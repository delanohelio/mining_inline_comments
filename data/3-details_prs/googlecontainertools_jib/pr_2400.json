{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyODgzODU1", "number": 2400, "title": "Set up sub-project for Gradle plugin extension and define extension API", "bodyText": "Continued work on establish the Jib plugin extension framework.\n\nSets up a sub-project for Gradle plugin extension (counterpart of #2368)\nDefines Gradle plugin extension API (counterpart of #2380)\nContainerBuildPlan extendContainerBuildPlan(\n    ContainerBuildPlan buildPlan, GradleData gradleData, ExtensionLogger logger)\n    throws JibPluginExtensionException;\n\n\n\nOne problem due to a difference from Maven: while the Maven Core API was defined with\ndependencies {\n  api \"org.apache.maven:maven-core:${dependencyVersions.MAVEN_API}\"\n\nhere the Gradle API dependency is though applying java-gradle-plugin.\nplugins {\n  id 'java-gradle-plugin'\nThe problem (I think) is that the Gradle API version is not pinned. So the Gradle version that the extension dev uses will determined the API version.", "createdAt": "2020-04-13T23:08:31Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2400", "merged": true, "mergeCommit": {"oid": "c42f6939a4af949d0ea6a513356034ab425f89db"}, "closed": true, "closedAt": "2020-04-16T15:17:48Z", "author": {"login": "chanseokoh"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXXAshgH2gAyNDAyODgzODU1OjAzMDI2ZjVlNTU3MzM4M2YyY2I4NDcxMDA2MTJhMzUzNjJjZWU0ZTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYN8jLAFqTM5NDcxNzYwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/03026f5e5573383f2cb847100612a35362cee4e1", "committedDate": "2020-04-13T22:54:55Z", "message": "Set up Gradle extension module and API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDk4Mzkw", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#pullrequestreview-392498390", "createdAt": "2020-04-13T23:09:17Z", "commit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzowOToxN1rOGE4Wng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzowOToxN1rOGE4Wng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3MDc4Mg==", "bodyText": "Is there an elegant way to merge this with the Maven block below?", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#discussion_r407770782", "createdAt": "2020-04-13T23:09:17Z", "author": {"login": "chanseokoh"}, "path": "build.gradle", "diffHunk": "@@ -21,6 +21,9 @@ idea.project.settings {\n \n import net.ltgt.gradle.errorprone.CheckSeverity\n \n+project('jib-gradle-plugin-extension-api') {\n+  apply plugin: 'java-library'\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTM2MzIx", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#pullrequestreview-392536321", "createdAt": "2020-04-14T01:03:51Z", "commit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMTowMzo1MlrOGE6eHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMTowNDo0MlrOGE6fCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgwNTQ2OQ==", "bodyText": "you could do something like?\n[\"jib-gradle-plugin-extension\", \"jib-maven-plugin-extension\"].each { projectName ->\n  project(projectName) {\n    apply plugin: 'java-library'\n  }\n}\n\nor some variation of this? I think you can call apply direction on the Project object? Nothing great I can think of.\nMaybe in the subprojects section below you can check\nif(project in [extension-api-projects list]) { \n  apply plugin: 'java-library' \n}", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#discussion_r407805469", "createdAt": "2020-04-14T01:03:52Z", "author": {"login": "loosebazooka"}, "path": "build.gradle", "diffHunk": "@@ -21,6 +21,9 @@ idea.project.settings {\n \n import net.ltgt.gradle.errorprone.CheckSeverity\n \n+project('jib-gradle-plugin-extension-api') {\n+  apply plugin: 'java-library'\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3MDc4Mg=="}, "originalCommit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgwNTcwNg==", "bodyText": "I don't think you need to apply the plugin, I think you can use gradleApi() directly in the dependencies block? (that still makes them provided dependencies though)", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#discussion_r407805706", "createdAt": "2020-04-14T01:04:42Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin-extension-api/build.gradle", "diffHunk": "@@ -0,0 +1,42 @@\n+plugins {\n+  // Is this the only option? Can't we do something simiar to Maven Extension API?\n+  id 'java-gradle-plugin'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03026f5e5573383f2cb847100612a35362cee4e1"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f928b2cbc5c7491ae41f4b02c7103bb5c2b84ea", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8f928b2cbc5c7491ae41f4b02c7103bb5c2b84ea", "committedDate": "2020-04-14T16:47:27Z", "message": "another way to apply java-library"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e901e6db16e0cfb552ba6e532a5b782084b3ebaa", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/e901e6db16e0cfb552ba6e532a5b782084b3ebaa", "committedDate": "2020-04-14T18:11:01Z", "message": "api gradleApi()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MTM5NTkx", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#pullrequestreview-394139591", "createdAt": "2020-04-15T21:13:43Z", "commit": {"oid": "e901e6db16e0cfb552ba6e532a5b782084b3ebaa"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQyMToxMzo0M1rOGGLxGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQyMToxMzo0M1rOGGLxGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTEzNzQzNA==", "bodyText": "should this go in the /* RELEASE */ section?", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#discussion_r409137434", "createdAt": "2020-04-15T21:13:43Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin-extension-api/build.gradle", "diffHunk": "@@ -0,0 +1,41 @@\n+plugins {\n+  id 'net.researchgate.release'\n+  id 'maven-publish'\n+}\n+\n+dependencies {\n+  api project(':jib-build-plan')\n+  api project(':jib-plugins-extension-common')\n+  api gradleApi()\n+}\n+\n+jar {\n+  manifest {\n+    attributes 'Implementation-Version': version\n+    attributes 'Automatic-Module-Name': 'com.google.cloud.tools.jib.gradle.extension'\n+\n+    // OSGi metadata\n+    attributes 'Bundle-SymbolicName': 'com.google.cloud.tools.jib.gradle.extension'\n+    attributes 'Bundle-Name': 'Extension API for Jib Gradle Plugin'\n+    attributes 'Bundle-Vendor': 'Google LLC'\n+    attributes 'Bundle-DocURL': 'https://github.com/GoogleContainerTools/jib'\n+    attributes 'Bundle-License': 'https://www.apache.org/licenses/LICENSE-2.0'\n+    attributes 'Export-Package': 'com.google.cloud.tools.jib.gradle.extension'\n+  }\n+}\n+\n+configureMavenRelease()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e901e6db16e0cfb552ba6e532a5b782084b3ebaa"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b15f5b876336f56813e9ce2f7bb1a1a0d22a6823", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/b15f5b876336f56813e9ce2f7bb1a1a0d22a6823", "committedDate": "2020-04-16T13:52:58Z", "message": "Move comments in build.gradle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NzE3NjA4", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#pullrequestreview-394717608", "createdAt": "2020-04-16T14:55:10Z", "commit": {"oid": "b15f5b876336f56813e9ce2f7bb1a1a0d22a6823"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNDo1NToxMFrOGGpaJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNDo1NToxMFrOGGpaJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTYyMzA3OA==", "bodyText": "oh haha, didn't realize this was a mistake I created :D", "url": "https://github.com/GoogleContainerTools/jib/pull/2400#discussion_r409623078", "createdAt": "2020-04-16T14:55:10Z", "author": {"login": "loosebazooka"}, "path": "jib-build-plan/build.gradle", "diffHunk": "@@ -29,9 +29,9 @@ jar {\n   }\n }\n \n+/* RELEASE */\n configureMavenRelease()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b15f5b876336f56813e9ce2f7bb1a1a0d22a6823"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 200, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}