{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MjA4MDE5", "number": 2670, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODo1OTo1NlrOEV9EeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxOTozOToxOVrOEWVSXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDU2MTIwOnYy", "diffSide": "RIGHT", "path": "docs/faq.md", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODo1OTo1NlrOG9AZFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxNzoyNjoxNVrOG9h-eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyMjc0Mg==", "bodyText": "@louismurerwa what happens as of now if the user is currently specifying a manifest (as opposed to a manifest list) of a non-default platform with Jib 2.4.0 and upgrades to 2.5.0? Will it fail or just shows a warning?", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r466622742", "createdAt": "2020-08-06T18:59:56Z", "author": {"login": "chanseokoh"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.\n+\n+Make sure to specify a manifest _list_ in `<from><image>` (whether by a tag name or a digest (`@sha256:...`)). For troubleshooting, you may want to check what platforms a manifest list contains. To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2277db302fe14ed5e9bcd03461156e2eff896d49"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE0ODY2OA==", "bodyText": "User specifies a manifest of a non-default platform\nJib 2.4.0 - This is the old Jib - it just builds using the manifest it found - it doesnt care about the platform of the manifest\nJib 2.5.0 - This is the the new Jib release - It also builds using the manifest it finds - It is not checking whether the specified manifest matches the default platform.\n\n  \n    \n      jib/jib-core/src/main/java/com/google/cloud/tools/jib/builder/steps/PullBaseImageStep.java\n    \n    \n         Line 234\n      in\n      4fae9f1\n    \n    \n    \n    \n\n        \n          \n           return Collections.singletonList( \n        \n    \n  \n\n\nShould I create an issue about this?", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r467148668", "createdAt": "2020-08-07T16:37:06Z", "author": {"login": "louismurerwa"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.\n+\n+Make sure to specify a manifest _list_ in `<from><image>` (whether by a tag name or a digest (`@sha256:...`)). For troubleshooting, you may want to check what platforms a manifest list contains. To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyMjc0Mg=="}, "originalCommit": {"oid": "2277db302fe14ed5e9bcd03461156e2eff896d49"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE2ODE2OQ==", "bodyText": "I see. So there's no change on that front; no warning or error, right? I know you've been keeping tracking of tasks to do in a separate doc. If you prefer, you can use GitHub as a tracking tool by creating issues. But eventually, I planned to have you file issues anyway.", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r467168169", "createdAt": "2020-08-07T17:16:29Z", "author": {"login": "chanseokoh"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.\n+\n+Make sure to specify a manifest _list_ in `<from><image>` (whether by a tag name or a digest (`@sha256:...`)). For troubleshooting, you may want to check what platforms a manifest list contains. To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyMjc0Mg=="}, "originalCommit": {"oid": "2277db302fe14ed5e9bcd03461156e2eff896d49"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE3MDE3NA==", "bodyText": "Awesome I will track this in the doc and file an issue at the end of the summer if I don't manage to fix it then.", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r467170174", "createdAt": "2020-08-07T17:20:44Z", "author": {"login": "louismurerwa"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.\n+\n+Make sure to specify a manifest _list_ in `<from><image>` (whether by a tag name or a digest (`@sha256:...`)). For troubleshooting, you may want to check what platforms a manifest list contains. To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyMjc0Mg=="}, "originalCommit": {"oid": "2277db302fe14ed5e9bcd03461156e2eff896d49"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzE3Mjk4Ng==", "bodyText": "Sounds good. Other than that, do the overall doc changes look OK?", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r467172986", "createdAt": "2020-08-07T17:26:15Z", "author": {"login": "chanseokoh"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.\n+\n+Make sure to specify a manifest _list_ in `<from><image>` (whether by a tag name or a digest (`@sha256:...`)). For troubleshooting, you may want to check what platforms a manifest list contains. To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyMjc0Mg=="}, "originalCommit": {"oid": "2277db302fe14ed5e9bcd03461156e2eff896d49"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxODUyODkzOnYy", "diffSide": "RIGHT", "path": "docs/faq.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxOTozOToxOVrOG9ltTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxOTozOToxOVrOG9ltTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIzNDEyNg==", "bodyText": "Updating this line to ->\nOnly architecture and os are supported. If there are multiple base images with given architecture and os in the manifest list, the first image will be selected.", "url": "https://github.com/GoogleContainerTools/jib/pull/2670#discussion_r467234126", "createdAt": "2020-08-07T19:39:19Z", "author": {"login": "louismurerwa"}, "path": "docs/faq.md", "diffHunk": "@@ -469,18 +469,46 @@ To inspect the image that is produced from the build using Docker, you can use c\n \n ### How do I specify a platform in the manifest list (or OCI index) of a base image?\n \n-By design, if the target image reference is a [manifest list](https://docs.docker.com/registry/spec/manifest-v2-2/#manifest-list), Jib will always select an image for the platform `amd64/linux`. If you need to specify a different image from a manifest list you must specify the digest for the platform you are targeting.\n+Jib 2.5.0 added an _incubating feature_ that provides limited support for selecting a base image with the desired platform from a manifest list. For example,\n \n-To view a manifest, [enable experimental docker CLI](https://docs.docker.com/engine/reference/commandline/cli/#experimental-features) features and then run the [manifest inspect](https://docs.docker.com/engine/reference/commandline/manifest_inspect/) command.\n+```xml\n+  <from>\n+    <image>... image reference to a manifest list ...</image>\n+    <platforms>\n+      <platform>\n+        <architecture>arm64</architecture>\n+        <os>linux</os>\n+      </platform>\n+    </platforms>\n+  </from>\n ```\n-$ docker manifest inspect openjdk:8\n+\n+```gradle\n+jib.from {\n+  image = '... image reference to a manifest list ...'\n+  platforms {\n+    platform {\n+      architecture = 'arm64'\n+      os = 'linux'\n+    }\n+  }\n+}\n ```\n \n-You can then inspect the output for the specific image you want (in this example an image for the platform `arm64/linux`)\n-```java\n+The default platform is \"amd64/linux\" if not specified, whose behavior is backward-compatible.\n+\n+As an incubating feature, there are certain limitations:\n+- OCI image indices are not supported (as opposed to Docker manifest lists).\n+- Supports specifying only one platform.\n+- Only `architecture` and `os` are supported. If there are multiple base images with given architecture and os, the first image will be selected.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea1efabba558bf6341de6104dbf86733ecf7dae7"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 106, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}