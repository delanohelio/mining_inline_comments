{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMTQ4ODAy", "number": 2218, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MDozOFrODWqlyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowOTowOVrODWq23A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDkzMDY0OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MDozOFrOFbjd5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MDozOFrOFbjd5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNjk2Nw==", "bodyText": "This is misleading, since it is, e.g., $XDG_CACHE_HOME/.cache/google-cloud-tools-java/lib/ on Linux.", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364436967", "createdAt": "2020-01-08T20:50:38Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDkzMjU2OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MToyMVrOFbjfAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MToyMVrOFbjfAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNzI0OA==", "bodyText": "ditto", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364437248", "createdAt": "2020-01-08T20:51:21Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk1MzMwOnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1OTo0MFrOFbjr4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjo0MTo0MFrOFb8UHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDU0NQ==", "bodyText": "I'd rather have\nPath linuxSubdirectory = Paths.get(\".config\").resolve(JIB_SUBDIRECTORY_LINUX);\nPath windowsSubdirectory = JIB_SUBDIRECTORY_OTHER.resolve(\"Config\");\nPath macSubdirectory = Paths.get(\"Library\", \"Preferences\").resolve(JIB_SUBDIRECTORY_OTHER);\ngetOsSpecificDirectory(..., linuxSubdirectory, windowsSubdirectory, macSubdirectory);", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364440545", "createdAt": "2020-01-08T20:59:40Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg0NDA2Mw==", "bodyText": "I agree this looks cleaner, but it might end up being a pain since the function operates on portions of the os-specific subdirectories, not the whole thing (e.g. mac needs to check if ~/Library/Preferences exists ignoring the JIB_SUBDIRECTORY_OTHER portion, if $XDG_X_HOME isn't configured then each OS defaults to `$HOME/.config/[OS-specific subdirectory], etc.)", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364844063", "createdAt": "2020-01-09T16:41:40Z", "author": {"login": "TadCordle"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDU0NQ=="}, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk1NTQ0OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowMDo0MlrOFbjtTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowMDo0MlrOFbjtTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDkwOA==", "bodyText": "xdgConfigHome --> xdgHome", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364440908", "createdAt": "2020-01-08T21:00:42Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 112}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk2NDc5OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNDo1NVrOFbjzVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNDo1NVrOFbjzVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjQ1NA==", "bodyText": "\"Use XDG environment variable if set and not empty.\"", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364442454", "createdAt": "2020-01-08T21:04:55Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);\n+    String userHome = properties.getProperty(\"user.home\");\n+    Path xdgPath = Paths.get(userHome, linuxFolder);\n+\n+    if (osName.contains(\"linux\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 117}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk2NjM2OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTo0MVrOFbj0cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTo0MVrOFbj0cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjczOA==", "bodyText": "ditto", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364442738", "createdAt": "2020-01-08T21:05:41Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);\n+    String userHome = properties.getProperty(\"user.home\");\n+    Path xdgPath = Paths.get(userHome, linuxFolder);\n+\n+    if (osName.contains(\"linux\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_LINUX);\n+      }\n+      return xdgPath.resolve(JIB_SUBDIRECTORY_LINUX);\n+\n+    } else if (osName.contains(\"windows\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(windowsSubDirectory);\n+      }\n+\n+      // Use %LOCALAPPDATA% for Windows.\n+      String localAppDataEnv = environment.get(\"LOCALAPPDATA\");\n+      if (localAppDataEnv == null || localAppDataEnv.trim().isEmpty()) {\n+        LOGGER.warning(\"LOCALAPPDATA environment is invalid or missing\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      Path localAppData = Paths.get(localAppDataEnv);\n+      if (!Files.exists(localAppData)) {\n+        LOGGER.warning(localAppData + \" does not exist\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      return localAppData.resolve(windowsSubDirectory);\n+\n+    } else if (osName.contains(\"mac\") || osName.contains(\"darwin\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 143}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk2NzI2OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTo1OVrOFbj0-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTo1OVrOFbj0-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0Mjg3NQ==", "bodyText": "ditto", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364442875", "createdAt": "2020-01-08T21:05:59Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);\n+    String userHome = properties.getProperty(\"user.home\");\n+    Path xdgPath = Paths.get(userHome, linuxFolder);\n+\n+    if (osName.contains(\"linux\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_LINUX);\n+      }\n+      return xdgPath.resolve(JIB_SUBDIRECTORY_LINUX);\n+\n+    } else if (osName.contains(\"windows\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 124}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk3Mzg3OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowODo1MVrOFbj5JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowODo1MVrOFbj5JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0Mzk0MA==", "bodyText": "The name applicationSupport is no longer used, right?", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364443940", "createdAt": "2020-01-08T21:08:51Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);\n+    String userHome = properties.getProperty(\"user.home\");\n+    Path xdgPath = Paths.get(userHome, linuxFolder);\n+\n+    if (osName.contains(\"linux\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_LINUX);\n+      }\n+      return xdgPath.resolve(JIB_SUBDIRECTORY_LINUX);\n+\n+    } else if (osName.contains(\"windows\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(windowsSubDirectory);\n+      }\n+\n+      // Use %LOCALAPPDATA% for Windows.\n+      String localAppDataEnv = environment.get(\"LOCALAPPDATA\");\n+      if (localAppDataEnv == null || localAppDataEnv.trim().isEmpty()) {\n+        LOGGER.warning(\"LOCALAPPDATA environment is invalid or missing\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      Path localAppData = Paths.get(localAppDataEnv);\n+      if (!Files.exists(localAppData)) {\n+        LOGGER.warning(localAppData + \" does not exist\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      return localAppData.resolve(windowsSubDirectory);\n+\n+    } else if (osName.contains(\"mac\") || osName.contains(\"darwin\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_OTHER);\n+      }\n+\n+      // Use '~/Library/Preferences/' for macOS.\n+      Path applicationSupport = Paths.get(userHome, \"Library\", macFolder);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 149}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk3NDM2OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowOTowOVrOFbj5hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowOTowOVrOFbj5hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0NDAzOA==", "bodyText": "\"Preferences\" is only for the config directory.", "url": "https://github.com/GoogleContainerTools/jib/pull/2218#discussion_r364444038", "createdAt": "2020-01-08T21:09:09Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/filesystem/XdgDirectories.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright 2018 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.filesystem;\n+\n+import com.google.common.annotations.VisibleForTesting;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Locale;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.logging.Logger;\n+\n+/**\n+ * Obtains OS-specific directories based on the XDG Base Directory Specification.\n+ *\n+ * <p>Specifically, from the specification:\n+ *\n+ * <ul>\n+ *   <li>These directories are defined by the environment variables {@code $XDG_CACHE_HOME} and\n+ *       {@code $XDG_CONFIG_HOME}.\n+ *   <li>If {@code $XDG_CACHE_HOME} / {@code $XDG_CONFIG_HOME} is either not set or empty, a\n+ *       platform-specific equivalent of {@code $HOME/.cache} / {@code $HOME/.config} should be\n+ *       used.\n+ * </ul>\n+ *\n+ * @see <a\n+ *     href=\"https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\">https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</a>\n+ */\n+public class XdgDirectories {\n+\n+  private static final Logger LOGGER = Logger.getLogger(XdgDirectories.class.getName());\n+  private static final Path JIB_SUBDIRECTORY_LINUX =\n+      Paths.get(\"google-cloud-tools-java\").resolve(\"jib\");\n+  private static final Path JIB_SUBDIRECTORY_OTHER = Paths.get(\"Google\").resolve(\"Jib\");\n+\n+  public static Path getCacheHome() {\n+    return getCacheHome(System.getProperties(), System.getenv());\n+  }\n+\n+  public static Path getConfigHome() {\n+    return getConfigHome(System.getProperties(), System.getenv());\n+  }\n+\n+  /**\n+   * Returns {@code $XDG_CACHE_HOME}, if available, or resolves the OS-specific user cache home\n+   * based.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.cache/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Cache\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Caches/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getCacheHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CACHE_HOME\", \".cache\", \"Cache\", \"Caches\");\n+  }\n+\n+  /**\n+   * Returns config directory based on {@code $XDG_CONFIG_HOME}, if available, or resolves the\n+   * OS-specific user config directory.\n+   *\n+   * <p>For Linux, this is {@code $HOME/.config/google-cloud-tools-java/jib/}.\n+   *\n+   * <p>For Windows, this is {@code %LOCALAPPDATA%\\Google\\Jib\\Config\\}.\n+   *\n+   * <p>For macOS, this is {@code $HOME/Library/Preferences/Google/Jib/}.\n+   */\n+  @VisibleForTesting\n+  static Path getConfigHome(Properties properties, Map<String, String> environment) {\n+    return getOsSpecificDirectory(\n+        properties, environment, \"XDG_CONFIG_HOME\", \".config\", \"Config\", \"Preferences\");\n+  }\n+\n+  /**\n+   * Helper method for resolving directories on different operating systems.\n+   *\n+   * @param xdgEnvVariable the name of the environment variable used to resolve the XDG base\n+   *     directory\n+   * @param linuxFolder \".config\" or \".cache\"\n+   * @param windowsFolder \"Config\" or \"Cache\"\n+   * @param macFolder \"Preferences\" or \"Caches\"\n+   * @return the full path constructed from the given parameters\n+   */\n+  private static Path getOsSpecificDirectory(\n+      Properties properties,\n+      Map<String, String> environment,\n+      String xdgEnvVariable,\n+      String linuxFolder,\n+      String windowsFolder,\n+      String macFolder) {\n+\n+    Path windowsSubDirectory = JIB_SUBDIRECTORY_OTHER.resolve(windowsFolder);\n+    String rawOsName = properties.getProperty(\"os.name\");\n+    String osName = rawOsName.toLowerCase(Locale.ENGLISH);\n+    String xdgConfigHome = environment.get(xdgEnvVariable);\n+    String userHome = properties.getProperty(\"user.home\");\n+    Path xdgPath = Paths.get(userHome, linuxFolder);\n+\n+    if (osName.contains(\"linux\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_LINUX);\n+      }\n+      return xdgPath.resolve(JIB_SUBDIRECTORY_LINUX);\n+\n+    } else if (osName.contains(\"windows\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(windowsSubDirectory);\n+      }\n+\n+      // Use %LOCALAPPDATA% for Windows.\n+      String localAppDataEnv = environment.get(\"LOCALAPPDATA\");\n+      if (localAppDataEnv == null || localAppDataEnv.trim().isEmpty()) {\n+        LOGGER.warning(\"LOCALAPPDATA environment is invalid or missing\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      Path localAppData = Paths.get(localAppDataEnv);\n+      if (!Files.exists(localAppData)) {\n+        LOGGER.warning(localAppData + \" does not exist\");\n+        return xdgPath.resolve(windowsSubDirectory);\n+      }\n+      return localAppData.resolve(windowsSubDirectory);\n+\n+    } else if (osName.contains(\"mac\") || osName.contains(\"darwin\")) {\n+      // Use environment variable $XDG_CONFIG_HOME if set and not empty.\n+      if (xdgConfigHome != null && !xdgConfigHome.trim().isEmpty()) {\n+        return Paths.get(xdgConfigHome).resolve(JIB_SUBDIRECTORY_OTHER);\n+      }\n+\n+      // Use '~/Library/Preferences/' for macOS.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594bf738f518969d49c5e288efe9a60f974bde12"}, "originalPosition": 148}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 438, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}