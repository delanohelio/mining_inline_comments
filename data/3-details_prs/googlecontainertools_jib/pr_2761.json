{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2OTExNDgy", "number": 2761, "title": "Throw IllegalArgumentException when jib.to.tags is set to a collection containing a null value. ", "bodyText": "Fixes #2760", "createdAt": "2020-09-14T21:53:00Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2761", "merged": true, "mergeCommit": {"oid": "bedfe058e9b5e90c76321387270ba48613545a24"}, "closed": true, "closedAt": "2020-09-28T13:58:43Z", "author": {"login": "mpeddada1"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI4dwggH2gAyNDg2OTExNDgyOmE3ZDJkODMyZmY3NGFhMjlkMmYxN2Q5NjZlZWI2YWE4NzlkMjEzYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMJJZQAH2gAyNDg2OTExNDgyOmRjYWU0Mjk3YmY3MTU4MDQzNGNiZjhiZTYxZjI5NTk1NWRjODVkNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a7d2d832ff74aa29d2f17d966eeb6aa879d213b5", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/a7d2d832ff74aa29d2f17d966eeb6aa879d213b5", "committedDate": "2020-09-14T19:35:49Z", "message": "throw IllegalArgumentException with message when jib.to.tags is assigned to Set<String> containing null value"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "334729a526664ea1f8f30a8d16e5285943051c89", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/334729a526664ea1f8f30a8d16e5285943051c89", "committedDate": "2020-09-14T19:37:48Z", "message": "fixing comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "857cae59d1c99627a934a74c9119062d34df9395", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/857cae59d1c99627a934a74c9119062d34df9395", "committedDate": "2020-09-14T21:47:29Z", "message": "fixing formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/81bbaa9bbb87aad94dfab8e5c58ff034441ade05", "committedDate": "2020-09-14T21:49:39Z", "message": "fix commenting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODg5NzUz", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-488889753", "createdAt": "2020-09-15T17:05:54Z", "commit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoxMjowNVrOHSLsqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzoxNDowMFrOHSLwpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyODA3Mg==", "bodyText": "For readability: I think maybe tags is confusing with the class member tags (this.tags). Perhaps use something that differentiates it? Personally I don't think this.tags should be used very often outside constructors.", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r488828072", "createdAt": "2020-09-15T17:12:05Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -60,10 +61,16 @@ public void setImage(String image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tags =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyODUwMQ==", "bodyText": "should we handle whitespace?", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r488828501", "createdAt": "2020-09-15T17:12:54Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -60,10 +61,16 @@ public void setImage(String image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tags =\n+        property != null\n+            ? ImmutableSet.copyOf(\n+                ConfigurationPropertyValidator.parseListProperty(\n+                    System.getProperty(PropertyNames.TO_TAGS)))\n+            : this.tags;\n+    if (tags.stream().anyMatch(Strings::isNullOrEmpty)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyODc2Mg==", "bodyText": "if we fail on empty, we should probably add a test for empty as well", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r488828762", "createdAt": "2020-09-15T17:13:25Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -85,6 +86,21 @@ public void testTo() {\n     Assert.assertEquals(\"some cred helper\", testJibExtension.getTo().getCredHelper());\n     Assert.assertEquals(\"some username\", testJibExtension.getTo().getAuth().getUsername());\n     Assert.assertEquals(\"some password\", testJibExtension.getTo().getAuth().getPassword());\n+\n+    // Testing scenario where jib.to.tags is set to a collection containing a null value.\n+    HashSet<String> tags = new HashSet<String>();\n+    tags.add(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyOTA5NA==", "bodyText": "Maybe just put this in a new test?", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r488829094", "createdAt": "2020-09-15T17:14:00Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -85,6 +86,21 @@ public void testTo() {\n     Assert.assertEquals(\"some cred helper\", testJibExtension.getTo().getCredHelper());\n     Assert.assertEquals(\"some username\", testJibExtension.getTo().getAuth().getUsername());\n     Assert.assertEquals(\"some password\", testJibExtension.getTo().getAuth().getPassword());\n+\n+    // Testing scenario where jib.to.tags is set to a collection containing a null value.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5Nzc4NDEx", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-489778411", "createdAt": "2020-09-16T16:03:20Z", "commit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNjowMzoyMFrOHS39Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNjowODoxMFrOHS4I7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU1MzE5MA==", "bodyText": "Also the case of getting tags from the system property.", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r489553190", "createdAt": "2020-09-16T16:03:20Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -85,6 +86,21 @@ public void testTo() {\n     Assert.assertEquals(\"some cred helper\", testJibExtension.getTo().getCredHelper());\n     Assert.assertEquals(\"some username\", testJibExtension.getTo().getAuth().getUsername());\n     Assert.assertEquals(\"some password\", testJibExtension.getTo().getAuth().getPassword());\n+\n+    // Testing scenario where jib.to.tags is set to a collection containing a null value.\n+    HashSet<String> tags = new HashSet<String>();\n+    tags.add(null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyODc2Mg=="}, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU1NTQzMw==", "bodyText": "Nit: if the message doesn't provide additional helpful information or details, just use Assert.fail().\nAnd I think it's meaningful to move testJibExtension.to() out of the try-catch block.", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r489555433", "createdAt": "2020-09-16T16:06:54Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -85,6 +86,21 @@ public void testTo() {\n     Assert.assertEquals(\"some cred helper\", testJibExtension.getTo().getCredHelper());\n     Assert.assertEquals(\"some username\", testJibExtension.getTo().getAuth().getUsername());\n     Assert.assertEquals(\"some password\", testJibExtension.getTo().getAuth().getPassword());\n+\n+    // Testing scenario where jib.to.tags is set to a collection containing a null value.\n+    HashSet<String> tags = new HashSet<String>();\n+    tags.add(null);\n+    tags.add(\"tags1\");\n+    try {\n+      testJibExtension.to(\n+          to -> {\n+            to.setTags(tags);\n+          });\n+      testJibExtension.getTo().getTags();\n+      Assert.fail(\"Expect this to fail\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU1NjIwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                System.getProperty(PropertyNames.TO_TAGS)))\n          \n          \n            \n                                property))", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r489556206", "createdAt": "2020-09-16T16:08:10Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -60,10 +61,16 @@ public void setImage(String image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tags =\n+        property != null\n+            ? ImmutableSet.copyOf(\n+                ConfigurationPropertyValidator.parseListProperty(\n+                    System.getProperty(PropertyNames.TO_TAGS)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bbaa9bbb87aad94dfab8e5c58ff034441ade05"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f447f310657df3db1b661955637cfd236ea4ad7", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/5f447f310657df3db1b661955637cfd236ea4ad7", "committedDate": "2020-09-16T21:39:46Z", "message": "added tests for empty tag, tag containing whitespace and System.getProperty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63f385f8fafdfcd5c1230cfe2edfb7bbfd64c1f7", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/63f385f8fafdfcd5c1230cfe2edfb7bbfd64c1f7", "committedDate": "2020-09-16T21:49:21Z", "message": "added helper method for common code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a574176b9160b9c687bd46632e26c4195501b58", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/7a574176b9160b9c687bd46632e26c4195501b58", "committedDate": "2020-09-16T21:59:13Z", "message": "changing method names"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDQ5MDg2", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-490049086", "createdAt": "2020-09-16T21:57:59Z", "commit": {"oid": "63f385f8fafdfcd5c1230cfe2edfb7bbfd64c1f7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMTo1Nzo1OVrOHTFqYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMjowMjoxM1rOHTFw4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc3Nzc2Mw==", "bodyText": "How about this?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                HashSet<String> tagSet = new HashSet<String>();\n          \n          \n            \n                for (String tag : tags) {\n          \n          \n            \n                  tagSet.add(tag);\n          \n          \n            \n                }\n          \n          \n            \n                HashSet<String> set = new HashSet<>(Arrays.asList(tags));", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r489777763", "createdAt": "2020-09-16T21:57:59Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -400,4 +437,16 @@ public void testProperties() {\n         fakeProject.getProjectDir().toPath().resolve(Paths.get(\"tar/path\")),\n         testJibExtension.getOutputPaths().getTarPath());\n   }\n+\n+  public TargetImageParameters generateTargetImageParametersWithTags(String... tags) {\n+    HashSet<String> tagSet = new HashSet<String>();\n+    for (String tag : tags) {\n+      tagSet.add(tag);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63f385f8fafdfcd5c1230cfe2edfb7bbfd64c1f7"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc3OTQyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (tagsValue.stream().anyMatch((String str) -> str.contains(\" \"))) {\n          \n          \n            \n                if (tagsValue.stream().anyMatch(str -> str.contains(\" \"))) {", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r489779427", "createdAt": "2020-09-16T22:02:13Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -60,12 +61,19 @@ public void setImage(String image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tagsValue =\n+        property != null\n+            ? ImmutableSet.copyOf(ConfigurationPropertyValidator.parseListProperty(property))\n+            : tags;\n+    String source = property != null ? PropertyNames.TO_TAGS : \"jib.to.tags\";\n+    if (tagsValue.stream().anyMatch(Strings::isNullOrEmpty)) {\n+      throw new IllegalArgumentException(source + \" has empty tag\");\n     }\n-    return tags;\n+    if (tagsValue.stream().anyMatch((String str) -> str.contains(\" \"))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63f385f8fafdfcd5c1230cfe2edfb7bbfd64c1f7"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "633f42173e2ebb14061efe15cbd4883b480e8afc", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/633f42173e2ebb14061efe15cbd4883b480e8afc", "committedDate": "2020-09-16T22:07:19Z", "message": "move test for getProperty to separate method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "716e6671edf295f6ac6dc0d523aac9fc4eff55af", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/716e6671edf295f6ac6dc0d523aac9fc4eff55af", "committedDate": "2020-09-16T22:09:08Z", "message": "Update jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java\n\nCo-authored-by: Chanseok Oh <chanseok@google.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35d96934a5f48cd27c11a148827c761ac3cc2c40", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/35d96934a5f48cd27c11a148827c761ac3cc2c40", "committedDate": "2020-09-16T22:09:32Z", "message": "Update jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java\n\nCo-authored-by: Chanseok Oh <chanseok@google.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0dcb5bf2027ac99a8130415c47244f4af0547da", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d0dcb5bf2027ac99a8130415c47244f4af0547da", "committedDate": "2020-09-16T22:12:19Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "947df8424ebea1b2f01fe05e25b2853ee47e0582", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/947df8424ebea1b2f01fe05e25b2853ee47e0582", "committedDate": "2020-09-16T22:12:23Z", "message": "Merge branch 'fix-npe' of github.com:GoogleContainerTools/jib into fix-npe"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "285d714332321abf56271b93d7a099c7caab12fb", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/285d714332321abf56271b93d7a099c7caab12fb", "committedDate": "2020-09-16T22:14:25Z", "message": "small fix to helper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzI5MTM4", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-491729138", "createdAt": "2020-09-18T19:29:16Z", "commit": {"oid": "285d714332321abf56271b93d7a099c7caab12fb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOToyOToxNlrOHUZaDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOToyOToxNlrOHUZaDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE0OTgzNw==", "bodyText": "What I meant was checking for something like \"   \" but maybe jib-core already validates these values before going?\nPerhaps your original condition was enough, lemme see if jib core validates this.", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r491149837", "createdAt": "2020-09-18T19:29:16Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -60,12 +61,19 @@ public void setImage(String image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tagsValue =\n+        property != null\n+            ? ImmutableSet.copyOf(ConfigurationPropertyValidator.parseListProperty(property))\n+            : tags;\n+    String source = property != null ? PropertyNames.TO_TAGS : \"jib.to.tags\";\n+    if (tagsValue.stream().anyMatch(Strings::isNullOrEmpty)) {\n+      throw new IllegalArgumentException(source + \" has empty tag\");\n     }\n-    return tags;\n+    if (tagsValue.stream().anyMatch(str -> str.contains(\" \"))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "285d714332321abf56271b93d7a099c7caab12fb"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e56c2470668bf8d00783d0c750050c6f6f24f3e4", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/e56c2470668bf8d00783d0c750050c6f6f24f3e4", "committedDate": "2020-09-18T20:43:47Z", "message": "remove checker for whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "022cff62df2f1acf6739154bc903e2c7c29520d3", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/022cff62df2f1acf6739154bc903e2c7c29520d3", "committedDate": "2020-09-18T20:47:49Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88bb2bae746203b48155ba4a6af68ac09404e830", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/88bb2bae746203b48155ba4a6af68ac09404e830", "committedDate": "2020-09-18T20:52:41Z", "message": "modify error message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09c825ae70cd16763b21ba2af63183be3111d93d", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/09c825ae70cd16763b21ba2af63183be3111d93d", "committedDate": "2020-09-18T21:28:46Z", "message": "fix formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMDAwNDIw", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-492000420", "createdAt": "2020-09-19T13:57:46Z", "commit": {"oid": "09c825ae70cd16763b21ba2af63183be3111d93d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c206490710b92b20f49f572c11778438739f125", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4c206490710b92b20f49f572c11778438739f125", "committedDate": "2020-09-21T17:52:41Z", "message": "resolving merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7a793fd7034d1a5651c2520350efbc8e2a9503a", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/f7a793fd7034d1a5651c2520350efbc8e2a9503a", "committedDate": "2020-09-21T19:42:58Z", "message": "catch the npe to add error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNzg5NzUy", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-493789752", "createdAt": "2020-09-22T19:42:39Z", "commit": {"oid": "f7a793fd7034d1a5651c2520350efbc8e2a9503a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxOTo0MjozOVrOHWJqqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxOTo0MjozOVrOHWJqqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk4OTA5OQ==", "bodyText": "Do we have to do that logic where we know its from system property or from configuration in teh build file?", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#discussion_r492989099", "createdAt": "2020-09-22T19:42:39Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/TargetImageParameters.java", "diffHunk": "@@ -69,12 +69,21 @@ public void setImage(Provider<String> image) {\n   @Input\n   @Optional\n   public Set<String> getTags() {\n-    if (System.getProperty(PropertyNames.TO_TAGS) != null) {\n-      return ImmutableSet.copyOf(\n-          ConfigurationPropertyValidator.parseListProperty(\n-              System.getProperty(PropertyNames.TO_TAGS)));\n+    String property = System.getProperty(PropertyNames.TO_TAGS);\n+    Set<String> tagsValue;\n+    if (property != null) {\n+      tagsValue = ImmutableSet.copyOf(ConfigurationPropertyValidator.parseListProperty(property));\n+    } else {\n+      try {\n+        tagsValue = tags.get();\n+      } catch (NullPointerException ex) {\n+        throw new IllegalArgumentException(\"jib.to.tags contains null tag\");\n+      }\n     }\n-    return tags.get();\n+    if (tagsValue.stream().anyMatch(str -> str.isEmpty())) {\n+      throw new IllegalArgumentException(\"jib.to.tags contains empty tag\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7a793fd7034d1a5651c2520350efbc8e2a9503a"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0ODkyNDEy", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-494892412", "createdAt": "2020-09-23T17:34:09Z", "commit": {"oid": "f7a793fd7034d1a5651c2520350efbc8e2a9503a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db0623f19222b7d4332e1faf82dfe585ee3c2bb9", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/db0623f19222b7d4332e1faf82dfe585ee3c2bb9", "committedDate": "2020-09-24T22:28:40Z", "message": "Add CHANGELOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ef68b13747a3d20c4d20d4de483963b8fa2ba60", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/5ef68b13747a3d20c4d20d4de483963b8fa2ba60", "committedDate": "2020-09-24T22:33:34Z", "message": "handle merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b764ef37f3b57d9699d5efc69934db4c852275ad", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/b764ef37f3b57d9699d5efc69934db4c852275ad", "committedDate": "2020-09-24T22:36:27Z", "message": "move issue description in CHANGELOG down"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1OTk3MTQ0", "url": "https://github.com/GoogleContainerTools/jib/pull/2761#pullrequestreview-495997144", "createdAt": "2020-09-24T22:38:07Z", "commit": {"oid": "b764ef37f3b57d9699d5efc69934db4c852275ad"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcae4297bf71580434cbf8be61f295955dc85d70", "author": {"user": {"login": "mpeddada1", "name": "Mridula"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/dcae4297bf71580434cbf8be61f295955dc85d70", "committedDate": "2020-09-24T22:43:44Z", "message": "refining description"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 13, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}