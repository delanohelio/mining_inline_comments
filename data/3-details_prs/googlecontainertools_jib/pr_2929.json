{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0MDg4NzU4", "number": 2929, "title": "Add new Utility to determine cache location", "bodyText": "There are two cache locations in the cli:\n\nThe base image cache (--base-image-cache), by default shared with any other tools using the default values from jib core. this is intended, base images can be large, and sharing a single cache would be good. CLI options --base-image-cache\nThe project cache (--project-cache, previously --application-cache), is the cache directory for any application layers but can also be used for any other build artifacts that need to be stored as part of the build. Caching uses paths to project files, so we want to this to be consistent across builds for temporary files projects (like expanded jars)\n\nthe default for this is <user-cache>/jib/cli/project/<hash>, the hash is calculated by obtaining and normalizing the absolute path to a project.\nthe user maybe configure this to their own liking, we chose not to put in in the project root because of unknown interactions with user configuration for creating layers.", "createdAt": "2020-12-08T03:19:25Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2929", "merged": true, "mergeCommit": {"oid": "02568ba12f4d6f0f400cf7e107f924e64803e8e6"}, "closed": true, "closedAt": "2020-12-11T16:31:14Z", "author": {"login": "loosebazooka"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkBdzZABqjQwODI2NjQ2MTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlAaLzAH2gAyNTM0MDg4NzU4OjQzZGZiZjNlM2YyOWU2ZGE2MjMyODE5NmE0Yjk5MWNiYmJmMGNjYzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca25af395f172798ba3ca1fa5b2ef3f116e5184c", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/ca25af395f172798ba3ca1fa5b2ef3f116e5184c", "committedDate": "2020-12-08T02:46:56Z", "message": "Add new Utility to determine cache location"}, "afterCommit": {"oid": "8b56f664bc717203d228161d02ff619f1ac395b5", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8b56f664bc717203d228161d02ff619f1ac395b5", "committedDate": "2020-12-08T03:20:36Z", "message": "Add new Caches utility to determine cache location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dacfdb3172b6a34445bddfac99fc8d611edf2c6c", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/dacfdb3172b6a34445bddfac99fc8d611edf2c6c", "committedDate": "2020-12-08T18:53:23Z", "message": "Add new Caches utility to determine cache location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/db286ca13c41014c2cb7bdd35167540182219029", "committedDate": "2020-12-08T18:53:35Z", "message": "use hex representation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b56f664bc717203d228161d02ff619f1ac395b5", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8b56f664bc717203d228161d02ff619f1ac395b5", "committedDate": "2020-12-08T03:20:36Z", "message": "Add new Caches utility to determine cache location"}, "afterCommit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/db286ca13c41014c2cb7bdd35167540182219029", "committedDate": "2020-12-08T18:53:35Z", "message": "use hex representation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NzEwMzE0", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#pullrequestreview-547710314", "createdAt": "2020-12-08T23:11:55Z", "commit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMzoxMTo1NlrOIB6h0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMzozOToyMFrOIB7X9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg3ODQxOQ==", "bodyText": "Perhaps, CacheLocation?", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r538878419", "createdAt": "2020-12-08T23:11:56Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/cli2/Caches.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import com.google.common.annotations.VisibleForTesting;\n+import com.google.common.base.Charsets;\n+import java.nio.file.Path;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.Optional;\n+import javax.annotation.Nullable;\n+\n+/** A class to determine cache locations for any cli commands. */\n+public class Caches {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg4Njk2OQ==", "bodyText": "very nit: don't need the Truth8 at the beginning. Same below.", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r538886969", "createdAt": "2020-12-08T23:26:43Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/test/java/com/google/cloud/tools/jib/cli/cli2/CachesTest.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import com.google.common.truth.Truth;\n+import com.google.common.truth.Truth8;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Optional;\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+import org.mockito.Mockito;\n+\n+public class CachesTest {\n+\n+  @Rule public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+  @Test\n+  public void testCaches_defaults() {\n+    CommonCliOptions commonCliOptions = new CommonCliOptions();\n+    Path buildContext = Paths.get(\"some-context\");\n+    Caches caches = Caches.from(commonCliOptions, buildContext);\n+\n+    Truth8.assertThat(caches.getBaseImageCache()).isEmpty();\n+    Truth8.assertThat(caches.getProjectCache())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg4ODQzOA==", "bodyText": "assertThat(path2).isNotEqualTo(path1)\nassertThat(Files.isSameFine(path1, path2)).isTrue()", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r538888438", "createdAt": "2020-12-08T23:30:02Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/test/java/com/google/cloud/tools/jib/cli/cli2/CachesTest.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import com.google.common.truth.Truth;\n+import com.google.common.truth.Truth8;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Optional;\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+import org.mockito.Mockito;\n+\n+public class CachesTest {\n+\n+  @Rule public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+  @Test\n+  public void testCaches_defaults() {\n+    CommonCliOptions commonCliOptions = new CommonCliOptions();\n+    Path buildContext = Paths.get(\"some-context\");\n+    Caches caches = Caches.from(commonCliOptions, buildContext);\n+\n+    Truth8.assertThat(caches.getBaseImageCache()).isEmpty();\n+    Truth8.assertThat(caches.getProjectCache())\n+        .isEqualTo(\n+            XdgDirectories.getCacheHome()\n+                .resolve(\"cli\")\n+                .resolve(\"projects\")\n+                .resolve(Caches.hashPath(Paths.get(\"some-context\"))));\n+  }\n+\n+  @Test\n+  public void testCaches_configuredValuesIgnoresBuildContext() {\n+    CommonCliOptions commonCliOptions = Mockito.mock(CommonCliOptions.class);\n+    Path userBaseImageCache = Paths.get(\"test-base-image-cache\");\n+    Path userProjectCache = Paths.get(\"test-project-cache\");\n+    Mockito.when(commonCliOptions.getBaseImageCache()).thenReturn(Optional.of(userBaseImageCache));\n+    Mockito.when(commonCliOptions.getProjectCache()).thenReturn(Optional.of(userProjectCache));\n+    Caches caches = Caches.from(commonCliOptions, Paths.get(\"ignored\"));\n+\n+    Truth8.assertThat(caches.getBaseImageCache()).hasValue(userBaseImageCache);\n+    Truth8.assertThat(caches.getProjectCache()).isEqualTo(userProjectCache);\n+  }\n+\n+  @Test\n+  public void testHashPath_sameFileDifferentPaths() throws IOException {\n+    temporaryFolder.newFolder(\"ignored\");\n+    Path path1 = temporaryFolder.getRoot().toPath().resolve(\"ignored\").resolve(\"..\");\n+    Path path2 = temporaryFolder.getRoot().toPath();\n+\n+    Assert.assertNotEquals(path1, path2); // the general equality should not hold true\n+    Assert.assertTrue(Files.isSameFile(path1, path2)); // path equality holds", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg5MjI3OQ==", "bodyText": "For my understanding, why is .normalize() needed here?", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r538892279", "createdAt": "2020-12-08T23:39:20Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/cli2/Caches.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import com.google.common.annotations.VisibleForTesting;\n+import com.google.common.base.Charsets;\n+import java.nio.file.Path;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.Optional;\n+import javax.annotation.Nullable;\n+\n+/** A class to determine cache locations for any cli commands. */\n+public class Caches {\n+\n+  @Nullable private final Path baseImageCache;\n+  private final Path projectCache;\n+\n+  /**\n+   * Create a caches helper for cli cache locations.\n+   *\n+   * @param commonCliOptions cli options\n+   * @param contextRoot the context root, if a single file, use the parent directory\n+   * @return an instance of Caches with cli specific cache locations\n+   */\n+  public static Caches from(CommonCliOptions commonCliOptions, Path contextRoot) {\n+    Path defaultProjectCache =\n+        XdgDirectories.getCacheHome()\n+            .resolve(\"cli\")\n+            .resolve(\"projects\")\n+            .resolve(hashPath(contextRoot));\n+    return new Caches(\n+        commonCliOptions.getBaseImageCache().orElse(null),\n+        commonCliOptions.getProjectCache().orElse(defaultProjectCache));\n+  }\n+\n+  @VisibleForTesting\n+  static String hashPath(Path path) {\n+    try {\n+      byte[] hashedBytes =\n+          MessageDigest.getInstance(\"SHA-256\")\n+              .digest(path.toAbsolutePath().normalize().toString().getBytes(Charsets.UTF_8));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db286ca13c41014c2cb7bdd35167540182219029"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6e57c7a81113e601e5eda7d6b81002d011f990a", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d6e57c7a81113e601e5eda7d6b81002d011f990a", "committedDate": "2020-12-09T17:48:17Z", "message": "rename and adjust tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "253666273b835770cd2fabf35651e22bc90e023e", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/253666273b835770cd2fabf35651e22bc90e023e", "committedDate": "2020-12-09T18:07:39Z", "message": "use canonical path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NDg2MzE4", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#pullrequestreview-548486318", "createdAt": "2020-12-09T18:35:33Z", "commit": {"oid": "d6e57c7a81113e601e5eda7d6b81002d011f990a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxODozNTozM1rOICjiOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxODozNTozM1rOICjiOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU1MDI2Nw==", "bodyText": "Sorry missed this last time, we could make the naming a little more specific for these two variables?", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r539550267", "createdAt": "2020-12-09T18:35:33Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/test/java/com/google/cloud/tools/jib/cli/cli2/CacheDirectoriesTest.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static com.google.common.truth.Truth8.assertThat;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+import picocli.CommandLine;\n+\n+public class CacheDirectoriesTest {\n+\n+  @Rule public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+  @Test\n+  public void testCacheDirectories_defaults() {\n+    CommonCliOptions commonCliOptions =\n+        CommandLine.populateCommand(new CommonCliOptions(), \"-t\", \"ignored\");\n+    Path buildContext = Paths.get(\"some-context\");\n+    CacheDirectories cacheDirectories = CacheDirectories.from(commonCliOptions, buildContext);\n+\n+    assertThat(cacheDirectories.getBaseImageCache()).isEmpty();\n+    assertThat(cacheDirectories.getProjectCache())\n+        .isEqualTo(\n+            XdgDirectories.getCacheHome()\n+                .resolve(\"cli\")\n+                .resolve(\"projects\")\n+                .resolve(CacheDirectories.hashPath(Paths.get(\"some-context\"))));\n+  }\n+\n+  @Test\n+  public void testCacheDirectories_configuredValuesIgnoresBuildContext() {\n+    CommonCliOptions commonCliOptions =\n+        CommandLine.populateCommand(\n+            new CommonCliOptions(),\n+            \"-t=ignored\",\n+            \"--base-image-cache=test-base-image-cache\",\n+            \"--project-cache=test-project-cache\");\n+    CacheDirectories cacheDirectories =\n+        CacheDirectories.from(commonCliOptions, Paths.get(\"ignored\"));\n+\n+    assertThat(cacheDirectories.getBaseImageCache()).hasValue(Paths.get(\"test-base-image-cache\"));\n+    assertThat(cacheDirectories.getProjectCache()).isEqualTo(Paths.get(\"test-project-cache\"));\n+  }\n+\n+  @Test\n+  public void testHashPath_sameFileDifferentPaths() throws IOException {\n+    temporaryFolder.newFolder(\"ignored\");\n+    Path path1 = temporaryFolder.getRoot().toPath().resolve(\"ignored\").resolve(\"..\");\n+    Path path2 = temporaryFolder.getRoot().toPath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6e57c7a81113e601e5eda7d6b81002d011f990a"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65124777113368385864803e97d7d9b387b7d26b", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/65124777113368385864803e97d7d9b387b7d26b", "committedDate": "2020-12-09T20:38:52Z", "message": "naming"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NDMxODUz", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#pullrequestreview-549431853", "createdAt": "2020-12-10T17:24:12Z", "commit": {"oid": "65124777113368385864803e97d7d9b387b7d26b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNzoyNDoxMlrOIDUr5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNzoyNDoxMlrOIDUr5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM1NTU1OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @return an instance of Caches with cli specific cache locations\n          \n          \n            \n               * @return an instance of CacheDirectories with cli specific cache locations", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#discussion_r540355559", "createdAt": "2020-12-10T17:24:12Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/cli2/CacheDirectories.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.cli.cli2;\n+\n+import com.google.cloud.tools.jib.filesystem.XdgDirectories;\n+import com.google.common.annotations.VisibleForTesting;\n+import com.google.common.base.Charsets;\n+import java.io.IOException;\n+import java.nio.file.Path;\n+import java.security.MessageDigest;\n+import java.security.NoSuchAlgorithmException;\n+import java.util.Optional;\n+import javax.annotation.Nullable;\n+\n+/** A class to determine cache locations for any cli commands. */\n+public class CacheDirectories {\n+\n+  @Nullable private final Path baseImageCache;\n+  private final Path projectCache;\n+\n+  /**\n+   * Create a caches helper for cli cache locations.\n+   *\n+   * @param commonCliOptions cli options\n+   * @param contextRoot the context root, if a single file, use the parent directory, this context\n+   *     root must exist\n+   * @return an instance of Caches with cli specific cache locations", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65124777113368385864803e97d7d9b387b7d26b"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NDMyNTcz", "url": "https://github.com/GoogleContainerTools/jib/pull/2929#pullrequestreview-549432573", "createdAt": "2020-12-10T17:25:02Z", "commit": {"oid": "65124777113368385864803e97d7d9b387b7d26b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43dfbf3e3f29e6da62328196a4b991cbbbf0ccc7", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/43dfbf3e3f29e6da62328196a4b991cbbbf0ccc7", "committedDate": "2020-12-11T04:41:02Z", "message": "Update jib-cli/src/main/java/com/google/cloud/tools/jib/cli/cli2/CacheDirectories.java\n\nCo-authored-by: Mridula <66699525+mpeddada1@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4724, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}