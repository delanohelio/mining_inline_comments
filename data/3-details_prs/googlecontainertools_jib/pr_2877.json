{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMjk2Mzgz", "number": 2877, "title": "Give better error message on Jib CLI", "bodyText": "Sometimes, ex.getMessage() doesn't give information enough to understand that an exception occurred. For example, file-not-found I/O exception:\n$ jib --target=docker://foo build\n./jib.yaml\n$\n\nAlso, specifying a directory for -b doesn't give a good error message.\n$ jib --target=docker://foo -b /tmp build\njava.io.IOException: Is a directory\n at [Source: (org.apache.commons.text.io.StringSubstitutorReader); line: 1, column: 1]\n$\n\nI decided to give special treatment for checking a build file, as I think first time users will likely get into it a lot. (@mpeddada1 and I both got into this and had to spend a lot of time figuring out what happened.)\nI spent some time to write a test for logging in Build, but it required me to considerably refactor the class. It didn't seem worth only to be able to write tests, so eventually I reverted the tests.\nLastly, I think it's better to add the prefixes for ERROR and WARN logs to make them clear.", "createdAt": "2020-10-30T21:34:53Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2877", "merged": true, "mergeCommit": {"oid": "a720aa1fb9d86c3a7115544ee4e3d59602361e12"}, "closed": true, "closedAt": "2020-11-02T15:48:57Z", "author": {"login": "chanseokoh"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXrI2ugH2gAyNTEzMjk2MzgzOjExZWQyYjUyNmNlZTM3YzIxNjc4OWUyNzBjYTY4NTczYTlhMjNjYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYl308gFqTUyMTcwNTYxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "11ed2b526cee37c216789e270ca68573a9a23ca9", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/11ed2b526cee37c216789e270ca68573a9a23ca9", "committedDate": "2020-10-30T18:33:05Z", "message": "Fix Jib CLI logger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bf65ee5a4b2d3df70da679208e99e45ab4bfa49", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/7bf65ee5a4b2d3df70da679208e99e45ab4bfa49", "committedDate": "2020-10-30T18:33:31Z", "message": "minor cleanups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8930bc314b3bceb28c676f3f662a8f4c5205dcf9", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8930bc314b3bceb28c676f3f662a8f4c5205dcf9", "committedDate": "2020-10-30T18:37:28Z", "message": "Flip twoCursorUpJumping"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a420145583af7d1ce78d3d518f2a436c9a272fee", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/a420145583af7d1ce78d3d518f2a436c9a272fee", "committedDate": "2020-10-30T21:15:14Z", "message": "Output better error messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a34ea7d056f06cc7ddffd75045c6425499d9abd", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4a34ea7d056f06cc7ddffd75045c6425499d9abd", "committedDate": "2020-10-30T21:23:03Z", "message": "Improve error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c854368088d2f121808f7eff45001ab244a0fef", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/0c854368088d2f121808f7eff45001ab244a0fef", "committedDate": "2020-10-30T21:26:11Z", "message": "Imporve error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fe3221d5be0ca9036fcfb3f3e69c61d99d6a713", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/9fe3221d5be0ca9036fcfb3f3e69c61d99d6a713", "committedDate": "2020-11-02T14:24:06Z", "message": "Merge remote-tracking branch 'origin/master' into jib-cli-error-output"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjg0MDUz", "url": "https://github.com/GoogleContainerTools/jib/pull/2877#pullrequestreview-521684053", "createdAt": "2020-11-02T14:36:13Z", "commit": {"oid": "9fe3221d5be0ca9036fcfb3f3e69c61d99d6a713"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNDozNjoxM1rOHsG-2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNDozNjoxM1rOHsG-2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjAxMzc4NQ==", "bodyText": "Maybe we can make the error message a bit more specific - \"The Build File YAML either does not exist or cannot be opened for reading\" since isReadable checks for both.", "url": "https://github.com/GoogleContainerTools/jib/pull/2877#discussion_r516013785", "createdAt": "2020-11-02T14:36:13Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/cli2/Build.java", "diffHunk": "@@ -40,18 +43,29 @@ public Integer call() {\n     try {\n       ConsoleLogger logger =\n           CliLogger.newLogger(globalOptions.getVerbosity(), globalOptions.getConsoleOutput());\n+\n+      Path buildFile = globalOptions.getBuildFile();\n+      if (!Files.isReadable(buildFile)) {\n+        logger.log(Level.ERROR, \"Cannot open Build File YAML: \" + buildFile);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9fe3221d5be0ca9036fcfb3f3e69c61d99d6a713"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a97460842658ac1af65196e92548fed7295f47a", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/5a97460842658ac1af65196e92548fed7295f47a", "committedDate": "2020-11-02T14:37:58Z", "message": "Update error message for isReadable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNzA1NjE5", "url": "https://github.com/GoogleContainerTools/jib/pull/2877#pullrequestreview-521705619", "createdAt": "2020-11-02T14:58:53Z", "commit": {"oid": "5a97460842658ac1af65196e92548fed7295f47a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4861, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}