{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NTI2MDUz", "number": 2292, "title": "Allow users to configure skaffold data exported from jib to skaffold", "bodyText": "Implementation of proposal at: https://github.com/GoogleContainerTools/jib/blob/master/proposals/skaffold_config.md", "createdAt": "2020-02-12T20:50:47Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2292", "merged": true, "mergeCommit": {"oid": "d6bcf7710bbac540920905a2f28ecf4bdd7b9ee4"}, "closed": true, "closedAt": "2020-02-21T19:58:49Z", "author": {"login": "loosebazooka"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDtOqgABqjMwMzI1MjU4NjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGiPoAAH2gAyMzc0NTI2MDUzOjk4ZTUwOThmNzUyNmNkY2JhMDQ1ZWVjZDgxMTY2OWQ3YmFhZjIwN2M=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "732456dd87e8520b80fc87568539ccf94d1aab9d", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/732456dd87e8520b80fc87568539ccf94d1aab9d", "committedDate": "2020-02-12T20:50:06Z", "message": "Allow gradle users to configure skaffold data"}, "afterCommit": {"oid": "2a54dc3a64cbac7b65f738379f8d23e81c02aa02", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/2a54dc3a64cbac7b65f738379f8d23e81c02aa02", "committedDate": "2020-02-12T21:29:26Z", "message": "Allow gradle users to configure skaffold data"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a54dc3a64cbac7b65f738379f8d23e81c02aa02", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/2a54dc3a64cbac7b65f738379f8d23e81c02aa02", "committedDate": "2020-02-12T21:29:26Z", "message": "Allow gradle users to configure skaffold data"}, "afterCommit": {"oid": "f4fa3fead7651c8e4f86164575df204bae19b921", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/f4fa3fead7651c8e4f86164575df204bae19b921", "committedDate": "2020-02-12T22:03:44Z", "message": "Allow gradle users to configure skaffold data"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4fa3fead7651c8e4f86164575df204bae19b921", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/f4fa3fead7651c8e4f86164575df204bae19b921", "committedDate": "2020-02-12T22:03:44Z", "message": "Allow gradle users to configure skaffold data"}, "afterCommit": {"oid": "8224c604aa6689ad4d33b14bb3c2c9ada38d6c0e", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8224c604aa6689ad4d33b14bb3c2c9ada38d6c0e", "committedDate": "2020-02-12T22:28:38Z", "message": "add some basic tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5OTMyMjc2", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-359932276", "createdAt": "2020-02-17T19:26:39Z", "commit": {"oid": "3fa279a0bac5f3972d6b0376695df63b03a6552a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxOToyNjozOVrOFquEZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxOToyNzo1NVrOFquFzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDMzOTMwMw==", "bodyText": "Does this comment apply when we use Path?", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380339303", "createdAt": "2020-02-17T19:26:39Z", "author": {"login": "briandealwis"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldSyncParameters.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import javax.inject.Inject;\n+import org.gradle.api.Project;\n+import org.gradle.api.tasks.Internal;\n+\n+public class SkaffoldSyncParameters {\n+  private final Project project;\n+\n+  private Set<Path> excludes = Collections.emptySet();\n+\n+  @Inject\n+  public SkaffoldSyncParameters(Project project) {\n+    this.project = project;\n+  }\n+\n+  /**\n+   * Get the excludes directive for sync functionality in skaffold.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getExcludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3fa279a0bac5f3972d6b0376695df63b03a6552a"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDMzOTUwMA==", "bodyText": "Does this apply with Path too? (I don't see any String?)", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380339500", "createdAt": "2020-02-17T19:27:23Z", "author": {"login": "briandealwis"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldWatchParameters.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import javax.inject.Inject;\n+import org.gradle.api.Project;\n+import org.gradle.api.tasks.Internal;\n+\n+public class SkaffoldWatchParameters {\n+\n+  private final Project project;\n+\n+  private Set<Path> buildIncludes = Collections.emptySet();\n+  private Set<Path> includes = Collections.emptySet();\n+  private Set<Path> excludes = Collections.emptySet();\n+\n+  @Inject\n+  public SkaffoldWatchParameters(Project project) {\n+    this.project = project;\n+  }\n+\n+  /**\n+   * A set of absolute paths to include with skaffold watching.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getBuildIncludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.\n+    return buildIncludes;\n+  }\n+\n+  /**\n+   * Sets includes. {@code includes} can be any suitable object describing file paths convertible by\n+   * {@link Project#files} (such as {@link File}, {@code List<File>}, or {@code List<String>}).\n+   *\n+   * @param paths paths to set on includes\n+   */\n+  public void setBuildIncludes(Object paths) {\n+    this.buildIncludes =\n+        project\n+            .files(paths)\n+            .getFiles()\n+            .stream()\n+            .map(File::toPath)\n+            .map(Path::toAbsolutePath)\n+            .collect(Collectors.toSet());\n+  }\n+\n+  /**\n+   * A set of absolute paths to include with skaffold watching.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getIncludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3fa279a0bac5f3972d6b0376695df63b03a6552a"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDMzOTY2MA==", "bodyText": "Does this apply to Path too?  I don't see a String?", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380339660", "createdAt": "2020-02-17T19:27:55Z", "author": {"login": "briandealwis"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldWatchParameters.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import javax.inject.Inject;\n+import org.gradle.api.Project;\n+import org.gradle.api.tasks.Internal;\n+\n+public class SkaffoldWatchParameters {\n+\n+  private final Project project;\n+\n+  private Set<Path> buildIncludes = Collections.emptySet();\n+  private Set<Path> includes = Collections.emptySet();\n+  private Set<Path> excludes = Collections.emptySet();\n+\n+  @Inject\n+  public SkaffoldWatchParameters(Project project) {\n+    this.project = project;\n+  }\n+\n+  /**\n+   * A set of absolute paths to include with skaffold watching.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getBuildIncludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.\n+    return buildIncludes;\n+  }\n+\n+  /**\n+   * Sets includes. {@code includes} can be any suitable object describing file paths convertible by\n+   * {@link Project#files} (such as {@link File}, {@code List<File>}, or {@code List<String>}).\n+   *\n+   * @param paths paths to set on includes\n+   */\n+  public void setBuildIncludes(Object paths) {\n+    this.buildIncludes =\n+        project\n+            .files(paths)\n+            .getFiles()\n+            .stream()\n+            .map(File::toPath)\n+            .map(Path::toAbsolutePath)\n+            .collect(Collectors.toSet());\n+  }\n+\n+  /**\n+   * A set of absolute paths to include with skaffold watching.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getIncludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.\n+    return includes;\n+  }\n+\n+  /**\n+   * Sets includes. {@code includes} can be any suitable object describing file paths convertible by\n+   * {@link Project#files} (such as {@link File}, {@code List<File>}, or {@code List<String>}).\n+   *\n+   * @param paths paths to set on includes\n+   */\n+  public void setIncludes(Object paths) {\n+    this.includes =\n+        project\n+            .files(paths)\n+            .getFiles()\n+            .stream()\n+            .map(File::toPath)\n+            .map(Path::toAbsolutePath)\n+            .collect(Collectors.toSet());\n+  }\n+\n+  /**\n+   * A set of absolute paths to exclude from skaffold watching.\n+   *\n+   * @return a set of absolute paths\n+   */\n+  @Internal\n+  public Set<Path> getExcludes() {\n+    // Gradle warns about @Input annotations on File objects, so we have to expose a getter for a\n+    // String to make them go away.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3fa279a0bac5f3972d6b0376695df63b03a6552a"}, "originalPosition": 107}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDY2OTI4", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-360466928", "createdAt": "2020-02-18T16:06:44Z", "commit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjowNjo0NFrOFrIeTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjoxMTo1NlrOFrIsVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc3MTkxNg==", "bodyText": "Javadoc", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380771916", "createdAt": "2020-02-18T16:06:44Z", "author": {"login": "TadCordle"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldParameters.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import com.google.common.base.Preconditions;\n+import javax.inject.Inject;\n+import org.gradle.api.Action;\n+import org.gradle.api.Project;\n+import org.gradle.api.model.ObjectFactory;\n+import org.gradle.api.tasks.Nested;\n+\n+public class SkaffoldParameters {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc3MzkxMQ==", "bodyText": "Javadoc", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380773911", "createdAt": "2020-02-18T16:09:32Z", "author": {"login": "TadCordle"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldSyncParameters.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import javax.inject.Inject;\n+import org.gradle.api.Project;\n+import org.gradle.api.tasks.Internal;\n+\n+public class SkaffoldSyncParameters {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc3NTUxMA==", "bodyText": "Javadoc", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380775510", "createdAt": "2020-02-18T16:11:56Z", "author": {"login": "TadCordle"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SkaffoldWatchParameters.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.gradle.skaffold;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import javax.inject.Inject;\n+import org.gradle.api.Project;\n+import org.gradle.api.tasks.Internal;\n+\n+public class SkaffoldWatchParameters {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNTMxNzM2", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-360531736", "createdAt": "2020-02-18T17:28:30Z", "commit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNzoyODozMFrOFrLnKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNzoyODozMFrOFrLnKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgyMzMzOQ==", "bodyText": "Is this a debug print or is it actually needed?", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380823339", "createdAt": "2020-02-18T17:28:30Z", "author": {"login": "TadCordle"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/skaffold/FilesMojoV2.java", "diffHunk": "@@ -207,6 +216,8 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n     }\n \n     try {\n+      System.out.println(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNTM1OTAw", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-360535900", "createdAt": "2020-02-18T17:34:28Z", "commit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNzozNDoyOFrOFrL0LQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNzo1ODoxNFrOFrMmVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgyNjY2OQ==", "bodyText": "Javadoc, probably for the inner classes too.", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380826669", "createdAt": "2020-02-18T17:34:28Z", "author": {"login": "TadCordle"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/skaffold/SkaffoldConfiguration.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven.skaffold;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.maven.plugins.annotations.Parameter;\n+\n+public class SkaffoldConfiguration {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgzOTUxMQ==", "bodyText": "Q: Why not just new HashSet<>()?", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380839511", "createdAt": "2020-02-18T17:58:14Z", "author": {"login": "TadCordle"}, "path": "jib-plugins-common/src/main/java/com/google/cloud/tools/jib/plugins/common/PluginConfigurationProcessor.java", "diffHunk": "@@ -213,18 +216,39 @@ public static String getSkaffoldSyncMap(\n             .getLayerEntries()\n             .stream()\n             .filter(layerEntry -> Files.isRegularFile(layerEntry.getSourceFile()))\n+            .filter(\n+                layerEntry ->\n+                    !excludesExpanded.contains(layerEntry.getSourceFile().toAbsolutePath()))\n             .forEach(syncMap::addGenerated);\n       } else { // this is a direct layer\n         layer\n             .getLayerEntries()\n             .stream()\n             .filter(layerEntry -> Files.isRegularFile(layerEntry.getSourceFile()))\n+            .filter(\n+                layerEntry ->\n+                    !excludesExpanded.contains(layerEntry.getSourceFile().toAbsolutePath()))\n             .forEach(syncMap::addDirect);\n       }\n     }\n     return syncMap.getJsonString();\n   }\n \n+  /** Expand directories to files (excludes directory paths). */\n+  static Set<Path> getAllFiles(Set<Path> paths) throws IOException {\n+    Set<Path> expanded = Sets.newHashSet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNTU1MjM5", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-360555239", "createdAt": "2020-02-18T18:03:35Z", "commit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODowMzozNVrOFrMw6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQyMDoxNToxNVrOFrQ8ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg0MjIxNw==", "bodyText": "This should work.\n          skaffold.sync(sync -> sync.setExcludes(fakeProject.files(\"sync1\", \"sync2\")));", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380842217", "createdAt": "2020-02-18T18:03:35Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/test/java/com/google/cloud/tools/jib/gradle/JibExtensionTest.java", "diffHunk": "@@ -240,6 +242,38 @@ public void testOutputFiles() {\n         testJibExtension.getOutputPaths().getTarPath());\n   }\n \n+  @Test\n+  public void testSkaffold() {\n+    testJibExtension.skaffold(\n+        skaffold -> {\n+          skaffold.sync(\n+              sync -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad19dd61fb2dea11aca7fc89c8f9f878859378fc"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxMDczMA==", "bodyText": "I think we can delete this field. It's not being used, since we parse this explicitly in FilesMojoV2.", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r380910730", "createdAt": "2020-02-18T20:15:15Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/skaffold/SkaffoldConfiguration.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven.skaffold;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.maven.plugins.annotations.Parameter;\n+\n+/** Skaffold specific Jib plugin configuration options. */\n+public class SkaffoldConfiguration {\n+\n+  /** Skaffold specific Jib plugin configuration for files to watch. */\n+  public static class Watch {\n+    @Parameter List<File> buildIncludes = Collections.emptyList();\n+    @Parameter List<File> includes = Collections.emptyList();\n+    @Parameter List<File> excludes = Collections.emptyList();\n+  }\n+\n+  /** Skaffold specific Jib plugin configuration for files to sync. */\n+  public static class Sync {\n+    @Parameter List<File> excludes = Collections.emptyList();\n+  }\n+\n+  @Parameter Watch watch = new Watch();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b27be3fdbaf8947816287d24268090559ef4f9d9"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMjE0NTc1", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-362214575", "createdAt": "2020-02-20T20:35:25Z", "commit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMDozNToyNVrOFsiRHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMDozNToyNVrOFsiRHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI0MzEwMg==", "bodyText": "So where do includes come in?", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r382243102", "createdAt": "2020-02-20T20:35:25Z", "author": {"login": "briandealwis"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/skaffold/SyncMapTask.java", "diffHunk": "@@ -77,7 +77,10 @@ public void listFilesAndTargets() {\n \n       try {\n         String syncMapJson =\n-            PluginConfigurationProcessor.getSkaffoldSyncMap(configuration, projectProperties);\n+            PluginConfigurationProcessor.getSkaffoldSyncMap(\n+                configuration,\n+                projectProperties,\n+                jibExtension.getSkaffold().getSync().getExcludes());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMjE4MjE2", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-362218216", "createdAt": "2020-02-20T20:41:54Z", "commit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMjIwMDg3", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-362220087", "createdAt": "2020-02-20T20:45:06Z", "commit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMDo0NTowNlrOFsih8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMDo0NTowNlrOFsih8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI0NzQwOA==", "bodyText": "Hmm, I'm wondering if this works with paths where the project ancestry has symlinks.", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r382247408", "createdAt": "2020-02-20T20:45:06Z", "author": {"login": "briandealwis"}, "path": "jib-plugins-common/src/main/java/com/google/cloud/tools/jib/plugins/common/PluginConfigurationProcessor.java", "diffHunk": "@@ -213,18 +215,39 @@ public static String getSkaffoldSyncMap(\n             .getLayerEntries()\n             .stream()\n             .filter(layerEntry -> Files.isRegularFile(layerEntry.getSourceFile()))\n+            .filter(\n+                layerEntry ->\n+                    !excludesExpanded.contains(layerEntry.getSourceFile().toAbsolutePath()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abd7b41d43b4bf223c95432bcdb6cc0d0068af75", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/abd7b41d43b4bf223c95432bcdb6cc0d0068af75", "committedDate": "2020-02-18T20:41:33Z", "message": "formatting and comments"}, "afterCommit": {"oid": "4b7ff2b66845866ddca7970bab62c67727144dcb", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4b7ff2b66845866ddca7970bab62c67727144dcb", "committedDate": "2020-02-20T22:08:00Z", "message": "update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1664f96063025c51545d077bd56c61c8f6ecd576", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/1664f96063025c51545d077bd56c61c8f6ecd576", "committedDate": "2020-02-20T22:40:51Z", "message": "Allow gradle users to configure skaffold data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d41081c656c344e8c1661e502f4ecdf59bbfa678", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d41081c656c344e8c1661e502f4ecdf59bbfa678", "committedDate": "2020-02-20T22:40:51Z", "message": "add some basic tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae2d998c002b04b23f49bc8101a4d5aff0b819cb", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/ae2d998c002b04b23f49bc8101a4d5aff0b819cb", "committedDate": "2020-02-20T22:40:51Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4878d61623aab066e4d76c29029eac5e384066e", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/b4878d61623aab066e4d76c29029eac5e384066e", "committedDate": "2020-02-20T22:40:51Z", "message": "more tests + maven configs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e803e757d30ca8b29c942ccd907d11231a6642c", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4e803e757d30ca8b29c942ccd907d11231a6642c", "committedDate": "2020-02-20T22:40:51Z", "message": "windows file paths"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aafd63aafde54d65fe702ab350aa93488560d26d", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/aafd63aafde54d65fe702ab350aa93488560d26d", "committedDate": "2020-02-20T22:40:51Z", "message": "More testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f634d0242bbb12ed45a4fe798b5b7a69af2d5a5", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/0f634d0242bbb12ed45a4fe798b5b7a69af2d5a5", "committedDate": "2020-02-20T22:40:51Z", "message": "Remove unnecessary comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14edff9ff9d0c6a40c3f35c8dfe97042cc0a68ca", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/14edff9ff9d0c6a40c3f35c8dfe97042cc0a68ca", "committedDate": "2020-02-20T22:40:51Z", "message": "fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e1339415732240d4086b29a290056d5572264d4", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/3e1339415732240d4086b29a290056d5572264d4", "committedDate": "2020-02-20T22:40:51Z", "message": "formatting and comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29f21b9aba5ae5a65ea35bcab00953ee76a2b5ec", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/29f21b9aba5ae5a65ea35bcab00953ee76a2b5ec", "committedDate": "2020-02-20T22:40:51Z", "message": "update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6227754f2f2c4eff68e8ce69f7af2b6a7eb344c6", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/6227754f2f2c4eff68e8ce69f7af2b6a7eb344c6", "committedDate": "2020-02-20T22:42:49Z", "message": "rebase with master and update checkstyle errors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b7ff2b66845866ddca7970bab62c67727144dcb", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4b7ff2b66845866ddca7970bab62c67727144dcb", "committedDate": "2020-02-20T22:08:00Z", "message": "update docs"}, "afterCommit": {"oid": "6227754f2f2c4eff68e8ce69f7af2b6a7eb344c6", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/6227754f2f2c4eff68e8ce69f7af2b6a7eb344c6", "committedDate": "2020-02-20T22:42:49Z", "message": "rebase with master and update checkstyle errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cac13c5d9dd8044b3de3138fe211c90783e43569", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/cac13c5d9dd8044b3de3138fe211c90783e43569", "committedDate": "2020-02-20T22:53:38Z", "message": "revert changes from readme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4a6ed8d5a52b1b9512f506db9f6eac6b565dada", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d4a6ed8d5a52b1b9512f506db9f6eac6b565dada", "committedDate": "2020-02-20T22:57:42Z", "message": "wording"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNzMzODY5", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#pullrequestreview-362733869", "createdAt": "2020-02-21T15:59:55Z", "commit": {"oid": "d4a6ed8d5a52b1b9512f506db9f6eac6b565dada"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNTo1OTo1NVrOFs741w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNjowMDoxMVrOFs75Yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY2Mjg3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - New skaffold configuration options that modify how jib's build config is presetned to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):\n          \n          \n            \n            - New skaffold configuration options that modify how jib's build config is presented to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r382662871", "createdAt": "2020-02-21T15:59:55Z", "author": {"login": "TadCordle"}, "path": "jib-gradle-plugin/CHANGELOG.md", "diffHunk": "@@ -5,6 +5,11 @@ All notable changes to this project will be documented in this file.\n \n ### Added\n - Additionally reads credentials from `~/.docker/.dockerconfigjson` and legacy Docker config (`~/.docker/.dockercfg`). Also searches for `$HOME/.docker/*` (in addition to current `System.get(\"user.home\")/.docker/*`). This may help retrieve credentials, for example, on Kubernetes. ([#2260](https://github.com/GoogleContainerTools/jib/issues/2260))\n+- New skaffold configuration options that modify how jib's build config is presetned to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4a6ed8d5a52b1b9512f506db9f6eac6b565dada"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY2MzAxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - New skaffold configuration options that modify how jib's build config is presetned to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):\n          \n          \n            \n            - New skaffold configuration options that modify how jib's build config is presented to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):", "url": "https://github.com/GoogleContainerTools/jib/pull/2292#discussion_r382663011", "createdAt": "2020-02-21T16:00:11Z", "author": {"login": "TadCordle"}, "path": "jib-maven-plugin/CHANGELOG.md", "diffHunk": "@@ -5,6 +5,11 @@ All notable changes to this project will be documented in this file.\n \n ### Added\n - Additionally reads credentials from `~/.docker/.dockerconfigjson` and legacy Docker config (`~/.docker/.dockercfg`). Also searches for `$HOME/.docker/*` (in addition to current `System.get(\"user.home\")/.docker/*`). This may help retrieve credentials, for example, on Kubernetes. ([#2260](https://github.com/GoogleContainerTools/jib/issues/2260))\n+- New skaffold configuration options that modify how jib's build config is presetned to skaffold ([#2292](https://github.com/GoogleContainerTools/jib/pull/2292)):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4a6ed8d5a52b1b9512f506db9f6eac6b565dada"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dc1b8d352444ec8ea5380043fb39043d265e539", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/0dc1b8d352444ec8ea5380043fb39043d265e539", "committedDate": "2020-02-21T16:23:20Z", "message": "Update jib-maven-plugin/CHANGELOG.md\n\nCo-Authored-By: Tad Cordle <tcordle@google.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98e5098f7526cdcba045eecd811669d7baaf207c", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/98e5098f7526cdcba045eecd811669d7baaf207c", "committedDate": "2020-02-21T16:23:28Z", "message": "Update jib-gradle-plugin/CHANGELOG.md\n\nCo-Authored-By: Tad Cordle <tcordle@google.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 358, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}