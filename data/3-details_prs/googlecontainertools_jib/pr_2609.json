{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NDMxODc5", "number": 2609, "title": "Convert most collections to empty instead of optional", "bodyText": "entrypoint and cmd are still optional as we have to\ndifferentiate between the user trying to erase a\nbase image value vs not setting anything.\n\nDoing some more thinking and reading about this (#2598 (comment)). It seems like using optional for collections is probably not great, except in the case of entrypoint and cmd.", "createdAt": "2020-07-23T01:18:18Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2609", "merged": true, "mergeCommit": {"oid": "91ecc03c31b1d62bf7df44844af9293f241ecd1f"}, "closed": true, "closedAt": "2020-07-24T02:44:01Z", "author": {"login": "loosebazooka"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3k9qVgH2gAyNDU1NDMxODc5OjNlZjY1ZDQ3YjRiZTZiZDE0MWI2MTc5NjlkMDNlYTQ2ODJjMzkxMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3yM5-AFqTQ1NDMxMjcxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3ef65d47b4be6bd141b617969d03ea4682c39125", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/3ef65d47b4be6bd141b617969d03ea4682c39125", "committedDate": "2020-07-23T01:15:51Z", "message": "Convert most collections to empty instead of optional\n\n- entrypoint and cmd are still optional as we have to\n  differentiate between the user trying to erase a\n  base image value vs not setting anything."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MTgxMTQ0", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#pullrequestreview-454181144", "createdAt": "2020-07-23T14:20:48Z", "commit": {"oid": "3ef65d47b4be6bd141b617969d03ea4682c39125"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDoyMDo0OFrOG2M1Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDoyMzo1NVrOG2M-JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ4NjUzMA==", "bodyText": "This confuses me. It says \"can be null\" and then \"set to empty\". Does \"empty\" mean an empty list? And what exactly \"override\" means?", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#discussion_r459486530", "createdAt": "2020-07-23T14:20:48Z", "author": {"login": "chanseokoh"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/BuildFileSpec.java", "diffHunk": "@@ -66,12 +68,14 @@\n   @Nullable private BaseImageSpec from;\n   @Nullable private Instant creationTime;\n   @Nullable private ImageFormat format;\n-  @Nullable private Map<String, String> environment;\n-  @Nullable private Map<String, String> labels;\n-  @Nullable private Set<AbsoluteUnixPath> volumes;\n-  @Nullable private Set<Port> exposedPorts;\n+  private Map<String, String> environment;\n+  private Map<String, String> labels;\n+  private Set<AbsoluteUnixPath> volumes;\n+  private Set<Port> exposedPorts;\n   @Nullable private String user;\n   @Nullable private AbsoluteUnixPath workingDirectory;\n+  // these two specific collection can be null as they can be set to empty to override\n+  // the base image", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef65d47b4be6bd141b617969d03ea4682c39125"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ4ODgwNQ==", "bodyText": "Use of ImmutableMap makes me wonder if it is possible to make all the fields of the class final? (Although using final on all the fields doesn't make this class an immutable one, but there is no reason not to do so if possible.) Or, is it not feasible due to JSON parsing?", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#discussion_r459488805", "createdAt": "2020-07-23T14:23:55Z", "author": {"login": "chanseokoh"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/BuildFileSpec.java", "diffHunk": "@@ -124,14 +128,13 @@ public BuildFileSpec(\n     if (format != null) {\n       this.format = ImageFormat.valueOf(format);\n     }\n-    this.environment = environment;\n-    this.labels = labels;\n-    if (volumes != null) {\n-      this.volumes = volumes.stream().map(AbsoluteUnixPath::get).collect(Collectors.toSet());\n-    }\n-    if (exposedPorts != null) {\n-      this.exposedPorts = Ports.parse(exposedPorts);\n-    }\n+    this.environment = (environment == null) ? ImmutableMap.of() : environment;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef65d47b4be6bd141b617969d03ea4682c39125"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d401248c9eea2787657acfaa66fc1bc1aca53c5", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/8d401248c9eea2787657acfaa66fc1bc1aca53c5", "committedDate": "2020-07-23T15:08:17Z", "message": "final and better comments on nullable list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "655fb972c6db24f18551aa8610b58d8c95bd00b0", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/655fb972c6db24f18551aa8610b58d8c95bd00b0", "committedDate": "2020-07-23T15:12:52Z", "message": "formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MjM5NjMy", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#pullrequestreview-454239632", "createdAt": "2020-07-23T15:15:54Z", "commit": {"oid": "655fb972c6db24f18551aa8610b58d8c95bd00b0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MjgwMzQ2", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#pullrequestreview-454280346", "createdAt": "2020-07-23T16:00:41Z", "commit": {"oid": "655fb972c6db24f18551aa8610b58d8c95bd00b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzEyNzEz", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#pullrequestreview-454312713", "createdAt": "2020-07-23T16:41:15Z", "commit": {"oid": "655fb972c6db24f18551aa8610b58d8c95bd00b0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjo0MToxNlrOG2SyVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjo0MToxNlrOG2SyVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU4NDA4Ng==", "bodyText": "Sorry, can we return ImmutableList here instead of List? Might be more secure to pass around immutable collections.", "url": "https://github.com/GoogleContainerTools/jib/pull/2609#discussion_r459584086", "createdAt": "2020-07-23T16:41:16Z", "author": {"login": "mpeddada1"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/PlatformSpec.java", "diffHunk": "@@ -85,15 +86,15 @@ public PlatformSpec(\n     return Optional.ofNullable(osVersion);\n   }\n \n-  public Optional<List<String>> getOsFeatures() {\n-    return Optional.ofNullable(osFeatures);\n+  public List<String> getOsFeatures() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "655fb972c6db24f18551aa8610b58d8c95bd00b0"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 119, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}