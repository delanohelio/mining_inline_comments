{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5OTY4MDg1", "number": 2337, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo0Nzo1MFrODpRf6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo0Nzo1MFrODpRf6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjA0OTA0OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo0Nzo1MFrOF4WTbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMTozODo1N1rOF4X0Iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYyOTk5OA==", "bodyText": "should this call setFileEntriesLayers with the final result of the stream.collect?", "url": "https://github.com/GoogleContainerTools/jib/pull/2337#discussion_r394629998", "createdAt": "2020-03-18T20:47:50Z", "author": {"login": "loosebazooka"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java", "diffHunk": "@@ -167,36 +170,82 @@ public JibContainerBuilder addLayer(List<Path> files, String pathInContainer) th\n   /**\n    * Adds a layer (defined by a {@link LayerConfiguration}).\n    *\n+   * <p>Deprecated. Use {@link #addFileEntriesLayer(FileEntriesLayer)}.\n+   *\n    * @param layerConfiguration the {@link LayerConfiguration}\n    * @return this\n    */\n+  @Deprecated\n   public JibContainerBuilder addLayer(LayerConfiguration layerConfiguration) {\n-    layerConfigurations.add(layerConfiguration);\n+    layerConfigurations.add(layerConfiguration.toFileEntriesLayer());\n+    return this;\n+  }\n+\n+  /**\n+   * Adds a layer (defined by a {@link FileEntriesLayer}).\n+   *\n+   * @param layer the {@link FileEntriesLayer}\n+   * @return this\n+   */\n+  public JibContainerBuilder addFileEntriesLayer(FileEntriesLayer layer) {\n+    layerConfigurations.add(layer);\n     return this;\n   }\n \n   /**\n    * Sets the layers (defined by a list of {@link LayerConfiguration}s). This replaces any\n    * previously-added layers.\n    *\n+   * <p>Deprecated. Use {@link #setFileEntriesLayers(List)}.\n+   *\n    * @param layerConfigurations the list of {@link LayerConfiguration}s\n    * @return this\n    */\n+  @Deprecated\n   public JibContainerBuilder setLayers(List<LayerConfiguration> layerConfigurations) {\n-    this.layerConfigurations = new ArrayList<>(layerConfigurations);\n+    this.layerConfigurations =\n+        layerConfigurations\n+            .stream()\n+            .map(LayerConfiguration::toFileEntriesLayer)\n+            .collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df357893136a8176419c1efd3943db6b8ef49863"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY1NDc1NQ==", "bodyText": "Makes sense. I just wanted to avoid creating an additional ArrayList in setFileEntriesLayers, but that's really negligible.\nAlso updated addLayer() to call addFileEntriesLayer() similarly.", "url": "https://github.com/GoogleContainerTools/jib/pull/2337#discussion_r394654755", "createdAt": "2020-03-18T21:38:57Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/api/JibContainerBuilder.java", "diffHunk": "@@ -167,36 +170,82 @@ public JibContainerBuilder addLayer(List<Path> files, String pathInContainer) th\n   /**\n    * Adds a layer (defined by a {@link LayerConfiguration}).\n    *\n+   * <p>Deprecated. Use {@link #addFileEntriesLayer(FileEntriesLayer)}.\n+   *\n    * @param layerConfiguration the {@link LayerConfiguration}\n    * @return this\n    */\n+  @Deprecated\n   public JibContainerBuilder addLayer(LayerConfiguration layerConfiguration) {\n-    layerConfigurations.add(layerConfiguration);\n+    layerConfigurations.add(layerConfiguration.toFileEntriesLayer());\n+    return this;\n+  }\n+\n+  /**\n+   * Adds a layer (defined by a {@link FileEntriesLayer}).\n+   *\n+   * @param layer the {@link FileEntriesLayer}\n+   * @return this\n+   */\n+  public JibContainerBuilder addFileEntriesLayer(FileEntriesLayer layer) {\n+    layerConfigurations.add(layer);\n     return this;\n   }\n \n   /**\n    * Sets the layers (defined by a list of {@link LayerConfiguration}s). This replaces any\n    * previously-added layers.\n    *\n+   * <p>Deprecated. Use {@link #setFileEntriesLayers(List)}.\n+   *\n    * @param layerConfigurations the list of {@link LayerConfiguration}s\n    * @return this\n    */\n+  @Deprecated\n   public JibContainerBuilder setLayers(List<LayerConfiguration> layerConfigurations) {\n-    this.layerConfigurations = new ArrayList<>(layerConfigurations);\n+    this.layerConfigurations =\n+        layerConfigurations\n+            .stream()\n+            .map(LayerConfiguration::toFileEntriesLayer)\n+            .collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYyOTk5OA=="}, "originalCommit": {"oid": "df357893136a8176419c1efd3943db6b8ef49863"}, "originalPosition": 86}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 547, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}