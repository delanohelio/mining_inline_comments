{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMjYxNjc5", "number": 473, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDowMTo0NlrOD-iukA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNzoyMzo1MVrOD_NmCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2OTA3MjgwOnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/SettingsFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDowMTo0NlrOGYtPDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTozODoyM1rOGZbj4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU2MDE0Mg==", "bodyText": "I tried to get the height of the view from binding. But it always returns 0 for the first time. Anyone knows why?\nThe reason we have to add top margin is to fit the preferences layout under the toolbar. There is no standard practice around how to add a toolbar because official docs recommend using the PreferenceFragment within an Activity. In our case, the activity doesn't have a toolbar. Any guidelines or suggestions are most welcome!", "url": "https://github.com/google/ground-android/pull/473#discussion_r428560142", "createdAt": "2020-05-21T10:01:46Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/SettingsFragment.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+import android.content.Intent;\n+import android.net.Uri;\n+import android.os.Bundle;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.view.ViewGroup;\n+import android.widget.FrameLayout.LayoutParams;\n+import android.widget.Toast;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.preference.Preference;\n+import androidx.preference.Preference.OnPreferenceChangeListener;\n+import androidx.preference.Preference.OnPreferenceClickListener;\n+import androidx.preference.PreferenceFragmentCompat;\n+import com.google.android.gnd.MainActivity;\n+import com.google.android.gnd.R;\n+import com.google.android.gnd.databinding.SettingsFragBinding;\n+\n+/**\n+ * Fragment containing app preferences saved as shared preferences.\n+ *\n+ * <p>NOTE: It uses {@link PreferenceFragmentCompat} instead of {@link\n+ * com.google.android.gnd.ui.common.AbstractFragment}, so dagger can't inject into it like it does\n+ * in other fragments.\n+ *\n+ * <p>TODO: Create dagger module and support injection into this fragment.\n+ */\n+public class SettingsFragment extends PreferenceFragmentCompat\n+    implements OnPreferenceChangeListener, OnPreferenceClickListener {\n+\n+  @Override\n+  public View onCreateView(\n+      @NonNull LayoutInflater inflater,\n+      @Nullable ViewGroup container,\n+      @Nullable Bundle savedInstanceState) {\n+    super.onCreateView(inflater, container, savedInstanceState);\n+    SettingsFragBinding binding = SettingsFragBinding.inflate(inflater, container, true);\n+    binding.setLifecycleOwner(this);\n+    ((MainActivity) getActivity()).setActionBar(binding.settingsToolbar, true);\n+    return super.onCreateView(inflater, container, savedInstanceState);\n+  }\n+\n+  @Override\n+  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n+    super.onViewCreated(view, savedInstanceState);\n+\n+    // TODO: Set dynamically by calculating the actual height of toolbar\n+    int topMargin = 108;\n+\n+    LayoutParams params = (LayoutParams) getListView().getLayoutParams();\n+    params.setMargins(0, topMargin, 0, 0);\n+    getListView().setLayoutParams(params);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ded70c0fea302f65eb0d3593dea764c3479d5c35"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxOTEzNw==", "bodyText": "Removed", "url": "https://github.com/google/ground-android/pull/473#discussion_r429319137", "createdAt": "2020-05-22T15:38:23Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/SettingsFragment.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+import android.content.Intent;\n+import android.net.Uri;\n+import android.os.Bundle;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.view.ViewGroup;\n+import android.widget.FrameLayout.LayoutParams;\n+import android.widget.Toast;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.preference.Preference;\n+import androidx.preference.Preference.OnPreferenceChangeListener;\n+import androidx.preference.Preference.OnPreferenceClickListener;\n+import androidx.preference.PreferenceFragmentCompat;\n+import com.google.android.gnd.MainActivity;\n+import com.google.android.gnd.R;\n+import com.google.android.gnd.databinding.SettingsFragBinding;\n+\n+/**\n+ * Fragment containing app preferences saved as shared preferences.\n+ *\n+ * <p>NOTE: It uses {@link PreferenceFragmentCompat} instead of {@link\n+ * com.google.android.gnd.ui.common.AbstractFragment}, so dagger can't inject into it like it does\n+ * in other fragments.\n+ *\n+ * <p>TODO: Create dagger module and support injection into this fragment.\n+ */\n+public class SettingsFragment extends PreferenceFragmentCompat\n+    implements OnPreferenceChangeListener, OnPreferenceClickListener {\n+\n+  @Override\n+  public View onCreateView(\n+      @NonNull LayoutInflater inflater,\n+      @Nullable ViewGroup container,\n+      @Nullable Bundle savedInstanceState) {\n+    super.onCreateView(inflater, container, savedInstanceState);\n+    SettingsFragBinding binding = SettingsFragBinding.inflate(inflater, container, true);\n+    binding.setLifecycleOwner(this);\n+    ((MainActivity) getActivity()).setActionBar(binding.settingsToolbar, true);\n+    return super.onCreateView(inflater, container, savedInstanceState);\n+  }\n+\n+  @Override\n+  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n+    super.onViewCreated(view, savedInstanceState);\n+\n+    // TODO: Set dynamically by calculating the actual height of toolbar\n+    int topMargin = 108;\n+\n+    LayoutParams params = (LayoutParams) getListView().getLayoutParams();\n+    params.setMargins(0, topMargin, 0, 0);\n+    getListView().setLayoutParams(params);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU2MDE0Mg=="}, "originalCommit": {"oid": "ded70c0fea302f65eb0d3593dea764c3479d5c35"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NjA5NTIzOnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/Keys.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNzoyMjozMlrOGZwNWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxOTowMTo1N1rOGZwsTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzQzMw==", "bodyText": "Can these be represented as String resources? Seems unfortunate we need to duplicate these keys in two places.", "url": "https://github.com/google/ground-android/pull/473#discussion_r429657433", "createdAt": "2020-05-24T17:22:32Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/Keys.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+/** These keys should match 1:1 in res/xml/preferences.xml. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY2NTM1OA==", "bodyText": "Sadly, no. preferences.xml only accepts string constants as inputs, not string resources.", "url": "https://github.com/google/ground-android/pull/473#discussion_r429665358", "createdAt": "2020-05-24T19:01:57Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/Keys.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+/** These keys should match 1:1 in res/xml/preferences.xml. */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzQzMw=="}, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NjA5NjA5OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/res/xml/preferences.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNzoyMzo1MVrOGZwNxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxOTowMjo1MFrOGZwsog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzU0Mg==", "bodyText": "Does the autoformat remove final CRs? Maybe they should be there?", "url": "https://github.com/google/ground-android/pull/473#discussion_r429657542", "createdAt": "2020-05-24T17:23:51Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/res/xml/preferences.xml", "diffHunk": "@@ -0,0 +1,53 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<!--\n+  ~ Copyright 2020 Google LLC\n+  ~\n+  ~ Licensed under the Apache License, Version 2.0 (the \"License\");\n+  ~ you may not use this file except in compliance with the License.\n+  ~ You may obtain a copy of the License at\n+  ~\n+  ~     https://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  -->\n+\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\">\n+\n+  <PreferenceCategory\n+    app:key=\"general_category\"\n+    app:title=\"General\">\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"upload_media\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Upload media\" />\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"offline_areas\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Offline areas download\" />\n+\n+  </PreferenceCategory>\n+\n+  <PreferenceCategory\n+    app:key=\"help_category\"\n+    app:title=\"Help\">\n+\n+    <Preference\n+      app:key=\"visit_website\"\n+      app:summary=\"@string/ground_website\"\n+      app:title=\"Visit website\" />\n+\n+    <Preference\n+      app:key=\"feedback\"\n+      app:summary=\"Report technical issues or suggest new features\"\n+      app:title=\"Send feedback\" />\n+\n+  </PreferenceCategory>\n+\n+</PreferenceScreen>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY2NTQ0Mg==", "bodyText": "I always forget about this. Thanks!\nMaybe there is a checkstyle or pmd rule for it.", "url": "https://github.com/google/ground-android/pull/473#discussion_r429665442", "createdAt": "2020-05-24T19:02:50Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/res/xml/preferences.xml", "diffHunk": "@@ -0,0 +1,53 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<!--\n+  ~ Copyright 2020 Google LLC\n+  ~\n+  ~ Licensed under the Apache License, Version 2.0 (the \"License\");\n+  ~ you may not use this file except in compliance with the License.\n+  ~ You may obtain a copy of the License at\n+  ~\n+  ~     https://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  -->\n+\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\">\n+\n+  <PreferenceCategory\n+    app:key=\"general_category\"\n+    app:title=\"General\">\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"upload_media\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Upload media\" />\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"offline_areas\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Offline areas download\" />\n+\n+  </PreferenceCategory>\n+\n+  <PreferenceCategory\n+    app:key=\"help_category\"\n+    app:title=\"Help\">\n+\n+    <Preference\n+      app:key=\"visit_website\"\n+      app:summary=\"@string/ground_website\"\n+      app:title=\"Visit website\" />\n+\n+    <Preference\n+      app:key=\"feedback\"\n+      app:summary=\"Report technical issues or suggest new features\"\n+      app:title=\"Send feedback\" />\n+\n+  </PreferenceCategory>\n+\n+</PreferenceScreen>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzU0Mg=="}, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2456, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}