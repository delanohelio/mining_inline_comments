{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MzM3NzM4", "number": 385, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjoyOTo0OVrODpMAXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjozODo0N1rODpMOMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NTE0OTA4OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjoyOTo0OVrOF4NMsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjozNDozN1rOF4NZPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4MDgxOA==", "bodyText": "I'm guessing we can't use this::toMapPins here because it's a static method? gtk!", "url": "https://github.com/google/ground-android/pull/385#discussion_r394480818", "createdAt": "2020-03-18T16:29:49Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "diffHunk": "@@ -78,12 +81,13 @@\n     // TODO: Clear feature markers when project is deactivated.\n     // TODO: Since we depend on project stream from repo anyway, this transformation can be moved\n     // into the repo?\n-    this.features =\n+    this.mapPins =\n         LiveDataReactiveStreams.fromPublisher(\n             projectRepository\n                 .getActiveProjectOnceAndStream()\n                 .map(Loadable::value)\n-                .switchMap(this::getFeaturesStream));\n+                .switchMap(this::getFeaturesStream)\n+                .map(MapContainerViewModel::toMapPins));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3a75fd4c6fb18a500d53361ce8f5337502401d0"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4NDAzMQ==", "bodyText": "Right! It also makes it clear that a reference to the current instance is not passed to the method impliciltly", "url": "https://github.com/google/ground-android/pull/385#discussion_r394484031", "createdAt": "2020-03-18T16:34:37Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "diffHunk": "@@ -78,12 +81,13 @@\n     // TODO: Clear feature markers when project is deactivated.\n     // TODO: Since we depend on project stream from repo anyway, this transformation can be moved\n     // into the repo?\n-    this.features =\n+    this.mapPins =\n         LiveDataReactiveStreams.fromPublisher(\n             projectRepository\n                 .getActiveProjectOnceAndStream()\n                 .map(Loadable::value)\n-                .switchMap(this::getFeaturesStream));\n+                .switchMap(this::getFeaturesStream)\n+                .map(MapContainerViewModel::toMapPins));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4MDgxOA=="}, "originalCommit": {"oid": "f3a75fd4c6fb18a500d53361ce8f5337502401d0"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NTE1Mzg4OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjozMToxMFrOF4NP9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzowMzoxOVrOF4OlzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4MTY1Mg==", "bodyText": "Rename mapMarker to mapPin?", "url": "https://github.com/google/ground-android/pull/385#discussion_r394481652", "createdAt": "2020-03-18T16:31:10Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "diffHunk": "@@ -162,7 +179,7 @@ public void onMapDrag(Point newCameraPosition) {\n     }\n   }\n \n-  public void onMarkerClick(MapMarker mapMarker) {\n+  public void onMarkerClick(MapPin mapMarker) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3a75fd4c6fb18a500d53361ce8f5337502401d0"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUwMzYyOA==", "bodyText": "Good catch!", "url": "https://github.com/google/ground-android/pull/385#discussion_r394503628", "createdAt": "2020-03-18T17:03:19Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/mapcontainer/MapContainerViewModel.java", "diffHunk": "@@ -162,7 +179,7 @@ public void onMapDrag(Point newCameraPosition) {\n     }\n   }\n \n-  public void onMarkerClick(MapMarker mapMarker) {\n+  public void onMarkerClick(MapPin mapMarker) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4MTY1Mg=="}, "originalCommit": {"oid": "f3a75fd4c6fb18a500d53361ce8f5337502401d0"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NTE4NDQ5OnYy", "diffSide": "LEFT", "path": "gnd/src/main/java/com/google/android/gnd/ui/map/MapProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjozODo0N1rOF4Nj7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODozNzo1MVrOF4SIGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4Njc2Ng==", "bodyText": "The getViewport method didn't get ported over to the MapAdapter!  I'll need it for offlineareas. It was unused up to this PR tough, so I'm happy to reimplement. Just an FYI.", "url": "https://github.com/google/ground-android/pull/385#discussion_r394486766", "createdAt": "2020-03-18T16:38:47Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/map/MapProvider.java", "diffHunk": "@@ -32,36 +25,4 @@\n   Fragment getFragment();\n \n   Single<MapAdapter> getMapAdapter();\n-\n-  /**\n-   * Interface defining map interactions and events. This a separate class from {@link MapProvider}\n-   * so that it can be returned asynchronously by {@link MapProvider#getMapAdapter()} if necessary.\n-   */\n-  interface MapAdapter {\n-\n-    Observable<MapMarker> getMarkerClicks();\n-\n-    Observable<Point> getDragInteractions();\n-\n-    Observable<Point> getCameraPosition();\n-\n-    void enable();\n-\n-    void disable();\n-\n-    void moveCamera(Point point);\n-\n-    void moveCamera(Point point, float zoomLevel);\n-\n-    Point getCenter();\n-\n-    float getCurrentZoomLevel();\n-\n-    @SuppressLint(\"MissingPermission\")\n-    void enableCurrentLocationIndicator();\n-\n-    void updateMarkers(ImmutableSet<Feature> features);\n-\n-    LatLngBounds getViewport();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c89834addd438e03ffc4dab4ec50adc370cf6a2"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU2MTU2MA==", "bodyText": "Oops, sorry! Added it back!", "url": "https://github.com/google/ground-android/pull/385#discussion_r394561560", "createdAt": "2020-03-18T18:37:51Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/map/MapProvider.java", "diffHunk": "@@ -32,36 +25,4 @@\n   Fragment getFragment();\n \n   Single<MapAdapter> getMapAdapter();\n-\n-  /**\n-   * Interface defining map interactions and events. This a separate class from {@link MapProvider}\n-   * so that it can be returned asynchronously by {@link MapProvider#getMapAdapter()} if necessary.\n-   */\n-  interface MapAdapter {\n-\n-    Observable<MapMarker> getMarkerClicks();\n-\n-    Observable<Point> getDragInteractions();\n-\n-    Observable<Point> getCameraPosition();\n-\n-    void enable();\n-\n-    void disable();\n-\n-    void moveCamera(Point point);\n-\n-    void moveCamera(Point point, float zoomLevel);\n-\n-    Point getCenter();\n-\n-    float getCurrentZoomLevel();\n-\n-    @SuppressLint(\"MissingPermission\")\n-    void enableCurrentLocationIndicator();\n-\n-    void updateMarkers(ImmutableSet<Feature> features);\n-\n-    LatLngBounds getViewport();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4Njc2Ng=="}, "originalCommit": {"oid": "9c89834addd438e03ffc4dab4ec50adc370cf6a2"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2624, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}