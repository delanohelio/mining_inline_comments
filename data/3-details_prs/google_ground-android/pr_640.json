{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NTA2MDk1", "number": 640, "title": "[Code health] Fix unchecked instances of Optional.get()", "bodyText": "I split this out of #639 to make review easier. This should contain only instances where get() is called without isEmpty() or isPresent() being called in the same context. There are likely more - wondering if there's a PMD check for this?\n@dturner care to have a look-see?\n@shobhitagarwal1612 @scolsen FYI.", "createdAt": "2020-11-25T14:58:25Z", "url": "https://github.com/google/ground-android/pull/640", "merged": true, "mergeCommit": {"oid": "30461f48f701127d59aa95ca1506c82f327949b2"}, "closed": true, "closedAt": "2020-12-08T17:43:34Z", "author": {"login": "gino-m"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf_ll3AH2gAyNTI3NTA2MDk1OjdiNzVjYWE4YzY3N2NlNjQ3MmVkYmIwY2U0ZDg4YTQ2NGIwYzJjYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkNhcKAFqTU0NzQ1ODkxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7b75caa8c677ce6472edbb0ce4d88a464b0c2caf", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/7b75caa8c677ce6472edbb0ce4d88a464b0c2caf", "committedDate": "2020-11-25T14:53:58Z", "message": "Skip and log invalid Observations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22da5ef7e8c401cd83625e77b5fdec92b3db49b4", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/22da5ef7e8c401cd83625e77b5fdec92b3db49b4", "committedDate": "2020-11-25T14:56:41Z", "message": "Skip and log invalid Features"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a7ad6cc47abf0f3ed508d86cab888b65a71512a", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/9a7ad6cc47abf0f3ed508d86cab888b65a71512a", "committedDate": "2020-11-25T14:56:42Z", "message": "Handle missing formId"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "116a13822526b3ce33c0f9993e8557aabe935089", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/116a13822526b3ce33c0f9993e8557aabe935089", "committedDate": "2020-11-25T14:56:43Z", "message": "Handle missing user"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "964e7284ea6a97c5f0a1f8c5352e2715976fcfa5", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/964e7284ea6a97c5f0a1f8c5352e2715976fcfa5", "committedDate": "2020-11-25T15:02:52Z", "message": "Check for form in same context its used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9c02c3c6eb0cc5b4b2623a7c4c462ee73ae3f06", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/a9c02c3c6eb0cc5b4b2623a7c4c462ee73ae3f06", "committedDate": "2020-11-25T15:04:41Z", "message": "Merge branch 'master' into fix-optional-get"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "309f294892265de8cbcf45cfab577f3575492e9a", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/309f294892265de8cbcf45cfab577f3575492e9a", "committedDate": "2020-11-25T17:55:50Z", "message": "Extend RuntimeException instead of Error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52eba0a83f9016beffd50289cae8b9990bb7fa03", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/52eba0a83f9016beffd50289cae8b9990bb7fa03", "committedDate": "2020-11-25T17:56:12Z", "message": "Merge remote-tracking branch 'origin/fix-optional-get' into fix-optional-get"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0b1afe216d868f8bd33fbfe342ab529a60972bf", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/f0b1afe216d868f8bd33fbfe342ab529a60972bf", "committedDate": "2020-11-25T18:31:41Z", "message": "Merge branch 'master' into fix-optional-get"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "383436e17044a739edc4361367e7dc3a6a05f43e", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/383436e17044a739edc4361367e7dc3a6a05f43e", "committedDate": "2020-12-08T16:17:50Z", "message": "Merge branch 'master' into fix-optional-get"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDA1NzIx", "url": "https://github.com/google/ground-android/pull/640#pullrequestreview-547405721", "createdAt": "2020-12-08T16:28:30Z", "commit": {"oid": "383436e17044a739edc4361367e7dc3a6a05f43e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80774f1aa6d51675cb3f34a2221426d92b387f4a", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/80774f1aa6d51675cb3f34a2221426d92b387f4a", "committedDate": "2020-12-08T17:02:17Z", "message": "Merge branch 'master' of https://github.com/google/ground-android into fix-optional-get\n\n\u0001 Conflicts:\n\u0001\tgnd/src/main/java/com/google/android/gnd/persistence/local/room/entity/FeatureEntity.java\n\u0001\tgnd/src/main/java/com/google/android/gnd/persistence/local/room/entity/ObservationEntity.java\n\u0001\tgnd/src/main/java/com/google/android/gnd/repository/ObservationRepository.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDQ0NzMz", "url": "https://github.com/google/ground-android/pull/640#pullrequestreview-547444733", "createdAt": "2020-12-08T17:08:38Z", "commit": {"oid": "80774f1aa6d51675cb3f34a2221426d92b387f4a"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzowODozOVrOIBqVGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNzowOToyOFrOIBqYxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzAxOA==", "bodyText": "Timber.e", "url": "https://github.com/google/ground-android/pull/640#discussion_r538613018", "createdAt": "2020-12-08T17:08:39Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/util/StreamUtil.java", "diffHunk": "@@ -0,0 +1,42 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.util;\n+\n+import static java8.util.stream.StreamSupport.stream;\n+\n+import java.util.Collections;\n+import java8.util.function.Supplier;\n+import java8.util.stream.Stream;\n+import timber.log.Timber;\n+\n+/** Methods for working with and manipulating {@link java8.util.stream.Stream}s. */\n+public class StreamUtil {\n+\n+  /**\n+   * Executes the specified Supplier, writing throw Error exceptions to debug logs. If an error\n+   * occurs, an empty Stream is returned, otherwise a Stream with only the result of the Supplier is\n+   * returned.\n+   */\n+  public static <R> Stream<R> logErrorsAndSkip(Supplier<R> supplier) {\n+    try {\n+      return stream(Collections.singleton(supplier.get()));\n+    } catch (RuntimeException e) {\n+      Timber.d(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80774f1aa6d51675cb3f34a2221426d92b387f4a"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxMzk1Nw==", "bodyText": "Timber.e", "url": "https://github.com/google/ground-android/pull/640#discussion_r538613957", "createdAt": "2020-12-08T17:09:28Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/persistence/local/room/RoomLocalDataStore.java", "diffHunk": "@@ -268,8 +266,8 @@ public Completable applyAndEnqueue(FeatureMutation mutation) {\n     return featureDao\n         .findById(featureId)\n         .map(f -> FeatureEntity.toFeature(f, project))\n-        .filter(Optional::isPresent)\n-        .map(Optional::get)\n+        .doOnError(e -> Timber.d(e))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80774f1aa6d51675cb3f34a2221426d92b387f4a"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d2d7d2fd1c29fe41c1d2c6274cb84b64abe3c8c", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/1d2d7d2fd1c29fe41c1d2c6274cb84b64abe3c8c", "committedDate": "2020-12-08T17:16:43Z", "message": "Log error instead of debug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c78bee97b32f7cbd21a3a174afe877483818374", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/3c78bee97b32f7cbd21a3a174afe877483818374", "committedDate": "2020-12-08T17:23:42Z", "message": "Timber.d -> Timber.e"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDU4OTEy", "url": "https://github.com/google/ground-android/pull/640#pullrequestreview-547458912", "createdAt": "2020-12-08T17:23:48Z", "commit": {"oid": "1d2d7d2fd1c29fe41c1d2c6274cb84b64abe3c8c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1524, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}