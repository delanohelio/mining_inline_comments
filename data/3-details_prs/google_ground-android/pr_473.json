{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMjYxNjc5", "number": 473, "title": "[Settings] Add basic settings page", "bodyText": "Fixes #424.\n\n Add a new item \"settings\" to navigation drawer\n Include some dummy preferences to setup the structure for future use.\n\nScreenshot:\n\n@scolsen  PTAL?", "createdAt": "2020-05-21T09:57:18Z", "url": "https://github.com/google/ground-android/pull/473", "merged": true, "mergeCommit": {"oid": "f8b0e5ee0b29ff4eb3dfe76a006b0099ea70d5cb"}, "closed": true, "closedAt": "2020-05-27T21:55:32Z", "author": {"login": "shobhitagarwal1612"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjEO79AH2gAyNDIxMjYxNjc5OmI2MDBhYTJmNWQyZWIxNzdlYjExNjk4NmZjZDkyZTIzM2NlYmVmNGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclgiCMgFqTQxOTYzNzI0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b600aa2f5d2eb177eb116986fcd92e233cebef4f", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/b600aa2f5d2eb177eb116986fcd92e233cebef4f", "committedDate": "2020-05-20T07:49:22Z", "message": "Add androidx.preference library\n\nandroid.preference is deprecated (https://developer.android.com/guide/topics/ui/settings)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "316965cead1da20b7c58f3eafcc6b6c2beffc877", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/316965cead1da20b7c58f3eafcc6b6c2beffc877", "committedDate": "2020-05-21T08:23:09Z", "message": "Add vector settings icon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "817a3d364fcf3a1cbaa48b467f553c3edd95e797", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/817a3d364fcf3a1cbaa48b467f553c3edd95e797", "committedDate": "2020-05-21T08:23:48Z", "message": "Add settings to nav menu xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbc03a4389f0a10a0b590b5d10ecea7b6135dd54", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/bbc03a4389f0a10a0b590b5d10ecea7b6135dd54", "committedDate": "2020-05-21T08:24:29Z", "message": "Add settings fragment with test preferences"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88af3afa3e71f1d15ff3a707e261802d7cbdc53b", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/88af3afa3e71f1d15ff3a707e261802d7cbdc53b", "committedDate": "2020-05-21T08:24:52Z", "message": "Add Settings to nav graph"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b384b452b04042bca733714b109b60e02685cd00", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/b384b452b04042bca733714b109b60e02685cd00", "committedDate": "2020-05-21T08:25:28Z", "message": "Add click handler in HomeScreenFragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b47cd8b6a7133d7c8274970059f11b81df77a4", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/a4b47cd8b6a7133d7c8274970059f11b81df77a4", "committedDate": "2020-05-21T08:29:47Z", "message": "Add javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3bc3098a442fd6172956c8f0211f5e61e6ea44b", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/a3bc3098a442fd6172956c8f0211f5e61e6ea44b", "committedDate": "2020-05-21T08:44:03Z", "message": "Add more meaningful preferences"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ef1a2b9a3d130c885fe7931af911a656298bcf9", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/2ef1a2b9a3d130c885fe7931af911a656298bcf9", "committedDate": "2020-05-21T09:49:21Z", "message": "Add class to manage preference keys"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ded70c0fea302f65eb0d3593dea764c3479d5c35", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/ded70c0fea302f65eb0d3593dea764c3479d5c35", "committedDate": "2020-05-21T09:52:51Z", "message": "Add preference handlers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MDI0NDM2", "url": "https://github.com/google/ground-android/pull/473#pullrequestreview-416024436", "createdAt": "2020-05-21T10:01:46Z", "commit": {"oid": "ded70c0fea302f65eb0d3593dea764c3479d5c35"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDowMTo0NlrOGYtPDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDowMTo0NlrOGYtPDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU2MDE0Mg==", "bodyText": "I tried to get the height of the view from binding. But it always returns 0 for the first time. Anyone knows why?\nThe reason we have to add top margin is to fit the preferences layout under the toolbar. There is no standard practice around how to add a toolbar because official docs recommend using the PreferenceFragment within an Activity. In our case, the activity doesn't have a toolbar. Any guidelines or suggestions are most welcome!", "url": "https://github.com/google/ground-android/pull/473#discussion_r428560142", "createdAt": "2020-05-21T10:01:46Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/SettingsFragment.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+import android.content.Intent;\n+import android.net.Uri;\n+import android.os.Bundle;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.view.ViewGroup;\n+import android.widget.FrameLayout.LayoutParams;\n+import android.widget.Toast;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.preference.Preference;\n+import androidx.preference.Preference.OnPreferenceChangeListener;\n+import androidx.preference.Preference.OnPreferenceClickListener;\n+import androidx.preference.PreferenceFragmentCompat;\n+import com.google.android.gnd.MainActivity;\n+import com.google.android.gnd.R;\n+import com.google.android.gnd.databinding.SettingsFragBinding;\n+\n+/**\n+ * Fragment containing app preferences saved as shared preferences.\n+ *\n+ * <p>NOTE: It uses {@link PreferenceFragmentCompat} instead of {@link\n+ * com.google.android.gnd.ui.common.AbstractFragment}, so dagger can't inject into it like it does\n+ * in other fragments.\n+ *\n+ * <p>TODO: Create dagger module and support injection into this fragment.\n+ */\n+public class SettingsFragment extends PreferenceFragmentCompat\n+    implements OnPreferenceChangeListener, OnPreferenceClickListener {\n+\n+  @Override\n+  public View onCreateView(\n+      @NonNull LayoutInflater inflater,\n+      @Nullable ViewGroup container,\n+      @Nullable Bundle savedInstanceState) {\n+    super.onCreateView(inflater, container, savedInstanceState);\n+    SettingsFragBinding binding = SettingsFragBinding.inflate(inflater, container, true);\n+    binding.setLifecycleOwner(this);\n+    ((MainActivity) getActivity()).setActionBar(binding.settingsToolbar, true);\n+    return super.onCreateView(inflater, container, savedInstanceState);\n+  }\n+\n+  @Override\n+  public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\n+    super.onViewCreated(view, savedInstanceState);\n+\n+    // TODO: Set dynamically by calculating the actual height of toolbar\n+    int topMargin = 108;\n+\n+    LayoutParams params = (LayoutParams) getListView().getLayoutParams();\n+    params.setMargins(0, topMargin, 0, 0);\n+    getListView().setLayoutParams(params);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ded70c0fea302f65eb0d3593dea764c3479d5c35"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28341c418ebe80467f34240df6d32670d6304c95", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/28341c418ebe80467f34240df6d32670d6304c95", "committedDate": "2020-05-21T10:05:45Z", "message": "Add missing default"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "778d3a0728730b3a65fbee2817e183bef33cfd4b", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/778d3a0728730b3a65fbee2817e183bef33cfd4b", "committedDate": "2020-05-21T10:07:06Z", "message": "Fix lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2fe98f80701107937d5c0eb5c1e013927b8d5e4", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/f2fe98f80701107937d5c0eb5c1e013927b8d5e4", "committedDate": "2020-05-21T10:08:49Z", "message": "Make Keys package private"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3366561b56b8813368730784047fade80ea44115", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/3366561b56b8813368730784047fade80ea44115", "committedDate": "2020-05-21T10:28:16Z", "message": "Merge branch 'master' into issue-424"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3da65e3dad03f36d0f6137ea0f1f321f11a3c13", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/b3da65e3dad03f36d0f6137ea0f1f321f11a3c13", "committedDate": "2020-05-22T15:35:23Z", "message": "Reformat AndroidManifest.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e704b8982335070970ab8c96eda3162a66b51b7e", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/e704b8982335070970ab8c96eda3162a66b51b7e", "committedDate": "2020-05-22T15:35:23Z", "message": "Remove obvious comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdcec45481d4107b95e1a9b525ac7f0d915b48a5", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/bdcec45481d4107b95e1a9b525ac7f0d915b48a5", "committedDate": "2020-05-22T15:35:23Z", "message": "Remove toolbar inflation from SettingsFragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70025af5a1d605ba27dc61f9b2c0aaa4e00fc5ab", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/70025af5a1d605ba27dc61f9b2c0aaa4e00fc5ab", "committedDate": "2020-05-22T15:35:23Z", "message": "Rename xml and add container for adding SettingsFragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4251dc1a62248b568eca50ac2d77da04a5d83c7c", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/4251dc1a62248b568eca50ac2d77da04a5d83c7c", "committedDate": "2020-05-22T15:35:23Z", "message": "Add settings activity and load SettingsFragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3bd471099b7d726518a0bf197c4af16ca1ffad9", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/a3bd471099b7d726518a0bf197c4af16ca1ffad9", "committedDate": "2020-05-22T15:35:23Z", "message": "Replace destination to activity in nav_graph"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f721cb8b2c306999424c6fc7e665f03243d516d6", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/f721cb8b2c306999424c6fc7e665f03243d516d6", "committedDate": "2020-05-22T15:35:23Z", "message": "Create a super abstract activity with helper methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a58b9ff6e9196cebe48f8a4e3591084eacd92f7", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/6a58b9ff6e9196cebe48f8a4e3591084eacd92f7", "committedDate": "2020-05-22T15:35:23Z", "message": "Extend AbstractActivity and cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40", "author": {"user": {"login": "gino-m", "name": "Gino Miceli"}}, "url": "https://github.com/google/ground-android/commit/1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40", "committedDate": "2020-05-24T17:16:56Z", "message": "Merge branch 'master' into issue-424"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3Mzc2MzMy", "url": "https://github.com/google/ground-android/pull/473#pullrequestreview-417376332", "createdAt": "2020-05-24T17:22:32Z", "commit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNzoyMjozMlrOGZwNWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNzoyMzo1MVrOGZwNxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzQzMw==", "bodyText": "Can these be represented as String resources? Seems unfortunate we need to duplicate these keys in two places.", "url": "https://github.com/google/ground-android/pull/473#discussion_r429657433", "createdAt": "2020-05-24T17:22:32Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/settings/Keys.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.ui.settings;\n+\n+/** These keys should match 1:1 in res/xml/preferences.xml. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NzU0Mg==", "bodyText": "Does the autoformat remove final CRs? Maybe they should be there?", "url": "https://github.com/google/ground-android/pull/473#discussion_r429657542", "createdAt": "2020-05-24T17:23:51Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/res/xml/preferences.xml", "diffHunk": "@@ -0,0 +1,53 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<!--\n+  ~ Copyright 2020 Google LLC\n+  ~\n+  ~ Licensed under the Apache License, Version 2.0 (the \"License\");\n+  ~ you may not use this file except in compliance with the License.\n+  ~ You may obtain a copy of the License at\n+  ~\n+  ~     https://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  -->\n+\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\">\n+\n+  <PreferenceCategory\n+    app:key=\"general_category\"\n+    app:title=\"General\">\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"upload_media\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Upload media\" />\n+\n+    <SwitchPreferenceCompat\n+      app:key=\"offline_areas\"\n+      app:summary=\"Over Wi-Fi only\"\n+      app:title=\"Offline areas download\" />\n+\n+  </PreferenceCategory>\n+\n+  <PreferenceCategory\n+    app:key=\"help_category\"\n+    app:title=\"Help\">\n+\n+    <Preference\n+      app:key=\"visit_website\"\n+      app:summary=\"@string/ground_website\"\n+      app:title=\"Visit website\" />\n+\n+    <Preference\n+      app:key=\"feedback\"\n+      app:summary=\"Report technical issues or suggest new features\"\n+      app:title=\"Send feedback\" />\n+\n+  </PreferenceCategory>\n+\n+</PreferenceScreen>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c7b3c9aab2ec5ad6bbe3257ce2d6e149afdfe40"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24a0977c04104ced8b6249e2759c02c192cc7d91", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/24a0977c04104ced8b6249e2759c02c192cc7d91", "committedDate": "2020-05-24T19:03:04Z", "message": "Add end line"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3215955c52f5ec975704105f0bc662020a99c2ea", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/3215955c52f5ec975704105f0bc662020a99c2ea", "committedDate": "2020-05-26T20:10:17Z", "message": "Merge branch 'master' into issue-424"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjM3MjQ4", "url": "https://github.com/google/ground-android/pull/473#pullrequestreview-419637248", "createdAt": "2020-05-27T21:55:25Z", "commit": {"oid": "3215955c52f5ec975704105f0bc662020a99c2ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1556, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}