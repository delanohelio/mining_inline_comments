{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MTQ4MjMz", "number": 379, "title": "[Feature] Display active project in navigation drawer", "bodyText": "Closes #230\n\n  Highlight selected project\n  Clicking on any project activates it\n  Add + Join Project item\n  Display only joined projects in nav drawer\n\nScreenshot:", "createdAt": "2020-02-24T18:37:59Z", "url": "https://github.com/google/ground-android/pull/379", "merged": true, "mergeCommit": {"oid": "894ac6d8837cb253968bbbf69f8fff35dee91112"}, "closed": true, "closedAt": "2020-03-11T14:14:07Z", "author": {"login": "shobhitagarwal1612"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHfcuVgH2gAyMzc5MTQ4MjMzOmM1YjQzNjk5ZWU5YzA2MGQ2ZTFlZGU5OTViOWUyMGNjNmVmZjc1N2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMnoBRgFqTM3Mjc4NTk1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c5b43699ee9c060d6e1ede995b9e20cc6eff757d", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/c5b43699ee9c060d6e1ede995b9e20cc6eff757d", "committedDate": "2020-02-24T15:41:59Z", "message": "Load projects into nav drawer dynamically"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ceff8cf3794d1cdde2a67e96d4f1bd4f0701a36d", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/ceff8cf3794d1cdde2a67e96d4f1bd4f0701a36d", "committedDate": "2020-02-24T18:12:29Z", "message": "Set active project on click"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61d39b9a7054f505beb72273189ad6a6e34a18de", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/61d39b9a7054f505beb72273189ad6a6e34a18de", "committedDate": "2020-02-24T18:19:48Z", "message": "Update strings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c74f2e257d59891c4019419a988dfb06d5fa0ed", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/7c74f2e257d59891c4019419a988dfb06d5fa0ed", "committedDate": "2020-02-24T18:28:25Z", "message": "Customize nav item styling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e82dc04c37268bbd8242ee91628539a3b236a02e", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/e82dc04c37268bbd8242ee91628539a3b236a02e", "committedDate": "2020-02-24T18:40:00Z", "message": "Merge branch 'master' into active-project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6da192bd5879044d31b7fa3d7353b9e1c03f1749", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/6da192bd5879044d31b7fa3d7353b9e1c03f1749", "committedDate": "2020-02-24T19:57:34Z", "message": "Display only joined projects in nav drawer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ea89549a4376de6ca1db9455826439be1b36848", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/8ea89549a4376de6ca1db9455826439be1b36848", "committedDate": "2020-02-25T05:47:55Z", "message": "Merge branch 'master' into active-project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8147d0e9c3686ee5f89638422ffb015daee7773", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/d8147d0e9c3686ee5f89638422ffb015daee7773", "committedDate": "2020-02-25T18:37:51Z", "message": "Re-arrange join project nav item"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzU4NDM5", "url": "https://github.com/google/ground-android/pull/379#pullrequestreview-364358439", "createdAt": "2020-02-25T18:45:40Z", "commit": {"oid": "6da192bd5879044d31b7fa3d7353b9e1c03f1749"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODo0NTo0MFrOFuQyOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODo0NzoyM1rOFuQ2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA1MzgxOA==", "bodyText": "We call these \"local\" here, and \"saved\" above.  Is there a more consistent name we can use? From the user's perspective, they will \"join/leave\" a project, which will store them locally for offline use, and sync them when online. Maybe \"offline projects\" would be clear?", "url": "https://github.com/google/ground-android/pull/379#discussion_r384053818", "createdAt": "2020-02-25T18:45:40Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/HomeScreenFragment.java", "diffHunk": "@@ -424,7 +427,7 @@ public boolean onBack() {\n   @Override\n   public boolean onNavigationItemSelected(@NonNull MenuItem item) {\n     if (item.getGroupId() == R.id.group_join_project) {\n-      projectSelectorViewModel.activateProject(item.getOrder());\n+      projectSelectorViewModel.activateLocalProject(item.getOrder());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6da192bd5879044d31b7fa3d7353b9e1c03f1749"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA1NDgzOQ==", "bodyText": "getOfflineProjectsOnceAndStream(), as per https://github.com/google/ground-android/wiki/RxJava-Usage-Guidelines#observable-and-flowable", "url": "https://github.com/google/ground-android/pull/379#discussion_r384054839", "createdAt": "2020-02-25T18:47:23Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/repository/ProjectRepository.java", "diffHunk": "@@ -131,6 +131,10 @@ public void activateProject(String projectId) {\n         .compose(Loadable::loadingOnceAndWrap);\n   }\n \n+  public Flowable<Loadable<List<Project>>> getSavedProjects() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6da192bd5879044d31b7fa3d7353b9e1c03f1749"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b7e767956744f7f41cb78a1baf334ae3cd8a45", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/a4b7e767956744f7f41cb78a1baf334ae3cd8a45", "committedDate": "2020-02-27T17:20:42Z", "message": "Merge branch 'master' into active-project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1255b616164bf6f86022ded9a205fc48fb34fc5e", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/1255b616164bf6f86022ded9a205fc48fb34fc5e", "committedDate": "2020-02-27T17:24:29Z", "message": "Better method names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "decb6b66bced7a61cd754f2626f1ae1383d0f63c", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/decb6b66bced7a61cd754f2626f1ae1383d0f63c", "committedDate": "2020-02-27T17:26:26Z", "message": "Update remaining references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f239e5fb44bb901dbd19e16ff3aa9f1ee1303aa6", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/f239e5fb44bb901dbd19e16ff3aa9f1ee1303aa6", "committedDate": "2020-02-27T17:40:02Z", "message": "Consolidate duplicate strings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15724d453ccbdd8efd5e42e3ad1e9cbec92e69e4", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/15724d453ccbdd8efd5e42e3ad1e9cbec92e69e4", "committedDate": "2020-03-05T17:59:59Z", "message": "Merge branch 'master' into active-project"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjQwMjE3", "url": "https://github.com/google/ground-android/pull/379#pullrequestreview-371640217", "createdAt": "2020-03-10T02:14:12Z", "commit": {"oid": "15724d453ccbdd8efd5e42e3ad1e9cbec92e69e4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a208b2da875c81a4850afb0883e814cf39d23cda", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/a208b2da875c81a4850afb0883e814cf39d23cda", "committedDate": "2020-03-11T13:26:08Z", "message": "Update nav drawer on activating a project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93b8709ef048e92209d30538245a709460549aeb", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/93b8709ef048e92209d30538245a709460549aeb", "committedDate": "2020-03-11T13:37:38Z", "message": "Add separator to nav menu and update string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fe488c5a1998906799aa125365802a2a96b96f1", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/4fe488c5a1998906799aa125365802a2a96b96f1", "committedDate": "2020-03-11T13:44:35Z", "message": "Add missing fullstop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzc0MjY1", "url": "https://github.com/google/ground-android/pull/379#pullrequestreview-372774265", "createdAt": "2020-03-11T13:50:32Z", "commit": {"oid": "93b8709ef048e92209d30538245a709460549aeb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo1MDozMlrOF03upw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzo1MDozMlrOF03upw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk4MzMzNQ==", "bodyText": "If the project is not yet activated, value() will return null here. Instead, you can replace the  activeProject null check with Loadable.getValue(activeProject) to cover both cases (i.e. Loadable.getValue(activeProject).ifPresent(p => updateSelectedProjectUI(getSelectedProjectIndex(p)));)", "url": "https://github.com/google/ground-android/pull/379#discussion_r390983335", "createdAt": "2020-03-11T13:50:32Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/home/HomeScreenFragment.java", "diffHunk": "@@ -210,6 +204,13 @@ private void addProjectToNavDrawer(List<Project> projects) {\n           .add(R.id.group_join_project, Menu.NONE, index, projects.get(index).getTitle())\n           .setIcon(R.drawable.ic_menu_project);\n     }\n+\n+    // Highlight active project\n+    Loadable<Project> activeProject = viewModel.getActiveProject().getValue();\n+    if (activeProject != null) {\n+      int index = getSelectedProjectIndex(activeProject.value().get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93b8709ef048e92209d30538245a709460549aeb"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfb5cebb3b376b76865792c870e823653069a6a2", "author": {"user": {"login": "shobhitagarwal1612", "name": "Shobhit Agarwal"}}, "url": "https://github.com/google/ground-android/commit/dfb5cebb3b376b76865792c870e823653069a6a2", "committedDate": "2020-03-11T14:00:12Z", "message": "Replace null check with cleaner implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzg1OTU2", "url": "https://github.com/google/ground-android/pull/379#pullrequestreview-372785956", "createdAt": "2020-03-11T14:03:11Z", "commit": {"oid": "dfb5cebb3b376b76865792c870e823653069a6a2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1722, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}