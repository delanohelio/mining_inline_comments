{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MDA1MzEz", "number": 542, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxODoyNzowNlrOEOYReQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMToyOToyMVrOES__5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNTEzMjA5OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxODoyNzowNlrOGxgBBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjowMToyM1rOG2RRtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1Nzk1OQ==", "bodyText": "Can you please move this string creation to catch block? Otherwise, it seems wasteful to do this init each time.", "url": "https://github.com/google/ground-android/pull/542#discussion_r454557959", "createdAt": "2020-07-14T18:27:06Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDY2ODI4Mg==", "bodyText": "@shobhitagarwal1612 Could you clarify what would be wasted and when?", "url": "https://github.com/google/ground-android/pull/542#discussion_r454668282", "createdAt": "2020-07-14T21:54:57Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1Nzk1OQ=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc1NTUxOQ==", "bodyText": "IIUC, this is the default area name \"unknown area\" which would be set if the try block throws an exception. So, this value would only be used if reverse geocoding fails for a particular point", "url": "https://github.com/google/ground-android/pull/542#discussion_r454755519", "createdAt": "2020-07-15T02:39:01Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1Nzk1OQ=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1OTM1MQ==", "bodyText": "After the refactor in 81c0b3f, the setup is a bit different--we still need to do the allocation early as we can't just hold on to the context in the class (iirc this can lead to leaks)--but it should be a bit cleaner now.", "url": "https://github.com/google/ground-android/pull/542#discussion_r459559351", "createdAt": "2020-07-23T16:01:23Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1Nzk1OQ=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNTEzODcxOnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxODoyODo1NVrOGxgFGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjowMTozMlrOG2RSCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTAwMQ==", "bodyText": "Can we please specify exactly which exception we are looking for? Is this catching errors other than AddressNotFoundException too?", "url": "https://github.com/google/ground-android/pull/542#discussion_r454559001", "createdAt": "2020-07-14T18:28:55Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);\n+\n+    OfflineArea area = offlineAreas.get(position);\n+    String id = area.getId();\n+    LatLng center = area.getBounds().getCenter();\n+\n+    try {\n+      List<Address> addresses =\n+          viewHolder.geocoder.getFromLocation(center.latitude, center.longitude, 1);\n+\n+      if (addresses.isEmpty()) {\n+        throw new AddressNotFoundException(\"No address found for area.\");\n+      }\n+\n+      Address address = addresses.get(0);\n+\n+      areaName =\n+          Optional.ofNullable(address.getFeatureName())\n+              .or(() -> Optional.ofNullable(address.getLocality()))\n+              .or(() -> Optional.ofNullable(address.getSubAdminArea()))\n+              .or(() -> Optional.ofNullable(address.getAdminArea()))\n+              .or(() -> Optional.ofNullable(address.getCountryName()))\n+              .orElse(areaName);\n+    } catch (Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1OTQzNA==", "bodyText": "done! 81c0b3f", "url": "https://github.com/google/ground-android/pull/542#discussion_r459559434", "createdAt": "2020-07-23T16:01:32Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);\n+\n+    OfflineArea area = offlineAreas.get(position);\n+    String id = area.getId();\n+    LatLng center = area.getBounds().getCenter();\n+\n+    try {\n+      List<Address> addresses =\n+          viewHolder.geocoder.getFromLocation(center.latitude, center.longitude, 1);\n+\n+      if (addresses.isEmpty()) {\n+        throw new AddressNotFoundException(\"No address found for area.\");\n+      }\n+\n+      Address address = addresses.get(0);\n+\n+      areaName =\n+          Optional.ofNullable(address.getFeatureName())\n+              .or(() -> Optional.ofNullable(address.getLocality()))\n+              .or(() -> Optional.ofNullable(address.getSubAdminArea()))\n+              .or(() -> Optional.ofNullable(address.getAdminArea()))\n+              .or(() -> Optional.ofNullable(address.getCountryName()))\n+              .orElse(areaName);\n+    } catch (Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTAwMQ=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNTUyMzk4OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQyMDoxOToyOVrOGxjxDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjowMTo0NlrOG2RSsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYxOTQwNg==", "bodyText": "Following our current architecture, remote and system services are all hidden either behind a Repository or a Manager, respectively. Also,\nListAdapter is a purely UI component, so it would be best to abstract services like this one so they can be mocked or replaced without needing to mock the lower level API.\nHow about creating a GeocodingService that exposes only the functionality needed to implement this feature?", "url": "https://github.com/google/ground-android/pull/542#discussion_r454619406", "createdAt": "2020-07-14T20:19:29Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -37,6 +50,7 @@\n     public int position;\n     private ImmutableList<OfflineArea> areas;\n     private final Navigator navigator;\n+    private final Geocoder geocoder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1OTYwMg==", "bodyText": "Done! 81c0b3f added a GeocodingManager", "url": "https://github.com/google/ground-android/pull/542#discussion_r459559602", "createdAt": "2020-07-23T16:01:46Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -37,6 +50,7 @@\n     public int position;\n     private ImmutableList<OfflineArea> areas;\n     private final Navigator navigator;\n+    private final Geocoder geocoder;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYxOTQwNg=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNTU1NDUwOnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQyMDoyNzo1N1rOGxkDww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNjowMTo1MlrOG2RS-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYyNDE5NQ==", "bodyText": "In particular, this is business logic that would be best defined in a more tightly scoped class imo.", "url": "https://github.com/google/ground-android/pull/542#discussion_r454624195", "createdAt": "2020-07-14T20:27:57Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);\n+\n+    OfflineArea area = offlineAreas.get(position);\n+    String id = area.getId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1OTY3Mg==", "bodyText": "81c0b3f", "url": "https://github.com/google/ground-android/pull/542#discussion_r459559672", "createdAt": "2020-07-23T16:01:52Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -75,9 +90,42 @@ public void onClick(View v) {\n   }\n \n   @Override\n-  public void onBindViewHolder(ViewHolder viewHolder, int position) {\n-    viewHolder.binding.offlineAreaName.setText(offlineAreas.get(position).getId());\n-    viewHolder.position = position;\n+  public void onBindViewHolder(@NonNull ViewHolder viewHolder, int position) {\n+    String areaName =\n+        viewHolder.binding.getRoot().getContext().getString(R.string.offline_areas_unknown_area);\n+\n+    OfflineArea area = offlineAreas.get(position);\n+    String id = area.getId();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYyNDE5NQ=="}, "originalCommit": {"oid": "7b6c4f309345107101af3eff4b30aac27e44ebba"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2OTM4NTA5OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMzowNzo1M1rOG2ehNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDo1OToyMVrOG4eoTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc3NjMxMA==", "bodyText": "This seems like logic that would normally be called from the ViewModel. Also, it would be preferable to inject the GeocodingManager (in the VM) to make it easier to swap out in tests. Would this be possible?", "url": "https://github.com/google/ground-android/pull/542#discussion_r459776310", "createdAt": "2020-07-23T23:07:53Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -60,7 +47,7 @@ public AddressNotFoundException(String message) {\n       this.binding = binding;\n       this.areas = areas;\n       this.navigator = navigator;\n-      this.geocoder = new Geocoder(binding.getRoot().getContext());\n+      this.geocoder = new GeocodingManager(binding.getRoot().getContext());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cef1feaf66f7d8e5b5bf6d26c045f1ca88196398"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg3NTI3Nw==", "bodyText": "77aaed7", "url": "https://github.com/google/ground-android/pull/542#discussion_r461875277", "createdAt": "2020-07-28T20:59:21Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreaListAdapter.java", "diffHunk": "@@ -60,7 +47,7 @@ public AddressNotFoundException(String message) {\n       this.binding = binding;\n       this.areas = areas;\n       this.navigator = navigator;\n-      this.geocoder = new Geocoder(binding.getRoot().getContext());\n+      this.geocoder = new GeocodingManager(binding.getRoot().getContext());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc3NjMxMA=="}, "originalCommit": {"oid": "cef1feaf66f7d8e5b5bf6d26c045f1ca88196398"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2OTM4NzA4OnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/system/GeocodingManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMzowODo1N1rOG2eiWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDo1OTozMVrOG4eopQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc3NjYwMA==", "bodyText": "s/abstracts over/abstracts/", "url": "https://github.com/google/ground-android/pull/542#discussion_r459776600", "createdAt": "2020-07-23T23:08:57Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/system/GeocodingManager.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.system;\n+\n+import android.content.Context;\n+import android.location.Address;\n+import android.location.Geocoder;\n+import com.google.android.gms.maps.model.LatLng;\n+import com.google.android.gnd.R;\n+import com.google.android.gnd.model.basemap.OfflineArea;\n+import java.io.IOException;\n+import java.util.List;\n+import java8.util.Optional;\n+import timber.log.Timber;\n+\n+/**\n+ * GeocodingManger abstracts over native geocoding facilities, and provides convenience methods for", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cef1feaf66f7d8e5b5bf6d26c045f1ca88196398"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg3NTM2NQ==", "bodyText": "656adc8", "url": "https://github.com/google/ground-android/pull/542#discussion_r461875365", "createdAt": "2020-07-28T20:59:31Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/system/GeocodingManager.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.android.gnd.system;\n+\n+import android.content.Context;\n+import android.location.Address;\n+import android.location.Geocoder;\n+import com.google.android.gms.maps.model.LatLng;\n+import com.google.android.gnd.R;\n+import com.google.android.gnd.model.basemap.OfflineArea;\n+import java.io.IOException;\n+import java.util.List;\n+import java8.util.Optional;\n+import timber.log.Timber;\n+\n+/**\n+ * GeocodingManger abstracts over native geocoding facilities, and provides convenience methods for", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc3NjYwMA=="}, "originalCommit": {"oid": "cef1feaf66f7d8e5b5bf6d26c045f1ca88196398"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzU4MzcyOnYy", "diffSide": "RIGHT", "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreasViewModel.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMToyOToyMVrOG4flYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDowNzo1OFrOG46LRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg5MDkxNQ==", "bodyText": "Instead of creating an instance here, how about converting GeocodingManager into an injectable dependency?", "url": "https://github.com/google/ground-android/pull/542#discussion_r461890915", "createdAt": "2020-07-28T21:29:21Z", "author": {"login": "shobhitagarwal1612"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreasViewModel.java", "diffHunk": "@@ -16,39 +16,57 @@\n \n package com.google.android.gnd.ui.offlinearea;\n \n+import static java8.util.stream.StreamSupport.stream;\n+\n+import android.content.Context;\n import androidx.lifecycle.LiveData;\n import androidx.lifecycle.LiveDataReactiveStreams;\n import com.google.android.gnd.model.basemap.OfflineArea;\n import com.google.android.gnd.repository.OfflineAreaRepository;\n+import com.google.android.gnd.system.GeocodingManager;\n import com.google.android.gnd.ui.common.AbstractViewModel;\n import com.google.android.gnd.ui.common.Navigator;\n-import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import dagger.hilt.android.qualifiers.ApplicationContext;\n+import java8.util.stream.Collectors;\n import javax.inject.Inject;\n \n /**\n  * View model for the offline area manager fragment. Handles the current list of downloaded areas.\n  */\n public class OfflineAreasViewModel extends AbstractViewModel {\n \n-  private LiveData<ImmutableList<OfflineArea>> offlineAreas;\n+  private LiveData<ImmutableMap<String, OfflineArea>> offlineAreas;\n   private final Navigator navigator;\n+  private final GeocodingManager geocoder;\n \n   @Inject\n-  OfflineAreasViewModel(Navigator navigator, OfflineAreaRepository offlineAreaRepository) {\n+  OfflineAreasViewModel(\n+      Navigator navigator,\n+      OfflineAreaRepository offlineAreaRepository,\n+      @ApplicationContext Context context) {\n     this.navigator = navigator;\n+    this.geocoder = new GeocodingManager(context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3379d8971a8436cd8bb2700c936dc192f2612a6d"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg5NTgxNg==", "bodyText": "+1. I believe all you need is to add @Inject to the constructor.", "url": "https://github.com/google/ground-android/pull/542#discussion_r461895816", "createdAt": "2020-07-28T21:40:06Z", "author": {"login": "gino-m"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreasViewModel.java", "diffHunk": "@@ -16,39 +16,57 @@\n \n package com.google.android.gnd.ui.offlinearea;\n \n+import static java8.util.stream.StreamSupport.stream;\n+\n+import android.content.Context;\n import androidx.lifecycle.LiveData;\n import androidx.lifecycle.LiveDataReactiveStreams;\n import com.google.android.gnd.model.basemap.OfflineArea;\n import com.google.android.gnd.repository.OfflineAreaRepository;\n+import com.google.android.gnd.system.GeocodingManager;\n import com.google.android.gnd.ui.common.AbstractViewModel;\n import com.google.android.gnd.ui.common.Navigator;\n-import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import dagger.hilt.android.qualifiers.ApplicationContext;\n+import java8.util.stream.Collectors;\n import javax.inject.Inject;\n \n /**\n  * View model for the offline area manager fragment. Handles the current list of downloaded areas.\n  */\n public class OfflineAreasViewModel extends AbstractViewModel {\n \n-  private LiveData<ImmutableList<OfflineArea>> offlineAreas;\n+  private LiveData<ImmutableMap<String, OfflineArea>> offlineAreas;\n   private final Navigator navigator;\n+  private final GeocodingManager geocoder;\n \n   @Inject\n-  OfflineAreasViewModel(Navigator navigator, OfflineAreaRepository offlineAreaRepository) {\n+  OfflineAreasViewModel(\n+      Navigator navigator,\n+      OfflineAreaRepository offlineAreaRepository,\n+      @ApplicationContext Context context) {\n     this.navigator = navigator;\n+    this.geocoder = new GeocodingManager(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg5MDkxNQ=="}, "originalCommit": {"oid": "3379d8971a8436cd8bb2700c936dc192f2612a6d"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNjU5Nw==", "bodyText": "56b49e5", "url": "https://github.com/google/ground-android/pull/542#discussion_r462326597", "createdAt": "2020-07-29T14:07:58Z", "author": {"login": "scolsen"}, "path": "gnd/src/main/java/com/google/android/gnd/ui/offlinearea/OfflineAreasViewModel.java", "diffHunk": "@@ -16,39 +16,57 @@\n \n package com.google.android.gnd.ui.offlinearea;\n \n+import static java8.util.stream.StreamSupport.stream;\n+\n+import android.content.Context;\n import androidx.lifecycle.LiveData;\n import androidx.lifecycle.LiveDataReactiveStreams;\n import com.google.android.gnd.model.basemap.OfflineArea;\n import com.google.android.gnd.repository.OfflineAreaRepository;\n+import com.google.android.gnd.system.GeocodingManager;\n import com.google.android.gnd.ui.common.AbstractViewModel;\n import com.google.android.gnd.ui.common.Navigator;\n-import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import dagger.hilt.android.qualifiers.ApplicationContext;\n+import java8.util.stream.Collectors;\n import javax.inject.Inject;\n \n /**\n  * View model for the offline area manager fragment. Handles the current list of downloaded areas.\n  */\n public class OfflineAreasViewModel extends AbstractViewModel {\n \n-  private LiveData<ImmutableList<OfflineArea>> offlineAreas;\n+  private LiveData<ImmutableMap<String, OfflineArea>> offlineAreas;\n   private final Navigator navigator;\n+  private final GeocodingManager geocoder;\n \n   @Inject\n-  OfflineAreasViewModel(Navigator navigator, OfflineAreaRepository offlineAreaRepository) {\n+  OfflineAreasViewModel(\n+      Navigator navigator,\n+      OfflineAreaRepository offlineAreaRepository,\n+      @ApplicationContext Context context) {\n     this.navigator = navigator;\n+    this.geocoder = new GeocodingManager(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg5MDkxNQ=="}, "originalCommit": {"oid": "3379d8971a8436cd8bb2700c936dc192f2612a6d"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2507, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}