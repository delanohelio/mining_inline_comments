{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4Nzg4NjQ0", "number": 795, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMjozMzoxOVrODbvhzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMjozMzoxOVrODbvhzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNDE2ODQ1OnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/WebViewAuthorizationFragment.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMjozMzoxOVrOFjZ4BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMjo0NjoyMlrOFjaLyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ==", "bodyText": "As a thought, what if this callback also listened for onPageStarted() so that the WebView determines both when to show and dismiss the spinner? Currently there's a bit of action-at-a-distance where onStart() shows and the callback hides.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372668421", "createdAt": "2020-01-29T22:33:19Z", "author": {"login": "iambmelt"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/WebViewAuthorizationFragment.java", "diffHunk": "@@ -80,10 +84,18 @@ void extractState(final Bundle state){\n     @Override\n     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\n         final View view = inflater.inflate(R.layout.common_activity_authentication, container, false);\n+        mProgressBar = view.findViewById(R.id.common_auth_webview_progressbar);\n \n         AzureActiveDirectoryWebViewClient webViewClient = new AzureActiveDirectoryWebViewClient(\n                 getActivity(),\n-                new AuthorizationCompletionCallback(), mRedirectUri);\n+                new AuthorizationCompletionCallback(),\n+                new OnPageLoadedCallback() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MjkwMg==", "bodyText": "I took that out because OAuth2WebViewClient.onPageStarted() is invoked every time a new page is loaded, and we don't want that because the user would see 2 progress bar at the same time (One rendered by the server, and the other by us).", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372672902", "createdAt": "2020-01-29T22:44:48Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/WebViewAuthorizationFragment.java", "diffHunk": "@@ -80,10 +84,18 @@ void extractState(final Bundle state){\n     @Override\n     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\n         final View view = inflater.inflate(R.layout.common_activity_authentication, container, false);\n+        mProgressBar = view.findViewById(R.id.common_auth_webview_progressbar);\n \n         AzureActiveDirectoryWebViewClient webViewClient = new AzureActiveDirectoryWebViewClient(\n                 getActivity(),\n-                new AuthorizationCompletionCallback(), mRedirectUri);\n+                new AuthorizationCompletionCallback(),\n+                new OnPageLoadedCallback() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ=="}, "originalCommit": {"oid": "8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MzQ4Mw==", "bodyText": "Oh yuck. OK, thanks Dome", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372673483", "createdAt": "2020-01-29T22:46:22Z", "author": {"login": "iambmelt"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/WebViewAuthorizationFragment.java", "diffHunk": "@@ -80,10 +84,18 @@ void extractState(final Bundle state){\n     @Override\n     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\n         final View view = inflater.inflate(R.layout.common_activity_authentication, container, false);\n+        mProgressBar = view.findViewById(R.id.common_auth_webview_progressbar);\n \n         AzureActiveDirectoryWebViewClient webViewClient = new AzureActiveDirectoryWebViewClient(\n                 getActivity(),\n-                new AuthorizationCompletionCallback(), mRedirectUri);\n+                new AuthorizationCompletionCallback(),\n+                new OnPageLoadedCallback() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ=="}, "originalCommit": {"oid": "8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2447, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}