{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1Nzk0MzY2", "number": 1032, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTo0M1rOEjOBGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjo1ODoyOVrOEjO3Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzY1MjczOnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTo0M1rOHRdC8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjo1MDoyOVrOHReCBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzcyOA==", "bodyText": "Is info really loud enough for this message?  I think it's at least a warning.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1032#discussion_r488063728", "createdAt": "2020-09-14T16:25:43Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "diffHunk": "@@ -567,6 +572,39 @@ public void putValueInSuccessEvent(ApiEndEvent event, Boolean result) {\n                 });\n     }\n \n+    /**\n+     * Invoke the logout endpoint on the specified browser.\n+     * If there are more than 1 session in the browser, an account picker will be displayed.\n+     * (Alternatively, we could pass the optional sessionID as one of the query string parameter, but we're not storing that at the moment).\n+     */\n+    private void logOutFromBrowser(@NonNull final Context context,\n+                                   @NonNull final RemoveAccountCommandParameters parameters) {\n+        final String methodName = \":logOutFromBrowser\";\n+\n+        String browserPackageName = null;\n+        try {\n+            final Browser browser = BrowserSelector.select(context, parameters.getBrowserSafeList());\n+            browserPackageName = browser.getPackageName();\n+        } catch (final ClientException e) {\n+            // Best effort. If none is passed to broker, then it will let the OS decide.\n+            Logger.error(TAG, e.getErrorCode(), e);\n+        }\n+\n+        try {\n+            final Intent intent = new Intent(Intent.ACTION_VIEW);\n+            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+            intent.setData(Uri.parse(AuthenticationConstants.Browser.LOGOUT_ENDPOINT_V2));\n+            if (browserPackageName != null) {\n+                intent.setPackage(browserPackageName);\n+            }\n+            context.startActivity(intent);\n+\n+        } catch (final ActivityNotFoundException e) {\n+            Logger.info(TAG + methodName,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f11978a974ba7f68ea82e00f9b357c5e171a83b"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2NjU4Ng==", "bodyText": "This means no browser is installed on the device (which is a valid case for some 'work devices')- nothing we can really do here.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1032#discussion_r488066586", "createdAt": "2020-09-14T16:30:22Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "diffHunk": "@@ -567,6 +572,39 @@ public void putValueInSuccessEvent(ApiEndEvent event, Boolean result) {\n                 });\n     }\n \n+    /**\n+     * Invoke the logout endpoint on the specified browser.\n+     * If there are more than 1 session in the browser, an account picker will be displayed.\n+     * (Alternatively, we could pass the optional sessionID as one of the query string parameter, but we're not storing that at the moment).\n+     */\n+    private void logOutFromBrowser(@NonNull final Context context,\n+                                   @NonNull final RemoveAccountCommandParameters parameters) {\n+        final String methodName = \":logOutFromBrowser\";\n+\n+        String browserPackageName = null;\n+        try {\n+            final Browser browser = BrowserSelector.select(context, parameters.getBrowserSafeList());\n+            browserPackageName = browser.getPackageName();\n+        } catch (final ClientException e) {\n+            // Best effort. If none is passed to broker, then it will let the OS decide.\n+            Logger.error(TAG, e.getErrorCode(), e);\n+        }\n+\n+        try {\n+            final Intent intent = new Intent(Intent.ACTION_VIEW);\n+            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+            intent.setData(Uri.parse(AuthenticationConstants.Browser.LOGOUT_ENDPOINT_V2));\n+            if (browserPackageName != null) {\n+                intent.setPackage(browserPackageName);\n+            }\n+            context.startActivity(intent);\n+\n+        } catch (final ActivityNotFoundException e) {\n+            Logger.info(TAG + methodName,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzcyOA=="}, "originalCommit": {"oid": "2f11978a974ba7f68ea82e00f9b357c5e171a83b"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA3OTg3OA==", "bodyText": "In that case, though, we wouldn't find a package name by examining the installed packages in BrowserSelector, right?  And we'll already log an error in those cases on line 590.  But if we didn't log that error, I think this would be a really strange occurrence.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1032#discussion_r488079878", "createdAt": "2020-09-14T16:50:29Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "diffHunk": "@@ -567,6 +572,39 @@ public void putValueInSuccessEvent(ApiEndEvent event, Boolean result) {\n                 });\n     }\n \n+    /**\n+     * Invoke the logout endpoint on the specified browser.\n+     * If there are more than 1 session in the browser, an account picker will be displayed.\n+     * (Alternatively, we could pass the optional sessionID as one of the query string parameter, but we're not storing that at the moment).\n+     */\n+    private void logOutFromBrowser(@NonNull final Context context,\n+                                   @NonNull final RemoveAccountCommandParameters parameters) {\n+        final String methodName = \":logOutFromBrowser\";\n+\n+        String browserPackageName = null;\n+        try {\n+            final Browser browser = BrowserSelector.select(context, parameters.getBrowserSafeList());\n+            browserPackageName = browser.getPackageName();\n+        } catch (final ClientException e) {\n+            // Best effort. If none is passed to broker, then it will let the OS decide.\n+            Logger.error(TAG, e.getErrorCode(), e);\n+        }\n+\n+        try {\n+            final Intent intent = new Intent(Intent.ACTION_VIEW);\n+            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+            intent.setData(Uri.parse(AuthenticationConstants.Browser.LOGOUT_ENDPOINT_V2));\n+            if (browserPackageName != null) {\n+                intent.setPackage(browserPackageName);\n+            }\n+            context.startActivity(intent);\n+\n+        } catch (final ActivityNotFoundException e) {\n+            Logger.info(TAG + methodName,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzcyOA=="}, "originalCommit": {"oid": "2f11978a974ba7f68ea82e00f9b357c5e171a83b"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Mzc5MTE1OnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjo1ODoyOVrOHReaEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjo1ODoyOVrOHReaEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA4NjAzMw==", "bodyText": "If you're going to add javadoc, add the method @param -eters.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1032#discussion_r488086033", "createdAt": "2020-09-14T16:58:29Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/BrokerMsalController.java", "diffHunk": "@@ -567,6 +572,39 @@ public void putValueInSuccessEvent(ApiEndEvent event, Boolean result) {\n                 });\n     }\n \n+    /**\n+     * Invoke the logout endpoint on the specified browser.\n+     * If there are more than 1 session in the browser, an account picker will be displayed.\n+     * (Alternatively, we could pass the optional sessionID as one of the query string parameter, but we're not storing that at the moment).\n+     */\n+    private void logOutFromBrowser(@NonNull final Context context,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f11978a974ba7f68ea82e00f9b357c5e171a83b"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2265, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}