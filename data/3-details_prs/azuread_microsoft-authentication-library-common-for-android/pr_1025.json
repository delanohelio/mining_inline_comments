{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5MjQ4MDAx", "number": 1025, "title": "Write test results to CSV", "bodyText": "Forked from #1005\nDone the following on top of #1005:\n\nRemove shadow plugin\nRemoved the repackaged kusto ingest sdk\nRemoved CSV Writer\nWrote custom csv writer\nNow only the results are written to CSV as part of test execution -- ingestion to Kusto is done in the ADO build pipeline as inline python script", "createdAt": "2020-09-04T03:45:33Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025", "merged": true, "mergeCommit": {"oid": "579bb971f6e86a15be31b2771a928ed91050ad59"}, "closed": true, "closedAt": "2020-09-04T18:09:33Z", "author": {"login": "shahzaibj"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_28voAH2gAyNDc5MjQ4MDAxOjZjMzUxMTExZTg5Yzg5MTgxZmQ2MjdmYjIyMzk2ZjNmMmYzZjVhYWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFoxrJgH2gAyNDc5MjQ4MDAxOmVjY2NlOTEyNTcwMTY3ODVhMmIyYjQwMzE0NjQ1ODMwMDI1NDNkZDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6c351111e89c89181fd627fb22396f3f2f3f5aaa", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6c351111e89c89181fd627fb22396f3f2f3f5aaa", "committedDate": "2020-08-17T18:44:32Z", "message": "Add support to send test results to ests kusto cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce6ae185c3379e8d8932c4570422568a01dec3db", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ce6ae185c3379e8d8932c4570422568a01dec3db", "committedDate": "2020-08-17T19:10:08Z", "message": "Merge branch 'dev' into shahzaibj/kusto-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6079e89fddb8094310b244bf073908a70522cd95", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6079e89fddb8094310b244bf073908a70522cd95", "committedDate": "2020-08-17T19:23:16Z", "message": "Use junit version from root project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2680d6e7a855eaad670be8a99aa355f9e4a04c1", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f2680d6e7a855eaad670be8a99aa355f9e4a04c1", "committedDate": "2020-08-17T19:36:50Z", "message": "Use latest version of csv writer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "248d8d7e10213989bfa9c28b095308acbe89d2de", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/248d8d7e10213989bfa9c28b095308acbe89d2de", "committedDate": "2020-08-17T19:52:39Z", "message": "Attempt at fixing build from subproject"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05629abe02991b3cabd78edea473a728973c09c3", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/05629abe02991b3cabd78edea473a728973c09c3", "committedDate": "2020-08-17T21:08:38Z", "message": "Second attempt at fixing build from subproject"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0854338f2c543567859fe2673b643e71dbc2849", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a0854338f2c543567859fe2673b643e71dbc2849", "committedDate": "2020-08-17T21:16:52Z", "message": "Exclude gson from kusto dep"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f317b55224c2a8b1d54a12ae763969edabc1829", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/8f317b55224c2a8b1d54a12ae763969edabc1829", "committedDate": "2020-08-17T22:23:12Z", "message": "Save test result file to user home location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea5f4b295c3f11b11d085d8d4a89ce46fbb2d5fb", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ea5f4b295c3f11b11d085d8d4a89ce46fbb2d5fb", "committedDate": "2020-08-18T01:06:28Z", "message": "Add javadoc to new source files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c04ae0c20dc477516709ddd4d35698ac2781f9a2", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/c04ae0c20dc477516709ddd4d35698ac2781f9a2", "committedDate": "2020-08-18T01:07:58Z", "message": "Add missing licenses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4d1acc5b35a9293ff15d17098135179def19698", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/e4d1acc5b35a9293ff15d17098135179def19698", "committedDate": "2020-08-18T01:15:18Z", "message": "Add comments to build.gradle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4b89cfb3e2998e0bea9c047a354e1155b5d99b7", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b4b89cfb3e2998e0bea9c047a354e1155b5d99b7", "committedDate": "2020-08-18T01:26:46Z", "message": "Configure sending test results to Kusto via boolean p param"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f368f7faccf25734dddede25f49af8c43a9854f4", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f368f7faccf25734dddede25f49af8c43a9854f4", "committedDate": "2020-08-19T16:40:11Z", "message": "Don't abort on lint for testutils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5cba7ef2983db78fdcc4a4e07a2631e157c3dbb", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d5cba7ef2983db78fdcc4a4e07a2631e157c3dbb", "committedDate": "2020-08-19T16:41:19Z", "message": "Merge branch 'dev' into shahzaibj/kusto-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b5aad164a937860176421ca35187f383159b07d", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/1b5aad164a937860176421ca35187f383159b07d", "committedDate": "2020-08-19T17:34:09Z", "message": "Downgrade csv writer version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fa1694ab4128143e52b929464557a8aa4528b0c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2fa1694ab4128143e52b929464557a8aa4528b0c", "committedDate": "2020-08-20T01:47:01Z", "message": "Add package base name to shadow jar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f37abd23bd6e397a4d8eb4402860ac475873105b", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f37abd23bd6e397a4d8eb4402860ac475873105b", "committedDate": "2020-08-20T01:51:12Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "325e550d9b82c4a3e9ccc12c730e7360e422c3e0", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/325e550d9b82c4a3e9ccc12c730e7360e422c3e0", "committedDate": "2020-08-23T17:47:34Z", "message": "Merge branch 'dev' into shahzaibj/kusto-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca11e720da170b47a38552abc672d7473ce3ecd8", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ca11e720da170b47a38552abc672d7473ce3ecd8", "committedDate": "2020-08-25T01:47:11Z", "message": "Disable connectedCheck for testutils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1becd2a04b0ee7a3a856264caccfbcfa4fede54d", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/1becd2a04b0ee7a3a856264caccfbcfa4fede54d", "committedDate": "2020-08-25T01:47:52Z", "message": "Refactor Kusto Utils to config based model"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2316c6bdf9e9d360e77691751ad86d3c2c208ef5", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2316c6bdf9e9d360e77691751ad86d3c2c208ef5", "committedDate": "2020-09-03T23:27:56Z", "message": "Remove repackaged kusto client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03fd441142aa0f4cf387fb1c917b676e22f2ca8b", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/03fd441142aa0f4cf387fb1c917b676e22f2ca8b", "committedDate": "2020-09-04T03:24:05Z", "message": "Use custom csv writer to avoid dex error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc0ce59e9c1e7adb392d774ca281ca24ec7303b2", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/cc0ce59e9c1e7adb392d774ca281ca24ec7303b2", "committedDate": "2020-09-04T03:35:07Z", "message": "Merge branch 'dev' into shahzaibj/kusto-removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b75dcbd8295cc3571f1007eea05e7b23401246c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/4b75dcbd8295cc3571f1007eea05e7b23401246c", "committedDate": "2020-09-04T03:38:04Z", "message": "Remove shadow plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f04b38166a6bdcc867155aa7a40359727b6e4ef5", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f04b38166a6bdcc867155aa7a40359727b6e4ef5", "committedDate": "2020-09-04T03:41:42Z", "message": "Rename variable for write test results to CSV"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a2eb86b954ec3ebf493ec1516b65eecc3b62d31c", "committedDate": "2020-09-04T03:44:26Z", "message": "Revert don't abort on lint for testutils"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODE0NzUx", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025#pullrequestreview-482814751", "createdAt": "2020-09-04T16:54:34Z", "commit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjo1NDozNFrOHNVf0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjo1NDozNFrOHNVf0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0NTc0Nw==", "bodyText": "Maybe close in a finally block.  Android studio might be able to desugar a try-with-resources for you, which would be nice.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025#discussion_r483745747", "createdAt": "2020-09-04T16:54:34Z", "author": {"login": "AdamBJohnsonx"}, "path": "testutils/src/main/java/com/microsoft/identity/internal/testutils/kusto/TestResultFileUtils.java", "diffHunk": "@@ -0,0 +1,70 @@\n+// Copyright (c) Microsoft Corporation.\n+// All rights reserved.\n+//\n+// This code is licensed under the MIT License.\n+//\n+// Permission is hereby granted, free of charge, to any person obtaining a copy\n+// of this software and associated documentation files(the \"Software\"), to deal\n+// in the Software without restriction, including without limitation the rights\n+// to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+// copies of the Software, and to permit persons to whom the Software is\n+// furnished to do so, subject to the following conditions :\n+//\n+// The above copyright notice and this permission notice shall be included in\n+// all copies or substantial portions of the Software.\n+//\n+// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+// THE SOFTWARE.\n+package com.microsoft.identity.internal.testutils.kusto;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.io.File;\n+import java.io.FileWriter;\n+import java.io.IOException;\n+\n+/**\n+ * Utilities to interact with test result file during android tests.\n+ */\n+public class TestResultFileUtils {\n+\n+    public final static String TEST_RESULT_FILE_NAME = \"test-results.csv\";\n+\n+    /**\n+     * Get the file containing the android test results.\n+     *\n+     * @return a File object containing the android test results\n+     */\n+    public static File getTestResultFile() {\n+        final File parent = new File(System.getProperty(\"user.home\"));\n+        return new File(parent, TEST_RESULT_FILE_NAME);\n+    }\n+\n+    /**\n+     * Write android client test results to a csv file.\n+     *\n+     * @param data the test data that needs to be written to csv\n+     */\n+    public static void writeTestResultsToCsv(@NonNull final EstsKustoClientTestTableData data) {\n+        final File testResultFile = getTestResultFile();\n+        try {\n+            // create FileWriter object with file as parameter\n+            final FileWriter outputFile = new FileWriter(testResultFile, true);\n+\n+            // create CSVWriter object with FileWriter object as parameter\n+            final KustoTableDataCsvWriter writer = new KustoTableDataCsvWriter(outputFile);\n+\n+            writer.writeNext(data);\n+\n+            // closing writer connection\n+            writer.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c"}, "originalPosition": 65}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODMzOTQy", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025#pullrequestreview-482833942", "createdAt": "2020-09-04T17:28:48Z", "commit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzoyODo0OFrOHNWZUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzoyODo0OFrOHNWZUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc2MDQ2NQ==", "bodyText": "nit: if we're OK with 1 and Y also being true things, then this can all be s == null ? false : s.toBoolean()", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025#discussion_r483760465", "createdAt": "2020-09-04T17:28:48Z", "author": {"login": "AdamBJohnsonx"}, "path": "testutils/build.gradle", "diffHunk": "@@ -54,8 +61,17 @@ dependencies {\n     implementation \"com.google.code.gson:gson:$rootProject.ext.gsonVersion\"\n     implementation \"com.nimbusds:nimbus-jose-jwt:$rootProject.ext.nimbusVersion\"\n     implementation 'androidx.appcompat:appcompat:1.0.2'\n-    testImplementation 'junit:junit:4.12'\n-    testImplementation \"org.robolectric:robolectric:$rootProject.ext.robolectricVersion\"\n-    androidTestImplementation 'androidx.test:runner:1.2.0'\n-    androidTestImplementation 'androidx.test.espresso:espresso-core:3.2.0'\n+    implementation \"junit:junit:$rootProject.ext.junitVersion\"\n+    compileOnly \"org.projectlombok:lombok:$rootProject.ext.lombokVersion\"\n+    annotationProcessor \"org.projectlombok:lombok:$rootProject.ext.lombokVersion\"\n+}\n+\n+static boolean getBoolean(final String s) {\n+    if (s == null || s == \"\") {\n+        return false;\n+    } else if (s.equalsIgnoreCase(\"true\")) {\n+        return true;\n+    } else {\n+        return false;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODM0MTg4", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1025#pullrequestreview-482834188", "createdAt": "2020-09-04T17:29:12Z", "commit": {"oid": "a2eb86b954ec3ebf493ec1516b65eecc3b62d31c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbb60c3d1c0a0b26a56653f03c05e7a2e60a56e7", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/fbb60c3d1c0a0b26a56653f03c05e7a2e60a56e7", "committedDate": "2020-09-04T17:36:46Z", "message": "Address comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eccce91257016785a2b2b4031464583002543dd1", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/eccce91257016785a2b2b4031464583002543dd1", "committedDate": "2020-09-04T17:37:19Z", "message": "Merge branch 'dev' into shahzaibj/kusto-removed"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1560, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}