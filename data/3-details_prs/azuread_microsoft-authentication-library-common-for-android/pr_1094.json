{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5NzE1MDIy", "number": 1094, "title": "Changes for UI Automation Pipeline", "bodyText": "This PR achieves the following:\n\nAdd rule to copy installed APK to /data/local/tmp folder\n-- This is needed because Firebase will install the APK on the device even before a test begins....and our test infrastructure will go and delete it right away....because we do clean up before a test begins i.e. we uninstall Broker apps before each test and re-install if the test requires it. This then poses a problem with Firebase because we need the ability to uninstall and re-install these APKs at specific point in execution of the test. To achieve this, we first copy the installed APK to /data/local/tmp folder....and then we proceed with our regular flow...which is to uninstall and re-install...but now since we have copied to a different location, we can actually proceed with uninstall/re-install.\nAdd support to accept Google Play terms of service when installing APK from Google Play\nAdd a RulesHelper to create a RuleChain and apply that directly when possible (instead of using the rule order notation)...this is much cleaner\nAdd some logs to rules execution\nEnable logcat logs for MSAL\n\nWe will be adding more logs to automation code over time\nRelated MSAL PR: AzureAD/microsoft-authentication-library-for-android#1231", "createdAt": "2020-10-26T02:19:26Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1094", "merged": true, "mergeCommit": {"oid": "2e0ad002ede74535cf3c99513b6a128f45b280bd"}, "closed": true, "closedAt": "2020-11-16T21:57:04Z", "author": {"login": "shahzaibj"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9nzAEAH2gAyNTA5NzE1MDIyOmE4MmRiYTY3MTI5YzFkMzEyZWMxYWFlZjE2YmFmZjlhZWI4ZTA5OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdc61x4gH2gAyNTA5NzE1MDIyOmEyMTcwYmQ1M2NhYTgwNjk0Nzk5YjA1ZTI0YTcwNmZjODA1YzllMmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a82dba67129c1d312ec1aaef16baff9aeb8e0990", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a82dba67129c1d312ec1aaef16baff9aeb8e0990", "committedDate": "2020-08-10T19:57:28Z", "message": "Changes for UI Test running on pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d16d4033fe26fe8657d1a2c1ce2d081ee5989ef7", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d16d4033fe26fe8657d1a2c1ce2d081ee5989ef7", "committedDate": "2020-08-11T01:44:55Z", "message": "Catch errors on app install and handle TOU in PlayStore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fbb7429dce303fb1090080391c264b3d4878f4a", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0fbb7429dce303fb1090080391c264b3d4878f4a", "committedDate": "2020-10-21T23:39:22Z", "message": "Merge branch 'dev' into shahzaibj/changes-for-ui-test-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8afd9e4392ec5ae3b00181a8346cc5fad980264", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d8afd9e4392ec5ae3b00181a8346cc5fad980264", "committedDate": "2020-10-23T16:57:32Z", "message": "Invoke copy method for BrokerHost apk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00ed28b4ad000d04ff380a1e2925146b75cc9da8", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/00ed28b4ad000d04ff380a1e2925146b75cc9da8", "committedDate": "2020-11-11T02:15:46Z", "message": "Merge branch 'dev' into shahzaibj/changes-for-ui-test-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2cbf99bae1a715e5d71ecb8948b2dd9be243ed6", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b2cbf99bae1a715e5d71ecb8948b2dd9be243ed6", "committedDate": "2020-11-11T21:33:08Z", "message": "Changes for firebase pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ca555293e2ccd52a52154ee0d478cc3c2315056", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/9ca555293e2ccd52a52154ee0d478cc3c2315056", "committedDate": "2020-11-12T20:50:09Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e421b5a40decd8d119d52e7410fd9ee1f22adda6", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/e421b5a40decd8d119d52e7410fd9ee1f22adda6", "committedDate": "2020-11-13T16:37:33Z", "message": "Merge branch 'dev' into shahzaibj/changes-for-ui-test-pipeline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNDQ3NjAz", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1094#pullrequestreview-530447603", "createdAt": "2020-11-13T22:05:14Z", "commit": {"oid": "e421b5a40decd8d119d52e7410fd9ee1f22adda6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMjowNToxNFrOHzBKHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMjowNToxNFrOHzBKHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI1ODM5OQ==", "bodyText": "This is just refactor....just relocating this code here from another class where it was previously located.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1094#discussion_r523258399", "createdAt": "2020-11-13T22:05:14Z", "author": {"login": "shahzaibj"}, "path": "uiautomationutilities/src/main/java/com/microsoft/identity/client/ui/automation/broker/AbstractTestBroker.java", "diffHunk": "@@ -53,6 +55,25 @@\n  */\n public abstract class AbstractTestBroker extends App implements ITestBroker {\n \n+    private final static String TAG = AbstractTestBroker.class.getSimpleName();\n+\n+    @Override\n+    public void uninstall() {\n+        super.uninstall();\n+\n+        if (isInstalled()) {\n+            // The broker app will still be installed on the device if it is enabled\n+            // as a device admin. In this case, we need to disable the admin and then\n+            // uninstall.\n+            Log.w(TAG, \"Unable to uninstall broker \" + getAppName() + \" from device...\" +\n+                    \"the broker is potentially enabled as an active device admin.\");\n+            Log.i(TAG, \"Disabling admin for \" + getAppName());\n+            TestContext.getTestContext().getTestDevice().getSettings().disableAdmin(getAdminName());\n+            Log.i(TAG, \"Reattempting uninstall for \" + getAppName());\n+            super.uninstall();\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e421b5a40decd8d119d52e7410fd9ee1f22adda6"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNDUyMjI4", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1094#pullrequestreview-530452228", "createdAt": "2020-11-13T22:15:56Z", "commit": {"oid": "e421b5a40decd8d119d52e7410fd9ee1f22adda6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1e78267d1c828f5e07d2bfa04089a6aafafa3c8", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b1e78267d1c828f5e07d2bfa04089a6aafafa3c8", "committedDate": "2020-11-16T01:36:31Z", "message": "Merge branch 'dev' into shahzaibj/changes-for-ui-test-pipeline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2170bd53caa80694799b05e24a706fc805c9e2e", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a2170bd53caa80694799b05e24a706fc805c9e2e", "committedDate": "2020-11-16T01:40:21Z", "message": "Change sys print statements to logcat logs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1399, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}