{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3ODQwNDk3", "number": 880, "title": "Refactoring with lombok + Throttling", "bodyText": "Refactor Operation Parameters into immutable Command Parameters classes using Lombok\nUse toBuilder to create a clone when necessary\nI've also added back throttling that we used to have in our code before we got the memory leak bug.", "createdAt": "2020-04-02T22:30:42Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880", "merged": true, "mergeCommit": {"oid": "f614e94c75d32d4cd96ec2a52029d272f105f977"}, "closed": true, "closedAt": "2020-04-20T22:47:50Z", "author": {"login": "shahzaibj"}, "timelineItems": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTyEE8gH2gAyMzk3ODQwNDk3OjQ2YjFjMWFlYjNjODE3OGJjMjI2NTFlZTIzMzY3MTU1MzA1YzMxZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZlZmHAFqTM5NjgwMTAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46b1c1aeb3c8178bc22651ee23367155305c31f3", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/46b1c1aeb3c8178bc22651ee23367155305c31f3", "committedDate": "2020-04-02T20:10:21Z", "message": "Refactor commands using lombok"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "381e6df3d6f8716783909b052fa96bb49a38008c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/381e6df3d6f8716783909b052fa96bb49a38008c", "committedDate": "2020-04-02T22:27:30Z", "message": "Merge branch 'dev' into shahzaibj/lombok"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dc442fadc89c169662ac09d2cc33f98f589c0db", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/3dc442fadc89c169662ac09d2cc33f98f589c0db", "committedDate": "2020-04-03T01:00:37Z", "message": "Remove nonnull annotations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdde397aa3ca9eda9c57ffbabd7783c928ca809b", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/cdde397aa3ca9eda9c57ffbabd7783c928ca809b", "committedDate": "2020-04-03T16:11:39Z", "message": "Add expose annotations to command parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecdd3ddf9c88c93d6301d634721c9c07a2da8346", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ecdd3ddf9c88c93d6301d634721c9c07a2da8346", "committedDate": "2020-04-03T18:36:48Z", "message": "Add transient for command parameters where needed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25614541a76a04192eadcb3c68bc3ff70492f42e", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/25614541a76a04192eadcb3c68bc3ff70492f42e", "committedDate": "2020-04-03T19:19:21Z", "message": "Use lombok as compile time only"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bde1fdd53eca0813c6293c9feb71b1ba0f372fea", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/bde1fdd53eca0813c6293c9feb71b1ba0f372fea", "committedDate": "2020-04-03T19:28:01Z", "message": "Remove disabling of lint for invalid package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15e835962ce41679f422deb20b7ebd3e557d2889", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/15e835962ce41679f422deb20b7ebd3e557d2889", "committedDate": "2020-04-03T19:34:59Z", "message": "Remove commented code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "278e5e7661adfb38b804f3519a0a362ed7da3626", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/278e5e7661adfb38b804f3519a0a362ed7da3626", "committedDate": "2020-04-03T20:49:08Z", "message": "Add validate logic to silent token command parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2140b1786a32878d3b16cd9e24fa085af601b8a2", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2140b1786a32878d3b16cd9e24fa085af601b8a2", "committedDate": "2020-04-03T20:50:17Z", "message": "Remove operation parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "374138f5fc62c73a5ca47dfe87daa8dc829041ff", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/374138f5fc62c73a5ca47dfe87daa8dc829041ff", "committedDate": "2020-04-03T20:59:13Z", "message": "Add missing license"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "376d3bed8538c95a4306bef07cae52154bf32c8d", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/376d3bed8538c95a4306bef07cae52154bf32c8d", "committedDate": "2020-04-03T21:15:37Z", "message": "Remove broker operation parameters, add broker request type enum"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2236ac521fdfee9e49b458d75b42b176ec4c7818", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2236ac521fdfee9e49b458d75b42b176ec4c7818", "committedDate": "2020-04-06T22:37:18Z", "message": "Make parameter collections immutable by returning a clone"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NjkyMTcz", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-388692173", "createdAt": "2020-04-06T23:42:03Z", "commit": {"oid": "2236ac521fdfee9e49b458d75b42b176ec4c7818"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo0MjowM1rOGBt2Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo0MjowM1rOGBt2Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1Mjg5MA==", "bodyText": "Is this import needed?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r404452890", "createdAt": "2020-04-06T23:42:03Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/CommandCallback.java", "diffHunk": "@@ -20,7 +20,9 @@\n //  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n //  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n //  THE SOFTWARE.\n-package com.microsoft.identity.common.internal.controllers;\n+package com.microsoft.identity.common.internal.commands;\n+\n+import com.microsoft.identity.common.internal.controllers.TaskCompletedCallbackWithError;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2236ac521fdfee9e49b458d75b42b176ec4c7818"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4Njk1MjA5", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-388695209", "createdAt": "2020-04-06T23:50:35Z", "commit": {"oid": "2236ac521fdfee9e49b458d75b42b176ec4c7818"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo1MDozNVrOGBuA_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo1MDozNVrOGBuA_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NTY3Ng==", "bodyText": "Is this needed?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r404455676", "createdAt": "2020-04-06T23:50:35Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/CommandResultCache.java", "diffHunk": "@@ -24,6 +24,8 @@\n \n import android.util.LruCache;\n \n+import com.microsoft.identity.common.internal.commands.BaseCommand;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2236ac521fdfee9e49b458d75b42b176ec4c7818"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "007f6600f682c38ce49270ef7ee5667f37996738", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/007f6600f682c38ce49270ef7ee5667f37996738", "committedDate": "2020-04-06T23:55:39Z", "message": "Move extra scopes and extra qp to interactive parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe4ea2eeba32d7a1cb0131ff7417619345f48cf5", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/fe4ea2eeba32d7a1cb0131ff7417619345f48cf5", "committedDate": "2020-04-07T00:37:32Z", "message": "Remove setting extra qp on silent parameters in broker adapters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6277dfd1bd79f11fdae7c5a5627c59359e89736", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f6277dfd1bd79f11fdae7c5a5627c59359e89736", "committedDate": "2020-04-10T03:26:32Z", "message": "Add equals and hash code annotation to all commands and parameter classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abdcee2c6aec85b43cf5d53ce763a4151efbb494", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/abdcee2c6aec85b43cf5d53ce763a4151efbb494", "committedDate": "2020-04-10T03:26:57Z", "message": "Add back throttling to Command Dispatcher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8d8895f35a36fd5a9a97a33b1f9b1334dfc6be7", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a8d8895f35a36fd5a9a97a33b1f9b1334dfc6be7", "committedDate": "2020-04-10T03:27:16Z", "message": "Merge branch 'dev' into shahzaibj/lombok"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMzM4MTEz", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-392338113", "createdAt": "2020-04-13T18:28:35Z", "commit": {"oid": "a8d8895f35a36fd5a9a97a33b1f9b1334dfc6be7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODoyODozNVrOGEwM1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODoyODozNVrOGEwM1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYzNzIwNg==", "bodyText": "Need to move these versions to version files", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r407637206", "createdAt": "2020-04-13T18:28:35Z", "author": {"login": "shahzaibj"}, "path": "common/build.gradle", "diffHunk": "@@ -84,6 +84,8 @@ dependencies {\n     implementation \"com.google.code.gson:gson:$rootProject.ext.gsonVersion\"\n     implementation \"androidx.browser:browser:$rootProject.ext.browserVersion\"\n     implementation \"androidx.constraintlayout:constraintlayout:$rootProject.ext.constraintLayoutVersion\"\n+    compileOnly 'org.projectlombok:lombok:1.18.12'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8d8895f35a36fd5a9a97a33b1f9b1334dfc6be7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0531f18337327232ed930dd864dac62eb5f585c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/c0531f18337327232ed930dd864dac62eb5f585c", "committedDate": "2020-04-14T15:54:14Z", "message": "Add lombok version to version file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dee485b6e89755c3d491b7a74a6662306eeb9ec", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/9dee485b6e89755c3d491b7a74a6662306eeb9ec", "committedDate": "2020-04-14T16:03:50Z", "message": "Format code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/155e289ccdbd92883bf21cedf709c27f530c5f47", "committedDate": "2020-04-15T18:22:52Z", "message": "Merge branch 'dev' into shahzaibj/lombok"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MzQzMjc1", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-394343275", "createdAt": "2020-04-16T06:52:24Z", "commit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MjoyNFrOGGW-4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNzo1Nzo0OVrOGGZICQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMTE4NA==", "bodyText": "nit: add @ getter and remove getName()?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409321184", "createdAt": "2020-04-16T06:52:24Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/authscheme/AbstractAuthenticationScheme.java", "diffHunk": "@@ -26,9 +26,12 @@\n \n import com.google.gson.annotations.SerializedName;\n \n+import lombok.EqualsAndHashCode;\n+\n /**\n  * Abstract base class for AuthenticationSchemes.\n  */\n+@EqualsAndHashCode", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMTYyNA==", "bodyText": "nit: add extra line above", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409321624", "createdAt": "2020-04-16T06:53:16Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/Command.java", "diffHunk": "@@ -20,10 +20,15 @@\n //  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n //  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n //  THE SOFTWARE.\n-package com.microsoft.identity.common.internal.controllers;\n+package com.microsoft.identity.common.internal.commands;\n+\n+import com.microsoft.identity.common.internal.controllers.BaseController;\n \n public interface Command<T> {\n     T execute() throws Exception;\n \n     boolean isEligibleForEstsTelemetry();\n+    BaseController getDefaultController();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyNDA0OA==", "bodyText": "nit: one param per line for readability.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409324048", "createdAt": "2020-04-16T06:58:34Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/GetDeviceModeCommand.java", "diffHunk": "@@ -20,33 +20,35 @@\n //  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n //  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n //  THE SOFTWARE.\n-package com.microsoft.identity.common.internal.controllers;\n+package com.microsoft.identity.common.internal.commands;\n \n import androidx.annotation.NonNull;\n \n-import com.microsoft.identity.common.internal.request.OperationParameters;\n+import com.microsoft.identity.common.internal.commands.parameters.CommandParameters;\n+import com.microsoft.identity.common.internal.controllers.BaseController;\n+\n+import java.util.List;\n+\n+import lombok.EqualsAndHashCode;\n \n /**\n  * Command class to call controllers to remove the account and return the result to\n  * {@see com.microsoft.identity.common.internal.controllers.CommandDispatcher}.\n  */\n+@EqualsAndHashCode(callSuper = true)\n public class GetDeviceModeCommand extends BaseCommand<Boolean> {\n-    private static final String TAG = GetDeviceModeCommand.class.getSimpleName();\n \n-    public GetDeviceModeCommand(@NonNull final OperationParameters parameters,\n-                                @NonNull final BaseController controller,\n-                                @NonNull final CommandCallback callback) {\n-        super(parameters, controller, callback);\n+    public GetDeviceModeCommand(@NonNull CommandParameters parameters, @NonNull BaseController controller, @NonNull CommandCallback callback, @NonNull String publicApiId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMzMTE2Mw==", "bodyText": "nit: moving file in the middle of the change makes it harder to review IMO. (i.e. git could get drunk like what we're seeing in this file)\nNext time, let's move the files in a separate PR.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409331163", "createdAt": "2020-04-16T07:13:50Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/SilentTokenCommand.java", "diffHunk": "@@ -20,7 +20,7 @@\n //  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n //  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n //  THE SOFTWARE.\n-package com.microsoft.identity.common.internal.controllers;\n+package com.microsoft.identity.common.internal.commands;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0OTg3NQ==", "bodyText": "nit: what does this mean? can't find it in the document.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409349875", "createdAt": "2020-04-16T07:47:47Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/parameters/InteractiveTokenCommandParameters.java", "diffHunk": "@@ -0,0 +1,85 @@\n+// Copyright (c) Microsoft Corporation.\n+// All rights reserved.\n+//\n+// This code is licensed under the MIT License.\n+//\n+// Permission is hereby granted, free of charge, to any person obtaining a copy\n+// of this software and associated documentation files(the \"Software\"), to deal\n+// in the Software without restriction, including without limitation the rights\n+// to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+// copies of the Software, and to permit persons to whom the Software is\n+// furnished to do so, subject to the following conditions :\n+//\n+// The above copyright notice and this permission notice shall be included in\n+// all copies or substantial portions of the Software.\n+//\n+// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+// THE SOFTWARE.\n+package com.microsoft.identity.common.internal.commands.parameters;\n+\n+import android.app.Activity;\n+import android.util.Pair;\n+\n+import androidx.fragment.app.Fragment;\n+\n+import com.google.gson.annotations.Expose;\n+import com.microsoft.identity.common.internal.providers.oauth2.OpenIdConnectPromptParameter;\n+import com.microsoft.identity.common.internal.ui.AuthorizationAgent;\n+import com.microsoft.identity.common.internal.ui.browser.BrowserDescriptor;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.List;\n+\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.experimental.SuperBuilder;\n+\n+@Getter\n+@EqualsAndHashCode(callSuper = true)\n+@SuperBuilder(toBuilder = true)\n+public class InteractiveTokenCommandParameters extends TokenCommandParameters {\n+\n+    @EqualsAndHashCode.Exclude\n+    private transient Activity activity;\n+\n+    @EqualsAndHashCode.Exclude\n+    private transient Fragment fragment;\n+\n+    private transient List<BrowserDescriptor> browserSafeList;\n+\n+    private transient HashMap<String, String> requestHeaders;\n+\n+    private boolean brokerBrowserSupportEnabled;\n+\n+    private String loginHint;\n+\n+    @Expose()\n+    private OpenIdConnectPromptParameter prompt;\n+\n+    @Expose()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1MTU4MQ==", "bodyText": "nit: are we including the throttling work in this PR also? if yes, the title is sort of misleading.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409351581", "createdAt": "2020-04-16T07:50:31Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/CommandDispatcher.java", "diffHunk": "@@ -79,6 +86,17 @@ public static void submitSilent(@NonNull final BaseCommand command) {\n                 \"Beginning execution of silent command.\"\n         );\n \n+        if (sExecutingCommands.contains(command)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1NDY4NA==", "bodyText": "why hardcoded false?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409354684", "createdAt": "2020-04-16T07:55:19Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -99,9 +106,9 @@ public BrokerRequest brokerRequestFromAcquireTokenParameters(@NonNull final Acqu\n                         parameters.getExtraQueryStringParameters() != null ?\n                                 QueryParamsAdapter._toJson(parameters.getExtraQueryStringParameters())\n                                 : null\n-                ).prompt(parameters.getOpenIdConnectPromptParameter().name())\n+                ).prompt(parameters.getPrompt().name())\n                 .claims(parameters.getClaimsRequestJson())\n-                .forceRefresh(parameters.getForceRefresh())\n+                .forceRefresh(false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1NTAyNw==", "bodyText": "slow clap \ud83d\udc4f", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409355027", "createdAt": "2020-04-16T07:55:50Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -210,42 +200,47 @@ public BrokerAcquireTokenOperationParameters brokerInteractiveParametersFromActi\n \n         if (authority != null) {\n             authority.setMultipleCloudsSupported(brokerRequest.getMultipleCloudsSupported());\n-            parameters.setAuthority(authority);\n         }\n \n-        parameters.setScopes(getScopesAsSet(brokerRequest.getScope()));\n-\n-        parameters.setClientId(brokerRequest.getClientId());\n-\n-        parameters.setRedirectUri(brokerRequest.getRedirect());\n-\n-        parameters.setLoginHint(brokerRequest.getUserName());\n-\n         String correlationIdString = brokerRequest.getCorrelationId();\n \n         if (TextUtils.isEmpty(correlationIdString)) {\n             UUID correlationId = UUID.randomUUID();\n             correlationIdString = correlationId.toString();\n         }\n-        parameters.setCorrelationId(correlationIdString);\n \n-        parameters.setClaimsRequest(brokerRequest.getClaims());\n+        Logger.info(TAG, \"Authorization agent passed in by MSAL: \" + brokerRequest.getAuthorizationAgent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1NTY1Ng==", "bodyText": "nit: can we do nested method calling here?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409355656", "createdAt": "2020-04-16T07:56:52Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -210,42 +200,47 @@ public BrokerAcquireTokenOperationParameters brokerInteractiveParametersFromActi\n \n         if (authority != null) {\n             authority.setMultipleCloudsSupported(brokerRequest.getMultipleCloudsSupported());\n-            parameters.setAuthority(authority);\n         }\n \n-        parameters.setScopes(getScopesAsSet(brokerRequest.getScope()));\n-\n-        parameters.setClientId(brokerRequest.getClientId());\n-\n-        parameters.setRedirectUri(brokerRequest.getRedirect());\n-\n-        parameters.setLoginHint(brokerRequest.getUserName());\n-\n         String correlationIdString = brokerRequest.getCorrelationId();\n \n         if (TextUtils.isEmpty(correlationIdString)) {\n             UUID correlationId = UUID.randomUUID();\n             correlationIdString = correlationId.toString();\n         }\n-        parameters.setCorrelationId(correlationIdString);\n \n-        parameters.setClaimsRequest(brokerRequest.getClaims());\n+        Logger.info(TAG, \"Authorization agent passed in by MSAL: \" + brokerRequest.getAuthorizationAgent());\n \n-        parameters.setOpenIdConnectPromptParameter(\n-                brokerRequest.getPrompt() != null ?\n+        final BrokerInteractiveTokenCommandParameters.BrokerInteractiveTokenCommandParametersBuilder\n+                commandParametersBuilder = BrokerInteractiveTokenCommandParameters.builder()\n+                .authenticationScheme(getAuthenticationScheme(callingActivity, brokerRequest))\n+                .activity(callingActivity)\n+                .androidApplicationContext(callingActivity.getApplicationContext())\n+                .sdkType(SdkType.MSAL)\n+                .callerUid(callingAppUid)\n+                .callerPackageName(brokerRequest.getApplicationName())\n+                .callerAppVersion(brokerRequest.getApplicationVersion())\n+                .extraQueryStringParameters(extraQP)\n+                .authority(authority)\n+                .scopes(getScopesAsSet(brokerRequest.getScope()))\n+                .clientId(brokerRequest.getClientId())\n+                .redirectUri(brokerRequest.getRedirect())\n+                .loginHint(brokerRequest.getUserName())\n+                .correlationId(correlationIdString)\n+                .claimsRequestJson(brokerRequest.getClaims())\n+                .prompt(brokerRequest.getPrompt() != null ?\n                         OpenIdConnectPromptParameter.valueOf(brokerRequest.getPrompt()) :\n-                        OpenIdConnectPromptParameter.NONE\n-        );\n-        Logger.info(TAG, \"Authorization agent passed in by MSAL: \" + brokerRequest.getAuthorizationAgent());\n+                        OpenIdConnectPromptParameter.NONE);\n+\n         if (brokerRequest.getAuthorizationAgent() != null\n                 && brokerRequest.getAuthorizationAgent().equalsIgnoreCase(AuthorizationAgent.BROWSER.name())\n-                && isCallingPackageIntune(parameters.getCallerPackageName())) { // TODO : Remove this whenever we enable System Browser support in Broker for apps.\n+                && isCallingPackageIntune(brokerRequest.getApplicationName())) { // TODO : Remove this whenever we enable System Browser support in Broker for apps.\n             Logger.info(TAG, \"Setting Authorization Agent to Browser for Intune app\");\n-            parameters.setAuthorizationAgent(AuthorizationAgent.BROWSER);\n-            parameters.setBrokerBrowserSupportEnabled(true);\n-            parameters.setBrowserSafeList(getBrowserSafeListForBroker());\n+            commandParametersBuilder.authorizationAgent(AuthorizationAgent.BROWSER);\n+            commandParametersBuilder.brokerBrowserSupportEnabled(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1NjI5Nw==", "bodyText": "why removing this?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409356297", "createdAt": "2020-04-16T07:57:49Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -304,40 +280,35 @@ public BrokerAcquireTokenSilentOperationParameters brokerSilentParametersFromBun\n             );\n         }\n \n-        parameters.setAuthority(authority);\n-\n         String correlationIdString = bundle.getString(\n                 brokerRequest.getCorrelationId()\n         );\n         if (TextUtils.isEmpty(correlationIdString)) {\n             UUID correlationId = UUID.randomUUID();\n             correlationIdString = correlationId.toString();\n         }\n-        parameters.setCorrelationId(correlationIdString);\n-\n-        parameters.setScopes(\n-                getScopesAsSet(brokerRequest.getScope())\n-        );\n-\n-        parameters.setRedirectUri(brokerRequest.getRedirect());\n \n-        parameters.setClientId(brokerRequest.getClientId());\n-\n-        parameters.setForceRefresh(brokerRequest.getForceRefresh());\n-\n-        parameters.setClaimsRequest(brokerRequest.getClaims());\n-\n-        parameters.setLoginHint(brokerRequest.getUserName());\n-\n-        parameters.setHomeAccountId(brokerRequest.getHomeAccountId());\n-\n-        parameters.setLocalAccountId(brokerRequest.getLocalAccountId());\n+        final BrokerSilentTokenCommandParameters commandParameters = BrokerSilentTokenCommandParameters\n+                .builder()\n+                .authenticationScheme(getAuthenticationScheme(context, brokerRequest))\n+                .androidApplicationContext(context)\n+                .accountManagerAccount(account)\n+                .sdkType(SdkType.MSAL)\n+                .callerUid(callingAppUid)\n+                .callerPackageName(brokerRequest.getApplicationName())\n+                .callerAppVersion(brokerRequest.getApplicationVersion())\n+                .authority(authority)\n+                .correlationId(correlationIdString)\n+                .scopes(getScopesAsSet(brokerRequest.getScope()))\n+                .redirectUri(brokerRequest.getRedirect())\n+                .clientId(brokerRequest.getClientId())\n+                .forceRefresh(brokerRequest.getForceRefresh())\n+                .claimsRequestJson(brokerRequest.getClaims())\n+                .loginHint(brokerRequest.getUserName())\n+                .homeAccountId(brokerRequest.getHomeAccountId())\n+                .localAccountId(brokerRequest.getLocalAccountId())\n+                .build();\n \n-        if (!TextUtils.isEmpty(brokerRequest.getExtraQueryStringParameter())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 263}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NzY0NjU1", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-394764655", "createdAt": "2020-04-16T15:44:30Z", "commit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNTo0NDozMVrOGGrqAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNTo0NDozMVrOGGrqAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY1OTkwNg==", "bodyText": "Need immutable getter for this collection too", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r409659906", "createdAt": "2020-04-16T15:44:31Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/parameters/RemoveAccountCommandParameters.java", "diffHunk": "@@ -0,0 +1,41 @@\n+// Copyright (c) Microsoft Corporation.\n+// All rights reserved.\n+//\n+// This code is licensed under the MIT License.\n+//\n+// Permission is hereby granted, free of charge, to any person obtaining a copy\n+// of this software and associated documentation files(the \"Software\"), to deal\n+// in the Software without restriction, including without limitation the rights\n+// to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+// copies of the Software, and to permit persons to whom the Software is\n+// furnished to do so, subject to the following conditions :\n+//\n+// The above copyright notice and this permission notice shall be included in\n+// all copies or substantial portions of the Software.\n+//\n+// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+// THE SOFTWARE.\n+package com.microsoft.identity.common.internal.commands.parameters;\n+\n+import com.microsoft.identity.common.internal.dto.IAccountRecord;\n+import com.microsoft.identity.common.internal.ui.browser.BrowserDescriptor;\n+\n+import java.util.List;\n+\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.experimental.SuperBuilder;\n+\n+@Getter\n+@SuperBuilder(toBuilder = true)\n+@EqualsAndHashCode(callSuper = true)\n+public class RemoveAccountCommandParameters extends CommandParameters {\n+\n+    private IAccountRecord account;\n+    private List<BrowserDescriptor> browserSafeList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6848a9e41b6a2cfb9972aa82f605035f8cc30aa4", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6848a9e41b6a2cfb9972aa82f605035f8cc30aa4", "committedDate": "2020-04-17T18:44:19Z", "message": "Merge branch 'dev' into shahzaibj/lombok"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5b9c3811da9c084caba3f2222ae279c139be081", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f5b9c3811da9c084caba3f2222ae279c139be081", "committedDate": "2020-04-17T18:59:00Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "664d24a10eae1802787251abb567be486837f5d7", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/664d24a10eae1802787251abb567be486837f5d7", "committedDate": "2020-04-17T19:05:40Z", "message": "Add clone getter for browser safe list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1Nzc1ODQ3", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-395775847", "createdAt": "2020-04-17T21:12:36Z", "commit": {"oid": "664d24a10eae1802787251abb567be486837f5d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjUwODEx", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-396650811", "createdAt": "2020-04-20T17:11:30Z", "commit": {"oid": "664d24a10eae1802787251abb567be486837f5d7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoxMTozMFrOGIe5oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozNDoxM1rOGIf0Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU0ODA2NQ==", "bodyText": "Why this class , if we don't have any additional properties associated with it?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r411548065", "createdAt": "2020-04-20T17:11:30Z", "author": {"login": "kreedula"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/TokenCommand.java", "diffHunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) Microsoft Corporation.\n+// All rights reserved.\n+//\n+// This code is licensed under the MIT License.\n+//\n+// Permission is hereby granted, free of charge, to any person obtaining a copy\n+// of this software and associated documentation files(the \"Software\"), to deal\n+// in the Software without restriction, including without limitation the rights\n+// to use, copy, modify, merge, publish, distribute, sublicense, and / or sell\n+// copies of the Software, and to permit persons to whom the Software is\n+// furnished to do so, subject to the following conditions :\n+//\n+// The above copyright notice and this permission notice shall be included in\n+// all copies or substantial portions of the Software.\n+//\n+// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+// THE SOFTWARE.\n+package com.microsoft.identity.common.internal.commands;\n+\n+import android.content.Intent;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.microsoft.identity.common.internal.commands.parameters.TokenCommandParameters;\n+import com.microsoft.identity.common.internal.controllers.BaseController;\n+import com.microsoft.identity.common.internal.result.AcquireTokenResult;\n+\n+import java.util.List;\n+\n+import lombok.EqualsAndHashCode;\n+\n+@EqualsAndHashCode(callSuper = true)\n+public abstract class TokenCommand extends BaseCommand<AcquireTokenResult> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "664d24a10eae1802787251abb567be486837f5d7"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MzAzMQ==", "bodyText": "This would break claimsRequest flow. Before this change , forceRefresh was on OperationParameter here  and we set forceRefresh to true for interactive calls when claimsRequest is present here . This is done because, in broker we would attempt to silently get a token for interactive calls as well if we a matching account using PRT, FRT, and if claimsRequest is present we would need to skip cache and refresh the token.\nSo i think you should move back forceRefresh to base class and add the logic back", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r411563031", "createdAt": "2020-04-20T17:34:13Z", "author": {"login": "kreedula"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -99,9 +106,9 @@ public BrokerRequest brokerRequestFromAcquireTokenParameters(@NonNull final Acqu\n                         parameters.getExtraQueryStringParameters() != null ?\n                                 QueryParamsAdapter._toJson(parameters.getExtraQueryStringParameters())\n                                 : null\n-                ).prompt(parameters.getOpenIdConnectPromptParameter().name())\n+                ).prompt(parameters.getPrompt().name())\n                 .claims(parameters.getClaimsRequestJson())\n-                .forceRefresh(parameters.getForceRefresh())\n+                .forceRefresh(false)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM1NDY4NA=="}, "originalCommit": {"oid": "155e289ccdbd92883bf21cedf709c27f530c5f47"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjcyMzQ1", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-396672345", "createdAt": "2020-04-20T17:40:57Z", "commit": {"oid": "664d24a10eae1802787251abb567be486837f5d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzo0MDo1N1rOGIgFIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzo0MDo1N1rOGIgFIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2NzM5Mw==", "bodyText": "This would break claimsRequest flow. Before this change , forceRefresh was on OperationParameter here  and we set forceRefresh to true for interactive calls when claimsRequest is present here . This is done because, in broker we would attempt to silently get a token for interactive calls as well if we a matching account using PRT, FRT, and if claimsRequest is present we would need to skip cache and refresh the token.\nSo i think you should move back forceRefresh to base class and add the logic back", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#discussion_r411567393", "createdAt": "2020-04-20T17:40:57Z", "author": {"login": "kreedula"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/request/MsalBrokerRequestAdapter.java", "diffHunk": "@@ -99,9 +106,9 @@ public BrokerRequest brokerRequestFromAcquireTokenParameters(@NonNull final Acqu\n                         parameters.getExtraQueryStringParameters() != null ?\n                                 QueryParamsAdapter._toJson(parameters.getExtraQueryStringParameters())\n                                 : null\n-                ).prompt(parameters.getOpenIdConnectPromptParameter().name())\n+                ).prompt(parameters.getPrompt().name())\n                 .claims(parameters.getClaimsRequestJson())\n-                .forceRefresh(parameters.getForceRefresh())\n+                .forceRefresh(false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "664d24a10eae1802787251abb567be486837f5d7"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5674111b5f49ff0701ffdc437b0baed90848cb5", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d5674111b5f49ff0701ffdc437b0baed90848cb5", "committedDate": "2020-04-20T20:05:36Z", "message": "Put force refresh on base token command parameters"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODAxMDMy", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/880#pullrequestreview-396801032", "createdAt": "2020-04-20T20:48:38Z", "commit": {"oid": "d5674111b5f49ff0701ffdc437b0baed90848cb5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1621, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}