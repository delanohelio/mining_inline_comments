{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2NzgzMzE2", "number": 1021, "title": "Consider controllers while throttling", "bodyText": "Controllers were not being considered in the Equals comparison of commands object. In this PR, I've updated the logic to consider them so that if we get a request with the same parameters, however, different controllers then we do NOT throttle.\nConsider this scenario:\n\nRequest with parameters A comes in (uses BrokerLocalController as device is NOT joined) - Fails as device registration required for resource\nUser registers device\nIn less than 30 seconds since first request, Another Request with same parameters A comes in (uses BrokerJoinedAccountController as device is now joined) - Fails due to throttling as the parameters were matched.\n\nSo now with this change, we wouldn't throttle in the second request with same parameters as now we would consider the controller as well so the request thumbprint is different i.e. the equals comparison for the two commands object fails and hence we do NOT throttle in such a case.\nRelated PR: AzureAD/ad-accounts-for-android#1367", "createdAt": "2020-09-01T03:29:51Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1021", "merged": true, "mergeCommit": {"oid": "f0e67e614c94c05d58523f4cacb086206eb25af4"}, "closed": true, "closedAt": "2020-09-03T00:58:40Z", "author": {"login": "shahzaibj"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEe2RlAH2gAyNDc2NzgzMzE2OjFlM2U2NDYwYTdmYzk3MGU0NDJkNDg3NzgyZTkwYWFhMDIyODczMjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFFP4sAH2gAyNDc2NzgzMzE2OmI4ZTdjMDE0NDNjNjFkODliYTA2M2UwMmI1Y2I1NjE5OTc1MjhhZmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e3e6460a7fc970e442d487782e90aaa02287326", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/1e3e6460a7fc970e442d487782e90aaa02287326", "committedDate": "2020-09-01T03:29:22Z", "message": "Consider controllers while throttling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTQyOTU2", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1021#pullrequestreview-479942956", "createdAt": "2020-09-01T16:56:08Z", "commit": {"oid": "1e3e6460a7fc970e442d487782e90aaa02287326"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTQzNjEw", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1021#pullrequestreview-479943610", "createdAt": "2020-09-01T16:56:53Z", "commit": {"oid": "1e3e6460a7fc970e442d487782e90aaa02287326"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNjo1Njo1M1rOHK_5_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNjo1Njo1M1rOHK_5_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI5NDg0NA==", "bodyText": "How many controllers can we have?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1021#discussion_r481294844", "createdAt": "2020-09-01T16:56:53Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/commands/BaseCommand.java", "diffHunk": "@@ -42,7 +42,6 @@\n     @EqualsAndHashCode.Exclude\n     private CommandCallback callback;\n \n-    @EqualsAndHashCode.Exclude\n     private List<BaseController> controllers;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e3e6460a7fc970e442d487782e90aaa02287326"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac20d3c3440d1c33dcf267db0a5f217cda3bbc0c", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ac20d3c3440d1c33dcf267db0a5f217cda3bbc0c", "committedDate": "2020-09-01T20:40:28Z", "message": "Merge branch 'dev' into shahzaibj/throttling-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c14afe7325439c63213376801b85913e2794ccd1", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/c14afe7325439c63213376801b85913e2794ccd1", "committedDate": "2020-09-02T17:46:36Z", "message": "Merge branch 'dev' into shahzaibj/throttling-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d7bce5a23418ba8d3e9190d3c0d81f86a20c37e", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/4d7bce5a23418ba8d3e9190d3c0d81f86a20c37e", "committedDate": "2020-09-02T23:48:56Z", "message": "Merge branch 'dev' into shahzaibj/throttling-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8e7c01443c61d89ba063e02b5cb561997528afe", "author": {"user": {"login": "shahzaibj", "name": "Shahzaib"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b8e7c01443c61d89ba063e02b5cb561997528afe", "committedDate": "2020-09-03T00:13:44Z", "message": "Ignore controller member fields while throttling\n\nThese aren't initialized with controllers and can cause memory leaks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1556, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}