{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NTc4MDcx", "number": 838, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNzoxMTo1M1rODl3-JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNzoxMTo1M1rODl3-JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMDQwOTMyOnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNzoxMTo1M1rOFzAmdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxOToyOToyMFrOFzEqew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA==", "bodyText": "Should we do this in the base class?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389031540", "createdAt": "2020-03-06T17:11:53Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTg3OA==", "bodyText": "It is already done there but is not sufficient as that method returns back here", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389031878", "createdAt": "2020-03-06T17:12:34Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMjI4Mg==", "bodyText": "super is called first, which does this logic and returns. Then we are back here, try to use the state param, it is NULL and we get NPE", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389032282", "createdAt": "2020-03-06T17:13:19Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMzM2Nw==", "bodyText": "ahh okay.\nIn the base class, can we move the logic to onCreate instead? (before extractState is called).\nThanks for catching the bug btw.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389033367", "createdAt": "2020-03-06T17:15:23Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzNTYwMw==", "bodyText": "Why do you want to finish in the onCreate? The state param in onCreate could be NULL and is currently handled by the mInstanceState instance variable. See this: \n  \n    \n      microsoft-authentication-library-common-for-android/common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/AuthorizationFragment.java\n    \n    \n        Lines 84 to 101\n      in\n      744fb75\n    \n    \n    \n    \n\n        \n          \n           public void onCreate(@Nullable Bundle savedInstanceState) { \n        \n\n        \n          \n               final String methodName = \"#onCreate\"; \n        \n\n        \n          \n               super.onCreate(savedInstanceState); \n        \n\n        \n          \n            \n        \n\n        \n          \n               // Register Broadcast receiver to cancel the auth request \n        \n\n        \n          \n               // if another incoming request is launched by the app \n        \n\n        \n          \n               LocalBroadcastManager.getInstance(getContext()).registerReceiver(mCancelRequestReceiver, \n        \n\n        \n          \n                       new IntentFilter(CANCEL_INTERACTIVE_REQUEST)); \n        \n\n        \n          \n            \n        \n\n        \n          \n               if (savedInstanceState == null) { \n        \n\n        \n          \n                   Logger.verbose(TAG + methodName, \"Extract state from the intent bundle.\"); \n        \n\n        \n          \n                   extractState(mInstanceState); \n        \n\n        \n          \n               } else { \n        \n\n        \n          \n                   // If activity is killed by the os, savedInstance will be the saved bundle. \n        \n\n        \n          \n                   Logger.verbose(TAG + methodName, \"Extract state from the saved bundle.\"); \n        \n\n        \n          \n                   extractState(savedInstanceState); \n        \n\n        \n          \n               } \n        \n\n        \n          \n           }", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389035603", "createdAt": "2020-03-06T17:19:55Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA0MTQ3MA==", "bodyText": "We could make extractState() takes NonNull parameter only, and then put the check inside onCreate(). We're already doing half the check there (if savedInstanceState==null) anyway.\nI just prefer having the check in one place - it's easier to maintain.", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389041470", "createdAt": "2020-03-06T17:31:08Z", "author": {"login": "rpdome"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA5ODEwNw==", "bodyText": "Addressed", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/838#discussion_r389098107", "createdAt": "2020-03-06T19:29:20Z", "author": {"login": "shahzaibj"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/BrowserAuthorizationFragment.java", "diffHunk": "@@ -94,6 +94,12 @@ public void onSaveInstanceState(@NonNull Bundle outState) {\n \n     @Override\n     void extractState(final Bundle state){\n+        if (state == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAzMTU0MA=="}, "originalCommit": {"oid": "59d0720547fa36728ebf118e04a6ef921de04549"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2460, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}