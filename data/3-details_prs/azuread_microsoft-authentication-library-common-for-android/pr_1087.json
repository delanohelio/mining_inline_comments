{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0NDY2MDA5", "number": 1087, "title": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "bodyText": "Do not silently swallow exception in requestAuthorization(),\n\n\nI accidentally hit this error when I disabled chrome and re enable it (making the 'emulator browser' the default browser). MSAL throws an NPE on the future object.\nAfter debugging, I found out that we only pull 'default browser that supports custom tabs that is in the browser safe list'.\nIn this case, the emulator browser does not support custom tabs is not in the safe list, and chrome is no longer the default browser, so a ClientException with NO_AVAILABLE_BROWSER_FOUND is thrown.\nHowever, that NO_AVAILABLE_BROWSER_FOUND is silently swallowed. the future object is never set and therefore we hit an NPE down the line.\n\n\nLaunch AuthorizationActivity with different flags for broker and non-broker auth\n\n\nThis is a regression from AzureAD/ad-accounts-for-android#1399, will only happen if MSAL is used inside the broker host app. (ipphone CP is in the progress to consume MSAL).\nAuthorizationActivity has to be launched with Intent.FLAG_ACTIVITY_CLEAR_TASK too, otherwise Authorization Activity on finish can land on the broker host app's activity (if it's in the background).", "createdAt": "2020-10-16T00:12:53Z", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087", "merged": true, "mergeCommit": {"oid": "9d8b7957cd4663bf13631fd3d231f8251b8acd8f"}, "closed": true, "closedAt": "2020-10-20T23:46:22Z", "author": {"login": "rpdome"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUHD-iAFqTUxMTk2MjI0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUgsbygFqTUxMzE4NjkyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExOTYyMjQ5", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#pullrequestreview-511962249", "createdAt": "2020-10-19T16:49:24Z", "commit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExOTc1MDQy", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#pullrequestreview-511975042", "createdAt": "2020-10-19T17:04:55Z", "commit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNzowNDo1NVrOHkYiKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNzowNDo1NVrOHkYiKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMjc0Nw==", "bodyText": "Is this return now @nonnull?  No.  Should it become that?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#discussion_r507912747", "createdAt": "2020-10-19T17:04:55Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java", "diffHunk": "@@ -126,21 +126,14 @@ public OAuth2Strategy(GenericOAuth2Configuration config,\n      */\n     public Future<AuthorizationResult> requestAuthorization(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExOTc1ODU1", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#pullrequestreview-511975855", "createdAt": "2020-10-19T17:05:56Z", "commit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNzowNTo1NlrOHkYkoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNzowNTo1NlrOHkYkoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMzM3Nw==", "bodyText": "How are we ending up with UnsupportedEncoding here?", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#discussion_r507913377", "createdAt": "2020-10-19T17:05:56Z", "author": {"login": "AdamBJohnsonx"}, "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java", "diffHunk": "@@ -213,7 +214,7 @@ public AcquireTokenResult acquireToken(\n     private AuthorizationResult performAuthorizationRequest(@NonNull final OAuth2Strategy strategy,\n                                                             @NonNull final Context context,\n                                                             @NonNull final InteractiveTokenCommandParameters parameters)\n-            throws ExecutionException, InterruptedException, ClientException {\n+            throws ExecutionException, InterruptedException, ClientException, UnsupportedEncodingException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a0b3ec24668694234d0be33ccda8ba4f4a4f55c5", "committedDate": "2020-10-16T00:03:27Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}, "afterCommit": {"oid": "a5440bbc359de888045e443ff6dec04d7535fed1", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a5440bbc359de888045e443ff6dec04d7535fed1", "committedDate": "2020-10-20T22:15:56Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5440bbc359de888045e443ff6dec04d7535fed1", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a5440bbc359de888045e443ff6dec04d7535fed1", "committedDate": "2020-10-20T22:15:56Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}, "afterCommit": {"oid": "2a7a5ec51b46b5834ea7dc87762b3c567838a053", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2a7a5ec51b46b5834ea7dc87762b3c567838a053", "committedDate": "2020-10-20T22:17:54Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a7a5ec51b46b5834ea7dc87762b3c567838a053", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2a7a5ec51b46b5834ea7dc87762b3c567838a053", "committedDate": "2020-10-20T22:17:54Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}, "afterCommit": {"oid": "3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "committedDate": "2020-10-20T22:23:10Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e1721b51169b1523266bf2aa2c6d931cd18af5d", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6e1721b51169b1523266bf2aa2c6d931cd18af5d", "committedDate": "2020-10-20T22:30:33Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "committedDate": "2020-10-20T22:23:10Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}, "afterCommit": {"oid": "6e1721b51169b1523266bf2aa2c6d931cd18af5d", "author": {"user": {"login": "rpdome", "name": "Dome Pongmongkol"}}, "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6e1721b51169b1523266bf2aa2c6d931cd18af5d", "committedDate": "2020-10-20T22:30:33Z", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMTg2OTI5", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#pullrequestreview-513186929", "createdAt": "2020-10-20T22:41:13Z", "commit": {"oid": "6e1721b51169b1523266bf2aa2c6d931cd18af5d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1386, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}