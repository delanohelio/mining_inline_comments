{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzMjY4NjAz", "number": 2337, "title": "feat(ios/android): allow to position Toast", "bodyText": "Implements feature request #1621\nIt can be one of 3 positions: 'top', 'center' or 'bottom' (the default).\ncloses #1621", "createdAt": "2020-01-15T18:08:22Z", "url": "https://github.com/ionic-team/capacitor/pull/2337", "merged": true, "mergeCommit": {"oid": "a1384d580e0c9f155ac5dd55b00430243525cdbf"}, "closed": true, "closedAt": "2020-01-30T11:10:31Z", "author": {"login": "veloce"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6pIqDAH2gAyMzYzMjY4NjAzOmM5ZTYxOGRlZTY0YWE4YzJhODdkZjAwYTc0MWEwNzg3MjI2NDA0MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_Yj8CAFqTM1MDc0NDI1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c9e618dee64aa8c2a87df00a741a078722640406", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/c9e618dee64aa8c2a87df00a741a078722640406", "committedDate": "2020-01-15T17:38:06Z", "message": "Implement toast position for android"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5046552a53ddd0c8c38ce3834486562c3172a692", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/5046552a53ddd0c8c38ce3834486562c3172a692", "committedDate": "2020-01-15T17:38:06Z", "message": "Implement toast position on ios"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53897dba470a7b94e4f454669fe9ee8412dcbe7e", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/53897dba470a7b94e4f454669fe9ee8412dcbe7e", "committedDate": "2020-01-15T17:48:11Z", "message": "Use same error message in android and ios"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c56237f7dc6412c2f74bfa5609d98af5042f449", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/2c56237f7dc6412c2f74bfa5609d98af5042f449", "committedDate": "2020-01-15T17:57:38Z", "message": "Simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/e2170d8effbeeffb4b23c0cd9973abc7e71a41d1", "committedDate": "2020-01-15T18:07:50Z", "message": "Don't try to change empty lines"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMTIwNzQx", "url": "https://github.com/ionic-team/capacitor/pull/2337#pullrequestreview-350120741", "createdAt": "2020-01-29T13:54:14Z", "commit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxMzo1NDoxNVrOFjJIOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNDozODowOFrOFjKppw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjM5NDA0Mg==", "bodyText": "With this change, bottom is a bit lower than before, better keep the old code. It looks a bit bad, specially on notch devices, the toast is too close to the gesture bar.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    y = vc.view.bounds.size.height - height - topBottomOffset\n          \n          \n            \n                    y = vc.view.bounds.size.height - height - (height/2)", "url": "https://github.com/ionic-team/capacitor/pull/2337#discussion_r372394042", "createdAt": "2020-01-29T13:54:15Z", "author": {"login": "jcesarmobile"}, "path": "ios/Capacitor/Capacitor/Plugins/Toast.swift", "diffHunk": "@@ -34,11 +35,25 @@ public class CAPToastPlugin : CAPPlugin {\n       let minWidth = min(maxSizeTitle.width, expectedSizeTitle.width)\n       let minHeight = min(maxSizeTitle.height, expectedSizeTitle.height)\n       expectedSizeTitle = CGSize(width: minWidth, height: minHeight)\n+        \n+      let topBottomOffset: CGFloat = 20\n+      let height = expectedSizeTitle.height+32\n+      let y: CGFloat\n+      if (position == \"top\") {\n+        y = topBottomOffset\n+      } else if (position == \"center\") {\n+        y = (vc.view.bounds.size.height/2) - (height/2)\n+      } else if (position == \"bottom\") {\n+        y = vc.view.bounds.size.height - height - topBottomOffset", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjM5NTA0NQ==", "bodyText": "increase the size a bit, to 40 I think, with 20 a small portion of the toast appears under the notch\nalso, as I recommended to change the bottom code, you no longer need the topBottomOffset variable, you can just set the y value on line 43", "url": "https://github.com/ionic-team/capacitor/pull/2337#discussion_r372395045", "createdAt": "2020-01-29T13:56:08Z", "author": {"login": "jcesarmobile"}, "path": "ios/Capacitor/Capacitor/Plugins/Toast.swift", "diffHunk": "@@ -34,11 +35,25 @@ public class CAPToastPlugin : CAPPlugin {\n       let minWidth = min(maxSizeTitle.width, expectedSizeTitle.width)\n       let minHeight = min(maxSizeTitle.height, expectedSizeTitle.height)\n       expectedSizeTitle = CGSize(width: minWidth, height: minHeight)\n+        \n+      let topBottomOffset: CGFloat = 20", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQxNTQ4NQ==", "bodyText": "This also changes the behaviour, so I wouldn't do anything if set to bottom, to keep the old behaviour.", "url": "https://github.com/ionic-team/capacitor/pull/2337#discussion_r372415485", "createdAt": "2020-01-29T14:32:14Z", "author": {"login": "jcesarmobile"}, "path": "android/capacitor/src/main/java/com/getcapacitor/plugin/Toast.java", "diffHunk": "@@ -23,7 +30,22 @@ public void show(PluginCall call) {\n       duration = android.widget.Toast.LENGTH_LONG;\n     }\n \n+\n     android.widget.Toast toast = android.widget.Toast.makeText(getContext(), text, duration);\n+\n+    String position = call.getString(\"position\", \"bottom\");\n+\n+    if(\"top\".equals(position)) {\n+      toast.setGravity(GRAVITY_TOP, 0, BASE_TOP_BOTTOM_OFFSET);\n+    } else  if(\"bottom\".equals(position)) {\n+      toast.setGravity(GRAVITY_BOTTOM, 0, BASE_TOP_BOTTOM_OFFSET);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQxODk4Mw==", "bodyText": "Since web toast doesn't really support the position, better not to add code that might look like it's implemented but broken\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                toast.position = options.position;", "url": "https://github.com/ionic-team/capacitor/pull/2337#discussion_r372418983", "createdAt": "2020-01-29T14:38:08Z", "author": {"login": "jcesarmobile"}, "path": "core/src/web/toast.ts", "diffHunk": "@@ -18,6 +18,7 @@ export class ToastPluginWeb extends WebPlugin implements ToastPlugin {\n     const toast = document.createElement('pwa-toast') as any;\n     toast.duration = duration;\n     toast.message = options.text;\n+    toast.position = options.position;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2170d8effbeeffb4b23c0cd9973abc7e71a41d1"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43e0f32f9a8579b2cfd659fc0b40a2d9fda3c9d7", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/43e0f32f9a8579b2cfd659fc0b40a2d9fda3c9d7", "committedDate": "2020-01-29T16:21:29Z", "message": "Suggested changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35ece70d3937ba04e6a21ea66fed6d55217457be", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/35ece70d3937ba04e6a21ea66fed6d55217457be", "committedDate": "2020-01-29T18:03:42Z", "message": "Android default behavior"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b6145db2967033614b8d7cb60e981f596f4a5c0", "author": {"user": {"login": "veloce", "name": "Vincent Velociter"}}, "url": "https://github.com/ionic-team/capacitor/commit/8b6145db2967033614b8d7cb60e981f596f4a5c0", "committedDate": "2020-01-30T08:44:35Z", "message": "No error returned if invalid toast position on iOS"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNzQ0MjUw", "url": "https://github.com/ionic-team/capacitor/pull/2337#pullrequestreview-350744250", "createdAt": "2020-01-30T11:09:08Z", "commit": {"oid": "8b6145db2967033614b8d7cb60e981f596f4a5c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1273, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}