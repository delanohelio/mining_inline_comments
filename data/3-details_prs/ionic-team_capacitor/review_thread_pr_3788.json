{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4ODExMDg3", "number": 3788, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNDowOFrOE-5bCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNDowOFrOE-5bCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0Mzg3OTc4OnYy", "diffSide": "RIGHT", "path": "android/capacitor/src/main/java/com/getcapacitor/PluginManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNDowOFrOH8TNQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNDowOFrOH8TNQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjk5MTI5OQ==", "bodyText": ":)\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    try (BufferedReader br = new BufferedReader(new InputStreamReader(assetManager.open(\"capacitor.plugins.json\")))) {\n          \n          \n            \n                        StringBuilder b = new StringBuilder();\n          \n          \n            \n                        String line;\n          \n          \n            \n                        while ((line = br.readLine()) != null) {\n          \n          \n            \n                            b.append(line);\n          \n          \n            \n                        }\n          \n          \n            \n                        String jsonString = b.toString();\n          \n          \n            \n                    try (BufferedReader reader = new BufferedReader(new InputStreamReader(assetManager.open(\"capacitor.plugins.json\")))) {\n          \n          \n            \n                        StringBuilder builder = new StringBuilder();\n          \n          \n            \n                        String line;\n          \n          \n            \n                        while ((line = reader.readLine()) != null) {\n          \n          \n            \n                            builder.append(line);\n          \n          \n            \n                        }\n          \n          \n            \n                        String jsonString = builder.toString();", "url": "https://github.com/ionic-team/capacitor/pull/3788#discussion_r532991299", "createdAt": "2020-12-01T00:24:08Z", "author": {"login": "carlpoole"}, "path": "android/capacitor/src/main/java/com/getcapacitor/PluginManager.java", "diffHunk": "@@ -0,0 +1,56 @@\n+package com.getcapacitor;\n+\n+import android.content.res.AssetManager;\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStreamReader;\n+import java.util.ArrayList;\n+import java.util.List;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+\n+public class PluginManager {\n+\n+    private final AssetManager assetManager;\n+\n+    public PluginManager(AssetManager assetManager) {\n+        this.assetManager = assetManager;\n+    }\n+\n+    public List<Class<? extends Plugin>> loadPluginClasses() throws PluginLoadException {\n+        JSONArray pluginsJSON = parsePluginsJSON();\n+        ArrayList<Class<? extends Plugin>> pluginList = new ArrayList<>();\n+\n+        try {\n+            for (int i = 0, size = pluginsJSON.length(); i < size; i++) {\n+                JSONObject pluginJSON = pluginsJSON.getJSONObject(i);\n+                String classPath = pluginJSON.getString(\"classpath\");\n+                Class<?> c = Class.forName(classPath);\n+                pluginList.add(c.asSubclass(Plugin.class));\n+            }\n+        } catch (JSONException e) {\n+            throw new PluginLoadException(\"Could not parse capacitor.plugins.json as JSON\");\n+        } catch (ClassNotFoundException e) {\n+            throw new PluginLoadException(\"Could not find class by class path: \" + e.getMessage());\n+        }\n+\n+        return pluginList;\n+    }\n+\n+    private JSONArray parsePluginsJSON() throws PluginLoadException {\n+        try (BufferedReader br = new BufferedReader(new InputStreamReader(assetManager.open(\"capacitor.plugins.json\")))) {\n+            StringBuilder b = new StringBuilder();\n+            String line;\n+            while ((line = br.readLine()) != null) {\n+                b.append(line);\n+            }\n+            String jsonString = b.toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9407e064a10113a45a177d402b7b4fcf641fe2e3"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3462, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}