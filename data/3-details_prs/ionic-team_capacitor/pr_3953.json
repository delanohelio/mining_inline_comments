{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwNzgzODA4", "number": 3953, "title": "refactor(iOS): Move webview delegation out of CAPBridgeViewController", "bodyText": "This branch refactors CAPBridgeViewController to move the WebKit delegation into a new object. None of the functionality needed to be in the view controller and was split between a protocol extension (adopted by the view controller) and the view controller class itself. This was a poor separation of concerns and made CAPBridgeViewController quite large.\n\nCAPMessageHandlerWrapper is removed. It only existed as a temporary refactor to break retain cycles in the object graph.\nWebViewDelegationHandler has now inherited the functionality that was split between CAPMessageHandlerWrapper and CAPBridgeDelegate.\nThe WKNavigationDelegate and WKUIDelegate protocol conformance has been moved out of CAPBridgeViewController and into WebViewDelegationHandler.\nCAPAssetHandler has been renamed to WebViewAssetHandler to match WebViewDelegationHandler.\n\nThe result is a cleaner separation between configuration/initialization of the environment, which CAPBridgeViewController handles, and runtime management of the environment, which is split between the handlers and owned by the bridge.", "createdAt": "2020-12-15T23:31:01Z", "url": "https://github.com/ionic-team/capacitor/pull/3953", "merged": true, "mergeCommit": {"oid": "581d89cfd9581bec4e99808b810b3dab2741d4eb"}, "closed": true, "closedAt": "2020-12-16T17:35:04Z", "author": {"login": "ikeith"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmiHDZAH2gAyNTQwNzgzODA4OjEzNDc3ODBhMGU2NDM3ZDdkNDFhYWE0YTg3NTIyYjE0MDNmZDJhZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmxwIugFqTU1Mzg3OTIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1347780a0e6437d7d41aaa4a87522b1403fd2ad8", "author": {"user": {"login": "ikeith", "name": "Ian Keith"}}, "url": "https://github.com/ionic-team/capacitor/commit/1347780a0e6437d7d41aaa4a87522b1403fd2ad8", "committedDate": "2020-12-15T22:30:50Z", "message": "Moved all runtime webview delegation out of bridge view controller. Removed CAPMessageHandlerWrapper, added WebViewDelegationHandler, renamed CAPAssetHandler."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9390493afc6ac8de1aca7a54656fafc681f2db8", "author": {"user": {"login": "ikeith", "name": "Ian Keith"}}, "url": "https://github.com/ionic-team/capacitor/commit/a9390493afc6ac8de1aca7a54656fafc681f2db8", "committedDate": "2020-12-15T22:31:29Z", "message": "Fixed tests to match refactor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ad60bfeff7d5bbdd50785d875c67ce3072ebae", "author": {"user": {"login": "ikeith", "name": "Ian Keith"}}, "url": "https://github.com/ionic-team/capacitor/commit/34ad60bfeff7d5bbdd50785d875c67ce3072ebae", "committedDate": "2020-12-15T22:32:09Z", "message": "Added tests for new configuration functionality."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a5ff0f0611da7ae360a711d31a59a7b7d204cea", "author": {"user": {"login": "ikeith", "name": "Ian Keith"}}, "url": "https://github.com/ionic-team/capacitor/commit/9a5ff0f0611da7ae360a711d31a59a7b7d204cea", "committedDate": "2020-12-15T22:32:29Z", "message": "Merge branch 'main' into web-delegate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzMTE2MTI2", "url": "https://github.com/ionic-team/capacitor/pull/3953#pullrequestreview-553116126", "createdAt": "2020-12-15T23:48:31Z", "commit": {"oid": "9a5ff0f0611da7ae360a711d31a59a7b7d204cea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMzo0ODozMVrOIGlIgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMzo0ODozMVrOIGlIgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc3MDc1NQ==", "bodyText": "Just curious, how come internal classes need an Obj-C name?", "url": "https://github.com/ionic-team/capacitor/pull/3953#discussion_r543770755", "createdAt": "2020-12-15T23:48:31Z", "author": {"login": "imhoffd"}, "path": "ios/Capacitor/Capacitor/WebViewAssetHandler.swift", "diffHunk": "@@ -1,7 +1,8 @@\n import Foundation\n import MobileCoreServices\n \n-internal class CAPAssetHandler: NSObject, WKURLSchemeHandler {\n+@objc(CAPWebViewAssetHandler)\n+internal class WebViewAssetHandler: NSObject, WKURLSchemeHandler {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a5ff0f0611da7ae360a711d31a59a7b7d204cea"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzMTMzNzIx", "url": "https://github.com/ionic-team/capacitor/pull/3953#pullrequestreview-553133721", "createdAt": "2020-12-16T00:00:29Z", "commit": {"oid": "9a5ff0f0611da7ae360a711d31a59a7b7d204cea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzODc5MjI3", "url": "https://github.com/ionic-team/capacitor/pull/3953#pullrequestreview-553879227", "createdAt": "2020-12-16T16:44:17Z", "commit": {"oid": "9a5ff0f0611da7ae360a711d31a59a7b7d204cea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1041, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}