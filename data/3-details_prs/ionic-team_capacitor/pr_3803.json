{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMjUzMTYz", "number": 3803, "title": "refactor(cli): shuffle imports to reduce startup time", "bodyText": "Using the following code after config is loaded in the run() function of cli/src/index.ts:\nconsole.log(Object.keys(require.cache).length);\nas well as time npx cap --version to test startup time.\nBenchmarks\nThese are the numbers I'm getting on my machine (MacBook Pro (16-inch, 2019) / 2.4 GHz 8-Core Intel Core i9 / 32 GB 2667 MHz DDR4):\nmain\n\n280 modules in cache\n0.42s startup\npackage: 141 files (500.7 kB, 829.7 kB unpacked)\n\ncli-bundle (#3797)\n\n241 modules in cache\n0.40s startup\npackage: 102 files (497.3 kB, 807.7 kB unpacked)\n\nimport-refactor (this PR)\n\n100 modules in cache\n0.32s startup\npackage: 145 files (501.1 kB, 832.9 kB unpacked)\n\nResults\nThis has ~100ms faster startup than cli-bundle while maintaining the simple build process and useful dist stack traces and while adding little to no maintenance overhead. To reduce the number of files published we can implement #3290 (wouldn't reduce the packaged size much, but would offer additional benefits).\nalternative to #3797", "createdAt": "2020-11-15T20:18:30Z", "url": "https://github.com/ionic-team/capacitor/pull/3803", "merged": true, "mergeCommit": {"oid": "15a5738b6f67529685990de5150fae0a88e6f0bb"}, "closed": true, "closedAt": "2020-11-17T17:51:59Z", "author": {"login": "imhoffd"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdc2MrPAH2gAyNTIxMjUzMTYzOjQ5ODkxNmJkODJmMGRjZmYzOTBhNzUyMTlmMDM2ODhlMDc3NTAzOGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddc5ufAFqTUzMjYwOTg0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "498916bd82f0dcff390a75219f03688e0775038c", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/498916bd82f0dcff390a75219f03688e0775038c", "committedDate": "2020-11-15T20:15:50Z", "message": "refactor imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2373835346b48d0615b939a9f518d3d004c1f59a", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/2373835346b48d0615b939a9f518d3d004c1f59a", "committedDate": "2020-11-15T20:47:29Z", "message": "Merge branch 'main' into import-refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "562c85f16d08d005c0b79923f3bfc9e96f07dd37", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/562c85f16d08d005c0b79923f3bfc9e96f07dd37", "committedDate": "2020-11-17T17:16:58Z", "message": "Merge branch 'main' into import-refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjA4NDgx", "url": "https://github.com/ionic-team/capacitor/pull/3803#pullrequestreview-532608481", "createdAt": "2020-11-17T17:19:54Z", "commit": {"oid": "562c85f16d08d005c0b79923f3bfc9e96f07dd37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNzoxOTo1NVrOH1AZFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNzoxOTo1NVrOH1AZFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM0Mjk5Nw==", "bodyText": "These changes are awesome \ud83d\ude0e", "url": "https://github.com/ionic-team/capacitor/pull/3803#discussion_r525342997", "createdAt": "2020-11-17T17:19:55Z", "author": {"login": "adamdbradley"}, "path": "cli/src/index.ts", "diffHunk": "@@ -1,21 +1,8 @@\n import program from 'commander';\n \n import c from './colors';\n-import { logFatal } from './common';\n import { loadConfig } from './config';\n-import { output } from './log';\n-import { addCommand } from './tasks/add';\n-import { copyCommand } from './tasks/copy';\n-import { createCommand } from './tasks/create';\n-import { doctorCommand } from './tasks/doctor';\n-import { initCommand } from './tasks/init';\n-import { listCommand } from './tasks/list';\n-import { newPluginCommand } from './tasks/new-plugin';\n-import { openCommand } from './tasks/open';\n-import { runCommand } from './tasks/run';\n-import { serveCommand } from './tasks/serve';\n-import { syncCommand } from './tasks/sync';\n-import { updateCommand } from './tasks/update';\n+import { output, logFatal } from './log';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "562c85f16d08d005c0b79923f3bfc9e96f07dd37"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjA5ODQy", "url": "https://github.com/ionic-team/capacitor/pull/3803#pullrequestreview-532609842", "createdAt": "2020-11-17T17:21:26Z", "commit": {"oid": "562c85f16d08d005c0b79923f3bfc9e96f07dd37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1113, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}