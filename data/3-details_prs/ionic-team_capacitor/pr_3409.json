{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2MzcyOTQw", "number": 3409, "title": "Remove npm/yarn", "bodyText": "This is a breaking change in the CLI that removes the \"magic\" behavior of using npm install in several places. Most notably:\n\nWhen using npx cap add\n\nThe CLI will no longer automatically install the platform into your project for you. Instead, a two step workflow will be required: 1) Install the platform package, 2) Use npx cap add to add the platform's native project to your app. This is how community platforms are installed today (see Electron docs).\n\n\nWhen Cordova plugin dependencies are missing\n\nThe CLI will no longer automatically install missing Cordova plugin dependencies when using npx cap update. Instead, a list of dependencies (and their version ranges) is printed so that the dev can install them.\n\n\nWhen using npx cap create\n\nThe CLI will no longer automatically install dependencies into the app template. Instead, Capacitor core and CLI are specified in the template's package.json and next steps are printed to install the dependencies and run copy.\n\n\n\nAdditional Changes\n\nRemoved the latest packages list from npx cap doctor because it was hard-coded to use npm\n\nWhy?\nCapacitor shouldn't concern itself with how dependencies are installed. This can lead to configuration options that have little to do with Capacitor (npmClient), scope creep (yarn, yarn 2, #1863, monorepo support), a support load for package manager issues (network proxies, caching, etc.) and unwanted implicit behavior.\nInstead, the Capacitor CLI should expect the necessary packages to be available and error with a helpful message when they're not. To be clear: this is not removing compatibility with npm/yarn/whatever, it's removing the assumption of which package manager to use and allow Capacitor to work in any NodeJS project.", "createdAt": "2020-08-11T21:49:31Z", "url": "https://github.com/ionic-team/capacitor/pull/3409", "merged": true, "mergeCommit": {"oid": "a4539be88ba939e793466badf7b2899294c05246"}, "closed": true, "closedAt": "2020-08-18T16:35:29Z", "author": {"login": "imhoffd"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9pa7bgH2gAyNDY2MzcyOTQwOjhhYzQxZmI2NzQzYWM1OGVlYjUxYjI1NGVjM2VlZWIyN2JlOGNmZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAFHyaAFqTQ2OTIzODAyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8ac41fb6743ac58eeb51b254ec3eeeb27be8cff4", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/8ac41fb6743ac58eeb51b254ec3eeeb27be8cff4", "committedDate": "2020-08-10T21:50:59Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64141f4ae4f13e7547cd20d86ca22d61336ec07b", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/64141f4ae4f13e7547cd20d86ca22d61336ec07b", "committedDate": "2020-08-11T21:23:38Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3202a1a5eaab7cb2144d64301474914be4558a49", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/3202a1a5eaab7cb2144d64301474914be4558a49", "committedDate": "2020-08-11T21:58:33Z", "message": "update tests to install platform"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4054104c7f6ecfb036c0e13eb533226ccce2a331", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/4054104c7f6ecfb036c0e13eb533226ccce2a331", "committedDate": "2020-08-11T23:48:09Z", "message": "install for create"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/c29b361d180c52f108b2207c3daaac7c3dbf5134", "committedDate": "2020-08-12T00:12:47Z", "message": "install platforms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MDg0Njg3", "url": "https://github.com/ionic-team/capacitor/pull/3409#pullrequestreview-466084687", "createdAt": "2020-08-12T16:33:16Z", "commit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4Mzk5NTQ0", "url": "https://github.com/ionic-team/capacitor/pull/3409#pullrequestreview-468399544", "createdAt": "2020-08-17T11:59:22Z", "commit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMTo1OToyMlrOHBl0AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMjowMjowNFrOHBl5TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzMDE0NQ==", "bodyText": "can we make this not be hardcoded?", "url": "https://github.com/ionic-team/capacitor/pull/3409#discussion_r471430145", "createdAt": "2020-08-17T11:59:22Z", "author": {"login": "jcesarmobile"}, "path": "app-template/package.json", "diffHunk": "@@ -3,13 +3,19 @@\n   \"version\": \"1.0.0\",\n   \"description\": \"An Amazing Capacitor App\",\n   \"main\": \"index.js\",\n-  \"scripts\": {\n-    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n-  },\n   \"keywords\": [\n     \"capacitor\",\n     \"mobile\"\n   ],\n+  \"scripts\": {\n+    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n+  },\n+  \"dependencies\": {\n+    \"@capacitor/core\": \"^3.0.0-alpha.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzMTAxMw==", "bodyText": "we shouldn't tell users to use npm to install the missing package", "url": "https://github.com/ionic-team/capacitor/pull/3409#discussion_r471431013", "createdAt": "2020-08-17T12:01:05Z", "author": {"login": "jcesarmobile"}, "path": "cli/src/common.ts", "diffHunk": "@@ -62,6 +62,26 @@ export async function checkPackage(_config: Config): Promise<string | null> {\n   return null;\n }\n \n+export async function checkCapacitorPackage(\n+  config: Config,\n+  packageName: string,\n+): Promise<string | null> {\n+  const pkg = await getCapacitorPackage(config, packageName);\n+\n+  if (!pkg) {\n+    return (\n+      `Could not find the ${chalk.bold(\n+        packageName,\n+      )} platform. Does it need to be installed?\\n\\n` +\n+      `    ${chalk.bold(`npm install @capacitor/${packageName}`)}${chalk.dim(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzMTUwMQ==", "bodyText": "same, we shouldn't tell to npm install", "url": "https://github.com/ionic-team/capacitor/pull/3409#discussion_r471431501", "createdAt": "2020-08-17T12:02:04Z", "author": {"login": "jcesarmobile"}, "path": "cli/src/common.ts", "diffHunk": "@@ -432,10 +421,12 @@ export async function printNextSteps(config: Config, appDir: string) {\n   if (appDir !== '') {\n     log(`Next steps:`);\n     log('');\n-    log(chalk`cd {bold ./${appDir}}`);\n+    log(chalk`  cd {bold ./${appDir}}`);\n+    log(`  npm install`);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c29b361d180c52f108b2207c3daaac7c3dbf5134"}, "originalPosition": 157}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ba4438899dc7da4053b2d24b045fa31afec828f", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/4ba4438899dc7da4053b2d24b045fa31afec828f", "committedDate": "2020-08-17T20:32:38Z", "message": "don't provide example install command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c103934c90a61bb60896ce06760a2638f042c23", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/1c103934c90a61bb60896ce06760a2638f042c23", "committedDate": "2020-08-17T20:37:24Z", "message": "generalize npm install"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "774cc23eaffb9b94e8c51912cf162fc4705f9b42", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/774cc23eaffb9b94e8c51912cf162fc4705f9b42", "committedDate": "2020-08-17T20:40:08Z", "message": "more generalization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75bd07eb8e1dff302b1e182a655260c15d744ec1", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/75bd07eb8e1dff302b1e182a655260c15d744ec1", "committedDate": "2020-08-17T20:45:46Z", "message": "add latest deps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aad8858d1cab7bf0575006b59d334389e588a983", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/aad8858d1cab7bf0575006b59d334389e588a983", "committedDate": "2020-08-17T21:58:28Z", "message": "Merge branch 'main' into remove-npm"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MjM4MDI3", "url": "https://github.com/ionic-team/capacitor/pull/3409#pullrequestreview-469238027", "createdAt": "2020-08-18T11:15:16Z", "commit": {"oid": "aad8858d1cab7bf0575006b59d334389e588a983"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1159, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}