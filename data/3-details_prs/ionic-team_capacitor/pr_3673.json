{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyNzk4NjQ3", "number": 3673, "title": "feat: unified errors and error codes", "bodyText": "This unifies the base class of Capacitor exceptions to a new Capacitor.Exception class, allowing the following:\nerr instanceof Capacitor.Exception; // true\nAdditionally, the .unimplemented()/.unavailable() helpers on iOS, Android, and Web can now accept a message argument and use the new exception codes to allow the following:\ne.code === ExceptionCode.Unimplemented; // true\ne.code === ExceptionCode.Unavailable; // false\nThese codes make it easier for people to check what went wrong with Plugin API calls.\nBecause of the new availability of UNAVAILABLE on iOS and Web, it makes sense to remove UNSUPPORTED_BROWSER and use unavailable instead. Usage example:\n--- a/haptics/src/web.ts\n+++ b/haptics/src/web.ts\n@@ -1,4 +1,4 @@\n-import { UnsupportedBrowserException, WebPlugin } from '@capacitor/core';\n+import { WebPlugin } from '@capacitor/core';\n\n import type {\n   HapticsPlugin,\n@@ -70,9 +70,7 @@ export class HapticsWeb extends WebPlugin implements HapticsPlugin {\n     if (navigator.vibrate) {\n       navigator.vibrate(pattern);\n     } else {\n-      throw new UnsupportedBrowserException(\n-        'Browser does not support the vibrate API',\n-      );\n+      throw this.unavailable('Browser does not support the vibrate API');\n     }\n   }\n }\ncloses #3670", "createdAt": "2020-10-13T20:25:30Z", "url": "https://github.com/ionic-team/capacitor/pull/3673", "merged": true, "mergeCommit": {"oid": "f9e08038aa88f7453e8235f380d2767a12a7a073"}, "closed": true, "closedAt": "2020-10-19T22:59:06Z", "author": {"login": "imhoffd"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSOhxjAH2gAyNTAyNzk4NjQ3OmZiNThkZmFmMjM2MmY5M2NiYTg1MWVhYWMzNjcxODIwMzdiNTczNmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUHwPigH2gAyNTAyNzk4NjQ3OjdlZGQzNjEwYzZkZmQyMTc2NDFjYWE5ODEzYmIyNjI2ODVkNDRiZTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fb58dfaf2362f93cba851eaac367182037b5736e", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/fb58dfaf2362f93cba851eaac367182037b5736e", "committedDate": "2020-10-13T20:23:26Z", "message": "feat: UNIMPLEMENTED/UNAVAILABLE error codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54162cc22220c4cd715f19697bc9ec2c55ba8e38", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/54162cc22220c4cd715f19697bc9ec2c55ba8e38", "committedDate": "2020-10-13T20:32:06Z", "message": "Merge branch 'main' into except"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa6f30f32b39973bff9aa7e781c7918708621313", "author": {"user": {"login": "jcesarmobile", "name": "jcesarmobile"}}, "url": "https://github.com/ionic-team/capacitor/commit/aa6f30f32b39973bff9aa7e781c7918708621313", "committedDate": "2020-10-14T18:03:00Z", "message": "Merge branch 'main' into except"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbe366b0ce5b6ac2272a27fd76aea9ceb291b099", "author": {"user": {"login": "jcesarmobile", "name": "jcesarmobile"}}, "url": "https://github.com/ionic-team/capacitor/commit/fbe366b0ce5b6ac2272a27fd76aea9ceb291b099", "committedDate": "2020-10-15T12:20:41Z", "message": "Merge branch 'main' into except"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "275710fd6c1b6c5c8857354892aaa01a44a4f8bc", "author": {"user": {"login": "dependabot[bot]", "name": null}}, "url": "https://github.com/ionic-team/capacitor/commit/275710fd6c1b6c5c8857354892aaa01a44a4f8bc", "committedDate": "2020-10-16T19:00:57Z", "message": "chore(deps-dev): bump typedoc from 0.14.2 to 0.19.2 (#3684)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68e872d3f845116ad0202dcd4e42673032b63092", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/68e872d3f845116ad0202dcd4e42673032b63092", "committedDate": "2020-10-16T19:00:57Z", "message": "feat(cli): add `capacitor run` command (#3599)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e964471f2a8565023966b11d9e246a8bd2c2ba4e", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/e964471f2a8565023966b11d9e246a8bd2c2ba4e", "committedDate": "2020-10-16T19:00:57Z", "message": "add unavailable to swift plugin call helper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b09f65704de3748a637f1cce217c6cf82f9af5b9", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/b09f65704de3748a637f1cce217c6cf82f9af5b9", "committedDate": "2020-10-16T19:00:57Z", "message": "allow message params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "835bceaa12b39a5953816a444cb4006c595a0a31", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/835bceaa12b39a5953816a444cb4006c595a0a31", "committedDate": "2020-10-16T19:00:57Z", "message": "make it work for objc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b83bc77d149612839a7ab3c0df26541a70c20a0e", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/b83bc77d149612839a7ab3c0df26541a70c20a0e", "committedDate": "2020-10-16T19:00:57Z", "message": "remove unsupported browser exception in favor of unimplemented/unavailable helpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/fe63476ba9766904bc16d099ff1d922bcd54f5a2", "committedDate": "2020-10-16T19:03:47Z", "message": "Merge branch 'main' into except"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNjY5ODcy", "url": "https://github.com/ionic-team/capacitor/pull/3673#pullrequestreview-511669872", "createdAt": "2020-10-19T11:38:37Z", "commit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozODozN1rOHkKLFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozODozN1rOHkKLFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NzQ2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              new (message: string, code: ExceptionCode): CapacitorException;\n          \n          \n            \n              new (message: string, code?: ExceptionCode): CapacitorException;\n          \n      \n    \n    \n  \n\nIf we plan to make all errors thrown by Capacitor to be Capacitor.Exception, then code should be optional.\nWith current implementation and this changes, all native Capacitor errors thrown are Capacitor.Exception, but only unimplemented and unavailable have codes, other errors have undefined code. But on web we can't create Capacitor.Exception errors without a code", "url": "https://github.com/ionic-team/capacitor/pull/3673#discussion_r507677463", "createdAt": "2020-10-19T11:38:37Z", "author": {"login": "jcesarmobile"}, "path": "core/src/definitions.ts", "diffHunk": "@@ -72,7 +72,37 @@ export interface PluginConfig {\n   name: string;\n }\n \n+export enum ExceptionCode {\n+  /**\n+   * API is not implemented.\n+   *\n+   * This means the API can't be used because:\n+   *   - it is not implemented at all\n+   *   - it is not implemented for the current platform\n+   */\n+  Unimplemented = 'UNIMPLEMENTED',\n+\n+  /**\n+   * API is not available.\n+   *\n+   * This means the API can't be used right now because:\n+   *   - it is currently missing a prerequisite, such as network connectivity\n+   *   - it requires a particular platform or browser version\n+   */\n+  Unavailable = 'UNAVAILABLE',\n+}\n+\n+export interface CapacitorException extends Error {\n+  code: ExceptionCode;\n+}\n+\n+declare const CapacitorException: {\n+  prototype: CapacitorException;\n+  new (message: string, code: ExceptionCode): CapacitorException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNjcxMzE4", "url": "https://github.com/ionic-team/capacitor/pull/3673#pullrequestreview-511671318", "createdAt": "2020-10-19T11:40:43Z", "commit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0MDo0NFrOHkKPSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0MDo0NFrOHkKPSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3ODUzOQ==", "bodyText": "I don't think this will ever be the case (not implemented at all), when it's not implemented it's just because it's not possible in one or more platforms, but if it's not possible on any platform the method should just not exist.", "url": "https://github.com/ionic-team/capacitor/pull/3673#discussion_r507678539", "createdAt": "2020-10-19T11:40:44Z", "author": {"login": "jcesarmobile"}, "path": "core/src/definitions.ts", "diffHunk": "@@ -72,7 +72,37 @@ export interface PluginConfig {\n   name: string;\n }\n \n+export enum ExceptionCode {\n+  /**\n+   * API is not implemented.\n+   *\n+   * This means the API can't be used because:\n+   *   - it is not implemented at all", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNjcyNzAw", "url": "https://github.com/ionic-team/capacitor/pull/3673#pullrequestreview-511672700", "createdAt": "2020-10-19T11:42:51Z", "commit": {"oid": "fe63476ba9766904bc16d099ff1d922bcd54f5a2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3b6a32b24e95d000ac679f97210e24aae41be70", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/a3b6a32b24e95d000ac679f97210e24aae41be70", "committedDate": "2020-10-19T17:29:29Z", "message": "reword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa30bbcc2fcd6f0ce22175c48e29b07cf50f9562", "author": {"user": {"login": "imhoffd", "name": "Dan Imhoff"}}, "url": "https://github.com/ionic-team/capacitor/commit/aa30bbcc2fcd6f0ce22175c48e29b07cf50f9562", "committedDate": "2020-10-19T17:30:06Z", "message": "make code optional"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMDAxNjMy", "url": "https://github.com/ionic-team/capacitor/pull/3673#pullrequestreview-512001632", "createdAt": "2020-10-19T17:37:36Z", "commit": {"oid": "aa30bbcc2fcd6f0ce22175c48e29b07cf50f9562"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7edd3610c6dfd217641caa9813bb262685d44be5", "author": {"user": {"login": "jcesarmobile", "name": "jcesarmobile"}}, "url": "https://github.com/ionic-team/capacitor/commit/7edd3610c6dfd217641caa9813bb262685d44be5", "committedDate": "2020-10-19T17:37:45Z", "message": "Merge branch 'main' into except"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1068, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}