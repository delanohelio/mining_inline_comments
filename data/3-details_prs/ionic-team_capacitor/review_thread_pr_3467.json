{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMzYxMTgw", "number": 3467, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTowMjo0MlrOEhagKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoxMToxMFrOEv6jzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNDcyNjgzOnYy", "diffSide": "RIGHT", "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTowMjo0MlrOHOt6xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwMDoyODo0MFrOHOyXLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTE5NDQzOQ==", "bodyText": "@dwieeb I added this method to the bridge so that it's possible to provide a Geolocation plugin for the onGeolocationPermissionsShowPrompt method in BridgeWebChromeClient to use. I'm unsure if we want to leave it at this, or make this method available on the Plugin class instead so that plugins don't need to touch the Bridge to do this. Thoughts?", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r485194439", "createdAt": "2020-09-08T21:02:42Z", "author": {"login": "carlpoole"}, "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "diffHunk": "@@ -883,4 +883,8 @@ public BridgeWebViewClient getWebViewClient() {\n     public void setWebViewClient(BridgeWebViewClient client) {\n         this.webViewClient = client;\n     }\n+\n+    public void registerGeolocationPlugin(Plugin geolocationPlugin) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b1503894dc3ab4a706afaf6d7feb9277161d64b"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTI2NzI0Ng==", "bodyText": "Would it make more sense to have it be more of an event-based design?", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r485267246", "createdAt": "2020-09-09T00:28:40Z", "author": {"login": "imhoffd"}, "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "diffHunk": "@@ -883,4 +883,8 @@ public BridgeWebViewClient getWebViewClient() {\n     public void setWebViewClient(BridgeWebViewClient client) {\n         this.webViewClient = client;\n     }\n+\n+    public void registerGeolocationPlugin(Plugin geolocationPlugin) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTE5NDQzOQ=="}, "originalCommit": {"oid": "8b1503894dc3ab4a706afaf6d7feb9277161d64b"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MzkyODcwOnYy", "diffSide": "RIGHT", "path": "android/capacitor/src/main/java/com/getcapacitor/BridgeWebChromeClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDowMDoyNlrOHXcYIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDowMDoyNlrOHXcYIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM0NDIyNA==", "bodyText": "Shouldn't use the same request code that is used on Geolocation plugin, the codes are used to identify who called the permission prompt, so if the Geolocation plugin is installed it could cause an undesired callback.", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r494344224", "createdAt": "2020-09-24T14:00:26Z", "author": {"login": "jcesarmobile"}, "path": "android/capacitor/src/main/java/com/getcapacitor/BridgeWebChromeClient.java", "diffHunk": "@@ -37,12 +38,14 @@\n  * WebView instance.\n  */\n public class BridgeWebChromeClient extends WebChromeClient {\n-    private Bridge bridge;\n     static final int FILE_CHOOSER = PluginRequestCodes.FILE_CHOOSER;\n     static final int FILE_CHOOSER_IMAGE_CAPTURE = PluginRequestCodes.FILE_CHOOSER_IMAGE_CAPTURE;\n     static final int FILE_CHOOSER_VIDEO_CAPTURE = PluginRequestCodes.FILE_CHOOSER_VIDEO_CAPTURE;\n     static final int FILE_CHOOSER_CAMERA_PERMISSION = PluginRequestCodes.FILE_CHOOSER_CAMERA_PERMISSION;\n     static final int GET_USER_MEDIA_PERMISSIONS = PluginRequestCodes.GET_USER_MEDIA_PERMISSIONS;\n+    static final int GEOLOCATION_REQUEST_PERMISSIONS = PluginRequestCodes.GEOLOCATION_REQUEST_PERMISSIONS;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2aa0d43db2c248bc2d5ba16a24d64f1c3593f7aa"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5Mzk1NTIzOnYy", "diffSide": "RIGHT", "path": "android/capacitor/src/main/java/com/getcapacitor/BridgeWebChromeClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDowNjowM1rOHXco1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMTo0NDo0NFrOHXttcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM0ODUwMQ==", "bodyText": "This should only be called with the second param as true if the permissions are accepted, otherwise it should prompt for the permission and this shouldn't be called until the user accept (and pass true) or deny (and pass false).", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r494348501", "createdAt": "2020-09-24T14:06:03Z", "author": {"login": "jcesarmobile"}, "path": "android/capacitor/src/main/java/com/getcapacitor/BridgeWebChromeClient.java", "diffHunk": "@@ -261,11 +264,11 @@ public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermiss\n         // Set that we want geolocation perms for this origin\n         callback.invoke(origin, true, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2aa0d43db2c248bc2d5ba16a24d64f1c3593f7aa"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDYyODIxMQ==", "bodyText": "thanks nice catch. I think this was always just saying true regardless \ud83d\ude43", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r494628211", "createdAt": "2020-09-24T21:44:44Z", "author": {"login": "carlpoole"}, "path": "android/capacitor/src/main/java/com/getcapacitor/BridgeWebChromeClient.java", "diffHunk": "@@ -261,11 +264,11 @@ public void onGeolocationPermissionsShowPrompt(String origin, GeolocationPermiss\n         // Set that we want geolocation perms for this origin\n         callback.invoke(origin, true, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM0ODUwMQ=="}, "originalCommit": {"oid": "2aa0d43db2c248bc2d5ba16a24d64f1c3593f7aa"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4Njc3OTY1OnYy", "diffSide": "RIGHT", "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoxMToxMFrOHlK00g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoxMjo1OFrOHlK5Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODczNjcyMg==", "bodyText": "the code should be unique, if you use the same on the geolocation plugin then only one of them will receive the response", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r508736722", "createdAt": "2020-10-20T18:11:10Z", "author": {"login": "jcesarmobile"}, "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "diffHunk": "@@ -687,6 +687,11 @@ public void startActivityForPluginWithResult(PluginCall call, Intent intent, int\n      */\n \n     public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {\n+        if (requestCode == BridgeWebChromeClient.GEOLOCATION_REQUEST_PERMISSIONS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fec082403aa44acf137613105903840503b17702"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODczNzg5MA==", "bodyText": "Yeah. Will make sure it is different", "url": "https://github.com/ionic-team/capacitor/pull/3467#discussion_r508737890", "createdAt": "2020-10-20T18:12:58Z", "author": {"login": "carlpoole"}, "path": "android/capacitor/src/main/java/com/getcapacitor/Bridge.java", "diffHunk": "@@ -687,6 +687,11 @@ public void startActivityForPluginWithResult(PluginCall call, Intent intent, int\n      */\n \n     public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {\n+        if (requestCode == BridgeWebChromeClient.GEOLOCATION_REQUEST_PERMISSIONS) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODczNjcyMg=="}, "originalCommit": {"oid": "fec082403aa44acf137613105903840503b17702"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3503, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}