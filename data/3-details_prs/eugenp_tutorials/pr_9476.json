{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyNjM1MjUw", "number": 9476, "title": "BAEL-4018 Spring Security - Already logged in user redirect from the login page", "bodyText": "PR for BAEL-4018", "createdAt": "2020-06-10T18:46:22Z", "url": "https://github.com/eugenp/tutorials/pull/9476", "merged": true, "mergeCommit": {"oid": "b0fb6ea8649e56d72d8e4c6fd168d7243f78136c"}, "closed": true, "closedAt": "2020-07-06T09:10:00Z", "author": {"login": "cicioflaviu"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcp-LNUAH2gAyNDMyNjM1MjUwOjYzNTc0YWU1MGI5N2IzZDM3NTUxNDQ4ODAwMzAxNzIyMDA4NDlkMTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrbNJEgH2gAyNDMyNjM1MjUwOjk0YzAyYmIyMmMyNGU2Y2I4MjEwMGRhYThhMGE1MjRmZjA2ZTZhNmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "63574ae50b97b3d3755144880030172200849d17", "author": {"user": {"login": "cicioflaviu", "name": "Cicio Flaviu"}}, "url": "https://github.com/eugenp/tutorials/commit/63574ae50b97b3d3755144880030172200849d17", "committedDate": "2020-06-10T18:43:20Z", "message": "BAEL-4018 Spring Security - Already logged in user redirect from the login page"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NzQxMzA4", "url": "https://github.com/eugenp/tutorials/pull/9476#pullrequestreview-428741308", "createdAt": "2020-06-11T09:25:17Z", "commit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwOToyNToxN1rOGiVgpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwOToyOToyNFrOGiVp0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1NzE4OQ==", "bodyText": "let's promote these to variables so we don't have to always cast them", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438657189", "createdAt": "2020-06-11T09:25:17Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginPageFilter.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package com.baeldung.loginredirect;\n+\n+import org.apache.http.HttpStatus;\n+import org.springframework.security.authentication.AnonymousAuthenticationToken;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.web.filter.GenericFilterBean;\n+\n+import javax.servlet.FilterChain;\n+import javax.servlet.ServletException;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletResponse;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.IOException;\n+\n+class LoginPageFilter extends GenericFilterBean {\n+\n+    @Override\n+    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n+        if (isAuthenticated() && ((HttpServletRequest) request).getRequestURI().equals(\"/loginUser\")) {\n+\n+            String encodedRedirectURL = ((HttpServletResponse) response).encodeRedirectURL(\n+              ((HttpServletRequest) request).getContextPath() + \"/userMainPage\");\n+\n+            ((HttpServletResponse) response).setStatus(HttpStatus.SC_TEMPORARY_REDIRECT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1NzU1OA==", "bodyText": "as to show best practices, let's use \"\".equals(...)", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438657558", "createdAt": "2020-06-11T09:25:56Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginPageFilter.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package com.baeldung.loginredirect;\n+\n+import org.apache.http.HttpStatus;\n+import org.springframework.security.authentication.AnonymousAuthenticationToken;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.web.filter.GenericFilterBean;\n+\n+import javax.servlet.FilterChain;\n+import javax.servlet.ServletException;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletResponse;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.IOException;\n+\n+class LoginPageFilter extends GenericFilterBean {\n+\n+    @Override\n+    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n+        if (isAuthenticated() && ((HttpServletRequest) request).getRequestURI().equals(\"/loginUser\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1NzY2OA==", "bodyText": "same", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438657668", "createdAt": "2020-06-11T09:26:07Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginPageInterceptor.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package com.baeldung.loginredirect;\n+\n+import org.apache.http.HttpStatus;\n+import org.springframework.security.authentication.AnonymousAuthenticationToken;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;\n+import org.springframework.web.util.UrlPathHelper;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+class LoginPageInterceptor extends HandlerInterceptorAdapter {\n+\n+    @Override\n+    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n+\n+        UrlPathHelper urlPathHelper = new UrlPathHelper();\n+        if (urlPathHelper.getLookupPathForRequest(request).equals(\"/loginUser\") && isAuthenticated()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1Nzk4NQ==", "bodyText": "wouldn't it be safer to use isAssignableFrom?", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438657985", "createdAt": "2020-06-11T09:26:39Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginPageInterceptor.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package com.baeldung.loginredirect;\n+\n+import org.apache.http.HttpStatus;\n+import org.springframework.security.authentication.AnonymousAuthenticationToken;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;\n+import org.springframework.web.util.UrlPathHelper;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+class LoginPageInterceptor extends HandlerInterceptorAdapter {\n+\n+    @Override\n+    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n+\n+        UrlPathHelper urlPathHelper = new UrlPathHelper();\n+        if (urlPathHelper.getLookupPathForRequest(request).equals(\"/loginUser\") && isAuthenticated()) {\n+\n+            String encodedRedirectURL = response.encodeRedirectURL(\n+              request.getContextPath() + \"/userMainPage\");\n+            response.setStatus(HttpStatus.SC_TEMPORARY_REDIRECT);\n+            response.setHeader(\"Location\", encodedRedirectURL);\n+\n+            return false;\n+        } else {\n+            return true;\n+        }\n+    }\n+\n+    private boolean isAuthenticated() {\n+        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n+        if (authentication == null || authentication instanceof AnonymousAuthenticationToken) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1ODA3NA==", "bodyText": "remove if not needed", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438658074", "createdAt": "2020-06-11T09:26:48Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginRedirectApplication.java", "diffHunk": "@@ -0,0 +1,12 @@\n+package com.baeldung.loginredirect;\n+\n+import org.springframework.boot.SpringApplication;\n+import org.springframework.boot.autoconfigure.SpringBootApplication;\n+\n+@SpringBootApplication\n+//@ImportResource({\"classpath*:spring-security-login-redirect.xml\"})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1OTA3Nw==", "bodyText": "do we want to make this package protected for some reason? if not let's make it public (check the others classes as well)", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438659077", "createdAt": "2020-06-11T09:28:36Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/java/com/baeldung/loginredirect/LoginPageInterceptor.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package com.baeldung.loginredirect;\n+\n+import org.apache.http.HttpStatus;\n+import org.springframework.security.authentication.AnonymousAuthenticationToken;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;\n+import org.springframework.web.util.UrlPathHelper;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+class LoginPageInterceptor extends HandlerInterceptorAdapter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1OTUzOA==", "bodyText": "not needed anymore right?", "url": "https://github.com/eugenp/tutorials/pull/9476#discussion_r438659538", "createdAt": "2020-06-11T09:29:24Z", "author": {"login": "rpvilao"}, "path": "spring-security-modules/spring-security-mvc-boot-2/src/main/resources/spring-security-login-redirect.xml", "diffHunk": "@@ -0,0 +1,46 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63574ae50b97b3d3755144880030172200849d17"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94c02bb22c24e6cb82100daa8a0a524ff06e6a6d", "author": {"user": {"login": "cicioflaviu", "name": "Cicio Flaviu"}}, "url": "https://github.com/eugenp/tutorials/commit/94c02bb22c24e6cb82100daa8a0a524ff06e6a6d", "committedDate": "2020-06-15T07:06:37Z", "message": "BAEL-4018 Improved login redirect classes."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4375, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}