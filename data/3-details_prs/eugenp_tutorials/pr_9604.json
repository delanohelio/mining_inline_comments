{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMDk2MzI1", "number": 9604, "title": "add excel formula", "bodyText": "", "createdAt": "2020-06-28T18:34:04Z", "url": "https://github.com/eugenp/tutorials/pull/9604", "merged": true, "mergeCommit": {"oid": "2ae80f83a50235371e17e2534d068ba9aeecf021"}, "closed": true, "closedAt": "2020-08-02T01:10:34Z", "author": {"login": "SaTaSo"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvw0XnAH2gAyNDQxMDk2MzI1OjQ4NGE2YmYyZjgxMDFjZjcwZTI2MzUyNzQzYWE2ZjY5ZDBhMjY0YjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5akYTAH2gAyNDQxMDk2MzI1OjNhYTUzNTQ0ZTkzODQ2OGZmY2YwMWUwNTA5ODYyYmQyNmZhMWMzM2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "484a6bf2f8101cf70e26352743aa6f69d0a264b4", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/484a6bf2f8101cf70e26352743aa6f69d0a264b4", "committedDate": "2020-06-28T18:33:10Z", "message": "add excel formula"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76786fc07849da6bf8a8814def79ff784a228fa8", "author": {"user": {"login": "SaTaSo", "name": "STS"}}, "url": "https://github.com/eugenp/tutorials/commit/76786fc07849da6bf8a8814def79ff784a228fa8", "committedDate": "2020-06-28T19:12:09Z", "message": "create README.md file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edb5ca529d1a9ae67349540d54fbd2590681dff5", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/edb5ca529d1a9ae67349540d54fbd2590681dff5", "committedDate": "2020-06-29T12:07:18Z", "message": "remove and add file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98ab3aa452841d40c54786e993150ca93c940ddc", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/98ab3aa452841d40c54786e993150ca93c940ddc", "committedDate": "2020-06-29T12:08:30Z", "message": "Merge branch 'master' of github.com:SanazTavakoli/tutorials"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e33f8675f69965b8df70017cf87cbfdd49514a5e", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/e33f8675f69965b8df70017cf87cbfdd49514a5e", "committedDate": "2020-07-03T21:56:52Z", "message": "change files location"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "92af7be7917aab9d2bc5e09f1f139a35fb5e47f7", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/92af7be7917aab9d2bc5e09f1f139a35fb5e47f7", "committedDate": "2020-07-03T21:55:06Z", "message": "change files location"}, "afterCommit": {"oid": "e33f8675f69965b8df70017cf87cbfdd49514a5e", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/e33f8675f69965b8df70017cf87cbfdd49514a5e", "committedDate": "2020-07-03T21:56:52Z", "message": "change files location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6a1041c40047ad05f70db129dd1063a1258ff31", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/c6a1041c40047ad05f70db129dd1063a1258ff31", "committedDate": "2020-07-11T08:31:02Z", "message": "changes after adding excel file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/e13f2c8e8b11c948fd6b5d8df0591aa65683272b", "committedDate": "2020-07-19T08:15:37Z", "message": "change excel file direcory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc2OTcy", "url": "https://github.com/eugenp/tutorials/pull/9604#pullrequestreview-455376972", "createdAt": "2020-07-26T16:13:27Z", "commit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxMzoyOFrOG3NdRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxMzoyOFrOG3NdRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTM1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n          \n          \n            \n                void givenExcelData_whenSetFormula_thenSuccess() throws IOException {", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545351", "createdAt": "2020-07-26T16:13:28Z", "author": {"login": "KevinGilmore"}, "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc3MDA3", "url": "https://github.com/eugenp/tutorials/pull/9604#pullrequestreview-455377007", "createdAt": "2020-07-26T16:14:00Z", "commit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxNDowMFrOG3Ndiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxNDowMFrOG3Ndiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTQxOQ==", "bodyText": "Add a blank line before and after the call to setFormula", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545419", "createdAt": "2020-07-26T16:14:00Z", "author": {"login": "KevinGilmore"}, "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n+        FileInputStream inputStream = new FileInputStream(new File(fileLocation));\n+        XSSFWorkbook wb = new XSSFWorkbook(inputStream);\n+        XSSFSheet sheet = wb.getSheetAt(0);\n+        double resultColumnA = 0;\n+        double resultColumnB = 0;\n+        for (int row = 0; row <= sheet.getLastRowNum(); row++) {\n+            resultColumnA += sheet.getRow(row).getCell(0).getNumericCellValue();\n+            resultColumnB += sheet.getRow(row).getCell(1).getNumericCellValue();\n+        }\n+        String colNameA = CellReference.convertNumToColString(0);\n+        String colNameB = CellReference.convertNumToColString(1);\n+        String startCellA = colNameA + 1;\n+        String stopCellA = colNameA + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnA = String.format(\"SUM(%s:%s)\", startCellA, stopCellA);\n+        String startCellB = colNameB + 1;\n+        String stopCellB = colNameB + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnB = String.format(\"SUM(%s:%s)\", startCellB, stopCellB);\n+        double resultValue = excelFormula.setFormula(fileLocation, wb, sumFormulaForColumnA + \"-\" + sumFormulaForColumnB);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc3MjQ1", "url": "https://github.com/eugenp/tutorials/pull/9604#pullrequestreview-455377245", "createdAt": "2020-07-26T16:17:39Z", "commit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxNzozOVrOG3Ne_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjoxNzozOVrOG3Ne_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NTc5MQ==", "bodyText": "Swap order of arguments to match the method signature: assertEquals(expected, actual)", "url": "https://github.com/eugenp/tutorials/pull/9604#discussion_r460545791", "createdAt": "2020-07-26T16:17:39Z", "author": {"login": "KevinGilmore"}, "path": "apache-poi/src/test/java/com/baeldung/poi/excel/setformula/ExcelFormulaUnitTest.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.baeldung.poi.excel.setformula;\n+\n+import org.apache.poi.ss.util.CellReference;\n+import org.apache.poi.xssf.usermodel.XSSFSheet;\n+import org.apache.poi.xssf.usermodel.XSSFWorkbook;\n+import org.junit.Assert;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.Paths;\n+\n+class ExcelFormulaUnitTest {\n+    private static String FILE_NAME = \"com/bealdung/poi/excel/setformula/SetFormulaTest.xlsx\";\n+    private String fileLocation;\n+    private ExcelFormula excelFormula;\n+\n+    @BeforeEach\n+    public void setup() throws URISyntaxException {\n+        fileLocation = Paths.get(ClassLoader.getSystemResource(FILE_NAME).toURI()).toString();\n+        excelFormula = new ExcelFormula();\n+    }\n+\n+    @Test\n+    void givenExcelData_whenSetAndEvaluateFormula() throws IOException {\n+        FileInputStream inputStream = new FileInputStream(new File(fileLocation));\n+        XSSFWorkbook wb = new XSSFWorkbook(inputStream);\n+        XSSFSheet sheet = wb.getSheetAt(0);\n+        double resultColumnA = 0;\n+        double resultColumnB = 0;\n+        for (int row = 0; row <= sheet.getLastRowNum(); row++) {\n+            resultColumnA += sheet.getRow(row).getCell(0).getNumericCellValue();\n+            resultColumnB += sheet.getRow(row).getCell(1).getNumericCellValue();\n+        }\n+        String colNameA = CellReference.convertNumToColString(0);\n+        String colNameB = CellReference.convertNumToColString(1);\n+        String startCellA = colNameA + 1;\n+        String stopCellA = colNameA + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnA = String.format(\"SUM(%s:%s)\", startCellA, stopCellA);\n+        String startCellB = colNameB + 1;\n+        String stopCellB = colNameB + (sheet.getLastRowNum() + 1);\n+        String sumFormulaForColumnB = String.format(\"SUM(%s:%s)\", startCellB, stopCellB);\n+        double resultValue = excelFormula.setFormula(fileLocation, wb, sumFormulaForColumnA + \"-\" + sumFormulaForColumnB);\n+        Assert.assertEquals(resultValue, resultColumnA - resultColumnB, 0d);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e13f2c8e8b11c948fd6b5d8df0591aa65683272b"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1700cbabd852cb67b62490b0c4c78d2aa83539fa", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/1700cbabd852cb67b62490b0c4c78d2aa83539fa", "committedDate": "2020-07-26T18:01:42Z", "message": "change test class name, add blank line and swap assert method parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcf0ccdb308fc1e498e8c6a70ce59bea42c39eef", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/dcf0ccdb308fc1e498e8c6a70ce59bea42c39eef", "committedDate": "2020-07-27T08:07:30Z", "message": "change baeldung spell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e711f71303f2656cad422c7f198b9bc50e2c3b9d", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/e711f71303f2656cad422c7f198b9bc50e2c3b9d", "committedDate": "2020-07-28T12:23:08Z", "message": "change address"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3aa53544e938468ffcf01e0509862bd26fa1c33e", "author": {"user": null}, "url": "https://github.com/eugenp/tutorials/commit/3aa53544e938468ffcf01e0509862bd26fa1c33e", "committedDate": "2020-07-28T18:17:02Z", "message": "Trigger Test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4358, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}