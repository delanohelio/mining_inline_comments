{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MDU4MzEx", "number": 1151, "title": "Fix azure and azure-samples test for cosmos, aks, sql", "bodyText": "", "createdAt": "2020-03-26T09:41:12Z", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1151", "merged": true, "mergeCommit": {"oid": "9ef30d8759cb4880eda987d809f18ea70ff91cbe"}, "closed": true, "closedAt": "2020-03-26T11:05:47Z", "author": {"login": "ChenTanyi"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQVc87AH2gAyMzk0MDU4MzExOjFjZTQ1MmRkOTU0MTFjY2IxNWYyMDAzNGJiYjU1ZTcwZjg1NTIxZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRY-SWgFqTM4MTg0NTg0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ce452dd95411ccb15f20034bbb55e70f85521fc", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-libraries-for-java/commit/1ce452dd95411ccb15f20034bbb55e70f85521fc", "committedDate": "2020-03-23T03:08:30Z", "message": "feat: regenerate sql"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29e609574e2d51239c45fe0cfa35d413c7170be0", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-libraries-for-java/commit/29e609574e2d51239c45fe0cfa35d413c7170be0", "committedDate": "2020-03-26T08:02:26Z", "message": "fix: cosmos, aks, sql in azure and azure-sample"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e9dbfa4687b8f6ff816fdc75e79a12a270fa1da", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-libraries-for-java/commit/4e9dbfa4687b8f6ff816fdc75e79a12a270fa1da", "committedDate": "2020-03-26T09:27:39Z", "message": "feat: update session record"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5b8bd751fed2c7f4a8a809172c3dce5b839d0c6", "author": {"user": {"login": "ChenTanyi", "name": "Tanyi Chen"}}, "url": "https://github.com/Azure/azure-libraries-for-java/commit/e5b8bd751fed2c7f4a8a809172c3dce5b839d0c6", "committedDate": "2020-03-26T09:36:15Z", "message": "feat: ignore acs error as it will be deprecated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxODQ0MjU1", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1151#pullrequestreview-381844255", "createdAt": "2020-03-26T09:46:26Z", "commit": {"oid": "29e609574e2d51239c45fe0cfa35d413c7170be0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwOTo0NjoyN1rOF7-w5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwOTo0NjoyN1rOF7-w5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQzODYzMQ==", "bodyText": "Please double check the recorded json for id and secret.", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1151#discussion_r398438631", "createdAt": "2020-03-26T09:46:27Z", "author": {"login": "weidongxu-microsoft"}, "path": "azure/src/test/java/com/azure/management/TestKubernetesCluster.java", "diffHunk": "@@ -27,8 +35,21 @@ public KubernetesCluster createResource(KubernetesClusters kubernetesClusters) t\n         final String newName = \"aks\" + kubernetesClusters.manager().getSdkContext().randomResourceName(\"\", 8);\n         final String dnsPrefix = \"dns\" + newName;\n         final String agentPoolName = \"ap\" + newName;\n-        final String clientId = \"clientId\";\n-        final String secret = \"secret\";\n+        String clientId = \"clientId\";\n+        String secret = \"secret\";\n+\n+        // aks can use another azure auth rather than original client auth to access azure service.\n+        // Thus, set it to AZURE_AUTH_LOCATION_2 when you want.\n+        String envSecondaryServicePrincipal = System.getenv(\"AZURE_AUTH_LOCATION_2\");\n+        if (envSecondaryServicePrincipal == null || envSecondaryServicePrincipal.isEmpty() || !(new File(envSecondaryServicePrincipal).exists())) {\n+            envSecondaryServicePrincipal = System.getenv(\"AZURE_AUTH_LOCATION\");\n+        }\n+\n+        try {\n+            HashMap<String, String> credentialsMap = ParseAuthFile(envSecondaryServicePrincipal);\n+            clientId = credentialsMap.get(\"clientId\");\n+            secret = credentialsMap.get(\"clientSecret\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29e609574e2d51239c45fe0cfa35d413c7170be0"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxODQ0Mjk3", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1151#pullrequestreview-381844297", "createdAt": "2020-03-26T09:46:31Z", "commit": {"oid": "e5b8bd751fed2c7f4a8a809172c3dce5b839d0c6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxODQ1ODQz", "url": "https://github.com/Azure/azure-libraries-for-java/pull/1151#pullrequestreview-381845843", "createdAt": "2020-03-26T09:48:33Z", "commit": {"oid": "e5b8bd751fed2c7f4a8a809172c3dce5b839d0c6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1438, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}