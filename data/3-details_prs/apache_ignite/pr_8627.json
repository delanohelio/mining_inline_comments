{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2NjAxNzk3", "number": 8627, "title": "IGNITE-13883 .NET: Simplify and optimize TryReadSystemType", "bodyText": "Replace dictionary+interfaces with a simple switch statement in BinarySystemHandlers.TryReadSystemType:\n\nLess code\nSimpler\nFaster\n\nBenchmark added: BinarySystemTypeReadBenchmark; results on Core i7-9700K, Ubuntu 20.04, .NET Core 3.1:\n|        |     Mean |     Error |    StdDev |  Gen 0 | Gen 1 | Gen 2 | Allocated |\n|------- |---------:|----------:|----------:|-------:|------:|------:|----------:|\n| Before | 1.080 us | 0.0030 us | 0.0025 us | 0.0725 |     - |     - |     456 B |\n|  After | 849.4 ns |   4.44 ns | 4.16 ns   | 0.0725 |     - |     - |     456 B |\n\n(~20% improvement)", "createdAt": "2020-12-29T19:11:06Z", "url": "https://github.com/apache/ignite/pull/8627", "merged": true, "mergeCommit": {"oid": "971f31852a9fbdf14f0fd987d87d344b97298000"}, "closed": true, "closedAt": "2020-12-30T07:22:08Z", "author": {"login": "ptupitsyn"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdq63LWgH2gAyNTQ2NjAxNzk3OjgzNTI2OTdlZjljNDFmMjY2NGFkOGVhZDhjOGMxZTU5YWViYzViMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdrAKo8AFqTU1OTY3NjM1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8352697ef9c41f2664ad8ead8c8c1e59aebc5b03", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/8352697ef9c41f2664ad8ead8c8c1e59aebc5b03", "committedDate": "2020-12-29T13:36:49Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9f7c01592295bd0db44710fc48a35b89be5ab32", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/c9f7c01592295bd0db44710fc48a35b89be5ab32", "committedDate": "2020-12-29T14:06:03Z", "message": "Add BinarySystemTypeReadBenchmark"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8f86c6cf485aa3a85116e063f634b9b9355f035", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/c8f86c6cf485aa3a85116e063f634b9b9355f035", "committedDate": "2020-12-29T14:08:47Z", "message": "Add BinarySystemTypeReadBenchmark - fix assembly signing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dee47114f978688b8813fad28623c528020cb5e5", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/dee47114f978688b8813fad28623c528020cb5e5", "committedDate": "2020-12-29T14:13:15Z", "message": "Add BinarySystemTypeReadBenchmark - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a89924c26eb9124150116e0b0d1575a1164f05c", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/5a89924c26eb9124150116e0b0d1575a1164f05c", "committedDate": "2020-12-29T16:29:19Z", "message": "Add BinarySystemTypeReadBenchmark - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f36961f826dec9fa3d8d3f2085e142a3e025e7bb", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/f36961f826dec9fa3d8d3f2085e142a3e025e7bb", "committedDate": "2020-12-29T16:30:34Z", "message": "Add BinarySystemTypeReadBenchmark - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a37486c2d3154eb4da3588dd0ba39562c8318f22", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/a37486c2d3154eb4da3588dd0ba39562c8318f22", "committedDate": "2020-12-29T16:31:40Z", "message": "Add BinarySystemTypeReadBenchmark - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e21dd77467bd3a0af7035deb2c919d92b7aeef24", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/e21dd77467bd3a0af7035deb2c919d92b7aeef24", "committedDate": "2020-12-29T16:32:45Z", "message": "Add BinarySystemTypeReadBenchmark - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c28270da2588ac8c8b5ab3b49999387cfa101da4", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/c28270da2588ac8c8b5ab3b49999387cfa101da4", "committedDate": "2020-12-29T16:37:02Z", "message": "Add BinarySystemTypeReadBenchmark - ForceTimestamp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "758cf04d5c1176c486e31215e7a722d35e58b1ad", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/758cf04d5c1176c486e31215e7a722d35e58b1ad", "committedDate": "2020-12-29T16:42:54Z", "message": "Add BinarySystemTypeReadBenchmark - fix arrays"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66ff74293690265c4afc11beb88ef078dab269d6", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/66ff74293690265c4afc11beb88ef078dab269d6", "committedDate": "2020-12-29T16:47:00Z", "message": "Add BinarySystemTypeReadBenchmark - update results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6647ae8760572e6fcc39fd6bc190c4ea5db7c25a", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/6647ae8760572e6fcc39fd6bc190c4ea5db7c25a", "committedDate": "2020-12-29T16:53:14Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switcj"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bce7aba2a8ef5660f957ecbb6a773e86cc748f6f", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/bce7aba2a8ef5660f957ecbb6a773e86cc748f6f", "committedDate": "2020-12-29T17:05:24Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9792267ad45ba60d92b14891200f494f726ab7da", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/9792267ad45ba60d92b14891200f494f726ab7da", "committedDate": "2020-12-29T17:07:20Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a10481e99045d8a522f9afd6cff0f3cf986cecff", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/a10481e99045d8a522f9afd6cff0f3cf986cecff", "committedDate": "2020-12-29T17:35:17Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "165f8da5c9ae88827d92d4e75d0195b8c8ba8dc8", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/165f8da5c9ae88827d92d4e75d0195b8c8ba8dc8", "committedDate": "2020-12-29T17:38:12Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2f5478c5b037cfcec8320ece55dea77514a4ee6", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/a2f5478c5b037cfcec8320ece55dea77514a4ee6", "committedDate": "2020-12-29T17:40:05Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0233460f8cba18800671639fc9f4f54e31bd21b", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/b0233460f8cba18800671639fc9f4f54e31bd21b", "committedDate": "2020-12-29T17:42:11Z", "message": "Refactor BinarySystemHandlers.TryReadSystemType - use a switch - done"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feeab51d9b88e6bd2b942ac92688f97c48cabb9d", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/feeab51d9b88e6bd2b942ac92688f97c48cabb9d", "committedDate": "2020-12-29T18:16:23Z", "message": "Fixing signed/unsigned types handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59f06a41b19779eafb667f4a4295843735f9ecbb", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/59f06a41b19779eafb667f4a4295843735f9ecbb", "committedDate": "2020-12-29T18:17:12Z", "message": "Fixing signed/unsigned types handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "682bd6569875edfeeb5e78fda211c3cb0ae32a41", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/682bd6569875edfeeb5e78fda211c3cb0ae32a41", "committedDate": "2020-12-29T18:22:47Z", "message": "Fix OptimizedMarshallerObject reading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b250d3ec6a23d002309403d44e4a9b002c29d909", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/b250d3ec6a23d002309403d44e4a9b002c29d909", "committedDate": "2020-12-29T18:28:38Z", "message": "Update benchmark results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe9a22c54fae7d25a9ac433339c496373f41043d", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/fe9a22c54fae7d25a9ac433339c496373f41043d", "committedDate": "2020-12-29T18:37:59Z", "message": "Improve benchmark: remove all extra code for more precise results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13b350379d8f571463110402cc3632fefa5b710f", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/13b350379d8f571463110402cc3632fefa5b710f", "committedDate": "2020-12-29T18:40:43Z", "message": "Improve benchmark: remove all extra code for more precise results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "434f269d254d5b4ecb640badfd3749377e169ed1", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/434f269d254d5b4ecb640badfd3749377e169ed1", "committedDate": "2020-12-29T18:45:49Z", "message": "Update benchmark results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "737e8596462ad8eb2dcd4d75a447adc53016b238", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/737e8596462ad8eb2dcd4d75a447adc53016b238", "committedDate": "2020-12-29T18:50:50Z", "message": "Update benchmark results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76d80e215dc1da35e74079c830bd26bcc43c31c2", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/76d80e215dc1da35e74079c830bd26bcc43c31c2", "committedDate": "2020-12-29T18:55:12Z", "message": "Fix bench"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ed81ce08de47e38b318405646a24d1eddbbcf3c", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/3ed81ce08de47e38b318405646a24d1eddbbcf3c", "committedDate": "2020-12-29T18:59:57Z", "message": "Fix bench"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbae903d3efd2305ec066e5eed332b67c3d3ed9d", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/bbae903d3efd2305ec066e5eed332b67c3d3ed9d", "committedDate": "2020-12-29T19:02:53Z", "message": "cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13ee7a278e9507b79a6147a32c0c03d523b56799", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/13ee7a278e9507b79a6147a32c0c03d523b56799", "committedDate": "2020-12-29T19:05:43Z", "message": "minor cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "932c348adaa4ee98586814b9beb45e7341d0df44", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/932c348adaa4ee98586814b9beb45e7341d0df44", "committedDate": "2020-12-29T19:16:42Z", "message": "Merge remote-tracking branch 'origin/master' into ignite-13883\n\n# Conflicts:\n#\tmodules/platforms/dotnet/Apache.Ignite.Core.Tests/Services/Model.cs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5da91c393f627378c95358c0eec77e0610cf065c", "author": {"user": {"login": "ptupitsyn", "name": "Pavel Tupitsyn"}}, "url": "https://github.com/apache/ignite/commit/5da91c393f627378c95358c0eec77e0610cf065c", "committedDate": "2020-12-29T19:16:57Z", "message": "minor cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5Njc2MzU0", "url": "https://github.com/apache/ignite/pull/8627#pullrequestreview-559676354", "createdAt": "2020-12-29T19:46:22Z", "commit": {"oid": "5da91c393f627378c95358c0eec77e0610cf065c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxOTo0NjoyMlrOIMWuew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxOTo0NjoyMlrOIMWuew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTgyNjE3MQ==", "bodyText": "Should not we at least assert here that header is HdrString, if not HdrNull?", "url": "https://github.com/apache/ignite/pull/8627#discussion_r549826171", "createdAt": "2020-12-29T19:46:22Z", "author": {"login": "isapego"}, "path": "modules/platforms/dotnet/Apache.Ignite.Core/Impl/Binary/BinaryUtils.cs", "diffHunk": "@@ -1170,6 +1170,38 @@ public static T[] ReadArray<T>(BinaryReader ctx, bool typed)\n             return vals;\n         }\n \n+        /// <summary>\n+        /// Read string array.\n+        /// </summary>\n+        /// <param name=\"stream\">Stream</param>\n+        /// <returns>String array.</returns>\n+        public static string[] ReadStringArray(IBinaryStream stream)\n+        {\n+            var len = stream.ReadInt();\n+            var res = new string[len];\n+\n+            for (var i = 0; i < len; i++)\n+                res[i] = stream.ReadByte() == HdrNull ? null : ReadString(stream);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5da91c393f627378c95358c0eec77e0610cf065c"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2317, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}