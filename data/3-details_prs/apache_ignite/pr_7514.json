{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2ODE1Mjcy", "number": 7514, "title": "IGNITE-12773 : Reduce number of cluster deactivation methods in internal API.", "bodyText": "IGNITE-12773 : Reduce number of cluster deactivation methods in internal API.", "createdAt": "2020-03-11T17:08:58Z", "url": "https://github.com/apache/ignite/pull/7514", "merged": true, "mergeCommit": {"oid": "6a4a9c89e8fccd8491310b69d36b47010c9e5214"}, "closed": true, "closedAt": "2020-03-20T09:49:53Z", "author": {"login": "Vladsz83"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMqLyuAH2gAyMzg2ODE1MjcyOjc1ZDY5ZTU2ZmVhMWQxNDg2YmEzNzJlYWE0MTRhMDdkOTVmZDg2NmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPaB_RgH2gAyMzg2ODE1MjcyOmQyNjI3ZGFiMzU3M2Y5MWI4M2U5Mjk3NTM5ZDM0YmJjOGNmMTBhMWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "75d69e56fea1d1486ba372eaa414a07d95fd866a", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/75d69e56fea1d1486ba372eaa414a07d95fd866a", "committedDate": "2020-03-11T17:02:04Z", "message": "first impl."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/f7546f02209f332e5725fd36599abb977c38d68d", "committedDate": "2020-03-11T17:06:29Z", "message": "IGNITE-12773 : minority."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNTE4Mzk0", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-373518394", "createdAt": "2020-03-12T12:39:36Z", "commit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjozOTozNlrOF1c6Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjo0OTowNVrOF1dN5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU5MjQ4Mg==", "bodyText": "There is no cluster deactivation, forceDeactivation should be false.", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391592482", "createdAt": "2020-03-12T12:39:36Z", "author": {"login": "NSAmelchev"}, "path": "modules/clients/src/test/java/org/apache/ignite/internal/processors/rest/ChangeStateCommandHandlerTest.java", "diffHunk": "@@ -87,23 +89,23 @@\n     public void testActivateDeActivate() throws GridClientException {\n         GridClientClusterState state = client.state();\n \n-        boolean active = state.active();\n+        boolean active = state.state() == ACTIVE;\n \n         assertTrue(active);\n \n-        state.active(false);\n+        state.state(INACTIVE, true);\n \n         IgniteEx ig1 = grid(0);\n         IgniteEx ig2 = grid(1);\n \n         assertFalse(ig1.active());\n         assertFalse(ig2.active());\n-        assertFalse(state.active());\n+        assertEquals(state.state(), INACTIVE);\n \n-        state.active(true);\n+        state.state(ACTIVE, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU5MzgwNA==", "bodyText": "Can static import be used? like previuos test used", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391593804", "createdAt": "2020-03-12T12:42:01Z", "author": {"login": "NSAmelchev"}, "path": "modules/clients/src/test/java/org/apache/ignite/jdbc/thin/MvccJdbcTransactionFinishOnDeactivatedClusterSelfTest.java", "diffHunk": "@@ -153,7 +154,7 @@ private void deactivateThroughClient() throws Exception {\n \n             log.info(\">>> Try to deactivate ...\");\n \n-            state.active(false);\n+            state.state(ClusterState.INACTIVE, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU5NDc1NA==", "bodyText": "GridClientConnection::currentState now unused. Seems can be removed too", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391594754", "createdAt": "2020-03-12T12:43:44Z", "author": {"login": "NSAmelchev"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/client/impl/GridClientClusterStateImpl.java", "diffHunk": "@@ -54,16 +53,6 @@ public GridClientClusterStateImpl(\n         super(client, nodes, filter, balancer);\n     }\n \n-    /** {@inheritDoc} */\n-    @Override public void active(final boolean active) throws GridClientException {\n-        state(active ? ACTIVE : INACTIVE, true);\n-    }\n-\n-    /** {@inheritDoc} */\n-    @Override public boolean active() throws GridClientException {\n-        return withReconnectHandling(GridClientConnection::currentState).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU5NjYzNA==", "bodyText": "Why forceDeactivation should be true for cluster activate?", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391596634", "createdAt": "2020-03-12T12:47:25Z", "author": {"login": "NSAmelchev"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/cluster/IgniteClusterImpl.java", "diffHunk": "@@ -313,7 +315,7 @@ public IgniteClusterImpl(GridKernalContext ctx) {\n         guard();\n \n         try {\n-            ctx.state().changeGlobalState(active, serverNodes(), false).get();\n+            ctx.state().changeGlobalState(active ? ACTIVE : INACTIVE, true, serverNodes(), false, false).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU5NzU0Mg==", "bodyText": "Why forceDeactivation should be true for cluster activate?", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391597542", "createdAt": "2020-03-12T12:49:05Z", "author": {"login": "NSAmelchev"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/commandline/ActivateCommand.java", "diffHunk": "@@ -49,7 +50,7 @@\n         try (GridClient client = Command.startClient(cfg)) {\n             GridClientClusterState state = client.state();\n \n-            state.active(true);\n+            state.state(ACTIVE, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7546f02209f332e5725fd36599abb977c38d68d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15ca05bc3cb4b8f2346250e758df3512a0d09c96", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/15ca05bc3cb4b8f2346250e758df3512a0d09c96", "committedDate": "2020-03-12T13:06:26Z", "message": "IGNITE-12773 : fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa783a5cca19309d38c304e55b025e4ac90caa76", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/fa783a5cca19309d38c304e55b025e4ac90caa76", "committedDate": "2020-03-12T14:20:24Z", "message": "IGNITE-12773 : false flag for cluster activation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "846e4c67d5f1e6bb772125df74d61ab2bff6ed03", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/846e4c67d5f1e6bb772125df74d61ab2bff6ed03", "committedDate": "2020-03-12T14:27:30Z", "message": "IGNITE-12773 : fix of param description order."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNjEyOTg1", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-373612985", "createdAt": "2020-03-12T14:37:00Z", "commit": {"oid": "846e4c67d5f1e6bb772125df74d61ab2bff6ed03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDozNzowMFrOF1hXGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDozNzowMFrOF1hXGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY2NTQzMw==", "bodyText": "Mixed up expected-actual", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391665433", "createdAt": "2020-03-12T14:37:00Z", "author": {"login": "NSAmelchev"}, "path": "modules/clients/src/test/java/org/apache/ignite/internal/processors/rest/ChangeStateCommandHandlerTest.java", "diffHunk": "@@ -87,23 +89,23 @@\n     public void testActivateDeActivate() throws GridClientException {\n         GridClientClusterState state = client.state();\n \n-        boolean active = state.active();\n+        boolean active = state.state() == ACTIVE;\n \n         assertTrue(active);\n \n-        state.active(false);\n+        state.state(INACTIVE, true);\n \n         IgniteEx ig1 = grid(0);\n         IgniteEx ig2 = grid(1);\n \n         assertFalse(ig1.active());\n         assertFalse(ig2.active());\n-        assertFalse(state.active());\n+        assertEquals(state.state(), INACTIVE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "846e4c67d5f1e6bb772125df74d61ab2bff6ed03"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNjEzMDY2", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-373613066", "createdAt": "2020-03-12T14:37:05Z", "commit": {"oid": "846e4c67d5f1e6bb772125df74d61ab2bff6ed03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDozNzowNVrOF1hXVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDozNzowNVrOF1hXVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY2NTQ5Mw==", "bodyText": "Mixed up expected-actual", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391665493", "createdAt": "2020-03-12T14:37:05Z", "author": {"login": "NSAmelchev"}, "path": "modules/clients/src/test/java/org/apache/ignite/internal/processors/rest/ChangeStateCommandHandlerTest.java", "diffHunk": "@@ -87,23 +89,23 @@\n     public void testActivateDeActivate() throws GridClientException {\n         GridClientClusterState state = client.state();\n \n-        boolean active = state.active();\n+        boolean active = state.state() == ACTIVE;\n \n         assertTrue(active);\n \n-        state.active(false);\n+        state.state(INACTIVE, true);\n \n         IgniteEx ig1 = grid(0);\n         IgniteEx ig2 = grid(1);\n \n         assertFalse(ig1.active());\n         assertFalse(ig2.active());\n-        assertFalse(state.active());\n+        assertEquals(state.state(), INACTIVE);\n \n-        state.active(true);\n+        state.state(ACTIVE, false);\n \n         assertTrue(ig1.active());\n         assertTrue(ig2.active());\n-        assertTrue(state.active());\n+        assertEquals(state.state(), ACTIVE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "846e4c67d5f1e6bb772125df74d61ab2bff6ed03"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "854df30c311f42b9b066a036d1ec30b79e42c635", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/854df30c311f42b9b066a036d1ec30b79e42c635", "committedDate": "2020-03-12T14:40:52Z", "message": "IGNITE-12779 : small fix in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNjIwNTU0", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-373620554", "createdAt": "2020-03-12T14:45:29Z", "commit": {"oid": "854df30c311f42b9b066a036d1ec30b79e42c635"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDo0NToyOVrOF1ht_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNDo0NToyOVrOF1ht_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY3MTI5NA==", "bodyText": "ClusterState.active(ClusterState state) was used.", "url": "https://github.com/apache/ignite/pull/7514#discussion_r391671294", "createdAt": "2020-03-12T14:45:29Z", "author": {"login": "NSAmelchev"}, "path": "modules/clients/src/test/java/org/apache/ignite/internal/processors/rest/ChangeStateCommandHandlerTest.java", "diffHunk": "@@ -87,23 +89,23 @@\n     public void testActivateDeActivate() throws GridClientException {\n         GridClientClusterState state = client.state();\n \n-        boolean active = state.active();\n+        boolean active = state.state() == ACTIVE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854df30c311f42b9b066a036d1ec30b79e42c635"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cc1072566e64ed233486cb0cf68638116a9f016", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/5cc1072566e64ed233486cb0cf68638116a9f016", "committedDate": "2020-03-12T15:01:10Z", "message": "IGNITE-12773 : minor fix in test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "857c4ba4406374f03ad89a494441f0f409c2c707", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/857c4ba4406374f03ad89a494441f0f409c2c707", "committedDate": "2020-03-12T15:02:35Z", "message": "IGNITE-12773 : minor fix2 in test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MjAxNDY3", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-374201467", "createdAt": "2020-03-13T10:42:24Z", "commit": {"oid": "857c4ba4406374f03ad89a494441f0f409c2c707"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26c7a9eec319a32060cd953051d3fab8a0e01211", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/26c7a9eec319a32060cd953051d3fab8a0e01211", "committedDate": "2020-03-19T11:06:06Z", "message": "IGNITE-12773 : better diff."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26f903cee5c29d5dcd0c81392efbf62d62b36792", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/26f903cee5c29d5dcd0c81392efbf62d62b36792", "committedDate": "2020-03-19T13:15:30Z", "message": "IGNITE-12773 : reverted call without isAutoAdjust."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe4b225e21c621c08514ff9c82c70a2bf6503874", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/fe4b225e21c621c08514ff9c82c70a2bf6503874", "committedDate": "2020-03-19T15:06:29Z", "message": "IGNITE-12773 : removed call with isAutoAdjust from the itf."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTIzNDg2", "url": "https://github.com/apache/ignite/pull/7514#pullrequestreview-377923486", "createdAt": "2020-03-19T17:08:00Z", "commit": {"oid": "fe4b225e21c621c08514ff9c82c70a2bf6503874"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "403cbc2c8053644184f4cfc393c49bd5be2ddcde", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/403cbc2c8053644184f4cfc393c49bd5be2ddcde", "committedDate": "2020-03-19T20:18:47Z", "message": "IGNITE-12773 : checkstyle fix."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2627dab3573f91b83e9297539d34bbc8cf10a1d", "author": {"user": {"login": "Vladsz83", "name": "Vladimir Steshin"}}, "url": "https://github.com/apache/ignite/commit/d2627dab3573f91b83e9297539d34bbc8cf10a1d", "committedDate": "2020-03-20T05:54:39Z", "message": "IGNITE-12773 : + comment."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2745, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}