{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NzUzMzI0", "number": 8431, "title": "IGNITE-13633 Fix ServiceDescriptor.serviceClass failure in case of de\u2026", "bodyText": "\u2026ployed via DeploymentSPI service\nThank you for submitting the pull request to the Apache Ignite.\nIn order to streamline the review of the contribution\nwe ask you to ensure the following steps have been taken:\nThe Contribution Checklist\n\n There is a single JIRA ticket related to the pull request.\n The web-link to the pull request is attached to the JIRA ticket.\n The JIRA ticket has the Patch Available state.\n The pull request body describes changes that have been made.\nThe description explains WHAT and WHY was made instead of HOW.\n The pull request title is treated as the final commit message.\nThe following pattern must be used: IGNITE-XXXX Change summary where XXXX - number of JIRA issue.\n A reviewer has been mentioned through the JIRA comments\n(see the Maintainers list)\n The pull request has been checked by the Teamcity Bot and\nthe green visa attached to the JIRA ticket (see TC.Bot: Check PR)\n\nNotes\n\nHow to Contribute\nCoding abbreviation rules\nCoding Guidelines\nApache Ignite Teamcity Bot\n\nIf you need any help, please email dev@ignite.apache.org or ask an\u0443 advice on http://asf.slack.com #ignite channel.", "createdAt": "2020-11-06T13:46:53Z", "url": "https://github.com/apache/ignite/pull/8431", "merged": true, "mergeCommit": {"oid": "dac370614be8c660601c881c2fc7bc79f9089df9"}, "closed": true, "closedAt": "2020-12-04T10:07:42Z", "author": {"login": "alex-plekhanov"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZ3OuKAH2gAyNTE2NzUzMzI0OjU1MzFmMGMwMWExYmQ3MDcwYmI5MzcyYjU4OTY0MWVmY2I2ZjA1NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiT1AMgFqTU0MzE3NDMwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5531f0c01a1bd7070bb9372b589641efcb6f0544", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/5531f0c01a1bd7070bb9372b589641efcb6f0544", "committedDate": "2020-11-06T13:46:12Z", "message": "IGNITE-13633 Fix ServiceDescriptor.serviceClass failure in case of deployed via DeploymentSPI service"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNTEyMTQ3", "url": "https://github.com/apache/ignite/pull/8431#pullrequestreview-532512147", "createdAt": "2020-11-17T15:49:13Z", "commit": {"oid": "5531f0c01a1bd7070bb9372b589641efcb6f0544"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNTo0OToxNFrOH075Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNTo1ODoyNFrOH08VrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI2OTI2Ng==", "bodyText": "I think that we shouldn't remove this check because this test is relevant only for the new Service Grid implementation.\nWe can remove such checks with the legacy SG-processor in future.", "url": "https://github.com/apache/ignite/pull/8431#discussion_r525269266", "createdAt": "2020-11-17T15:49:14Z", "author": {"login": "daradurvs"}, "path": "modules/core/src/test/java/org/apache/ignite/internal/processors/service/ServiceHotRedeploymentViaDeploymentSpiTest.java", "diffHunk": "@@ -61,12 +66,6 @@\n         return cfg;\n     }\n \n-    /** */\n-    @BeforeClass", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5531f0c01a1bd7070bb9372b589641efcb6f0544"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3NjExNQ==", "bodyText": "ServiceInfo is a serializable unit.\nI'm not sure that there is a sense to transfer GridKernalContext instance.\nMaybe it's better to make the field transient and initialize it after deserialization.\nWhat do you think?", "url": "https://github.com/apache/ignite/pull/8431#discussion_r525276115", "createdAt": "2020-11-17T15:57:46Z", "author": {"login": "daradurvs"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/service/ServiceInfo.java", "diffHunk": "@@ -37,6 +39,9 @@\n     /** */\n     private static final long serialVersionUID = 0L;\n \n+    /** Context. */\n+    private final GridKernalContext ctx;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5531f0c01a1bd7070bb9372b589641efcb6f0544"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI3NjU4OA==", "bodyText": "We have similar logic here IgniteServiceProcessor#copyAndInject\nCan't we reuse it?", "url": "https://github.com/apache/ignite/pull/8431#discussion_r525276588", "createdAt": "2020-11-17T15:58:24Z", "author": {"login": "daradurvs"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/service/ServiceInfo.java", "diffHunk": "@@ -116,15 +125,28 @@ public IgniteUuid serviceId() {\n     }\n \n     /** {@inheritDoc} */\n-    @SuppressWarnings(\"unchecked\")\n     @Override public Class<? extends Service> serviceClass() {\n         if (cfg instanceof LazyServiceConfiguration) {\n+            if (srvcCls != null)\n+                return srvcCls;\n+\n             String clsName = ((LazyServiceConfiguration)cfg).serviceClassName();\n \n             try {\n-                return (Class<? extends Service>)Class.forName(clsName);\n+                srvcCls = (Class<? extends Service>)Class.forName(clsName);\n+\n+                return srvcCls;\n             }\n             catch (ClassNotFoundException e) {\n+                GridDeployment srvcDep = ctx.deploy().getDeployment(clsName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5531f0c01a1bd7070bb9372b589641efcb6f0544"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9245c9ba23d85e42eade478c774510505ccaf436", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/9245c9ba23d85e42eade478c774510505ccaf436", "committedDate": "2020-11-19T15:06:47Z", "message": "IGNITE-13633 Review fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1144b052f3ac4be2fbd97c37cc53c25f701e5051", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/1144b052f3ac4be2fbd97c37cc53c25f701e5051", "committedDate": "2020-12-02T09:48:17Z", "message": "IGNITE-13663 Review fixes, partial revert"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ce95c603e15aa81d665c0be5b2b89466982d0fb", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/1ce95c603e15aa81d665c0be5b2b89466982d0fb", "committedDate": "2020-12-02T10:43:15Z", "message": "IGNITE-13663 Unused imports removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "880b49754dfdd14fb9dbdd1c63bc22ae88a8d49f", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/880b49754dfdd14fb9dbdd1c63bc22ae88a8d49f", "committedDate": "2020-12-02T12:58:17Z", "message": "IGNITE-13663 Review fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b37d9802d1be71efa74a8e243fbd2493b1f2a6cc", "author": {"user": {"login": "alex-plekhanov", "name": "Aleksey Plekhanov"}}, "url": "https://github.com/apache/ignite/commit/b37d9802d1be71efa74a8e243fbd2493b1f2a6cc", "committedDate": "2020-12-02T13:00:32Z", "message": "IGNITE-13663 Review fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTc0MzA2", "url": "https://github.com/apache/ignite/pull/8431#pullrequestreview-543174306", "createdAt": "2020-12-02T19:36:45Z", "commit": {"oid": "b37d9802d1be71efa74a8e243fbd2493b1f2a6cc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3104, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}