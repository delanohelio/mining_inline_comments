{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwMjI0NDE1", "number": 8109, "title": "Json params support", "bodyText": "", "createdAt": "2020-07-31T14:59:07Z", "url": "https://github.com/apache/ignite/pull/8109", "merged": true, "mergeCommit": {"oid": "254bb679629a14a64538233792ffa7dd353f6bb9"}, "closed": true, "closedAt": "2020-08-05T09:30:21Z", "author": {"login": "anton-vinogradov"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6VgadAH2gAyNDYwMjI0NDE1OmQ5Zjg0N2IzNjU1MTM2YzUwNzIyNmFjZjNhMGUwM2ZkOGVkM2YxN2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc72zFSgH2gAyNDYwMjI0NDE1OjJlNDA2Nzc0YmQ1NzIxM2VjYjE0M2ExYzhjNDNiZDlkZjRjMjcyODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/d9f847b3655136c507226acf3a0e03fd8ed3f17d", "committedDate": "2020-07-31T14:57:06Z", "message": "Json params support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MjU5Nzk3", "url": "https://github.com/apache/ignite/pull/8109#pullrequestreview-459259797", "createdAt": "2020-07-31T15:22:01Z", "commit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToyMjowMVrOG6MeXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNTozODo0MlrOG6NCWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NDk3NA==", "bodyText": "Why do you use Map instead of fair JsonNode object? Now you're limited with flat structure, also user is responsible for casting value types.", "url": "https://github.com/apache/ignite/pull/8109#discussion_r463674974", "createdAt": "2020-07-31T15:22:01Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/src/main/java/org/apache/ignite/internal/ducktest/tests/DataGenerationApplication.java", "diffHunk": "@@ -34,13 +35,13 @@ public DataGenerationApplication(Ignite ignite) {\n     }\n \n     /** {@inheritDoc} */\n-    @Override protected void run(String[] args) {\n+    @Override protected void run(Map<String, String> args) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NzM5Mg==", "bodyText": "Why do you use base64 there? Is it a workaround to avoid escape issue?", "url": "https://github.com/apache/ignite/pull/8109#discussion_r463677392", "createdAt": "2020-07-31T15:26:13Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_aware_app.py", "diffHunk": "@@ -82,7 +84,7 @@ def app_args(self):\n         args = self.java_class_name + \",\" + IgniteAwareApplicationService.CONFIG_FILE\n \n         if self.params != \"\":\n-            args += \",\" + self.params\n+            args += \",\" + str(base64.b64encode(json.dumps(self.params).encode(\"UTF-8\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MDgzMA==", "bodyText": "Looks like user_libs and service_libs should be lists and shouldn't know about colons delimeter. As colon is a part of USER_LIBS, now we have usage of the delimiter in 3 places (user_libs, service_libs, USER_LIBS)", "url": "https://github.com/apache/ignite/pull/8109#discussion_r463680830", "createdAt": "2020-07-31T15:32:35Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_aware_app.py", "diffHunk": "@@ -106,7 +108,23 @@ def env(self):\n         return \"export MAIN_CLASS={main_class}; \".format(main_class=self.servicejava_class_name) + \\\n                \"export EXCLUDE_TEST_CLASSES=true; \" + \\\n                \"export IGNITE_LOG_DIR={log_dir}; \".format(log_dir=self.PERSISTENT_ROOT) + \\\n-               \"export USER_LIBS=%s:/opt/ignite-dev/modules/ducktests/target/*; \" % self.user_libs\n+               \"export USER_LIBS=%s:/opt/ignite-dev/modules/ducktests/target/*%s; \" % \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MTEwMg==", "bodyText": "just rename _home to home and use it", "url": "https://github.com/apache/ignite/pull/8109#discussion_r463681102", "createdAt": "2020-07-31T15:33:05Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_path.py", "diffHunk": "@@ -56,3 +56,9 @@ def script(self, script_name):\n         :return: absolute path to the specified script\n         \"\"\"\n         return os.path.join(self._home, \"bin\", script_name)\n+\n+    def home(self):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4NDE4Ng==", "bodyText": "Why do you extract jackson jars from the AWS library? As I can see AWS isn't used in the application", "url": "https://github.com/apache/ignite/pull/8109#discussion_r463684186", "createdAt": "2020-07-31T15:38:42Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/tests/ignitetest/services/utils/ignite_aware_app.py", "diffHunk": "@@ -106,7 +108,23 @@ def env(self):\n         return \"export MAIN_CLASS={main_class}; \".format(main_class=self.servicejava_class_name) + \\\n                \"export EXCLUDE_TEST_CLASSES=true; \" + \\\n                \"export IGNITE_LOG_DIR={log_dir}; \".format(log_dir=self.PERSISTENT_ROOT) + \\\n-               \"export USER_LIBS=%s:/opt/ignite-dev/modules/ducktests/target/*; \" % self.user_libs\n+               \"export USER_LIBS=%s:/opt/ignite-dev/modules/ducktests/target/*%s; \" % \\\n+               (self.user_libs, self.app_service_libs())\n+\n+    def app_service_libs(self):\n+        \"\"\"\n+        :return: Libs required to start IgniteAwareApplication java implementation.\n+        \"\"\"\n+        if self.version.is_dev:\n+            return \"\"\n+\n+        libs = \"\"\n+\n+        for line in self.nodes[0].account.ssh_capture(\n+                \"ls -d %s/libs/optional/ignite-aws/* | grep jackson | tr '\\n' ':' | sed 's/.$//'\" % self.path.home()):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9f847b3655136c507226acf3a0e03fd8ed3f17d"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "903dfb88c5dda6f636fc13f8a33e50a504abc09f", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/903dfb88c5dda6f636fc13f8a33e50a504abc09f", "committedDate": "2020-08-04T08:38:22Z", "message": "Json params support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05ba11c69ac4ce6503a466d3f883c7f741b2a4c0", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/05ba11c69ac4ce6503a466d3f883c7f741b2a4c0", "committedDate": "2020-08-04T10:22:12Z", "message": "Json params support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNzMyODMx", "url": "https://github.com/apache/ignite/pull/8109#pullrequestreview-460732831", "createdAt": "2020-08-04T11:39:39Z", "commit": {"oid": "05ba11c69ac4ce6503a466d3f883c7f741b2a4c0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMTozOTozOVrOG7cnEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMTozOTozOVrOG7cnEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk4NzkyMg==", "bodyText": "Is it possible to use a DTO object instead? Generics is more clear solution", "url": "https://github.com/apache/ignite/pull/8109#discussion_r464987922", "createdAt": "2020-08-04T11:39:39Z", "author": {"login": "timoninmaxim"}, "path": "modules/ducktests/src/main/java/org/apache/ignite/internal/ducktest/tests/DataGenerationApplication.java", "diffHunk": "@@ -34,13 +35,13 @@ public DataGenerationApplication(Ignite ignite) {\n     }\n \n     /** {@inheritDoc} */\n-    @Override protected void run(String[] args) {\n+    @Override protected void run(JsonNode jsonNode) {\n         log.info(\"Creating cache...\");\n \n-        IgniteCache<Integer, Integer> cache = ignite.createCache(args[0]);\n+        IgniteCache<Integer, Integer> cache = ignite.createCache(jsonNode.get(\"cacheName\").asText());\n \n         try (IgniteDataStreamer<Integer, Integer> stmr = ignite.dataStreamer(cache.getName())) {\n-            for (int i = 0; i < Integer.parseInt(args[1]); i++) {\n+            for (int i = 0; i < jsonNode.get(\"range\").asInt(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05ba11c69ac4ce6503a466d3f883c7f741b2a4c0"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ebdc0412e92817027cdd6d45a58f200d0d1cc9", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/08ebdc0412e92817027cdd6d45a58f200d0d1cc9", "committedDate": "2020-08-04T11:51:02Z", "message": "Json params support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee5057140f12c9d14ef1de9f779a139fd0634ef8", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/ee5057140f12c9d14ef1de9f779a139fd0634ef8", "committedDate": "2020-08-04T12:26:38Z", "message": "Json params support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e934bb2978b19af4b2ab3dfc4a0f98b0ec272835", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/e934bb2978b19af4b2ab3dfc4a0f98b0ec272835", "committedDate": "2020-08-04T13:53:33Z", "message": "Merge branch 'ignite-ducktape' into ignite-ducktape-json-params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6d53817fa12ac9f6fbb999207d09cae7d599c17", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/d6d53817fa12ac9f6fbb999207d09cae7d599c17", "committedDate": "2020-08-04T14:27:23Z", "message": "Json params support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDI4OTc5", "url": "https://github.com/apache/ignite/pull/8109#pullrequestreview-461428979", "createdAt": "2020-08-05T08:00:19Z", "commit": {"oid": "d6d53817fa12ac9f6fbb999207d09cae7d599c17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwODowMDoxOVrOG7-nsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwODowMDoxOVrOG7-nsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU0NTEzOQ==", "bodyText": "Unused variable, I presume", "url": "https://github.com/apache/ignite/pull/8109#discussion_r465545139", "createdAt": "2020-08-05T08:00:19Z", "author": {"login": "ivandasch"}, "path": "modules/ducktests/src/main/java/org/apache/ignite/internal/ducktest/utils/IgniteAwareApplicationService.java", "diffHunk": "@@ -40,8 +47,15 @@ public static void main(String[] args) throws Exception {\n \n         IgniteAwareApplication app = (IgniteAwareApplication)clazz.getConstructor().newInstance();\n \n-        String[] appParams = Arrays.copyOfRange(params, 1, params.length);\n+        ObjectMapper mapper = new ObjectMapper();\n+\n+        ObjectReader reader = mapper.readerFor(Map.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6d53817fa12ac9f6fbb999207d09cae7d599c17"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e406774bd57213ecb143a1c8c43bd9df4c27280", "author": {"user": {"login": "anton-vinogradov", "name": "Anton Vinogradov"}}, "url": "https://github.com/apache/ignite/commit/2e406774bd57213ecb143a1c8c43bd9df4c27280", "committedDate": "2020-08-05T08:18:17Z", "message": "Json params support"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3203, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}