{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2Mzk2MzI2", "number": 7593, "title": "IGNITE-12790 introduce distributed SQL configuration and ability to disable SQL functions ", "bodyText": "", "createdAt": "2020-03-31T15:01:55Z", "url": "https://github.com/apache/ignite/pull/7593", "merged": true, "mergeCommit": {"oid": "a65e51c9148cd765f3a58b956e4e0e08ddc7a201"}, "closed": true, "closedAt": "2020-04-17T10:41:12Z", "author": {"login": "tledkov-gridgain"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTEcYmAH2gAyMzk2Mzk2MzI2OjMyNTlkMDc2NTlkMzNiODhhYTA1OTRhZjA0NjlhMDc2ZmQ5YzI5NDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYe5fsgFqTM5NTM0NzY5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3259d07659d33b88aa0594af0469a076fd9c2942", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/3259d07659d33b88aa0594af0469a076fd9c2942", "committedDate": "2020-03-31T15:01:16Z", "message": "IGNITE-12790 introduce distributed SQL configuration and disable insecure SQL functions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "011d441ab7780aa0eb9c054d1ed55a19713e97ba", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/011d441ab7780aa0eb9c054d1ed55a19713e97ba", "committedDate": "2020-04-03T08:54:51Z", "message": "Merge branch 'apache-master' into ignite-12790\n\n# Conflicts:\n#\tmodules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/IgniteH2Indexing.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7776ed5a286589424e32de14ab9a080bd612cbad", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/7776ed5a286589424e32de14ab9a080bd612cbad", "committedDate": "2020-04-03T08:55:41Z", "message": "IGNITE-12790 fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6b030388f414c44644f6465c663f71566bea201", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/c6b030388f414c44644f6465c663f71566bea201", "committedDate": "2020-04-03T08:57:47Z", "message": "Merge branch 'apache-master' into ignite-12790"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4ODU3OTIw", "url": "https://github.com/apache/ignite/pull/7593#pullrequestreview-388857920", "createdAt": "2020-04-07T07:38:02Z", "commit": {"oid": "c6b030388f414c44644f6465c663f71566bea201"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNzozODowMlrOGB2x6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNzozODowMlrOGB2x6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU5OTI3Mg==", "bodyText": "Javadoc", "url": "https://github.com/apache/ignite/pull/7593#discussion_r404599272", "createdAt": "2020-04-07T07:38:02Z", "author": {"login": "AMashenkov"}, "path": "modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/FunctionsManager.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.ignite.internal.processors.query.h2;\n+\n+import java.lang.reflect.Field;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Objects;\n+import java.util.Set;\n+import org.h2.expression.Function;\n+\n+/**\n+ * SQL function manager.\n+ */\n+@SuppressWarnings(\"unchecked\")\n+public class FunctionsManager {\n+    /** Original H2 functions set. */\n+    private static HashMap<String, Object> origFuncs;\n+\n+    /** Current H2 functions set. */\n+    private static HashMap<String, Object> funcs;\n+\n+    static {\n+        try {\n+            Field fldFUNCTIONS = Function.class.getDeclaredField(\"FUNCTIONS\");\n+\n+            fldFUNCTIONS.setAccessible(true);\n+\n+            funcs = (HashMap<String, Object>)fldFUNCTIONS.get(Class.class);\n+\n+            origFuncs = new HashMap<>(funcs);\n+        }\n+        catch (NoSuchFieldException | IllegalAccessException e) {\n+            e.printStackTrace();\n+        }\n+    }\n+\n+    /**\n+     *\n+     */\n+    public FunctionsManager(DistributedSqlConfiguration distSqlCfg) {\n+        assert Objects.nonNull(funcs);\n+        assert Objects.nonNull(origFuncs);\n+        distSqlCfg.listenDisabledFunctions(this::updateDisabledFunctions);\n+    }\n+\n+    /**\n+     *\n+     */\n+    private void updateDisabledFunctions(String s, HashSet<String> oldFuncs, HashSet<String> newFuncs) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6b030388f414c44644f6465c663f71566bea201"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a57e84639ff82490b3fde57784173c160a50cd1", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/4a57e84639ff82490b3fde57784173c160a50cd1", "committedDate": "2020-04-07T08:10:15Z", "message": "IGNITE-12790 javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39d85136dadcc9b6b69da359896ef2e0896a1d0e", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/39d85136dadcc9b6b69da359896ef2e0896a1d0e", "committedDate": "2020-04-07T08:23:20Z", "message": "Merge branch 'apache-master' into ignite-12790"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4ODkzNTQ0", "url": "https://github.com/apache/ignite/pull/7593#pullrequestreview-388893544", "createdAt": "2020-04-07T08:25:42Z", "commit": {"oid": "39d85136dadcc9b6b69da359896ef2e0896a1d0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17337dbd235b47de4e04dce8f87c191030343118", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/17337dbd235b47de4e04dce8f87c191030343118", "committedDate": "2020-04-14T14:54:23Z", "message": "IGNITE-12790: fix case when metastorage is not available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a82b7863adaa79a4f04fabf45ca5f576ec750018", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/a82b7863adaa79a4f04fabf45ca5f576ec750018", "committedDate": "2020-04-14T14:54:46Z", "message": "Merge branch 'apache-master' into ignite-12790"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0cb2ffbbc936edbb4620d279a9854682edaedfb", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/f0cb2ffbbc936edbb4620d279a9854682edaedfb", "committedDate": "2020-04-15T10:15:18Z", "message": "IGNITE-12790: fix compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e33d3fe0c668624185cfcdf71bccf9279952a56", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/9e33d3fe0c668624185cfcdf71bccf9279952a56", "committedDate": "2020-04-15T10:45:52Z", "message": "IGNITE-12790: fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dc684ad1c0d48e2eca55de9b7e853823dd7f48e", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/8dc684ad1c0d48e2eca55de9b7e853823dd7f48e", "committedDate": "2020-04-15T13:51:36Z", "message": "Merge branch 'apache-master' into ignite-12790"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2db7cd7fa3a82d5601c4bf02422b835a93f70a8c", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/2db7cd7fa3a82d5601c4bf02422b835a93f70a8c", "committedDate": "2020-04-15T15:18:25Z", "message": "IGNITE-12790: fix ML test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efd1ea919e961ff9157176521c46886998ba15ed", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/efd1ea919e961ff9157176521c46886998ba15ed", "committedDate": "2020-04-15T15:28:14Z", "message": "IGNITE-12790: fix comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f670e07c3f887c8605b92376f37c2d30361685dc", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/f670e07c3f887c8605b92376f37c2d30361685dc", "committedDate": "2020-04-15T17:54:39Z", "message": "IGNITE-12790: fix ML test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77cbbecb71683f0f40033a06e63dc1620b6345cb", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/77cbbecb71683f0f40033a06e63dc1620b6345cb", "committedDate": "2020-04-15T19:40:07Z", "message": "IGNITE-12790: fix ML test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62cb2f952107d3172fdca8e034ec8938ff129a11", "author": {"user": {"login": "tledkov-gridgain", "name": "Taras Ledkov"}}, "url": "https://github.com/apache/ignite/commit/62cb2f952107d3172fdca8e034ec8938ff129a11", "committedDate": "2020-04-16T08:15:30Z", "message": "IGNITE-12790: add TODO"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MzQ3Njk4", "url": "https://github.com/apache/ignite/pull/7593#pullrequestreview-395347698", "createdAt": "2020-04-17T10:40:13Z", "commit": {"oid": "62cb2f952107d3172fdca8e034ec8938ff129a11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2802, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}