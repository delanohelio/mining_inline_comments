{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2ODc2ODYw", "number": 7310, "title": "IGNITE-12576 nodeId replaced with consistentId in TcpCommunicationSpi for usability purposes.", "bodyText": "", "createdAt": "2020-01-24T15:00:16Z", "url": "https://github.com/apache/ignite/pull/7310", "merged": true, "mergeCommit": {"oid": "eec735a4ea39439d57a1da89b5cc17bfbff2a74c"}, "closed": true, "closedAt": "2020-01-30T08:24:13Z", "author": {"login": "ibessonov"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9gQJ5gH2gAyMzY2ODc2ODYwOjZlMjRhYmFlNDdiOTQzZTFiZDJmOGUyNzZlOTY4M2YxZGY3YjBhYzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_H-VpgH2gAyMzY2ODc2ODYwOjdmNmEzNWYxZmUyODBjY2VlZTg5ZjI1Y2Q4YjAxNTA4ZmM3YTMwZTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/6e24abae47b943e1bd2f8e276e9683f1df7b0ac2", "committedDate": "2020-01-24T14:58:55Z", "message": "IGNITE-12576 nodeId replaced with consistentId in TcpCommunicationSpi for usability purposes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NzY3NzA0", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-348767704", "createdAt": "2020-01-27T15:49:56Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNTo0OTo1N1rOFiHmGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNTo0OTo1N1rOFiHmGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMyMDM0Nw==", "bodyText": "Metric named ConsistentIdMetric but the constant for looking up named as by nodeId SENT_MESSAGES_BY_NODE_ID_METRIC_NAME why?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371320347", "createdAt": "2020-01-27T15:49:57Z", "author": {"login": "Mmuzaf"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -121,11 +134,17 @@ public TcpCommunicationMetricsListener(GridMetricManager mmgr) {\n         );\n \n         sentMsgsCntByNodeIdMetricFactory = nodeId ->\n-            mmgr.registry(metricName(COMMUNICATION_METRICS_GROUP_NAME, nodeId.toString()))\n-                .findMetric(SENT_MESSAGES_BY_NODE_ID_METRIC_NAME);\n+            allSentMsgsMetricsByNodeId.computeIfAbsent(nodeId, k -> new AtomicLong());\n \n         rcvdMsgsCntByNodeIdMetricFactory = nodeId ->\n-            mmgr.registry(metricName(COMMUNICATION_METRICS_GROUP_NAME, nodeId.toString()))\n+            allRcvdMsgsMetricsByNodeId.computeIfAbsent(nodeId, k -> new AtomicLong());\n+\n+        sentMsgsCntByConsistentIdMetricFactory = consistentId ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NzkzNDk5", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-348793499", "createdAt": "2020-01-27T16:21:33Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNjoyMTozNFrOFiIy2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNjoyMTozNFrOFiIy2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMzOTk5Mw==", "bodyText": "Why we should keep this metric if it totally replaced with the new one?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371339993", "createdAt": "2020-01-27T16:21:34Z", "author": {"login": "Mmuzaf"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -121,11 +134,17 @@ public TcpCommunicationMetricsListener(GridMetricManager mmgr) {\n         );\n \n         sentMsgsCntByNodeIdMetricFactory = nodeId ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTczNzI1", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349173725", "createdAt": "2020-01-28T07:38:35Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzozODozNVrOFibZUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzozODozNVrOFibZUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NDc1NA==", "bodyText": "Why this change?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371644754", "createdAt": "2020-01-28T07:38:35Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -82,10 +83,22 @@\n     private final Function<Short, LongAdderMetric> rcvdMsgsCntByTypeMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code sentMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> sentMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> sentMsgsCntByNodeIdMetricFactory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc0NTA4", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349174508", "createdAt": "2020-01-28T07:40:48Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MDo0OFrOFibbvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MDo0OFrOFibbvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NTM3Mw==", "bodyText": "nodeId should be removed as it not used.", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371645373", "createdAt": "2020-01-28T07:40:48Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -404,36 +423,50 @@ public static String receivedMessagesByTypeMetricName(Short directType) {\n         /**\n          * Sent messages count metrics grouped by message node id.\n          */\n-        public volatile Map<UUID, LongAdderMetric> sentMsgsMetricsByNodeId = new HashMap<>();\n+        public volatile Map<UUID, AtomicLong> sentMsgsMetricsByNodeId = new HashMap<>();\n \n         /**\n          * Received messages metrics count grouped by message node id.\n          */\n-        public volatile Map<UUID, LongAdderMetric> rcvdMsgsMetricsByNodeId = new HashMap<>();\n+        public volatile Map<UUID, AtomicLong> rcvdMsgsMetricsByNodeId = new HashMap<>();\n+\n+        /**\n+         * Sent messages count metrics grouped by message node consistent id.\n+         */\n+        public volatile Map<Object, LongAdderMetric> sentMsgsMetricsByConsistentId = new HashMap<>();\n+\n+        /**\n+         * Received messages metrics count grouped by message node consistent id.\n+         */\n+        public volatile Map<Object, LongAdderMetric> rcvdMsgsMetricsByConsistentId = new HashMap<>();\n \n \n         /**\n          * Collects statistics for message sent by SPI.\n-         *\n-         * @param msg Sent message.\n+         *  @param msg Sent message.\n+         * @param consistentId Receiver node consistent id.\n          * @param nodeId Receiver node id.\n          */\n-        private void onMessageSent(Message msg, UUID nodeId) {\n+        private void onMessageSent(Message msg, Object consistentId, UUID nodeId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 196}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc0NTkx", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349174591", "createdAt": "2020-01-28T07:41:02Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MTowMlrOFibb-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MTowMlrOFibb-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NTQzNQ==", "bodyText": "nodeId should be removed as it not used.", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371645435", "createdAt": "2020-01-28T07:41:02Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -404,36 +423,50 @@ public static String receivedMessagesByTypeMetricName(Short directType) {\n         /**\n          * Sent messages count metrics grouped by message node id.\n          */\n-        public volatile Map<UUID, LongAdderMetric> sentMsgsMetricsByNodeId = new HashMap<>();\n+        public volatile Map<UUID, AtomicLong> sentMsgsMetricsByNodeId = new HashMap<>();\n \n         /**\n          * Received messages metrics count grouped by message node id.\n          */\n-        public volatile Map<UUID, LongAdderMetric> rcvdMsgsMetricsByNodeId = new HashMap<>();\n+        public volatile Map<UUID, AtomicLong> rcvdMsgsMetricsByNodeId = new HashMap<>();\n+\n+        /**\n+         * Sent messages count metrics grouped by message node consistent id.\n+         */\n+        public volatile Map<Object, LongAdderMetric> sentMsgsMetricsByConsistentId = new HashMap<>();\n+\n+        /**\n+         * Received messages metrics count grouped by message node consistent id.\n+         */\n+        public volatile Map<Object, LongAdderMetric> rcvdMsgsMetricsByConsistentId = new HashMap<>();\n \n \n         /**\n          * Collects statistics for message sent by SPI.\n-         *\n-         * @param msg Sent message.\n+         *  @param msg Sent message.\n+         * @param consistentId Receiver node consistent id.\n          * @param nodeId Receiver node id.\n          */\n-        private void onMessageSent(Message msg, UUID nodeId) {\n+        private void onMessageSent(Message msg, Object consistentId, UUID nodeId) {\n             sentMsgsMetricsByType.computeIfAbsent(msg.directType(), sentMsgsCntByTypeMetricFactory).increment();\n \n-            sentMsgsMetricsByNodeId.computeIfAbsent(nodeId, sentMsgsCntByNodeIdMetricFactory).increment();\n+            sentMsgsMetricsByConsistentId.computeIfAbsent(consistentId, sentMsgsCntByConsistentIdMetricFactory).increment();\n+\n+            sentMsgsMetricsByNodeId.computeIfAbsent(nodeId, sentMsgsCntByNodeIdMetricFactory).incrementAndGet();\n         }\n \n         /**\n          * Collects statistics for message received by SPI.\n-         *\n-         * @param msg Received message.\n+         *  @param msg Received message.\n+         * @param consistentId Sender node consistent id.\n          * @param nodeId Sender node id.\n          */\n-        private void onMessageReceived(Message msg, UUID nodeId) {\n+        private void onMessageReceived(Message msg, Object consistentId, UUID nodeId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 214}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc1MDUw", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349175050", "createdAt": "2020-01-28T07:42:13Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjoxNFrOFibdVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjoxNFrOFibdVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NTc4MQ==", "bodyText": "Are we still need this factory?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371645781", "createdAt": "2020-01-28T07:42:14Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -82,10 +83,22 @@\n     private final Function<Short, LongAdderMetric> rcvdMsgsCntByTypeMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code sentMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> sentMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> sentMsgsCntByNodeIdMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code rcvdMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> rcvdMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> rcvdMsgsCntByNodeIdMetricFactory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc1MTMy", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349175132", "createdAt": "2020-01-28T07:42:27Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjoyN1rOFibdjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjoyN1rOFibdjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NTgzOQ==", "bodyText": "Are we still need this factory?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371645839", "createdAt": "2020-01-28T07:42:27Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -82,10 +83,22 @@\n     private final Function<Short, LongAdderMetric> rcvdMsgsCntByTypeMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code sentMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> sentMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> sentMsgsCntByNodeIdMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code rcvdMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> rcvdMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> rcvdMsgsCntByNodeIdMetricFactory;\n+\n+    /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code #sentMsgsMetricsByConsistentId}. */\n+    private final Function<Object, LongAdderMetric> sentMsgsCntByConsistentIdMetricFactory;\n+\n+    /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code #rcvdMsgsMetricsByConsistentId}. */\n+    private final Function<Object, LongAdderMetric> rcvdMsgsCntByConsistentIdMetricFactory;\n+\n+    /** All sent messages count metrics grouped by message node id. */\n+    public volatile Map<UUID, AtomicLong> allSentMsgsMetricsByNodeId = new ConcurrentHashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc1MTg1", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349175185", "createdAt": "2020-01-28T07:42:36Z", "commit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjozN1rOFibdtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0MjozN1rOFibdtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NTg3Nw==", "bodyText": "Are we still need this factory?", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371645877", "createdAt": "2020-01-28T07:42:37Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationMetricsListener.java", "diffHunk": "@@ -82,10 +83,22 @@\n     private final Function<Short, LongAdderMetric> rcvdMsgsCntByTypeMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code sentMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> sentMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> sentMsgsCntByNodeIdMetricFactory;\n \n     /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code rcvdMsgsMetricsByNodeId}. */\n-    private final Function<UUID, LongAdderMetric> rcvdMsgsCntByNodeIdMetricFactory;\n+    private final Function<UUID, AtomicLong> rcvdMsgsCntByNodeIdMetricFactory;\n+\n+    /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code #sentMsgsMetricsByConsistentId}. */\n+    private final Function<Object, LongAdderMetric> sentMsgsCntByConsistentIdMetricFactory;\n+\n+    /** Function to be used in {@link Map#computeIfAbsent(Object, Function)} of {@code #rcvdMsgsMetricsByConsistentId}. */\n+    private final Function<Object, LongAdderMetric> rcvdMsgsCntByConsistentIdMetricFactory;\n+\n+    /** All sent messages count metrics grouped by message node id. */\n+    public volatile Map<UUID, AtomicLong> allSentMsgsMetricsByNodeId = new ConcurrentHashMap<>();\n+\n+    /** Received messages metrics count grouped by message node id. */\n+    public volatile Map<UUID, AtomicLong> allRcvdMsgsMetricsByNodeId = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e24abae47b943e1bd2f8e276e9683f1df7b0ac2"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42bf05e56122fbe5c9a9868c20dcef228bd0a278", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/42bf05e56122fbe5c9a9868c20dcef228bd0a278", "committedDate": "2020-01-28T07:54:37Z", "message": "IGNITE-12576 Constants renamed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTgxOTQ5", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349181949", "createdAt": "2020-01-28T07:59:37Z", "commit": {"oid": "42bf05e56122fbe5c9a9868c20dcef228bd0a278"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo1OTozN1rOFibzqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo1OTozN1rOFibzqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY1MTQ5Ng==", "bodyText": "consistentId should be a part of session meta (ses.meta(CONSISTENT_ID_META). It has no meaning for the connectionKey class. An thus it will require much less changes in this PR.", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371651496", "createdAt": "2020-01-28T07:59:37Z", "author": {"login": "Mmuzaf"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/internal/ConnectionKey.java", "diffHunk": "@@ -25,6 +25,9 @@\n  * Connection Key.\n  */\n public class ConnectionKey {\n+    /** */\n+    private final Object consistentId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42bf05e56122fbe5c9a9868c20dcef228bd0a278"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb90b96202a8b0ea252ecea4962f5946591f9fe0", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/cb90b96202a8b0ea252ecea4962f5946591f9fe0", "committedDate": "2020-01-28T08:35:03Z", "message": "IGNITE-12576 nodeId JMX values calculation reworked."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fe8004112b943a88a14d79dc2c4e79442f5ee82", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/0fe8004112b943a88a14d79dc2c4e79442f5ee82", "committedDate": "2020-01-28T08:38:23Z", "message": "IGNITE-12576 cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76cbccfe4c1cddbb7a1efe01c029ada2f2c2ae40", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/76cbccfe4c1cddbb7a1efe01c029ada2f2c2ae40", "committedDate": "2020-01-28T08:44:35Z", "message": "IGNITE-12576 cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MjI1NDM0", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349225434", "createdAt": "2020-01-28T09:22:32Z", "commit": {"oid": "76cbccfe4c1cddbb7a1efe01c029ada2f2c2ae40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "808f8be196f47f9701e2ea7c11d09f33fe04d57e", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/808f8be196f47f9701e2ea7c11d09f33fe04d57e", "committedDate": "2020-01-28T09:29:04Z", "message": "IGNITE-12576 latest review remarks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81041a60ec2cd9c020c1c94339b5f0c1c4974e81", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/81041a60ec2cd9c020c1c94339b5f0c1c4974e81", "committedDate": "2020-01-28T09:36:57Z", "message": "IGNITE-12576 cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90646d45b5be65f1ea1c30b535a2c58d8842be71", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/90646d45b5be65f1ea1c30b535a2c58d8842be71", "committedDate": "2020-01-28T10:01:40Z", "message": "IGNITE-12576 CONSISTENT_ID_META"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af3d3f1d4962f3e53500174d63258c336c516267", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/af3d3f1d4962f3e53500174d63258c336c516267", "committedDate": "2020-01-28T10:04:07Z", "message": "IGNITE-12576 comment added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MjU1ODg2", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349255886", "createdAt": "2020-01-28T10:09:12Z", "commit": {"oid": "af3d3f1d4962f3e53500174d63258c336c516267"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMDowOToxM1rOFifZEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMDowOToxM1rOFifZEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTcxMDIyNg==", "bodyText": "It seems these changes are not required.", "url": "https://github.com/apache/ignite/pull/7310#discussion_r371710226", "createdAt": "2020-01-28T10:09:13Z", "author": {"login": "nizhikov"}, "path": "modules/core/src/main/java/org/apache/ignite/spi/communication/tcp/TcpCommunicationSpi.java", "diffHunk": "@@ -562,20 +569,22 @@\n              */\n             private void onFirstMessage(final GridNioSession ses, Message msg) {\n                 UUID sndId;\n-\n-                ConnectionKey connKey;\n+                int connIdx;\n+                long connCnt;\n \n                 if (msg instanceof NodeIdMessage) {\n                     sndId = U.bytesToUuid(((NodeIdMessage)msg).nodeIdBytes(), 0);\n-                    connKey = new ConnectionKey(sndId, 0, -1);\n+                    connIdx = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af3d3f1d4962f3e53500174d63258c336c516267"}, "originalPosition": 58}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d608e5ae2c6853e41ef90e86832c2a1650697a4", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/3d608e5ae2c6853e41ef90e86832c2a1650697a4", "committedDate": "2020-01-28T11:00:31Z", "message": "IGNITE-12576 cleanup."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NTI1MDA0", "url": "https://github.com/apache/ignite/pull/7310#pullrequestreview-349525004", "createdAt": "2020-01-28T16:36:26Z", "commit": {"oid": "3d608e5ae2c6853e41ef90e86832c2a1650697a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f6a35f1fe280cceee89f25cd8b01508fc7a30e1", "author": {"user": {"login": "ibessonov", "name": "ibessonov"}}, "url": "https://github.com/apache/ignite/commit/7f6a35f1fe280cceee89f25cd8b01508fc7a30e1", "committedDate": "2020-01-29T15:49:35Z", "message": "IGNITE-12576 meta"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2893, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}