{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NTYwNTM5", "number": 8614, "title": "IGNITE-13897 .NET: Service can't assign correct type to passed array parameters", "bodyText": "The array of user objects can't be deserialized on the java side.\nThe Contribution Checklist\n\n There is a single JIRA ticket related to the pull request.\n The web-link to the pull request is attached to the JIRA ticket.\n The JIRA ticket has the Patch Available state.\n The pull request body describes changes that have been made.\nThe description explains WHAT and WHY was made instead of HOW.\n The pull request title is treated as the final commit message.\nThe following pattern must be used: IGNITE-XXXX Change summary where XXXX - number of JIRA issue.\n A reviewer has been mentioned through the JIRA comments\n(see the Maintainers list)\n The pull request has been checked by the Teamcity Bot and\nthe green visa attached to the JIRA ticket (see TC.Bot: Check PR)\n\nNotes\n\nHow to Contribute\nCoding abbreviation rules\nCoding Guidelines\nApache Ignite Teamcity Bot\n\nIf you need any help, please email dev@ignite.apache.org or ask an\u0443 advice on http://asf.slack.com #ignite channel.", "createdAt": "2020-12-25T09:21:40Z", "url": "https://github.com/apache/ignite/pull/8614", "merged": true, "mergeCommit": {"oid": "c2204cda29e70294cc93756eabc844b64e07a42e"}, "closed": true, "closedAt": "2020-12-29T10:39:49Z", "author": {"login": "nizhikov"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpkyZ1AH2gAyNTQ1NTYwNTM5OjU5Zjk3ZGI3OTVlZWEzYTM1MTgwY2M1NzhmYWFlMmE4YTBjZDAzNjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdq3gtxAFqTU1OTQ1Mjk2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "59f97db795eea3a35180cc578faae2a8a0cd0368", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/59f97db795eea3a35180cc578faae2a8a0cd0368", "committedDate": "2020-12-25T09:19:46Z", "message": "IGNITE-13897: Bug reproducer."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da985e953f081042980c0a7e0f54b8f58a478ba0", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/da985e953f081042980c0a7e0f54b8f58a478ba0", "committedDate": "2020-12-25T15:37:23Z", "message": "IGNITE-13897: WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbdc7743f3b86890388b5074739c7706858dbae9", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/cbdc7743f3b86890388b5074739c7706858dbae9", "committedDate": "2020-12-25T15:55:00Z", "message": "Merge branch 'master' into IGNITE-13897"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9166f42b2c3678665f79e4b7798e3546ad1325c8", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/9166f42b2c3678665f79e4b7798e3546ad1325c8", "committedDate": "2020-12-26T07:51:28Z", "message": "Merge branch 'master' into IGNITE-13897"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b95f64ba9bff0d1ed3a2f1256a4f3e2a10a056c5", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/b95f64ba9bff0d1ed3a2f1256a4f3e2a10a056c5", "committedDate": "2020-12-26T16:48:37Z", "message": "IGNITE-13897: WIP. Dirty fix of the bug."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0aebe2263bf4061e8cf9145a626970552b06678", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/c0aebe2263bf4061e8cf9145a626970552b06678", "committedDate": "2020-12-26T16:50:08Z", "message": "IGNITE-13897: WIP. Dirty fix of the bug."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03b4085f85bb9e0ca47186ed1cc383994e1828d2", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/03b4085f85bb9e0ca47186ed1cc383994e1828d2", "committedDate": "2020-12-26T16:52:27Z", "message": "IGNITE-13897: WIP. Dirty fix of the bug."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/f096e42f7e565db4dac4f0c7b7e84d50ffefefc5", "committedDate": "2020-12-26T16:54:50Z", "message": "IGNITE-13897: WIP. Dirty fix of the bug."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTEzNjUx", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-558913651", "createdAt": "2020-12-27T09:04:11Z", "commit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QwOTowNDoxMVrOILpkJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QwOTowNDoxMVrOILpkJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTA4NjI0NQ==", "bodyText": "Great! It was strange, that here was untyped array. Great catch!", "url": "https://github.com/apache/ignite/pull/8614#discussion_r549086245", "createdAt": "2020-12-27T09:04:11Z", "author": {"login": "ivandasch"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/platform/utils/PlatformUtils.java", "diffHunk": "@@ -989,7 +990,9 @@ private static boolean knownMap(Object o) {\n      * @return Result.\n      */\n     public static Object[] unwrapBinariesInArray(Object[] arr) {\n-        Object[] res = new Object[arr.length];\n+        Class<?> compType = arr.getClass().getComponentType();\n+\n+        Object[] res = (Object[])Array.newInstance(compType, arr.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTEzNzE5", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-558913719", "createdAt": "2020-12-27T09:05:16Z", "commit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTE0NTAy", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-558914502", "createdAt": "2020-12-27T09:19:03Z", "commit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac2deaf1c6789a702de53be155cdc6d0bfdd9fff", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/ac2deaf1c6789a702de53be155cdc6d0bfdd9fff", "committedDate": "2020-12-28T08:57:23Z", "message": "IGNITE-13897: Tests fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf8bc6c00706d3fa37762f65489c491bc3a0fec8", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/cf8bc6c00706d3fa37762f65489c491bc3a0fec8", "committedDate": "2020-12-28T09:01:00Z", "message": "IGNITE-13897: Tests fixes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MTA1OTU1", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-559105955", "createdAt": "2020-12-28T11:27:13Z", "commit": {"oid": "cf8bc6c00706d3fa37762f65489c491bc3a0fec8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMToyNzoxM1rOIL3dJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMTozNDozOFrOIL3lBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMxMzgyOQ==", "bodyText": "Seems to be unnecessary, please revert", "url": "https://github.com/apache/ignite/pull/8614#discussion_r549313829", "createdAt": "2020-12-28T11:27:13Z", "author": {"login": "ptupitsyn"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/platform/services/PlatformServices.java", "diffHunk": "@@ -559,7 +561,7 @@ public static void convertArrayArgs(Object[] args, Method mtd) {\n     @SuppressWarnings({\"unchecked\", \"rawtypes\"})\n     private static class ServiceProxyHolder extends PlatformAbstractTarget {\n         /** */\n-        private final Object proxy;\n+        public final Object proxy;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf8bc6c00706d3fa37762f65489c491bc3a0fec8"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMxNTg0Nw==", "bodyText": "What is the use case when compType is not Object, is it covered with some test? I thought we are unwrapping binary objects here, so arr is either Object[], or maybe BinaryObject[].\nIn my understanding, res[i] = unwrapBinary(arr[i]) line below can return an instance of any class, so res must be an Object[].", "url": "https://github.com/apache/ignite/pull/8614#discussion_r549315847", "createdAt": "2020-12-28T11:34:38Z", "author": {"login": "ptupitsyn"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/platform/utils/PlatformUtils.java", "diffHunk": "@@ -989,7 +990,9 @@ private static boolean knownMap(Object o) {\n      * @return Result.\n      */\n     public static Object[] unwrapBinariesInArray(Object[] arr) {\n-        Object[] res = new Object[arr.length];\n+        Class<?> compType = arr.getClass().getComponentType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf8bc6c00706d3fa37762f65489c491bc3a0fec8"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fd079a577e63781bb65829d5fb82bdaf0589b80", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/2fd079a577e63781bb65829d5fb82bdaf0589b80", "committedDate": "2020-12-28T11:59:36Z", "message": "IGNITE-13897: Code review fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0f72c226cd866af64cf28e049ffaf849e51f179", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/b0f72c226cd866af64cf28e049ffaf849e51f179", "committedDate": "2020-12-28T12:43:53Z", "message": "Merge branch 'master' into IGNITE-13897"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MTQ4MTcy", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-559148172", "createdAt": "2020-12-28T13:38:08Z", "commit": {"oid": "2fd079a577e63781bb65829d5fb82bdaf0589b80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b97b457497cf6e348e78f905be74215b310818d", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/7b97b457497cf6e348e78f905be74215b310818d", "committedDate": "2020-12-29T08:08:55Z", "message": "IGNITE-13897: Code review fixes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDI4NTEw", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-559428510", "createdAt": "2020-12-29T08:34:47Z", "commit": {"oid": "7b97b457497cf6e348e78f905be74215b310818d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwODozNDo0N1rOIMJ8tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwODozNDo0N1rOIMJ8tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxNjgyMQ==", "bodyText": "Now that we have a check for component type above, this can be changed back to Object[] res = new Object[arr.length];", "url": "https://github.com/apache/ignite/pull/8614#discussion_r549616821", "createdAt": "2020-12-29T08:34:47Z", "author": {"login": "ptupitsyn"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/platform/utils/PlatformUtils.java", "diffHunk": "@@ -989,7 +990,9 @@ private static boolean knownMap(Object o) {\n      * @return Result.\n      */\n     public static Object[] unwrapBinariesInArray(Object[] arr) {\n-        Object[] res = new Object[arr.length];\n+        Class<?> compType = arr.getClass().getComponentType();\n+\n+        Object[] res = (Object[])Array.newInstance(compType, arr.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTA4NjI0NQ=="}, "originalCommit": {"oid": "f096e42f7e565db4dac4f0c7b7e84d50ffefefc5"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9012c944bfcc74d69566f4974b45a644c8fea7d2", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/ignite/commit/9012c944bfcc74d69566f4974b45a644c8fea7d2", "committedDate": "2020-12-29T09:21:48Z", "message": "IGNITE-13897: Code review fixes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDUyOTY4", "url": "https://github.com/apache/ignite/pull/8614#pullrequestreview-559452968", "createdAt": "2020-12-29T09:42:34Z", "commit": {"oid": "9012c944bfcc74d69566f4974b45a644c8fea7d2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2308, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}