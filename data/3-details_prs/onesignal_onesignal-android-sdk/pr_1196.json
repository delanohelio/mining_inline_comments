{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NjY2MTY0", "number": 1196, "title": "Enable background player updates", "bodyText": "If user send tags under ServiceExtension implementation, player update should happen\nAdd sendTags on background test\n\n\nThis change is\u2002", "createdAt": "2020-10-23T03:01:05Z", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196", "merged": true, "mergeCommit": {"oid": "012cdb2ab23c7ed4c5c79a3c3b728029fd754d92"}, "closed": true, "closedAt": "2020-10-27T23:58:57Z", "author": {"login": "Jeasmine"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVNmu3gH2gAyNTA4NjY2MTY0OjA0MGExNTUxMDBkZmEyODkxNDNlY2E3OWUzYWRmMWZhZTk2M2I5ODY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWw_ySgFqTUxODIwNzY4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/040a155100dfa289143eca79e3adf1fae963b986", "committedDate": "2020-10-23T03:00:43Z", "message": "Enable background player updates\n\n* If user send tags under ServiceExtension implementation, player update should happen\n* Add sendTags on background test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTY2MzE4", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196#pullrequestreview-517966318", "createdAt": "2020-10-27T17:26:08Z", "commit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzoyNjowOFrOHpIBRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzoyNzo0N1rOHpIHIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg4NTA2Mg==", "bodyText": "The return here was removed was that intentional?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196#discussion_r512885062", "createdAt": "2020-10-27T17:26:08Z", "author": {"login": "emawby"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -815,25 +816,27 @@ private static void handleAmazonPurchase() {\n    private static void doSessionInit() {\n       // Check session time to determine whether to start a new session or not\n       if (isPastOnSessionTime()) {\n-         OneSignal.onesignalLog(LOG_LEVEL.DEBUG, \"Starting new session\");\n-         OneSignalStateSynchronizer.setNewSession();\n          if (inForeground) {\n+            logger.debug(\"Starting new session\");\n+\n+            OneSignalStateSynchronizer.setNewSession();\n             outcomeEventsController.cleanOutcomes();\n             sessionManager.restartSessionIfNeeded(getAppEntryState());\n             getInAppMessageController().resetSessionLaunchTime();\n+            setLastSessionTime(time.getCurrentTimeMillis());\n          }\n-      } else if (inForeground) {\n-         OneSignal.onesignalLog(LOG_LEVEL.DEBUG, \"Continue on same session\");\n+      } else {\n+         logger.debug(\"Continue on same session\");\n+\n          sessionManager.attemptSessionUpgrade(getAppEntryState());\n       }\n       getInAppMessageController().initWithCachedInAppMessages();\n \n       // We still want register the user to OneSignal if the SDK was initialized\n       //   in the background for the first time.\n       if (!inForeground && hasUserId())\n-         return;\n+         logger.debug(\"doSessionInit on background with already registered user\");\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg4NjU2Mg==", "bodyText": "I think it would be useful to print the values here so we know why registerUser isn't possible since there are 4 possibilities", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196#discussion_r512886562", "createdAt": "2020-10-27T17:27:47Z", "author": {"login": "emawby"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -1224,16 +1234,18 @@ private static int getTimeZoneOffset() {\n    }\n \n    private static void registerUser() {\n-      Log(LOG_LEVEL.DEBUG,\n+      logger.debug(\n          \"registerUser:\" +\n          \"registerForPushFired:\" + registerForPushFired +\n          \", locationFired: \" + locationFired +\n          \", remoteParams: \" + getRemoteParams() +\n          \", appId: \" + appId\n       );\n \n-      if (!registerForPushFired || !locationFired || getRemoteParams() == null || appId == null)\n+      if (!registerForPushFired || !locationFired || getRemoteParams() == null || appId == null) {\n+         logger.debug(\"registerUser not possible\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986"}, "originalPosition": 154}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MDUwNTM3", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196#pullrequestreview-518050537", "createdAt": "2020-10-27T19:09:12Z", "commit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MjA3Njgx", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1196#pullrequestreview-518207681", "createdAt": "2020-10-27T22:48:41Z", "commit": {"oid": "040a155100dfa289143eca79e3adf1fae963b986"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3475, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}