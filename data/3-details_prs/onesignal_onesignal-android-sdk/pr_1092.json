{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwMzY0MzAx", "number": 1092, "title": "Add task delay due to requiring consent from remote params", "bodyText": "Add task delay due to requiring consent from remote params\n\nMove task management to TaskController\nDelay task until remote params and init is done\nAfter task delayed, check again for user consent\nFix test, add tests\n\n\n\nThis change is\u2002", "createdAt": "2020-07-16T17:21:08Z", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092", "merged": true, "mergeCommit": {"oid": "657172b06b9703da43075de763fbc039a3c7d5c0"}, "closed": true, "closedAt": "2020-07-30T19:54:07Z", "author": {"login": "Jeasmine"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1imz9ABqjM1NTQzMTc2NjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6FB9GgFqTQ1ODcwNDM2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ecdd2bcfe7f86682a499689d967fc74f84f209b", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/4ecdd2bcfe7f86682a499689d967fc74f84f209b", "committedDate": "2020-07-16T17:19:40Z", "message": "Add task delay due to require consent from remote params"}, "afterCommit": {"oid": "4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28", "committedDate": "2020-07-16T17:22:08Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Mote task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNTAzNDkw", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#pullrequestreview-450503490", "createdAt": "2020-07-17T09:17:55Z", "commit": {"oid": "4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwOToxNzo1NVrOGzLz3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwOToxNzo1NVrOGzLz3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMyNDA2Mw==", "bodyText": "These OneSignal public methods now seem to go through these steps.\n\nCheck if remote params are done\nIf not add to queue\nAfter remote params finishes check if privacy consent is required.\nCheck if OneSignal has been initialized\n\nHowever with step 4 if we got here we already download remote params so OneSignal has been initialized. So this is a redundant check.", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r456324063", "createdAt": "2020-07-17T09:17:55Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -1316,25 +1218,35 @@ public static void setEmail(@NonNull final String email, @Nullable final String\n     *                      Omit this value if you do not have a backend to authenticate the user.\n     * @param callback Fire onSuccess or onFailure depending if the update successes or fails\n     */\n-   public static void setEmail(@NonNull final String email, @Nullable final String emailAuthHash, @Nullable EmailUpdateHandler callback) {\n-\n-      //if applicable, check if the user provided privacy consent\n+   public static void setEmail(@NonNull final String email, @Nullable final String emailAuthHash, @Nullable final EmailUpdateHandler callback) {\n+      if (taskController.shouldQueueTaskForInit(\"setEmail()\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28"}, "originalPosition": 347}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/4e6a4eb3ae9d20da2f9e3bf7e912d402bf1c5c28", "committedDate": "2020-07-16T17:22:08Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Mote task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "26400bd8d1b477ef7c9abe268ce03806eb26677f", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/26400bd8d1b477ef7c9abe268ce03806eb26677f", "committedDate": "2020-07-20T16:04:22Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26400bd8d1b477ef7c9abe268ce03806eb26677f", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/26400bd8d1b477ef7c9abe268ce03806eb26677f", "committedDate": "2020-07-20T16:04:22Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "74a8b50a2728971c247c06430744bdffbab976c1", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/74a8b50a2728971c247c06430744bdffbab976c1", "committedDate": "2020-07-20T17:09:06Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74a8b50a2728971c247c06430744bdffbab976c1", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/74a8b50a2728971c247c06430744bdffbab976c1", "committedDate": "2020-07-20T17:09:06Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "91a76820179541b21d48af92ede4239d87edb6a7", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/91a76820179541b21d48af92ede4239d87edb6a7", "committedDate": "2020-07-20T17:55:40Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91a76820179541b21d48af92ede4239d87edb6a7", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/91a76820179541b21d48af92ede4239d87edb6a7", "committedDate": "2020-07-20T17:55:40Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "314786336b3316afe228edb7dc98562143acfccd", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/314786336b3316afe228edb7dc98562143acfccd", "committedDate": "2020-07-20T18:43:29Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "314786336b3316afe228edb7dc98562143acfccd", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/314786336b3316afe228edb7dc98562143acfccd", "committedDate": "2020-07-20T18:43:29Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/079158157511e4e4611c2c67a9f4ca63e464aee4", "committedDate": "2020-07-20T18:56:59Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODk4OTI0", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#pullrequestreview-455898924", "createdAt": "2020-07-27T15:35:50Z", "commit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNTo1MFrOG3oC5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzo0MTo1NFrOG3s2jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MDk2Ng==", "bodyText": "Is there a way we use a single null check for locationHandlerThread == null\ninstead of having one externally and internally to the synchronized?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r460980966", "createdAt": "2020-07-27T15:35:50Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/LocationController.java", "diffHunk": "@@ -58,7 +58,18 @@\n    private static boolean locationCoarse;\n \n    static final Object syncLock = new Object() {};\n-   static LocationHandlerThread locationHandlerThread;\n+\n+   private static LocationHandlerThread locationHandlerThread;\n+   static LocationHandlerThread getLocationHandlerThread() {\n+      if (locationHandlerThread == null) {\n+         synchronized (syncLock) {\n+            if (locationHandlerThread == null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NDcxNA==", "bodyText": "Does this have to be within the constructor of the TaskController?\nSeems like we could just make this global static HashSet<String> for O(1) access using the .contains method\nprivate HashSet<String> methodsAvailableForDelay = new HashSet<>(Arrays.asList(\n        \"getTags()\",\n        \"SyncHashedEmail()\",\n        \"setExternalUserId()\",\n        \"setSubscription()\",\n        \"promptLocation()\",\n        \"idsAvailable()\",\n        \"sendTag()\",\n        \"sendTags()\",\n        \"handleNotificationOpen()\",\n        \"setEmail()\"));", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r461044714", "createdAt": "2020-07-27T17:16:06Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSTaskController.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.onesignal;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.concurrent.ConcurrentLinkedQueue;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.RejectedExecutionException;\n+import java.util.concurrent.ThreadFactory;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+class OSTaskController {\n+\n+    // the concurrent queue in which we pin pending tasks upon finishing initialization\n+    static final ConcurrentLinkedQueue<Runnable> taskQueueWaitingForInit = new ConcurrentLinkedQueue<>();\n+    private static final AtomicLong lastTaskId = new AtomicLong();\n+    private static ExecutorService pendingTaskExecutor;\n+\n+    private final OSLogger logger;\n+    private final OSRemoteParamController paramController;\n+\n+    private List<String> methodsAvailableForDelay;\n+\n+    OSTaskController(OSRemoteParamController paramController, OSLogger logger) {\n+        this.paramController = paramController;\n+        this.logger = logger;\n+\n+        methodsAvailableForDelay = new ArrayList<>(\n+                Arrays.asList(\"getTags()\", \"SyncHashedEmail()\", \"setExternalUserId()\", \"setSubscription()\",\n+                        \"promptLocation()\", \"idsAvailable()\", \"sendTag()\", \"sendTags()\", \"handleNotificationOpen()\",\n+                        \"setEmail()\"));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NTM0Ng==", "bodyText": "Also lets make things consistent and change this SyncHashedEmail() task method name to syncHashedEmail()", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r461045346", "createdAt": "2020-07-27T17:17:16Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSTaskController.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.onesignal;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.concurrent.ConcurrentLinkedQueue;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.RejectedExecutionException;\n+import java.util.concurrent.ThreadFactory;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+class OSTaskController {\n+\n+    // the concurrent queue in which we pin pending tasks upon finishing initialization\n+    static final ConcurrentLinkedQueue<Runnable> taskQueueWaitingForInit = new ConcurrentLinkedQueue<>();\n+    private static final AtomicLong lastTaskId = new AtomicLong();\n+    private static ExecutorService pendingTaskExecutor;\n+\n+    private final OSLogger logger;\n+    private final OSRemoteParamController paramController;\n+\n+    private List<String> methodsAvailableForDelay;\n+\n+    OSTaskController(OSRemoteParamController paramController, OSLogger logger) {\n+        this.paramController = paramController;\n+        this.logger = logger;\n+\n+        methodsAvailableForDelay = new ArrayList<>(\n+                Arrays.asList(\"getTags()\", \"SyncHashedEmail()\", \"setExternalUserId()\", \"setSubscription()\",\n+                        \"promptLocation()\", \"idsAvailable()\", \"sendTag()\", \"sendTags()\", \"handleNotificationOpen()\",\n+                        \"setEmail()\"));\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NDcxNA=="}, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NTQwOA==", "bodyText": "And if we wanna make it easier to change in the future we should create static final String for each method name\nOR\nWe make a helper that calls and returns the current enclosing method name\nExample:\nString name = new Object(){}.getClass().getEnclosingMethod().getName();\nWhich would return \"sendTag\" if we called this within the sendTag method", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r461045408", "createdAt": "2020-07-27T17:17:24Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSTaskController.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.onesignal;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.concurrent.ConcurrentLinkedQueue;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.RejectedExecutionException;\n+import java.util.concurrent.ThreadFactory;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+class OSTaskController {\n+\n+    // the concurrent queue in which we pin pending tasks upon finishing initialization\n+    static final ConcurrentLinkedQueue<Runnable> taskQueueWaitingForInit = new ConcurrentLinkedQueue<>();\n+    private static final AtomicLong lastTaskId = new AtomicLong();\n+    private static ExecutorService pendingTaskExecutor;\n+\n+    private final OSLogger logger;\n+    private final OSRemoteParamController paramController;\n+\n+    private List<String> methodsAvailableForDelay;\n+\n+    OSTaskController(OSRemoteParamController paramController, OSLogger logger) {\n+        this.paramController = paramController;\n+        this.logger = logger;\n+\n+        methodsAvailableForDelay = new ArrayList<>(\n+                Arrays.asList(\"getTags()\", \"SyncHashedEmail()\", \"setExternalUserId()\", \"setSubscription()\",\n+                        \"promptLocation()\", \"idsAvailable()\", \"sendTag()\", \"sendTags()\", \"handleNotificationOpen()\",\n+                        \"setEmail()\"));\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA0NDcxNA=="}, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1ODcwNQ==", "bodyText": "It might be easier to read this if we place this method call inside of the OneSignal class underneath instead of inside, like this:\nremoteParamController.saveRemoteParams(params, trackerFactory, preferences, logger);\nonRemoteParamSet();", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r461058705", "createdAt": "2020-07-27T17:39:58Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSRemoteParamController.java", "diffHunk": "@@ -69,6 +69,10 @@ void saveRemoteParams(OneSignalRemoteParams.Params remoteParams,\n         OneSignal.onRemoteParamSet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1OTcyNQ==", "bodyText": "CallBack should be Callback, this is one word", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r461059725", "createdAt": "2020-07-27T17:41:54Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -912,15 +807,12 @@ private static boolean pushStatusRuntimeError(int subscriptionStatus) {\n    }\n \n    private static void makeAndroidParamsRequest(String appId, String userId) {\n-      if (getRemoteParams() != null) {\n-         remoteParamsCall = true;\n+      if (getRemoteParams() != null)\n          return;\n-      }\n \n       OneSignalRemoteParams.makeAndroidParamsRequest(appId, userId, new OneSignalRemoteParams.CallBack() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4"}, "originalPosition": 287}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae59aedac413e807c2fc301620df9f87484426cc", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/ae59aedac413e807c2fc301620df9f87484426cc", "committedDate": "2020-07-28T18:00:03Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "079158157511e4e4611c2c67a9f4ca63e464aee4", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/079158157511e4e4611c2c67a9f4ca63e464aee4", "committedDate": "2020-07-20T18:56:59Z", "message": "Add task delay due to requiring consent from remote params\n\n   * Move task management to TaskController\n   * Delay task until remote params and init is done\n   * After task delayed, check again for user consent\n   * Fix test, add tests"}, "afterCommit": {"oid": "5015ee844f8a7e28cf8154b16f5168cebd48d32c", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/5015ee844f8a7e28cf8154b16f5168cebd48d32c", "committedDate": "2020-07-28T18:09:52Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5015ee844f8a7e28cf8154b16f5168cebd48d32c", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/5015ee844f8a7e28cf8154b16f5168cebd48d32c", "committedDate": "2020-07-28T18:09:52Z", "message": "Remove extra check/schedule on pending tasks"}, "afterCommit": {"oid": "692c765c28b278d8cab36b96aafe942dca8d5149", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/692c765c28b278d8cab36b96aafe942dca8d5149", "committedDate": "2020-07-28T18:15:11Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "692c765c28b278d8cab36b96aafe942dca8d5149", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/692c765c28b278d8cab36b96aafe942dca8d5149", "committedDate": "2020-07-28T18:15:11Z", "message": "Remove extra check/schedule on pending tasks"}, "afterCommit": {"oid": "fd3525f3ffc13999470a7d147b2ae3c51ff784d9", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/fd3525f3ffc13999470a7d147b2ae3c51ff784d9", "committedDate": "2020-07-28T18:56:19Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd3525f3ffc13999470a7d147b2ae3c51ff784d9", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/fd3525f3ffc13999470a7d147b2ae3c51ff784d9", "committedDate": "2020-07-28T18:56:19Z", "message": "Remove extra check/schedule on pending tasks"}, "afterCommit": {"oid": "8100830917aec47f75b887c358a1c5614570ae92", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/8100830917aec47f75b887c358a1c5614570ae92", "committedDate": "2020-07-28T19:20:11Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e2964d727266044c1c5dc04f63839ba65cabe31", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/6e2964d727266044c1c5dc04f63839ba65cabe31", "committedDate": "2020-07-28T20:47:39Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8100830917aec47f75b887c358a1c5614570ae92", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/8100830917aec47f75b887c358a1c5614570ae92", "committedDate": "2020-07-28T19:20:11Z", "message": "Remove extra check/schedule on pending tasks"}, "afterCommit": {"oid": "6e2964d727266044c1c5dc04f63839ba65cabe31", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/6e2964d727266044c1c5dc04f63839ba65cabe31", "committedDate": "2020-07-28T20:47:39Z", "message": "Remove extra check/schedule on pending tasks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NjAzNzMy", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#pullrequestreview-457603732", "createdAt": "2020-07-29T14:52:56Z", "commit": {"oid": "6e2964d727266044c1c5dc04f63839ba65cabe31"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDo1Mjo1N1rOG48Vig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDo1Mjo1N1rOG48Vig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjM2MTk5NA==", "bodyText": "Just curious why we have an _ at the end of the OS_PENDING_EXECUTOR_", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#discussion_r462361994", "createdAt": "2020-07-29T14:52:57Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSTaskController.java", "diffHunk": "@@ -0,0 +1,169 @@\n+package com.onesignal;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.concurrent.ConcurrentLinkedQueue;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.RejectedExecutionException;\n+import java.util.concurrent.ThreadFactory;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+class OSTaskController {\n+\n+    static final String OS_PENDING_EXECUTOR = \"OS_PENDING_EXECUTOR_\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e2964d727266044c1c5dc04f63839ba65cabe31"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NzA0MzYx", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1092#pullrequestreview-458704361", "createdAt": "2020-07-30T19:45:21Z", "commit": {"oid": "6e2964d727266044c1c5dc04f63839ba65cabe31"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3637, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}