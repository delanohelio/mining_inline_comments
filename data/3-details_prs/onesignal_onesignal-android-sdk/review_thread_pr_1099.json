{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2Mzg1NzYx", "number": 1099, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxOToxMzo1OFrOER79Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0NlrOEScz7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MjQzNjE4OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignalRestClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxOToxMzo1OVrOG262uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxOToxMzo1OVrOG262uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI0MDU3MQ==", "bodyText": "Let's put this before the privacy consent check. This means we will fail faster so we can detect issues sooner if this become a problem in the future.", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460240571", "createdAt": "2020-07-24T19:13:59Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignalRestClient.java", "diffHunk": "@@ -103,7 +104,10 @@ private static void makeRequest(final String url, final String method, final JSO\n       // If not a GET request, check if the user provided privacy consent if the application is set to require user privacy consent\n       if (method != null && OneSignal.shouldLogUserPrivacyConsentErrorMessageForMethodName(null))\n          return;\n-   \n+\n+      if (OSUtils.isThreadRunningOnMainThread())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49f03821eadb618b8d674b3d0ff1be5b45aef992"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MjQzODY5OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/unittest/src/test/java/com/onesignal/ShadowOSUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxOToxNDo1OFrOG264Xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxOTozODo1OVrOG27jIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI0MDk5MA==", "bodyText": "We shouldn't be overriding this for the tests. We will want to know in the tests if we have an issue with a network call being made on the main thread.", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460240990", "createdAt": "2020-07-24T19:14:58Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/unittest/src/test/java/com/onesignal/ShadowOSUtils.java", "diffHunk": "@@ -88,6 +89,11 @@ public static void resetStatics() {\n \n    }\n \n+   @Implementation\n+   public static boolean isThreadRunningOnMainThread() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49f03821eadb618b8d674b3d0ff1be5b45aef992"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI1MTkzOA==", "bodyText": "yeah U r right", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460251938", "createdAt": "2020-07-24T19:38:59Z", "author": {"login": "Jeasmine"}, "path": "OneSignalSDK/unittest/src/test/java/com/onesignal/ShadowOSUtils.java", "diffHunk": "@@ -88,6 +89,11 @@ public static void resetStatics() {\n \n    }\n \n+   @Implementation\n+   public static boolean isThreadRunningOnMainThread() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI0MDk5MA=="}, "originalCommit": {"oid": "49f03821eadb618b8d674b3d0ff1be5b45aef992"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MjY1ODIxOnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMDozNTowM1rOG28-mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMDozNTowM1rOG28-mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3NTM1Mw==", "bodyText": "This could be changed to just OneSignalRestClient.get(\"URL\", null, null); which is asynchronous. This would simplify this.\nOr does this create any issues with the tests getting stuck?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460275353", "createdAt": "2020-07-24T20:35:03Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "diffHunk": "@@ -92,23 +99,38 @@ public void testRESTClientFallbackTimeout() throws Exception {\n \n    @Test\n    public void SDKHeaderIsIncludedInGetCalls() throws Exception {\n-      OneSignalRestClient.getSync(\"URL\", null, null);\n+      new Thread(new Runnable() {\n+         @Override\n+         public void run() {\n+            OneSignalRestClient.getSync(\"URL\", null, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dea98ddcec5a9da7d58f5783ff88a8923a5faad"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MjY2MTc0OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMDozNjozMlrOG29A0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMDozNjozMlrOG29A0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3NTkyMg==", "bodyText": "how about more simply isRunningOnMainThread?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460275922", "createdAt": "2020-07-24T20:36:32Z", "author": {"login": "rgomezp"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSUtils.java", "diffHunk": "@@ -475,6 +475,10 @@ static boolean areNotificationsEnabled(Context  context) {\n       return true;\n    }\n \n+   static boolean isThreadRunningOnMainThread() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dea98ddcec5a9da7d58f5783ff88a8923a5faad"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzY4NTcwOnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNToyMzoxMlrOG3nfhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNToyMzoxMlrOG3nfhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3MTkwOA==", "bodyText": "OneSignalRestClient.post(\"URL\", null,null);\nneeds a space between null,null\nOneSignalRestClient.post(\"URL\", null, null);", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460971908", "createdAt": "2020-07-27T15:23:12Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "diffHunk": "@@ -92,23 +92,23 @@ public void testRESTClientFallbackTimeout() throws Exception {\n \n    @Test\n    public void SDKHeaderIsIncludedInGetCalls() throws Exception {\n-      OneSignalRestClient.getSync(\"URL\", null, null);\n+      OneSignalRestClient.get(\"URL\", null, null);\n       threadAndTaskWait();\n \n       assertEquals(SDK_VERSION_HTTP_HEADER, getLastHTTPHeaderProp(\"SDK-Version\"));\n    }\n \n    @Test\n    public void SDKHeaderIsIncludedInPostCalls() throws Exception {\n-      OneSignalRestClient.postSync(\"URL\", null,null);\n+      OneSignalRestClient.post(\"URL\", null,null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a5788e026a9cf328e8331807c609efec57d5a71"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzgxODcwOnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0NlrOG3oxvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTo1Mzo0NlrOG3oxvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5Mjk1Nw==", "bodyText": "Whoops found another missing a space", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1099#discussion_r460992957", "createdAt": "2020-07-27T15:53:46Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/RESTClientRunner.java", "diffHunk": "@@ -82,7 +82,7 @@ public void testRESTClientFallbackTimeout() throws Exception {\n          mockThreadHang = true;\n       }};\n \n-      OneSignalRestClient.getSync(\"URL\", null,\"\");\n+      OneSignalRestClient.get(\"URL\", null,\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b32da4f1cd67f03afe9ccad130a524c5bb4401de"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2099, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}