{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTUxOTQ5", "number": 1009, "title": "Add Settings option to denied location prompt", "bodyText": "Whenever the user clicks on never ask again option and denies the permission,\nwe will show the reason why we need it and the option to open settings and change the location permission\n\n\n\nThis change is\u2002", "createdAt": "2020-05-07T22:29:35Z", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009", "merged": true, "mergeCommit": {"oid": "7a9e778f7efc2f917b110e46705918658139dda9"}, "closed": true, "closedAt": "2020-05-12T14:30:58Z", "author": {"login": "Jeasmine"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfFP78ABqjMzMTQ5MjA0MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgZ9vDgFqTQwOTYzODQ0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f435d7551d83ab3d4f40bf6b82244f577bc83b37", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/f435d7551d83ab3d4f40bf6b82244f577bc83b37", "committedDate": "2020-05-07T22:43:03Z", "message": "Don't show setting dialog after firt never ask again option click"}, "afterCommit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2", "committedDate": "2020-05-07T22:44:10Z", "message": "Don't show setting dialog after first  never ask again option click"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NDIwMDUw", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#pullrequestreview-408420050", "createdAt": "2020-05-08T18:04:10Z", "commit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxODowNDoxMFrOGSucIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxODowOTozMlrOGSumLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4ODQxOA==", "bodyText": "We just need the correct text for this and should be good to go!\nMaybe rename to location_not_available_open_settings_message?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#discussion_r422288418", "createdAt": "2020-05-08T18:04:10Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/res/values/strings.xml", "diffHunk": "@@ -4,4 +4,6 @@\n     <string name=\"location_not_available_title\">Location Not Available</string>\n     <string name=\"location_not_available_message\">Looks like this app doesn\\'t have location permissions granted</string>\n \n+    <string name=\"location_not_available_open_settings\">We need location for user .....complete text</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4ODk5Nw==", "bodyText": "settings is a little unclear, maybe lets rename to\nlocation_not_available_open_settings_title?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#discussion_r422288997", "createdAt": "2020-05-08T18:05:23Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/res/values/strings.xml", "diffHunk": "@@ -4,4 +4,6 @@\n     <string name=\"location_not_available_title\">Location Not Available</string>\n     <string name=\"location_not_available_message\">Looks like this app doesn\\'t have location permissions granted</string>\n \n+    <string name=\"location_not_available_open_settings\">We need location for user .....complete text</string>\n+    <string name=\"settings\">Settings</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI5MDk4OA==", "bodyText": "Maybe we should move this if check into a separate method to clean up this long if-statement, something like below?\nif (shouldShowLocationPermissionSettings)\n    showLocationPermissionSettings();\n\nOR\nprivate void attemptToShowLocationPermissionSettings() {\n    if (fallbackToSettings \n            && neverAskAgainClicked \n            && !ActivityCompat.shouldShowRequestPermissionRationale(PermissionsActivity.this, LocationGMS.requestPermission))\n        showLocationPermissionSettings();\n}", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#discussion_r422290988", "createdAt": "2020-05-08T18:09:32Z", "author": {"login": "mikechoch"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/PermissionsActivity.java", "diffHunk": "@@ -104,10 +109,16 @@ public void onRequestPermissionsResult(final int requestCode, @NonNull String pe\n             public void run() {\n                boolean granted = grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED;\n                LocationGMS.sendAndClearPromptHandlers(true, granted);\n-               if (granted)\n+               if (granted) {\n                   LocationGMS.startGetLocation();\n-               else\n+               } else {\n+                  if (fallbackToSettings &&\n+                          neverAskAgainClicked &&\n+                          !ActivityCompat.shouldShowRequestPermissionRationale(PermissionsActivity.this, LocationGMS.requestPermission)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2"}, "originalPosition": 45}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/bcac731294c1a8a4dc27d81cbfa3bb78a0a4ebb2", "committedDate": "2020-05-07T22:44:10Z", "message": "Don't show setting dialog after first  never ask again option click"}, "afterCommit": {"oid": "a8ff1715a8da07ec36f278cae625429d3ef3763a", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a8ff1715a8da07ec36f278cae625429d3ef3763a", "committedDate": "2020-05-08T22:56:03Z", "message": "Change message text and address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NTYzNTAw", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#pullrequestreview-409563500", "createdAt": "2020-05-11T22:03:26Z", "commit": {"oid": "a8ff1715a8da07ec36f278cae625429d3ef3763a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d28187e7e9ee5ddc255e44c87ef73c271cf5af76", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/d28187e7e9ee5ddc255e44c87ef73c271cf5af76", "committedDate": "2020-05-11T22:19:45Z", "message": "Add Settings option to denied location prompt\n\n   * Whenever the user clicks on never ask again option and denies the permission,\n     we will show the reason why we need it and the option to open settings and change the location permission\n   * Don't show setting dialog after first never ask again option click"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a8ff1715a8da07ec36f278cae625429d3ef3763a", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a8ff1715a8da07ec36f278cae625429d3ef3763a", "committedDate": "2020-05-08T22:56:03Z", "message": "Change message text and address comments"}, "afterCommit": {"oid": "d28187e7e9ee5ddc255e44c87ef73c271cf5af76", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/d28187e7e9ee5ddc255e44c87ef73c271cf5af76", "committedDate": "2020-05-11T22:19:45Z", "message": "Add Settings option to denied location prompt\n\n   * Whenever the user clicks on never ask again option and denies the permission,\n     we will show the reason why we need it and the option to open settings and change the location permission\n   * Don't show setting dialog after first never ask again option click"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NjM4NDQy", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1009#pullrequestreview-409638442", "createdAt": "2020-05-12T01:26:43Z", "commit": {"oid": "d28187e7e9ee5ddc255e44c87ef73c271cf5af76"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3558, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}