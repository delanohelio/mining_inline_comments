{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTM0OTgy", "number": 1174, "title": "Fix foreground check for wrappers", "bodyText": "If user init with activity context foreground check should work even if on resume callback is not fire\n\n\nThis change is\u2002", "createdAt": "2020-10-02T21:04:58Z", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174", "merged": true, "mergeCommit": {"oid": "d6f222d96f6dcfa0dfde89e85b368e59f974fd52"}, "closed": true, "closedAt": "2020-10-07T16:27:50Z", "author": {"login": "Jeasmine"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOvNP3gFqTUwMTQ5OTg2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQACGXgFqTUwMzQwMDg4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNDk5ODYy", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#pullrequestreview-501499862", "createdAt": "2020-10-03T00:00:41Z", "commit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDowMDo0MlrOHb-PIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDoxMTo1MlrOHb-U8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5MzI4MA==", "bodyText": "It seems that Worker would always have a Context so I won't expect a null check is need here.", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499093280", "createdAt": "2020-10-03T00:00:42Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSNotificationRestoreWorkManager.java", "diffHunk": "@@ -61,7 +61,8 @@ public NotificationRestoreWorker(@NonNull Context context, @NonNull WorkerParame\n         public Result doWork() {\n             Context context = getApplicationContext();\n \n-            OneSignal.initWithContext(context);\n+            if (OneSignal.appContext == null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5NDA0MA==", "bodyText": "nit, extra space after instanceof", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499094040", "createdAt": "2020-10-03T00:06:45Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -594,6 +599,8 @@ public static void initWithContext(@NonNull Context context) {\n \n       boolean wasAppContextNull = (appContext == null);\n       appContext = context.getApplicationContext();\n+      if (context instanceof  Activity)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5NDc2OA==", "bodyText": "\ud83d\udc4d This covers the scenario we are looking to fix!", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499094768", "createdAt": "2020-10-03T00:11:52Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/MainOneSignalClassRunner.java", "diffHunk": "@@ -792,10 +792,23 @@ public void testInitWithContext_ActivityResumedBeforeInit() throws Exception {\n       OneSignal.setLogLevel(OneSignal.LOG_LEVEL.VERBOSE, OneSignal.LOG_LEVEL.NONE);\n       ShadowOSUtils.subscribableStatus = 1;\n \n-      OneSignal.initWithContext(blankActivity);\n       blankActivityController.resume();\n+      OneSignal.initWithContext(blankActivity);\n+      OneSignal.setAppId(ONESIGNAL_APP_ID);\n+      threadAndTaskWait();\n \n+      assertTrue(OneSignal_isInForeground());\n+   }\n+\n+   @Test\n+   public void testInitWithContextAppIdSet_ActivityResumedBeforeInit() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNTAxNjA3", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#pullrequestreview-501501607", "createdAt": "2020-10-03T00:12:32Z", "commit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c", "committedDate": "2020-10-02T20:59:42Z", "message": "Fix foreground check for wrappers\n\n* If user init with activity context foreground check should work even if on resume callback is not fire"}, "afterCommit": {"oid": "25bab5f9311308cc71a92db9819bd37fbff7ed53", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/25bab5f9311308cc71a92db9819bd37fbff7ed53", "committedDate": "2020-10-05T16:18:21Z", "message": "Fix failing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae75ff5586ec9a5514e013c6c38498d5a210ac2f", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/ae75ff5586ec9a5514e013c6c38498d5a210ac2f", "committedDate": "2020-10-05T19:34:27Z", "message": "Fix foreground check for wrappers\n\n* If user init with activity context foreground check should work even if on resume callback is not fire"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25bab5f9311308cc71a92db9819bd37fbff7ed53", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/25bab5f9311308cc71a92db9819bd37fbff7ed53", "committedDate": "2020-10-05T16:18:21Z", "message": "Fix failing tests"}, "afterCommit": {"oid": "26a2a16d5de6e07370209aaf2b27c2335d6e00a0", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/26a2a16d5de6e07370209aaf2b27c2335d6e00a0", "committedDate": "2020-10-05T19:34:28Z", "message": "Fix failing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a225ff5ae036991fb3618cc0b52fc46a8fffbb18", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a225ff5ae036991fb3618cc0b52fc46a8fffbb18", "committedDate": "2020-10-05T19:36:25Z", "message": "Fix failing tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26a2a16d5de6e07370209aaf2b27c2335d6e00a0", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/26a2a16d5de6e07370209aaf2b27c2335d6e00a0", "committedDate": "2020-10-05T19:34:28Z", "message": "Fix failing tests"}, "afterCommit": {"oid": "a225ff5ae036991fb3618cc0b52fc46a8fffbb18", "author": {"user": {"login": "Jeasmine", "name": "JNahui"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a225ff5ae036991fb3618cc0b52fc46a8fffbb18", "committedDate": "2020-10-05T19:36:25Z", "message": "Fix failing tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDAwODg0", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#pullrequestreview-503400884", "createdAt": "2020-10-06T22:22:19Z", "commit": {"oid": "a225ff5ae036991fb3618cc0b52fc46a8fffbb18"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3454, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}