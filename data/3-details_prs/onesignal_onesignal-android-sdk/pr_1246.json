{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzODE4NDkw", "number": 1246, "title": "Fix Displaying IAMs past end time", "bodyText": "This change involves reading in end_time from JSON when creating an IAM\nso that we can decide to not show the IAM (Cached case) if the IAM\nshould be finished. The date comes in iso8601 format.\n\nThis change is\u2002", "createdAt": "2020-12-22T01:53:34Z", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1246", "merged": true, "mergeCommit": {"oid": "be9f2fa2681afddda0c729327de7b96572c0beeb"}, "closed": true, "closedAt": "2020-12-23T22:04:12Z", "author": {"login": "emawby"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoglAFgH2gAyNTQzODE4NDkwOjUyNGQzMGQzNTE4MzJiM2I4ZWI1Nzg5ZmIyYTg2NzM1NmE1YzVlM2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdo_4DZgFqTU1Nzg5NTc4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "524d30d351832b3b8eb5789fb2a867356a5c5e3b", "author": {"user": {"login": "emawby", "name": "Elliot Mawby"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/524d30d351832b3b8eb5789fb2a867356a5c5e3b", "committedDate": "2020-12-22T01:51:35Z", "message": "Fix showing IAMs past their end time\n\nThis change involves reading in end_time from JSON when creating an IAM\nso that we can decide to not show the IAM (Cached case) if the IAM\nshould be finished. The date comes in iso8601 format."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5cb276a557a53779e64394dadf900b6f3136ce0", "author": {"user": {"login": "emawby", "name": "Elliot Mawby"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/f5cb276a557a53779e64394dadf900b6f3136ce0", "committedDate": "2020-12-22T01:52:02Z", "message": "unit tests for IAM end_time logic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MzU2NDE2", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1246#pullrequestreview-557356416", "createdAt": "2020-12-22T20:45:01Z", "commit": {"oid": "f5cb276a557a53779e64394dadf900b6f3136ce0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo0NTowMVrOIKIsKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQyMDo0NTowMVrOIKIsKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ5OTA0OQ==", "bodyText": "can we put this on a constant?", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1246#discussion_r547499049", "createdAt": "2020-12-22T20:45:01Z", "author": {"login": "Jeasmine"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSInAppMessage.java", "diffHunk": "@@ -76,11 +82,31 @@\n         this.variants = parseVariants(json.getJSONObject(IAM_VARIANTS));\n         this.triggers = parseTriggerJson(json.getJSONArray(IAM_TRIGGERS));\n         this.clickedClickIds = new HashSet<>();\n+        this.endTime = parseEndTimeJson(json);\n \n         if (json.has(IAM_REDISPLAY_STATS))\n             this.redisplayStats = new OSInAppMessageRedisplayStats(json.getJSONObject(IAM_REDISPLAY_STATS));\n     }\n \n+    private Date parseEndTimeJson(JSONObject json) {\n+        String endTimeString;\n+        try {\n+            endTimeString = json.getString(END_TIME);\n+        } catch (JSONException e) {\n+            return null;\n+        }\n+\n+        SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\", Locale.US);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5cb276a557a53779e64394dadf900b6f3136ce0"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a37f3128d67b6456d31acd6fd3bf135910783665", "author": {"user": {"login": "emawby", "name": "Elliot Mawby"}}, "url": "https://github.com/OneSignal/OneSignal-Android-SDK/commit/a37f3128d67b6456d31acd6fd3bf135910783665", "committedDate": "2020-12-22T23:18:44Z", "message": "move the iso8601 SimpleDateFormat to its own class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3ODk1Nzgz", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1246#pullrequestreview-557895783", "createdAt": "2020-12-23T14:19:27Z", "commit": {"oid": "a37f3128d67b6456d31acd6fd3bf135910783665"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3389, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}