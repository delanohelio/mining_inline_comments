{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTM0OTgy", "number": 1174, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDowMDo0MlrOEp-c8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDoxMTo1MlrOEp-g_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDUwMjg4OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSNotificationRestoreWorkManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDowMDo0MlrOHb-PIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNDoxOTo0MlrOHcfPog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5MzI4MA==", "bodyText": "It seems that Worker would always have a Context so I won't expect a null check is need here.", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499093280", "createdAt": "2020-10-03T00:00:42Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSNotificationRestoreWorkManager.java", "diffHunk": "@@ -61,7 +61,8 @@ public NotificationRestoreWorker(@NonNull Context context, @NonNull WorkerParame\n         public Result doWork() {\n             Context context = getApplicationContext();\n \n-            OneSignal.initWithContext(context);\n+            if (OneSignal.appContext == null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNDA4Mg==", "bodyText": "This is to avoid a new OneSignal.initWithContext(context); while the first initWithContext was called but not finished yet", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499634082", "createdAt": "2020-10-05T14:19:42Z", "author": {"login": "Jeasmine"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OSNotificationRestoreWorkManager.java", "diffHunk": "@@ -61,7 +61,8 @@ public NotificationRestoreWorker(@NonNull Context context, @NonNull WorkerParame\n         public Result doWork() {\n             Context context = getApplicationContext();\n \n-            OneSignal.initWithContext(context);\n+            if (OneSignal.appContext == null)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5MzI4MA=="}, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDUwODE1OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDowNjo0NVrOHb-SGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNDoxOTo1MlrOHcfQHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5NDA0MA==", "bodyText": "nit, extra space after instanceof", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499094040", "createdAt": "2020-10-03T00:06:45Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -594,6 +599,8 @@ public static void initWithContext(@NonNull Context context) {\n \n       boolean wasAppContextNull = (appContext == null);\n       appContext = context.getApplicationContext();\n+      if (context instanceof  Activity)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNDIwNg==", "bodyText": "good catch!", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499634206", "createdAt": "2020-10-05T14:19:52Z", "author": {"login": "Jeasmine"}, "path": "OneSignalSDK/onesignal/src/main/java/com/onesignal/OneSignal.java", "diffHunk": "@@ -594,6 +599,8 @@ public static void initWithContext(@NonNull Context context) {\n \n       boolean wasAppContextNull = (appContext == null);\n       appContext = context.getApplicationContext();\n+      if (context instanceof  Activity)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5NDA0MA=="}, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDUxMzI0OnYy", "diffSide": "RIGHT", "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/MainOneSignalClassRunner.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDoxMTo1MlrOHb-U8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wM1QwMDoxMTo1MlrOHb-U8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA5NDc2OA==", "bodyText": "\ud83d\udc4d This covers the scenario we are looking to fix!", "url": "https://github.com/OneSignal/OneSignal-Android-SDK/pull/1174#discussion_r499094768", "createdAt": "2020-10-03T00:11:52Z", "author": {"login": "jkasten2"}, "path": "OneSignalSDK/unittest/src/test/java/com/test/onesignal/MainOneSignalClassRunner.java", "diffHunk": "@@ -792,10 +792,23 @@ public void testInitWithContext_ActivityResumedBeforeInit() throws Exception {\n       OneSignal.setLogLevel(OneSignal.LOG_LEVEL.VERBOSE, OneSignal.LOG_LEVEL.NONE);\n       ShadowOSUtils.subscribableStatus = 1;\n \n-      OneSignal.initWithContext(blankActivity);\n       blankActivityController.resume();\n+      OneSignal.initWithContext(blankActivity);\n+      OneSignal.setAppId(ONESIGNAL_APP_ID);\n+      threadAndTaskWait();\n \n+      assertTrue(OneSignal_isInForeground());\n+   }\n+\n+   @Test\n+   public void testInitWithContextAppIdSet_ActivityResumedBeforeInit() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5976e7eb76ecbb18f7052e2b3ba8ec1416407a6c"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2148, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}