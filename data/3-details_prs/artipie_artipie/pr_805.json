{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MjY0ODEx", "number": 805, "title": "#738 - Fix path handling for NpmProxySlice", "bodyText": "Closes #738\nThe problem was that the TrimPathSlice cut off repository name from the request therefore patterns that were created before in NpmProxySlice became invalid. Refusing to use trimIfNotStandalone in SliceFromConfig for npm-proxy helped to solve this problem.", "createdAt": "2020-12-14T08:38:44Z", "url": "https://github.com/artipie/artipie/pull/805", "merged": true, "mergeCommit": {"oid": "6d7ed358d48b4f6c5818f3912d38f96d3e12e499"}, "closed": true, "closedAt": "2020-12-14T11:22:33Z", "author": {"login": "genryxy"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmBgE_AH2gAyNTM5MjY0ODExOmI2NDA5N2JhYjFhNjE3Yzg2ODhmNTQ4Nzc0MGM3YWE1NjcwYzg0Mjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmCTxlAH2gAyNTM5MjY0ODExOmJmM2M3NDIxZmE5NmJjNjQ5Y2M3YjJkNjE1MGM3NjczNjg5YTY3NDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b64097bab1a617c8688f5487740c7aa5670c8427", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/b64097bab1a617c8688f5487740c7aa5670c8427", "committedDate": "2020-12-14T08:31:18Z", "message": "#738 - Fix path for NpmProxySlice"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5fb872a0903a183fcea4ff6fdc06b718ce6de5c", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/e5fb872a0903a183fcea4ff6fdc06b718ce6de5c", "committedDate": "2020-12-14T08:39:35Z", "message": "#738 - Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "924f013f390140ebe403701799f3a0d48a51860a", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/924f013f390140ebe403701799f3a0d48a51860a", "committedDate": "2020-12-14T08:43:41Z", "message": "#738 - Fix qulice"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMTY0MTQx", "url": "https://github.com/artipie/artipie/pull/805#pullrequestreview-551164141", "createdAt": "2020-12-14T09:04:13Z", "commit": {"oid": "924f013f390140ebe403701799f3a0d48a51860a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwOTowNDoxM1rOIFGT7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwOTowNDoxM1rOIFGT7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjIxNzE5Nw==", "bodyText": "@genryxy it is not something you added, but there is a big problem in this code. Vertx.vertx() call creates a Vert.x instance, a very heavy object. It should be created only once for whole application on start an reused everywhere. Could you please add a puzzle for solving this issue?", "url": "https://github.com/artipie/artipie/pull/805#discussion_r542217197", "createdAt": "2020-12-14T09:04:13Z", "author": {"login": "olegmoz"}, "path": "src/main/java/com/artipie/SliceFromConfig.java", "diffHunk": "@@ -250,15 +250,12 @@ static Slice build(\n                 );\n                 break;\n             case \"npm-proxy\":\n-                slice = trimIfNotStandalone(\n-                    settings, standalone,\n-                    new NpmProxySlice(\n-                        cfg.path(),\n-                        new NpmProxy(\n-                            new NpmProxyConfig(cfg.settings().orElseThrow()),\n-                            Vertx.vertx(),\n-                            cfg.storage()\n-                        )\n+                slice = new NpmProxySlice(\n+                    cfg.path(),\n+                    new NpmProxy(\n+                        new NpmProxyConfig(cfg.settings().orElseThrow()),\n+                        Vertx.vertx(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "924f013f390140ebe403701799f3a0d48a51860a"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5eed8888e57fb6b353835f76cc87e0e041ff540", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/d5eed8888e57fb6b353835f76cc87e0e041ff540", "committedDate": "2020-12-14T09:22:48Z", "message": "#738 - Add todo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMTgzMjYx", "url": "https://github.com/artipie/artipie/pull/805#pullrequestreview-551183261", "createdAt": "2020-12-14T09:27:33Z", "commit": {"oid": "d5eed8888e57fb6b353835f76cc87e0e041ff540"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf3c7421fa96bc649cc7b2d6150c7673689a6743", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/artipie/commit/bf3c7421fa96bc649cc7b2d6150c7673689a6743", "committedDate": "2020-12-14T09:27:46Z", "message": "Merge branch 'master' into 738-fixPathNpmProxySlice"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3357, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}