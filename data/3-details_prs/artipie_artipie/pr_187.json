{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2NTUzMDAz", "number": 187, "title": "Support hierarchical paths for repos", "bodyText": "#178 - support two different repository layout formats:\n\nflat - no repository hierarchy\norg - two level hierarchy: first level is organization name, second part is repository name\n\nSee RepoLayout javadoc for more details.", "createdAt": "2020-06-02T12:30:07Z", "url": "https://github.com/artipie/artipie/pull/187", "merged": true, "mergeCommit": {"oid": "06a5670f84dde0e7de5e479869e70df106d47310"}, "closed": true, "closedAt": "2020-06-03T09:14:53Z", "author": {"login": "g4s8"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnT_FnAH2gAyNDI2NTUzMDAzOmE0YmE3NmRjNWM1NGIzNzRjNWVjMTRhNTZkYjdjOGE4OWE1OTRlYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnkzUhAH2gAyNDI2NTUzMDAzOjZlYzYwOWZjOGY3ZjY5N2ViYTQwZDk0MTM0YjAwYWJkZGU4NDM5NTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4", "author": {"user": {"login": "g4s8", "name": "Kirill"}}, "url": "https://github.com/artipie/artipie/commit/a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4", "committedDate": "2020-06-02T12:26:14Z", "message": "#178 - hierarchical paths for repos"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzAyMzk0", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422702394", "createdAt": "2020-06-02T13:56:34Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NjozNFrOGdy2lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NjozNFrOGdy2lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg5NTA2MQ==", "bodyText": "The Javadoc has been copied from FlatLayout", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433895061", "createdAt": "2020-06-02T13:56:34Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/repo/OrgLayout.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.RepoConfig;\n+import com.artipie.Settings;\n+import com.artipie.SliceFromConfig;\n+import com.artipie.asto.Key;\n+import com.artipie.http.Slice;\n+import com.artipie.http.async.AsyncSlice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.rs.RsWithBody;\n+import com.artipie.http.rs.RsWithStatus;\n+import com.artipie.http.slice.SliceSimple;\n+import com.jcabi.log.Logger;\n+import io.vertx.reactivex.core.Vertx;\n+import java.nio.charset.StandardCharsets;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.regex.Pattern;\n+import org.cactoos.scalar.Unchecked;\n+\n+/**\n+ * Flat repositories layout.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzAzNzgz", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422703783", "createdAt": "2020-06-02T13:57:21Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NzoyMVrOGdy4vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMzo1NzoyMVrOGdy4vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg5NTYxMg==", "bodyText": "How those changes are related to the Pull Request?", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433895612", "createdAt": "2020-06-02T13:57:21Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/Settings.java", "diffHunk": "@@ -80,13 +92,18 @@ public Fake(final Storage storage) {\n         }\n \n         @Override\n-        public Storage storage() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzE0ODU3", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422714857", "createdAt": "2020-06-02T14:06:34Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDowNjozNFrOGdzaUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDowNjozNFrOGdzaUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkwNDIxMQ==", "bodyText": "Org layout and User based are different terms. I'd suggest sticking with only one, so the Javadoc would be consistent with the actual code", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433904211", "createdAt": "2020-06-02T14:06:34Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/repo/RepoLayout.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.http.Slice;\n+\n+/**\n+ * Repositories layout.\n+ * <p>\n+ * This object resolves repository HTTP endpoints for specified URL.\n+ * Artipie supports two primary layout configurations:\n+ * <ul>\n+ *     <li>Flat layout - Artipie doesn't use any structural layout, all repositories\n+ *     are located at the root of base path, e.g. URI {@code https://central.artipie.com/maven}\n+ *     accesses {@code maven} repository.</li>\n+ *     <li>User based - Artipie installation has multiple namespaces/organizations/users,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzE2NTk1", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422716595", "createdAt": "2020-06-02T14:08:18Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDowODoxOFrOGdzgvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDowODoxOFrOGdzgvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkwNTg1Mw==", "bodyText": "Is this change somehow related to the Pull Request?", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433905853", "createdAt": "2020-06-02T14:08:18Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/Settings.java", "diffHunk": "@@ -35,6 +38,7 @@\n  * @since 0.1\n  */\n public interface Settings {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzIwNDg2", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422720486", "createdAt": "2020-06-02T14:12:10Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoxMjoxMFrOGdzsLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoxMjoxMFrOGdzsLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkwODc4Mw==", "bodyText": "Except for one field REPO_PREF, how OrgLayout is different from FlatLayout? I could not find any differences.", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433908783", "createdAt": "2020-06-02T14:12:10Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/repo/OrgLayout.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.RepoConfig;\n+import com.artipie.Settings;\n+import com.artipie.SliceFromConfig;\n+import com.artipie.asto.Key;\n+import com.artipie.http.Slice;\n+import com.artipie.http.async.AsyncSlice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.rs.RsWithBody;\n+import com.artipie.http.rs.RsWithStatus;\n+import com.artipie.http.slice.SliceSimple;\n+import com.jcabi.log.Logger;\n+import io.vertx.reactivex.core.Vertx;\n+import java.nio.charset.StandardCharsets;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.regex.Pattern;\n+import org.cactoos.scalar.Unchecked;\n+\n+/**\n+ * Flat repositories layout.\n+ * @see RepoLayout\n+ * @since 0.4\n+ * @checkstyle ReturnCountCheck (500 lines)\n+ * @checkstyle ClassDataAbstractionCouplingCheck (500 lines)\n+ */\n+public final class OrgLayout implements RepoLayout {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzIxMjE4", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422721218", "createdAt": "2020-06-02T14:12:56Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoxMjo1NlrOGdzuaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoxNDo1M1rOGdzzvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkwOTM1NQ==", "bodyText": "@g4s8 I think, this pattern is too restricted: how about dashes ('-'), underscores ('_') and some other symbols? Valid path symbols can be looked here", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433909355", "createdAt": "2020-06-02T14:12:56Z", "author": {"login": "brastak"}, "path": "src/main/java/com/artipie/repo/OrgLayout.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.RepoConfig;\n+import com.artipie.Settings;\n+import com.artipie.SliceFromConfig;\n+import com.artipie.asto.Key;\n+import com.artipie.http.Slice;\n+import com.artipie.http.async.AsyncSlice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.rs.RsWithBody;\n+import com.artipie.http.rs.RsWithStatus;\n+import com.artipie.http.slice.SliceSimple;\n+import com.jcabi.log.Logger;\n+import io.vertx.reactivex.core.Vertx;\n+import java.nio.charset.StandardCharsets;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.regex.Pattern;\n+import org.cactoos.scalar.Unchecked;\n+\n+/**\n+ * Flat repositories layout.\n+ * @see RepoLayout\n+ * @since 0.4\n+ * @checkstyle ReturnCountCheck (500 lines)\n+ * @checkstyle ClassDataAbstractionCouplingCheck (500 lines)\n+ */\n+public final class OrgLayout implements RepoLayout {\n+\n+    /**\n+     * Repository path prefix.\n+     */\n+    private static final Pattern REPO_PREF =\n+        Pattern.compile(\"/(?:[a-zA-Z0-9]+)/(?:[a-zA-Z0-9]+)(/.*)\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkxMDcxNg==", "bodyText": "@g4s8 We need test for new param and documentation (please, add todos)", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433910716", "createdAt": "2020-06-02T14:14:53Z", "author": {"login": "brastak"}, "path": "src/main/java/com/artipie/YamlSettings.java", "diffHunk": "@@ -112,6 +116,23 @@ public Storage storage() throws IOException {\n         return res;\n     }\n \n+    @Override\n+    public RepoLayout layout(final Vertx vertx) throws IOException {\n+        final String layout = Yaml.createYamlInput(this.content)\n+            .readYamlMapping()\n+            .yamlMapping(YamlSettings.META)\n+            .string(\"layout\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzM0Njcy", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422734672", "createdAt": "2020-06-02T14:26:28Z", "commit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoyNjoyOFrOGd0VcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDoyNjoyOFrOGd0VcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkxOTM0NQ==", "bodyText": "The only difference between this pattern and the one at FlatLayout.REPO_PREF is the minimum amount of / symbols and parts in between them, 2 in case of FlatLayout and 3 in this case. This also could be decomposed. An example:\nPattern REPO_PREF = new PathLevel(3)", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433919345", "createdAt": "2020-06-02T14:26:28Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/repo/OrgLayout.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.RepoConfig;\n+import com.artipie.Settings;\n+import com.artipie.SliceFromConfig;\n+import com.artipie.asto.Key;\n+import com.artipie.http.Slice;\n+import com.artipie.http.async.AsyncSlice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.rs.RsWithBody;\n+import com.artipie.http.rs.RsWithStatus;\n+import com.artipie.http.slice.SliceSimple;\n+import com.jcabi.log.Logger;\n+import io.vertx.reactivex.core.Vertx;\n+import java.nio.charset.StandardCharsets;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.regex.Pattern;\n+import org.cactoos.scalar.Unchecked;\n+\n+/**\n+ * Flat repositories layout.\n+ * @see RepoLayout\n+ * @since 0.4\n+ * @checkstyle ReturnCountCheck (500 lines)\n+ * @checkstyle ClassDataAbstractionCouplingCheck (500 lines)\n+ */\n+public final class OrgLayout implements RepoLayout {\n+\n+    /**\n+     * Repository path prefix.\n+     */\n+    private static final Pattern REPO_PREF =\n+        Pattern.compile(\"/(?:[a-zA-Z0-9]+)/(?:[a-zA-Z0-9]+)(/.*)\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4ba76dc5c54b374c5ec14a56db7c8a89a594ea4"}, "originalPosition": 56}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "448782ad2de072decf0cade1550a2ca91b051fd5", "author": {"user": {"login": "g4s8", "name": "Kirill"}}, "url": "https://github.com/artipie/artipie/commit/448782ad2de072decf0cade1550a2ca91b051fd5", "committedDate": "2020-06-02T14:49:30Z", "message": "#178 - review fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzcyMTI5", "url": "https://github.com/artipie/artipie/pull/187#pullrequestreview-422772129", "createdAt": "2020-06-02T15:04:36Z", "commit": {"oid": "448782ad2de072decf0cade1550a2ca91b051fd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNTowNDozNlrOGd2Czg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNTowNDozNlrOGd2Czg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk0NzM0Mg==", "bodyText": "(?:[a-zA-Z0-9_]+) repeated 3 times, decompose it somehow so you would not do the same changes 3 times like you did it in 448782a", "url": "https://github.com/artipie/artipie/pull/187#discussion_r433947342", "createdAt": "2020-06-02T15:04:36Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/repo/FlatLayout.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * The MIT License (MIT)\n+ *\n+ * Copyright (c) 2020 artipie.com\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included\n+ * in all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.repo;\n+\n+import com.artipie.RepoConfig;\n+import com.artipie.Settings;\n+import com.artipie.SliceFromConfig;\n+import com.artipie.asto.Key;\n+import com.artipie.http.Slice;\n+import com.artipie.http.async.AsyncSlice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.rs.RsWithBody;\n+import com.artipie.http.rs.RsWithStatus;\n+import com.artipie.http.slice.SliceSimple;\n+import com.jcabi.log.Logger;\n+import io.vertx.reactivex.core.Vertx;\n+import java.nio.charset.StandardCharsets;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.regex.Pattern;\n+import org.cactoos.scalar.Unchecked;\n+\n+/**\n+ * Flat repositories layout.\n+ * <p>\n+ * Artipie doesn't use any structural layout, all repositories\n+ * are located at the root of base path, e.g. URI {@code https://central.artipie.com/maven}\n+ * accesses {@code maven} repository.\n+ * </p>\n+ * @see RepoLayout\n+ * @since 0.4\n+ * @checkstyle ReturnCountCheck (500 lines)\n+ * @checkstyle ClassDataAbstractionCouplingCheck (500 lines)\n+ */\n+public final class FlatLayout implements RepoLayout {\n+\n+    /**\n+     * Repository path prefix.\n+     */\n+    private static final Pattern REPO_PREF = Pattern.compile(\"/(?:[a-zA-Z0-9_]+)(/.*)\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "448782ad2de072decf0cade1550a2ca91b051fd5"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ec609fc8f7f697eba40d94134b00abdde843957", "author": {"user": {"login": "g4s8", "name": "Kirill"}}, "url": "https://github.com/artipie/artipie/commit/6ec609fc8f7f697eba40d94134b00abdde843957", "committedDate": "2020-06-03T08:01:46Z", "message": "#178 - review fixes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3205, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}