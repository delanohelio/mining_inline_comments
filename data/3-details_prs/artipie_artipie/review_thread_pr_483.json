{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNTk1MTU1", "number": 483, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyMzoxNVrOEa8kEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyNDoyNVrOEa8lbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NjkwNzA1OnYy", "diffSide": "RIGHT", "path": "examples/php/run.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyMzoxNlrOHErG3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjozMzo1N1rOHErbhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MjYyMg==", "bodyText": "@Sammers21 guess this command is to clean up after previous run? If so, would not it be better move it down to somewhere around docker stop artipie command", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474662622", "createdAt": "2020-08-21T12:23:16Z", "author": {"login": "olegmoz"}, "path": "examples/php/run.sh", "diffHunk": "@@ -0,0 +1,35 @@\n+set -x\n+set -e\n+\n+# Start artipie.\n+docker run --rm --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+\n+# Wait for container to be ready for new connections.\n+sleep 5\n+\n+# Make a zip package and post it to artipie binary storage.\n+zip -r sample-for-deployment.zip sample-for-deployment\n+curl -i -X PUT --data-binary \"@sample-for-deployment.zip\" http://localhost:8080/bin/sample-for-deployment.zip\n+\n+# Post the package to php-composer-repository.\n+curl -i -X POST  http://localhost:8080/my-php \\\n+--request PUT \\\n+-H \"Expect:\" \\\n+-H 'Content-Type: application/json; charset=utf-8' \\\n+--data-binary @- << EOF\n+{\n+  \"name\": \"artipie/sample_composer_package\",\n+  \"version\": \"1.0\",\n+  \"dist\": {\n+    \"url\": \"http://localhost:8080/bin/sample-for-deployment.zip\",\n+    \"type\": \"zip\"\n+  }\n+}\n+EOF\n+\n+# Install the deployed package.\n+cd sample-consumer; rm -rf vendor/ composer.lock", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d33837f60e52c857085044c215fc1dd8bc0b02ca"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2NzkxMA==", "bodyText": "@Sammers21 guess this command is to clean up after previous run?\n\n@olegmoz, Yes and for ensuring that the package will be downloaded via network and vendor/ cache would not be reused.\n\nIf so, would not it be better move it down to somewhere around docker stop artipie command\n\nIf I would do this, a user would not be able to inspect the vendor/ directory and composer.lock file, which he might find useful.", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474667910", "createdAt": "2020-08-21T12:33:57Z", "author": {"login": "Sammers21"}, "path": "examples/php/run.sh", "diffHunk": "@@ -0,0 +1,35 @@\n+set -x\n+set -e\n+\n+# Start artipie.\n+docker run --rm --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+\n+# Wait for container to be ready for new connections.\n+sleep 5\n+\n+# Make a zip package and post it to artipie binary storage.\n+zip -r sample-for-deployment.zip sample-for-deployment\n+curl -i -X PUT --data-binary \"@sample-for-deployment.zip\" http://localhost:8080/bin/sample-for-deployment.zip\n+\n+# Post the package to php-composer-repository.\n+curl -i -X POST  http://localhost:8080/my-php \\\n+--request PUT \\\n+-H \"Expect:\" \\\n+-H 'Content-Type: application/json; charset=utf-8' \\\n+--data-binary @- << EOF\n+{\n+  \"name\": \"artipie/sample_composer_package\",\n+  \"version\": \"1.0\",\n+  \"dist\": {\n+    \"url\": \"http://localhost:8080/bin/sample-for-deployment.zip\",\n+    \"type\": \"zip\"\n+  }\n+}\n+EOF\n+\n+# Install the deployed package.\n+cd sample-consumer; rm -rf vendor/ composer.lock", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MjYyMg=="}, "originalCommit": {"oid": "d33837f60e52c857085044c215fc1dd8bc0b02ca"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NjkxMDU0OnYy", "diffSide": "RIGHT", "path": "examples/php/run.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyNDoyNVrOHErJAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyNDoyNVrOHErJAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2MzE2OA==", "bodyText": "@Sammers21 are these headers required? I'd keep the example as simple and short as possible and removed everything that is not mandatory", "url": "https://github.com/artipie/artipie/pull/483#discussion_r474663168", "createdAt": "2020-08-21T12:24:25Z", "author": {"login": "olegmoz"}, "path": "examples/php/run.sh", "diffHunk": "@@ -0,0 +1,35 @@\n+set -x\n+set -e\n+\n+# Start artipie.\n+docker run --rm --name artipie -d -it -v $(pwd)/artipie.yaml:/etc/artipie.yml -v $(pwd):/var/artipie -p 8080:80 artipie/artipie:latest\n+\n+# Wait for container to be ready for new connections.\n+sleep 5\n+\n+# Make a zip package and post it to artipie binary storage.\n+zip -r sample-for-deployment.zip sample-for-deployment\n+curl -i -X PUT --data-binary \"@sample-for-deployment.zip\" http://localhost:8080/bin/sample-for-deployment.zip\n+\n+# Post the package to php-composer-repository.\n+curl -i -X POST  http://localhost:8080/my-php \\\n+--request PUT \\\n+-H \"Expect:\" \\\n+-H 'Content-Type: application/json; charset=utf-8' \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d33837f60e52c857085044c215fc1dd8bc0b02ca"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2122, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}