{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5ODY2NjEz", "number": 612, "title": "#572 - read groups in AuthFromYaml", "bodyText": "Part of #572\nUpdated http and corrected AuthFromYaml read groups from credentials.yaml", "createdAt": "2020-09-20T06:58:14Z", "url": "https://github.com/artipie/artipie/pull/612", "merged": true, "mergeCommit": {"oid": "c61372a6934f8590e815758078e291e1667b3975"}, "closed": true, "closedAt": "2020-09-21T10:49:09Z", "author": {"login": "olenagerasimova"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKpJOsAH2gAyNDg5ODY2NjEzOjMwZGIwYWVkNGJjYWU5ZTdjZGYxMGQ0ZGEzMTBlYzg5YmUwZWEwMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLA5rSAH2gAyNDg5ODY2NjEzOjMxN2U1MjY0MTA5MGQwY2E0ODI0NjM5YmNmNTViOTU0MzE5MGE1OTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "30db0aed4bcae9e7cdf10d4da310ec89be0ea01a", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/30db0aed4bcae9e7cdf10d4da310ec89be0ea01a", "committedDate": "2020-09-20T06:52:40Z", "message": "#572 - read groups in AuthFromYaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNDAzNDI0", "url": "https://github.com/artipie/artipie/pull/612#pullrequestreview-492403424", "createdAt": "2020-09-21T09:07:01Z", "commit": {"oid": "30db0aed4bcae9e7cdf10d4da310ec89be0ea01a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwOTowNzowMVrOHVGq4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwOTowNzowMVrOHVGq4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg5MTQyNQ==", "bodyText": "@olenagerasimova merging of nested if/else statements you've mad are not identical. Is it intentional? I'd suggest to keep it as it is for now and address in separate issue/PR if it needs to be fixed", "url": "https://github.com/artipie/artipie/pull/612#discussion_r491891425", "createdAt": "2020-09-21T09:07:01Z", "author": {"login": "olegmoz"}, "path": "src/main/java/com/artipie/auth/AuthFromYaml.java", "diffHunk": "@@ -65,22 +68,18 @@ public AuthFromYaml(final YamlMapping cred) {\n     }\n \n     @Override\n-    public Optional<String> user(final String user, final String pass) {\n+    public Optional<Authentication.User> user(final String user, final String pass) {\n         final YamlMapping users = this.cred.yamlMapping(\"credentials\");\n-        Optional<String> res = Optional.empty();\n+        Optional<Authentication.User> res = Optional.empty();\n         //@checkstyle NestedIfDepthCheck (10 lines)\n         if (users != null && users.yamlMapping(user) != null) {\n             final String stored = users.yamlMapping(user).string(\"pass\");\n             if (stored != null) {\n                 final String type = users.yamlMapping(user).string(\"type\");\n-                if (type != null) {\n-                    if (check(stored, type, pass)) {\n-                        res = Optional.of(user);\n-                    }\n-                } else {\n-                    if (check(stored, pass)) {\n-                        res = Optional.of(user);\n-                    }\n+                if (type != null && check(stored, type, pass)) {\n+                    res = Optional.of(new User(user, AuthFromYaml.groups(users.yamlMapping(user))));\n+                } else if (check(stored, pass)) {\n+                    res = Optional.of(new User(user, AuthFromYaml.groups(users.yamlMapping(user))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30db0aed4bcae9e7cdf10d4da310ec89be0ea01a"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eacadd3c87054445614b2131b8a0a209ebc2d849", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/eacadd3c87054445614b2131b8a0a209ebc2d849", "committedDate": "2020-09-21T09:34:58Z", "message": "#572 - CR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNDY2MTcz", "url": "https://github.com/artipie/artipie/pull/612#pullrequestreview-492466173", "createdAt": "2020-09-21T10:33:17Z", "commit": {"oid": "eacadd3c87054445614b2131b8a0a209ebc2d849"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317e52641090d0ca4824639bcf55b9543190a597", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/artipie/commit/317e52641090d0ca4824639bcf55b9543190a597", "committedDate": "2020-09-21T10:33:24Z", "message": "Merge branch 'master' into 572-update-http"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3584, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}