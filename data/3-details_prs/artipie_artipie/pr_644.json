{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0MTI1NDk0", "number": 644, "title": "#573 - add groups to GetPermissionSlice", "bodyText": "Part of #573\nAdded groups to GetPermissionSlice and updated API doc.", "createdAt": "2020-09-28T13:01:01Z", "url": "https://github.com/artipie/artipie/pull/644", "merged": true, "mergeCommit": {"oid": "898fffa35f9ccd9f1a8c697b87a7f9dcd7cd80c8"}, "closed": true, "closedAt": "2020-09-29T07:37:26Z", "author": {"login": "olenagerasimova"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNTLkagH2gAyNDk0MTI1NDk0OjVkYTc3ZTRiODhmNmY0OGFmOWE3MGYwOWY1YjMwNzA3NGE3ZTUwODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNi07VAFqTQ5ODE1Njc5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5da77e4b88f6f48af9a70f09f5b307074a7e5081", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/5da77e4b88f6f48af9a70f09f5b307074a7e5081", "committedDate": "2020-09-28T12:59:05Z", "message": "#573 - add groups to GetPermissionSlice"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NTI4MTQw", "url": "https://github.com/artipie/artipie/pull/644#pullrequestreview-497528140", "createdAt": "2020-09-28T13:46:30Z", "commit": {"oid": "5da77e4b88f6f48af9a70f09f5b307074a7e5081"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMzo0NjozMFrOHY-exg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMzo0NjozMFrOHY-exg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTk1MTU1OA==", "bodyText": "@olenagerasimova I think we need to extract item.username().charAt(0) == '/' this predicate to a method or class and reuse it in both filter expressions here to avoid code duplication and make intent more clear", "url": "https://github.com/artipie/artipie/pull/644#discussion_r495951558", "createdAt": "2020-09-28T13:46:30Z", "author": {"login": "olegmoz"}, "path": "src/main/java/com/artipie/api/artifactory/GetPermissionSlice.java", "diffHunk": "@@ -111,7 +112,22 @@ private static JsonObject response(\n         return Json.createObjectBuilder()\n             .add(\"includesPattern\", includesPattern(patterns))\n             .add(\"repositories\", Json.createArrayBuilder().add(repo).build())\n-            .add(\"principals\", Json.createObjectBuilder().add(\"users\", users(permissions)))\n+            .add(\n+                \"principals\",\n+                Json.createObjectBuilder()\n+                    .add(\n+                        \"users\",\n+                        permissions(\n+                            permissions.stream().filter(item -> item.username().charAt(0) != '/')\n+                        )\n+                    )\n+                    .add(\n+                        \"groups\",\n+                        permissions(\n+                            permissions.stream().filter(item -> item.username().charAt(0) == '/')\n+                        )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5da77e4b88f6f48af9a70f09f5b307074a7e5081"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "000a6106fbf2c462bb4a18d0be9cdfed9bcbad01", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/000a6106fbf2c462bb4a18d0be9cdfed9bcbad01", "committedDate": "2020-09-28T17:43:32Z", "message": "#573 - CR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf8c86904304bb47fc9070df5c97d787d517b74c", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/artipie/commit/cf8c86904304bb47fc9070df5c97d787d517b74c", "committedDate": "2020-09-29T07:12:31Z", "message": "Merge branch 'master' into 573-groups-for-get-perm-slice"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTU2Nzky", "url": "https://github.com/artipie/artipie/pull/644#pullrequestreview-498156792", "createdAt": "2020-09-29T07:12:50Z", "commit": {"oid": "cf8c86904304bb47fc9070df5c97d787d517b74c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3387, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}