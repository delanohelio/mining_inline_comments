{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0NTgzMzcy", "number": 767, "title": "#606 - Add authentication push and install IT for Gem", "bodyText": "Closes #606\nAdd authentication push and install IT for Gem. Now these test cases are disabled. Add todo to enable them after passing of authentication and permissions would be implemented.", "createdAt": "2020-11-20T09:48:39Z", "url": "https://github.com/artipie/artipie/pull/767", "merged": true, "mergeCommit": {"oid": "f59c1b8ceb62c73e10f00e28c4256f7f618be0da"}, "closed": true, "closedAt": "2020-11-23T07:06:29Z", "author": {"login": "genryxy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeUJ0DgH2gAyNTI0NTgzMzcyOmU2NmZhNTU3ODU3NmYyMDc4OGNjZjQ3OTBkMjEwYjA2ODQ4NDExYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeZA3SAFqTUzNTUyMjczMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e66fa5578576f20788ccf4790d210b06848411a1", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/e66fa5578576f20788ccf4790d210b06848411a1", "committedDate": "2020-11-20T09:43:47Z", "message": "#606 - Add auth IT for Gem"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1Mzg2MzQz", "url": "https://github.com/artipie/artipie/pull/767#pullrequestreview-535386343", "createdAt": "2020-11-20T12:28:43Z", "commit": {"oid": "e66fa5578576f20788ccf4790d210b06848411a1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxMjoyODo0M1rOH3NwVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxMjoyODo0M1rOH3NwVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzY1OTA5Mg==", "bodyText": "@genryxy it seems odd that there is no GEM_HOST_API_KEY specified in case of non-anonymous operation", "url": "https://github.com/artipie/artipie/pull/767#discussion_r527659092", "createdAt": "2020-11-20T12:28:43Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/gem/GemITCase.java", "diffHunk": "@@ -121,18 +131,25 @@ void tearDown() {\n     }\n \n     private void push(final boolean anonymous) throws Exception {\n-        final String key = new Base64Encoded(\"any:any\").asString();\n         new TestResource(String.format(\"gem/%s\", GemITCase.RAILS))\n             .saveTo(this.storage, new Key.From(GemITCase.RAILS));\n         final String tmpurl = this.url.string(anonymous);\n-        this.cntn.execStdout(\n-            \"/bin/bash\", \"-c\",\n-            String.format(\n-                \"GEM_HOST_API_KEY=%s gem push %s --host %s\",\n-                key, GemITCase.RAILS,\n-                tmpurl.substring(0, tmpurl.length() - 1)\n-            )\n-        );\n+        if (anonymous) {\n+            final String key = new Base64Encoded(\"any:any\").asString();\n+            this.cntn.execStdout(\n+                \"/bin/bash\", \"-c\",\n+                String.format(\n+                    \"GEM_HOST_API_KEY=%s gem push %s --host %s\",\n+                    key, GemITCase.RAILS,\n+                    tmpurl.substring(0, tmpurl.length() - 1)\n+                )\n+            );\n+        } else {\n+            this.cntn.execStdout(\n+                \"gem\", \"push\", GemITCase.RAILS,\n+                \"--host\", tmpurl.substring(0, tmpurl.length() - 1)\n+            );\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e66fa5578576f20788ccf4790d210b06848411a1"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46e493565c424660a944e17b887d40ad6481ac1f", "author": {"user": {"login": "genryxy", "name": "Alexander"}}, "url": "https://github.com/artipie/artipie/commit/46e493565c424660a944e17b887d40ad6481ac1f", "committedDate": "2020-11-20T15:09:56Z", "message": "#606 - Changes by review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc2d822c42722f7ff6eb8d13690045f91e80bbef", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/artipie/commit/fc2d822c42722f7ff6eb8d13690045f91e80bbef", "committedDate": "2020-11-20T15:23:18Z", "message": "Merge branch 'master' into 606-authGemIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NTIyNzMw", "url": "https://github.com/artipie/artipie/pull/767#pullrequestreview-535522730", "createdAt": "2020-11-20T15:23:32Z", "commit": {"oid": "46e493565c424660a944e17b887d40ad6481ac1f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3462, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}