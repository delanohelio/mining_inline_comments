{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0OTIzODQw", "number": 577, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwODo1MzowOFrOEjBuoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNjo1ODo0MFrOEjcwxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MTYzOTM3OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/YamlSettingsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwODo1MzowOFrOHRKJUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTo1MDoyMlrOHRbm3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc1NDA2NA==", "bodyText": "@IlyaMoskva do we really need to provide all that content to YamlSettings? I'd suggest to remove not required lines from the test to make it more focused and clear", "url": "https://github.com/artipie/artipie/pull/577#discussion_r487754064", "createdAt": "2020-09-14T08:53:08Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -46,12 +46,27 @@\n  *\n  * @since 0.1\n  * @checkstyle MethodNameCheck (500 lines)\n- * @todo #187:30min Add a test for layout structure, it can be either `flat` or `org`. If it's\n- *  omitted, it should treated as a `flat` layout. See RepoLayout javadocs for more details.\n  */\n-@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.TooManyMethods\"})\n class YamlSettingsTest {\n \n+    @Test\n+    public void shouldSetFlatAsDefaultLayout() throws Exception {\n+        final YamlSettings settings = new YamlSettings(\n+            String.join(\n+                \"\",\n+                \"meta:\\n\",\n+                \"  storage:\\n\",\n+                \"    type: s3\\n\",\n+                \"    path: /var/artipie/configs\\n\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6408f49c1bb9d30d98386dc365cdbd55ed877c"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA0MDE1OA==", "bodyText": "Not all, you're right. Fixed.", "url": "https://github.com/artipie/artipie/pull/577#discussion_r488040158", "createdAt": "2020-09-14T15:50:22Z", "author": {"login": "IlyaMoskva"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -46,12 +46,27 @@\n  *\n  * @since 0.1\n  * @checkstyle MethodNameCheck (500 lines)\n- * @todo #187:30min Add a test for layout structure, it can be either `flat` or `org`. If it's\n- *  omitted, it should treated as a `flat` layout. See RepoLayout javadocs for more details.\n  */\n-@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.TooManyMethods\"})\n class YamlSettingsTest {\n \n+    @Test\n+    public void shouldSetFlatAsDefaultLayout() throws Exception {\n+        final YamlSettings settings = new YamlSettings(\n+            String.join(\n+                \"\",\n+                \"meta:\\n\",\n+                \"  storage:\\n\",\n+                \"    type: s3\\n\",\n+                \"    path: /var/artipie/configs\\n\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc1NDA2NA=="}, "originalCommit": {"oid": "ef6408f49c1bb9d30d98386dc365cdbd55ed877c"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MTY0NjU4OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/YamlSettingsTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwODo1NDo1MlrOHRKNgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTo0OTo0OFrOHRbldw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc1NTEzOQ==", "bodyText": "@IlyaMoskva using new IsEqual<>() here will be more in line with code style of the project, see https://github.com/artipie/artipie/blob/master/CONTRIBUTING.md#code-style", "url": "https://github.com/artipie/artipie/pull/577#discussion_r487755139", "createdAt": "2020-09-14T08:54:52Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -46,12 +46,27 @@\n  *\n  * @since 0.1\n  * @checkstyle MethodNameCheck (500 lines)\n- * @todo #187:30min Add a test for layout structure, it can be either `flat` or `org`. If it's\n- *  omitted, it should treated as a `flat` layout. See RepoLayout javadocs for more details.\n  */\n-@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.TooManyMethods\"})\n class YamlSettingsTest {\n \n+    @Test\n+    public void shouldSetFlatAsDefaultLayout() throws Exception {\n+        final YamlSettings settings = new YamlSettings(\n+            String.join(\n+                \"\",\n+                \"meta:\\n\",\n+                \"  storage:\\n\",\n+                \"    type: s3\\n\",\n+                \"    path: /var/artipie/configs\\n\"\n+            )\n+        );\n+        MatcherAssert.assertThat(\n+            settings.layout(),\n+            Matchers.is(\"flat\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6408f49c1bb9d30d98386dc365cdbd55ed877c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzOTc5OQ==", "bodyText": "Changed.", "url": "https://github.com/artipie/artipie/pull/577#discussion_r488039799", "createdAt": "2020-09-14T15:49:48Z", "author": {"login": "IlyaMoskva"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -46,12 +46,27 @@\n  *\n  * @since 0.1\n  * @checkstyle MethodNameCheck (500 lines)\n- * @todo #187:30min Add a test for layout structure, it can be either `flat` or `org`. If it's\n- *  omitted, it should treated as a `flat` layout. See RepoLayout javadocs for more details.\n  */\n-@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.TooManyMethods\"})\n class YamlSettingsTest {\n \n+    @Test\n+    public void shouldSetFlatAsDefaultLayout() throws Exception {\n+        final YamlSettings settings = new YamlSettings(\n+            String.join(\n+                \"\",\n+                \"meta:\\n\",\n+                \"  storage:\\n\",\n+                \"    type: s3\\n\",\n+                \"    path: /var/artipie/configs\\n\"\n+            )\n+        );\n+        MatcherAssert.assertThat(\n+            settings.layout(),\n+            Matchers.is(\"flat\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc1NTEzOQ=="}, "originalCommit": {"oid": "ef6408f49c1bb9d30d98386dc365cdbd55ed877c"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjA2ODU0OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/YamlSettingsTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNjo1ODo0MFrOHRzbsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjo1NjowNFrOHSvfBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMDUxMg==", "bodyText": "@IlyaMoskva and is storage: part really needed? We do not access storage in this test and I believe the string could be simplified to just `\"meta:\\n\"", "url": "https://github.com/artipie/artipie/pull/577#discussion_r488430512", "createdAt": "2020-09-15T06:58:40Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -56,14 +57,12 @@ public void shouldSetFlatAsDefaultLayout() throws Exception {\n             String.join(\n                 \"\",\n                 \"meta:\\n\",\n-                \"  storage:\\n\",\n-                \"    type: s3\\n\",\n-                \"    path: /var/artipie/configs\\n\"\n+                \"  storage:\\n\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "394b55b58f123a37728d91509d1efd8a8812b76c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODUyMTk5Nw==", "bodyText": "@olegmoz It breaks in constructor or in other place before. Just 'meta:' doesn't work for me.", "url": "https://github.com/artipie/artipie/pull/577#discussion_r488521997", "createdAt": "2020-09-15T09:29:15Z", "author": {"login": "IlyaMoskva"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -56,14 +57,12 @@ public void shouldSetFlatAsDefaultLayout() throws Exception {\n             String.join(\n                 \"\",\n                 \"meta:\\n\",\n-                \"  storage:\\n\",\n-                \"    type: s3\\n\",\n-                \"    path: /var/artipie/configs\\n\"\n+                \"  storage:\\n\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMDUxMg=="}, "originalCommit": {"oid": "394b55b58f123a37728d91509d1efd8a8812b76c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU1OTczMw==", "bodyText": "@IlyaMoskva that's weird, there is just assignment in constructor. Could you please elaborate the problem?", "url": "https://github.com/artipie/artipie/pull/577#discussion_r488559733", "createdAt": "2020-09-15T10:30:13Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -56,14 +57,12 @@ public void shouldSetFlatAsDefaultLayout() throws Exception {\n             String.join(\n                 \"\",\n                 \"meta:\\n\",\n-                \"  storage:\\n\",\n-                \"    type: s3\\n\",\n-                \"    path: /var/artipie/configs\\n\"\n+                \"  storage:\\n\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMDUxMg=="}, "originalCommit": {"oid": "394b55b58f123a37728d91509d1efd8a8812b76c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQwNjgyNg==", "bodyText": "@olegmoz Exactly 'storage' is not necessary here it can be any string, but empty meta throws java.util.NoSuchElementException in .yamlMapping(YamlSettings.KEY_META) call. It must contain at least something inside. I believe, it's out of scope for this ticket.", "url": "https://github.com/artipie/artipie/pull/577#discussion_r489406826", "createdAt": "2020-09-16T12:44:25Z", "author": {"login": "IlyaMoskva"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -56,14 +57,12 @@ public void shouldSetFlatAsDefaultLayout() throws Exception {\n             String.join(\n                 \"\",\n                 \"meta:\\n\",\n-                \"  storage:\\n\",\n-                \"    type: s3\\n\",\n-                \"    path: /var/artipie/configs\\n\"\n+                \"  storage:\\n\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMDUxMg=="}, "originalCommit": {"oid": "394b55b58f123a37728d91509d1efd8a8812b76c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQxNDQwNw==", "bodyText": "@IlyaMoskva got it, thanks", "url": "https://github.com/artipie/artipie/pull/577#discussion_r489414407", "createdAt": "2020-09-16T12:56:04Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlSettingsTest.java", "diffHunk": "@@ -56,14 +57,12 @@ public void shouldSetFlatAsDefaultLayout() throws Exception {\n             String.join(\n                 \"\",\n                 \"meta:\\n\",\n-                \"  storage:\\n\",\n-                \"    type: s3\\n\",\n-                \"    path: /var/artipie/configs\\n\"\n+                \"  storage:\\n\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMDUxMg=="}, "originalCommit": {"oid": "394b55b58f123a37728d91509d1efd8a8812b76c"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2185, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}