{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzOTAwNjkw", "number": 641, "title": "#573 - update http", "bodyText": "Updated http to 0.16.2, gem and docker adapters and corrected YamlPermissions to check permissions for user groups.", "createdAt": "2020-09-28T06:14:58Z", "url": "https://github.com/artipie/artipie/pull/641", "merged": true, "mergeCommit": {"oid": "9b2b135780258206588a3d7e1f8a6d9a33fedfbc"}, "closed": true, "closedAt": "2020-09-29T08:46:49Z", "author": {"login": "olenagerasimova"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNNXrogH2gAyNDkzOTAwNjkwOmU1OTdkMTkyY2NhNTE0MmZhMzIxZGIxNjQ2MTA4YTFlNzhkYWNmZjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNkKycgFqTQ5ODI0NTYxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e597d192cca5142fa321db1646108a1e78dacff6", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/e597d192cca5142fa321db1646108a1e78dacff6", "committedDate": "2020-09-28T06:12:53Z", "message": "#573 - update http"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dced3f5f753283904f6c614d2908ecfba86add4", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/6dced3f5f753283904f6c614d2908ecfba86add4", "committedDate": "2020-09-28T07:14:52Z", "message": "Merge branch 'master' into 573-udpdate-http"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3c7a86e911a187b498ca659f051727fe2896917", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/a3c7a86e911a187b498ca659f051727fe2896917", "committedDate": "2020-09-28T10:30:15Z", "message": "check groups in YamlPermissions and update docker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddf1cdc283a65c4beb48ac3551d32d7c0f31b54e", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/ddf1cdc283a65c4beb48ac3551d32d7c0f31b54e", "committedDate": "2020-09-29T04:58:40Z", "message": "#573 - bumped gem version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef7fad21fa58a1f260ef940e485b43c3dfa3051d", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/ef7fad21fa58a1f260ef940e485b43c3dfa3051d", "committedDate": "2020-09-29T05:05:12Z", "message": "Merge branch 'master' into 573-udpdate-http"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTc2MjQw", "url": "https://github.com/artipie/artipie/pull/641#pullrequestreview-498176240", "createdAt": "2020-09-29T07:40:00Z", "commit": {"oid": "ef7fad21fa58a1f260ef940e485b43c3dfa3051d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNzo0MDowMFrOHZe45g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQwNzo0OTo1OVrOHZfPxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ4MjUzNA==", "bodyText": "@olenagerasimova I think User class lacks proper toString method at the moment. So we need to implement User formatting ourselves here or just print user's name for now", "url": "https://github.com/artipie/artipie/pull/641#discussion_r496482534", "createdAt": "2020-09-29T07:40:00Z", "author": {"login": "olegmoz"}, "path": "src/main/java/com/artipie/LoggingPermissions.java", "diffHunk": "@@ -63,12 +64,12 @@ public LoggingPermissions(final Permissions origin, final Level level) {\n     }\n \n     @Override\n-    public boolean allowed(final String name, final String action) {\n-        final boolean res = this.origin.allowed(name, action);\n+    public boolean allowed(final Authentication.User user, final String action) {\n+        final boolean res = this.origin.allowed(user, action);\n         if (res) {\n-            Logger.log(this.level, this.origin, \"Operation '%s' allowed for '%s'\", action, name);\n+            Logger.log(this.level, this.origin, \"Operation '%s' allowed for '%s'\", action, user);\n         } else {\n-            Logger.log(this.level, this.origin, \"Operation '%s' denied for '%s'\", action, name);\n+            Logger.log(this.level, this.origin, \"Operation '%s' denied for '%s'\", action, user);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef7fad21fa58a1f260ef940e485b43c3dfa3051d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ4ODM5MA==", "bodyText": "@olenagerasimova I'd suggest to extract variable for Authentication.User(uname) to make code easier to read here and in janeCanDownloadAndDeploy, adminCanDoAnything methods", "url": "https://github.com/artipie/artipie/pull/641#discussion_r496488390", "createdAt": "2020-09-29T07:49:59Z", "author": {"login": "olegmoz"}, "path": "src/test/java/com/artipie/YamlPermissionsTest.java", "diffHunk": "@@ -48,10 +53,11 @@ void johnCanDownloadDeployAndDelete() throws Exception {\n             this.permissions(),\n             new AllOf<YamlPermissions>(\n                 new ListOf<org.hamcrest.Matcher<? super YamlPermissions>>(\n-                    new MatcherOf<>(perm -> { return perm.allowed(uname, \"delete\"); }),\n-                    new MatcherOf<>(perm -> { return perm.allowed(uname, \"deploy\"); }),\n-                    new MatcherOf<>(perm -> { return perm.allowed(uname, \"download\"); }),\n-                    new MatcherOf<>(perm -> !perm.allowed(uname, \"install\"))\n+                    // @checkstyle LineLengthCheck (4 lines)\n+                    new MatcherOf<>(perm -> { return perm.allowed(new Authentication.User(uname), \"delete\"); }),\n+                    new MatcherOf<>(perm -> { return perm.allowed(new Authentication.User(uname), \"deploy\"); }),\n+                    new MatcherOf<>(perm -> { return perm.allowed(new Authentication.User(uname), \"download\"); }),\n+                    new MatcherOf<>(perm -> !perm.allowed(new Authentication.User(uname), \"install\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef7fad21fa58a1f260ef940e485b43c3dfa3051d"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcb535d2cf646601d366bc9dc7fb32609a878f40", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/dcb535d2cf646601d366bc9dc7fb32609a878f40", "committedDate": "2020-09-29T08:25:43Z", "message": "#573 - CR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34b91a3a415a91f6734c4dd7400df6475b3e90ea", "author": {"user": {"login": "olenagerasimova", "name": "Alena"}}, "url": "https://github.com/artipie/artipie/commit/34b91a3a415a91f6734c4dd7400df6475b3e90ea", "committedDate": "2020-09-29T08:26:19Z", "message": "Merge branch 'master' into 573-udpdate-http"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MjQ1NjEw", "url": "https://github.com/artipie/artipie/pull/641#pullrequestreview-498245610", "createdAt": "2020-09-29T08:46:37Z", "commit": {"oid": "34b91a3a415a91f6734c4dd7400df6475b3e90ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3385, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}