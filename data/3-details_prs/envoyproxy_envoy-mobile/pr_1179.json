{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMjIxMDM1", "number": 1179, "title": "native resource registry: fix construction", "bodyText": "Description: Cleans up and and fixes an earlier rebase issue with the NativeResourceRegistry and adds test coverage.\nRisk Level: Low\nTesting: Local, CI, and in app.\nSigned-off-by: Mike Schore mike.schore@gmail.com", "createdAt": "2020-11-12T23:29:02Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1179", "merged": true, "mergeCommit": {"oid": "2db10d6c0dce9cdd9c67ff10cf948040855eba0d"}, "closed": true, "closedAt": "2020-11-18T20:21:50Z", "author": {"login": "goaway"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcDgRogBqjM5OTI1NTAyMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddz-dOgFqTUzMzgzNzM0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "13db4ba40afad869d452b34a60d8fb8a6c946458", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/13db4ba40afad869d452b34a60d8fb8a6c946458", "committedDate": "2020-11-12T23:28:32Z", "message": "native resouce registry: fix construction\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}, "afterCommit": {"oid": "54d69161a20d7662104a5886db815973ac6f69e0", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/54d69161a20d7662104a5886db815973ac6f69e0", "committedDate": "2020-11-13T09:11:52Z", "message": "native resouce registry: fix construction\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb5dac724bdd936291d4448829e03060660f56cf", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/cb5dac724bdd936291d4448829e03060660f56cf", "committedDate": "2020-11-17T11:53:55Z", "message": "native resouce registry: fix construction\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "447b7fc07a1862e7da5ecb0dd5fb06e0eb737499", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/447b7fc07a1862e7da5ecb0dd5fb06e0eb737499", "committedDate": "2020-11-17T11:53:55Z", "message": "add test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0828935521b28c8619d864b2a12bb26f681b40f0", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/0828935521b28c8619d864b2a12bb26f681b40f0", "committedDate": "2020-11-17T12:22:49Z", "message": "working test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b411b44083ea8c7667559aff61eec435b8c28990", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/b411b44083ea8c7667559aff61eec435b8c28990", "committedDate": "2020-11-13T12:49:54Z", "message": "add test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}, "afterCommit": {"oid": "0828935521b28c8619d864b2a12bb26f681b40f0", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/0828935521b28c8619d864b2a12bb26f681b40f0", "committedDate": "2020-11-17T12:22:49Z", "message": "working test\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61e06a50f8437c01ef08fc15e1db46da768f4676", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/61e06a50f8437c01ef08fc15e1db46da768f4676", "committedDate": "2020-11-17T12:42:46Z", "message": "fix format\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjUxMzQ5", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1179#pullrequestreview-532651349", "createdAt": "2020-11-17T18:06:40Z", "commit": {"oid": "61e06a50f8437c01ef08fc15e1db46da768f4676"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODowNjo0MFrOH1CcDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODowNjo0MFrOH1CcDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM3NjUyNg==", "bodyText": "Would this still work if we create a private method which does this instead of inlining it into each test (this is so we can more easily add a new test or change the wrapper)?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1179#discussion_r525376526", "createdAt": "2020-11-17T18:06:40Z", "author": {"login": "buildbreaker"}, "path": "library/java/test/io/envoyproxy/envoymobile/engine/EnvoyNativeResourceRegistryTest.kt", "diffHunk": "@@ -0,0 +1,52 @@\n+package io.envoyproxy.envoymobile.engine\n+\n+import java.util.concurrent.CountDownLatch\n+import java.util.concurrent.TimeUnit\n+\n+import org.assertj.core.api.Assertions.assertThat\n+import org.junit.Test\n+\n+class EnvoyNativeResourceRegistryTest {\n+\n+  @Test\n+  fun `release callbacks are invoked when EnvoyNativeResourceWrappers are flagged as unreachable`() {\n+    val latch = CountDownLatch(1)\n+    val testHandle: Long = 77\n+    // Force Wrapper out of scope so the GC picks it up. \u00af\\_(\u30c4)_/\u00af\n+    for (i in 0..1 step 2) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e06a50f8437c01ef08fc15e1db46da768f4676"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "567812e38ab1f10b0ed04037cc91315abf665a7e", "author": {"user": {"login": "goaway", "name": "Mike Schore"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/567812e38ab1f10b0ed04037cc91315abf665a7e", "committedDate": "2020-11-18T10:15:02Z", "message": "fix imports?\n\nSigned-off-by: Mike Schore <mike.schore@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODM3MzQ1", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1179#pullrequestreview-533837345", "createdAt": "2020-11-18T20:14:25Z", "commit": {"oid": "567812e38ab1f10b0ed04037cc91315abf665a7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3910, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}