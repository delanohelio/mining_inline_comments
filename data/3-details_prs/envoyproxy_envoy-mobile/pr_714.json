{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxOTE5MjMx", "number": 714, "title": "dns: add ability to set dns failure refresh rate", "bodyText": "Description: updates envoy ref to include envoyproxy/envoy#10137. Exposes client builder function to add dns failure refresh rate.\nRisk Level: low, new configuration option\nTesting: local apps, CI\nDocs Changes: created #715 to create a section in the docs for all the builder options.\nFixes #673", "createdAt": "2020-02-29T18:32:07Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714", "merged": true, "mergeCommit": {"oid": "824ba9d00a063deb869b26274d273d17115e0fe1"}, "closed": true, "closedAt": "2020-03-02T18:12:57Z", "author": {"login": "junr03"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJCVEAgH2gAyMzgxOTE5MjMxOjkyMDgwZTZiN2QzMTNhMGRmZGIzZTE0YjUzNTZkODRkYzZjMzQzYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJxT_XgFqTM2NzM5MjE3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "92080e6b7d313a0dfdb3e14b5356d84dc6c343ac", "author": {"user": {"login": "junr03", "name": "Jose Ulises Nino Rivera"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/92080e6b7d313a0dfdb3e14b5356d84dc6c343ac", "committedDate": "2020-02-29T10:54:13Z", "message": "wip\n\nSigned-off-by: Jose Nino <jnino@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b53ec329890842a45936405d250ac9a411c80d1f", "author": {"user": {"login": "junr03", "name": "Jose Ulises Nino Rivera"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/b53ec329890842a45936405d250ac9a411c80d1f", "committedDate": "2020-02-29T12:29:56Z", "message": "tests passing\n\nSigned-off-by: Jose Nino <jnino@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54413b0ba7b33af3186d82cb48fe9514538472e9", "author": {"user": {"login": "junr03", "name": "Jose Ulises Nino Rivera"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/54413b0ba7b33af3186d82cb48fe9514538472e9", "committedDate": "2020-02-29T18:35:26Z", "message": "fmt\n\nSigned-off-by: Jose Nino <jnino@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODEzMDU2", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#pullrequestreview-366813056", "createdAt": "2020-02-29T18:40:33Z", "commit": {"oid": "54413b0ba7b33af3186d82cb48fe9514538472e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQxODo0MDozM1rOFwKcLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQxODo0MDozM1rOFwKcLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA0NzAyMQ==", "bodyText": "I considered putting all of the dns settings into a struct (same on iOS), but ultimately decided to keep this flat for this change.\nI think if this lists keeps growing we need to first think about how we are going to manage config as it gets more unruly. But for now keeping it flat seemed the least intrusive change.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#discussion_r386047021", "createdAt": "2020-02-29T18:40:33Z", "author": {"login": "junr03"}, "path": "library/java/src/io/envoyproxy/envoymobile/engine/EnvoyConfiguration.java", "diffHunk": "@@ -5,22 +5,29 @@\n   public final String statsDomain;\n   public final Integer connectTimeoutSeconds;\n   public final Integer dnsRefreshSeconds;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54413b0ba7b33af3186d82cb48fe9514538472e9"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae", "author": {"user": {"login": "junr03", "name": "Jose Ulises Nino Rivera"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/95fd2c78ace3c598716cb0319da968ace999a2ae", "committedDate": "2020-02-29T18:42:32Z", "message": "java test\n\nSigned-off-by: Jose Nino <jnino@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3Mzg5OTk4", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#pullrequestreview-367389998", "createdAt": "2020-03-02T17:35:12Z", "commit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNzozNToxMlrOFwomeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNzozNTozMlrOFwonFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU0MTE3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param statsDomain                  The domain to flush stats to.\n          \n          \n            \n               * @param statsDomain                  the domain to flush stats to.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#discussion_r386541176", "createdAt": "2020-03-02T17:35:12Z", "author": {"login": "rebello95"}, "path": "library/java/src/io/envoyproxy/envoymobile/engine/EnvoyConfiguration.java", "diffHunk": "@@ -5,22 +5,29 @@\n   public final String statsDomain;\n   public final Integer connectTimeoutSeconds;\n   public final Integer dnsRefreshSeconds;\n+  public final Integer dnsFailureRefreshSecondsBase;\n+  public final Integer dnsFailureRefreshSecondsMax;\n   public final Integer statsFlushSeconds;\n \n   /**\n    * Create an EnvoyConfiguration with a user provided configuration values.\n    *\n-   * @param statsDomain           The domain to flush stats to.\n-   * @param connectTimeoutSeconds timeout for new network connections to hosts in\n-   *                              the cluster.\n-   * @param dnsRefreshSeconds     rate in seconds to refresh DNS.\n-   * @param statsFlushSeconds     interval at which to flush Envoy stats.\n+   * @param statsDomain                  The domain to flush stats to.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU0MTMwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                assertThat(resolvedTemplate).contains(\"base_interval: 345\")\n          \n          \n            \n                assertThat(resolvedTemplate).contains(\"base_interval: 345s\")", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#discussion_r386541300", "createdAt": "2020-03-02T17:35:26Z", "author": {"login": "rebello95"}, "path": "library/java/test/io/envoyproxy/envoymobile/engine/EnvoyConfigurationTest.kt", "diffHunk": "@@ -18,20 +21,22 @@ class EnvoyConfigurationTest {\n \n   @Test\n   fun `resolving with default configuration resolves with values`() {\n-    val envoyConfiguration = EnvoyConfiguration(\"stats.foo.com\", 123, 234, 345)\n+    val envoyConfiguration = EnvoyConfiguration(\"stats.foo.com\", 123, 234, 345, 456, 567)\n \n     val resolvedTemplate = envoyConfiguration.resolveTemplate(TEST_CONFIG)\n     assertThat(resolvedTemplate).contains(\"stats_domain: stats.foo.com\")\n     assertThat(resolvedTemplate).contains(\"connect_timeout: 123s\")\n     assertThat(resolvedTemplate).contains(\"dns_refresh_rate: 234s\")\n-    assertThat(resolvedTemplate).contains(\"stats_flush_interval: 345s\")\n+    assertThat(resolvedTemplate).contains(\"base_interval: 345\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU0MTMzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                assertThat(resolvedTemplate).contains(\"max_interval: 456\")\n          \n          \n            \n                assertThat(resolvedTemplate).contains(\"max_interval: 456s\")", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#discussion_r386541334", "createdAt": "2020-03-02T17:35:32Z", "author": {"login": "rebello95"}, "path": "library/java/test/io/envoyproxy/envoymobile/engine/EnvoyConfigurationTest.kt", "diffHunk": "@@ -18,20 +21,22 @@ class EnvoyConfigurationTest {\n \n   @Test\n   fun `resolving with default configuration resolves with values`() {\n-    val envoyConfiguration = EnvoyConfiguration(\"stats.foo.com\", 123, 234, 345)\n+    val envoyConfiguration = EnvoyConfiguration(\"stats.foo.com\", 123, 234, 345, 456, 567)\n \n     val resolvedTemplate = envoyConfiguration.resolveTemplate(TEST_CONFIG)\n     assertThat(resolvedTemplate).contains(\"stats_domain: stats.foo.com\")\n     assertThat(resolvedTemplate).contains(\"connect_timeout: 123s\")\n     assertThat(resolvedTemplate).contains(\"dns_refresh_rate: 234s\")\n-    assertThat(resolvedTemplate).contains(\"stats_flush_interval: 345s\")\n+    assertThat(resolvedTemplate).contains(\"base_interval: 345\")\n+    assertThat(resolvedTemplate).contains(\"max_interval: 456\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f4f09bcb120bb44adc8ad69b840761413d5630e", "author": {"user": {"login": "rebello95", "name": "Michael Rebello"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/1f4f09bcb120bb44adc8ad69b840761413d5630e", "committedDate": "2020-03-02T17:38:23Z", "message": "fixups\n\nSigned-off-by: Michael Rebello <me@michaelrebello.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3MzkyMTc1", "url": "https://github.com/envoyproxy/envoy-mobile/pull/714#pullrequestreview-367392175", "createdAt": "2020-03-02T17:38:35Z", "commit": {"oid": "95fd2c78ace3c598716cb0319da968ace999a2ae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4299, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}