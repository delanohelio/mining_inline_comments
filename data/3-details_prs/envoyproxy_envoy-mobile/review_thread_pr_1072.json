{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5MDcxMTcw", "number": 1072, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyMDoyMVrOEiUyag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyMDo0OFrOEiUy1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDI3NjI2OnYy", "diffSide": "RIGHT", "path": "library/common/extensions/filters/http/assertion/filter.cc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyMDoyMVrOHQI7lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyMDoyMVrOHQI7lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY4NTU5MA==", "bodyText": "same misspell as #1071", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1072#discussion_r486685590", "createdAt": "2020-09-10T23:20:21Z", "author": {"login": "junr03"}, "path": "library/common/extensions/filters/http/assertion/filter.cc", "diffHunk": "@@ -133,6 +135,111 @@ Http::FilterTrailersStatus AssertionFilter::decodeTrailers(Http::RequestTrailerM\n   return Http::FilterTrailersStatus::Continue;\n }\n \n+Http::FilterHeadersStatus AssertionFilter::encodeHeaders(Http::ResponseHeaderMap& headers,\n+                                                         bool end_stream) {\n+  config_->rootMatcher().onHttpResponseHeaders(headers, statuses_);\n+  auto& match_status = config_->rootMatcher().matchStatus(statuses_);\n+  if (!match_status.matches_ && !match_status.might_change_status_) {\n+    decoder_callbacks_->sendLocalReply(Http::Code::InternalServerError,\n+                                       \"Response Headers do not match configured expectations\",\n+                                       nullptr, absl::nullopt, \"\");\n+    return Http::FilterHeadersStatus::StopIteration;\n+  }\n+\n+  if (end_stream) {\n+    // Check if there are unsatisfied assertions about stream data.\n+    Buffer::OwnedImpl empty_buffer;\n+    config_->rootMatcher().onResponseBody(empty_buffer, statuses_);\n+    auto& match_status = config_->rootMatcher().matchStatus(statuses_);\n+    if (!match_status.matches_ && !match_status.might_change_status_) {\n+      decoder_callbacks_->sendLocalReply(Http::Code::InternalServerError,\n+                                         \"Response Body does not match configured expectations\",\n+                                         nullptr, absl::nullopt, \"\");\n+      return Http::FilterHeadersStatus::StopIteration;\n+    }\n+\n+    // Check of there are unsatisfied assertions about stream trailers.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e85776cdff2ce64b9414e82fac33087f24255df5"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDI3NzMyOnYy", "diffSide": "RIGHT", "path": "test/common/extensions/filters/http/assertion/assertion_filter_test.cc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyMDo0OFrOHQI8NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyNjo1NlrOHQJDtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY4NTc0OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            // DIVIDE\n          \n          \n            \n            // Response Pathway\n          \n      \n    \n    \n  \n\n?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1072#discussion_r486685748", "createdAt": "2020-09-10T23:20:48Z", "author": {"login": "junr03"}, "path": "test/common/extensions/filters/http/assertion/assertion_filter_test.cc", "diffHunk": "@@ -263,6 +263,240 @@ TEST_F(AssertionFilterTest, RequestTrailersNoMatch) {\n   EXPECT_EQ(Http::FilterTrailersStatus::StopIteration, filter_->decodeTrailers(request_trailers));\n }\n \n+// DIVIDE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e85776cdff2ce64b9414e82fac33087f24255df5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY4NzY2OA==", "bodyText": "haha this was for jumping back to here in vim", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1072#discussion_r486687668", "createdAt": "2020-09-10T23:26:56Z", "author": {"login": "goaway"}, "path": "test/common/extensions/filters/http/assertion/assertion_filter_test.cc", "diffHunk": "@@ -263,6 +263,240 @@ TEST_F(AssertionFilterTest, RequestTrailersNoMatch) {\n   EXPECT_EQ(Http::FilterTrailersStatus::StopIteration, filter_->decodeTrailers(request_trailers));\n }\n \n+// DIVIDE", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY4NTc0OA=="}, "originalCommit": {"oid": "e85776cdff2ce64b9414e82fac33087f24255df5"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 606, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}