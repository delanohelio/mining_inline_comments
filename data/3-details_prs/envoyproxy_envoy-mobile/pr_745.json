{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1ODg3NDMx", "number": 745, "title": "docs: add docs on `EnvoyClientBuilder`", "bodyText": "Resolves #715.\nSigned-off-by: Michael Rebello me@michaelrebello.com", "createdAt": "2020-03-10T01:08:54Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/745", "merged": true, "mergeCommit": {"oid": "917186e6cd080880106b9b2e0bf06d741bbb800e"}, "closed": true, "closedAt": "2020-03-10T01:15:29Z", "author": {"login": "rebello95"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMH8pUgH2gAyMzg1ODg3NDMxOmUyMWJiMjhlNTZiNmNmMDNkYzJlMTViMDQxOThjMjllODk3MjA3YWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMIAtFgFqTM3MTYyNDEwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e21bb28e56b6cf03dc2e15b04198c29e897207aa", "author": {"user": {"login": "rebello95", "name": "Michael Rebello"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/e21bb28e56b6cf03dc2e15b04198c29e897207aa", "committedDate": "2020-03-10T01:08:45Z", "message": "docs: add docs on `EnvoyClientBuilder`\n\nResolves https://github.com/lyft/envoy-mobile/issues/715.\n\nSigned-off-by: Michael Rebello <me@michaelrebello.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjIzNTQ2", "url": "https://github.com/envoyproxy/envoy-mobile/pull/745#pullrequestreview-371623546", "createdAt": "2020-03-10T01:11:08Z", "commit": {"oid": "e21bb28e56b6cf03dc2e15b04198c29e897207aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMToxMTowOVrOFz-WwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQwMToxMTowOVrOFz-WwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA0MzMyOA==", "bodyText": "Just a nit: it would make more sense if it was something like https://envoyproxy.envoy-mobile.io?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/745#discussion_r390043328", "createdAt": "2020-03-10T01:11:09Z", "author": {"login": "buildbreaker"}, "path": "docs/root/api/starting_envoy.rst", "diffHunk": "@@ -10,29 +10,130 @@ Starting Envoy\n Starting an instance of Envoy Mobile for making requests is done by creating an ``EnvoyClient``,\n which conforms to the ``HTTPClient`` interface.\n \n-To do so, create an ``EnvoyClientBuilder`` and call ``build()``.\n+To do so, create an ``EnvoyClientBuilder`` and call ``build()`` (see below).\n \n-This builder exposes some of Envoy's configuration options programmatically using builder\n-functions, some of which are demonstrated below:\n+After the client is created, it should be stored and kept in memory in order to be used\n+for issuing requests.\n \n **Kotlin example**::\n \n-  val envoy = AndroidEnvoyClientBuilder(baseContext)\n+  val envoy = AndroidEnvoyClientBuilder(getApplication())\n     .addLogLevel(LogLevel.WARN)\n-    .addStatsFlushSeconds(60)\n     ...\n     .build()\n \n **Swift example**::\n \n   let envoy = try EnvoyClientBuilder()\n     .addLogLevel(.warn)\n-    .addStatsFlushSeconds(60)\n     ...\n     .build()\n \n-After the client is created, it should be stored and kept in memory in order to be used\n-for issuing requests.\n+----------------------\n+``EnvoyClientBuilder``\n+----------------------\n+\n+This type is used to configure an instance of ``EnvoyClient`` before finally\n+creating the client using ``.build()``.\n+\n+Available builders are 1:1 between iOS/Android, and are documented below.\n+\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+``addConnectTimeoutSeconds``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Specify the timeout for new network connections to hosts in Envoy Mobile clusters.\n+\n+**Example**::\n+\n+  // Kotlin\n+  builder.addConnectTimeoutSeconds(30L)\n+\n+  // Swift\n+  builder.addConnectTimeoutSeconds(30)\n+\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+``addDNSFailureRefreshSeconds``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Specify the rate at which Envoy Mobile should refresh DNS in states of failure.\n+\n+This should typically be a relatively aggressive range compared to the standard-state DNS refresh\n+rate, as it is required for Envoy Mobile to recover and continue making requests.\n+\n+**Example**::\n+\n+  // Kotlin\n+  builder.addDNSFailureRefreshSeconds(2, 5)\n+\n+  // Swift\n+  builder.addDNSFailureRefreshSeconds(base: 2, max: 5)\n+\n+~~~~~~~~~~~~~~~~~~~~~~~~\n+``addDNSRefreshSeconds``\n+~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Specify the interval at which Envoy should forcefully refresh DNS.\n+\n+**Example**::\n+\n+  // Kotlin\n+  builder.addDNSRefreshSeconds(60L)\n+\n+  // Swift\n+  builder.addDNSRefreshSeconds(60)\n+\n+~~~~~~~~~~~~~~~\n+``addLogLevel``\n+~~~~~~~~~~~~~~~\n+\n+Specify the log level to be used when running the underlying Envoy engine.\n+\n+**Example**::\n+\n+  // Kotlin\n+  builder.addLogLevel(LogLevel.WARN)\n+\n+  // Swift\n+  builder.addLogLevel(.warn)\n+\n+~~~~~~~~~~~~~~~~~~\n+``addStatsDomain``\n+~~~~~~~~~~~~~~~~~~\n+\n+Specify a domain which implements the\n+:tree:`stats endpoint <83908423d46a37574e9a35627df1f3dd9634e5ec/library/common/config_template.cc#L139-L145>`\n+in order to take advantage of the\n+`stats emitted by Envoy <https://www.envoyproxy.io/docs/envoy/latest/configuration/upstream/cluster_manager/cluster_stats>`_\n+(and subsequently Envoy Mobile).\n+\n+Note that only stats specified in the configuration's\n+:tree:`whitelist <83908423d46a37574e9a35627df1f3dd9634e5ec/library/common/config_template.cc#L146-L167>`\n+will be emitted.\n+\n+**Example**::\n+\n+  // Kotlin\n+  builder.addStatsDomain(\"io.envoyproxy.envoy-mobile\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21bb28e56b6cf03dc2e15b04198c29e897207aa"}, "originalPosition": 116}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjIzNjg0", "url": "https://github.com/envoyproxy/envoy-mobile/pull/745#pullrequestreview-371623684", "createdAt": "2020-03-10T01:11:35Z", "commit": {"oid": "e21bb28e56b6cf03dc2e15b04198c29e897207aa"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56255c6f2571d079221e973894471c5942677c68", "author": {"user": {"login": "rebello95", "name": "Michael Rebello"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/56255c6f2571d079221e973894471c5942677c68", "committedDate": "2020-03-10T01:12:10Z", "message": "CR\n\nSigned-off-by: Michael Rebello <me@michaelrebello.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxNjI0MTA5", "url": "https://github.com/envoyproxy/envoy-mobile/pull/745#pullrequestreview-371624109", "createdAt": "2020-03-10T01:13:11Z", "commit": {"oid": "56255c6f2571d079221e973894471c5942677c68"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4309, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}