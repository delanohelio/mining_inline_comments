{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwOTQ4NzEy", "number": 1183, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQyMToxNjozNVrOFSEAWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQyMToxODoxOVrOFVY--A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzU0NDg0MzE0OnYy", "diffSide": "RIGHT", "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQyMToxNjozNVrOIY1oVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yM1QwMjoxNTozOVrOIY69NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjkxNTQxMw==", "bodyText": "nit: I would make this field 2.\nAlso lets document what this field is for.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r562915413", "createdAt": "2021-01-22T21:16:35Z", "author": {"login": "junr03"}, "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "diffHunk": "@@ -0,0 +1,34 @@\n+syntax = \"proto3\";\n+\n+package envoymobile.extensions.stat_sinks.metrics_service;\n+\n+import \"envoy/config/core/v3/base.proto\";\n+import \"metrics.proto\";\n+import \"validate/validate.proto\";\n+\n+service EnvoyMobileMetricsService {\n+  rpc EnvoyMobileStreamMetrics(stream EnvoyMobileStreamMetricsMessage)\n+      returns (stream EnvoyMobileStreamMetricsResponse) {\n+  }\n+}\n+\n+message EnvoyMobileStreamMetricsResponse {\n+  string batch_id = 1;\n+}\n+\n+message EnvoyMobileStreamMetricsMessage {\n+\n+  message Identifier {\n+    // The node sending metrics over the stream.\n+    envoy.config.core.v3.Node node = 1 [(validate.rules).message = {required: true}];\n+  }\n+\n+  // Identifier data effectively is a structured metadata. As a performance optimization this will\n+  // only be sent in the first message on the stream.\n+  Identifier identifier = 1;\n+\n+  // A list of metric entries\n+  repeated io.prometheus.client.MetricFamily envoy_metrics = 2;\n+\n+  string batch_id = 3;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166577c9661ecf7adaec5146f41e5bf7a28dff2d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2Mjk4MTc4MA==", "bodyText": "you mean\nstring batch_id = 2;\nrepeated io.prometheus.client.MetricFamily envoy_metrics = 3;\n\n?\n\ud83d\udc4c on documentation", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r562981780", "createdAt": "2021-01-23T00:14:37Z", "author": {"login": "jingwei99"}, "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "diffHunk": "@@ -0,0 +1,34 @@\n+syntax = \"proto3\";\n+\n+package envoymobile.extensions.stat_sinks.metrics_service;\n+\n+import \"envoy/config/core/v3/base.proto\";\n+import \"metrics.proto\";\n+import \"validate/validate.proto\";\n+\n+service EnvoyMobileMetricsService {\n+  rpc EnvoyMobileStreamMetrics(stream EnvoyMobileStreamMetricsMessage)\n+      returns (stream EnvoyMobileStreamMetricsResponse) {\n+  }\n+}\n+\n+message EnvoyMobileStreamMetricsResponse {\n+  string batch_id = 1;\n+}\n+\n+message EnvoyMobileStreamMetricsMessage {\n+\n+  message Identifier {\n+    // The node sending metrics over the stream.\n+    envoy.config.core.v3.Node node = 1 [(validate.rules).message = {required: true}];\n+  }\n+\n+  // Identifier data effectively is a structured metadata. As a performance optimization this will\n+  // only be sent in the first message on the stream.\n+  Identifier identifier = 1;\n+\n+  // A list of metric entries\n+  repeated io.prometheus.client.MetricFamily envoy_metrics = 2;\n+\n+  string batch_id = 3;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjkxNTQxMw=="}, "originalCommit": {"oid": "166577c9661ecf7adaec5146f41e5bf7a28dff2d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzAwMjY3Nw==", "bodyText": "Yes", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r563002677", "createdAt": "2021-01-23T02:15:39Z", "author": {"login": "junr03"}, "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "diffHunk": "@@ -0,0 +1,34 @@\n+syntax = \"proto3\";\n+\n+package envoymobile.extensions.stat_sinks.metrics_service;\n+\n+import \"envoy/config/core/v3/base.proto\";\n+import \"metrics.proto\";\n+import \"validate/validate.proto\";\n+\n+service EnvoyMobileMetricsService {\n+  rpc EnvoyMobileStreamMetrics(stream EnvoyMobileStreamMetricsMessage)\n+      returns (stream EnvoyMobileStreamMetricsResponse) {\n+  }\n+}\n+\n+message EnvoyMobileStreamMetricsResponse {\n+  string batch_id = 1;\n+}\n+\n+message EnvoyMobileStreamMetricsMessage {\n+\n+  message Identifier {\n+    // The node sending metrics over the stream.\n+    envoy.config.core.v3.Node node = 1 [(validate.rules).message = {required: true}];\n+  }\n+\n+  // Identifier data effectively is a structured metadata. As a performance optimization this will\n+  // only be sent in the first message on the stream.\n+  Identifier identifier = 1;\n+\n+  // A list of metric entries\n+  repeated io.prometheus.client.MetricFamily envoy_metrics = 2;\n+\n+  string batch_id = 3;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjkxNTQxMw=="}, "originalCommit": {"oid": "166577c9661ecf7adaec5146f41e5bf7a28dff2d"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzU0NDg0ODQyOnYy", "diffSide": "RIGHT", "path": "library/common/config_template.cc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQyMToxODowNFrOIY1rZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMlQyMToxODowNFrOIY1rZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjkxNjE5Ng==", "bodyText": "I am going to put up a PR today to reduce some of the stats we are emitting (and no longer need), as this config effectively doubles the amount of stats emitted", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r562916196", "createdAt": "2021-01-22T21:18:04Z", "author": {"login": "junr03"}, "path": "library/common/config_template.cc", "diffHunk": "@@ -207,6 +207,13 @@ stats_flush_interval: {{ stats_flush_interval_seconds }}s\n       grpc_service:\n         envoy_grpc:\n           cluster_name: stats\n+  - name: envoy.stat_sinks.metrics_service.mobile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166577c9661ecf7adaec5146f41e5bf7a28dff2d"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzU3OTczNjkxOnYy", "diffSide": "RIGHT", "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQyMToxODowN1rOId03Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQyMToxODowN1rOId03Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODE0NTc0Mw==", "bodyText": "comment", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r568145743", "createdAt": "2021-02-01T21:18:07Z", "author": {"login": "junr03"}, "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "diffHunk": "@@ -0,0 +1,35 @@\n+syntax = \"proto3\";\n+\n+package envoymobile.extensions.stat_sinks.metrics_service;\n+\n+import \"envoy/config/core/v3/base.proto\";\n+import \"metrics.proto\";\n+import \"validate/validate.proto\";\n+\n+service EnvoyMobileMetricsService {\n+  rpc EnvoyMobileStreamMetrics(stream EnvoyMobileStreamMetricsMessage)\n+      returns (stream EnvoyMobileStreamMetricsResponse) {\n+  }\n+}\n+\n+message EnvoyMobileStreamMetricsResponse {\n+  string batch_id = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00370f14cda8f6054c38b2f85ad94ed623ec8863"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzU3OTczNzUyOnYy", "diffSide": "RIGHT", "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQyMToxODoxOVrOId03tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMVQyMToxODoxOVrOId03tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODE0NTg0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              // Identifier for the current envoy_metrics batch\n          \n          \n            \n              // Identifier for the current envoy_metrics batch.\n          \n      \n    \n    \n  \n\nSame below.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1183#discussion_r568145845", "createdAt": "2021-02-01T21:18:19Z", "author": {"login": "junr03"}, "path": "library/common/extensions/stat_sinks/metrics_service/service.proto", "diffHunk": "@@ -0,0 +1,35 @@\n+syntax = \"proto3\";\n+\n+package envoymobile.extensions.stat_sinks.metrics_service;\n+\n+import \"envoy/config/core/v3/base.proto\";\n+import \"metrics.proto\";\n+import \"validate/validate.proto\";\n+\n+service EnvoyMobileMetricsService {\n+  rpc EnvoyMobileStreamMetrics(stream EnvoyMobileStreamMetricsMessage)\n+      returns (stream EnvoyMobileStreamMetricsResponse) {\n+  }\n+}\n+\n+message EnvoyMobileStreamMetricsResponse {\n+  string batch_id = 1;\n+}\n+\n+message EnvoyMobileStreamMetricsMessage {\n+\n+  message Identifier {\n+    // The node sending metrics over the stream.\n+    envoy.config.core.v3.Node node = 1 [(validate.rules).message = {required: true}];\n+  }\n+\n+  // Identifier data effectively is a structured metadata. As a performance optimization this will\n+  // only be sent in the first message on the stream.\n+  Identifier identifier = 1;\n+\n+  // Identifier for the current envoy_metrics batch", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00370f14cda8f6054c38b2f85ad94ed623ec8863"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 515, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}