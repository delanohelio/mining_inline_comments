{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNjkyOTE2", "number": 1214, "title": "Expose histogram envoy stats methods to interface & engines", "bodyText": "Description: Expose the histogram stat in envoy/include/envoy/stats/ to envoy-mobile engine. This will be leveraged in subsequent PRs to support a new set of stats collection in the iOS and Android layers.\nRisk Level: Medium (due to changes in the core engine impl, but should be Low given no one depends on these APIs yet)\nTesting: Unit tests, CI, Build Envoy Mobile Library and compile into mobile apps to ensure that changes do not break the build.\nDocs Changes: Done in https://github.com/envoyproxy/envoy-mobile/blob/main/docs/root/api/stats.rst\nRelease Notes:\nExpose histogram as a stat exposed via Pulse", "createdAt": "2020-12-18T18:00:04Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214", "merged": true, "mergeCommit": {"oid": "875a456d2b1256fc2f201c7f7b9bd23df3afe65c"}, "closed": true, "closedAt": "2021-02-06T04:34:04Z", "author": {"login": "donyu"}, "timelineItems": {"totalCount": 45, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdncDpAAFqTU1NTY5OTc3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABd3Wcx6gFqTU4NDgyMjA4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1Njk5Nzc4", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-555699778", "createdAt": "2020-12-18T18:01:36Z", "commit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowMTozNlrOIItEmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowMTozNlrOIItEmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk5Nzk3OA==", "bodyText": "Why don't we use the *FromStatNames methods in utility.h? I see that we are passing a dynamic name, but I'm not sure why it needs to be a dynamic name.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r545997978", "createdAt": "2020-12-18T18:01:36Z", "author": {"login": "donyu"}, "path": "library/common/engine.cc", "diffHunk": "@@ -154,6 +154,19 @@ envoy_status_t Engine::recordGaugeSub(const std::string& elements, uint64_t amou\n   return ENVOY_FAILURE;\n }\n \n+envoy_status_t Engine::recordHistogramDurationMs(const std::string& elements, uint64_t amount) {\n+  if (server_ && client_scope_) {\n+    std::string name = Stats::Utility::sanitizeStatsName(elements);\n+    server_->dispatcher().post([this, name, amount]() -> void {\n+      Stats::Utility::histogramFromElements(*client_scope_, {Stats::DynamicName(name)},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NzAxMzM2", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-555701336", "createdAt": "2020-12-18T18:04:08Z", "commit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowNDowOFrOIItJTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowNDowOFrOIItJTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk5OTE4Mg==", "bodyText": "Put this down as a DurationMs since it's the most common use case I see on the mobile side, but I'm going to move this to an enum so clients can record any unit values e.g. bytes/ms/us", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r545999182", "createdAt": "2020-12-18T18:04:08Z", "author": {"login": "donyu"}, "path": "library/common/engine.h", "diffHunk": "@@ -63,6 +63,13 @@ class Engine {\n    */\n   envoy_status_t recordGaugeSub(const std::string& elements, uint64_t amount);\n \n+  /**\n+   * Record a value for the histogram with the given string of elements\n+   * @param elements, joined elements of the timeseries.\n+   * @param amount, amount to add to the aggregated pool of events for quantile calculations\n+   */\n+  envoy_status_t recordHistogramDurationMs(const std::string& elements, uint64_t amount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NzAyMDI1", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-555702025", "createdAt": "2020-12-18T18:05:13Z", "commit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowNToxNFrOIItLOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODowNToxNFrOIItLOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk5OTY3NA==", "bodyText": "This is then called in jni_interface.cc for Android clients.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r545999674", "createdAt": "2020-12-18T18:05:14Z", "author": {"login": "donyu"}, "path": "library/common/main_interface.h", "diffHunk": "@@ -133,6 +133,15 @@ envoy_status_t record_gauge_add(envoy_engine_t engine, const char* elements, uin\n  * @param amount, amount to subtract from the gauge.\n  */\n envoy_status_t record_gauge_sub(envoy_engine_t engine, const char* elements, uint64_t amount);\n+\n+/**\n+ * Add another recorded amount to the histogram with the given string of elements.\n+ * @param engine, the engine that owns the histogram.\n+ * @param elements, the string that identifies the histogram to subtract from.\n+ * @param amount, amount to record as a new value for the histogram.\n+ */\n+envoy_status_t record_histogram_duration_ms(envoy_engine_t engine, const char* elements, uint64_t amount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NzA2NTkz", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-555706593", "createdAt": "2020-12-18T18:12:22Z", "commit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODoxMjoyM1rOIItZuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODoxMjoyM1rOIItZuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAwMzM4Nw==", "bodyText": "This will be used in a follow-up PR for the actual interface that clients will use to record histogram stats.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r546003387", "createdAt": "2020-12-18T18:12:23Z", "author": {"login": "donyu"}, "path": "library/java/src/io/envoyproxy/envoymobile/engine/AndroidEngineImpl.java", "diffHunk": "@@ -60,6 +60,16 @@ public int recordGaugeSub(String elements, int amount) {\n     return envoyEngine.recordGaugeSub(elements, amount);\n   }\n \n+  @Override\n+  public int recordGaugeSub(String elements, int amount) {\n+    return envoyEngine.recordGaugeSub(elements, amount);\n+  }\n+\n+  @Override\n+  public int recordHistogramDurationMs(String elements, int duration) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db7f194adeb52375b3e8e005935c057d9ee4cf1c"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NzMzNjI1", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-555733625", "createdAt": "2020-12-18T18:52:01Z", "commit": {"oid": "80940c253314baddabef2037c58e414fca4e520f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODo1MjowMVrOIIuuWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxODo1MjowMVrOIIuuWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAyNTA0OQ==", "bodyText": "This is the only method exposed in histogram.h and all we really need to assign more values to the collection of data points in the histogram.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r546025049", "createdAt": "2020-12-18T18:52:01Z", "author": {"login": "donyu"}, "path": "library/common/engine.cc", "diffHunk": "@@ -154,6 +154,19 @@ envoy_status_t Engine::recordGaugeSub(const std::string& elements, uint64_t amou\n   return ENVOY_FAILURE;\n }\n \n+envoy_status_t Engine::recordHistogramDurationMs(const std::string& elements, uint64_t amount) {\n+  if (server_ && client_scope_) {\n+    std::string name = Stats::Utility::sanitizeStatsName(elements);\n+    server_->dispatcher().post([this, name, amount]() -> void {\n+      Stats::Utility::histogramFromElements(*client_scope_, {Stats::DynamicName(name)},\n+                                        Histogram::Unit::Milliseconds)\n+          .recordValue(amount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80940c253314baddabef2037c58e414fca4e520f"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d60d701b0a05da52449b2d107e09ff3df6f9c7a3", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/d60d701b0a05da52449b2d107e09ff3df6f9c7a3", "committedDate": "2021-01-15T19:18:21Z", "message": "Incorporate different unit measurements for histogram"}, "afterCommit": {"oid": "07b5c07b4174ede4d013ae22cb97bc7e328fb43b", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/07b5c07b4174ede4d013ae22cb97bc7e328fb43b", "committedDate": "2021-01-22T17:50:03Z", "message": "update interfaces again to separate timer and generic"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e80b342700d0ed16907e9a346e56bfcd9bdc3bde", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/e80b342700d0ed16907e9a346e56bfcd9bdc3bde", "committedDate": "2021-01-27T00:28:51Z", "message": "uncommit temp bazel change"}, "afterCommit": {"oid": "6a8e0e8891a989bc2af960544c617a21e5482635", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/6a8e0e8891a989bc2af960544c617a21e5482635", "committedDate": "2021-01-27T00:29:02Z", "message": "uncommit temp bazel change"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12379eda590d6174a61bba6118732bc5c2e75ff5", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/12379eda590d6174a61bba6118732bc5c2e75ff5", "committedDate": "2021-01-27T18:16:38Z", "message": "kotlin and swift lint"}, "afterCommit": {"oid": "47f6deff7656bb630a57491ce2cf401ccd73d7e6", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/47f6deff7656bb630a57491ce2cf401ccd73d7e6", "committedDate": "2021-01-27T18:26:20Z", "message": "kotlin and swift lint\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1eaf83a14dbd4f4be26d4065ccdb8da763ca182", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/f1eaf83a14dbd4f4be26d4065ccdb8da763ca182", "committedDate": "2021-01-27T20:33:02Z", "message": "fix ordinal"}, "afterCommit": {"oid": "c8ce6d04ebf621add913fe51bc4d0a9743efc10b", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c8ce6d04ebf621add913fe51bc4d0a9743efc10b", "committedDate": "2021-01-27T21:11:43Z", "message": "fix ordinal\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgxODA0NzA5", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-581804709", "createdAt": "2021-02-02T21:50:33Z", "commit": {"oid": "c8ce6d04ebf621add913fe51bc4d0a9743efc10b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMTo1MDozM1rOIemRiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMTo1MDozM1rOIemRiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODk1NTI3Mw==", "bodyText": "+1 to APIs", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r568955273", "createdAt": "2021-02-02T21:50:33Z", "author": {"login": "jingwei99"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/PulseClient.kt", "diffHunk": "@@ -15,4 +15,10 @@ interface PulseClient {\n \n   /** @return A gauge based on the joined elements. */\n   fun gauge(vararg elements: Element): Gauge\n+\n+  /** @return A histogram based on the joined elements that can be used as a timer. */\n+  fun histogramTimer(vararg elements: Element): Histogram\n+\n+  /** @return A histogram based on the joined elements that tracks an unspecified unit measure */\n+  fun histogramGeneric(vararg elements: Element): Histogram", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8ce6d04ebf621add913fe51bc4d0a9743efc10b"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8ce6d04ebf621add913fe51bc4d0a9743efc10b", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c8ce6d04ebf621add913fe51bc4d0a9743efc10b", "committedDate": "2021-01-27T21:11:43Z", "message": "fix ordinal\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}, "afterCommit": {"oid": "cf64ce10ea17c7b7319cee5780e53089f0440706", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/cf64ce10ea17c7b7319cee5780e53089f0440706", "committedDate": "2021-02-02T21:53:57Z", "message": "fix ordinal\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgxODA5MjE3", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-581809217", "createdAt": "2021-02-02T21:57:18Z", "commit": {"oid": "cf64ce10ea17c7b7319cee5780e53089f0440706"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMTo1NzoxOFrOIemgKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMTo1NzoxOFrOIemgKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODk1OTAxNg==", "bodyText": "it's probably worth documenting (as a comment in this pr) the reason of pushing HistogramUnit enum to this layer (instead of keeping in below jni)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r568959016", "createdAt": "2021-02-02T21:57:18Z", "author": {"login": "jingwei99"}, "path": "library/java/src/io/envoyproxy/envoymobile/engine/EnvoyEngine.java", "diffHunk": "@@ -72,5 +73,15 @@ int runWithConfig(EnvoyConfiguration envoyConfiguration, String logLevel,\n    */\n   int recordGaugeSub(String elements, int amount);\n \n+  /**\n+   * Add another recorded amount to the histogram with the given string of elements.\n+   *\n+   * @param elements Elements of the histogram stat.\n+   * @param value Amount to record as a new value for the histogram distribution.\n+   * @param unitMeasure the unit of measurement (e.g. milliseconds, bytes, etc.)\n+   * @return A status indicating if the action was successful.\n+   */\n+  int recordHistogramValue(String elements, int value, HistogramUnit unitMeasure);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf64ce10ea17c7b7319cee5780e53089f0440706"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgxODE1NDIz", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-581815423", "createdAt": "2021-02-02T22:06:38Z", "commit": {"oid": "cf64ce10ea17c7b7319cee5780e53089f0440706"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMjowNjozOFrOIemzdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQyMjowNjozOFrOIemzdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODk2Mzk1OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              /** @return A histogram based on the joined elements that tracks an unspecified unit measure */\n          \n          \n            \n            /** @return A histogram based on the joined elements that tracks generic value */", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r568963959", "createdAt": "2021-02-02T22:06:38Z", "author": {"login": "jingwei99"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/PulseClient.kt", "diffHunk": "@@ -15,4 +15,10 @@ interface PulseClient {\n \n   /** @return A gauge based on the joined elements. */\n   fun gauge(vararg elements: Element): Gauge\n+\n+  /** @return A histogram based on the joined elements that can be used as a timer. */\n+  fun histogramTimer(vararg elements: Element): Histogram\n+\n+  /** @return A histogram based on the joined elements that tracks an unspecified unit measure */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf64ce10ea17c7b7319cee5780e53089f0440706"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "40ecb419393f1d8e61387ff6ec3dc2a3cf23e152", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/40ecb419393f1d8e61387ff6ec3dc2a3cf23e152", "committedDate": "2021-02-05T16:51:20Z", "message": "create elements string in constructor + update examples"}, "afterCommit": {"oid": "5b93771bbdd82cea92acc0811a218108a5f3a5d2", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/5b93771bbdd82cea92acc0811a218108a5f3a5d2", "committedDate": "2021-02-05T17:15:09Z", "message": "create elements string in constructor + update examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b93771bbdd82cea92acc0811a218108a5f3a5d2", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/5b93771bbdd82cea92acc0811a218108a5f3a5d2", "committedDate": "2021-02-05T17:15:09Z", "message": "create elements string in constructor + update examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}, "afterCommit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/8f3f5f8f5933f7e225f1a4bbbbf33976a102044c", "committedDate": "2021-02-05T17:32:05Z", "message": "create elements string in constructor + update examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg0NTkwNjIz", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-584590623", "createdAt": "2021-02-05T18:17:36Z", "commit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg0NTkzNzky", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-584593792", "createdAt": "2021-02-05T18:20:32Z", "commit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNVQxODoyMDozMlrOIgs_Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNVQxODoyMDozMlrOIgs_Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTE2MjM3OQ==", "bodyText": "nit: I'd called this Distribution.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r571162379", "createdAt": "2021-02-05T18:20:32Z", "author": {"login": "goaway"}, "path": "docs/root/api/stats.rst", "diffHunk": "@@ -82,3 +82,33 @@ The value of a ``Gauge`` can be incremented, decremented, or reassigned.\n \n   // Swift\n   gauge.sub(amount: 5)\n+\n+---------\n+``Timer``\n+---------\n+Use ``Timer`` to track a distribution of time durations.\n+You can view the cumulative stats like quantile data (p50/p90/etc.) and average durations.\n+\n+**Example**::\n+\n+  // Add a new duration to the underlying timer distribution\n+  // Kotlin\n+  timer.recordDuration(5)\n+\n+  // Swift\n+  timer.recordDuration(durationMs: 5)\n+\n+-------------\n+``Histogram``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg0NTk4Mjg5", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-584598289", "createdAt": "2021-02-05T18:26:51Z", "commit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNVQxODoyNjo1MlrOIgtMXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNVQxODoyNjo1MlrOIgtMXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTE2NTc4OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              envoy_status_t recordHistogramValue(const std::string& elements, uint64_t value,\n          \n          \n            \n              envoy_status_t recordDistributionValue(const std::string& elements, uint64_t value,", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#discussion_r571165789", "createdAt": "2021-02-05T18:26:52Z", "author": {"login": "goaway"}, "path": "library/common/engine.h", "diffHunk": "@@ -63,6 +63,15 @@ class Engine {\n    */\n   envoy_status_t recordGaugeSub(const std::string& elements, uint64_t amount);\n \n+  /**\n+   * Record a value for the histogram with the given string of elements and unit measurement\n+   * @param elements, joined elements of the timeseries.\n+   * @param value, value to add to the aggregated distribution of values for quantile calculations\n+   * @param unit_measure, the unit of measurement (e.g. milliseconds, bytes, etc.)\n+   */\n+  envoy_status_t recordHistogramValue(const std::string& elements, uint64_t value,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f3f5f8f5933f7e225f1a4bbbbf33976a102044c"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "444c7beaf6d12c69b81e6c7c232a29c53385b284", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/444c7beaf6d12c69b81e6c7c232a29c53385b284", "committedDate": "2021-02-05T22:08:32Z", "message": "fix examples"}, "afterCommit": {"oid": "1cba1767a8ffef5d50ef2a534e249f93b8d5b442", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/1cba1767a8ffef5d50ef2a534e249f93b8d5b442", "committedDate": "2021-02-05T22:09:28Z", "message": "fix examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce424fda4525b69e26ee60bed1fe3bdafdaee235", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/ce424fda4525b69e26ee60bed1fe3bdafdaee235", "committedDate": "2021-02-06T00:27:30Z", "message": "rename Histogram public api to Distribution\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}, "afterCommit": {"oid": "743486b67a9b35b823655ca751981530fdb08c1f", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/743486b67a9b35b823655ca751981530fdb08c1f", "committedDate": "2021-02-06T00:34:57Z", "message": "rename Histogram public api to Distribution\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f2d4af632bc9d8bc695266f69f51c7786ad9f4", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/d4f2d4af632bc9d8bc695266f69f51c7786ad9f4", "committedDate": "2021-02-06T02:50:02Z", "message": "[WIP] Expose histogram envoy stats to mobile clients\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bba4ec51ff54bf00ddc7a73cfdbdf36a4e5b0a8e", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/bba4ec51ff54bf00ddc7a73cfdbdf36a4e5b0a8e", "committedDate": "2021-02-06T02:50:02Z", "message": "stats bridge for Android\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4eab8887bfc6c10c11fec8ee4bd484edac710333", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/4eab8887bfc6c10c11fec8ee4bd484edac710333", "committedDate": "2021-02-06T02:50:02Z", "message": "also bridge to objective-c/swift\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "623ec2ffe55c6c9b24db517588efb92ac3e1b8f6", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/623ec2ffe55c6c9b24db517588efb92ac3e1b8f6", "committedDate": "2021-02-06T02:50:02Z", "message": "Incorporate different unit measurements for histogram\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89bf5d1950066ef6bad86d6e6a1520a4222f749f", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/89bf5d1950066ef6bad86d6e6a1520a4222f749f", "committedDate": "2021-02-06T02:50:02Z", "message": "Expose mobile interfaces for Histogram Pulse metric\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c08134b2d0aeaa882cd814755b75f91ecfc02250", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c08134b2d0aeaa882cd814755b75f91ecfc02250", "committedDate": "2021-02-06T02:50:02Z", "message": "tests for Android\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4cad6e2b92113f7ef5aad6f23fe493f53b20d54", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/d4cad6e2b92113f7ef5aad6f23fe493f53b20d54", "committedDate": "2021-02-06T02:50:02Z", "message": "update interfaces again to separate timer and generic\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "263ee4b7a9fed9826d7b9bba1f8cffa820efdc69", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/263ee4b7a9fed9826d7b9bba1f8cffa820efdc69", "committedDate": "2021-02-06T02:50:02Z", "message": "lints\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33778be91b29f7e7e7fd56a70d3db152502e3074", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/33778be91b29f7e7e7fd56a70d3db152502e3074", "committedDate": "2021-02-06T02:50:02Z", "message": "match Android\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bd908b9c7af756f32e5dd192a063c5ae52df59d", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/2bd908b9c7af756f32e5dd192a063c5ae52df59d", "committedDate": "2021-02-06T02:50:02Z", "message": "more lints\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "023b8a7ca1d822fb8a89faa79915c730505a7f83", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/023b8a7ca1d822fb8a89faa79915c730505a7f83", "committedDate": "2021-02-06T02:50:02Z", "message": "uncommit temp bazel change\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7081f9a2e1c5feb660c3895d858bc87c650bdeea", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/7081f9a2e1c5feb660c3895d858bc87c650bdeea", "committedDate": "2021-02-06T02:50:02Z", "message": "more lints\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c97013e45f692bd24e767be06edb294aa0ac997e", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c97013e45f692bd24e767be06edb294aa0ac997e", "committedDate": "2021-02-06T02:50:02Z", "message": "new test\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21d6019e52b93bba4a7a3a95c114fd7f6b658c44", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/21d6019e52b93bba4a7a3a95c114fd7f6b658c44", "committedDate": "2021-02-06T02:50:02Z", "message": "clang format\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae1a0df93257bddf0c84c566c3f24d57ab67d767", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/ae1a0df93257bddf0c84c566c3f24d57ab67d767", "committedDate": "2021-02-06T02:50:02Z", "message": "kotlin and swift lint\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcb2015dff0783e3bf40e3e16c86016c4b8e12f9", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/dcb2015dff0783e3bf40e3e16c86016c4b8e12f9", "committedDate": "2021-02-06T02:50:02Z", "message": "pass enum in JNI\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fb1bcc83924dd160e747ec1457df89383efc7c0", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/6fb1bcc83924dd160e747ec1457df89383efc7c0", "committedDate": "2021-02-06T02:50:02Z", "message": "fix ordinal\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a66a081c31920ef80f4affdbb117173e2ce1f38f", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/a66a081c31920ef80f4affdbb117173e2ce1f38f", "committedDate": "2021-02-06T02:50:02Z", "message": "update docs\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ab01eb3eb2a3563c4de130856a1f5742f44c461", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/8ab01eb3eb2a3563c4de130856a1f5742f44c461", "committedDate": "2021-02-06T02:50:02Z", "message": "docs + examples update\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c92a92cc8c0255ab3be980ef8f71ef304fd133f6", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c92a92cc8c0255ab3be980ef8f71ef304fd133f6", "committedDate": "2021-02-06T02:50:02Z", "message": "remove enum from API java/kotlin/swift layers\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfc91e5a4d979c1ebc60bc3befe10880ba956315", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/bfc91e5a4d979c1ebc60bc3befe10880ba956315", "committedDate": "2021-02-06T02:50:02Z", "message": "create elements string in constructor + update examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a071d086404d5ee67a14b73f9b28f2cbdb8982fb", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/a071d086404d5ee67a14b73f9b28f2cbdb8982fb", "committedDate": "2021-02-06T02:50:02Z", "message": "fix examples\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64e5a0e1e805bb4d643c48c0e8fec00223805cc8", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/64e5a0e1e805bb4d643c48c0e8fec00223805cc8", "committedDate": "2021-02-06T02:50:02Z", "message": "rename Histogram public api to Distribution\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "743486b67a9b35b823655ca751981530fdb08c1f", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/743486b67a9b35b823655ca751981530fdb08c1f", "committedDate": "2021-02-06T00:34:57Z", "message": "rename Histogram public api to Distribution\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}, "afterCommit": {"oid": "64e5a0e1e805bb4d643c48c0e8fec00223805cc8", "author": {"user": {"login": "donyu", "name": "Don Yu"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/64e5a0e1e805bb4d643c48c0e8fec00223805cc8", "committedDate": "2021-02-06T02:50:02Z", "message": "rename Histogram public api to Distribution\n\nSigned-off-by: Don Yu <donyu@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg0ODIyMDgx", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1214#pullrequestreview-584822081", "createdAt": "2021-02-06T04:32:25Z", "commit": {"oid": "64e5a0e1e805bb4d643c48c0e8fec00223805cc8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3956, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}