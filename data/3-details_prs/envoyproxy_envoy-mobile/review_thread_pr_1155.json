{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExOTM2NzU5", "number": 1155, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNTozNVrOE3c1Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMToyMzoxMFrOE3e_lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc5NDc1OnYy", "diffSide": "RIGHT", "path": "examples/java/hello_world/MainActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNTozNVrOHwzU4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNTozNVrOHwzU4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNDYyNg==", "bodyText": "Maybe vary these numbers?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520934626", "createdAt": "2020-11-10T23:15:35Z", "author": {"login": "rebello95"}, "path": "examples/java/hello_world/MainActivity.java", "diffHunk": "@@ -127,4 +131,19 @@ private void makeRequest() {\n         .start(Executors.newSingleThreadExecutor())\n         .sendHeaders(requestHeaders, true);\n   }\n+\n+  private void recordStats() {\n+    final Counter counter = engine.statsClient().counter(new Element(\"foo\"), new Element(\"bar\"),\n+                                                         new Element(\"counter\"));\n+\n+    final Gauge gauge =\n+        engine.statsClient().gauge(new Element(\"foo\"), new Element(\"bar\"), new Element(\"gauge\"));\n+\n+    counter.increment(1);\n+    counter.increment(5);\n+\n+    gauge.set(5);\n+    gauge.add(5);\n+    gauge.sub(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc5NTE0OnYy", "diffSide": "RIGHT", "path": "examples/java/hello_world/hello_world.iml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNTo0M1rOHwzVGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoyNjowM1rOHwzkqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNDY4Mg==", "bodyText": "@buildbreaker is this file required?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520934682", "createdAt": "2020-11-10T23:15:43Z", "author": {"login": "rebello95"}, "path": "examples/java/hello_world/hello_world.iml", "diffHunk": "@@ -0,0 +1,11 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzODY2NQ==", "bodyText": "my ide generated it, it's not required", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520938665", "createdAt": "2020-11-10T23:26:03Z", "author": {"login": "jingwei99"}, "path": "examples/java/hello_world/hello_world.iml", "diffHunk": "@@ -0,0 +1,11 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNDY4Mg=="}, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc5NjU0OnYy", "diffSide": "RIGHT", "path": "examples/objective-c/hello_world/ViewController.m", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNjoxOVrOHwzWBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNjoxOVrOHwzWBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNDkxOQ==", "bodyText": "Please spell out \"element\" (more idiomatic on iOS)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520934919", "createdAt": "2020-11-10T23:16:19Z", "author": {"login": "rebello95"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -123,6 +126,20 @@ - (void)addResponseMessage:(NSString *)message\n   [self.tableView reloadData];\n }\n \n+- (void)sendStats {\n+  Element *eleFoo = [[Element alloc] initWithStringLiteral:@\"foo\"];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc5NzYyOnYy", "diffSide": "RIGHT", "path": "examples/objective-c/hello_world/ViewController.m", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxNjo0NlrOHwzWtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzozMDozOFrOHwzrfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTA5Mw==", "bodyText": "Why are these different from Android?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520935093", "createdAt": "2020-11-10T23:16:46Z", "author": {"login": "rebello95"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -123,6 +126,20 @@ - (void)addResponseMessage:(NSString *)message\n   [self.tableView reloadData];\n }\n \n+- (void)sendStats {\n+  Element *eleFoo = [[Element alloc] initWithStringLiteral:@\"foo\"];\n+  Element *eleBar = [[Element alloc] initWithStringLiteral:@\"bar\"];\n+  Element *eleCounter = [[Element alloc] initWithStringLiteral:@\"counter\"];\n+  Element *eleGauge = [[Element alloc] initWithStringLiteral:@\"gauge\"];\n+  id<Counter> counter = [self.statsClient counterWithElements:@[ eleFoo, eleBar, eleCounter ]];\n+  [counter incrementWithCount:1];\n+\n+  id<Gauge> gauge = [self.statsClient gaugeWithElements:@[ eleFoo, eleBar, eleGauge ]];\n+  [gauge setWithValue:1];\n+  [gauge addWithAmount:1];\n+  [gauge subWithAmount:1];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzOTI3OA==", "bodyText": "you mean the method names?\nthey come from the swift generated Envoy/Envoy-Swift.h", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520939278", "createdAt": "2020-11-10T23:27:40Z", "author": {"login": "jingwei99"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -123,6 +126,20 @@ - (void)addResponseMessage:(NSString *)message\n   [self.tableView reloadData];\n }\n \n+- (void)sendStats {\n+  Element *eleFoo = [[Element alloc] initWithStringLiteral:@\"foo\"];\n+  Element *eleBar = [[Element alloc] initWithStringLiteral:@\"bar\"];\n+  Element *eleCounter = [[Element alloc] initWithStringLiteral:@\"counter\"];\n+  Element *eleGauge = [[Element alloc] initWithStringLiteral:@\"gauge\"];\n+  id<Counter> counter = [self.statsClient counterWithElements:@[ eleFoo, eleBar, eleCounter ]];\n+  [counter incrementWithCount:1];\n+\n+  id<Gauge> gauge = [self.statsClient gaugeWithElements:@[ eleFoo, eleBar, eleGauge ]];\n+  [gauge setWithValue:1];\n+  [gauge addWithAmount:1];\n+  [gauge subWithAmount:1];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTA5Mw=="}, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzOTY5NA==", "bodyText": "I meant the amounts", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520939694", "createdAt": "2020-11-10T23:28:48Z", "author": {"login": "rebello95"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -123,6 +126,20 @@ - (void)addResponseMessage:(NSString *)message\n   [self.tableView reloadData];\n }\n \n+- (void)sendStats {\n+  Element *eleFoo = [[Element alloc] initWithStringLiteral:@\"foo\"];\n+  Element *eleBar = [[Element alloc] initWithStringLiteral:@\"bar\"];\n+  Element *eleCounter = [[Element alloc] initWithStringLiteral:@\"counter\"];\n+  Element *eleGauge = [[Element alloc] initWithStringLiteral:@\"gauge\"];\n+  id<Counter> counter = [self.statsClient counterWithElements:@[ eleFoo, eleBar, eleCounter ]];\n+  [counter incrementWithCount:1];\n+\n+  id<Gauge> gauge = [self.statsClient gaugeWithElements:@[ eleFoo, eleBar, eleGauge ]];\n+  [gauge setWithValue:1];\n+  [gauge addWithAmount:1];\n+  [gauge subWithAmount:1];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTA5Mw=="}, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0MDQxMg==", "bodyText": "to clarify: you mean the actual numbers sent (instead of the method names)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520940412", "createdAt": "2020-11-10T23:30:38Z", "author": {"login": "jingwei99"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -123,6 +126,20 @@ - (void)addResponseMessage:(NSString *)message\n   [self.tableView reloadData];\n }\n \n+- (void)sendStats {\n+  Element *eleFoo = [[Element alloc] initWithStringLiteral:@\"foo\"];\n+  Element *eleBar = [[Element alloc] initWithStringLiteral:@\"bar\"];\n+  Element *eleCounter = [[Element alloc] initWithStringLiteral:@\"counter\"];\n+  Element *eleGauge = [[Element alloc] initWithStringLiteral:@\"gauge\"];\n+  id<Counter> counter = [self.statsClient counterWithElements:@[ eleFoo, eleBar, eleCounter ]];\n+  [counter incrementWithCount:1];\n+\n+  id<Gauge> gauge = [self.statsClient gaugeWithElements:@[ eleFoo, eleBar, eleGauge ]];\n+  [gauge setWithValue:1];\n+  [gauge addWithAmount:1];\n+  [gauge subWithAmount:1];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTA5Mw=="}, "originalCommit": {"oid": "c67d76434d82785012013b7a5875a059fe6c274e"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjE0OTMzOnYy", "diffSide": "RIGHT", "path": "examples/objective-c/hello_world/ViewController.m", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMToyMzoxMFrOHw2v-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMTo0MjowNFrOHw3kNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk5MDcxNQ==", "bodyText": "I just noticed this - it looks like iOS is sending stats only once whereas Android is sending them with each request, is that correct? If so, these should be consistent", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r520990715", "createdAt": "2020-11-11T01:23:10Z", "author": {"login": "rebello95"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -46,8 +47,10 @@ - (void)startEnvoy {\n     NSLog(@\"starting Envoy failed: %@\", error);\n   } else {\n     NSLog(@\"started Envoy, beginning requests...\");\n-    self.client = [engine streamClient];\n+    self.streamClient = [engine streamClient];\n+    self.statsClient = [engine statsClient];\n     [self startRequests];\n+    [self sendStats];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "056289d4023644bdff2ccf1c32c4ce7db12b3505"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAwNDA4Nw==", "bodyText": "looking, the structure of the code for ios and android are pretty different", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1155#discussion_r521004087", "createdAt": "2020-11-11T01:42:04Z", "author": {"login": "jingwei99"}, "path": "examples/objective-c/hello_world/ViewController.m", "diffHunk": "@@ -46,8 +47,10 @@ - (void)startEnvoy {\n     NSLog(@\"starting Envoy failed: %@\", error);\n   } else {\n     NSLog(@\"started Envoy, beginning requests...\");\n-    self.client = [engine streamClient];\n+    self.streamClient = [engine streamClient];\n+    self.statsClient = [engine statsClient];\n     [self startRequests];\n+    [self sendStats];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk5MDcxNQ=="}, "originalCommit": {"oid": "056289d4023644bdff2ccf1c32c4ce7db12b3505"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 491, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}