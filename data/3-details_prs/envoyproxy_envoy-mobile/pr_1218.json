{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyODA0OTgx", "number": 1218, "title": "python: implement stream-related classes", "bodyText": "Description:\nAll header changes in this PR come from #1217, that should be reviewed and merged first.\nThis PR implements all of the stream-related classes: Stream, StreamCallbacks EnvoyHttpCallbacksAdapter, and StreamPrototype`.\nRisk Level: Low\nTesting: N/A, will follow up when everything is finished with e2e testing + unit testing in Python and/orC++\nDocs Changes: N/A\nRelease Notes: N/A", "createdAt": "2020-12-18T22:33:07Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218", "merged": true, "mergeCommit": {"oid": "3c7b840695b294d19a28c52e4ebf0bb4269ba239"}, "closed": true, "closedAt": "2021-01-12T18:20:49Z", "author": {"login": "crockeo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdtkg80AH2gAyNTQyODA0OTgxOmM3NjljYjg2ZDcyMmJhOGRiMGJkNzlmZWE5NTBhYjRkNDRmZmI2ZTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvfS1HAFqTU2NjU0NzAxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c769cb86d722ba8db0bd79fea950ab4d44ffb6e5", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/c769cb86d722ba8db0bd79fea950ab4d44ffb6e5", "committedDate": "2021-01-06T19:16:24Z", "message": "impl stream\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49f5c5f11af63b95ff242f261102abc89a338f6b", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/49f5c5f11af63b95ff242f261102abc89a338f6b", "committedDate": "2021-01-06T19:26:49Z", "message": "lib changes\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7405637c00e9956ac072af9f45d2b2a42cedbacc", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/7405637c00e9956ac072af9f45d2b2a42cedbacc", "committedDate": "2021-01-06T19:35:25Z", "message": "implement relevant shims\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f2aafe0e37d6347fd53aefba7d35784688f7078", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/3f2aafe0e37d6347fd53aefba7d35784688f7078", "committedDate": "2021-01-06T20:09:44Z", "message": "add shims for the rest of the callbacks so we can assume GIL\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6407aee1822a4406665fb4635ffc147b860681c2", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/6407aee1822a4406665fb4635ffc147b860681c2", "committedDate": "2020-12-18T22:04:03Z", "message": "impl stream\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}, "afterCommit": {"oid": "3f2aafe0e37d6347fd53aefba7d35784688f7078", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/3f2aafe0e37d6347fd53aefba7d35784688f7078", "committedDate": "2021-01-06T20:09:44Z", "message": "add shims for the rest of the callbacks so we can assume GIL\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "569912781d2bd4b20415c906694eb42013d7bd38", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/569912781d2bd4b20415c906694eb42013d7bd38", "committedDate": "2021-01-08T15:42:25Z", "message": "Merge branch 'main' of github.com:envoyproxy/envoy-mobile into ch/python-stream-impl\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d", "author": {"user": {"login": "crockeo", "name": "Cerek Hillen"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/48fb7229e98ef6b6970a64c01b9357f8434c541d", "committedDate": "2021-01-11T14:30:59Z", "message": "move closure defn to a template\n\nSigned-off-by: Cerek Hillen <chillen@lyft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2NTQ1Nzcx", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#pullrequestreview-566545771", "createdAt": "2021-01-12T18:17:41Z", "commit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxODoxNzo0MVrOISORRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxODoxNzo0MVrOISORRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk3OTA3OA==", "bodyText": "Envoy style is for all instance methods to be camelCase.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#discussion_r555979078", "createdAt": "2021-01-12T18:17:41Z", "author": {"login": "goaway"}, "path": "library/cc/stream.cc", "diffHunk": "@@ -0,0 +1,37 @@\n+#include \"stream.h\"\n+\n+#include <iostream>\n+\n+#include \"bridge_utility.h\"\n+#include \"library/common/main_interface.h\"\n+#include \"library/common/types/c_types.h\"\n+\n+namespace Envoy {\n+namespace Platform {\n+\n+Stream::Stream(envoy_stream_t handle, EnvoyHttpCallbacksAdapterSharedPtr adapter)\n+    : handle_(handle), adapter_(adapter) {}\n+\n+Stream& Stream::send_headers(RequestHeadersSharedPtr headers, bool end_stream) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2NTQ2MDkx", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#pullrequestreview-566546091", "createdAt": "2021-01-12T18:18:06Z", "commit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxODoxODowNlrOISOSSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxODoxODowNlrOISOSSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk3OTMzOQ==", "bodyText": "These though I think we can leave as snake_case to distinguish them", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#discussion_r555979339", "createdAt": "2021-01-12T18:18:06Z", "author": {"login": "goaway"}, "path": "library/cc/stream_callbacks.cc", "diffHunk": "@@ -0,0 +1,96 @@\n+#include \"stream_callbacks.h\"\n+\n+#include \"bridge_utility.h\"\n+#include \"response_headers_builder.h\"\n+#include \"response_trailers_builder.h\"\n+\n+namespace Envoy {\n+namespace Platform {\n+\n+EnvoyHttpCallbacksAdapter::EnvoyHttpCallbacksAdapter(StreamCallbacksSharedPtr callbacks)\n+    : stream_callbacks_(callbacks) {}\n+\n+envoy_http_callbacks EnvoyHttpCallbacksAdapter::as_envoy_http_callbacks() {\n+  envoy_http_callbacks callbacks{\n+      .on_headers = &EnvoyHttpCallbacksAdapter::c_on_headers,\n+      .on_data = &EnvoyHttpCallbacksAdapter::c_on_data,\n+      // on_metadata is not used\n+      .on_trailers = &EnvoyHttpCallbacksAdapter::c_on_trailers,\n+      .on_error = &EnvoyHttpCallbacksAdapter::c_on_error,\n+      .on_complete = &EnvoyHttpCallbacksAdapter::c_on_complete,\n+      .on_cancel = &EnvoyHttpCallbacksAdapter::c_on_cancel,\n+      .context = this,\n+  };\n+  return callbacks;\n+}\n+\n+void* EnvoyHttpCallbacksAdapter::c_on_headers(envoy_headers headers, bool end_stream,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2NTQ3MDE2", "url": "https://github.com/envoyproxy/envoy-mobile/pull/1218#pullrequestreview-566547016", "createdAt": "2021-01-12T18:19:18Z", "commit": {"oid": "48fb7229e98ef6b6970a64c01b9357f8434c541d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3964, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}