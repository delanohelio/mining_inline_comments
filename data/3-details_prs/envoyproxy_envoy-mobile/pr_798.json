{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MzI3ODgx", "number": 798, "title": "platform: close streams explicitly with data or trailers", "bodyText": "Replaces the close(trailers: Map<String, List<String>>?) function with two new functions (one for closing with data, and one for closing with trailers).\nThis removes the ambiguity of how a stream will be closed by making the consumer specify explicitly whether they'd like to close a stream using trailers or data.\nThe change is being done as a precursor for integrating L7 Swift/Kotlin filters, which will have interfaces in which trailers are not nullable.\nSigned-off-by: Michael Rebello me@michaelrebello.com", "createdAt": "2020-04-20T22:07:11Z", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798", "merged": true, "mergeCommit": {"oid": "b3b27c5a2103126d135ce3f5b4379d27d914790c"}, "closed": true, "closedAt": "2020-04-20T22:44:45Z", "author": {"login": "rebello95"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZmhV6AH2gAyNDA2MzI3ODgxOmZlOGEwNGJiNWNlYzk1MThkYTAyNDRhMWQ3OWY1YWE1N2RjNGMyZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZm8jHgFqTM5Njg2MDQ2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2", "author": {"user": {"login": "rebello95", "name": "Michael Rebello"}}, "url": "https://github.com/envoyproxy/envoy-mobile/commit/fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2", "committedDate": "2020-04-20T22:07:00Z", "message": "platform: close streams explicitly with data or trailers\n\nReplaces the `close(trailers: Map<String, List<String>>?)` function with two new functions (one for closing with data, and one for closing with trailers).\n\nThis removes the ambiguity of how a stream will be closed by making the consumer specify it explicitly.\n\nThe change is being done as a precursor for integrating L7 Swift/Kotlin filters, which will have interfaces in which trailers are not nullable.\n\nSigned-off-by: Michael Rebello <me@michaelrebello.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODQ4MTI3", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#pullrequestreview-396848127", "createdAt": "2020-04-20T22:09:18Z", "commit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowOToxOFrOGIpuSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjowOToxOFrOGIpuSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyNTM4Nw==", "bodyText": "Not going to keep the comments?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#discussion_r411725387", "createdAt": "2020-04-20T22:09:18Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/EnvoyStreamEmitter.kt", "diffHunk": "@@ -29,22 +29,14 @@ class EnvoyStreamEmitter(\n     return this\n   }\n \n-  /**\n-   * For ending an associated stream and sending trailers.\n-   *\n-   * @param trailers to send with ending a stream. If null, stream will be closed with an empty data frame.\n-   */\n-  override fun close(trailers: Map<String, List<String>>?) {\n-    trailers?.let {\n-      stream.sendTrailers(it)\n-      return\n-    }\n-    stream.sendData(ByteBuffer.allocate(0), true)\n+  override fun close(trailers: Map<String, List<String>>) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODQ5MTU0", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#pullrequestreview-396849154", "createdAt": "2020-04-20T22:11:22Z", "commit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjoxMToyMlrOGIpyOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjoxMToyMlrOGIpyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcyNjM5Mg==", "bodyText": "What was the rationale for making this required (instead of having something like fun close(byteBuffer: ByteBuffer = ByteBuffer.allocate(0)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#discussion_r411726392", "createdAt": "2020-04-20T22:11:22Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/EnvoyStreamEmitter.kt", "diffHunk": "@@ -29,22 +29,14 @@ class EnvoyStreamEmitter(\n     return this\n   }\n \n-  /**\n-   * For ending an associated stream and sending trailers.\n-   *\n-   * @param trailers to send with ending a stream. If null, stream will be closed with an empty data frame.\n-   */\n-  override fun close(trailers: Map<String, List<String>>?) {\n-    trailers?.let {\n-      stream.sendTrailers(it)\n-      return\n-    }\n-    stream.sendData(ByteBuffer.allocate(0), true)\n+  override fun close(trailers: Map<String, List<String>>) {\n+    stream.sendTrailers(trailers)\n+  }\n+\n+  override fun close(byteBuffer: ByteBuffer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODQ5OTQ0", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#pullrequestreview-396849944", "createdAt": "2020-04-20T22:13:04Z", "commit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODYwNDYy", "url": "https://github.com/envoyproxy/envoy-mobile/pull/798#pullrequestreview-396860462", "createdAt": "2020-04-20T22:36:43Z", "commit": {"oid": "fe8a04bb5cec9518da0244a1d79f5aa57dc4c2e2"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4345, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}