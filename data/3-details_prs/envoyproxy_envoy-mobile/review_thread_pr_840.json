{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NDM3NjA4", "number": 840, "reviewThreads": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDoyMjo1MVrOD7z-Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwMTowNzo0M1rOD8ssmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDQ0MDU1OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/BUILD", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDoyMjo1MVrOGUXjHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDozOTozOFrOGUhLLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxMDUyNw==", "bodyText": "We are missing builders for ResponseHeaders/Trailers for both kotlin and swift.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424010527", "createdAt": "2020-05-12T20:22:51Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/BUILD", "diffHunk": "@@ -40,17 +40,34 @@ envoy_mobile_kt_library(\n         \"EnvoyClientBuilder.kt\",\n         \"EnvoyError.kt\",\n         \"EnvoyStreamEmitter.kt\",\n+        \"Filter.kt\",\n+        \"FilterDataStatus.kt\",\n+        \"FilterHeaderStatus.kt\",\n+        \"FilterRegistry.kt\",\n+        \"FilterTrailerStatus.kt\",\n         \"GRPCClient.kt\",\n         \"GRPCRequestBuilder.kt\",\n         \"GRPCResponseHandler.kt\",\n         \"GRPCStreamEmitter.kt\",\n         \"HTTPClient.kt\",\n+        \"Headers.kt\",\n+        \"HeadersBuilder.kt\",\n         \"LogLevel.kt\",\n         \"Request.kt\",\n         \"RequestBuilder.kt\",\n+        \"RequestFilter.kt\",\n+        \"RequestFilterCallbacks.kt\",\n+        \"RequestHeaders.kt\",\n+        \"RequestHeadersBuilder.kt\",\n         \"RequestMapper.kt\",\n         \"RequestMethod.kt\",\n+        \"RequestTrailersBuilder.kt\",\n+        \"RequestTrailers.kt\",\n+        \"ResponseFilter.kt\",\n+        \"ResponseFilterCallbacks.kt\",\n         \"ResponseHandler.kt\",\n+        \"ResponseHeaders.kt\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODIzOQ==", "bodyText": "Ah yea we should add those. Originally I thought they wouldn't be necessary, but since we'll allow filters to add/mutate response headers/trailers, we'll need to add those. Can do in a separate PR (maybe comment on the issue?)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424168239", "createdAt": "2020-05-13T04:39:38Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/BUILD", "diffHunk": "@@ -40,17 +40,34 @@ envoy_mobile_kt_library(\n         \"EnvoyClientBuilder.kt\",\n         \"EnvoyError.kt\",\n         \"EnvoyStreamEmitter.kt\",\n+        \"Filter.kt\",\n+        \"FilterDataStatus.kt\",\n+        \"FilterHeaderStatus.kt\",\n+        \"FilterRegistry.kt\",\n+        \"FilterTrailerStatus.kt\",\n         \"GRPCClient.kt\",\n         \"GRPCRequestBuilder.kt\",\n         \"GRPCResponseHandler.kt\",\n         \"GRPCStreamEmitter.kt\",\n         \"HTTPClient.kt\",\n+        \"Headers.kt\",\n+        \"HeadersBuilder.kt\",\n         \"LogLevel.kt\",\n         \"Request.kt\",\n         \"RequestBuilder.kt\",\n+        \"RequestFilter.kt\",\n+        \"RequestFilterCallbacks.kt\",\n+        \"RequestHeaders.kt\",\n+        \"RequestHeadersBuilder.kt\",\n         \"RequestMapper.kt\",\n         \"RequestMethod.kt\",\n+        \"RequestTrailersBuilder.kt\",\n+        \"RequestTrailers.kt\",\n+        \"ResponseFilter.kt\",\n+        \"ResponseFilterCallbacks.kt\",\n         \"ResponseHandler.kt\",\n+        \"ResponseHeaders.kt\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxMDUyNw=="}, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDUwMTY0OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/Headers.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo0MTo0NlrOGUYJqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDowMzoxM1rOGVBh4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyMDM5Mw==", "bodyText": "Can we add a TODO for fixing the linter from being this strict?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424020393", "createdAt": "2020-05-12T20:41:46Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/Headers.kt", "diffHunk": "@@ -0,0 +1,30 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Base class that is used to represent header/trailer data structures.\n+ * To instantiate new instances, see `{Request|Response}HeadersBuilder`.\n+ */\n+open class Headers {\n+  @Suppress(\"MemberNameEqualsClassName\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5ODMzOQ==", "bodyText": "My personal bias is to make it intentional to suppress the linter rather than making the linter less-strict. But I am draconian like that.\nThis way we don't fall into anti-patterns (according to the linter's convention) without giving it thought.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424698339", "createdAt": "2020-05-13T20:03:13Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/Headers.kt", "diffHunk": "@@ -0,0 +1,30 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Base class that is used to represent header/trailer data structures.\n+ * To instantiate new instances, see `{Request|Response}HeadersBuilder`.\n+ */\n+open class Headers {\n+  @Suppress(\"MemberNameEqualsClassName\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyMDM5Mw=="}, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDUwMjYyOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/Filter.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo0MjowNFrOGUYKTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDowNDowOVrOGVBjzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyMDU1OQ==", "bodyText": "Let's add a TODO for avoid linting on this", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424020559", "createdAt": "2020-05-12T20:42:04Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/Filter.kt", "diffHunk": "@@ -0,0 +1,7 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Interface representing a filter. See `RequestFilter` and `ResponseFilter` for more details.\n+ */\n+@Suppress(\"EmptyClassBlock\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5ODgzMQ==", "bodyText": "same as other comment", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424698831", "createdAt": "2020-05-13T20:04:09Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/Filter.kt", "diffHunk": "@@ -0,0 +1,7 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Interface representing a filter. See `RequestFilter` and `ResponseFilter` for more details.\n+ */\n+@Suppress(\"EmptyClassBlock\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyMDU1OQ=="}, "originalCommit": {"oid": "2722caf1910f6b80acfea1147df66421ff7281f8"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU1MDkzOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1NjozNVrOGUYpVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1NjozNVrOGUYpVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyODUwMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import java.lang.IllegalArgumentException\n          \n          \n            \n            \n          \n          \n            \n            import java.lang.IllegalArgumentException", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424028500", "createdAt": "2020-05-12T20:56:35Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "diffHunk": "@@ -1,5 +1,5 @@\n package io.envoyproxy.envoymobile\n-\n+import java.lang.IllegalArgumentException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU1MjUxOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestTrailers.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1NzowM1rOGUYqVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDowNDoyMVrOGVBkMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyODc1OA==", "bodyText": "Is this actually needed? We can add a TODO for removing this lint check", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424028758", "createdAt": "2020-05-12T20:57:03Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestTrailers.kt", "diffHunk": "@@ -0,0 +1,14 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Trailers representing an outbound request.\n+ */\n+@Suppress(\"EmptyClassBlock\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5ODkzMQ==", "bodyText": "same as other comment", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424698931", "createdAt": "2020-05-13T20:04:21Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestTrailers.kt", "diffHunk": "@@ -0,0 +1,14 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Trailers representing an outbound request.\n+ */\n+@Suppress(\"EmptyClassBlock\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyODc1OA=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU1NzEzOnYy", "diffSide": "RIGHT", "path": "library/swift/src/RetryPolicyMapper.swift", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1ODoyNFrOGUYtMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDozODowM1rOGUhJ4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTQ5MQ==", "bodyText": "@rebello95 Could you give insight onto how we can find this out (or help find this out for us?)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424029491", "createdAt": "2020-05-12T20:58:24Z", "author": {"login": "buildbreaker"}, "path": "library/swift/src/RetryPolicyMapper.swift", "diffHunk": "@@ -36,8 +36,10 @@ extension RetryPolicy {\n     self.init(\n       maxRetryCount: maxRetryCount,\n       retryOn: headers.value(forName: \"x-envoy-retry-on\")?.compactMap(RetryRule.init) ?? [],\n+      // TODO: does the UInt.init blow up? or does it return nil?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2NzkwNw==", "bodyText": "Just checked, and mapping String to UInt* here just returns nil if it's not a valid unsigned int", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424167907", "createdAt": "2020-05-13T04:38:03Z", "author": {"login": "rebello95"}, "path": "library/swift/src/RetryPolicyMapper.swift", "diffHunk": "@@ -36,8 +36,10 @@ extension RetryPolicy {\n     self.init(\n       maxRetryCount: maxRetryCount,\n       retryOn: headers.value(forName: \"x-envoy-retry-on\")?.compactMap(RetryRule.init) ?? [],\n+      // TODO: does the UInt.init blow up? or does it return nil?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTQ5MQ=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU1ODU0OnYy", "diffSide": "RIGHT", "path": "library/swift/src/ResponseHeaders.swift", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1ODo1NlrOGUYuKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDowNTo0NVrOGVsSsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTczNg==", "bodyText": "@rebello95 Same here, do we error out when a :status is not a number?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424029736", "createdAt": "2020-05-12T20:58:56Z", "author": {"login": "buildbreaker"}, "path": "library/swift/src/ResponseHeaders.swift", "diffHunk": "@@ -4,6 +4,7 @@ import Foundation\n @objcMembers\n public final class ResponseHeaders: Headers {\n   /// HTTP status code received with the response.\n+  /// TODO: in Kotlin this blows up if the value of status cannot be translated to an int.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3MDM4MQ==", "bodyText": "Commented above, but swift returns nil in the case of an invalid :status which I think makes sense, especially if at some point we have internal headers generated by Envoy/Envoy Mobile in the future that don't contain this header", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424170381", "createdAt": "2020-05-13T04:49:15Z", "author": {"login": "rebello95"}, "path": "library/swift/src/ResponseHeaders.swift", "diffHunk": "@@ -4,6 +4,7 @@ import Foundation\n @objcMembers\n public final class ResponseHeaders: Headers {\n   /// HTTP status code received with the response.\n+  /// TODO: in Kotlin this blows up if the value of status cannot be translated to an int.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTczNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5NzczOQ==", "bodyText": "update kotlin with an optional. Although the server-side bias in me wishes we blew up.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424697739", "createdAt": "2020-05-13T20:02:04Z", "author": {"login": "junr03"}, "path": "library/swift/src/ResponseHeaders.swift", "diffHunk": "@@ -4,6 +4,7 @@ import Foundation\n @objcMembers\n public final class ResponseHeaders: Headers {\n   /// HTTP status code received with the response.\n+  /// TODO: in Kotlin this blows up if the value of status cannot be translated to an int.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTczNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5ODk2Mw==", "bodyText": "I feel we should blow up but let's keep it consistent for now and we can have a separate discussion about these details after. What do you think?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425398963", "createdAt": "2020-05-14T20:05:45Z", "author": {"login": "buildbreaker"}, "path": "library/swift/src/ResponseHeaders.swift", "diffHunk": "@@ -4,6 +4,7 @@ import Foundation\n @objcMembers\n public final class ResponseHeaders: Headers {\n   /// HTTP status code received with the response.\n+  /// TODO: in Kotlin this blows up if the value of status cannot be translated to an int.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTczNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU1OTU0OnYy", "diffSide": "RIGHT", "path": "library/swift/src/ResponseFilterCallbacks.swift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1OToxNVrOGUYuyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1OToxNVrOGUYuyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAyOTg5Nw==", "bodyText": "Nice catch!", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424029897", "createdAt": "2020-05-12T20:59:15Z", "author": {"login": "buildbreaker"}, "path": "library/swift/src/ResponseFilterCallbacks.swift", "diffHunk": "@@ -20,5 +21,5 @@ public protocol ResponseFilterCallbacks {\n   /// `endStream = true` in order to guarantee that the client will not send its own trailers.\n   ///\n   /// - parameter trailers: The trailers to add and pass to subsequent filters.\n-  func addResponseTrailers() -> ResponseHeaders\n+  func addResponseTrailers(_ trailers: ResponseTrailers)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU2MTg5OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicyMapper.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDo1OTo1MVrOGUYwOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDowNjoxMVrOGVBoDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDI2Nw==", "bodyText": "Is this still relevant since you've added the enumValue() method in the class?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424030267", "createdAt": "2020-05-12T20:59:51Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicyMapper.kt", "diffHunk": "@@ -30,6 +30,7 @@ internal fun RetryPolicy.outboundHeaders(): Map<String, List<String>> {\n  *\n  * @return The string representation of the retry rule\n  */\n+ //TODO: change to enum pattern in UpstreamHttpProtocol", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5OTkxNw==", "bodyText": "yep I mean I wanted to update the enum classes to be enum class RetryRule(internal val stringValue: String) {...} to avoid having the stringValue() method. I have updated RequestMethod and RetryRule.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424699917", "createdAt": "2020-05-13T20:06:11Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicyMapper.kt", "diffHunk": "@@ -30,6 +30,7 @@ internal fun RetryPolicy.outboundHeaders(): Map<String, List<String>> {\n  *\n  * @return The string representation of the retry rule\n  */\n+ //TODO: change to enum pattern in UpstreamHttpProtocol", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDI2Nw=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDU2NDIyOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMTowMDoyM1rOGUYxog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxOTo0MzozNVrOGVrknA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDYyNg==", "bodyText": "Contingent on https://github.com/lyft/envoy-mobile/pull/840/files#r424029491", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424030626", "createdAt": "2020-05-12T21:00:23Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,6 +25,22 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),\n+      // TODO: should we have ? after the map?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcwNTAzOQ==", "bodyText": "I guess my question is what optional is the ? after map talking about? The first one is because the key x-envoy-retry-on might not be in the headers map so the list is optional. But the return type of map is List<T>, so I am not sure what ? means there because I understood the first ? meaning that we only call map if the list is there.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424705039", "createdAt": "2020-05-13T20:15:37Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,6 +25,22 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),\n+      // TODO: should we have ? after the map?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDYyNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODQ1Ng==", "bodyText": "Yea I'm actually curious about this as well", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425348456", "createdAt": "2020-05-14T18:32:04Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,6 +25,22 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),\n+      // TODO: should we have ? after the map?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDYyNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NzE2NA==", "bodyText": "Are you talking about the elvis symbol ?: here rather than the ? symbol?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425387164", "createdAt": "2020-05-14T19:43:35Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,6 +25,22 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),\n+      // TODO: should we have ? after the map?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAzMDYyNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzMjE5OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0MjoxMFrOGUhNQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMTowOTo1NFrOGVDn1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODc2OA==", "bodyText": "In Swift these are computed and are only computed when they're accessed by the consumer. Is it possible to do that here @buildbreaker?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424168768", "createdAt": "2020-05-13T04:42:10Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyNjcyMQ==", "bodyText": "yeah we have to use the lazy keyword: https://stackoverflow.com/questions/36623177/kotlin-property-initialization-using-by-lazy-vs-lateinit", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424726721", "createdAt": "2020-05-13T20:57:44Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODc2OA=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMjYzMQ==", "bodyText": "thanks, done!", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424732631", "createdAt": "2020-05-13T21:09:54Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODc2OA=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzMzE4OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0Mjo0NVrOGUhN0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0Mjo0NVrOGUhN0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODkxMw==", "bodyText": "This is optional/nullable, so we probably should not force unwrap here", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424168913", "createdAt": "2020-05-13T04:42:45Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme = value(\":scheme\")?.first()!!\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority = value(\":authority\")?.first()!!\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path = value(\":path\")?.first()!!\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  // TODO: retry policy mapper\n+  val retryPolicy = RetryPolicy(this)\n+\n+  /**\n+   * The protocol version to use for upstream requests.\n+   */\n+  val upstreamHttpProtocol =\n+    UpstreamHttpProtocol.enumValue(value(\"x-envoy-mobile-upstream-protocol\")?.first()!!)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzMzgwOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0MzowMlrOGUhOJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDoxNzozN1rOGVCAIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODk5Ng==", "bodyText": "What's necessary to do here?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424168996", "createdAt": "2020-05-13T04:43:02Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme = value(\":scheme\")?.first()!!\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority = value(\":authority\")?.first()!!\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path = value(\":path\")?.first()!!\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  // TODO: retry policy mapper", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcwNjA4MA==", "bodyText": "stale", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424706080", "createdAt": "2020-05-13T20:17:37Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme = value(\":scheme\")?.first()!!\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority = value(\":authority\")?.first()!!\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path = value(\":path\")?.first()!!\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  // TODO: retry policy mapper", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2ODk5Ng=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzNjUzOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseHeaders.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NTowOVrOGUhP9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NTowOVrOGUhP9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2OTQ2MQ==", "bodyText": "I think we should probably avoid throwing an exception here if possible to match Swift", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424169461", "createdAt": "2020-05-13T04:45:09Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseHeaders.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an inbound response.\n+ */\n+class ResponseHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * HTTP status code received with the response.\n+   */\n+  val httpStatus = value(\":status\")?.first()?.toInt()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzNzk2OnYy", "diffSide": "RIGHT", "path": "library/swift/src/RequestFilter.swift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NjoyMFrOGUhQ6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NjoyMFrOGUhQ6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2OTcwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              func onRequestTrailers(_ trailers: RequestTrailers) -> FilterTrailerStatus<RequestHeaders>\n          \n          \n            \n              func onRequestTrailers(_ trailers: RequestTrailers) -> FilterTrailerStatus<RequestTrailers>\n          \n      \n    \n    \n  \n\nMissed one \ud83d\ude09", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424169707", "createdAt": "2020-05-13T04:46:20Z", "author": {"login": "rebello95"}, "path": "library/swift/src/RequestFilter.swift", "diffHunk": "@@ -36,5 +36,5 @@ public protocol RequestFilter: Filter {\n   /// - parameter trailers: The outbound trailers.\n   ///\n   /// - returns: The trailer status containing body with which to continue or buffer.\n-  func onRequestTrailers(_ trailers: RequestHeaders) -> FilterTrailerStatus<RequestHeaders>\n+  func onRequestTrailers(_ trailers: RequestTrailers) -> FilterTrailerStatus<RequestHeaders>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQzOTQ2OnYy", "diffSide": "RIGHT", "path": "library/swift/src/RequestFilterCallbacks.swift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NzozMFrOGUhR4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0NzozMFrOGUhR4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2OTk1Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            /// Interface for RequestFilters to access FilterManager state.\n          \n          \n            \n            /// Interface for RequestFilters to access FilterManager state.\n          \n      \n    \n    \n  \n\nMight want to remove this (same in Kotlin) for now since we haven't yet confirmed if FilterManager will be a class or where that logic will live", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424169953", "createdAt": "2020-05-13T04:47:30Z", "author": {"login": "rebello95"}, "path": "library/swift/src/RequestFilterCallbacks.swift", "diffHunk": "@@ -1,5 +1,6 @@\n import Foundation\n \n+/// Interface for RequestFilters to access FilterManager state.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MTQ0MDA3OnYy", "diffSide": "RIGHT", "path": "library/swift/src/RequestTrailersBuilder.swift", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0Nzo0MlrOGUhSNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDo0ODowNlrOGUhSkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3MDAzNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            /// Builder used for constructing instances of `RequestTrailers` type.\n          \n          \n            \n            /// Builder used for constructing instances of the `RequestTrailers` type.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424170036", "createdAt": "2020-05-13T04:47:42Z", "author": {"login": "rebello95"}, "path": "library/swift/src/RequestTrailersBuilder.swift", "diffHunk": "@@ -1,6 +1,6 @@\n import Foundation\n \n-/// Builder used for constructing instances of `RequestTrailers` types.\n+/// Builder used for constructing instances of `RequestTrailers` type.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3MDEyOQ==", "bodyText": "This was \"types\" before since we have multiple subclasses, but no strong opinion (let's just keep them all consistent)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424170129", "createdAt": "2020-05-13T04:48:06Z", "author": {"login": "rebello95"}, "path": "library/swift/src/RequestTrailersBuilder.swift", "diffHunk": "@@ -1,6 +1,6 @@\n import Foundation\n \n-/// Builder used for constructing instances of `RequestTrailers` types.\n+/// Builder used for constructing instances of `RequestTrailers` type.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3MDAzNg=="}, "originalCommit": {"oid": "9d671b1b94349a2dbe58c98408cef97169ebd936"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NDg2NzcyOnYy", "diffSide": "RIGHT", "path": "library/swift/src/RetryPolicyMapper.swift", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDo1NzoyMVrOGVDP1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMDo1NzoyMVrOGVDP1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyNjQ4Nw==", "bodyText": "https://www.hackingwithswift.com/articles/205/whats-the-difference-between-map-flatmap-and-compactmap", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424726487", "createdAt": "2020-05-13T20:57:21Z", "author": {"login": "junr03"}, "path": "library/swift/src/RetryPolicyMapper.swift", "diffHunk": "@@ -38,6 +38,7 @@ extension RetryPolicy {\n       retryOn: headers.value(forName: \"x-envoy-retry-on\")?.compactMap(RetryRule.init) ?? [],\n       retryStatusCodes: headers.value(forName: \"x-envoy-retriable-status-codes\")?\n         .compactMap(UInt.init) ?? [],\n+      // TODO: is the flatmap to apply the constructor even if there is only one value?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3b28689191116d6ba62b84e262286eef6b238f3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NDkwODg3OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMToxMDozNVrOGVDpYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMToxMDozNVrOGVDpYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMzAyNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              val method = RequestMethod.enumValue(value(\":method\")?.first()!!)\n          \n          \n            \n              val method by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r424733025", "createdAt": "2020-05-13T21:10:35Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,54 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method = RequestMethod.enumValue(value(\":method\")?.first()!!)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dff47d79cbe7776b490b8fe4c26fc09266ff5daa"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODY5OTg4OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestFilter.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyNjozMlrOGVpBTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyNjozMlrOGVpBTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTM1OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              fun onRequestTrailers(trailers: RequestTrailers): FilterTrailerStatus<RequestHeaders>\n          \n          \n            \n              fun onRequestTrailers(trailers: RequestTrailers): FilterTrailerStatus<RequestTrailers>", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425345358", "createdAt": "2020-05-14T18:26:32Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestFilter.kt", "diffHunk": "@@ -0,0 +1,52 @@\n+package io.envoyproxy.envoymobile\n+\n+import java.nio.ByteBuffer\n+\n+/*\n+ * Filter executed for outbound requests, providing the ability to observe and mutate streams.\n+ */\n+interface RequestFilter: Filter {\n+  /**\n+   * Called by the filter manager once to initialize the filter callbacks that the filter should\n+   * use.\n+   *\n+   * @param callbacks: The callbacks for this filter to use to interact with the chain.\n+   */\n+  fun setRequestFilterCallbacks(callbacks: RequestFilterCallbacks)\n+\n+  /**\n+   * Called once when the request is initiated.\n+   *\n+   * Filters may mutate or delay the request headers.\n+   *\n+   * @param headers:   The current request headers.\n+   * @param endStream: Whether this is a headers-only request.\n+   *\n+   * @return: The header status containing headers with which to continue or buffer.\n+   */\n+  fun onRequestHeaders(headers: RequestHeaders, endStream: Boolean):\n+    FilterHeaderStatus<RequestHeaders>\n+\n+  /**\n+   * Called any number of times whenever body data is sent.\n+   *\n+   * Filters may mutate or buffer (defer and concatenate) the data.\n+   *\n+   * @param body:      The outbound body data chunk.\n+   * @param endStream: Whether this is the last data frame.\n+   *\n+   * @return: The data status containing body with which to continue or buffer.\n+   */\n+  fun onRequestData(body: ByteBuffer, endStream: Boolean): FilterDataStatus\n+\n+  /**\n+   * Called at most once when the request is closed from the client with trailers.\n+   *\n+   * Filters may mutate or delay the trailers.\n+   *\n+   * @param trailers: The outbound trailers.\n+   *\n+   * @return: The trailer status containing body with which to continue or buffer.\n+   */\n+  fun onRequestTrailers(trailers: RequestTrailers): FilterTrailerStatus<RequestHeaders>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcwMjU4OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyNzoyMFrOGVpDGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMTowNDo0NlrOGVuKeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTgxNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }\n          \n          \n            \n              val retryPolicy: RetryPolicy? by lazy { RetryPolicy(this) }\n          \n      \n    \n    \n  \n\nShouldn't this be optional?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425345816", "createdAt": "2020-05-14T18:27:20Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method: RequestMethod by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme: String by lazy { value(\":scheme\")?.first()!! }\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority: String by lazy { value(\":authority\")?.first()!! }\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path: String by lazy { value(\":path\")?.first()!! }\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4Mjg4OA==", "bodyText": "Constructors cannot return null", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425382888", "createdAt": "2020-05-14T19:35:35Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method: RequestMethod by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme: String by lazy { value(\":scheme\")?.first()!! }\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority: String by lazy { value(\":authority\")?.first()!! }\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path: String by lazy { value(\":path\")?.first()!! }\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTgxNg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NTYxMg==", "bodyText": "The constructor is not a \"failable\" constructor, no such concept in Kotlin afaict.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425385612", "createdAt": "2020-05-14T19:40:47Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method: RequestMethod by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme: String by lazy { value(\":scheme\")?.first()!! }\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority: String by lazy { value(\":authority\")?.first()!! }\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path: String by lazy { value(\":path\")?.first()!! }\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTgxNg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwMjY5Nw==", "bodyText": "@junr03 I think we should keep consistency here for this PR. It's a little weird/strange of a thing to do but we'll need to do something like this:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }\n          \n          \n            \n              val retryPolicy: RetryPolicy? by lazy {\n          \n          \n            \n                try {\n          \n          \n            \n                  RetryPolicy(this)\n          \n          \n            \n                } catch (t: Throwable) {\n          \n          \n            \n                  null\n          \n          \n            \n                }\n          \n          \n            \n              }", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425402697", "createdAt": "2020-05-14T20:12:59Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method: RequestMethod by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme: String by lazy { value(\":scheme\")?.first()!! }\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority: String by lazy { value(\":authority\")?.first()!! }\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path: String by lazy { value(\":path\")?.first()!! }\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTgxNg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQyOTYyNA==", "bodyText": "Yea +1 to this. Another option would be to make a static function that returns an optional ReturnPolicy? instead of having a throwing constructor. Not sure which is more \"acceptable\" \ud83e\udd37", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425429624", "createdAt": "2020-05-14T21:04:46Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestHeaders.kt", "diffHunk": "@@ -0,0 +1,55 @@\n+\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an outbound request.\n+ */\n+class RequestHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * Method for the request.\n+   */\n+  val method: RequestMethod by lazy { RequestMethod.enumValue(value(\":method\")?.first()!!) }\n+\n+  /**\n+   * The URL scheme for the request (i.e., \"https\").\n+   */\n+  val scheme: String by lazy { value(\":scheme\")?.first()!! }\n+\n+  /**\n+   * The URL authority for the request (i.e., \"api.foo.com\").\n+   */\n+  val authority: String by lazy { value(\":authority\")?.first()!! }\n+\n+  /**\n+   * The URL path for the request (i.e., \"/foo\").\n+   */\n+  val path: String by lazy { value(\":path\")?.first()!! }\n+\n+  /**\n+   * Retry policy to use for this request.\n+   */\n+  val retryPolicy: RetryPolicy by lazy { RetryPolicy(this) }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NTgxNg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcwODc5OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMapper.kt", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyOToxNlrOGVpHWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMTowNDo1NlrOGVuK1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NjkwNQ==", "bodyText": "\ud83e\udd14 how'd this work before? Do they work the same way @buildbreaker?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425346905", "createdAt": "2020-05-14T18:29:16Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMapper.kt", "diffHunk": "@@ -8,7 +8,7 @@ internal fun Request.outboundHeaders(): Map<String, List<String>> {\n     !entry.key.startsWith(\":\") && !entry.key.startsWith(\"x-envoy-mobile\")\n   })\n   result.putAll(retryPolicyHeaders)\n-  result[\":method\"] = listOf(method.stringValue())\n+  result[\":method\"] = listOf(method.stringValue)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4MjE2NQ==", "bodyText": "Was a method before: https://github.com/lyft/envoy-mobile/pull/840/files#diff-5075eb53390be0c0b1fc060ee9f6f359L23-L33", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425382165", "createdAt": "2020-05-14T19:34:15Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMapper.kt", "diffHunk": "@@ -8,7 +8,7 @@ internal fun Request.outboundHeaders(): Map<String, List<String>> {\n     !entry.key.startsWith(\":\") && !entry.key.startsWith(\"x-envoy-mobile\")\n   })\n   result.putAll(retryPolicyHeaders)\n-  result[\":method\"] = listOf(method.stringValue())\n+  result[\":method\"] = listOf(method.stringValue)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NjkwNQ=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NTgyNg==", "bodyText": "I homogenized all of the enums to use the same pattern", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425385826", "createdAt": "2020-05-14T19:41:15Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMapper.kt", "diffHunk": "@@ -8,7 +8,7 @@ internal fun Request.outboundHeaders(): Map<String, List<String>> {\n     !entry.key.startsWith(\":\") && !entry.key.startsWith(\"x-envoy-mobile\")\n   })\n   result.putAll(retryPolicyHeaders)\n-  result[\":method\"] = listOf(method.stringValue())\n+  result[\":method\"] = listOf(method.stringValue)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NjkwNQ=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQyOTcxOA==", "bodyText": "Nice", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425429718", "createdAt": "2020-05-14T21:04:56Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMapper.kt", "diffHunk": "@@ -8,7 +8,7 @@ internal fun Request.outboundHeaders(): Map<String, List<String>> {\n     !entry.key.startsWith(\":\") && !entry.key.startsWith(\"x-envoy-mobile\")\n   })\n   result.putAll(retryPolicyHeaders)\n-  result[\":method\"] = listOf(method.stringValue())\n+  result[\":method\"] = listOf(method.stringValue)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NjkwNQ=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcwOTcyOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyOTozN1rOGVpIAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxOTo0MjoxOFrOGVrhyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NzA3Mw==", "bodyText": "I think this can be internal", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425347073", "createdAt": "2020-05-14T18:29:37Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "diffHunk": "@@ -1,15 +1,33 @@\n package io.envoyproxy.envoymobile\n \n+import java.lang.IllegalArgumentException\n+\n /**\n  * Represents an HTTP request method.\n  */\n-enum class RequestMethod {\n-  DELETE,\n-  GET,\n-  HEAD,\n-  OPTIONS,\n-  PATCH,\n-  POST,\n-  PUT,\n-  TRACE\n+enum class RequestMethod(internal val stringValue: String) {\n+  DELETE(\"DELETE\"),\n+  GET(\"GET\"),\n+  HEAD(\"HEAD\"),\n+  OPTIONS(\"OPTIONS\"),\n+  PATCH(\"PATCH\"),\n+  POST(\"POST\"),\n+  PUT(\"PUT\"),\n+  TRACE(\"TRACE\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): RequestMethod {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NjQ0MA==", "bodyText": "I see where you are coming from. Everything outside of the module should deal with only enum types, not strings. I like that.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425386440", "createdAt": "2020-05-14T19:42:18Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "diffHunk": "@@ -1,15 +1,33 @@\n package io.envoyproxy.envoymobile\n \n+import java.lang.IllegalArgumentException\n+\n /**\n  * Represents an HTTP request method.\n  */\n-enum class RequestMethod {\n-  DELETE,\n-  GET,\n-  HEAD,\n-  OPTIONS,\n-  PATCH,\n-  POST,\n-  PUT,\n-  TRACE\n+enum class RequestMethod(internal val stringValue: String) {\n+  DELETE(\"DELETE\"),\n+  GET(\"GET\"),\n+  HEAD(\"HEAD\"),\n+  OPTIONS(\"OPTIONS\"),\n+  PATCH(\"PATCH\"),\n+  POST(\"POST\"),\n+  PUT(\"PUT\"),\n+  TRACE(\"TRACE\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): RequestMethod {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NzA3Mw=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxMTgzOnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseFilter.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDowOFrOGVpJRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDowOFrOGVpJRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NzM5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                FilterHeaderStatus<ResponseTrailers>\n          \n          \n            \n                FilterHeaderStatus<ResponseHeaders>", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425347399", "createdAt": "2020-05-14T18:30:08Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseFilter.kt", "diffHunk": "@@ -0,0 +1,70 @@\n+package io.envoyproxy.envoymobile\n+\n+import java.nio.ByteBuffer\n+\n+/*\n+ * Filter executed for inbound responses, providing the ability to observe and mutate streams.\n+ */\n+interface ResponseFilter: Filter {\n+  /**\n+   * Called by the filter manager once to initialize the filter callbacks that the filter should\n+   * use.\n+   *\n+   * @param callbacks: The callbacks for this filter to use to interact with the chain.\n+   */\n+  fun setResponseFilterCallbacks(callbacks: ResponseFilterCallbacks)\n+\n+  /**\n+   * Called once when the response is initiated.\n+   *\n+   * Filters may mutate or delay the response headers.\n+   *\n+   * @param headers:   The current response headers.\n+   * @param endStream: Whether this is a headers-only response.\n+   *\n+   * @return: The header status containing headers with which to continue or buffer.\n+   */\n+  fun onResponseHeaders(headers: ResponseHeaders, endStream: Boolean):\n+    FilterHeaderStatus<ResponseTrailers>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxMjM0OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseFilter.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDoxOFrOGVpJpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDoxOFrOGVpJpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NzQ5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              fun onResponseTrailers(trailers: RequestTrailers): FilterTrailerStatus<ResponseTrailers>\n          \n          \n            \n              fun onResponseTrailers(trailers: ResponseTrailers): FilterTrailerStatus<ResponseTrailers>", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425347495", "createdAt": "2020-05-14T18:30:18Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseFilter.kt", "diffHunk": "@@ -0,0 +1,70 @@\n+package io.envoyproxy.envoymobile\n+\n+import java.nio.ByteBuffer\n+\n+/*\n+ * Filter executed for inbound responses, providing the ability to observe and mutate streams.\n+ */\n+interface ResponseFilter: Filter {\n+  /**\n+   * Called by the filter manager once to initialize the filter callbacks that the filter should\n+   * use.\n+   *\n+   * @param callbacks: The callbacks for this filter to use to interact with the chain.\n+   */\n+  fun setResponseFilterCallbacks(callbacks: ResponseFilterCallbacks)\n+\n+  /**\n+   * Called once when the response is initiated.\n+   *\n+   * Filters may mutate or delay the response headers.\n+   *\n+   * @param headers:   The current response headers.\n+   * @param endStream: Whether this is a headers-only response.\n+   *\n+   * @return: The header status containing headers with which to continue or buffer.\n+   */\n+  fun onResponseHeaders(headers: ResponseHeaders, endStream: Boolean):\n+    FilterHeaderStatus<ResponseTrailers>\n+\n+  /**\n+   * Called any number of times whenever body data is received.\n+   *\n+   * Filters may mutate or buffer (defer and concatenate) the data.\n+   *\n+   * @param body:      The inbound body data chunk.\n+   * @param endStream: Whether this is the last data frame.\n+   *\n+   * @return: The data status containing body with which to continue or buffer.\n+   */\n+  fun onResponseData(body: ByteBuffer, endStream: Boolean): FilterDataStatus\n+\n+  /**\n+   * Called at most once when the response is closed from the server with trailers.\n+   *\n+   * Filters may mutate or delay the trailers.\n+   *\n+   * @param trailers: The inbound trailers.\n+   *\n+   * @return: The trailer status containing body with which to continue or buffer.\n+   */\n+  fun onResponseTrailers(trailers: RequestTrailers): FilterTrailerStatus<ResponseTrailers>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxMzU1OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseHeaders.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDozOVrOGVpKZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDozOVrOGVpKZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NzY4Nw==", "bodyText": "This one should be lazy as well", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425347687", "createdAt": "2020-05-14T18:30:39Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseHeaders.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Headers representing an inbound response.\n+ */\n+class ResponseHeaders: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param headers: Headers to set.\n+   */\n+  internal constructor(headers: Map<String, List<String>>) : super(headers)\n+\n+  /**\n+   * HTTP status code received with the response.\n+   */\n+  val httpStatus = value(\":status\")?.first()?.toIntOrNull()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxNDA3OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseTrailers.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDo1MlrOGVpKzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMDo1MlrOGVpKzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0Nzc4OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param trailers: Headers to set.\n          \n          \n            \n               * @param trailers: Trailers to set.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425347789", "createdAt": "2020-05-14T18:30:52Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/ResponseTrailers.kt", "diffHunk": "@@ -0,0 +1,14 @@\n+package io.envoyproxy.envoymobile\n+\n+/*\n+ * Trailers representing an inbound response.\n+ */\n+@Suppress(\"EmptyClassBlock\")\n+class ResponseTrailers: Headers {\n+  /**\n+   * Internal constructor used by builders.\n+   *\n+   * @param trailers: Headers to set.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxNjY5OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMTozOVrOGVpMkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMTowNTo1MVrOGVuMsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODI0Mg==", "bodyText": "I think we should avoid crashing here like we do in Swift (and early return)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425348242", "createdAt": "2020-05-14T18:31:39Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,18 +25,49 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4ODcwMA==", "bodyText": "Same as above, there is no concept of a failable constructor. So our option is to have a default value, or crash.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425388700", "createdAt": "2020-05-14T19:46:25Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,18 +25,49 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODI0Mg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQzMDE5NQ==", "bodyText": "#840 (comment)", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425430195", "createdAt": "2020-05-14T21:05:51Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,18 +25,49 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODI0Mg=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxODM2OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMjoxMVrOGVpNow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMjoxMVrOGVpNow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODUxNQ==", "bodyText": "Can be internal", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425348515", "createdAt": "2020-05-14T18:32:11Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RetryPolicy.kt", "diffHunk": "@@ -25,18 +25,49 @@ data class RetryPolicy(\n       throw IllegalArgumentException(\"Per-retry timeout cannot be less than total timeout\")\n     }\n   }\n+\n+  /**\n+   * Initialize the retry policy from a set of headers.\n+   *\n+   * @param headers: The headers with which to initialize the retry policy.\n+   */\n+  constructor(headers: Headers): this(\n+      headers.value(\"x-envoy-max-retries\")?.first()!!.toInt(),\n+      // TODO: should we have ? after the map?\n+      headers.value(\"x-envoy-retry-on\")\n+        ?.map { retryOn -> RetryRule.enumValue(retryOn) }?.filterNotNull() ?: emptyList(),\n+      headers.value(\"x-envoy-retriable-status-codes\")\n+        ?.map { statusCode -> statusCode.toIntOrNull() }?.filterNotNull() ?: emptyList(),\n+      headers.value(\"x-envoy-upstream-rq-per-try-timeout-ms\")?.firstOrNull()?.toLongOrNull(),\n+      headers.value(\"x-envoy-upstream-rq-timeout-ms\")?.firstOrNull()?.toLongOrNull()\n+    )\n }\n \n /**\n  * Rules that may be used with `RetryPolicy`.\n  * See the `x-envoy-retry-on` Envoy header for documentation.\n  */\n-enum class RetryRule {\n-  STATUS_5XX,\n-  GATEWAY_ERROR,\n-  CONNECT_FAILURE,\n-  REFUSED_STREAM,\n-  RETRIABLE_4XX,\n-  RETRIABLE_HEADERS,\n-  RESET,\n+enum class RetryRule(internal val stringValue: String) {\n+  STATUS_5XX(\"5xx\"),\n+  GATEWAY_ERROR(\"gateway-error\"),\n+  CONNECT_FAILURE(\"connect-failure\"),\n+  REFUSED_STREAM(\"refused-stream\"),\n+  RETRIABLE_4XX(\"retriable-4xx\"),\n+  RETRIABLE_HEADERS(\"retriable-headers\"),\n+  RESET(\"reset\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): RetryRule? {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcxOTI0OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/UpstreamHttpProtocol.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMjoyOFrOGVpONw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMjoyOFrOGVpONw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODY2Mw==", "bodyText": "Internal", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425348663", "createdAt": "2020-05-14T18:32:28Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/UpstreamHttpProtocol.kt", "diffHunk": "@@ -5,5 +5,15 @@ package io.envoyproxy.envoymobile\n  */\n enum class UpstreamHttpProtocol(internal val stringValue: String) {\n   HTTP1(\"http1\"),\n-  HTTP2(\"http2\"),\n+  HTTP2(\"http2\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): UpstreamHttpProtocol {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0ODcyMDY3OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/UpstreamHttpProtocol.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODozMjo1M1rOGVpPIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxOTo1ODoxNlrOGVsD7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODg5Nw==", "bodyText": "I noticed that some of these throw and others are nullable. Should we keep them consistent?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425348897", "createdAt": "2020-05-14T18:32:53Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/UpstreamHttpProtocol.kt", "diffHunk": "@@ -5,5 +5,15 @@ package io.envoyproxy.envoymobile\n  */\n enum class UpstreamHttpProtocol(internal val stringValue: String) {\n   HTTP1(\"http1\"),\n-  HTTP2(\"http2\"),\n+  HTTP2(\"http2\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): UpstreamHttpProtocol {\n+      return when (stringRepresentation) {\n+        \"http1\" -> UpstreamHttpProtocol.HTTP1\n+        \"http2\" -> UpstreamHttpProtocol.HTTP2\n+        else -> throw IllegalArgumentException(\"Unable to find value for $stringRepresentation\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5NTE4MA==", "bodyText": "We had it that way because of the automatic addition of \"retriable-status-codes\", although I'd rather throw in all of them. I have updated to something I think is better.", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425395180", "createdAt": "2020-05-14T19:58:16Z", "author": {"login": "junr03"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/UpstreamHttpProtocol.kt", "diffHunk": "@@ -5,5 +5,15 @@ package io.envoyproxy.envoymobile\n  */\n enum class UpstreamHttpProtocol(internal val stringValue: String) {\n   HTTP1(\"http1\"),\n-  HTTP2(\"http2\"),\n+  HTTP2(\"http2\");\n+\n+  companion object {\n+    fun enumValue(stringRepresentation: String): UpstreamHttpProtocol {\n+      return when (stringRepresentation) {\n+        \"http1\" -> UpstreamHttpProtocol.HTTP1\n+        \"http2\" -> UpstreamHttpProtocol.HTTP2\n+        else -> throw IllegalArgumentException(\"Unable to find value for $stringRepresentation\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0ODg5Nw=="}, "originalCommit": {"oid": "23feee94ac3038e6f22ea2959783eb7297c3dc37"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0OTczMzQ3OnYy", "diffSide": "RIGHT", "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwMTowNzowMFrOGVzKEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1OTo1M1rOGWOq4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUxMTQ0Mg==", "bodyText": "Non-blocking: Do we return nil in swift?", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425511442", "createdAt": "2020-05-15T01:07:00Z", "author": {"login": "buildbreaker"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "diffHunk": "@@ -1,15 +1,33 @@\n package io.envoyproxy.envoymobile\n \n+import java.lang.IllegalArgumentException\n+\n /**\n  * Represents an HTTP request method.\n  */\n-enum class RequestMethod {\n-  DELETE,\n-  GET,\n-  HEAD,\n-  OPTIONS,\n-  PATCH,\n-  POST,\n-  PUT,\n-  TRACE\n+enum class RequestMethod(internal val stringValue: String) {\n+  DELETE(\"DELETE\"),\n+  GET(\"GET\"),\n+  HEAD(\"HEAD\"),\n+  OPTIONS(\"OPTIONS\"),\n+  PATCH(\"PATCH\"),\n+  POST(\"POST\"),\n+  PUT(\"PUT\"),\n+  TRACE(\"TRACE\");\n+\n+  companion object {\n+    internal fun enumValue(stringRepresentation: String): RequestMethod {\n+      return when (stringRepresentation) {\n+        \"DELETE\" -> RequestMethod.DELETE\n+        \"GET\" -> RequestMethod.GET\n+        \"HEAD\" -> RequestMethod.HEAD\n+        \"OPTIONS\" -> RequestMethod.OPTIONS\n+        \"PATCH\" -> RequestMethod.PATCH\n+        \"POST\" -> RequestMethod.POST\n+        \"PUT\" -> RequestMethod.PUT\n+        \"TRACE\" -> RequestMethod.TRACE\n+        else -> throw IllegalArgumentException(\"invalid value $stringRepresentation\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d37812946e2456920d90cf6da1c5394b9ad7648"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MjIxMA==", "bodyText": "We do now \ud83d\ude43", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425962210", "createdAt": "2020-05-15T17:59:53Z", "author": {"login": "rebello95"}, "path": "library/kotlin/src/io/envoyproxy/envoymobile/RequestMethod.kt", "diffHunk": "@@ -1,15 +1,33 @@\n package io.envoyproxy.envoymobile\n \n+import java.lang.IllegalArgumentException\n+\n /**\n  * Represents an HTTP request method.\n  */\n-enum class RequestMethod {\n-  DELETE,\n-  GET,\n-  HEAD,\n-  OPTIONS,\n-  PATCH,\n-  POST,\n-  PUT,\n-  TRACE\n+enum class RequestMethod(internal val stringValue: String) {\n+  DELETE(\"DELETE\"),\n+  GET(\"GET\"),\n+  HEAD(\"HEAD\"),\n+  OPTIONS(\"OPTIONS\"),\n+  PATCH(\"PATCH\"),\n+  POST(\"POST\"),\n+  PUT(\"PUT\"),\n+  TRACE(\"TRACE\");\n+\n+  companion object {\n+    internal fun enumValue(stringRepresentation: String): RequestMethod {\n+      return when (stringRepresentation) {\n+        \"DELETE\" -> RequestMethod.DELETE\n+        \"GET\" -> RequestMethod.GET\n+        \"HEAD\" -> RequestMethod.HEAD\n+        \"OPTIONS\" -> RequestMethod.OPTIONS\n+        \"PATCH\" -> RequestMethod.PATCH\n+        \"POST\" -> RequestMethod.POST\n+        \"PUT\" -> RequestMethod.PUT\n+        \"TRACE\" -> RequestMethod.TRACE\n+        else -> throw IllegalArgumentException(\"invalid value $stringRepresentation\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUxMTQ0Mg=="}, "originalCommit": {"oid": "7d37812946e2456920d90cf6da1c5394b9ad7648"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0OTczNDY1OnYy", "diffSide": "RIGHT", "path": "library/swift/src/RequestMethod.swift", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwMTowNzo0M1rOGVzKwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwMTowNzo0M1rOGVzKwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUxMTYxNg==", "bodyText": "We do now!", "url": "https://github.com/envoyproxy/envoy-mobile/pull/840#discussion_r425511616", "createdAt": "2020-05-15T01:07:43Z", "author": {"login": "buildbreaker"}, "path": "library/swift/src/RequestMethod.swift", "diffHunk": "@@ -56,7 +56,7 @@ public enum RequestMethod: Int, CaseIterable {\n     case \"TRACE\":\n       self = .trace\n     default:\n-      return nil\n+      fatalError(\"invalid value '\\(stringValue)'\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d37812946e2456920d90cf6da1c5394b9ad7648"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 789, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}