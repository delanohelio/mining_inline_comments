{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4MDU2NDE3", "number": 898, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQwNDoxNjo0MFrODoF2hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyNDoxNFrODofTPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzY1NTA4OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQwNDoxNjo0MFrOF2c1pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNDozNzozMFrOF2lVGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYzOTkwOQ==", "bodyText": "Shall we just call it deleteCloudConfigFields?", "url": "https://github.com/apache/helix/pull/898#discussion_r392639909", "createdAt": "2020-03-15T04:16:40Z", "author": {"login": "zhangmeng916"}, "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "diffHunk": "@@ -604,7 +604,47 @@ public CloudConfig getCloudConfig(String clusterName) {\n       return null;\n     }\n \n-    return new CloudConfig.Builder(record).build();\n+    return new CloudConfig(record);\n+  }\n+\n+  /**\n+   * Delete cloud config fields (not the whole config)\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void deleteCloudConfigPatrial(String clusterName, CloudConfig cloudConfig) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3OTAzNA==", "bodyText": "Changed to deleteCloudConfigFields.", "url": "https://github.com/apache/helix/pull/898#discussion_r392779034", "createdAt": "2020-03-16T04:37:30Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "diffHunk": "@@ -604,7 +604,47 @@ public CloudConfig getCloudConfig(String clusterName) {\n       return null;\n     }\n \n-    return new CloudConfig.Builder(record).build();\n+    return new CloudConfig(record);\n+  }\n+\n+  /**\n+   * Delete cloud config fields (not the whole config)\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void deleteCloudConfigPatrial(String clusterName, CloudConfig cloudConfig) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYzOTkwOQ=="}, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzY1NTI2OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQwNDoxNzoxN1rOF2c1vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNDozNzo0NFrOF2lVRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYzOTkzMg==", "bodyText": "Thanks for help modify this part.", "url": "https://github.com/apache/helix/pull/898#discussion_r392639932", "createdAt": "2020-03-15T04:17:17Z", "author": {"login": "zhangmeng916"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3OTA3Ng==", "bodyText": "No problem :)", "url": "https://github.com/apache/helix/pull/898#discussion_r392779076", "createdAt": "2020-03-16T04:37:44Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYzOTkzMg=="}, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzY2MjIzOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQwNDozOToxNFrOF2c5RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwNDo0MjoyNlrOF2lYkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY0MDgzNw==", "bodyText": "Based on the current design, if user needs to use Java API instead of REST, they need to call HelixAdmin for add and remove, call ConfigAccessor for get, update and delete fields. Is this separation intended? Seems not intuitive.", "url": "https://github.com/apache/helix/pull/898#discussion_r392640837", "createdAt": "2020-03-15T04:39:14Z", "author": {"login": "zhangmeng916"}, "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "diffHunk": "@@ -604,7 +604,47 @@ public CloudConfig getCloudConfig(String clusterName) {\n       return null;\n     }\n \n-    return new CloudConfig.Builder(record).build();\n+    return new CloudConfig(record);\n+  }\n+\n+  /**\n+   * Delete cloud config fields (not the whole config)\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void deleteCloudConfigPatrial(String clusterName, CloudConfig cloudConfig) {\n+    if (!ZKUtil.isClusterSetup(clusterName, _zkClient)) {\n+      throw new HelixException(\"fail to delete cloud config. cluster: \" + clusterName + \" is NOT setup.\");\n+    }\n+\n+    HelixConfigScope scope =\n+        new HelixConfigScopeBuilder(ConfigScopeProperty.CLOUD).forCluster(clusterName).build();\n+    remove(scope, cloudConfig.getRecord());\n+  }\n+\n+  /**\n+   * Update cloud config\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void updateCloudConfig(String clusterName, CloudConfig cloudConfig) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjc3OTkyMg==", "bodyText": "Basically, completely add or remove of cloud config seems to be admin work because it won't be used frequently (mainly used for cluster creation). I also find other similar API calls such as removeConfig in the HelixAdmin. However, updating or modifying such config are lower lever operations which have been implemented in ConfigAccessor.", "url": "https://github.com/apache/helix/pull/898#discussion_r392779922", "createdAt": "2020-03-16T04:42:26Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/ConfigAccessor.java", "diffHunk": "@@ -604,7 +604,47 @@ public CloudConfig getCloudConfig(String clusterName) {\n       return null;\n     }\n \n-    return new CloudConfig.Builder(record).build();\n+    return new CloudConfig(record);\n+  }\n+\n+  /**\n+   * Delete cloud config fields (not the whole config)\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void deleteCloudConfigPatrial(String clusterName, CloudConfig cloudConfig) {\n+    if (!ZKUtil.isClusterSetup(clusterName, _zkClient)) {\n+      throw new HelixException(\"fail to delete cloud config. cluster: \" + clusterName + \" is NOT setup.\");\n+    }\n+\n+    HelixConfigScope scope =\n+        new HelixConfigScopeBuilder(ConfigScopeProperty.CLOUD).forCluster(clusterName).build();\n+    remove(scope, cloudConfig.getRecord());\n+  }\n+\n+  /**\n+   * Update cloud config\n+   * @param clusterName\n+   * @param cloudConfig\n+   */\n+  public void updateCloudConfig(String clusterName, CloudConfig cloudConfig) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY0MDgzNw=="}, "originalCommit": {"oid": "666268710e4e15ee10000ebce94c287df0986d8f"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzgyMzMxOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyMzo0NlrOF3EefQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyNjowMlrOF3Eiig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTM0MQ==", "bodyText": "What happened here?", "url": "https://github.com/apache/helix/pull/898#discussion_r393289341", "createdAt": "2020-03-16T20:23:46Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";\n \n         AzureCloudInstanceInformation.Builder builder = new AzureCloudInstanceInformation.Builder();\n-        builder.setInstanceName(vmName).setFaultDomain(domain)\n-            .setInstanceSetName(vmssName);\n+        builder.setInstanceName(vmName).setFaultDomain(domain).setInstanceSetName(vmssName);\n         azureCloudInstanceInformation = builder.build();\n       }\n     } catch (IOException e) {\n-      throw new HelixException(String.format(\"Error in parsing cloud instance information: {}\", response, e));\n+      throw new HelixException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19da28ae37a6359cb48ecc9fcac84feb2822d59d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MDM3OA==", "bodyText": "I checked the format/style and fix it while working on this file.", "url": "https://github.com/apache/helix/pull/898#discussion_r393290378", "createdAt": "2020-03-16T20:26:02Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";\n \n         AzureCloudInstanceInformation.Builder builder = new AzureCloudInstanceInformation.Builder();\n-        builder.setInstanceName(vmName).setFaultDomain(domain)\n-            .setInstanceSetName(vmssName);\n+        builder.setInstanceName(vmName).setFaultDomain(domain).setInstanceSetName(vmssName);\n         azureCloudInstanceInformation = builder.build();\n       }\n     } catch (IOException e) {\n-      throw new HelixException(String.format(\"Error in parsing cloud instance information: {}\", response, e));\n+      throw new HelixException(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTM0MQ=="}, "originalCommit": {"oid": "19da28ae37a6359cb48ecc9fcac84feb2822d59d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzgyNDYxOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyNDoxNFrOF3EfXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyNjoxOVrOF3EjBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTU2NQ==", "bodyText": "Is this format issue?", "url": "https://github.com/apache/helix/pull/898#discussion_r393289565", "createdAt": "2020-03-16T20:24:14Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";\n \n         AzureCloudInstanceInformation.Builder builder = new AzureCloudInstanceInformation.Builder();\n-        builder.setInstanceName(vmName).setFaultDomain(domain)\n-            .setInstanceSetName(vmssName);\n+        builder.setInstanceName(vmName).setFaultDomain(domain).setInstanceSetName(vmssName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19da28ae37a6359cb48ecc9fcac84feb2822d59d"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MDUwMA==", "bodyText": "I checked the format/style and fix it while working on this file.", "url": "https://github.com/apache/helix/pull/898#discussion_r393290500", "createdAt": "2020-03-16T20:26:19Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/cloud/azure/AzureCloudInstanceInformationProcessor.java", "diffHunk": "@@ -145,15 +145,15 @@ public AzureCloudInstanceInformation parseCloudInstanceInformation(List<String>\n         String azureTopology = AzureConstants.AZURE_TOPOLOGY;\n         String[] parts = azureTopology.trim().split(\"/\");\n         //The hostname will be filled in by each participant\n-        String domain = parts[0] + \"=\" + platformFaultDomain + \",\" + parts[1] + \"=\";\n+        String domain = parts[1] + \"=\" + platformFaultDomain + \",\" + parts[2] + \"=\";\n \n         AzureCloudInstanceInformation.Builder builder = new AzureCloudInstanceInformation.Builder();\n-        builder.setInstanceName(vmName).setFaultDomain(domain)\n-            .setInstanceSetName(vmssName);\n+        builder.setInstanceName(vmName).setFaultDomain(domain).setInstanceSetName(vmssName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTU2NQ=="}, "originalCommit": {"oid": "19da28ae37a6359cb48ecc9fcac84feb2822d59d"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1391, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}