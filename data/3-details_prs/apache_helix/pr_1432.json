{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTY4NDA3", "number": 1432, "title": "Enhancement of ClusterVerifier and TaskDriver", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\nFix #1431\nfix clusterVerifier to take waitTillVeriy and also enhance\nlogging of TaskDriver and TaskUtil to make sure the job\nadding and selective update race condition would have a\nlog\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\n\nRunning\nTests\n\n The following tests are written for this issue:\n\n(List the names of added unit/integration tests)\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\nAll test passed. See this link from github https://github.com/apache/helix/runs/1201249679?check_suite_focus=true\nThe following is the last part of the result of mvn test\n\ntestCluster-823c9bca-693f-4b04-8e28-687f0c392cdf, STATEMODELDEFS]\n2020-10-03T00:11:06.9787433Z 4254322 [TestNGInvoker-testP2PWithInstanceOffline()] ERROR org.apache.helix.common.caches.InstanceMessagesCache  - Target state for partition testDB_0 matches the hosted message's target state, set relay message 377cd66d-5166-47e3-9a59-a3c9e2ae19b6 to be expired.\n2020-10-03T00:11:07.0293029Z keySplit:[, testCluster-823c9bca-693f-4b04-8e28-687f0c392cdf, INSTANCES, localhost_0, MESSAGES]\n2020-10-03T00:11:07.0305557Z pathSplit:[, testCluster-823c9bca-693f-4b04-8e28-687f0c392cdf, INSTANCES, localhost_0, MESSAGES]\n2020-10-03T00:11:07.0307510Z END testP2PWithInstanceOffline at Sat Oct 03 00:11:07 UTC 2020, took: 960ms.\n2020-10-03T00:11:07.0308546Z END TestP2PMessages at Sat Oct 03 00:11:07 UTC 2020\n2020-10-03T00:11:07.0309791Z START TestP2PWithStateCancellationMessage at Sat Oct 03 00:11:07 UTC 2020\n2020-10-03T00:11:07.0311509Z START testP2PWithStateCancellationMessage at Sat Oct 03 00:11:07 UTC 2020\n2020-10-03T00:11:07.8645832Z END testP2PWithStateCancellationMessage at Sat Oct 03 00:11:07 UTC 2020, took: 833ms.\n2020-10-03T00:11:07.8647681Z END TestP2PWithStateCancellationMessage at Sat Oct 03 00:11:07 UTC 2020\n2020-10-03T00:11:08.1968465Z Shut down zookeeper at port 2183 in thread main\n\nDocumentation (Optional)\n\nIn case of new functionality, my PR adds documentation in the following wiki page:\n\n(Link the GitHub wiki you added)\nCommits\n\nMy commits all reference appropriate Apache Helix GitHub issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\nMy diff has been formatted using helix-style.xml\n(helix-style-intellij.xml if IntelliJ IDE is used)", "createdAt": "2020-10-02T22:57:31Z", "url": "https://github.com/apache/helix/pull/1432", "merged": true, "mergeCommit": {"oid": "5dfd02e329d5a709176e571381f0c2adf78383a3"}, "closed": true, "closedAt": "2020-10-06T01:44:04Z", "author": {"login": "kaisun2000"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOuA2OAH2gAyNDk3MTY4NDA3OmMwMDI0ZDA1OTg2MWU0MTZiYWNhYTYzNzE4MjM3MmQyOTA5NWU3Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPt_IZgFqTUwMjUyMjgyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c0024d059861e416bacaa637182372d29095e769", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/c0024d059861e416bacaa637182372d29095e769", "committedDate": "2020-10-02T22:48:44Z", "message": "Ehancement of ClusterVerifier and TaskDriver #1431\n\nfix clusterVerifier to take waitTillVeriy and also enhance\nlogging of TaskDriver and TaskUtil to make sure the job\nadding and selective update race condition would have a\nlog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2c3f44fee0c6616331b268b800081e89969aa07", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/e2c3f44fee0c6616331b268b800081e89969aa07", "committedDate": "2020-10-02T23:53:45Z", "message": "fix a space"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a8a70c898322e1eee73e192b5a7af843ea7d9ae", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/7a8a70c898322e1eee73e192b5a7af843ea7d9ae", "committedDate": "2020-10-03T02:39:59Z", "message": "add track issue #1245"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNTAyNzM3", "url": "https://github.com/apache/helix/pull/1432#pullrequestreview-502502737", "createdAt": "2020-10-06T00:12:33Z", "commit": {"oid": "7a8a70c898322e1eee73e192b5a7af843ea7d9ae"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMDoxMjozM1rOHcx0Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMDoxMzoxM1rOHcx08Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkzODM3NA==", "bodyText": "Note that these constructors are deprecated and suggest to use builder. So you may also want to add this new parameter to the builder.", "url": "https://github.com/apache/helix/pull/1432#discussion_r499938374", "createdAt": "2020-10-06T00:12:33Z", "author": {"login": "zhangmeng916"}, "path": "helix-core/src/main/java/org/apache/helix/tools/ClusterVerifiers/BestPossibleExternalViewVerifier.java", "diffHunk": "@@ -78,8 +78,8 @@\n    */\n   @Deprecated\n   public BestPossibleExternalViewVerifier(String zkAddr, String clusterName, Set<String> resources,\n-      Map<String, Map<String, String>> errStates, Set<String> expectLiveInstances) {\n-    super(zkAddr, clusterName);\n+      Map<String, Map<String, String>> errStates, Set<String> expectLiveInstances, int waitTillVerify) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a8a70c898322e1eee73e192b5a7af843ea7d9ae"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkzODU0NQ==", "bodyText": "Could you please add some doc about the rationale of adding waiting time?", "url": "https://github.com/apache/helix/pull/1432#discussion_r499938545", "createdAt": "2020-10-06T00:13:13Z", "author": {"login": "zhangmeng916"}, "path": "helix-core/src/main/java/org/apache/helix/tools/ClusterVerifiers/BestPossibleExternalViewVerifier.java", "diffHunk": "@@ -78,8 +78,8 @@\n    */\n   @Deprecated\n   public BestPossibleExternalViewVerifier(String zkAddr, String clusterName, Set<String> resources,\n-      Map<String, Map<String, String>> errStates, Set<String> expectLiveInstances) {\n-    super(zkAddr, clusterName);\n+      Map<String, Map<String, String>> errStates, Set<String> expectLiveInstances, int waitTillVerify) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a8a70c898322e1eee73e192b5a7af843ea7d9ae"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34cd67898b02cfc1d6afdf9f85dc6eeabb2b0fbd", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/34cd67898b02cfc1d6afdf9f85dc6eeabb2b0fbd", "committedDate": "2020-10-06T01:15:18Z", "message": "address Meng's feedback."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNTIyODI0", "url": "https://github.com/apache/helix/pull/1432#pullrequestreview-502522824", "createdAt": "2020-10-06T01:20:47Z", "commit": {"oid": "34cd67898b02cfc1d6afdf9f85dc6eeabb2b0fbd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4317, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}