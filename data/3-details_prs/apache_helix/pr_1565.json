{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NzYwMTE4", "number": 1565, "title": "Refine task framework log", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\n#1510 - Improve debuggability in Task Framework\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\n\nImprove debuggability in Task Framework\nTests\n\n\n The following tests are written for this issue:\nNA\n\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\n\n[INFO] Tests run: 1251, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 5,521.423 s - in TestSuite\n[INFO]\n[INFO] Results:\n[INFO]\n[INFO] Tests run: 1251, Failures: 0, Errors: 0, Skipped: 0\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  01:32 h\n[INFO] Finished at: 2020-11-25T17:58:27-08:00\n[INFO] ------------------------------------------------------------------------\n\nDocumentation (Optional)\n\nIn case of new functionality, my PR adds documentation in the following wiki page:\n\n(Link the GitHub wiki you added)\nCommits\n\nMy commits all reference appropriate Apache Helix GitHub issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\nMy diff has been formatted using helix-style.xml\n(helix-style-intellij.xml if IntelliJ IDE is used)", "createdAt": "2020-11-30T19:25:44Z", "url": "https://github.com/apache/helix/pull/1565", "merged": true, "mergeCommit": {"oid": "2e30348d1447f0a107e6c19f59e38d37662787fa"}, "closed": true, "closedAt": "2020-12-04T04:47:51Z", "author": {"login": "xyuanlu"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgF2hCgH2gAyNTI5NzYwMTE4OjcwMGVlODJhNjgwMTlmZDhlMzIwYTBhNGQ1ZjRiYjk0YWEwYzBkMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiSLlIAFqTU0MzA4NDM0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "700ee82a68019fd8e320a0a4d5f4bb94aa0c0d22", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/700ee82a68019fd8e320a0a4d5f4bb94aa0c0d22", "committedDate": "2020-11-25T22:11:53Z", "message": "log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53b5b056822f29cd36b2639a496d247a6eb25f31", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/53b5b056822f29cd36b2639a496d247a6eb25f31", "committedDate": "2020-11-25T22:11:53Z", "message": "refine log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56c9ecebbb09ec6f03ef5b0b59343ec57a02b41d", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/56c9ecebbb09ec6f03ef5b0b59343ec57a02b41d", "committedDate": "2020-11-26T00:21:59Z", "message": "audit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "433688723bcaa0fc9474937abac49daba1538a8d", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/433688723bcaa0fc9474937abac49daba1538a8d", "committedDate": "2020-11-30T19:22:29Z", "message": "fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMjEyODM3", "url": "https://github.com/apache/helix/pull/1565#pullrequestreview-542212837", "createdAt": "2020-12-01T19:09:47Z", "commit": {"oid": "433688723bcaa0fc9474937abac49daba1538a8d"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxOTowOTo0N1rOH87xCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxOToxMTo0NlrOH871KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY1NTgxOA==", "bodyText": "This may confusing. Originally it tells us the command should be either in job config or task config. But when you dd job name and task id can distract the focus.\nYou can change it as: \"Command must exist in either jobconfig (jobname) or taskconfig (taskid)\" something.", "url": "https://github.com/apache/helix/pull/1565#discussion_r533655818", "createdAt": "2020-12-01T19:09:47Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/TaskDriver.java", "diffHunk": "@@ -804,7 +803,9 @@ private void validateConfigsForTaskModifications(String workflowName, String job\n     }\n \n     if ((taskConfig.getCommand() == null) == (jobConfig.getCommand() == null)) {\n-      throw new HelixException(\"Command must exist in either job or task, not both!\");\n+      throw new HelixException(String\n+          .format(\"Command must exist in either job %s or task %s, not both!\", jobName,\n+              taskConfig.getId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "433688723bcaa0fc9474937abac49daba1538a8d"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY1NjI4NA==", "bodyText": "This could cause runtime exception. Not workflow + state.", "url": "https://github.com/apache/helix/pull/1565#discussion_r533656284", "createdAt": "2020-12-01T19:10:37Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/TaskDriver.java", "diffHunk": "@@ -1065,16 +1066,16 @@ private void setSingleWorkflowTargetState(String workflow, final TargetState sta\n \n     WorkflowConfig workflowConfig = TaskUtil.getWorkflowConfig(_accessor, workflow);\n     if (workflowConfig == null) {\n-      LOG.warn(\"WorkflowConfig for \" + workflow + \" not found!\");\n+      LOG.warn(\"WorkflowConfig for {} not found!\", workflow);\n       return;\n     }\n \n     WorkflowContext workflowContext = TaskUtil.getWorkflowContext(_propertyStore, workflow);\n     if (state != TargetState.DELETE && workflowContext != null\n         && workflowContext.getFinishTime() != WorkflowContext.UNFINISHED) {\n       // Should not update target state for completed workflow\n-      LOG.info(\"Workflow \" + workflow + \" is already completed, skip to update its target state \"\n-          + state);\n+      LOG.info(\"Workflow {} is already completed, skip to update its target state {}\",\n+          workflow + state);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "433688723bcaa0fc9474937abac49daba1538a8d"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY1Njg3Mg==", "bodyText": "The quote gives us clear range in naming. If you dont like to see the escaper, then let's have \"()\" to bound the names.", "url": "https://github.com/apache/helix/pull/1565#discussion_r533656872", "createdAt": "2020-12-01T19:11:46Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/TaskDriver.java", "diffHunk": "@@ -1173,7 +1176,7 @@ public TaskState pollForWorkflowState(String workflowName, long timeout,\n \n     if (ctx == null || !allowedStates.contains(ctx.getWorkflowState())) {\n       throw new HelixException(String.format(\n-          \"Workflow \\\"%s\\\" context is empty or not in states: \\\"%s\\\", current state: \\\"%s\\\"\",\n+          \"Workflow %s context is empty or not in states: %s, current state: %s.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "433688723bcaa0fc9474937abac49daba1538a8d"}, "originalPosition": 106}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzc5NzEy", "url": "https://github.com/apache/helix/pull/1565#pullrequestreview-542379712", "createdAt": "2020-12-01T23:21:57Z", "commit": {"oid": "91df43c0f7c75b72dcb168fd966438611360ceba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02a87eb9dd80fef668ba402ec0c742dc62e0d00f", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/02a87eb9dd80fef668ba402ec0c742dc62e0d00f", "committedDate": "2020-12-01T23:50:32Z", "message": "address commends"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91df43c0f7c75b72dcb168fd966438611360ceba", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/91df43c0f7c75b72dcb168fd966438611360ceba", "committedDate": "2020-12-01T21:58:28Z", "message": "address commends"}, "afterCommit": {"oid": "02a87eb9dd80fef668ba402ec0c742dc62e0d00f", "author": {"user": {"login": "xyuanlu", "name": null}}, "url": "https://github.com/apache/helix/commit/02a87eb9dd80fef668ba402ec0c742dc62e0d00f", "committedDate": "2020-12-01T23:50:32Z", "message": "address commends"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDg0MzQz", "url": "https://github.com/apache/helix/pull/1565#pullrequestreview-543084343", "createdAt": "2020-12-02T17:41:36Z", "commit": {"oid": "02a87eb9dd80fef668ba402ec0c742dc62e0d00f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4155, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}