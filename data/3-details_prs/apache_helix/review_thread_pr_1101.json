{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MTA3Njcy", "number": 1101, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMDoyMToxMFrOEG88EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMDoyNDozNFrOEG8-Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzI1MzI4OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMDoyMToxMFrOGmEMzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMjoyMjoxMFrOGnS8cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2Nzg4Ng==", "bodyText": "I think it would be simpler that we let the caller checking this dependency but not the record method.\nSo just do\nif (stateChange) {}\nif (dataChange) {}\nif (sessionExpired) {}", "url": "https://github.com/apache/helix/pull/1101#discussion_r442567886", "createdAt": "2020-06-19T00:21:10Z", "author": {"login": "jiajunwang"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -2138,11 +2139,14 @@ private void recordFailure(String path, ZkClientMonitor.AccessType accessType) {\n     }\n   }\n \n-  private void recordStateChange(boolean stateChanged, boolean dataChanged) {\n+  private void recordStateChange(boolean stateChanged, boolean dataChanged, boolean sessionExpired) {\n     // update state change counter.\n     if (_monitor != null) {\n       if (stateChanged) {\n         _monitor.increaseStateChangeEventCounter();\n+        if (sessionExpired) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2606680f59d667b969d91765cf567cb2df758dc"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg1ODAzMg==", "bodyText": "Updated.", "url": "https://github.com/apache/helix/pull/1101#discussion_r443858032", "createdAt": "2020-06-22T22:22:10Z", "author": {"login": "xyuanlu"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -2138,11 +2139,14 @@ private void recordFailure(String path, ZkClientMonitor.AccessType accessType) {\n     }\n   }\n \n-  private void recordStateChange(boolean stateChanged, boolean dataChanged) {\n+  private void recordStateChange(boolean stateChanged, boolean dataChanged, boolean sessionExpired) {\n     // update state change counter.\n     if (_monitor != null) {\n       if (stateChanged) {\n         _monitor.increaseStateChangeEventCounter();\n+        if (sessionExpired) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2Nzg4Ng=="}, "originalCommit": {"oid": "e2606680f59d667b969d91765cf567cb2df758dc"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzI1OTE1OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/test/java/org/apache/helix/zookeeper/impl/client/TestRawZkClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMDoyNDozNFrOGmEQVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMjoyMjoxNFrOGnS8jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2ODc5MA==", "bodyText": "This looks duplicate to the testSessionExpiry method. Could you please merge the test logic if possible?", "url": "https://github.com/apache/helix/pull/1101#discussion_r442568790", "createdAt": "2020-06-19T00:24:34Z", "author": {"login": "jiajunwang"}, "path": "zookeeper-api/src/test/java/org/apache/helix/zookeeper/impl/client/TestRawZkClient.java", "diffHunk": "@@ -487,6 +488,50 @@ void testPendingRequestGauge()\n     }\n   }\n \n+  @Test(dependsOnMethods = \"testZkClientMonitor\")\n+  void testSessionExpireCount() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2606680f59d667b969d91765cf567cb2df758dc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg1ODA2Mw==", "bodyText": "Updated.", "url": "https://github.com/apache/helix/pull/1101#discussion_r443858063", "createdAt": "2020-06-22T22:22:14Z", "author": {"login": "xyuanlu"}, "path": "zookeeper-api/src/test/java/org/apache/helix/zookeeper/impl/client/TestRawZkClient.java", "diffHunk": "@@ -487,6 +488,50 @@ void testPendingRequestGauge()\n     }\n   }\n \n+  @Test(dependsOnMethods = \"testZkClientMonitor\")\n+  void testSessionExpireCount() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU2ODc5MA=="}, "originalCommit": {"oid": "e2606680f59d667b969d91765cf567cb2df758dc"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1172, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}