{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0OTUwMDg4", "number": 1237, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTo1OToxOFrOEZob3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQwOToyMDoxMlrOEbMv4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MzEyMzQ4OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/util/InstanceValidationUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTo1OToxOFrOHCjzLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQwODoyNjoyMVrOHFDjPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTc0MQ==", "bodyText": "I find this may be misleading. Can we change it to, \"Persist assignment (%s) is not turned on in the Cluster Config. This is required to enable instance stability check.\"", "url": "https://github.com/apache/helix/pull/1237#discussion_r472445741", "createdAt": "2020-08-18T19:59:18Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/util/InstanceValidationUtil.java", "diffHunk": "@@ -261,7 +261,9 @@ public static boolean isInstanceStable(HelixDataAccessor dataAccessor, String in\n       throw new HelixException(\"Missing cluster config!\");\n     }\n     if (!clusterConfig.isPersistIntermediateAssignment()) {\n-      throw new HelixException(\"isInstanceStable needs persist assignment on!\");\n+      throw new HelixException(String.format(\n+          \"Instance stability check needs persist assignment cluster config turned on: %s = true\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTA2MzEwMg==", "bodyText": "Made it clearer.", "url": "https://github.com/apache/helix/pull/1237#discussion_r475063102", "createdAt": "2020-08-22T08:26:21Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/main/java/org/apache/helix/util/InstanceValidationUtil.java", "diffHunk": "@@ -261,7 +261,9 @@ public static boolean isInstanceStable(HelixDataAccessor dataAccessor, String in\n       throw new HelixException(\"Missing cluster config!\");\n     }\n     if (!clusterConfig.isPersistIntermediateAssignment()) {\n-      throw new HelixException(\"isInstanceStable needs persist assignment on!\");\n+      throw new HelixException(String.format(\n+          \"Instance stability check needs persist assignment cluster config turned on: %s = true\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTc0MQ=="}, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MzEyOTgxOnYy", "diffSide": "RIGHT", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceServiceImpl.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMDowMTowMlrOHCj3CA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwNDoxMjoxMlrOHGFlEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NjcyOA==", "bodyText": "Why it is a warning now?", "url": "https://github.com/apache/helix/pull/1237#discussion_r472446728", "createdAt": "2020-08-18T20:01:02Z", "author": {"login": "jiajunwang"}, "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceServiceImpl.java", "diffHunk": "@@ -213,7 +219,12 @@ public StoppableCheck getInstanceStoppableCheck(String clusterId, String instanc\n           instancesForNextCheck.add(instance);\n         }\n       } catch (InterruptedException | ExecutionException e) {\n-        LOG.error(\"Failed to get StoppableChecks in parallel. Instance: {}\", instance, e);\n+        LOG.warn(\"Failed to get StoppableChecks in parallel. Instance: {}. Caused by {}\", instance,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTA2MzM0Mw==", "bodyText": "I feel error is inappropriate for this kind of msg. It is not a server error.\nERROR should contain technical issues that need to be resolved for proper functioning of the system (ex: couldn\u2019t connect to database)\nWARN is best used for temporary problems or unexpected behavior that does not significantly hamper the functioning of the application (ex:  failed user login)\nINFO should contain messages that describe what is happening in the application (ex: user registered, order placed)", "url": "https://github.com/apache/helix/pull/1237#discussion_r475063343", "createdAt": "2020-08-22T08:29:13Z", "author": {"login": "huizhilu"}, "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceServiceImpl.java", "diffHunk": "@@ -213,7 +219,12 @@ public StoppableCheck getInstanceStoppableCheck(String clusterId, String instanc\n           instancesForNextCheck.add(instance);\n         }\n       } catch (InterruptedException | ExecutionException e) {\n-        LOG.error(\"Failed to get StoppableChecks in parallel. Instance: {}\", instance, e);\n+        LOG.warn(\"Failed to get StoppableChecks in parallel. Instance: {}. Caused by {}\", instance,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NjcyOA=="}, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTgxMTg1MQ==", "bodyText": "I think the failure reason does not really matter here (although an Exception looks to be a problem to me more than a warning).\nThe real matter thing is that whether the result is complete and fully computed. If not certain, then this is an error.", "url": "https://github.com/apache/helix/pull/1237#discussion_r475811851", "createdAt": "2020-08-24T18:26:43Z", "author": {"login": "jiajunwang"}, "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceServiceImpl.java", "diffHunk": "@@ -213,7 +219,12 @@ public StoppableCheck getInstanceStoppableCheck(String clusterId, String instanc\n           instancesForNextCheck.add(instance);\n         }\n       } catch (InterruptedException | ExecutionException e) {\n-        LOG.error(\"Failed to get StoppableChecks in parallel. Instance: {}\", instance, e);\n+        LOG.warn(\"Failed to get StoppableChecks in parallel. Instance: {}. Caused by {}\", instance,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NjcyOA=="}, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjE0NDkxNA==", "bodyText": "The code change is not necessary and kept as it is.\nRegarding warn or error, I look at it from server perspective: if the exception is not a server exception that affects running of the REST server, I would say it is an error.\nBut obviously this is not an exception that stops REST server running. It is just a normal running of the API check. It should not be logged as an error. A warning should already be enough to help debug.", "url": "https://github.com/apache/helix/pull/1237#discussion_r476144914", "createdAt": "2020-08-25T04:12:12Z", "author": {"login": "huizhilu"}, "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceServiceImpl.java", "diffHunk": "@@ -213,7 +219,12 @@ public StoppableCheck getInstanceStoppableCheck(String clusterId, String instanc\n           instancesForNextCheck.add(instance);\n         }\n       } catch (InterruptedException | ExecutionException e) {\n-        LOG.error(\"Failed to get StoppableChecks in parallel. Instance: {}\", instance, e);\n+        LOG.warn(\"Failed to get StoppableChecks in parallel. Instance: {}. Caused by {}\", instance,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NjcyOA=="}, "originalCommit": {"oid": "e1b5cb467a70b75d0cd7f9e695be189e537aca47"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2OTU1ODcyOnYy", "diffSide": "RIGHT", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQwOToyMDoxMlrOHFD0dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQwOToyMDoxMlrOHFD0dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTA2NzUxMQ==", "bodyText": "@dasahcc INVALID_CONFIG should also be added to STARTED_AND_HEALTH_CHECK_LIST, right?", "url": "https://github.com/apache/helix/pull/1237#discussion_r475067511", "createdAt": "2020-08-22T09:20:12Z", "author": {"login": "huizhilu"}, "path": "helix-rest/src/main/java/org/apache/helix/rest/server/service/InstanceService.java", "diffHunk": "@@ -72,9 +72,10 @@\n         /**\n          * Pre-defined list of checks to test if an instance is in healthy running state\n          */\n-        public static List<HealthCheck> STARTED_AND_HEALTH_CHECK_LIST =\n-                ImmutableList.of(HealthCheck.INSTANCE_NOT_ALIVE, HealthCheck.INSTANCE_NOT_ENABLED,\n-                        HealthCheck.INSTANCE_NOT_STABLE, HealthCheck.EMPTY_RESOURCE_ASSIGNMENT);\n+        public static List<HealthCheck> STARTED_AND_HEALTH_CHECK_LIST = ImmutableList\n+            .of(HealthCheck.INVALID_CONFIG, HealthCheck.INSTANCE_NOT_ALIVE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3f3ec915fc3b60df7f2d5eaac8011477d46460d"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 875, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}