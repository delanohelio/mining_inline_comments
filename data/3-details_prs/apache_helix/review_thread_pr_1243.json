{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NjgwMDAz", "number": 1243, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDo1NzoxM1rOEW9hIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDo1NzoxM1rOEW9hIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNTEyMDM1OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/participant/HelixCustomCodeRunner.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDo1NzoxM1rOG-fh8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxODo1N1rOG-gKRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4MTQ5MQ==", "bodyText": "if zkaddress is null and we are initialize it with FederatedZKClient, do we have problem? For example, we cannot get the routing key and cause any problems?", "url": "https://github.com/apache/helix/pull/1243#discussion_r468181491", "createdAt": "2020-08-10T20:57:13Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/participant/HelixCustomCodeRunner.java", "diffHunk": "@@ -130,14 +147,23 @@ public void start() throws Exception {\n \n     StateMachineEngine stateMach = _manager.getStateMachineEngine();\n     stateMach.registerStateModelFactory(LEADER_STANDBY, _stateModelFty, _resourceName);\n-    HelixZkClient zkClient = null;\n+    RealmAwareZkClient zkClient = null;\n     try {\n       // manually add ideal state for participant leader using LeaderStandby\n       // model\n-      HelixZkClient.ZkClientConfig clientConfig = new HelixZkClient.ZkClientConfig();\n-      clientConfig.setZkSerializer(new ZNRecordSerializer());\n-      zkClient = SharedZkClientFactory.getInstance()\n-          .buildZkClient(new HelixZkClient.ZkConnectionConfig(_zkAddr), clientConfig);\n+      if (Boolean.getBoolean(SystemPropertyKeys.MULTI_ZK_ENABLED) || _zkAddr == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ceb20dc1ca964e3107ff89473a5ddeb613eeea8c"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MTgxMg==", "bodyText": "The whole point of FederatedZkClient is not using a particular ZkAddress, but rather rely on RealmAwareConnectionConfig to establish a multi-zk connection, so this makes sense. The sharding key information is included in the connection config.", "url": "https://github.com/apache/helix/pull/1243#discussion_r468191812", "createdAt": "2020-08-10T21:18:57Z", "author": {"login": "narendly"}, "path": "helix-core/src/main/java/org/apache/helix/participant/HelixCustomCodeRunner.java", "diffHunk": "@@ -130,14 +147,23 @@ public void start() throws Exception {\n \n     StateMachineEngine stateMach = _manager.getStateMachineEngine();\n     stateMach.registerStateModelFactory(LEADER_STANDBY, _stateModelFty, _resourceName);\n-    HelixZkClient zkClient = null;\n+    RealmAwareZkClient zkClient = null;\n     try {\n       // manually add ideal state for participant leader using LeaderStandby\n       // model\n-      HelixZkClient.ZkClientConfig clientConfig = new HelixZkClient.ZkClientConfig();\n-      clientConfig.setZkSerializer(new ZNRecordSerializer());\n-      zkClient = SharedZkClientFactory.getInstance()\n-          .buildZkClient(new HelixZkClient.ZkConnectionConfig(_zkAddr), clientConfig);\n+      if (Boolean.getBoolean(SystemPropertyKeys.MULTI_ZK_ENABLED) || _zkAddr == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4MTQ5MQ=="}, "originalCommit": {"oid": "ceb20dc1ca964e3107ff89473a5ddeb613eeea8c"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 878, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}