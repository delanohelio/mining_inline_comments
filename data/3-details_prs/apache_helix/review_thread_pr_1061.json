{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MDc1MzE3", "number": 1061, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODowNjowOFrOED_0Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDoxNDoyNFrOEECbWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjI2NzY2OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/task/DeprecatedTaskRebalancer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODowNjowOFrOGhWRPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxOTozODowMVrOGhZYMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyMTA1Mw==", "bodyText": "I dont think any one is using this class. Shall we remove it? Or at least, let's deprecate the class instead of changing the public API for backward incompatible change.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437621053", "createdAt": "2020-06-09T18:06:08Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/DeprecatedTaskRebalancer.java", "diffHunk": "@@ -110,10 +109,9 @@\n    * @return map of instances to set of partition numbers\n    */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY3MTk4Ng==", "bodyText": "Removed.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437671986", "createdAt": "2020-06-09T19:38:01Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/task/DeprecatedTaskRebalancer.java", "diffHunk": "@@ -110,10 +109,9 @@\n    * @return map of instances to set of partition numbers\n    */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyMTA1Mw=="}, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjI3MDA5OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskAssignmentCalculator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODowNjo1MlrOGhWS0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDowMDoyOVrOGhaG9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyMTQ1Ng==", "bodyText": "So it may not be safe to change public API directly. My suggestion is to deprecate the method and create a new one if necessary.\nThis deprecated function can call the new function.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437621456", "createdAt": "2020-06-09T18:06:52Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskAssignmentCalculator.java", "diffHunk": "@@ -78,11 +78,11 @@ public FixedTargetTaskAssignmentCalculator(AssignableInstanceManager assignableI\n \n   @Override\n   public Map<String, SortedSet<Integer>> getTaskAssignment(CurrentStateOutput currStateOutput,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY4Mzk1Ng==", "bodyText": "Done.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437683956", "createdAt": "2020-06-09T20:00:29Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskAssignmentCalculator.java", "diffHunk": "@@ -78,11 +78,11 @@ public FixedTargetTaskAssignmentCalculator(AssignableInstanceManager assignableI\n \n   @Override\n   public Map<String, SortedSet<Integer>> getTaskAssignment(CurrentStateOutput currStateOutput,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyMTQ1Ng=="}, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjI4NzI1OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskRebalancer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxMTo0MlrOGhWdtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxOTo0Mjo1M1rOGhZiVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDI0Ng==", "bodyText": "Same here. Shall we remove this class?", "url": "https://github.com/apache/helix/pull/1061#discussion_r437624246", "createdAt": "2020-06-09T18:11:42Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskRebalancer.java", "diffHunk": "@@ -48,13 +48,11 @@\n   }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY3NDU4MQ==", "bodyText": "Removed.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437674581", "createdAt": "2020-06-09T19:42:53Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/task/FixedTargetTaskRebalancer.java", "diffHunk": "@@ -48,13 +48,11 @@\n   }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDI0Ng=="}, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjI4OTY1OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskAssignmentCalculator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxMjoyM1rOGhWfKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDowMDo0MVrOGhaHUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDYxNg==", "bodyText": "Better not change public API, we can deprecate it and add a new one.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437624616", "createdAt": "2020-06-09T18:12:23Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskAssignmentCalculator.java", "diffHunk": "@@ -65,9 +65,9 @@\n \n   @Override\n   public Map<String, SortedSet<Integer>> getTaskAssignment(CurrentStateOutput currStateOutput,\n-      ResourceAssignment prevAssignment, Collection<String> instances, JobConfig jobCfg,\n-      final JobContext jobContext, WorkflowConfig workflowCfg, WorkflowContext workflowCtx,\n-      Set<Integer> partitionSet, Map<String, IdealState> idealStateMap) {\n+      Collection<String> instances, JobConfig jobCfg, final JobContext jobContext,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY4NDA1MA==", "bodyText": "Done.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437684050", "createdAt": "2020-06-09T20:00:41Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskAssignmentCalculator.java", "diffHunk": "@@ -65,9 +65,9 @@\n \n   @Override\n   public Map<String, SortedSet<Integer>> getTaskAssignment(CurrentStateOutput currStateOutput,\n-      ResourceAssignment prevAssignment, Collection<String> instances, JobConfig jobCfg,\n-      final JobContext jobContext, WorkflowConfig workflowCfg, WorkflowContext workflowCtx,\n-      Set<Integer> partitionSet, Map<String, IdealState> idealStateMap) {\n+      Collection<String> instances, JobConfig jobCfg, final JobContext jobContext,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDYxNg=="}, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjI5MTM2OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskRebalancer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxMjo1MFrOGhWgOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxOTo0MzoxNFrOGhZjHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDg4OQ==", "bodyText": "Same here. Shall we remove the rebalancer related class. Or, at least, deprecate it.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437624889", "createdAt": "2020-06-09T18:12:50Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskRebalancer.java", "diffHunk": "@@ -40,18 +40,18 @@\n \n   @Override\n   public Set<Integer> getAllTaskPartitions(JobConfig jobCfg, JobContext jobCtx,\n-      WorkflowConfig workflowCfg, WorkflowContext workflowCtx, WorkflowControllerDataProvider cache) {\n-    return taskAssignmentCalculator\n-        .getAllTaskPartitions(jobCfg, jobCtx, workflowCfg, workflowCtx, cache.getIdealStates());\n+      WorkflowConfig workflowCfg, WorkflowContext workflowCtx,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY3NDc4MA==", "bodyText": "Removed.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437674780", "createdAt": "2020-06-09T19:43:14Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/task/GenericTaskRebalancer.java", "diffHunk": "@@ -40,18 +40,18 @@\n \n   @Override\n   public Set<Integer> getAllTaskPartitions(JobConfig jobCfg, JobContext jobCtx,\n-      WorkflowConfig workflowCfg, WorkflowContext workflowCtx, WorkflowControllerDataProvider cache) {\n-    return taskAssignmentCalculator\n-        .getAllTaskPartitions(jobCfg, jobCtx, workflowCfg, workflowCtx, cache.getIdealStates());\n+      WorkflowConfig workflowCfg, WorkflowContext workflowCtx,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNDg4OQ=="}, "originalCommit": {"oid": "9745afe38eb76ab01bfb551660a918ca14939bc1"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjY5NTMwOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/model/IdealState.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDoxNDoyNFrOGhaixg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDoyMjoyNlrOGhazgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY5MTA3OA==", "bodyText": "Would this break backward compatibility for existing long-running TF resources?", "url": "https://github.com/apache/helix/pull/1061#discussion_r437691078", "createdAt": "2020-06-09T20:14:24Z", "author": {"login": "narendly"}, "path": "helix-core/src/main/java/org/apache/helix/model/IdealState.java", "diffHunk": "@@ -721,9 +719,7 @@ private RebalanceMode normalizeRebalanceMode(IdealStateModeProperty mode) {\n       String rebalancerName = getRebalancerClassName();\n       if (rebalancerName != null) {\n         if (rebalancerName.equals(JobRebalancer.class.getName())\n-            || rebalancerName.equals(WorkflowRebalancer.class.getName())\n-            || rebalancerName.equals(GenericTaskRebalancer.class.getName())\n-            || rebalancerName.equals(FixedTargetTaskRebalancer.class.getName())) {\n+            || rebalancerName.equals(WorkflowRebalancer.class.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d2d65092e5719578cb1845b30ad17c45b163035"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY5NTM2Mg==", "bodyText": "I think we are safe because the remove ones have been deprecated around 4 years ago. Perhaps it is time to do some cleaning for TF code base.", "url": "https://github.com/apache/helix/pull/1061#discussion_r437695362", "createdAt": "2020-06-09T20:22:26Z", "author": {"login": "alirezazamani"}, "path": "helix-core/src/main/java/org/apache/helix/model/IdealState.java", "diffHunk": "@@ -721,9 +719,7 @@ private RebalanceMode normalizeRebalanceMode(IdealStateModeProperty mode) {\n       String rebalancerName = getRebalancerClassName();\n       if (rebalancerName != null) {\n         if (rebalancerName.equals(JobRebalancer.class.getName())\n-            || rebalancerName.equals(WorkflowRebalancer.class.getName())\n-            || rebalancerName.equals(GenericTaskRebalancer.class.getName())\n-            || rebalancerName.equals(FixedTargetTaskRebalancer.class.getName())) {\n+            || rebalancerName.equals(WorkflowRebalancer.class.getName())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY5MTA3OA=="}, "originalCommit": {"oid": "7d2d65092e5719578cb1845b30ad17c45b163035"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1120, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}