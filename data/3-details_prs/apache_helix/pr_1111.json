{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MTA5NzQ0", "number": 1111, "title": "Add Cluster and instance level metrics to report the past-due incompleted message count.", "bodyText": "Issue\n\n My PR addresses the following Helix issues and references them in the PR description:\n\n(#1128 - #1128)\n\"Add metrics to report the number of messages that have not been completed after a certain of time #1128\"\nDescription\nAdd Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time.\nChanges:\n\n\nAdd expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n\n\nAdd Past-Due incomplete message gauge in both cluster and instance monitor.\n\n\nTests\n\n The following tests are written for this issue:\n\nTestClusterStatusMonitor. testMessageMetrics\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n[INFO]\n[INFO] Results:\n[INFO]\n[ERROR] Failures:\n[ERROR]   TestStateTransitionTimeout.testStateTransitionTimeOut:166 expected: but was:\n[ERROR]   TestStateTransitionTimeoutWithResource.testStateTransitionTimeOut:171 expected: but was:\n[ERROR]   TestStateTransitionTimeoutWithResource.testStateTransitionTimeoutByClusterLevel:199 expected: but was:\n[ERROR] org.apache.helix.tools.TestClusterStateVerifier.afterMethod(org.apache.helix.tools.TestClusterStateVerifier)\n[ERROR]   Run 1: TestClusterStateVerifier.afterMethod:98 \u00bb IllegalState ZkClient already closed...\n[INFO]   Run 2: PASS\n[INFO]\n[INFO]\n[ERROR] Tests run: 1156, Failures: 4, Errors: 0, Skipped: 3\n\nAll failed tests passed with individual run.\nCommits\n\n My commits all reference appropriate Apache Helix GitHub issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\n My diff has been formatted using helix-style.xml\n(helix-style-intellij.xml if IntelliJ IDE is used)", "createdAt": "2020-06-22T18:31:07Z", "url": "https://github.com/apache/helix/pull/1111", "merged": true, "mergeCommit": {"oid": "dc2e8bb137f03552271dce3e83819d6dfdf25371"}, "closed": true, "closedAt": "2020-07-21T16:50:48Z", "author": {"login": "lei-xia"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuMQp3gFqTQzNjE2MTkyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc15oJ5gBqjM1NTk3MTQ4MTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MTYxOTI1", "url": "https://github.com/apache/helix/pull/1111#pullrequestreview-436161925", "createdAt": "2020-06-23T21:12:33Z", "commit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QyMToxMjozM1rOGn613Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QyMToxNzo1NlrOGn6_3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMTcwOQ==", "bodyText": "This is not epoch time. epoch time is not at milisecond but second level.", "url": "https://github.com/apache/helix/pull/1111#discussion_r444511709", "createdAt": "2020-06-23T21:12:33Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -522,12 +538,25 @@ public long getExecuteStartTimeStamp() {\n \n   /**\n    * Get the time that this message was created\n-   * @return UNIX timestamp\n+   * @return UNIX epoch timestamp", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMjM5NQ==", "bodyText": "Do we want to have this param for our internal message report or including for some user defined messages? It is hard to define the time from user perspective.", "url": "https://github.com/apache/helix/pull/1111#discussion_r444512395", "createdAt": "2020-06-23T21:14:02Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -117,6 +120,11 @@\n   // Currently, the field is only used for invalidating messages in controller's message cache.\n   private boolean _expired = false;\n \n+  // The expect period of time (in ms) that a message should be completed, default 1 day\n+  public static final long MESSAGE_EXPECT_COMPLETION_PERIOD = HelixUtil", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMjk5Ng==", "bodyText": "We can combine it as:\nlong completionDue = _record.getLongField(Attributes.COMPLETION_DUE_TIMESTAMP.name(), getCreateTimeStamp() + MESSAGE_EXPECT_COMPLETION_PERIOD);", "url": "https://github.com/apache/helix/pull/1111#discussion_r444512996", "createdAt": "2020-06-23T21:15:15Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -522,12 +538,25 @@ public long getExecuteStartTimeStamp() {\n \n   /**\n    * Get the time that this message was created\n-   * @return UNIX timestamp\n+   * @return UNIX epoch timestamp\n    */\n   public long getCreateTimeStamp() {\n     return _record.getLongField(Attributes.CREATE_TIMESTAMP.toString(), 0L);\n   }\n \n+  /**\n+   * Get the time that the message was expected to be completed\n+   * @return UNIX epoch timestamp\n+   */\n+  public long getCompletionDueTimeStamp() {\n+    long completionDue = _record.getLongField(Attributes.COMPLETION_DUE_TIMESTAMP.name(), 0L);\n+    if (completionDue == 0) {\n+      completionDue = getCreateTimeStamp() + MESSAGE_EXPECT_COMPLETION_PERIOD;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMzM5NQ==", "bodyText": "Do we need any validation here? For example, it timestamp already < currentmilisecond.", "url": "https://github.com/apache/helix/pull/1111#discussion_r444513395", "createdAt": "2020-06-23T21:16:07Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -173,6 +181,14 @@ public void setCreateTimeStamp(long timestamp) {\n     _record.setLongField(Attributes.CREATE_TIMESTAMP.toString(), timestamp);\n   }\n \n+  /**\n+   * Set the time that the message was expected to be completed\n+   * @param timestamp a UNIX epoch timestamp\n+   */\n+  public void setCompletionDueTimeStamp(long timestamp) {\n+    _record.setLongField(Attributes.COMPLETION_DUE_TIMESTAMP.name(), timestamp);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxNDI3MA==", "bodyText": "pastDueMsgCount", "url": "https://github.com/apache/helix/pull/1111#discussion_r444514270", "createdAt": "2020-06-23T21:17:56Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/monitoring/mbeans/ClusterStatusMonitor.java", "diffHunk": "@@ -289,6 +288,32 @@ public void setClusterInstanceStatus(Set<String> liveInstanceSet, Set<String> in\n           }\n         }\n       }\n+\n+      // update all message related gauges\n+      long now = System.currentTimeMillis();\n+      long totalMsgQueueSize = 0L;\n+      long maxInstanceMsgQueueSize = 0L;\n+      long totalPastdueMsgSize = 0L;\n+      for (String instance : instanceMessageMap.keySet()) {\n+        Set<Message> messages = instanceMessageMap.get(instance);\n+        InstanceMonitor bean = _instanceMonitorMap.get(instance);\n+\n+        long msgQueueSize = messages.size();\n+        bean.updateMessageQueueSize(msgQueueSize);\n+        totalMsgQueueSize += msgQueueSize;\n+        if (msgQueueSize > maxInstanceMsgQueueSize) {\n+          maxInstanceMsgQueueSize = msgQueueSize;\n+        }\n+\n+        long pastdueMsgCount = messages.stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 92}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/9abe2aa5a57771962e16bbf80c6d30f47bdd491b", "committedDate": "2020-06-22T18:28:09Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time."}, "afterCommit": {"oid": "6553c726f1df277698198ef62767b4441caf7082", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/6553c726f1df277698198ef62767b4441caf7082", "committedDate": "2020-06-29T02:38:02Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6553c726f1df277698198ef62767b4441caf7082", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/6553c726f1df277698198ef62767b4441caf7082", "committedDate": "2020-06-29T02:38:02Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time."}, "afterCommit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/b66d8b5dc863f5dfc162324b19c6d7ef2999015c", "committedDate": "2020-06-29T04:59:16Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NjEwMTQ5", "url": "https://github.com/apache/helix/pull/1111#pullrequestreview-439610149", "createdAt": "2020-06-30T01:38:13Z", "commit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwMTozODoxM1rOGqoedw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwMjowNTowMVrOGqo8WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM1NjUzNQ==", "bodyText": "Is this method set by the controller or the participant?\nIf controller, can we just update it when set the create time? So we don't need to consider validating.\nOr, if the messages are created with different expected run time, then we can add the expected run time as the parameter. That logic would easier to justify (and easier to valid) compared with passing the exact due timestamp.\nAnd I am thinking that it might be better if the participant updates it. Since 1. participant knows the estimation better. 2. if the participant has not read the message yet, then we probably don't want to mark it as a past-due message.", "url": "https://github.com/apache/helix/pull/1111#discussion_r447356535", "createdAt": "2020-06-30T01:38:13Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -173,6 +181,14 @@ public void setCreateTimeStamp(long timestamp) {\n     _record.setLongField(Attributes.CREATE_TIMESTAMP.toString(), timestamp);\n   }\n \n+  /**\n+   * Set the time that the message was expected to be completed\n+   * @param timestamp a UNIX epoch timestamp\n+   */\n+  public void setCompletionDueTimeStamp(long timestamp) {\n+    _record.setLongField(Attributes.COMPLETION_DUE_TIMESTAMP.name(), timestamp);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMzM5NQ=="}, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM1ODE5Mg==", "bodyText": "To be safe, shall we define a constant COMPLETION_DUE_TIMESTAMP_NOT_SET = -1 for the default value?", "url": "https://github.com/apache/helix/pull/1111#discussion_r447358192", "createdAt": "2020-06-30T01:44:01Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -522,12 +538,25 @@ public long getExecuteStartTimeStamp() {\n \n   /**\n    * Get the time that this message was created\n-   * @return UNIX timestamp\n+   * @return UNIX epoch timestamp\n    */\n   public long getCreateTimeStamp() {\n     return _record.getLongField(Attributes.CREATE_TIMESTAMP.toString(), 0L);\n   }\n \n+  /**\n+   * Get the time that the message was expected to be completed\n+   * @return UNIX epoch timestamp\n+   */\n+  public long getCompletionDueTimeStamp() {\n+    long completionDue = _record.getLongField(Attributes.COMPLETION_DUE_TIMESTAMP.name(), 0L);\n+    if (completionDue == 0) {\n+      completionDue = getCreateTimeStamp() + MESSAGE_EXPECT_COMPLETION_PERIOD;\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxMjk5Ng=="}, "originalCommit": {"oid": "9abe2aa5a57771962e16bbf80c6d30f47bdd491b"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM2MTI1Mw==", "bodyText": "nit, can we organically add the new logic to the existing one. As you can see the logic is,\n\nensure instance mbeans created\ndo the metric data calculation\nupdate the metrics\n\nCan we split the new logic into 2 parts and put the logic to the corresponding sections 2 and 3?\n\nWe have some check regarding the monitor objects there.\nWe want to keep the structure of the code.", "url": "https://github.com/apache/helix/pull/1111#discussion_r447361253", "createdAt": "2020-06-30T01:54:43Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/monitoring/mbeans/ClusterStatusMonitor.java", "diffHunk": "@@ -289,6 +288,32 @@ public void setClusterInstanceStatus(Set<String> liveInstanceSet, Set<String> in\n           }\n         }\n       }\n+\n+      // update all message related gauges", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzM2NDE4NQ==", "bodyText": "I don't have strong preference here.\n\nShall protected or package-private enough here?\nOr, on the other hand, with these two methods made to the public, we can avoid several test codes using INSTANCE_DN_KEY and RESOURCE_DN_KEY directly. Not a must in this PR, though.", "url": "https://github.com/apache/helix/pull/1111#discussion_r447364185", "createdAt": "2020-06-30T02:05:01Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/monitoring/mbeans/ClusterStatusMonitor.java", "diffHunk": "@@ -881,7 +910,7 @@ public String clusterBeanName() {\n    * @param instanceName\n    * @return instance bean name\n    */\n-  private String getInstanceBeanName(String instanceName) {\n+  public String getInstanceBeanName(String instanceName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "originalPosition": 163}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjY3Mjg2", "url": "https://github.com/apache/helix/pull/1111#pullrequestreview-440267286", "createdAt": "2020-06-30T18:09:39Z", "commit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODowOTozOVrOGrIm-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODowOTozOVrOGrIm-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg4MzAwMg==", "bodyText": "This is legacy way of converting times. Better to use TimeUnit.DAYS.toMillis(1);", "url": "https://github.com/apache/helix/pull/1111#discussion_r447883002", "createdAt": "2020-06-30T18:09:39Z", "author": {"login": "junkaixue"}, "path": "helix-core/src/main/java/org/apache/helix/model/Message.java", "diffHunk": "@@ -117,6 +120,11 @@\n   // Currently, the field is only used for invalidating messages in controller's message cache.\n   private boolean _expired = false;\n \n+  // The expect period of time (in ms) that a message should be completed, default 1 day\n+  public static final long MESSAGE_EXPECT_COMPLETION_PERIOD = HelixUtil\n+      .getSystemPropertyAsLong(SystemPropertyKeys.MESSAGE_EXPECTED_COMPLETION_PERIOD,\n+          24 * 60 * 60 * 1000 /* 1 day in ms */);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjY3Mzk1", "url": "https://github.com/apache/helix/pull/1111#pullrequestreview-440267395", "createdAt": "2020-06-30T18:09:49Z", "commit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b66d8b5dc863f5dfc162324b19c6d7ef2999015c", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/b66d8b5dc863f5dfc162324b19c6d7ef2999015c", "committedDate": "2020-06-29T04:59:16Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}, "afterCommit": {"oid": "6e25e7d78454ecd8526703ec1869d3dd6eb501bd", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/6e25e7d78454ecd8526703ec1869d3dd6eb501bd", "committedDate": "2020-07-01T20:35:55Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e25e7d78454ecd8526703ec1869d3dd6eb501bd", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/6e25e7d78454ecd8526703ec1869d3dd6eb501bd", "committedDate": "2020-07-01T20:35:55Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}, "afterCommit": {"oid": "3fc870815219d910c6e357b6b4ba843b2244c776", "author": {"user": {"login": "jiajunwang", "name": "Jiajun Wang"}}, "url": "https://github.com/apache/helix/commit/3fc870815219d910c6e357b6b4ba843b2244c776", "committedDate": "2020-07-07T18:05:56Z", "message": "Shutdown the TaskStateModelFactory threads created in the tests. (#1140)\n\nThe TaskStateModelFactory initialization creates a thread pool. The expectation is that the application code closes the thread pool and the threads when the participant instance is shutting down. In most cases, this means the JVM is going to be shutdown. So this operation is not a must. However, in the test cases, these thread pools leak thousands of threads.\r\nThis PR adds cleanup logic to shutdown thread pools that are created for the participant instances. Note that there is still thread leakage when the participants are created separately instead of using the general methods."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b29a6e2f13344fa43f81d2bb21845cb65a83c7d", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/9b29a6e2f13344fa43f81d2bb21845cb65a83c7d", "committedDate": "2020-07-17T20:11:33Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93b2ad2977c8fc9c39f02f2961b63ccab339b821", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/93b2ad2977c8fc9c39f02f2961b63ccab339b821", "committedDate": "2020-07-13T15:35:58Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}, "afterCommit": {"oid": "9b29a6e2f13344fa43f81d2bb21845cb65a83c7d", "author": {"user": {"login": "lei-xia", "name": "Lei Xia"}}, "url": "https://github.com/apache/helix/commit/9b29a6e2f13344fa43f81d2bb21845cb65a83c7d", "committedDate": "2020-07-17T20:11:33Z", "message": "Add Cluster and instance level metrics to report the number of messages that have not been completed after their expected completion time\n\nChanges in this commit:\n1) Add expected completion time field to Message, set the default expected completion period to be 1 day (can be configurable via system property).\n2) Add Past-Due incomplete message gauge in both cluster and instance monitor."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4513, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}