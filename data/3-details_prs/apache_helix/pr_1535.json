{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMDg4ODQ4", "number": 1535, "title": "fix TestHelixAdminCli testDeactivateCluster flakiness", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\nfix #1300\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\nfix TestHelixAdminCli testDeactivateCluster flakiness. As this\ntest does not wait till the cluster converge before tearing it\ndown. The tearing down process can have exceptions depending on\ntiming.\n\n(Write a concise description including what, why, how)\nTests\n\n The following tests are written for this issue:\n\n(List the names of added unit/integration tests)\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\n(Before CI test pass, please copy & paste the result of \"mvn test\")\nDocumentation (Optional)\n\nIn case of new functionality, my PR adds documentation in the following wiki page:\n\n(Link the GitHub wiki you added)\nCommits\n\nMy commits all reference appropriate Apache Helix GitHub issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\nMy diff has been formatted using helix-style.xml\n(helix-style-intellij.xml if IntelliJ IDE is used)", "createdAt": "2020-11-17T02:08:45Z", "url": "https://github.com/apache/helix/pull/1535", "merged": true, "mergeCommit": {"oid": "1b01972f7616f6af2296270929f3fb5cd853a20a"}, "closed": true, "closedAt": "2020-11-18T00:29:53Z", "author": {"login": "kaisun2000"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddPycngH2gAyNTIyMDg4ODQ4OjUzMDE1OGY3ZDdiZDZlZDcyNmRjNzQ4OGYxNjdjMGM2MTJiY2Y0YTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddfL84gH2gAyNTIyMDg4ODQ4OjRkNDdhYWY5YWY5YjQ4MmE5ZTM0OGM4NGI4NjYxZmQ3YzM1ZjZhN2Y=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "530158f7d7bd6ed726dc7488f167c0c612bcf4a8", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/530158f7d7bd6ed726dc7488f167c0c612bcf4a8", "committedDate": "2020-11-17T02:04:43Z", "message": "fix TestHelixAdminCli testDeactivateCluster flakiness. As this\ntest does not wait till the cluster converge before tearing it\ndown. The tearing down process can have exceptions depending on\ntiming."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjc4MzM5", "url": "https://github.com/apache/helix/pull/1535#pullrequestreview-532678339", "createdAt": "2020-11-17T18:40:13Z", "commit": {"oid": "530158f7d7bd6ed726dc7488f167c0c612bcf4a8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODo0MDoxM1rOH1DxKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxODo0MDoxM1rOH1DxKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM5ODMxMw==", "bodyText": "nit, TestHelper.WAIT_DURATION?", "url": "https://github.com/apache/helix/pull/1535#discussion_r525398313", "createdAt": "2020-11-17T18:40:13Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/test/java/org/apache/helix/tools/TestHelixAdminCli.java", "diffHunk": "@@ -603,6 +611,12 @@ public void testDeactivateCluster() throws Exception {\n     command = \"-zkSvr localhost:2183 -dropCluster \" + clusterName;\n     ClusterSetup.processCommandLineArgs(command.split(\"\\\\s\"));\n \n+    boolean leaderNotExists = TestHelper.verify(() -> {\n+      boolean isLeaderExists = _gZkClient.exists(path);\n+      return isLeaderExists == false;\n+    }, 10000L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "530158f7d7bd6ed726dc7488f167c0c612bcf4a8"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjc4NzY0", "url": "https://github.com/apache/helix/pull/1535#pullrequestreview-532678764", "createdAt": "2020-11-17T18:40:44Z", "commit": {"oid": "530158f7d7bd6ed726dc7488f167c0c612bcf4a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d47aaf9af9b482a9e348c84b8661fd7c35f6a7f", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/4d47aaf9af9b482a9e348c84b8661fd7c35f6a7f", "committedDate": "2020-11-17T20:01:09Z", "message": "one more fix of wait time."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4129, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}