{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NTgxMDkz", "number": 693, "title": "Removed useless znodes to resolve dependency between test methods in TestZKUtil", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\n#689\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\n\nThere is sometimes test failing because some znodes created in a test method didn't get deleted and it makes another test method's result false because we use one Zk cluster for all test methods in the same test class.\nI added code to delete the created znodes at the end of each test method so each test method is truly independent.\nTests\n\n The following tests are written for this issue:\n\n(List the names of added unit/integration tests)\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\n[INFO] Tests run: 897, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3,521.447 s - in TestSuite\n[INFO]\n[INFO] Results:\n[INFO]\n[INFO] Tests run: 897, Failures: 0, Errors: 0, Skipped: 0\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  58:54 min\n[INFO] Finished at: 2020-01-22T17:53:32-08:00\n[INFO] ------------------------------------------------------------------------\nCommits\n\n My commits all reference appropriate Apache Helix GitHub issues in their subject lines, and I have squashed multiple commits if they address the same issue. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nDocumentation\n\n In case of new functionality, my PR adds documentation in the following wiki page:\n\n(Link the GitHub wiki you added)\nCode Quality\n\n My diff has been formatted using helix-style.xml", "createdAt": "2020-01-21T23:27:52Z", "url": "https://github.com/apache/helix/pull/693", "merged": true, "mergeCommit": {"oid": "e5c2f77129c66df1eba5518e979c2bac04daf383"}, "closed": true, "closedAt": "2020-01-24T19:15:30Z", "author": {"login": "mgao0"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8qKZKgBqjI5NjgyMjA4NjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9jo5-AFqTM0ODE1NjY3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10ce360f7848fb4608ad9368af0f30cb5d3c05a6", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/10ce360f7848fb4608ad9368af0f30cb5d3c05a6", "committedDate": "2020-01-21T19:25:52Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}, "afterCommit": {"oid": "3976be5303b0eb14eb74b82cdd5cfe27ea589169", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/3976be5303b0eb14eb74b82cdd5cfe27ea589169", "committedDate": "2020-01-21T23:57:03Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3976be5303b0eb14eb74b82cdd5cfe27ea589169", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/3976be5303b0eb14eb74b82cdd5cfe27ea589169", "committedDate": "2020-01-21T23:57:03Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}, "afterCommit": {"oid": "d6835665556fd56a1f47791646c776ba1e34c894", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/d6835665556fd56a1f47791646c776ba1e34c894", "committedDate": "2020-01-22T00:12:44Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MjgzMzk1", "url": "https://github.com/apache/helix/pull/693#pullrequestreview-346283395", "createdAt": "2020-01-22T00:33:18Z", "commit": {"oid": "d6835665556fd56a1f47791646c776ba1e34c894"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwMDozMzoxOFrOFgNVtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwMDozMzoxOFrOFgNVtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTMxNzMwMQ==", "bodyText": "Nit, this line is unnecessary. Style format file is updated in master branch. You may want to re-import the file in your Intellij so this line won't be formatted.", "url": "https://github.com/apache/helix/pull/693#discussion_r369317301", "createdAt": "2020-01-22T00:33:18Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/test/java/org/apache/helix/manager/zk/TestZKUtil.java", "diffHunk": "@@ -37,13 +37,15 @@\n import org.testng.annotations.BeforeClass;\n import org.testng.annotations.Test;\n \n+\n public class TestZKUtil extends ZkUnitTestBase {\n   private static Logger LOG = LoggerFactory.getLogger(TestZKUtil.class);\n \n   String clusterName = CLUSTER_PREFIX + \"_\" + getShortClassName();\n \n   @BeforeClass()\n-  public void beforeClass() throws Exception {\n+  public void beforeClass()\n+      throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6835665556fd56a1f47791646c776ba1e34c894"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d", "committedDate": "2020-01-22T00:42:58Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6835665556fd56a1f47791646c776ba1e34c894", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/d6835665556fd56a1f47791646c776ba1e34c894", "committedDate": "2020-01-22T00:12:44Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}, "afterCommit": {"oid": "3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d", "committedDate": "2020-01-22T00:42:58Z", "message": "Removed useless znodes to resolve dependency between test methods in TestZKUtil (apache#689)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTMxMjY4", "url": "https://github.com/apache/helix/pull/693#pullrequestreview-347531268", "createdAt": "2020-01-23T18:55:47Z", "commit": {"oid": "3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTYzNjM5", "url": "https://github.com/apache/helix/pull/693#pullrequestreview-347563639", "createdAt": "2020-01-23T19:49:07Z", "commit": {"oid": "3b51688e6dfb39a3ce3b1bf60fdcdb1a1a9bf70d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9777873f68bc2bbb574d0970093a5a386b8a2b51", "author": {"user": {"login": "mgao0", "name": "Molly Gao"}}, "url": "https://github.com/apache/helix/commit/9777873f68bc2bbb574d0970093a5a386b8a2b51", "committedDate": "2020-01-24T01:11:47Z", "message": "Remove created nodes after each test method (apache#689)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Nzc4NzI1", "url": "https://github.com/apache/helix/pull/693#pullrequestreview-347778725", "createdAt": "2020-01-24T07:10:18Z", "commit": {"oid": "9777873f68bc2bbb574d0970093a5a386b8a2b51"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwNzoxMDoxOFrOFhVXBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwNzoxMDoxOFrOFhVXBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ5NzI4NA==", "bodyText": "This is like delete and re-create the cluster, which I don't believe is a better way than deleting the path in the required methods.\nNot every method needs deleting. Ex. testIsClusterSetup.\nIn my opinion, if a method creates the path, it is the method's responsibility to clean up.", "url": "https://github.com/apache/helix/pull/693#discussion_r370497284", "createdAt": "2020-01-24T07:10:18Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/test/java/org/apache/helix/manager/zk/TestZKUtil.java", "diffHunk": "@@ -63,6 +65,13 @@ public void afterClass() {\n     deleteCluster(clusterName);\n   }\n \n+  @AfterMethod()\n+  public void afterMethod() {\n+    String path = PropertyPathBuilder.instanceConfig(clusterName);\n+    _gZkClient.deleteRecursively(path);\n+    _gZkClient.createPersistent(path);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9777873f68bc2bbb574d0970093a5a386b8a2b51"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTU2Njc0", "url": "https://github.com/apache/helix/pull/693#pullrequestreview-348156674", "createdAt": "2020-01-24T18:55:40Z", "commit": {"oid": "9777873f68bc2bbb574d0970093a5a386b8a2b51"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4874, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}