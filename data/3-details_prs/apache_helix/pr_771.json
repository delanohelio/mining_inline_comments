{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1ODk4OTA4", "number": 771, "title": "Create metadata-store-directory-common module", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\nResolves #769\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\n\nmetadata-store-directory-common module was created to avoid circular dependency because the RoutingData classes will be used in zookeeper-api.\nNOTE: once tested, there will be further separation work as described here: #777\nTests\n\n The following tests are written for this issue:\n\nExisting tests for Metadata Store Directory have been moved into the new module.\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\nhelix-rest:\n[INFO]\n[INFO] Results:\n[INFO]\n[ERROR] Failures:\n[ERROR]   TestZkRoutingDataWriter.testAddMetadataStoreRealm:60\n[ERROR]   TestMetadataStoreDirectoryAccessor.testGetAllMetadataStoreRealms:119->AbstractTestClass.get:504 expected:<200> but was:<500>\n[ERROR]   TestMetadataStoreDirectoryAccessor.testGetShardingKeysInNamespace:199->AbstractTestClass.get:504 expected:<200> but was:<500>\n[ERROR]   TestMetadataStoreDirectoryAccessor.testGetShardingKeysInRealm:226 expected:<404> but was:<500>\n[INFO]\n[ERROR] Tests run: 123, Failures: 4, Errors: 0, Skipped: 4\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] --------------------\n-> known failures; they pass when run individually\nmetadata-store-directory-common\n[INFO] Running TestSuite\n[INFO] Tests run: 27, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.271 s - in TestSuite\n[INFO]\n[INFO] Results:\n[INFO]\n[INFO] Tests run: 27, Failures: 0, Errors: 0, Skipped: 0\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  4.274 s\n[INFO] Finished at: 2020-02-19T19:08:33-08:00\n[INFO] -------------------------------------\nCommits\n\n My commits all reference appropriate Apache Helix GitHub issues in their subject lines, and I have squashed multiple commits if they address the same issue. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\n My diff has been formatted using helix-style.xml", "createdAt": "2020-02-17T01:05:58Z", "url": "https://github.com/apache/helix/pull/771", "merged": true, "mergeCommit": {"oid": "4f04ba08826e5ed4d3575aea9e587b221595238a"}, "closed": true, "closedAt": "2020-02-20T18:09:23Z", "author": {"login": "narendly"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFHQ1zAFqTM1OTUwNzI5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGOqBiAFqTM2MjA5NjU3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NTA3Mjkz", "url": "https://github.com/apache/helix/pull/771#pullrequestreview-359507293", "createdAt": "2020-02-17T06:17:40Z", "commit": {"oid": "a95fe06b42c0d0a007d43df5d559aba9667a1389"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwNjoxNzo0MFrOFqZaUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwNjoyMToyM1rOFqZdSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAwMDg1MA==", "bodyText": "Why we change this?", "url": "https://github.com/apache/helix/pull/771#discussion_r380000850", "createdAt": "2020-02-17T06:17:40Z", "author": {"login": "junkaixue"}, "path": "helix-core/pom.xml", "diffHunk": "@@ -168,7 +168,7 @@ under the License.\n     <resources>\n       <resource>\n         <directory>${basedir}/src/main/resources</directory>\n-        <filtering>true</filtering>\n+        <filtering>false</filtering>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a95fe06b42c0d0a007d43df5d559aba9667a1389"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAwMTUzMQ==", "bodyText": "This is almost same as REST module. Can we think about how to reduce the redundancy of the code?", "url": "https://github.com/apache/helix/pull/771#discussion_r380001531", "createdAt": "2020-02-17T06:20:57Z", "author": {"login": "junkaixue"}, "path": "metadata-store-directory/src/main/java/org/apache/helix/metadatastore/server/MetadataStoreDirectoryServer.java", "diffHunk": "@@ -0,0 +1,232 @@\n+package org.apache.helix.metadatastore.server;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import javax.net.ssl.SSLContext;\n+\n+import org.apache.helix.metadatastore.server.common.ContextPropertyKeys;\n+import org.apache.helix.metadatastore.server.common.RestNamespace;\n+import org.apache.helix.metadatastore.server.common.ServletType;\n+import org.apache.helix.metadatastore.server.auditlog.AuditLogger;\n+import org.apache.helix.metadatastore.server.filters.AuditLogFilter;\n+import org.apache.helix.metadatastore.server.filters.CORSFilter;\n+import org.eclipse.jetty.http.HttpVersion;\n+import org.eclipse.jetty.server.HttpConfiguration;\n+import org.eclipse.jetty.server.HttpConnectionFactory;\n+import org.eclipse.jetty.server.SecureRequestCustomizer;\n+import org.eclipse.jetty.server.Server;\n+import org.eclipse.jetty.server.ServerConnector;\n+import org.eclipse.jetty.server.SslConnectionFactory;\n+import org.eclipse.jetty.servlet.ServletContextHandler;\n+import org.eclipse.jetty.servlet.ServletHolder;\n+import org.eclipse.jetty.util.ssl.SslContextFactory;\n+import org.glassfish.jersey.server.ResourceConfig;\n+import org.glassfish.jersey.server.ServerProperties;\n+import org.glassfish.jersey.servlet.ServletContainer;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+\n+public class MetadataStoreDirectoryServer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a95fe06b42c0d0a007d43df5d559aba9667a1389"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDAwMTYwOQ==", "bodyText": "Same here.", "url": "https://github.com/apache/helix/pull/771#discussion_r380001609", "createdAt": "2020-02-17T06:21:23Z", "author": {"login": "junkaixue"}, "path": "metadata-store-directory/src/main/java/org/apache/helix/metadatastore/server/MetadataStoreDirectoryServiceMain.java", "diffHunk": "@@ -0,0 +1,163 @@\n+package org.apache.helix.metadatastore.server;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+\n+import org.apache.commons.cli.CommandLine;\n+import org.apache.commons.cli.CommandLineParser;\n+import org.apache.commons.cli.GnuParser;\n+import org.apache.commons.cli.HelpFormatter;\n+import org.apache.commons.cli.Option;\n+import org.apache.commons.cli.OptionBuilder;\n+import org.apache.commons.cli.Options;\n+import org.apache.commons.cli.ParseException;\n+import org.apache.helix.metadatastore.server.common.RestNamespace;\n+import org.apache.helix.metadatastore.server.auditlog.auditloggers.FileBasedAuditLogger;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.yaml.snakeyaml.Yaml;\n+\n+\n+public class MetadataStoreDirectoryServiceMain {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a95fe06b42c0d0a007d43df5d559aba9667a1389"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30e47de7be8ef5cacc8feafd7a27de23c8ac2dbe", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/30e47de7be8ef5cacc8feafd7a27de23c8ac2dbe", "committedDate": "2020-02-20T02:31:39Z", "message": "Create metadata-store-directory module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b786124f5a948e415e3460a05ce58f81adf5209", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/7b786124f5a948e415e3460a05ce58f81adf5209", "committedDate": "2020-02-20T02:34:15Z", "message": "Remove MSDS from Helix REST"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ebcdcfcaeef55cf7c81c9345005d3748eb4cb66", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/6ebcdcfcaeef55cf7c81c9345005d3748eb4cb66", "committedDate": "2020-02-20T02:34:15Z", "message": "Add metadata-store-directory-common"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0eab92a06f8d1351df0b438c5aa11bed47654ad", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/b0eab92a06f8d1351df0b438c5aa11bed47654ad", "committedDate": "2020-02-20T02:34:15Z", "message": "Add comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06b15bb3ec9dd6406f5a128f5cad6c7ed9862a01", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/06b15bb3ec9dd6406f5a128f5cad6c7ed9862a01", "committedDate": "2020-02-20T02:34:15Z", "message": "sadf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0f54e450e1e68059a5846927e1e30a47c29d272", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/a0f54e450e1e68059a5846927e1e30a47c29d272", "committedDate": "2020-02-20T02:34:15Z", "message": "Fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fff86a19f220b78f45d8a5ed82141198a72f9d53", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/fff86a19f220b78f45d8a5ed82141198a72f9d53", "committedDate": "2020-02-20T02:34:15Z", "message": "f"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f423e724c883fbd22e9b12891e8980f1f91c73ed", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/f423e724c883fbd22e9b12891e8980f1f91c73ed", "committedDate": "2020-02-20T02:34:15Z", "message": "remove server module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b2ae8ab51bdc3b5c82d114a8836e7b38fd8e7e1", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/6b2ae8ab51bdc3b5c82d114a8836e7b38fd8e7e1", "committedDate": "2020-02-20T02:34:15Z", "message": "remove"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba664213f2b6951f5cc116333a2248c9576b413b", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/ba664213f2b6951f5cc116333a2248c9576b413b", "committedDate": "2020-02-20T03:00:54Z", "message": "merge conflict"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e7ed462bf3298cd7aa531a91d2f848941a9a9d0b", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/e7ed462bf3298cd7aa531a91d2f848941a9a9d0b", "committedDate": "2020-02-20T02:30:07Z", "message": "remove"}, "afterCommit": {"oid": "ba664213f2b6951f5cc116333a2248c9576b413b", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/ba664213f2b6951f5cc116333a2248c9576b413b", "committedDate": "2020-02-20T03:00:54Z", "message": "merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c6ffba622d3a6145820d0cc8d7e55368e8f6516", "author": {"user": {"login": "narendly", "name": "Hunter Lee"}}, "url": "https://github.com/apache/helix/commit/0c6ffba622d3a6145820d0cc8d7e55368e8f6516", "committedDate": "2020-02-20T03:03:50Z", "message": "fix bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMDk2NTc2", "url": "https://github.com/apache/helix/pull/771#pullrequestreview-362096576", "createdAt": "2020-02-20T17:32:56Z", "commit": {"oid": "0c6ffba622d3a6145820d0cc8d7e55368e8f6516"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNzozMjo1NlrOFscmnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNzozMjo1NlrOFscmnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE1MDMwMA==", "bodyText": "I think it should be 0.9.5-SNAPSHOT? We already have 0.9.4 release. We need change all the places for the pom.", "url": "https://github.com/apache/helix/pull/771#discussion_r382150300", "createdAt": "2020-02-20T17:32:56Z", "author": {"login": "junkaixue"}, "path": "helix-rest/pom.xml", "diffHunk": "@@ -44,6 +44,11 @@ under the License.\n   </properties>\n \n   <dependencies>\n+    <dependency>\n+      <groupId>org.apache.helix</groupId>\n+      <artifactId>metadata-store-directory-common</artifactId>\n+      <version>0.9.2-SNAPSHOT</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c6ffba622d3a6145820d0cc8d7e55368e8f6516"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4975, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}