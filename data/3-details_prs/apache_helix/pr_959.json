{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MjkzMjMz", "number": 959, "title": "Fix Regression on Flaky Tests in TestResourceAccessor", "bodyText": "Issues\n\n My PR addresses the following Helix issues and references them in the PR description:\n\nFixes #958\nDescription\n\n Here are some details about my PR, including screenshots of any UI changes:\n\nThe previous fix to the flaky tests might have impacted other tests. It may be caused by stopping the controllers. A better approach is to pause the clusters instead.\nTests\n\n The following is the result of the \"mvn test\" command on the appropriate module:\n\n[INFO] Tests run: 155, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 29.911 s - in TestSuite\n[INFO] \n[INFO] Results:\n[INFO] \n[INFO] Tests run: 155, Failures: 0, Errors: 0, Skipped: 0\n[INFO] \n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  34.510 s\n[INFO] Finished at: 2020-04-20T12:02:05-07:00\n[INFO] ------------------------------------------------------------------------\n\nCommits\n\n My commits all reference appropriate Apache Helix GitHub issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nCode Quality\n\n My diff has been formatted using helix-style.xml\n(helix-style-intellij.xml if IntelliJ IDE is used)", "createdAt": "2020-04-20T20:45:48Z", "url": "https://github.com/apache/helix/pull/959", "merged": true, "mergeCommit": {"oid": "38b4fa3dc5c9973ba3a13e07163b48adc4ba7c4a"}, "closed": true, "closedAt": "2020-04-21T19:49:57Z", "author": {"login": "NealSun96"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYmoeaAH2gAyNDA2MjkzMjMzOjM0NDBhMWU2YmEwZDBmODFiYmZiNGZmMWVmMDY5YWExZTEwZjViZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZnBxGgFqTM5Njg2MjkyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3440a1e6ba0d0f81bbfb4ff1ef069aa1e10f5bd7", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/3440a1e6ba0d0f81bbfb4ff1ef069aa1e10f5bd7", "committedDate": "2020-04-17T19:40:52Z", "message": "Stabilize flaky ResourceAccessor tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5751b4d9461a20e75abe523dbe4de7dafae37b38", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/5751b4d9461a20e75abe523dbe4de7dafae37b38", "committedDate": "2020-04-20T18:47:31Z", "message": "Clean up code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODA3MzI0", "url": "https://github.com/apache/helix/pull/959#pullrequestreview-396807324", "createdAt": "2020-04-20T20:58:07Z", "commit": {"oid": "5751b4d9461a20e75abe523dbe4de7dafae37b38"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMDo1ODowN1rOGInZ4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMDo1ODowN1rOGInZ4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY4NzM5Mw==", "bodyText": "Why do you need to create a HelixAdmin object every time this is called? Also, why do you need to wrap this into a private method especially when the function signatures are exactly the same?", "url": "https://github.com/apache/helix/pull/959#discussion_r411687393", "createdAt": "2020-04-20T20:58:07Z", "author": {"login": "narendly"}, "path": "helix-rest/src/test/java/org/apache/helix/rest/server/TestResourceAccessor.java", "diffHunk": "@@ -657,19 +660,9 @@ private void createDummyMapping(String clusterName, String resourceName,\n     System.out.println(\"End test :\" + TestHelper.getTestMethodName());\n   }\n \n-  private void stopClustersControllers() {\n-    for (ClusterControllerManager cm : _clusterControllerManagers) {\n-      if (cm != null && cm.isConnected()) {\n-        cm.syncStop();\n-      }\n-    }\n+  private void enableCluster(String clusterName, boolean enable) {\n+    HelixAdmin helixAdmin = new ZKHelixAdmin(_gZkClient);\n+    helixAdmin.enableCluster(clusterName, enable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5751b4d9461a20e75abe523dbe4de7dafae37b38"}, "originalPosition": 87}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b15e7d34c2228974b36dfce47bfa582211dacad0", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/b15e7d34c2228974b36dfce47bfa582211dacad0", "committedDate": "2020-04-20T22:22:25Z", "message": "Use HelixAdmin from gSetupTool"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e79cb1f243257015f5cdce135e27e596a5e9ba1b", "author": {"user": null}, "url": "https://github.com/apache/helix/commit/e79cb1f243257015f5cdce135e27e596a5e9ba1b", "committedDate": "2020-04-20T22:29:10Z", "message": "remove unnecessary imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODYyOTIw", "url": "https://github.com/apache/helix/pull/959#pullrequestreview-396862920", "createdAt": "2020-04-20T22:42:25Z", "commit": {"oid": "e79cb1f243257015f5cdce135e27e596a5e9ba1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4774, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}