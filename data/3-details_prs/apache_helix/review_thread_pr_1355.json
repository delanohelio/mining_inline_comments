{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyMzk0MTg5", "number": 1355, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNDowODoxOFrOEhf1jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMToxOTozNVrOEmyVhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNTYwMDc3OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNDowODoxOFrOHO15NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwNDoyNTowMVrOHVp0Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTMyNTEwOA==", "bodyText": "I think a toString() would give a comprehensive meaning/description for an object. Here, a uid doesn't achieve the purpose. If you just want to log uid, then put uid in log is enough.\nIf I override a toString(), I would add more descriptions/fields for this object, eg: \"CallbackHandler[uid=xxx, path=xxx, ...]\".", "url": "https://github.com/apache/helix/pull/1355#discussion_r485325108", "createdAt": "2020-09-09T04:08:18Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -660,24 +666,31 @@ private void subscribeForChanges(NotificationContext.Type callbackType, String p\n           //TODO: avoid calling getChildren for path that does not exist\n           if (_changeType == CUSTOMIZED_STATE_ROOT) {\n             logger.warn(\n-                \"Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n-                    + \"does not support Customized State!\", path, _listener);\n+                \"CallbackHandler {}, Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n+                    + \"does not support Customized State!\", this.toString(), path, _listener);\n           } else {\n-            logger.warn(\"Failed to subscribe child/data change. path: {}, listener: {}\", path,\n-                _listener, e);\n+            logger.warn(\"CallbackHandler {}, Failed to subscribe child/data change. path: {}, listener: {}\",\n+                this.toString(), path, _listener, e);\n           }\n         }\n       }\n     }\n \n     long end = System.currentTimeMillis();\n-    logger.info(\"Subscribing to path: {} took: {}\", path, (end - start));\n+    logger.info(\"CallbackHandler{}, Subscribing to path: {} took: {}\", this.toString(), path, (end - start));\n   }\n \n   public EventType[] getEventTypes() {\n     return (EventType[]) _eventTypes.toArray();\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);\n+    return stringBuilder.toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjUxODgwMQ==", "bodyText": "I think Lei mentioned in the review meeting not to hard code the UID. How about let me use a function called getUID()?", "url": "https://github.com/apache/helix/pull/1355#discussion_r486518801", "createdAt": "2020-09-10T17:37:51Z", "author": {"login": "kaisun2000"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -660,24 +666,31 @@ private void subscribeForChanges(NotificationContext.Type callbackType, String p\n           //TODO: avoid calling getChildren for path that does not exist\n           if (_changeType == CUSTOMIZED_STATE_ROOT) {\n             logger.warn(\n-                \"Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n-                    + \"does not support Customized State!\", path, _listener);\n+                \"CallbackHandler {}, Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n+                    + \"does not support Customized State!\", this.toString(), path, _listener);\n           } else {\n-            logger.warn(\"Failed to subscribe child/data change. path: {}, listener: {}\", path,\n-                _listener, e);\n+            logger.warn(\"CallbackHandler {}, Failed to subscribe child/data change. path: {}, listener: {}\",\n+                this.toString(), path, _listener, e);\n           }\n         }\n       }\n     }\n \n     long end = System.currentTimeMillis();\n-    logger.info(\"Subscribing to path: {} took: {}\", path, (end - start));\n+    logger.info(\"CallbackHandler{}, Subscribing to path: {} took: {}\", this.toString(), path, (end - start));\n   }\n \n   public EventType[] getEventTypes() {\n     return (EventType[]) _eventTypes.toArray();\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);\n+    return stringBuilder.toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTMyNTEwOA=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjAxMQ==", "bodyText": "I agree to what Huizhi mentioned, please include the basic information. If only uid is needed, then just refer to the _uid field in the code. No need to override toString().", "url": "https://github.com/apache/helix/pull/1355#discussion_r488322011", "createdAt": "2020-09-15T01:07:38Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -660,24 +666,31 @@ private void subscribeForChanges(NotificationContext.Type callbackType, String p\n           //TODO: avoid calling getChildren for path that does not exist\n           if (_changeType == CUSTOMIZED_STATE_ROOT) {\n             logger.warn(\n-                \"Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n-                    + \"does not support Customized State!\", path, _listener);\n+                \"CallbackHandler {}, Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n+                    + \"does not support Customized State!\", this.toString(), path, _listener);\n           } else {\n-            logger.warn(\"Failed to subscribe child/data change. path: {}, listener: {}\", path,\n-                _listener, e);\n+            logger.warn(\"CallbackHandler {}, Failed to subscribe child/data change. path: {}, listener: {}\",\n+                this.toString(), path, _listener, e);\n           }\n         }\n       }\n     }\n \n     long end = System.currentTimeMillis();\n-    logger.info(\"Subscribing to path: {} took: {}\", path, (end - start));\n+    logger.info(\"CallbackHandler{}, Subscribing to path: {} took: {}\", this.toString(), path, (end - start));\n   }\n \n   public EventType[] getEventTypes() {\n     return (EventType[]) _eventTypes.toArray();\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);\n+    return stringBuilder.toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTMyNTEwOA=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 201}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2NzI3OQ==", "bodyText": "changed .", "url": "https://github.com/apache/helix/pull/1355#discussion_r492467279", "createdAt": "2020-09-22T04:25:01Z", "author": {"login": "kaisun2000"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -660,24 +666,31 @@ private void subscribeForChanges(NotificationContext.Type callbackType, String p\n           //TODO: avoid calling getChildren for path that does not exist\n           if (_changeType == CUSTOMIZED_STATE_ROOT) {\n             logger.warn(\n-                \"Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n-                    + \"does not support Customized State!\", path, _listener);\n+                \"CallbackHandler {}, Failed to subscribe child/data change on path: {}, listener: {}. Instance \"\n+                    + \"does not support Customized State!\", this.toString(), path, _listener);\n           } else {\n-            logger.warn(\"Failed to subscribe child/data change. path: {}, listener: {}\", path,\n-                _listener, e);\n+            logger.warn(\"CallbackHandler {}, Failed to subscribe child/data change. path: {}, listener: {}\",\n+                this.toString(), path, _listener, e);\n           }\n         }\n       }\n     }\n \n     long end = System.currentTimeMillis();\n-    logger.info(\"Subscribing to path: {} took: {}\", path, (end - start));\n+    logger.info(\"CallbackHandler{}, Subscribing to path: {} took: {}\", this.toString(), path, (end - start));\n   }\n \n   public EventType[] getEventTypes() {\n     return (EventType[]) _eventTypes.toArray();\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);\n+    return stringBuilder.toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTMyNTEwOA=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 201}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTM0NDg3OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMTowODowOVrOHRs0Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwNDoyNDo0NVrOHVp0FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjEyNw==", "bodyText": "Same thing here, it seems that directly refer to _uid is enough.", "url": "https://github.com/apache/helix/pull/1355#discussion_r488322127", "createdAt": "2020-09-15T01:08:09Z", "author": {"login": "jiajunwang"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -204,6 +204,13 @@ public void recordPathStat(Stat stat, OptionalLong notificationTime) {\n     }\n   }\n \n+  @Override\n+  public String toString() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2NzIyMQ==", "bodyText": "changed.", "url": "https://github.com/apache/helix/pull/1355#discussion_r492467221", "createdAt": "2020-09-22T04:24:45Z", "author": {"login": "kaisun2000"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -204,6 +204,13 @@ public void recordPathStat(Stat stat, OptionalLong notificationTime) {\n     }\n   }\n \n+  @Override\n+  public String toString() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjEyNw=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTM0NjM1OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMTowODo1OFrOHRs1Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwNDoyNDoxOFrOHVpzoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjM0Nw==", "bodyText": "nit \"_uid\" => \"uid\"", "url": "https://github.com/apache/helix/pull/1355#discussion_r488322347", "createdAt": "2020-09-15T01:08:58Z", "author": {"login": "jiajunwang"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -220,7 +227,7 @@ protected ZkClient(IZkConnection zkConnection, int connectionTimeout, long opera\n \n     _asyncCallRetryThread = new ZkAsyncRetryThread(zkConnection.getServers());\n     _asyncCallRetryThread.start();\n-    LOG.debug(\"ZkClient created with _uid {}, _asyncCallRetryThread id {}\", _uid, _asyncCallRetryThread.getId());\n+    LOG.debug(\"ZkClient created with _uid {}, _asyncCallRetryThread id {}\", this.toString(), _asyncCallRetryThread.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2NzEwNQ==", "bodyText": "changed,", "url": "https://github.com/apache/helix/pull/1355#discussion_r492467105", "createdAt": "2020-09-22T04:24:18Z", "author": {"login": "kaisun2000"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -220,7 +227,7 @@ protected ZkClient(IZkConnection zkConnection, int connectionTimeout, long opera\n \n     _asyncCallRetryThread = new ZkAsyncRetryThread(zkConnection.getServers());\n     _asyncCallRetryThread.start();\n-    LOG.debug(\"ZkClient created with _uid {}, _asyncCallRetryThread id {}\", _uid, _asyncCallRetryThread.getId());\n+    LOG.debug(\"ZkClient created with _uid {}, _asyncCallRetryThread id {}\", this.toString(), _asyncCallRetryThread.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjM0Nw=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTM0ODc2OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwMToxMDoxOFrOHRs2jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwNDoyNDozMVrOHVpz3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjcwMg==", "bodyText": "I just notice that _uid here was not made final field, could you please fix it? It should be a final field.", "url": "https://github.com/apache/helix/pull/1355#discussion_r488322702", "createdAt": "2020-09-15T01:10:18Z", "author": {"login": "jiajunwang"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -204,6 +204,13 @@ public void recordPathStat(Stat stat, OptionalLong notificationTime) {\n     }\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2NzE2Nw==", "bodyText": "changed to final", "url": "https://github.com/apache/helix/pull/1355#discussion_r492467167", "createdAt": "2020-09-22T04:24:31Z", "author": {"login": "kaisun2000"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -204,6 +204,13 @@ public void recordPathStat(Stat stat, OptionalLong notificationTime) {\n     }\n   }\n \n+  @Override\n+  public String toString() {\n+    StringBuilder stringBuilder = new StringBuilder();\n+    stringBuilder.append(_uid);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjcwMg=="}, "originalCommit": {"oid": "ffc89ce95532d52e7be19b339dd3c2e2cf6072e5"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4Njg0NjA1OnYy", "diffSide": "RIGHT", "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNjoxMzo1N1rOHWX1HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNjoxMzo1N1rOHWX1HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIyMTE0OQ==", "bodyText": "It'd be great to make these similar messages easier to read, like Closing zkclient. uid={}, zk={}?", "url": "https://github.com/apache/helix/pull/1355#discussion_r493221149", "createdAt": "2020-09-23T06:13:57Z", "author": {"login": "huizhilu"}, "path": "zookeeper-api/src/main/java/org/apache/helix/zookeeper/zkclient/ZkClient.java", "diffHunk": "@@ -2228,7 +2233,7 @@ public void close() throws ZkInterruptedException {\n       _eventThread.interrupt();\n       _eventThread.join(2000);\n       if (isManagingZkConnection()) {\n-        LOG.info(\"Closing zkclient: \" + ((ZkConnection) connection).getZookeeper());\n+        LOG.info(\"zkclient{}, Closing zkclient zk: {} \", this._uid, ((ZkConnection) connection).getZookeeper());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af895545b294257c596db3be9de31cbcdb3701b"}, "originalPosition": 393}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4Njg1Nzk4OnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNjoxODo0NFrOHWX8Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNzo1NDoxNlrOHW6BCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIyMjk3NQ==", "bodyText": "static final?\nAnd also give it a more comprehensive name, like CALLBACK_HANDLER_UID or NEXT_ID?", "url": "https://github.com/apache/helix/pull/1355#discussion_r493222975", "createdAt": "2020-09-23T06:18:44Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -105,7 +106,9 @@\n @PreFetchChangedData(enabled = false)\n public class CallbackHandler implements IZkChildListener, IZkDataListener {\n   private static Logger logger = LoggerFactory.getLogger(CallbackHandler.class);\n+  private static AtomicLong CB_UID = new AtomicLong();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af895545b294257c596db3be9de31cbcdb3701b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4MTI1OQ==", "bodyText": "changed.", "url": "https://github.com/apache/helix/pull/1355#discussion_r493781259", "createdAt": "2020-09-23T17:54:16Z", "author": {"login": "kaisun2000"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -105,7 +106,9 @@\n @PreFetchChangedData(enabled = false)\n public class CallbackHandler implements IZkChildListener, IZkDataListener {\n   private static Logger logger = LoggerFactory.getLogger(CallbackHandler.class);\n+  private static AtomicLong CB_UID = new AtomicLong();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIyMjk3NQ=="}, "originalCommit": {"oid": "3af895545b294257c596db3be9de31cbcdb3701b"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4NjkyOTMzOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNjo0NDoyOFrOHWYnPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNjo0NDoyOFrOHWYnPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzIzMzk4Mw==", "bodyText": "This is not used. Remove it?", "url": "https://github.com/apache/helix/pull/1355#discussion_r493233983", "createdAt": "2020-09-23T06:44:28Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -28,6 +28,7 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Set;\n+import java.util.concurrent.atomic.AtomicInteger;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3af895545b294257c596db3be9de31cbcdb3701b"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDM0MzYwOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxODowNTozMlrOHW6cgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMDoxMTo1NlrOHW_OSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4ODI5MQ==", "bodyText": "@kaisun2000 This one? CALLBACK_HANDLER_UI -> CALLBACK_HANDLER_UID", "url": "https://github.com/apache/helix/pull/1355#discussion_r493788291", "createdAt": "2020-09-23T18:05:32Z", "author": {"login": "huizhilu"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -105,7 +105,9 @@\n @PreFetchChangedData(enabled = false)\n public class CallbackHandler implements IZkChildListener, IZkDataListener {\n   private static Logger logger = LoggerFactory.getLogger(CallbackHandler.class);\n+  private static final AtomicLong CALLBACK_HANDLER_UI = new AtomicLong();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591254ab11c7317e51866c5a7c6722aa7eaa08e7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg2NjU2OQ==", "bodyText": "good catch. fixed.", "url": "https://github.com/apache/helix/pull/1355#discussion_r493866569", "createdAt": "2020-09-23T20:11:56Z", "author": {"login": "kaisun2000"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -105,7 +105,9 @@\n @PreFetchChangedData(enabled = false)\n public class CallbackHandler implements IZkChildListener, IZkDataListener {\n   private static Logger logger = LoggerFactory.getLogger(CallbackHandler.class);\n+  private static final AtomicLong CALLBACK_HANDLER_UI = new AtomicLong();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc4ODI5MQ=="}, "originalCommit": {"oid": "591254ab11c7317e51866c5a7c6722aa7eaa08e7"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MTA2MDUzOnYy", "diffSide": "RIGHT", "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMToxOTozNVrOHXBX9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMTozNzoyMFrOHXB3GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwMTgxNQ==", "bodyText": "nit, \"this.\" in \"this._uid\" is not necessary, right?\nSame as the following places.", "url": "https://github.com/apache/helix/pull/1355#discussion_r493901815", "createdAt": "2020-09-23T21:19:35Z", "author": {"login": "jiajunwang"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -354,10 +359,10 @@ public void enqueueTask(NotificationContext changeContext) throws Exception {\n     // async mode only applicable to CALLBACK from ZK, During INIT and FINALIZE invoke the\n     // callback's immediately.\n     if (_batchModeEnabled && changeContext.getType() == NotificationContext.Type.CALLBACK) {\n-      logger.debug(\"Enqueuing callback\");\n+      logger.debug(\"Callbackhandler {}, Enqueuing callback\", this._uid );\n       if (!isReady()) {\n-        logger.info(\"CallbackHandler is not ready, ignore change callback from path: {}, for \"\n-            + \"listener: {}\", _path, _listener);\n+        logger.info(\"CallbackHandler {} is not ready, ignore change callback from path: {}, for \"\n+            + \"listener: {}\", this._uid, _path, _listener);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8b43c005f88d39ec498954d01b7ccd48ac02a7f"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTc4NQ==", "bodyText": "removed all this.", "url": "https://github.com/apache/helix/pull/1355#discussion_r493909785", "createdAt": "2020-09-23T21:37:20Z", "author": {"login": "kaisun2000"}, "path": "helix-core/src/main/java/org/apache/helix/manager/zk/CallbackHandler.java", "diffHunk": "@@ -354,10 +359,10 @@ public void enqueueTask(NotificationContext changeContext) throws Exception {\n     // async mode only applicable to CALLBACK from ZK, During INIT and FINALIZE invoke the\n     // callback's immediately.\n     if (_batchModeEnabled && changeContext.getType() == NotificationContext.Type.CALLBACK) {\n-      logger.debug(\"Enqueuing callback\");\n+      logger.debug(\"Callbackhandler {}, Enqueuing callback\", this._uid );\n       if (!isReady()) {\n-        logger.info(\"CallbackHandler is not ready, ignore change callback from path: {}, for \"\n-            + \"listener: {}\", _path, _listener);\n+        logger.info(\"CallbackHandler {} is not ready, ignore change callback from path: {}, for \"\n+            + \"listener: {}\", this._uid, _path, _listener);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwMTgxNQ=="}, "originalCommit": {"oid": "f8b43c005f88d39ec498954d01b7ccd48ac02a7f"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 942, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}