{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NDQ4NTQ5", "number": 622, "title": "[EIP-1559] Step 3 - Implement EIP-1559 logic in a manager class", "bodyText": "PR description\nWe need a manager class to hold EIP-1559 core logic. This helper class will be then used by glue code. This separation make testing simpler.\nSpecifically the following methods:\n\nlong computeBaseFee(final long parentBaseFee, final long parentGasUsed)\nboolean isValidBaseFee(final long parentBaseFee, final long baseFee)\nlong eip1559GasPool(final long blockNumber)\nlong legacyGasPool(final long blockNumber)\n\nFixed Issue(s)\n\n\nfixes #621\nSigned-off-by: Abdelhamid Bakhta abdelhamid.bakhta@consensys.net", "createdAt": "2020-03-31T16:27:16Z", "url": "https://github.com/hyperledger/besu/pull/622", "merged": true, "mergeCommit": {"oid": "96122e05d73609ced9071b0b6adbe1a36bfe125e"}, "closed": true, "closedAt": "2020-04-03T17:34:37Z", "author": {"login": "abdelhamidbakhta"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM4BqCAH2gAyMzk2NDQ4NTQ5OmJhMzdmZDBlZmNiYTJkZTRlYTM0Yzk3OTA2MGZmMzYxYTFmZTk3OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUEOO4AFqTM4NzQ0MTY4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ba37fd0efcba2de4ea34c979060ff361a1fe9798", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/ba37fd0efcba2de4ea34c979060ff361a1fe9798", "committedDate": "2020-03-12T09:09:40Z", "message": "Added changelog entries for PR:\n- https://github.com/hyperledger/besu/pull/430\n- https://github.com/hyperledger/besu/pull/440\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "872f9cc4e93b90829961ebe6e599c51af43c95a7", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/872f9cc4e93b90829961ebe6e599c51af43c95a7", "committedDate": "2020-03-13T08:25:43Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e417b30e90cb0b33940adb1bee6a9dc8953c4abd", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e417b30e90cb0b33940adb1bee6a9dc8953c4abd", "committedDate": "2020-03-16T09:10:11Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2fb831c87dae221c92a9f9ec7705500717f1e77", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/a2fb831c87dae221c92a9f9ec7705500717f1e77", "committedDate": "2020-03-17T09:17:25Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c07ed7de515e1e25ea22ef38b59bf8337086812e", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/c07ed7de515e1e25ea22ef38b59bf8337086812e", "committedDate": "2020-03-17T15:26:18Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c1e22fe5a81e6a748b338a2ebedaaa53a00f04d", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/1c1e22fe5a81e6a748b338a2ebedaaa53a00f04d", "committedDate": "2020-03-18T08:29:25Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee10a2590d8e23b95a40c946a2927730714c4793", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/ee10a2590d8e23b95a40c946a2927730714c4793", "committedDate": "2020-03-19T16:27:54Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40cd31d7b48aab7b285524661ac17168c0d38467", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/40cd31d7b48aab7b285524661ac17168c0d38467", "committedDate": "2020-03-23T10:35:38Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e96c01a8ca248ded2aa4f22a6f56d9119cabebf2", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e96c01a8ca248ded2aa4f22a6f56d9119cabebf2", "committedDate": "2020-03-25T08:04:10Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c782ba4617a68e42def01737bdc6950ff7f9f53", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/2c782ba4617a68e42def01737bdc6950ff7f9f53", "committedDate": "2020-03-31T09:26:18Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "854ed2a6c863415636cd24a0519de23e9471c9fc", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/854ed2a6c863415636cd24a0519de23e9471c9fc", "committedDate": "2020-03-31T13:50:37Z", "message": "### Description\nBlockHeader object needs to be modified in order to add the new field (baseFee) as specified in the EIP.\nWe should take care about the RLP encoding/decoding of this structure since it has to include or not the new fields depending on whether we are pre fork or post fork.\n\n- Update `core.BlockHeader.java`\n    - Add `baseFee`\n    - Update `readFrom` method for RLP decoding\n    - Update `writeTo` method for RLP encoding\n- Update `plugin.data.BlockHeader.java`\n    - Add `getBaseFee` method\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8ddc67cce5fb022f17b0bd8abfd0d70fd83420e", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/d8ddc67cce5fb022f17b0bd8abfd0d70fd83420e", "committedDate": "2020-03-31T15:05:17Z", "message": "### Description\nTransaction object needs to be modified in order to add the 2 new fields (`gasPremium` and `feeCap`) as specified in the EIP.\nWe should take care about the RLP encoding/decoding of this structure since it has to include or not the new fields depending on whether we are pre fork or post fork.\n\n- Update core `Transaction` object\n    - Add gasPremium and feeCap fields\n    - Update readFrom method for RLP decoding\n    - Update writeTo method for RLP encoding\n- Update plugin `Transaction` interface\n    - Add `getGasPremium` and `getFeeCap` methods\n\nThis EIP introduces gasPremium and feeCap fields in the transaction. They need to be included in the signing mechanism.\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09b5c6d8556ffd4cda24714257d9c454ab32e503", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/09b5c6d8556ffd4cda24714257d9c454ab32e503", "committedDate": "2020-03-31T16:25:22Z", "message": "We need a manager class to hold EIP-1559 core logic. This helper class will be then used by glue code. This separation make testing simpler.\nSpecifically the following methods:\n\n- `long computeBaseFee(final long parentBaseFee, final long parentGasUsed)`\n- `boolean isValidBaseFee(final long parentBaseFee, final long baseFee)`\n- `long eip1559GasPool(final long blockNumber)`\n- `long legacyGasPool(final long blockNumber)`\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da50f903b7ce6ff192c5cd5cc841aade0ad8f35c", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/da50f903b7ce6ff192c5cd5cc841aade0ad8f35c", "committedDate": "2020-03-31T16:38:13Z", "message": "spotlessApply\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "493c7d320b4fcd24a561594121615622d7fb0410", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/493c7d320b4fcd24a561594121615622d7fb0410", "committedDate": "2020-04-01T07:56:54Z", "message": "Merge branch 'master' into step-3-manager-class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e70b8baf179450eedc75f49f0c2c828c5c9baa0a", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e70b8baf179450eedc75f49f0c2c828c5c9baa0a", "committedDate": "2020-04-01T15:25:38Z", "message": "TODO Add CLI command line flag `--Xeip1559-enabled`.\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c19dce6aef914e6cf295ede16793e31be0c9af0", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/5c19dce6aef914e6cf295ede16793e31be0c9af0", "committedDate": "2020-04-03T11:39:20Z", "message": "Merge remote-tracking branch 'upstream/master' into step-3-manager-class\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>\n\n# Conflicts:\n#\tethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/BlockHeader.java\n#\tethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/BlockHeaderBuilder.java\n#\tethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/SealableBlockHeader.java\n#\tplugin-api/build.gradle\n#\tplugin-api/src/main/java/org/hyperledger/besu/plugin/data/BlockHeader.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "583acd197f5b4cfbfded20c9cf9ca6d31784364a", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/583acd197f5b4cfbfded20c9cf9ca6d31784364a", "committedDate": "2020-04-03T11:46:30Z", "message": "update known hash\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a43560735ccf71fa33a72b2e525fc1d6d07da70c", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/a43560735ccf71fa33a72b2e525fc1d6d07da70c", "committedDate": "2020-04-03T12:41:09Z", "message": "clean up\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e41d6ef15d288697b0284c7e63c62435787bf744", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e41d6ef15d288697b0284c7e63c62435787bf744", "committedDate": "2020-04-03T12:47:13Z", "message": "Merge branch 'step-3-manager-class' of https://github.com/abdelhamidbakhta/besu into step-3-manager-class\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5f8f84ce168a6111184d6733d969ab6b5eb7ef1", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/b5f8f84ce168a6111184d6733d969ab6b5eb7ef1", "committedDate": "2020-04-03T12:48:27Z", "message": "clean up\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Mzg5NDM4", "url": "https://github.com/hyperledger/besu/pull/622#pullrequestreview-387389438", "createdAt": "2020-04-03T16:05:41Z", "commit": {"oid": "b5f8f84ce168a6111184d6733d969ab6b5eb7ef1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjowNTo0MVrOGAb53Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjowNTo0MVrOGAb53Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzExMDM2NQ==", "bodyText": "These numbers could change in future blocks, especially the target and max gas used.  I think this should be an interface with static methods for each fork.  Call the first one \"experimental\" or just \"EIP1559\".  I could see this moving into ProtocolSchedule once it ships, but while it is experimental it's own interface is fine.", "url": "https://github.com/hyperledger/besu/pull/622#discussion_r403110365", "createdAt": "2020-04-03T16:05:41Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/EIP1559Config.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.core.fees;\n+\n+public class EIP1559Config {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f8f84ce168a6111184d6733d969ab6b5eb7ef1"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22a49084eb09ae499f8ad448b1524955cd2fe10c", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/22a49084eb09ae499f8ad448b1524955cd2fe10c", "committedDate": "2020-04-03T16:24:33Z", "message": "Address PR comments\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a2be3bd68d3a09b1653af5f33cb061f82015e8a", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/9a2be3bd68d3a09b1653af5f33cb061f82015e8a", "committedDate": "2020-04-03T16:44:26Z", "message": "Address PR comments\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11d68c4c1f2725f4bf809096b3553c2cb7a17908", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/11d68c4c1f2725f4bf809096b3553c2cb7a17908", "committedDate": "2020-04-03T16:47:09Z", "message": "Merge remote-tracking branch 'upstream/master' into step-3-manager-class\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b75ba74813da9833647c2600add1de7f65447d8", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/1b75ba74813da9833647c2600add1de7f65447d8", "committedDate": "2020-04-03T16:50:06Z", "message": "remove useless constructor\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95fceedf698cc14555c5602387ff904a9d042f9f", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/95fceedf698cc14555c5602387ff904a9d042f9f", "committedDate": "2020-04-03T16:56:44Z", "message": "add spdx header\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDQxNjg4", "url": "https://github.com/hyperledger/besu/pull/622#pullrequestreview-387441688", "createdAt": "2020-04-03T17:19:44Z", "commit": {"oid": "95fceedf698cc14555c5602387ff904a9d042f9f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1648, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}