{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NzMyNTA3", "number": 421, "title": "Report memory/processes at end of test", "bodyText": "At the end of every test, report the status of memory and running processes.\nA lot of the problems I'm trying to fix come from tests that fail to close nodes. Reporting memory and processes is the simplest stab at letting the user realize what could be going wrong when a test fails spuriously.\nProbably a better solution would be to, instead of having the user create nodes and clusters, have the DSL create them for the user (factory?), so it can keep track of them and later destroy them reliably.", "createdAt": "2020-02-20T12:38:42Z", "url": "https://github.com/hyperledger/besu/pull/421", "merged": true, "mergeCommit": {"oid": "e917a35e80d4349e88485691a1d6fe9722dec9b1"}, "closed": true, "closedAt": "2020-04-09T07:35:01Z", "author": {"login": "hmijail"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGKTtCAH2gAyMzc3NzMyNTA3OjYzNWUzMTUwMDA5NWJlOWQ5YjU5ZjRmNTE4MDQ2YTQ1MzgzNTkzMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV22K4AH2gAyMzc3NzMyNTA3OmUzZTJjMzllYjc0OTM4NDlmZjBjOGU1YTBjMjUwMmQ4MDMyZTdjNDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "635e31500095be9d9b59f4f518046a4538359325", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/635e31500095be9d9b59f4f518046a4538359325", "committedDate": "2020-02-20T12:30:12Z", "message": "Report memory/processes at end of test\n\nSigned-off-by: Horacio Mijail Anton Quiles <hmijail@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNDA3ODYz", "url": "https://github.com/hyperledger/besu/pull/421#pullrequestreview-362407863", "createdAt": "2020-02-21T05:32:51Z", "commit": {"oid": "635e31500095be9d9b59f4f518046a4538359325"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwNTozMjo1MVrOFssIQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwNTozMjo1MVrOFssIQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwNDY3Mw==", "bodyText": "Apply the clean code philosophy here, refactor these into private methods with descriptive names, please", "url": "https://github.com/hyperledger/besu/pull/421#discussion_r382404673", "createdAt": "2020-02-21T05:32:51Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -101,5 +115,42 @@ protected AcceptanceTestBase() {\n   @After\n   public void tearDownAcceptanceTestBase() {\n     cluster.close();\n+\n+    String os = System.getProperty(\"os.name\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "635e31500095be9d9b59f4f518046a4538359325"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "497c15b222ee6ffc77e0b2e1fc33f238c998f956", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/497c15b222ee6ffc77e0b2e1fc33f238c998f956", "committedDate": "2020-02-22T19:01:08Z", "message": "Clean code\n\nSigned-off-by: Horacio Mijail Anton Quiles <hmijail@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08896ec0f396bb429ef43fde7397d45dc0ee0495", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/08896ec0f396bb429ef43fde7397d45dc0ee0495", "committedDate": "2020-03-24T05:32:45Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93b2e803ee497365ff437ce604e75e7abc98b21e", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/93b2e803ee497365ff437ce604e75e7abc98b21e", "committedDate": "2020-03-24T08:30:59Z", "message": "Merge remote-tracking branch 'upstream/master' into report-memory\n\nSigned-off-by: Horacio Mijail Anton Quiles <hmijail@gmail.com>\n\n# Conflicts:\n#\tacceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzg2MjIw", "url": "https://github.com/hyperledger/besu/pull/421#pullrequestreview-380786220", "createdAt": "2020-03-25T00:25:25Z", "commit": {"oid": "93b2e803ee497365ff437ce604e75e7abc98b21e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwMDoyNToyNlrOF7H-_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwMDoyNjozMlrOF7IAGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU0MTExNg==", "bodyText": "Doesn't this Log4j property need setting before the Log4j2 framework get initialised? (isn't it too late by here)", "url": "https://github.com/hyperledger/besu/pull/421#discussion_r397541116", "createdAt": "2020-03-25T00:25:26Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -52,13 +53,18 @@\n \n import org.apache.logging.log4j.LogManager;\n import org.apache.logging.log4j.Logger;\n+import org.apache.logging.log4j.ThreadContext;\n import org.junit.After;\n import org.junit.Rule;\n import org.junit.rules.TestName;\n import org.junit.rules.TestWatcher;\n import org.junit.runner.Description;\n \n public class AcceptanceTestBase {\n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93b2e803ee497365ff437ce604e75e7abc98b21e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU0MTQwMw==", "bodyText": "Remind me again why this rule needs to be in the AcceptanceTestBase and not it's own class?", "url": "https://github.com/hyperledger/besu/pull/421#discussion_r397541403", "createdAt": "2020-03-25T00:26:32Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -201,4 +168,46 @@ public void tearDownAcceptanceTestBase() {\n       LOG.info(\"Don't know how to report memory for OS {}\", os);\n     }\n   }\n+\n+  @Rule", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93b2e803ee497365ff437ce604e75e7abc98b21e"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08a1164410b7413d288a0a3f1ae54d830f77de08", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/08a1164410b7413d288a0a3f1ae54d830f77de08", "committedDate": "2020-03-25T13:10:42Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "812a095fbc014ef85db71357a6082c60f2335f07", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/812a095fbc014ef85db71357a6082c60f2335f07", "committedDate": "2020-03-26T10:46:46Z", "message": "Address comment: move property setting to a properties file\n\nSigned-off-by: Horacio Mijail Anton Quiles <hmijail@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83c83f517ea0ceb58aa448cfb6fb281a1974a0a5", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/83c83f517ea0ceb58aa448cfb6fb281a1974a0a5", "committedDate": "2020-03-27T00:41:35Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4e14bae78155bae8b66632f7085c52c15667e5c", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/c4e14bae78155bae8b66632f7085c52c15667e5c", "committedDate": "2020-04-01T01:03:59Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8bb6bf83fc28b0ab1e254f55ffd3ffe1dc2bacf", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/a8bb6bf83fc28b0ab1e254f55ffd3ffe1dc2bacf", "committedDate": "2020-04-01T12:32:53Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55a4b1289587122ee98a9485cd9cd12fbd292976", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/55a4b1289587122ee98a9485cd9cd12fbd292976", "committedDate": "2020-04-02T05:02:30Z", "message": "Clean code further\n\nSigned-off-by: Horacio Mijail Anton Quiles <hmijail@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c9d44e6bcb278935606b414481cc85211dc4463", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/7c9d44e6bcb278935606b414481cc85211dc4463", "committedDate": "2020-04-02T05:04:07Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzU2NDc0", "url": "https://github.com/hyperledger/besu/pull/421#pullrequestreview-388756474", "createdAt": "2020-04-07T03:16:08Z", "commit": {"oid": "7c9d44e6bcb278935606b414481cc85211dc4463"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad878feec10fb5ce72cf114575649cb4de07f457", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/ad878feec10fb5ce72cf114575649cb4de07f457", "committedDate": "2020-04-07T03:17:01Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edb3d189a5b100b2e53745c63687b2b32fbda18e", "author": {"user": {"login": "CjHare", "name": "CJ Hare"}}, "url": "https://github.com/hyperledger/besu/commit/edb3d189a5b100b2e53745c63687b2b32fbda18e", "committedDate": "2020-04-07T06:51:45Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae9a8a3c7f184bff30dee2343f8d20af8a0d7d9d", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/ae9a8a3c7f184bff30dee2343f8d20af8a0d7d9d", "committedDate": "2020-04-07T07:40:29Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebbb671419d7754b98b5183ecadad2972ecdaf36", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/ebbb671419d7754b98b5183ecadad2972ecdaf36", "committedDate": "2020-04-07T13:49:15Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068426c8eba8ff17abb5710bdf480a284e2c0543", "author": {"user": {"login": "hmijail", "name": "Horacio Mijail Ant\u00f3n Quiles"}}, "url": "https://github.com/hyperledger/besu/commit/068426c8eba8ff17abb5710bdf480a284e2c0543", "committedDate": "2020-04-08T23:17:06Z", "message": "Merge branch 'master' into report-memory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3e2c39eb7493849ff0c8e5a0c2502d8032e7c47", "author": {"user": {"login": "CjHare", "name": "CJ Hare"}}, "url": "https://github.com/hyperledger/besu/commit/e3e2c39eb7493849ff0c8e5a0c2502d8032e7c47", "committedDate": "2020-04-09T06:52:32Z", "message": "Merge branch 'master' into report-memory"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1791, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}