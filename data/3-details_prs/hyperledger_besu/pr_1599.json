{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1NDUzOTQx", "number": 1599, "title": "Go quorum enclave", "bodyText": "Add an enclave that uses Tessera to send and receive private transactions.\nThis implementation supports the functionality necessary for the Besu privacy mode that is compatible with GoQuorum standard privacy.", "createdAt": "2020-11-23T05:16:11Z", "url": "https://github.com/hyperledger/besu/pull/1599", "merged": true, "mergeCommit": {"oid": "a4a8723b695294a3ad003be7016905ae4ab38807"}, "closed": true, "closedAt": "2020-11-24T23:17:11Z", "author": {"login": "pinges"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfOCzMgH2gAyNTI1NDUzOTQxOjBjZTI4YTg5Mzg5NzczOTkwZTljZmY2NDQ3YWIwY2U3OWViZDZhMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfxsUxgH2gAyNTI1NDUzOTQxOjM3NTgzMDEwOTQ0ZWM4ZjVjNGUwYTZjMzcxZWVhYjdjNmJkYWRlZjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0ce28a89389773990e9cff6447ab0ce79ebd6a19", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/0ce28a89389773990e9cff6447ab0ce79ebd6a19", "committedDate": "2020-11-23T05:10:37Z", "message": "add enclave for goQuorum privacy using Tessera\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c4f68aa3008edb47abf30c4dc9695b189d83852", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/2c4f68aa3008edb47abf30c4dc9695b189d83852", "committedDate": "2020-11-23T05:11:16Z", "message": "Merge branch 'master' of github.com:hyperledger/besu into goQuorumEnclave"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fff8392079ff15ebb0679d9135bdb2b8dc14c92", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/8fff8392079ff15ebb0679d9135bdb2b8dc14c92", "committedDate": "2020-11-23T05:36:04Z", "message": "add enclave for goQuorum privacy using Tessera\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a85643072e0cca1dda4a3c12ede417109786bb1e", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/a85643072e0cca1dda4a3c12ede417109786bb1e", "committedDate": "2020-11-23T05:53:51Z", "message": "add enclave for goQuorum privacy using Tessera\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2ODM3OTMz", "url": "https://github.com/hyperledger/besu/pull/1599#pullrequestreview-536837933", "createdAt": "2020-11-23T20:55:12Z", "commit": {"oid": "a85643072e0cca1dda4a3c12ede417109786bb1e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMDo1NToxMlrOH4e_Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMDo1OTozNVrOH4fHvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk4OTk5OA==", "bodyText": "If this is not needed we can delete it.", "url": "https://github.com/hyperledger/besu/pull/1599#discussion_r528989998", "createdAt": "2020-11-23T20:55:12Z", "author": {"login": "lucassaldanha"}, "path": "enclave/src/main/java/org/hyperledger/besu/enclave/GoQuorumEnclave.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.enclave;\n+\n+import org.hyperledger.besu.enclave.RequestTransmitter.ResponseBodyHandler;\n+import org.hyperledger.besu.enclave.types.GoQuorumReceiveResponse;\n+import org.hyperledger.besu.enclave.types.GoQuorumSendRequest;\n+import org.hyperledger.besu.enclave.types.ReceiveRequest;\n+import org.hyperledger.besu.enclave.types.SendResponse;\n+\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+\n+public class GoQuorumEnclave {\n+\n+  private static final ObjectMapper objectMapper = new ObjectMapper();\n+  private static final String JSON = \"application/json\";\n+\n+  private final RequestTransmitter requestTransmitter;\n+\n+  public GoQuorumEnclave(final RequestTransmitter requestTransmitter) {\n+    this.requestTransmitter = requestTransmitter;\n+  }\n+\n+  public boolean upCheck() {\n+    try {\n+      final String upcheckResponse =\n+          requestTransmitter.get(null, null, \"/upcheck\", this::handleRawResponse);\n+      return upcheckResponse.equals(\"I'm up!\");\n+    } catch (final Exception e) {\n+      return false;\n+    }\n+  }\n+\n+  public SendResponse send(\n+      final byte[] payload, final String privateFrom, final List<String> privateFor) {\n+    final GoQuorumSendRequest request = new GoQuorumSendRequest(payload, privateFrom, privateFor);\n+    return post(\n+        JSON,\n+        request,\n+        \"/send\",\n+        (statusCode, body) -> handleJsonResponse(statusCode, body, SendResponse.class, 201));\n+  }\n+\n+  public GoQuorumReceiveResponse receive(final String payloadKey) {\n+    final ReceiveRequest request = new ReceiveRequest(payloadKey);\n+    return get(\n+        JSON,\n+        request,\n+        \"/receive\",\n+        (statusCode, body) ->\n+            handleJsonResponse(statusCode, body, GoQuorumReceiveResponse.class, 200));\n+  }\n+\n+  //  This method is not needed for GoQuorum privacy, as we do not support multi-tenancy\n+  //  public GoQuorumReceiveResponse receive(final String payloadKey, final String to) {\n+  //    final ReceiveRequest request = new ReceiveRequest(payloadKey, to);\n+  //    return get(\n+  //        JSON,\n+  //        request,\n+  //        \"/receive\",\n+  //        (statusCode, body) ->\n+  //            handleJsonResponse(statusCode, body, GoQuorumReceiveResponse.class, 200));\n+  //  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a85643072e0cca1dda4a3c12ede417109786bb1e"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MjE5MA==", "bodyText": "Why do we need the media-type and content in the interface?", "url": "https://github.com/hyperledger/besu/pull/1599#discussion_r528992190", "createdAt": "2020-11-23T20:59:35Z", "author": {"login": "lucassaldanha"}, "path": "enclave/src/main/java/org/hyperledger/besu/enclave/RequestTransmitter.java", "diffHunk": "@@ -27,5 +27,9 @@\n       String endpoint,\n       ResponseBodyHandler<T> responseBodyHandler);\n \n-  <T> T get(String endpoint, ResponseBodyHandler<T> responseBodyHandler);\n+  <T> T get(\n+      String mediaType,\n+      String content,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a85643072e0cca1dda4a3c12ede417109786bb1e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6618d209de4545a20055144b056be53821adc317", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/6618d209de4545a20055144b056be53821adc317", "committedDate": "2020-11-23T23:11:31Z", "message": "Merge branch 'master' of github.com:hyperledger/besu into goQuorumEnclave"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dabd24bcc816abec390577b7ee31cd14fc6985bd", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/dabd24bcc816abec390577b7ee31cd14fc6985bd", "committedDate": "2020-11-23T23:20:35Z", "message": "removed code that was commented out\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cedbe72f9bedd1c34771a7c5810e776165deb378", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/cedbe72f9bedd1c34771a7c5810e776165deb378", "committedDate": "2020-11-23T23:27:53Z", "message": "removed code that was commented out\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3ODg4OTE1", "url": "https://github.com/hyperledger/besu/pull/1599#pullrequestreview-537888915", "createdAt": "2020-11-24T20:44:35Z", "commit": {"oid": "cedbe72f9bedd1c34771a7c5810e776165deb378"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37583010944ec8f5c4e0a6c371eeab7c6bdadef1", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/37583010944ec8f5c4e0a6c371eeab7c6bdadef1", "committedDate": "2020-11-24T22:42:39Z", "message": "Merge branch 'master' into goQuorumEnclave"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2118, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}