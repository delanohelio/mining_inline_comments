{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMzMxNzE2", "number": 1567, "title": "added blockhash as alias for blockHash param; added tests", "bodyText": "Signed-off-by: Sally MacFarlane sally.macfarlane@consensys.net\nAdded blockhash as an alias for blockHash property\nPR description\nFixed Issue(s)\nSee #1540\nChangelog\n\n I thought about the changelog and included a changelog update if required.", "createdAt": "2020-11-16T03:29:29Z", "url": "https://github.com/hyperledger/besu/pull/1567", "merged": true, "mergeCommit": {"oid": "2898bc6f8d94ddd36eb047d479ac66897f1f03a1"}, "closed": true, "closedAt": "2020-11-23T02:29:19Z", "author": {"login": "macfarla"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdc7VlCgH2gAyNTIxMzMxNzE2OjZkNWEwZGYxMmU3YTk5YzNiMDA2MDgxYTRlYjdhZWNhNGU3NjFiZjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfLZx0AH2gAyNTIxMzMxNzE2OjlhNDdhYjI5OWVkNTcwNjI1ZmRhY2FkNTIwNDFiMDZkYTM1NDkzMTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6d5a0df12e7a99c3b006081a4eb7aeca4e761bf1", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/6d5a0df12e7a99c3b006081a4eb7aeca4e761bf1", "committedDate": "2020-11-16T02:15:05Z", "message": "added case insensitive annotation for blockHash param; added tests\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d5e3d97654ce39851c5888c2a4393ed369d920a", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/2d5e3d97654ce39851c5888c2a4393ed369d920a", "committedDate": "2020-11-16T03:29:50Z", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63349ae4343609b77065ed57332949256ef4ea93", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/63349ae4343609b77065ed57332949256ef4ea93", "committedDate": "2020-11-20T04:12:17Z", "message": "gradle jackson version\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de51b61660eab67d0e7992fc0cb2357e54fcfcb1", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/de51b61660eab67d0e7992fc0cb2357e54fcfcb1", "committedDate": "2020-11-22T23:56:10Z", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ee230b1f5d3c521ce64cb85b3a5f67e7df9e2e", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/83ee230b1f5d3c521ce64cb85b3a5f67e7df9e2e", "committedDate": "2020-11-22T23:57:24Z", "message": "reverted gradle changes\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3adcd2a8eed4812c71fd51a339c6ddc637e82526", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/3adcd2a8eed4812c71fd51a339c6ddc637e82526", "committedDate": "2020-11-23T00:39:53Z", "message": "JsonAlias\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1151979e80e2638c4d7acd6596b1cebd1045ba8e", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/1151979e80e2638c4d7acd6596b1cebd1045ba8e", "committedDate": "2020-11-23T00:54:53Z", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into block-hash-rpc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dbc968ba149c1f3d56ca8233b683359ae8fb620", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/6dbc968ba149c1f3d56ca8233b683359ae8fb620", "committedDate": "2020-11-23T00:55:11Z", "message": "formatting\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd646cb1832a2006be3469f7ea8f60aec8ef1ec", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/9bd646cb1832a2006be3469f7ea8f60aec8ef1ec", "committedDate": "2020-11-23T01:07:08Z", "message": "changelog entry\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642", "committedDate": "2020-11-23T01:09:13Z", "message": "spaces\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MTQyODUz", "url": "https://github.com/hyperledger/besu/pull/1567#pullrequestreview-536142853", "createdAt": "2020-11-23T01:40:07Z", "commit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0MDowN1rOH39WcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0ODo1OFrOH39bHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzODg5Ng==", "bodyText": "Looks like you don't need to include blockHash in @JsonAlias.", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528438896", "createdAt": "2020-11-23T01:40:07Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameter.java", "diffHunk": "@@ -49,7 +50,7 @@ public FilterParameter(\n           final List<Address> address,\n       @JsonDeserialize(using = TopicsDeserializer.class) @JsonProperty(\"topics\")\n           final List<List<LogTopic>> topics,\n-      @JsonProperty(\"blockhash\") final Hash blockHash) {\n+      @JsonProperty(\"blockHash\") @JsonAlias({\"blockhash\", \"blockHash\"}) final Hash blockHash) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzOTU5Mg==", "bodyText": "I'd consider deleting the previous test because the name clash is a bit confusing and the case of blockHash doesn't seem significant to the test case.", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528439592", "createdAt": "2020-11-23T01:45:06Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MDA5Mg==", "bodyText": "The different casing of the test names is a bit confusing again...\nWould it make sense to merge both of these test cases into a blockHashAliasSucceeds that asserts the output of both requests is valid and that the output is equal?", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528440092", "createdAt": "2020-11-23T01:48:58Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test\n+  public void jsonWithBlockHashAndFromAndToParametersIsInvalid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\", \\\"fromBlock\\\": \\\"0x0\\\", \\\"toBlock\\\": \\\"pending\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isFalse();\n+  }\n+\n+  @Test\n+  public void jsonWithBlockHashIsValid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isTrue();\n+    assertThat(parsedFilterParameter.getBlockHash()).isEqualTo(Optional.of(Hash.ZERO));\n+  }\n+\n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2c04d2b5479bcb6573005a4d164c6d18a423e7b", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/b2c04d2b5479bcb6573005a4d164c6d18a423e7b", "committedDate": "2020-11-23T01:54:10Z", "message": "space\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47798fe43b7abbd0190a3a20895d0ae17a775237", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/47798fe43b7abbd0190a3a20895d0ae17a775237", "committedDate": "2020-11-23T02:05:46Z", "message": "refactored testing of alias\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a47ab299ed570625fdacad52041b06da3549317", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/9a47ab299ed570625fdacad52041b06da3549317", "committedDate": "2020-11-23T02:06:00Z", "message": "made past tense\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2099, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}