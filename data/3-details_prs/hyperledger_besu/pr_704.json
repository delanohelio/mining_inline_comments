{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyOTg5MjY5", "number": 704, "title": "Separate recId calc from signing", "bodyText": "PR description\nSecurity frameworks create signatures of 64-bytes (for a 256-bit keys) - and do not produce the recId.\nFurthermore, the signatures created maybe in the upper-half of the curve, which is illegal under Ethereum.\nAs these checks must be applied to signatures generated by the jce, it is prudent to separate the concept of signature generation, from the post-operations.\nFixed Issue(s)\nN/A", "createdAt": "2020-04-14T06:13:33Z", "url": "https://github.com/hyperledger/besu/pull/704", "merged": true, "mergeCommit": {"oid": "d6fabbda70d65ddac56bdda630a0e4b244cb2762"}, "closed": true, "closedAt": "2020-04-15T03:03:37Z", "author": {"login": "rain-on"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXdPi5AH2gAyNDAyOTg5MjY5Ojk0YzkwZjVjZmQyOGI3ZmQ5NzUxZTkzMDBiM2E4ZDMwODUzYWUxYzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXvEtEgFqTM5MzQyNDUzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94c90f5cfd28b7fd9751e9300b3a8d30853ae1c3", "author": {"user": null}, "url": "https://github.com/hyperledger/besu/commit/94c90f5cfd28b7fd9751e9300b3a8d30853ae1c3", "committedDate": "2020-04-14T06:10:34Z", "message": "Separate recId calc from signing\n\nSigned-off-by: Trent Mohay <trent.mohay@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNjM4NDQ0", "url": "https://github.com/hyperledger/besu/pull/704#pullrequestreview-392638444", "createdAt": "2020-04-14T06:36:17Z", "commit": {"oid": "94c90f5cfd28b7fd9751e9300b3a8d30853ae1c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwNjozNjoxN1rOGFAH6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwNjozNjoxN1rOGFAH6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzg5ODA5MQ==", "bodyText": "DataHash shouldn't be needed here", "url": "https://github.com/hyperledger/besu/pull/704#discussion_r407898091", "createdAt": "2020-04-14T06:36:17Z", "author": {"login": "jframe"}, "path": "crypto/src/main/java/org/hyperledger/besu/crypto/SECP256K1.java", "diffHunk": "@@ -187,9 +187,17 @@ public static Signature sign(final Bytes32 dataHash, final KeyPair keyPair) {\n     signer.init(true, privKey);\n \n     final BigInteger[] components = signer.generateSignature(dataHash.toArrayUnsafe());\n-    final BigInteger r = components[0];\n-    BigInteger s = components[1];\n \n+    return normaliseSignature(components[0], components[1], keyPair.getPublicKey(), dataHash);\n+  }\n+\n+  public static Signature normaliseSignature(\n+      final BigInteger nativeR,\n+      final BigInteger nativeS,\n+      final PublicKey publicKey,\n+      final Bytes32 dataHash) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94c90f5cfd28b7fd9751e9300b3a8d30853ae1c3"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07e8e9729ec80618efca44b6706a41419a6ea786", "author": {"user": {"login": "rain-on", "name": "Trent Mohay"}}, "url": "https://github.com/hyperledger/besu/commit/07e8e9729ec80618efca44b6706a41419a6ea786", "committedDate": "2020-04-15T02:49:45Z", "message": "Merge branch 'master' into tweak_sig"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDI0NTM5", "url": "https://github.com/hyperledger/besu/pull/704#pullrequestreview-393424539", "createdAt": "2020-04-15T02:57:01Z", "commit": {"oid": "07e8e9729ec80618efca44b6706a41419a6ea786"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1713, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}