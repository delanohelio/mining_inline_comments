{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExOTMyNDk5", "number": 826, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoxODo1N1rOD40x-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoxODo1N1rOD40x-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwOTExNjA4OnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetLogs.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoxODo1N1rOGPwVYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoxODo1N1rOGPwVYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MzczMA==", "bodyText": "I think we should update this to be the headBlockNumber as well. This seems to be the \"default\" for Geth APIs. And probably update the PrivGetLogs as well.\nI'm happy to do this in another PR is you don't wanna mix up with the other changes! :)\nhttps://github.com/ethereum/wiki/wiki/JSON-RPC#eth_getlogs", "url": "https://github.com/hyperledger/besu/pull/826#discussion_r419173730", "createdAt": "2020-05-03T23:18:57Z", "author": {"login": "lucassaldanha"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetLogs.java", "diffHunk": "@@ -41,30 +43,26 @@ public String getName() {\n   @Override\n   public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n     final FilterParameter filter = requestContext.getRequiredParameter(0, FilterParameter.class);\n-    final LogsQuery query =\n-        new LogsQuery.Builder().addresses(filter.getAddresses()).topics(filter.getTopics()).build();\n \n-    if (isValid(filter)) {\n+    if (!filter.isValid()) {\n       return new JsonRpcErrorResponse(\n           requestContext.getRequest().getId(), JsonRpcError.INVALID_PARAMS);\n     }\n-    if (filter.getBlockhash() != null) {\n-      return new JsonRpcSuccessResponse(\n-          requestContext.getRequest().getId(),\n-          new LogsResult(blockchain.matchingLogs(filter.getBlockhash(), query)));\n-    }\n \n-    final long fromBlockNumber = filter.getFromBlock().getNumber().orElse(0);\n-    final long toBlockNumber = filter.getToBlock().getNumber().orElse(blockchain.headBlockNumber());\n+    final List<LogWithMetadata> matchingLogs =\n+        filter\n+            .getBlockHash()\n+            .map(blockHash -> blockchain.matchingLogs(blockHash, filter.getLogsQuery()))\n+            .orElseGet(\n+                () -> {\n+                  final long fromBlockNumber = filter.getFromBlock().getNumber().orElse(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34cd770853862ac391941ac33978770e8cdea55a"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 969, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}