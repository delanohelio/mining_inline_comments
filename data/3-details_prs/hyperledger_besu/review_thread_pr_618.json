{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2Mjc2ODQ2", "number": 618, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToxMzo1NlrODuLG2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNDowOTo1NFrODuM3LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzQzMDY1OnYy", "diffSide": "RIGHT", "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueQueryPluginServiceFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToxMzo1NlrOGAB1uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTo0MjoxN1rOGACSsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4MzMyMA==", "bodyText": "should variable name be nodeKey ??", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402683320", "createdAt": "2020-04-03T01:13:56Z", "author": {"login": "usmansaleem"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueQueryPluginServiceFactory.java", "diffHunk": "@@ -26,19 +26,18 @@\n public class CliqueQueryPluginServiceFactory implements PluginServiceFactory {\n \n   private final Blockchain blockchain;\n-  private final KeyPair localNodeKeypair;\n+  private final NodeKey cryptoOps;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY5MDczNw==", "bodyText": "oh bugger", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402690737", "createdAt": "2020-04-03T01:42:17Z", "author": {"login": "rain-on"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueQueryPluginServiceFactory.java", "diffHunk": "@@ -26,19 +26,18 @@\n public class CliqueQueryPluginServiceFactory implements PluginServiceFactory {\n \n   private final Blockchain blockchain;\n-  private final KeyPair localNodeKeypair;\n+  private final NodeKey cryptoOps;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4MzMyMA=="}, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzQ0MDEzOnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/test/java/org/hyperledger/besu/consensus/ibft/IbftHelpersTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToxOToyOVrOGAB7Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToxOToyOVrOGAB7Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4NDc2Nw==", "bodyText": "nit: extra pair of brackets not required.", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402684767", "createdAt": "2020-04-03T01:19:29Z", "author": {"login": "usmansaleem"}, "path": "consensus/ibft/src/test/java/org/hyperledger/besu/consensus/ibft/IbftHelpersTest.java", "diffHunk": "@@ -138,7 +140,8 @@ public void latestPreparedCertificateIsExtractedFromRoundChangeCertificate() {\n   @Test\n   public void allRoundChangeHaveNoPreparedReturnsEmptyOptional() {\n     final KeyPair proposerKey = KeyPair.generate();\n-    final MessageFactory proposerMessageFactory = new MessageFactory(proposerKey);\n+    final MessageFactory proposerMessageFactory =\n+        new MessageFactory(new BouncyCastleNodeKey((proposerKey)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzQ0OTQyOnYy", "diffSide": "RIGHT", "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueQueryPluginServiceFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToyNDoyOVrOGACAjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMToyNDoyOVrOGACAjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4NjA5Mg==", "bodyText": "Same as Uzi's comment above, this should NodeKey", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402686092", "createdAt": "2020-04-03T01:24:29Z", "author": {"login": "jframe"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueQueryPluginServiceFactory.java", "diffHunk": "@@ -26,19 +26,18 @@\n public class CliqueQueryPluginServiceFactory implements PluginServiceFactory {\n \n   private final Blockchain blockchain;\n-  private final KeyPair localNodeKeypair;\n+  private final NodeKey cryptoOps;\n \n-  public CliqueQueryPluginServiceFactory(\n-      final Blockchain blockchain, final KeyPair localNodeKeypair) {\n+  public CliqueQueryPluginServiceFactory(final Blockchain blockchain, final NodeKey cryptoOps) {\n     this.blockchain = blockchain;\n-    this.localNodeKeypair = localNodeKeypair;\n+    this.cryptoOps = cryptoOps;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzQ3MDE1OnYy", "diffSide": "RIGHT", "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueBesuControllerBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTozNjowMlrOGACMTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTo1NDo0NFrOGACfWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4OTEwMA==", "bodyText": "Is this PR for Clique as well as IBFT?", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402689100", "createdAt": "2020-04-03T01:36:02Z", "author": {"login": "jframe"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueBesuControllerBuilder.java", "diffHunk": "@@ -46,6 +47,7 @@\n import org.apache.logging.log4j.Logger;\n \n public class CliqueBesuControllerBuilder extends BesuControllerBuilder<CliqueContext> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY5Mzk3Ng==", "bodyText": "Ah - had to include this here as the Metrics plugin work was affected by the change", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402693976", "createdAt": "2020-04-03T01:54:44Z", "author": {"login": "rain-on"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/CliqueBesuControllerBuilder.java", "diffHunk": "@@ -46,6 +47,7 @@\n import org.apache.logging.log4j.Logger;\n \n public class CliqueBesuControllerBuilder extends BesuControllerBuilder<CliqueContext> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY4OTEwMA=="}, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzQ4MjY2OnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/test/java/org/hyperledger/besu/consensus/ibft/validation/SignedDataValidatorTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTo0MzowNlrOGACTjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMTo0MzowNlrOGACTjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY5MDk1OQ==", "bodyText": "Since the pattern new BouncyCastleNodeKey(KeyPair.generate()) is used so often, perhaps a static generate method on BouncyCastleNodeKey would clean test code a bit", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402690959", "createdAt": "2020-04-03T01:43:06Z", "author": {"login": "jframe"}, "path": "consensus/ibft/src/test/java/org/hyperledger/besu/consensus/ibft/validation/SignedDataValidatorTest.java", "diffHunk": "@@ -47,9 +48,12 @@\n   private final KeyPair proposerKey = KeyPair.generate();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e970196585795f3de8eff3a5c3c1f3d84d540f"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzY3Nzc5OnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/support/NetworkLayout.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMzo0MjoyOVrOGAEGYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMzo0MjoyOVrOGAEGYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyMDM1NQ==", "bodyText": "nit: newKeyPair -> newNodeKey", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402720355", "createdAt": "2020-04-03T03:42:29Z", "author": {"login": "jframe"}, "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/support/NetworkLayout.java", "diffHunk": "@@ -53,7 +54,7 @@ public static NetworkLayout createNetworkLayout(\n     final TreeMap<Address, NodeParams> addressKeyMap = new TreeMap<>();\n \n     for (int i = 0; i < validatorCount; i++) {\n-      final KeyPair newKeyPair = KeyPair.generate();\n+      final NodeKey newKeyPair = BouncyCastleNodeKey.generate();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzY4MzE3OnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/tests/SpuriousBehaviourTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMzo0NTo0OFrOGAEJaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMzo0NTo0OFrOGAEJaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyMTEzMQ==", "bodyText": "Could just use the NodeKey.generate here to then use do nodeKey.getPublicKey() to get the address for NodeParams", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402721131", "createdAt": "2020-04-03T03:45:48Z", "author": {"login": "jframe"}, "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/tests/SpuriousBehaviourTest.java", "diffHunk": "@@ -100,12 +100,14 @@ public void messageWithIllegalMessageCodeAreDiscardedAndDoNotPreventOngoingIbftO\n   public void nonValidatorsCannotTriggerResponses() {\n     final KeyPair nonValidatorKeys = KeyPair.generate();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzcxMjg5OnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/support/NodeParams.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNDowNjozMVrOGAEasg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMDozMjozNlrOGAoPdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyNTU1NA==", "bodyText": "nit: getNodeKey instead of getnodeKey keeping the java beans conventions.", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402725554", "createdAt": "2020-04-03T04:06:31Z", "author": {"login": "usmansaleem"}, "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/support/NodeParams.java", "diffHunk": "@@ -14,23 +14,23 @@\n  */\n package org.hyperledger.besu.consensus.ibft.support;\n \n-import org.hyperledger.besu.crypto.SECP256K1.KeyPair;\n+import org.hyperledger.besu.crypto.NodeKey;\n import org.hyperledger.besu.ethereum.core.Address;\n \n public class NodeParams {\n   private final Address address;\n-  private final KeyPair nodeKeys;\n+  private final NodeKey nodeKey;\n \n-  public NodeParams(final Address address, final KeyPair nodeKeys) {\n+  public NodeParams(final Address address, final NodeKey nodeKey) {\n     this.address = address;\n-    this.nodeKeys = nodeKeys;\n+    this.nodeKey = nodeKey;\n   }\n \n   public Address getAddress() {\n     return address;\n   }\n \n-  public KeyPair getNodeKeyPair() {\n-    return nodeKeys;\n+  public NodeKey getnodeKey() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxMjUwMQ==", "bodyText": "done", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r403312501", "createdAt": "2020-04-03T20:32:36Z", "author": {"login": "rain-on"}, "path": "consensus/ibft/src/integration-test/java/org/hyperledger/besu/consensus/ibft/support/NodeParams.java", "diffHunk": "@@ -14,23 +14,23 @@\n  */\n package org.hyperledger.besu.consensus.ibft.support;\n \n-import org.hyperledger.besu.crypto.SECP256K1.KeyPair;\n+import org.hyperledger.besu.crypto.NodeKey;\n import org.hyperledger.besu.ethereum.core.Address;\n \n public class NodeParams {\n   private final Address address;\n-  private final KeyPair nodeKeys;\n+  private final NodeKey nodeKey;\n \n-  public NodeParams(final Address address, final KeyPair nodeKeys) {\n+  public NodeParams(final Address address, final NodeKey nodeKey) {\n     this.address = address;\n-    this.nodeKeys = nodeKeys;\n+    this.nodeKey = nodeKey;\n   }\n \n   public Address getAddress() {\n     return address;\n   }\n \n-  public KeyPair getNodeKeyPair() {\n-    return nodeKeys;\n+  public NodeKey getnodeKey() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyNTU1NA=="}, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzcxODIxOnYy", "diffSide": "RIGHT", "path": "consensus/ibft/src/main/java/org/hyperledger/besu/consensus/ibft/statemachine/IbftFinalState.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNDowOTo1NFrOGAEdpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMDozMjo1OFrOGAoQgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyNjMwOQ==", "bodyText": "getNodeKey", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r402726309", "createdAt": "2020-04-03T04:09:54Z", "author": {"login": "usmansaleem"}, "path": "consensus/ibft/src/main/java/org/hyperledger/besu/consensus/ibft/statemachine/IbftFinalState.java", "diffHunk": "@@ -74,8 +74,8 @@ public int getQuorum() {\n     return voteTallyCache.getVoteTallyAtHead().getValidators();\n   }\n \n-  public KeyPair getNodeKeys() {\n-    return nodeKeys;\n+  public NodeKey getnodeKey() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxMjc3MQ==", "bodyText": "done", "url": "https://github.com/hyperledger/besu/pull/618#discussion_r403312771", "createdAt": "2020-04-03T20:32:58Z", "author": {"login": "rain-on"}, "path": "consensus/ibft/src/main/java/org/hyperledger/besu/consensus/ibft/statemachine/IbftFinalState.java", "diffHunk": "@@ -74,8 +74,8 @@ public int getQuorum() {\n     return voteTallyCache.getVoteTallyAtHead().getValidators();\n   }\n \n-  public KeyPair getNodeKeys() {\n-    return nodeKeys;\n+  public NodeKey getnodeKey() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcyNjMwOQ=="}, "originalCommit": {"oid": "15cc340442ebf38cd877f9455e46a3f769a140f2"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1002, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}