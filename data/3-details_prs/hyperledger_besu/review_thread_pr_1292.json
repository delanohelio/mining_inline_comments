{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1ODMxNDk2", "number": 1292, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyOTozNVrOEXClpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyOTozNVrOEXClpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNTk1MTEwOnYy", "diffSide": "RIGHT", "path": "ethereum/p2p/src/main/java/org/hyperledger/besu/ethereum/p2p/network/DefaultP2PNetwork.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyOTozNVrOG-nGTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNDozMzo1NlrOG-62wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNTQ4NA==", "bodyText": "Does this mean that we require discovery to be enabled on peers that we want to add using static-nodes.json file or AddPeer API? Because I feel like most uses that are statically mapping their peers might not have discovery enabled (and might not want to).", "url": "https://github.com/hyperledger/besu/pull/1292#discussion_r468305484", "createdAt": "2020-08-11T03:29:35Z", "author": {"login": "lucassaldanha"}, "path": "ethereum/p2p/src/main/java/org/hyperledger/besu/ethereum/p2p/network/DefaultP2PNetwork.java", "diffHunk": "@@ -265,6 +265,7 @@ public void awaitStop() {\n   @Override\n   public boolean addMaintainConnectionPeer(final Peer peer) {\n     final boolean wasAdded = maintainedPeers.add(peer);\n+    peerDiscoveryAgent.bond(peer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35436d777a1eec5bb3d8522a350c5c5a3f06a376"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYyOTE4Ng==", "bodyText": "No - we try to create a DiscoveryPeer to initiate bonding with.  The DiscoveryPeer.from helper will only return a peer if discovery appears to be enabled.  The bonding process consists of sending a PING to that peer, and waiting for a response.  Only if the peer is running discovery and responds do we add the peer to our table.  If the peer doesn't respond, we'll retry a few times and then stop.\nUsers can explicitly indicate that discovery is disabled by supplying enode urls with discport=0, which will cause us to skip the bonding attempt.", "url": "https://github.com/hyperledger/besu/pull/1292#discussion_r468629186", "createdAt": "2020-08-11T14:33:56Z", "author": {"login": "mbaxter"}, "path": "ethereum/p2p/src/main/java/org/hyperledger/besu/ethereum/p2p/network/DefaultP2PNetwork.java", "diffHunk": "@@ -265,6 +265,7 @@ public void awaitStop() {\n   @Override\n   public boolean addMaintainConnectionPeer(final Peer peer) {\n     final boolean wasAdded = maintainedPeers.add(peer);\n+    peerDiscoveryAgent.bond(peer);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNTQ4NA=="}, "originalCommit": {"oid": "35436d777a1eec5bb3d8522a350c5c5a3f06a376"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 749, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}