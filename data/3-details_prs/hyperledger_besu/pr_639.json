{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MzU3NDA4", "number": 639, "title": "#628 Deprecating Private Transaction hash/getHash()", "bodyText": "PR description\n\u2022 Deprecating Private Transaction hash/getHash()\n\u2022 In the future, private transactions will be addressed by their PMT hash", "createdAt": "2020-04-02T05:02:03Z", "url": "https://github.com/hyperledger/besu/pull/639", "merged": true, "mergeCommit": {"oid": "031c8cba5a96260593f18a1623f97f6b1649fa89"}, "closed": true, "closedAt": "2020-04-03T04:07:05Z", "author": {"login": "lucassaldanha"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTlDRJAH2gAyMzk3MzU3NDA4OmFjMjE2Y2RmZjg5NzZkZDVjNGJkNjAxMGM1ODBkMzg5ZmFmNWNmZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcT4mKwgH2gAyMzk3MzU3NDA4OjIzZTkwM2ZlNjA0YTc4OGQ0YTRlZjIzYTU1ZjM0MjVlNTljMTBiMjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3", "author": {"user": {"login": "lucassaldanha", "name": "Lucas Saldanha"}}, "url": "https://github.com/hyperledger/besu/commit/ac216cdff8976dd5c4bd6010c580d389faf5cfe3", "committedDate": "2020-04-02T05:00:42Z", "message": "#628 Deprecating Private Transaction hash/getHash()\n\nSigned-off-by: Lucas Saldanha <lucas.saldanha@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "658429ec03c46ab768ce58add38512c9b16f8eae", "author": {"user": {"login": "lucassaldanha", "name": "Lucas Saldanha"}}, "url": "https://github.com/hyperledger/besu/commit/658429ec03c46ab768ce58add38512c9b16f8eae", "committedDate": "2020-04-02T21:08:19Z", "message": "Merge branch 'master' into deleteprivtxhash\n\nSigned-off-by: Lucas Saldanha <lucas.saldanha@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODY3MTU2", "url": "https://github.com/hyperledger/besu/pull/639#pullrequestreview-386867156", "createdAt": "2020-04-03T00:33:52Z", "commit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "state": "APPROVED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDozMzo1MlrOGABL5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMjozMjo1MFrOGADCSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3MjYxMg==", "bodyText": "\"Processing private transaction corresponding to PMT {} in privacy group {}\"?", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402672612", "createdAt": "2020-04-03T00:33:52Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/precompiles/privacy/OnChainPrivacyPrecompiledContract.java", "diffHunk": "@@ -111,10 +113,7 @@ public Bytes compute(final Bytes input, final MessageFrame messageFrame) {\n \n     final Bytes32 privacyGroupId = Bytes32.wrap(maybeGroupId.get());\n \n-    LOG.debug(\n-        \"Processing private transaction {} in privacy group {}\",\n-        privateTransaction.getHash(),\n-        privacyGroupId);\n+    LOG.debug(\"Processing private transaction {} in privacy group {}\", pmtHash, privacyGroupId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY3NDAxNA==", "bodyText": "should it be \"corresponding\"? I'm not sure, maybe we should ask Madeline :-)", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402674014", "createdAt": "2020-04-03T00:39:13Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/privacy/PrivateTransaction.java", "diffHunk": "@@ -414,8 +416,11 @@ public BigInteger getV() {\n   /**\n    * Returns the transaction hash.\n    *\n+   * @deprecated All private transactions should be identified by their correspondent PMT hash.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcwMjAzOA==", "bodyText": "What about this: \"// Corresponding PMT does not exist.\"", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402702038", "createdAt": "2020-04-03T02:29:02Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/privacy/PrivateTransactionSimulator.java", "diffHunk": "@@ -122,6 +122,7 @@ public PrivateTransactionSimulator(\n             publicWorldState.updater(),\n             disposablePrivateState.updater(),\n             header,\n+            Hash.ZERO, // PMT hash is not needed as this private transaction doesn't exist", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcwMjI3Ng==", "bodyText": "\"Validating private transaction corresponding to PMT {}\" ?", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402702276", "createdAt": "2020-04-03T02:30:02Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/privacy/PrivateTransactionValidator.java", "diffHunk": "@@ -38,25 +38,21 @@ public PrivateTransactionValidator(final Optional<BigInteger> chainId) {\n       final PrivateTransaction transaction,\n       final Long accountNonce,\n       final boolean allowFutureNonces) {\n-    LOG.debug(\"Validating private transaction fields of {}\", transaction.getHash());\n+    LOG.debug(\"Validating private transaction {}\", transaction);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcwMjU2Nw==", "bodyText": "s.a.", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402702567", "createdAt": "2020-04-03T02:31:24Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/precompiles/privacy/PrivacyPrecompiledContract.java", "diffHunk": "@@ -127,10 +129,7 @@ public Bytes compute(final Bytes input, final MessageFrame messageFrame) {\n     final Bytes32 privacyGroupId =\n         Bytes32.wrap(Bytes.fromBase64String(receiveResponse.getPrivacyGroupId()));\n \n-    LOG.debug(\n-        \"Processing private transaction {} in privacy group {}\",\n-        privateTransaction.getHash(),\n-        privacyGroupId);\n+    LOG.debug(\"Processing private transaction {} in privacy group {}\", pmtHash, privacyGroupId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjcwMjkyMQ==", "bodyText": "We might not need the \"corresponding to PMT\" business here ....", "url": "https://github.com/hyperledger/besu/pull/639#discussion_r402702921", "createdAt": "2020-04-03T02:32:50Z", "author": {"login": "pinges"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/privacy/PrivateTransactionValidator.java", "diffHunk": "@@ -38,25 +38,21 @@ public PrivateTransactionValidator(final Optional<BigInteger> chainId) {\n       final PrivateTransaction transaction,\n       final Long accountNonce,\n       final boolean allowFutureNonces) {\n-    LOG.debug(\"Validating private transaction fields of {}\", transaction.getHash());\n+    LOG.debug(\"Validating private transaction {}\", transaction);\n     final ValidationResult<TransactionInvalidReason> privateFieldsValidationResult =\n         validatePrivateTransactionFields(transaction);\n     if (!privateFieldsValidationResult.isValid()) {\n       LOG.debug(\n-          \"Private Transaction fields are invalid {}, {}\",\n-          transaction.getHash(),\n+          \"Private Transaction fields are invalid {}\",\n           privateFieldsValidationResult.getErrorMessage());\n       return privateFieldsValidationResult;\n     }\n \n-    LOG.debug(\"Validating the signature of Private Transaction {} \", transaction.getHash());\n-\n     final ValidationResult<TransactionValidator.TransactionInvalidReason>\n         signatureValidationResult = validateTransactionSignature(transaction);\n     if (!signatureValidationResult.isValid()) {\n       LOG.debug(\n-          \"Private Transaction {}, failed validation {}, {}\",\n-          transaction.getHash(),\n+          \"Private Transaction failed signature validation {}, {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac216cdff8976dd5c4bd6010c580d389faf5cfe3"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "165b911629fbfae02e0dcebf35d2da36fcbc4ed9", "author": {"user": {"login": "lucassaldanha", "name": "Lucas Saldanha"}}, "url": "https://github.com/hyperledger/besu/commit/165b911629fbfae02e0dcebf35d2da36fcbc4ed9", "committedDate": "2020-04-03T03:40:05Z", "message": "Merge branch 'master' into deleteprivtxhash\n\nSigned-off-by: Lucas Saldanha <lucas.saldanha@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d73ca80fb742ec9893de520013bf7310d8c2675d", "author": {"user": {"login": "lucassaldanha", "name": "Lucas Saldanha"}}, "url": "https://github.com/hyperledger/besu/commit/d73ca80fb742ec9893de520013bf7310d8c2675d", "committedDate": "2020-04-03T03:43:20Z", "message": "Updating comments\n\nSigned-off-by: Lucas Saldanha <lucas.saldanha@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23e903fe604a788d4a4ef23a55f3425e59c10b29", "author": {"user": {"login": "lucassaldanha", "name": "Lucas Saldanha"}}, "url": "https://github.com/hyperledger/besu/commit/23e903fe604a788d4a4ef23a55f3425e59c10b29", "committedDate": "2020-04-03T03:47:01Z", "message": "Spotless\n\nSigned-off-by: Lucas Saldanha <lucas.saldanha@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1662, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}