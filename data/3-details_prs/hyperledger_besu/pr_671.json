{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMjc3ODA4", "number": 671, "title": "[MISC-39] Fix balance for self detruct", "bodyText": "Signed-off-by: Karim TAAM karim.t2am@gmail.com\nFixed Issue(s)\nDuring a self destruct operation when the address and the refundAddress are identical there is an invalid balance. We are adding the balance of an account to itself. This PR solves this issue\n\nFix issue\nCreate a new test\nUpdate of tracing tests (after genesis and blocks file modification)\n\n\n  \n    \n      besu/ethereum/core/src/main/java/org/hyperledger/besu/ethereum/vm/operations/SelfDestructOperation.java\n    \n    \n         Line 58\n      in\n      d3778d5\n    \n    \n    \n    \n\n        \n          \n           if (!account.getAddress().equals(recipient.getAddress())) { \n        \n    \n  \n\n\n\n  \n    \n      besu/ethereum/api/src/test/resources/org/hyperledger/besu/ethereum/api/jsonrpc/trace/chain-data/blocks.json\n    \n    \n         Line 87\n      in\n      d3778d5\n    \n    \n    \n    \n\n        \n          \n           \"comment\": \"Self destruct and send contract balance to the same address provided in the to field.\",", "createdAt": "2020-04-07T13:46:05Z", "url": "https://github.com/hyperledger/besu/pull/671", "merged": true, "mergeCommit": {"oid": "fc5e8d6cd85b8c008401308cb53ab47e3eec1591"}, "closed": true, "closedAt": "2020-04-07T17:46:21Z", "author": {"login": "matkt"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM4aWHAH2gAyNDAwMjc3ODA4OjllMWE0OTFmYmUyZjQ3YWE0YjliYjgxMzM3YWRmMTc1MDgwZTAwOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVWzpegH2gAyNDAwMjc3ODA4OjlmMDNmOTFhYjdmMTk4NWIyZmI3YTJiNjI1YTEyMmRmNDZmYmEwMDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9e1a491fbe2f47aa4b9bb81337adf175080e008b", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/9e1a491fbe2f47aa4b9bb81337adf175080e008b", "committedDate": "2020-03-12T09:36:38Z", "message": "update changelog\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f91d6f0cb2305e3decd444d3796edf72da5e0b9", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/4f91d6f0cb2305e3decd444d3796edf72da5e0b9", "committedDate": "2020-03-12T15:28:02Z", "message": "Merge branch 'master' of https://github.com/hyperledger/besu\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b72e4aebeed925ea6eff57c6e831786fd2dd920", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/9b72e4aebeed925ea6eff57c6e831786fd2dd920", "committedDate": "2020-03-16T10:27:25Z", "message": "Merge branch 'master' of https://github.com/matkt/besu\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4e962cacec7c203fa0994454b66b830bdfadd67", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/f4e962cacec7c203fa0994454b66b830bdfadd67", "committedDate": "2020-03-19T14:32:57Z", "message": "Merge commit 'fff1f5e13ff91f7f99efe9b27dc0a0d5da474bad'\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1ed080b08a6a44a1d14c7554fd23517f02df2e1", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/d1ed080b08a6a44a1d14c7554fd23517f02df2e1", "committedDate": "2020-03-25T09:23:57Z", "message": "Merge commit '5e368dd7e6ec74827b481a9fbfccc24dc1aa9e2d'\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5494f19f4a42a4ada74967280a3ad0fb3a4a994", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/a5494f19f4a42a4ada74967280a3ad0fb3a4a994", "committedDate": "2020-03-25T18:07:33Z", "message": "update change log\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a97432f4a2eb05826e15786911d4cce3b934d040", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/a97432f4a2eb05826e15786911d4cce3b934d040", "committedDate": "2020-03-25T18:08:41Z", "message": "update change log\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5ac1ac2fca931cef013b178e2caf3b64a1a5782", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/a5ac1ac2fca931cef013b178e2caf3b64a1a5782", "committedDate": "2020-03-26T12:50:02Z", "message": "Merge commit '4fa78d61a3571a098ecbaa0c9980f7475ae7ca7a'\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a814b196c867e6d517d214ce13710e8d30e7c88", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/0a814b196c867e6d517d214ce13710e8d30e7c88", "committedDate": "2020-04-07T09:06:30Z", "message": "Merge commit 'fbd4e36bbeee58edd9f1d017e81edae58c4ba81a'\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3778d567c4a85d72ad58b574bc4d57a99baa7a1", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/d3778d567c4a85d72ad58b574bc4d57a99baa7a1", "committedDate": "2020-04-07T13:26:22Z", "message": "Fix invalid balance with self destruct operation\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5Mjg1MTkw", "url": "https://github.com/hyperledger/besu/pull/671#pullrequestreview-389285190", "createdAt": "2020-04-07T16:24:58Z", "commit": {"oid": "d3778d567c4a85d72ad58b574bc4d57a99baa7a1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNDo1OFrOGCLybw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNDo1OFrOGCLybw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MzQ3MQ==", "bodyText": "Can this be moved to it's own transaction in a new block 0x1B?  Since it adjusts a balance field as you can see the cascading change to test files is huge, impacting almost all of them.", "url": "https://github.com/hyperledger/besu/pull/671#discussion_r404943471", "createdAt": "2020-04-07T16:24:58Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/test/resources/org/hyperledger/besu/ethereum/api/jsonrpc/trace/chain-data/blocks.json", "diffHunk": "@@ -82,6 +82,14 @@\n           \"gasPrice\": \"0xEF\",\n           \"to\": \"0x0020000000000000000000000000000000000000\",\n           \"data\": \"0x0000000000000000000000000000000000000999\"\n+        },\n+        {\n+          \"comment\": \"Self destruct and send contract balance to the same address provided in the to field.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3778d567c4a85d72ad58b574bc4d57a99baa7a1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5964f594a0c51504fcc5fa48dd6ba4aec44fcdf", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/d5964f594a0c51504fcc5fa48dd6ba4aec44fcdf", "committedDate": "2020-04-07T16:47:30Z", "message": "reduce number of modification\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a523c50d735a2a86e0d7ee5a13bd8f80d3d18cd", "author": {"user": {"login": "matkt", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/6a523c50d735a2a86e0d7ee5a13bd8f80d3d18cd", "committedDate": "2020-04-07T17:00:20Z", "message": "fix pipeline issue\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f03f91ab7f1985b2fb7a2b625a122df46fba000", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/9f03f91ab7f1985b2fb7a2b625a122df46fba000", "committedDate": "2020-04-07T17:32:49Z", "message": "Merge branch 'master' into feature/misc-39-fix-balance-for-self-detruct"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1692, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}