{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NTM2MDUx", "number": 623, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzowOTozMVrODtoE1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzoxMDowM1rODtoFiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MTY5MTEwOnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzowOTozMVrOF_KY0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOToyOTo1OVrOF_PcDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NDgwMA==", "bodyText": "Is this to be configurable?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401774800", "createdAt": "2020-04-01T17:09:31Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -31,14 +33,20 @@\n \n public class GraphQLProvider {\n \n+  public static final int MAX_COMPLEXITY = 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg1NzU1MQ==", "bodyText": "No.  Normal queries won't break that limit.", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401857551", "createdAt": "2020-04-01T19:29:59Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -31,14 +33,20 @@\n \n public class GraphQLProvider {\n \n+  public static final int MAX_COMPLEXITY = 200;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NDgwMA=="}, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MTY5MjMzOnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzowOTo1M1rOF_KZpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTozNzoyOVrOF_Pr8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTAxMg==", "bodyText": "Is there a published algorithm for this?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401775012", "createdAt": "2020-04-01T17:09:53Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -74,4 +82,18 @@ private static RuntimeWiring buildWiring(final GraphQLDataFetchers graphQLDataFe\n                     \"sendRawTransaction\", graphQLDataFetchers.getSendRawTransactionDataFetcher()))\n         .build();\n   }\n+\n+  private static int calculateFieldCost(\n+      final FieldComplexityEnvironment environment, final int childComplexity) {\n+    final String childTypeName = environment.getParentType().getName();\n+    final String fieldName = environment.getField().getName();\n+\n+    if (childTypeName.equals(\"Transaction\") && fieldName.equals(\"block\")) {\n+      return childComplexity + 100;\n+    } else if (childTypeName.equals(\"__Type\") && fieldName.equals(\"fields\")) {\n+      return childComplexity + 100;\n+    } else {\n+      return childComplexity + 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2MTYxOQ==", "bodyText": "This is a custom algorithm, focused on our schema.", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401861619", "createdAt": "2020-04-01T19:37:29Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -74,4 +82,18 @@ private static RuntimeWiring buildWiring(final GraphQLDataFetchers graphQLDataFe\n                     \"sendRawTransaction\", graphQLDataFetchers.getSendRawTransactionDataFetcher()))\n         .build();\n   }\n+\n+  private static int calculateFieldCost(\n+      final FieldComplexityEnvironment environment, final int childComplexity) {\n+    final String childTypeName = environment.getParentType().getName();\n+    final String fieldName = environment.getField().getName();\n+\n+    if (childTypeName.equals(\"Transaction\") && fieldName.equals(\"block\")) {\n+      return childComplexity + 100;\n+    } else if (childTypeName.equals(\"__Type\") && fieldName.equals(\"fields\")) {\n+      return childComplexity + 100;\n+    } else {\n+      return childComplexity + 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTAxMg=="}, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MTY5Mjg4OnYy", "diffSide": "LEFT", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/graphql/EthGraphQLHttpBySpecErrorCaseTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzoxMDowM1rOF_KaAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTozODoxOVrOF_PttQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTEwNg==", "bodyText": "Why is that test removed?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401775106", "createdAt": "2020-04-01T17:10:03Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/graphql/EthGraphQLHttpBySpecErrorCaseTest.java", "diffHunk": "@@ -1,88 +0,0 @@\n-/*\n- * Copyright ConsenSys AG.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n- * the License. You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n- * specific language governing permissions and limitations under the License.\n- *\n- * SPDX-License-Identifier: Apache-2.0\n- */\n-package org.hyperledger.besu.ethereum.api.graphql;\n-\n-import java.io.IOException;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.List;\n-\n-import com.google.common.base.Charsets;\n-import com.google.common.io.Resources;\n-import io.vertx.core.json.JsonObject;\n-import okhttp3.Request;\n-import okhttp3.RequestBody;\n-import okhttp3.Response;\n-import org.assertj.core.api.Assertions;\n-import org.junit.Test;\n-import org.junit.runner.RunWith;\n-import org.junit.runners.Parameterized;\n-import org.junit.runners.Parameterized.Parameters;\n-\n-@RunWith(Parameterized.class)\n-public class EthGraphQLHttpBySpecErrorCaseTest extends AbstractEthGraphQLHttpServiceTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2MjA2OQ==", "bodyText": "There were no test being loaded up in the parameters section.  All tests (error or non error) are all in EthGraphQLHttpBySpecTest", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401862069", "createdAt": "2020-04-01T19:38:19Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/graphql/EthGraphQLHttpBySpecErrorCaseTest.java", "diffHunk": "@@ -1,88 +0,0 @@\n-/*\n- * Copyright ConsenSys AG.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n- * the License. You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n- * specific language governing permissions and limitations under the License.\n- *\n- * SPDX-License-Identifier: Apache-2.0\n- */\n-package org.hyperledger.besu.ethereum.api.graphql;\n-\n-import java.io.IOException;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.List;\n-\n-import com.google.common.base.Charsets;\n-import com.google.common.io.Resources;\n-import io.vertx.core.json.JsonObject;\n-import okhttp3.Request;\n-import okhttp3.RequestBody;\n-import okhttp3.Response;\n-import org.assertj.core.api.Assertions;\n-import org.junit.Test;\n-import org.junit.runner.RunWith;\n-import org.junit.runners.Parameterized;\n-import org.junit.runners.Parameterized.Parameters;\n-\n-@RunWith(Parameterized.class)\n-public class EthGraphQLHttpBySpecErrorCaseTest extends AbstractEthGraphQLHttpServiceTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTEwNg=="}, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1012, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}