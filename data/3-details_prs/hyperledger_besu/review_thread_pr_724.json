{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzODY3OTUz", "number": 724, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0MDo0OFrODyLRtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0NDoxMFrODyLW3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzOTQwMTUxOnYy", "diffSide": "RIGHT", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PeerPendingTransactionTracker.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0MDo0OFrOGGEkkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0NDowMFrOGGEsRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAxOTUzOA==", "bodyText": "The protocol should be an argument, for future feature support.  I don't think this will be the first time we will change behavior based on ETH subprotocol support.", "url": "https://github.com/hyperledger/besu/pull/724#discussion_r409019538", "createdAt": "2020-04-15T17:40:48Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PeerPendingTransactionTracker.java", "diffHunk": "@@ -67,6 +68,10 @@ public synchronized void addToPeerSendQueue(final EthPeer peer, final Hash hash)\n     }\n   }\n \n+  public boolean isPeerSupported(final EthPeer peer) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af76df0d4e8211b077c66218447375964f8b2170"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyMTUwOQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/hyperledger/besu/pull/724#discussion_r409021509", "createdAt": "2020-04-15T17:44:00Z", "author": {"login": "atoulme"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PeerPendingTransactionTracker.java", "diffHunk": "@@ -67,6 +68,10 @@ public synchronized void addToPeerSendQueue(final EthPeer peer, final Hash hash)\n     }\n   }\n \n+  public boolean isPeerSupported(final EthPeer peer) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAxOTUzOA=="}, "originalCommit": {"oid": "af76df0d4e8211b077c66218447375964f8b2170"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzOTQxMDM1OnYy", "diffSide": "RIGHT", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PeerPendingTransactionTracker.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0MzowN1rOGGEqGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0MzowN1rOGGEqGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyMDk1Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public boolean isPeerSupported(final EthPeer peer) {\n          \n          \n            \n                return peer.getAgreedCapabilities().contains(EthProtocol.ETH65);\n          \n          \n            \n              }\n          \n          \n            \n              public boolean isPeerSupported(final EthPeer peer, final Capability capability) {\n          \n          \n            \n                return peer.getAgreedCapabilities().contains(capability);\n          \n          \n            \n              }", "url": "https://github.com/hyperledger/besu/pull/724#discussion_r409020952", "createdAt": "2020-04-15T17:43:07Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PeerPendingTransactionTracker.java", "diffHunk": "@@ -67,6 +68,10 @@ public synchronized void addToPeerSendQueue(final EthPeer peer, final Hash hash)\n     }\n   }\n \n+  public boolean isPeerSupported(final EthPeer peer) {\n+    return peer.getAgreedCapabilities().contains(EthProtocol.ETH65);\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af76df0d4e8211b077c66218447375964f8b2170"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzOTQxNDY5OnYy", "diffSide": "RIGHT", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PendingTransactionSender.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0NDoxMFrOGGEstQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo0NDo0MlrOGGEt9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyMTYyMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    .filter(transactionTracker::isPeerSupported)\n          \n          \n            \n                    .filter(peer -> transactionTracker.isPeerSupported(peer, EthProtocol.ETH65)\n          \n      \n    \n    \n  \n\nMay require an import, and similarly to the other 5 places it's called.", "url": "https://github.com/hyperledger/besu/pull/724#discussion_r409021621", "createdAt": "2020-04-15T17:44:10Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PendingTransactionSender.java", "diffHunk": "@@ -38,6 +38,7 @@ public void onTransactionsAdded(final Iterable<Transaction> transactions) {\n     ethContext\n         .getEthPeers()\n         .streamAvailablePeers()\n+        .filter(transactionTracker::isPeerSupported)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af76df0d4e8211b077c66218447375964f8b2170"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyMTk0MA==", "bodyText": "I'll commit your first suggestion and work my way from there, no worries.", "url": "https://github.com/hyperledger/besu/pull/724#discussion_r409021940", "createdAt": "2020-04-15T17:44:42Z", "author": {"login": "atoulme"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/PendingTransactionSender.java", "diffHunk": "@@ -38,6 +38,7 @@ public void onTransactionsAdded(final Iterable<Transaction> transactions) {\n     ethContext\n         .getEthPeers()\n         .streamAvailablePeers()\n+        .filter(transactionTracker::isPeerSupported)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyMTYyMQ=="}, "originalCommit": {"oid": "af76df0d4e8211b077c66218447375964f8b2170"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1070, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}