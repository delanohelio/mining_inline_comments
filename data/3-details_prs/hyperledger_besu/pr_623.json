{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NTM2MDUx", "number": 623, "title": "Measure Graphql complexity", "bodyText": "Measure the complexity of GraphQL queries\nSigned-off-by: Danno Ferrin danno.ferrin@gmail.com", "createdAt": "2020-03-31T19:04:23Z", "url": "https://github.com/hyperledger/besu/pull/623", "merged": true, "mergeCommit": {"oid": "865b10b99dfb5b9831216051b0ed47f38c5a4484"}, "closed": true, "closedAt": "2020-04-01T20:13:57Z", "author": {"login": "shemnon"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS4JfRAH2gAyMzk2NTM2MDUxOjg5Y2MzOTJmY2ZlOWU4ZTM2NDJjNzliMDk5MmZiM2I1NDA5YmI5MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTdAf1AH2gAyMzk2NTM2MDUxOjEwM2EwMmVjNTQyMTgxODQ0ZWMwNmY0NzU2MTI4YjJlMjI1YTQwMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900", "author": {"user": {"login": "shemnon", "name": "Danno Ferrin"}}, "url": "https://github.com/hyperledger/besu/commit/89cc392fcfe9e8e3642c79b0992fb3b5409bb900", "committedDate": "2020-03-31T00:41:46Z", "message": "Measure Graphql complexity\n\nMeasure the complexity of GraphQL queries\n\nSigned-off-by: Danno Ferrin <danno.ferrin@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ0OTYx", "url": "https://github.com/hyperledger/besu/pull/623#pullrequestreview-385344961", "createdAt": "2020-04-01T07:56:26Z", "commit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1Nzg0NTg2", "url": "https://github.com/hyperledger/besu/pull/623#pullrequestreview-385784586", "createdAt": "2020-04-01T17:09:31Z", "commit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzowOTozMVrOF_KY0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzoxMDowM1rOF_KaAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NDgwMA==", "bodyText": "Is this to be configurable?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401774800", "createdAt": "2020-04-01T17:09:31Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -31,14 +33,20 @@\n \n public class GraphQLProvider {\n \n+  public static final int MAX_COMPLEXITY = 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTAxMg==", "bodyText": "Is there a published algorithm for this?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401775012", "createdAt": "2020-04-01T17:09:53Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/graphql/GraphQLProvider.java", "diffHunk": "@@ -74,4 +82,18 @@ private static RuntimeWiring buildWiring(final GraphQLDataFetchers graphQLDataFe\n                     \"sendRawTransaction\", graphQLDataFetchers.getSendRawTransactionDataFetcher()))\n         .build();\n   }\n+\n+  private static int calculateFieldCost(\n+      final FieldComplexityEnvironment environment, final int childComplexity) {\n+    final String childTypeName = environment.getParentType().getName();\n+    final String fieldName = environment.getField().getName();\n+\n+    if (childTypeName.equals(\"Transaction\") && fieldName.equals(\"block\")) {\n+      return childComplexity + 100;\n+    } else if (childTypeName.equals(\"__Type\") && fieldName.equals(\"fields\")) {\n+      return childComplexity + 100;\n+    } else {\n+      return childComplexity + 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc3NTEwNg==", "bodyText": "Why is that test removed?", "url": "https://github.com/hyperledger/besu/pull/623#discussion_r401775106", "createdAt": "2020-04-01T17:10:03Z", "author": {"login": "atoulme"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/graphql/EthGraphQLHttpBySpecErrorCaseTest.java", "diffHunk": "@@ -1,88 +0,0 @@\n-/*\n- * Copyright ConsenSys AG.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n- * the License. You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n- * specific language governing permissions and limitations under the License.\n- *\n- * SPDX-License-Identifier: Apache-2.0\n- */\n-package org.hyperledger.besu.ethereum.api.graphql;\n-\n-import java.io.IOException;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.List;\n-\n-import com.google.common.base.Charsets;\n-import com.google.common.io.Resources;\n-import io.vertx.core.json.JsonObject;\n-import okhttp3.Request;\n-import okhttp3.RequestBody;\n-import okhttp3.Response;\n-import org.assertj.core.api.Assertions;\n-import org.junit.Test;\n-import org.junit.runner.RunWith;\n-import org.junit.runners.Parameterized;\n-import org.junit.runners.Parameterized.Parameters;\n-\n-@RunWith(Parameterized.class)\n-public class EthGraphQLHttpBySpecErrorCaseTest extends AbstractEthGraphQLHttpServiceTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89cc392fcfe9e8e3642c79b0992fb3b5409bb900"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "103a02ec542181844ec06f4756128b2e225a401c", "author": {"user": {"login": "shemnon", "name": "Danno Ferrin"}}, "url": "https://github.com/hyperledger/besu/commit/103a02ec542181844ec06f4756128b2e225a401c", "committedDate": "2020-04-01T19:38:26Z", "message": "Merge branch 'master' into complexgraphql"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1651, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}