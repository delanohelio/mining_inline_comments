{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1OTk0ODYy", "number": 1253, "title": "Hide AtomicReference from Inheritors", "bodyText": "CompletableFuture already has its own atomicity under the hood that allows for threadsafe cancelations.\nI hid the AtomicReference that gives us idempotency in executing the task so that inheritors don't need to care about it.", "createdAt": "2020-07-23T23:08:34Z", "url": "https://github.com/hyperledger/besu/pull/1253", "merged": true, "mergeCommit": {"oid": "e41419ba1fc8e9e1c4652acb3ca8cfdd682b064d"}, "closed": true, "closedAt": "2020-08-10T15:24:37Z", "author": {"login": "RatanRSur"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc33jOLAH2gAyNDU1OTk0ODYyOjEyZGQ5MzZhNjg0NjZkMTMwZTIzNDczM2M4MjVjYmEwZTNhMGZlNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9jNTMAH2gAyNDU1OTk0ODYyOjU1Yzg4YzViOTZkZjNiYWNhNWY1MjMyNjFhNzcxNjQ3NWE4OWQ1Yzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "12dd936a68466d130e234733c825cba0e3a0fe66", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/12dd936a68466d130e234733c825cba0e3a0fe66", "committedDate": "2020-07-23T22:55:10Z", "message": "hide AtomicReference form inheritors\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6046c969e58b7d1af3ecea00dd05995f2f719898", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/6046c969e58b7d1af3ecea00dd05995f2f719898", "committedDate": "2020-07-23T23:00:25Z", "message": "clean up state utilities\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "195c8adef076c82e152cf7f2e46e9a0f3b7bc3c3", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/195c8adef076c82e152cf7f2e46e9a0f3b7bc3c3", "committedDate": "2020-07-23T23:02:14Z", "message": "spotless\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/4624f056bf7506b9ccbe5d140b4096eab8a6850d", "committedDate": "2020-07-23T23:10:39Z", "message": "Merge branch 'master' into remove-atomic-reference"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NzgwNzc4", "url": "https://github.com/hyperledger/besu/pull/1253#pullrequestreview-454780778", "createdAt": "2020-07-24T10:23:01Z", "commit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMzowMVrOG2qasg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMzowMVrOG2qasg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTI1MA==", "bodyText": "I'm not sure why we should remove isSucceeded but we should keep isFailed. maybe I missed something", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r459971250", "createdAt": "2020-07-24T10:23:01Z", "author": {"login": "matkt"}, "path": "ethereum/eth/src/test/java/org/hyperledger/besu/ethereum/eth/manager/EthSchedulerTest.java", "diffHunk": "@@ -205,7 +205,6 @@ public void timeout_cancelsTaskWhenResultIsCancelled() {\n     result.cancel(false);\n     assertThat(task.isDone()).isTrue();\n     assertThat(task.isFailed()).isTrue();\n-    assertThat(task.isSucceeded()).isFalse();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NzQ4MDY4", "url": "https://github.com/hyperledger/besu/pull/1253#pullrequestreview-458748068", "createdAt": "2020-07-30T20:52:47Z", "commit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMDo1Mjo0OFrOG5za7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMDo1Mjo0OFrOG5za7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI2NDQ5Mg==", "bodyText": "isDone instead of isCancelled?  Can we re-execute something that completed normally?  isDone catches any termination.\nAlso, perhaps move the started before the cancelled/done check?", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r463264492", "createdAt": "2020-07-30T20:52:48Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/task/AbstractEthTask.java", "diffHunk": "@@ -69,44 +71,39 @@ public double stopTimer() {\n \n   @Override\n   public final CompletableFuture<T> run() {\n-    if (result.compareAndSet(null, new CompletableFuture<>())) {\n+    if (!result.isCancelled() && started.compareAndSet(false, true)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02da3913e979452c00bb02d03a56a503947571a6", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/02da3913e979452c00bb02d03a56a503947571a6", "committedDate": "2020-08-10T14:33:51Z", "message": "isComplete -> isDone\n\nSigned-off-by: Ratan Rai Sur <ratan.r.sur@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55c88c5b96df3baca5f523261a7716475a89d5c7", "author": {"user": {"login": "RatanRSur", "name": "Ratan (Rai) Sur"}}, "url": "https://github.com/hyperledger/besu/commit/55c88c5b96df3baca5f523261a7716475a89d5c7", "committedDate": "2020-08-10T14:36:40Z", "message": "Merge remote-tracking branch 'upstream/master' into remove-atomic-reference"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1454, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}