{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NzA2NTMx", "number": 399, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozMjowMVrODfu9Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozOTo0N1rODfvEHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjAxNzUxOnYy", "diffSide": "RIGHT", "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozMjowMVrOFpnKVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNDowOToxOVrOFq0nPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3NzU1Ng==", "bodyText": "Is there any reason not to have the static modifier for the logger?\n(that would be in keeping with the reference being uppercase)", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379177556", "createdAt": "2020-02-13T23:32:01Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -41,9 +41,19 @@\n import org.hyperledger.besu.tests.acceptance.dsl.transaction.privacy.PrivacyTransactions;\n import org.hyperledger.besu.tests.acceptance.dsl.transaction.web3.Web3Transactions;\n \n+import java.io.File;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.apache.logging.log4j.ThreadContext;\n import org.junit.After;\n+import org.junit.Rule;\n+import org.junit.rules.TestName;\n+import org.junit.rules.TestWatcher;\n+import org.junit.runner.Description;\n \n public class AcceptanceTestBase {\n+  protected final Logger LOG = LogManager.getLogger();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ0NjUyNg==", "bodyText": "Discussed and done.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380446526", "createdAt": "2020-02-18T04:09:19Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -41,9 +41,19 @@\n import org.hyperledger.besu.tests.acceptance.dsl.transaction.privacy.PrivacyTransactions;\n import org.hyperledger.besu.tests.acceptance.dsl.transaction.web3.Web3Transactions;\n \n+import java.io.File;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.apache.logging.log4j.ThreadContext;\n import org.junit.After;\n+import org.junit.Rule;\n+import org.junit.rules.TestName;\n+import org.junit.rules.TestWatcher;\n+import org.junit.runner.Description;\n \n public class AcceptanceTestBase {\n+  protected final Logger LOG = LogManager.getLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3NzU1Ng=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjAyMzU3OnYy", "diffSide": "RIGHT", "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozNDoyN1rOFpnNyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQwNDowOTozMFrOFq0nZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODQ0Mw==", "bodyText": "You could put the error string into a local String variable and use Log4j lazy variable substitution.\ne.g.\nfinal String errorMessage = \" \"Uncaught exception in thread \\\"{}\\\"\";", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379178443", "createdAt": "2020-02-13T23:34:27Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ0NjU2NA==", "bodyText": "Discussed and done.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380446564", "createdAt": "2020-02-18T04:09:30Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODQ0Mw=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjAyNzI2OnYy", "diffSide": "RIGHT", "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozNTo1OVrOFpnP5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxODo1MjozNVrOFtMYxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ==", "bodyText": "acctests.keepLogs seems misleading as a variable, as it only applies to successful test executions, not the failed ones?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379178981", "createdAt": "2020-02-13T23:35:59Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDQ0Njc0OQ==", "bodyText": "Would acctests.keepAllLogs be better?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380446749", "createdAt": "2020-02-18T04:10:35Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTYyNzYxNw==", "bodyText": "Wouldn't something like acctests.discardlLogs make sense, then you could remove the logical inversion?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381627617", "createdAt": "2020-02-20T00:36:08Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY4NTA5Mw==", "bodyText": "The default behavior as currently coded is to keep logs of failing tests and delete logs of successful tests.\nThe intended behavior of this variable is to keep all test logs, both failing and successful.\nPlease suggest a default behavior and which modifier to use :)", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381685093", "createdAt": "2020-02-20T02:37:24Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQwMDk5NA==", "bodyText": "If failed test logs are kept either way, then is it correct to say that this variable is only about keeping logs for successful / passing tests?\nIf so, then a name like accosts.keepLogsOfPassingTests?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r382400994", "createdAt": "2020-02-21T05:14:45Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzMzE5MA==", "bodyText": "Sounds good, done.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r382933190", "createdAt": "2020-02-22T18:52:35Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/AcceptanceTestBase.java", "diffHunk": "@@ -98,6 +108,55 @@ protected AcceptanceTestBase() {\n     permissionedNodeBuilder = new PermissionedNodeBuilder();\n   }\n \n+  static {\n+    System.setProperty(\"log4j2.isThreadContextMapInheritable\", \"true\");\n+  }\n+\n+  @Rule public final TestName name = new TestName();\n+\n+  @Rule\n+  public TestWatcher log_eraser =\n+      new TestWatcher() {\n+\n+        @Override\n+        protected void starting(final Description description) {\n+          ThreadContext.put(\"test\", description.getMethodName());\n+          ThreadContext.put(\"class\", description.getClassName());\n+          Thread.currentThread()\n+              .setUncaughtExceptionHandler(\n+                  (thread, error) ->\n+                      LOG.error(\n+                          \"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+          Thread.setDefaultUncaughtExceptionHandler(\n+              (thread, error) ->\n+                  LOG.error(\"Uncaught exception in thread \\\"\" + thread.getName() + \"\\\"\", error));\n+        }\n+\n+        @Override\n+        protected void failed(final Throwable e, final Description description) {\n+          // add the result at the end of the log so it is self-sufficient\n+          LOG.error(\n+              \"==========================================================================================\");\n+          LOG.error(\"Test failed. Reported Throwable at the point of failure:\", e);\n+        }\n+\n+        @Override\n+        protected void succeeded(final Description description) {\n+          // if so configured, delete logs of successful tests\n+          if (!Boolean.getBoolean(\"acctests.keepLogs\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3ODk4MQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjAzMjg0OnYy", "diffSide": "RIGHT", "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ProcessBesuNodeRunner.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozODo1MlrOFpnTYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMDozNjoyMlrOFr8tIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3OTg3Mw==", "bodyText": "Aren't you loosing the name of the node here (that name being assigned by the test being executed)?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379179873", "createdAt": "2020-02-13T23:38:52Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ProcessBesuNodeRunner.java", "diffHunk": "@@ -298,11 +310,16 @@ private void printOutput(final BesuNode node, final Process process) {\n         new BufferedReader(new InputStreamReader(process.getInputStream(), UTF_8))) {\n       String line = in.readLine();\n       while (line != null) {\n-        PROCESS_LOG.info(\"{}: {}\", node.getName(), line);\n+        // would be nice to pass up the log level of the incoming log line\n+        PROCESS_LOG.info(line);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDYxNzU0NQ==", "bodyText": "Yes, it is removed here and instead added in log4j2.xml from the ThreadContext.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380617545", "createdAt": "2020-02-18T11:35:16Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ProcessBesuNodeRunner.java", "diffHunk": "@@ -298,11 +310,16 @@ private void printOutput(final BesuNode node, final Process process) {\n         new BufferedReader(new InputStreamReader(process.getInputStream(), UTF_8))) {\n       String line = in.readLine();\n       while (line != null) {\n-        PROCESS_LOG.info(\"{}: {}\", node.getName(), line);\n+        // would be nice to pass up the log level of the incoming log line\n+        PROCESS_LOG.info(line);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3OTg3Mw=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTYyNzY4Mg==", "bodyText": "fair enough", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381627682", "createdAt": "2020-02-20T00:36:22Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ProcessBesuNodeRunner.java", "diffHunk": "@@ -298,11 +310,16 @@ private void printOutput(final BesuNode node, final Process process) {\n         new BufferedReader(new InputStreamReader(process.getInputStream(), UTF_8))) {\n       String line = in.readLine();\n       while (line != null) {\n-        PROCESS_LOG.info(\"{}: {}\", node.getName(), line);\n+        // would be nice to pass up the log level of the incoming log line\n+        PROCESS_LOG.info(line);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE3OTg3Mw=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjAzNTQ4OnYy", "diffSide": "RIGHT", "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "isResolved": true, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QyMzozOTo0N1rOFpnUxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMjozODozN1rOFsAP6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ==", "bodyText": "Does this also change the logging levels of the third party dependencies e.g Vertx?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379180231", "createdAt": "2020-02-13T23:39:47Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE5MjI1NQ==", "bodyText": "This overrides all log4j configuration, including any config files the user has setup.  If we want to enable debug logging we should just change the log4j2.xml file used by acceptance tests.  Then users running locally could still use system properties to use a custom config and use settings they prefer.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r379192255", "createdAt": "2020-02-14T00:21:24Z", "author": {"login": "ajsutton"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDYxODg4MQ==", "bodyText": "This is just what BesuCommand.configureLogging() does too. The purpose is to enable DEBUG logging, and since the ThreadBesuNodeRunner bypasses BesuCommand, I couldn't find other simple way to do this.\nAnyway, my understanding is that ThreadBesuNodeRunner is rather on its way out, and in sidechains-besu we indeed no longer use it. So I will just remove this change.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380618881", "createdAt": "2020-02-18T11:38:21Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNzA1MA==", "bodyText": "BesuCommand.configureLogging does that only when the user has specifically set a log level on the command line (ie the user has requested the change).  It was deliberately changed to not set a default level so it doesn't override any external log4j config files.\nThreadBesuNodeRunner makes it much easier to test changes to production code - without it you need to run gradle installDist after every change. With it you can just rerun the test in IntelliJ. I haven't heard of plans to remove it and thought it was in use by a number of people to make development faster.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r380907050", "createdAt": "2020-02-18T20:07:48Z", "author": {"login": "ajsutton"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTEyNTIxNg==", "bodyText": "FWIW, gradle acceptanceTest seems to imply installDist anyway.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381125216", "createdAt": "2020-02-19T07:54:39Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU4MTQzMw==", "bodyText": "Yes, because running in gradle will use the process runner.  The threaded runner is designed to make it easy to run in IntelliJ where installDist is not automatically run.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381581433", "createdAt": "2020-02-19T22:24:21Z", "author": {"login": "ajsutton"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTYyODg1Mg==", "bodyText": "ThreadBesuNodeRunner also allows easy IDE step through Besu source during execution of the AT.\nPlans to delete the thread runner from Besu are also news to me, is this from a RocketChat thread I missed?", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381628852", "createdAt": "2020-02-20T00:40:15Z", "author": {"login": "CjHare"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY4MzA4Ng==", "bodyText": "What I meant is that if IntelliJ is set to use its gradle runner integration (which I think is the default), then both gradle and IntelliJ work as expected, no matter if using the threaded runner or the process runner. Meaning that installDist should not be needed in any case, as far as I can see.\nRe: plans to delete: I didn't say \"delete\", but maybe I still worded that too strongly? My understanding from when we talked was that the threaded runner might change the behavior or the node, and so it's better to use the process runner - meaning that the default advice is to use the process runner.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381683086", "createdAt": "2020-02-20T02:33:38Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY4NTczNw==", "bodyText": "Anyway, at this point this sounds like a red herring. I'm happy to drop this modification.", "url": "https://github.com/hyperledger/besu/pull/399#discussion_r381685737", "createdAt": "2020-02-20T02:38:37Z", "author": {"login": "hmijail"}, "path": "acceptance-tests/dsl/src/main/java/org/hyperledger/besu/tests/acceptance/dsl/node/ThreadBesuNodeRunner.java", "diffHunk": "@@ -197,9 +205,15 @@ public void startNode(final BesuNode node) {\n             .besuPluginContext(new BesuPluginContextImpl())\n             .build();\n \n+    // in testing, we don't mind logging on success, but we want max info on failures\n+    // log level is normally set in BesuCommand, which is bypassed here. So let's just set it.\n+    // This still leaves out the vertx system properties set in Besu.main().\n+    Configurator.setAllLevels(\"\", Level.DEBUG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MDIzMQ=="}, "originalCommit": {"oid": "bccb75c7ed0130e25c4311e4224099d37dbb8529"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1091, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}