{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2NjM1OTY4", "number": 759, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxMTowMlrOD0ddOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxODozM1rOD0dnDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MzM1MTYxOnYy", "diffSide": "RIGHT", "path": "besu/src/main/java/org/hyperledger/besu/controller/BesuControllerBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxMTowMlrOGJaocw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOTowNzozMVrOGJr0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNjcwNw==", "bodyText": "return value ignored?  Are we relying on side effects or is this a stray line that should be deleted?", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412526707", "createdAt": "2020-04-21T22:11:02Z", "author": {"login": "shemnon"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/BesuControllerBuilder.java", "diffHunk": "@@ -256,6 +259,17 @@\n     final EthContext ethContext = new EthContext(ethPeers, ethMessages, scheduler);\n     final SyncState syncState = new SyncState(blockchain, ethPeers);\n     final boolean fastSyncEnabled = syncConfig.getSyncMode().equals(SyncMode.FAST);\n+\n+    final Optional<EIP1559> eip1559;\n+    final GenesisConfigOptions genesisConfigOptions =\n+        genesisConfig.getConfigOptions(genesisConfigOverrides);\n+    if (ExperimentalEIPs.eip1559Enabled\n+        && genesisConfigOptions.getEIP1559BlockNumber().isPresent()) {\n+      eip1559 = Optional.of(new EIP1559(genesisConfigOptions.getEIP1559BlockNumber().getAsLong()));\n+    } else {\n+      eip1559 = Optional.empty();\n+    }\n+    genesisConfig.getConfigOptions(genesisConfigOverrides).getEIP1559BlockNumber();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgwODI0OA==", "bodyText": "It is a stray line that should be deleted.\nDone.", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412808248", "createdAt": "2020-04-22T09:07:31Z", "author": {"login": "abdelhamidbakhta"}, "path": "besu/src/main/java/org/hyperledger/besu/controller/BesuControllerBuilder.java", "diffHunk": "@@ -256,6 +259,17 @@\n     final EthContext ethContext = new EthContext(ethPeers, ethMessages, scheduler);\n     final SyncState syncState = new SyncState(blockchain, ethPeers);\n     final boolean fastSyncEnabled = syncConfig.getSyncMode().equals(SyncMode.FAST);\n+\n+    final Optional<EIP1559> eip1559;\n+    final GenesisConfigOptions genesisConfigOptions =\n+        genesisConfig.getConfigOptions(genesisConfigOverrides);\n+    if (ExperimentalEIPs.eip1559Enabled\n+        && genesisConfigOptions.getEIP1559BlockNumber().isPresent()) {\n+      eip1559 = Optional.of(new EIP1559(genesisConfigOptions.getEIP1559BlockNumber().getAsLong()));\n+    } else {\n+      eip1559 = Optional.empty();\n+    }\n+    genesisConfig.getConfigOptions(genesisConfigOverrides).getEIP1559BlockNumber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNjcwNw=="}, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MzM1NDk3OnYy", "diffSide": "RIGHT", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/BaseFee.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxMTo1M1rOGJaqLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOToxNDoyNFrOGJsHFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNzE0OA==", "bodyText": "Will this ever change across hard forks or are the designers fairly sure it is static?", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412527148", "createdAt": "2020-04-21T22:11:53Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/BaseFee.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.core.fees;\n+\n+public class BaseFee {\n+  private static final long BOUNDING_DENOMINATOR = 8;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgxMzA3OA==", "bodyText": "Actually the value is defined in FeeMarket interface: getBasefeeMaxChangeDenominator\nRemoved the constant in favor of the interface method", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412813078", "createdAt": "2020-04-22T09:14:24Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/BaseFee.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.core.fees;\n+\n+public class BaseFee {\n+  private static final long BOUNDING_DENOMINATOR = 8;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNzE0OA=="}, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MzM3Njc2OnYy", "diffSide": "RIGHT", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/TransactionPool.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxODozM1rOGJa2XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNToyMTo0OFrOGJ8RqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDI2OQ==", "bodyText": "Style: I prefer to see returns at the same level, unless it is a guard block (https://wiki.c2.com/?GuardClause).  Unexpected fall throughs I've seen lead to bugs.\nBoth ways to address this will duplicate the frontier gas price calculation, but from a readability perspective I think it's fine as it makes what is going on explicit.\nThis could be re-written as two guard blocks (one checking for 1559 enablement in general, then the two variables calculation, then the check for basefee being present) returning frontier prices and then a final return for 1559 prices.", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412530269", "createdAt": "2020-04-21T22:18:33Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/TransactionPool.java", "diffHunk": "@@ -268,4 +281,18 @@ private BlockHeader getChainHeadBlockHeader() {\n \n     void onTransactionsAdded(Iterable<Transaction> transactions);\n   }\n+\n+  private Wei minTransactionGasPrice(final Transaction transaction) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgyMTQzMQ==", "bodyText": "I added a guard block, if EIP-1559 is not enabled in general, returns with frontier price.\nThen i have a simple if-else block with returns at the same level. Actually i simplified because base fee is mandatory if the block is post EIP-1559, so i added an orElseThrow when retrieving the base fee.", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r412821431", "createdAt": "2020-04-22T09:26:08Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/TransactionPool.java", "diffHunk": "@@ -268,4 +281,18 @@ private BlockHeader getChainHeadBlockHeader() {\n \n     void onTransactionsAdded(Iterable<Transaction> transactions);\n   }\n+\n+  private Wei minTransactionGasPrice(final Transaction transaction) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDI2OQ=="}, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA3NzkyOQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/hyperledger/besu/pull/759#discussion_r413077929", "createdAt": "2020-04-22T15:21:48Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/transactions/TransactionPool.java", "diffHunk": "@@ -268,4 +281,18 @@ private BlockHeader getChainHeadBlockHeader() {\n \n     void onTransactionsAdded(Iterable<Transaction> transactions);\n   }\n+\n+  private Wei minTransactionGasPrice(final Transaction transaction) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDI2OQ=="}, "originalCommit": {"oid": "08ad077361a0fb282556ded79a3789ff03c22b33"}, "originalPosition": 73}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 944, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}