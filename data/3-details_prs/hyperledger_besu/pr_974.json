{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNDQyMzk1", "number": 974, "title": "feat: FastSync now stops on failure instead of falling back to FullSync", "bodyText": "PR description\nChange FastSync default max pivot block reset to 250\nFastSync now stops on failure instead of falling back to FullSync\nfeat: FastSync now stops on failure instead of falling back to FullSync\nFixed Issue(s)\nfixes #683\nSigned-off-by: Alexandre PARIS-VERGNE alexpv14@gmail.com", "createdAt": "2020-05-24T17:14:12Z", "url": "https://github.com/hyperledger/besu/pull/974", "merged": true, "mergeCommit": {"oid": "3c2ef2b1e651b52be613a96c8c3ed8e997136522"}, "closed": true, "closedAt": "2020-06-04T17:27:00Z", "author": {"login": "br0tchain"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckepMRAH2gAyNDIyNDQyMzk1OjgzMDZhYmJiN2EwNjYyZTVkMzJjZjhlODM2YmU5YTI5NGM4ODgzYWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoBABfgH2gAyNDIyNDQyMzk1OjJhYThlNjIzYzZlMTRmODNiMzQ1MDdlNzE4OTJkNjRjMDA4NTU1NDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8306abbb7a0662e5d32cf8e836be9a294c8883ae", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/8306abbb7a0662e5d32cf8e836be9a294c8883ae", "committedDate": "2020-05-24T17:09:30Z", "message": "feat: FastSync now stops on failure instead of falling back to FullSync\n\nSigned-off-by: Alexandre PARIS-VERGNE <alexpv14@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36a78e8f70610986a28cb39affa7177f09e47a23", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/36a78e8f70610986a28cb39affa7177f09e47a23", "committedDate": "2020-05-27T07:37:28Z", "message": "Merge branch 'master' into feature/683-fast-sync-falls-back-to-full-sync-on-fastsyncexception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751d72367e9223b2023077e2dc3686c889f05096", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/751d72367e9223b2023077e2dc3686c889f05096", "committedDate": "2020-05-27T07:45:36Z", "message": "feat: exiting on FastSync failed\n\nSigned-off-by: Alexandre PARIS-VERGNE <alexpv14@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ff1912792fadf9323f99f377f4c09e8e63fe999", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/4ff1912792fadf9323f99f377f4c09e8e63fe999", "committedDate": "2020-05-27T16:29:49Z", "message": "feat: FastSync continues on FullSync when no errors happened\n\nSigned-off-by: Alexandre PARIS-VERGNE <alexpv14@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyODQ3Njky", "url": "https://github.com/hyperledger/besu/pull/974#pullrequestreview-422847692", "createdAt": "2020-06-02T16:21:43Z", "commit": {"oid": "4ff1912792fadf9323f99f377f4c09e8e63fe999"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNjoyMTo0M1rOGd5xlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNjoyMTo0M1rOGd5xlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAwODQ2OA==", "bodyText": "We have a stop method here, we should probably be calling that instead of just exiting. There could be important resources to close or cleanup nicely now or in the future.", "url": "https://github.com/hyperledger/besu/pull/974#discussion_r434008468", "createdAt": "2020-06-02T16:21:43Z", "author": {"login": "RatanRSur"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/sync/DefaultSynchronizer.java", "diffHunk": "@@ -126,7 +126,16 @@ public void start() {\n       LOG.info(\"Starting synchronizer.\");\n       blockPropagationManager.start();\n       if (fastSyncDownloader.isPresent()) {\n-        fastSyncDownloader.get().start().whenComplete(this::handleFastSyncResult);\n+        fastSyncDownloader\n+            .get()\n+            .start()\n+            .whenComplete(this::handleFastSyncResult)\n+            .exceptionally(\n+                ex -> {\n+                  System.exit(0);\n+                  return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff1912792fadf9323f99f377f4c09e8e63fe999"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f09b8e48f7f69dbbccde626872f62e2d9c7788fb", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/f09b8e48f7f69dbbccde626872f62e2d9c7788fb", "committedDate": "2020-06-03T16:38:58Z", "message": "Merge branch 'master' into feature/683-fast-sync-falls-back-to-full-sync-on-fastsyncexception"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTY2OTI5", "url": "https://github.com/hyperledger/besu/pull/974#pullrequestreview-424166929", "createdAt": "2020-06-04T07:22:14Z", "commit": {"oid": "f09b8e48f7f69dbbccde626872f62e2d9c7788fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "436e43366326d6ecbcc4a387041d2934cba36d7b", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/436e43366326d6ecbcc4a387041d2934cba36d7b", "committedDate": "2020-06-04T11:44:43Z", "message": "feat: add log on exiting FastSync process\n\nSigned-off-by: Alexandre PARIS-VERGNE <alexpv14@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2aa8e623c6e14f83b34507e71892d64c00855547", "author": {"user": {"login": "br0tchain", "name": null}}, "url": "https://github.com/hyperledger/besu/commit/2aa8e623c6e14f83b34507e71892d64c00855547", "committedDate": "2020-06-04T16:52:59Z", "message": "Merge branch 'master' into feature/683-fast-sync-falls-back-to-full-sync-on-fastsyncexception"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1537, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}