{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NzMxMTM5", "number": 660, "title": "[EIP-1559] Step 5 - Gas price and gas limit block header validation rules", "bodyText": "PR description\nImplement 2 new AttachedBlockHeaderValidationRule\n\nEIP1559BlockHeaderGasPriceValidationRule\nEIP1559BlockHeaderGasLimitValidationRule\n\nFixed Issue(s)\n\n\nfixes #597 #598\nSigned-off-by: Abdelhamid Bakhta abdelhamid.bakhta@consensys.net", "createdAt": "2020-04-06T15:36:27Z", "url": "https://github.com/hyperledger/besu/pull/660", "merged": true, "mergeCommit": {"oid": "8b1a06f4efff38ed6240bf79ac351af8c509d088"}, "closed": true, "closedAt": "2020-04-09T06:42:07Z", "author": {"login": "abdelhamidbakhta"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM4BqCAH2gAyMzk5NzMxMTM5OmJhMzdmZDBlZmNiYTJkZTRlYTM0Yzk3OTA2MGZmMzYxYTFmZTk3OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV2VzlgH2gAyMzk5NzMxMTM5OjVhZjdjYmYwMTY5OTU2ZTEzMTBhZTYwMjAwMjY0OTBjOGZlNTgxOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ba37fd0efcba2de4ea34c979060ff361a1fe9798", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/ba37fd0efcba2de4ea34c979060ff361a1fe9798", "committedDate": "2020-03-12T09:09:40Z", "message": "Added changelog entries for PR:\n- https://github.com/hyperledger/besu/pull/430\n- https://github.com/hyperledger/besu/pull/440\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "872f9cc4e93b90829961ebe6e599c51af43c95a7", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/872f9cc4e93b90829961ebe6e599c51af43c95a7", "committedDate": "2020-03-13T08:25:43Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e417b30e90cb0b33940adb1bee6a9dc8953c4abd", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e417b30e90cb0b33940adb1bee6a9dc8953c4abd", "committedDate": "2020-03-16T09:10:11Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2fb831c87dae221c92a9f9ec7705500717f1e77", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/a2fb831c87dae221c92a9f9ec7705500717f1e77", "committedDate": "2020-03-17T09:17:25Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c07ed7de515e1e25ea22ef38b59bf8337086812e", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/c07ed7de515e1e25ea22ef38b59bf8337086812e", "committedDate": "2020-03-17T15:26:18Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c1e22fe5a81e6a748b338a2ebedaaa53a00f04d", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/1c1e22fe5a81e6a748b338a2ebedaaa53a00f04d", "committedDate": "2020-03-18T08:29:25Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee10a2590d8e23b95a40c946a2927730714c4793", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/ee10a2590d8e23b95a40c946a2927730714c4793", "committedDate": "2020-03-19T16:27:54Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40cd31d7b48aab7b285524661ac17168c0d38467", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/40cd31d7b48aab7b285524661ac17168c0d38467", "committedDate": "2020-03-23T10:35:38Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e96c01a8ca248ded2aa4f22a6f56d9119cabebf2", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e96c01a8ca248ded2aa4f22a6f56d9119cabebf2", "committedDate": "2020-03-25T08:04:10Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c782ba4617a68e42def01737bdc6950ff7f9f53", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/2c782ba4617a68e42def01737bdc6950ff7f9f53", "committedDate": "2020-03-31T09:26:18Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b7f62d00c53ed1e8de940bffc675fad31825ba2", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/8b7f62d00c53ed1e8de940bffc675fad31825ba2", "committedDate": "2020-04-02T11:50:21Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce2a4c9a0d600f1309fc1a6e3be8c3d04c0e543a", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/ce2a4c9a0d600f1309fc1a6e3be8c3d04c0e543a", "committedDate": "2020-04-03T08:45:52Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97fc9b5900c05a3f4c18183e1b861fd86b6152b6", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/97fc9b5900c05a3f4c18183e1b861fd86b6152b6", "committedDate": "2020-04-06T10:50:47Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95947ab35e9145c5f788bb98ad1068a3db7a4895", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/95947ab35e9145c5f788bb98ad1068a3db7a4895", "committedDate": "2020-04-06T12:24:48Z", "message": "Merge remote-tracking branch 'upstream/master'\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8c4e9921430b8a06f8bb882bc9ce4975ce5579b", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e8c4e9921430b8a06f8bb882bc9ce4975ce5579b", "committedDate": "2020-04-06T15:33:44Z", "message": "Implement gas limit and gas price block header validation rules as per specified in EIP-1559\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e911532ffe39cc3d159d29fa8e99b7506fdcf168", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/e911532ffe39cc3d159d29fa8e99b7506fdcf168", "committedDate": "2020-04-07T08:15:04Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fb289299c04b4afc774b74c51b5ed15ad63882f", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/9fb289299c04b4afc774b74c51b5ed15ad63882f", "committedDate": "2020-04-07T09:00:06Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c521cef761d09abb3aee753bf5207fac9574bf87", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/c521cef761d09abb3aee753bf5207fac9574bf87", "committedDate": "2020-04-07T11:18:43Z", "message": "Merge remote-tracking branch 'upstream/master' into eip1559-step5\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa2f839d1218a684625a616a76754af216510221", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/aa2f839d1218a684625a616a76754af216510221", "committedDate": "2020-04-07T11:19:02Z", "message": "Merge branch 'eip1559-step5' of https://github.com/abdelhamidbakhta/besu into eip1559-step5"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MjQ5NDg1", "url": "https://github.com/hyperledger/besu/pull/660#pullrequestreview-389249485", "createdAt": "2020-04-07T15:46:21Z", "commit": {"oid": "aa2f839d1218a684625a616a76754af216510221"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNTo0NjoyMVrOGCKDDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNTo1Njo1MFrOGCKiDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDkxNDk1OA==", "bodyText": "This makes the BlockHeaderValidator mutable, and IMHO should not be done.  Note we have a builder that has the exact same method, so instead of mutating a produced BlockHeaderValidator we should hook into wherever the builder is being created.", "url": "https://github.com/hyperledger/besu/pull/660#discussion_r404914958", "createdAt": "2020-04-07T15:46:21Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/BlockHeaderValidator.java", "diffHunk": "@@ -99,6 +99,10 @@ private boolean applyRules(\n     return parent;\n   }\n \n+  public void addRule(final AttachedBlockHeaderValidationRule<C> rule) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa2f839d1218a684625a616a76754af216510221"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDkxODYzMg==", "bodyText": "Maybe start this off with a check of the feature flag?  Throw an exception if not set?", "url": "https://github.com/hyperledger/besu/pull/660#discussion_r404918632", "createdAt": "2020-04-07T15:51:07Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/MainnetProtocolSpecs.java", "diffHunk": "@@ -324,6 +328,21 @@ private MainnetProtocolSpecs() {}\n         .name(\"MuirGlacier\");\n   }\n \n+  // TODO EIP-1559 change for the actual fork name when known\n+  static ProtocolSpecBuilder<Void> eip1559Definition(\n+      final Optional<BigInteger> chainId,\n+      final OptionalInt contractSizeLimit,\n+      final OptionalInt configStackSizeLimit,\n+      final boolean enableRevertReason,\n+      final GenesisConfigOptions genesisConfigOptions) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa2f839d1218a684625a616a76754af216510221"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDkyMjg5NQ==", "bodyText": "This will require a tiny bit of replumbing.  We can have blockHeaderValidatorBuilder return the builder instead of the fully assembled blockHeaderValidator. Then we call addRule on the builder, then build and store.", "url": "https://github.com/hyperledger/besu/pull/660#discussion_r404922895", "createdAt": "2020-04-07T15:56:50Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/mainnet/ProtocolSpecBuilder.java", "diffHunk": "@@ -284,6 +294,8 @@\n \n     final BlockHeaderValidator<T> blockHeaderValidator =\n         blockHeaderValidatorBuilder.apply(difficultyCalculator);\n+    additionalBlockHeaderValidationRules.forEach(blockHeaderValidator::addRule);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa2f839d1218a684625a616a76754af216510221"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf071760ff3b625136c23384427ada14d4e3b929", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/bf071760ff3b625136c23384427ada14d4e3b929", "committedDate": "2020-04-07T16:31:31Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f50d8a82784032eb10bb0ae34ceb17ca0e48cff5", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/f50d8a82784032eb10bb0ae34ceb17ca0e48cff5", "committedDate": "2020-04-07T17:08:20Z", "message": "guard with feature flag\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25a5a2191bd92fa7ef31bf9664ab58eabb8ca243", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/25a5a2191bd92fa7ef31bf9664ab58eabb8ca243", "committedDate": "2020-04-07T17:46:49Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a30112f700f3a1a9b19c18b20693bd226279f19d", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/a30112f700f3a1a9b19c18b20693bd226279f19d", "committedDate": "2020-04-08T07:51:09Z", "message": "Merge remote-tracking branch 'upstream/master' into eip1559-step5\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73d8cb5ea853db4d1e8c59f35ac71129f45ec2ec", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/73d8cb5ea853db4d1e8c59f35ac71129f45ec2ec", "committedDate": "2020-04-08T10:11:46Z", "message": "address pr comments\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "498493b7047070b855d6a9abc99f0a7758ccb352", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/498493b7047070b855d6a9abc99f0a7758ccb352", "committedDate": "2020-04-08T11:19:00Z", "message": "address pr comments\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3abfac07d0891efa58baf56770f0b0384828507", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/c3abfac07d0891efa58baf56770f0b0384828507", "committedDate": "2020-04-08T13:57:57Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzgzMDcz", "url": "https://github.com/hyperledger/besu/pull/660#pullrequestreview-390383073", "createdAt": "2020-04-08T22:48:47Z", "commit": {"oid": "c3abfac07d0891efa58baf56770f0b0384828507"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c92365a564a2f913fd799d9ae76fb6434072b0b3", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/c92365a564a2f913fd799d9ae76fb6434072b0b3", "committedDate": "2020-04-09T05:28:47Z", "message": "Merge branch 'master' into eip1559-step5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5af7cbf0169956e1310ae6020026490c8fe58195", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/5af7cbf0169956e1310ae6020026490c8fe58195", "committedDate": "2020-04-09T06:17:11Z", "message": "Merge branch 'master' into eip1559-step5"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1680, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}