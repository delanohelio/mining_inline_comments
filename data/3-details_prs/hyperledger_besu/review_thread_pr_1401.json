{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzNzE4NTE3", "number": 1401, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTo1NTozMlrOEoJ1gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMDoxODowN1rOEou8jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwNTM5NjUxOnYy", "diffSide": "RIGHT", "path": "besu/src/main/java/org/hyperledger/besu/cli/BesuCommand.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTo1NTozMlrOHZFEgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTo1NTozMlrOHZFEgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA1OTUyMg==", "bodyText": "Looks like we need to special case port zero, which is designed to conflict.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          if (!allocatedPorts.add(port)) {\n          \n          \n            \n                          if (port != 0 && !allocatedPorts.add(port)) {\n          \n      \n    \n    \n  \n\nWe will also need a unit test for this.", "url": "https://github.com/hyperledger/besu/pull/1401#discussion_r496059522", "createdAt": "2020-09-28T15:55:32Z", "author": {"login": "shemnon"}, "path": "besu/src/main/java/org/hyperledger/besu/cli/BesuCommand.java", "diffHunk": "@@ -2233,6 +2238,31 @@ public EnodeDnsConfiguration getEnodeDnsConfiguration() {\n     return enodeDnsConfiguration;\n   }\n \n+  private void checkPortClash() {\n+    // List of port parameters\n+    final List<Integer> ports =\n+        asList(\n+            p2pPort,\n+            graphQLHttpPort,\n+            rpcHttpPort,\n+            rpcWsPort,\n+            metricsPort,\n+            metricsPushPort,\n+            stratumPort);\n+    ports.stream()\n+        .filter(Objects::nonNull)\n+        .forEach(\n+            port -> {\n+              if (!allocatedPorts.add(port)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "68302791a862b56d9999cfc11117004a277e3a5a"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMTQ3NjYzOnYy", "diffSide": "RIGHT", "path": "besu/src/test/java/org/hyperledger/besu/cli/BesuCommandTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMDoxODowN1rOHZ_mwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMDoxODowN1rOHZ_mwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAxODU2MQ==", "bodyText": "Two more tests - no ports specified and every possible port specified - p2pPort, graphQLHttpPort, rpcHttpPort, rpcWsPort, metricsPort, metricsPushPort, stratumPort", "url": "https://github.com/hyperledger/besu/pull/1401#discussion_r497018561", "createdAt": "2020-09-29T20:18:07Z", "author": {"login": "shemnon"}, "path": "besu/src/test/java/org/hyperledger/besu/cli/BesuCommandTest.java", "diffHunk": "@@ -3672,4 +3672,17 @@ public void assertThatInvalidWsTimeoutSecondsFails() {\n     assertThat(commandErrorOutput.toString())\n         .contains(\"Invalid value for option\", \"--Xws-timeout-seconds\", \"abc\", \"is not a long\");\n   }\n+\n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c347679c58cb5e64e1aaadf3dabd0ef5ffae5a4e"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1402, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}