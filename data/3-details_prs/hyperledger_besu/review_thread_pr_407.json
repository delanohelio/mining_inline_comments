{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MDM0MjA1", "number": 407, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDowNDoyOFrODgZraw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDowNDoyOFrODgZraw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MzAxNzM5OnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/query/TransactionLogBloomCacher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDowNDoyOFrOFqljdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDowNTozNVrOFqllyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDE5OTc5Ng==", "bodyText": "Why did ensureChecks get introduced? Performance reasons?", "url": "https://github.com/hyperledger/besu/pull/407#discussion_r380199796", "createdAt": "2020-02-17T14:04:28Z", "author": {"login": "RatanRSur"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/query/TransactionLogBloomCacher.java", "diffHunk": "@@ -134,15 +126,19 @@ private long fillCacheFile(\n       cachingStatus.currentBlock = blockNum;\n       blockNum++;\n     }\n-    return blockNum - startBlock;\n   }\n \n-  public void cacheLogsBloomForBlockHeader(final BlockHeader blockHeader) {\n+  public void cacheLogsBloomForBlockHeader(\n+      final BlockHeader blockHeader,\n+      final Optional<File> reusedCacheFile,\n+      final boolean ensureChecks) {\n     try {\n       final long blockNumber = blockHeader.getNumber();\n       LOG.debug(\"Caching logs bloom for block {}.\", \"0x\" + Long.toHexString(blockNumber));\n-      ensurePreviousSegmentsArePresent(blockNumber);\n-      final File cacheFile = calculateCacheFileName(blockNumber, cacheDir);\n+      if (ensureChecks) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6de9fa9d7fa4edaec21776c66d6dca90c7d101ea"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIwMDM5Mg==", "bodyText": "Yeah. At some places we don't want to do always this check", "url": "https://github.com/hyperledger/besu/pull/407#discussion_r380200392", "createdAt": "2020-02-17T14:05:35Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/query/TransactionLogBloomCacher.java", "diffHunk": "@@ -134,15 +126,19 @@ private long fillCacheFile(\n       cachingStatus.currentBlock = blockNum;\n       blockNum++;\n     }\n-    return blockNum - startBlock;\n   }\n \n-  public void cacheLogsBloomForBlockHeader(final BlockHeader blockHeader) {\n+  public void cacheLogsBloomForBlockHeader(\n+      final BlockHeader blockHeader,\n+      final Optional<File> reusedCacheFile,\n+      final boolean ensureChecks) {\n     try {\n       final long blockNumber = blockHeader.getNumber();\n       LOG.debug(\"Caching logs bloom for block {}.\", \"0x\" + Long.toHexString(blockNumber));\n-      ensurePreviousSegmentsArePresent(blockNumber);\n-      final File cacheFile = calculateCacheFileName(blockNumber, cacheDir);\n+      if (ensureChecks) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDE5OTc5Ng=="}, "originalCommit": {"oid": "6de9fa9d7fa4edaec21776c66d6dca90c7d101ea"}, "originalPosition": 73}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1100, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}