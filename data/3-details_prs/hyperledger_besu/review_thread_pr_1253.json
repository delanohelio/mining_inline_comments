{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1OTk0ODYy", "number": 1253, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMzowMVrOERxdew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMDo1Mjo0OFrOET1yCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDcxNjExOnYy", "diffSide": "LEFT", "path": "ethereum/eth/src/test/java/org/hyperledger/besu/ethereum/eth/manager/EthSchedulerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMzowMVrOG2qasg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMzoyNDoxOFrOG2vMYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTI1MA==", "bodyText": "I'm not sure why we should remove isSucceeded but we should keep isFailed. maybe I missed something", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r459971250", "createdAt": "2020-07-24T10:23:01Z", "author": {"login": "matkt"}, "path": "ethereum/eth/src/test/java/org/hyperledger/besu/ethereum/eth/manager/EthSchedulerTest.java", "diffHunk": "@@ -205,7 +205,6 @@ public void timeout_cancelsTaskWhenResultIsCancelled() {\n     result.cancel(false);\n     assertThat(task.isDone()).isTrue();\n     assertThat(task.isFailed()).isTrue();\n-    assertThat(task.isSucceeded()).isFalse();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDA0OTUwNQ==", "bodyText": "I removed the method entirely and here because this was the only place it was used and if the previous two assertions, isDone and isFailed are true, isSucceeded can never be true.", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r460049505", "createdAt": "2020-07-24T13:24:18Z", "author": {"login": "RatanRSur"}, "path": "ethereum/eth/src/test/java/org/hyperledger/besu/ethereum/eth/manager/EthSchedulerTest.java", "diffHunk": "@@ -205,7 +205,6 @@ public void timeout_cancelsTaskWhenResultIsCancelled() {\n     result.cancel(false);\n     assertThat(task.isDone()).isTrue();\n     assertThat(task.isFailed()).isTrue();\n-    assertThat(task.isSucceeded()).isFalse();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTI1MA=="}, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MjM5NTYyOnYy", "diffSide": "RIGHT", "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/task/AbstractEthTask.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMDo1Mjo0OFrOG5za7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNDozMjoyNFrOG-RJnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI2NDQ5Mg==", "bodyText": "isDone instead of isCancelled?  Can we re-execute something that completed normally?  isDone catches any termination.\nAlso, perhaps move the started before the cancelled/done check?", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r463264492", "createdAt": "2020-07-30T20:52:48Z", "author": {"login": "shemnon"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/task/AbstractEthTask.java", "diffHunk": "@@ -69,44 +71,39 @@ public double stopTimer() {\n \n   @Override\n   public final CompletableFuture<T> run() {\n-    if (result.compareAndSet(null, new CompletableFuture<>())) {\n+    if (!result.isCancelled() && started.compareAndSet(false, true)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk0NTg4NQ==", "bodyText": "You're right, I think it should be isDone.", "url": "https://github.com/hyperledger/besu/pull/1253#discussion_r467945885", "createdAt": "2020-08-10T14:32:24Z", "author": {"login": "RatanRSur"}, "path": "ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/task/AbstractEthTask.java", "diffHunk": "@@ -69,44 +71,39 @@ public double stopTimer() {\n \n   @Override\n   public final CompletableFuture<T> run() {\n-    if (result.compareAndSet(null, new CompletableFuture<>())) {\n+    if (!result.isCancelled() && started.compareAndSet(false, true)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI2NDQ5Mg=="}, "originalCommit": {"oid": "4624f056bf7506b9ccbe5d140b4096eab8a6850d"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 728, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}