{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMzgzMDk5", "number": 1182, "title": "exception if --privacy-marker-transaction-signing-key-file not specified in non-zero-gas network", "bodyText": "With privacy enabled, it is only valid to omit --privacy-marker-transaction-signing-key-file\nif --min-gas-price=0\nSo - if --privacy-enabled and --min-gas-price > 0 and --privacy-marker-transaction-signing-key-file not specified, throw exception and prevent startup.\nSee #505", "createdAt": "2020-07-01T01:16:08Z", "url": "https://github.com/hyperledger/besu/pull/1182", "merged": true, "mergeCommit": {"oid": "70ce1682916a61ea2695411e421cb135e4ed95e7"}, "closed": true, "closedAt": "2020-07-02T06:57:53Z", "author": {"login": "macfarla"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcweCyxgH2gAyNDQyMzgzMDk5OjJjZjQwMGFjODU3Y2UzZTIxZWZjNWM4MTMyN2I3YWFkMGI5MjQzZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcw483qgFqTQ0MTM4MzQxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2cf400ac857ce3e21efc5c81327b7aad0b9243f4", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/2cf400ac857ce3e21efc5c81327b7aad0b9243f4", "committedDate": "2020-06-30T23:14:39Z", "message": "exception if min-gas-price > 0 and pmt key file not specified\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72975f9229f6913d4386e92b5c7b2d3188a5cecc", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/72975f9229f6913d4386e92b5c7b2d3188a5cecc", "committedDate": "2020-07-01T01:09:03Z", "message": "use compareTo\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8ab243651764c412e25e3aa97acdb0a422620bc", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/b8ab243651764c412e25e3aa97acdb0a422620bc", "committedDate": "2020-07-01T01:09:11Z", "message": "Merge branch 'master' of https://github.com/hyperledger/besu into 505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65d78a54aa6f23f7d2b165a3b57053cecf458a1c", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/65d78a54aa6f23f7d2b165a3b57053cecf458a1c", "committedDate": "2020-07-01T02:09:08Z", "message": "reverted change to API\n\nSigned-off-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f52e2b0e8dc1553aa59e3627c5d0782ce5f65ee0", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/f52e2b0e8dc1553aa59e3627c5d0782ce5f65ee0", "committedDate": "2020-07-01T19:48:23Z", "message": "Merge branch 'master' into 505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8d26f24a70319663960f21d240027c9d66f88ac", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/b8d26f24a70319663960f21d240027c9d66f88ac", "committedDate": "2020-07-02T02:26:47Z", "message": "Merge branch 'master' into 505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5a710ef3ba54510b8d3f02710a3f12203e21b77", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/f5a710ef3ba54510b8d3f02710a3f12203e21b77", "committedDate": "2020-07-02T02:50:38Z", "message": "Merge branch 'master' into 505"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b599cf9c5901ecf2090b938a446a30f997081eb3", "author": {"user": {"login": "macfarla", "name": "Sally MacFarlane"}}, "url": "https://github.com/hyperledger/besu/commit/b599cf9c5901ecf2090b938a446a30f997081eb3", "committedDate": "2020-07-02T06:28:14Z", "message": "Merge branch 'master' into 505"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzgzNDE3", "url": "https://github.com/hyperledger/besu/pull/1182#pullrequestreview-441383417", "createdAt": "2020-07-02T06:30:05Z", "commit": {"oid": "b599cf9c5901ecf2090b938a446a30f997081eb3"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjozMDowNlrOGr_HpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjozNTowMlrOGr_O6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NjEwMQ==", "bodyText": "\"set, each\" ?", "url": "https://github.com/hyperledger/besu/pull/1182#discussion_r448776101", "createdAt": "2020-07-02T06:30:06Z", "author": {"login": "mark-terry"}, "path": "besu/src/main/java/org/hyperledger/besu/cli/BesuCommand.java", "diffHunk": "@@ -909,7 +909,7 @@ void setBannedNodeIds(final List<String> values) {\n   @Option(\n       names = {\"--target-gas-limit\"},\n       description =\n-          \"Sets target gas limit per block. If set each blocks gas limit will approach this setting over time if the current gas limit is different.\")\n+          \"Sets target gas limit per block. If set each block's gas limit will approach this setting over time if the current gas limit is different.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b599cf9c5901ecf2090b938a446a30f997081eb3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NzM2OA==", "bodyText": "\"Private transactions cannot be signed by random (non-funded) accounts in paid gas networks\"\nWould you expect a user to connect that not specifying a key file will mean a random account is used? I'm not sure whether we can expect the user to have enough context to understand the last sentence.", "url": "https://github.com/hyperledger/besu/pull/1182#discussion_r448777368", "createdAt": "2020-07-02T06:33:22Z", "author": {"login": "mark-terry"}, "path": "besu/src/main/java/org/hyperledger/besu/cli/BesuCommand.java", "diffHunk": "@@ -1882,6 +1882,16 @@ private PrivacyParameters privacyParameters() {\n         throw new ParameterException(\n             commandLine, \"Please specify Enclave public key file path to enable privacy\");\n       }\n+\n+      if (Wei.ZERO.compareTo(minTransactionGasPrice) < 0) {\n+        // if gas is required, cannot use random keys to sign private tx\n+        // ie --privacy-marker-transaction-signing-key-file must be set\n+        if (privacyMarkerTransactionSigningKeyPath == null) {\n+          throw new ParameterException(\n+              commandLine,\n+              \"Not a free gas network. --privacy-marker-transaction-signing-key-file must be specified and must be a funded account. Private transactions cannot be signed by random (non-funded) accounts in paid gas networks\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b599cf9c5901ecf2090b938a446a30f997081eb3"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3Nzk2Mw==", "bodyText": "Does it make sense to rely on a default non-zero gas price, or would it be clearer to have an explicit non-zero gas price?", "url": "https://github.com/hyperledger/besu/pull/1182#discussion_r448777963", "createdAt": "2020-07-02T06:35:02Z", "author": {"login": "mark-terry"}, "path": "besu/src/test/java/org/hyperledger/besu/cli/BesuCommandTest.java", "diffHunk": "@@ -3073,6 +3089,15 @@ public void onchainPrivacyAndMultiTenancyCannotBeUsedTogether() {\n         .startsWith(\"Privacy multi-tenancy and onchain privacy groups cannot be used together\");\n   }\n \n+  @Test\n+  public void privacyMarkerTransactionSigningKeyFileRequiredIfMinGasPriceNonZero() {\n+    parseCommand(\"--privacy-enabled\", \"--privacy-public-key-file\", ENCLAVE_PUBLIC_KEY_PATH);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b599cf9c5901ecf2090b938a446a30f997081eb3"}, "originalPosition": 77}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1509, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}