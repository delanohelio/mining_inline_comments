{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMzMxNzE2", "number": 1567, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0MDowN1rOE8C5jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0ODo1OFrOE8C9KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMzk3NTE3OnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0MDowN1rOH39WcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0MDowN1rOH39WcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzODg5Ng==", "bodyText": "Looks like you don't need to include blockHash in @JsonAlias.", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528438896", "createdAt": "2020-11-23T01:40:07Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameter.java", "diffHunk": "@@ -49,7 +50,7 @@ public FilterParameter(\n           final List<Address> address,\n       @JsonDeserialize(using = TopicsDeserializer.class) @JsonProperty(\"topics\")\n           final List<List<LogTopic>> topics,\n-      @JsonProperty(\"blockhash\") final Hash blockHash) {\n+      @JsonProperty(\"blockHash\") @JsonAlias({\"blockhash\", \"blockHash\"}) final Hash blockHash) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMzk4MDU2OnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0NTowNlrOH39ZKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMjowNjozN1rOH39lqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzOTU5Mg==", "bodyText": "I'd consider deleting the previous test because the name clash is a bit confusing and the case of blockHash doesn't seem significant to the test case.", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528439592", "createdAt": "2020-11-23T01:45:06Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0Mjc5Mw==", "bodyText": "put it into a single test", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528442793", "createdAt": "2020-11-23T02:06:37Z", "author": {"login": "macfarla"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzOTU5Mg=="}, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMzk4NDQwOnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMTo0ODo1OFrOH39bHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMjowMToxMFrOH39inw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MDA5Mg==", "bodyText": "The different casing of the test names is a bit confusing again...\nWould it make sense to merge both of these test cases into a blockHashAliasSucceeds that asserts the output of both requests is valid and that the output is equal?", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528440092", "createdAt": "2020-11-23T01:48:58Z", "author": {"login": "mark-terry"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test\n+  public void jsonWithBlockHashAndFromAndToParametersIsInvalid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\", \\\"fromBlock\\\": \\\"0x0\\\", \\\"toBlock\\\": \\\"pending\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isFalse();\n+  }\n+\n+  @Test\n+  public void jsonWithBlockHashIsValid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isTrue();\n+    assertThat(parsedFilterParameter.getBlockHash()).isEqualTo(Optional.of(Hash.ZERO));\n+  }\n+\n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MjAxNQ==", "bodyText": "good idea", "url": "https://github.com/hyperledger/besu/pull/1567#discussion_r528442015", "createdAt": "2020-11-23T02:01:10Z", "author": {"login": "macfarla"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/parameters/FilterParameterTest.java", "diffHunk": "@@ -179,6 +180,68 @@ public void jsonWithBlockAndFromAndToParametersIsInvalid() throws Exception {\n     assertThat(parsedFilterParameter.isValid()).isFalse();\n   }\n \n+  @Test\n+  public void jsonWithBlockHashAndFromAndToParametersIsInvalid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\", \\\"fromBlock\\\": \\\"0x0\\\", \\\"toBlock\\\": \\\"pending\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isFalse();\n+  }\n+\n+  @Test\n+  public void jsonWithBlockHashIsValid() throws Exception {\n+    final String json =\n+        \"{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"eth_getLogs\\\",\\\"params\\\":[{\"\n+            + \"\\\"address\\\":\\\"0x0\\\",\"\n+            + \"\\\"topics\\\":[\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \",\"\n+            + TOPICS_TWO_THREE_ARRAY\n+            + \"], \\\"blockHash\\\": \\\"\"\n+            + Hash.ZERO\n+            + \"\\\"}],\\\"id\\\":1}\";\n+\n+    final JsonRpcRequestContext request = new JsonRpcRequestContext(readJsonAsJsonRpcRequest(json));\n+    final FilterParameter parsedFilterParameter =\n+        request.getRequiredParameter(0, FilterParameter.class);\n+\n+    assertThat(parsedFilterParameter.isValid()).isTrue();\n+    assertThat(parsedFilterParameter.getBlockHash()).isEqualTo(Optional.of(Hash.ZERO));\n+  }\n+\n+  @Test", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ0MDA5Mg=="}, "originalCommit": {"oid": "8a12c4b0b0ea7fe6a8a839f7a6773ec8f8f3f642"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1350, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}