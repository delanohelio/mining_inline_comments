{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNDk1OTEz", "number": 694, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNTo0MzowOVrODwdeKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxODowNDoxNVrODwgosA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMTQxMDk3OnYy", "diffSide": "RIGHT", "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/EIP1559.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNTo0MzowOVrOGDefTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNjo0MDoyMlrOGDgrkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI5ODQ0NA==", "bodyText": "This feels like it should be in MainnetTransactionValidator instead, with two new constructor args.  If we get a third format we can go to an enum set or bitfield.  As part of validate(final Transaction transaction) we check the valid types against the booleans or enum set/bitfield.  Perhaps we need to define two forks for testing, EIP1559 and EIP1559Only", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406298444", "createdAt": "2020-04-09T15:43:09Z", "author": {"login": "shemnon"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/EIP1559.java", "diffHunk": "@@ -76,6 +79,23 @@ public long getForkBlock() {\n     return initialForkBlknum;\n   }\n \n+  public boolean isValid(final Transaction transaction, final LongSupplier blockNumberSupplier) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60df7f8825f51f3c6b89274c59cec13ea8ce37fd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMzNDM1Mw==", "bodyText": "Done", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406334353", "createdAt": "2020-04-09T16:40:22Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/core/src/main/java/org/hyperledger/besu/ethereum/core/fees/EIP1559.java", "diffHunk": "@@ -76,6 +79,23 @@ public long getForkBlock() {\n     return initialForkBlknum;\n   }\n \n+  public boolean isValid(final Transaction transaction, final LongSupplier blockNumberSupplier) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI5ODQ0NA=="}, "originalCommit": {"oid": "60df7f8825f51f3c6b89274c59cec13ea8ce37fd"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMTY1MjQwOnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransaction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNjo0NjoyNlrOGDg5Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNjo1ODo1M1rOGDhVyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMzNzgzOA==", "bodyText": "I don't think we need any of this logic in the RPC stub. MainnetTransacitonValidator should be catching it when we try and addLocalTransaction.  The RPC stub should have no knowledge of the internals of the block chain.", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406337838", "createdAt": "2020-04-09T16:46:26Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransaction.java", "diffHunk": "@@ -99,4 +114,26 @@ private Transaction decodeRawTransaction(final String hash)\n       throw new InvalidJsonRpcRequestException(\"Invalid raw transaction hex\", e);\n     }\n   }\n+\n+  private Transaction checkEIP1559(final Transaction transaction)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee56b8c0703b94a3e0beeb0de8a228d1998becea"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM0NTE2MA==", "bodyText": "Ok done.", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406345160", "createdAt": "2020-04-09T16:58:53Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransaction.java", "diffHunk": "@@ -99,4 +114,26 @@ private Transaction decodeRawTransaction(final String hash)\n       throw new InvalidJsonRpcRequestException(\"Invalid raw transaction hex\", e);\n     }\n   }\n+\n+  private Transaction checkEIP1559(final Transaction transaction)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMzNzgzOA=="}, "originalCommit": {"oid": "ee56b8c0703b94a3e0beeb0de8a228d1998becea"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMTkyOTQ0OnYy", "diffSide": "RIGHT", "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransactionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxODowNDoxNVrOGDjnAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNjo1OToxMFrOGDywuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM4MjMzOA==", "bodyText": "This can be removed.", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406382338", "createdAt": "2020-04-09T18:04:15Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransactionTest.java", "diffHunk": "@@ -42,7 +43,7 @@\n   private static final String VALID_TRANSACTION =\n       \"0xf86d0485174876e800830222e0945aae326516b4f8fe08074b7e972e40a713048d62880de0b6b3a7640000801ba05d4e7998757264daab67df2ce6f7e7a0ae36910778a406ca73898c9899a32b9ea0674700d5c3d1d27f2e6b4469957dfd1a1c49bf92383d80717afc84eb05695d5b\";\n   @Mock private TransactionPool transactionPool;\n-\n+  @Mock private BlockchainQueries blockchainQueries;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db1d528ab341f2d1189a04197f1eed5ee959b47b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYzMDU4Nw==", "bodyText": "Done", "url": "https://github.com/hyperledger/besu/pull/694#discussion_r406630587", "createdAt": "2020-04-10T06:59:10Z", "author": {"login": "abdelhamidbakhta"}, "path": "ethereum/api/src/test/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthSendRawTransactionTest.java", "diffHunk": "@@ -42,7 +43,7 @@\n   private static final String VALID_TRANSACTION =\n       \"0xf86d0485174876e800830222e0945aae326516b4f8fe08074b7e972e40a713048d62880de0b6b3a7640000801ba05d4e7998757264daab67df2ce6f7e7a0ae36910778a406ca73898c9899a32b9ea0674700d5c3d1d27f2e6b4469957dfd1a1c49bf92383d80717afc84eb05695d5b\";\n   @Mock private TransactionPool transactionPool;\n-\n+  @Mock private BlockchainQueries blockchainQueries;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM4MjMzOA=="}, "originalCommit": {"oid": "db1d528ab341f2d1189a04197f1eed5ee959b47b"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1048, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}