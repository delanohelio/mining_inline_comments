{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MjYxODg1", "number": 1350, "title": "Implement batch transactions RPC endpoint.", "bodyText": "PR description\nAs part of EIP-1559 testnet work, we are facing some issues regarding transaction orchestration.\nWe want to simulate 25M blocks for long periods.\nA dedicated endpoint to submit batch of transactions would help achieving this goal.\nThis PR introduces a new RPC endpoint debug_batchSendRawTransaction.\nRequest parameters\nDATA, The signed transaction data array.\nparams: [\"0xf868808203e882520894627306090abab3a6e1400e9345bc60c78a8bef57872386f26fc10000801ba0ac74ecfa0e9b85785f042c143ead4780931234cc9a032fce99fab1f45e0d90faa02fd17e8eb433d4ca47727653232045d4f81322619c0852d3fe8ddcfcedb66a43\", \"0xf868018203e882520894627306090abab3a6e1400e9345bc60c78a8bef57872386f26fc10000801ca0b24ea1bee8fe36984c36acbf80979a4509f23fc17141851e08d505c0df158aa0a00472a05903d4cd7a811bd4d5c59cc105d93f5943f3393f253e92e65fc36e7ce0\"]\nResponse\nReturns the status of the execution for each input raw transaction. Individual result object contains:\n\nindex: the index of the transaction in the request parameters array,\nsuccess: a boolean indicating whether or not the transaction has been added to the transaction pool, and\nerrorMessage: an optional error message.\n\nFixed Issue(s)\nFixes #1227\nChangelog\n\nAdded debug_batchSendRawTransaction JSON-RPC API to submit multiple signed transactions with a single call.\n\nTesting\nManual testing\nSample request\n{\n   \"jsonrpc\":\"2.0\",\n   \"method\":\"debug_batchSendRawTransaction\",\n   \"params\":[\n      \"0xf868808203e882520894627306090abab3a6e1400e9345bc60c78a8bef57872386f26fc10000801ba0ac74ecfa0e9b85785f042c143ead4780931234cc9a032fce99fab1f45e0d90faa02fd17e8eb433d4ca47727653232045d4f81322619c0852d3fe8ddcfcedb66a43\",\n      \"0x416\",\n      \"0xf868018203e882520894627306090abab3a6e1400e9345bc60c78a8bef57872386f26fc10000801ca0b24ea1bee8fe36984c36acbf80979a4509f23fc17141851e08d505c0df158aa0a00472a05903d4cd7a811bd4d5c59cc105d93f5943f3393f253e92e65fc36e7ce0\",\n      \"0xf868808203e882520894627306090abab3a6e1400e9345bc60c78a8bef5787470de4df820000801ca0f7936b4de04792e3c65095cfbfd1399d231368f5f05f877588c0c8509f6c98c9a01834004dead527c8da1396eede42e1c60e41f38a77c2fd13a6e495479c729b99\"\n   ],\n   \"id\":1\n}\nSample response\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": [\n    {\n      \"index\": 0,\n      \"success\": true\n    },\n    {\n      \"index\": 1,\n      \"success\": false,\n      \"errorMessage\": \"Invalid raw transaction hex\"\n    },\n    {\n      \"index\": 2,\n      \"success\": true\n    },\n    {\n      \"index\": 3,\n      \"success\": false,\n      \"errorMessage\": \"TRANSACTION_REPLACEMENT_UNDERPRICED\"\n    }\n  ]\n}\nSigned-off-by: Abdelhamid Bakhta abdelhamid.bakhta@consensys.net", "createdAt": "2020-08-31T12:19:49Z", "url": "https://github.com/hyperledger/besu/pull/1350", "merged": true, "mergeCommit": {"oid": "1b082b3bbef9b441cc1130b596547004536e4252"}, "closed": true, "closedAt": "2020-09-02T08:28:28Z", "author": {"login": "abdelhamidbakhta"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdERuWsgH2gAyNDc2MjYxODg1OjMzNTk0NmNkZThhNWY2YTI5OTcxN2ZlODljZmVmNjUyMTEyMzYxMTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE2r-HAH2gAyNDc2MjYxODg1OjJiYzJmY2UxYmZjNWQwZmQyMGFiYjc1MjFjMTU1YTI1ZGQ3MjdmYWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "335946cde8a5f6a299717fe89cfef65211236117", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/335946cde8a5f6a299717fe89cfef65211236117", "committedDate": "2020-08-31T12:11:57Z", "message": "Implement batch transactions RPC endoint\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c6cf027f7e53e8e547aa6e21ad37e14d8afe4cc", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/8c6cf027f7e53e8e547aa6e21ad37e14d8afe4cc", "committedDate": "2020-08-31T12:52:34Z", "message": "Add file header\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NzUyMDE4", "url": "https://github.com/hyperledger/besu/pull/1350#pullrequestreview-478752018", "createdAt": "2020-08-31T16:14:02Z", "commit": {"oid": "8c6cf027f7e53e8e547aa6e21ad37e14d8afe4cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxNDowM1rOHJ_T8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxNDowM1rOHJ_T8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIzNjUyOQ==", "bodyText": "So if all of the TXes fail the RPC call succeeds, but with an array of each failed TX?  That's fine, no need to throw a JSON-RPC error in that case.", "url": "https://github.com/hyperledger/besu/pull/1350#discussion_r480236529", "createdAt": "2020-08-31T16:14:03Z", "author": {"login": "shemnon"}, "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/DebugBatchSendRawTransaction.java", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods;\n+\n+import org.hyperledger.besu.ethereum.api.jsonrpc.RpcMethod;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.JsonRpcRequestContext;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.exception.InvalidJsonRpcRequestException;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcResponse;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcSuccessResponse;\n+import org.hyperledger.besu.ethereum.api.util.DomainObjectDecodeUtils;\n+import org.hyperledger.besu.ethereum.eth.transactions.TransactionPool;\n+import org.hyperledger.besu.ethereum.mainnet.TransactionValidator;\n+import org.hyperledger.besu.ethereum.mainnet.ValidationResult;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.function.Supplier;\n+import java.util.stream.IntStream;\n+\n+import com.fasterxml.jackson.annotation.JsonGetter;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonInclude.Include;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import com.google.common.base.Suppliers;\n+\n+public class DebugBatchSendRawTransaction implements JsonRpcMethod {\n+  private final Supplier<TransactionPool> transactionPool;\n+\n+  public DebugBatchSendRawTransaction(final TransactionPool transactionPool) {\n+    this(Suppliers.ofInstance(transactionPool));\n+  }\n+\n+  public DebugBatchSendRawTransaction(final Supplier<TransactionPool> transactionPool) {\n+    this.transactionPool = transactionPool;\n+  }\n+\n+  @Override\n+  public String getName() {\n+    return RpcMethod.DEBUG_BATCH_RAW_TRANSACTION.getMethodName();\n+  }\n+\n+  @Override\n+  public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n+    final List<ExecutionStatus> executionStatuses = new ArrayList<>();\n+    IntStream.range(0, requestContext.getRequest().getParamLength())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c6cf027f7e53e8e547aa6e21ad37e14d8afe4cc"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7618c2d26281ac9b6653c9544a5785a7628ccc0d", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/7618c2d26281ac9b6653c9544a5785a7628ccc0d", "committedDate": "2020-09-01T07:24:37Z", "message": "Merge remote-tracking branch 'upstream/master' into 1227\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c8c25eb1d9aa44cbb686f8a47c91b2dca0d3050", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/9c8c25eb1d9aa44cbb686f8a47c91b2dca0d3050", "committedDate": "2020-09-01T16:27:35Z", "message": "Added unit tests and integration tests.\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTU0NzMw", "url": "https://github.com/hyperledger/besu/pull/1350#pullrequestreview-480154730", "createdAt": "2020-09-01T22:15:26Z", "commit": {"oid": "9c8c25eb1d9aa44cbb686f8a47c91b2dca0d3050"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ded339070bd5fab585da4f110501c25373526ca", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/9ded339070bd5fab585da4f110501c25373526ca", "committedDate": "2020-09-02T07:04:47Z", "message": "Merge remote-tracking branch 'upstream/master' into 1227\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bc2fce1bfc5d0fd20abb7521c155a25dd727faa", "author": {"user": {"login": "abdelhamidbakhta", "name": "Abdelhamid Bakhta"}}, "url": "https://github.com/hyperledger/besu/commit/2bc2fce1bfc5d0fd20abb7521c155a25dd727faa", "committedDate": "2020-09-02T07:15:50Z", "message": "Added test for invalid signature.\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1475, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}