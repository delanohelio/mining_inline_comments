{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMDE4MzA3", "number": 828, "title": "Make sure that the onchain privacy group version is always different.", "bodyText": "Signed-off-by: Stefan Pingel stefan.pingel@consensys.net", "createdAt": "2020-05-01T07:18:55Z", "url": "https://github.com/hyperledger/besu/pull/828", "merged": true, "mergeCommit": {"oid": "46233966f52b617e8eb3a4d0c0b13e698b87508d"}, "closed": true, "closedAt": "2020-05-05T06:33:47Z", "author": {"login": "pinges"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcc8YFFAH2gAyNDEyMDE4MzA3Ojg1MDExMjUyNWYxZTQyZmRhZDYxZmE5OTYxYTFiMWM3YTFkNjlhM2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceNppeAFqTQwNTUwODY5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "850112525f1e42fdad61fa9961a1b1c7a1d69a3c", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/850112525f1e42fdad61fa9961a1b1c7a1d69a3c", "committedDate": "2020-05-01T07:16:34Z", "message": "Make sure that the onchain privacy group version is always different.\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e786dd1d8a45a6b6294602f7579a6bd2f0e2b0f7", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/e786dd1d8a45a6b6294602f7579a6bd2f0e2b0f7", "committedDate": "2020-05-01T07:19:11Z", "message": "Merge branch 'master' into fixOnChainVersion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NjY3NzI4", "url": "https://github.com/hyperledger/besu/pull/828#pullrequestreview-404667728", "createdAt": "2020-05-03T23:23:27Z", "commit": {"oid": "e786dd1d8a45a6b6294602f7579a6bd2f0e2b0f7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoyMzoyN1rOGPwW1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzoyNzoyMlrOGPwYMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3NDEwMQ==", "bodyText": "Remove the System.out.println :)", "url": "https://github.com/hyperledger/besu/pull/828#discussion_r419174101", "createdAt": "2020-05-03T23:23:27Z", "author": {"login": "lucassaldanha"}, "path": "acceptance-tests/tests/src/test/java/org/hyperledger/besu/tests/web3j/privacy/contracts/PrivacyGroupTest.java", "diffHunk": "@@ -131,6 +134,30 @@ public void ensureContractIsNotLockedAfterDeploy() throws Exception {\n     assertThat(privacyGroup.canExecute().send()).isTrue();\n   }\n \n+  @Test\n+  public void ensurePrivacyGroupVersionIsAlwaysDifferent() throws Exception {\n+    privacyGroup\n+        .addParticipants(firstParticipant.raw(), Collections.singletonList(secondParticipant.raw()))\n+        .send();\n+    final byte[] version1 = privacyGroup.getVersion().send();\n+    privacyGroup.lock().send();\n+    privacyGroup\n+        .addParticipants(firstParticipant.raw(), Collections.singletonList(thirdParticipant.raw()))\n+        .send();\n+    final byte[] version2 = privacyGroup.getVersion().send();\n+    privacyGroup.lock().send();\n+    privacyGroup.removeParticipant(firstParticipant.raw(), secondParticipant.raw()).send();\n+    final byte[] version3 = privacyGroup.getVersion().send();\n+\n+    System.out.println(Arrays.toString(version1));\n+    System.out.println(Arrays.toString(version2));\n+    System.out.println(Arrays.toString(version3));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e786dd1d8a45a6b6294602f7579a6bd2f0e2b0f7"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3NDQ0OA==", "bodyText": "Have you tested the impact of this change in web3j and web3js-eea? If they aren't compatible, we need at least to have GIs to update the libraries after we change this.", "url": "https://github.com/hyperledger/besu/pull/828#discussion_r419174448", "createdAt": "2020-05-03T23:27:22Z", "author": {"login": "lucassaldanha"}, "path": "privacy-contracts/src/main/solidity/DefaultOnChainPrivacyGroupManagementContract.sol", "diffHunk": "@@ -4,11 +4,11 @@ import \"./OnChainPrivacyGroupManagementInterface.sol\";\n contract DefaultOnChainPrivacyGroupManagementContract is OnChainPrivacyGroupManagementInterface {\n \n     bool private _canExecute;\n-    int private _version;\n+    bytes32 private _version;\n     bytes32[] private distributionList;\n     mapping(bytes32 => uint256) private distributionIndexOf;\n \n-    function getVersion() external view returns (int) {\n+    function getVersion() external view returns (bytes32) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e786dd1d8a45a6b6294602f7579a6bd2f0e2b0f7"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb4d88e37e7f9d10a4cabbc4d98cc0331be950b1", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/cb4d88e37e7f9d10a4cabbc4d98cc0331be950b1", "committedDate": "2020-05-05T00:37:54Z", "message": "add spdx header\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4b06c34f185ed5079f034f3646879e2d4e36169", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/d4b06c34f185ed5079f034f3646879e2d4e36169", "committedDate": "2020-05-05T01:01:41Z", "message": "Merge branch 'master' into fixOnChainVersion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc1ca327ac8683fa6f205f327203325effccffb0", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/cc1ca327ac8683fa6f205f327203325effccffb0", "committedDate": "2020-05-05T01:07:30Z", "message": "remove System.out\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02ad4beb02fa7efb6c3d86cc7f0f80bc1d5dc59c", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/02ad4beb02fa7efb6c3d86cc7f0f80bc1d5dc59c", "committedDate": "2020-05-05T01:08:54Z", "message": "Merge branch 'fixOnChainVersion' of github.com:pinges/besu into fixOnChainVersion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5529cd5a340e45946f7698d5c2e91e02377d1807", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/5529cd5a340e45946f7698d5c2e91e02377d1807", "committedDate": "2020-05-05T01:24:22Z", "message": "spotless\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bbd45b0d28795fc32a5aedc18892273e3497f9c", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/6bbd45b0d28795fc32a5aedc18892273e3497f9c", "committedDate": "2020-05-05T05:34:57Z", "message": "fix error code\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36da0964f7d7d33701f4e8f08705964307f80ac0", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/36da0964f7d7d33701f4e8f08705964307f80ac0", "committedDate": "2020-05-05T05:49:52Z", "message": "fix error code\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63926f797095cf6d651e4d99d79be97f90f61560", "author": {"user": {"login": "pinges", "name": "Stefan Pingel"}}, "url": "https://github.com/hyperledger/besu/commit/63926f797095cf6d651e4d99d79be97f90f61560", "committedDate": "2020-05-05T05:55:14Z", "message": "fix error code\n\nSigned-off-by: Stefan Pingel <stefan.pingel@consensys.net>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NTA4Njk1", "url": "https://github.com/hyperledger/besu/pull/828#pullrequestreview-405508695", "createdAt": "2020-05-05T05:58:04Z", "commit": {"oid": "63926f797095cf6d651e4d99d79be97f90f61560"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1612, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}