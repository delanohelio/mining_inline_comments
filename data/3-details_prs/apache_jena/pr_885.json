{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM3MDgyNDM4", "number": 885, "title": "Several tickets: JENA-2011 : JENA-2013 :  JENA-2014", "bodyText": "JENA-2011: Fuseki and IPv6 localhost\nJENA-2013: Support xsd:dateTimeStamp values\nJENA-2014: Duration comparison", "createdAt": "2020-12-11T16:11:14Z", "url": "https://github.com/apache/jena/pull/885", "merged": true, "mergeCommit": {"oid": "28dcacc041cc1c4733dadc184bcff1c6766ba000"}, "closed": true, "closedAt": "2020-12-12T11:07:40Z", "author": {"login": "afs"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlF9k6gH2gAyNTM3MDgyNDM4OjE0OTVhZDg4ZWI0ZmE2YWI1MmY3ZTg2NmQxNDhjYzY5OTlhNzAxZTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlafdyAH2gAyNTM3MDgyNDM4OmVmNjdjMzQwNzAxNjkzMzY1NDRlMzc1MDNkZWNjYTZkNTljZmYxNjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1495ad88eb4fa6ab52f7e866d148cc6999a701e0", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/1495ad88eb4fa6ab52f7e866d148cc6999a701e0", "committedDate": "2020-12-11T11:09:13Z", "message": "Remove inactive code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04bae43e5f77778a218639c5d0eb0e6b6740567a", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/04bae43e5f77778a218639c5d0eb0e6b6740567a", "committedDate": "2020-12-11T15:26:14Z", "message": "JENA-2014: Fix for comparing fractional seconds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1967e174200af7a355d6ccd3c01a46f9e26f894c", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/1967e174200af7a355d6ccd3c01a46f9e26f894c", "committedDate": "2020-12-11T15:26:57Z", "message": "JENA-2013: Treat xsd:dateTimeStamp as a derived type of xsd:dateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a254043a14fe916edcfff7c15025f297d986a03f", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/a254043a14fe916edcfff7c15025f297d986a03f", "committedDate": "2020-12-11T16:33:10Z", "message": "JENA-2011: Handle IPv6 localhost address for Jetty"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab6c2200699e585cd621d0950804d68e69aaa6b7", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/ab6c2200699e585cd621d0950804d68e69aaa6b7", "committedDate": "2020-12-11T15:30:21Z", "message": "JENA-2011: Handle IPv6 localhost address for Jetty"}, "afterCommit": {"oid": "a254043a14fe916edcfff7c15025f297d986a03f", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/a254043a14fe916edcfff7c15025f297d986a03f", "committedDate": "2020-12-11T16:33:10Z", "message": "JENA-2011: Handle IPv6 localhost address for Jetty"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwNTMzNDUw", "url": "https://github.com/apache/jena/pull/885#pullrequestreview-550533450", "createdAt": "2020-12-11T19:53:49Z", "commit": {"oid": "a254043a14fe916edcfff7c15025f297d986a03f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxOTo1Mzo1MFrOIEJesw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxOTo1Mzo1MFrOIEJesw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIyMDUzMQ==", "bodyText": "Extra spaces?", "url": "https://github.com/apache/jena/pull/885#discussion_r541220531", "createdAt": "2020-12-11T19:53:50Z", "author": {"login": "kinow"}, "path": "jena-core/src/main/java/org/apache/jena/ext/xerces/jaxp/datatype/DurationImpl.java", "diffHunk": "@@ -832,42 +832,45 @@ public int compare(Duration rhs) {\n \t\t\t\t\t);\n     \t}\n \n-    \t// turn this Duration into a GregorianCalendar\n-    \tGregorianCalendar lhsCalendar = new GregorianCalendar(\n-    \t\t\t1970,\n-\t\t\t\t1,\n-\t\t\t\t1,\n-\t\t\t\t0,\n-\t\t\t\t0,\n-\t\t\t\t0);\n-   \t\tlhsCalendar.add(GregorianCalendar.YEAR, getYears() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.MONTH, getMonths() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, getDays() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, getHours() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.MINUTE, getMinutes() * getSign());\n-   \t\tlhsCalendar.add(GregorianCalendar.SECOND, getSeconds() * getSign());\n-   \t\t\n-   \t\t// turn compare Duration into a GregorianCalendar\n-    \tGregorianCalendar rhsCalendar = new GregorianCalendar(\n-\t\t\t\t1970,\n-\t\t\t\t1,\n-\t\t\t\t1,\n-\t\t\t\t0,\n-\t\t\t\t0,\n-\t\t\t\t0);\n-   \t\trhsCalendar.add(GregorianCalendar.YEAR, rhs.getYears() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.MONTH, rhs.getMonths() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, rhs.getDays() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, rhs.getHours() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.MINUTE, rhs.getMinutes() * rhs.getSign());\n-   \t\trhsCalendar.add(GregorianCalendar.SECOND, rhs.getSeconds() * rhs.getSign());\n-   \t\n-   \t\t\n-   \t\tif (lhsCalendar.equals(rhsCalendar)) {\n-   \t\t\treturn DatatypeConstants.EQUAL;\n-   \t\t}\n-\n-   \t\treturn compareDates(this, rhs);\n+    \tif ( rhsSecondsAsBigDecimal == null || seconds == null ) {\n+    \t    // Jena: change: this only works for durations with no fractional seconds.\n+    \t    // Fix is to only use if no seconds in LHS or RHS.\n+    \t    \n+    \t    // turn this Duration into a GregorianCalendar\n+    \t    GregorianCalendar lhsCalendar = new GregorianCalendar(\n+    \t        1970,\n+    \t        1,\n+    \t        1,\n+    \t        0,\n+    \t        0,\n+    \t        0);\n+    \t    lhsCalendar.add(GregorianCalendar.YEAR, getYears() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.MONTH, getMonths() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, getDays() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, getHours() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.MINUTE, getMinutes() * getSign());\n+    \t    lhsCalendar.add(GregorianCalendar.SECOND, getSeconds() * getSign());\n+\n+    \t    // turn compare Duration into a GregorianCalendar\n+    \t    GregorianCalendar rhsCalendar = new GregorianCalendar(\n+    \t        1970,\n+    \t        1,\n+    \t        1,\n+    \t        0,\n+    \t        0,\n+    \t        0);\n+    \t    rhsCalendar.add(GregorianCalendar.YEAR, rhs.getYears() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.MONTH, rhs.getMonths() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.DAY_OF_YEAR, rhs.getDays() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.HOUR_OF_DAY, rhs.getHours() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.MINUTE, rhs.getMinutes() * rhs.getSign());\n+    \t    rhsCalendar.add(GregorianCalendar.SECOND, rhs.getSeconds() * rhs.getSign());\n+\n+    \t    if (lhsCalendar.equals(rhsCalendar)) {\n+    \t        return DatatypeConstants.EQUAL;\n+    \t    }\n+    \t}\n+   \t\treturn compareDuration(this, rhs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a254043a14fe916edcfff7c15025f297d986a03f"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef67c34070169336544e37503decca6d59cff165", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/ef67c34070169336544e37503decca6d59cff165", "committedDate": "2020-12-12T11:04:20Z", "message": "Fix up tabs/spaces"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2918, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}