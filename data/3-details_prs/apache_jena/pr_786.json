{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMTg3Nzg3", "number": 786, "title": "JENA-1949: Docker tools for Fuseki", "bodyText": "This creates a zip that would be part of a Jena release.\nThe zip file has the Dockerfile/docker-compose.yml and documentation to build locally.\nThe container is based on alpine.\nThe build creates a trimmed down Java11 runtime.\nThe Fuseki container is about 82 Mb.", "createdAt": "2020-08-25T13:00:36Z", "url": "https://github.com/apache/jena/pull/786", "merged": true, "mergeCommit": {"oid": "42aa71953afe795d2287b4961589d8abe9dba06c"}, "closed": true, "closedAt": "2020-09-11T15:22:59Z", "author": {"login": "afs"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEn8XfABqjM3MTUxMTU5OTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdH269tgBqjM3NTY3MzEyNzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff17c2710b7a1e3b12eef0793a01d3cefac5245e", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/ff17c2710b7a1e3b12eef0793a01d3cefac5245e", "committedDate": "2020-08-25T12:53:43Z", "message": "JENA-1949: Docker tools for Fuseki"}, "afterCommit": {"oid": "7aed922faa411d1fac65c2085ad2c3adddbaed48", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/7aed922faa411d1fac65c2085ad2c3adddbaed48", "committedDate": "2020-09-01T14:04:56Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMzAyMjcx", "url": "https://github.com/apache/jena/pull/786#pullrequestreview-481302271", "createdAt": "2020-09-02T21:08:54Z", "commit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMTowODo1NFrOHMH1JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMTowODo1NFrOHMH1JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3MzI1Mg==", "bodyText": "Why not docker-compose up?", "url": "https://github.com/apache/jena/pull/786#discussion_r482473252", "createdAt": "2020-09-02T21:08:54Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/README.md", "diffHunk": "@@ -0,0 +1,96 @@\n+# Apache Jena Fuseki Docker Tools\n+\n+This package contains a Dockerfile, docker-compose file, and helper scripts to\n+create a docker container for Apache Jena Fuseki.\n+\n+The docker container is based on \n+[Fuseki main](https://jena.apache.org/documentation/fuseki2/fuseki-main)\n+for running a SPARQL server.\n+\n+There is no UI - all configuration is by command line and all usage by via the\n+network protocols.\n+\n+Databases can be mounted outside the docker container so they are preserved when\n+the container terminates.\n+\n+This build system allows the user to customize the docker image.\n+\n+The docker build downloads the server binary from \n+[Maven central](https://repo1.maven.org/maven2/org/apache/jena/jena-fuseki-server/),\n+checking the download against the SHA1 checksum.\n+\n+## Database\n+\n+There is a volume mapping \"./databases\" in the current diectory into the server.\n+This can be used to contain databases outside, but accessible to, the container\n+that do not get deleted when the container exits.\n+\n+See examples below.\n+\n+## Build\n+\n+Choose the version number of Apache Jena release you wish to use. This toolkit\n+defaults to the version of the overall Jena release it was part of. It is best\n+to use the release of this set of tools from the same release of the desired\n+server.\n+\n+    docker-compose build --build-arg JENA_VERSION=3.16.0\n+\n+Note the build command must provide the version number.\n+\n+## Run\n+\n+Examples:\n+\n+Start Fuseki with an in-memory, updatable dataset at http://<i>host</i>:3030/ds\n+\n+    docker-compose run --rm --service-ports fuseki --mem /ds\n+\n+Load a TDB2 database, and expose, read-only, via docker:\n+\n+    mkdir -p databases/DB2\n+    tdb2.tdbloader --loc databases/DB2 MyData.ttl\n+    # Publish read-only\n+    docker-compose run --rm --name MyServer --service-ports fuseki --tdb2 --loc databases/DB2 /ds", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMzAzNDYx", "url": "https://github.com/apache/jena/pull/786#pullrequestreview-481303461", "createdAt": "2020-09-02T21:10:49Z", "commit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMToxMDo0OVrOHMH9Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQyMToyODoxN1rOHMI33Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3NTI4Mw==", "bodyText": "What is this doing?", "url": "https://github.com/apache/jena/pull/786#discussion_r482475283", "createdAt": "2020-09-02T21:10:49Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/Dockerfile", "diffHunk": "@@ -0,0 +1,112 @@\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##     http://www.apache.org/licenses/LICENSE-2.0\n+## \n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+\n+## Apache Jena Fuseki server Dockerfile.\n+\n+## This Dockefile builds a reduced footprint container.\n+\n+ARG OPENJDK_VERSION=14\n+ARG ALPINE_VERSION=3.12.0\n+ARG JENA_VERSION=unset\n+\n+# Internal, passed between stages.\n+ARG JAVA_MINIMAL=/opt/java-minimal\n+ARG FUSEKI_DIR=/fuseki\n+ARG FUSEKI_JAR=jena-fuseki-server-${JENA_VERSION}.jar\n+\n+## ---- Stage: Download and build java.\n+FROM openjdk:${OPENJDK_VERSION}-alpine AS base\n+ARG JENA_VERSION\n+ARG JAVA_MINIMAL\n+ARG FUSEKI_DIR\n+ARG FUSEKI_JAR\n+\n+ARG REPO=https://repo1.maven.org/maven2\n+ARG JAR_URL=${REPO}/org/apache/jena/jena-fuseki-server/${JENA_VERSION}/${FUSEKI_JAR}\n+\n+RUN [ \"${JENA_VERSION}\" != \"unset\" ] || { echo -e '\\n**** Set JENA_VERSION ****\\n' ; exit 1 ; }\n+\n+RUN echo && echo \"==== Docker build for Apache Jena Fuseki ${JENA_VERSION} ====\" && echo\n+\n+# Alpine: For objcopy used in jlink\n+RUN apk add --no-cache curl binutils\n+\n+## -- Fuseki installed and runs in /fuseki.\n+WORKDIR $FUSEKI_DIR\n+\n+## -- Download the jar file.\n+COPY download.sh .\n+RUN chmod a+x download.sh\n+\n+RUN ./download.sh --chksum sha1 \"$JAR_URL\"\n+\n+## -- Alternative to download : copy already downloaded.\n+## COPY ${FUSEKI_JAR} .\n+\n+## -- Make reduced Java JDK\n+RUN \\\n+  JDEPS=\"$(jdeps --multi-release base --print-module-deps --ignore-missing-deps ${FUSEKI_JAR})\" && \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3ODcyOA==", "bodyText": "Maybe 2.x would suffice?", "url": "https://github.com/apache/jena/pull/786#discussion_r482478728", "createdAt": "2020-09-02T21:14:49Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/docker-compose.yaml", "diffHunk": "@@ -0,0 +1,30 @@\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '3.0'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ4MDg1NQ==", "bodyText": "Needs to be filled out?", "url": "https://github.com/apache/jena/pull/786#discussion_r482480855", "createdAt": "2020-09-02T21:17:22Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/dist/LICENSE", "diffHunk": "@@ -0,0 +1,202 @@\n+\n+                                 Apache License\n+                           Version 2.0, January 2004\n+                        http://www.apache.org/licenses/\n+\n+   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n+\n+   1. Definitions.\n+\n+      \"License\" shall mean the terms and conditions for use, reproduction,\n+      and distribution as defined by Sections 1 through 9 of this document.\n+\n+      \"Licensor\" shall mean the copyright owner or entity authorized by\n+      the copyright owner that is granting the License.\n+\n+      \"Legal Entity\" shall mean the union of the acting entity and all\n+      other entities that control, are controlled by, or are under common\n+      control with that entity. For the purposes of this definition,\n+      \"control\" means (i) the power, direct or indirect, to cause the\n+      direction or management of such entity, whether by contract or\n+      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n+      outstanding shares, or (iii) beneficial ownership of such entity.\n+\n+      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n+      exercising permissions granted by this License.\n+\n+      \"Source\" form shall mean the preferred form for making modifications,\n+      including but not limited to software source code, documentation\n+      source, and configuration files.\n+\n+      \"Object\" form shall mean any form resulting from mechanical\n+      transformation or translation of a Source form, including but\n+      not limited to compiled object code, generated documentation,\n+      and conversions to other media types.\n+\n+      \"Work\" shall mean the work of authorship, whether in Source or\n+      Object form, made available under the License, as indicated by a\n+      copyright notice that is included in or attached to the work\n+      (an example is provided in the Appendix below).\n+\n+      \"Derivative Works\" shall mean any work, whether in Source or Object\n+      form, that is based on (or derived from) the Work and for which the\n+      editorial revisions, annotations, elaborations, or other modifications\n+      represent, as a whole, an original work of authorship. For the purposes\n+      of this License, Derivative Works shall not include works that remain\n+      separable from, or merely link (or bind by name) to the interfaces of,\n+      the Work and Derivative Works thereof.\n+\n+      \"Contribution\" shall mean any work of authorship, including\n+      the original version of the Work and any modifications or additions\n+      to that Work or Derivative Works thereof, that is intentionally\n+      submitted to Licensor for inclusion in the Work by the copyright owner\n+      or by an individual or Legal Entity authorized to submit on behalf of\n+      the copyright owner. For the purposes of this definition, \"submitted\"\n+      means any form of electronic, verbal, or written communication sent\n+      to the Licensor or its representatives, including but not limited to\n+      communication on electronic mailing lists, source code control systems,\n+      and issue tracking systems that are managed by, or on behalf of, the\n+      Licensor for the purpose of discussing and improving the Work, but\n+      excluding communication that is conspicuously marked or otherwise\n+      designated in writing by the copyright owner as \"Not a Contribution.\"\n+\n+      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n+      on behalf of whom a Contribution has been received by Licensor and\n+      subsequently incorporated within the Work.\n+\n+   2. Grant of Copyright License. Subject to the terms and conditions of\n+      this License, each Contributor hereby grants to You a perpetual,\n+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n+      copyright license to reproduce, prepare Derivative Works of,\n+      publicly display, publicly perform, sublicense, and distribute the\n+      Work and such Derivative Works in Source or Object form.\n+\n+   3. Grant of Patent License. Subject to the terms and conditions of\n+      this License, each Contributor hereby grants to You a perpetual,\n+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n+      (except as stated in this section) patent license to make, have made,\n+      use, offer to sell, sell, import, and otherwise transfer the Work,\n+      where such license applies only to those patent claims licensable\n+      by such Contributor that are necessarily infringed by their\n+      Contribution(s) alone or by combination of their Contribution(s)\n+      with the Work to which such Contribution(s) was submitted. If You\n+      institute patent litigation against any entity (including a\n+      cross-claim or counterclaim in a lawsuit) alleging that the Work\n+      or a Contribution incorporated within the Work constitutes direct\n+      or contributory patent infringement, then any patent licenses\n+      granted to You under this License for that Work shall terminate\n+      as of the date such litigation is filed.\n+\n+   4. Redistribution. You may reproduce and distribute copies of the\n+      Work or Derivative Works thereof in any medium, with or without\n+      modifications, and in Source or Object form, provided that You\n+      meet the following conditions:\n+\n+      (a) You must give any other recipients of the Work or\n+          Derivative Works a copy of this License; and\n+\n+      (b) You must cause any modified files to carry prominent notices\n+          stating that You changed the files; and\n+\n+      (c) You must retain, in the Source form of any Derivative Works\n+          that You distribute, all copyright, patent, trademark, and\n+          attribution notices from the Source form of the Work,\n+          excluding those notices that do not pertain to any part of\n+          the Derivative Works; and\n+\n+      (d) If the Work includes a \"NOTICE\" text file as part of its\n+          distribution, then any Derivative Works that You distribute must\n+          include a readable copy of the attribution notices contained\n+          within such NOTICE file, excluding those notices that do not\n+          pertain to any part of the Derivative Works, in at least one\n+          of the following places: within a NOTICE text file distributed\n+          as part of the Derivative Works; within the Source form or\n+          documentation, if provided along with the Derivative Works; or,\n+          within a display generated by the Derivative Works, if and\n+          wherever such third-party notices normally appear. The contents\n+          of the NOTICE file are for informational purposes only and\n+          do not modify the License. You may add Your own attribution\n+          notices within Derivative Works that You distribute, alongside\n+          or as an addendum to the NOTICE text from the Work, provided\n+          that such additional attribution notices cannot be construed\n+          as modifying the License.\n+\n+      You may add Your own copyright statement to Your modifications and\n+      may provide additional or different license terms and conditions\n+      for use, reproduction, or distribution of Your modifications, or\n+      for any such Derivative Works as a whole, provided Your use,\n+      reproduction, and distribution of the Work otherwise complies with\n+      the conditions stated in this License.\n+\n+   5. Submission of Contributions. Unless You explicitly state otherwise,\n+      any Contribution intentionally submitted for inclusion in the Work\n+      by You to the Licensor shall be under the terms and conditions of\n+      this License, without any additional terms or conditions.\n+      Notwithstanding the above, nothing herein shall supersede or modify\n+      the terms of any separate license agreement you may have executed\n+      with Licensor regarding such Contributions.\n+\n+   6. Trademarks. This License does not grant permission to use the trade\n+      names, trademarks, service marks, or product names of the Licensor,\n+      except as required for reasonable and customary use in describing the\n+      origin of the Work and reproducing the content of the NOTICE file.\n+\n+   7. Disclaimer of Warranty. Unless required by applicable law or\n+      agreed to in writing, Licensor provides the Work (and each\n+      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n+      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n+      implied, including, without limitation, any warranties or conditions\n+      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n+      PARTICULAR PURPOSE. You are solely responsible for determining the\n+      appropriateness of using or redistributing the Work and assume any\n+      risks associated with Your exercise of permissions under this License.\n+\n+   8. Limitation of Liability. In no event and under no legal theory,\n+      whether in tort (including negligence), contract, or otherwise,\n+      unless required by applicable law (such as deliberate and grossly\n+      negligent acts) or agreed to in writing, shall any Contributor be\n+      liable to You for damages, including any direct, indirect, special,\n+      incidental, or consequential damages of any character arising as a\n+      result of this License or out of the use or inability to use the\n+      Work (including but not limited to damages for loss of goodwill,\n+      work stoppage, computer failure or malfunction, or any and all\n+      other commercial damages or losses), even if such Contributor\n+      has been advised of the possibility of such damages.\n+\n+   9. Accepting Warranty or Additional Liability. While redistributing\n+      the Work or Derivative Works thereof, You may choose to offer,\n+      and charge a fee for, acceptance of support, warranty, indemnity,\n+      or other liability obligations and/or rights consistent with this\n+      License. However, in accepting such obligations, You may act only\n+      on Your own behalf and on Your sole responsibility, not on behalf\n+      of any other Contributor, and only if You agree to indemnify,\n+      defend, and hold each Contributor harmless for any liability\n+      incurred by, or claims asserted against, such Contributor by reason\n+      of your accepting any such warranty or additional liability.\n+\n+   END OF TERMS AND CONDITIONS\n+\n+   APPENDIX: How to apply the Apache License to your work.\n+\n+      To apply the Apache License to your work, attach the following\n+      boilerplate notice, with the fields enclosed by brackets \"[]\"\n+      replaced with your own identifying information. (Don't include\n+      the brackets!)  The text should be enclosed in the appropriate\n+      comment syntax for the file format. We also recommend that a\n+      file or class name and description of purpose be included on the\n+      same \"printed page\" as the copyright notice for easier\n+      identification within third-party archives.\n+\n+   Copyright [yyyy] [name of copyright owner]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 190}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ4MTg1Ng==", "bodyText": "diectory => directory", "url": "https://github.com/apache/jena/pull/786#discussion_r482481856", "createdAt": "2020-09-02T21:18:32Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/README.md", "diffHunk": "@@ -0,0 +1,96 @@\n+# Apache Jena Fuseki Docker Tools\n+\n+This package contains a Dockerfile, docker-compose file, and helper scripts to\n+create a docker container for Apache Jena Fuseki.\n+\n+The docker container is based on \n+[Fuseki main](https://jena.apache.org/documentation/fuseki2/fuseki-main)\n+for running a SPARQL server.\n+\n+There is no UI - all configuration is by command line and all usage by via the\n+network protocols.\n+\n+Databases can be mounted outside the docker container so they are preserved when\n+the container terminates.\n+\n+This build system allows the user to customize the docker image.\n+\n+The docker build downloads the server binary from \n+[Maven central](https://repo1.maven.org/maven2/org/apache/jena/jena-fuseki-server/),\n+checking the download against the SHA1 checksum.\n+\n+## Database\n+\n+There is a volume mapping \"./databases\" in the current diectory into the server.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ4Mjk0MQ==", "bodyText": "Remove?", "url": "https://github.com/apache/jena/pull/786#discussion_r482482941", "createdAt": "2020-09-02T21:19:51Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/docker-compose.yaml", "diffHunk": "@@ -0,0 +1,30 @@\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+version: '3.0'\n+services:\n+  fuseki:\n+    build:\n+      context: .\n+      dockerfile: Dockerfile\n+    image: fuseki\n+    ports:\n+      - \"3030:3030\"\n+    volumes:\n+      - ./logs:/fuseki/logs\n+      - ./databases:/fuseki/databases\n+#volumes:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ4NDg5Ng==", "bodyText": "Maybe  ${FUSEKI_DIR}/${FUSEKI_JAR} should be \"${FUSEKI_DIR}/${FUSEKI_JAR}\"? What if there are spaces in the filepaths?", "url": "https://github.com/apache/jena/pull/786#discussion_r482484896", "createdAt": "2020-09-02T21:22:06Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/entrypoint.sh", "diffHunk": "@@ -0,0 +1,5 @@\n+#!/bin/sh\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+\n+## env | sort\n+exec \"$JAVA_HOME/bin/java\" $JAVA_OPTIONS -jar ${FUSEKI_DIR}/${FUSEKI_JAR} \"$@\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ4NTMwOA==", "bodyText": "Maybe more informative message? :)", "url": "https://github.com/apache/jena/pull/786#discussion_r482485308", "createdAt": "2020-09-02T21:22:31Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/download.sh", "diffHunk": "@@ -0,0 +1,148 @@\n+#!/bin/sh\n+\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+ \n+# This is ash/dash script (it uses \"local\"), not a bash script.\n+# It can run in an Alpine image.\n+\n+# The advantage over using docker ADD is that it checks\n+# whether download file is already present and does not download\n+# each time.\n+\n+# Shell script to down load URL and check the checksum\n+\n+USAGE=\"Usage: $(basename \"$0\") --chksum [sha1|sha512] URL\"\n+\n+if [ $# -eq 0 ]\n+then\n+    echo \"$USAGE\" 2>&1\n+    exit 1\n+fi\n+\n+CHKSUM_TYPE='unset'\n+\n+while [ $# -gt 0 ] ; do\n+    case \"$1\" in\n+\t--chksum|-chksum|-sha|--sha)\n+\t    if [ $# -lt 2 ]\n+\t    then\n+\t\techo \"$USAGE\" 1>&2\n+\t\texit 1\n+\t    fi\n+\t    CHKSUM_TYPE=$2\n+\t    shift\n+\t    shift\n+\t    ;;\n+\t-h|--help)\n+\t    echo \"$USAGE\" 1>&2\n+\t    exit 0\n+\t    ;;\n+\t-*)\n+\t    echo \"$USAGE\" 1>&2\n+\t    exit 1\n+\t    ;;\n+\t*)\n+\t    if [ $# -ne 1 ]\n+\t    then\n+\t\techo \"$USAGE\" 1>&2\n+\t\texit 1\n+\t    fi\n+\t    URL=\"$1\"\n+\t    shift\n+\t    ;;\n+    esac\n+done\n+\n+case \"${CHKSUM_TYPE}\" in\n+    unset)\n+\techo \"$USAGE\" 1>&2\n+\texit 1\n+\t;;\n+    sha*|md5) ;;\n+    *)\n+\techo \"Bad checksum type: '$CHKSUM_TYPE' (must start 'sha' or be 'md5')\" 2>&1\n+\texit 1\t \n+\t;;\n+esac\n+\n+## ---- Script starts ----\n+\n+ARTIFACT_URL=\"${URL}\"\n+ARTIFACT_NAME=\"$(basename \"$ARTIFACT_URL\")\"\n+\n+# -------- Checksum details\n+\n+CHKSUM_EXT=\".${CHKSUM_TYPE}\"\n+CHKSUM_URL=\"${ARTIFACT_URL}${CHKSUM_EXT}\"\n+CHKSUM_FILE=\"${ARTIFACT_NAME}${CHKSUM_EXT}\"\n+CHKSUMPROG=\"${CHKSUM_TYPE}sum\"\n+# --------\n+\n+CURL_FETCH_OPTS=\"-sS --fail --location --max-redirs 3\"\n+if false\n+then\n+    echo \"ARTIFACT_URL=$ARTIFACT_URL\"\n+    echo \"CHKSUM_URL=$CHKSUM_URL\"\n+fi\n+\n+download() { # URL\n+    local URL=\"$1\"\n+    local FN=\"$(basename \"$URL\")\"\n+    if [ ! -e \"$FN\" ]\n+    then\n+\techo \"Fetching $URL\"\n+\tcurl $CURL_FETCH_OPTS \"$URL\" --output \"$FN\" \\\n+\t    || { echo \"Bad download of $FN\" 2>&1 ; return 1 ; }\n+    else\n+\techo \"$FN already present\"\n+    fi\n+    return 0\n+}\n+\n+checkChksum() { # Filename checksum\n+    local FN=\"$1\"\n+    local CHKSUM=\"$2\"\n+    if [ ! -e \"$FN\" ]\n+    then\n+\techo \"No such file: '$FN'\" 2>&1\n+\texit 1\n+    fi\n+    # NB Two spaces required for busybox\n+    echo \"$CHKSUM  $FN\" | ${CHKSUMPROG} -c > /dev/null\n+}\n+\n+download \"$ARTIFACT_URL\" || exit 1\n+\n+if [ -z \"$CHKSUM\" ]\n+then\n+    # Checksum not previously set.\n+    # Extract from file, copes with variations in content (filename or not)\n+    download \"$CHKSUM_URL\" || exit 1\n+    CHKSUM=\"$(cut -d' ' -f1 \"$CHKSUM_FILE\")\"\n+fi\n+\n+checkChksum \"${ARTIFACT_NAME}\" \"$CHKSUM\"\n+if [ $? = 0 ]\n+then\n+    echo \"Good download: $ARTIFACT_NAME\"\n+else\n+    echo \"BAD!!!! $ARTIFACT_NAME\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ5MDMzMw==", "bodyText": "Missing a section ## Configuration linking to https://jena.apache.org/documentation/fuseki2/fuseki-configuration.html as well a docker-compose.yml example mounting the config file and changing the command to smth like command: [ \"--config\", \"/fuseki/config.ttl\" ].", "url": "https://github.com/apache/jena/pull/786#discussion_r482490333", "createdAt": "2020-09-02T21:28:17Z", "author": {"login": "namedgraph"}, "path": "jena-fuseki2/jena-fuseki-docker/README.md", "diffHunk": "@@ -0,0 +1,96 @@\n+# Apache Jena Fuseki Docker Tools\n+\n+This package contains a Dockerfile, docker-compose file, and helper scripts to\n+create a docker container for Apache Jena Fuseki.\n+\n+The docker container is based on \n+[Fuseki main](https://jena.apache.org/documentation/fuseki2/fuseki-main)\n+for running a SPARQL server.\n+\n+There is no UI - all configuration is by command line and all usage by via the\n+network protocols.\n+\n+Databases can be mounted outside the docker container so they are preserved when\n+the container terminates.\n+\n+This build system allows the user to customize the docker image.\n+\n+The docker build downloads the server binary from \n+[Maven central](https://repo1.maven.org/maven2/org/apache/jena/jena-fuseki-server/),\n+checking the download against the SHA1 checksum.\n+\n+## Database\n+\n+There is a volume mapping \"./databases\" in the current diectory into the server.\n+This can be used to contain databases outside, but accessible to, the container\n+that do not get deleted when the container exits.\n+\n+See examples below.\n+\n+## Build\n+\n+Choose the version number of Apache Jena release you wish to use. This toolkit\n+defaults to the version of the overall Jena release it was part of. It is best\n+to use the release of this set of tools from the same release of the desired\n+server.\n+\n+    docker-compose build --build-arg JENA_VERSION=3.16.0\n+\n+Note the build command must provide the version number.\n+\n+## Run\n+\n+Examples:\n+\n+Start Fuseki with an in-memory, updatable dataset at http://<i>host</i>:3030/ds\n+\n+    docker-compose run --rm --service-ports fuseki --mem /ds\n+\n+Load a TDB2 database, and expose, read-only, via docker:\n+\n+    mkdir -p databases/DB2\n+    tdb2.tdbloader --loc databases/DB2 MyData.ttl\n+    # Publish read-only\n+    docker-compose run --rm --name MyServer --service-ports fuseki --tdb2 --loc databases/DB2 /ds\n+\n+To allow update on the database, updates are persisted:\n+\n+    docker-compose run --rm --name MyServer --service-ports fuseki --tdb2 --update --loc databases/DB2 /ds\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45"}, "originalPosition": 59}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "52fe35877b009d97b50bbd6bd6950af6c108cd45", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/52fe35877b009d97b50bbd6bd6950af6c108cd45", "committedDate": "2020-09-02T20:00:02Z", "message": "Docker build: use non-root user to run fuseki"}, "afterCommit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/69570053699f2a76ca3fb0718f286358cf3430bb", "committedDate": "2020-09-04T16:13:17Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMzcwMTQ5", "url": "https://github.com/apache/jena/pull/786#pullrequestreview-483370149", "createdAt": "2020-09-07T08:46:18Z", "commit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0NjoxOFrOHN2YcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0NjoxOFrOHN2YcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI4NDUyOA==", "bodyText": "Missing space?\nash/dash script  -> a sh/dash script", "url": "https://github.com/apache/jena/pull/786#discussion_r484284528", "createdAt": "2020-09-07T08:46:18Z", "author": {"login": "rvesse"}, "path": "jena-fuseki2/jena-fuseki-docker/download.sh", "diffHunk": "@@ -0,0 +1,148 @@\n+#!/bin/sh\n+\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+ \n+# This is ash/dash script (it uses \"local\"), not a bash script.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMzcwNDA4", "url": "https://github.com/apache/jena/pull/786#pullrequestreview-483370408", "createdAt": "2020-09-07T08:46:40Z", "commit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0Njo0MFrOHN2ZLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwODo0Njo0MFrOHN2ZLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI4NDcxNg==", "bodyText": "Unnecessary space - down load", "url": "https://github.com/apache/jena/pull/786#discussion_r484284716", "createdAt": "2020-09-07T08:46:40Z", "author": {"login": "rvesse"}, "path": "jena-fuseki2/jena-fuseki-docker/download.sh", "diffHunk": "@@ -0,0 +1,148 @@\n+#!/bin/sh\n+\n+## Licensed under the terms of http://www.apache.org/licenses/LICENSE-2.0\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+ \n+# This is ash/dash script (it uses \"local\"), not a bash script.\n+# It can run in an Alpine image.\n+\n+# The advantage over using docker ADD is that it checks\n+# whether download file is already present and does not download\n+# each time.\n+\n+# Shell script to down load URL and check the checksum", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "69570053699f2a76ca3fb0718f286358cf3430bb", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/69570053699f2a76ca3fb0718f286358cf3430bb", "committedDate": "2020-09-04T16:13:17Z", "message": "JENA-1949: Docker tools for Fuseki"}, "afterCommit": {"oid": "f035056c5a0cd2af5f61ec0bdb5100799a8b9592", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/f035056c5a0cd2af5f61ec0bdb5100799a8b9592", "committedDate": "2020-09-07T13:33:18Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f035056c5a0cd2af5f61ec0bdb5100799a8b9592", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/f035056c5a0cd2af5f61ec0bdb5100799a8b9592", "committedDate": "2020-09-07T13:33:18Z", "message": "JENA-1949: Docker tools for Fuseki"}, "afterCommit": {"oid": "0a78e6145504335cbfd81923644f52242fd5ae9a", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/0a78e6145504335cbfd81923644f52242fd5ae9a", "committedDate": "2020-09-07T13:34:03Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a78e6145504335cbfd81923644f52242fd5ae9a", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/0a78e6145504335cbfd81923644f52242fd5ae9a", "committedDate": "2020-09-07T13:34:03Z", "message": "JENA-1949: Docker tools for Fuseki"}, "afterCommit": {"oid": "252f134f0081013826d1494299a5a553d7687448", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/252f134f0081013826d1494299a5a553d7687448", "committedDate": "2020-09-10T14:40:22Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MzMzNTg1", "url": "https://github.com/apache/jena/pull/786#pullrequestreview-486333585", "createdAt": "2020-09-10T21:47:18Z", "commit": {"oid": "252f134f0081013826d1494299a5a553d7687448"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo0NzoxOFrOHQG5Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMTo0NzoxOFrOHQG5Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1MjE2Mw==", "bodyText": "@afs this was the only part I didn't understand \ud83e\udd13\nADD \"$JAR_URL\" would download the JAR once, when we run docker build ... no? Why is the download.sh necessary?\nI saw the comment in that file about running only once, but I thought ADD $remote-url was also executed once, when building the container from the image?", "url": "https://github.com/apache/jena/pull/786#discussion_r486652163", "createdAt": "2020-09-10T21:47:18Z", "author": {"login": "kinow"}, "path": "jena-fuseki2/jena-fuseki-docker/Dockerfile", "diffHunk": "@@ -0,0 +1,111 @@\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##     http://www.apache.org/licenses/LICENSE-2.0\n+## \n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+\n+## Apache Jena Fuseki server Dockerfile.\n+\n+## This Dockefile builds a reduced footprint container.\n+\n+ARG OPENJDK_VERSION=14\n+ARG ALPINE_VERSION=3.12.0\n+ARG JENA_VERSION=\"\"\n+\n+# Internal, passed between stages.\n+ARG FUSEKI_DIR=/fuseki\n+ARG FUSEKI_JAR=jena-fuseki-server-${JENA_VERSION}.jar\n+ARG JAVA_MINIMAL=/opt/java-minimal\n+\n+## ---- Stage: Download and build java.\n+FROM openjdk:${OPENJDK_VERSION}-alpine AS base\n+\n+ARG JAVA_MINIMAL\n+ARG JENA_VERSION\n+ARG FUSEKI_DIR\n+ARG FUSEKI_JAR\n+ARG REPO=https://repo1.maven.org/maven2\n+ARG JAR_URL=${REPO}/org/apache/jena/jena-fuseki-server/${JENA_VERSION}/${FUSEKI_JAR}\n+\n+RUN [ \"${JENA_VERSION}\" != \"\" ] || { echo -e '\\n**** Set JENA_VERSION ****\\n' ; exit 1 ; }\n+RUN echo && echo \"==== Docker build for Apache Jena Fuseki ${JENA_VERSION} ====\" && echo\n+\n+# Alpine: For objcopy used in jlink\n+RUN apk add --no-cache curl binutils\n+\n+## -- Fuseki installed and runs in /fuseki.\n+WORKDIR $FUSEKI_DIR\n+\n+## -- Download the jar file.\n+COPY download.sh .\n+RUN chmod a+x download.sh\n+\n+RUN ./download.sh --chksum sha1 \"$JAR_URL\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "252f134f0081013826d1494299a5a553d7687448"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb1843eba99c01b5499ed294f664c194d23011ec", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/fb1843eba99c01b5499ed294f664c194d23011ec", "committedDate": "2020-09-11T15:13:44Z", "message": "JENA-1949: Docker tools for Fuseki"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "252f134f0081013826d1494299a5a553d7687448", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/252f134f0081013826d1494299a5a553d7687448", "committedDate": "2020-09-10T14:40:22Z", "message": "JENA-1949: Docker tools for Fuseki"}, "afterCommit": {"oid": "fb1843eba99c01b5499ed294f664c194d23011ec", "author": {"user": {"login": "afs", "name": "Andy Seaborne"}}, "url": "https://github.com/apache/jena/commit/fb1843eba99c01b5499ed294f664c194d23011ec", "committedDate": "2020-09-11T15:13:44Z", "message": "JENA-1949: Docker tools for Fuseki"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2936, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}