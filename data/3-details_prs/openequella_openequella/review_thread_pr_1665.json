{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5ODk3NjE3", "number": 1665, "reviewThreads": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTowOTo1NFrOD3cJlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwMzo1OToxM1rOD4R-tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDU5NDc2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/components/ConfirmDialog.stories.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTowOTo1NFrOGNslbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNDoyMDowNlrOGNvOhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNTE1MQ==", "bodyText": "It looks like the stories don't include a MUI theme provider (e.g. a global decorator in .storybook/preview.ts) so I'm not sure any of these stories include the oEQ MUI theme", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417015151", "createdAt": "2020-04-29T01:09:54Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/components/ConfirmDialog.stories.tsx", "diffHunk": "@@ -5,7 +5,7 @@ import ConfirmDialog from \"../../tsrc/components/ConfirmDialog\";\n \n export default {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA1ODQzNg==", "bodyText": "I don't think oEQ MUI theme is included.\nHi @edalex-ian , do we want to create a ticket for this?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417058436", "createdAt": "2020-04-29T04:20:06Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/components/ConfirmDialog.stories.tsx", "diffHunk": "@@ -5,7 +5,7 @@ import ConfirmDialog from \"../../tsrc/components/ConfirmDialog\";\n \n export default {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNTE1MQ=="}, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYwMzE4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/components/SettingPageTemplate.stories.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxNDo0OFrOGNsqTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxNDo0OFrOGNsqTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNjM5Nw==", "bodyText": "Recommend these be knobs to allow devs to interact with the story and see the effect without needing to change stories.", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417016397", "createdAt": "2020-04-29T01:14:48Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/components/SettingPageTemplate.stories.tsx", "diffHunk": "@@ -0,0 +1,41 @@\n+import * as React from \"react\";\n+import { action } from \"@storybook/addon-actions\";\n+import SettingPageTemplate from \"../../tsrc/components/SettingPageTemplate\";\n+import { Card } from \"@material-ui/core\";\n+\n+export default {\n+  title: \"SettingPageTemplate\",\n+  component: SettingPageTemplate\n+};\n+\n+const onClose = action(\"Close snackbar\");\n+const onSave = action(\"save\");\n+const children = (\n+  <Card>\n+    <h3>SettingPageTemplate Story</h3>\n+  </Card>\n+);\n+\n+export const saveButtonEnabled = () => (\n+  <SettingPageTemplate\n+    onSave={onSave}\n+    saveButtonDisabled={false}\n+    snackbarOpen={false}\n+    preventNavigation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYwNTI3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxNjoxOFrOGNsrdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxNjoxOFrOGNsrdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNjY5NQ==", "bodyText": "module isn't a meaningful name", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417016695", "createdAt": "2020-04-29T01:16:18Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYwOTAwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxODozNFrOGNstcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxODozNFrOGNstcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNzIwMg==", "bodyText": "Recommend this be a function call, otherwise the same mounted component will be used by all the tests, which may cause confusion if one test changes the component state", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417017202", "createdAt": "2020-04-29T01:18:34Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn()\n+  })\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />\n+    </Router>\n+  );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYxMDU1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxOToyNVrOGNsuNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToxOToyNVrOGNsuNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNzM5OA==", "bodyText": "May be better to group the mocks together for readability, there's a mock outside the describe and a spyOn inside the describe.", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417017398", "createdAt": "2020-04-29T01:19:25Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn()\n+  })\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYxMzA4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyMDo1NVrOGNsvlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyMDo1NVrOGNsvlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxNzc0OA==", "bodyText": "This expect doesn't match the it block description, this looks like it belongs in the \"should show ConfirmDialog\" test.\nAnother test could be added to ensure the on unmount logic (window.onbeforeunload = null) is performed.", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417017748", "createdAt": "2020-04-29T01:20:55Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn()\n+  })\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />\n+    </Router>\n+  );\n+\n+  it(\"should call blockNavigationWithBrowser once in the useEffect\", () => {\n+    expect(component.find(ConfirmDialog)).toHaveLength(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYxNjY3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyMjo1NVrOGNsxdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyMjo1NVrOGNsxdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxODIzMA==", "bodyText": "The comment doesn't match what the expect is doing, unless the lack of a h2 element indicates the dialog is closed?\nI'm not sure the not is adding anything here, it could also just be a .toBe(false) or .toBeFalsy()", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417018230", "createdAt": "2020-04-29T01:22:55Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn()\n+  })\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />\n+    </Router>\n+  );\n+\n+  it(\"should call blockNavigationWithBrowser once in the useEffect\", () => {\n+    expect(component.find(ConfirmDialog)).toHaveLength(1);\n+    expect(mockBlockNavigationWithBrowser).toHaveBeenCalledTimes(1);\n+  });\n+\n+  it(\"should show ConfirmDialog when route is going to change\", () => {\n+    // The dialog is closed.\n+    expect(component.exists(\"h2\")).not.toBe(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYyMzUwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/ConfirmDialog.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyNjo0MlrOGNs1Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyNjo0MlrOGNs1Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxOTE1NQ==", "bodyText": "Missing JS doc", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417019155", "createdAt": "2020-04-29T01:26:42Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/ConfirmDialog.tsx", "diffHunk": "@@ -24,8 +25,9 @@ const ConfirmDialog: FunctionComponent<ConfirmDialogProps> = ({\n   children,\n   onCancel,\n   onConfirm,\n+  confirmButtonText", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYyNTEzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyNzo1MFrOGNs2Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMToyNzo1MFrOGNs2Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAxOTM5NA==", "bodyText": "Missing JS doc", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417019394", "createdAt": "2020-04-29T01:27:50Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";\n+import { useEffect, useState } from \"react\";\n+import { Prompt, useHistory } from \"react-router\";\n+import ConfirmDialog from \"./ConfirmDialog\";\n+import { Location } from \"history\";\n+import { commonString } from \"../util/commonstrings\";\n+import { languageStrings } from \"../util/langstrings\";\n+\n+/**\n+ * Prevent navigations triggered by Browsers' behaviours when this's required.\n+ */\n+export const blockNavigationWithBrowser = (preventNavigation: boolean) => {\n+  window.onbeforeunload = () => {\n+    if (preventNavigation) {\n+      return true;\n+    }\n+    return;\n+  };\n+};\n+\n+interface Props {\n+  /**\n+   * A condition when navigation should be prevented.\n+   */\n+  when: boolean;\n+}\n+\n+export const NavigationGuard = ({ when }: Props) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYyOTY3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/SettingPageTemplate.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozMDo1NFrOGNs4yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozMDo1NFrOGNs4yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMDEwNg==", "bodyText": "This save button and styling be better refactored out to a dedicated component, unless it's SettingsPage specific?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417020106", "createdAt": "2020-04-29T01:30:54Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/SettingPageTemplate.tsx", "diffHunk": "@@ -0,0 +1,94 @@\n+import * as React from \"react\";\n+import { ReactNode } from \"react\";\n+import { Button } from \"@material-ui/core\";\n+import { Save } from \"@material-ui/icons\";\n+import { commonString } from \"../util/commonstrings\";\n+import MessageInfo from \"./MessageInfo\";\n+import { makeStyles } from \"@material-ui/core/styles\";\n+import { NavigationGuard } from \"./NavigationGuard\";\n+\n+const useStyles = makeStyles({\n+  floatingButton: {\n+    position: \"fixed\",\n+    top: 0,\n+    right: 0,\n+    marginTop: \"80px\",\n+    marginRight: \"16px\",\n+    width: \"calc(25% - 112px)\"\n+  }\n+});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYzMjE0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozMjoxMlrOGNs6Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozMjoxMlrOGNs6Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMDQ1OQ==", "bodyText": "Spelling mistake for handle", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417020459", "createdAt": "2020-04-29T01:32:12Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";\n+import { useEffect, useState } from \"react\";\n+import { Prompt, useHistory } from \"react-router\";\n+import ConfirmDialog from \"./ConfirmDialog\";\n+import { Location } from \"history\";\n+import { commonString } from \"../util/commonstrings\";\n+import { languageStrings } from \"../util/langstrings\";\n+\n+/**\n+ * Prevent navigations triggered by Browsers' behaviours when this's required.\n+ */\n+export const blockNavigationWithBrowser = (preventNavigation: boolean) => {\n+  window.onbeforeunload = () => {\n+    if (preventNavigation) {\n+      return true;\n+    }\n+    return;\n+  };\n+};\n+\n+interface Props {\n+  /**\n+   * A condition when navigation should be prevented.\n+   */\n+  when: boolean;\n+}\n+\n+export const NavigationGuard = ({ when }: Props) => {\n+  const history = useHistory();\n+  const { message, title } = languageStrings.navigationguard;\n+\n+  const [showPrompt, setShowPrompt] = useState(false);\n+  const [confirmedNavigation, setConfirmedNavigation] = useState(false);\n+  const [navigateTo, setNavigateTo] = useState<Location>();\n+\n+  /**\n+   * Navigate to other pages, depending on if user confirms and next location.\n+   */\n+  useEffect(() => {\n+    if (confirmedNavigation && navigateTo) {\n+      history.push(navigateTo.pathname);\n+    }\n+  }, [confirmedNavigation, navigateTo]);\n+\n+  /**\n+   * Handle 'beforeunload' event when preventing navigation is required.\n+   * Do not handel this event when this component will unmount.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDYzNjAzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/cloudprovider/CloudProviderListPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozNTowN1rOGNs8hQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozNTowN1rOGNs8hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMTA2MQ==", "bodyText": "Mixing patterns, there's onClick handlers that have () =>  versus _ =>", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417021061", "createdAt": "2020-04-29T01:35:07Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/cloudprovider/CloudProviderListPage.tsx", "diffHunk": "@@ -203,7 +204,7 @@ class CloudProviderListPage extends React.Component<\n                 {cloudProvider.description} -{\" \"}\n                 <a\n                   href=\"javascript:void\"\n-                  onClick={(_) => this.refreshProvider(cloudProvider)}\n+                  onClick={_ => this.refreshProvider(cloudProvider)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a0db7668c7901ae88afb5c39cd9ee26a56171d"}, "originalPosition": 134}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY0MTA3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTozODoyN1rOGNs_bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzoyMTo1MVrOGNyoEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMTgwNA==", "bodyText": "Has there been any discussions about organising/grouping the components?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417021804", "createdAt": "2020-04-29T01:38:27Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEwNjMwMQ==", "bodyText": "Nope, not yet. So far components pretty well holds all the general use ones, and then more specific ones are in related directories.", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417106301", "createdAt": "2020-04-29T07:04:46Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMTgwNA=="}, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzExNDEzMA==", "bodyText": "I have not got involved in any discussion about this. Maybe @edalex-ian  had?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417114130", "createdAt": "2020-04-29T07:21:51Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMTgwNA=="}, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY1NDk4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo0Njo0M1rOGNtHIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo0Njo0M1rOGNtHIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMzc3Nw==", "bodyText": "This may cause an exception if the h2 does not exist.\nI pulled down the repo and it doesn't look like this expect block is being evaluated (e.g. changed the toBe to be random text and test still passes).", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417023777", "createdAt": "2020-04-29T01:46:43Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn(),\n+  }),\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />\n+    </Router>\n+  );\n+\n+  it(\"should call blockNavigationWithBrowser once in the useEffect\", () => {\n+    expect(component.find(ConfirmDialog)).toHaveLength(1);\n+    expect(mockBlockNavigationWithBrowser).toHaveBeenCalledTimes(1);\n+  });\n+\n+  it(\"should show ConfirmDialog when route is going to change\", () => {\n+    // The dialog is closed.\n+    expect(component.exists(\"h2\")).not.toBe(true);\n+\n+    // The dialog is open when route change event is triggered.\n+    history.listen(() => {\n+      expect(component.find(\"h2\").text()).toBe(\"Close without saving?\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY1NTc5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/ConfirmDialog.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo0NzowNVrOGNtHig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo0NzowNVrOGNtHig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyMzg4Mg==", "bodyText": "Missing JS docs", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417023882", "createdAt": "2020-04-29T01:47:05Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/ConfirmDialog.tsx", "diffHunk": "@@ -16,6 +16,7 @@ interface ConfirmDialogProps {\n   children?: ReactNode;\n   onConfirm: () => void;\n   onCancel: () => void;\n+  confirmButtonText: string;\n }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY2NTAzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/searchfilter/SearchFilterSettingsPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo1Mjo0MlrOGNtMoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo1Mjo0MlrOGNtMoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyNTE4NA==", "bodyText": "I'm not seeing a huge value in these comments as the name of the component below provides a good name of what it is.  The usage of these comments are also inconsistent, occasionally they're not prevent (e.g. for the MessageDialog below this)", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417025184", "createdAt": "2020-04-29T01:52:42Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/searchfilter/SearchFilterSettingsPage.tsx", "diffHunk": "@@ -354,7 +348,6 @@ const SearchFilterPage = ({ updateTemplate }: TemplateUpdateProps) => {\n           </IconButton>\n         </CardActions>\n       </Card>\n-\n       {/* MIME type filter dialog */}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY3NTI0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo1OTowMlrOGNtSVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMTo1OTowMlrOGNtSVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyNjY0Nw==", "bodyText": "There are multiple useEffects, it may be better to phrase it once when the component first mounts", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417026647", "createdAt": "2020-04-29T01:59:02Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn(),\n+  }),\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />\n+    </Router>\n+  );\n+\n+  it(\"should call blockNavigationWithBrowser once in the useEffect\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NDY4MTQwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMjowMjo0OFrOGNtVpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwMjowMjo0OFrOGNtVpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzAyNzQ5Mw==", "bodyText": "There's no test for when is false?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417027493", "createdAt": "2020-04-29T02:02:48Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/NavigationGuard.test.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import * as module from \"../../../tsrc/components/NavigationGuard\";\n+import { Router } from \"react-router\";\n+import * as historyModule from \"history\";\n+import { act } from \"react-dom/test-utils\";\n+import ConfirmDialog from \"../../../tsrc/components/ConfirmDialog\";\n+\n+/**\n+ * Need to mock the react-router context and function 'push'.\n+ */\n+jest.mock(\"react-router-dom\", () => ({\n+  useHistory: () => ({\n+    push: jest.fn(),\n+  }),\n+}));\n+\n+describe(\"<NavigationGuard />\", () => {\n+  const history = historyModule.createMemoryHistory();\n+  const mockBlockNavigationWithBrowser = jest.spyOn(\n+    module,\n+    \"blockNavigationWithBrowser\"\n+  );\n+  const component = mount(\n+    <Router history={history}>\n+      <module.NavigationGuard when />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NTI0ODMwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowOTo0N1rOGNyShQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwNzowOTo0N1rOGNyShQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzEwODYxMw==", "bodyText": "The JS doc says 'a condition', but true/false doesn't seem to capture a condition to me - as I'd expect it to be somewhat dynamic. Down below I see this is being passed around as a Location... Something seems out of wack here.", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417108613", "createdAt": "2020-04-29T07:09:47Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/NavigationGuard.tsx", "diffHunk": "@@ -0,0 +1,92 @@\n+import * as React from \"react\";\n+import { useEffect, useState } from \"react\";\n+import { Prompt, useHistory } from \"react-router\";\n+import ConfirmDialog from \"./ConfirmDialog\";\n+import { Location } from \"history\";\n+import { commonString } from \"../util/commonstrings\";\n+import { languageStrings } from \"../util/langstrings\";\n+\n+/**\n+ * Prevent navigations triggered by Browsers' behaviours when this's required.\n+ */\n+export const blockNavigationWithBrowser = (preventNavigation: boolean) => {\n+  window.onbeforeunload = () => {\n+    if (preventNavigation) {\n+      return true;\n+    }\n+    return;\n+  };\n+};\n+\n+interface Props {\n+  /**\n+   * A condition when navigation should be prevented.\n+   */\n+  when: boolean;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e81e7a8e04047f7063f236258deb2c0c3bf558ab"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5OTYxMTgzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/SearchPageSettings.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQwNzowODo0MFrOGOcdZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQwNzowODo0MFrOGOcdZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzc5OTUyNw==", "bodyText": "I think shallowEqual is fine because the structure of SearchSettings is simple (no nested objects).", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r417799527", "createdAt": "2020-04-30T07:08:40Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/SearchPageSettings.tsx", "diffHunk": "@@ -48,27 +48,49 @@ function SearchPageSettings({ updateTemplate }: TemplateUpdateProps) {\n   const [cloudSettings, setCloudSettings] = React.useState<CloudSettings>({\n     disabled: false,\n   });\n+\n+  const [initialSearchSettings, setInitialSearchSettings] = React.useState<\n+    SearchSettings\n+  >(defaultSearchSettings);\n+  const [initialCloudSettings, setInitialCloudSettings] = React.useState<\n+    CloudSettings\n+  >({\n+    disabled: false,\n+  });\n+\n   const [showError, setShowError] = React.useState<boolean>(false);\n   const [showSuccess, setShowSuccess] = React.useState<boolean>(false);\n \n   const searchPageSettingsStrings =\n     languageStrings.settings.searching.searchPageSettings;\n   const classes = useStyles();\n \n+  const changesUnsaved =\n+    initialCloudSettings.disabled !== cloudSettings.disabled ||\n+    !shallowEqual(searchSettings, initialSearchSettings);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66f044f13ca4547a03317bd11e703a6a97778b65"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMzQxNDI5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/SaveButton.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwMzo1OToxM1rOGPBgRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwMzo1OToxM1rOGPBgRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQwNjQ3MQ==", "bodyText": "A lot of these styles are dependent on where it's used. We can't really say this is a generic component if we put this in here. Maybe it's up to the parent to style it for that specific context. But at that point, do we need this as a common component?", "url": "https://github.com/openequella/openEQUELLA/pull/1665#discussion_r418406471", "createdAt": "2020-05-01T03:59:13Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/SaveButton.tsx", "diffHunk": "@@ -0,0 +1,47 @@\n+import * as React from \"react\";\n+import { Button, makeStyles } from \"@material-ui/core\";\n+import { commonString } from \"../util/commonstrings\";\n+import { Save } from \"@material-ui/icons\";\n+\n+const useStyles = makeStyles({\n+  floatingButton: {\n+    position: \"fixed\",\n+    top: 0,\n+    right: 0,\n+    marginTop: \"80px\",\n+    marginRight: \"16px\",\n+    width: \"calc(25% - 112px)\",\n+  },\n+});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40682b8948f35f5d982864f631401caaf6adb7d6"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1404, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}