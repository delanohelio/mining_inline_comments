{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NjQ5NTE5", "number": 1896, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo1OToxNVrOEHafnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NTowMVrOEHy2vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjA5NTY3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo1OToxNVrOGmwnVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTozMDoxOVrOGmyYFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTU3NA==", "bodyText": "I'm confused - I thought we weren't supposed to refer to the rest-api-client directly, it should be through the module?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295574", "createdAt": "2020-06-22T02:59:15Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjgyMg==", "bodyText": "Or does that not apply to simply evaluating types?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296822", "createdAt": "2020-06-22T03:06:08Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTU3NA=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMxNDc2NA==", "bodyText": "I think we can reuse these interfaces. We use modules because we may need to do some checks before calling the function in some cases. So the module is the best place to do these checks.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443314764", "createdAt": "2020-06-22T04:46:03Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTU3NA=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNDQzOA==", "bodyText": "Yup, for the types it is fine. It should act as the authoritative source for the raw oEQ types. Now and then the various Modules might choose to have their own representation to better fit the domain, and that's fine too.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443324438", "createdAt": "2020-06-22T05:30:19Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTU3NA=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjA5NjM5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo1OTo1NlrOGmwn2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo1OTo1NlrOGmwn2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTcwNQ==", "bodyText": "The first sentence of this comment (up to and including the colon) can be omitted.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295705", "createdAt": "2020-06-22T02:59:56Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjA5ODIzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowMToxOFrOGmwo5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTozMTowOVrOGmyY0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTk3Mg==", "bodyText": "Perhaps have an @see pointing towards SearchParams for this one?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295972", "createdAt": "2020-06-22T03:01:18Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMxOTg0OQ==", "bodyText": "I tried   @param params Search crierial, also see {@link OEQ.Search.SearchParams } but IDE can't resolve Search.SearchParams from namespace OEQ \ud83e\udd14", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443319849", "createdAt": "2020-06-22T05:10:34Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTk3Mg=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNDYyNA==", "bodyText": "Ahh well, in that case it's okay as you can still see the type on the function signature and find out more from there.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443324624", "createdAt": "2020-06-22T05:31:09Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTk3Mg=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 78}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjA5OTQ1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowMjoyMVrOGmwprA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMDoxNzowMVrOGnVCGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjE3Mg==", "bodyText": "Is there a way to do this redirect with Router rather than window.location?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296172", "createdAt": "2020-06-22T03:02:21Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMxMzgyMw==", "bodyText": "I guess we can't do that at the moment because we don't have a route for this specific URL and a react component for ItemSummary page.\nBut maybe we can try hook useHistory to do ?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443313823", "createdAt": "2020-06-22T04:41:00Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjE3Mg=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNTE1Nw==", "bodyText": "Yeah, it's an interesting this one - as will be the attachments - as it's where we still need to straddle over into the Legacy UI. \ud83e\udd14\nYes, maybe the useHistory hook could be the goer for now.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443325157", "createdAt": "2020-06-22T05:33:43Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjE3Mg=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg5MjI1MA==", "bodyText": "I just had a talk with Tom. A better way could be to tweak SearchResult to make it be a hyperlink.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443892250", "createdAt": "2020-06-23T00:17:01Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjE3Mg=="}, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjEwMTI4OnYy", "diffSide": "RIGHT", "path": "oeq-ts-rest-api/src/Search.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowMzo1N1rOGmwqzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowMzo1N1rOGmwqzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjQ2MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this attachment.\n          \n          \n            \n                 * The URL for viewing this attachment.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296461", "createdAt": "2020-06-22T03:03:57Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -124,7 +124,16 @@ export interface Attachment {\n   /**\n    * Links to the attachment.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this attachment.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjEwMTYxOnYy", "diffSide": "RIGHT", "path": "oeq-ts-rest-api/src/Search.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNDoxNVrOGmwq_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNDoxNVrOGmwq_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjUwOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this attachment's thumbnail.\n          \n          \n            \n                 * The URL for viewing this attachment's thumbnail.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296509", "createdAt": "2020-06-22T03:04:15Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -124,7 +124,16 @@ export interface Attachment {\n   /**\n    * Links to the attachment.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this attachment.\n+     */\n+    view: string;\n+    /**\n+     * The URL of viewing this attachment's thumbnail.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjEwMTk1OnYy", "diffSide": "RIGHT", "path": "oeq-ts-rest-api/src/Search.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNDozM1rOGmwrKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNDozM1rOGmwrKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjU1NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this item.\n          \n          \n            \n                 * The URL for viewing this item.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296555", "createdAt": "2020-06-22T03:04:33Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -182,7 +191,16 @@ export interface SearchResultItem {\n   /**\n    * Links to an item.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this item.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjEwMjY2OnYy", "diffSide": "RIGHT", "path": "oeq-ts-rest-api/src/Search.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNTowM1rOGmwrlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNTowM1rOGmwrlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjY2MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The REST API path used to get details of this item.\n          \n          \n            \n                 * The REST API path used to get this item's details.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296660", "createdAt": "2020-06-22T03:05:03Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -182,7 +191,16 @@ export interface SearchResultItem {\n   /**\n    * Links to an item.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this item.\n+     */\n+    view: string;\n+    /**\n+     * The REST API path used to get details of this item.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjI4MzUxOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTozMDoyMlrOGmyYJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTozMDoyMlrOGmyYJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNDQ1Mw==", "bodyText": "Good pickup here \ud83d\udc4d , I thought i had added keys to all of the ListItem components, but must've missed this one", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443324453", "createdAt": "2020-06-22T05:30:22Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -158,9 +158,9 @@ export default function SearchResult({\n   );\n \n   const customDisplayMetadata = displayFields.map(\n-    (element: OEQ.Search.DisplayFields) => {\n+    (element: OEQ.Search.DisplayFields, index: number) => {\n       return (\n-        <ListItem disableGutters dense>\n+        <ListItem disableGutters dense key={element.name + index}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MjMxMzY1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTo0OTo0NFrOGmyqiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMDozMDo0MFrOGnVQvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyOTE2MA==", "bodyText": "Should we make it so the SearchResults takes up the full width of the page when there is no refine search panel? Probably something to address once we implement the refine search panel component.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443329160", "createdAt": "2020-06-22T05:49:44Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,101 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}\n+        />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />\n+          </IconButton>\n+          <TextField />\n+        </Card>\n+      </Grid>\n+\n+      <Grid item xs={9}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMzMDgwOA==", "bodyText": "Yeah, true, we could conditionally do that. For now I guess this is just a nice default while we lay things out. But I guess it's especially in the case of selection sessions we wont have a refine search panel?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443330808", "createdAt": "2020-06-22T05:55:50Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,101 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}\n+        />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />\n+          </IconButton>\n+          <TextField />\n+        </Card>\n+      </Grid>\n+\n+      <Grid item xs={9}>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyOTE2MA=="}, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzg5NTk5OA==", "bodyText": "Yeah, mainly for selection sessions. But also in the regular ui, when the horizontal screen size goes below a certain level.\nEither way, it makes sense to revisit this when we get to actually implementing the refine panel component", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443895998", "createdAt": "2020-06-23T00:30:40Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,101 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}\n+        />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />\n+          </IconButton>\n+          <TextField />\n+        </Card>\n+      </Grid>\n+\n+      <Grid item xs={9}>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyOTE2MA=="}, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjA4NjU2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NDo0NFrOGnXgiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NDo0NFrOGnXgiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMjgwOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <SearchIcon fontSize={\"large\"} />\n          \n          \n            \n                        <SearchIcon fontSize=\"large\" />", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443932808", "createdAt": "2020-06-23T02:54:44Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,98 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult {...item} />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "originalPosition": 117}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjA4NzAxOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NTowMVrOGnXg0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NTowMVrOGnXg0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMjg4MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <Grid container direction={\"column\"} spacing={2}>\n          \n          \n            \n                <Grid container direction=\"column\" spacing={2}>", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443932880", "createdAt": "2020-06-23T02:55:01Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,98 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult {...item} />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "originalPosition": 113}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1318, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}