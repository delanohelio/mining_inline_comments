{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MDExNjMz", "number": 1541, "title": "Feature/convert purs to tsx for setting menu", "bodyText": "#1337\nChecklist\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n\nDescription of change\nRewrite the Setting Menu and UI Setting Editor in Typescript.", "createdAt": "2020-03-16T06:17:15Z", "url": "https://github.com/openequella/openEQUELLA/pull/1541", "merged": true, "mergeCommit": {"oid": "a62ace17d6d3dfc6b57a46364f75363aa1f89021"}, "closed": true, "closedAt": "2020-03-20T03:35:46Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOF9LNAH2gAyMzg5MDExNjMzOjE0MDcxZGY2MzliZmIwMDQzYmEzMmE4YjBlOTAwMjNiZmIyYmMxNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPUUBZgFqTM3ODE1NTYwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "14071df639bfb0043ba32a8b0e90023bfb2bc179", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/14071df639bfb0043ba32a8b0e90023bfb2bc179", "committedDate": "2020-03-16T03:57:22Z", "message": "Rewrite the Setting Menu and UI Setting Editor in Typescript"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9efd82169998b828769cdf08c71cda974fe8ace", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/b9efd82169998b828769cdf08c71cda974fe8ace", "committedDate": "2020-03-16T04:14:36Z", "message": "Use the new TS components instead of the bridge to Purs components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8809bc1c8eb7edefb6a881e5306640ed0c2e55b", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/a8809bc1c8eb7edefb6a881e5306640ed0c2e55b", "committedDate": "2020-03-16T04:30:13Z", "message": "Remove 'Settings.purs', 'SettingsPage.purs', 'UISettings.purs'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/05b3780b6a1bcf4464fc2e78c406260d4e681670", "committedDate": "2020-03-16T06:08:06Z", "message": "Add error handling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Mzg1MTc1", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-375385175", "createdAt": "2020-03-16T16:33:52Z", "commit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNjozMzo1MlrOF28ShA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNjozOTo1MVrOF28hzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1NTIwNA==", "bodyText": "Since TS is going to compile this down to ES5 would there be any issues setting this to support all features up to ES2020?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \"lib\": [\"es6\", \"dom\", \"es2018.promise\"],\n          \n          \n            \n                \"lib\": [\"es2020\", \"dom\"],", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393155204", "createdAt": "2020-03-16T16:33:52Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsconfig.json", "diffHunk": "@@ -3,7 +3,7 @@\n     \"outDir\": \"target/ts\",\n     \"module\": \"CommonJS\",\n     \"target\": \"es5\",\n-    \"lib\": [\"es6\", \"dom\"],\n+    \"lib\": [\"es6\", \"dom\", \"es2018.promise\"],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1NTQ4Nw==", "bodyText": "for consistency\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      <SettingsPage refreshUser={() => {}} updateTemplate={_ => {}} />\n          \n          \n            \n                      <SettingsPage refreshUser={() => {}} updateTemplate={() => {}} />", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393155487", "createdAt": "2020-03-16T16:34:16Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/index.tsx", "diffHunk": "@@ -245,10 +243,7 @@ export default function() {\n     ReactDOM.render(\n       <BrowserRouter basename={basePath} forceRefresh>\n         <ThemeProvider theme={oeqTheme}>\n-          <bridge.SettingsPage\n-            refreshUser={() => {}}\n-            updateTemplate={_ => {}}\n-          />\n+          <SettingsPage refreshUser={() => {}} updateTemplate={_ => {}} />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1OTExNw==", "bodyText": "could forEach be replaced with a map?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                SETTING_CATEGORIES.forEach(category => {\n          \n          \n            \n                  const settingsOfCategory = settings\n          \n          \n            \n                    .filter(setting => setting.group === category.id)\n          \n          \n            \n                    .sort((s1, s2) => {\n          \n          \n            \n                      return s1.name > s2.name ? 1 : -1;\n          \n          \n            \n                    });\n          \n          \n            \n                  groups.push({ category: category, settings: settingsOfCategory });\n          \n          \n            \n                });\n          \n          \n            \n                return SETTING_CATEGORIES.map(category => {\n          \n          \n            \n                  const settingsOfCategory = settings\n          \n          \n            \n                    .filter(setting => setting.group === category.id)\n          \n          \n            \n                    .sort((s1, s2) => {\n          \n          \n            \n                      return s1.name > s2.name ? 1 : -1;\n          \n          \n            \n                    });\n          \n          \n            \n                  return { category: category, settings: settingsOfCategory };\n          \n          \n            \n                });", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393159117", "createdAt": "2020-03-16T16:39:51Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 117}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c", "committedDate": "2020-03-16T21:44:39Z", "message": "Merge branch 'component/search_configuration' into feature/convert-purs-to-tsx-for-setting-menu"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjMyMTcy", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-375632172", "createdAt": "2020-03-16T22:45:25Z", "commit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMjo0NToyNVrOF3IPfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMjo1ODozNFrOF3IfiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1MTAzNw==", "bodyText": "Can we just use 'type' here because 'SettingCategory' and 'SettingGroup' probably do not need inheritance and other abilities of 'interface' ?", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393351037", "createdAt": "2020-03-16T22:45:25Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1MjY3OQ==", "bodyText": "Help wanted !\nHad a short discussion with Tom regarding the usage of this boolean flag. The intention is to avoid the warning:\nCan only update a mounted or mounting component. This usually means you called setState, replaceState, or forceUpdate on an unmounted component. This is a no-op.\nIt seems a lot developers have accepted this approach, but I wonder if we have any better approaches.", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393352679", "createdAt": "2020-03-16T22:50:46Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1NTE0NA==", "bodyText": "I remember we had short discussions about the generic error handling in oEQ. This one looks generic but there is only one usage.\n\n  \n    \n      openEQUELLA/Source/Plugins/Core/com.equella.core/js/tsrc/components/index.ts\n    \n    \n         Line 10\n      in\n      903ca6b\n    \n    \n    \n    \n\n        \n          \n           export function handleUnexpectedApiError<P extends TemplateUpdateProps>({", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393355144", "createdAt": "2020-03-16T22:58:34Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 93}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjMxODU0", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-375631854", "createdAt": "2020-03-16T22:44:36Z", "commit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "state": "COMMENTED", "comments": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMjo0NDozNlrOF3IOdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDoyNzo1MVrOF3KIAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1MDc3NQ==", "bodyText": "May be worth just destructing the properties in the signature, saves the pattern of const {a,b} = props being repeated through the app.\nconst SettingsPage = ({ refreshUser, updateTemplate} = SettingsPageProps) => {", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393350775", "createdAt": "2020-03-16T22:44:36Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1MTMyMw==", "bodyText": "If this is immutable then may be better have it declared outside the component body as it doesn't need to be re-evaluated ever", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393351323", "createdAt": "2020-03-16T22:46:19Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1Mjk0OQ==", "bodyText": "I remember discussing this, it's interesting how it works and may be worth adding an inline comment to highlight it's to stop the setting state when component is being unmounted as it may get confused with a cancel token which it isn't.\nMay be worth discussing whether bringing in cancel tokens is a good pattern, as it'll cater for cancelling background API calls that won't be needed anymore, it may have covered preventing interacting with state when component is unmounting.", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393352949", "createdAt": "2020-03-16T22:51:28Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1MzM1Mg==", "bodyText": "This has shown up a few times, a single function should be able to cover this (even if it does the same thing behind the scenes)", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393353352", "createdAt": "2020-03-16T22:52:54Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1Mzc3Nw==", "bodyText": "Agreed, map is cleaner than pushing to an array", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393353777", "createdAt": "2020-03-16T22:54:18Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1OTExNw=="}, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM1ODE0OQ==", "bodyText": "Personal preference, can this be function be moved outside of the component? (either a file or outside the component body) as it\n\nmakes the component body heavier\nwould be difficult to write a jest test for", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393358149", "createdAt": "2020-03-16T23:04:00Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2MDc0MA==", "bodyText": "If using typescript 3.7+ or ES2020, it may be time to start using the optional chaining.  E.g. settings?.map\nIf no other functionality is needed in the map then the return can be immediate:\n{settings?.map(setting => (<ListItem key={setting.id}>\n    <ListItemText\n      primary={settingLink(setting)}\n      secondary={setting.description}\n    />\n  </ListItem>))};", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393360740", "createdAt": "2020-03-16T23:08:42Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 136}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2MTY4Mw==", "bodyText": "Has there been any use of the Link component from Material UI?  It creates the same anchor but caters for styling from the MUI theme", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393361683", "createdAt": "2020-03-16T23:11:50Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {\n+                return (\n+                  <ListItem key={setting.id}>\n+                    <ListItemText\n+                      primary={settingLink(setting)}\n+                      secondary={setting.description}\n+                    />\n+                  </ListItem>\n+                );\n+              })}\n+          </List>\n+        </ExpansionPanelDetails>\n+      );\n+    }\n+  };\n+\n+  // Create a link for each setting\n+  const settingLink = (setting: GeneralSetting): ReactElement => {\n+    let link = <div />;\n+    if (setting.links.route) {\n+      link = <Link to={setting.links.route}>{setting.name}</Link>;\n+    } else if (setting.links.href) {\n+      link = <a href={setting.links.href}>{setting.name}</a>;\n+    } else if (setting.id === \"adminconsole\") {\n+      link = (\n+        <a href=\"javascript:void(0)\" onClick={() => setAdminDialogOpen(true)}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 161}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2MjY0Mg==", "bodyText": "Else isn't needed, there's a return in the if", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393362642", "createdAt": "2020-03-16T23:15:01Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NDIwOQ==", "bodyText": "Is this div required?", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393364209", "createdAt": "2020-03-16T23:20:10Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {\n+                return (\n+                  <ListItem key={setting.id}>\n+                    <ListItemText\n+                      primary={settingLink(setting)}\n+                      secondary={setting.description}\n+                    />\n+                  </ListItem>\n+                );\n+              })}\n+          </List>\n+        </ExpansionPanelDetails>\n+      );\n+    }\n+  };\n+\n+  // Create a link for each setting\n+  const settingLink = (setting: GeneralSetting): ReactElement => {\n+    let link = <div />;\n+    if (setting.links.route) {\n+      link = <Link to={setting.links.route}>{setting.name}</Link>;\n+    } else if (setting.links.href) {\n+      link = <a href={setting.links.href}>{setting.name}</a>;\n+    } else if (setting.id === \"adminconsole\") {\n+      link = (\n+        <a href=\"javascript:void(0)\" onClick={() => setAdminDialogOpen(true)}>\n+          {setting.name}\n+        </a>\n+      );\n+    }\n+\n+    return link;\n+  };\n+\n+  return (\n+    <div id=\"settingsPage\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NDkxNQ==", "bodyText": "Should \"ui\" be a constant?  I don't know if it'll be used more than once", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393364915", "createdAt": "2020-03-16T23:22:52Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 127}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NDk5OA==", "bodyText": "Can switch this to a jsdoc", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393364998", "createdAt": "2020-03-16T23:23:07Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2ODM1Ng==", "bodyText": "Can settings be undefined?  The interface has the array as always being defined.\nNot suggesting, as it makes the code harder to read but the signature can be tweaked to support using it as an element which would allow it to be moved to a dedicated file without significantly impacting the page render logic:\nconst ExpansionPanelContent = ({category, settings}: {category: string; settings: GeneralSetting[]}): ReactElement => {\n...\n}\n<ExpansionPanelContent category={category.id} settings={group.settings}></ExpansionPanelContent>", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393368356", "createdAt": "2020-03-16T23:35:28Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 125}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2OTY5OQ==", "bodyText": "Not sure on this but the settingsGroups function is going to be called on every render, the sorted and filtered groups may be better stored in state once", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393369699", "createdAt": "2020-03-16T23:40:19Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {\n+                return (\n+                  <ListItem key={setting.id}>\n+                    <ListItemText\n+                      primary={settingLink(setting)}\n+                      secondary={setting.description}\n+                    />\n+                  </ListItem>\n+                );\n+              })}\n+          </List>\n+        </ExpansionPanelDetails>\n+      );\n+    }\n+  };\n+\n+  // Create a link for each setting\n+  const settingLink = (setting: GeneralSetting): ReactElement => {\n+    let link = <div />;\n+    if (setting.links.route) {\n+      link = <Link to={setting.links.route}>{setting.name}</Link>;\n+    } else if (setting.links.href) {\n+      link = <a href={setting.links.href}>{setting.name}</a>;\n+    } else if (setting.id === \"adminconsole\") {\n+      link = (\n+        <a href=\"javascript:void(0)\" onClick={() => setAdminDialogOpen(true)}>\n+          {setting.name}\n+        </a>\n+      );\n+    }\n+\n+    return link;\n+  };\n+\n+  return (\n+    <div id=\"settingsPage\">\n+      <AdminDownloadDialog\n+        open={adminDialogOpen}\n+        onClose={() => setAdminDialogOpen(false)}\n+      />\n+      {// Display a circular Progress Bar or the Setting menu, depending on the state of 'loading'\n+      loading ? (\n+        <div className={classes.progress}>\n+          <CircularProgress variant=\"indeterminate\" />\n+        </div>\n+      ) : (\n+        settingGroups().map(group => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 182}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3MjAzOA==", "bodyText": "Can daisy chain the destruct or just destruct values from group.category as category is never needed and save needing to do category.variable again and again.\nconst { id, details } = group.category;", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393372038", "createdAt": "2020-03-16T23:48:52Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {\n+                return (\n+                  <ListItem key={setting.id}>\n+                    <ListItemText\n+                      primary={settingLink(setting)}\n+                      secondary={setting.description}\n+                    />\n+                  </ListItem>\n+                );\n+              })}\n+          </List>\n+        </ExpansionPanelDetails>\n+      );\n+    }\n+  };\n+\n+  // Create a link for each setting\n+  const settingLink = (setting: GeneralSetting): ReactElement => {\n+    let link = <div />;\n+    if (setting.links.route) {\n+      link = <Link to={setting.links.route}>{setting.name}</Link>;\n+    } else if (setting.links.href) {\n+      link = <a href={setting.links.href}>{setting.name}</a>;\n+    } else if (setting.id === \"adminconsole\") {\n+      link = (\n+        <a href=\"javascript:void(0)\" onClick={() => setAdminDialogOpen(true)}>\n+          {setting.name}\n+        </a>\n+      );\n+    }\n+\n+    return link;\n+  };\n+\n+  return (\n+    <div id=\"settingsPage\">\n+      <AdminDownloadDialog\n+        open={adminDialogOpen}\n+        onClose={() => setAdminDialogOpen(false)}\n+      />\n+      {// Display a circular Progress Bar or the Setting menu, depending on the state of 'loading'\n+      loading ? (\n+        <div className={classes.progress}>\n+          <CircularProgress variant=\"indeterminate\" />\n+        </div>\n+      ) : (\n+        settingGroups().map(group => {\n+          const { category } = group;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 183}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3MzM5Mw==", "bodyText": "Is the Axios response ever needed?  If not then the results can be returned rather than the response, this will\n\nsave the caller from needing to know about Axios and means the underlying functionality can be switched to native fetch without impacting the callers.\nallow callers to immediately destruct the result data in the then value without needing to do result.data\n\nAlso there's a lot of flipping between function and arrow functions, personal preference is to stick to one\nexport const fetchSettings(): Promise<GeneralSetting[]> => \n  Axios.get<GeneralSetting[]>(GET_SETTINGS_URL).then(resp => resp.data);", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393373393", "createdAt": "2020-03-16T23:53:14Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPageModule.ts", "diffHunk": "@@ -0,0 +1,26 @@\n+import Axios, { AxiosPromise } from \"axios\";\n+import { GeneralSetting, UISetting } from \"./SettingsPageEntry\";\n+import { Config } from \"../config\";\n+\n+const GET_SETTINGS_URL = `${Config.baseUrl}api/settings`;\n+const GET_UI_SETTINGS_URL = `${GET_SETTINGS_URL}/ui`;\n+\n+export function fetchSettings(): AxiosPromise<GeneralSetting[]> {\n+  return Axios.get(GET_SETTINGS_URL);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3NDg3NA==", "bodyText": "I've got mixed habits for JS docs between components and modules but I'm trying to get into the habit of adding them to modules, same as adding them on the java/groovy/scala side.", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393374874", "createdAt": "2020-03-16T23:58:54Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPageModule.ts", "diffHunk": "@@ -0,0 +1,26 @@\n+import Axios, { AxiosPromise } from \"axios\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3NjkyOA==", "bodyText": "The data can be immediately destructed, saves needed to settings.newUI\nconst {enabled, newSearch} = result.data.newUI;", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393376928", "createdAt": "2020-03-17T00:06:39Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/UISettingEditor.tsx", "diffHunk": "@@ -0,0 +1,121 @@\n+import * as React from \"react\";\n+import { UISetting } from \"./SettingsPageEntry\";\n+import { fetchUISetting, saveUISetting } from \"./SettingsPageModule\";\n+import { ExpansionPanelDetails, Theme } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import { Link } from \"react-router-dom\";\n+import { routes } from \"../mainui/routes\";\n+import Button from \"@material-ui/core/Button\";\n+import { languageStrings } from \"../util/langstrings\";\n+import FormControl from \"@material-ui/core/FormControl\";\n+import FormControlLabel from \"@material-ui/core/FormControlLabel\";\n+import Switch from \"@material-ui/core/Switch\";\n+import { Config } from \"../config\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    fab: {\n+      position: \"absolute\",\n+      bottom: 0,\n+      right: 16\n+    },\n+    enableNewUIColumn: {\n+      flexBasis: \"33.3%\"\n+    },\n+    enableNewSearchColumn: {\n+      flexBasis: \"33.3%\"\n+    }\n+  };\n+});\n+\n+interface UISettingEditorProps {\n+  refreshUser: () => void;\n+  handleError: (error: AxiosError) => void;\n+}\n+\n+const UISettingEditor = (props: UISettingEditorProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, handleError } = props;\n+  const { uiconfig } = languageStrings;\n+\n+  const [newUIEnabled, setNewUIEnabled] = React.useState<boolean>(true);\n+  const [newSearchEnabled, setNewSearchEnabled] = React.useState<boolean>(\n+    false\n+  );\n+\n+  React.useEffect(() => {\n+    fetchUISetting()\n+      .then(result => {\n+        const setting: UISetting = result.data;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3NzI4Mw==", "bodyText": "Not sure this div is needed", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393377283", "createdAt": "2020-03-17T00:07:58Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/UISettingEditor.tsx", "diffHunk": "@@ -0,0 +1,121 @@\n+import * as React from \"react\";\n+import { UISetting } from \"./SettingsPageEntry\";\n+import { fetchUISetting, saveUISetting } from \"./SettingsPageModule\";\n+import { ExpansionPanelDetails, Theme } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import { Link } from \"react-router-dom\";\n+import { routes } from \"../mainui/routes\";\n+import Button from \"@material-ui/core/Button\";\n+import { languageStrings } from \"../util/langstrings\";\n+import FormControl from \"@material-ui/core/FormControl\";\n+import FormControlLabel from \"@material-ui/core/FormControlLabel\";\n+import Switch from \"@material-ui/core/Switch\";\n+import { Config } from \"../config\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    fab: {\n+      position: \"absolute\",\n+      bottom: 0,\n+      right: 16\n+    },\n+    enableNewUIColumn: {\n+      flexBasis: \"33.3%\"\n+    },\n+    enableNewSearchColumn: {\n+      flexBasis: \"33.3%\"\n+    }\n+  };\n+});\n+\n+interface UISettingEditorProps {\n+  refreshUser: () => void;\n+  handleError: (error: AxiosError) => void;\n+}\n+\n+const UISettingEditor = (props: UISettingEditorProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, handleError } = props;\n+  const { uiconfig } = languageStrings;\n+\n+  const [newUIEnabled, setNewUIEnabled] = React.useState<boolean>(true);\n+  const [newSearchEnabled, setNewSearchEnabled] = React.useState<boolean>(\n+    false\n+  );\n+\n+  React.useEffect(() => {\n+    fetchUISetting()\n+      .then(result => {\n+        const setting: UISetting = result.data;\n+        setNewSearchEnabled(setting.newUI.newSearch);\n+        setNewUIEnabled(setting.newUI.enabled);\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  }, []);\n+\n+  const setNewUI = (enabled: boolean) => {\n+    setNewUIEnabled(enabled);\n+    saveUISetting(enabled, newSearchEnabled)\n+      .then(_ => {\n+        window.location.href = Config.baseUrl + \"access/settings.do\";\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  };\n+\n+  const setNewSearch = (enabled: boolean) => {\n+    setNewSearchEnabled(enabled);\n+    saveUISetting(newUIEnabled, enabled)\n+      .then(_ => refreshUser())\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  };\n+\n+  return (\n+    <ExpansionPanelDetails>\n+      <div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODA0NA==", "bodyText": "There's no guarantee the error will be an AxiosError as the catch could return a runtime error", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393378044", "createdAt": "2020-03-17T00:11:05Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/UISettingEditor.tsx", "diffHunk": "@@ -0,0 +1,121 @@\n+import * as React from \"react\";\n+import { UISetting } from \"./SettingsPageEntry\";\n+import { fetchUISetting, saveUISetting } from \"./SettingsPageModule\";\n+import { ExpansionPanelDetails, Theme } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import { Link } from \"react-router-dom\";\n+import { routes } from \"../mainui/routes\";\n+import Button from \"@material-ui/core/Button\";\n+import { languageStrings } from \"../util/langstrings\";\n+import FormControl from \"@material-ui/core/FormControl\";\n+import FormControlLabel from \"@material-ui/core/FormControlLabel\";\n+import Switch from \"@material-ui/core/Switch\";\n+import { Config } from \"../config\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    fab: {\n+      position: \"absolute\",\n+      bottom: 0,\n+      right: 16\n+    },\n+    enableNewUIColumn: {\n+      flexBasis: \"33.3%\"\n+    },\n+    enableNewSearchColumn: {\n+      flexBasis: \"33.3%\"\n+    }\n+  };\n+});\n+\n+interface UISettingEditorProps {\n+  refreshUser: () => void;\n+  handleError: (error: AxiosError) => void;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODQwNA==", "bodyText": "Do we have handling for legacy browsers?  E.g. message stating browser is not supported", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393378404", "createdAt": "2020-03-17T00:12:37Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsconfig.json", "diffHunk": "@@ -3,7 +3,7 @@\n     \"outDir\": \"target/ts\",\n     \"module\": \"CommonJS\",\n     \"target\": \"es5\",\n-    \"lib\": [\"es6\", \"dom\"],\n+    \"lib\": [\"es6\", \"dom\", \"es2018.promise\"],", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE1NTIwNA=="}, "originalCommit": {"oid": "05b3780b6a1bcf4464fc2e78c406260d4e681670"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTI5OA==", "bodyText": "I think this can be achieved with a MUI Grid which will reduce the need for custom styles and cater for responsive design if desired at some point", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393379298", "createdAt": "2020-03-17T00:16:31Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/UISettingEditor.tsx", "diffHunk": "@@ -0,0 +1,121 @@\n+import * as React from \"react\";\n+import { UISetting } from \"./SettingsPageEntry\";\n+import { fetchUISetting, saveUISetting } from \"./SettingsPageModule\";\n+import { ExpansionPanelDetails, Theme } from \"@material-ui/core\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import { Link } from \"react-router-dom\";\n+import { routes } from \"../mainui/routes\";\n+import Button from \"@material-ui/core/Button\";\n+import { languageStrings } from \"../util/langstrings\";\n+import FormControl from \"@material-ui/core/FormControl\";\n+import FormControlLabel from \"@material-ui/core/FormControlLabel\";\n+import Switch from \"@material-ui/core/Switch\";\n+import { Config } from \"../config\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    fab: {\n+      position: \"absolute\",\n+      bottom: 0,\n+      right: 16\n+    },\n+    enableNewUIColumn: {\n+      flexBasis: \"33.3%\"\n+    },\n+    enableNewSearchColumn: {\n+      flexBasis: \"33.3%\"\n+    }\n+  };\n+});\n+\n+interface UISettingEditorProps {\n+  refreshUser: () => void;\n+  handleError: (error: AxiosError) => void;\n+}\n+\n+const UISettingEditor = (props: UISettingEditorProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, handleError } = props;\n+  const { uiconfig } = languageStrings;\n+\n+  const [newUIEnabled, setNewUIEnabled] = React.useState<boolean>(true);\n+  const [newSearchEnabled, setNewSearchEnabled] = React.useState<boolean>(\n+    false\n+  );\n+\n+  React.useEffect(() => {\n+    fetchUISetting()\n+      .then(result => {\n+        const setting: UISetting = result.data;\n+        setNewSearchEnabled(setting.newUI.newSearch);\n+        setNewUIEnabled(setting.newUI.enabled);\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  }, []);\n+\n+  const setNewUI = (enabled: boolean) => {\n+    setNewUIEnabled(enabled);\n+    saveUISetting(enabled, newSearchEnabled)\n+      .then(_ => {\n+        window.location.href = Config.baseUrl + \"access/settings.do\";\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  };\n+\n+  const setNewSearch = (enabled: boolean) => {\n+    setNewSearchEnabled(enabled);\n+    saveUISetting(newUIEnabled, enabled)\n+      .then(_ => refreshUser())\n+      .catch(error => {\n+        handleError(error);\n+      });\n+  };\n+\n+  return (\n+    <ExpansionPanelDetails>\n+      <div>\n+        <div className={classes.enableNewUIColumn}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4MDE0Ng==", "bodyText": "I take it properties are injected into a component at a higher level, as routes has no contract for properties (e.g. component: \"not valid\" is fine and won't cause errors here)", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393380146", "createdAt": "2020-03-17T00:20:30Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/routes.tsx", "diffHunk": "@@ -46,7 +47,7 @@ export const routes = {\n   Settings: {\n     path: \"(/access/settings.do|/page/settings)\",\n     to: \"/page/settings\",\n-    render: (p: OEQRouteComponentProps<any>) => <bridge.SettingsPage {...p} />\n+    component: SettingsPage", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4MTI5NQ==", "bodyText": "Most of the MUI components (excluding icons) can be imported all at once, tree shaking should still work\nimport { Theme, ExpansionPanelDetails, List, ListItem, ListItemText, ExpansionPanel, ExpansionPanelSummary, Typography } from \"@material-ui/core\";", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393381295", "createdAt": "2020-03-17T00:25:26Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4MTcwNQ==", "bodyText": "This could be a dedicated oEQ component, allowing it to  be defined once and potentially changed later without needing to update all the pages.", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393381705", "createdAt": "2020-03-17T00:26:57Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,203 @@\n+import * as React from \"react\";\n+import { Theme } from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\n+import ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\n+import ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import Typography from \"@material-ui/core/Typography\";\n+import List from \"@material-ui/core/List\";\n+import ListItem from \"@material-ui/core/ListItem\";\n+import ListItemText from \"@material-ui/core/ListItemText\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import CircularProgress from \"@material-ui/core/CircularProgress\";\n+import { generateFromError } from \"../api/errors\";\n+import { AxiosError } from \"axios\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+interface SettingCategory {\n+  id: string;\n+  details: {\n+    name: string;\n+    desc: string;\n+  };\n+}\n+\n+interface SettingGroup {\n+  category: SettingCategory;\n+  settings: GeneralSetting[];\n+}\n+\n+const SettingsPage = (props: SettingsPageProps) => {\n+  const classes = useStyles();\n+  const { refreshUser, updateTemplate } = props;\n+  const SETTING_CATEGORIES: SettingCategory[] = [\n+    { id: \"general\", details: languageStrings.settings.general },\n+    { id: \"integration\", details: languageStrings.settings.integration },\n+    { id: \"diagnostics\", details: languageStrings.settings.diagnostics },\n+    { id: \"searching\", details: languageStrings.settings.searching },\n+    { id: \"ui\", details: languageStrings.settings.ui }\n+  ];\n+\n+  const [settings, setSettings] = React.useState<GeneralSetting[]>([]);\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+\n+  // Update the title of App Bar\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  // Fetch settings from the server\n+  React.useEffect(() => {\n+    let cancel = false;\n+    fetchSettings()\n+      .then(result => {\n+        if (!cancel) {\n+          setSettings(result.data);\n+        }\n+      })\n+      .catch(error => {\n+        handleError(error);\n+      })\n+      .finally(() => setLoading(false));\n+\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n+\n+  const handleError = (error: AxiosError) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  // Group settings by their category and sort each group by setting name\n+  const settingGroups = (): SettingGroup[] => {\n+    const groups: SettingGroup[] = [];\n+\n+    SETTING_CATEGORIES.forEach(category => {\n+      const settingsOfCategory = settings\n+        .filter(setting => setting.group === category.id)\n+        .sort((s1, s2) => {\n+          return s1.name > s2.name ? 1 : -1;\n+        });\n+      groups.push({ category: category, settings: settingsOfCategory });\n+    });\n+\n+    return groups;\n+  };\n+\n+  // Create the content of each ExpansionPanel\n+  const expansionPanelContent = (\n+    category: string,\n+    settings?: GeneralSetting[]\n+  ): ReactElement => {\n+    if (category === \"ui\") {\n+      return (\n+        <UISettingEditor refreshUser={refreshUser} handleError={handleError} />\n+      );\n+    } else {\n+      return (\n+        <ExpansionPanelDetails>\n+          <List>\n+            {settings &&\n+              settings.map(setting => {\n+                return (\n+                  <ListItem key={setting.id}>\n+                    <ListItemText\n+                      primary={settingLink(setting)}\n+                      secondary={setting.description}\n+                    />\n+                  </ListItem>\n+                );\n+              })}\n+          </List>\n+        </ExpansionPanelDetails>\n+      );\n+    }\n+  };\n+\n+  // Create a link for each setting\n+  const settingLink = (setting: GeneralSetting): ReactElement => {\n+    let link = <div />;\n+    if (setting.links.route) {\n+      link = <Link to={setting.links.route}>{setting.name}</Link>;\n+    } else if (setting.links.href) {\n+      link = <a href={setting.links.href}>{setting.name}</a>;\n+    } else if (setting.id === \"adminconsole\") {\n+      link = (\n+        <a href=\"javascript:void(0)\" onClick={() => setAdminDialogOpen(true)}>\n+          {setting.name}\n+        </a>\n+      );\n+    }\n+\n+    return link;\n+  };\n+\n+  return (\n+    <div id=\"settingsPage\">\n+      <AdminDownloadDialog\n+        open={adminDialogOpen}\n+        onClose={() => setAdminDialogOpen(false)}\n+      />\n+      {// Display a circular Progress Bar or the Setting menu, depending on the state of 'loading'\n+      loading ? (\n+        <div className={classes.progress}>\n+          <CircularProgress variant=\"indeterminate\" />\n+        </div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 180}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4MTg4OA==", "bodyText": "Same as before, the MUI core components can be imported in a single line", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r393381888", "createdAt": "2020-03-17T00:27:51Z", "author": {"login": "edalex-tom"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/UISettingEditor.tsx", "diffHunk": "@@ -0,0 +1,121 @@\n+import * as React from \"react\";\n+import { UISetting } from \"./SettingsPageEntry\";\n+import { fetchUISetting, saveUISetting } from \"./SettingsPageModule\";\n+import { ExpansionPanelDetails, Theme } from \"@material-ui/core\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99d3f64caf6a959aa4ba075ec8a5ccf662ab4a6c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c4ff5cc2d64343acea502bd74d2812f8545a683", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/2c4ff5cc2d64343acea502bd74d2812f8545a683", "committedDate": "2020-03-18T01:16:05Z", "message": "* Move 'SettingCategory' and 'SettingGroup' to a separate ts file\n\n* Rename 'settingGroups' to 'groupMap'\n\n* Remove the hard-coded 'SETTING_CATEGORIES'\n  and use Object.keys instead\n\n* Store the groups of settings in state\n\n* Use MUI Link rather than raw <a>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b31faf7f3285cd94391ebb646aa4739dac93bbf", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/3b31faf7f3285cd94391ebb646aa4739dac93bbf", "committedDate": "2020-03-18T04:29:14Z", "message": "* Import MUI components at once\n\n* Return the results of 'AxiosResponse' instead of the response itself\n\n* Use MUI Grid for a few For controls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e815d455ba90743583ce1a0604f7c9a92f713685", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/e815d455ba90743583ce1a0604f7c9a92f713685", "committedDate": "2020-03-18T05:25:28Z", "message": "* Use JSDoc to create better comments for three important functions\n\n* Add one language string for the Admin Console download link"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12a6e53b7664295ed7f2026e35240b14e6637af3", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/12a6e53b7664295ed7f2026e35240b14e6637af3", "committedDate": "2020-03-18T06:32:17Z", "message": "Include es2020 in the compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2367f8acddc8a3b365d529897651f827b9f4075a", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/2367f8acddc8a3b365d529897651f827b9f4075a", "committedDate": "2020-03-18T06:37:51Z", "message": "Make 'handleError' not limited to AxiosError"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e16c6bdb239ad8d2ea0d60a8f3fbdfdddd5bef77", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/e16c6bdb239ad8d2ea0d60a8f3fbdfdddd5bef77", "committedDate": "2020-03-19T03:31:50Z", "message": "Add cancel token for fetching general settings and the UI setting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDAxMTQw", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-377401140", "createdAt": "2020-03-19T03:34:50Z", "commit": {"oid": "e16c6bdb239ad8d2ea0d60a8f3fbdfdddd5bef77"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzozNDo1MFrOF4e-uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzozNDo1MFrOF4e-uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3MjE1Mw==", "bodyText": "I did not add cancel token here because cancelling this request will result in different user experience, and it is out of the scope of this PR.", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r394772153", "createdAt": "2020-03-19T03:34:50Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPageModule.ts", "diffHunk": "@@ -1,16 +1,22 @@\n-import Axios, { AxiosPromise } from \"axios\";\n+import Axios, { AxiosPromise, CancelToken } from \"axios\";\n import { GeneralSetting, UISetting } from \"./SettingsPageEntry\";\n import { Config } from \"../config\";\n \n const GET_SETTINGS_URL = `${Config.baseUrl}api/settings`;\n const GET_UI_SETTINGS_URL = `${GET_SETTINGS_URL}/ui`;\n \n-export const fetchSettings = (): Promise<GeneralSetting[]> => {\n-  return Axios.get<GeneralSetting[]>(GET_SETTINGS_URL).then(res => res.data);\n+export const fetchSettings = (\n+  token: CancelToken\n+): Promise<GeneralSetting[]> => {\n+  return Axios.get<GeneralSetting[]>(GET_SETTINGS_URL, {\n+    cancelToken: token\n+  }).then(res => res.data);\n };\n \n-export const fetchUISetting = (): Promise<UISetting> => {\n-  return Axios.get<UISetting>(GET_UI_SETTINGS_URL).then(res => res.data);\n+export const fetchUISetting = (token: CancelToken): Promise<UISetting> => {\n+  return Axios.get<UISetting>(GET_UI_SETTINGS_URL, {\n+    cancelToken: token\n+  }).then(res => res.data);\n };\n \n export const saveUISetting = (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e16c6bdb239ad8d2ea0d60a8f3fbdfdddd5bef77"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a60887a095c0983d65656ac4cd7efe3443e2f3", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/a8a60887a095c0983d65656ac4cd7efe3443e2f3", "committedDate": "2020-03-19T05:03:40Z", "message": "Merge branch 'component/search_configuration' into feature/convert-purs-to-tsx-for-setting-menu"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTQ5Mjcz", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-378149273", "createdAt": "2020-03-19T22:58:27Z", "commit": {"oid": "a8a60887a095c0983d65656ac4cd7efe3443e2f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMjo1ODoyN1rOF5DLvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMjo1ODoyN1rOF5DLvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM2NTMwOQ==", "bodyText": "Could useEffect and useState be destructured either on the import from react or at the beginning of the file?", "url": "https://github.com/openequella/openEQUELLA/pull/1541#discussion_r395365309", "createdAt": "2020-03-19T22:58:27Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/SettingsPage.tsx", "diffHunk": "@@ -0,0 +1,177 @@\n+import * as React from \"react\";\n+import axios from \"axios\";\n+import {\n+  Theme,\n+  ExpansionPanel,\n+  ExpansionPanelSummary,\n+  ExpansionPanelDetails,\n+  Typography,\n+  List,\n+  ListItem,\n+  ListItemText,\n+  CircularProgress\n+} from \"@material-ui/core\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps\n+} from \"../mainui/Template\";\n+import { fetchSettings } from \"./SettingsPageModule\";\n+import { GeneralSetting } from \"./SettingsPageEntry\";\n+import { languageStrings } from \"../util/langstrings\";\n+import MUILink from \"@material-ui/core/Link\";\n+import ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n+import { Link } from \"react-router-dom\";\n+import { makeStyles } from \"@material-ui/styles\";\n+import AdminDownloadDialog from \"../settings/AdminDownloadDialog\";\n+import { ReactElement } from \"react\";\n+import UISettingEditor from \"./UISettingEditor\";\n+import { generateFromError } from \"../api/errors\";\n+import { groupMap, SettingGroup } from \"./SettingGroups\";\n+\n+const useStyles = makeStyles((theme: Theme) => {\n+  return {\n+    heading: {\n+      fontSize: theme.typography.pxToRem(15),\n+      flexBasis: \"33.33%\",\n+      flexShrink: 0\n+    },\n+    secondaryHeading: {\n+      fontSize: theme.typography.pxToRem(15)\n+    },\n+    progress: {\n+      display: \"flex\",\n+      marginTop: theme.spacing.unit * 4,\n+      justifyContent: \"center\"\n+    }\n+  };\n+});\n+\n+interface SettingsPageProps extends TemplateUpdateProps {\n+  refreshUser: () => void;\n+}\n+\n+const SettingsPage = ({ refreshUser, updateTemplate }: SettingsPageProps) => {\n+  const classes = useStyles();\n+\n+  const [adminDialogOpen, setAdminDialogOpen] = React.useState<boolean>(false);\n+  const [loading, setLoading] = React.useState<boolean>(true);\n+  const [settingGroups, setSettingGroups] = React.useState<SettingGroup[]>([]);\n+\n+  React.useEffect(() => {\n+    updateTemplate(templateDefaults(languageStrings[\"com.equella.core\"].title));\n+  }, []);\n+\n+  React.useEffect(() => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8a60887a095c0983d65656ac4cd7efe3443e2f3"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a269d9fb9f8ccea85afce2cde36b344fcfebfd1e", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/a269d9fb9f8ccea85afce2cde36b344fcfebfd1e", "committedDate": "2020-03-19T23:12:39Z", "message": "Destructure 'useEffect' and 'useState'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTU1NjA3", "url": "https://github.com/openequella/openEQUELLA/pull/1541#pullrequestreview-378155607", "createdAt": "2020-03-19T23:14:55Z", "commit": {"oid": "a269d9fb9f8ccea85afce2cde36b344fcfebfd1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 164, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}