{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NzU3ODU3", "number": 2491, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMTo1OToyNFrOE13QNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0Nzo0MlrOE3hDmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0OTE1MjUyOnYy", "diffSide": "RIGHT", "path": ".github/workflows/ci.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMTo1OToyNFrOHuYVDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMTo1OToyNFrOHuYVDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM5NTE1MA==", "bodyText": "This seems like something which we may want to add to the eslint ignore or prettier ignore.\nIt will likely be an issue if the static storybook pages are built locally, could be nice to fix it for both cases.", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r518395150", "createdAt": "2020-11-05T21:59:24Z", "author": {"login": "ChristianMurphy"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,28 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        run: |\n+          tar cvf storybook.tar --transform='s/.\\+\\///' \\\n+          Source/Plugins/Core/com.equella.core/js/storybook-static\n+\n+      - name: Remove Storybook Folder After Packaging\n+        # We need this step so that storybook isn't included in the checks\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          rm -R storybook-static", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d13b043d81a7c77bbff89843343c07ec761d82bc"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MTA5NDI4OnYy", "diffSide": "RIGHT", "path": ".github/workflows/ci.yaml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMDowMToyNFrOHwGaMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMzo1Njo0MFrOHwKzaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5ODcwNg==", "bodyText": "does this still need to be removed?\nNow that it is ignored by the linting and formatting tools?", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r520198706", "createdAt": "2020-11-10T00:01:24Z", "author": {"login": "ChristianMurphy"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,27 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          tar cvf storybook.tar storybook-static\n+\n+      - name: Remove Storybook Folder After Packaging\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          rm -R storybook-static", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc720368c69a148e06c9562703bdd7bd11b57f71"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIzODM2NA==", "bodyText": "Not necessarily, but it just makes sure that the storybook steps clean up after themselves.", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r520238364", "createdAt": "2020-11-10T02:03:49Z", "author": {"login": "SammyIsConfused"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,27 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          tar cvf storybook.tar storybook-static\n+\n+      - name: Remove Storybook Folder After Packaging\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          rm -R storybook-static", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5ODcwNg=="}, "originalCommit": {"oid": "dc720368c69a148e06c9562703bdd7bd11b57f71"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI3MDY5Nw==", "bodyText": "Removed the step in 6dbd054.", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r520270697", "createdAt": "2020-11-10T03:56:40Z", "author": {"login": "SammyIsConfused"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,27 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          tar cvf storybook.tar storybook-static\n+\n+      - name: Remove Storybook Folder After Packaging\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          rm -R storybook-static", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5ODcwNg=="}, "originalCommit": {"oid": "dc720368c69a148e06c9562703bdd7bd11b57f71"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MTA5NjA2OnYy", "diffSide": "RIGHT", "path": ".github/workflows/ci.yaml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMDowMjoxMVrOHwGbMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMjowMjo0NlrOHwIz8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5ODk2Mw==", "bodyText": "could these be combined into a single step?", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r520198963", "createdAt": "2020-11-10T00:02:11Z", "author": {"login": "ChristianMurphy"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,27 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          tar cvf storybook.tar storybook-static", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc720368c69a148e06c9562703bdd7bd11b57f71"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIzODA2NA==", "bodyText": "As I said to Penghai above, the other steps that involve building, tarring and uploading artefacts are split into steps. It was a deliberate choice to stay separate in order to be consistent with the rest of the yaml. It also helps with diagnosing build issues to split into steps, as at-a-glance it tells us exactly where the issue arose.", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r520238064", "createdAt": "2020-11-10T02:02:46Z", "author": {"login": "SammyIsConfused"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -78,6 +78,27 @@ jobs:\n         run: |\n           npm ci\n \n+      - name: Generate Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          npm run build-storybook\n+\n+      - name: Package Static Storybook instance\n+        working-directory: Source/Plugins/Core/com.equella.core/js\n+        run: |\n+          tar cvf storybook.tar storybook-static", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5ODk2Mw=="}, "originalCommit": {"oid": "dc720368c69a148e06c9562703bdd7bd11b57f71"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjQ1OTk5OnYy", "diffSide": "RIGHT", "path": ".github/workflows/ci.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0MDowOVrOHw5-5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0MDowOVrOHw5-5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTA0MzY4Nw==", "bodyText": "Is that required? AFAICT, everything done below is JS / Node.", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r521043687", "createdAt": "2020-11-11T02:40:09Z", "author": {"login": "edalex-ian"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -110,6 +110,56 @@ jobs:\n           name: Artefacts\n           path: artefacts.tar\n \n+  build_storybook:\n+    runs-on: ubuntu-latest\n+    steps:\n+      # Using v1 (rather than v2) through-out this workflow due to issue:\n+      # https://github.com/actions/checkout/issues/237\n+      - uses: actions/checkout@v1\n+\n+      - name: NPM Cache\n+        uses: actions/cache@v2\n+        with:\n+          path: ~/.npm\n+          key: ${{ runner.os }}-npm-${{ hashFiles('**/package-lock.json') }}\n+          restore-keys: |\n+            ${{ runner.os }}-npm-\n+\n+      - name: Read .nvmrc\n+        run: echo ::set-output name=NVMRC::$(cat .nvmrc)\n+        id: nvm\n+\n+      - name: Setup node\n+        uses: actions/setup-node@v1\n+        with:\n+          node-version: \"${{ steps.nvm.outputs.NVMRC }}\"\n+\n+      - name: Set up JDK 1.8\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46735b7d57338c6c6e7fb9dfe07e5687be8c6847"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjQ2NjMxOnYy", "diffSide": "RIGHT", "path": ".gitignore", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0MjoxN1rOHw6DfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0MjoxN1rOHw6DfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTA0NDg2MA==", "bodyText": "This should sit down with the code it belongs to: Source/Plugins/Core/com.equella.core/js/.gitignore", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r521044860", "createdAt": "2020-11-11T02:42:17Z", "author": {"login": "edalex-ian"}, "path": ".gitignore", "diffHunk": "@@ -17,4 +17,4 @@ generated.keystore\n Source/Plugins/Kaltura\n server.xml\n node_modules/\n-\n+storybook-static/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46735b7d57338c6c6e7fb9dfe07e5687be8c6847"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjQ4NzI5OnYy", "diffSide": "RIGHT", "path": ".github/workflows/ci.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0Nzo0MlrOHw6RSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjo0Nzo0MlrOHw6RSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTA0ODM5NQ==", "bodyText": "It would be prudent to have it's own cache for this me thinks.\nbe good to replace -npm- on lines 124 and 126:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      key: ${{ runner.os }}-npm-${{ hashFiles('**/package-lock.json') }}\n          \n          \n            \n                      restore-keys: |\n          \n          \n            \n                        ${{ runner.os }}-npm-\n          \n          \n            \n                      key: ${{ runner.os }}-npm.storybook-${{ hashFiles('**/package-lock.json') }}\n          \n          \n            \n                      restore-keys: |\n          \n          \n            \n                        ${{ runner.os }}-npm.storybook-", "url": "https://github.com/openequella/openEQUELLA/pull/2491#discussion_r521048395", "createdAt": "2020-11-11T02:47:42Z", "author": {"login": "edalex-ian"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -110,6 +110,56 @@ jobs:\n           name: Artefacts\n           path: artefacts.tar\n \n+  build_storybook:\n+    runs-on: ubuntu-latest\n+    steps:\n+      # Using v1 (rather than v2) through-out this workflow due to issue:\n+      # https://github.com/actions/checkout/issues/237\n+      - uses: actions/checkout@v1\n+\n+      - name: NPM Cache\n+        uses: actions/cache@v2\n+        with:\n+          path: ~/.npm\n+          key: ${{ runner.os }}-npm-${{ hashFiles('**/package-lock.json') }}\n+          restore-keys: |\n+            ${{ runner.os }}-npm-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46735b7d57338c6c6e7fb9dfe07e5687be8c6847"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1649, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}