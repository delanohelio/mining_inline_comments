{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5OTg1Mjg3", "number": 1509, "title": "Back-end for Search page settings", "bodyText": "#1337\nChecklist\n\n the [contributor license agreement] is signed\n commit message follows [commit guidelines]\n tests are included\n screenshots are included showing significant UI changes\n\nDescription of change\nProvider REST endpoints to support Seach page settings.", "createdAt": "2020-02-26T03:17:44Z", "url": "https://github.com/openequella/openEQUELLA/pull/1509", "merged": true, "mergeCommit": {"oid": "22e77fe79dfce7b0460927c6f569efafd3a9ed05"}, "closed": true, "closedAt": "2020-02-27T22:44:08Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH8OuCAH2gAyMzc5OTg1Mjg3OmRjMzBmNmM3OTdlZmM4NGVjMWI4ZTc3ZDlhNmYzOWYwMjc4NWNkZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIjLuxAH2gAyMzc5OTg1Mjg3OjIyNTE2NWQzOGQ5YTJlNjg1NjExMzhkZDEzYmQzOTc2OGNiMTBkN2E=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc30f6c797efc84ec1b8e77d9a6f39f02785cde7", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/dc30f6c797efc84ec1b8e77d9a6f39f02785cde7", "committedDate": "2020-02-26T01:13:56Z", "message": "Create new REST endpoints to support Search page settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df", "committedDate": "2020-02-26T03:14:16Z", "message": "Create a new test for Search page setting API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjAwNzA4", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-364600708", "createdAt": "2020-02-26T03:21:23Z", "commit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzoyMToyM1rOFudHCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzoyMToyM1rOFudHCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1NTc1NA==", "bodyText": "Maybe PUT is more suitable?", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384255754", "createdAt": "2020-02-26T03:21:23Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +105,26 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"searchpage\")\n+  def loadSearchPageSettings: SearchPageSettings = {\n+    searchPrivProvider.checkAuthorised()\n+    SearchPageSettings(loadSettings(new SearchSettings), loadSettings(new CloudSettings))\n+  }\n+\n+  @POST", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0019899a8a08ab15a4fc8dfdf57cf67938104b50", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/0019899a8a08ab15a4fc8dfdf57cf67938104b50", "committedDate": "2020-02-26T03:28:13Z", "message": "Use token rather than getToken"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjAzNjUy", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-364603652", "createdAt": "2020-02-26T03:33:00Z", "commit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzozMzowMFrOFudQnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzozMzowMFrOFudQnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1ODIwNQ==", "bodyText": "could defaultResultOrder become defaultSortOrder?\nAlso, for showNoneLive we need the prefix version of the term (non) rather than none as a value. So it would end up being showNonLive", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384258205", "createdAt": "2020-02-26T03:33:00Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -45,12 +49,44 @@ object SettingTypeLinks {\n                        if (ed.isRoute) Some(\"/\" + ed.uri) else None)\n   }\n }\n+\n+case class GalleryViewSettings(disableImage: Boolean,\n+                               disableVideo: Boolean,\n+                               disableFileCount: Boolean)\n+\n+case class SearchPageSettings(showNoneLive: Boolean,\n+                              disableGalleryViews: GalleryViewSettings,\n+                              disableCloudSearching: Boolean,\n+                              defaultResultOrder: String,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f09303561b25e78ae0f49b63200b1305ce365c7", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/5f09303561b25e78ae0f49b63200b1305ce365c7", "committedDate": "2020-02-26T03:36:46Z", "message": "Use PUT instead of POST for updating settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fcd0947f0427fbead1c6dc2a6f5f0658a6f64d7", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/1fcd0947f0427fbead1c6dc2a6f5f0658a6f64d7", "committedDate": "2020-02-26T03:43:37Z", "message": "A couple of wording changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjA2Njkx", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-364606691", "createdAt": "2020-02-26T03:45:04Z", "commit": {"oid": "1fcd0947f0427fbead1c6dc2a6f5f0658a6f64d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjUxNDcw", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-364651470", "createdAt": "2020-02-26T06:38:48Z", "commit": {"oid": "1fcd0947f0427fbead1c6dc2a6f5f0658a6f64d7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "474ce9d0cd4351d4ce54296554035c33cac287d4", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/474ce9d0cd4351d4ce54296554035c33cac287d4", "committedDate": "2020-02-27T00:47:44Z", "message": "Endpoints for 'settings/search' and 'settings/search/cloud';\n\nDisable the new test for now."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "377bb68c21095f03366cb1acf1c828f77bff737a", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/377bb68c21095f03366cb1acf1c828f77bff737a", "committedDate": "2020-02-27T02:52:19Z", "message": "Update tests for Search setting and Cloud setting;"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1Mzg1Nzg3", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-365385787", "createdAt": "2020-02-27T02:56:37Z", "commit": {"oid": "377bb68c21095f03366cb1acf1c828f77bff737a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/b2a92936dbeb981fd4636e5fc15a852ff6dac57e", "committedDate": "2020-02-27T03:35:21Z", "message": "Update doco and remove some useless code."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1Mzk2NDA5", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-365396409", "createdAt": "2020-02-27T03:38:18Z", "commit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDA0ODE0", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-365404814", "createdAt": "2020-02-27T04:13:52Z", "commit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxMzo1MlrOFvEutA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNjoxOVrOFvEwew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNDg4NA==", "bodyText": "When reading this class by itself it's going to seem a bit out of place to have a stray @JsonIgnore. So how about we add a comment:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              @JsonIgnore\n          \n          \n            \n              @JsonIgnore // The REST endpoints for this was split into two - one for general search settings, and one for filters - so we don't want this included in the general search settings.", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384904884", "createdAt": "2020-02-27T04:13:52Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.base/src/com/tle/common/settings/standard/SearchSettings.java", "diffHunk": "@@ -73,6 +74,7 @@\n   @Property(key = \"search.defaultsort\")\n   private String defaultSearchSort;\n \n+  @JsonIgnore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNTAyNg==", "bodyText": "No need to specify the Model classes here, as Swagger will document them for you based on method typings.", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384905026", "createdAt": "2020-02-27T04:14:48Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +87,46 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"search\")\n+  @ApiOperation(\n+    value = \"Load Search settings\",\n+    notes =\n+      \"This endpoint is used to retrieve general search settings excluding search filter. The corresponding Model class is SearchSettings.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNTMzOQ==", "bodyText": "As we add all these additional settings going forward we don't all want them in this one class. I suggest for each grouping we split them into their own class. So for below we'd probably add (in the same package):\n\nSearchSettingsResource\nCloudSearchSettingsResource\n\nAnd later\n\nSearchFiltersResource", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384905339", "createdAt": "2020-02-27T04:16:19Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +87,46 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"search\")\n+  @ApiOperation(\n+    value = \"Load Search settings\",\n+    notes =\n+      \"This endpoint is used to retrieve general search settings excluding search filter. The corresponding Model class is SearchSettings.\"\n+  )\n+  def loadSearchSettings: SearchSettings = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4cd453888965e620b8fe76ea6b097df523b65f1", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/d4cd453888965e620b8fe76ea6b097df523b65f1", "committedDate": "2020-02-27T05:25:12Z", "message": "Split different endpoints into their own class;"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDMxMTY0", "url": "https://github.com/openequella/openEQUELLA/pull/1509#pullrequestreview-365431164", "createdAt": "2020-02-27T06:00:59Z", "commit": {"oid": "d4cd453888965e620b8fe76ea6b097df523b65f1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "225165d38d9a2e68561138dd13bd39768cb10d7a", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/225165d38d9a2e68561138dd13bd39768cb10d7a", "committedDate": "2020-02-27T22:36:58Z", "message": "Reformat the comment for JsonIgnore"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 144, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}