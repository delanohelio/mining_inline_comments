{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNTI0NjMz", "number": 2139, "title": "Fix resumption token used in REST APIs", "bodyText": "#1735\nChecklist\n\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n tests are included\n screenshots are included showing significant UI changes\n documentation is changed or added\n\nDescription of change\nFixed the resumption token used in some REST APIs.\nThe testing environment for below screenshots has 5 items totally.\nFirst request with initial resumption token being 0:2. The length specified in params is ignored.\n\nSecond request with the token returned from last request\n\nThird request with the token returned from last request. No more token is returned.\n\nAnother request with an initial token which can retrieve all items so no token returned.\n\nAnother request with an invalid token. So use the length from query params instead.", "createdAt": "2020-08-04T04:42:23Z", "url": "https://github.com/openequella/openEQUELLA/pull/2139", "merged": true, "mergeCommit": {"oid": "a3e2534f01bf13015c6561083a0818df40c35aff"}, "closed": true, "closedAt": "2020-08-05T00:44:11Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7e6xxAH2gAyNDYyNTI0NjMzOjQzZTVmNDFiOTQ3YjliYjVmNGE3NGUxMDhkNGI5N2JiMjc1ZjIzZjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7v-4TAH2gAyNDYyNTI0NjMzOjI1MjU2OWY1YzJjN2QxZGRlYTJjZDg1NGQ4NzUxYzJkZjQyNWFiZjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "43e5f41b947b9bb5f4a74e108d4b97bb275f23f9", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/43e5f41b947b9bb5f4a74e108d4b97bb275f23f9", "committedDate": "2020-08-04T04:28:58Z", "message": "Fix resumption token used in REST APIs\n\n1. Make the length included in a resumption token higher priority\n   than the one specified in query params.\n2. Do not return a resumption token if no more items are available.\n3. Correctly generate resumption tokens"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMjU4NDQy", "url": "https://github.com/openequella/openEQUELLA/pull/2139#pullrequestreview-461258442", "createdAt": "2020-08-05T00:15:50Z", "commit": {"oid": "43e5f41b947b9bb5f4a74e108d4b97bb275f23f9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMDoxNTo1MFrOG71vUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMDoxNTo1MFrOG71vUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM5OTYzNA==", "bodyText": "I think putting results.length into its own variable impinges on readability later on. Let's not have actualLen and just use results.length.", "url": "https://github.com/openequella/openEQUELLA/pull/2139#discussion_r465399634", "createdAt": "2020-08-05T00:15:50Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/entity/PagedResults.scala", "diffHunk": "@@ -99,16 +100,18 @@ object PagedResults {\n       b\n     }\n \n-    val (nextOffset, results) = collectMore(length, firstOffset, 0, Vector.empty)\n-    val pb                    = new PagingBean[BEB]\n-    val actualLen             = results.length\n-    pb.setStart(start)\n+    val (_, results) = collectMore(_length, firstOffset, 0, Vector.empty)\n+    val pb           = new PagingBean[BEB]\n+    val actualLen    = results.length", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e5f41b947b9bb5f4a74e108d4b97bb275f23f9"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "252569f5c2c7d1ddea2cd854d8751c2df425abf7", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/252569f5c2c7d1ddea2cd854d8751c2df425abf7", "committedDate": "2020-08-05T00:21:50Z", "message": "Remove redundant variable to improve readability."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4868, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}