{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NzEyMjk1", "number": 2437, "title": "Feature/integrate new search page in selection section", "bodyText": "#1306\nChecklist\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n tests are included\n screenshots are included showing significant UI changes\n documentation is changed or added\n\nDescription of change\nThis PR integrates the new search UI into Selection Section.\nThe approach basically contains two steps:\n\n\nAdd new html files named NewSearchPage.html  and tsx files named NewSearchPage.tsx  under the js entry folders (entrydev and entrybuild),  and the tsx files incorporate the new search UI.\n\n\nOn server side, check if new search UI is enabled and if the request comes from Selection Session. If yes, then parse NewSearchPage.html and output the parsed contents to the section.\n\n\nAlso, I need to mention a couple things.\n\n\nSelection Session has three layouts: COURSE, SKINNY and NORMAL.  Both COURSE and NORMAL can display new search UI depending on the setting. For SKINNY, I talked to Charlie about how to trigger this layout but we have not found much useful information. All I know so far is this layout could be associated with Advanced Search. So I need some help here.\n\n\nCSS changes made in this PR also affect Resource Selector as it uses NORMAL layout.\n\n\nHere are two videos for COURSE and NORMAL\n#688", "createdAt": "2020-10-19T06:16:56Z", "url": "https://github.com/openequella/openEQUELLA/pull/2437", "merged": true, "mergeCommit": {"oid": "dae770afca38bf3d3d4a5b70e3fb081704dfd9a7"}, "closed": true, "closedAt": "2020-11-05T23:15:37Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 43, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdT7qGngH2gAyNTA1NzEyMjk1OmI5OWZjMGM2ZTdmNGJiNzMzMmU5NzZhNzU3YTQ0MTA3MzUzM2IzZTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZbwLSAH2gAyNTA1NzEyMjk1OjIwNDM3MTk5NDA2Y2FmODAwNjE2MmU3OTU4ZmMyZmE0MzAzNDgzNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b99fc0c6e7f4bb7332e976a757a441073533b3e6", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/b99fc0c6e7f4bb7332e976a757a441073533b3e6", "committedDate": "2020-10-19T03:32:11Z", "message": "Display new search ui in Selection Section."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf5b601a3818474255f3327418857202cb71fefe", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/bf5b601a3818474255f3327418857202cb71fefe", "committedDate": "2020-10-19T03:32:36Z", "message": "Add the new search page entry files in 'entrybuild'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "149699d1856b8ad7479daf79fe638a58ca2c2f7a", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/149699d1856b8ad7479daf79fe638a58ca2c2f7a", "committedDate": "2020-10-19T03:32:49Z", "message": "Rename the ID of new search page DIV."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2e7120b78cd11b66b06c72049a57facc0d32587", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/d2e7120b78cd11b66b06c72049a57facc0d32587", "committedDate": "2020-10-19T03:33:01Z", "message": "Fix a broken comment format for RootSearchSection."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c7f31a63d3f4a43a79c0fbdab192748a9f3d39b", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/8c7f31a63d3f4a43a79c0fbdab192748a9f3d39b", "committedDate": "2020-10-19T03:33:10Z", "message": "Selection Section CSS styles tweaks\n\n1. Make sure the new search UI display properly.\n2. Also improve other pages and the LMS side panel."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e0317a129fe3e54409b6c39ad572895fce45535", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7e0317a129fe3e54409b6c39ad572895fce45535", "committedDate": "2020-10-19T05:22:53Z", "message": "Show new search page in Selection Section when the mode is\n'structured'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c2d907eaea575b90e1ddd0e90a1e40d9f1e6ec2", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/5c2d907eaea575b90e1ddd0e90a1e40d9f1e6ec2", "committedDate": "2020-10-19T06:06:00Z", "message": "Improve the UI of Selection Section when it's in\n'selectOrAdd' mode."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e789f2060cf834d7216027c5b486eb1fb20801ef", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/e789f2060cf834d7216027c5b486eb1fb20801ef", "committedDate": "2020-10-19T22:26:13Z", "message": "Create header for RenderNewSearchPage.scala"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58d4cb55bbf970cf9dec9421315f3d6cf21295f1", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/58d4cb55bbf970cf9dec9421315f3d6cf21295f1", "committedDate": "2020-10-20T00:42:05Z", "message": "Ensure CSS changes made for Selection Section do not\napply to other UI pages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fd77379af2b162c92a40cbd6c274fed27d8f7f0", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7fd77379af2b162c92a40cbd6c274fed27d8f7f0", "committedDate": "2020-10-21T01:16:59Z", "message": "Remove MUI class name conflicts in production environment.\n\nLoading NewSearchPage.tsx in Selection Section with New UI turned\non causes MUI class name conflicts. For example, there would be\ntwo styles named 'jss1'. This can be fixed by using 'Class Name\ngenerator' to differentiate styles."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cc78ca3e58394efb5c6e1127469e8642ff08560", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/5cc78ca3e58394efb5c6e1127469e8642ff08560", "committedDate": "2020-10-21T03:28:30Z", "message": "Also display new search UI when Selection Session is in\nNORMAL layout."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/85357985dd7c44c219b455141f6df02331a6d0bc", "committedDate": "2020-10-21T03:45:01Z", "message": "Ensure new search UI displays properly with the Two Column\nLayout in Selection Session."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMzA0OTcw", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-513304970", "createdAt": "2020-10-21T04:52:51Z", "commit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNDo1Mjo1MVrOHlaMOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNDo1NToyMlrOHlaPFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk4ODQ3NA==", "bodyText": "I guess we don't need to use StylesProvider in dev environment ?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r508988474", "createdAt": "2020-10-21T04:52:51Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/entrydev/NewSearchPage.tsx", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { ThemeProvider } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import * as ReactDOM from \"react-dom\";\n+import { BrowserRouter } from \"react-router-dom\";\n+import { basePath } from \"../tsrc/mainui/App\";\n+import SearchPage from \"../tsrc/search/SearchPage\";\n+import { oeqTheme } from \"../tsrc/theme\";\n+\n+const searchPageProps = { updateTemplate: () => {} };\n+const renderSearchPage = () => {\n+  ReactDOM.render(\n+    <BrowserRouter basename={basePath}>\n+      <ThemeProvider theme={oeqTheme}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk4OTA1MA==", "bodyText": "This 100vw will cause a problem - when there is a vertical scroll bar, the actual width of the page is bigger than 100vw, so a horizontal scroll bar gets displayed. If  100% is used instead, then we also need to add 100% to <main>...</main>, which seems to require some fundamental changes in template.tsx.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r508989050", "createdAt": "2020-10-21T04:54:54Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4461,22 +4472,37 @@ img.warningimg {\n }\n \n #selection-page {\n-  margin: 0 auto;\n-  width: 784px;\n-  position: relative;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  // The width of this div is Full viewport width minus vertical scrollbar width.\n+  // Ideally we should us JS to get scrollbar width.\n+  width: 100vw;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk4OTIwNQ==", "bodyText": "I just forgot to remove this comment. But I think we need to do what this comment says with JS in future EBP work so I did not do it now.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r508989205", "createdAt": "2020-10-21T04:55:22Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4461,22 +4472,37 @@ img.warningimg {\n }\n \n #selection-page {\n-  margin: 0 auto;\n-  width: 784px;\n-  position: relative;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  // The width of this div is Full viewport width minus vertical scrollbar width.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzQ1OTY0", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-515345964", "createdAt": "2020-10-23T05:09:02Z", "commit": {"oid": "b99fc0c6e7f4bb7332e976a757a441073533b3e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNTowOTowMlrOHm8SVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNTowOTowMlrOHm8SVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU5NTY3MA==", "bodyText": "So this file is only for displaying the New Search Page inside a selection session? If so, could the filename be modified to reflect this?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510595670", "createdAt": "2020-10-23T05:09:02Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/entrydev/NewSearchPage.html", "diffHunk": "@@ -0,0 +1,3 @@\n+<div id=\"newSearchPage\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b99fc0c6e7f4bb7332e976a757a441073533b3e6"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MzUzNzQ1", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-515353745", "createdAt": "2020-10-23T05:22:26Z", "commit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNToyMjoyNlrOHm868A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNTo0NDozOVrOHm-JoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYwNjA2NA==", "bodyText": "Would it be good to keep it shorter and go with something specific to oEQ. Maybe oeq-nsp. Then maybe we should also specify one for our normal full build - perhaps just oeq.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510606064", "createdAt": "2020-10-23T05:22:26Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/entrybuild/NewSearchPage.tsx", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { ThemeProvider } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import * as ReactDOM from \"react-dom\";\n+import { BrowserRouter } from \"react-router-dom\";\n+import { basePath } from \"../tsrc/mainui/App\";\n+import SearchPage from \"../tsrc/search/SearchPage\";\n+import { oeqTheme } from \"../tsrc/theme\";\n+import { StylesProvider, createGenerateClassName } from \"@material-ui/core\";\n+\n+const searchPageProps = { updateTemplate: () => {} };\n+const generateClassName = createGenerateClassName({\n+  productionPrefix: \"new-search-page\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYwNjM1Mw==", "bodyText": "I think we should keep it the same for both.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510606353", "createdAt": "2020-10-23T05:22:43Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/entrydev/NewSearchPage.tsx", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { ThemeProvider } from \"@material-ui/core\";\n+import * as React from \"react\";\n+import * as ReactDOM from \"react-dom\";\n+import { BrowserRouter } from \"react-router-dom\";\n+import { basePath } from \"../tsrc/mainui/App\";\n+import SearchPage from \"../tsrc/search/SearchPage\";\n+import { oeqTheme } from \"../tsrc/theme\";\n+\n+const searchPageProps = { updateTemplate: () => {} };\n+const renderSearchPage = () => {\n+  ReactDOM.render(\n+    <BrowserRouter basename={basePath}>\n+      <ThemeProvider theme={oeqTheme}>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk4ODQ3NA=="}, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYwOTY5MA==", "bodyText": "Why 98%? Could be handy to add a comment here.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510609690", "createdAt": "2020-10-23T05:26:25Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4461,22 +4472,37 @@ img.warningimg {\n }\n \n #selection-page {\n-  margin: 0 auto;\n-  width: 784px;\n-  position: relative;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  // The width of this div is Full viewport width minus vertical scrollbar width.\n+  // Ideally we should us JS to get scrollbar width.\n+  width: 100vw;\n+  overflow-x: hidden;\n }\n \n #selection-content {\n   background: url(../images/content-middle.gif) repeat-y 0px 0px;\n-  position: relative;\n-  width: 784px;\n-  float: left;\n+  width: 98%;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYwOTg0Mw==", "bodyText": "Why 98%? Could be handy to add a comment here.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510609843", "createdAt": "2020-10-23T05:26:34Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4461,22 +4472,37 @@ img.warningimg {\n }\n \n #selection-page {\n-  margin: 0 auto;\n-  width: 784px;\n-  position: relative;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  // The width of this div is Full viewport width minus vertical scrollbar width.\n+  // Ideally we should us JS to get scrollbar width.\n+  width: 100vw;\n+  overflow-x: hidden;\n }\n \n #selection-content {\n   background: url(../images/content-middle.gif) repeat-y 0px 0px;\n-  position: relative;\n-  width: 784px;\n-  float: left;\n+  width: 98%;\n }\n \n #selection-content #breadcrumb-inner {\n   margin-left: 18px;\n }\n \n+#selection-content #new-search-page {\n+  margin: 0 15px 0 0;\n+  width: 80%;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYxMDI3NQ==", "bodyText": "I believe there is a variable along the lines of $doubleMargin which is 16px. Would that be appropriate here?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510610275", "createdAt": "2020-10-23T05:27:04Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4461,22 +4472,37 @@ img.warningimg {\n }\n \n #selection-page {\n-  margin: 0 auto;\n-  width: 784px;\n-  position: relative;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  // The width of this div is Full viewport width minus vertical scrollbar width.\n+  // Ideally we should us JS to get scrollbar width.\n+  width: 100vw;\n+  overflow-x: hidden;\n }\n \n #selection-content {\n   background: url(../images/content-middle.gif) repeat-y 0px 0px;\n-  position: relative;\n-  width: 784px;\n-  float: left;\n+  width: 98%;\n }\n \n #selection-content #breadcrumb-inner {\n   margin-left: 18px;\n }\n \n+#selection-content #new-search-page {\n+  margin: 0 15px 0 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYyMDkzMA==", "bodyText": "The below code is not immediately clear, as it seems it has gone more with a pattern of augmentation. I wonder if instead the above code can be broken into a few useful private methods, and then further up in this method the below if becomes part of an if/else.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510620930", "createdAt": "2020-10-23T05:39:00Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/src/com/tle/web/search/base/AbstractRootSearchSection.java", "diffHunk": "@@ -104,6 +106,20 @@ protected TemplateResult getTemplateResult(RenderEventContext info) {\n     templateResult.addNamedResult(\n         OneColumnLayout.BODY, CombinedRenderer.combineMultipleResults(cssIncludes));\n \n+    // If new search UI should be rendered, keep the right column content and override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYyMTMxOA==", "bodyText": "Could this fail to getNamedResult?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510621318", "createdAt": "2020-10-23T05:39:23Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/src/com/tle/web/search/base/AbstractRootSearchSection.java", "diffHunk": "@@ -104,6 +106,20 @@ protected TemplateResult getTemplateResult(RenderEventContext info) {\n     templateResult.addNamedResult(\n         OneColumnLayout.BODY, CombinedRenderer.combineMultipleResults(cssIncludes));\n \n+    // If new search UI should be rendered, keep the right column content and override\n+    // the body content with new search UI.\n+    if (model.isNewSearchUIInNormalLayout()) {\n+      TemplateRenderable rightColumnContent =\n+          templateResult.getNamedResult(info, TwoColumnLayout.RIGHT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYyMjA5Mg==", "bodyText": "I reckon a bit of JavaDoc would go a long way here to help readers understand what you mean by 'Normal Layout'.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510622092", "createdAt": "2020-10-23T05:40:07Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/src/com/tle/web/search/base/AbstractRootSearchSection.java", "diffHunk": "@@ -150,5 +168,21 @@ public InfoBookmark getPermanentUrl() {\n     public void setPermanentUrl(InfoBookmark permanentUrl) {\n       this.permanentUrl = permanentUrl;\n     }\n+\n+    public boolean isNewSearchUIInNormalLayout() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDYyNjIwOQ==", "bodyText": "Should this be an else if, and then follow with an else to throw an IllegalStateException if we've ended up with an unexpected Layout? Or are there only two Layouts? (Maybe if there are only two, we might want to protect from the unknown future.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r510626209", "createdAt": "2020-10-23T05:44:39Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/src/com/tle/web/searching/section/RootSearchSection.java", "diffHunk": "@@ -80,6 +85,21 @@ public SectionResult renderHtml(RenderEventContext context) {\n       throw new AccessDeniedException(\n           urlHelper.getString(\"missingprivileges\", WebConstants.SEARCH_PAGE_PRIVILEGE));\n     }\n+\n+    // If this method is triggered from Selection Section, then check if Selection Section\n+    // is in 'structured' mode. If yes, then render the new search page if it's enabled.\n+    SelectionSession selectionSession = selectionService.getCurrentSession(context);\n+    if (isNewSearchUIInSelectionSession(selectionSession)) {\n+      SimpleSectionResult newSearchUIContent = RenderNewSearchPage.renderNewSearchPage(context);\n+      // For 'structured' layout, output the new search UI content directly.\n+      // For 'addOrSelected' layout, save the content in model.\n+      if (selectionSession.getLayout() == Layout.COURSE) {\n+        return newSearchUIContent;\n+      } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85357985dd7c44c219b455141f6df02331a6d0bc"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "188bd95b7208f07a32d0ac4363d860e8c4859fd1", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/188bd95b7208f07a32d0ac4363d860e8c4859fd1", "committedDate": "2020-10-26T01:08:19Z", "message": "Remove folder 'entrydev' and rename 'entrybuild' to\n'entrypoint'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aca1cbbaa9a34ce4f10abf48eaaa1c8452ae9d83", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/aca1cbbaa9a34ce4f10abf48eaaa1c8452ae9d83", "committedDate": "2020-10-26T02:56:46Z", "message": "Update the js entry path used in 'package.json' and\n'tsconfig.json'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7932628147cb14e39b80f6ccf352393d99134685", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7932628147cb14e39b80f6ccf352393d99134685", "committedDate": "2020-10-26T03:23:31Z", "message": "Let the default function of 'index.tsx' take an argument\nwhich indicates where the function is called."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d944d3eb4f1971f9534b2feabc6f653f484c1e7f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/d944d3eb4f1971f9534b2feabc6f653f484c1e7f", "committedDate": "2020-10-26T03:40:56Z", "message": "Update the html and ts files under 'entrypoint'\n\n1. Each html file now has their own ts file.\n2. Each ts file calls the default function of 'Index.tsx' with\na string literal argument."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15573e4944b3e89d18fe18612c4c19611b5d4901", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/15573e4944b3e89d18fe18612c4c19611b5d4901", "committedDate": "2020-10-26T05:42:22Z", "message": "Use 'runtypes' to determine what component should be rendered."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f37e4482cd9384e989c3d106a70052600ebe14cc", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/f37e4482cd9384e989c3d106a70052600ebe14cc", "committedDate": "2020-10-27T02:56:33Z", "message": "Use 'runtypes' to match the entry JS file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a76ecc0b149d3e0c1d493a8c51bb5df1ad9af0b", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/3a76ecc0b149d3e0c1d493a8c51bb5df1ad9af0b", "committedDate": "2020-10-27T04:58:25Z", "message": "More Css work for selection session\n\n1. Make sure all pages have consistent horizontal margin by reusing\npre-defined variable '$doubleMargin'.\n\n2. Improve the LMS side panel in Normal layout.\n\n3. Adjust the width of contribution page.\n\n4. Add comments to explain the purposes of some styles."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1263d7e562fd1bf35830c0efe32e51da0342e01", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/a1263d7e562fd1bf35830c0efe32e51da0342e01", "committedDate": "2020-10-28T01:05:01Z", "message": "Refactor the logic of generating contents of AbstractRootSearchSection."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63ad4a65b5a31f9f4e13c35742441a24b80adcdf", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/63ad4a65b5a31f9f4e13c35742441a24b80adcdf", "committedDate": "2020-10-28T01:06:11Z", "message": "Override the CSS of 'mainCols' and 'col2' in different contexts."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecd45a7d8cb01ca66324ebf3898ef3c85d591d45", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/ecd45a7d8cb01ca66324ebf3898ef3c85d591d45", "committedDate": "2020-10-29T06:57:32Z", "message": "Update how to render new search UI in selection\nsession.\n\nThe previous approach results in unnecessary DOM tree\ndifferences: in COURSE layout new search UI is just under\n'selection-content-inner' whereas in NORMAL layout it is\nunder 'selection-content-inner/mainCols/col1'. This commit\nensure the DOM tree keeps consistent. By doing this, some\nCSS styles made previously can be removed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a", "committedDate": "2020-10-29T08:42:07Z", "message": "Remove unused imports in RootSearchSection"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMTM4ODIw", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-520138820", "createdAt": "2020-10-29T22:40:40Z", "commit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMjo0MDo0MVrOHqxLbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwMTowMjo0OVrOHqz2lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYwNzk4MQ==", "bodyText": "How about merging into a single parcelEntryFiles? It'd make things a bit simpler, as we don't need this fragmentation.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514607981", "createdAt": "2020-10-29T22:40:41Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/package.json", "diffHunk": "@@ -9,20 +9,23 @@\n     \"dist\": \"target/resources/web/reactjs\",\n     \"jest\": {\n       \"verbose\": true\n-    }\n+    },\n+    \"entryHtml\": \"entrypoint/*.html\",\n+    \"entryScript\": \"entrypoint/scripts/*.js\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYwODYwNA==", "bodyText": "Should be a pinned version. Mind you though, this is now on develop, so whether you want to merge into component and then into this one......", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514608604", "createdAt": "2020-10-29T22:42:18Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/package.json", "diffHunk": "@@ -60,7 +63,8 @@\n     \"typescript-fsa\": \"2.5.0\",\n     \"typescript-fsa-reducers\": \"0.4.5\",\n     \"uuid\": \"8.3.1\",\n-    \"wicked-good-xpath\": \"1.3.0\"\n+    \"wicked-good-xpath\": \"1.3.0\",\n+    \"runtypes\": \"^5.0.1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY0Mjc1MA==", "bodyText": "My understanding of this config value is that it's really only used for the output of the purescript upload component which has historically gone into a target folder within the entry folders. With all that in mind I suggest a few things:\n\nThis folder should just use the shared target/ folder;\nAs a result, this config value becomes redundant - so don't add it - simply use that path prefix down in the bundleps:uploadlist task; and\nUpdate the require in entrypoint/scripts/uploadlist.js to be require(\"../../target/uploadlist.js\")\n\nThis will have the added bonus that the clean script will now also clean this previously missed file.\n(This is not a perfect solution, that would require a whole lot of extra tidy up of this package.json - but that's well outside the scope of this PR. We really need to better organise the output and target directories - and understand if we even need pulp)", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514642750", "createdAt": "2020-10-30T00:33:42Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/package.json", "diffHunk": "@@ -9,20 +9,23 @@\n     \"dist\": \"target/resources/web/reactjs\",\n     \"jest\": {\n       \"verbose\": true\n-    }\n+    },\n+    \"entryHtml\": \"entrypoint/*.html\",\n+    \"entryScript\": \"entrypoint/scripts/*.js\",\n+    \"entryTarget\": \"entrypoint/target\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY0ODA4Mw==", "bodyText": "Nit (just maybe a bit more understandable as to intention).\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const emptyFunc = () => {};\n          \n          \n            \n              const nop = () => {};", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514648083", "createdAt": "2020-10-30T00:53:50Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/App.tsx", "diffHunk": "@@ -183,95 +193,145 @@ function IndexPage() {\n   }\n \n   return (\n-    <BrowserRouter\n-      basename={basePath}\n-      getUserConfirmation={(message, cb) => {\n-        if (errorShowing.current) {\n-          errorShowing.current = false;\n-          setFullPageError(undefined);\n-          cb(true);\n-        } else {\n-          setNavAwayCallback({ message, cb });\n-        }\n-      }}\n-    >\n-      <Prompt\n-        when={Boolean(preventNavMessage) || errorShowing.current}\n-        message={nonBlankNavMessage}\n-      />\n-      <NavAwayDialog\n-        open={Boolean(navAwayCallback)}\n-        message={nonBlankNavMessage}\n-        navigateConfirm={(confirm) => {\n-          if (navAwayCallback) navAwayCallback.cb(confirm);\n-          if (confirm) setPreventNavMessage(undefined);\n-          setNavAwayCallback(undefined);\n+    <ThemeProvider theme={oeqTheme}>\n+      <BrowserRouter\n+        basename={basePath}\n+        getUserConfirmation={(message, cb) => {\n+          if (errorShowing.current) {\n+            errorShowing.current = false;\n+            setFullPageError(undefined);\n+            cb(true);\n+          } else {\n+            setNavAwayCallback({ message, cb });\n+          }\n         }}\n-      />\n-      <LegacyContent\n-        {...legacyContentProps}\n-        render={(content) => {\n-          const tp = content\n-            ? templatePropsForLegacy(content)\n-            : {\n-                ...templateProps,\n-                fullscreenMode: legacyContentProps.enabled\n-                  ? templateProps.fullscreenMode\n-                  : undefined,\n-              };\n-          const withErr = fullPageError\n-            ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n-            : tp;\n-          const template = (\n-            <Template {...withErr} currentUser={currentUser}>\n-              {routeSwitch(content)}\n-            </Template>\n-          );\n-          const render = () => {\n-            if (!content || content.noForm) {\n-              return template;\n-            } else {\n-              const { form } = content.html;\n-              return (\n-                <>\n-                  <LegacyForm state={content.state}>{template}</LegacyForm>\n-                  {form && HtmlParser(form)}\n-                </>\n-              );\n-            }\n-          };\n-          return render();\n-        }}\n-      />\n-    </BrowserRouter>\n+      >\n+        <Prompt\n+          when={Boolean(preventNavMessage) || errorShowing.current}\n+          message={nonBlankNavMessage}\n+        />\n+        <NavAwayDialog\n+          open={Boolean(navAwayCallback)}\n+          message={nonBlankNavMessage}\n+          navigateConfirm={(confirm) => {\n+            if (navAwayCallback) navAwayCallback.cb(confirm);\n+            if (confirm) setPreventNavMessage(undefined);\n+            setNavAwayCallback(undefined);\n+          }}\n+        />\n+        <LegacyContent\n+          {...legacyContentProps}\n+          render={(content) => {\n+            const tp = content\n+              ? templatePropsForLegacy(content)\n+              : {\n+                  ...templateProps,\n+                  fullscreenMode: legacyContentProps.enabled\n+                    ? templateProps.fullscreenMode\n+                    : undefined,\n+                };\n+            const withErr = fullPageError\n+              ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n+              : tp;\n+            const template = (\n+              <Template {...withErr} currentUser={currentUser}>\n+                {routeSwitch(content)}\n+              </Template>\n+            );\n+            const render = () => {\n+              if (!content || content.noForm) {\n+                return template;\n+              } else {\n+                const { form } = content.html;\n+                return (\n+                  <>\n+                    <LegacyForm state={content.state}>{template}</LegacyForm>\n+                    {form && HtmlParser(form)}\n+                  </>\n+                );\n+              }\n+            };\n+            return render();\n+          }}\n+        />\n+      </BrowserRouter>\n+    </ThemeProvider>\n   );\n }\n \n-interface AppProps {\n-  legacySettingsMode: boolean;\n+interface NewPageProps {\n+  page: ReactNode;\n+  classPrefix: string;\n+  isOpenInSelectonSession: boolean;\n }\n \n-export const App = ({ legacySettingsMode }: AppProps) => {\n-  if (legacySettingsMode) {\n-    return (\n-      <BrowserRouter basename={basePath} forceRefresh>\n-        <ThemeProvider theme={oeqTheme}>\n-          <SettingsPage\n-            refreshUser={() => {}}\n-            updateTemplate={() => {}}\n-            isReloadNeeded={false}\n-          />\n-        </ThemeProvider>\n-      </BrowserRouter>\n-    );\n-  } else {\n-    startHeartbeat();\n-    return (\n+/**\n+ * Build a single oEQ new UI page.\n+ * @param page A tsx page such as SearchPage.tsx\n+ * @param forceRefresh Whether to refresh the page when navigating to different route\n+ * @param classPrefix The prefix added in MUI styles\n+ */\n+function NewPage({ page, isOpenInSelectonSession, classPrefix }: NewPageProps) {\n+  const generateClassName = createGenerateClassName({\n+    productionPrefix: classPrefix,\n+  });\n+\n+  return (\n+    <StylesProvider generateClassName={generateClassName}>\n       <ThemeProvider theme={oeqTheme}>\n-        <IndexPage />\n+        <BrowserRouter\n+          basename={basePath}\n+          forceRefresh={!isOpenInSelectonSession}\n+        >\n+          {page}\n+        </BrowserRouter>\n       </ThemeProvider>\n-    );\n-  }\n+    </StylesProvider>\n+  );\n+}\n+\n+interface AppProps {\n+  entryPage: EntryPage;\n+}\n+\n+const App = ({ entryPage }: AppProps) => {\n+  const emptyFunc = () => {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 229}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY0ODcxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              page: ReactNode;\n          \n          \n            \n              children: ReactNode;\n          \n      \n    \n    \n  \n\nAnd then that way below you can go with the more usual:\n<NewPage>\n  <SettingsPage ... />\n</NewPage>\n\nRather than the current slightly unusual:\n<NewPage\n  page={(<SettingsPage .../>})\n/>\n\n(It was that unusual pattern that caught my eye.)", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514648713", "createdAt": "2020-10-30T00:56:23Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/App.tsx", "diffHunk": "@@ -183,95 +193,145 @@ function IndexPage() {\n   }\n \n   return (\n-    <BrowserRouter\n-      basename={basePath}\n-      getUserConfirmation={(message, cb) => {\n-        if (errorShowing.current) {\n-          errorShowing.current = false;\n-          setFullPageError(undefined);\n-          cb(true);\n-        } else {\n-          setNavAwayCallback({ message, cb });\n-        }\n-      }}\n-    >\n-      <Prompt\n-        when={Boolean(preventNavMessage) || errorShowing.current}\n-        message={nonBlankNavMessage}\n-      />\n-      <NavAwayDialog\n-        open={Boolean(navAwayCallback)}\n-        message={nonBlankNavMessage}\n-        navigateConfirm={(confirm) => {\n-          if (navAwayCallback) navAwayCallback.cb(confirm);\n-          if (confirm) setPreventNavMessage(undefined);\n-          setNavAwayCallback(undefined);\n+    <ThemeProvider theme={oeqTheme}>\n+      <BrowserRouter\n+        basename={basePath}\n+        getUserConfirmation={(message, cb) => {\n+          if (errorShowing.current) {\n+            errorShowing.current = false;\n+            setFullPageError(undefined);\n+            cb(true);\n+          } else {\n+            setNavAwayCallback({ message, cb });\n+          }\n         }}\n-      />\n-      <LegacyContent\n-        {...legacyContentProps}\n-        render={(content) => {\n-          const tp = content\n-            ? templatePropsForLegacy(content)\n-            : {\n-                ...templateProps,\n-                fullscreenMode: legacyContentProps.enabled\n-                  ? templateProps.fullscreenMode\n-                  : undefined,\n-              };\n-          const withErr = fullPageError\n-            ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n-            : tp;\n-          const template = (\n-            <Template {...withErr} currentUser={currentUser}>\n-              {routeSwitch(content)}\n-            </Template>\n-          );\n-          const render = () => {\n-            if (!content || content.noForm) {\n-              return template;\n-            } else {\n-              const { form } = content.html;\n-              return (\n-                <>\n-                  <LegacyForm state={content.state}>{template}</LegacyForm>\n-                  {form && HtmlParser(form)}\n-                </>\n-              );\n-            }\n-          };\n-          return render();\n-        }}\n-      />\n-    </BrowserRouter>\n+      >\n+        <Prompt\n+          when={Boolean(preventNavMessage) || errorShowing.current}\n+          message={nonBlankNavMessage}\n+        />\n+        <NavAwayDialog\n+          open={Boolean(navAwayCallback)}\n+          message={nonBlankNavMessage}\n+          navigateConfirm={(confirm) => {\n+            if (navAwayCallback) navAwayCallback.cb(confirm);\n+            if (confirm) setPreventNavMessage(undefined);\n+            setNavAwayCallback(undefined);\n+          }}\n+        />\n+        <LegacyContent\n+          {...legacyContentProps}\n+          render={(content) => {\n+            const tp = content\n+              ? templatePropsForLegacy(content)\n+              : {\n+                  ...templateProps,\n+                  fullscreenMode: legacyContentProps.enabled\n+                    ? templateProps.fullscreenMode\n+                    : undefined,\n+                };\n+            const withErr = fullPageError\n+              ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n+              : tp;\n+            const template = (\n+              <Template {...withErr} currentUser={currentUser}>\n+                {routeSwitch(content)}\n+              </Template>\n+            );\n+            const render = () => {\n+              if (!content || content.noForm) {\n+                return template;\n+              } else {\n+                const { form } = content.html;\n+                return (\n+                  <>\n+                    <LegacyForm state={content.state}>{template}</LegacyForm>\n+                    {form && HtmlParser(form)}\n+                  </>\n+                );\n+              }\n+            };\n+            return render();\n+          }}\n+        />\n+      </BrowserRouter>\n+    </ThemeProvider>\n   );\n }\n \n-interface AppProps {\n-  legacySettingsMode: boolean;\n+interface NewPageProps {\n+  page: ReactNode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY0OTA1Nw==", "bodyText": "Be advised that this component has been pushed out into its own .tsx file on develop to assist with lazy loading. So I'd suggest you get that stuff merged across as you'll need to do the same (lazy loading) here/below.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514649057", "createdAt": "2020-10-30T00:57:53Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/App.tsx", "diffHunk": "@@ -57,6 +64,9 @@ export const basePath = baseFullPath.substr(0, baseFullPath.length - 1);\n \n declare const renderData: RenderData | undefined;\n \n+/**\n+ * Build the full oEQ Index page.\n+ */\n function IndexPage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY0OTgzMQ==", "bodyText": "Nice work with the pattern matching. Very tidy. \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514649831", "createdAt": "2020-10-30T00:59:31Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/mainui/App.tsx", "diffHunk": "@@ -183,95 +193,145 @@ function IndexPage() {\n   }\n \n   return (\n-    <BrowserRouter\n-      basename={basePath}\n-      getUserConfirmation={(message, cb) => {\n-        if (errorShowing.current) {\n-          errorShowing.current = false;\n-          setFullPageError(undefined);\n-          cb(true);\n-        } else {\n-          setNavAwayCallback({ message, cb });\n-        }\n-      }}\n-    >\n-      <Prompt\n-        when={Boolean(preventNavMessage) || errorShowing.current}\n-        message={nonBlankNavMessage}\n-      />\n-      <NavAwayDialog\n-        open={Boolean(navAwayCallback)}\n-        message={nonBlankNavMessage}\n-        navigateConfirm={(confirm) => {\n-          if (navAwayCallback) navAwayCallback.cb(confirm);\n-          if (confirm) setPreventNavMessage(undefined);\n-          setNavAwayCallback(undefined);\n+    <ThemeProvider theme={oeqTheme}>\n+      <BrowserRouter\n+        basename={basePath}\n+        getUserConfirmation={(message, cb) => {\n+          if (errorShowing.current) {\n+            errorShowing.current = false;\n+            setFullPageError(undefined);\n+            cb(true);\n+          } else {\n+            setNavAwayCallback({ message, cb });\n+          }\n         }}\n-      />\n-      <LegacyContent\n-        {...legacyContentProps}\n-        render={(content) => {\n-          const tp = content\n-            ? templatePropsForLegacy(content)\n-            : {\n-                ...templateProps,\n-                fullscreenMode: legacyContentProps.enabled\n-                  ? templateProps.fullscreenMode\n-                  : undefined,\n-              };\n-          const withErr = fullPageError\n-            ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n-            : tp;\n-          const template = (\n-            <Template {...withErr} currentUser={currentUser}>\n-              {routeSwitch(content)}\n-            </Template>\n-          );\n-          const render = () => {\n-            if (!content || content.noForm) {\n-              return template;\n-            } else {\n-              const { form } = content.html;\n-              return (\n-                <>\n-                  <LegacyForm state={content.state}>{template}</LegacyForm>\n-                  {form && HtmlParser(form)}\n-                </>\n-              );\n-            }\n-          };\n-          return render();\n-        }}\n-      />\n-    </BrowserRouter>\n+      >\n+        <Prompt\n+          when={Boolean(preventNavMessage) || errorShowing.current}\n+          message={nonBlankNavMessage}\n+        />\n+        <NavAwayDialog\n+          open={Boolean(navAwayCallback)}\n+          message={nonBlankNavMessage}\n+          navigateConfirm={(confirm) => {\n+            if (navAwayCallback) navAwayCallback.cb(confirm);\n+            if (confirm) setPreventNavMessage(undefined);\n+            setNavAwayCallback(undefined);\n+          }}\n+        />\n+        <LegacyContent\n+          {...legacyContentProps}\n+          render={(content) => {\n+            const tp = content\n+              ? templatePropsForLegacy(content)\n+              : {\n+                  ...templateProps,\n+                  fullscreenMode: legacyContentProps.enabled\n+                    ? templateProps.fullscreenMode\n+                    : undefined,\n+                };\n+            const withErr = fullPageError\n+              ? { ...tp, title: fullPageError.error, fullscreenMode: undefined }\n+              : tp;\n+            const template = (\n+              <Template {...withErr} currentUser={currentUser}>\n+                {routeSwitch(content)}\n+              </Template>\n+            );\n+            const render = () => {\n+              if (!content || content.noForm) {\n+                return template;\n+              } else {\n+                const { form } = content.html;\n+                return (\n+                  <>\n+                    <LegacyForm state={content.state}>{template}</LegacyForm>\n+                    {form && HtmlParser(form)}\n+                  </>\n+                );\n+              }\n+            };\n+            return render();\n+          }}\n+        />\n+      </BrowserRouter>\n+    </ThemeProvider>\n   );\n }\n \n-interface AppProps {\n-  legacySettingsMode: boolean;\n+interface NewPageProps {\n+  page: ReactNode;\n+  classPrefix: string;\n+  isOpenInSelectonSession: boolean;\n }\n \n-export const App = ({ legacySettingsMode }: AppProps) => {\n-  if (legacySettingsMode) {\n-    return (\n-      <BrowserRouter basename={basePath} forceRefresh>\n-        <ThemeProvider theme={oeqTheme}>\n-          <SettingsPage\n-            refreshUser={() => {}}\n-            updateTemplate={() => {}}\n-            isReloadNeeded={false}\n-          />\n-        </ThemeProvider>\n-      </BrowserRouter>\n-    );\n-  } else {\n-    startHeartbeat();\n-    return (\n+/**\n+ * Build a single oEQ new UI page.\n+ * @param page A tsx page such as SearchPage.tsx\n+ * @param forceRefresh Whether to refresh the page when navigating to different route\n+ * @param classPrefix The prefix added in MUI styles\n+ */\n+function NewPage({ page, isOpenInSelectonSession, classPrefix }: NewPageProps) {\n+  const generateClassName = createGenerateClassName({\n+    productionPrefix: classPrefix,\n+  });\n+\n+  return (\n+    <StylesProvider generateClassName={generateClassName}>\n       <ThemeProvider theme={oeqTheme}>\n-        <IndexPage />\n+        <BrowserRouter\n+          basename={basePath}\n+          forceRefresh={!isOpenInSelectonSession}\n+        >\n+          {page}\n+        </BrowserRouter>\n       </ThemeProvider>\n-    );\n-  }\n+    </StylesProvider>\n+  );\n+}\n+\n+interface AppProps {\n+  entryPage: EntryPage;\n+}\n+\n+const App = ({ entryPage }: AppProps) => {\n+  const emptyFunc = () => {};\n+  const renderApp = match(\n+    [\n+      Literal(\"mainDiv\"),\n+      () => {\n+        startHeartbeat();\n+        return <IndexPage />;\n+      },\n+    ],\n+    [\n+      Literal(\"searchPage\"),\n+      () => (\n+        <NewPage\n+          page={<SearchPage updateTemplate={emptyFunc} />}\n+          classPrefix=\"oeq-nsp\"\n+          isOpenInSelectonSession\n+        />\n+      ),\n+    ],\n+    [\n+      Literal(\"settingsPage\"),\n+      () => (\n+        <NewPage\n+          page={\n+            <SettingsPage\n+              refreshUser={emptyFunc}\n+              updateTemplate={emptyFunc}\n+              isReloadNeeded={false}\n+            />\n+          }\n+          classPrefix=\"oeq-nst\"\n+          isOpenInSelectonSession={false}\n+        />\n+      ),\n+    ]\n+  );\n+  return renderApp(entryPage);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 265}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY1MTYzNw==", "bodyText": "You probably want to look at using curvedCorners mixin whenever you find yourself doing this.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514651637", "createdAt": "2020-10-30T01:02:36Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4701,12 +4720,13 @@ div#sssh_finishedButton {\n   border: none;\n   box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);\n   background: none;\n+  border-radius: 4px;\n }\n \n .box_head {\n   background-color: white;\n   border: none;\n-\n+  border-radius: 4px;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDY1MTc5OA==", "bodyText": "As above, look at using curvedCorners.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r514651798", "createdAt": "2020-10-30T01:02:49Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4720,6 +4740,7 @@ div#sssh_finishedButton {\n .box_content {\n   background: none;\n   border: none;\n+  border-radius: 4px;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b20cfec6310061e7e6c898feae5a2a0a6e8e0c0a"}, "originalPosition": 142}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ce22a021f6a69b69c19ed9424ccb697e98c5b9f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/5ce22a021f6a69b69c19ed9424ccb697e98c5b9f", "committedDate": "2020-11-02T05:43:12Z", "message": "Merge branch 'component/new-search-page-in-selection-section' into feature/integrate-new-search-page-in-selection-section"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16122511c64fad3d2c788bef7c7536337bbe2082", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/16122511c64fad3d2c788bef7c7536337bbe2082", "committedDate": "2020-11-02T05:44:41Z", "message": "Use the pinned version of 'runtypes'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ae3500c57175e0a27447c9a3c715063e4ca64c3", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/9ae3500c57175e0a27447c9a3c715063e4ca64c3", "committedDate": "2020-11-02T05:51:08Z", "message": "Wrap component IndexPage by ThemeProvider in App.tsx."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "839057e9546c2fb6b871a864c10366a0e14e1aec", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/839057e9546c2fb6b871a864c10366a0e14e1aec", "committedDate": "2020-11-02T06:04:48Z", "message": "Reuse sass mixin 'curvedCorners' in CSS class 'box_head'\nand 'box_content'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d91192b3da938c05138ac8705a6368c8157eb4cd", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/d91192b3da938c05138ac8705a6368c8157eb4cd", "committedDate": "2020-11-02T22:30:59Z", "message": "A couple tweaks for 'App.tsx'.\n\n1. Rename 'page' to 'children' for 'NewPageProps' and update\nhow 'children' is passed into 'NewPage'.\n2. Rename function 'emptyFunc' to 'nop'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4084222b0d63147b1e9805de09e700274882465", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/b4084222b0d63147b1e9805de09e700274882465", "committedDate": "2020-11-03T02:45:40Z", "message": "Move the compiled 'uploadlist.js' to the correct target folder."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c636222ec7d9916f7155ad8dfec057e63cf8ef2", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7c636222ec7d9916f7155ad8dfec057e63cf8ef2", "committedDate": "2020-11-03T03:04:14Z", "message": "Clean up the NPM scripts for Parcel build/watch."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553", "committedDate": "2020-11-04T04:25:00Z", "message": "Update react route to ensure new search UI displays\nproperly in Selection Session."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzODkxODk5", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-523891899", "createdAt": "2020-11-05T02:58:39Z", "commit": {"oid": "7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwMjo1ODozOVrOHtx0Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwMjo1ODozOVrOHtx0Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc2NDA5OQ==", "bodyText": "Oooh, this looks like something recently added to fix EBP stuff for 2020.2. Removing it's not removing a fix is it?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r517764099", "createdAt": "2020-11-05T02:58:39Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4511,7 +4531,6 @@ img.warningimg {\n \n .selectiondashboard #col2 {\n   width: 368px;\n-  margin-left: $doubleMargin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553"}, "originalPosition": 119}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzODkyODMz", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-523892833", "createdAt": "2020-11-05T03:01:25Z", "commit": {"oid": "7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwMzowMToyNVrOHtx3Bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwMzowMToyNVrOHtx3Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc2NDg3MA==", "bodyText": "This change, combined with the above, looks like you're attempting to achieve the standard style defined in buttonShadowBorder. Should that be used instead? (And maybe still keeping the background declaration.)\nOtherwise at the very least, it should be using curvedCorners.", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r517764870", "createdAt": "2020-11-05T03:01:25Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/resources/web/sass/legacy.scss", "diffHunk": "@@ -4701,12 +4720,13 @@ div#sssh_finishedButton {\n   border: none;\n   box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);\n   background: none;\n+  border-radius: 4px;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553"}, "originalPosition": 127}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6868196bdbebadae9a708b0c336369d2679da32f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/6868196bdbebadae9a708b0c336369d2679da32f", "committedDate": "2020-11-05T04:30:23Z", "message": "Revert \"Update react route to ensure new search UI displays\"\n\nThis reverts commit 7e9f5f3e6d38383680ba7a2bfc3f1d7eb3c22553."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38a5481ea4fd8f92a41ebe17d7189803136a7ec2", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/38a5481ea4fd8f92a41ebe17d7189803136a7ec2", "committedDate": "2020-11-05T04:52:02Z", "message": "Support accessing Legacy Search page through\n'/access/selectoradd/searching.do'.\n\nThe intention of this commit is to differentiate the URL\nused to access the old Search UI from Selection Session.\nWith the changes made in #2414, once New Search UI is enabled,\n'searching.do' will be captured by react-route, which results\nin incorrect contents of Search page displayed in Selection\nSession. Therefore, we need to have a new URL to access old\nSearch page in Selection Session."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa77e5b06920ea2d4e8ee446b4b6cf34df2ec251", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/fa77e5b06920ea2d4e8ee446b4b6cf34df2ec251", "committedDate": "2020-11-05T05:01:56Z", "message": "Reuse mixin 'buttonShadowBorder' for CSS class 'box'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adc09192d6b064403c861df6b90433df0f8328e1", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/adc09192d6b064403c861df6b90433df0f8328e1", "committedDate": "2020-11-05T05:14:52Z", "message": "Remove unneeded prefix from the URL used to access\nold Search UI in 'selectoradd' mode."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzOTMzODY5", "url": "https://github.com/openequella/openEQUELLA/pull/2437#pullrequestreview-523933869", "createdAt": "2020-11-05T05:24:41Z", "commit": {"oid": "adc09192d6b064403c861df6b90433df0f8328e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwNToyNDo0MVrOHtz-iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwNToyNDo0MVrOHtz-iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5OTU2MQ==", "bodyText": "I'm just wondering how this may inadvertently affect clients who are not using the new ui?\nI can't think of any specific examples, but it might be safe to check if the new UI is enabled before using this path?", "url": "https://github.com/openequella/openEQUELLA/pull/2437#discussion_r517799561", "createdAt": "2020-11-05T05:24:41Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/src/com/tle/web/searching/selection/SearchSelectable.java", "diffHunk": "@@ -50,7 +50,7 @@ public SectionInfo createSectionInfo(SectionInfo info, SelectionSession session)\n \n   @SuppressWarnings(\"nls\")\n   protected SectionInfo getSearchTree(SectionInfo info) {\n-    return controller.createForward(info, \"/searching.do\");\n+    return controller.createForward(info, \"/selectoradd/searching.do\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adc09192d6b064403c861df6b90433df0f8328e1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20437199406caf8006162e7958fc2fa430348370", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/20437199406caf8006162e7958fc2fa430348370", "committedDate": "2020-11-05T05:45:24Z", "message": "Only forward to \"/selectoradd/searching.do\" when new\nUI is enabled."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 420, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}