{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MjQ1MTk5", "number": 2157, "reviewThreads": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNToxNToxOVrOEWqFXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDozNTozM1rOEXAsUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTkzNjMxOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNToxNToxOVrOG-BmpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjo1OTo1MVrOG-DQQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MTE3Mw==", "bodyText": "We had talks about using spread for objects in Storybook. As I recall, actions are fine with spread. So why not do\n{...commonParams}?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467691173", "createdAt": "2020-08-10T05:15:19Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";\n+import * as UserSearchMock from \"../../__mocks__/UserSearch.mock\";\n+\n+export default {\n+  title: \"Search/OwnerSelector\",\n+  component: OwnerSelector,\n+};\n+\n+const commonParams = {\n+  onClearSelect: action(\"onClearSelect\"),\n+  onSelect: action(\"onSelect\"),\n+  userListProvider: UserSearchMock.userDetailsProvider,\n+};\n+\n+export const NoSelectedUser = () => <OwnerSelector {...commonParams} />;\n+\n+export const SelectedUser = () => (\n+  <OwnerSelector\n+    onClearSelect={action(\"onClearSelect\")}\n+    onSelect={action(\"onSelect\")}\n+    userListProvider={UserSearchMock.userDetailsProvider}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcxODIwOQ==", "bodyText": "You raise a good question. Not sure why I took them off here, as it all works fine. Fixed.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467718209", "createdAt": "2020-08-10T06:59:51Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";\n+import * as UserSearchMock from \"../../__mocks__/UserSearch.mock\";\n+\n+export default {\n+  title: \"Search/OwnerSelector\",\n+  component: OwnerSelector,\n+};\n+\n+const commonParams = {\n+  onClearSelect: action(\"onClearSelect\"),\n+  onSelect: action(\"onSelect\"),\n+  userListProvider: UserSearchMock.userDetailsProvider,\n+};\n+\n+export const NoSelectedUser = () => <OwnerSelector {...commonParams} />;\n+\n+export const SelectedUser = () => (\n+  <OwnerSelector\n+    onClearSelect={action(\"onClearSelect\")}\n+    onSelect={action(\"onSelect\")}\n+    userListProvider={UserSearchMock.userDetailsProvider}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MTE3Mw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTkzNzAyOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__mocks__/UserSearch.mock.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNToxNTo1NVrOG-BnCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNzowNjoyN1rOG-DZhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MTI3NA==", "bodyText": "Would it be easier to read if use Promise.resolve() ?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467691274", "createdAt": "2020-08-10T05:15:55Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__mocks__/UserSearch.mock.ts", "diffHunk": "@@ -58,9 +58,12 @@ export const users: OEQ.UserQuery.UserDetails[] = [\n  *\n  * @param query A simple string to filter by (no wildcard support)\n  */\n-export const userDetailsProvider = (\n+export const userDetailsProvider = async (\n   query?: string\n-): Promise<OEQ.UserQuery.UserDetails[]> =>\n-  new Promise((resolve) =>\n+): Promise<OEQ.UserQuery.UserDetails[]> => {\n+  // A sleep to emulate latency\n+  await new Promise((resolve) => setTimeout(resolve, 500));\n+  return new Promise((resolve) =>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyMDU4Mg==", "bodyText": "Could be. Less to read. Change. \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467720582", "createdAt": "2020-08-10T07:06:27Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__mocks__/UserSearch.mock.ts", "diffHunk": "@@ -58,9 +58,12 @@ export const users: OEQ.UserQuery.UserDetails[] = [\n  *\n  * @param query A simple string to filter by (no wildcard support)\n  */\n-export const userDetailsProvider = (\n+export const userDetailsProvider = async (\n   query?: string\n-): Promise<OEQ.UserQuery.UserDetails[]> =>\n-  new Promise((resolve) =>\n+): Promise<OEQ.UserQuery.UserDetails[]> => {\n+  // A sleep to emulate latency\n+  await new Promise((resolve) => setTimeout(resolve, 500));\n+  return new Promise((resolve) =>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MTI3NA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTk0NDIzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNToyMToxOVrOG-Bqww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzoyNzoyNFrOG-jGwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MjIyNw==", "bodyText": "matches return a boolean so I think we can remove as boolean  ?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467692227", "createdAt": "2020-08-10T05:21:19Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryByText } from \"@testing-library/react\";\n+\n+/**\n+ * Helper function to find MUI buttons with React Testing Library.\n+ *\n+ * @param container A root element to start the search from\n+ * @param text The text to identify the button by.\n+ */\n+export const queryMuiButtonByText = (container: HTMLElement, text: string) =>\n+  queryByText(\n+    container,\n+    (content: string, element: HTMLElement) =>\n+      content === text && (element.parentElement?.matches(\"button\") as boolean)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyMjY0Mw==", "bodyText": "The coercian is due to the safe navigator from the parentElement?.. That is, if it can't get the parentElement (or it's undefined) then the resulting null will resolve to an explicit false (and keep TS happy).\nWithout:\n    __tests__/tsrc/MuiQueries.ts:29:5 - error TS2345: Argument of type '(content: string, element: HTMLElement) => boolean | undefined' is not assignable to parameter of type 'Matcher'.\n      Type '(content: string, element: HTMLElement) => boolean | undefined' is not assignable to type 'MatcherFunction'.\n        Type 'boolean | undefined' is not assignable to type 'boolean'.\n          Type 'undefined' is not assignable to type 'boolean'.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467722643", "createdAt": "2020-08-10T07:12:14Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryByText } from \"@testing-library/react\";\n+\n+/**\n+ * Helper function to find MUI buttons with React Testing Library.\n+ *\n+ * @param container A root element to start the search from\n+ * @param text The text to identify the button by.\n+ */\n+export const queryMuiButtonByText = (container: HTMLElement, text: string) =>\n+  queryByText(\n+    container,\n+    (content: string, element: HTMLElement) =>\n+      content === text && (element.parentElement?.matches(\"button\") as boolean)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MjIyNw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0MDA2NQ==", "bodyText": "Ah I see! \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468240065", "createdAt": "2020-08-10T23:27:24Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryByText } from \"@testing-library/react\";\n+\n+/**\n+ * Helper function to find MUI buttons with React Testing Library.\n+ *\n+ * @param container A root element to start the search from\n+ * @param text The text to identify the button by.\n+ */\n+export const queryMuiButtonByText = (container: HTMLElement, text: string) =>\n+  queryByText(\n+    container,\n+    (content: string, element: HTMLElement) =>\n+      content === text && (element.parentElement?.matches(\"button\") as boolean)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MjIyNw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTk1NTI3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNToyOTowOVrOG-Bwqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDozNzoyNlrOG-kXNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MzczOA==", "bodyText": "Do we want to use await waitFor(() => searchPromise ) instead ?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467693738", "createdAt": "2020-08-10T05:29:09Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyNTkxNg==", "bodyText": "Not sure I follow.\nwaitFor works by repeatedly calling the passed function at a set interval for a maximum timeout period until it stops getting an Error thrown. All we want to do here is wait for the promise call to complete - however we need to wrap it in an act to ensure we don't get the error:\nconsole.error\n    Warning: An update to SearchPage inside a test was not wrapped in act(...).\n\nThe test passes, but we get yet another console error.\nAm I missing something?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467725916", "createdAt": "2020-08-10T07:21:02Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MzczOA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1Njc3OA==", "bodyText": "Hmmm, I just checked out your branch and ran the whole test and I did not see this warning again. I saw three warnings: one about MUI unique \"key\" prop, one about window.scrollTo and one about MuiPickersUtilsProvider.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468256778", "createdAt": "2020-08-11T00:23:42Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MzczOA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2MDY2Mg==", "bodyText": "Correct. You only get the error if you remove the act call.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468260662", "createdAt": "2020-08-11T00:37:26Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5MzczOA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTk2Mzk0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNTozNDowNVrOG-B1KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzozMzo1N1rOG-jOnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5NDg4OQ==", "bodyText": "Is there any reason that you need this argument ? In next line, can we just use page.container ? This function is not shared to other tests.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467694889", "createdAt": "2020-08-10T05:34:05Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {\n+      await searchPromise;\n+    });\n+  });\n+\n+  afterEach(() => {\n+    // Needed to keep Enzyme tests below happy\n+    jest.clearAllMocks();\n+  });\n+\n+  const getOwnerFilter = (container: Element): HTMLElement => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyNzE0Nw==", "bodyText": "This is deliberate the make the function a nice unit. The inputs and outputs are (mostly) known - leaning towards a more pure function. Not just closing over various variables which may change.\nI think we should be doing more of this, and be cautious not to be doing almost OO style coding by closing over variables in our current scope. Can make for harder maintenance and refactoring later on.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467727147", "createdAt": "2020-08-10T07:24:06Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {\n+      await searchPromise;\n+    });\n+  });\n+\n+  afterEach(() => {\n+    // Needed to keep Enzyme tests below happy\n+    jest.clearAllMocks();\n+  });\n+\n+  const getOwnerFilter = (container: Element): HTMLElement => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5NDg4OQ=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0MjA3Nw==", "bodyText": "Yeah I agree! Good choice!", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468242077", "createdAt": "2020-08-10T23:33:57Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}\n+      </BrowserRouter>\n+    );\n+    // Wait for the first completion of initial search\n+    await act(async () => {\n+      await searchPromise;\n+    });\n+  });\n+\n+  afterEach(() => {\n+    // Needed to keep Enzyme tests below happy\n+    jest.clearAllMocks();\n+  });\n+\n+  const getOwnerFilter = (container: Element): HTMLElement => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5NDg4OQ=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTk5MTIzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNTo1MTo0MVrOG-CD5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzo1OTowMFrOG-jtFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5ODY2Mw==", "bodyText": "Is there any handler listening to this event?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467698663", "createdAt": "2020-08-10T05:51:41Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -88,6 +94,7 @@ const UserSearch = ({\n         setUsers([]);\n         setSelectedUser(undefined);\n         setHasSearched(false);\n+        event.stopPropagation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyNzY5Mg==", "bodyText": "Yup. If you place this generic component in say... a Dialog... you press enter to clear the field (which it does) but then also triggers the dialog close. So it makes sense to stop it on this field.\nThoughts?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467727692", "createdAt": "2020-08-10T07:25:24Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -88,6 +94,7 @@ const UserSearch = ({\n         setUsers([]);\n         setSelectedUser(undefined);\n         setHasSearched(false);\n+        event.stopPropagation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5ODY2Mw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0NTczNg==", "bodyText": "If we don't want the dialog to be closed when click escape, we can add disableEscapeKeyDown to the dialog.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468245736", "createdAt": "2020-08-10T23:45:53Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -88,6 +94,7 @@ const UserSearch = ({\n         setUsers([]);\n         setSelectedUser(undefined);\n         setHasSearched(false);\n+        event.stopPropagation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5ODY2Mw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0OTg3Ng==", "bodyText": "Cool. Might leave here for now though - as it feels like it's a concern for UserSearch - but if later we feel we do want it to percolate for some reason we can revisit.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468249876", "createdAt": "2020-08-10T23:59:00Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -88,6 +94,7 @@ const UserSearch = ({\n         setUsers([]);\n         setSelectedUser(undefined);\n         setHasSearched(false);\n+        event.stopPropagation();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5ODY2Mw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMTk5ODMxOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNTo1NTo0NVrOG-CHpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNzozMzo1MlrOG-ECsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5OTYyMw==", "bodyText": "Confused - is this a stray comment or in the wrong place?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467699623", "createdAt": "2020-08-10T05:55:45Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+// Helper function to execute a search (assuming rendered component)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzczMTEyMg==", "bodyText": "Stray evolutionary comment. Removed.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467731122", "createdAt": "2020-08-10T07:33:52Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+// Helper function to execute a search (assuming rendered component)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5OTYyMw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMjAwOTQ0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjowMjo0N1rOG-CNpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNzozNTowOVrOG-EEug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMTE1OA==", "bodyText": "I think this is what you meant? Or have I misunderstood?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              /** The currently selected user or. */\n          \n          \n            \n              /** The currently selected user or undefined. */", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467701158", "createdAt": "2020-08-10T06:02:47Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "diffHunk": "@@ -0,0 +1,168 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import * as React from \"react\";\n+import { useState } from \"react\";\n+import {\n+  Button,\n+  Dialog,\n+  DialogActions,\n+  DialogContent,\n+  DialogTitle,\n+  Grid,\n+  IconButton,\n+  List,\n+  ListItem,\n+  ListItemIcon,\n+  ListItemSecondaryAction,\n+  ListItemText,\n+} from \"@material-ui/core\";\n+import { AccountCircle } from \"@material-ui/icons\";\n+import DeleteIcon from \"@material-ui/icons/Delete\";\n+import UserSearch from \"../../components/UserSearch\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface OwnerSelectorProps {\n+  /** The currently selected user or. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzczMTY0Mg==", "bodyText": "Ah yes, mostly. Fixed up. :)", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467731642", "createdAt": "2020-08-10T07:35:09Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "diffHunk": "@@ -0,0 +1,168 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import * as React from \"react\";\n+import { useState } from \"react\";\n+import {\n+  Button,\n+  Dialog,\n+  DialogActions,\n+  DialogContent,\n+  DialogTitle,\n+  Grid,\n+  IconButton,\n+  List,\n+  ListItem,\n+  ListItemIcon,\n+  ListItemSecondaryAction,\n+  ListItemText,\n+} from \"@material-ui/core\";\n+import { AccountCircle } from \"@material-ui/icons\";\n+import DeleteIcon from \"@material-ui/icons/Delete\";\n+import UserSearch from \"../../components/UserSearch\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface OwnerSelectorProps {\n+  /** The currently selected user or. */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMTE1OA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMjAxNjY4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjowNzowMlrOG-CRqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNzozNjoyMlrOG-EG7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjE4Ng==", "bodyText": "Is this a stray comment or just in the wrong place?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467702186", "createdAt": "2020-08-10T06:07:02Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+// Helper function to execute a search (assuming rendered component)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzczMjIwNg==", "bodyText": "Hmmm, that's odd. I'm seeing double here. This is your comment from above. I'll mark it as resolved too.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467732206", "createdAt": "2020-08-10T07:36:22Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/components/UserSearchTestHelpers.ts", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+// Helper function to execute a search (assuming rendered component)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjE4Ng=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMjAxODQ2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjowODoxMVrOG-CSqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNzoyNzowMFrOG-D4DQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjQ0Mw==", "bodyText": "Do you want to explicitly say the type of selection could be undefined? If no we can do selection?: OEQ.UserQuery.UserDetails .", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467702443", "createdAt": "2020-08-10T06:08:11Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "diffHunk": "@@ -0,0 +1,168 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import * as React from \"react\";\n+import { useState } from \"react\";\n+import {\n+  Button,\n+  Dialog,\n+  DialogActions,\n+  DialogContent,\n+  DialogTitle,\n+  Grid,\n+  IconButton,\n+  List,\n+  ListItem,\n+  ListItemIcon,\n+  ListItemSecondaryAction,\n+  ListItemText,\n+} from \"@material-ui/core\";\n+import { AccountCircle } from \"@material-ui/icons\";\n+import DeleteIcon from \"@material-ui/icons/Delete\";\n+import UserSearch from \"../../components/UserSearch\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface OwnerSelectorProps {\n+  /** The currently selected user or. */\n+  value?: OEQ.UserQuery.UserDetails;\n+  /** Handler for when current selection is cleared. */\n+  onClearSelect: () => void;\n+  /** Handler for when a user is selected. */\n+  onSelect: (selection: OEQ.UserQuery.UserDetails) => void;\n+  /** Function which will provide the list of users for UserSearch. */\n+  userListProvider?: (query?: string) => Promise<OEQ.UserQuery.UserDetails[]>;\n+}\n+\n+const OwnerSelector = ({\n+  value,\n+  onClearSelect,\n+  onSelect,\n+  userListProvider,\n+}: OwnerSelectorProps) => {\n+  const [showFindUserDialog, setShowFindUserDialog] = useState<boolean>(false);\n+\n+  const handleCloseFindUserDialog = (\n+    selection: OEQ.UserQuery.UserDetails | undefined", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcyODM5Nw==", "bodyText": "Ah yes, bad habit of mine. Will fix.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467728397", "createdAt": "2020-08-10T07:27:00Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/OwnerSelector.tsx", "diffHunk": "@@ -0,0 +1,168 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import * as React from \"react\";\n+import { useState } from \"react\";\n+import {\n+  Button,\n+  Dialog,\n+  DialogActions,\n+  DialogContent,\n+  DialogTitle,\n+  Grid,\n+  IconButton,\n+  List,\n+  ListItem,\n+  ListItemIcon,\n+  ListItemSecondaryAction,\n+  ListItemText,\n+} from \"@material-ui/core\";\n+import { AccountCircle } from \"@material-ui/icons\";\n+import DeleteIcon from \"@material-ui/icons/Delete\";\n+import UserSearch from \"../../components/UserSearch\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface OwnerSelectorProps {\n+  /** The currently selected user or. */\n+  value?: OEQ.UserQuery.UserDetails;\n+  /** Handler for when current selection is cleared. */\n+  onClearSelect: () => void;\n+  /** Handler for when a user is selected. */\n+  onSelect: (selection: OEQ.UserQuery.UserDetails) => void;\n+  /** Function which will provide the list of users for UserSearch. */\n+  userListProvider?: (query?: string) => Promise<OEQ.UserQuery.UserDetails[]>;\n+}\n+\n+const OwnerSelector = ({\n+  value,\n+  onClearSelect,\n+  onSelect,\n+  userListProvider,\n+}: OwnerSelectorProps) => {\n+  const [showFindUserDialog, setShowFindUserDialog] = useState<boolean>(false);\n+\n+  const handleCloseFindUserDialog = (\n+    selection: OEQ.UserQuery.UserDetails | undefined", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjQ0Mw=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMjAxOTg2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjowODo1OFrOG-CTZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjoxMzowMlrOG-CXcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjYzMA==", "bodyText": "What is the {\" \"} for in this context?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467702630", "createdAt": "2020-08-10T06:08:58Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMzY2Nw==", "bodyText": "I removed it in my PR.", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467703667", "createdAt": "2020-08-10T06:13:02Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -28,34 +28,118 @@ import { act } from \"react-dom/test-utils\";\n import * as SearchModule from \"../../../tsrc/modules/SearchModule\";\n import * as CollectionsModule from \"../../../tsrc/modules/CollectionsModule\";\n import * as SearchSettingsModule from \"../../../tsrc/modules/SearchSettingsModule\";\n+import * as UserModule from \"../../../tsrc/modules/UserModule\";\n import { BrowserRouter } from \"react-router-dom\";\n import { CircularProgress } from \"@material-ui/core\";\n import { CollectionSelector } from \"../../../tsrc/search/components/CollectionSelector\";\n import { paginatorControls } from \"../components/SearchPaginationTestHelper\";\n import { DateRangeSelector } from \"../../../tsrc/components/DateRangeSelector\";\n+import * as UserSearchMock from \"../../../__mocks__/UserSearch.mock\";\n+import { render, RenderResult, screen, waitFor } from \"@testing-library/react\";\n+import {\n+  clearSelection,\n+  selectUser,\n+} from \"./components/OwnerSelectTestHelpers\";\n \n const SEARCHBAR_ID = \"input[id='searchBar']\";\n const RAW_SEARCH_TOGGLE_ID = \"input[id='rawSearch']\";\n+\n+const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n+const mockListUsers = jest.spyOn(UserModule, \"listUsers\");\n const mockSearch = jest.spyOn(SearchModule, \"searchItems\");\n const mockSearchSettings = jest.spyOn(\n   SearchSettingsModule,\n   \"getSearchSettingsFromServer\"\n );\n-const mockCollections = jest.spyOn(CollectionsModule, \"collectionListSummary\");\n-const searchSettingPromise = mockSearchSettings.mockImplementation(() =>\n-  Promise.resolve(SearchSettingsModule.defaultSearchSettings)\n-);\n-const searchPromise = mockSearch.mockImplementation(() =>\n-  Promise.resolve(getSearchResult)\n+\n+const searchSettingPromise = mockSearchSettings.mockResolvedValue(\n+  SearchSettingsModule.defaultSearchSettings\n );\n-mockCollections.mockImplementation(() => Promise.resolve(getCollectionMap));\n+const searchPromise = mockSearch.mockResolvedValue(getSearchResult);\n+\n+mockCollections.mockResolvedValue(getCollectionMap);\n+mockListUsers.mockResolvedValue(UserSearchMock.users);\n+\n const defaultSearchPageOptions: SearchPageOptions = {\n   ...SearchModule.defaultSearchOptions,\n   sortOrder: SearchSettingsModule.SortOrder.RANK,\n   dateRangeQuickModeEnabled: true,\n };\n const defaultCollectionPrivileges = [\"SEARCH_COLLECTION\"];\n \n+describe(\"Refine search by Owner\", () => {\n+  const testUser = UserSearchMock.users[0];\n+  let page: RenderResult;\n+\n+  beforeEach(async () => {\n+    window.history.replaceState({}, \"Clean history state\");\n+    page = render(\n+      <BrowserRouter>\n+        <SearchPage updateTemplate={jest.fn()} />{\" \"}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwMjYzMA=="}, "originalCommit": {"oid": "48b54ad774387f9c928eba664c384a75592f850d"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMzYwODMyOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNDoyODoxN1rOG-Q-Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzozMTo1OFrOG-jMVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk0Mjk5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  content === text && (element.parentElement?.matches(\"button\") as boolean)\n          \n          \n            \n                  content === text && (element.parentElement?.matches(\"button\") ?? false)", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467942990", "createdAt": "2020-08-10T14:28:17Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryByText } from \"@testing-library/react\";\n+\n+/**\n+ * Helper function to find MUI buttons with React Testing Library.\n+ *\n+ * @param container A root element to start the search from\n+ * @param text The text to identify the button by.\n+ */\n+export const queryMuiButtonByText = (container: HTMLElement, text: string) =>\n+  queryByText(\n+    container,\n+    (content: string, element: HTMLElement) =>\n+      content === text && (element.parentElement?.matches(\"button\") as boolean)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90bdcecc563cc603fc9dc54685c2f335ae5e18f0"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0MTQ5Mg==", "bodyText": "Aww yeah, I'd say that improves readability. Thanks. \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468241492", "createdAt": "2020-08-10T23:31:58Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/MuiQueries.ts", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryByText } from \"@testing-library/react\";\n+\n+/**\n+ * Helper function to find MUI buttons with React Testing Library.\n+ *\n+ * @param container A root element to start the search from\n+ * @param text The text to identify the button by.\n+ */\n+export const queryMuiButtonByText = (container: HTMLElement, text: string) =>\n+  queryByText(\n+    container,\n+    (content: string, element: HTMLElement) =>\n+      content === text && (element.parentElement?.matches(\"button\") as boolean)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk0Mjk5MA=="}, "originalCommit": {"oid": "90bdcecc563cc603fc9dc54685c2f335ae5e18f0"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMzcwNjc3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNDo1MDo0MlrOG-R7NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzozMzoxMFrOG-jNow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk1ODU4MA==", "bodyText": "Possibly outside the scope of this PR.\nWould it make sense to unify the loading experiences using something like https://github.com/async-library/react-async?", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r467958580", "createdAt": "2020-08-10T14:50:42Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -66,20 +67,25 @@ const UserSearch = ({\n     OEQ.Common.UuidString | undefined\n   >(undefined);\n   const [hasSearched, setHasSearched] = useState<boolean>(false);\n+  const [showSpinner, setShowSpinner] = useState<boolean>(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90bdcecc563cc603fc9dc54685c2f335ae5e18f0"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI0MTgyNw==", "bodyText": "Thanks @ChristianMurphy . Will have a read. \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468241827", "createdAt": "2020-08-10T23:33:10Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/components/UserSearch.tsx", "diffHunk": "@@ -66,20 +67,25 @@ const UserSearch = ({\n     OEQ.Common.UuidString | undefined\n   >(undefined);\n   const [hasSearched, setHasSearched] = useState<boolean>(false);\n+  const [showSpinner, setShowSpinner] = useState<boolean>(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk1ODU4MA=="}, "originalCommit": {"oid": "90bdcecc563cc603fc9dc54685c2f335ae5e18f0"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNTYzNzU5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDozNDoxNVrOG-kTkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMToxNDo1MlrOG-k-Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1OTcyOA==", "bodyText": "Stylistically, I've personally found it easier to have node module import first, the internal imports after.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n          \n          \n            \n            import { action } from \"@storybook/addon-actions\";\n          \n          \n            \n            import { action } from \"@storybook/addon-actions\";\n          \n          \n            \n            import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468259728", "createdAt": "2020-08-11T00:34:15Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a0a9b8fc2c4bbf206d8609f8b26da918e89b48c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2MTIxNg==", "bodyText": "Yes, I was wondering about this. We've accrued a bit of a mess. Is there an ESLint rule you've ever found to support this notion?\nI'd be interested (in another place) go through and tidy this all up. (I'm disappointed that the intellij optimise imports does not do something like this - than again, maybe there's an option...)", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468261216", "createdAt": "2020-08-11T00:39:11Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1OTcyOA=="}, "originalCommit": {"oid": "5a0a9b8fc2c4bbf206d8609f8b26da918e89b48c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2Mzc2OQ==", "bodyText": "eslint and eslint-plugin-import come with https://eslint.org/docs/rules/sort-imports and https://github.com/benmosher/eslint-plugin-import/blob/master/docs/rules/order.md which can be setup.\nAlternatively there is https://github.com/lydell/eslint-plugin-simple-import-sort", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468263769", "createdAt": "2020-08-11T00:48:31Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1OTcyOA=="}, "originalCommit": {"oid": "5a0a9b8fc2c4bbf206d8609f8b26da918e89b48c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI3MDYyMg==", "bodyText": "Nice. The simple-import-sort looks nice and... simple. \ud83d\ude01", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468270622", "createdAt": "2020-08-11T01:14:52Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/OwnerSelector.stories.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import OwnerSelector from \"../../tsrc/search/components/OwnerSelector\";\n+import { action } from \"@storybook/addon-actions\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1OTcyOA=="}, "originalCommit": {"oid": "5a0a9b8fc2c4bbf206d8609f8b26da918e89b48c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNTY0MDUxOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/OwnerSelectTestHelpers.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDozNTozM1rOG-kVIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDozNTozM1rOG-kVIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2MDEyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { queryMuiButtonByText } from \"../../MuiQueries\";\n          \n          \n            \n            import { languageStrings } from \"../../../../tsrc/util/langstrings\";\n          \n          \n            \n            import { fireEvent, screen, waitFor } from \"@testing-library/react\";\n          \n          \n            \n            import { fireEvent, screen, waitFor } from \"@testing-library/react\";\n          \n          \n            \n            import { queryMuiButtonByText } from \"../../MuiQueries\";\n          \n          \n            \n            import { languageStrings } from \"../../../../tsrc/util/langstrings\";", "url": "https://github.com/openequella/openEQUELLA/pull/2157#discussion_r468260129", "createdAt": "2020-08-11T00:35:33Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/OwnerSelectTestHelpers.ts", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { queryMuiButtonByText } from \"../../MuiQueries\";\n+import { languageStrings } from \"../../../../tsrc/util/langstrings\";\n+import { fireEvent, screen, waitFor } from \"@testing-library/react\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a0a9b8fc2c4bbf206d8609f8b26da918e89b48c"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1206, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}