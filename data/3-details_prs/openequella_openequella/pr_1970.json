{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNzg0MTY5", "number": 1970, "title": "Ensure the default search order is included in the first search", "bodyText": "#1306\nChecklist\n\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n tests are included\n screenshots are included showing significant UI changes\n documentation is changed or added\n\nDescription of change\nThe search triggered by opening the Search page should include the default search order configured in the Search settings page. Therefore, in the Search page, retrieve Search settings first, and then add order to search criteria.\nFor some unknown reasons (maybe just unknown to me), the order values have been inconsistent  for a long time. For example, in the context of Search settings, the value of order Last modified date is datemodified. However in the context of Search, the accepted value is 'modified'. Previously in Purescript, this was handled by a Purscript Map. More details can be seen from these two links old search setting page (line 249-254), purs version search page.\nMy approach for handling this is to slightly change the method 'getOrderType' because this requires least changes, but I am happy to discuss other approaches.", "createdAt": "2020-06-30T05:03:47Z", "url": "https://github.com/openequella/openEQUELLA/pull/1970", "merged": true, "mergeCommit": {"oid": "41a40c291fa05478b8e6fe68ef1b394797edfeab"}, "closed": true, "closedAt": "2020-07-01T00:54:22Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwN32cgH2gAyNDQxNzg0MTY5OmRjNjk3MzliZWY3YzFkNTdjNWYwNzhkOWIxNzJkOGJiODdiMzAwNWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwebKWAFqTQ0MDQ1NjQ0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc69739bef7c1d57c5f078d9b172d8bb87b3005e", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/dc69739bef7c1d57c5f078d9b172d8bb87b3005e", "committedDate": "2020-06-30T04:24:13Z", "message": "Ensure the default search order is included in the first search."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b6efed0b58bdff6bcdf462ad1239f0d22a4f6b5", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/2b6efed0b58bdff6bcdf462ad1239f0d22a4f6b5", "committedDate": "2020-06-30T07:07:00Z", "message": "Safely lowercase search order."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDU2NDQz", "url": "https://github.com/openequella/openEQUELLA/pull/1970#pullrequestreview-440456443", "createdAt": "2020-06-30T23:40:15Z", "commit": {"oid": "2b6efed0b58bdff6bcdf462ad1239f0d22a4f6b5"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzo0MDoxNlrOGrSDUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzo0MDoxNlrOGrSDUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAzNzcxMg==", "bodyText": "Hmm, this is a bit interesting...\nAs really, we'll want to set a sort order control to the default, and then on searches simply read in it's current value. But we don't have that control yet. However, consideration will also need to be given to this value in the work being done over in #1967 .\nMind you, the same also applies for the current hardcoded status.", "url": "https://github.com/openequella/openEQUELLA/pull/1970#discussion_r448037712", "createdAt": "2020-06-30T23:40:16Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -53,9 +57,12 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n \n-    search({\n-      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n-    });\n+    getSearchSettingsFromServer().then((settings: SearchSettings) =>\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+        order: settings.defaultSearchSort,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b6efed0b58bdff6bcdf462ad1239f0d22a4f6b5"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 30, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}