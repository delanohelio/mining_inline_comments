{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMjk3MjE3", "number": 2515, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMDozNlrOE5u-3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyODoxNlrOE7ZqDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4OTc0MDQ0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/ResourceSelector.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMDozNlrOH0YG6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMDozNlrOH0YG6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4Mjk4Nw==", "bodyText": "You could probably have a bit of JSDoc explaining this function.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r524682987", "createdAt": "2020-11-16T22:30:36Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/ResourceSelector.tsx", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import { IconButton } from \"@material-ui/core\";\n+import Tooltip from \"@material-ui/core/Tooltip\";\n+import DoubleArrowIcon from \"@material-ui/icons/DoubleArrow\";\n+import * as React from \"react\";\n+\n+export interface ResourceSelectorProps {\n+  /**\n+   * Text for the label of ResourceSelector\n+   */\n+  labelText: string;\n+  /**\n+   * Handler for clicking the ResourceSelector\n+   */\n+  onClick: () => void;\n+  /**\n+   * Whether to stop the propagation of a click event\n+   */\n+  isStopPropagation?: boolean;\n+}\n+\n+export const ResourceSelector = ({", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4OTc0NzUyOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMTo0N1rOH0YL6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMTo0N1rOH0YL6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4NDI2Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                              onClick={nop} // todo: replace nop with an handler for selecting one attachment\n          \n          \n            \n                              onClick={nop} // todo: replace nop with a handler for selecting one attachment", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r524684266", "createdAt": "2020-11-16T22:31:47Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -314,11 +322,39 @@ export default function SearchResult({\n             >\n               <ListItemText color=\"primary\" primary={description} />\n             </ItemAttachmentLink>\n+            {selectionSessionData && (\n+              <ListItemSecondaryAction>\n+                <ResourceSelector\n+                  labelText={selectResourceStrings.attachment}\n+                  isStopPropagation\n+                  onClick={nop} // todo: replace nop with an handler for selecting one attachment", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4OTc1MTU3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMjozMVrOH0YO8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMjozMVrOH0YO8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4NTA0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        onClick={nop} // todo: replace nop with an handler for selecting attachments\n          \n          \n            \n                        onClick={nop} // todo: replace nop with a handler for selecting attachments", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r524685041", "createdAt": "2020-11-16T22:32:31Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -314,11 +322,39 @@ export default function SearchResult({\n             >\n               <ListItemText color=\"primary\" primary={description} />\n             </ItemAttachmentLink>\n+            {selectionSessionData && (\n+              <ListItemSecondaryAction>\n+                <ResourceSelector\n+                  labelText={selectResourceStrings.attachment}\n+                  isStopPropagation\n+                  onClick={nop} // todo: replace nop with an handler for selecting one attachment\n+                />\n+              </ListItemSecondaryAction>\n+            )}\n           </ListItem>\n         );\n       }\n     );\n \n+    const accordionText = (\n+      <Typography>{searchResultStrings.attachments}</Typography>\n+    );\n+\n+    const accordionSummaryContent = selectionSessionData ? (\n+      <Grid container alignItems=\"center\">\n+        <Grid item>{accordionText}</Grid>\n+        <Grid>\n+          <ResourceSelector\n+            labelText={selectResourceStrings.allAttachments}\n+            isStopPropagation\n+            onClick={nop} // todo: replace nop with an handler for selecting attachments", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4OTc1NzgwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMzo0MlrOH0YThQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjozMzo0MlrOH0YThQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY4NjIxMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      onClick={nop} // todo: replace nop with an handler for selecting summary page\n          \n          \n            \n                      onClick={nop} // todo: replace nop with a handler for selecting summary page", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r524686213", "createdAt": "2020-11-16T22:33:42Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -390,14 +428,29 @@ export default function SearchResult({\n     );\n   };\n \n+  const itemPrimaryContent = selectionSessionData ? (\n+    <Grid container alignItems=\"center\">\n+      <Grid item>{itemLink()}</Grid>\n+      <Grid item>\n+        <ResourceSelector\n+          labelText={selectResourceStrings.summaryPage}\n+          isStopPropagation\n+          onClick={nop} // todo: replace nop with an handler for selecting summary page", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 127}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4OTgyNDE0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQyMjo0NDo0NVrOH0ZBQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwMDozNDozN1rOH24QFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY5NzkyMQ==", "bodyText": "Nit: I wonder if doing a change like this would help readability:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const selectionSessionData = renderData?.selectionSessionInfo;\n          \n          \n            \n              const inSelectionSession: boolean = renderData?.selectionSessionInfo;\n          \n      \n    \n    \n  \n\nAnd then in the one place you need selectionSessionInfo as the actual data structure, you simply use renderData?.selectionSessionInfo.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r524697921", "createdAt": "2020-11-16T22:44:45Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -141,6 +146,8 @@ export default function SearchResult({\n     viewerDetails?: OEQ.MimeType.MimeTypeViewerDetail;\n   }\n   const renderData = getRenderData();\n+  const selectionSessionData = renderData?.selectionSessionInfo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4MDA0Nw==", "bodyText": "I like this, but this we need to do a type casting from undefined to boolean.\nAlso we will need to change the parameter type of buildSelectionSessionItemSummaryLink.\nAnd lastly, we need to add a type check for whether Selection Session info is null/undefined and throw an error if yes.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r526480047", "createdAt": "2020-11-18T22:59:51Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -141,6 +146,8 @@ export default function SearchResult({\n     viewerDetails?: OEQ.MimeType.MimeTypeViewerDetail;\n   }\n   const renderData = getRenderData();\n+  const selectionSessionData = renderData?.selectionSessionInfo;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY5NzkyMQ=="}, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzMwNjc3Mg==", "bodyText": "As per discussions this morning, it'd still be good to address this for future readability/maintainability. @PenghaiZhang is going to see what he can come up with.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r527306772", "createdAt": "2020-11-20T00:34:37Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -141,6 +146,8 @@ export default function SearchResult({\n     viewerDetails?: OEQ.MimeType.MimeTypeViewerDetail;\n   }\n   const renderData = getRenderData();\n+  const selectionSessionData = renderData?.selectionSessionInfo;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY5NzkyMQ=="}, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NjA0MjA2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwMjo1Nzo1OFrOH1Vpsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwMDozODoxNVrOH24c4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTY5MTMxNA==", "bodyText": "This seems a bit surprising.\nWhy remove the ul list semantics from a list element?", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r525691314", "createdAt": "2020-11-18T02:57:58Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -351,13 +387,15 @@ export default function SearchResult({\n           <AccordionSummary expandIcon={<ExpandMore />}>\n             <Grid container spacing={2} alignItems=\"center\">\n               <Grid item>{attachFileBadge(keywordFoundInAttachment)}</Grid>\n-              <Grid item>\n-                <Typography>{searchResultStrings.attachments}</Typography>\n-              </Grid>\n+              <Grid item>{accordionSummaryContent}</Grid>\n             </Grid>\n           </AccordionSummary>\n           <AccordionDetails>\n-            <List component=\"div\" disablePadding>\n+            <List\n+              component=\"div\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ1MDE2MQ==", "bodyText": "Hi @mrblippy, do you have any answer for Christian's query ?\nI probably miss the background of using div here. Actually, I have tried to remove component=\"div\" and the UI seems unchanged.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r526450161", "createdAt": "2020-11-18T21:58:37Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -351,13 +387,15 @@ export default function SearchResult({\n           <AccordionSummary expandIcon={<ExpandMore />}>\n             <Grid container spacing={2} alignItems=\"center\">\n               <Grid item>{attachFileBadge(keywordFoundInAttachment)}</Grid>\n-              <Grid item>\n-                <Typography>{searchResultStrings.attachments}</Typography>\n-              </Grid>\n+              <Grid item>{accordionSummaryContent}</Grid>\n             </Grid>\n           </AccordionSummary>\n           <AccordionDetails>\n-            <List component=\"div\" disablePadding>\n+            <List\n+              component=\"div\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTY5MTMxNA=="}, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzMxMDA1MQ==", "bodyText": "I can't remember exactly why i added that. But, when i look at it now, it really doesn't make sense for a List component to be a div \ud83e\udd14\nI would say you are fine to remove it @PenghaiZhang", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r527310051", "createdAt": "2020-11-20T00:38:15Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -351,13 +387,15 @@ export default function SearchResult({\n           <AccordionSummary expandIcon={<ExpandMore />}>\n             <Grid container spacing={2} alignItems=\"center\">\n               <Grid item>{attachFileBadge(keywordFoundInAttachment)}</Grid>\n-              <Grid item>\n-                <Typography>{searchResultStrings.attachments}</Typography>\n-              </Grid>\n+              <Grid item>{accordionSummaryContent}</Grid>\n             </Grid>\n           </AccordionSummary>\n           <AccordionDetails>\n-            <List component=\"div\" disablePadding>\n+            <List\n+              component=\"div\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTY5MTMxNA=="}, "originalCommit": {"oid": "0d961df0b5ffd1a740ee159cbc98d0b588e08ae5"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNzIwMjkzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyNToxMVrOH3BwTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyNToxMVrOH3BwTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ2MjQ3OA==", "bodyText": "Nit\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            const isSelectionSession = (\n          \n          \n            \n            const isSelectionSessionInfo = (", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r527462478", "createdAt": "2020-11-20T06:25:11Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "diffHunk": "@@ -15,26 +15,48 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-import { AppConfig, SelectionSessionInfo } from \"../AppConfig\";\n+import { AppConfig, getRenderData, SelectionSessionInfo } from \"../AppConfig\";\n+\n+const selectionSessionInfo:\n+  | SelectionSessionInfo\n+  | undefined\n+  | null = getRenderData()?.selectionSessionInfo;\n+\n+/**\n+ * Type guard to check whether an object is of type SelectionSessionInfo.\n+ * @param data The data to be checked\n+ */\n+const isSelectionSession = (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbf1fc72047452e37701f3bc220d17c302424843"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNzIxMjc2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyNzowNFrOH3B3eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyNzowNFrOH3B3eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ2NDMxMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Build a Selection Session specific ItemSummary Link.\n          \n          \n            \n             * Build a Selection Session specific ItemSummary Link. Recommended to first call `inSelectionSession()`\n          \n          \n            \n             * before use.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r527464313", "createdAt": "2020-11-20T06:27:04Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "diffHunk": "@@ -15,26 +15,48 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-import { AppConfig, SelectionSessionInfo } from \"../AppConfig\";\n+import { AppConfig, getRenderData, SelectionSessionInfo } from \"../AppConfig\";\n+\n+const selectionSessionInfo:\n+  | SelectionSessionInfo\n+  | undefined\n+  | null = getRenderData()?.selectionSessionInfo;\n+\n+/**\n+ * Type guard to check whether an object is of type SelectionSessionInfo.\n+ * @param data The data to be checked\n+ */\n+const isSelectionSession = (\n+  data: unknown\n+): data is { [K in keyof SelectionSessionInfo]: unknown } =>\n+  typeof data === \"object\" && data !== null && \"stateId\" in data;\n+\n+/**\n+ * True if the Selection Session info provided by renderData is neither null nor undefined.\n+ */\n+export const inSelectionSession = isSelectionSession(selectionSessionInfo);\n+\n /**\n  * Build a Selection Session specific ItemSummary Link.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbf1fc72047452e37701f3bc220d17c302424843"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNzIxODA1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNjoyODoxNlrOH3B7ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjoxMjo1OFrOH4haBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ2NTMxNg==", "bodyText": "Be good to force the issue here - also for the sake of doco:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export const inSelectionSession = isSelectionSession(selectionSessionInfo);\n          \n          \n            \n            export const inSelectionSession: boolean = isSelectionSession(selectionSessionInfo);", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r527465316", "createdAt": "2020-11-20T06:28:16Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "diffHunk": "@@ -15,26 +15,48 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-import { AppConfig, SelectionSessionInfo } from \"../AppConfig\";\n+import { AppConfig, getRenderData, SelectionSessionInfo } from \"../AppConfig\";\n+\n+const selectionSessionInfo:\n+  | SelectionSessionInfo\n+  | undefined\n+  | null = getRenderData()?.selectionSessionInfo;\n+\n+/**\n+ * Type guard to check whether an object is of type SelectionSessionInfo.\n+ * @param data The data to be checked\n+ */\n+const isSelectionSession = (\n+  data: unknown\n+): data is { [K in keyof SelectionSessionInfo]: unknown } =>\n+  typeof data === \"object\" && data !== null && \"stateId\" in data;\n+\n+/**\n+ * True if the Selection Session info provided by renderData is neither null nor undefined.\n+ */\n+export const inSelectionSession = isSelectionSession(selectionSessionInfo);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbf1fc72047452e37701f3bc220d17c302424843"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNjU5Ng==", "bodyText": "I have to change this const to a function to make tests passed. As a const, it gets evaluated during those imports (SearchResult imports this from the module) and the mocks done in the test are too late. So making it a function can help solve this issue.", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r528436596", "createdAt": "2020-11-23T01:22:47Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "diffHunk": "@@ -15,26 +15,48 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-import { AppConfig, SelectionSessionInfo } from \"../AppConfig\";\n+import { AppConfig, getRenderData, SelectionSessionInfo } from \"../AppConfig\";\n+\n+const selectionSessionInfo:\n+  | SelectionSessionInfo\n+  | undefined\n+  | null = getRenderData()?.selectionSessionInfo;\n+\n+/**\n+ * Type guard to check whether an object is of type SelectionSessionInfo.\n+ * @param data The data to be checked\n+ */\n+const isSelectionSession = (\n+  data: unknown\n+): data is { [K in keyof SelectionSessionInfo]: unknown } =>\n+  typeof data === \"object\" && data !== null && \"stateId\" in data;\n+\n+/**\n+ * True if the Selection Session info provided by renderData is neither null nor undefined.\n+ */\n+export const inSelectionSession = isSelectionSession(selectionSessionInfo);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ2NTMxNg=="}, "originalCommit": {"oid": "dbf1fc72047452e37701f3bc220d17c302424843"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAyOTYzOQ==", "bodyText": "Ha! I almost commented on this during the review, but then decided the single evaluation would be fine. I forgot about the test side of things. ;)", "url": "https://github.com/openequella/openEQUELLA/pull/2515#discussion_r529029639", "createdAt": "2020-11-23T22:12:58Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/SelectionSessionModule.ts", "diffHunk": "@@ -15,26 +15,48 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-import { AppConfig, SelectionSessionInfo } from \"../AppConfig\";\n+import { AppConfig, getRenderData, SelectionSessionInfo } from \"../AppConfig\";\n+\n+const selectionSessionInfo:\n+  | SelectionSessionInfo\n+  | undefined\n+  | null = getRenderData()?.selectionSessionInfo;\n+\n+/**\n+ * Type guard to check whether an object is of type SelectionSessionInfo.\n+ * @param data The data to be checked\n+ */\n+const isSelectionSession = (\n+  data: unknown\n+): data is { [K in keyof SelectionSessionInfo]: unknown } =>\n+  typeof data === \"object\" && data !== null && \"stateId\" in data;\n+\n+/**\n+ * True if the Selection Session info provided by renderData is neither null nor undefined.\n+ */\n+export const inSelectionSession = isSelectionSession(selectionSessionInfo);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ2NTMxNg=="}, "originalCommit": {"oid": "dbf1fc72047452e37701f3bc220d17c302424843"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1668, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}