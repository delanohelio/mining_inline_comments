{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MjM1NDI3", "number": 2055, "title": "Trim the search query and only append wildcard to non-empty queries", "bodyText": "Checklist\n\n\n the contributor license agreement is signed\n commit message follows commit guidelines\n\nDescription of change\nWIldcard for simple search was getting incorrectly appended to empty search queries. This fix trims the query before sending it and only appends the wildcard for non-empty searches.", "createdAt": "2020-07-15T04:25:41Z", "url": "https://github.com/openequella/openEQUELLA/pull/2055", "merged": true, "mergeCommit": {"oid": "413027919d8ef93debdfdf717b4bdf7824b8604c"}, "closed": true, "closedAt": "2020-07-15T07:18:05Z", "author": {"login": "SammyIsConfused"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1C1n7gH2gAyNDQ5MjM1NDI3OjQ3YzY2OGZlYjZiNmM1NzYxY2Q5NWYzNTQwMThjMzQ1ZDI5ZDU1OGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1EDkNgFqTQ0ODY0NTI3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "47c668feb6b6c5761cd95f354018c345d29d558a", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/47c668feb6b6c5761cd95f354018c345d29d558a", "committedDate": "2020-07-15T04:22:27Z", "message": "Trim the search query and only append * with nonempty queries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NjIyMTQ4", "url": "https://github.com/openequella/openEQUELLA/pull/2055#pullrequestreview-448622148", "createdAt": "2020-07-15T04:35:02Z", "commit": {"oid": "47c668feb6b6c5761cd95f354018c345d29d558a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDozNTowMlrOGxt6BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDozNTowMlrOGxt6BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTU0MQ==", "bodyText": "The readability here is suffering. And in trying to untangle it, it led me to a more basic question. If there is no query after trimming, then should we call onChange at all? If not, that may indeed enable simplifying this logic quite readily.", "url": "https://github.com/openequella/openEQUELLA/pull/2055#discussion_r454785541", "createdAt": "2020-07-15T04:35:02Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchBar.tsx", "diffHunk": "@@ -53,8 +53,10 @@ export default function SearchBar({ onChange }: SearchBarProps) {\n   const [rawSearchMode, setRawSearchMode] = useState<boolean>(false);\n   const [queryString, setQuery] = React.useState<string>(\"\");\n   const strings = languageStrings.searchpage;\n-  const callOnChange = (query: string) =>\n-    onChange(query + (rawSearchMode ? \"\" : \"*\"));\n+  const callOnChange = (query: string) => {\n+    const trimmedQuery = query.trim();\n+    onChange(trimmedQuery + (rawSearchMode || !trimmedQuery ? \"\" : \"*\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47c668feb6b6c5761cd95f354018c345d29d558a"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9bbe120c6b7aade047a53f78564a0f46a5c4718", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/f9bbe120c6b7aade047a53f78564a0f46a5c4718", "committedDate": "2020-07-15T05:27:16Z", "message": "Add test for empty queries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2737f89fec75663fdd3ea78a097bcd0b0f7f76e2", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/2737f89fec75663fdd3ea78a097bcd0b0f7f76e2", "committedDate": "2020-07-15T05:27:48Z", "message": "Improve readability for callOnChange"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NjQzNTUx", "url": "https://github.com/openequella/openEQUELLA/pull/2055#pullrequestreview-448643551", "createdAt": "2020-07-15T05:42:46Z", "commit": {"oid": "2737f89fec75663fdd3ea78a097bcd0b0f7f76e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NjQ1Mjcw", "url": "https://github.com/openequella/openEQUELLA/pull/2055#pullrequestreview-448645270", "createdAt": "2020-07-15T05:47:35Z", "commit": {"oid": "2737f89fec75663fdd3ea78a097bcd0b0f7f76e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4968, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}