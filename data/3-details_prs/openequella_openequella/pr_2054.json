{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTkwOTY5", "number": 2054, "title": "Refactor raw search into searchbar", "bodyText": "Checklist\n\n\n the contributor license agreement is signed\n commit message follows commit guidelines\n tests are included (existing tests cover this area)\n screenshots are included showing significant UI changes\n\nDescription of change\n\nMove raw search controls into SearchBar.tsx from SearchPage.tsx\nUse grid and styles to place the raw search control to the right hand side of the search bar rather than underneath, with some extra room for language string changes", "createdAt": "2020-07-15T01:24:55Z", "url": "https://github.com/openequella/openEQUELLA/pull/2054", "merged": true, "mergeCommit": {"oid": "f0330090450170c34a5f1c3f8b33bdad9a8c3f6b"}, "closed": true, "closedAt": "2020-07-15T03:28:41Z", "author": {"login": "SammyIsConfused"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0_vv3gH2gAyNDQ5MTkwOTY5Ojg1NmY4N2I1NTFiODIyZTBkNzM3MzE0NzI5YmExNDI0NTNkMjk2OWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1As57gFqTQ0ODU3NjUxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "856f87b551b822e0d737314729ba142453d2969a", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/856f87b551b822e0d737314729ba142453d2969a", "committedDate": "2020-07-15T00:46:19Z", "message": "Move raw search controls out of SearchPage.tsx\n\nShould be included in SearchBar.tsx."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6be286c2c26beae7d9982d7919ed5fcf0692b76", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/d6be286c2c26beae7d9982d7919ed5fcf0692b76", "committedDate": "2020-07-15T00:47:08Z", "message": "Add raw search controls to Searchbar component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee7af4ef6887a43ce5b101eaee74b9b9b83dbc69", "author": {"user": null}, "url": "https://github.com/openequella/openEQUELLA/commit/ee7af4ef6887a43ce5b101eaee74b9b9b83dbc69", "committedDate": "2020-07-15T01:19:40Z", "message": "Add dependency to rawSearchMode in debouncedQuery\n\nOtherwise state does not update properly. Was not an issue when\nrawSearchMode was controlled by the parent component."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTcwMzA3", "url": "https://github.com/openequella/openEQUELLA/pull/2054#pullrequestreview-448570307", "createdAt": "2020-07-15T01:31:17Z", "commit": {"oid": "ee7af4ef6887a43ce5b101eaee74b9b9b83dbc69"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTc2NTE2", "url": "https://github.com/openequella/openEQUELLA/pull/2054#pullrequestreview-448576516", "createdAt": "2020-07-15T01:52:26Z", "commit": {"oid": "ee7af4ef6887a43ce5b101eaee74b9b9b83dbc69"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMTo1MjoyNlrOGxrUEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwMTo1MjoyNlrOGxrUEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc0MzA1Nw==", "bodyText": "I think debouncedQuery does not need to depend on rawSearchMode.", "url": "https://github.com/openequella/openEQUELLA/pull/2054#discussion_r454743057", "createdAt": "2020-07-15T01:52:26Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchBar.tsx", "diffHunk": "@@ -46,15 +48,20 @@ interface SearchBarProps {\n  * This component does not handle the API query itself,\n  * that should be done in the parent component with the onChange callback.\n  */\n-export default function SearchBar({ onChange, rawSearchMode }: SearchBarProps) {\n-  const [query, setQuery] = React.useState<string>(\"\");\n+export default function SearchBar({ onChange }: SearchBarProps) {\n+  const searchStrings = languageStrings.searchpage;\n+  const [rawSearchMode, setRawSearchMode] = useState<boolean>(false);\n+  const [queryString, setQuery] = React.useState<string>(\"\");\n   const strings = languageStrings.searchpage;\n   const callOnChange = (query: string) =>\n     onChange(query + (rawSearchMode ? \"\" : \"*\"));\n   /**\n    * uses lodash to debounce the search query by half a second\n    */\n-  const debouncedQuery = useCallback(debounce(callOnChange, 500), [onChange]);\n+  const debouncedQuery = useCallback(debounce(callOnChange, 500), [\n+    onChange,\n+    rawSearchMode,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee7af4ef6887a43ce5b101eaee74b9b9b83dbc69"}, "originalPosition": 52}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4965, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}