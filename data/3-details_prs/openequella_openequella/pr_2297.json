{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MzkyNjM5", "number": 2297, "title": "Include REST module's tests in GHA", "bodyText": "#1480 ### Checklist\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n tests are included\n screenshots are included showing significant UI changes\n documentation is changed or added\n\nDescription of change\nThe purpose of this PR is to include tests of module oeq-ts-rest-api in GHA.", "createdAt": "2020-09-17T04:21:08Z", "url": "https://github.com/openequella/openEQUELLA/pull/2297", "merged": true, "mergeCommit": {"oid": "320111e5a198e6f6526b5ebda580927fd0ebfe09"}, "closed": true, "closedAt": "2020-09-21T00:33:59Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJo74pAH2gAyNDg4MzkyNjM5Ojg5M2U1N2I3NGI4YTcwNjM2OWVhNDgyNmM1N2ZiY2EyY2RkNDcxNzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ_55sgFqTQ5MTE5MzA0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "893e57b74b8a706369ea4826c57fbca2cdd47175", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/893e57b74b8a706369ea4826c57fbca2cdd47175", "committedDate": "2020-09-17T04:04:10Z", "message": "Add 'async' to a test of 'auth.test.ts'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e53a26c9600f6463f75cd50881155db1d035284", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/9e53a26c9600f6463f75cd50881155db1d035284", "committedDate": "2020-09-17T04:07:08Z", "message": "Include the tests of module 'oeq-ts-rest-api' in GHA."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f489fa82336b0dc36abcc4b947d680ac2164d2f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/5f489fa82336b0dc36abcc4b947d680ac2164d2f", "committedDate": "2020-09-17T04:13:05Z", "message": "Update the password used in Rest module tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dfb852b4c91cb0cd480237be4de5c5501be2b6e", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/8dfb852b4c91cb0cd480237be4de5c5501be2b6e", "committedDate": "2020-09-17T05:22:08Z", "message": "Install Chromium and Chrome Driver for GHA job\n'rest-module-testing'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5126e1ce71fea2dd4f78503eccd97356bad1db", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/fe5126e1ce71fea2dd4f78503eccd97356bad1db", "committedDate": "2020-09-17T06:39:33Z", "message": "Specify the configuration used for initialising\noEQ in autotest."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNjk5MzU0", "url": "https://github.com/openequella/openEQUELLA/pull/2297#pullrequestreview-490699354", "createdAt": "2020-09-17T15:05:41Z", "commit": {"oid": "fe5126e1ce71fea2dd4f78503eccd97356bad1db"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTowNTo0MVrOHTnLKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxNTowNjozM1rOHTnNUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMyNjgyNw==", "bodyText": "FWIW the github linux virtual environment comes with Chrome + ChromeDriver and Firefox + GeckoDriver pre-installed https://github.com/actions/virtual-environments/blob/main/images/linux/Ubuntu2004-README.md#ubuntu-20041-lts", "url": "https://github.com/openequella/openEQUELLA/pull/2297#discussion_r490326827", "createdAt": "2020-09-17T15:05:41Z", "author": {"login": "ChristianMurphy"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -259,3 +259,78 @@ jobs:\n         with:\n           name: CoverageReport-newui-${{ matrix.newui }}\n           path: coverage_report.tar\n+\n+  rest-module-testing:\n+    needs: build_and_check\n+\n+    runs-on: ubuntu-latest\n+\n+    services:\n+      postgres:\n+        image: postgres:9.6\n+        env:\n+          POSTGRES_USER: equellatests\n+          POSTGRES_PASSWORD: password\n+        # Set health checks to wait until postgres has started\n+        options: >-\n+          --health-cmd pg_isready\n+          --health-interval 10s\n+          --health-timeout 5s\n+          --health-retries 5\n+        ports:\n+          # Maps tcp port 5432 on service container to the host\n+          - 5432:5432\n+\n+    env:\n+      AUTOTEST_CONFIG: autotest/github-actions.conf\n+\n+    steps:\n+      - uses: actions/checkout@v1\n+\n+      - name: Set up JDK 1.8\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8\n+\n+      - name: Install Chromium\n+        run: |\n+          sudo apt-get update\n+          sudo apt-get install -y --no-install-recommends \\\n+            chromium-browser \\\n+            chromium-chromedriver \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe5126e1ce71fea2dd4f78503eccd97356bad1db"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMyNzM3OA==", "bodyText": "#2284 may work here as well", "url": "https://github.com/openequella/openEQUELLA/pull/2297#discussion_r490327378", "createdAt": "2020-09-17T15:06:33Z", "author": {"login": "ChristianMurphy"}, "path": ".github/workflows/ci.yaml", "diffHunk": "@@ -259,3 +259,78 @@ jobs:\n         with:\n           name: CoverageReport-newui-${{ matrix.newui }}\n           path: coverage_report.tar\n+\n+  rest-module-testing:\n+    needs: build_and_check\n+\n+    runs-on: ubuntu-latest\n+\n+    services:\n+      postgres:\n+        image: postgres:9.6\n+        env:\n+          POSTGRES_USER: equellatests\n+          POSTGRES_PASSWORD: password\n+        # Set health checks to wait until postgres has started\n+        options: >-\n+          --health-cmd pg_isready\n+          --health-interval 10s\n+          --health-timeout 5s\n+          --health-retries 5\n+        ports:\n+          # Maps tcp port 5432 on service container to the host\n+          - 5432:5432\n+\n+    env:\n+      AUTOTEST_CONFIG: autotest/github-actions.conf\n+\n+    steps:\n+      - uses: actions/checkout@v1\n+\n+      - name: Set up JDK 1.8\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8\n+\n+      - name: Install Chromium\n+        run: |\n+          sudo apt-get update\n+          sudo apt-get install -y --no-install-recommends \\\n+            chromium-browser \\\n+            chromium-chromedriver \\\n+\n+      - name: Download installer\n+        uses: actions/download-artifact@v1\n+        with:\n+          name: Artefacts\n+\n+      - name: Extract installer from build\n+        env:\n+          DOWNLOAD_DIR: Artefacts\n+          INSTALLER_DIR: Installer/target\n+        run: |\n+          tar --directory $DOWNLOAD_DIR -xvf $DOWNLOAD_DIR/artefacts.tar\n+          mkdir -p $INSTALLER_DIR\n+          mv -v $DOWNLOAD_DIR/equella-installer*.zip $INSTALLER_DIR\n+\n+      - name: Install openEquella\n+        run: |\n+          ./sbt -jvm-opts autotest/.jvmopts \"project autotest\" \\\n+            installEquella startEquella configureInstall setupForTests\n+\n+      - name: Set up NVM\n+        shell: bash -l {0}\n+        run: |\n+          curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash\n+          export NVM_DIR=\"$HOME/.nvm\"\n+          echo \"source $NVM_DIR/nvm.sh\" >> \"$HOME/.bash_profile\"\n+\n+      - name: Install NodeJS\n+        shell: bash -l {0}\n+        run: |\n+          nvm install", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe5126e1ce71fea2dd4f78503eccd97356bad1db"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4380765d4823fd293909299299402f86ac3f67db", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/4380765d4823fd293909299299402f86ac3f67db", "committedDate": "2020-09-18T01:25:39Z", "message": "Use autotest account in REST Module tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e035fca9c050a45e4dc4eea32bd904555c9d0b99", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/e035fca9c050a45e4dc4eea32bd904555c9d0b99", "committedDate": "2020-09-18T01:32:16Z", "message": "Install NodeJs by using action 'setup-node@v1'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24d46f2eae40797e52c9129aca8efd0bbed2b5b8", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/24d46f2eae40797e52c9129aca8efd0bbed2b5b8", "committedDate": "2020-09-18T01:33:30Z", "message": "No need to install Chromium and ChromeDriver as\nthey are pre-installed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16ba1e4317d815d61b0a5f35843ba7b8bbea8f3f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/16ba1e4317d815d61b0a5f35843ba7b8bbea8f3f", "committedDate": "2020-09-18T02:38:30Z", "message": "Use env variable to access ChromeDriver.\n\nGHA's VM (ubuntu) adds ChromeDriver to an env variable\nnamed CHROMEWEBDRIVER so we can use this variable."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ee2fe53aaef3e9972d98c3a1ee1fd9efa4f313", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/83ee2fe53aaef3e9972d98c3a1ee1fd9efa4f313", "committedDate": "2020-09-18T03:55:05Z", "message": "Correct the path to ChromeDriver."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcd3b003ef8c8ec30c66427220889803198fb1ba", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/fcd3b003ef8c8ec30c66427220889803198fb1ba", "committedDate": "2020-09-18T04:29:55Z", "message": "Remove redundant double quotes for ChromeDriver path."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "738c06fbf380cc472cf6415c8b3c22e95b8b1fc2", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/738c06fbf380cc472cf6415c8b3c22e95b8b1fc2", "committedDate": "2020-09-18T05:25:40Z", "message": "Try another env var for Chrome."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff2b14083ace9c3b0d1ee5fb24138ddb9389f393", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/ff2b14083ace9c3b0d1ee5fb24138ddb9389f393", "committedDate": "2020-09-18T06:18:09Z", "message": "Job 'functional_testing' does not need to install Chrome\nas well."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTkzMDQ3", "url": "https://github.com/openequella/openEQUELLA/pull/2297#pullrequestreview-491193047", "createdAt": "2020-09-18T06:49:49Z", "commit": {"oid": "ff2b14083ace9c3b0d1ee5fb24138ddb9389f393"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 473, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}