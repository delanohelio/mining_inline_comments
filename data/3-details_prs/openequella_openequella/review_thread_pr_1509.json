{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5OTg1Mjg3", "number": 1509, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzoyMToyM1rODi7mOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNjoxOVrODjU9Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTU0NjE5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzoyMToyM1rOFudHCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzozMDozM1rOFudOqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1NTc1NA==", "bodyText": "Maybe PUT is more suitable?", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384255754", "createdAt": "2020-02-26T03:21:23Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +105,26 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"searchpage\")\n+  def loadSearchPageSettings: SearchPageSettings = {\n+    searchPrivProvider.checkAuthorised()\n+    SearchPageSettings(loadSettings(new SearchSettings), loadSettings(new CloudSettings))\n+  }\n+\n+  @POST", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1NzcwNA==", "bodyText": "I agree with this, PUT fits better. The difference is that PUT is idempotent; meaning if you were to try the same request multiple times the output would be the same as if you did it just once. That applies to changing settings, which is update rather than create operation.", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384257704", "createdAt": "2020-02-26T03:30:33Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +105,26 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"searchpage\")\n+  def loadSearchPageSettings: SearchPageSettings = {\n+    searchPrivProvider.checkAuthorised()\n+    SearchPageSettings(loadSettings(new SearchSettings), loadSettings(new CloudSettings))\n+  }\n+\n+  @POST", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1NTc1NA=="}, "originalCommit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTU2MTU0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzozMzowMFrOFudQnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwMzozMzowMFrOFudQnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI1ODIwNQ==", "bodyText": "could defaultResultOrder become defaultSortOrder?\nAlso, for showNoneLive we need the prefix version of the term (non) rather than none as a value. So it would end up being showNonLive", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384258205", "createdAt": "2020-02-26T03:33:00Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -45,12 +49,44 @@ object SettingTypeLinks {\n                        if (ed.isRoute) Some(\"/\" + ed.uri) else None)\n   }\n }\n+\n+case class GalleryViewSettings(disableImage: Boolean,\n+                               disableVideo: Boolean,\n+                               disableFileCount: Boolean)\n+\n+case class SearchPageSettings(showNoneLive: Boolean,\n+                              disableGalleryViews: GalleryViewSettings,\n+                              disableCloudSearching: Boolean,\n+                              defaultResultOrder: String,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92e7f72d99181b7a99b7c60cf3ac4b470fa2e9df"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzY5NzY1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.base/src/com/tle/common/settings/standard/SearchSettings.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxMzo1MlrOFvEutA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxMzo1MlrOFvEutA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNDg4NA==", "bodyText": "When reading this class by itself it's going to seem a bit out of place to have a stray @JsonIgnore. So how about we add a comment:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              @JsonIgnore\n          \n          \n            \n              @JsonIgnore // The REST endpoints for this was split into two - one for general search settings, and one for filters - so we don't want this included in the general search settings.", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384904884", "createdAt": "2020-02-27T04:13:52Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.base/src/com/tle/common/settings/standard/SearchSettings.java", "diffHunk": "@@ -73,6 +74,7 @@\n   @Property(key = \"search.defaultsort\")\n   private String defaultSearchSort;\n \n+  @JsonIgnore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzY5ODQ2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNDo0OFrOFvEvQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNDo0OFrOFvEvQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNTAyNg==", "bodyText": "No need to specify the Model classes here, as Swagger will document them for you based on method typings.", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384905026", "createdAt": "2020-02-27T04:14:48Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +87,46 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"search\")\n+  @ApiOperation(\n+    value = \"Load Search settings\",\n+    notes =\n+      \"This endpoint is used to retrieve general search settings excluding search filter. The corresponding Model class is SearchSettings.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzcwMDU1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNjoxOVrOFvEwew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNDoxNjoxOVrOFvEwew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwNTMzOQ==", "bodyText": "As we add all these additional settings going forward we don't all want them in this one class. I suggest for each grouping we split them into their own class. So for below we'd probably add (in the same package):\n\nSearchSettingsResource\nCloudSearchSettingsResource\n\nAnd later\n\nSearchFiltersResource", "url": "https://github.com/openequella/openEQUELLA/pull/1509#discussion_r384905339", "createdAt": "2020-02-27T04:16:19Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/scalasrc/com/tle/web/api/settings/SettingsResource.scala", "diffHunk": "@@ -69,4 +87,46 @@ class SettingsResource {\n   def setUISettings(in: UISettings): Unit = RunWithDB.executeWithPostCommit(\n     SettingsDB.ensureEditSystem(UISettings.setUISettings(in))\n   )\n+\n+  @GET\n+  @Path(\"search\")\n+  @ApiOperation(\n+    value = \"Load Search settings\",\n+    notes =\n+      \"This endpoint is used to retrieve general search settings excluding search filter. The corresponding Model class is SearchSettings.\"\n+  )\n+  def loadSearchSettings: SearchSettings = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a92936dbeb981fd4636e5fc15a852ff6dac57e"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1470, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}