{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4MzI2NDA1", "number": 1655, "title": "Feature/boost settings", "bodyText": "Checklist\n\n\n the contributor license agreement is signed\n commit message follows commit guidelines\n screenshots are included showing significant UI changes\n\nDescription of change\n#1337", "createdAt": "2020-04-24T04:43:56Z", "url": "https://github.com/openequella/openEQUELLA/pull/1655", "merged": true, "mergeCommit": {"oid": "c47b9dc70d57eb5b2b9a210bd4a8e447efbb2511"}, "closed": true, "closedAt": "2020-04-30T23:21:25Z", "author": {"login": "mrblippy"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcapsXmgH2gAyNDA4MzI2NDA1OjNlZmFmZDkyNTc3OTZiYzg4NTQyZGY2MDgyYjlkMDA2NzgxZDc3ZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcc1Q5PgFqTQwMzkzMzQzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3efafd9257796bc88542df6082b9d006781d77d8", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/3efafd9257796bc88542df6082b9d006781d77d8", "committedDate": "2020-04-24T04:22:41Z", "message": "Seach boosting sliders i did all by myself"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d7830c04b54067154f921bafb1ee21bbd35d6a1", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/2d7830c04b54067154f921bafb1ee21bbd35d6a1", "committedDate": "2020-04-24T04:30:22Z", "message": "formatting changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed3819a455cd25f954de770f87182bdb95a52bc5", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/ed3819a455cd25f954de770f87182bdb95a52bc5", "committedDate": "2020-04-24T04:56:22Z", "message": "moved ariaText function to constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d7d9dca24492403e1d81dafd5612a67b1307862", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/5d7d9dca24492403e1d81dafd5612a67b1307862", "committedDate": "2020-04-24T05:21:03Z", "message": "Merge branch 'component/search_configuration' into feature/boost-settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjkwMzg0", "url": "https://github.com/openequella/openEQUELLA/pull/1655#pullrequestreview-399690384", "createdAt": "2020-04-24T07:07:07Z", "commit": {"oid": "5d7d9dca24492403e1d81dafd5612a67b1307862"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNzowNzowOFrOGLJnug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNzowNzowOFrOGLJnug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM0NTE0Ng==", "bodyText": "If we can move this to langstrings,  then we could also remove  sliderMarks .", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r414345146", "createdAt": "2020-04-24T07:07:08Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/settings/Search/ContentIndexSettings.tsx", "diffHunk": "@@ -46,8 +46,21 @@ function ContentIndexSettings({ updateTemplate }: TemplateUpdateProps) {\n \n   const contentIndexSettingsStrings =\n     languageStrings.settings.searching.contentIndexSettings;\n+\n+  const markStrings = contentIndexSettingsStrings.sliderMarks;\n   const classes = useStyles();\n \n+  const boostVals: Mark[] = [\n+    { label: markStrings.off, value: 0 },\n+    { label: \"x0.25\", value: 1 },\n+    { label: \"x0.5\", value: 2 },\n+    { label: markStrings.noBoost, value: 3 },\n+    { label: \"x1.5\", value: 4 },\n+    { label: \"x2\", value: 5 },\n+    { label: \"x4\", value: 6 },\n+    { label: \"x8\", value: 7 },\n+  ];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d7d9dca24492403e1d81dafd5612a67b1307862"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b628081023ec2eda3c4bf02b65b7bede7bb69df", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/9b628081023ec2eda3c4bf02b65b7bede7bb69df", "committedDate": "2020-04-29T06:26:10Z", "message": "Beginnings of ContentIndexing jest test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc8c9da74d0b8aea335f7a51a572ef55779c3517", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/fc8c9da74d0b8aea335f7a51a572ef55779c3517", "committedDate": "2020-04-29T06:29:08Z", "message": "Merge branch 'feature/boost-settings' of https://github.com/mrblippy/Charliequella into feature/boost-settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMTA3NTMz", "url": "https://github.com/openequella/openEQUELLA/pull/1655#pullrequestreview-403107533", "createdAt": "2020-04-29T23:25:05Z", "commit": {"oid": "fc8c9da74d0b8aea335f7a51a572ef55779c3517"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQyMzoyNTowNVrOGOUhhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQwMDo0NDoyMlrOGOV_XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTUwOA==", "bodyText": "Can remove this line.", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417669508", "createdAt": "2020-04-29T23:25:05Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc8c9da74d0b8aea335f7a51a572ef55779c3517"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY2OTgzNw==", "bodyText": "I think we can use jest.fn instead of () => null ?", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417669837", "createdAt": "2020-04-29T23:26:04Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc8c9da74d0b8aea335f7a51a572ef55779c3517"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3NzQwMQ==", "bodyText": "Can we just use () => Promise.resolve(SearchSettingsModule.defaultSearchSettings) in the mockImplementation block?", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417677401", "createdAt": "2020-04-29T23:50:08Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b628081023ec2eda3c4bf02b65b7bede7bb69df"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY3OTg2Ng==", "bodyText": "This expect does not match the description. We can have another it for testing if getSearchSettingsFromServer has been called in the useEffect.", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417679866", "createdAt": "2020-04-29T23:57:51Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);\n+\n+  describe(\"When content indexing settings page page is loaded\", () => {\n+    const component = renderComponent();\n+    const listControls = component.find(SettingsList);\n+    const defaultVals = SearchSettingsModule.defaultSearchSettings;\n+\n+    it(\"should display the default values\", () => {\n+      expect(listControls.length).toBeGreaterThanOrEqual(2);\n+      expect(\n+        SearchSettingsModule.getSearchSettingsFromServer\n+      ).toHaveBeenCalledTimes(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b628081023ec2eda3c4bf02b65b7bede7bb69df"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY5MzUzMw==", "bodyText": "I think we can skip findWhere for Content indexing.", "url": "https://github.com/openequella/openEQUELLA/pull/1655#discussion_r417693533", "createdAt": "2020-04-30T00:44:22Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/mainui/ContentIndexSettings.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import * as React from \"react\";\n+import { mount } from \"enzyme\";\n+import ContentIndexSettings from \"../../../tsrc/settings/Search/ContentIndexSettings\";\n+import * as SearchSettingsModule from \"../../../tsrc/settings/Search/SearchSettingsModule\"; // eslint-disable-line\n+import SettingsList from \"../../../tsrc/components/SettingsList\";\n+import WebPageIndexSetting from \"../../../tsrc/settings/Search/components/WebPageIndexSetting\";\n+import { Slider } from \"@material-ui/core\";\n+\n+describe(\"Content Index Settings Page\", () => {\n+  jest\n+    .spyOn(SearchSettingsModule, \"getSearchSettingsFromServer\")\n+    .mockImplementation(\n+      () =>\n+        new Promise(\n+          (\n+            resolve: (settings: SearchSettingsModule.SearchSettings) => void,\n+            reject: (error: any) => void\n+          ) => {\n+            console.log(\"its in ere\");\n+            resolve(SearchSettingsModule.defaultSearchSettings);\n+          }\n+        )\n+    );\n+\n+  const renderComponent = () =>\n+    mount(<ContentIndexSettings updateTemplate={() => null} />);\n+\n+  describe(\"When content indexing settings page page is loaded\", () => {\n+    const component = renderComponent();\n+    const listControls = component.find(SettingsList);\n+    const defaultVals = SearchSettingsModule.defaultSearchSettings;\n+\n+    it(\"should display the default values\", () => {\n+      expect(listControls.length).toBeGreaterThanOrEqual(2);\n+      expect(\n+        SearchSettingsModule.getSearchSettingsFromServer\n+      ).toHaveBeenCalledTimes(1);\n+\n+      //content indexing stuff\n+      const contentIndex = listControls\n+        .findWhere((c) => c.prop(\"primaryText\") === \"Content indexing\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b628081023ec2eda3c4bf02b65b7bede7bb69df"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c331e9ee71b6225891f181b7069680e656e30bb", "author": {"user": {"login": "edalex-ian", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/7c331e9ee71b6225891f181b7069680e656e30bb", "committedDate": "2020-04-30T01:01:16Z", "message": "Refactor config.ts\n\nThis file only seems to be for the course editor (?), but we could\nupdate it to use modern syntax and also provide safer results. Without\nthis, it was causing the new Jest tests to fail due to execution on\nimport."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28db3cacff1c6c8047cbc667557920324314a769", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/28db3cacff1c6c8047cbc667557920324314a769", "committedDate": "2020-04-30T01:38:08Z", "message": "autotest pr feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde", "author": {"user": {"login": "edalex-ian", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde", "committedDate": "2020-04-30T05:59:07Z", "message": "Property setup lazy loading for RichTextEditor\n\nThe RichTextEditor pulls in the whole of TinyMCE which has some code\nthat will execute on import. This code was breaking the new Jest test as\nit was expecting various values to be pulled from the `window` object.\n\nLazily loading, helps with both of these.\n\nHowever, this is not splitting the bundle, as parcel does not support\nthis form of code splitting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMjI5MjAw", "url": "https://github.com/openequella/openEQUELLA/pull/1655#pullrequestreview-403229200", "createdAt": "2020-04-30T06:15:21Z", "commit": {"oid": "3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzOTMzNDM2", "url": "https://github.com/openequella/openEQUELLA/pull/1655#pullrequestreview-403933436", "createdAt": "2020-04-30T22:59:23Z", "commit": {"oid": "3bf49fcb1e45ecfdc024b1a0dd75ef17931d5cde"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 80, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}