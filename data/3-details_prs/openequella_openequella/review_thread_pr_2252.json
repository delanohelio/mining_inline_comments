{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NjAwNDM4", "number": 2252, "reviewThreads": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNjoyMjo0M1rOEfSBog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNjoyN1rOEjK5jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMjM2NjQyOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNjoyMjo0M1rOHLdZ7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMzowOTo1MFrOHMUOpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng==", "bodyText": "This piece of code in particular is something i'm not proud of, for multiple reasons.\n\nThe destructuring looks ugly, so if anyone has any a good way to include only a subset of searchPageOptions properties\nWhat collapsed filters to include is being defined here (to determine what filters have been modified), but RefineSearchPanel is controlling what controls are appearing in the collapsible panel. So maintenance will be an issue", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r481778156", "createdAt": "2020-09-02T06:22:43Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2Nzc4NQ==", "bodyText": "I see what you mean! As per @ChristianMurphy suggestion, how about something like:\n  const areCollapsibleFiltersSet = (): boolean => {\n    const getCollapsedOptions = (options: SearchPageOptions) =>\n      _.pick( options, [\"lastModifiedDateRange\", \"owner\", \"status\", \"searchAttachments\"]);\n\n    return !_.isEqual(\n      getCollapsedOptions(defaultSearchOptions),\n      getCollapsedOptions(searchPageOptions));\n  }", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482667785", "createdAt": "2020-09-03T02:36:35Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng=="}, "originalCommit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3NjM5MA==", "bodyText": "Yeah, this lodash pick is much better than what I ended up with \ud83e\udd2e\nFunnily enough, I was originally using the lodash pick function. So in this case I probably should've just gone with my first instinct", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482676390", "createdAt": "2020-09-03T03:09:50Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng=="}, "originalCommit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNDg0MDI3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo0Mzo1NVrOHL1j-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo0Mzo1NVrOHL1j-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3Mzk0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { Collection } from \"../modules/CollectionsModule\";\n          \n          \n            \n            import type { Collection } from \"../modules/CollectionsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482173947", "createdAt": "2020-09-02T15:43:55Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -15,41 +15,42 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+import { Grid } from \"@material-ui/core\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n import * as React from \"react\";\n import { useEffect, useRef, useState } from \"react\";\n+import { useHistory } from \"react-router\";\n+import { generateFromError } from \"../api/errors\";\n+import { DateRange, DateRangeSelector } from \"../components/DateRangeSelector\";\n import {\n   templateDefaults,\n   templateError,\n   TemplateUpdateProps,\n } from \"../mainui/Template\";\n-import { languageStrings } from \"../util/langstrings\";\n-import { Grid } from \"@material-ui/core\";\n+import { Collection } from \"../modules/CollectionsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNDg2ODk2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo1MDoyOVrOHL11wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo1MDoyOVrOHL11wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3ODQ5OA==", "bodyText": "https://lodash.com/docs/#pick may help here", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482178498", "createdAt": "2020-09-02T15:50:29Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {\n+    const defaultCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      defaultSearchOptions\n+    );\n+\n+    const currentCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      searchPageOptions\n+    );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 161}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzYxMjgzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozMzowNlrOHMSBEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozMzowNlrOHMSBEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MDE0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Collapsible refine filter section\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Collapsible refine filter section\", () => {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482640147", "createdAt": "2020-09-03T01:33:06Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzYyMjgwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozODoxMVrOHMSGhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozODoxMVrOHMSGhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTU0Mw==", "bodyText": "Some (all?) of these have also be defined elsewhere in this file. Seeing they're a key component we need to work with, perhaps we should define them at the top level or in a SearchPageHelper.ts[x] file. If it were for such a file, it'd also be where the queryRefineSearchComponent would live too.\nOn other details, you've called these getXyz, however we're aiming to align with the React Testing Library standards and so these should all be queryXyz. (The key difference being, getXyz should throw if it can't find the element whereas queryXyz simply returns null.)", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641543", "createdAt": "2020-09-03T01:38:11Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzYyNDU5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozOToxNFrOHMSHjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDo1NDoyMVrOHMV4EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw==", "bodyText": "Would it be worth ensuring that there is only 1 'item'?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641807", "createdAt": "2020-09-03T01:39:14Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");\n+\n+  it(\"Should contain the correct controls\", async () => {\n+    const collapsibleSection = page.container\n+      .getElementsByClassName(\"collapsibleRefinePanel\")\n+      .item(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5NjcwMw==", "bodyText": "I think that would be sensible", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482696703", "createdAt": "2020-09-03T04:29:52Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");\n+\n+  it(\"Should contain the correct controls\", async () => {\n+    const collapsibleSection = page.container\n+      .getElementsByClassName(\"collapsibleRefinePanel\")\n+      .item(0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcwMzM3Ng==", "bodyText": "Why not use querySelector(\".collapsibleRefinePanel\") ?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482703376", "createdAt": "2020-09-03T04:54:21Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");\n+\n+  it(\"Should contain the correct controls\", async () => {\n+    const collapsibleSection = page.container\n+      .getElementsByClassName(\"collapsibleRefinePanel\")\n+      .item(0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzY0MDA1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo0Njo1NFrOHMSQIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo0Njo1NFrOHMSQIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDAwMA==", "bodyText": "Props is something different, and SearchHistory sounds more like it's about all our previous searches. Could I suggest something like:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            interface SearchHistoryProps {\n          \n          \n            \n            interface SearchPageHistoryState {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644000", "createdAt": "2020-09-03T01:46:54Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history\n+ */\n+interface SearchHistoryProps {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzY0MjM1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo0ODoxNVrOHMSRew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo0ODoxNVrOHMSRew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDM0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Type to keep track of values stored in history\n          \n          \n            \n             * Structure of data stored in browser's history state to capture the current state of the SearchPage\n          \n          \n            \n             * to support on back.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644347", "createdAt": "2020-09-03T01:48:15Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzY2MDk3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo1ODoxNFrOHMScMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTo1ODoxNFrOHMScMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NzA5MQ==", "bodyText": "It's not so much managing, it's only storing or persisting. Maybe:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const manageSearchPageHistory = () => {\n          \n          \n            \n              const storeSearchPageHistory = () => {\n          \n      \n    \n    \n  \n\nThen again though, if you see my recommendation above about adding pagedSearchResult as a new dependency of your Effect, then this stand alone function can just be the anonymous function of useEffect.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482647091", "createdAt": "2020-09-03T01:58:14Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);\n+\n   const handleError = (error: Error) => {\n     updateTemplate(templateError(generateFromError(error)));\n   };\n \n+  const manageSearchPageHistory = () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzY2NzgwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjowMjowNFrOHMSgTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjowMjowNFrOHMSgTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0ODE0Mw==", "bodyText": "We can make this look after all the cases. Below in search where you've called manageSearchPageHistory is such that it only saves the options to history on a successful search which is then what drives pagedSearchResult. So:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              }, [filterExpansion]);\n          \n          \n            \n              }, [filterExpansion, pagedSearchResult]);", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482648143", "createdAt": "2020-09-03T02:02:04Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 108}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzc5NjY0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo0MTo1NFrOHMTylA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNDoyNjozNFrOHSflLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA==", "bodyText": "This name sounds all encompassing. How's about onChangeExpansion or something?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669204", "createdAt": "2020-09-03T02:41:54Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEzODMyNg==", "bodyText": "This was marked as resolved, but... Looks like it wasn't. \ud83e\udd14", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r489138326", "createdAt": "2020-09-16T03:24:19Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1MzgzOQ==", "bodyText": "Sorry @edalex-ian . It is now fixed", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r489153839", "createdAt": "2020-09-16T04:26:34Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzc5NzY1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo0MjoyOVrOHMTzMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo0MjoyOVrOHMTzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTM2MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Determines the current state of the filter expansion panel\n          \n          \n            \n               * Specifies whether the expansion panel should be expanded or collapsed.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669360", "createdAt": "2020-09-03T02:42:29Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzgwNDc2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo0Njo0M1rOHMT3ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDozNjoxN1rOHMVldw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDQ1OQ==", "bodyText": "There's an assumption being made here that the Collection control is first.\nTo some degree, that's outside the purview of this component. The contract for this component is that it will display the first component outside of the selection control, so perhaps this should just be:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const [collectionControl, ...collapsedControls] = controls.filter(\n          \n          \n            \n              const [alwaysVisibleControl, ...collapsedControls] = controls.filter(\n          \n      \n    \n    \n  \n\nFor now that's all we need. But if that ever changed then we'd possibly allow two lots of controls to be passed in - those in the expansion panel, those outside of it.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670459", "createdAt": "2020-09-03T02:46:43Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5ODYxNQ==", "bodyText": "Yeah, I had originally envisioned to pass in two sets of controls, but yeah, we can cross that bridge if the need arises in the future", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482698615", "createdAt": "2020-09-03T04:36:17Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDQ1OQ=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzgwODAwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo0ODo0N1rOHMT5iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNDo0NToyMlrOHMVujQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ==", "bodyText": "This just occurred to me, and applies to all our components. For keyboard accessibility, is it sufficient that we're only ever doing onClick?\nSee you did some of our recent accessibility work, you might be well placed to answer that.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670985", "createdAt": "2020-09-03T02:48:47Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3NDk4NA==", "bodyText": "Yeah, that has been in the back of my mind for a while. I'm not sure on the answer to it. But it definitely warrants further investigation. Because, like you said, this could have implications for all of our React/Material components", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482674984", "createdAt": "2020-09-03T03:04:13Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY4MjEwNw==", "bodyText": "The button appears to be responding to the enter key. It appears that, the majority of the time the enter key will trigger an onClick event.\nSome more detailed explanation can be found here https://webaim.org/techniques/javascript/eventhandlers#onclick", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482682107", "createdAt": "2020-09-03T03:32:33Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcwMDk0MQ==", "bodyText": "Nice work! Thanks @mrblippy", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482700941", "createdAt": "2020-09-03T04:45:22Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxNzgxMTQ0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/util/langstrings.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo1MDozOVrOHMT7eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo1MDozOVrOHMT7eA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MTQ4MA==", "bodyText": "It was agreed we're going to aim for camelCase here, so:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  showmore: \"Show more\",\n          \n          \n            \n                  showless: \"Show less\",\n          \n          \n            \n                  showMore: \"Show more\",\n          \n          \n            \n                  showLess: \"Show less\",", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482671480", "createdAt": "2020-09-03T02:50:39Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/util/langstrings.ts", "diffHunk": "@@ -301,6 +301,8 @@ export const languageStrings = {\n       done: \"Done\",\n       yes: \"Yes\",\n       no: \"No\",\n+      showmore: \"Show more\",\n+      showless: \"Show less\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU3NjM1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoxNzo1N1rOHNA_SA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNTo1NDozOVrOHRxw2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg==", "bodyText": "Nit: This name makes it sound like a function. Maybe:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                const findCollapsibleSection = page.container.getElementsByClassName(\n          \n          \n            \n                const collapsibleSections = page.container.getElementsByClassName(\n          \n      \n    \n    \n  \n\nIs there a suitable RTL query we could do here directly on page rather than using container. Probably a getAllBy?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483409736", "createdAt": "2020-09-04T06:17:57Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMDQxMw==", "bodyText": "Currently, the only way to target the collapsible filter section is by using a classname. There's no RTL query to perform this function. So it will have to stay as-is", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487610413", "createdAt": "2020-09-14T01:41:21Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5ODM5Mg==", "bodyText": "I would try to give an ID to the panel, get the panel by querySelector, and then use getAllByRole(\"listitem\") to get a list of controls wrapped inside this panel. So the benefit is you don't need to check how many the length of collapsibleSections and use collapsibleSections.item(0) to access the panel.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488398392", "createdAt": "2020-09-15T05:41:09Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQwMzE2MA==", "bodyText": "You may not even need an ID. You can get the panel by finding the parent node of  h5 Refine search.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488403160", "createdAt": "2020-09-15T05:54:39Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU3ODI2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoxODo0OVrOHNBAdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoxODo0OVrOHNBAdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMDAzNg==", "bodyText": "Good to have a line space here, as you're into a whole new logical block.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Hide Refine Search controls\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Hide Refine Search controls\", () => {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483410036", "createdAt": "2020-09-04T06:18:49Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 89}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU4NzQ4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyMjoyM1rOHNBFqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMzozOTo0MFrOHRASqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTM3MA==", "bodyText": "You may want to highlight that these are queryXyz functions. Appreciating the name would shadow the the main ones, one option is an underscore prefix:\n_queryOwnerSelector() etc.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411370", "createdAt": "2020-09-04T06:22:23Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const ownerSelector = () => queryOwnerSelector(page.container);\n+  const dateSelector = () => queryDateRangeSelector(page.container);\n+  const statusSelector = () => queryStatusSelector(page.container);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjYxOA==", "bodyText": "Oh ok, the underscore prefix sounds good for the const names", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592618", "createdAt": "2020-09-13T23:39:40Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const ownerSelector = () => queryOwnerSelector(page.container);\n+  const dateSelector = () => queryDateRangeSelector(page.container);\n+  const statusSelector = () => queryStatusSelector(page.container);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTM3MA=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU4OTI5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyMzowNVrOHNBGrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMzozODowOFrOHRASAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTYzMQ==", "bodyText": "Interesting you've changed all these from getXyz to queryXyz semantics. Was that intended?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411631", "createdAt": "2020-09-04T06:23:05Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -331,19 +363,19 @@ describe(\"Hide Refine Search controls\", () => {\n     // Reuse default Search settings as disableStatusSelector, enableOwnerSelector and enableDateSelector.\n     [\n       \"Owner Selector\",\n-      getOwnerSelector,\n+      ownerSelector,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjQ0OA==", "bodyText": "I now can't really remember why i made this change. After looking at this again, i think I should revert it to how it was", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592448", "createdAt": "2020-09-13T23:38:08Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -331,19 +363,19 @@ describe(\"Hide Refine Search controls\", () => {\n     // Reuse default Search settings as disableStatusSelector, enableOwnerSelector and enableDateSelector.\n     [\n       \"Owner Selector\",\n-      getOwnerSelector,\n+      ownerSelector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTYzMQ=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjU5MTQ5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPageHelper.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyNDowMlrOHNBIAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xM1QyMzozODoyNlrOHRASHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTk3MQ==", "bodyText": "See you've brought this one over, it'd make sense to also bring over the getRefineSearchComponent as they're a bit of pidgeon pair.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411971", "createdAt": "2020-09-04T06:24:02Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPageHelper.tsx", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+/**\n+ * Helper function to find individual Refine Search components based on the their `idSuffix`,\n+ * or return null if the component is not found.\n+ *\n+ * @param container The root container to start the search from\n+ * @param componentSuffix Typically the `idSuffix` provided in `SearchPage.tsx`\n+ */\n+export const queryRefineSearchComponent = (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MjQ3Nw==", "bodyText": "Yeah, I was wondering about that. I will move it over too", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487592477", "createdAt": "2020-09-13T23:38:26Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPageHelper.tsx", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+/**\n+ * Helper function to find individual Refine Search components based on the their `idSuffix`,\n+ * or return null if the component is not found.\n+ *\n+ * @param container The root container to start the search from\n+ * @param componentSuffix Typically the `idSuffix` provided in `SearchPage.tsx`\n+ */\n+export const queryRefineSearchComponent = (", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTk3MQ=="}, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzEzMTI4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/CategorySelector.stories.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNDoxN1rOHRX-zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMjo1MDoyOVrOHRqUgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MDc1MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487980750", "createdAt": "2020-09-14T14:34:17Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/CategorySelector.stories.tsx", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI4MTIxOQ==", "bodyText": "I keep forgetting about that type keyword \ud83e\udd26  thanks @ChristianMurphy", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r488281219", "createdAt": "2020-09-14T22:50:29Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/CategorySelector.stories.tsx", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MDc1MA=="}, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzEzNzUzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/modules/SearchModule.test.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNTozNVrOHRYCsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNTozNVrOHRYCsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTc0Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487981746", "createdAt": "2020-09-14T14:35:35Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/modules/SearchModule.test.ts", "diffHunk": "@@ -16,81 +16,92 @@\n  * limitations under the License.\n  */\n import * as OEQ from \"@openequella/rest-api-client\";\n+import { getSearchResult } from \"../../../__mocks__/SearchResult.mock\";\n+import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzE0MTkwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/CategorySelector.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNjoyN1rOHRYFWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNjoyN1rOHRYFWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MjQyNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487982425", "createdAt": "2020-09-14T14:36:27Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/CategorySelector.test.tsx", "diffHunk": "@@ -24,33 +24,33 @@ import {\n   RenderResult,\n   getAllByRole,\n } from \"@testing-library/react\";\n-import { FacetSelector } from \"../../../../tsrc/search/components/FacetSelector\";\n-import * as FacetSelectorMock from \"../../../../__mocks__/FacetSelector.mock\";\n+import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1770, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}