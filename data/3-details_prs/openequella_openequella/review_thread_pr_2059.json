{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODk3OTM2", "number": 2059, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNTowMTozNVrOEO9qBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo1NjoyMVrOEPYJsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MTI1NzAzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNTowMTozNVrOGyaMbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNTowMTozNVrOGyaMbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUxMTE0OA==", "bodyText": "I was trying to add one more  expect here.\nexpect(SearchModule.searchItems).toHaveBeenCalledWith({\n  ...defaultSearchOptions,\n  collections: selectedCollections\n})\n\nBut this expect always failed which is strange, but I will try to fix it.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455511148", "createdAt": "2020-07-16T05:01:35Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -228,4 +239,17 @@ describe(\"<SearchPage/>\", () => {\n     and the search triggered by the Enter key.*/\n     expect(SearchModule.searchItems).toHaveBeenCalledTimes(2);\n   });\n+\n+  it(\"should filter search results by collections\", async () => {\n+    const selectedCollections = [\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545fff\",\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545ffe\",\n+    ];\n+    const collectionSelector = component.find(CollectionSelector);\n+    const handleCollectionChange: (\n+      collections: string[]\n+    ) => void = collectionSelector.prop(\"onSelectionChange\");\n+    await awaitAct(() => handleCollectionChange(selectedCollections));\n+    expect(SearchModule.searchItems).toHaveBeenCalledTimes(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ce437bc462a8d8946dc1cc61810f25bf9461997"}, "originalPosition": 78}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MTM4MzY5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjowNzowOFrOGybWlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjoxOToyMVrOGybmug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMDEzNQ==", "bodyText": "I did not know you could find like this directly. That's really neat.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455530135", "createdAt": "2020-07-16T06:07:08Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -228,4 +239,17 @@ describe(\"<SearchPage/>\", () => {\n     and the search triggered by the Enter key.*/\n     expect(SearchModule.searchItems).toHaveBeenCalledTimes(2);\n   });\n+\n+  it(\"should filter search results by collections\", async () => {\n+    const selectedCollections = [\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545fff\",\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545ffe\",\n+    ];\n+    const collectionSelector = component.find(CollectionSelector);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzNDI2Ng==", "bodyText": "Yes when we want to access a component instead of a dom element we can do this.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455534266", "createdAt": "2020-07-16T06:19:21Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -228,4 +239,17 @@ describe(\"<SearchPage/>\", () => {\n     and the search triggered by the Enter key.*/\n     expect(SearchModule.searchItems).toHaveBeenCalledTimes(2);\n   });\n+\n+  it(\"should filter search results by collections\", async () => {\n+    const selectedCollections = [\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545fff\",\n+      \"8e3caf16-f3cb-b3dd-d403-e5eb8d545ffe\",\n+    ];\n+    const collectionSelector = component.find(CollectionSelector);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMDEzNQ=="}, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MTM4NTc3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjowODowOFrOGybX6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjowODowOFrOGybX6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMDQ3NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Fire when collection selections are changed.\n          \n          \n            \n               * Fires when collection selections are changed.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455530475", "createdAt": "2020-07-16T06:08:08Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MTM5MDkzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjoxMDozM1rOGybbFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjoxMzo1M1rOGybfcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMTI4NA==", "bodyText": "This should be a language string.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455531284", "createdAt": "2020-07-16T06:10:33Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(event: React.ChangeEvent<{}>, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));\n+      }}\n+      options={collections}\n+      disableCloseOnSelect\n+      getOptionLabel={(collection) => collection[1]}\n+      renderOption={(collection, { selected }) => (\n+        <>\n+          <Checkbox\n+            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n+            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n+            checked={selected}\n+          />\n+          {collection[1]}\n+        </>\n+      )}\n+      renderInput={(params) => (\n+        <TextField\n+          {...params}\n+          variant=\"outlined\"\n+          label=\"Collections\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMjQwMg==", "bodyText": "Yes! THanks for reminding!", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455532402", "createdAt": "2020-07-16T06:13:53Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(event: React.ChangeEvent<{}>, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));\n+      }}\n+      options={collections}\n+      disableCloseOnSelect\n+      getOptionLabel={(collection) => collection[1]}\n+      renderOption={(collection, { selected }) => (\n+        <>\n+          <Checkbox\n+            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n+            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n+            checked={selected}\n+          />\n+          {collection[1]}\n+        </>\n+      )}\n+      renderInput={(params) => (\n+        <TextField\n+          {...params}\n+          variant=\"outlined\"\n+          label=\"Collections\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzMTI4NA=="}, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MTQxNTM1OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNjoyMTowMVrOGybpbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzowNTozMVrOGy_vVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzNDk1Ng==", "bodyText": "I wonder if people are confused by collection[0] and collection[1]. They refer to the uuid and name of a collection. Perhaps another interface can help this ?", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455534956", "createdAt": "2020-07-16T06:21:01Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(event: React.ChangeEvent<{}>, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU1MDMyMQ==", "bodyText": "If I remember right you can destructure.\n([uuid, name] => uuid)", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r455550321", "createdAt": "2020-07-16T06:55:44Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(event: React.ChangeEvent<{}>, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzNDk1Ng=="}, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEyNjI5Mg==", "bodyText": "Yes, would be good to do the destructure. As one question I had earlier on in this was whether or not collection: string was the UUID or the name - and was hoping this would clarify for me (which in its current state does not).", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456126292", "createdAt": "2020-07-16T23:05:31Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fire when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(event: React.ChangeEvent<{}>, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzNDk1Ng=="}, "originalCommit": {"oid": "113c6b1f7ad417b25203dbd914253c060789e2a5"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDgzNzI5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchModule.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMTowNDo0N1rOGy8vdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzoyNzo0NFrOGzAKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3NzE3Mw==", "bodyText": "Would it make sense to destructure this directly in the function params?", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456077173", "createdAt": "2020-07-16T21:04:47Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchModule.ts", "diffHunk": "@@ -40,7 +40,13 @@ export const defaultPagedSearchResult: OEQ.Common.PagedResult<OEQ.Search.SearchR\n export const searchItems = (\n   searchOptions: SearchOptions\n ): Promise<OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>> => {\n-  const { query, rowsPerPage, currentPage, sortOrder } = searchOptions;\n+  const {\n+    query,\n+    rowsPerPage,\n+    currentPage,\n+    sortOrder,\n+    collections,\n+  } = searchOptions;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzMzE4Nw==", "bodyText": "Good idea!", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456133187", "createdAt": "2020-07-16T23:27:44Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchModule.ts", "diffHunk": "@@ -40,7 +40,13 @@ export const defaultPagedSearchResult: OEQ.Common.PagedResult<OEQ.Search.SearchR\n export const searchItems = (\n   searchOptions: SearchOptions\n ): Promise<OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>> => {\n-  const { query, rowsPerPage, currentPage, sortOrder } = searchOptions;\n+  const {\n+    query,\n+    rowsPerPage,\n+    currentPage,\n+    sortOrder,\n+    collections,\n+  } = searchOptions;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3NzE3Mw=="}, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTE1NDExOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzowMjo0MlrOGy_rXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzowMjo0MlrOGy_rXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEyNTI3Nw==", "bodyText": "For the other onChange type handlers above we've used handler functions (e.g. handleSortOrderChanged()). For consistency, let's stick with that. (As an aside, when working through some refactoring on this, having them split out like this (even for simple functions) has been handy.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456125277", "createdAt": "2020-07-16T23:02:42Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -137,11 +138,11 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n \n       <Grid item xs={3}>\n         <RefineSearchPanel>\n-          <Typography>place holder 1</Typography>\n-          <Typography>place holder 2</Typography>\n-          <Typography>place holder 3</Typography>\n-          <Typography>place holder 4</Typography>\n-          <Typography>place holder 5</Typography>\n+          <CollectionSelector\n+            onSelectionChange={(collections: string[]) =>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTE2NTA4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzowNzo0MlrOGy_xxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzowNzo0MlrOGy_xxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEyNjkxNw==", "bodyText": "In my current work to support 'back' to the search page, we need a prop that allows us to set the initial selections. Any chance you could add this?", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456126917", "createdAt": "2020-07-16T23:07:42Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTI0NDM3OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMzo0NDo0MlrOGzAfMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMDoyNToxNVrOGzBNnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzODU0NQ==", "bodyText": "what are collection[0] and collection[1]?\nAre these things we could destructure and give more meaningful names?", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456138545", "createdAt": "2020-07-16T23:44:42Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(_, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));\n+      }}\n+      options={collections}\n+      disableCloseOnSelect\n+      getOptionLabel={(collection) => collection[1]}\n+      renderOption={(collection, { selected }) => (\n+        <>\n+          <Checkbox\n+            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n+            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n+            checked={selected}\n+          />\n+          {collection[1]}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE1MDQzMQ==", "bodyText": "Yes I will give more meaningful names.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456150431", "createdAt": "2020-07-17T00:25:15Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import { collectionListSummary } from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: string[]) => void;\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<[string, string][]>([]);\n+  useEffect(() => {\n+    collectionListSummary([\n+      \"SEARCH_COLLECTION\",\n+    ]).then((collections: Map<string, string>) =>\n+      setCollections(Array.from(collections))\n+    );\n+  }, []);\n+\n+  return (\n+    <Autocomplete\n+      multiple\n+      fullWidth\n+      limitTags={2}\n+      onChange={(_, value: [string, string][]) => {\n+        onSelectionChange(value.map((collection) => collection[0]));\n+      }}\n+      options={collections}\n+      disableCloseOnSelect\n+      getOptionLabel={(collection) => collection[1]}\n+      renderOption={(collection, { selected }) => (\n+        <>\n+          <Checkbox\n+            icon={<CheckBoxOutlineBlankIcon fontSize=\"small\" />}\n+            checkedIcon={<CheckBoxIcon fontSize=\"small\" />}\n+            checked={selected}\n+          />\n+          {collection[1]}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzODU0NQ=="}, "originalCommit": {"oid": "b7b4dc75f41161333fc3906d14acb62e9f169a06"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTUzMDg4OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/CollectionsModule.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjoxNjowOVrOGzDCVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjoxNjowOVrOGzDCVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4MDMxMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * A simplified type of Collection used when only collection'uuid and name are required.\n          \n          \n            \n             * A simplified type of Collection used when only collection uuid and name are required.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456180310", "createdAt": "2020-07-17T02:16:09Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/modules/CollectionsModule.ts", "diffHunk": "@@ -35,3 +35,17 @@ export const collectionListSummary = (\n     length: 100,\n     privilege: requiredPrivileges,\n   }).then(summarisePagedBaseEntities);\n+\n+/**\n+ * A simplified type of Collection used when only collection'uuid and name are required.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cf9953f3f0228d080626f4d084789482cf5b2d2"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTU5MDkwOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo1MjoxMFrOGzDmGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNDowNzoyNVrOGzEqaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4OTQ2NA==", "bodyText": "If it's more useful, how about changing collectionListSummary to return Collection[]?", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456189464", "createdAt": "2020-07-17T02:52:10Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );\n+\n+  useEffect(() => {\n+    collectionListSummary([", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwNjk1NQ==", "bodyText": "Good idea.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456206955", "createdAt": "2020-07-17T04:07:25Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );\n+\n+  useEffect(() => {\n+    collectionListSummary([", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4OTQ2NA=="}, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTU5NzkzOnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo1NjoyMVrOGzDqLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNDoxODo0NVrOGzEz5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE5MDUxMQ==", "bodyText": "Do you need that in state at all?\nI'd assume you'd just use value directly down on the AutoComplete's value, and then rely on two way binding via onSelectionChange. \ud83e\udd14", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456190511", "createdAt": "2020-07-17T02:56:21Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwNjg2Ng==", "bodyText": "The reason for using this state to avoid this warning:  A component is changing the uncontrolled value state of Autocomplete to be controlled.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456206866", "createdAt": "2020-07-17T04:07:01Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE5MDUxMQ=="}, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwNzY3OQ==", "bodyText": "But we can also avoid the warning by setting  value ?? []  to AutoComplete's value.", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456207679", "createdAt": "2020-07-17T04:10:40Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE5MDUxMQ=="}, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwOTM4MQ==", "bodyText": "Well, sounds like a plan to me. \ud83d\udc4d", "url": "https://github.com/openequella/openEQUELLA/pull/2059#discussion_r456209381", "createdAt": "2020-07-17T04:18:45Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/CollectionSelector.tsx", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { Checkbox, TextField } from \"@material-ui/core\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  Collection,\n+  collectionListSummary,\n+} from \"../../modules/CollectionsModule\";\n+import { Autocomplete } from \"@material-ui/lab\";\n+import CheckBoxOutlineBlankIcon from \"@material-ui/icons/CheckBoxOutlineBlank\";\n+import CheckBoxIcon from \"@material-ui/icons/CheckBox\";\n+import { languageStrings } from \"../../util/langstrings\";\n+\n+interface CollectionSelectorProps {\n+  /**\n+   * Fires when collection selections are changed.\n+   * @param collections Selected collections.\n+   */\n+  onSelectionChange: (collections: Collection[]) => void;\n+  /**\n+   * Initially selected collections.\n+   */\n+  value?: Collection[];\n+}\n+\n+/**\n+ * As a refine search control, this component is used to filter search results by collections.\n+ * The initially selected collections are either provided through props or an empty array.\n+ */\n+export const CollectionSelector = ({\n+  onSelectionChange,\n+  value,\n+}: CollectionSelectorProps) => {\n+  const collectionSelectorStrings =\n+    languageStrings.searchpage.collectionSelector;\n+  const [collections, setCollections] = useState<Collection[]>([]);\n+  const [selectedCollections, setSelectedCollections] = useState<Collection[]>(\n+    value ?? []\n+  );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE5MDUxMQ=="}, "originalCommit": {"oid": "1404db5a04196b5f3687abdd931c244ca58505e2"}, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1299, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}