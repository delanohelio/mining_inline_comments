{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzNzk3NzQ2", "number": 2410, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNTo0N1rOEuN8QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxODoxMlrOEuN-UA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODk4MzY5OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNTo0N1rOHiermA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNTo0N1rOHiermA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkxNjMxMg==", "bodyText": "Should use the languageString for 'No comments'.", "url": "https://github.com/openequella/openEQUELLA/pull/2410#discussion_r505916312", "createdAt": "2020-10-15T23:15:47Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "diffHunk": "@@ -52,4 +53,30 @@ describe(\"<SearchResult/>\", () => {\n       queryByLabelText(container, keywordFoundInAttachmentLabel)\n     ).not.toBeInTheDocument();\n   });\n+\n+  it.each([\n+    [\"singular comment\", mockData.basicSearchObj],\n+    [\"plural comments\", mockData.attachSearchObj],\n+  ])(\n+    \"should show comment count as a link for %s\",\n+    (testName: string, item: OEQ.Search.SearchResultItem) => {\n+      const { container } = renderSearchResult(item);\n+      const countLink = getByText(\n+        container,\n+        formatSize(item.commentCount ?? 0, languageStrings.searchpage.comments),\n+        { selector: \"a\" }\n+      );\n+\n+      expect(countLink).toBeInTheDocument();\n+    }\n+  );\n+\n+  it(\"should hide comment count link if count is 0\", () => {\n+    const { container } = renderSearchResult(\n+      mockData.keywordFoundInAttachmentObj\n+    );\n+    expect(\n+      queryByLabelText(container, `No comments`, { selector: \"a\" })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8528b4ccd8549a6aa104715802a6daa46550f1ea"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODk4NTM0OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNjozM1rOHieshg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwMjozMTozMFrOHijlAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkxNjU1MA==", "bodyText": "This line will never fail, because if getByText fails it'll throw an exception. In this context I normally go with queryByText for an item to be checked.", "url": "https://github.com/openequella/openEQUELLA/pull/2410#discussion_r505916550", "createdAt": "2020-10-15T23:16:33Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "diffHunk": "@@ -52,4 +53,30 @@ describe(\"<SearchResult/>\", () => {\n       queryByLabelText(container, keywordFoundInAttachmentLabel)\n     ).not.toBeInTheDocument();\n   });\n+\n+  it.each([\n+    [\"singular comment\", mockData.basicSearchObj],\n+    [\"plural comments\", mockData.attachSearchObj],\n+  ])(\n+    \"should show comment count as a link for %s\",\n+    (testName: string, item: OEQ.Search.SearchResultItem) => {\n+      const { container } = renderSearchResult(item);\n+      const countLink = getByText(\n+        container,\n+        formatSize(item.commentCount ?? 0, languageStrings.searchpage.comments),\n+        { selector: \"a\" }\n+      );\n+\n+      expect(countLink).toBeInTheDocument();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8528b4ccd8549a6aa104715802a6daa46550f1ea"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk5NjU0NQ==", "bodyText": "Ah I completely forgot this :)", "url": "https://github.com/openequella/openEQUELLA/pull/2410#discussion_r505996545", "createdAt": "2020-10-16T02:31:30Z", "author": {"login": "PenghaiZhang"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "diffHunk": "@@ -52,4 +53,30 @@ describe(\"<SearchResult/>\", () => {\n       queryByLabelText(container, keywordFoundInAttachmentLabel)\n     ).not.toBeInTheDocument();\n   });\n+\n+  it.each([\n+    [\"singular comment\", mockData.basicSearchObj],\n+    [\"plural comments\", mockData.attachSearchObj],\n+  ])(\n+    \"should show comment count as a link for %s\",\n+    (testName: string, item: OEQ.Search.SearchResultItem) => {\n+      const { container } = renderSearchResult(item);\n+      const countLink = getByText(\n+        container,\n+        formatSize(item.commentCount ?? 0, languageStrings.searchpage.comments),\n+        { selector: \"a\" }\n+      );\n+\n+      expect(countLink).toBeInTheDocument();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkxNjU1MA=="}, "originalCommit": {"oid": "8528b4ccd8549a6aa104715802a6daa46550f1ea"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODk4Njc2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNzowOVrOHietSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxNzowOVrOHietSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkxNjc0Nw==", "bodyText": "Better to just go straight to destructing what you want:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  const { container } = renderSearchResult(item);\n          \n          \n            \n                  const { getByText } = renderSearchResult(item);", "url": "https://github.com/openequella/openEQUELLA/pull/2410#discussion_r505916747", "createdAt": "2020-10-15T23:17:09Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "diffHunk": "@@ -52,4 +53,30 @@ describe(\"<SearchResult/>\", () => {\n       queryByLabelText(container, keywordFoundInAttachmentLabel)\n     ).not.toBeInTheDocument();\n   });\n+\n+  it.each([\n+    [\"singular comment\", mockData.basicSearchObj],\n+    [\"plural comments\", mockData.attachSearchObj],\n+  ])(\n+    \"should show comment count as a link for %s\",\n+    (testName: string, item: OEQ.Search.SearchResultItem) => {\n+      const { container } = renderSearchResult(item);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8528b4ccd8549a6aa104715802a6daa46550f1ea"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODk4ODk2OnYy", "diffSide": "RIGHT", "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxODoxMlrOHieuoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQyMzoxODoxMlrOHieuoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkxNzA4OA==", "bodyText": "This is kind of just copying the same code from the code under test. Almost like testing 1 === 1 directly. Really a test should do it a different way to the code under test.", "url": "https://github.com/openequella/openEQUELLA/pull/2410#discussion_r505917088", "createdAt": "2020-10-15T23:18:12Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/SearchResult.test.tsx", "diffHunk": "@@ -52,4 +53,30 @@ describe(\"<SearchResult/>\", () => {\n       queryByLabelText(container, keywordFoundInAttachmentLabel)\n     ).not.toBeInTheDocument();\n   });\n+\n+  it.each([\n+    [\"singular comment\", mockData.basicSearchObj],\n+    [\"plural comments\", mockData.attachSearchObj],\n+  ])(\n+    \"should show comment count as a link for %s\",\n+    (testName: string, item: OEQ.Search.SearchResultItem) => {\n+      const { container } = renderSearchResult(item);\n+      const countLink = getByText(\n+        container,\n+        formatSize(item.commentCount ?? 0, languageStrings.searchpage.comments),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8528b4ccd8549a6aa104715802a6daa46550f1ea"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1721, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}