{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NjAwNDM4", "number": 2252, "title": "Feature/refine panel accordion", "bodyText": "Checklist\n\n\n the contributor license agreement is signed\n commit message follows commit guidelines\n tests are included\n screenshots are included showing significant UI changes\n\nDescription of change\n\n#1306\nThis PR includes a Collapsible area inside the RefineSearchPanel. It's default state is closed\n\nAll refine controls are included inside this panel, except for the Collection panel\nOpen/closed state of filter panel is remembered in history\nA filter icon is displayed next to the 'Show more' button. This indicates that the user has set at least one of the panels inside the collapsed area", "createdAt": "2020-09-02T06:21:51Z", "url": "https://github.com/openequella/openEQUELLA/pull/2252", "merged": true, "mergeCommit": {"oid": "1a822086cd67d5b1f4af5f03696860711516fd46"}, "closed": true, "closedAt": "2020-09-16T06:44:43Z", "author": {"login": "mrblippy"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE1hzCgH2gAyNDc3NjAwNDM4OmM5ZTEwMzhhYTBhYzcxYTM1YjAwOWNjNzJhMDk1MTYwNGJmMzRmZTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJU7lMAH2gAyNDc3NjAwNDM4OjBkMWEyNDRhZDU1OGQ1ZDU2ZGZiYzUxZGIxZTdhNjdjOGQ0ODc2MGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c9e1038aa0ac71a35b009cc72a0951604bf34fe0", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/c9e1038aa0ac71a35b009cc72a0951604bf34fe0", "committedDate": "2020-09-02T05:54:49Z", "message": "Add collapsible area to refine search panel.\n\n* All refine controls are included inside this panel, except for the Collection panel\n* Open/closed state of filter panel is remembered in history\n* A filter icon is displayed next to the 'Show more' button. This indicates that the user has set at least one of the panels inside the collapsed area"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af924013a36eb98898484bb031d635fc5f9b22c6", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/af924013a36eb98898484bb031d635fc5f9b22c6", "committedDate": "2020-09-02T06:02:58Z", "message": "Update SearchPage test to support collapsible filter area"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/50bb9e5c045b73c34d01a7186644d41b011cddf2", "committedDate": "2020-09-02T06:22:18Z", "message": "Delete prettier.xml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNTE0OTEw", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-480514910", "createdAt": "2020-09-02T06:22:43Z", "commit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNjoyMjo0M1rOHLdZ7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNjoyMjo0M1rOHLdZ7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng==", "bodyText": "This piece of code in particular is something i'm not proud of, for multiple reasons.\n\nThe destructuring looks ugly, so if anyone has any a good way to include only a subset of searchPageOptions properties\nWhat collapsed filters to include is being defined here (to determine what filters have been modified), but RefineSearchPanel is controlling what controls are appearing in the collapsible panel. So maintenance will be an issue", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r481778156", "createdAt": "2020-09-02T06:22:43Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "originalPosition": 144}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2164df8d950ad25033b4b6fa56be1c5a85e5c4e4", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/2164df8d950ad25033b4b6fa56be1c5a85e5c4e4", "committedDate": "2020-09-02T07:20:32Z", "message": "update facetselector to use generic language string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/bc9707322a2a7b8bbf59efb5d7653f4fa0256e23", "committedDate": "2020-09-02T07:22:06Z", "message": "Merge branch 'feature/refine-panel-accordion' of https://github.com/mrblippy/Charliequella into feature/refine-panel-accordion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwOTU2NDc4", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-480956478", "createdAt": "2020-09-02T15:43:55Z", "commit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo0Mzo1NVrOHL1j-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNTo1MDoyOVrOHL11wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3Mzk0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { Collection } from \"../modules/CollectionsModule\";\n          \n          \n            \n            import type { Collection } from \"../modules/CollectionsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482173947", "createdAt": "2020-09-02T15:43:55Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -15,41 +15,42 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+import { Grid } from \"@material-ui/core\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n import * as React from \"react\";\n import { useEffect, useRef, useState } from \"react\";\n+import { useHistory } from \"react-router\";\n+import { generateFromError } from \"../api/errors\";\n+import { DateRange, DateRangeSelector } from \"../components/DateRangeSelector\";\n import {\n   templateDefaults,\n   templateError,\n   TemplateUpdateProps,\n } from \"../mainui/Template\";\n-import { languageStrings } from \"../util/langstrings\";\n-import { Grid } from \"@material-ui/core\";\n+import { Collection } from \"../modules/CollectionsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3ODQ5OA==", "bodyText": "https://lodash.com/docs/#pick may help here", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482178498", "createdAt": "2020-09-02T15:50:29Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {\n+    const defaultCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      defaultSearchOptions\n+    );\n+\n+    const currentCollapsibleFilters = (({\n+      lastModifiedDateRange,\n+      owner,\n+      status,\n+      searchAttachments,\n+    }) => ({ lastModifiedDateRange, owner, status, searchAttachments }))(\n+      searchPageOptions\n+    );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 161}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNDIzMDE3", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-481423017", "createdAt": "2020-09-03T01:33:06Z", "commit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMTozMzowNlrOHMSBEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMjo1MDozOVrOHMT7eA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MDE0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Collapsible refine filter section\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Collapsible refine filter section\", () => {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482640147", "createdAt": "2020-09-03T01:33:06Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTU0Mw==", "bodyText": "Some (all?) of these have also be defined elsewhere in this file. Seeing they're a key component we need to work with, perhaps we should define them at the top level or in a SearchPageHelper.ts[x] file. If it were for such a file, it'd also be where the queryRefineSearchComponent would live too.\nOn other details, you've called these getXyz, however we're aiming to align with the React Testing Library standards and so these should all be queryXyz. (The key difference being, getXyz should throw if it can't find the element whereas queryXyz simply returns null.)", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641543", "createdAt": "2020-09-03T01:38:11Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MTgwNw==", "bodyText": "Would it be worth ensuring that there is only 1 'item'?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482641807", "createdAt": "2020-09-03T01:39:14Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -297,7 +297,46 @@ describe(\"Refine search by Owner\", () => {\n     );\n   });\n });\n+describe(\"Collapsible refine filter section\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const getOwnerSelector = () =>\n+    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n+  const getDateRangeSelector = () =>\n+    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n+  const getSearchAttachmentsSelector = () =>\n+    queryRefineSearchComponent(page.container, \"SearchAttachmentsSelector\");\n+  const getCollectionSelector = () =>\n+    queryRefineSearchComponent(page.container, \"CollectionSelector\");\n+\n+  it(\"Should contain the correct controls\", async () => {\n+    const collapsibleSection = page.container\n+      .getElementsByClassName(\"collapsibleRefinePanel\")\n+      .item(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDAwMA==", "bodyText": "Props is something different, and SearchHistory sounds more like it's about all our previous searches. Could I suggest something like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            interface SearchHistoryProps {\n          \n          \n            \n            interface SearchPageHistoryState {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644000", "createdAt": "2020-09-03T01:46:54Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history\n+ */\n+interface SearchHistoryProps {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NDM0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Type to keep track of values stored in history\n          \n          \n            \n             * Structure of data stored in browser's history state to capture the current state of the SearchPage\n          \n          \n            \n             * to support on back.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482644347", "createdAt": "2020-09-03T01:48:15Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -61,6 +62,20 @@ export interface SearchPageOptions extends SearchOptions {\n   dateRangeQuickModeEnabled: boolean;\n }\n \n+/**\n+ * Type to keep track of values stored in history", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0NzA5MQ==", "bodyText": "It's not so much managing, it's only storing or persisting. Maybe:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const manageSearchPageHistory = () => {\n          \n          \n            \n              const storeSearchPageHistory = () => {\n          \n      \n    \n    \n  \n\nThen again though, if you see my recommendation above about adding pagedSearchResult as a new dependency of your Effect, then this stand alone function can just be the anonymous function of useEffect.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482647091", "createdAt": "2020-09-03T01:58:14Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);\n+\n   const handleError = (error: Error) => {\n     updateTemplate(templateError(generateFromError(error)));\n   };\n \n+  const manageSearchPageHistory = () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0ODE0Mw==", "bodyText": "We can make this look after all the cases. Below in search where you've called manageSearchPageHistory is such that it only saves the options to history on a successful search which is then what drives pagedSearchResult. So:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              }, [filterExpansion]);\n          \n          \n            \n              }, [filterExpansion, pagedSearchResult]);", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482648143", "createdAt": "2020-09-03T02:02:04Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -115,10 +140,21 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     }\n   }, [searchPageOptions]);\n \n+  useEffect(() => {\n+    manageSearchPageHistory();\n+  }, [filterExpansion]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2Nzc4NQ==", "bodyText": "I see what you mean! As per @ChristianMurphy suggestion, how about something like:\n  const areCollapsibleFiltersSet = (): boolean => {\n    const getCollapsedOptions = (options: SearchPageOptions) =>\n      _.pick( options, [\"lastModifiedDateRange\", \"owner\", \"status\", \"searchAttachments\"]);\n\n    return !_.isEqual(\n      getCollapsedOptions(defaultSearchOptions),\n      getCollapsedOptions(searchPageOptions));\n  }", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482667785", "createdAt": "2020-09-03T02:36:35Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -153,6 +189,34 @@ const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n     });\n   };\n \n+  const handleCollapsibleFilterClick = () => {\n+    setFilterExpansion(!filterExpansion);\n+  };\n+\n+  /**\n+   * Determines if any collapsible filters have been modified from their defaults\n+   */\n+  const areCollapsibleFiltersSet = (): boolean => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc3ODE1Ng=="}, "originalCommit": {"oid": "50bb9e5c045b73c34d01a7186644d41b011cddf2"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA==", "bodyText": "This name sounds all encompassing. How's about onChangeExpansion or something?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669204", "createdAt": "2020-09-03T02:41:54Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTM2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Determines the current state of the filter expansion panel\n          \n          \n            \n               * Specifies whether the expansion panel should be expanded or collapsed.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482669360", "createdAt": "2020-09-03T02:42:29Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDQ1OQ==", "bodyText": "There's an assumption being made here that the Collection control is first.\nTo some degree, that's outside the purview of this component. The contract for this component is that it will display the first component outside of the selection control, so perhaps this should just be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const [collectionControl, ...collapsedControls] = controls.filter(\n          \n          \n            \n              const [alwaysVisibleControl, ...collapsedControls] = controls.filter(\n          \n      \n    \n    \n  \n\nFor now that's all we need. But if that ever changed then we'd possibly allow two lots of controls to be passed in - those in the expansion panel, those outside of it.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670459", "createdAt": "2020-09-03T02:46:43Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MDk4NQ==", "bodyText": "This just occurred to me, and applies to all our components. For keyboard accessibility, is it sufficient that we're only ever doing onClick?\nSee you did some of our recent accessibility work, you might be well placed to answer that.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482670985", "createdAt": "2020-09-03T02:48:47Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;\n+  /**\n+   * Determines the current state of the filter expansion panel\n+   */\n+  panelExpanded: boolean;\n+  /**\n+   * True if filter icon should be shown next to the 'Show more' button\n+   */\n+  showFilterIcon: boolean;\n }\n \n-export const RefineSearchPanel = ({ controls }: RefinePanelProps) => {\n+export const RefineSearchPanel = ({\n+  controls,\n+  handleClick,\n+  panelExpanded,\n+  showFilterIcon,\n+}: RefinePanelProps) => {\n   const { title } = languageStrings.searchpage.refineSearchPanel;\n+\n+  const { showmore, showless } = languageStrings.common.action;\n+\n+  const [collectionControl, ...collapsedControls] = controls.filter(\n+    (c) => !c.disabled\n+  );\n+\n+  const collapsibleSection = (controls: RefinePanelControl[]) => {\n+    return (\n+      <>\n+        <Collapse className=\"collapsibleRefinePanel\" in={panelExpanded}>\n+          <List>{controls.map((control) => renderRefineControl(control))}</List>\n+        </Collapse>\n+        <Button\n+          fullWidth\n+          onClick={() => handleClick(panelExpanded)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY3MTQ4MA==", "bodyText": "It was agreed we're going to aim for camelCase here, so:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  showmore: \"Show more\",\n          \n          \n            \n                  showless: \"Show less\",\n          \n          \n            \n                  showMore: \"Show more\",\n          \n          \n            \n                  showLess: \"Show less\",", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r482671480", "createdAt": "2020-09-03T02:50:39Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/util/langstrings.ts", "diffHunk": "@@ -301,6 +301,8 @@ export const languageStrings = {\n       done: \"Done\",\n       yes: \"Yes\",\n       no: \"No\",\n+      showmore: \"Show more\",\n+      showless: \"Show less\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54a9b50d15b81f19d59eeeabf75e57c3ad57ce61", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/54a9b50d15b81f19d59eeeabf75e57c3ad57ce61", "committedDate": "2020-09-03T04:07:00Z", "message": "Use camelCase for language strings, as that follows our in-house style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95c659e04dbcc711bf3f0a36783b1be2346e81b5", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/95c659e04dbcc711bf3f0a36783b1be2346e81b5", "committedDate": "2020-09-03T04:16:46Z", "message": "Make use of lodash pick function, instead of using destructuring to select a subset of SearchOptions properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d542e955d4da1ef6403cb2c184826886b1e40fef", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/d542e955d4da1ef6403cb2c184826886b1e40fef", "committedDate": "2020-09-03T04:29:10Z", "message": "Import the Collection type from CollectionsModule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d27b77340c0251176246b42244cbbf585f4b6729", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/d27b77340c0251176246b42244cbbf585f4b6729", "committedDate": "2020-09-03T04:51:17Z", "message": "Tidied up interface and function names, aiding in readability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "024614a21c83896aaeb8ad09aa11c6241734f8bd", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/024614a21c83896aaeb8ad09aa11c6241734f8bd", "committedDate": "2020-09-04T00:48:00Z", "message": "Move SearchPage test refine query selectors into helper file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc713c4013a70b06d8947ac327e671d26d5df3fc", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/bc713c4013a70b06d8947ac327e671d26d5df3fc", "committedDate": "2020-09-04T01:13:39Z", "message": "Add pagedSearchResult as useEffect dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/e113b1d874350f6fb0dc61292d0afa62ef0ef1ab", "committedDate": "2020-09-04T01:18:33Z", "message": "Minor wording change to RefinePanelProps jsdoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMzg1Mzc5", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-482385379", "createdAt": "2020-09-04T06:17:57Z", "commit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoxNzo1N1rOHNA_SA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNjoyNDowMlrOHNBIAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTczNg==", "bodyText": "Nit: This name makes it sound like a function. Maybe:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                const findCollapsibleSection = page.container.getElementsByClassName(\n          \n          \n            \n                const collapsibleSections = page.container.getElementsByClassName(\n          \n      \n    \n    \n  \n\nIs there a suitable RTL query we could do here directly on page rather than using container. Probably a getAllBy?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483409736", "createdAt": "2020-09-04T06:17:57Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMDAzNg==", "bodyText": "Good to have a line space here, as you're into a whole new logical block.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            describe(\"Hide Refine Search controls\", () => {\n          \n          \n            \n            \n          \n          \n            \n            describe(\"Hide Refine Search controls\", () => {", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483410036", "createdAt": "2020-09-04T06:18:49Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTM3MA==", "bodyText": "You may want to highlight that these are queryXyz functions. Appreciating the name would shadow the the main ones, one option is an underscore prefix:\n_queryOwnerSelector() etc.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411370", "createdAt": "2020-09-04T06:22:23Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -308,13 +301,52 @@ describe(\"Hide Refine Search controls\", () => {\n     jest.clearAllMocks();\n   });\n \n-  const getOwnerSelector = () =>\n-    queryRefineSearchComponent(page.container, \"OwnerSelector\");\n-  const getDateSelector = () =>\n-    queryRefineSearchComponent(page.container, \"DateRangeSelector\");\n-  const getStatusSelector = () =>\n-    queryRefineSearchComponent(page.container, \"StatusSelector\");\n+  it(\"Should contain the correct controls\", async () => {\n+    const pageContainer = page.container;\n+    const findCollapsibleSection = page.container.getElementsByClassName(\n+      \"collapsibleRefinePanel\"\n+    );\n+    expect(findCollapsibleSection).toHaveLength(1);\n+\n+    const collapsibleSection = findCollapsibleSection.item(0);\n+\n+    expect(collapsibleSection).toContainElement(\n+      queryOwnerSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      queryDateRangeSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).toContainElement(\n+      querySearchAttachmentsSelector(pageContainer)\n+    );\n+    expect(collapsibleSection).not.toContainElement(\n+      queryCollectionSelector(pageContainer)\n+    );\n+  });\n+\n+  it(\"Should change button text when clicked\", async () => {\n+    const expansionButton = page.getByText(\n+      languageStrings.common.action.showMore\n+    );\n+    fireEvent.click(expansionButton);\n+    expect(expansionButton).toHaveTextContent(\n+      languageStrings.common.action.showLess\n+    );\n+  });\n+});\n+describe(\"Hide Refine Search controls\", () => {\n+  let page: RenderResult;\n+  beforeEach(async () => {\n+    page = await renderSearchPage();\n+  });\n+\n+  afterEach(() => {\n+    jest.clearAllMocks();\n+  });\n \n+  const ownerSelector = () => queryOwnerSelector(page.container);\n+  const dateSelector = () => queryDateRangeSelector(page.container);\n+  const statusSelector = () => queryStatusSelector(page.container);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTYzMQ==", "bodyText": "Interesting you've changed all these from getXyz to queryXyz semantics. Was that intended?", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411631", "createdAt": "2020-09-04T06:23:05Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPage.test.tsx", "diffHunk": "@@ -331,19 +363,19 @@ describe(\"Hide Refine Search controls\", () => {\n     // Reuse default Search settings as disableStatusSelector, enableOwnerSelector and enableDateSelector.\n     [\n       \"Owner Selector\",\n-      getOwnerSelector,\n+      ownerSelector,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMTk3MQ==", "bodyText": "See you've brought this one over, it'd make sense to also bring over the getRefineSearchComponent as they're a bit of pidgeon pair.", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r483411971", "createdAt": "2020-09-04T06:24:02Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/SearchPageHelper.tsx", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+/**\n+ * Helper function to find individual Refine Search components based on the their `idSuffix`,\n+ * or return null if the component is not found.\n+ *\n+ * @param container The root container to start the search from\n+ * @param componentSuffix Typically the `idSuffix` provided in `SearchPage.tsx`\n+ */\n+export const queryRefineSearchComponent = (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e113b1d874350f6fb0dc61292d0afa62ef0ef1ab"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69256a4cb237ce03342577f2daa5cda9300ca6e5", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/69256a4cb237ce03342577f2daa5cda9300ca6e5", "committedDate": "2020-09-14T01:38:15Z", "message": "Use more logical naming for constants. Move getRefineSearchComponent into Helper file, as it makes more sense to be there"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/b5f60754677f8557d753ee41c7b0aa383abef3b7", "committedDate": "2020-09-14T07:16:19Z", "message": "Merge branch 'component/new-search-page' into feature/refine-panel-accordion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be6955ecc8650a5e54607d8f8555ac7a4f37d9a0", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/be6955ecc8650a5e54607d8f8555ac7a4f37d9a0", "committedDate": "2020-09-14T07:54:47Z", "message": "Update imagemagick readme links"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODM0NTgx", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-487834581", "createdAt": "2020-09-14T14:34:16Z", "commit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNDoxN1rOHRX-zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDozNjoyN1rOHRYFWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MDc1MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487980750", "createdAt": "2020-09-14T14:34:17Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__stories__/search/CategorySelector.stories.tsx", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * The Apereo Foundation licenses this file to you under the Apache License,\n+ * Version 2.0, (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+import * as React from \"react\";\n+import { SelectedCategories } from \"../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MTc0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487981746", "createdAt": "2020-09-14T14:35:35Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/modules/SearchModule.test.ts", "diffHunk": "@@ -16,81 +16,92 @@\n  * limitations under the License.\n  */\n import * as OEQ from \"@openequella/rest-api-client\";\n+import { getSearchResult } from \"../../../__mocks__/SearchResult.mock\";\n+import { SelectedCategories } from \"../../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4MjQyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";\n          \n          \n            \n            import type { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r487982425", "createdAt": "2020-09-14T14:36:27Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/__tests__/tsrc/search/components/CategorySelector.test.tsx", "diffHunk": "@@ -24,33 +24,33 @@ import {\n   RenderResult,\n   getAllByRole,\n } from \"@testing-library/react\";\n-import { FacetSelector } from \"../../../../tsrc/search/components/FacetSelector\";\n-import * as FacetSelectorMock from \"../../../../__mocks__/FacetSelector.mock\";\n+import { SelectedCategories } from \"../../../../tsrc/modules/SearchFacetsModule\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f60754677f8557d753ee41c7b0aa383abef3b7"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "987b983506e0c1547013f61359957414c34181d0", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/987b983506e0c1547013f61359957414c34181d0", "committedDate": "2020-09-15T01:09:06Z", "message": "added type annotations to tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f918bd06c59fbb4ee1f79144f1092812a43aeef8", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/f918bd06c59fbb4ee1f79144f1092812a43aeef8", "committedDate": "2020-09-15T07:57:42Z", "message": "Refactor test to get Refine Panel, using getByText in react testing library"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MjQ2MTE1", "url": "https://github.com/openequella/openEQUELLA/pull/2252#pullrequestreview-489246115", "createdAt": "2020-09-16T03:24:19Z", "commit": {"oid": "f918bd06c59fbb4ee1f79144f1092812a43aeef8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMzoyNDoxOVrOHSeolg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMzoyNDoxOVrOHSeolg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEzODMyNg==", "bodyText": "This was marked as resolved, but... Looks like it wasn't. \ud83e\udd14", "url": "https://github.com/openequella/openEQUELLA/pull/2252#discussion_r489138326", "createdAt": "2020-09-16T03:24:19Z", "author": {"login": "edalex-ian"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/RefineSearchPanel.tsx", "diffHunk": "@@ -52,31 +55,81 @@ interface RefinePanelProps {\n    * Child components rendered inside this panel.\n    */\n   controls: RefinePanelControl[];\n+  /**\n+   * Handler for when the show more/show less button is clicked\n+   */\n+  handleClick: (expansionState: boolean) => void;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY2OTIwNA=="}, "originalCommit": {"oid": "bc9707322a2a7b8bbf59efb5d7653f4fa0256e23"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ea06b137de2a0ce7385bc2ba5a8fa60ca788a41", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/4ea06b137de2a0ce7385bc2ba5a8fa60ca788a41", "committedDate": "2020-09-16T04:15:16Z", "message": "Merge branch 'component/new-search-page' into feature/refine-panel-accordion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46dc7148d57297f070b6ff6e867f05ac2b84d689", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/46dc7148d57297f070b6ff6e867f05ac2b84d689", "committedDate": "2020-09-16T04:21:18Z", "message": "Give the expansion handler a more specific name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d1a244ad558d5d56dfbc51db1e7a67c8d48760e", "author": {"user": {"login": "mrblippy", "name": "Nick Charles"}}, "url": "https://github.com/openequella/openEQUELLA/commit/0d1a244ad558d5d56dfbc51db1e7a67c8d48760e", "committedDate": "2020-09-16T04:45:44Z", "message": "Update RefineSearchPanel prop. I put too much trust in intellij's refactor functionality :/"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 438, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}