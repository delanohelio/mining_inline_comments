{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NjQ5NTE5", "number": 1896, "title": "Integrate search page with search result component", "bodyText": "#1306\nChecklist\n\n the [contributor license agreement][] is signed\n commit message follows [commit guidelines][]\n tests are included\n screenshots are included showing significant UI changes\n documentation is changed or added\n\nDescription of change\nIntegrate search page with search result component and search module.\nWhen opening the search page, search settings are retrieved first.  Then, a default search is done so that a list of items are displayed.\nTo match the existing functionality in old Search UI, a couple of things are considered.\n\nThe default sort order is handled on server side (view getOrderType in DefaultSearch.java to get more details)  so client does not need to implement it again.\nThe default item status is 'live' and 'review' and it's handled on client.", "createdAt": "2020-06-22T02:48:16Z", "url": "https://github.com/openequella/openEQUELLA/pull/1896", "merged": true, "mergeCommit": {"oid": "2d1c7c1a060ebe6afc3ed4b18662cf05c9db7a06"}, "closed": true, "closedAt": "2020-06-23T05:25:23Z", "author": {"login": "PenghaiZhang"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctlO_SAH2gAyNDM3NjQ5NTE5OmM5MTA5NzZmOGZmOGZkYTk2ZWI5YTU5NmExYzMwMGYyZjA3NTExNzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABct8mE1AH2gAyNDM3NjQ5NTE5OjJkMTdjYzUxZjhkOTMzMmMzYTJkM2EyY2RmZDZkOGNiMmY4ODY5ZmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c910976f8ff8fda96eb9a596a1c300f2f0751176", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/c910976f8ff8fda96eb9a596a1c300f2f0751176", "committedDate": "2020-06-21T23:55:32Z", "message": "Modify the link types for SearchResultItem and Attachment. It's confirmed\nthat two key/value pairs that are always added into a SearchResultItem\nare 'view' and 'self', and those two of Attachment are 'view' and 'thumbsail'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5b1be78b1a223c3d106ac09ef77f9213c37f25c", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/f5b1be78b1a223c3d106ac09ef77f9213c37f25c", "committedDate": "2020-06-22T02:35:46Z", "message": "Integrate the Search page place holder with REST APIs and the Search\nresult component."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/6c20a70b340772039ad1d9069e0cf4a3f30bff76", "committedDate": "2020-06-22T02:56:33Z", "message": "Catch and handle errors if fail to search."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTc2MDI5", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-434576029", "createdAt": "2020-06-22T02:59:15Z", "commit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "state": "APPROVED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo1OToxNVrOGmwnVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMzowNTowM1rOGmwrlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTU3NA==", "bodyText": "I'm confused - I thought we weren't supposed to refer to the rest-api-client directly, it should be through the module?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295574", "createdAt": "2020-06-22T02:59:15Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTcwNQ==", "bodyText": "The first sentence of this comment (up to and including the colon) can be omitted.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295705", "createdAt": "2020-06-22T02:59:56Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NTk3Mg==", "bodyText": "Perhaps have an @see pointing towards SearchParams for this one?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443295972", "createdAt": "2020-06-22T03:01:18Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjE3Mg==", "bodyText": "Is there a way to do this redirect with Router rather than window.location?", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296172", "createdAt": "2020-06-22T03:02:21Z", "author": {"login": "SammyIsConfused"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,113 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import {\n+  defaultSearchSettings,\n+  getSearchSettingsFromServer,\n+  SearchSettings,\n+} from \"../settings/Search/SearchSettingsModule\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n+  const [searchSettings, setSearchSettings] = useState<SearchSettings>(\n+    defaultSearchSettings\n+  );\n \n+  /**\n+   * What is done in this hook include: updating the page title, retrieving search settings, and\n+   * doing a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    getSearchSettingsFromServer().then((settings: SearchSettings) => {\n+      setSearchSettings(settings);\n+      search({\n+        status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+      });\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjQ2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this attachment.\n          \n          \n            \n                 * The URL for viewing this attachment.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296461", "createdAt": "2020-06-22T03:03:57Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -124,7 +124,16 @@ export interface Attachment {\n   /**\n    * Links to the attachment.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this attachment.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjUwOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this attachment's thumbnail.\n          \n          \n            \n                 * The URL for viewing this attachment's thumbnail.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296509", "createdAt": "2020-06-22T03:04:15Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -124,7 +124,16 @@ export interface Attachment {\n   /**\n    * Links to the attachment.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this attachment.\n+     */\n+    view: string;\n+    /**\n+     * The URL of viewing this attachment's thumbnail.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjU1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The URL of viewing this item.\n          \n          \n            \n                 * The URL for viewing this item.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296555", "createdAt": "2020-06-22T03:04:33Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -182,7 +191,16 @@ export interface SearchResultItem {\n   /**\n    * Links to an item.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this item.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5NjY2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The REST API path used to get details of this item.\n          \n          \n            \n                 * The REST API path used to get this item's details.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443296660", "createdAt": "2020-06-22T03:05:03Z", "author": {"login": "SammyIsConfused"}, "path": "oeq-ts-rest-api/src/Search.ts", "diffHunk": "@@ -182,7 +191,16 @@ export interface SearchResultItem {\n   /**\n    * Links to an item.\n    */\n-  links: Record<string, string>;\n+  links: {\n+    /**\n+     * The URL of viewing this item.\n+     */\n+    view: string;\n+    /**\n+     * The REST API path used to get details of this item.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c20a70b340772039ad1d9069e0cf4a3f30bff76"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce581c6f1b682c27131b934ca236d263000eadb4", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/ce581c6f1b682c27131b934ca236d263000eadb4", "committedDate": "2020-06-22T04:05:50Z", "message": "Don't get search settings as they do not get used at this stage."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/148f4a4038ae02385480f1a035af62e64c93038d", "committedDate": "2020-06-22T04:39:16Z", "message": "Remove the imports of Search settings.\n\nReword comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjExNzY3", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-434611767", "createdAt": "2020-06-22T05:27:55Z", "commit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjEyNTA2", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-434612506", "createdAt": "2020-06-22T05:30:22Z", "commit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTozMDoyMlrOGmyYJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNTo0OTo0NFrOGmyqiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyNDQ1Mw==", "bodyText": "Good pickup here \ud83d\udc4d , I thought i had added keys to all of the ListItem components, but must've missed this one", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443324453", "createdAt": "2020-06-22T05:30:22Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/components/SearchResult.tsx", "diffHunk": "@@ -158,9 +158,9 @@ export default function SearchResult({\n   );\n \n   const customDisplayMetadata = displayFields.map(\n-    (element: OEQ.Search.DisplayFields) => {\n+    (element: OEQ.Search.DisplayFields, index: number) => {\n       return (\n-        <ListItem disableGutters dense>\n+        <ListItem disableGutters dense key={element.name + index}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMyOTE2MA==", "bodyText": "Should we make it so the SearchResults takes up the full width of the page when there is no refine search panel? Probably something to address once we implement the refine search panel component.", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443329160", "createdAt": "2020-06-22T05:49:44Z", "author": {"login": "mrblippy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,101 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult\n+          resultData={item}\n+          onClick={() => (window.location.href = item.links.view)}\n+        />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />\n+          </IconButton>\n+          <TextField />\n+        </Card>\n+      </Grid>\n+\n+      <Grid item xs={9}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "148f4a4038ae02385480f1a035af62e64c93038d"}, "originalPosition": 126}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/6ac3cc9913169087a2e764481c65ed24534a189b", "committedDate": "2020-06-23T01:42:37Z", "message": "A few tweaks for component SearchResult:\n1. only click title to navigate to Item's summary page; and\n2. allow other texts to be selected and copied; and\n3. refactor props of SearchResult"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Mzg1ODE4", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-435385818", "createdAt": "2020-06-23T01:53:09Z", "commit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Mzg3Njc4", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-435387678", "createdAt": "2020-06-23T01:58:39Z", "commit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1NDA0ODg4", "url": "https://github.com/openequella/openEQUELLA/pull/1896#pullrequestreview-435404888", "createdAt": "2020-06-23T02:54:44Z", "commit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NDo0NFrOGnXgiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo1NTowMVrOGnXg0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMjgwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <SearchIcon fontSize={\"large\"} />\n          \n          \n            \n                        <SearchIcon fontSize=\"large\" />", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443932808", "createdAt": "2020-06-23T02:54:44Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,98 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult {...item} />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>\n+      <Grid item xs={9}>\n+        <Card>\n+          <IconButton>\n+            <SearchIcon fontSize={\"large\"} />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMjg4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <Grid container direction={\"column\"} spacing={2}>\n          \n          \n            \n                <Grid container direction=\"column\" spacing={2}>", "url": "https://github.com/openequella/openEQUELLA/pull/1896#discussion_r443932880", "createdAt": "2020-06-23T02:55:01Z", "author": {"login": "ChristianMurphy"}, "path": "Source/Plugins/Core/com.equella.core/js/tsrc/search/SearchPage.tsx", "diffHunk": "@@ -16,63 +16,98 @@\n  * limitations under the License.\n  */\n import * as React from \"react\";\n-import { templateDefaults, TemplateUpdateProps } from \"../mainui/Template\";\n-import { useEffect } from \"react\";\n+import { useEffect, useState } from \"react\";\n+import {\n+  templateDefaults,\n+  templateError,\n+  TemplateUpdateProps,\n+} from \"../mainui/Template\";\n import { languageStrings } from \"../util/langstrings\";\n import {\n-  Card,\n   IconButton,\n   List,\n   ListItem,\n-  ListItemText,\n   ListSubheader,\n   TextField,\n+  Grid,\n+  Card,\n } from \"@material-ui/core\";\n import SearchIcon from \"@material-ui/icons/Search\";\n+import { searchItems } from \"./SearchModule\";\n+import * as OEQ from \"@openequella/rest-api-client\";\n+import SearchResult from \"./components/SearchResult\";\n+import { generateFromError } from \"../api/errors\";\n \n const SearchPage = ({ updateTemplate }: TemplateUpdateProps) => {\n   const searchStrings = languageStrings.searchpage;\n-  const placeholderData: string[] = [\n-    \"item1\",\n-    \"item2\",\n-    \"item3\",\n-    \"item4\",\n-    \"item5\",\n-  ];\n+  const [searchResultItems, setSearchResultItems] = useState<\n+    OEQ.Search.SearchResultItem[]\n+  >([]);\n \n+  /**\n+   * Update the page title and do a default search.\n+   */\n   useEffect(() => {\n     updateTemplate((tp) => ({\n       ...templateDefaults(searchStrings.title)(tp),\n     }));\n+\n+    search({\n+      status: [OEQ.Common.ItemStatus.LIVE, OEQ.Common.ItemStatus.REVIEW],\n+    });\n   }, []);\n \n-  const searchResults = placeholderData.map((data: string) => {\n-    return (\n-      <ListItem>\n-        <ListItemText primary={data} />\n+  const handleError = (error: Error) => {\n+    updateTemplate(templateError(generateFromError(error)));\n+  };\n+\n+  /**\n+   * Search items with specified search criteria.\n+   * @param params Search criteria\n+   */\n+  const search = (params?: OEQ.Search.SearchParams): void => {\n+    searchItems(params)\n+      .then((items: OEQ.Common.PagedResult<OEQ.Search.SearchResultItem>) =>\n+        setSearchResultItems(items.results)\n+      )\n+      .catch((error: Error) => handleError(error));\n+  };\n+\n+  /**\n+   * A SearchResult that represents one of the search result items.\n+   */\n+  const searchResults = searchResultItems.map(\n+    (item: OEQ.Search.SearchResultItem) => (\n+      <ListItem key={item.uuid}>\n+        <SearchResult {...item} />\n       </ListItem>\n-    );\n-  });\n+    )\n+  );\n+\n+  /**\n+   * A list that consists of search result items.\n+   */\n   const searchResultList = (\n-    <List\n-      subheader={\n-        <ListSubheader disableGutters>{searchStrings.subtitle}</ListSubheader>\n-      }\n-    >\n+    <List subheader={<ListSubheader>{searchStrings.subtitle}</ListSubheader>}>\n       {searchResults}\n     </List>\n   );\n \n   return (\n-    <>\n-      <Card>\n-        <IconButton>\n-          <SearchIcon fontSize={\"large\"} />\n-        </IconButton>\n-        <TextField />\n-      </Card>\n-      <Card>{searchResultList}</Card>\n-    </>\n+    <Grid container direction={\"column\"} spacing={2}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ac3cc9913169087a2e764481c65ed24534a189b"}, "originalPosition": 113}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d071d57327e2e2649c8b27f0fed69148b5dd472f", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/d071d57327e2e2649c8b27f0fed69148b5dd472f", "committedDate": "2020-06-23T03:05:33Z", "message": "Update the story for SearchResult."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d17cc51f8d9332c3a2d3a2cdfd6d8cb2f8869fe", "author": {"user": {"login": "PenghaiZhang", "name": null}}, "url": "https://github.com/openequella/openEQUELLA/commit/2d17cc51f8d9332c3a2d3a2cdfd6d8cb2f8869fe", "committedDate": "2020-06-23T03:08:34Z", "message": "Fix a couple styling issues for Search page\n\nCo-authored-by: Christian Murphy <christian.murphy.42@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4999, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}