{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NTc1ODY5", "number": 9981, "title": "Update DDR code to comply with arrays not having NULL pointers", "bodyText": "Discontiguous arraylets do not have NULL arrayoids anymore;\ntherefore DDR was updated to reflect this change.\nRelated to: #9373\nFixes: #9971\nSigned-off-by: Igor Braga higorb1@gmail.com", "createdAt": "2020-06-23T13:35:13Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9981", "merged": true, "mergeCommit": {"oid": "a20f7943f6fb09595d3a545dcb3156e7abff67c2"}, "closed": true, "closedAt": "2020-06-25T16:32:14Z", "author": {"login": "bragaigor"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuFppmgBqjM0NzMwMTM3OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuxRhSgFqTQzNzY2NDQzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6f374bd7613058c90e36a6750e091ca17a8d3c2", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e6f374bd7613058c90e36a6750e091ca17a8d3c2", "committedDate": "2020-06-23T03:01:22Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\nRelated PR: #9373\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}, "afterCommit": {"oid": "2fa667fbbeb99416a7deb886cdbce597994cf769", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2fa667fbbeb99416a7deb886cdbce597994cf769", "committedDate": "2020-06-23T13:40:40Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fa667fbbeb99416a7deb886cdbce597994cf769", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2fa667fbbeb99416a7deb886cdbce597994cf769", "committedDate": "2020-06-23T13:40:40Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}, "afterCommit": {"oid": "6aa7a1c486beacf5930d557a824e5a823788edd3", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6aa7a1c486beacf5930d557a824e5a823788edd3", "committedDate": "2020-06-23T13:43:11Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1ODE5NTA0", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#pullrequestreview-435819504", "createdAt": "2020-06-23T14:07:16Z", "commit": {"oid": "6aa7a1c486beacf5930d557a824e5a823788edd3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDowNzoxNlrOGnq-8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDowOToyNFrOGnrE_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI1MTg4OA==", "bodyText": "Please remove the redundant parentheses:\n  numberOfArraylets = dataSizeInBytes.rightShift(arrayletLeafLogSize).add(dataSizeInBytes.bitAnd(arrayletLeafSizeMask).add(arrayletLeafSizeMask).rightShift(arrayletLeafLogSize));", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#discussion_r444251888", "createdAt": "2020-06-23T14:07:16Z", "author": {"login": "keithc-ca"}, "path": "debugtools/DDR_VM/src/com/ibm/j9ddr/vm29/j9/gc/GCArrayletObjectModelBase_V2.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*******************************************************************************\n+ * Copyright (c) 2001, 2020 IBM Corp. and others\n+ *\n+ * This program and the accompanying materials are made available under\n+ * the terms of the Eclipse Public License 2.0 which accompanies this\n+ * distribution and is available at https://www.eclipse.org/legal/epl-2.0/\n+ * or the Apache License, Version 2.0 which accompanies this distribution and\n+ * is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * This Source Code may also be made available under the following\n+ * Secondary Licenses when the conditions for such availability set\n+ * forth in the Eclipse Public License, v. 2.0 are satisfied: GNU\n+ * General Public License, version 2 with the GNU Classpath\n+ * Exception [1] and GNU General Public License, version 2 with the\n+ * OpenJDK Assembly Exception [2].\n+ *\n+ * [1] https://www.gnu.org/software/classpath/license.html\n+ * [2] http://openjdk.java.net/legal/assembly-exception.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n+ *******************************************************************************/\n+package com.ibm.j9ddr.vm29.j9.gc;\n+\n+import com.ibm.j9ddr.CorruptDataException;\n+import com.ibm.j9ddr.vm29.types.UDATA;\n+\n+public abstract class GCArrayletObjectModelBase_V2 extends GCArrayletObjectModelBase_V1\n+{\n+\tpublic GCArrayletObjectModelBase_V2() throws CorruptDataException \n+\t{\n+\t\tsuper();\n+\t}\n+\n+\t/**\n+\t * Return the total number of arraylets for an indexable object with a size of dataInSizeByte, including a (possibly empty) leaf in the spine.\n+\t * @param dataSizeInBytes size of an array in bytes (not elements)\n+\t * @return the number of arraylets used for an array of dataSizeInBytes bytes\n+\t */\n+\t@Override\n+\tprotected UDATA numArraylets(UDATA dataSizeInBytes) throws CorruptDataException\n+\t{\n+\t\tUDATA numberOfArraylets = new UDATA(1);\n+\t\tif (!UDATA.MAX.eq(arrayletLeafSize)) {\n+\t\t\t/* CMVC 135307 : following logic for calculating the leaf count would not overflow dataSizeInBytes.\n+\t\t\t * the assumption is leaf size is order of 2. It's identical to:\n+\t\t\t * if (dataSizeInBytes % leafSize) is 0\n+\t\t\t * \tleaf count = dataSizeInBytes >> leafLogSize\n+\t\t\t * else\n+\t\t\t * \tleaf count = (dataSizeInBytes >> leafLogSize) + 1\n+\t\t\t */\n+\t\t\tnumberOfArraylets = (dataSizeInBytes.rightShift(arrayletLeafLogSize)).add(((dataSizeInBytes.bitAnd(arrayletLeafSizeMask)).add(arrayletLeafSizeMask)).rightShift(arrayletLeafLogSize));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6aa7a1c486beacf5930d557a824e5a823788edd3"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI1MzQzNw==", "bodyText": "Please remove this and similar methods below that only delegate to super.", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#discussion_r444253437", "createdAt": "2020-06-23T14:09:24Z", "author": {"login": "keithc-ca"}, "path": "debugtools/DDR_VM/src/com/ibm/j9ddr/vm29/j9/gc/GCArrayletObjectModel_V2.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*******************************************************************************\n+ * Copyright (c) 1991, 2020 IBM Corp. and others\n+ *\n+ * This program and the accompanying materials are made available under\n+ * the terms of the Eclipse Public License 2.0 which accompanies this\n+ * distribution and is available at https://www.eclipse.org/legal/epl-2.0/\n+ * or the Apache License, Version 2.0 which accompanies this distribution and\n+ * is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * This Source Code may also be made available under the following\n+ * Secondary Licenses when the conditions for such availability set\n+ * forth in the Eclipse Public License, v. 2.0 are satisfied: GNU\n+ * General Public License, version 2 with the GNU Classpath\n+ * Exception [1] and GNU General Public License, version 2 with the\n+ * OpenJDK Assembly Exception [2].\n+ *\n+ * [1] https://www.gnu.org/software/classpath/license.html\n+ * [2] http://openjdk.java.net/legal/assembly-exception.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n+ *******************************************************************************/\n+package com.ibm.j9ddr.vm29.j9.gc;\n+\n+import com.ibm.j9ddr.CorruptDataException;\n+import com.ibm.j9ddr.vm29.pointer.ObjectReferencePointer;\n+import com.ibm.j9ddr.vm29.pointer.VoidPointer;\n+import com.ibm.j9ddr.vm29.pointer.generated.J9ArrayClassPointer;\n+import com.ibm.j9ddr.vm29.pointer.generated.J9IndexableObjectPointer;\n+import com.ibm.j9ddr.vm29.types.UDATA;\n+\n+class GCArrayletObjectModel_V2 extends GCArrayletObjectModelBase_V2\n+{\n+\t\n+\tpublic GCArrayletObjectModel_V2() throws CorruptDataException \n+\t{\t\t\n+\t}\n+\t\n+\t@Override\n+\tprotected long getArrayLayout(J9IndexableObjectPointer array) throws CorruptDataException\n+\t{\n+\t\treturn super.getArrayLayout(array);\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6aa7a1c486beacf5930d557a824e5a823788edd3"}, "originalPosition": 42}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e81f4d42658515d85f51d8015865f21d56a9ae2d", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e81f4d42658515d85f51d8015865f21d56a9ae2d", "committedDate": "2020-06-23T21:11:11Z", "message": "Rename GCArrayletObjectModelBase_V1\n\nModify ALG_GC_ARRAYLET_OBJECT_MODEL_VERSION to 2\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}, "afterCommit": {"oid": "002933b210f84d5eb50614685c5a716de964b21b", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/002933b210f84d5eb50614685c5a716de964b21b", "committedDate": "2020-06-23T21:14:02Z", "message": "Rename GCArrayletObjectModelBase_V1\n\nModify ALG_GC_ARRAYLET_OBJECT_MODEL_VERSION to 2\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "002933b210f84d5eb50614685c5a716de964b21b", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/002933b210f84d5eb50614685c5a716de964b21b", "committedDate": "2020-06-23T21:14:02Z", "message": "Rename GCArrayletObjectModelBase_V1\n\nModify ALG_GC_ARRAYLET_OBJECT_MODEL_VERSION to 2\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}, "afterCommit": {"oid": "d6b54e0134766db00e69c997b61f59ee7ac32364", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d6b54e0134766db00e69c997b61f59ee7ac32364", "committedDate": "2020-06-23T21:42:55Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MTgxMjY1", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#pullrequestreview-436181265", "createdAt": "2020-06-23T21:44:59Z", "commit": {"oid": "d6b54e0134766db00e69c997b61f59ee7ac32364"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QyMTo0NDo1OVrOGn7wGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QyMTo0NDo1OVrOGn7wGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUyNjYxOQ==", "bodyText": "I thought the plan was that this would extend GCArrayletObjectModelBase?", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#discussion_r444526619", "createdAt": "2020-06-23T21:44:59Z", "author": {"login": "keithc-ca"}, "path": "debugtools/DDR_VM/src/com/ibm/j9ddr/vm29/j9/gc/GCArrayletObjectModel_V2.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*******************************************************************************\n+ * Copyright (c) 1991, 2020 IBM Corp. and others\n+ *\n+ * This program and the accompanying materials are made available under\n+ * the terms of the Eclipse Public License 2.0 which accompanies this\n+ * distribution and is available at https://www.eclipse.org/legal/epl-2.0/\n+ * or the Apache License, Version 2.0 which accompanies this distribution and\n+ * is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * This Source Code may also be made available under the following\n+ * Secondary Licenses when the conditions for such availability set\n+ * forth in the Eclipse Public License, v. 2.0 are satisfied: GNU\n+ * General Public License, version 2 with the GNU Classpath\n+ * Exception [1] and GNU General Public License, version 2 with the\n+ * OpenJDK Assembly Exception [2].\n+ *\n+ * [1] https://www.gnu.org/software/classpath/license.html\n+ * [2] http://openjdk.java.net/legal/assembly-exception.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n+ *******************************************************************************/\n+package com.ibm.j9ddr.vm29.j9.gc;\n+\n+import com.ibm.j9ddr.CorruptDataException;\n+import com.ibm.j9ddr.vm29.types.UDATA;\n+\n+class GCArrayletObjectModel_V2 extends GCArrayletObjectModel_V1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6b54e0134766db00e69c997b61f59ee7ac32364"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6548260f771d6caaaec4a6efd020f6c3f1f9ba5e", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6548260f771d6caaaec4a6efd020f6c3f1f9ba5e", "committedDate": "2020-06-24T15:37:19Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6b54e0134766db00e69c997b61f59ee7ac32364", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d6b54e0134766db00e69c997b61f59ee7ac32364", "committedDate": "2020-06-23T21:42:55Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}, "afterCommit": {"oid": "6548260f771d6caaaec4a6efd020f6c3f1f9ba5e", "author": {"user": {"login": "bragaigor", "name": "Igor Braga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6548260f771d6caaaec4a6efd020f6c3f1f9ba5e", "committedDate": "2020-06-24T15:37:19Z", "message": "Update DDR code to comply with arrays not having NULL pointers\n\nDiscontiguous arraylet do not have NULL arrayoids anymore;\ntheregore DDR was updated to reflect this change.\n\nRelated to: #9373\nFixes: #9971\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NjY0NDMz", "url": "https://github.com/eclipse-openj9/openj9/pull/9981#pullrequestreview-437664433", "createdAt": "2020-06-25T16:31:05Z", "commit": {"oid": "6548260f771d6caaaec4a6efd020f6c3f1f9ba5e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 578, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}