{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMTgxOTgz", "number": 10449, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMTozODoyOFrOEee3gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMTozODoyOFrOEee3gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMzk4NDY0OnYy", "diffSide": "RIGHT", "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMTozODoyOFrOHKKJXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNDowMjo0NVrOHLwq2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxNDA0Ng==", "bodyText": "Here and in a few other places, we don't check the disableTOC option. Is that by design?", "url": "https://github.com/eclipse-openj9/openj9/pull/10449#discussion_r480414046", "createdAt": "2020-08-31T21:38:28Z", "author": {"login": "gita-omr"}, "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "diffHunk": "@@ -219,7 +219,12 @@ TR::Register *J9::Power::JNILinkage::buildDirectDispatch(TR::Node *callNode)\n       {\n       // We need to kill all the non-volatiles so that they'll be in a stack frame in case\n       // gc needs to find them.\n-      if (comp()->target().is32Bit())\n+      if (comp()->target().is64Bit())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9be4b681f1e6543aa201729f09c7fcf71d22a4b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEwMTI1Mw==", "bodyText": "yes, that is by design, since disableTOC carries more meanings than POWER10.  For example, on POWER8/9, AOT also disabled pTOC (but gr16 is not free in those cases).  gr16 is only free on P10 and later (when pTOC is disabled as well).", "url": "https://github.com/eclipse-openj9/openj9/pull/10449#discussion_r481101253", "createdAt": "2020-09-01T12:31:40Z", "author": {"login": "zl-wang"}, "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "diffHunk": "@@ -219,7 +219,12 @@ TR::Register *J9::Power::JNILinkage::buildDirectDispatch(TR::Node *callNode)\n       {\n       // We need to kill all the non-volatiles so that they'll be in a stack frame in case\n       // gc needs to find them.\n-      if (comp()->target().is32Bit())\n+      if (comp()->target().is64Bit())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxNDA0Ng=="}, "originalCommit": {"oid": "9be4b681f1e6543aa201729f09c7fcf71d22a4b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTA1NQ==", "bodyText": "Sorry, I don't completely follow: will we be able to run with pTOC on P10?", "url": "https://github.com/eclipse-openj9/openj9/pull/10449#discussion_r481351055", "createdAt": "2020-09-01T18:36:53Z", "author": {"login": "gita-omr"}, "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "diffHunk": "@@ -219,7 +219,12 @@ TR::Register *J9::Power::JNILinkage::buildDirectDispatch(TR::Node *callNode)\n       {\n       // We need to kill all the non-volatiles so that they'll be in a stack frame in case\n       // gc needs to find them.\n-      if (comp()->target().is32Bit())\n+      if (comp()->target().is64Bit())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxNDA0Ng=="}, "originalCommit": {"oid": "9be4b681f1e6543aa201729f09c7fcf71d22a4b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1NzI0NA==", "bodyText": "after this PR is merged ... no, pTOC is completely gone on P10 and gr16 is recovered (you cannot reference to pTOC anymore on P10).  before this PR is merged, gr16 is still reserved and pTOC can be referenced and used in theory (but disabled in reality already -- on P10/later only, this is).", "url": "https://github.com/eclipse-openj9/openj9/pull/10449#discussion_r481357244", "createdAt": "2020-09-01T18:48:37Z", "author": {"login": "zl-wang"}, "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "diffHunk": "@@ -219,7 +219,12 @@ TR::Register *J9::Power::JNILinkage::buildDirectDispatch(TR::Node *callNode)\n       {\n       // We need to kill all the non-volatiles so that they'll be in a stack frame in case\n       // gc needs to find them.\n-      if (comp()->target().is32Bit())\n+      if (comp()->target().is64Bit())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxNDA0Ng=="}, "originalCommit": {"oid": "9be4b681f1e6543aa201729f09c7fcf71d22a4b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA5Mzc4NA==", "bodyText": "Thanks. Just to clarify after an off-line discussion: it was a design decision to disable pTOC completely and always use gr16 on P10 (no command line or env option to use old behaviour for either of those)", "url": "https://github.com/eclipse-openj9/openj9/pull/10449#discussion_r482093784", "createdAt": "2020-09-02T14:02:45Z", "author": {"login": "gita-omr"}, "path": "runtime/compiler/p/codegen/PPCJNILinkage.cpp", "diffHunk": "@@ -219,7 +219,12 @@ TR::Register *J9::Power::JNILinkage::buildDirectDispatch(TR::Node *callNode)\n       {\n       // We need to kill all the non-volatiles so that they'll be in a stack frame in case\n       // gc needs to find them.\n-      if (comp()->target().is32Bit())\n+      if (comp()->target().is64Bit())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQxNDA0Ng=="}, "originalCommit": {"oid": "9be4b681f1e6543aa201729f09c7fcf71d22a4b2"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4726, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}