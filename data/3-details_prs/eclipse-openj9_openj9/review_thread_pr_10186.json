{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwNTY0MDI5", "number": 10186, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowNDo1MlrOEQo58Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxNjoxMVrOEQwvrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODgyODY1OnYy", "diffSide": "RIGHT", "path": "runtime/bcutil/ClassFileWriter.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowNDo1MlrOG05mbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowNDo1MlrOG05mbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyMjg2Mg==", "bodyText": "Please use J9ROMCLASS_IS_SEALED at every possible location rather than testing the bit directly.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458122862", "createdAt": "2020-07-21T14:04:52Z", "author": {"login": "gacholio"}, "path": "runtime/bcutil/ClassFileWriter.cpp", "diffHunk": "@@ -957,6 +968,9 @@ ClassFileWriter::writeAttributes()\n \tif (J9_ARE_ANY_BITS_SET(_romClass->extraModifiers, J9AccRecord)) {\n \t\tattributesCount += 1;\n \t}\n+\tif (J9_ARE_ANY_BITS_SET(_romClass->extraModifiers, J9AccSealed)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODgzODA3OnYy", "diffSide": "RIGHT", "path": "runtime/bcutil/ClassFileWriter.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowNjo0M1rOG05sGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowNjo0M1rOG05sGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyNDMxMw==", "bodyText": "J9UTF8_EQUALS could be used here.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458124313", "createdAt": "2020-07-21T14:06:43Z", "author": {"login": "gacholio"}, "path": "runtime/bcutil/ClassFileWriter.cpp", "diffHunk": "@@ -1085,6 +1099,34 @@ ClassFileWriter::writeAttributes()\n \tif (J9_ARE_ANY_BITS_SET(_romClass->extraModifiers, J9AccRecord)) {\n \t\twriteRecordAttribute();\n \t}\n+\n+\t/* write PermittedSubclasses attribute */\n+\tif (J9_ARE_ANY_BITS_SET(_romClass->extraModifiers, J9AccSealed)) {\n+\t\tU_32 *permittedSubclassesCountPtr = getNumberOfPermittedSubclassesPtr(_romClass);\n+\t\twriteAttributeHeader((J9UTF8 *) &PERMITTED_SUBCLASSES, sizeof(U_16) + (*permittedSubclassesCountPtr * sizeof(U_16)));\n+\n+\t\twriteU16(*permittedSubclassesCountPtr);\n+\n+\t\tfor (U_32 i = 0; i < *permittedSubclassesCountPtr; i++) {\n+\t\t\tJ9UTF8* permittedSubclassNameUtf8 = permittedSubclassesNameAtIndex(permittedSubclassesCountPtr, i);\n+\n+\t\t\t/* CONSTANT_Class_info index should be written. Find class entry that references the subclass name in constant pool. */\n+\t\t\tJ9HashTableState hashTableState;\n+\t\t\tHashTableEntry * entry = (HashTableEntry *) hashTableStartDo(_cpHashTable, &hashTableState);\n+\t\t\twhile (NULL != entry) {\n+\t\t\t\tif (CFR_CONSTANT_Class == entry->cpType) {\n+\t\t\t\t\tJ9UTF8* classNameCandidate = (J9UTF8*)entry->address;\n+\t\t\t\t\tif (J9UTF8_DATA_EQUALS(J9UTF8_DATA(classNameCandidate), J9UTF8_LENGTH(classNameCandidate), ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg0OTY4OnYy", "diffSide": "RIGHT", "path": "runtime/cfdumper/main.c", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowOToxOFrOG05zYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDowOToxOFrOG05zYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyNjE3Ng==", "bodyText": "Is the string guaranteed to be nul-terminated? I see this pattern repeated throughout the code, so maybe it is.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458126176", "createdAt": "2020-07-21T14:09:18Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -907,6 +907,16 @@ static void dumpAttribute(J9CfrClassFile* classfile, J9CfrAttribute* attrib, U_3\n \t\t\t}\n \t\t\tbreak;\n \n+\t\tcase CFR_ATTRIBUTE_PermittedSubclasses:\n+\t\t\tfor(i = 0; i < ((J9CfrAttributePermittedSubclasses*)attrib)->numberOfClasses; i++) {\n+\t\t\t\tU_16 classIndex = ((J9CfrAttributePermittedSubclasses*)attrib)->classes[i];\n+\t\t\t\tU_16 nameIndex = classfile->constantPool[classIndex].slot1;\n+\n+\t\t\t\tfor(j = 0; j < tabLevel + 1; j++) j9tty_printf( PORTLIB, \"  \");\n+\t\t\t\tj9tty_printf( PORTLIB, \"PermittedSubclass class index, name: %i, %i -> %s\\n\", classIndex, nameIndex, classfile->constantPool[nameIndex].bytes);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg2MjQ1OnYy", "diffSide": "RIGHT", "path": "runtime/cfdumper/main.c", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMjoxMVrOG057gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMjoxMVrOG057gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyODI1Ng==", "bodyText": "Explicit '\\0 != check please.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458128256", "createdAt": "2020-07-21T14:12:11Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg2MzE5OnYy", "diffSide": "RIGHT", "path": "runtime/cfdumper/main.c", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMjoyMlrOG057-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxNToyM1rOG1GOWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyODM3OQ==", "bodyText": "Spacing.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458128379", "createdAt": "2020-07-21T14:12:22Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMyOTY5MQ==", "bodyText": "Please add spaces around the ? and :", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458329691", "createdAt": "2020-07-21T19:15:23Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyODM3OQ=="}, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg2NTYwOnYy", "diffSide": "RIGHT", "path": "runtime/cfdumper/main.c", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMjo1M1rOG059jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMjo1M1rOG059jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyODc4MQ==", "bodyText": "Brace on preceding line", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458128781", "createdAt": "2020-07-21T14:12:53Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg2Nzg5OnYy", "diffSide": "RIGHT", "path": "runtime/cfdumper/main.c", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMzoyNVrOG05_Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwNTowNjowMVrOG1S2Zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTE3OA==", "bodyText": "Please bracket the addition, and use braces.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458129178", "createdAt": "2020-07-21T14:13:25Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);\n+\t\t\t\t\t\tk++;\n+\t\t\t\t\t}\n+\t\t\t\t\tif (j + 1 != ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses) j9tty_printf( PORTLIB, \", \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMyOTMwNA==", "bodyText": "I would like the brackets around the addition, please - the rest doesn't matter.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458329304", "createdAt": "2020-07-21T19:14:43Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);\n+\t\t\t\t\t\tk++;\n+\t\t\t\t\t}\n+\t\t\t\t\tif (j + 1 != ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses) j9tty_printf( PORTLIB, \", \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTE3OA=="}, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzNjEyMg==", "bodyText": "updated.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458336122", "createdAt": "2020-07-21T19:27:30Z", "author": {"login": "theresa-m"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);\n+\t\t\t\t\t\tk++;\n+\t\t\t\t\t}\n+\t\t\t\t\tif (j + 1 != ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses) j9tty_printf( PORTLIB, \", \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTE3OA=="}, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODUwNzc5Mw==", "bodyText": "I'm not seeing the change.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458507793", "createdAt": "2020-07-22T03:10:55Z", "author": {"login": "gacholio"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);\n+\t\t\t\t\t\tk++;\n+\t\t\t\t\t}\n+\t\t\t\t\tif (j + 1 != ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses) j9tty_printf( PORTLIB, \", \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTE3OA=="}, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODUzNjU1MQ==", "bodyText": "I think I misread the change you wanted. Should be there now.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458536551", "createdAt": "2020-07-22T05:06:01Z", "author": {"login": "theresa-m"}, "path": "runtime/cfdumper/main.c", "diffHunk": "@@ -998,6 +1008,35 @@ static void printClassFile(J9CfrClassFile* classfile)\n \t\t}\n \t}\n \n+\t/* JEP 360: sealed class permits list */\n+\tif(classfile->j9Flags & CFR_J9FLAG_IS_SEALED) {\n+\t\t/* find PermittedSubclasses attribute */\n+\t\tfor (i = 0; i < classfile->attributesCount; i++) {\n+\t\t\tif (CFR_ATTRIBUTE_PermittedSubclasses == classfile->attributes[i]->tag) {\n+\t\t\t\t/* found attribute, print permitted subclasses */\n+\t\t\t\tj9tty_printf( PORTLIB, \" permits \");\n+\n+\t\t\t\tfor (j = 0; j < ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses; j++) {\n+\t\t\t\t\t/* class index */\n+\t\t\t\t\tindex = ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->classes[j];\n+\t\t\t\t\t/* class name index */\n+\t\t\t\t\tindex = classfile->constantPool[index].slot1;\n+\t\t\t\t\tstring = classfile->constantPool[index].bytes;\n+\n+\t\t\t\t\tk = 0;\n+\t\t\t\t\twhile(string[k])\n+\t\t\t\t\t{\n+\t\t\t\t\t\tj9tty_printf( PORTLIB, \"%c\", (string[k] == '/')?'.':string[k]);\n+\t\t\t\t\t\tk++;\n+\t\t\t\t\t}\n+\t\t\t\t\tif (j + 1 != ((J9CfrAttributePermittedSubclasses*)classfile->attributes[i])->numberOfClasses) j9tty_printf( PORTLIB, \", \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTE3OA=="}, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1ODg2OTc5OnYy", "diffSide": "RIGHT", "path": "runtime/util/romclasswalk.c", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMzo1MVrOG06ARQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDoxMzo1MVrOG06ARQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODEyOTQ3Nw==", "bodyText": "Function name on new line", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458129477", "createdAt": "2020-07-21T14:13:51Z", "author": {"login": "gacholio"}, "path": "runtime/util/romclasswalk.c", "diffHunk": "@@ -763,6 +763,32 @@ static void allSlotsInRecordDo(J9ROMClass* romClass, U_32* recordPointer, J9ROMC\n \tcallbacks->sectionCallback(romClass, recordPointer, (UDATA)cursor - (UDATA)recordPointer, \"recordInfo\", userData);\n }\n \n+static void allSlotsInPermittedSubclassesDo(J9ROMClass* romClass, U_32* permittedSubclassesPointer, J9ROMClassWalkCallbacks* callbacks, void* userData) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e43a14ec59dfe4c7a7504b42f9e2df1f4d63c9"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDExMzA4OnYy", "diffSide": "RIGHT", "path": "runtime/util/romclasswalk.c", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxNjoxMVrOG1GQBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxNjoxMVrOG1GQBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzMDExNw==", "bodyText": "Brace on new line please.", "url": "https://github.com/eclipse-openj9/openj9/pull/10186#discussion_r458330117", "createdAt": "2020-07-21T19:16:11Z", "author": {"login": "gacholio"}, "path": "runtime/util/romclasswalk.c", "diffHunk": "@@ -763,6 +763,33 @@ static void allSlotsInRecordDo(J9ROMClass* romClass, U_32* recordPointer, J9ROMC\n \tcallbacks->sectionCallback(romClass, recordPointer, (UDATA)cursor - (UDATA)recordPointer, \"recordInfo\", userData);\n }\n \n+static void \n+allSlotsInPermittedSubclassesDo(J9ROMClass* romClass, U_32* permittedSubclassesPointer, J9ROMClassWalkCallbacks* callbacks, void* userData) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90cac047ad51ee327818fac191d339f47d2cb469"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4779, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}