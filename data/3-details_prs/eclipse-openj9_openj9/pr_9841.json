{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMzExOTQy", "number": 9841, "title": "Inlined version of recognized methods", "bodyText": "java_nio_Bits_keepAlive and\njava_lang_ref_Reference_reachabilityFence have been added\nby consulting the semantics on other architectures.\nCloses: #7137\nSigned-off-by: Siri Sahithi Ponangi sahithi.ponangi@unb.ca", "createdAt": "2020-06-10T09:01:54Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9841", "merged": true, "mergeCommit": {"oid": "74f6ded549294fcf6f8691cbba58f87895b429d9"}, "closed": true, "closedAt": "2021-03-19T21:41:12Z", "author": {"login": "sahithiponangi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqPkCBAFqTQyODk5NzYzOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABeExu-0gFqTYxNjgxMDcwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4OTk3NjM5", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#pullrequestreview-428997639", "createdAt": "2020-06-11T14:58:50Z", "commit": {"oid": "a1b45af1bccef9a623fe6731995de034cc3c92fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo1ODo1MFrOGihQ_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo1ODo1MFrOGihQ_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg0OTc4OA==", "bodyText": "If you copied this implementation from x86, can you copy the comments that were in that code as well?  It helps to explain what this code is trying to achieve.", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#discussion_r438849788", "createdAt": "2020-06-11T14:58:50Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -1693,6 +1693,19 @@ J9::ARM64::CodeGenerator::inlineDirectCall(TR::Node *node, TR::Register *&result\n       {\n       switch (methodSymbol->getRecognizedMethod())\n          {\n+         case TR::java_nio_Bits_keepAlive:\n+         case TR::java_lang_ref_Reference_reachabilityFence:\n+            {\n+            TR::Node *paramNode = node->getFirstChild();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1b45af1bccef9a623fe6731995de034cc3c92fe"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a1b45af1bccef9a623fe6731995de034cc3c92fe", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/a1b45af1bccef9a623fe6731995de034cc3c92fe", "committedDate": "2020-06-10T08:56:28Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and\n java_lang_ref_Reference_reachabilityFence have been added\n by consulting the semantics on other architectures.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}, "afterCommit": {"oid": "41f2f9c748429b6962849dc53f02c53f05197061", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/41f2f9c748429b6962849dc53f02c53f05197061", "committedDate": "2020-06-15T19:50:36Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added by consulting the semantics on other architectures.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Mjg3Mzkx", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#pullrequestreview-456287391", "createdAt": "2020-07-28T04:05:43Z", "commit": {"oid": "41f2f9c748429b6962849dc53f02c53f05197061"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNDowNTo0NFrOG37z0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNDowNTo0NFrOG37z0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTMwNDc4NQ==", "bodyText": "There is a trailing space at the end of this line.", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#discussion_r461304785", "createdAt": "2020-07-28T04:05:44Z", "author": {"login": "knn-k"}, "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -1928,6 +1928,28 @@ J9::ARM64::CodeGenerator::inlineDirectCall(TR::Node *node, TR::Register *&result\n       {\n       switch (methodSymbol->getRecognizedMethod())\n          {\n+         case TR::java_nio_Bits_keepAlive:\n+         // The only purpose of keepAlive is to prevent an otherwise\n+         // unreachable object from being garbage collected, because we don't\n+         // want its finalizer to be called too early.  There's no need to\n+         // generate a full-blown call site just for this purpose.\n+         case TR::java_lang_ref_Reference_reachabilityFence: ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41f2f9c748429b6962849dc53f02c53f05197061"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "41f2f9c748429b6962849dc53f02c53f05197061", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/41f2f9c748429b6962849dc53f02c53f05197061", "committedDate": "2020-06-15T19:50:36Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added by consulting the semantics on other architectures.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}, "afterCommit": {"oid": "148ad1a4eecb4ac2b5b735b2072b7cd2bd0eb903", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/148ad1a4eecb4ac2b5b735b2072b7cd2bd0eb903", "committedDate": "2020-07-28T13:38:25Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added to prevent them from being collected.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE1NjM3NTg4", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#pullrequestreview-615637588", "createdAt": "2021-03-18T16:47:32Z", "commit": {"oid": "148ad1a4eecb4ac2b5b735b2072b7cd2bd0eb903"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQxNjo0NzozMlrOI5ZuvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQxNjo0NzozMlrOI5ZuvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzA2MTMwOA==", "bodyText": "I find the placement of these comments to be a bit odd.  Can you move them down below the opening brace like x86 has them?  Also, remove the specific reference to keepAlive as this applies to a couple of different recognized methods.  Maybe say \"these functions\" instead?", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#discussion_r597061308", "createdAt": "2021-03-18T16:47:32Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -1693,6 +1693,19 @@ J9::ARM64::CodeGenerator::inlineDirectCall(TR::Node *node, TR::Register *&result\n       {\n       switch (methodSymbol->getRecognizedMethod())\n          {\n+         case TR::java_nio_Bits_keepAlive:\n+         case TR::java_lang_ref_Reference_reachabilityFence:\n+            {\n+            TR::Node *paramNode = node->getFirstChild();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg0OTc4OA=="}, "originalCommit": {"oid": "a1b45af1bccef9a623fe6731995de034cc3c92fe"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81edd3dacae21119f33cc8bbd571862cd3cd5725", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/81edd3dacae21119f33cc8bbd571862cd3cd5725", "committedDate": "2021-03-18T17:09:21Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added to prevent them from being collected.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "148ad1a4eecb4ac2b5b735b2072b7cd2bd0eb903", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/148ad1a4eecb4ac2b5b735b2072b7cd2bd0eb903", "committedDate": "2020-07-28T13:38:25Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added to prevent them from being collected.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}, "afterCommit": {"oid": "81edd3dacae21119f33cc8bbd571862cd3cd5725", "author": {"user": {"login": "sahithiponangi", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/81edd3dacae21119f33cc8bbd571862cd3cd5725", "committedDate": "2021-03-18T17:09:21Z", "message": "Inlined version of recognized methods\n\njava_nio_Bits_keepAlive and java_lang_ref_Reference_reachabilityFence\n have been added to prevent them from being collected.\n\nIssue: #7137\n\nSigned-off-by: Siri Sahithi Ponangi <sahithi.ponangi@unb.ca>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE2ODEwNzA3", "url": "https://github.com/eclipse-openj9/openj9/pull/9841#pullrequestreview-616810707", "createdAt": "2021-03-19T21:40:45Z", "commit": {"oid": "81edd3dacae21119f33cc8bbd571862cd3cd5725"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 648, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}