{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0OTMwNjIy", "number": 10219, "title": "AArch64: Enable OOL for VMnewEvaluator", "bodyText": "This commit enables OutOfLineCodeSection for VMnewEvaluator.\nDepends on:\neclipse/omr#5392\n#10155\nSigned-off-by: Akira Saitoh saiaki@jp.ibm.com", "createdAt": "2020-07-22T07:19:22Z", "url": "https://github.com/eclipse-openj9/openj9/pull/10219", "merged": true, "mergeCommit": {"oid": "c4c6adfe6339af33ebcf3da25107ae45d6c57dcd"}, "closed": true, "closedAt": "2020-07-29T06:11:35Z", "author": {"login": "Akira1Saitoh"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3VLtngH2gAyNDU0OTMwNjIyOjZlODEyZjhlMGY4NmE0ZGNhOTYzYTE2MzJlODM0NjhjZjRjZmRiMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5kyXxAFqTQ1NzIyMDM1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f", "author": {"user": {"login": "Akira1Saitoh", "name": "Akira Saito"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6e812f8e0f86a4dca963a1632e83468cf4cfdb0f", "committedDate": "2020-07-22T06:52:43Z", "message": "AArch64: Enable OOL for VMnewEvaluator\n\nThis commit enables OutOfLineCodeSection for VMnewEvaluator.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTY1NjE5", "url": "https://github.com/eclipse-openj9/openj9/pull/10219#pullrequestreview-457165619", "createdAt": "2020-07-29T03:14:30Z", "commit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMzoxNDozMFrOG4nBFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMzoxNDozMFrOG4nBFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjAxMjY5Mw==", "bodyText": "Is ARM64HeapAllocSnippet used anywhere else?\nIf not, please remove its code from J9ARM64Snippet.hpp/cpp.  You can do it in a separate PR.", "url": "https://github.com/eclipse-openj9/openj9/pull/10219#discussion_r462012693", "createdAt": "2020-07-29T03:14:30Z", "author": {"login": "knn-k"}, "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -1368,9 +1369,10 @@ J9::ARM64::TreeEvaluator::VMnewEvaluator(TR::Node *node, TR::CodeGenerator *cg)\n    // 5. Allocate object/array on heap\n    genHeapAlloc(node, cg, isVariableLength, allocateSize, elementSize, resultReg, lengthReg, tempReg1, tempReg2, tempReg3, conditions, callLabel);\n \n-   // 6. Setup HeapAllocSnippet for slowpath\n-   TR::Snippet *snippet = new (cg->trHeapMemory()) TR::ARM64HeapAllocSnippet(cg, node, callLabel, node->getSymbolReference(), doneLabel);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTY3MzE4", "url": "https://github.com/eclipse-openj9/openj9/pull/10219#pullrequestreview-457167318", "createdAt": "2020-07-29T03:20:25Z", "commit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMzoyMDoyNVrOG4nHCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMzoyMDoyNVrOG4nHCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjAxNDIxNg==", "bodyText": "You use objReg as the target register of the OOL section here.\nWhat is the reason of calling generateMovInstruction(cg, node, objReg, resultReg, true); later?", "url": "https://github.com/eclipse-openj9/openj9/pull/10219#discussion_r462014216", "createdAt": "2020-07-29T03:20:25Z", "author": {"login": "knn-k"}, "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -1368,9 +1369,10 @@ J9::ARM64::TreeEvaluator::VMnewEvaluator(TR::Node *node, TR::CodeGenerator *cg)\n    // 5. Allocate object/array on heap\n    genHeapAlloc(node, cg, isVariableLength, allocateSize, elementSize, resultReg, lengthReg, tempReg1, tempReg2, tempReg3, conditions, callLabel);\n \n-   // 6. Setup HeapAllocSnippet for slowpath\n-   TR::Snippet *snippet = new (cg->trHeapMemory()) TR::ARM64HeapAllocSnippet(cg, node, callLabel, node->getSymbolReference(), doneLabel);\n-   cg->addSnippet(snippet);\n+   // 6. Setup OOL Section for slowpath\n+   TR::Register *objReg = cg->allocateCollectedReferenceRegister();\n+   TR_ARM64OutOfLineCodeSection *outlinedHelperCall = new (cg->trHeapMemory()) TR_ARM64OutOfLineCodeSection(node, TR::acall, objReg, callLabel, callReturnLabel, cg);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MjIwMzUx", "url": "https://github.com/eclipse-openj9/openj9/pull/10219#pullrequestreview-457220351", "createdAt": "2020-07-29T06:11:23Z", "commit": {"oid": "6e812f8e0f86a4dca963a1632e83468cf4cfdb0f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 325, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}