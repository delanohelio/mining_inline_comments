{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5MjE3MDA0", "number": 10521, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1NDo1OFrOEk-v-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDowNDoxM1rOEk--6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjEyMjgwOnYy", "diffSide": "RIGHT", "path": "runtime/vm/jvminit.c", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1NDo1OFrOHUOM_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1NDo1OFrOHUOM_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2NjI2OA==", "bodyText": "I would use explicit list of supported platforms rather than use \"all except Power\". What about ARM, RiscV, ZTPF etc?", "url": "https://github.com/eclipse-openj9/openj9/pull/10521#discussion_r490966268", "createdAt": "2020-09-18T13:54:58Z", "author": {"login": "dmitripivkine"}, "path": "runtime/vm/jvminit.c", "diffHunk": "@@ -1682,10 +1682,10 @@ IDATA VMInitStages(J9JavaVM *vm, IDATA stage, void* reserved) {\n \t\t\t\tIDATA argIndex9 = 0;\n \t\t\t\tBOOLEAN sharedClassDisabled = FALSE;\n \n-#if defined(J9VM_ARCH_X86)\n+#if !defined(J9VM_ARCH_POWER)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab7ef1c8e9f3fadba590132d136d4871346376da"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjE2MTA0OnYy", "diffSide": "RIGHT", "path": "runtime/gc_modron_startup/mminit.cpp", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDowNDoxM1rOHUOkkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNjo0ODowMlrOHUUpHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3MjMwNg==", "bodyText": "Does this code change the behavior when AOT is enabled? We want a change in behavior if AOT and portableAOT enabled.", "url": "https://github.com/eclipse-openj9/openj9/pull/10521#discussion_r490972306", "createdAt": "2020-09-18T14:04:13Z", "author": {"login": "mpirvu"}, "path": "runtime/gc_modron_startup/mminit.cpp", "diffHunk": "@@ -2927,7 +2927,7 @@ gcInitializeDefaults(J9JavaVM* vm)\n \n \t\t\t\tif (hwSupported) {\n \t\t\t\t\t/* Software Barrier request overwrites HW usage on supported HW */\n-\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier;\n+\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier && !J9_ARE_ANY_BITS_SET(vm->extendedRuntimeFlags2, J9_EXTENDED_RUNTIME2_ENABLE_AOT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab7ef1c8e9f3fadba590132d136d4871346376da"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3NjExNg==", "bodyText": "Right. Is it the same flag we check to force 3-bit shift?", "url": "https://github.com/eclipse-openj9/openj9/pull/10521#discussion_r490976116", "createdAt": "2020-09-18T14:10:06Z", "author": {"login": "dmitripivkine"}, "path": "runtime/gc_modron_startup/mminit.cpp", "diffHunk": "@@ -2927,7 +2927,7 @@ gcInitializeDefaults(J9JavaVM* vm)\n \n \t\t\t\tif (hwSupported) {\n \t\t\t\t\t/* Software Barrier request overwrites HW usage on supported HW */\n-\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier;\n+\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier && !J9_ARE_ANY_BITS_SET(vm->extendedRuntimeFlags2, J9_EXTENDED_RUNTIME2_ENABLE_AOT);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3MjMwNg=="}, "originalCommit": {"oid": "ab7ef1c8e9f3fadba590132d136d4871346376da"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA1MTg4MQ==", "bodyText": "You are checking J9_EXTENDED_RUNTIME2_ENABLE_PORTABLE_SHARED_CACHE to force shift selection. Should check here be the same?", "url": "https://github.com/eclipse-openj9/openj9/pull/10521#discussion_r491051881", "createdAt": "2020-09-18T16:10:39Z", "author": {"login": "dmitripivkine"}, "path": "runtime/gc_modron_startup/mminit.cpp", "diffHunk": "@@ -2927,7 +2927,7 @@ gcInitializeDefaults(J9JavaVM* vm)\n \n \t\t\t\tif (hwSupported) {\n \t\t\t\t\t/* Software Barrier request overwrites HW usage on supported HW */\n-\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier;\n+\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier && !J9_ARE_ANY_BITS_SET(vm->extendedRuntimeFlags2, J9_EXTENDED_RUNTIME2_ENABLE_AOT);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3MjMwNg=="}, "originalCommit": {"oid": "ab7ef1c8e9f3fadba590132d136d4871346376da"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA3MTc3NQ==", "bodyText": "Yes sorry I used the wrong flag, should be J9_EXTENDED_RUNTIME2_ENABLE_PORTABLE_SHARED_CACHE", "url": "https://github.com/eclipse-openj9/openj9/pull/10521#discussion_r491071775", "createdAt": "2020-09-18T16:48:02Z", "author": {"login": "harryyu1994"}, "path": "runtime/gc_modron_startup/mminit.cpp", "diffHunk": "@@ -2927,7 +2927,7 @@ gcInitializeDefaults(J9JavaVM* vm)\n \n \t\t\t\tif (hwSupported) {\n \t\t\t\t\t/* Software Barrier request overwrites HW usage on supported HW */\n-\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier;\n+\t\t\t\t\textensions->concurrentScavengerHWSupport = hwSupported && !extensions->softwareRangeCheckReadBarrier && !J9_ARE_ANY_BITS_SET(vm->extendedRuntimeFlags2, J9_EXTENDED_RUNTIME2_ENABLE_AOT);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3MjMwNg=="}, "originalCommit": {"oid": "ab7ef1c8e9f3fadba590132d136d4871346376da"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4571, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}