{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MjAzNzA0", "number": 8816, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzowNTo0NFrODnENwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzowNTo0NFrODnENwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjkwMTEzOnYy", "diffSide": "RIGHT", "path": "runtime/bcutil/ClassFileOracle.cpp", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMzowNTo0NFrOF01_zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMzozNToyMVrOF12tSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk1NDk1OQ==", "bodyText": "The knownAnnotations argument is for tracking specialAnnotations.  It shouldn't be set unless the code needs to do something with the \"found\" annotations - and this code isn't as it isn't checking the return value\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\twalkTypeAnnotations(recordComponentTypeAnnotations->numberOfAnnotations, recordComponentTypeAnnotations->typeAnnotations);\n          \n          \n            \n            \t\t\t\t\twalkTypeAnnotations(recordComponentTypeAnnotations->numberOfAnnotations, 0);", "url": "https://github.com/eclipse-openj9/openj9/pull/8816#discussion_r390954959", "createdAt": "2020-03-11T13:05:44Z", "author": {"login": "DanHeidinga"}, "path": "runtime/bcutil/ClassFileOracle.cpp", "diffHunk": "@@ -568,11 +568,19 @@ ClassFileOracle::walkRecordComponents(J9CfrAttributeRecord *attrib)\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = (J9CfrAttributeRuntimeVisibleAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleAnnotations *recordComponentAnnotations = (J9CfrAttributeRuntimeVisibleAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentAnnotations->rawDataLength) {\n+\t\t\t\t\twalkAnnotations(recordComponentAnnotations->numberOfAnnotations, recordComponentAnnotations->annotations, 0);\n+\t\t\t\t}\n+\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = recordComponentAnnotations;\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleTypeAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].typeAnnotationsAttribute = (J9CfrAttributeRuntimeVisibleTypeAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleTypeAnnotations *recordComponentTypeAnnotations = (J9CfrAttributeRuntimeVisibleTypeAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentTypeAnnotations->rawDataLength) {\n+\t\t\t\t\twalkTypeAnnotations(recordComponentTypeAnnotations->numberOfAnnotations, recordComponentTypeAnnotations->typeAnnotations);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "848eece76c31c85fb2e42f26fa585a4897de40ea"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExNDkyOQ==", "bodyText": "It should be correct. Only walkAnnotations has the knownAnnotations parameter.", "url": "https://github.com/eclipse-openj9/openj9/pull/8816#discussion_r391114929", "createdAt": "2020-03-11T16:49:48Z", "author": {"login": "theresa-m"}, "path": "runtime/bcutil/ClassFileOracle.cpp", "diffHunk": "@@ -568,11 +568,19 @@ ClassFileOracle::walkRecordComponents(J9CfrAttributeRecord *attrib)\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = (J9CfrAttributeRuntimeVisibleAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleAnnotations *recordComponentAnnotations = (J9CfrAttributeRuntimeVisibleAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentAnnotations->rawDataLength) {\n+\t\t\t\t\twalkAnnotations(recordComponentAnnotations->numberOfAnnotations, recordComponentAnnotations->annotations, 0);\n+\t\t\t\t}\n+\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = recordComponentAnnotations;\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleTypeAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].typeAnnotationsAttribute = (J9CfrAttributeRuntimeVisibleTypeAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleTypeAnnotations *recordComponentTypeAnnotations = (J9CfrAttributeRuntimeVisibleTypeAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentTypeAnnotations->rawDataLength) {\n+\t\t\t\t\twalkTypeAnnotations(recordComponentTypeAnnotations->numberOfAnnotations, recordComponentTypeAnnotations->typeAnnotations);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk1NDk1OQ=="}, "originalCommit": {"oid": "848eece76c31c85fb2e42f26fa585a4897de40ea"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjAxNTE3Ng==", "bodyText": "Sorry, my bad.  I misread the code", "url": "https://github.com/eclipse-openj9/openj9/pull/8816#discussion_r392015176", "createdAt": "2020-03-13T03:35:21Z", "author": {"login": "DanHeidinga"}, "path": "runtime/bcutil/ClassFileOracle.cpp", "diffHunk": "@@ -568,11 +568,19 @@ ClassFileOracle::walkRecordComponents(J9CfrAttributeRecord *attrib)\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = (J9CfrAttributeRuntimeVisibleAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleAnnotations *recordComponentAnnotations = (J9CfrAttributeRuntimeVisibleAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentAnnotations->rawDataLength) {\n+\t\t\t\t\twalkAnnotations(recordComponentAnnotations->numberOfAnnotations, recordComponentAnnotations->annotations, 0);\n+\t\t\t\t}\n+\t\t\t\t_recordComponentsInfo[i].annotationsAttribute = recordComponentAnnotations;\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\tcase CFR_ATTRIBUTE_RuntimeVisibleTypeAnnotations: {\n-\t\t\t\t_recordComponentsInfo[i].typeAnnotationsAttribute = (J9CfrAttributeRuntimeVisibleTypeAnnotations *) recordComponentAttr;\n+\t\t\t\tJ9CfrAttributeRuntimeVisibleTypeAnnotations *recordComponentTypeAnnotations = (J9CfrAttributeRuntimeVisibleTypeAnnotations *)recordComponentAttr;\n+\t\t\t\tif (0 == recordComponentTypeAnnotations->rawDataLength) {\n+\t\t\t\t\twalkTypeAnnotations(recordComponentTypeAnnotations->numberOfAnnotations, recordComponentTypeAnnotations->typeAnnotations);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk1NDk1OQ=="}, "originalCommit": {"oid": "848eece76c31c85fb2e42f26fa585a4897de40ea"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 512, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}