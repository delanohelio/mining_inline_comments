{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMjY4NTI4", "number": 9155, "title": "AArch64: Return 64 as L1 data cache line size when info unavailable", "bodyText": "sysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\nFixes #8969\nSigned-off-by: KONNO Kazuhiro konno@jp.ibm.com", "createdAt": "2020-04-07T13:29:53Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9155", "merged": true, "mergeCommit": {"oid": "a286546d32277aefd43a29e4de5a46f7a7e4d0f3"}, "closed": true, "closedAt": "2020-04-08T12:51:44Z", "author": {"login": "knn-k"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVTjUeAFqTM4OTEyOTQxMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVeepTgFqTM4OTYxMzYxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MTI5NDEx", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#pullrequestreview-389129411", "createdAt": "2020-04-07T13:44:03Z", "commit": {"oid": "88ef36f44ef0937bbfc888d4a72f7b9f00eaccab"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMzo0NDowM1rOGCEOlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMzo0NToxMFrOGCER3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDgxOTYwNw==", "bodyText": "Nitpick - we typically avoid // comments in VM code as not all supported compilers accept them and its easier to blanket ban them then ensure they are only present where in platform-specific code\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t// Cache line size in unavailable on some systems\n          \n          \n            \n            \t\t\t/* Cache line size in unavailable on some systems */", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#discussion_r404819607", "createdAt": "2020-04-07T13:44:03Z", "author": {"login": "DanHeidinga"}, "path": "runtime/port/unix/j9sysinfo.c", "diffHunk": "@@ -1675,8 +1675,11 @@ j9sysinfo_get_cache_info(struct J9PortLibrary *portLibrary, const J9CacheInfoQue\n \t) {\n \t\t/* L1 data cache line size */\n \t\tint32_t rc = (int32_t)sysconf(_SC_LEVEL1_DCACHE_LINESIZE);\n-\t\tif (rc >= 0) {\n+\t\tif (rc > 0) {\n \t\t\tresult = rc;\n+\t\t} else if (rc == 0) {\n+\t\t\t// Cache line size in unavailable on some systems", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88ef36f44ef0937bbfc888d4a72f7b9f00eaccab"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDgyMDQ0NQ==", "bodyText": "I had suggested 64 in the issue where this was discussed but have no experience on aarch64 to tell if that's actually reasonable.  Does 64 make sense given the chips that are available?  Would another value be a safer default?", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#discussion_r404820445", "createdAt": "2020-04-07T13:45:10Z", "author": {"login": "DanHeidinga"}, "path": "runtime/port/unix/j9sysinfo.c", "diffHunk": "@@ -1675,8 +1675,11 @@ j9sysinfo_get_cache_info(struct J9PortLibrary *portLibrary, const J9CacheInfoQue\n \t) {\n \t\t/* L1 data cache line size */\n \t\tint32_t rc = (int32_t)sysconf(_SC_LEVEL1_DCACHE_LINESIZE);\n-\t\tif (rc >= 0) {\n+\t\tif (rc > 0) {\n \t\t\tresult = rc;\n+\t\t} else if (rc == 0) {\n+\t\t\t// Cache line size in unavailable on some systems\n+\t\t\tresult = 64;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88ef36f44ef0937bbfc888d4a72f7b9f00eaccab"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88ef36f44ef0937bbfc888d4a72f7b9f00eaccab", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/88ef36f44ef0937bbfc888d4a72f7b9f00eaccab", "committedDate": "2020-04-07T13:23:01Z", "message": "AArch64: Return 64 as L1 data cache line size when info unavailable\n\nsysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}, "afterCommit": {"oid": "86175da91f7fc0eff778a588fd70bc281c7d7436", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/86175da91f7fc0eff778a588fd70bc281c7d7436", "committedDate": "2020-04-07T14:08:57Z", "message": "AArch64: Return 64 as L1 data cache line size when info unavailable\n\nsysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTkyMzE2", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#pullrequestreview-389592316", "createdAt": "2020-04-08T01:16:08Z", "commit": {"oid": "86175da91f7fc0eff778a588fd70bc281c7d7436"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTkyNTk4", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#pullrequestreview-389592598", "createdAt": "2020-04-08T01:17:11Z", "commit": {"oid": "86175da91f7fc0eff778a588fd70bc281c7d7436"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMToxNzoxMVrOGCbqFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMToxNzoxMVrOGCbqFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIwMzQ3Ng==", "bodyText": "Typo in should be is", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#discussion_r405203476", "createdAt": "2020-04-08T01:17:11Z", "author": {"login": "pshipton"}, "path": "runtime/port/unix/j9sysinfo.c", "diffHunk": "@@ -1675,8 +1675,11 @@ j9sysinfo_get_cache_info(struct J9PortLibrary *portLibrary, const J9CacheInfoQue\n \t) {\n \t\t/* L1 data cache line size */\n \t\tint32_t rc = (int32_t)sysconf(_SC_LEVEL1_DCACHE_LINESIZE);\n-\t\tif (rc >= 0) {\n+\t\tif (rc > 0) {\n \t\t\tresult = rc;\n+\t\t} else if (rc == 0) {\n+\t\t\t/* Cache line size in unavailable on some systems */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86175da91f7fc0eff778a588fd70bc281c7d7436"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da9324c7ef17d4b8b900e89b50a7aa2981d7f978", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/da9324c7ef17d4b8b900e89b50a7aa2981d7f978", "committedDate": "2020-04-08T01:37:32Z", "message": "AArch64: Return 64 as L1 data cache line size when info unavailable\n\nsysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86175da91f7fc0eff778a588fd70bc281c7d7436", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/86175da91f7fc0eff778a588fd70bc281c7d7436", "committedDate": "2020-04-07T14:08:57Z", "message": "AArch64: Return 64 as L1 data cache line size when info unavailable\n\nsysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}, "afterCommit": {"oid": "da9324c7ef17d4b8b900e89b50a7aa2981d7f978", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/da9324c7ef17d4b8b900e89b50a7aa2981d7f978", "committedDate": "2020-04-08T01:37:32Z", "message": "AArch64: Return 64 as L1 data cache line size when info unavailable\n\nsysconf(_SC_LEVEL1_DCACHE_LINESIZE) returns 0 on some systems.\nThis commit changes j9sysinfo_get_cache_info() to return 64 as the\nL1 data cache line size for AArch64 on such systems.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NjEzNjEx", "url": "https://github.com/eclipse-openj9/openj9/pull/9155#pullrequestreview-389613611", "createdAt": "2020-04-08T02:29:07Z", "commit": {"oid": "da9324c7ef17d4b8b900e89b50a7aa2981d7f978"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1210, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}