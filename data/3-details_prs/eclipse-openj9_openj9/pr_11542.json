{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NzM0NjU4", "number": 11542, "title": "Add single quote detection", "bodyText": "Add single quote detection to Tokenizer.java per described issue #11351.\n\nAdded single quote detection\nAdjusted comments so they make sense\nChanged command strings in sigabrtHandlingTest.xml to reflect this change\n\nCloses:  #11351\nSigned-off-by: J. Cody Arnholt j.cody.tbone@gmail.com", "createdAt": "2020-12-26T21:08:52Z", "url": "https://github.com/eclipse-openj9/openj9/pull/11542", "merged": true, "mergeCommit": {"oid": "c1b65d19e33c540abdd3a05d07f70b4c24acdd31"}, "closed": true, "closedAt": "2021-01-07T16:19:54Z", "author": {"login": "JCodyA"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdrQna3gFqTU2MDA3OTQ3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdt2ig8AFqTU2MzYyMTE1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMDc5NDc3", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#pullrequestreview-560079477", "createdAt": "2020-12-30T14:54:17Z", "commit": {"oid": "b051da1022644f3ce3d525831ac8b4eb99a43020"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQxNDo1NDoxN1rOIMu2_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQxNDo1NzoyMFrOIMu7Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDIyMTU2Ng==", "bodyText": "The first date should not be changed (it should remain 2013); the second date should be 2020 (or soon 2021).", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r550221566", "createdAt": "2020-12-30T14:54:17Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2013, 2018 IBM Corp. and others\n+ * Copyright (c) %s, %s IBM Corp. and others", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b051da1022644f3ce3d525831ac8b4eb99a43020"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDIyMTg2Ng==", "bodyText": "While you're changing this comment can you also fix the grammar, please (e.g. 'an argument')?", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r550221866", "createdAt": "2020-12-30T14:55:14Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -81,30 +81,36 @@ private String token() throws Exception {\n          * otherwise it will ends up returning an empty argument to be ignored in forming the command array.\n          *\n          * Three cases are taken into account in the while loop:\n-         * 1) Strings in double-quotes (a argument starting with double-quotes(\")) are completely extracted from the command string,\n-         *    whether white spaces in the argument exist or not. Double-quotes themselves are discarded after extraction when scanning forward.\n-         * 2) Normal arguments (no double-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n+         * 1) Strings in double-quotes/single-quotes (a argument starting with double-quotes(\") or single-quotes(')) are completely extracted from the command string,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b051da1022644f3ce3d525831ac8b4eb99a43020"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDIyMjYwMw==", "bodyText": "Perhaps delim should be moved up before the if:\nchar delim = buffer.charAt(index);\nif ((delim == '\"') || (delim == '\\'')) {\n\nNote the extra parentheses (so a reader doesn't have to consider the relative precedence of == vs. ||).", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r550222603", "createdAt": "2020-12-30T14:57:20Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -81,30 +81,36 @@ private String token() throws Exception {\n          * otherwise it will ends up returning an empty argument to be ignored in forming the command array.\n          *\n          * Three cases are taken into account in the while loop:\n-         * 1) Strings in double-quotes (a argument starting with double-quotes(\")) are completely extracted from the command string,\n-         *    whether white spaces in the argument exist or not. Double-quotes themselves are discarded after extraction when scanning forward.\n-         * 2) Normal arguments (no double-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n+         * 1) Strings in double-quotes/single-quotes (a argument starting with double-quotes(\") or single-quotes(')) are completely extracted from the command string,\n+         *    whether white spaces in the argument exist or not. Double-quotes/single-quotes themselves are discarded after extraction when scanning forward.\n+         * 2) Normal arguments (no double-quotes/single-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n          * 3) Following the original order of the command line, non-quoted portions of an argument would be extracted in case 2)\n          *    and concatenated to quoted portions of the argument extracted in case 1) within the external while loop.\n          */\n         while ((index < buffer.length()) && !Character.isWhitespace(buffer.charAt(index))) {\n \n         \t/**\n-        \t * Case 1: Expect a double-quoted string once a double-quotes is detected\n+        \t * Case 1: Expect a double-quoted or single-quoted string once either is detected\n         \t */\n-            if (buffer.charAt(index) == '\"') {\n+            if (buffer.charAt(index) == '\"' || buffer.charAt(index) == '\\'') {\n                 index++;\n                 int i = index;\n+                char delim;\n+                if (buffer.charAt(index-1) == '\"') {\n+                \tdelim = '\"';\n+                } else{\n+                \tdelim = '\\'';\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b051da1022644f3ce3d525831ac8b4eb99a43020"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMTg5OTMx", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#pullrequestreview-561189931", "createdAt": "2021-01-04T17:04:38Z", "commit": {"oid": "82ab2940c69906e6b0ac99595cf90d6779afb3f4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxNzowNDozOFrOIN5laQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxNzowNzo0N1rOIN5sew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQ0NTg2NQ==", "bodyText": "This will now need to be updated for 2021.", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r551445865", "createdAt": "2021-01-04T17:04:38Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -1,5 +1,5 @@\n /*******************************************************************************\n- * Copyright (c) 2013, 2018 IBM Corp. and others\n+ * Copyright (c) 2013, 2020 IBM Corp. and others", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82ab2940c69906e6b0ac99595cf90d6779afb3f4"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQ0NzU4Nw==", "bodyText": "Please fix the grammar here (we're searching for a singular quote).", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r551447587", "createdAt": "2021-01-04T17:07:36Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -81,30 +81,31 @@ private String token() throws Exception {\n          * otherwise it will ends up returning an empty argument to be ignored in forming the command array.\n          *\n          * Three cases are taken into account in the while loop:\n-         * 1) Strings in double-quotes (a argument starting with double-quotes(\")) are completely extracted from the command string,\n-         *    whether white spaces in the argument exist or not. Double-quotes themselves are discarded after extraction when scanning forward.\n-         * 2) Normal arguments (no double-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n+         * 1) Strings in double-quotes/single-quotes (an argument starting with double-quotes(\") or single-quotes(')) are completely extracted from the command string,\n+         *    whether white spaces in the argument exist or not. Double-quotes/single-quotes themselves are discarded after extraction when scanning forward.\n+         * 2) Normal arguments (no double-quotes/single-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n          * 3) Following the original order of the command line, non-quoted portions of an argument would be extracted in case 2)\n          *    and concatenated to quoted portions of the argument extracted in case 1) within the external while loop.\n          */\n         while ((index < buffer.length()) && !Character.isWhitespace(buffer.charAt(index))) {\n \n         \t/**\n-        \t * Case 1: Expect a double-quoted string once a double-quotes is detected\n+        \t * Case 1: Expect a double-quoted or single-quoted string once either is detected\n         \t */\n-            if (buffer.charAt(index) == '\"') {\n-                index++;\n-                int i = index;\n+\t\t\t\t\t  char delim = buffer.charAt(index);\n+            if ((delim == '\"') || (delim == '\\'')) {\n+\t\t\t\t\t\t\t\tindex++;\n+\t\t\t\t\t\t\t\tint i = index;\n \n                 /**\n-                 * search for another double-quotes since double-quotes appear in pairs.\n+                 * search for another double-quotes/single-quotes since they appear in pairs.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82ab2940c69906e6b0ac99595cf90d6779afb3f4"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQ0NzY3NQ==", "bodyText": "Please fix indentation to match surrounding code.", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#discussion_r551447675", "createdAt": "2021-01-04T17:07:47Z", "author": {"login": "keithc-ca"}, "path": "test/functional/cmdline_options_tester/src/Tokenizer.java", "diffHunk": "@@ -81,30 +81,31 @@ private String token() throws Exception {\n          * otherwise it will ends up returning an empty argument to be ignored in forming the command array.\n          *\n          * Three cases are taken into account in the while loop:\n-         * 1) Strings in double-quotes (a argument starting with double-quotes(\")) are completely extracted from the command string,\n-         *    whether white spaces in the argument exist or not. Double-quotes themselves are discarded after extraction when scanning forward.\n-         * 2) Normal arguments (no double-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n+         * 1) Strings in double-quotes/single-quotes (an argument starting with double-quotes(\") or single-quotes(')) are completely extracted from the command string,\n+         *    whether white spaces in the argument exist or not. Double-quotes/single-quotes themselves are discarded after extraction when scanning forward.\n+         * 2) Normal arguments (no double-quotes/single-quotes occur in the argument) are split up and extracted with white spaces between arguments.\n          * 3) Following the original order of the command line, non-quoted portions of an argument would be extracted in case 2)\n          *    and concatenated to quoted portions of the argument extracted in case 1) within the external while loop.\n          */\n         while ((index < buffer.length()) && !Character.isWhitespace(buffer.charAt(index))) {\n \n         \t/**\n-        \t * Case 1: Expect a double-quoted string once a double-quotes is detected\n+        \t * Case 1: Expect a double-quoted or single-quoted string once either is detected\n         \t */\n-            if (buffer.charAt(index) == '\"') {\n-                index++;\n-                int i = index;\n+\t\t\t\t\t  char delim = buffer.charAt(index);\n+            if ((delim == '\"') || (delim == '\\'')) {\n+\t\t\t\t\t\t\t\tindex++;\n+\t\t\t\t\t\t\t\tint i = index;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82ab2940c69906e6b0ac99595cf90d6779afb3f4"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "728d53ec6c779fe3b97f9b1423ffca690ccb14bc", "author": {"user": {"login": "JCodyA", "name": "Cody Arnholt"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/728d53ec6c779fe3b97f9b1423ffca690ccb14bc", "committedDate": "2021-01-07T15:45:05Z", "message": "Add single quote detection\n\nSigned-off-by: J. Cody Arnholt <j.cody.tbone@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNjIxMTUx", "url": "https://github.com/eclipse-openj9/openj9/pull/11542#pullrequestreview-563621151", "createdAt": "2021-01-07T16:16:24Z", "commit": {"oid": "728d53ec6c779fe3b97f9b1423ffca690ccb14bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1413, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}