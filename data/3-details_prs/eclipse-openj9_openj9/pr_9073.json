{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MTI3NTkz", "number": 9073, "title": "Prepare Power UnresolvedDataSnippet for OMR changes", "bodyText": "Previously, Power's UnresolvedDataSnippet took the address of the\ninstruction it should patch within the binary-encoded buffer. However,\nthe binary encoder refactors currently happening in OMR will make\nunresolved-related expansion occur before binary encoding, making it\nimpossible to provide this information at that time. Instead, the\nTR::Instruction object of the corresponding instruction will need to be\nused instead.\nTo avoid breaking OpenJ9, it's necessary to make sure it can handle both\nmethods of passing the instruction until the refactor is complete. To\naccomplish this, Power's UnresolvedDataSnippet will determine which\nmethod to use at runtime for the time being by overriding\ngetAddressOfDataReference. Once the refactors are complete, this hack\ncan be removed and the TR::Instruction method can be used\nunconditionally.\nSigned-off-by: Ben Thomas ben@benthomas.ca", "createdAt": "2020-04-01T17:20:17Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9073", "merged": true, "mergeCommit": {"oid": "ea159ff8388e3d2ea0d65c56fdac047d8035085b"}, "closed": true, "closedAt": "2020-04-13T16:55:32Z", "author": {"login": "aviansie-ben"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTbDlsAH2gAyMzk3MTI3NTkzOjFkMzEzNWZlNzRlM2Y4NTc5ZTM3YjI1Y2VkMWE0M2EyNzQ2MjNmZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTsi1hgFqTM4NjQzOTU0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1d3135fe74e3f8579e37b25ced1a43a274623fd8", "committedDate": "2020-04-01T17:22:00Z", "message": "Prepare Power UnresolvedDataSnippet for OMR changes\n\nPreviously, Power's UnresolvedDataSnippet took the address of the\ninstruction it should patch within the binary-encoded buffer. However,\nthe binary encoder refactors currently happening in OMR will make\nunresolved-related expansion occur before binary encoding, making it\nimpossible to provide this information at that time. Instead, the\nTR::Instruction object of the corresponding instruction will need to be\nused instead.\n\nTo avoid breaking OpenJ9, it's necessary to make sure it can handle both\nmethods of passing the instruction until the refactor is complete. To\naccomplish this, Power's UnresolvedDataSnippet will determine which\nmethod to use at runtime for the time being by overriding\ngetAddressOfDataReference. Once the refactors are complete, this hack\ncan be removed and the TR::Instruction method can be used\nunconditionally.\n\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1e64e4b586f78396bea0728bc6c39b276cea6e3", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/c1e64e4b586f78396bea0728bc6c39b276cea6e3", "committedDate": "2020-04-01T15:39:21Z", "message": "Prepare Power UnresolvedDataSnippet for OMR changes\n\nPreviously, Power's UnresolvedDataSnippet took the address of the\ninstruction it should patch within the binary-encoded buffer. However,\nthe binary encoder refactors currently happening in OMR will make\nunresolved-related expansion occur before binary encoding, making it\nimpossible to provide this information at that time. Instead, the\nTR::Instruction object of the corresponding instruction will need to be\nused instead.\n\nTo avoid breaking OpenJ9, it's necessary to make sure it can handle both\nmethods of passing the instruction until the refactor is complete. To\naccomplish this, Power's UnresolvedDataSnippet will determine which\nmethod to use at runtime for the time being by overriding\ngetAddressOfDataReference. Once the refactors are complete, this hack\ncan be removed and the TR::Instruction method can be used\nunconditionally.\n\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}, "afterCommit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1d3135fe74e3f8579e37b25ced1a43a274623fd8", "committedDate": "2020-04-01T17:22:00Z", "message": "Prepare Power UnresolvedDataSnippet for OMR changes\n\nPreviously, Power's UnresolvedDataSnippet took the address of the\ninstruction it should patch within the binary-encoded buffer. However,\nthe binary encoder refactors currently happening in OMR will make\nunresolved-related expansion occur before binary encoding, making it\nimpossible to provide this information at that time. Instead, the\nTR::Instruction object of the corresponding instruction will need to be\nused instead.\n\nTo avoid breaking OpenJ9, it's necessary to make sure it can handle both\nmethods of passing the instruction until the refactor is complete. To\naccomplish this, Power's UnresolvedDataSnippet will determine which\nmethod to use at runtime for the time being by overriding\ngetAddressOfDataReference. Once the refactors are complete, this hack\ncan be removed and the TR::Instruction method can be used\nunconditionally.\n\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1ODE5NDIw", "url": "https://github.com/eclipse-openj9/openj9/pull/9073#pullrequestreview-385819420", "createdAt": "2020-04-01T17:55:57Z", "commit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzo1NTo1N1rOF_MHtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNzo1NzoxNlrOF_MKsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgwMzE5MA==", "bodyText": "Will this return null at the time of the merge?", "url": "https://github.com/eclipse-openj9/openj9/pull/9073#discussion_r401803190", "createdAt": "2020-04-01T17:55:57Z", "author": {"login": "gita-omr"}, "path": "runtime/compiler/p/codegen/J9UnresolvedDataSnippet.cpp", "diffHunk": "@@ -66,6 +67,13 @@ J9::Power::UnresolvedDataSnippet::UnresolvedDataSnippet(\n    {\n    }\n \n+uint8_t *J9::Power::UnresolvedDataSnippet::getAddressOfDataReference()\n+   {\n+   if (self()->getDataReferenceInstruction())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgwMzk1Mw==", "bodyText": "With the new expansion phase, will the binary encoding address be available at that time?", "url": "https://github.com/eclipse-openj9/openj9/pull/9073#discussion_r401803953", "createdAt": "2020-04-01T17:57:16Z", "author": {"login": "gita-omr"}, "path": "runtime/compiler/p/codegen/J9UnresolvedDataSnippet.cpp", "diffHunk": "@@ -66,6 +67,13 @@ J9::Power::UnresolvedDataSnippet::UnresolvedDataSnippet(\n    {\n    }\n \n+uint8_t *J9::Power::UnresolvedDataSnippet::getAddressOfDataReference()\n+   {\n+   if (self()->getDataReferenceInstruction())\n+      return self()->getDataReferenceInstruction()->getBinaryEncoding();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NDM5NTQz", "url": "https://github.com/eclipse-openj9/openj9/pull/9073#pullrequestreview-386439543", "createdAt": "2020-04-02T13:44:31Z", "commit": {"oid": "1d3135fe74e3f8579e37b25ced1a43a274623fd8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1396, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}