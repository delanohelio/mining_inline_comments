{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MTQ5NDU0", "number": 9016, "title": "Make JITINLINE functions in MethodMetaData.c static VMINLINE", "bodyText": "Delete JITINLINE, replacing all uses with VMINLINE.\nMove the declaration of private functions from MethodMetaData.h to\nMethodMetaData.c.\nAdd the static qualifier to every function that was marked JITINLINE.\nRemove duplicate non-inline declarations of:\n\ngetJit32BitInterpreterPC\ngetJit16BitInterpreterPC\ngetJitConstantPool\ngetJitRamMethod\n\n\nremove inline annotation from the public function getByteCodeIndex.\n\nThis fixes a dynamic linker error in debug builds, caused by inline\nfunction definitions that were were not marked static or extern.\nFixes: #9015\nSigned-off-by: Robert Young rwy0717@gmail.com", "createdAt": "2020-03-28T20:21:21Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9016", "merged": true, "mergeCommit": {"oid": "0e7c6deda28d5d95e3212bcfa929921904fb8e2c"}, "closed": true, "closedAt": "2020-04-28T16:00:27Z", "author": {"login": "rwy0717"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSLQLqgBqjMxNzUyOTkwOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXsJW1gFqTM5MzM2MzU0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f1b810132545993595aceca8d349270c6e105fd", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6f1b810132545993595aceca8d349270c6e105fd", "committedDate": "2020-03-28T20:20:10Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "1ce5d3a4be825d8f61b0434c29f97b7c963bd096", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1ce5d3a4be825d8f61b0434c29f97b7c963bd096", "committedDate": "2020-03-28T20:23:03Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ce5d3a4be825d8f61b0434c29f97b7c963bd096", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1ce5d3a4be825d8f61b0434c29f97b7c963bd096", "committedDate": "2020-03-28T20:23:03Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "d12fc05bc7a9ce6467ac5b3f9f5c2a2c3facbb24", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d12fc05bc7a9ce6467ac5b3f9f5c2a2c3facbb24", "committedDate": "2020-03-28T20:31:57Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n4. For functions already marked static JITINLINE, remove static\n   qualifier.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d12fc05bc7a9ce6467ac5b3f9f5c2a2c3facbb24", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d12fc05bc7a9ce6467ac5b3f9f5c2a2c3facbb24", "committedDate": "2020-03-28T20:31:57Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n4. For functions already marked static JITINLINE, remove static\n   qualifier.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "eba1d78b6fe12db0f7afb42642e1e5248c522b4f", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/eba1d78b6fe12db0f7afb42642e1e5248c522b4f", "committedDate": "2020-03-28T21:31:08Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n4. For functions already marked static and JITINLINE, remove static\n   qualifier.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eba1d78b6fe12db0f7afb42642e1e5248c522b4f", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/eba1d78b6fe12db0f7afb42642e1e5248c522b4f", "committedDate": "2020-03-28T21:31:08Z", "message": "Make JITINLINE functions in MethodMetaData.c static inline\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c\n2. Add the static qualifier to JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC\n4. For functions already marked static and JITINLINE, remove static\n   qualifier.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "d846a8f1a5b781aac3d9ff01af9cfeb49e70a3f5", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d846a8f1a5b781aac3d9ff01af9cfeb49e70a3f5", "committedDate": "2020-03-29T17:24:01Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d846a8f1a5b781aac3d9ff01af9cfeb49e70a3f5", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d846a8f1a5b781aac3d9ff01af9cfeb49e70a3f5", "committedDate": "2020-03-29T17:24:01Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "0b53ef5ddc63b9766f2b4c604df6308a73a09383", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/0b53ef5ddc63b9766f2b4c604df6308a73a09383", "committedDate": "2020-03-29T17:27:38Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTkwMjcx", "url": "https://github.com/eclipse-openj9/openj9/pull/9016#pullrequestreview-392190271", "createdAt": "2020-04-13T14:45:54Z", "commit": {"oid": "0b53ef5ddc63b9766f2b4c604df6308a73a09383"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDo0NTo1NFrOGEoyPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDo0NTo1NFrOGEoyPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUxNTcxMQ==", "bodyText": "Does JITINLINE == VMINLINE? If so I don't see the value of having this duplicate value. We should just use VMINLINE to be consistent.", "url": "https://github.com/eclipse-openj9/openj9/pull/9016#discussion_r407515711", "createdAt": "2020-04-13T14:45:54Z", "author": {"login": "fjeremic"}, "path": "runtime/compiler/runtime/MethodMetaData.c", "diffHunk": "@@ -30,10 +30,62 @@\n #include \"rommeth.h\"\n #include \"env/jittypes.h\"\n \n+#if defined(DEBUG)\n+#define JITINLINE\n+#else\n+#if defined(_MSC_VER)\n+#define JITINLINE __forceinline\n+#elif (((__GNUC__ > 3) || (__GNUC__ == 3 && __GNUC_MINOR__ >= 1)) || defined(__clang__)) && !defined(J9VM_GC_REALTIME)\n+#define JITINLINE inline __attribute((always_inline))\n+#else\n+#define JITINLINE __inline\n+#endif\n+#endif", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b53ef5ddc63b9766f2b4c604df6308a73a09383"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b53ef5ddc63b9766f2b4c604df6308a73a09383", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/0b53ef5ddc63b9766f2b4c604df6308a73a09383", "committedDate": "2020-03-29T17:27:38Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "c15894e46262ed578788ecfa204e62aee67d52a2", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/c15894e46262ed578788ecfa204e62aee67d52a2", "committedDate": "2020-04-14T13:10:33Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27054625eeac5e0bbf260f366890c8e5fbcae4cf", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/27054625eeac5e0bbf260f366890c8e5fbcae4cf", "committedDate": "2020-04-14T13:57:35Z", "message": "Make JITINLINE functions in MethodMetaData.c static VMINLINE\n\n1. Delete JITINLINE, replacing all uses with VMINLINE.\n2. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c.\n3. Add the static qualifier to every function that was marked JITINLINE.\n4. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n5. remove inline annotation from the public function getByteCodeIndex.\n\nThis fixes a dynamic linker error in debug builds, caused by inline\nfunction definitions that were were not marked static or extern.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c15894e46262ed578788ecfa204e62aee67d52a2", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/c15894e46262ed578788ecfa204e62aee67d52a2", "committedDate": "2020-04-14T13:10:33Z", "message": "Make JITINLINE functions in MethodMetaData.c also static\n\n1. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c, as well as the definition of JITINLINE.\n2. Add the static qualifier to every function that is marked JITINLINE.\n3. Recognize the clang compiler, JITINLINE should be the same as on GCC.\n4. Replace preprocessor test against WINDOWS with test against _MSC_VER.\n5. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n6. remove JITINLINE annotation from public function getByteCodeIndex.\n\nThis fixes a link-time error, caused by an incorrect usage of the inline\nqualifier in C code.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}, "afterCommit": {"oid": "27054625eeac5e0bbf260f366890c8e5fbcae4cf", "author": {"user": {"login": "rwy0717", "name": "Robert Young"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/27054625eeac5e0bbf260f366890c8e5fbcae4cf", "committedDate": "2020-04-14T13:57:35Z", "message": "Make JITINLINE functions in MethodMetaData.c static VMINLINE\n\n1. Delete JITINLINE, replacing all uses with VMINLINE.\n2. Move the declaration of private functions from MethodMetaData.h to\n   MethodMetaData.c.\n3. Add the static qualifier to every function that was marked JITINLINE.\n4. Remove duplicate non-inline declarations of:\n   - getJit32BitInterpreterPC\n   - getJit16BitInterpreterPC\n   - getJitConstantPool\n   - getJitRamMethod\n5. remove inline annotation from the public function getByteCodeIndex.\n\nThis fixes a dynamic linker error in debug builds, caused by inline\nfunction definitions that were were not marked static or extern.\n\nSigned-off-by: Robert Young <rwy0717@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMzYzNTQw", "url": "https://github.com/eclipse-openj9/openj9/pull/9016#pullrequestreview-393363540", "createdAt": "2020-04-14T23:32:23Z", "commit": {"oid": "27054625eeac5e0bbf260f366890c8e5fbcae4cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1347, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}