{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDA0NjM3", "number": 10153, "title": "CMake: Update flag handling on interpreter sources", "bodyText": "Signed-off-by: Devin Nakamura devinn@ca.ibm.com", "createdAt": "2020-07-13T17:57:07Z", "url": "https://github.com/eclipse-openj9/openj9/pull/10153", "merged": true, "mergeCommit": {"oid": "371211f60308b066db6ec6e8afc914d21c49a612"}, "closed": true, "closedAt": "2020-09-01T16:41:10Z", "author": {"login": "dnakamura"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5FY5UgFqTQ1NTk4OTUwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEWIadABqjM3MTA4NTQxOTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTg5NTAz", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#pullrequestreview-455989503", "createdAt": "2020-07-27T17:28:50Z", "commit": {"oid": "8810ea447848ec7f7d3405db99ff5bef914773c9"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyODo1MVrOG3sZnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzoyODo1NVrOG3sZzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MjMxOQ==", "bodyText": "This doesn't apply to pLinux BE, only AIX (although pLinux BE uses gcc for the interpreter).", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#discussion_r461052319", "createdAt": "2020-07-27T17:28:51Z", "author": {"login": "pshipton"}, "path": "runtime/vm/CMakeLists.txt", "diffHunk": "@@ -21,23 +21,50 @@\n ################################################################################\n \n omr_add_tracegen(j9vm.tdf)\n-j9vm_add_library(j9vm SHARED\n-\tOUTPUT_NAME j9vm${J9VM_VERSION_SUFFIX}\n+\n+set(interp_flags_to_remove) # list of flags removed when compiling the interpreter\n+set(interp_new_flags) # flags to be added when compiling the interpreter\n+\n+if(OMR_ARCH_POWER)\n+\tif(OMR_TOOLCONFIG STREQUAL \"xlc\")\n+\t\tlist(APPEND interp_flags_to_remove \"-O3\")\n+\t\tlist(APPEND interp_new_flags \"-O2\" \"-qdebug=lincomm:ptranl:tfbagg\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8810ea447848ec7f7d3405db99ff5bef914773c9"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MjM2Nw==", "bodyText": "I don't think we support any Linux compiling the interpreter with xlc.", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#discussion_r461052367", "createdAt": "2020-07-27T17:28:55Z", "author": {"login": "pshipton"}, "path": "runtime/vm/CMakeLists.txt", "diffHunk": "@@ -21,23 +21,50 @@\n ################################################################################\n \n omr_add_tracegen(j9vm.tdf)\n-j9vm_add_library(j9vm SHARED\n-\tOUTPUT_NAME j9vm${J9VM_VERSION_SUFFIX}\n+\n+set(interp_flags_to_remove) # list of flags removed when compiling the interpreter\n+set(interp_new_flags) # flags to be added when compiling the interpreter\n+\n+if(OMR_ARCH_POWER)\n+\tif(OMR_TOOLCONFIG STREQUAL \"xlc\")\n+\t\tlist(APPEND interp_flags_to_remove \"-O3\")\n+\t\tlist(APPEND interp_new_flags \"-O2\" \"-qdebug=lincomm:ptranl:tfbagg\")\n+\t\tif(OMR_OS_LINUX)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8810ea447848ec7f7d3405db99ff5bef914773c9"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8810ea447848ec7f7d3405db99ff5bef914773c9", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/8810ea447848ec7f7d3405db99ff5bef914773c9", "committedDate": "2020-07-13T17:54:15Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "1c71e0eca330b201e36cd066d98d7a02a8c3b812", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1c71e0eca330b201e36cd066d98d7a02a8c3b812", "committedDate": "2020-08-10T17:12:18Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MDU4MTk5", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#pullrequestreview-466058199", "createdAt": "2020-08-12T15:59:31Z", "commit": {"oid": "1c71e0eca330b201e36cd066d98d7a02a8c3b812"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNTo1OTozMVrOG_oCwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNjowMDo0NVrOG_oF9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM2OTUzNw==", "bodyText": "This is commented but the closing ]] aren't.  Am I missing something about the cmake syntax?", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#discussion_r469369537", "createdAt": "2020-08-12T15:59:31Z", "author": {"login": "DanHeidinga"}, "path": "runtime/vm/CMakeLists.txt", "diffHunk": "@@ -21,23 +21,54 @@\n ################################################################################\n \n omr_add_tracegen(j9vm.tdf)\n-j9vm_add_library(j9vm SHARED\n-\tOUTPUT_NAME j9vm${J9VM_VERSION_SUFFIX}\n+\n+set(interp_flags_to_remove) # list of flags removed when compiling the interpreter\n+set(interp_new_flags) # flags to be added when compiling the interpreter\n+\n+# Note: the uma makefiles also specify this for pLinux, however it appears we no longer\n+# support building the interpreter with xlc on linux\n+if(OMR_ARCH_POWER AND OMR_OS_AIX)\n+\tif(OMR_TOOLCONFIG STREQUAL \"xlc\")\n+\t\tlist(APPEND interp_flags_to_remove \"-O3\")\n+\t\tlist(APPEND interp_new_flags \"-O2\" \"-qdebug=lincomm:ptranl:tfbagg\")\n+\t\t#[[", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c71e0eca330b201e36cd066d98d7a02a8c3b812"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM3MDM1OA==", "bodyText": "We can never get to this if statement, can we?  It's enclosed in a if power && AIX check", "url": "https://github.com/eclipse-openj9/openj9/pull/10153#discussion_r469370358", "createdAt": "2020-08-12T16:00:45Z", "author": {"login": "DanHeidinga"}, "path": "runtime/vm/CMakeLists.txt", "diffHunk": "@@ -21,23 +21,50 @@\n ################################################################################\n \n omr_add_tracegen(j9vm.tdf)\n-j9vm_add_library(j9vm SHARED\n-\tOUTPUT_NAME j9vm${J9VM_VERSION_SUFFIX}\n+\n+set(interp_flags_to_remove) # list of flags removed when compiling the interpreter\n+set(interp_new_flags) # flags to be added when compiling the interpreter\n+\n+if(OMR_ARCH_POWER)\n+\tif(OMR_TOOLCONFIG STREQUAL \"xlc\")\n+\t\tlist(APPEND interp_flags_to_remove \"-O3\")\n+\t\tlist(APPEND interp_new_flags \"-O2\" \"-qdebug=lincomm:ptranl:tfbagg\")\n+\t\tif(OMR_OS_LINUX)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1MjM2Nw=="}, "originalCommit": {"oid": "8810ea447848ec7f7d3405db99ff5bef914773c9"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c71e0eca330b201e36cd066d98d7a02a8c3b812", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/1c71e0eca330b201e36cd066d98d7a02a8c3b812", "committedDate": "2020-08-10T17:12:18Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "2270d6d53a56d36e25ad782cb96c22cbe7678725", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2270d6d53a56d36e25ad782cb96c22cbe7678725", "committedDate": "2020-08-31T15:26:35Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c50ff509bb51cee8e42e0299158df214f526266", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2c50ff509bb51cee8e42e0299158df214f526266", "committedDate": "2020-08-31T17:19:51Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2270d6d53a56d36e25ad782cb96c22cbe7678725", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2270d6d53a56d36e25ad782cb96c22cbe7678725", "committedDate": "2020-08-31T15:26:35Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "2c50ff509bb51cee8e42e0299158df214f526266", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2c50ff509bb51cee8e42e0299158df214f526266", "committedDate": "2020-08-31T17:19:51Z", "message": "CMake: Update flag handling on interpreter sources\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 566, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}