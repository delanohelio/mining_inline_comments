{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NzE1Mzgy", "number": 10364, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNjo1NDowNVrOEXtr9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNjo1NDowNVrOEXtr9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMzAxMjM4OnYy", "diffSide": "RIGHT", "path": "runtime/jcl/common/jclcinit.c", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNjo1NDowNVrOG_qFHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxODo0MDoyMlrOG_t1rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjkwOQ==", "bodyText": "Rather than doing this, you could just preload NPE using the existing mechanism and fetch it via J9VMJAVALANGNULLPOINTEREXCEPITON_OR_NULL.", "url": "https://github.com/eclipse-openj9/openj9/pull/10364#discussion_r469402909", "createdAt": "2020-08-12T16:54:05Z", "author": {"login": "gacholio"}, "path": "runtime/jcl/common/jclcinit.c", "diffHunk": "@@ -773,6 +773,9 @@ initializeRequiredClasses(J9VMThread *vmThread, char* dllName)\n \t\treturn 1;\n \t}\n \tvmThread->outOfMemoryError = oom;\n+#if JAVA_SPEC_VERSION >= 15\n+\tvm->nullPointerExceptionClass = vmFuncs->internalFindKnownClass(vmThread, J9VMCONSTANTPOOL_JAVALANGNULLPOINTEREXCEPTION, J9_FINDKNOWNCLASS_FLAG_NON_FATAL);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "045c3892c1aefc75138451fdd20e39ed512927fa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQxMTYyMg==", "bodyText": "Sure, will switch to J9VMJAVALANGNULLPOINTEREXCEPTION_OR_NULL(vm) assuming NPE is one of the known classes initialized within initializeKnownClasses.", "url": "https://github.com/eclipse-openj9/openj9/pull/10364#discussion_r469411622", "createdAt": "2020-08-12T17:08:42Z", "author": {"login": "JasonFengJ9"}, "path": "runtime/jcl/common/jclcinit.c", "diffHunk": "@@ -773,6 +773,9 @@ initializeRequiredClasses(J9VMThread *vmThread, char* dllName)\n \t\treturn 1;\n \t}\n \tvmThread->outOfMemoryError = oom;\n+#if JAVA_SPEC_VERSION >= 15\n+\tvm->nullPointerExceptionClass = vmFuncs->internalFindKnownClass(vmThread, J9VMCONSTANTPOOL_JAVALANGNULLPOINTEREXCEPTION, J9_FINDKNOWNCLASS_FLAG_NON_FATAL);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjkwOQ=="}, "originalCommit": {"oid": "045c3892c1aefc75138451fdd20e39ed512927fa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQxMTc2Mg==", "bodyText": "For java15, add NPE to the list of required classes that already exists.", "url": "https://github.com/eclipse-openj9/openj9/pull/10364#discussion_r469411762", "createdAt": "2020-08-12T17:08:59Z", "author": {"login": "gacholio"}, "path": "runtime/jcl/common/jclcinit.c", "diffHunk": "@@ -773,6 +773,9 @@ initializeRequiredClasses(J9VMThread *vmThread, char* dllName)\n \t\treturn 1;\n \t}\n \tvmThread->outOfMemoryError = oom;\n+#if JAVA_SPEC_VERSION >= 15\n+\tvm->nullPointerExceptionClass = vmFuncs->internalFindKnownClass(vmThread, J9VMCONSTANTPOOL_JAVALANGNULLPOINTEREXCEPTION, J9_FINDKNOWNCLASS_FLAG_NON_FATAL);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjkwOQ=="}, "originalCommit": {"oid": "045c3892c1aefc75138451fdd20e39ed512927fa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ2NDQ5NQ==", "bodyText": "Updated the PR, it works with following simple testcases:\nnew NullPointerException().printStackTrace();\njava.lang.NullPointerException\n\tat a.se.next.TestNPEMsg.testAll(TestNPEMsg.java:8)\n\tat a.se.next.TestNPEMsg.main(TestNPEMsg.java:13)\n\nnew NullPointerException(\"JDK15 NPE\").printStackTrace();\njava.lang.NullPointerException: JDK15 NPE\n\tat a.se.next.TestNPEMsg.testAll(TestNPEMsg.java:9)\n\tat a.se.next.TestNPEMsg.main(TestNPEMsg.java:13)\n\nPlease have another look.", "url": "https://github.com/eclipse-openj9/openj9/pull/10364#discussion_r469464495", "createdAt": "2020-08-12T18:40:22Z", "author": {"login": "JasonFengJ9"}, "path": "runtime/jcl/common/jclcinit.c", "diffHunk": "@@ -773,6 +773,9 @@ initializeRequiredClasses(J9VMThread *vmThread, char* dllName)\n \t\treturn 1;\n \t}\n \tvmThread->outOfMemoryError = oom;\n+#if JAVA_SPEC_VERSION >= 15\n+\tvm->nullPointerExceptionClass = vmFuncs->internalFindKnownClass(vmThread, J9VMCONSTANTPOOL_JAVALANGNULLPOINTEREXCEPTION, J9_FINDKNOWNCLASS_FLAG_NON_FATAL);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjkwOQ=="}, "originalCommit": {"oid": "045c3892c1aefc75138451fdd20e39ed512927fa"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4667, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}