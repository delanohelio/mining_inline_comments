{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MDMwNzE3", "number": 10743, "title": "Handle native OOM in catUTFToString4", "bodyText": "catUTFToString4 will now set native OOM if it fails to allocate memory,\nso that an exception will always be pending if NULL is returned. Update\ncallers to respect the OOM.\n[ci skip]\nSigned-off-by: Graham Chapman graham_chapman@ca.ibm.com", "createdAt": "2020-09-29T18:50:59Z", "url": "https://github.com/eclipse-openj9/openj9/pull/10743", "merged": true, "mergeCommit": {"oid": "b18b9e53eb38c10c3c42dfca938400d501910ba4"}, "closed": true, "closedAt": "2020-09-30T16:53:50Z", "author": {"login": "gacholio"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNsxqTgH2gAyNDk1MDMwNzE3OjY1N2QyNGZhZTJiYThhZGMyNDI1YzA2YWZhZjRjMzhkYTFlMjY0NDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNtja4AFqTQ5ODgyMjE5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "657d24fae2ba8adc2425c06afaf4c38da1e26449", "author": {"user": {"login": "gacholio", "name": "Graham Chapman"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/657d24fae2ba8adc2425c06afaf4c38da1e26449", "committedDate": "2020-09-29T18:48:19Z", "message": "Handle native OOM in catUTFToString4\n\ncatUTFToString4 will now set native OOM if it fails to allocate memory,\nso that an exception will always be pending if NULL is returned. Update\ncallers to respect the OOM.\n\n[ci skip]\n\nSigned-off-by: Graham Chapman <graham_chapman@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NzkyOTcy", "url": "https://github.com/eclipse-openj9/openj9/pull/10743#pullrequestreview-498792972", "createdAt": "2020-09-29T19:06:14Z", "commit": {"oid": "657d24fae2ba8adc2425c06afaf4c38da1e26449"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTowNjoxNFrOHZ8xfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOToxMDowMFrOHZ85Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk3MjE1OQ==", "bodyText": "Is it better to throw an empty IAE here than the NativeOOM?", "url": "https://github.com/eclipse-openj9/openj9/pull/10743#discussion_r496972159", "createdAt": "2020-09-29T19:06:14Z", "author": {"login": "DanHeidinga"}, "path": "runtime/codert_vm/cnathelp.cpp", "diffHunk": "@@ -3013,7 +3013,9 @@ old_slow_jitNewInstanceImplAccessCheck(J9VMThread *currentThread)\n \t\t\t\tJ9UTF8_LENGTH(nameUTF),\n \t\t\t\tJ9UTF8_DATA(sigUTF),\n \t\t\t\tJ9UTF8_LENGTH(sigUTF));\n-\t\tsetCurrentExceptionFromJIT(currentThread, J9VMCONSTANTPOOL_JAVALANGILLEGALACCESSEXCEPTION, detailMessage);\n+\t\tif (NULL != detailMessage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "657d24fae2ba8adc2425c06afaf4c38da1e26449"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk3NDE1OQ==", "bodyText": "We're in the VM here.  Can we directly call setNativeOOM??\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tvmThread->javaVM->internalVMFunctions->setNativeOutOfMemoryError(vmThread, 0, 0);\n          \n          \n            \n            \t\tsetNativeOutOfMemoryError(vmThread, 0, 0);", "url": "https://github.com/eclipse-openj9/openj9/pull/10743#discussion_r496974159", "createdAt": "2020-09-29T19:10:00Z", "author": {"login": "DanHeidinga"}, "path": "runtime/vm/stringhelpers.cpp", "diffHunk": "@@ -498,7 +498,9 @@ catUtfToString4(J9VMThread * vmThread, const U_8 *data1, UDATA length1, const U_\n \tj9object_t result = NULL;\n \tUDATA totalLength = length1 + length2 + length3 + length4;\n \tU_8 *buffer = (U_8*)j9mem_allocate_memory(totalLength, OMRMEM_CATEGORY_VM);\n-\tif (NULL != buffer) {\n+\tif (NULL == buffer) {\n+\t\tvmThread->javaVM->internalVMFunctions->setNativeOutOfMemoryError(vmThread, 0, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "657d24fae2ba8adc2425c06afaf4c38da1e26449"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODIyMTk0", "url": "https://github.com/eclipse-openj9/openj9/pull/10743#pullrequestreview-498822194", "createdAt": "2020-09-29T19:42:40Z", "commit": {"oid": "657d24fae2ba8adc2425c06afaf4c38da1e26449"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 342, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}