{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNjY3ODYx", "number": 10069, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODowNTo1OFrOELAXhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODowNTo1OFrOELAXhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTc1ODEyOnYy", "diffSide": "RIGHT", "path": "runtime/oti/j9consts.h", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODowNTo1OFrOGsYNSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxODoyOTozN1rOGsY5Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4NzE0NQ==", "bodyText": "why the renumbering and why is 0x39 reserved?", "url": "https://github.com/eclipse-openj9/openj9/pull/10069#discussion_r449187145", "createdAt": "2020-07-02T18:05:58Z", "author": {"login": "DanHeidinga"}, "path": "runtime/oti/j9consts.h", "diffHunk": "@@ -732,15 +732,16 @@ extern \"C\" {\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_GC_FINISH\t\t\t\t\t\t\t0x36\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_OBJECT_FREE\t\t\t\t\t\t\t0x37\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_VM_OBJECT_ALLOC\t\t\t\t\t\t0x38\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_COMPILING_START\t\t\t\t\t0x39\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_COMPILING_END\t\t\t\t\t\t0x3A\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_INSTRUMENTABLE_OBJECT_ALLOC\t\t0x3B\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_VM_DUMP_START\t\t\t\t\t\t0x3C\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_VM_DUMP_END\t\t\t\t\t\t0x3D\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_GC_CYCLE_START\t\t\t\t\t0x3E\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_GC_CYCLE_FINISH\t\t\t\t\t0x3F\n-#define J9_JNI_OFFLOAD_SWITCH_TRACE_SUBSCRIBER_THREAD\t\t\t\t\t0x40\n-#define J9_JNI_OFFLOAD_SWITCH_JVMTI_SAMPLED_OBJECT_ALLOC\t\t\t\t0x41\n+/* 0x39 Reserved for JVMTI event */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d7bd9b8cf0d2b3e28edb9b163c782875e98d849"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE5ODQwNg==", "bodyText": "why the renumbering and why is 0x39 reserved?\n\nThere are two kind of JVMTI events, one is from the JVMTI spec and defined at https://github.com/eclipse/openj9/blob/00bc8b44faf3cd10181871f3d43f98f94b41c7e9/runtime/include/jvmti.h.m4#L738-L741\nthe other is OpenJ9 specific JVMTI event and defined at https://github.com/eclipse/openj9/blob/00bc8b44faf3cd10181871f3d43f98f94b41c7e9/runtime/oti/jvmtiInternal.h#L36-L48\nThe OpenJ9 internal ones always start from J9JVMTI_HIGHEST_EVENT and are larger than all JVMTI spec event defines.\njavaOffloadSwitchOn() & javaOffloadSwitchOff() use eventNumber - J9JVMTI_LOWEST_EVENT to determine the reason code.\nhttps://github.com/eclipse/openj9/blob/00bc8b44faf3cd10181871f3d43f98f94b41c7e9/runtime/jvmti/jvmtiHelpers.c#L631-L632\nHence this new JDK11 J9_JNI_OFFLOAD_SWITCH_JVMTI_SAMPLED_OBJECT_ALLOC has to match its event define within jvmti.h like its friends such as https://github.com/eclipse/openj9/blob/d9f3cf63cf21cae1e2cc3bf7e02e0a5281989e9a/runtime/oti/j9consts.h#L721-L730 i.e., it need to be inserted between previous JDK 8 and OpenJ9 specific defines.", "url": "https://github.com/eclipse-openj9/openj9/pull/10069#discussion_r449198406", "createdAt": "2020-07-02T18:29:37Z", "author": {"login": "JasonFengJ9"}, "path": "runtime/oti/j9consts.h", "diffHunk": "@@ -732,15 +732,16 @@ extern \"C\" {\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_GC_FINISH\t\t\t\t\t\t\t0x36\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_OBJECT_FREE\t\t\t\t\t\t\t0x37\n #define J9_JNI_OFFLOAD_SWITCH_JVMTI_VM_OBJECT_ALLOC\t\t\t\t\t\t0x38\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_COMPILING_START\t\t\t\t\t0x39\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_COMPILING_END\t\t\t\t\t\t0x3A\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_INSTRUMENTABLE_OBJECT_ALLOC\t\t0x3B\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_VM_DUMP_START\t\t\t\t\t\t0x3C\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_VM_DUMP_END\t\t\t\t\t\t0x3D\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_GC_CYCLE_START\t\t\t\t\t0x3E\n-#define J9_JNI_OFFLOAD_SWITCH_J9JVMTI_GC_CYCLE_FINISH\t\t\t\t\t0x3F\n-#define J9_JNI_OFFLOAD_SWITCH_TRACE_SUBSCRIBER_THREAD\t\t\t\t\t0x40\n-#define J9_JNI_OFFLOAD_SWITCH_JVMTI_SAMPLED_OBJECT_ALLOC\t\t\t\t0x41\n+/* 0x39 Reserved for JVMTI event */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4NzE0NQ=="}, "originalCommit": {"oid": "6d7bd9b8cf0d2b3e28edb9b163c782875e98d849"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4899, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}