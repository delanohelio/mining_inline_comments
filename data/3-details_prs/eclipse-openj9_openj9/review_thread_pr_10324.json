{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyODU4NzAw", "number": 10324, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxMDoyNlrOEVEbwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxNzoxMFrOEVEnGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTI4MTkzOnYy", "diffSide": "RIGHT", "path": "runtime/jcl/common/jcldefine.c", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxMDoyNlrOG7ndAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzowNDo0OVrOG7pgAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NTU2OQ==", "bodyText": "This would read better as an assignment of the constant bit and an if to OR in the second bit.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465165569", "createdAt": "2020-08-04T16:10:26Z", "author": {"login": "gacholio"}, "path": "runtime/jcl/common/jcldefine.c", "diffHunk": "@@ -95,14 +95,15 @@ defineClassCommon(JNIEnv *env, jobject classLoaderObject,\n \t/* Allocate and initialize a UTF8 copy of the Unicode class-name */\n \tif (NULL != className) {\n \t\tj9object_t classNameObject = J9_JNI_UNWRAP_REFERENCE(className);\n-\t\tutf8Name = (U_8*)vmFuncs->copyStringToUTF8WithMemAlloc(currentThread, classNameObject, J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT, \"\", 0, utf8NameStackBuffer, J9VM_PACKAGE_NAME_BUFFER_LENGTH, &utf8Length);\n+\t\tUDATA stringFlags = (validateName ? J9_STR_NULL_TERMINATE_RESULT : (J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5OTEwNg==", "bodyText": "Updated the code against the suggestion above.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465199106", "createdAt": "2020-08-04T17:04:49Z", "author": {"login": "ChengJin01"}, "path": "runtime/jcl/common/jcldefine.c", "diffHunk": "@@ -95,14 +95,15 @@ defineClassCommon(JNIEnv *env, jobject classLoaderObject,\n \t/* Allocate and initialize a UTF8 copy of the Unicode class-name */\n \tif (NULL != className) {\n \t\tj9object_t classNameObject = J9_JNI_UNWRAP_REFERENCE(className);\n-\t\tutf8Name = (U_8*)vmFuncs->copyStringToUTF8WithMemAlloc(currentThread, classNameObject, J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT, \"\", 0, utf8NameStackBuffer, J9VM_PACKAGE_NAME_BUFFER_LENGTH, &utf8Length);\n+\t\tUDATA stringFlags = (validateName ? J9_STR_NULL_TERMINATE_RESULT : (J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NTU2OQ=="}, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTI4OTYxOnYy", "diffSide": "RIGHT", "path": "runtime/vm/classsupport.c", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxMjoxMVrOG7nhrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzowNDo1N1rOG7pgZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2Njc2Ng==", "bodyText": "Same comment as above - assignment and if.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465166766", "createdAt": "2020-08-04T16:12:11Z", "author": {"login": "gacholio"}, "path": "runtime/vm/classsupport.c", "diffHunk": "@@ -307,11 +307,19 @@ internalFindClassString(J9VMThread* currentThread, j9object_t moduleName, j9obje\n \t\tchar localBuf[J9VM_PACKAGE_NAME_BUFFER_LENGTH];\n \t\tchar *utf8Name = NULL;\n \t\tUDATA utf8Length = 0;\n+\t\tUDATA stringFlags = ((CLASSNAME_INVALID != allowedBitsForClassName) ? J9_STR_NULL_TERMINATE_RESULT : (J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5OTIwNw==", "bodyText": "Updated the code against the suggestion above.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465199207", "createdAt": "2020-08-04T17:04:57Z", "author": {"login": "ChengJin01"}, "path": "runtime/vm/classsupport.c", "diffHunk": "@@ -307,11 +307,19 @@ internalFindClassString(J9VMThread* currentThread, j9object_t moduleName, j9obje\n \t\tchar localBuf[J9VM_PACKAGE_NAME_BUFFER_LENGTH];\n \t\tchar *utf8Name = NULL;\n \t\tUDATA utf8Length = 0;\n+\t\tUDATA stringFlags = ((CLASSNAME_INVALID != allowedBitsForClassName) ? J9_STR_NULL_TERMINATE_RESULT : (J9_STR_NULL_TERMINATE_RESULT | J9_STR_XLAT));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2Njc2Ng=="}, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTI5NTY1OnYy", "diffSide": "RIGHT", "path": "runtime/vm/classsupport.c", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxMzozOFrOG7nlYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzowNjoxNFrOG7pjdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NzcxMw==", "bodyText": "For consistency with the other code, please declare this as U_8 * and cast it on the assignment, rather than casting the uses.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465167713", "createdAt": "2020-08-04T16:13:38Z", "author": {"login": "gacholio"}, "path": "runtime/vm/classsupport.c", "diffHunk": "@@ -307,11 +307,19 @@ internalFindClassString(J9VMThread* currentThread, j9object_t moduleName, j9obje\n \t\tchar localBuf[J9VM_PACKAGE_NAME_BUFFER_LENGTH];\n \t\tchar *utf8Name = NULL;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE5OTk4OA==", "bodyText": "Updated the code involved against the suggestion above.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465199988", "createdAt": "2020-08-04T17:06:14Z", "author": {"login": "ChengJin01"}, "path": "runtime/vm/classsupport.c", "diffHunk": "@@ -307,11 +307,19 @@ internalFindClassString(J9VMThread* currentThread, j9object_t moduleName, j9obje\n \t\tchar localBuf[J9VM_PACKAGE_NAME_BUFFER_LENGTH];\n \t\tchar *utf8Name = NULL;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2NzcxMw=="}, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTMwODIzOnYy", "diffSide": "RIGHT", "path": "runtime/vm/stringhelpers.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxNjoyNlrOG7ntAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzowNjozMFrOG7pkBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2OTY2Ng==", "bodyText": "This comment seems out of date - the bcv function has no interaction with this code.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465169666", "createdAt": "2020-08-04T16:16:26Z", "author": {"login": "gacholio"}, "path": "runtime/vm/stringhelpers.cpp", "diffHunk": "@@ -445,14 +434,10 @@ verifyQualifiedName(J9VMThread *vmThread, j9object_t string, UDATA allowedBitsFo\n \t}\n \n \t/* map the return code against the arity value from checkNameImpl (called by bcvCheckClassName):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIwMDEzMg==", "bodyText": "Removed the outdated comments.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465200132", "createdAt": "2020-08-04T17:06:30Z", "author": {"login": "ChengJin01"}, "path": "runtime/vm/stringhelpers.cpp", "diffHunk": "@@ -445,14 +434,10 @@ verifyQualifiedName(J9VMThread *vmThread, j9object_t string, UDATA allowedBitsFo\n \t}\n \n \t/* map the return code against the arity value from checkNameImpl (called by bcvCheckClassName):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE2OTY2Ng=="}, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTMxMDk3OnYy", "diffSide": "RIGHT", "path": "runtime/vm/stringhelpers.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjoxNzoxMFrOG7nuwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNzowNjo1M1rOG7plCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3MDExMg==", "bodyText": "Please don't include the constant values in the comments.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465170112", "createdAt": "2020-08-04T16:17:10Z", "author": {"login": "gacholio"}, "path": "runtime/vm/stringhelpers.cpp", "diffHunk": "@@ -445,14 +434,10 @@ verifyQualifiedName(J9VMThread *vmThread, j9object_t string, UDATA allowedBitsFo\n \t}\n \n \t/* map the return code against the arity value from checkNameImpl (called by bcvCheckClassName):\n-\t * 1) if arity = -1, then rc = CLASSNAME_INVALID(0)\n-\t * 2) if arity = 0,  then rc = CLASSNAME_VALID_NON_ARRARY(1)\n-\t * 3) if arity > 0,  then rc = CLASSNAME_VALID_ARRARY(2)\n+\t * 1) if arity = 0,  then rc = CLASSNAME_VALID_NON_ARRARY(1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIwMDM5Mg==", "bodyText": "Remove these constant values and modified the comments.", "url": "https://github.com/eclipse-openj9/openj9/pull/10324#discussion_r465200392", "createdAt": "2020-08-04T17:06:53Z", "author": {"login": "ChengJin01"}, "path": "runtime/vm/stringhelpers.cpp", "diffHunk": "@@ -445,14 +434,10 @@ verifyQualifiedName(J9VMThread *vmThread, j9object_t string, UDATA allowedBitsFo\n \t}\n \n \t/* map the return code against the arity value from checkNameImpl (called by bcvCheckClassName):\n-\t * 1) if arity = -1, then rc = CLASSNAME_INVALID(0)\n-\t * 2) if arity = 0,  then rc = CLASSNAME_VALID_NON_ARRARY(1)\n-\t * 3) if arity > 0,  then rc = CLASSNAME_VALID_ARRARY(2)\n+\t * 1) if arity = 0,  then rc = CLASSNAME_VALID_NON_ARRARY(1)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE3MDExMg=="}, "originalCommit": {"oid": "3b84ca8efdd45dd6795748fc3393ea69ff623d3c"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4860, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}