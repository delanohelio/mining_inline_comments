{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NjUyMDcw", "number": 9984, "title": "Properly handle runtime assumptions in S390J9CallDataSnippet", "bodyText": "This commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\nSigned-off-by: Dhruv Chopra Dhruv.C.Chopra@ibm.com", "createdAt": "2020-06-23T15:34:06Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9984", "merged": true, "mergeCommit": {"oid": "be1e5c825fb8b8eaa4919de47605a28de2f695e3"}, "closed": true, "closedAt": "2020-06-24T17:47:50Z", "author": {"login": "dchopra001"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuIBXkAFqTQzNTk1MjQxMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuc3XigFqTQzNjgyNTM3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1OTUyNDEw", "url": "https://github.com/eclipse-openj9/openj9/pull/9984#pullrequestreview-435952410", "createdAt": "2020-06-23T16:27:08Z", "commit": {"oid": "4d846d1f11859c3b0bbea25b928daeec433ef39f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNjoyNzowOFrOGnxJew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNjoyNzowOFrOGnxJew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1Mjg5MQ==", "bodyText": "Is cg()->getCodeStart() the beginning of the code cache (thus including all of the prologue, pre-prologue and code cache header?\nOn x86 we use self()->getBinaryBufferStart()", "url": "https://github.com/eclipse-openj9/openj9/pull/9984#discussion_r444352891", "createdAt": "2020-06-23T16:27:08Z", "author": {"login": "mpirvu"}, "path": "runtime/compiler/z/codegen/S390J9CallSnippet.cpp", "diffHunk": "@@ -1460,7 +1460,18 @@ TR::S390JNICallDataSnippet::emitSnippetBody()\n       // _targetAddress/function pointer of native method\n       *(intptr_t *) cursor = (intptr_t) _targetAddress;\n       TR_OpaqueMethodBlock *method = getNode()->getSymbol()->castToResolvedMethodSymbol()->getResolvedMethod()->getPersistentIdentifier();\n-      TR_PatchJNICallSite::make(cg()->fe(), cg()->trPersistentMemory(), (uintptr_t) method, cursor, comp->getMetadataAssumptionList());\n+\n+      if (comp->isOutOfProcessCompilation())\n+         {\n+         // For JITServer we need to build a list of assumptions that will be sent to client at end of compilation\n+         intptr_t offset = cursor - cg()->getCodeStart();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d846d1f11859c3b0bbea25b928daeec433ef39f"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d846d1f11859c3b0bbea25b928daeec433ef39f", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/4d846d1f11859c3b0bbea25b928daeec433ef39f", "committedDate": "2020-06-23T15:16:29Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}, "afterCommit": {"oid": "dbfa57d4d21a59c69cc393e0bdce39f495ccb043", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/dbfa57d4d21a59c69cc393e0bdce39f495ccb043", "committedDate": "2020-06-23T17:40:11Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbfa57d4d21a59c69cc393e0bdce39f495ccb043", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/dbfa57d4d21a59c69cc393e0bdce39f495ccb043", "committedDate": "2020-06-23T17:40:11Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}, "afterCommit": {"oid": "ffd80c7357d47b46c4219c76af0d6215754a6a86", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/ffd80c7357d47b46c4219c76af0d6215754a6a86", "committedDate": "2020-06-23T17:43:34Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MDIwMTQ1", "url": "https://github.com/eclipse-openj9/openj9/pull/9984#pullrequestreview-436020145", "createdAt": "2020-06-23T17:51:26Z", "commit": {"oid": "ffd80c7357d47b46c4219c76af0d6215754a6a86"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ffd80c7357d47b46c4219c76af0d6215754a6a86", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/ffd80c7357d47b46c4219c76af0d6215754a6a86", "committedDate": "2020-06-23T17:43:34Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}, "afterCommit": {"oid": "03f0a30f7db8a3a3f419e7efa04b98b4905e524d", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/03f0a30f7db8a3a3f419e7efa04b98b4905e524d", "committedDate": "2020-06-24T16:00:22Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cec3a059f9128c53da4765a0bc8f26d9a0ff6887", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/cec3a059f9128c53da4765a0bc8f26d9a0ff6887", "committedDate": "2020-06-24T16:04:46Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03f0a30f7db8a3a3f419e7efa04b98b4905e524d", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/03f0a30f7db8a3a3f419e7efa04b98b4905e524d", "committedDate": "2020-06-24T16:00:22Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}, "afterCommit": {"oid": "cec3a059f9128c53da4765a0bc8f26d9a0ff6887", "author": {"user": {"login": "dchopra001", "name": "Dhruv Chopra"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/cec3a059f9128c53da4765a0bc8f26d9a0ff6887", "committedDate": "2020-06-24T16:04:46Z", "message": "Properly handle runtime assumptions in S390J9CallDataSnippet\n\nThis commit will now build runtime assumptions and send them to the client\ninstead storing them locally when doing a JITServer compilation.\n\nSigned-off-by: Dhruv Chopra <Dhruv.C.Chopra@ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2ODI1Mzcz", "url": "https://github.com/eclipse-openj9/openj9/pull/9984#pullrequestreview-436825373", "createdAt": "2020-06-24T16:44:25Z", "commit": {"oid": "cec3a059f9128c53da4765a0bc8f26d9a0ff6887"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 585, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}