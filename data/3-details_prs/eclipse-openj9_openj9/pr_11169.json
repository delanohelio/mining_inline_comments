{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMTI2Njcz", "number": 11169, "title": "Centralize opcode enum", "bodyText": "This PR is a series of commits which builds on the work performed within OMR to centralized the opcode enum into a macro generated version which is able to generate the various tables used within the project. Each commit explains what exactly it does. The net effect of this PR is that we will avoid having to break the OpenJ9 build whenever OMR modifies it's list of opcodes, which is a frequent occurrence judging by past changes.\nThere are a few more steps which have to be performed, such as centralizing the VP handlers properly and eliminating the need for TreeEvaluatorTable.hpp within OpenJ9. These changes will be performed once this initial setup has been merged.\nThis PR needs to be merged concurrently with eclipse/omr#5670.", "createdAt": "2020-11-12T20:04:35Z", "url": "https://github.com/eclipse-openj9/openj9/pull/11169", "merged": true, "mergeCommit": {"oid": "1c3056d2c8087c23fcd9faa9f725b709980add05"}, "closed": true, "closedAt": "2020-11-20T21:14:35Z", "author": {"login": "fjeremic"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdb1y9MgH2gAyNTIwMTI2NjczOjNlZjg3N2NjNTM3N2YwNDU0ZmMxZjllM2FmMWM5MGMwZWM5MDI5YzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdedkNxAFqTUzNTc2MjIwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3ef877cc5377f0454fc1f9e3af1c90c0ec9029c1", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/3ef877cc5377f0454fc1f9e3af1c90c0ec9029c1", "committedDate": "2020-11-12T17:13:49Z", "message": "Centralize the opcode enum into Opcodes.enum\n\nTransmutes the ILOpCodeProperties.hpp file into Opcodes.enum which holds\nthe exact same information presented in a macro format. The new\n`OPCODE_MACRO` has just one additional field which is a commented out\ndescription which was pulled from J9ILOpCodesEnum.hpp.\n\nThis new Opcodes.enum file is the concrete enum file which gets included\ninto various places that generate tables based on opcodes. It will\nautomatically get pulled into OMR when building up the various tables\nsuch that no extra boilerplate needs to be done within OpenJ9.\n\nThis will avoid future build breaks whenever we need to modify the\nopcode tables between the two projects (OpenJ9 and OMR).\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fba26362ab318def894963b90a2eadca120993f9", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/fba26362ab318def894963b90a2eadca120993f9", "committedDate": "2020-11-12T17:18:08Z", "message": "Extend the simplifier tables in OpenJ9 using the centralized opcode enum\n\nFollow the same pattern as within OMR and extend the simplifier table\nusing the now centralized auto-generated tables.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da874c30ca3de391bbcd1a6cea6db86bf84e0bd8", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/da874c30ca3de391bbcd1a6cea6db86bf84e0bd8", "committedDate": "2020-11-12T17:19:34Z", "message": "Centralize the AMD64 TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d54a50e0417e51d807f2e68d48b4c67db7ceb024", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d54a50e0417e51d807f2e68d48b4c67db7ceb024", "committedDate": "2020-11-12T19:43:04Z", "message": "Centralize the AArch64 TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "025b36121335216d05b29933c90f58cc7901dae0", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/025b36121335216d05b29933c90f58cc7901dae0", "committedDate": "2020-11-12T19:43:30Z", "message": "Centralize the ARM TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7979f20efeaa6cc64cd4f482b7fa7c5d570e3e61", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/7979f20efeaa6cc64cd4f482b7fa7c5d570e3e61", "committedDate": "2020-11-12T19:43:51Z", "message": "Centralize the Power TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef64719db5dafafd2dc447906f70c77120a685cf", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/ef64719db5dafafd2dc447906f70c77120a685cf", "committedDate": "2020-11-12T19:44:05Z", "message": "Centralize the Z TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b5819b29cbe47761b55c6d20243e02450240c19", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/9b5819b29cbe47761b55c6d20243e02450240c19", "committedDate": "2020-11-12T19:44:26Z", "message": "Centralize the Intel TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47a5e7adebdb1dfa2ccab702268808b44444646c", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/47a5e7adebdb1dfa2ccab702268808b44444646c", "committedDate": "2020-11-12T19:45:02Z", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}, "afterCommit": {"oid": "d53776b39faa0a176adcd424149d3ab0cfe18fb7", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d53776b39faa0a176adcd424149d3ab0cfe18fb7", "committedDate": "2020-11-12T20:06:34Z", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NDU5MDgz", "url": "https://github.com/eclipse-openj9/openj9/pull/11169#pullrequestreview-529459083", "createdAt": "2020-11-12T20:12:48Z", "commit": {"oid": "d53776b39faa0a176adcd424149d3ab0cfe18fb7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMDoxMjo0OFrOHyMSEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMDoxMjo0OFrOHyMSEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM5MjA4Mw==", "bodyText": "Whoooooops. This is a mistake. Going to take this out now.", "url": "https://github.com/eclipse-openj9/openj9/pull/11169#discussion_r522392083", "createdAt": "2020-11-12T20:12:48Z", "author": {"login": "fjeremic"}, "path": "runtime/cmake/platform/toolcfg/gnu.cmake", "diffHunk": "@@ -20,7 +20,7 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n-list(APPEND OMR_PLATFORM_COMPILE_OPTIONS -O3 -g -fstack-protector)\n+list(APPEND OMR_PLATFORM_COMPILE_OPTIONS -O0 -g -fstack-protector)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d53776b39faa0a176adcd424149d3ab0cfe18fb7"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85a509ca734a731a62ea2896c9149444ed554497", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/85a509ca734a731a62ea2896c9149444ed554497", "committedDate": "2020-11-12T20:14:20Z", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d53776b39faa0a176adcd424149d3ab0cfe18fb7", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d53776b39faa0a176adcd424149d3ab0cfe18fb7", "committedDate": "2020-11-12T20:06:34Z", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}, "afterCommit": {"oid": "85a509ca734a731a62ea2896c9149444ed554497", "author": {"user": {"login": "fjeremic", "name": "Filip Jeremic"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/85a509ca734a731a62ea2896c9149444ed554497", "committedDate": "2020-11-12T20:14:20Z", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NzYyMjA3", "url": "https://github.com/eclipse-openj9/openj9/pull/11169#pullrequestreview-535762207", "createdAt": "2020-11-20T20:41:46Z", "commit": {"oid": "85a509ca734a731a62ea2896c9149444ed554497"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1558, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}