{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzNjE5MTM2", "number": 10714, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTo0NjowMVrOExQxPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDozOToxMFrOEz0lQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDkwNDI4OnYy", "diffSide": "RIGHT", "path": "runtime/gc_base/IndexableObjectAllocationModel.cpp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTo0NjowMVrOHnThow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNTo0NjowMVrOHnThow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDk3NjQxOQ==", "bodyText": "spelling: preferred", "url": "https://github.com/eclipse-openj9/openj9/pull/10714#discussion_r510976419", "createdAt": "2020-10-23T15:46:01Z", "author": {"login": "amicic"}, "path": "runtime/gc_base/IndexableObjectAllocationModel.cpp", "diffHunk": "@@ -305,12 +305,12 @@ MM_IndexableObjectAllocationModel::layoutDiscontiguousArraylet(MM_EnvironmentBas\n }\n \n #if defined(J9VM_GC_ENABLE_DOUBLE_MAP)\n-#if !(defined(LINUX) && defined(J9VM_ENV_DATA64))\n+#if !((defined(LINUX) || defined(OSX)) && defined(J9VM_ENV_DATA64))\n /* Double map is only supported on LINUX 64 bit Systems for now */\n #error \"Platform not supported by Double Map API\"\n-#endif /* !(defined(LINUX) && defined(J9VM_ENV_DATA64)) */\n+#endif /* !((defined(LINUX) || defined(OSX)) && defined(J9VM_ENV_DATA64)) */\n void * \n-MM_IndexableObjectAllocationModel::doubleMapArraylets(MM_EnvironmentBase *env, J9Object *objectPtr) \n+MM_IndexableObjectAllocationModel::doubleMapArraylets(MM_EnvironmentBase *env, J9Object *objectPtr, void *preferedAddress)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95e6075546b06f53d3dcf1b57b0c7b308cff383"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzc0MzM2OnYy", "diffSide": "RIGHT", "path": "runtime/oti/j9port_generated.h", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDozOToxMFrOHrR99Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNjo1Mzo1MlrOHrXqmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0NTIwNQ==", "bodyText": "Minor rant.... This mapping is probably unnecessary, since at the call site we could create OMR PortLib instance and call OMR API directly .\nWe already have many instances in OpenJ9 code that we do such things (use directly OMR API of different sorts), but we also have already pre-existing OpenJ9-to-OMR mapping in this file.\nI don't know what's a preferred way with newly introduced APIs. I prefer simplicity (and avoid this mapping). @pshipton @DanHeidinga, opinion?", "url": "https://github.com/eclipse-openj9/openj9/pull/10714#discussion_r515145205", "createdAt": "2020-10-30T14:39:10Z", "author": {"login": "amicic"}, "path": "runtime/oti/j9port_generated.h", "diffHunk": "@@ -582,6 +582,7 @@ extern J9_CFUNC int32_t j9port_isCompatible(struct J9PortLibraryVersion *expecte\n #define j9vmem_commit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_commit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_decommit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_decommit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_free_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_free_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n+#define j9vmem_release_double_mapped_region(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_release_double_mapped_region(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1caf1aaf622cc771f79cd4da656c78acd14b6262"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2NDY4Mw==", "bodyText": "I prefer for new code to use omr directly rather than using a mapping. I believe the mappings were introduced just to avoid changing a lot of code. In the future we may want to remove them.", "url": "https://github.com/eclipse-openj9/openj9/pull/10714#discussion_r515164683", "createdAt": "2020-10-30T15:03:47Z", "author": {"login": "pshipton"}, "path": "runtime/oti/j9port_generated.h", "diffHunk": "@@ -582,6 +582,7 @@ extern J9_CFUNC int32_t j9port_isCompatible(struct J9PortLibraryVersion *expecte\n #define j9vmem_commit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_commit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_decommit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_decommit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_free_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_free_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n+#define j9vmem_release_double_mapped_region(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_release_double_mapped_region(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0NTIwNQ=="}, "originalCommit": {"oid": "1caf1aaf622cc771f79cd4da656c78acd14b6262"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE4OTA5OQ==", "bodyText": "I agree with Peter.  Let's avoid introducing new mappings and use OMR directly when it makes sense", "url": "https://github.com/eclipse-openj9/openj9/pull/10714#discussion_r515189099", "createdAt": "2020-10-30T15:36:16Z", "author": {"login": "DanHeidinga"}, "path": "runtime/oti/j9port_generated.h", "diffHunk": "@@ -582,6 +582,7 @@ extern J9_CFUNC int32_t j9port_isCompatible(struct J9PortLibraryVersion *expecte\n #define j9vmem_commit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_commit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_decommit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_decommit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_free_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_free_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n+#define j9vmem_release_double_mapped_region(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_release_double_mapped_region(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0NTIwNQ=="}, "originalCommit": {"oid": "1caf1aaf622cc771f79cd4da656c78acd14b6262"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzODU1NQ==", "bodyText": "Updated vmem_release_double_mapped_region calls to use OMR API.", "url": "https://github.com/eclipse-openj9/openj9/pull/10714#discussion_r515238555", "createdAt": "2020-10-30T16:53:52Z", "author": {"login": "bragaigor"}, "path": "runtime/oti/j9port_generated.h", "diffHunk": "@@ -582,6 +582,7 @@ extern J9_CFUNC int32_t j9port_isCompatible(struct J9PortLibraryVersion *expecte\n #define j9vmem_commit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_commit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_decommit_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_decommit_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n #define j9vmem_free_memory(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_free_memory(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)\n+#define j9vmem_release_double_mapped_region(param1,param2,param3) OMRPORT_FROM_J9PORT(privatePortLibrary)->vmem_release_double_mapped_region(OMRPORT_FROM_J9PORT(privatePortLibrary),param1,param2,param3)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE0NTIwNQ=="}, "originalCommit": {"oid": "1caf1aaf622cc771f79cd4da656c78acd14b6262"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1247, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}