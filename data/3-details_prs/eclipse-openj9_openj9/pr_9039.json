{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MzI2MTQx", "number": 9039, "title": "Clarify contract of findROMClassFromPC() method", "bodyText": "Discovered thru a painful debug session that this API will\nalways return the vm->systemClassLoader for any ROMClass\nfound in the SharedClasses cache.  This is regardless of\nwhich classloader actually loaded the class.\nSigned-off-by: Dan Heidinga daniel_heidinga@ca.ibm.com", "createdAt": "2020-03-31T13:13:00Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9039", "merged": true, "mergeCommit": {"oid": "03878bd7572ca9204376b235cf2a1b2c153e2737"}, "closed": true, "closedAt": "2020-03-31T17:01:02Z", "author": {"login": "DanHeidinga"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS0hILAH2gAyMzk2MzI2MTQxOjJjNWI2MzcxZmIwMDg4MmYxMmE4OTY0MGU4N2ZkMjljYzUyODg0MjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTFTf8AFqTM4NDg4MTA1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2c5b6371fb00882f12a89640e87fd29cc5288422", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2c5b6371fb00882f12a89640e87fd29cc5288422", "committedDate": "2020-03-30T20:27:58Z", "message": "Clarify contract of findROMClassFromPC() method\n\nDiscovered thru a painful debug session that this API will\nalways return the vm->systemClassLoader for any ROMClass\nfound in the SharedClasses cache.  This is regardless of\nwhich classloader actually loaded the class.\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feefd3cff894e0c11bb004d02a5d81beb65bb93e", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/feefd3cff894e0c11bb004d02a5d81beb65bb93e", "committedDate": "2020-03-30T20:31:41Z", "message": "Fetch mutex into a local to avoid repeated fetch\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3004583de55fab81740d09aa54e13212daee9221", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/3004583de55fab81740d09aa54e13212daee9221", "committedDate": "2020-03-31T13:18:16Z", "message": "Update copyrights\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODQxNDQw", "url": "https://github.com/eclipse-openj9/openj9/pull/9039#pullrequestreview-384841440", "createdAt": "2020-03-31T15:19:28Z", "commit": {"oid": "3004583de55fab81740d09aa54e13212daee9221"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxOToyOFrOF-bCIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxOToyOFrOF-bCIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk5ODk0NA==", "bodyText": "May as well assign this in the declaration - if THR_PREEMPTIVE is off (which it never is), the code would fail to compile because of an unused variable. Suggest getting rid of the ifdefs while you're here.", "url": "https://github.com/eclipse-openj9/openj9/pull/9039#discussion_r400998944", "createdAt": "2020-03-31T15:19:28Z", "author": {"login": "gacholio"}, "path": "runtime/vm/classseg.c", "diffHunk": "@@ -108,10 +107,12 @@ allocateClassMemorySegment(J9JavaVM *javaVM, UDATA requiredSize, UDATA segmentTy\n {\n \tUDATA appropriateSize = 0;\n \tJ9MemorySegment *memorySegment = NULL;\n+\tomrthread_monitor_t segmentMutex = NULL;\n \t\n #if defined(J9VM_THR_PREEMPTIVE)\n-\tif (javaVM->classMemorySegments->segmentMutex) {\n-\t\tomrthread_monitor_enter(javaVM->classMemorySegments->segmentMutex);\n+\tsegmentMutex = javaVM->classMemorySegments->segmentMutex;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3004583de55fab81740d09aa54e13212daee9221"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e88114167824b39200931b5699d1f5876f8595e5", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e88114167824b39200931b5699d1f5876f8595e5", "committedDate": "2020-03-31T15:58:02Z", "message": "Remove always true J9VM_THR_PREEMPTIVE flag\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODgxMDUw", "url": "https://github.com/eclipse-openj9/openj9/pull/9039#pullrequestreview-384881050", "createdAt": "2020-03-31T16:01:28Z", "commit": {"oid": "e88114167824b39200931b5699d1f5876f8595e5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1364, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}