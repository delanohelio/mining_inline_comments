{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MzA3MTE2", "number": 8334, "title": "Avoids the concern about enqueue causing clear to be called", "bodyText": "new private method clearImpl for setting the referent to null.\nclearImpl() is called from clear() and enqueue()\n\nfix: #8322\nSigned-off-by: Lin Hu linhu@ca.ibm.com", "createdAt": "2020-01-17T20:29:05Z", "url": "https://github.com/eclipse-openj9/openj9/pull/8334", "merged": true, "mergeCommit": {"oid": "4e4b5147e90c6b6742358f391523a7df837a665a"}, "closed": true, "closedAt": "2020-01-22T06:32:46Z", "author": {"login": "LinHu2016"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7U6y9gFqTM0NDgyODYxNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8PToMAFqTM0NTQyOTA3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODI4NjE2", "url": "https://github.com/eclipse-openj9/openj9/pull/8334#pullrequestreview-344828616", "createdAt": "2020-01-17T20:38:41Z", "commit": {"oid": "29e792f446705e1bbc9be911370943425e1ffb91"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMDozODo0MlrOFfEqZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMDozODo0MlrOFfEqZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEyNjU2Nw==", "bodyText": "I believe this code should be moved to clearImpl() as well.  Otherwise, we could just null the field directly.\nNote, clearImpl() can be mad synchronized as its the method that needs to keep the referent and state consistent", "url": "https://github.com/eclipse-openj9/openj9/pull/8334#discussion_r368126567", "createdAt": "2020-01-17T20:38:42Z", "author": {"login": "DanHeidinga"}, "path": "jcl/src/java.base/share/classes/java/lang/ref/Reference.java", "diffHunk": "@@ -116,14 +116,21 @@ public boolean tryHandlePendingReference() {\n  */\t\n public void clear() {\n \tsynchronized(this) {\n-\t\treferent = null;\n+\t\tclearImpl();\n \t\t/* change the state to cleared if it's not already cleared or enqueued */\n \t\tif (STATE_INITIAL == state) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29e792f446705e1bbc9be911370943425e1ffb91"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c2270f92fad398bcd02b2d83cd18f065979ade6", "author": {"user": {"login": "LinHu2016", "name": "Lin Hu"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2c2270f92fad398bcd02b2d83cd18f065979ade6", "committedDate": "2020-01-20T15:52:14Z", "message": "Avoids the concern about enqueue causing clear to be called\n\n\tnew private method clearImpl for setting the referent to null.\n\tclearImpl() is called from clear() and enqueue()\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "29e792f446705e1bbc9be911370943425e1ffb91", "author": {"user": {"login": "LinHu2016", "name": "Lin Hu"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/29e792f446705e1bbc9be911370943425e1ffb91", "committedDate": "2020-01-17T20:26:39Z", "message": "Avoids the concern about enqueue causing clear to be called\n\n\tnew private method clearImpl for setting the referent to null.\n\tclearImpl() is called from clear() and enqueue()\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>"}, "afterCommit": {"oid": "2c2270f92fad398bcd02b2d83cd18f065979ade6", "author": {"user": {"login": "LinHu2016", "name": "Lin Hu"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/2c2270f92fad398bcd02b2d83cd18f065979ade6", "committedDate": "2020-01-20T15:52:14Z", "message": "Avoids the concern about enqueue causing clear to be called\n\n\tnew private method clearImpl for setting the referent to null.\n\tclearImpl() is called from clear() and enqueue()\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NDAzMDUw", "url": "https://github.com/eclipse-openj9/openj9/pull/8334#pullrequestreview-345403050", "createdAt": "2020-01-20T15:58:18Z", "commit": {"oid": "2c2270f92fad398bcd02b2d83cd18f065979ade6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NDI5MDc1", "url": "https://github.com/eclipse-openj9/openj9/pull/8334#pullrequestreview-345429075", "createdAt": "2020-01-20T16:40:24Z", "commit": {"oid": "2c2270f92fad398bcd02b2d83cd18f065979ade6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 881, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}