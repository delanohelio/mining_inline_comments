{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1NDM4NDEw", "number": 10578, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTowOFrOEjOAQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTowOFrOEjOAQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzY1MDU4OnYy", "diffSide": "RIGHT", "path": "runtime/compiler/env/ProcessorDetection.cpp", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTowOFrOHRdBlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjozNDowNFrOHRdWiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzM4Mw==", "bodyText": "So where are things initialized now? Is it in OMR?", "url": "https://github.com/eclipse-openj9/openj9/pull/10578#discussion_r488063383", "createdAt": "2020-09-14T16:25:08Z", "author": {"login": "fjeremic"}, "path": "runtime/compiler/env/ProcessorDetection.cpp", "diffHunk": "@@ -653,62 +653,12 @@ TR_J9VM::initializeProcessorType()\n    if (TR::Compiler->target.cpu.isZ())\n       {\n #if defined(TR_HOST_S390)\n-      initializeS390ProcessorFeatures();\n-\n #if defined(J9ZOS390)\n       // Cache whether current process is running in Supervisor State (i.e. Control Region of WAS).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73db8443e2b8331282a1658aec585d2bd0fac154"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2NjkwMw==", "bodyText": "Step 1. OMR detects and initializes the CPU using omr port library.\nvoid\nOMR::CompilerEnv::initializeHostEnvironment()\n   {\n\n   // Host processor bitness\n   //\n#ifdef TR_HOST_64BIT\n   host.setBitness(TR::bits_64);\n#elif TR_HOST_32BIT\n   host.setBitness(TR::bits_32);\n#else\n   host.setBitness(TR::bits_unknown);\n#endif\n\n   // Initialize the host CPU by querying the host processor\n   //\n   host.cpu = TR::CPU::detect(TR::Compiler->omrPortLib);\nStep 2. OpenJ9 calls J9::Z::CPU::applyUserOptions() to apply command line options from user and initialize the J9-specific features that couldn't be done in OMR.\nvoid\nTR_J9VM::initializeProcessorType()\n   {\n   TR_ASSERT(_compInfo,\"compInfo not defined\");\n   TR::Compiler->target.cpu.applyUserOptions();", "url": "https://github.com/eclipse-openj9/openj9/pull/10578#discussion_r488066903", "createdAt": "2020-09-14T16:30:52Z", "author": {"login": "harryyu1994"}, "path": "runtime/compiler/env/ProcessorDetection.cpp", "diffHunk": "@@ -653,62 +653,12 @@ TR_J9VM::initializeProcessorType()\n    if (TR::Compiler->target.cpu.isZ())\n       {\n #if defined(TR_HOST_S390)\n-      initializeS390ProcessorFeatures();\n-\n #if defined(J9ZOS390)\n       // Cache whether current process is running in Supervisor State (i.e. Control Region of WAS).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzM4Mw=="}, "originalCommit": {"oid": "73db8443e2b8331282a1658aec585d2bd0fac154"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2NzYwNQ==", "bodyText": "applyUserOptions() mirrors the things that were done in initializeS390ProcessorFeatures()", "url": "https://github.com/eclipse-openj9/openj9/pull/10578#discussion_r488067605", "createdAt": "2020-09-14T16:32:03Z", "author": {"login": "harryyu1994"}, "path": "runtime/compiler/env/ProcessorDetection.cpp", "diffHunk": "@@ -653,62 +653,12 @@ TR_J9VM::initializeProcessorType()\n    if (TR::Compiler->target.cpu.isZ())\n       {\n #if defined(TR_HOST_S390)\n-      initializeS390ProcessorFeatures();\n-\n #if defined(J9ZOS390)\n       // Cache whether current process is running in Supervisor State (i.e. Control Region of WAS).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzM4Mw=="}, "originalCommit": {"oid": "73db8443e2b8331282a1658aec585d2bd0fac154"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2ODc0NQ==", "bodyText": "Thanks for the explanation! Leaving this as unresolved for future reference. We'll wait until the OMR change has propagated.", "url": "https://github.com/eclipse-openj9/openj9/pull/10578#discussion_r488068745", "createdAt": "2020-09-14T16:34:04Z", "author": {"login": "fjeremic"}, "path": "runtime/compiler/env/ProcessorDetection.cpp", "diffHunk": "@@ -653,62 +653,12 @@ TR_J9VM::initializeProcessorType()\n    if (TR::Compiler->target.cpu.isZ())\n       {\n #if defined(TR_HOST_S390)\n-      initializeS390ProcessorFeatures();\n-\n #if defined(J9ZOS390)\n       // Cache whether current process is running in Supervisor State (i.e. Control Region of WAS).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzM4Mw=="}, "originalCommit": {"oid": "73db8443e2b8331282a1658aec585d2bd0fac154"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4601, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}