{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODA5Nzg0", "number": 9530, "title": "Implement basic support for POWER10 in the compiler", "bodyText": "This PR adds basic support for detecting POWER10 systems to the OpenJ9 JIT. At this time, POWER10 support in the compiler is gated behind an environment variable to prevent accidental future use of this functionality by users who use older versions of OpenJ9 on future POWER10 systems, since the current support is untested. Currently, the only exploitation which has been added is the use of the brh and brd instructions for the recognized {Short,Long}.reverseBytes methods, but more will be added in the near future.", "createdAt": "2020-05-12T15:42:14Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9530", "merged": true, "mergeCommit": {"oid": "b5e20ac687cdedfcb8a6e4ea569ea4708512c48f"}, "closed": true, "closedAt": "2020-06-05T18:10:31Z", "author": {"login": "aviansie-ben"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclZFo8AFqTQxOTE5MTk5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclwRfvABqjMzODM1NjU2MjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MTkxOTkz", "url": "https://github.com/eclipse-openj9/openj9/pull/9530#pullrequestreview-419191993", "createdAt": "2020-05-27T13:13:52Z", "commit": {"oid": "3df7c5c4ffc50de9051f6e04a6d83609cd65c816"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMzoxMzo1MlrOGbJOEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMzoxMzo1MlrOGbJOEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTExNTc5Mw==", "bodyText": "older version of OpenJ9 cannot recognize P10 such that it is only an Unknown processor (i.e. DefaultProcessor). This code on P10Processor never kicks in anyway such that It is unnecessary.", "url": "https://github.com/eclipse-openj9/openj9/pull/9530#discussion_r431115793", "createdAt": "2020-05-27T13:13:52Z", "author": {"login": "zl-wang"}, "path": "runtime/compiler/env/ProcessorDetection.cpp", "diffHunk": "@@ -269,6 +269,20 @@ TR_Processor mapJ9Processor(J9ProcessorArchitecture j9processor)\n       case PROCESSOR_PPC_P9:\n          tp = TR_PPCp9;\n          break;\n+      case PROCESSOR_PPC_P10:\n+         // P10 support is not yet well-tested, so it's currently gated behind an environment\n+         // variable to prevent it from being used by accident by users who use old versions of\n+         // OpenJ9 once P10 chips become available.\n+         if (jitConfig)\n+            {\n+            static bool enableP10 = feGetEnv(\"TR_EnableExperimentalPower10Support\");\n+            tp = enableP10 ? TR_PPCp10 : TR_PPCp9;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df7c5c4ffc50de9051f6e04a6d83609cd65c816"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MjAxMjUx", "url": "https://github.com/eclipse-openj9/openj9/pull/9530#pullrequestreview-419201251", "createdAt": "2020-05-27T13:23:48Z", "commit": {"oid": "3df7c5c4ffc50de9051f6e04a6d83609cd65c816"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a8557b5dd940d3d10e630d064cd9a64ba87a4af", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6a8557b5dd940d3d10e630d064cd9a64ba87a4af", "committedDate": "2020-05-28T16:15:03Z", "message": "Add code to recognize POWER10 in the port library and compiler\n\nCurrently, support for recognizing POWER10 in the compiler is gated\nbehind an environment variable, since support is still very early in\ndevelopment and untested. Gating this support prevents accidental use of\nuntested P10 code by people using older versions of OpenJ9 when such\nchips become available.\n\nCo-authored-by: Julian Wang <zlwang@ca.ibm.com>\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5034de8f24977e32951833b9ef985b9149f0a637", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5034de8f24977e32951833b9ef985b9149f0a637", "committedDate": "2020-05-28T16:15:05Z", "message": "Add code for exploiting P10 byte reverse instructions\n\nThe Power codegen support for inlining the reverseBytes methods of the\nShort and Long classes will now make use of the brh and brd instructions\navailable on POWER10 systems.\n\nCo-authored-by: Julian Wang <zlwang@ca.ibm.com>\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3df7c5c4ffc50de9051f6e04a6d83609cd65c816", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/3df7c5c4ffc50de9051f6e04a6d83609cd65c816", "committedDate": "2020-05-12T15:16:55Z", "message": "Add code for exploiting P10 byte reverse instructions\n\nThe Power codegen support for inlining the reverseBytes methods of the\nShort and Long classes will now make use of the brh and brd instructions\navailable on POWER10 systems.\n\nCo-authored-by: Julian Wang <zlwang@ca.ibm.com>\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}, "afterCommit": {"oid": "5034de8f24977e32951833b9ef985b9149f0a637", "author": {"user": {"login": "aviansie-ben", "name": "Ben Thomas (Aviansie Ben)"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5034de8f24977e32951833b9ef985b9149f0a637", "committedDate": "2020-05-28T16:15:05Z", "message": "Add code for exploiting P10 byte reverse instructions\n\nThe Power codegen support for inlining the reverseBytes methods of the\nShort and Long classes will now make use of the brh and brd instructions\navailable on POWER10 systems.\n\nCo-authored-by: Julian Wang <zlwang@ca.ibm.com>\nSigned-off-by: Ben Thomas <ben@benthomas.ca>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 909, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}