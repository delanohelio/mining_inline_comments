{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NjcwMjYw", "number": 10410, "title": "Avoid the static initialization of class in getCPMethodHandleAt", "bodyText": "The change is to avoid initializing the specified class\nin getCPMethodHandleAt so as to postpone the static\ninitialization to the invocation of the method of this class.\nFixes: #10356\nSigned-off-by: Cheng Jin jincheng@ca.ibm.com", "createdAt": "2020-08-18T18:38:46Z", "url": "https://github.com/eclipse-openj9/openj9/pull/10410", "merged": true, "mergeCommit": {"oid": "97b0de9533712a845756a70f2c9c488bfc95ba02"}, "closed": true, "closedAt": "2020-08-18T22:14:10Z", "author": {"login": "ChengJin01"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdALm14gFqTQ2OTczMTM5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdALvldAFqTQ2OTczODIxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzMxMzk4", "url": "https://github.com/eclipse-openj9/openj9/pull/10410#pullrequestreview-469731398", "createdAt": "2020-08-18T18:48:12Z", "commit": {"oid": "960d8e8e15134c1c951f5ab44d0a1427b8d8a4bd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxODo0ODoxMlrOHChglQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxODo0ODoxMlrOHChglQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQwODIxMw==", "bodyText": "Bit of a nitpick - I'd leave the line long here rather than trying to figure out the \"right\" level of indent for the second line of parameters\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tmethodHandleObject = vmFunctions->resolveMethodHandleRef(vmThread, J9_CP_FROM_CLASS(ramClass), cpIndex,\n          \n          \n            \n            \t\t\t\t\t\t\t\t\t\tJ9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_CLASS_INIT);\n          \n          \n            \n            \t\t\t\tmethodHandleObject = vmFunctions->resolveMethodHandleRef(vmThread, J9_CP_FROM_CLASS(ramClass), cpIndex, J9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_CLASS_INIT);", "url": "https://github.com/eclipse-openj9/openj9/pull/10410#discussion_r472408213", "createdAt": "2020-08-18T18:48:12Z", "author": {"login": "DanHeidinga"}, "path": "runtime/jcl/common/sun_reflect_ConstantPool.c", "diffHunk": "@@ -752,7 +752,11 @@ Java_java_lang_invoke_MethodHandle_getCPMethodHandleAt(JNIEnv *env, jclass unuse\n \t\t\tj9object_t methodHandleObject = J9STATIC_OBJECT_LOAD(vmThread, ramClass, &ramMethodHandleRef->methodHandle);\n \n \t\t\tif (NULL == methodHandleObject) {\n-\t\t\t\tmethodHandleObject = vmFunctions->resolveMethodHandleRef(vmThread, J9_CP_FROM_CLASS(ramClass), cpIndex, J9_RESOLVE_FLAG_RUNTIME_RESOLVE);\n+\t\t\t\t/* Avoid initializing the class from there so as to postpone the static initialization\n+\t\t\t\t * to the invocation of the specified method of the class.\n+\t\t\t\t */\n+\t\t\t\tmethodHandleObject = vmFunctions->resolveMethodHandleRef(vmThread, J9_CP_FROM_CLASS(ramClass), cpIndex,\n+\t\t\t\t\t\t\t\t\t\tJ9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_CLASS_INIT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "960d8e8e15134c1c951f5ab44d0a1427b8d8a4bd"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac3cd7299d79258701a88196600e6fa3c42a0021", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/ac3cd7299d79258701a88196600e6fa3c42a0021", "committedDate": "2020-08-18T18:53:15Z", "message": "Avoid the static initialization of class in getCPMethodHandleAt\n\nThe change is to avoid initializing the specified class\nin getCPMethodHandleAt so as to postpone the static\ninitialization to the invocation of the method of this class.\n\nFixes: #10356\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "960d8e8e15134c1c951f5ab44d0a1427b8d8a4bd", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/960d8e8e15134c1c951f5ab44d0a1427b8d8a4bd", "committedDate": "2020-08-18T18:37:13Z", "message": "Avoid the static initialization of class in getCPMethodHandleAt\n\nThe change is to avoid initializing the specified class\nin getCPMethodHandleAt so as to postpone the static\ninitialization to the invocation of the method of this class.\n\nFixes: #10356\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}, "afterCommit": {"oid": "ac3cd7299d79258701a88196600e6fa3c42a0021", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/ac3cd7299d79258701a88196600e6fa3c42a0021", "committedDate": "2020-08-18T18:53:15Z", "message": "Avoid the static initialization of class in getCPMethodHandleAt\n\nThe change is to avoid initializing the specified class\nin getCPMethodHandleAt so as to postpone the static\ninitialization to the invocation of the method of this class.\n\nFixes: #10356\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzM4MjEx", "url": "https://github.com/eclipse-openj9/openj9/pull/10410#pullrequestreview-469738211", "createdAt": "2020-08-18T18:58:10Z", "commit": {"oid": "ac3cd7299d79258701a88196600e6fa3c42a0021"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 190, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}