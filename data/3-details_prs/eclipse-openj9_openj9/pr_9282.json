{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NzUxNTYw", "number": 9282, "title": "AArch64: Align 64-bit data in call snippets", "bodyText": "This commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\nSigned-off-by: KONNO Kazuhiro konno@jp.ibm.com", "createdAt": "2020-04-19T22:53:38Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9282", "merged": true, "mergeCommit": {"oid": "a386db49afa8b14dd185fb6697ddd1bb704ea0d6"}, "closed": true, "closedAt": "2020-04-22T11:47:25Z", "author": {"login": "knn-k"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZn3AVABqjMyNTM5NjU3NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaG2fsAFqTM5ODEwODAzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "64a2e1371f7a5370738ccdac5741f88262443381", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/64a2e1371f7a5370738ccdac5741f88262443381", "committedDate": "2020-04-18T01:33:51Z", "message": "AArch64: Align 64-bit data in call snippets\n\nThis commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}, "afterCommit": {"oid": "93df4623e551c63c5aee0fa331b84c016e5f1b3e", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/93df4623e551c63c5aee0fa331b84c016e5f1b3e", "committedDate": "2020-04-20T23:39:25Z", "message": "AArch64: Align 64-bit data in call snippets\n\nThis commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjUzODAz", "url": "https://github.com/eclipse-openj9/openj9/pull/9282#pullrequestreview-397653803", "createdAt": "2020-04-21T20:33:16Z", "commit": {"oid": "93df4623e551c63c5aee0fa331b84c016e5f1b3e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDozMzoxNlrOGJXRwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDozNToxM1rOGJXWTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ3MTc0Ng==", "bodyText": "If your concern is about the size of intptr_t data, why not just use sizeof(intptr_t) here instead of the call to sizeofReferenceAddress() ?", "url": "https://github.com/eclipse-openj9/openj9/pull/9282#discussion_r412471746", "createdAt": "2020-04-21T20:33:16Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/aarch64/codegen/CallSnippet.cpp", "diffHunk": "@@ -410,11 +410,18 @@ uint8_t *TR::ARM64VirtualUnresolvedSnippet::emitSnippetBody()\n    TR_J9VMBase *fej9 = (TR_J9VMBase *)(comp->fe());\n    void *thunk = fej9->getJ2IThunk(callNode->getSymbolReference()->getSymbol()->castToMethodSymbol()->getMethod(), comp);\n \n+   // for alignment of intptr_t data\n+   if (((uint64_t)cursor % TR::Compiler->om.sizeofReferenceAddress()) == 0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93df4623e551c63c5aee0fa331b84c016e5f1b3e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ3MjkxMQ==", "bodyText": "Since this code is here to align the data after the call instruction, perhaps adding an assert that sizeof(int32_t) == ARM64_INSTRUCTION_LENGTH is warranted just to make it clear of the assumption you're making.", "url": "https://github.com/eclipse-openj9/openj9/pull/9282#discussion_r412472911", "createdAt": "2020-04-21T20:35:13Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/aarch64/codegen/CallSnippet.cpp", "diffHunk": "@@ -410,11 +410,18 @@ uint8_t *TR::ARM64VirtualUnresolvedSnippet::emitSnippetBody()\n    TR_J9VMBase *fej9 = (TR_J9VMBase *)(comp->fe());\n    void *thunk = fej9->getJ2IThunk(callNode->getSymbolReference()->getSymbol()->castToMethodSymbol()->getMethod(), comp);\n \n+   // for alignment of intptr_t data\n+   if (((uint64_t)cursor % TR::Compiler->om.sizeofReferenceAddress()) == 0)\n+      {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93df4623e551c63c5aee0fa331b84c016e5f1b3e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a5dccd0b7f92710b0d27284dce5ede60fec92c1", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5a5dccd0b7f92710b0d27284dce5ede60fec92c1", "committedDate": "2020-04-21T23:55:36Z", "message": "AArch64: Align 64-bit data in call snippets\n\nThis commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93df4623e551c63c5aee0fa331b84c016e5f1b3e", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/93df4623e551c63c5aee0fa331b84c016e5f1b3e", "committedDate": "2020-04-20T23:39:25Z", "message": "AArch64: Align 64-bit data in call snippets\n\nThis commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}, "afterCommit": {"oid": "5a5dccd0b7f92710b0d27284dce5ede60fec92c1", "author": {"user": {"login": "knn-k", "name": "KONNO Kazuhiro"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5a5dccd0b7f92710b0d27284dce5ede60fec92c1", "committedDate": "2020-04-21T23:55:36Z", "message": "AArch64: Align 64-bit data in call snippets\n\nThis commit adds adjustments for addresses of virtual unresolved call\nsnippets and interface call snippets so that the 64-bit data in\nsnippets are naturally aligned.\n\nSigned-off-by: KONNO Kazuhiro <konno@jp.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MTA4MDM0", "url": "https://github.com/eclipse-openj9/openj9/pull/9282#pullrequestreview-398108034", "createdAt": "2020-04-22T11:47:04Z", "commit": {"oid": "5a5dccd0b7f92710b0d27284dce5ede60fec92c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1016, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}