{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNDYwNDQ0", "number": 9619, "title": "CMake: update the way we handle appending the \"29\" suffix on libs", "bodyText": "Old method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\nSigned-off-by: Devin Nakamura devinn@ca.ibm.com", "createdAt": "2020-05-20T01:58:56Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9619", "merged": true, "mergeCommit": {"oid": "60f2f9454a92b0f1b7898fd7463cfb97810ee3de"}, "closed": true, "closedAt": "2020-05-23T12:16:18Z", "author": {"login": "dnakamura"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjAMVLABqjMzNTQ1MDk4MTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcj4gn-gFqTQxNzE3MzU3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e49450867453e4c4ed166ef5726273d263ad4533", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e49450867453e4c4ed166ef5726273d263ad4533", "committedDate": "2020-05-20T01:57:38Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\n\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "30b19c8b5744ef0b3c7b2c9fac0570e2085a7469", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/30b19c8b5744ef0b3c7b2c9fac0570e2085a7469", "committedDate": "2020-05-20T02:21:15Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\n\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30b19c8b5744ef0b3c7b2c9fac0570e2085a7469", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/30b19c8b5744ef0b3c7b2c9fac0570e2085a7469", "committedDate": "2020-05-20T02:21:15Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\n\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e846aa3ddce9aa196ada5571e2ea58755c3d62a7", "committedDate": "2020-05-20T14:22:26Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\n\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTA5MzU3", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-416509357", "createdAt": "2020-05-21T21:33:50Z", "commit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozMzo1MFrOGZDtew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozMzo1MFrOGZDtew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkyODM3OQ==", "bodyText": "typo: arroung -> around", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r428928379", "createdAt": "2020-05-21T21:33:50Z", "author": {"login": "keithc-ca"}, "path": "runtime/cmake/J9vmTargetSupport.cmake", "diffHunk": "@@ -20,15 +20,50 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n+if(J9VM_TARGET_SUPPORT)\n+\treturn()\n+endif()\n+set(J9VM_TARGET_SUPPORT 1)\n+\n include(OmrTargetSupport)\n \n-# Currently j9vm_add_library and j9vm_add_executable just call\n-# omr_add_library and omr_add_executable, but have them so that we can add\n-# functionality in the future, without having to hunt down all the \n-# add_library/add_executable calls.\n+# Currently j9vm_add_library and j9vm_add_executable are wrappers arroung", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTEwMTIz", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-416510123", "createdAt": "2020-05-21T21:35:14Z", "commit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozNToxNFrOGZDwsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozNToxNFrOGZDwsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkyOTIwMg==", "bodyText": "For libraries other than shared libraries this loses OUTPUT_NAME if specified.", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r428929202", "createdAt": "2020-05-21T21:35:14Z", "author": {"login": "keithc-ca"}, "path": "runtime/cmake/J9vmTargetSupport.cmake", "diffHunk": "@@ -20,15 +20,50 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n+if(J9VM_TARGET_SUPPORT)\n+\treturn()\n+endif()\n+set(J9VM_TARGET_SUPPORT 1)\n+\n include(OmrTargetSupport)\n \n-# Currently j9vm_add_library and j9vm_add_executable just call\n-# omr_add_library and omr_add_executable, but have them so that we can add\n-# functionality in the future, without having to hunt down all the \n-# add_library/add_executable calls.\n+# Currently j9vm_add_library and j9vm_add_executable are wrappers arroung\n+# omr_add_library and omr_add_executable. Here we only document the additional\n+# functionality provided. For full information see cmake/moudles/OmrTargetSupport.cmake\n+# from omr\n+\n+# j9vm_add_library(<target_name> <library_type> [options ...] [source ...] )\n+#  NO_VERSION_SUFFIX  - Don't append a version suffix  (eg 29) on the output file name.\n+#                       Note: Only applies to SHARED libraries\n+function(j9vm_add_library name type)\n+\tset(options NO_VERSION_SUFFIX)\n+\tset(oneValueArgs OUTPUT_NAME)\n+\tset(multiValueArgs)\n+\tcmake_parse_arguments(opt \"${options}\" \"${oneValueArgs}\" \"${multiValueArgs}\" ${ARGN})\n+\n+\t# Check if we need to append a version suffix eg '29'\n+\tset(output_name_args)\n+\tif(type STREQUAL \"SHARED\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTEwNzQz", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-416510743", "createdAt": "2020-05-21T21:36:21Z", "commit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozNjoyMVrOGZDy5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTozNjoyMVrOGZDy5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkyOTc2NQ==", "bodyText": "If OUTPUT_NAME is explicitly specified, I don't think the version suffix should be added even if NO_VERSION_SUFFIX was not specified.", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r428929765", "createdAt": "2020-05-21T21:36:21Z", "author": {"login": "keithc-ca"}, "path": "runtime/cmake/J9vmTargetSupport.cmake", "diffHunk": "@@ -20,15 +20,50 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n+if(J9VM_TARGET_SUPPORT)\n+\treturn()\n+endif()\n+set(J9VM_TARGET_SUPPORT 1)\n+\n include(OmrTargetSupport)\n \n-# Currently j9vm_add_library and j9vm_add_executable just call\n-# omr_add_library and omr_add_executable, but have them so that we can add\n-# functionality in the future, without having to hunt down all the \n-# add_library/add_executable calls.\n+# Currently j9vm_add_library and j9vm_add_executable are wrappers arroung\n+# omr_add_library and omr_add_executable. Here we only document the additional\n+# functionality provided. For full information see cmake/moudles/OmrTargetSupport.cmake\n+# from omr\n+\n+# j9vm_add_library(<target_name> <library_type> [options ...] [source ...] )\n+#  NO_VERSION_SUFFIX  - Don't append a version suffix  (eg 29) on the output file name.\n+#                       Note: Only applies to SHARED libraries\n+function(j9vm_add_library name type)\n+\tset(options NO_VERSION_SUFFIX)\n+\tset(oneValueArgs OUTPUT_NAME)\n+\tset(multiValueArgs)\n+\tcmake_parse_arguments(opt \"${options}\" \"${oneValueArgs}\" \"${multiValueArgs}\" ${ARGN})\n+\n+\t# Check if we need to append a version suffix eg '29'\n+\tset(output_name_args)\n+\tif(type STREQUAL \"SHARED\")\n+\t\t# If OUTPUT_NAME is specified, use that as the starting name\n+\t\t# otherwise the name of the cmake target is our starting point\n+\t\tif(opt_OUTPUT_NAME)\n+\t\t\tset(output_name \"${opt_OUTPUT_NAME}\")\n+\t\telse()\n+\t\t\tset(output_name \"${name}\")\n+\t\tendif()\n+\n+\t\t# Default to appending a version suffix, unless we are told not to\n+\t\tif(NOT opt_NO_VERSION_SUFFIX)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTE0NzU1", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-416514755", "createdAt": "2020-05-21T21:43:51Z", "commit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTo0Mzo1MlrOGZD_mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMTo0Mzo1MlrOGZD_mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODkzMzAxOA==", "bodyText": "typo: moudles -> modules", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r428933018", "createdAt": "2020-05-21T21:43:52Z", "author": {"login": "keithc-ca"}, "path": "runtime/cmake/J9vmTargetSupport.cmake", "diffHunk": "@@ -20,15 +20,50 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n+if(J9VM_TARGET_SUPPORT)\n+\treturn()\n+endif()\n+set(J9VM_TARGET_SUPPORT 1)\n+\n include(OmrTargetSupport)\n \n-# Currently j9vm_add_library and j9vm_add_executable just call\n-# omr_add_library and omr_add_executable, but have them so that we can add\n-# functionality in the future, without having to hunt down all the \n-# add_library/add_executable calls.\n+# Currently j9vm_add_library and j9vm_add_executable are wrappers arroung\n+# omr_add_library and omr_add_executable. Here we only document the additional\n+# functionality provided. For full information see cmake/moudles/OmrTargetSupport.cmake", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e846aa3ddce9aa196ada5571e2ea58755c3d62a7", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e846aa3ddce9aa196ada5571e2ea58755c3d62a7", "committedDate": "2020-05-20T14:22:26Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. However now that we have j9vm_add_library, it provides\nus an easy place to implement the desired behaviour.\n\nNote: the NO_VERSION_SUFFIX corresponds to\n<artifact ... appendrelease=\"false\"> in uma\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/78571f54f2a3b7866ab06274298a43907b35bb0b", "committedDate": "2020-05-22T18:09:05Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. Now version suffix is explicity added by using the\nOUTPUT_NAME parameter of j9vm_add_library.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTA4NTUz", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-417108553", "createdAt": "2020-05-22T18:27:52Z", "commit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxODoyNzo1MlrOGZgMtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxODo0Njo1MlrOGZgqeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM5NTEyNw==", "bodyText": "This should be j9trc${J9VM_VERSION_SUFFIX}.", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r429395127", "createdAt": "2020-05-22T18:27:52Z", "author": {"login": "keithc-ca"}, "path": "runtime/rastrace/CMakeLists.txt", "diffHunk": "@@ -26,6 +26,7 @@ add_tracegen(j9trc_aux.tdf)\n add_tracegen(mt.tdf)\n \n j9vm_add_library(j9trc SHARED\n+\tOUTPUT_NAME j9trc", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQwMTQ2OA==", "bodyText": "The lines above should be removed:\n# Don't append version suffix.\nset(CMAKE_SHARED_LIBRARY_SUFFIX ${J9VM_OLD_SHARED_SUFFIX})", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r429401468", "createdAt": "2020-05-22T18:43:36Z", "author": {"login": "keithc-ca"}, "path": "runtime/redirector/CMakeLists.txt", "diffHunk": "@@ -28,7 +28,10 @@ set_source_files_properties(\"${CMAKE_CURRENT_BINARY_DIR}/generated.c\" PROPERTIES\n ################################################################################\n # Redirector\n ################################################################################\n-j9vm_add_library(jvm_redirect SHARED\n+j9vm_add_library(jvm_redirect", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQwMjc0NQ==", "bodyText": "The lines above should be removed:\n#re-enable version num suffix\nset(CMAKE_SHARED_LIBRARY_SUFFIX ${J9VM_SHARED_LIBRARY_SUFFIX})", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#discussion_r429402745", "createdAt": "2020-05-22T18:46:52Z", "author": {"login": "keithc-ca"}, "path": "runtime/tests/thread/CMakeLists.txt", "diffHunk": "@@ -45,6 +45,7 @@ target_link_libraries(thread_cutest_harness\n \n \n j9vm_add_library(j9thrtestnatives SHARED\n+\tOUTPUT_NAME j9thrtestnatives${J9VM_VERSION_SUFFIX}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1cd05a220b1354ad6887959da82f0fed8f545bd", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/b1cd05a220b1354ad6887959da82f0fed8f545bd", "committedDate": "2020-05-22T18:56:25Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. Now version suffix is explicity added by using the\nOUTPUT_NAME parameter of j9vm_add_library.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78571f54f2a3b7866ab06274298a43907b35bb0b", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/78571f54f2a3b7866ab06274298a43907b35bb0b", "committedDate": "2020-05-22T18:09:05Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. Now version suffix is explicity added by using the\nOUTPUT_NAME parameter of j9vm_add_library.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}, "afterCommit": {"oid": "b1cd05a220b1354ad6887959da82f0fed8f545bd", "author": {"user": {"login": "dnakamura", "name": "Devin Nakamura"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/b1cd05a220b1354ad6887959da82f0fed8f545bd", "committedDate": "2020-05-22T18:56:25Z", "message": "CMake: update the way we handle appending the \"29\" suffix on libs\n\nOld method of updating CMAKE_SHARED_LIBRARY_SUFFIX was clunky and\nproblematic. Now version suffix is explicity added by using the\nOUTPUT_NAME parameter of j9vm_add_library.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MTczNTc3", "url": "https://github.com/eclipse-openj9/openj9/pull/9619#pullrequestreview-417173577", "createdAt": "2020-05-22T20:43:45Z", "commit": {"oid": "b1cd05a220b1354ad6887959da82f0fed8f545bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 991, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}