{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NjQ2Nzc1", "number": 9131, "title": "HeapSampling not available for GC policies Metronome & Balanced", "bodyText": "HeapSampling not available for GC policies Metronome & Balanced\nNot enable  jvmtiCapabilities can_generate_sampled_object_alloc_events when the GC policy is Metronome or Balanced;\nMoved the test for initialCapabilities.can_generate_sampled_object_alloc_events to soae001.c.\nThis is a known limitation as per https://www.eclipse.org/openj9/docs/version0.15/\n Restrictions: JEP 331 is implemented for OpenJ9 with the following limitations:\n    The balanced and metronome garbage collection policies are not supported.\n\nCurrently following GC policies are tested https://github.com/eclipse/openj9/blob/958d2f9b581efc1ddf774753520d709e64c7d6e7/test/functional/cmdLineTests/jvmtitests/playlist.xml#L640-L643\ncloses: #9045\nReviewer: @DanHeidinga\nSigned-off-by: Jason Feng fengj@ca.ibm.com", "createdAt": "2020-04-06T13:29:14Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9131", "merged": true, "mergeCommit": {"oid": "3f7ce36e8830dcf4a9b091e05fdc1ecf88000dfc"}, "closed": true, "closedAt": "2020-04-09T20:30:02Z", "author": {"login": "JasonFengJ9"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVfnSuAFqTM4OTYzNDIyOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV-j7dgFqTM5MDkxODkyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NjM0MjI4", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#pullrequestreview-389634228", "createdAt": "2020-04-08T03:47:41Z", "commit": {"oid": "e363d8001fcfa8eef2641b326b194ec9503959c7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMzo0Nzo0MVrOGCeAdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMzo0Nzo0MVrOGCeAdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI0MTk3NA==", "bodyText": "Should the can_generate_sampled_object_alloc_events event be removed from the potential set of capabilities when running with metronome or balanced? ie https://github.com/eclipse/openj9/blob/e363d8001fcfa8eef2641b326b194ec9503959c7/runtime/jvmti/jvmtiCapability.c#L178", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#discussion_r405241974", "createdAt": "2020-04-08T03:47:41Z", "author": {"login": "DanHeidinga"}, "path": "runtime/jvmti/jvmtiCapability.c", "diffHunk": "@@ -373,7 +373,10 @@ jvmtiAddCapabilities(jvmtiEnv* env,\n \n #if JAVA_SPEC_VERSION >= 11\n \t\tif (newCapabilities.can_generate_sampled_object_alloc_events) {\n-\t\t\tif (J9_ARE_ANY_BITS_SET(jvmtiData->flags, J9JVMTI_FLAG_SAMPLED_OBJECT_ALLOC_ENABLED)) {\n+\t\t\tif (J9_ARE_ANY_BITS_SET(jvmtiData->flags, J9JVMTI_FLAG_SAMPLED_OBJECT_ALLOC_ENABLED)\n+\t\t\t\t|| (J9_GC_POLICY_METRONOME == vm->gcPolicy)\n+\t\t\t\t|| (J9_GC_POLICY_BALANCED == vm->gcPolicy)\n+\t\t\t) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e363d8001fcfa8eef2641b326b194ec9503959c7"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e363d8001fcfa8eef2641b326b194ec9503959c7", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/e363d8001fcfa8eef2641b326b194ec9503959c7", "committedDate": "2020-04-06T00:27:38Z", "message": "HeapSampling not available for GC policy Metronome/Balanced\n\nReturn JVMTI_ERROR_NOT_AVAILABLE for\ncan_generate_sampled_object_alloc_events when the GC policy is Metronome\nor Balanced.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "cef02e102daab0f658d495f2fe715be11f32e478", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/cef02e102daab0f658d495f2fe715be11f32e478", "committedDate": "2020-04-08T12:01:21Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTU5OTYw", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#pullrequestreview-389959960", "createdAt": "2020-04-08T13:12:58Z", "commit": {"oid": "cef02e102daab0f658d495f2fe715be11f32e478"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMDQyNDk5", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#pullrequestreview-390042499", "createdAt": "2020-04-08T14:43:21Z", "commit": {"oid": "cef02e102daab0f658d495f2fe715be11f32e478"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cef02e102daab0f658d495f2fe715be11f32e478", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/cef02e102daab0f658d495f2fe715be11f32e478", "committedDate": "2020-04-08T12:01:21Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "70384a3022728add8b1cf9b25ecc296911a7d1db", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/70384a3022728add8b1cf9b25ecc296911a7d1db", "committedDate": "2020-04-08T19:34:18Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced;\nMoved the test for\ninitialCapabilities.can_generate_sampled_object_alloc_events\nto soae001.c.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNDQ2NTg3", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#pullrequestreview-390446587", "createdAt": "2020-04-09T02:08:42Z", "commit": {"oid": "70384a3022728add8b1cf9b25ecc296911a7d1db"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwMjowODo0M1rOGDHJZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwMjowODo0M1rOGDHJZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTkxNjAwNQ==", "bodyText": "We greatly prefer -= 1", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#discussion_r405916005", "createdAt": "2020-04-09T02:08:43Z", "author": {"login": "gacholio"}, "path": "runtime/tests/jvmtitests/src/com/ibm/jvmti/tests/getPotentialCapabilities/gpc001.c", "diffHunk": "@@ -153,6 +153,11 @@ Java_com_ibm_jvmti_tests_getPotentialCapabilities_gpc001_verifyOnLoadCapabilitie\n \t\tunavailableCount--;\n \t}\n \n+\t/* GC policies Metronome & Balanced don't support this event */\n+\tif (!initialCapabilities.can_generate_sampled_object_alloc_events) {\n+\t\tunavailableCount--;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70384a3022728add8b1cf9b25ecc296911a7d1db"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48484f531f3fda614d64459650714e6836dc7cd1", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/48484f531f3fda614d64459650714e6836dc7cd1", "committedDate": "2020-04-09T02:36:34Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced;\nMoved the test for\ninitialCapabilities.can_generate_sampled_object_alloc_events\nto soae001.c.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70384a3022728add8b1cf9b25ecc296911a7d1db", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/70384a3022728add8b1cf9b25ecc296911a7d1db", "committedDate": "2020-04-08T19:34:18Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced;\nMoved the test for\ninitialCapabilities.can_generate_sampled_object_alloc_events\nto soae001.c.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "48484f531f3fda614d64459650714e6836dc7cd1", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/48484f531f3fda614d64459650714e6836dc7cd1", "committedDate": "2020-04-09T02:36:34Z", "message": "HeapSampling not available for GC policies Metronome/Balanced\n\nNot enable jvmtiCapabilities can_generate_sampled_object_alloc_events\nwhen the GC policy is Metronome or Balanced;\nMoved the test for\ninitialCapabilities.can_generate_sampled_object_alloc_events\nto soae001.c.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwOTE4OTIz", "url": "https://github.com/eclipse-openj9/openj9/pull/9131#pullrequestreview-390918923", "createdAt": "2020-04-09T15:51:51Z", "commit": {"oid": "48484f531f3fda614d64459650714e6836dc7cd1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1192, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}