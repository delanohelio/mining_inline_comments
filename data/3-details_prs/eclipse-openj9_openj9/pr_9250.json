{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNTQ3NjYz", "number": 9250, "title": "Match number of artifacts to number of build logs", "bodyText": "Add option to allow number of Artifactory artifacts\nto match the number of build logs we rotate. This\nwill have several positive effects. The first is\nit should reduce our overall disk usage. It will\nalso be more practical to have a) Same number of\nbuild logs and artifacts and b) Different number\nof artifacts for different builds. This can be\nenabled on a per server basis and I have enabled\nit for the main (default) OSU server.\n\n[skip ci]\nSigned-off-by: Adam Brousseau adam.brousseau88@gmail.com\nReduce history on builds\n\nReduce Release from 10 to 5\nReduce OMR Acceptance from 20 to 15\nReduce JDK Acceptances from 20 to 10", "createdAt": "2020-04-15T05:21:05Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9250", "merged": true, "mergeCommit": {"oid": "787a9a203a3b5a820b17795a167274e89135f925"}, "closed": true, "closedAt": "2020-04-20T17:15:01Z", "author": {"login": "AdamBrousseau"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXxS0xgBqjMyMzM4OTkzMzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZiUiyAFqTM5NjY1MjI2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6017b64c28ccd2ac189635396132eee6e2171971", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/6017b64c28ccd2ac189635396132eee6e2171971", "committedDate": "2020-04-15T05:09:41Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}, "afterCommit": {"oid": "b5ecc11e3a23fe8ce0c166511aacd87d01da5a6d", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/b5ecc11e3a23fe8ce0c166511aacd87d01da5a6d", "committedDate": "2020-04-15T05:32:06Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5ecc11e3a23fe8ce0c166511aacd87d01da5a6d", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/b5ecc11e3a23fe8ce0c166511aacd87d01da5a6d", "committedDate": "2020-04-15T05:32:06Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}, "afterCommit": {"oid": "bc3048f2200ea4c07d6e187d017737bb3704d7c2", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/bc3048f2200ea4c07d6e187d017737bb3704d7c2", "committedDate": "2020-04-15T06:33:14Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0ODMzNzA3", "url": "https://github.com/eclipse-openj9/openj9/pull/9250#pullrequestreview-394833707", "createdAt": "2020-04-16T17:07:29Z", "commit": {"oid": "bc3048f2200ea4c07d6e187d017737bb3704d7c2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNzowNzozMFrOGGvAtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNzowOTo0MVrOGGvFyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxNDg2OA==", "bodyText": "Why set it for unb since useBuildDiscarderNumArtifacts is set to false and uses build_discarder.logs?", "url": "https://github.com/eclipse-openj9/openj9/pull/9250#discussion_r409714868", "createdAt": "2020-04-16T17:07:30Z", "author": {"login": "vsebe"}, "path": "buildenv/jenkins/variables/defaults.yml", "diffHunk": "@@ -57,6 +57,9 @@ artifactory:\n   numArtifacts:\n     osu: 30\n     unb: 5", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc3048f2200ea4c07d6e187d017737bb3704d7c2"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxNjE2OA==", "bodyText": "Doesn't seem to be required. It could be removed. If numArtifacts for geo is not set use build_discarder.logs in set_artifactory_config() method:\ne.g.\ndef numArtifacts = get_value(VARIABLES.artifactory.numArtifacts, geo)\nif (!numArtifacts ){\n    numArtifacts = get_value(VARIABLES.build_discarder.logs, pipelineFunctions.convert_build_identifier(id))\n}\nARTIFACTORY_CONFIG[geo]['numArtifacts'] = numArtifacts.toInteger()", "url": "https://github.com/eclipse-openj9/openj9/pull/9250#discussion_r409716168", "createdAt": "2020-04-16T17:09:41Z", "author": {"login": "vsebe"}, "path": "buildenv/jenkins/variables/defaults.yml", "diffHunk": "@@ -57,6 +57,9 @@ artifactory:\n   numArtifacts:\n     osu: 30\n     unb: 5\n+  useBuildDiscarderNumArtifacts:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc3048f2200ea4c07d6e187d017737bb3704d7c2"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46a0ea1d4c40a3d144936b3dda87aa1d82a25c0e", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/46a0ea1d4c40a3d144936b3dda87aa1d82a25c0e", "committedDate": "2020-04-17T03:58:17Z", "message": "Match number of artifacts to number of build logs\n\n- Add option to allow number of Artifactory artifacts\n  to match the number of build logs we rotate. If\n  numArtifacts is not set, use build_discarder. This\n  will have several positive effects. The first is\n  it should reduce our overall disk usage. It will\n  also be more practical to have a) Same number of\n  build logs and artifacts and b) Different number\n  of artifacts for different builds. This can be\n  enabled on a per server basis and I have enabled\n  it for the main (default) OSU server.\n\n[skip ci]\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "406108a96d024f833348e8568997000a2162bda9", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/406108a96d024f833348e8568997000a2162bda9", "committedDate": "2020-04-17T03:59:34Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc3048f2200ea4c07d6e187d017737bb3704d7c2", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/bc3048f2200ea4c07d6e187d017737bb3704d7c2", "committedDate": "2020-04-15T06:33:14Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}, "afterCommit": {"oid": "406108a96d024f833348e8568997000a2162bda9", "author": {"user": {"login": "AdamBrousseau", "name": null}}, "url": "https://github.com/eclipse-openj9/openj9/commit/406108a96d024f833348e8568997000a2162bda9", "committedDate": "2020-04-17T03:59:34Z", "message": "Reduce history on builds\n\n- Reduce Release from 10 to 5\n- Reduce OMR Acceptance from 20 to 15\n- Reduce JDK Acceptances from 20 to 10\n\n[skip ci]\n\nSigned-off-by: Adam Brousseau <adam.brousseau88@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NjQ5MTEz", "url": "https://github.com/eclipse-openj9/openj9/pull/9250#pullrequestreview-395649113", "createdAt": "2020-04-17T17:39:33Z", "commit": {"oid": "406108a96d024f833348e8568997000a2162bda9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjUyMjYw", "url": "https://github.com/eclipse-openj9/openj9/pull/9250#pullrequestreview-396652260", "createdAt": "2020-04-20T17:13:24Z", "commit": {"oid": "406108a96d024f833348e8568997000a2162bda9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1276, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}