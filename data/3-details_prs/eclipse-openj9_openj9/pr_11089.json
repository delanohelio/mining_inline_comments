{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0Nzk1MzA0", "number": 11089, "title": "Initialize variables so mergeStacks is easier to read", "bodyText": "While reviewing #11086, I looked at mergeStacks (the\nsource of the compiler bug) and see that there are a\nlot of uninitialized variables.\nUpdated the code to initialize them and to move some\nof them to the smallest possible scope.\nSigned-off-by: Dan Heidinga heidinga@redhat.com", "createdAt": "2020-11-03T15:02:31Z", "url": "https://github.com/eclipse-openj9/openj9/pull/11089", "merged": true, "mergeCommit": {"oid": "c020c13191c0a4898461d7dda070493e38971a7c"}, "closed": true, "closedAt": "2020-11-03T18:22:10Z", "author": {"login": "DanHeidinga"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdY77uRgFqTUyMjY4MzM1Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY9QynABqjM5NTQyMDI3ODQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNjgzMzU3", "url": "https://github.com/eclipse-openj9/openj9/pull/11089#pullrequestreview-522683357", "createdAt": "2020-11-03T16:41:03Z", "commit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNjg1NzEx", "url": "https://github.com/eclipse-openj9/openj9/pull/11089#pullrequestreview-522685711", "createdAt": "2020-11-03T16:43:42Z", "commit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjo0Mzo0M1rOHs3bqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjo0Mzo0M1rOHs3bqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjgwNzU5Mg==", "bodyText": "Actually, while we're here, let's remove the extra blank. Do it after testing passes and I'll merge.", "url": "https://github.com/eclipse-openj9/openj9/pull/11089#discussion_r516807592", "createdAt": "2020-11-03T16:43:43Z", "author": {"login": "gacholio"}, "path": "runtime/bcverify/bcverify.c", "diffHunk": "@@ -867,16 +867,16 @@ mergeStacks (J9BytecodeVerificationData * verifyData, UDATA target)\n \tUDATA maxIndex = J9_ARG_COUNT_FROM_ROM_METHOD(romMethod) + J9_TEMP_COUNT_FROM_ROM_METHOD(romMethod);\n \tU_32 *bytecodeMap = verifyData->bytecodeMap;\n \tUDATA i = 0;\n-\tUDATA stackIndex;\n+\tUDATA stackIndex = bytecodeMap[target] >> BRANCH_INDEX_SHIFT;\n \tIDATA rewalk = FALSE;\n \tIDATA rc = BCV_SUCCESS;\n-\tUDATA *targetStackPtr, *targetStackTop, *sourceStackPtr, *sourceStackTop, *sourceStackTemps;\n+\tUDATA *targetStackPtr = NULL;\n+\tUDATA *targetStackTop = NULL;\n+\tUDATA *sourceStackPtr = NULL;\n+\tUDATA *sourceStackTop = NULL;\n+\tUDATA *sourceStackTemps = NULL;\n \tJ9BranchTargetStack *liveStack = (J9BranchTargetStack *) verifyData->liveStack;\n-\tJ9BranchTargetStack *targetStack;\n-\n-\n-\tstackIndex = bytecodeMap[target] >> BRANCH_INDEX_SHIFT;\n-\ttargetStack = BCV_INDEX_STACK (stackIndex);\n+\tJ9BranchTargetStack *targetStack = BCV_INDEX_STACK (stackIndex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzI3MjUy", "url": "https://github.com/eclipse-openj9/openj9/pull/11089#pullrequestreview-522727252", "createdAt": "2020-11-03T17:31:18Z", "commit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzozMToxOFrOHs5YOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzozMToxOFrOHs5YOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjgzOTQ4MA==", "bodyText": "verifyData->verificationFlags & J9_VERIFY_OPTIMIZE is the kind of thing I've seen cause compilation problems in the past on P. If these types of expressions are modified to use J9_ARE_ALL_BITS_SET() or J9_ARE_ANY_BITS_SET() which create proper boolean expressions, it might help #11086\n@ChengJin01 fyi", "url": "https://github.com/eclipse-openj9/openj9/pull/11089#discussion_r516839480", "createdAt": "2020-11-03T17:31:18Z", "author": {"login": "pshipton"}, "path": "runtime/bcverify/bcverify.c", "diffHunk": "@@ -979,11 +978,11 @@ mergeStacks (J9BytecodeVerificationData * verifyData, UDATA target)\n \t\t\t\t\t\t\t\t*targetStackPtr = *sourceStackPtr;\n \t\t\t\t\t\t\t\trewalk = TRUE;\n \t\t\t\t\t\t\t} else {\n-\n \t\t\t\t\t\t\t\t/* Use local mapper to check merge necessity in locals */\n \t\t\t\t\t\t\t\tif ((verifyData->verificationFlags & J9_VERIFY_OPTIMIZE) && (maxIndex <= 32)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0146a241ee2bfba38fb6664009df275da6f63d9f", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/0146a241ee2bfba38fb6664009df275da6f63d9f", "committedDate": "2020-11-03T18:13:35Z", "message": "Initialize variables so mergeStacks is easier to read\n\nWhile reviewing #11086, I looked at mergeStacks (the\nsource of the compiler bug) and see that there are a\nlot of uninitialized variables.\n\nUpdated the code to initialize them and to move some\nof them to the smallest possible scope.\n\nSigned-off-by: Dan Heidinga <heidinga@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03075be7f069951e0bf0edba0d604e15693d8767", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/03075be7f069951e0bf0edba0d604e15693d8767", "committedDate": "2020-11-03T14:59:28Z", "message": "Initialize variables so mergeStacks is easier to read\n\nWhile reviewing #11086, I looked at mergeStacks (the\nsource of the compiler bug) and see that there are a\nlot of uninitialized variables.\n\nUpdated the code to initialize them and to move some\nof them to the smallest possible scope.\n\nSigned-off-by: Dan Heidinga <heidinga@redhat.com>"}, "afterCommit": {"oid": "0146a241ee2bfba38fb6664009df275da6f63d9f", "author": {"user": {"login": "DanHeidinga", "name": "Dan Heidinga"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/0146a241ee2bfba38fb6664009df275da6f63d9f", "committedDate": "2020-11-03T18:13:35Z", "message": "Initialize variables so mergeStacks is easier to read\n\nWhile reviewing #11086, I looked at mergeStacks (the\nsource of the compiler bug) and see that there are a\nlot of uninitialized variables.\n\nUpdated the code to initialize them and to move some\nof them to the smallest possible scope.\n\nSigned-off-by: Dan Heidinga <heidinga@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 91, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}