{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MDYyMjM2", "number": 9069, "title": "AArch64: Implement TR_UnloadedClassPicSite::compensate", "bodyText": "This commit implements TR_UnloadedClassPicSite::compensate for aarch64.\nSigned-off-by: Akira Saitoh saiaki@jp.ibm.com", "createdAt": "2020-04-01T15:18:18Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9069", "merged": true, "mergeCommit": {"oid": "6661740689dc449794e57016b74509cc2d2d351d"}, "closed": true, "closedAt": "2020-04-02T05:52:15Z", "author": {"login": "Akira1Saitoh"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTZfajgFqTM4NTcwMTk2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTiSyOABqjMxOTAyNjQ0ODM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NzAxOTYz", "url": "https://github.com/eclipse-openj9/openj9/pull/9069#pullrequestreview-385701963", "createdAt": "2020-04-01T15:31:34Z", "commit": {"oid": "c01dd4d906bcd6d8fe23a80a6e7d5642340a87c3"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNTozMTozNFrOF_GQMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNTozMjoyNVrOF_GSkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcwNzA1Ng==", "bodyText": "Should be 8 bytes rather than 4.", "url": "https://github.com/eclipse-openj9/openj9/pull/9069#discussion_r401707056", "createdAt": "2020-04-01T15:31:34Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/runtime/ClassUnloadAssumption.cpp", "diffHunk": "@@ -716,6 +716,11 @@ void TR_UnloadedClassPicSite::compensate(TR_FrontEnd *, bool isSMP, void *)\n    value |= 0x03a00001;\n    *((uint32_t *)_picLocation) = value;\n    armCodeSync(_picLocation, 4);\n+#elif defined(TR_HOST_ARM64)\n+   // On aarch64, we use constant data snippet for class unloading pic site\n+   extern void arm64CodeSync(unsigned char *codeStart, unsigned int codeSize);\n+   *(int64_t *)_picLocation = -1;\n+   arm64CodeSync(_picLocation, 4);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c01dd4d906bcd6d8fe23a80a6e7d5642340a87c3"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcwNzY2NA==", "bodyText": "Where does AArch64 do this in a constant data snippet?  I'm looking for the code and can't seem to find it.", "url": "https://github.com/eclipse-openj9/openj9/pull/9069#discussion_r401707664", "createdAt": "2020-04-01T15:32:25Z", "author": {"login": "0xdaryl"}, "path": "runtime/compiler/runtime/ClassUnloadAssumption.cpp", "diffHunk": "@@ -716,6 +716,11 @@ void TR_UnloadedClassPicSite::compensate(TR_FrontEnd *, bool isSMP, void *)\n    value |= 0x03a00001;\n    *((uint32_t *)_picLocation) = value;\n    armCodeSync(_picLocation, 4);\n+#elif defined(TR_HOST_ARM64)\n+   // On aarch64, we use constant data snippet for class unloading pic site", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c01dd4d906bcd6d8fe23a80a6e7d5642340a87c3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4454a119d4bf5a39e3fed9c5367859a3a37c2315", "author": {"user": {"login": "Akira1Saitoh", "name": "Akira Saito"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/4454a119d4bf5a39e3fed9c5367859a3a37c2315", "committedDate": "2020-04-02T01:47:46Z", "message": "AArch64: Implement TR_UnloadedClassPicSite::compensate\n\nThis commit implements `TR_UnloadedClassPicSite::compensate` for aarch64.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c01dd4d906bcd6d8fe23a80a6e7d5642340a87c3", "author": {"user": {"login": "Akira1Saitoh", "name": "Akira Saito"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/c01dd4d906bcd6d8fe23a80a6e7d5642340a87c3", "committedDate": "2020-04-01T15:17:52Z", "message": "AArch64: Implement TR_UnloadedClassPicSite::compensate\n\nThis commit implements `TR_UnloadedClassPicSite::compensate` for aarch64.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>"}, "afterCommit": {"oid": "4454a119d4bf5a39e3fed9c5367859a3a37c2315", "author": {"user": {"login": "Akira1Saitoh", "name": "Akira Saito"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/4454a119d4bf5a39e3fed9c5367859a3a37c2315", "committedDate": "2020-04-02T01:47:46Z", "message": "AArch64: Implement TR_UnloadedClassPicSite::compensate\n\nThis commit implements `TR_UnloadedClassPicSite::compensate` for aarch64.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1391, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}