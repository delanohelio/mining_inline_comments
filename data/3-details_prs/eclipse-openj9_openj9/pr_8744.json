{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNTk3Mjk3", "number": 8744, "title": "Support Jcmd dump with default settings", "bodyText": "Support Jcmd dump with default settings\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default settings when the dump request doesn't have :file=name, modified the request string according to the incoming arguments.\nModified Jcmd help message;\nModified the test to adopt Jcmd without command argument;\nAdded a test for Jcmd with default settings;\nMinor refactoring.\ncloses: #8721\nReviewer: @DanHeidinga\nFYI: @pshipton\nSigned-off-by: Jason Feng fengj@ca.ibm.com", "createdAt": "2020-03-04T14:35:40Z", "url": "https://github.com/eclipse-openj9/openj9/pull/8744", "merged": true, "mergeCommit": {"oid": "03c0d48c9288bf8748113f7ff74b5dda9469024c"}, "closed": true, "closedAt": "2020-03-07T05:03:50Z", "author": {"login": "JasonFengJ9"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKY9DcAFqTM2ODg5NTAwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLNgr5gFqTM3MDcyMzI1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODk1MDA5", "url": "https://github.com/eclipse-openj9/openj9/pull/8744#pullrequestreview-368895009", "createdAt": "2020-03-04T15:49:43Z", "commit": {"oid": "d3e72e04a562fb62aacea62f1f7e5ff9eff5ed85"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNTo0OTo0M1rOFxyx2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNTo0OTo0M1rOFxyx2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc1NjUwNA==", "bodyText": "Any reason the existing native can't be used here, it looks like it would work.", "url": "https://github.com/eclipse-openj9/openj9/pull/8744#discussion_r387756504", "createdAt": "2020-03-04T15:49:43Z", "author": {"login": "pshipton"}, "path": "jcl/src/java.base/share/classes/openj9/internal/tools/attach/target/DiagnosticUtils.java", "diffHunk": "@@ -271,14 +272,23 @@ private static DiagnosticProperties doDump(String diagnosticCommand) {\n \t\t\t}\n \t\t\tif (!dumpType.isEmpty()) {\n \t\t\t\tString fileDirective = (\"system\".equals(dumpType) && IPC.isZOS) ? \":dsn=\" : \":file=\"; //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$\n-\n-\t\t\t\tString request = dumpType + fileDirective + parts[1];\n-\t\t\t\ttry {\n-\t\t\t\t\tString actualDumpFile = triggerDumpsImpl(request, dumpType + \"DumpToFile\"); //$NON-NLS-1$\n-\t\t\t\t\tresult = DiagnosticProperties.makeStringResult(\"Dump written to \" + actualDumpFile); //$NON-NLS-1$\n-\t\t\t\t} catch (InvalidDumpOptionExceptionBase e) {\n-\t\t\t\t\tIPC.logMessage(\"doDump exception: \", e.getMessage()); //$NON-NLS-1$\n-\t\t\t\t\tDiagnosticProperties.makeExceptionProperties(e);\n+\t\t\t\tif (parts.length == 1) {\n+\t\t\t\t\t// there is no file path/name specified, use default settings like -Xdump\n+\t\t\t\t\tint rc = triggerDefaultDumpsImpl(dumpType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3e72e04a562fb62aacea62f1f7e5ff9eff5ed85"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d3e72e04a562fb62aacea62f1f7e5ff9eff5ed85", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/d3e72e04a562fb62aacea62f1f7e5ff9eff5ed85", "committedDate": "2020-03-04T14:32:15Z", "message": "Support Jcmd dump with default settings\n\nAllow Jcmd Dump.heap/java/snap/system with default settings like -Xdump;\nAdded a native DiagnosticUtils.triggerDefaultDumpsImpl(dumpType);\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "f3ed828742402ce843fcb1d71309fc6945b0c562", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/f3ed828742402ce843fcb1d71309fc6945b0c562", "committedDate": "2020-03-04T19:23:43Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3ed828742402ce843fcb1d71309fc6945b0c562", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/f3ed828742402ce843fcb1d71309fc6945b0c562", "committedDate": "2020-03-04T19:23:43Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "8e823a319c2edcaa6abfc78f22c382aec9b8be71", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/8e823a319c2edcaa6abfc78f22c382aec9b8be71", "committedDate": "2020-03-05T21:37:39Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments;\nModified Jcmd help message;\nModified the test to adopt Jcmd without command argument;\nAdded a test for Jcmd with default settings;\nMinor refactoring.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48dbf741ec547abff94dfd29c385702249a69790", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/48dbf741ec547abff94dfd29c385702249a69790", "committedDate": "2020-03-06T03:36:26Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments;\nModified Jcmd help message;\nModified the test to adopt Jcmd without command argument;\nAdded a test for Jcmd with default settings;\nMinor refactoring.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e823a319c2edcaa6abfc78f22c382aec9b8be71", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/8e823a319c2edcaa6abfc78f22c382aec9b8be71", "committedDate": "2020-03-05T21:37:39Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments;\nModified Jcmd help message;\nModified the test to adopt Jcmd without command argument;\nAdded a test for Jcmd with default settings;\nMinor refactoring.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}, "afterCommit": {"oid": "48dbf741ec547abff94dfd29c385702249a69790", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/48dbf741ec547abff94dfd29c385702249a69790", "committedDate": "2020-03-06T03:36:26Z", "message": "Support Jcmd dump with default settings\n\nDiagnosticUtils.triggerDumpsImpl() can generate dump files with default\nsettings when the dump request doesn't have `:file=name`, modified the\nrequest string according to the incoming arguments;\nModified Jcmd help message;\nModified the test to adopt Jcmd without command argument;\nAdded a test for Jcmd with default settings;\nMinor refactoring.\n\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNzIzMjU1", "url": "https://github.com/eclipse-openj9/openj9/pull/8744#pullrequestreview-370723255", "createdAt": "2020-03-07T05:03:43Z", "commit": {"oid": "48dbf741ec547abff94dfd29c385702249a69790"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 654, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}