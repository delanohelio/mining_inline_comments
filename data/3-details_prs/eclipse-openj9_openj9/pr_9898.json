{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MjcwMDE5", "number": 9898, "title": "[Test] Adjust the setting of GC specific tests on RISC-V", "bodyText": "The test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\nSigned-off-by: Cheng Jin jincheng@ca.ibm.com", "createdAt": "2020-06-16T14:51:59Z", "url": "https://github.com/eclipse-openj9/openj9/pull/9898", "merged": true, "mergeCommit": {"oid": "29270ed1570f48ae903b86cf2fd0cf22058ddb06"}, "closed": true, "closedAt": "2020-07-06T19:38:23Z", "author": {"login": "ChengJin01"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsK1JVgFqTQzMjQ2ODIwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyWijggFqTQ0MzM1NjE2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDY4MjA3", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-432468207", "createdAt": "2020-06-17T14:35:51Z", "commit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDozNTo1MVrOGlIy5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDozNTo1MVrOGlIy5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU5NDU5OA==", "bodyText": "I believe you can just replace \"60\" to \"200\" regardless of platform. This extends valid range for parameter only.", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#discussion_r441594598", "createdAt": "2020-06-17T14:35:51Z", "author": {"login": "dmitripivkine"}, "path": "test/functional/cmdLineTests/gcRegressionTests/src/com/ibm/tests/garbagecollector/SpinAllocate.java", "diffHunk": "@@ -29,18 +29,25 @@\n public class SpinAllocate\n {\n \tpublic static Object _objectHolder;\n+\t\n+\t/* Given that the jdk runs very slow on RISC-V, we have to increase \n+\t * the threshold value to ensure the test is completed.\n+\t */\n+\tprivate static String archName = System.getProperty(\"os.arch\");\n+\tprivate static boolean isRiscv = archName.toLowerCase().contains(\"riscv\");\n+\tprivate static int threshold = (isRiscv) ? 200 : 60;\n \n \t/**\n \t * @param args Takes one argument:  number of seconds to spin for before terminating with a message that the test ran to completion.\n-\t * This argument is required.  It must be in the range [1-60]\n+\t * This argument is required.  It must be in the range [1-200]\n \t */\n \tpublic static void main(String[] args)\n \t{\n \t\tif (1 == args.length)\n \t\t{\n \t\t\tint secondsToSpin = Integer.parseInt(args[0]);\n \n-\t\t\tif ((secondsToSpin >= 1) && (secondsToSpin <= 60))\n+\t\t\tif ((secondsToSpin >= 1) && (secondsToSpin <= threshold))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDg1NjY0", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-432485664", "createdAt": "2020-06-17T14:53:19Z", "commit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1MzoxOVrOGlJmyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1MzoxOVrOGlJmyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwNzg4MA==", "bodyText": "From test correctness point of view we can replace \"5\" to \"200\" regardless of platform. The only issue with this it might increase hang detection time from 10 to 400 seconds. @llxia is it acceptable?", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#discussion_r441607880", "createdAt": "2020-06-17T14:53:19Z", "author": {"login": "dmitripivkine"}, "path": "test/functional/Java8andUp/src/org/openj9/test/nogc/TestGCPolicyNogc.java", "diffHunk": "@@ -118,7 +125,7 @@ public void testGCPolicyNogc() {\n \t\twhile (allocator.isAlive()) {\n \t\t\ttry {\n \t\t\t\tcount++;\n-\t\t\t\tif (count > 5) {\n+\t\t\t\tif (count > threshold) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTAzMDIx", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-432503021", "createdAt": "2020-06-17T15:09:44Z", "commit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNTowOTo0NFrOGlKaiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNTowOTo0NFrOGlKaiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYyMTEzMQ==", "bodyText": "I am not sure we need special version for RISC-V but just replace -Xms8m -Xmx8m to -Xms2m -Xmx2m for general. @amicic Any complains about this?", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#discussion_r441621131", "createdAt": "2020-06-17T15:09:44Z", "author": {"login": "dmitripivkine"}, "path": "test/functional/cmdLineTests/gcRegressionTests/gcRegressionTests.xml", "diffHunk": "@@ -227,6 +227,13 @@\n  \t<output regex=\"no\" type=\"failure\">Test ran to completion</output>\n  \t<output regex=\"no\" type=\"success\">java.lang.OutOfMemoryError</output>\n  </test>\n+ <test id=\"Excessive GC throws OOM on RISC-V\">\n+ \t<echo value=\"CMVC 148977:  Excessive GC throws OOM may fail if there is other activity on the machine - at least 5 GCs are required, in the 20 second test\" />\n+ \t<!-- does the test fail to run (thus implying that we encountered excessive GC)? -->\n+ \t<command>$EXE$ $XINT$ $ARGS_FOR_ALL_TESTS$ -Xdump:none -Xms2m -Xmx2m -Xgc:fvtest=forceExcessiveAllocFailureAfter=5 -verbose:gc -Xverbosegclog:foo.log $CP$ com.ibm.tests.garbagecollector.SpinAllocate 20</command>\n+ \t<output regex=\"no\" type=\"failure\">Test ran to completion</output>\n+ \t<output regex=\"no\" type=\"success\">java.lang.OutOfMemoryError</output>\n+ </test>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "184e782aa8f8b7cca16e256ae2540fce24851f39", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/184e782aa8f8b7cca16e256ae2540fce24851f39", "committedDate": "2020-06-16T14:51:06Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}, "afterCommit": {"oid": "4a3cf770e7d03e53742c90c18e600597eba11891", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/4a3cf770e7d03e53742c90c18e600597eba11891", "committedDate": "2020-06-17T20:20:24Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMTU5ODkw", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-443159890", "createdAt": "2020-07-06T15:03:40Z", "commit": {"oid": "4a3cf770e7d03e53742c90c18e600597eba11891"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMTYzNzgx", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-443163781", "createdAt": "2020-07-06T15:08:08Z", "commit": {"oid": "4a3cf770e7d03e53742c90c18e600597eba11891"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNTowODowOVrOGtbaTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNTowODowOVrOGtbaTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI4ODIwNg==", "bodyText": "Do you need this change? I thought we agreed to keep -Xms8m -Xmx8m for all non-RISC-V cases", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#discussion_r450288206", "createdAt": "2020-07-06T15:08:09Z", "author": {"login": "dmitripivkine"}, "path": "test/functional/cmdLineTests/gcRegressionTests/gcRegressionTests.xml", "diffHunk": "@@ -223,7 +223,14 @@\n  <test id=\"Excessive GC throws OOM\">\n  \t<echo value=\"CMVC 148977:  Excessive GC throws OOM may fail if there is other activity on the machine - at least 5 GCs are required, in the 20 second test\" />\n  \t<!-- does the test fail to run (thus implying that we encountered excessive GC)? -->\n- \t<command>$EXE$ $XINT$ $ARGS_FOR_ALL_TESTS$ -Xdump:none -Xms8m -Xmx8m -Xgc:fvtest=forceExcessiveAllocFailureAfter=5 -verbose:gc -Xverbosegclog:foo.log $CP$ com.ibm.tests.garbagecollector.SpinAllocate 20</command>\n+ \t<command>$EXE$ $XINT$ $ARGS_FOR_ALL_TESTS$ -Xdump:none -Xms2m -Xmx2m -Xgc:fvtest=forceExcessiveAllocFailureAfter=5 -verbose:gc -Xverbosegclog:foo.log $CP$ com.ibm.tests.garbagecollector.SpinAllocate 20</command>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a3cf770e7d03e53742c90c18e600597eba11891"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a3cf770e7d03e53742c90c18e600597eba11891", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/4a3cf770e7d03e53742c90c18e600597eba11891", "committedDate": "2020-06-17T20:20:24Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}, "afterCommit": {"oid": "151838253c128f56c6a3aa8811467464594aca74", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/151838253c128f56c6a3aa8811467464594aca74", "committedDate": "2020-07-06T15:13:26Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMTc0MzIw", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-443174320", "createdAt": "2020-07-06T15:20:01Z", "commit": {"oid": "151838253c128f56c6a3aa8811467464594aca74"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNToyMDowMlrOGtb5iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNToyMDowMlrOGtb5iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI5NjIwMQ==", "bodyText": "You did increase parameter range from [1-60] to [1-200] for SpinAllocate. Is there an intention to increase it here?", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#discussion_r450296201", "createdAt": "2020-07-06T15:20:02Z", "author": {"login": "dmitripivkine"}, "path": "test/functional/cmdLineTests/gcRegressionTests/gcRegressionTests.xml", "diffHunk": "@@ -227,6 +227,13 @@\n  \t<output regex=\"no\" type=\"failure\">Test ran to completion</output>\n  \t<output regex=\"no\" type=\"success\">java.lang.OutOfMemoryError</output>\n  </test>\n+ <test id=\"Excessive GC throws OOM on RISC-V\">\n+ \t<echo value=\"CMVC 148977:  Excessive GC throws OOM may fail if there is other activity on the machine - at least 5 GCs are required, in the 20 second test\" />\n+ \t<!-- does the test fail to run (thus implying that we encountered excessive GC)? -->\n+ \t<command>$EXE$ $XINT$ $ARGS_FOR_ALL_TESTS$ -Xdump:none -Xms2m -Xmx2m -Xgc:fvtest=forceExcessiveAllocFailureAfter=5 -verbose:gc -Xverbosegclog:foo.log $CP$ com.ibm.tests.garbagecollector.SpinAllocate 20</command>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "151838253c128f56c6a3aa8811467464594aca74"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47", "committedDate": "2020-07-06T16:50:12Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "151838253c128f56c6a3aa8811467464594aca74", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/151838253c128f56c6a3aa8811467464594aca74", "committedDate": "2020-07-06T15:13:26Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}, "afterCommit": {"oid": "5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47", "author": {"user": {"login": "ChengJin01", "name": "Cheng Jin"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47", "committedDate": "2020-07-06T16:50:12Z", "message": "[Test] Adjust the setting of GC specific tests on RISC-V\n\nThe test change is to update the initial memory setting &\nthe threshold values in GC specific tests to ensure the\nJVM works appropriately as expected in tests due to the\nlack of JIT on RISC-V.\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMjU4NTI3", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-443258527", "createdAt": "2020-07-06T17:03:33Z", "commit": {"oid": "5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMzU2MTY1", "url": "https://github.com/eclipse-openj9/openj9/pull/9898#pullrequestreview-443356165", "createdAt": "2020-07-06T19:37:57Z", "commit": {"oid": "5f3a1f6f69b045aecc0b52b0d4419cb8d27abb47"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 693, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}