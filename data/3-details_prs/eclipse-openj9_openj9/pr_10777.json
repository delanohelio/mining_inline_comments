{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTgyNjk2", "number": 10777, "title": "Reduce the number of TargetVM in test_startupShutdownRobustness()", "bodyText": "Changed the number of TargetVM from 10 to 5 to ensure all target VM can be notified when the target folders are deleted;\nAdded more log messages and trace points.\nNote: In normal scenarios, the number of TargetVM can be determined via https://github.com/eclipse/openj9/blob/b71e0caddf3a6170fe368305fbbd1e2a8187b62a/jcl/src/java.base/share/classes/openj9/internal/tools/attach/target/WaitLoop.java#L108-L110\nWhen the target folder are deleted, the number of target is determined via https://github.com/eclipse/openj9/blob/b71e0caddf3a6170fe368305fbbd1e2a8187b62a/jcl/src/java.base/share/classes/openj9/internal/tools/attach/target/AttachHandler.java#L459-L464\nwhich is around 7 in usual case, and eventually causes some targetVM not notified.\nDeleting the target folders are not normal usages, this is a test issue, changing the target VM number to 5 fixed the issue (verified in grinders).\ncloses #7010\nSigned-off-by: Jason Feng fengj@ca.ibm.com", "createdAt": "2020-10-03T00:08:53Z", "url": "https://github.com/eclipse-openj9/openj9/pull/10777", "merged": true, "mergeCommit": {"oid": "5d9f96ddded3330fb78b38b2956b5e4529fc185e"}, "closed": true, "closedAt": "2020-10-05T23:59:55Z", "author": {"login": "JasonFengJ9"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOrX4vgH2gAyNDk3MTgyNjk2OjhiZDg1MzJkY2RiNDAzNjg0N2U0YmYyM2NlOTY1ZGE2ZmY3NGFjY2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPs1AQgFqTUwMjQ5ODYyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8bd8532dcdb4036847e4bf23ce965da6ff74accb", "author": {"user": {"login": "JasonFengJ9", "name": "Jason Feng"}}, "url": "https://github.com/eclipse-openj9/openj9/commit/8bd8532dcdb4036847e4bf23ce965da6ff74accb", "committedDate": "2020-10-02T19:44:11Z", "message": "Reduce the number of TargetVM in test_startupShutdownRobustness()\n\nChanged the number of TargetVM from 10 to 5 to ensure all target VM can\nbe notified when the target folders are deleted;\nAdded more log messages and trace points.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMTU1MDY2", "url": "https://github.com/eclipse-openj9/openj9/pull/10777#pullrequestreview-502155066", "createdAt": "2020-10-05T15:09:01Z", "commit": {"oid": "8bd8532dcdb4036847e4bf23ce965da6ff74accb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNTowOTowMVrOHchgVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNTowOTowMVrOHchgVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3MTEyNQ==", "bodyText": "Since only AIX has a problem with the larger number, perhaps this change should be platform specific so as not to change the testing for other platforms.", "url": "https://github.com/eclipse-openj9/openj9/pull/10777#discussion_r499671125", "createdAt": "2020-10-05T15:09:01Z", "author": {"login": "pshipton"}, "path": "test/functional/Java8andUp/src/org/openj9/test/attachAPI/TestAttachErrorHandling.java", "diffHunk": "@@ -96,15 +96,17 @@ public void testTracepoint() {\n \tpublic void test_startupShutdownRobustness() throws IOException {\n \t\tFile ipcDir=new File(System.getProperty(\"java.io.tmpdir\"), testName);\n \t\tipcDir.mkdir();\n+\t\tlogger.debug(\"test_startupShutdownRobustness ipcDir = \" + ipcDir.getAbsolutePath());\n \t\tFile logDir=new File(System.getProperty(\"java.io.tmpdir\"), testName+\"_logs\");\n \t\tlogDir.mkdir();\n+\t\tlogger.debug(\"test_startupShutdownRobustness logDir = \" + logDir.getAbsolutePath());\n \t\t\n \t\tArrayList<TargetManager> targets = new ArrayList<TargetManager>();\n \t\tArrayList<String> vmArgs = new ArrayList<String>();\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.directory=\"+ ipcDir.getAbsolutePath());\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.logging=yes\");\n \t\tvmArgs.add(\"-Dcom.ibm.tools.attach.log.name=\"+logDir.getAbsolutePath()+File.separatorChar);\n-\t\tfor (int i = 0; i < 10; ++i)  {\n+\t\tfor (int i = 0; i < 5; ++i)  {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8532dcdb4036847e4bf23ce965da6ff74accb"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDk4NjIw", "url": "https://github.com/eclipse-openj9/openj9/pull/10777#pullrequestreview-502498620", "createdAt": "2020-10-05T23:59:49Z", "commit": {"oid": "8bd8532dcdb4036847e4bf23ce965da6ff74accb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 369, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}