{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2Mjc1MjA1", "number": 3184, "title": "TRUNK-5728: Condition to be linked to an Encounter", "bodyText": "Description of what I changed\nLinking Condition to the Encounter domain. Checkout this talk thread for more details.\nIssue I worked on\nsee https://issues.openmrs.org/browse/TRUNK-5728", "createdAt": "2020-04-20T20:08:42Z", "url": "https://github.com/openmrs/openmrs-core/pull/3184", "merged": true, "mergeCommit": {"oid": "53e4d9ce7b94b4c6e7cb0f7b817244664d3c0124"}, "closed": true, "closedAt": "2020-05-19T22:16:54Z", "author": {"login": "samuelmale"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZyuqygBqjMyNTU5NjczMzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABci8vw9gFqTQxNDg4MzI4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "65af7ef3412c342d14df76f14d2afb870e768f58", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/65af7ef3412c342d14df76f14d2afb870e768f58", "committedDate": "2020-04-21T11:32:36Z", "message": "Delete header.vm.save.1"}, "afterCommit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/47c88f12bc30ace26157e1139732d2583a1e63ae", "committedDate": "2020-04-21T12:20:00Z", "message": "TRUNK-5728: Condition to be linked to an Encounter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Mjg4MjI3", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-397288227", "createdAt": "2020-04-21T12:40:11Z", "commit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMjo0MDoxMVrOGJDiig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMjo0NTozOFrOGJDxUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjE0ODM2Mg==", "bodyText": "@since 2.4.0, 2.3.1\nAnd everywhere where you did use @since.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r412148362", "createdAt": "2020-04-21T12:40:11Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/Condition.java", "diffHunk": "@@ -328,6 +332,28 @@ public void setPatient(Patient patient) {\n \t\tthis.patient = patient;\n \t}\n \t\n+\t/**\n+\t * Basic property getter for encounter\n+\t * \n+\t * @return encounter - the associated encounter\n+\t * @since 2.4.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjE1MjE0NQ==", "bodyText": "Then I would expect test showing that conditions can be set and gotten from an encounter.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r412152145", "createdAt": "2020-04-21T12:45:38Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/Encounter.java", "diffHunk": "@@ -486,6 +489,26 @@ public void setDiagnoses(Set<Diagnosis> diagnoses) {\n \t\tthis.diagnoses = diagnoses;\n \t}\n \t\n+\t/**\n+\t * Basic property getter for conditions\n+\t * \n+\t * @return conditions - set of conditions\n+\t * @since 2.4.0\n+\t */\n+\tpublic Set<Condition> getConditions() {\n+\t\treturn conditions;\n+\t}\n+\n+\t/**\n+\t * Basic property setter for conditions\n+\t *  \n+\t * @param conditions - set of conditions\n+\t * @since 2.4.0\n+\t */\n+\tpublic void setConditions(Set<Condition> conditions) {\n+\t\tthis.conditions = conditions;\n+\t}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjYyNzg4", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-397662788", "createdAt": "2020-04-21T20:46:42Z", "commit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0Njo0MlrOGJXxow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0Njo0MlrOGJXxow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ3OTkwNw==", "bodyText": "Why change an existing test? Is it because this change made it fail?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r412479907", "createdAt": "2020-04-21T20:46:42Z", "author": {"login": "dkayiwa"}, "path": "api/src/test/java/org/openmrs/api/impl/ConditionServiceImplTest.java", "diffHunk": "@@ -61,13 +61,15 @@ public void saveCondition_shouldSaveNewCondition(){\n \t\tcondition.setClinicalStatus(ConditionClinicalStatus.ACTIVE);\n \t\tcondition.setUuid(uuid);\n \t\tcondition.setPatient(new Patient(patientId));\n+\t\tcondition.setEncounter(new Encounter(2039));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47c88f12bc30ace26157e1139732d2583a1e63ae"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa0be985fbc9056628938ef2d0e245a10cb59a3e", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/aa0be985fbc9056628938ef2d0e245a10cb59a3e", "committedDate": "2020-05-12T11:08:35Z", "message": "TRUNK-5728: Existing tests should not be tampered with"}, "afterCommit": {"oid": "d4f167ab6633869e3fa32602e43e79a3ff6f20ec", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/d4f167ab6633869e3fa32602e43e79a3ff6f20ec", "committedDate": "2020-05-13T11:37:33Z", "message": "TRUNK-5728: Existing tests should not be tampered with"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4f167ab6633869e3fa32602e43e79a3ff6f20ec", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/d4f167ab6633869e3fa32602e43e79a3ff6f20ec", "committedDate": "2020-05-13T11:37:33Z", "message": "TRUNK-5728: Existing tests should not be tampered with"}, "afterCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/b42ffcdc0545819ae52f126626e12b08a34997c4", "committedDate": "2020-05-14T09:41:40Z", "message": "TRUNK-5728: Condition to be linked to an Encounter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNjU2MzE5", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-411656319", "createdAt": "2020-05-14T10:07:02Z", "commit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMDowNzowM1rOGVVSiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMDoxODozM1rOGVVtiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyMjA5MQ==", "bodyText": "@since 2.4.0, 2.3.1", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425022091", "createdAt": "2020-05-14T10:07:03Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/Encounter.java", "diffHunk": "@@ -486,6 +489,26 @@ public void setDiagnoses(Set<Diagnosis> diagnoses) {\n \t\tthis.diagnoses = diagnoses;\n \t}\n \t\n+\t/**\n+\t * Basic property getter for conditions\n+\t * \n+\t * @return conditions - set of conditions\n+\t * @since 2.4.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyMjI0OA==", "bodyText": "@since 2.4.0, 2.3.1", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425022248", "createdAt": "2020-05-14T10:07:19Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/Encounter.java", "diffHunk": "@@ -486,6 +489,26 @@ public void setDiagnoses(Set<Diagnosis> diagnoses) {\n \t\tthis.diagnoses = diagnoses;\n \t}\n \t\n+\t/**\n+\t * Basic property getter for conditions\n+\t * \n+\t * @return conditions - set of conditions\n+\t * @since 2.4.0\n+\t */\n+\tpublic Set<Condition> getConditions() {\n+\t\treturn conditions;\n+\t}\n+\n+\t/**\n+\t * Basic property setter for conditions\n+\t *  \n+\t * @param conditions - set of conditions\n+\t * @since 2.4.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyMjQ2OA==", "bodyText": "@since 2.4.0, 2.3.1", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425022468", "createdAt": "2020-05-14T10:07:36Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/api/ConditionService.java", "diffHunk": "@@ -73,6 +74,16 @@\n \t@Authorized({ PrivilegeConstants.GET_CONDITIONS })\n \tList<Condition> getAllConditions(Patient patient) throws APIException;\n \n+\t/**\n+\t * Gets all conditions(not voided) of an encounter.\n+\t * \n+\t * @param encounter - the encounter to retrieve conditions for\n+\t * @return a list of encounter's conditions\n+\t * @throws APIException\n+\t * @since 2.4.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyMzYzNA==", "bodyText": "Looks like you're touching more than you should, can you clean this up?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425023634", "createdAt": "2020-05-14T10:09:32Z", "author": {"login": "mks-d"}, "path": "api/src/main/resources/org/openmrs/liquibase/updates/liquibase-update-to-latest-2.3.x.xml", "diffHunk": "@@ -92,4 +92,54 @@\n \t\t\t<where>system_id='admin'</where>\n \t\t</update>\n \t</changeSet>\n+\t\n+\t<changeSet id=\"TRUNK-5671-20191017\" author=\"Wyclif\">\n+\t\t<preConditions onFail=\"MARK_RAN\">\n+\t\t\t<not>\n+\t\t\t\t<tableExists tableName=\"provider_unused_fields\" />\n+\t\t\t</not>\n+\t\t</preConditions>\n+\t\t<comment>Adding provider_unused_fields table</comment>\n+\t\t<createTable tableName=\"provider_unused_fields\">\n+\t\t\t<column name=\"provider_id\" type=\"int\" >\n+\t\t\t\t<constraints nullable=\"false\" unique=\"true\" />\n+\t\t\t</column>\n+\t\t\t<column name=\"description\" type=\"varchar(1)\" />\n+\t\t</createTable>\n+\t</changeSet>\n+\t <changeSet id=\"20190815-Trunk-5650\" author=\"gitacliff\">\n+\t\t<preConditions onFail=\"MARK_RAN\">\n+\t\t\t<not>\n+\t\t\t\t<columnExists tableName=\"order_group\" columnName=\"parent_order_group\"/>\t\t\t\t\n+\t\t\t</not>\n+\t\t</preConditions>\n+\t\t<comment>Adding \"parent_order_group\" column to order_group table</comment>\n+        <addColumn tableName=\"order_group\">\n+            <column name=\"parent_order_group\" type=\"int\">\n+            \t<constraints nullable=\"true\"/>\n+            </column>\n+        </addColumn><addForeignKeyConstraint baseTableName=\"order_group\"\n+\t\t\t\t\t\t\t\t baseColumnNames=\"parent_order_group\"\n+\t\t\t\t\t\t\t\t constraintName=\"order_group_parent_order_group_fk\"\n+\t\t\t\t\t\t\t\t referencedTableName=\"order_group\"\n+\t\t\t\t\t\t\t\t referencedColumnNames=\"order_group_id\" />\n+    </changeSet>\n+    \n+    <changeSet id=\"TRUNK-5728-2020-04-15\" author=\"samuel34\">\n+    \t<preConditions>\n+    \t\t<not>\n+    \t\t\t<columnExists tableName=\"conditions\" columnName=\"encounter_id\"/>\n+    \t\t</not>\n+    \t</preConditions>\n+    \t<comment>Adding 'encounter_id' column to 'conditions' table</comment>\n+    \t<addColumn tableName=\"conditions\">\n+    \t\t<column name=\"encounter_id\" type=\"int\">\n+    \t\t\t<constraints nullable=\"true\" />\n+    \t\t</column>\n+    \t</addColumn>\n+    \t<addForeignKeyConstraint constraintName=\"encounter_id_fk\"\n+\t\t\t\t\t\t\t\t baseTableName=\"conditions\" baseColumnNames=\"encounter_id\"\n+\t\t\t\t\t\t\t\t referencedTableName=\"encounter\" referencedColumnNames=\"encounter_id\" />\n+    </changeSet>\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyNDQyNA==", "bodyText": "Cleaning up .gitignore files should be done through an ad-hoc ticket/PRs.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425024424", "createdAt": "2020-05-14T10:10:42Z", "author": {"login": "mks-d"}, "path": "api/.gitignore", "diffHunk": "@@ -0,0 +1 @@\n+/target/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyNjQ4MQ==", "bodyText": "@dkayiwa / @ibacher what do you think, should this just be getConditionsForEncounter(Encounter) or even getConditions(Encounter)?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425026481", "createdAt": "2020-05-14T10:14:09Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/api/ConditionService.java", "diffHunk": "@@ -73,6 +74,16 @@\n \t@Authorized({ PrivilegeConstants.GET_CONDITIONS })\n \tList<Condition> getAllConditions(Patient patient) throws APIException;\n \n+\t/**\n+\t * Gets all conditions(not voided) of an encounter.\n+\t * \n+\t * @param encounter - the encounter to retrieve conditions for\n+\t * @return a list of encounter's conditions\n+\t * @throws APIException\n+\t * @since 2.4.0\n+\t */\n+\tList<Condition> getConditionsByEncounter(Encounter encounter) throws APIException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyNzQzNA==", "bodyText": "We need to assert that the conditions that are returned are actually those that are expected. Use two conditions as well to enforce the use of an actual \"collection\".", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425027434", "createdAt": "2020-05-14T10:15:47Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/EncounterServiceTest.java", "diffHunk": "@@ -382,6 +384,20 @@ public void saveEncounter_shouldSaveEncounterWithComplexObs() {\n \t\tassertEquals(2, encounter.getObsAtTopLevel(true).size());\n \t}\n \t\n+\t@Test\n+\tpublic void saveEncounter_shouldSaveEncounterWithCondition() {\n+\t\tEncounter encounter = buildEncounter();\n+\t\tCondition condition = new Condition();\n+\t\t\n+\t\tcondition.setPatient(encounter.getPatient());\n+\t\tencounter.setConditions(Collections.singleton(condition));\n+\t\tEncounterService es = Context.getEncounterService();\n+\t\tes.saveEncounter(encounter);\n+\t\t\n+\t\tencounter = es.getEncounter(encounter.getId());\n+\t\tassertEquals(1, encounter.getConditions().size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyNzc0MQ==", "bodyText": "saveCondition_shouldSaveConditionAssociatedWithAnEncounter", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425027741", "createdAt": "2020-05-14T10:16:19Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/impl/ConditionServiceImplTest.java", "diffHunk": "@@ -70,6 +70,21 @@ public void saveCondition_shouldSaveNewCondition(){\n \t\tAssert.assertNotNull(savedCondition.getConditionId());\n \t}\n \n+\t/**\n+\t * @see ConditionService#saveCondition(Condition)\n+\t */\n+\t@Test\n+\tpublic void saveCondition_shouldSaveConditionWithAnEncounter() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyODM5OQ==", "bodyText": "Always use the given/when/then pattern when writing tests. This makes easier for the reader to find what you actually replay.\nUnless @dkayiwa thinks differently?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425028399", "createdAt": "2020-05-14T10:17:30Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/EncounterServiceTest.java", "diffHunk": "@@ -382,6 +384,20 @@ public void saveEncounter_shouldSaveEncounterWithComplexObs() {\n \t\tassertEquals(2, encounter.getObsAtTopLevel(true).size());\n \t}\n \t\n+\t@Test\n+\tpublic void saveEncounter_shouldSaveEncounterWithCondition() {\n+\t\tEncounter encounter = buildEncounter();\n+\t\tCondition condition = new Condition();\n+\t\t\n+\t\tcondition.setPatient(encounter.getPatient());\n+\t\tencounter.setConditions(Collections.singleton(condition));\n+\t\tEncounterService es = Context.getEncounterService();\n+\t\tes.saveEncounter(encounter);\n+\t\t\n+\t\tencounter = es.getEncounter(encounter.getId());\n+\t\tassertEquals(1, encounter.getConditions().size());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyNzQzNA=="}, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyODk4Ng==", "bodyText": "Cleaning up .gitignore files should be done through an ad-hoc ticket/PRs.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425028986", "createdAt": "2020-05-14T10:18:30Z", "author": {"login": "mks-d"}, "path": "tools/.gitignore", "diffHunk": "@@ -0,0 +1 @@\n+/target/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAyOTAwMw==", "bodyText": "Cleaning up .gitignore files should be done through an ad-hoc ticket/PRs.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r425029003", "createdAt": "2020-05-14T10:18:33Z", "author": {"login": "mks-d"}, "path": "web/.gitignore", "diffHunk": "@@ -0,0 +1 @@\n+/target/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "503c8eb72682e83d3dc921927145668888ecb029", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/503c8eb72682e83d3dc921927145668888ecb029", "committedDate": "2020-05-15T14:06:13Z", "message": "TRUNK-5728: Condition to be linked to an Encounter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b42ffcdc0545819ae52f126626e12b08a34997c4", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/b42ffcdc0545819ae52f126626e12b08a34997c4", "committedDate": "2020-05-14T09:41:40Z", "message": "TRUNK-5728: Condition to be linked to an Encounter"}, "afterCommit": {"oid": "503c8eb72682e83d3dc921927145668888ecb029", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/503c8eb72682e83d3dc921927145668888ecb029", "committedDate": "2020-05-15T14:06:13Z", "message": "TRUNK-5728: Condition to be linked to an Encounter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "148a6756cd468d064b9679baa2bfb8bb653548d7", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/148a6756cd468d064b9679baa2bfb8bb653548d7", "committedDate": "2020-05-15T14:13:56Z", "message": "TRUNK-5728: Adding minor release version 2.3.1 to @since annotation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/177c79d8f10c9bc5470a28ddb6edd4c13a656d09", "committedDate": "2020-05-15T14:16:28Z", "message": "TRUNK-5728: Fixing a minor formating"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNDM5Mzg2", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-413439386", "createdAt": "2020-05-18T09:50:15Z", "commit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwOTo1MDoxNVrOGWvw_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwOTo1ODoxM1rOGWwEuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwNDQ0Ng==", "bodyText": "Using streams?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r426504446", "createdAt": "2020-05-18T09:50:15Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/api/impl/EncounterServiceImpl.java", "diffHunk": "@@ -196,6 +197,11 @@ public Encounter saveEncounter(Encounter encounter) throws APIException {\n \n \t\tremoveGivenObsAndTheirGroupMembersFromEncounter(obsToRemove, encounter);\n \t\taddGivenObsAndTheirGroupMembersToEncounter(obsToAdd, encounter);\n+\t\t\n+\t\t// save the conditions\n+\t\tfor (Condition condition : encounter.getConditions()) {\n+\t\t\tContext.getConditionService().saveCondition(condition);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwODc1OQ==", "bodyText": "This is part of the replay.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r426508759", "createdAt": "2020-05-18T09:57:02Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/EncounterServiceTest.java", "diffHunk": "@@ -382,6 +385,38 @@ public void saveEncounter_shouldSaveEncounterWithComplexObs() {\n \t\tassertEquals(2, encounter.getObsAtTopLevel(true).size());\n \t}\n \t\n+\t@Test\n+\tpublic void saveEncounter_shouldCascadeSaveToContainedConditions() {\n+\t\t// setup\n+\t\tEncounter encounter = buildEncounter();\n+\t\tCondition pregnancy = new Condition();\n+\t\tCodedOrFreeText freeTextForPregnancy = new CodedOrFreeText();\n+\t\tfreeTextForPregnancy.setNonCoded(\"Pregnancy\");\n+\t\tpregnancy.setCondition(freeTextForPregnancy);\n+\t\tpregnancy.setPatient(encounter.getPatient());\n+\t\tencounter.addCondition(pregnancy);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwODg3OQ==", "bodyText": "This is part of the replay as well.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r426508879", "createdAt": "2020-05-18T09:57:13Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/EncounterServiceTest.java", "diffHunk": "@@ -382,6 +385,38 @@ public void saveEncounter_shouldSaveEncounterWithComplexObs() {\n \t\tassertEquals(2, encounter.getObsAtTopLevel(true).size());\n \t}\n \t\n+\t@Test\n+\tpublic void saveEncounter_shouldCascadeSaveToContainedConditions() {\n+\t\t// setup\n+\t\tEncounter encounter = buildEncounter();\n+\t\tCondition pregnancy = new Condition();\n+\t\tCodedOrFreeText freeTextForPregnancy = new CodedOrFreeText();\n+\t\tfreeTextForPregnancy.setNonCoded(\"Pregnancy\");\n+\t\tpregnancy.setCondition(freeTextForPregnancy);\n+\t\tpregnancy.setPatient(encounter.getPatient());\n+\t\tencounter.addCondition(pregnancy);\n+\t\t\n+\t\tCondition edema = new Condition();\n+\t\tCodedOrFreeText freeTextForEdema = new CodedOrFreeText();\n+\t\tfreeTextForEdema.setNonCoded(\"Edema\");\n+\t\tedema.setCondition(freeTextForEdema);\n+\t\tedema.setPatient(encounter.getPatient());\n+\t\tencounter.addCondition(edema);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUwOTQ5Nw==", "bodyText": "This is part of the replay.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r426509497", "createdAt": "2020-05-18T09:58:13Z", "author": {"login": "mks-d"}, "path": "api/src/test/java/org/openmrs/api/impl/ConditionServiceImplTest.java", "diffHunk": "@@ -70,6 +70,26 @@ public void saveCondition_shouldSaveNewCondition(){\n \t\tAssert.assertNotNull(savedCondition.getConditionId());\n \t}\n \n+\t/**\n+\t * @see ConditionService#saveCondition(Condition)\n+\t */\n+\t@Test\n+\tpublic void saveCondition_shouldSaveConditionAssociatedWithAnEncounter() {\n+\t\t// setup\n+\t\tString uuid = \"fc281d91-cb1a-4cd1-b1ca-0f3cd5138fb2\";\n+\t\tCondition condition = new Condition();\n+\t\tcondition.setUuid(uuid);\n+\t\tcondition.setPatient(new Patient(2));\n+\t\tcondition.setEncounter(new Encounter(2039));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "177c79d8f10c9bc5470a28ddb6edd4c13a656d09"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b56869eb7758d521b6c3837dc47a1431f395f50", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/7b56869eb7758d521b6c3837dc47a1431f395f50", "committedDate": "2020-05-18T12:30:56Z", "message": "TRUNK-5728: Using Java 8 streams"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MjY2NjU2", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414266656", "createdAt": "2020-05-19T09:29:10Z", "commit": {"oid": "7b56869eb7758d521b6c3837dc47a1431f395f50"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af", "author": {"user": {"login": "ibacher", "name": "Ian"}}, "url": "https://github.com/openmrs/openmrs-core/commit/93f09a7bbeb3ff0e75f569c6ac4614847a31c4af", "committedDate": "2020-05-19T13:32:43Z", "message": "Remove extraneous whitespace"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDQ5MTEz", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414449113", "createdAt": "2020-05-19T13:33:14Z", "commit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjI0ODUw", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414624850", "createdAt": "2020-05-19T16:32:51Z", "commit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjozMjo1MVrOGXo2JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjozMjo1MVrOGXo2JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQzOTY1Mg==", "bodyText": "I get scared when you add an encounter_id to existing conditions. It looks as if they no longer save without encounters, yet they are optional.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r427439652", "createdAt": "2020-05-19T16:32:51Z", "author": {"login": "dkayiwa"}, "path": "api/src/test/resources/org/openmrs/api/include/ConditionServiceImplTest-SetupCondition.xml", "diffHunk": "@@ -11,17 +11,21 @@\n \n -->\n <dataset>\n-\t<conditions condition_id=\"1\" patient_id=\"2\" clinical_status=\"INACTIVE\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" \n+\n+\t<encounter encounter_id=\"2039\" encounter_type=\"2\" patient_id=\"2\" location_id=\"1\" form_id=\"1\" encounter_datetime=\"2020-04-20 14:09:05.0\" \n+\t\t\t\tcreator=\"1\" date_created=\"2020-04-20 14:09:05.0\" voided=\"false\" uuid=\"0519d652-393b-4118-9c83-a3715b82d4av\"/>\n+\n+\t<conditions condition_id=\"1\" patient_id=\"2\" clinical_status=\"INACTIVE\" encounter_id=\"2039\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" \n \t\t\t   voided=\"false\" onset_date=\"2017-01-12 00:00:00\" end_date=\"2017-01-15 00:00:00\" verification_status=\"PROVISIONAL\" \n \t\t\t   uuid=\"2cc6880e-2c46-15e4-9038-a6c5e4d22fb7\"/>\n \t<conditions condition_id=\"2\" patient_id=\"2\" clinical_status=\"ACTIVE\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" \n \t\t\t   voided=\"false\" onset_date=\"2017-01-12 00:00:50\" verification_status=\"CONFIRMED\" \n \t\t\t   uuid=\"2cc6880e-2c46-11e4-9138-a6c5e4d20fb7\"/>\n-\t<conditions condition_id=\"4\" patient_id=\"2\" clinical_status=\"ACTIVE\" creator=\"1\" date_created=\"2016-01-12 00:00:00\" ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjM1MjY3", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414635267", "createdAt": "2020-05-19T16:45:48Z", "commit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjo0NTo0OFrOGXpWmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjo0NTo0OFrOGXpWmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ0Nzk2MQ==", "bodyText": "I get scared when you add an encounter_id to existing conditions. It looks as if they no longer save without encounters, yet they are optional.\n\n@dkayiwa I actually didn't touch all. This justifies that the changes are backwards compatible. The above entry doesn't have an encounter_id column. Does it still worry you?", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r427447961", "createdAt": "2020-05-19T16:45:48Z", "author": {"login": "samuelmale"}, "path": "api/src/test/resources/org/openmrs/api/include/ConditionServiceImplTest-SetupCondition.xml", "diffHunk": "@@ -11,17 +11,21 @@\n \n -->\n <dataset>\n-\t<conditions condition_id=\"1\" patient_id=\"2\" clinical_status=\"INACTIVE\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" \n+\n+\t<encounter encounter_id=\"2039\" encounter_type=\"2\" patient_id=\"2\" location_id=\"1\" form_id=\"1\" encounter_datetime=\"2020-04-20 14:09:05.0\" \n+\t\t\t\tcreator=\"1\" date_created=\"2020-04-20 14:09:05.0\" voided=\"false\" uuid=\"0519d652-393b-4118-9c83-a3715b82d4av\"/>\n+\n+\t<conditions condition_id=\"1\" patient_id=\"2\" clinical_status=\"INACTIVE\" encounter_id=\"2039\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" \n \t\t\t   voided=\"false\" onset_date=\"2017-01-12 00:00:00\" end_date=\"2017-01-15 00:00:00\" verification_status=\"PROVISIONAL\" \n \t\t\t   uuid=\"2cc6880e-2c46-15e4-9038-a6c5e4d22fb7\"/>\n \t<conditions condition_id=\"2\" patient_id=\"2\" clinical_status=\"ACTIVE\" creator=\"1\" date_created=\"2015-01-12 00:00:00\" ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93f09a7bbeb3ff0e75f569c6ac4614847a31c4af"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/05a77adb72d1e81400e34195c7748fbcd5aff247", "committedDate": "2020-05-19T21:02:19Z", "message": "TRUNK-5728: Existing rows in the test datasets should not be tampered\u2026"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a57acc85e736d3ccb57f51496d0b69a114f44635", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/a57acc85e736d3ccb57f51496d0b69a114f44635", "committedDate": "2020-05-19T20:32:04Z", "message": "TRUNK-5728: Existing rows in the test datasets should not be tampered with"}, "afterCommit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/05a77adb72d1e81400e34195c7748fbcd5aff247", "committedDate": "2020-05-19T21:02:19Z", "message": "TRUNK-5728: Existing rows in the test datasets should not be tampered\u2026"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODI1ODE3", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414825817", "createdAt": "2020-05-19T21:10:28Z", "commit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMToxMDoyOFrOGXywFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMToxMDoyOFrOGXywFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYwMTk0Mg==", "bodyText": "I would not silently ignore one passing a null parameter. In other words, i would remove the if check and assume that the condition is not null. If it turns out to be null, better for the caller to automatically get a NullPointerException than chewing it quietly.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r427601942", "createdAt": "2020-05-19T21:10:28Z", "author": {"login": "dkayiwa"}, "path": "api/src/main/java/org/openmrs/Encounter.java", "diffHunk": "@@ -486,6 +489,52 @@ public void setDiagnoses(Set<Diagnosis> diagnoses) {\n \t\tthis.diagnoses = diagnoses;\n \t}\n \t\n+\t/**\n+\t * Basic property getter for conditions\n+\t * \n+\t * @return conditions - set of conditions\n+\t * @since 2.4.0, 2.3.1\n+\t */\n+\tpublic Set<Condition> getConditions() {\n+\t\tif (conditions == null) {\n+\t\t\tconditions = new LinkedHashSet<>();\n+\t\t}\n+\t\treturn conditions;\n+\t}\n+\n+\t/**\n+\t * Basic property setter for conditions\n+\t *  \n+\t * @param conditions - set of conditions\n+\t * @since 2.4.0, 2.3.1\n+\t */\n+\tpublic void setConditions(Set<Condition> conditions) {\n+\t\tthis.conditions = conditions;\n+\t}\n+\n+\t/**\n+\t * Add the given Condition to the set of conditions for this Encounter\n+\t *\n+\t * @param condition - the condition to add\n+\t */\n+\tpublic void addCondition(Condition condition) {\n+\t\tif (condition != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODQ2NjQz", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414846643", "createdAt": "2020-05-19T21:45:51Z", "commit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMTo0NTo1MVrOGXzydw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMTo0NTo1MVrOGXzydw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYxODkzNQ==", "bodyText": "I would not silently ignore one passing a null parameter. In other words, i would remove the if check and assume that the condition is not null. If it turns out to be null, better for the caller to automatically get a NullPointerException than chewing it quietly.\n\n@dkayiwa this was by design that the method addCondition(Condition) is null safe.\nI was simply following the behaviours  portrayed by existing addXxxx(Xxxx) methods in the codebase. An example is addObs(Observation)", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r427618935", "createdAt": "2020-05-19T21:45:51Z", "author": {"login": "samuelmale"}, "path": "api/src/test/java/org/openmrs/EncounterTest.java", "diffHunk": "@@ -954,6 +954,66 @@ public void removeOrder_shouldNotFailWhenRemovingNonExistentOrder() {\n \t\tencounter.removeOrder(new Order(123));\n \t}\n \t\n+\t/**\n+\t * @see Encounter#addCondition(Condition)\n+\t */\n+\t@Test\n+\tpublic void addCondition_shouldSetEncounterAttribute() {\n+\t\t// setup\n+\t\tEncounter encounter = new Encounter();\n+\t\tCondition condition = new Condition();\n+\t\t\n+\t\t// replay\n+\t\tencounter.addCondition(condition);\n+\t\t\n+\t\t// verify\n+\t\tassertTrue(condition.getEncounter().equals(encounter));\n+\t}\n+\t\n+\t/**\n+\t * @see Encounter#addCondition(Condition)\n+\t */\n+\t@Test\n+\tpublic void addCondition_shouldNotFailWithNullCondition() {\n+\t\t// setup\n+\t\tEncounter encounter = new Encounter();\n+\t\t\n+\t\t// replay\n+\t\tencounter.addCondition(null);\n+\t\t\n+\t\t// verify\n+\t\tassertEquals(0, encounter.getConditions().size());\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05a77adb72d1e81400e34195c7748fbcd5aff247"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6285ed96ec803bb6f778a4ac5745b675b2b6e7e9", "author": {"user": {"login": "samuelmale", "name": "Samuel Male"}}, "url": "https://github.com/openmrs/openmrs-core/commit/6285ed96ec803bb6f778a4ac5745b675b2b6e7e9", "committedDate": "2020-05-19T21:58:42Z", "message": "TRUNK-5728: method Encounter#addCondition(Condition) should fail with a NPE with a null argument"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODgzMjg1", "url": "https://github.com/openmrs/openmrs-core/pull/3184#pullrequestreview-414883285", "createdAt": "2020-05-19T23:05:59Z", "commit": {"oid": "6285ed96ec803bb6f778a4ac5745b675b2b6e7e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzowNTo1OVrOGX1pNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMzowNTo1OVrOGX1pNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0OTMzNQ==", "bodyText": "The encounter_id_fk name is already taken.", "url": "https://github.com/openmrs/openmrs-core/pull/3184#discussion_r427649335", "createdAt": "2020-05-19T23:05:59Z", "author": {"login": "dkayiwa"}, "path": "api/src/main/resources/org/openmrs/liquibase/updates/liquibase-update-to-latest-2.3.x.xml", "diffHunk": "@@ -92,4 +92,22 @@\n \t\t\t<where>system_id='admin'</where>\n \t\t</update>\n \t</changeSet>\n+    \n+    <changeSet id=\"TRUNK-5728-2020-04-15\" author=\"samuel34\">\n+    \t<preConditions onFail=\"MARK_RAN\">\n+    \t\t<not>\n+    \t\t\t<columnExists tableName=\"conditions\" columnName=\"encounter_id\"/>\n+    \t\t</not>\n+    \t</preConditions>\n+    \t<comment>Adding 'encounter_id' column to 'conditions' table</comment>\n+    \t<addColumn tableName=\"conditions\">\n+    \t\t<column name=\"encounter_id\" type=\"int\">\n+    \t\t\t<constraints nullable=\"true\" />\n+    \t\t</column>\n+    \t</addColumn>\n+    \t<addForeignKeyConstraint constraintName=\"encounter_id_fk\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6285ed96ec803bb6f778a4ac5745b675b2b6e7e9"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4768, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}