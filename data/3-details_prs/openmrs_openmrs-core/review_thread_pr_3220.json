{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MTUzNTM0", "number": 3220, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDoyMzoyNVrOEBgIVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNjo1MDo0NFrOEEYXvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDEwNDU0OnYy", "diffSide": "LEFT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDoyMzoyNVrOGdY1eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzo0NDo0MFrOGemu1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw==", "bodyText": "Could you remind me as to why we are using PostgreSQL82Dialect instead of PostgreSQL92Dialect or PostgreSQL102Dialect, etc?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r433468793", "createdAt": "2020-06-01T20:23:25Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjU4OA==", "bodyText": "PostgreSQL82Dialect supports PostgreSQL 8.2 and later ( see here : https://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/dialect/PostgreSQL82Dialect.html ) where as others like PostgreSQL10 Dialect provide support for PostgreSQL10 and later ( see here: https://docs.jboss.org/hibernate/stable/orm/javadocs/org/hibernate/dialect/PostgreSQL10Dialect.html ). I used PostgreSQL82Dialect so that if some implementation is still relying on older versions of PostgreSQL then there won't be a problem.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r433626588", "createdAt": "2020-06-02T05:23:02Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkyNjYxMw==", "bodyText": "Does this therefore mean that we do not support the latest release of PostgreSQL?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r433926613", "createdAt": "2020-06-02T14:36:34Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk0MjY1Ng==", "bodyText": "I would actually questions whether we need to select a Hibernate dialect at all, but that might be bigger than this ticket (Hibernate should automatically do the right thing).", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r433942656", "createdAt": "2020-06-02T14:58:16Z", "author": {"login": "ibacher"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA3MzkzNg==", "bodyText": "Does this therefore mean that we do not support the latest release of PostgreSQL?\n\nHere as mentioned in the docs, support is for PostgreSQL 8.2 and later.\nhttps://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/dialect/PostgreSQL82Dialect.html", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434073936", "createdAt": "2020-06-02T18:06:27Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA5MTE1MA==", "bodyText": "What do you think about @ibacher's point?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434091150", "createdAt": "2020-06-02T18:25:49Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA5NzQ3Nw==", "bodyText": "I would actually questions whether we need to select a Hibernate dialect at all, but that might be bigger than this ticket (Hibernate should automatically do the right thing).\n\n@ibacher your take on this appears to me, right. I'll try on mysql and postgresql without specifying the dialect and see what happens. Though, I fear if there is a problem then it might require a separate ticket in itself and also a lot of look into how hibernate uses database metadata( like using drivers ) to select dialect  and won't be of immediate concern.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434097477", "createdAt": "2020-06-02T18:37:41Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA5OTk0OA==", "bodyText": "Can you try it out and tell us what happens?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434099948", "createdAt": "2020-06-02T18:42:18Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDExMzU4Mg==", "bodyText": "Sure @dkayiwa , I am working on it.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434113582", "createdAt": "2020-06-02T19:06:56Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEyNjk2Nw==", "bodyText": "@ibacher  @dkayiwa  , I initialized OpenMRS-core on PostgreSQL. I added legacyUI module and Now when I am trying to create a Patient,\n\n\nWithout using any PostgreSQL dialect : This is the error log https://pastebin.com/JaCZdja6\n\n\nUsing PostgreSQL dialect: Everything works fine and I am redirected to page where I need to fill patient details.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434126967", "createdAt": "2020-06-02T19:30:21Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEzODQ0MQ==", "bodyText": "Did you test to confirm that PostgreSQL82Dialect works for the latest release of PostgreSQL?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434138441", "createdAt": "2020-06-02T19:52:34Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE0NjQ3MA==", "bodyText": "@ibacher @dkayiwa , I initialized OpenMRS-core on PostgreSQL. I added legacyUI module and Now when I am trying to create a Patient,\n1. Without using any PostgreSQL dialect : This is the error log [pastebin.com/JaCZdja6](https://pastebin.com/JaCZdja6)\n\n2. Using PostgreSQL dialect: Everything works fine and I am redirected to page where I need to fill patient details.\n\n\n@Am-Coder I think there may be a small trick to this. There's a file in src/main/resources called hibernate.default.properties which has the line:\nhibernate.dialect=org.hibernate.dialect.MySQLDialect\n\nCould you edit that file to comment out that line and try again?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434146470", "createdAt": "2020-06-02T20:08:37Z", "author": {"login": "ibacher"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM0NzMwOQ==", "bodyText": "@ibacher @dkayiwa , I initialized OpenMRS-core on PostgreSQL. I added legacyUI module and Now when I am trying to create a Patient,\n1. Without using any PostgreSQL dialect : This is the error log [pastebin.com/JaCZdja6](https://pastebin.com/JaCZdja6)\n\n2. Using PostgreSQL dialect: Everything works fine and I am redirected to page where I need to fill patient details.\n\n\n@Am-Coder I think there may be a small trick to this. There's a file in src/main/resources called hibernate.default.properties which has the line:\nhibernate.dialect=org.hibernate.dialect.MySQLDialect\n\nCould you edit that file to comment out that line and try again?\n\nSorry, I missed the default dialect. So, I tried and the results are:\n\nIn both mysql and postgresql we are able enter Patient details page successfully. In mysql we are able to add patient successfully as well.\nIn mysql, I entered patient management section and tried to use delete the patient forever option. The error log I got is : https://pastebin.com/cj0tb7ue . I think this might be related to this that https://talk.openmrs.org/t/patient-management-in-postgresql/28228/5 .", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434347309", "createdAt": "2020-06-03T06:57:18Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM0NzgxMA==", "bodyText": "Did you test to confirm that PostgreSQL82Dialect works for the latest release of PostgreSQL?\n\nI'll try with postgresql 12 and report the results.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434347810", "createdAt": "2020-06-03T06:58:22Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDUyMzg5Ng==", "bodyText": "@Am-Coder Does 1 imply that you weren't able to add a patient successfully on PostgreSQL? 2 is a very good point; I forgot we were being \"saved\" by using the \"wrong\" dialect. I'm actually in favour of just adding in the appropriate ondelete = cascade properties to the affected tables.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434523896", "createdAt": "2020-06-03T12:19:47Z", "author": {"login": "ibacher"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDY4NjY1Mw==", "bodyText": "@ibacher\nFor 1 there is another problem that is not related to dialect but related to sequence and holds a different solution.\nFor 2, I will be adding the necessary ondelete = cascade in another ticket as this is necessary for PostgreSQL.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434686653", "createdAt": "2020-06-03T16:09:38Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDY4NzgxOQ==", "bodyText": "@Am-Coder didn't i solve the sequence problem in my previous commits?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434687819", "createdAt": "2020-06-03T16:11:25Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcwNjAwMQ==", "bodyText": "Did you test to confirm that PostgreSQL82Dialect works for the latest release of PostgreSQL?\n\n@dkayiwa\nPostgreSQL 12 gives the following error with both PostgreSQL82 and PostgreSQL10 dialect:  https://pastebin.com/Q62dG05P\nSo I thought of upgrading PostgreSQL dependency to :\n<dependency>\n    <groupId>org.postgresql</groupId>\n    <artifactId>postgresql</artifactId>\n    <version>42.2.5</version>\n</dependency>\n\nAnd now the problem is resolved with PostgreSQL 12 and PostgreSQL82 as dialect. Upgrading this dependency is linked to the ticket - https://issues.openmrs.org/browse/TRUNK-5553 . So I think this now depends on this ticket.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434706001", "createdAt": "2020-06-03T16:39:01Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc0NTA0Ng==", "bodyText": "@Am-Coder didn't i solve the sequence problem in my previous commits?\n\nStill the problem exists, the error log : https://pastebin.com/VJrSf98T", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r434745046", "createdAt": "2020-06-03T17:44:40Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1492,7 +1516,7 @@ public void run() {\n \t\t\t\t\t\t\truntimeProperties.put(\"connection.driver_class\", wizardModel.databaseDriver);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tif (finalDatabaseConnectionString.contains(\"postgres\")) {\n-\t\t\t\t\t\t\truntimeProperties.put(\"hibernate.dialect\", \"org.hibernate.dialect.PostgreSQLDialect\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ2ODc5Mw=="}, "originalCommit": {"oid": "462faa979eef89ca14dc0d72180893a11266a556"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNTUwMDk3OnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNDowNjoyMlrOGfwBjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxODoxODo0OVrOGf4zXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NTg2OQ==", "bodyText": "Is the replacedSql.replaceAll needed for postgresql?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r435945869", "createdAt": "2020-06-05T14:06:22Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1152,6 +1152,9 @@ private int executeStatement(boolean silent, String user, String pw, String sql,\n \t\t\t// TODO how to get the driver for the other dbs...\n \t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {\n \t\t\t\tClass.forName(\"com.mysql.cj.jdbc.Driver\").newInstance();\n+\t\t\t} else if (wizardModel.databaseConnection.contains(\"postgres\")) {\n+\t\t\t\tClass.forName(\"org.postgresql.Driver\").newInstance();\n+\t\t\t\treplacedSql = replacedSql.replaceAll(\"`\", \"\\\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjA4OTY5Mg==", "bodyText": "Currently, if you remove this you'll get the error :", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436089692", "createdAt": "2020-06-05T18:18:49Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1152,6 +1152,9 @@ private int executeStatement(boolean silent, String user, String pw, String sql,\n \t\t\t// TODO how to get the driver for the other dbs...\n \t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {\n \t\t\t\tClass.forName(\"com.mysql.cj.jdbc.Driver\").newInstance();\n+\t\t\t} else if (wizardModel.databaseConnection.contains(\"postgres\")) {\n+\t\t\t\tClass.forName(\"org.postgresql.Driver\").newInstance();\n+\t\t\t\treplacedSql = replacedSql.replaceAll(\"`\", \"\\\"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NTg2OQ=="}, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNTUwNTQ3OnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNDowNzozOFrOGfwEYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQxMDo0MDo0NlrOGgDFvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NjU5NA==", "bodyText": "Shouldn't we be using a constant for mysql or posgresql?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r435946594", "createdAt": "2020-06-05T14:07:38Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1434,10 +1437,23 @@ public void run() {\n \t\t\t\t\t\t\t        || wizardModel.databaseConnection.contains(\"127.0.0.1\")) {\n \t\t\t\t\t\t\t\thost = \"'localhost'\";\n \t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tString sql = \"drop user '?'@\" + host;\n+\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\tString sql = \"\";\n+\t\t\t\t\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NzI4OA==", "bodyText": "Or even better, wrap wizardModel.databaseConnection.contains in a method?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r435947288", "createdAt": "2020-06-05T14:08:46Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1434,10 +1437,23 @@ public void run() {\n \t\t\t\t\t\t\t        || wizardModel.databaseConnection.contains(\"127.0.0.1\")) {\n \t\t\t\t\t\t\t\thost = \"'localhost'\";\n \t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tString sql = \"drop user '?'@\" + host;\n+\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\tString sql = \"\";\n+\t\t\t\t\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NjU5NA=="}, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwMjYyMg==", "bodyText": "I'll make use of constants for db's within this same class as private members and wrap wizardModel in a method like :\n\tprivate boolean checkDatabase(String database) {\n\t\tif (wizardModel.databaseConnection.contains(database))\n\t\t\treturn true;\n\t\treturn false;\n\t}\n\nAlso should I add constants for other db like 'sqlserver' as well ?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436102622", "createdAt": "2020-06-05T18:45:43Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1434,10 +1437,23 @@ public void run() {\n \t\t\t\t\t\t\t        || wizardModel.databaseConnection.contains(\"127.0.0.1\")) {\n \t\t\t\t\t\t\t\thost = \"'localhost'\";\n \t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tString sql = \"drop user '?'@\" + host;\n+\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\tString sql = \"\";\n+\t\t\t\t\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NjU5NA=="}, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1ODIzNg==", "bodyText": "@dkayiwa , I have made some changes according to your suggestion. Also I have checked the runtime properties file and tried login with these changes in place and there was no problem.\nMySQL:\n\nPostgresql:", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436258236", "createdAt": "2020-06-06T10:40:46Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1434,10 +1437,23 @@ public void run() {\n \t\t\t\t\t\t\t        || wizardModel.databaseConnection.contains(\"127.0.0.1\")) {\n \t\t\t\t\t\t\t\thost = \"'localhost'\";\n \t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tString sql = \"drop user '?'@\" + host;\n+\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\tString sql = \"\";\n+\t\t\t\t\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk0NjU5NA=="}, "originalCommit": {"oid": "0cc23fe9f41a221f4084484f45de0dd431f31540"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMTE0NDA2OnYy", "diffSide": "RIGHT", "path": "pom.xml", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNTozNzozOVrOGgkSSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMjoxODowNFrOGhyFOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg==", "bodyText": "Is there any reason why you did not use the latest version?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436802122", "createdAt": "2020-06-08T15:37:39Z", "author": {"login": "dkayiwa"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgyOTY0NA==", "bodyText": "I went through the list of versions of type 42.x.x and the one which was used by most people, I used here. If required I can try with the latest version and report the results.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436829644", "createdAt": "2020-06-08T16:16:56Z", "author": {"login": "Am-Coder"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwNDgxNg==", "bodyText": "What were the results?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r437704816", "createdAt": "2020-06-09T20:40:57Z", "author": {"login": "dkayiwa"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA1ODEzNw==", "bodyText": "Initialization is successful. All is working fine. I used the latest 42.2.13 . Which driver I should keep 42.2.13 or 42.2.5 ?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438058137", "createdAt": "2020-06-10T11:41:08Z", "author": {"login": "Am-Coder"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA3MTAxMw==", "bodyText": "I thought the answer is obvious! \ud83d\ude0a", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438071013", "createdAt": "2020-06-10T12:07:31Z", "author": {"login": "dkayiwa"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA3NjczMQ==", "bodyText": "Ok, then I'll change to the latest one ( i.e. 42.2.13 ) .", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438076731", "createdAt": "2020-06-10T12:18:04Z", "author": {"login": "Am-Coder"}, "path": "pom.xml", "diffHunk": "@@ -412,9 +412,9 @@\n \t\t\t\t<version>5.0.11</version>\n \t\t\t</dependency>\n \t\t\t<dependency>\n-\t\t\t\t<groupId>postgresql</groupId>\n+\t\t\t\t<groupId>org.postgresql</groupId>\n \t\t\t\t<artifactId>postgresql</artifactId>\n-\t\t\t\t<version>9.0-801.jdbc4</version>\n+\t\t\t\t<version>42.2.5</version>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjEyMg=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMTE0NjYyOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNTozODoxM1rOGgkT3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNjoyNjo1OFrOGgmW5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjUyNA==", "bodyText": "What is the value added by this comment?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436802524", "createdAt": "2020-06-08T15:38:13Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -86,6 +86,26 @@\n \t\n \tprivate static final org.slf4j.Logger log = LoggerFactory.getLogger(InitializationFilter.class);\n \t\n+\t/**\n+\t * Supported Database", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgzMTk5NQ==", "bodyText": "My motive behind adding this string was to tell the one who see's the code to show the database that openmrs supports currently. I think I'll remove this string over H2 and sqlserver. What do you think should I add this string or remove it from everywhere ?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436831995", "createdAt": "2020-06-08T16:20:38Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -86,6 +86,26 @@\n \t\n \tprivate static final org.slf4j.Logger log = LoggerFactory.getLogger(InitializationFilter.class);\n \t\n+\t/**\n+\t * Supported Database", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjUyNA=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgzNjA3MQ==", "bodyText": "If it is the same comment used for four different things, then i do not see the value added.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436836071", "createdAt": "2020-06-08T16:26:58Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -86,6 +86,26 @@\n \t\n \tprivate static final org.slf4j.Logger log = LoggerFactory.getLogger(InitializationFilter.class);\n \t\n+\t/**\n+\t * Supported Database", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMjUyNA=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMTE1NDQ3OnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNTo0MDoyMFrOGgkZDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNjoyODoxOFrOGgmaIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMzg1NA==", "bodyText": "What does checkDatabase mean?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436803854", "createdAt": "2020-06-08T15:40:20Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1153,12 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkDatabase(String database) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgzNDE5Mw==", "bodyText": "Given a string as input , checkDatabase checks whteher the database is required or supported by OpenMRS platform.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436834193", "createdAt": "2020-06-08T16:24:05Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1153,12 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkDatabase(String database) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMzg1NA=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgzNjg5Nw==", "bodyText": "Shouldn't the method name contain that information such that one does not need this comment to understand what the method does?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436836897", "createdAt": "2020-06-08T16:28:18Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1153,12 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkDatabase(String database) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwMzg1NA=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMTE1ODMwOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNTo0MToxN1rOGgkbhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNjoyNDo0MlrOGgmRHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwNDQ4Nw==", "bodyText": "https://wiki.openmrs.org/display/docs/Java+Conventions#JavaConventions-CodeStyle", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436804487", "createdAt": "2020-06-08T15:41:17Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1153,12 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkDatabase(String database) {\n+\t\tif (wizardModel.databaseConnection.contains(database))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgzNDU4OA==", "bodyText": "This is a mistake on my part. I'll correct it.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r436834588", "createdAt": "2020-06-08T16:24:42Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1153,12 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkDatabase(String database) {\n+\t\tif (wizardModel.databaseConnection.contains(database))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgwNDQ4Nw=="}, "originalCommit": {"oid": "506635506a623a275e6506701dbbb986642bfe74"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNjgwNDIwOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDo0NjozM1rOGhbmBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxMTo0NTo1N1rOGhxFJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwODI5Mw==", "bodyText": "This method name creates an impression that we support only one database. But from the code base, we support four databases. Do you get my point?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r437708293", "createdAt": "2020-06-09T20:46:33Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1141,13 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkIfDatabaseIsSupported(String database) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f509e7235d2fae0c8d9f737cc380f161516b3de5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODAzMjY4Mg==", "bodyText": "Does checkInSupportedDatabases looks right ?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438032682", "createdAt": "2020-06-10T10:48:57Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1141,13 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkIfDatabaseIsSupported(String database) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwODI5Mw=="}, "originalCommit": {"oid": "f509e7235d2fae0c8d9f737cc380f161516b3de5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA1MzYyOQ==", "bodyText": "What do you think of isCurrentDatabase?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438053629", "createdAt": "2020-06-10T11:31:37Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1141,13 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkIfDatabaseIsSupported(String database) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwODI5Mw=="}, "originalCommit": {"oid": "f509e7235d2fae0c8d9f737cc380f161516b3de5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2MDMyNw==", "bodyText": "Seems fine to me. I'll make the changes.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438060327", "createdAt": "2020-06-10T11:45:57Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1133,6 +1141,13 @@ private void importTestDataSet(InputStream in, String connectionUrl, String conn\n \t\t}\n \t}\n \t\n+\tprivate boolean checkIfDatabaseIsSupported(String database) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwODI5Mw=="}, "originalCommit": {"oid": "f509e7235d2fae0c8d9f737cc380f161516b3de5"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMDI1NjUwOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNjo0MDo1OVrOGh9hDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxOTowMjo1MlrOGiCfOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw==", "bodyText": "Why run executeStatement twice?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438264077", "createdAt": "2020-06-10T16:40:59Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4OTgyNw==", "bodyText": "The number of parameters in sql query for mysql and postgresql are different, so need to have a separate statement.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438289827", "createdAt": "2020-06-10T17:24:38Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI5MDUxNQ==", "bodyText": "You can still do that but run executeStatement once.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438290515", "createdAt": "2020-06-10T17:25:43Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMyMzAwOA==", "bodyText": "Let me try if there is a way. But if you are suggesting that I make use of a similar GRANT statement for PostgreSQL. Then there is a problem since that way user does not get permission to create extension fuzzystrmatch required for soundex.", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438323008", "createdAt": "2020-06-10T18:21:10Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMzMjM4Ng==", "bodyText": "What i simply mean is that assign the sql in the if statements and then execute the result once. Does this make sense?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438332386", "createdAt": "2020-06-10T18:38:04Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0MDg3Mg==", "bodyText": "For MySQL the execute statement is :\nresult = executeStatement(false, wizardModel.createUserUsername,\nwizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n\nFor PostgreSQL, the execute statement is :\nresult = executeStatement(false, wizardModel.createUserUsername,\nwizardModel.createUserPassword, sql, connectionUsername);\n\nSo, if I make use of MySQL's execute statement in\nsql = \"ALTER USER ? WITH SUPERUSER\"; for postgreSQL then it will replace '?' with wizardModel.databaseName which will be wrong. Am I missing something ?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438340872", "createdAt": "2020-06-10T18:53:56Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0NTUzMA==", "bodyText": "Oh i see! If the parameters are different, then you can leave it. \ud83d\ude0a", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438345530", "createdAt": "2020-06-10T19:02:52Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1448,9 +1479,17 @@ public void run() {\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\n \t\t\t\t\t\t\t// grant the roles\n-\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n-\t\t\t\t\t\t\tint result = executeStatement(false, wizardModel.createUserUsername,\n-\t\t\t\t\t\t\t    wizardModel.createUserPassword, sql, wizardModel.databaseName, connectionUsername);\n+\t\t\t\t\t\t\tint result = 1;\n+\t\t\t\t\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n+\t\t\t\t\t\t\t\tsql = \"GRANT ALL ON `?`.* TO '?'@\" + host;\n+\t\t\t\t\t\t\t\tresult = executeStatement(false, wizardModel.createUserUsername,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2NDA3Nw=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMDI5MDUzOnYy", "diffSide": "RIGHT", "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNjo1MDo0NFrOGh936Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNzozNDozMlrOGh_dZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2OTkyOQ==", "bodyText": "Why do we have the exact same replacedSql.replaceAll in more than one place?", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438269929", "createdAt": "2020-06-10T16:50:44Z", "author": {"login": "dkayiwa"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1150,8 +1165,11 @@ private int executeStatement(boolean silent, String user, String pw, String sql,\n \t\t\tString replacedSql = sql;\n \t\t\t\n \t\t\t// TODO how to get the driver for the other dbs...\n-\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {\n+\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n \t\t\t\tClass.forName(\"com.mysql.cj.jdbc.Driver\").newInstance();\n+\t\t\t} else if (isCurrentDatabase(DATABASE_POSTGRESQL)) {\n+\t\t\t\tClass.forName(\"org.postgresql.Driver\").newInstance();\n+\t\t\t\treplacedSql = replacedSql.replaceAll(\"`\", \"\\\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI5NTkxMA==", "bodyText": "So, in the existing implementation for other db's other then MySQL we had\n \t\t\t\treplacedSql = replacedSql.replaceAll(\"\", \"\"\"); `\nin else condition. Now for PostgreSQL we also require this. What can be done to add a single statement is we set drivers separately in if conditions and do :\nif ( !isCurrentDatabase(DATABASE_MYSQL)){\n         replacedSql = replacedSql.replaceAll(\"`\", \"\\\"\");\n}", "url": "https://github.com/openmrs/openmrs-core/pull/3220#discussion_r438295910", "createdAt": "2020-06-10T17:34:32Z", "author": {"login": "Am-Coder"}, "path": "web/src/main/java/org/openmrs/web/filter/initialization/InitializationFilter.java", "diffHunk": "@@ -1150,8 +1165,11 @@ private int executeStatement(boolean silent, String user, String pw, String sql,\n \t\t\tString replacedSql = sql;\n \t\t\t\n \t\t\t// TODO how to get the driver for the other dbs...\n-\t\t\tif (wizardModel.databaseConnection.contains(\"mysql\")) {\n+\t\t\tif (isCurrentDatabase(DATABASE_MYSQL)) {\n \t\t\t\tClass.forName(\"com.mysql.cj.jdbc.Driver\").newInstance();\n+\t\t\t} else if (isCurrentDatabase(DATABASE_POSTGRESQL)) {\n+\t\t\t\tClass.forName(\"org.postgresql.Driver\").newInstance();\n+\t\t\t\treplacedSql = replacedSql.replaceAll(\"`\", \"\\\"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI2OTkyOQ=="}, "originalCommit": {"oid": "c8771d54e83d810ec2ea4f84dbbe7abafb500a6e"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1470, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}