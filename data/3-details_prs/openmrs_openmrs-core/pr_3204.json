{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MDkwNzA2", "number": 3204, "title": "TRUNK-4830 Avoid running legacy liquibase changesets", "bodyText": "Log details of un-run change sets.\nThis pull request provides additional logging when the OpenMRS database is updated. The additional log entries are limited to no more than 10 and un-run change sets are logged for 1.9.x Liquibase snapshot files only.\nThe additional logging was used to debug the database initialisation of the reference application and will help when other users report similar issues.\n\n[ x ] My pull request only contains ONE single commit\n[ x ] My IDE is configured to follow the [code style]- [ ] I have added tests to cover my changes. (If you refactored\nexisting code that was well tested you do not have to add tests)\n[ x ] I ran mvn clean package right before creating this pull request and\nadded all formatting changes to my commit.\n[ x ] All new and existing tests passed.\n[ x ] My pull request is based on the latest changes of the master branch.", "createdAt": "2020-05-17T10:13:09Z", "url": "https://github.com/openmrs/openmrs-core/pull/3204", "merged": true, "mergeCommit": {"oid": "3e37ea62fb377e58f0a19efa2d144cda648692c9"}, "closed": true, "closedAt": "2020-05-17T10:44:55Z", "author": {"login": "WolfSchlegel"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciISpfgH2gAyNDE5MDkwNzA2OjUwNDIyNGQxMWIwZWZjMzk3MmFkZGQyMzRlODA5MTg4NTMwYWMwMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABciIp30gFqTQxMzE0Nzg3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "504224d11b0efc3972addd234e809188530ac022", "author": {"user": {"login": "WolfSchlegel", "name": "Wolf Schlegel"}}, "url": "https://github.com/openmrs/openmrs-core/commit/504224d11b0efc3972addd234e809188530ac022", "committedDate": "2020-05-17T09:59:07Z", "message": "TRUNK-4830 log un-run change sets"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTQ3ODc5", "url": "https://github.com/openmrs/openmrs-core/pull/3204#pullrequestreview-413147879", "createdAt": "2020-05-17T10:24:28Z", "commit": {"oid": "504224d11b0efc3972addd234e809188530ac022"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QxMDoyNDoyOVrOGWf3Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QxMDoyNDoyOVrOGWf3Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI0Mzg5OA==", "bodyText": "I guess these are usually not many, from the performance perspective. Correct?", "url": "https://github.com/openmrs/openmrs-core/pull/3204#discussion_r426243898", "createdAt": "2020-05-17T10:24:29Z", "author": {"login": "dkayiwa"}, "path": "api/src/main/java/org/openmrs/liquibase/ChangeLogDetective.java", "diffHunk": "@@ -157,13 +161,22 @@ boolean isVintageChangeSet(String filename, ChangeSet changeSet) {\n \t\t}\n \t\treturn false;\n \t}\n-\t\n-\tprivate void logUnrunChangeSetDetails(String filename, List<ChangeSet> filteredUnrunChangeSets) {\n-\t\tif (filteredUnrunChangeSets.size() < MAX_NUMBER_OF_CHANGE_SETS_TO_LOG) {\n-\t\t\tfor (ChangeSet changeSet : filteredUnrunChangeSets) {\n-\t\t\t\tlog.debug(\"file '{}' contains un-run change set with id '{}' by author '{}'\", filename, changeSet.getId(),\n+\n+\t/**\n+\t * Logs un-run change sets no more than a given number and only for the 1.9.x Liquibase snapshots.\n+\t * \n+\t * @return a boolean value indicating whether the change sets were logged. The value is used for testing.\n+\t */\n+\tboolean logUnRunChangeSetDetails( String filename, List<ChangeSet> ChangeSets) {\n+\t\tif (ChangeSets.size() < MAX_NUMBER_OF_CHANGE_SETS_TO_LOG", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "504224d11b0efc3972addd234e809188530ac022"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4804, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}