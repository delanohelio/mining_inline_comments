{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODQzNDcy", "number": 3318, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NDowMFrOEQysNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NDowMFrOEQysNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDQzMTg5OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NDowMFrOG1JX-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxMjoyODowOFrOHErQWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg==", "bodyText": "Why use a hack?", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r458381306", "createdAt": "2020-07-21T20:54:00Z", "author": {"login": "dkayiwa"}, "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "diffHunk": "@@ -588,12 +590,26 @@ public Integer getEncountersByVisitsAndPatientCount(Patient patient, boolean inc\n \t\tCriteria criteria = sessionFactory.getCurrentSession().createCriteria(Visit.class);\n \t\taddEmptyVisitsByPatientCriteria(criteria, patient, includeVoided, query);\n \t\t\n+\t\t//A hack to remove the order_by clauses as they cause error in PostgreSQL\n+\t\tIterator<CriteriaImpl.OrderEntry> orderIter = ((CriteriaImpl) criteria).iterateOrderings();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "383a6f26354a518fdece3dddc3c62560e8162bb6"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczNDAzMg==", "bodyText": "There is no direct way to remove the order clause from criteria once it gets added( docs ).  I found this solution here.", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r458734032", "createdAt": "2020-07-22T11:49:42Z", "author": {"login": "Am-Coder"}, "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "diffHunk": "@@ -588,12 +590,26 @@ public Integer getEncountersByVisitsAndPatientCount(Patient patient, boolean inc\n \t\tCriteria criteria = sessionFactory.getCurrentSession().createCriteria(Visit.class);\n \t\taddEmptyVisitsByPatientCriteria(criteria, patient, includeVoided, query);\n \t\t\n+\t\t//A hack to remove the order_by clauses as they cause error in PostgreSQL\n+\t\tIterator<CriteriaImpl.OrderEntry> orderIter = ((CriteriaImpl) criteria).iterateOrderings();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}, "originalCommit": {"oid": "383a6f26354a518fdece3dddc3c62560e8162bb6"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU4MTI3Mw==", "bodyText": "@dkayiwa , your view on this ? Apparently, This is not an issue on Reference Application but comes up when visiting Patient Dashboard on LegacyUI.", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r474581273", "createdAt": "2020-08-21T09:35:57Z", "author": {"login": "Am-Coder"}, "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "diffHunk": "@@ -588,12 +590,26 @@ public Integer getEncountersByVisitsAndPatientCount(Patient patient, boolean inc\n \t\tCriteria criteria = sessionFactory.getCurrentSession().createCriteria(Visit.class);\n \t\taddEmptyVisitsByPatientCriteria(criteria, patient, includeVoided, query);\n \t\t\n+\t\t//A hack to remove the order_by clauses as they cause error in PostgreSQL\n+\t\tIterator<CriteriaImpl.OrderEntry> orderIter = ((CriteriaImpl) criteria).iterateOrderings();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}, "originalCommit": {"oid": "383a6f26354a518fdece3dddc3c62560e8162bb6"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY2NTA0OQ==", "bodyText": "@Am-Coder I think the question is: why not just remove the order by stuff from the place where its being added instead of adding this hack? The order by stuff can then be added in where it's actually needed, e.g., getEncountersByVisitsAndPatient()", "url": "https://github.com/openmrs/openmrs-core/pull/3318#discussion_r474665049", "createdAt": "2020-08-21T12:28:08Z", "author": {"login": "ibacher"}, "path": "api/src/main/java/org/openmrs/api/db/hibernate/HibernateEncounterDAO.java", "diffHunk": "@@ -588,12 +590,26 @@ public Integer getEncountersByVisitsAndPatientCount(Patient patient, boolean inc\n \t\tCriteria criteria = sessionFactory.getCurrentSession().createCriteria(Visit.class);\n \t\taddEmptyVisitsByPatientCriteria(criteria, patient, includeVoided, query);\n \t\t\n+\t\t//A hack to remove the order_by clauses as they cause error in PostgreSQL\n+\t\tIterator<CriteriaImpl.OrderEntry> orderIter = ((CriteriaImpl) criteria).iterateOrderings();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTMwNg=="}, "originalCommit": {"oid": "383a6f26354a518fdece3dddc3c62560e8162bb6"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1397, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}