{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0MzY0Mjc4", "number": 3389, "title": "TRUNK-5862: Condition and Obs to implement FormRecordable.", "bodyText": "TRUNK-5862: Condition and Obs to implement FormRecordable, backport for 2.3\n\n\nIssue I worked on\n\n\n\n\nsee https://issues.openmrs.org/browse/TRUNK-5862\nChecklist: I completed these to help reviewers :)\n\n\n\n\n My IDE is configured to follow the code style of this project.\n\n\n I have added tests to cover my changes. (If you refactored\nexisting code that was well tested you do not have to add tests)\n\n\n I ran mvn clean package right before creating this pull request and\nadded all formatting changes to my commit.\n\n\n All new and existing tests passed.\n\n\n My pull request is based on the latest changes of the master branch.", "createdAt": "2020-07-21T10:30:30Z", "url": "https://github.com/openmrs/openmrs-core/pull/3389", "merged": true, "mergeCommit": {"oid": "7e179e65904d08c96eaeff9bfc16a050bf93e18e"}, "closed": true, "closedAt": "2020-07-23T10:20:56Z", "author": {"login": "icrc-loliveira"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3DndeAH2gAyNDU0MzY0Mjc4OjBiNzMyZGMwYTFlZmVkZGQ2ZjJiNTQ3NGJmM2JkMjIyNTAxNmE5NDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3swVYAFqTQ1NDAwMjk2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0b732dc0a1efeddd6f2b5474bf3bd2225016a946", "author": {"user": null}, "url": "https://github.com/openmrs/openmrs-core/commit/0b732dc0a1efeddd6f2b5474bf3bd2225016a946", "committedDate": "2020-07-21T10:24:44Z", "message": "TRUNK-5862 backport for 2.3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMzM4NDYy", "url": "https://github.com/openmrs/openmrs-core/pull/3389#pullrequestreview-452338462", "createdAt": "2020-07-21T10:46:55Z", "commit": {"oid": "0b732dc0a1efeddd6f2b5474bf3bd2225016a946"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMDo0Njo1NVrOG0ycJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMDo0Njo1NVrOG0ycJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAwNTU0Mg==", "bodyText": "That'd be 2.3.2.", "url": "https://github.com/openmrs/openmrs-core/pull/3389#discussion_r458005542", "createdAt": "2020-07-21T10:46:55Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/BaseFormRecordableOpenmrsData.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/**\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.openmrs.api.APIException;\n+\n+import javax.persistence.Column;\n+import javax.persistence.MappedSuperclass;\n+\n+/**\n+ * This is a super class to make a bridge between an OpenMrsObject and is position in the form.\n+ *\n+ * @since 2.3.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b732dc0a1efeddd6f2b5474bf3bd2225016a946"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e53480dce0cfe3bb13edba5623bd43b0b38bb84d", "author": {"user": null}, "url": "https://github.com/openmrs/openmrs-core/commit/e53480dce0cfe3bb13edba5623bd43b0b38bb84d", "committedDate": "2020-07-21T10:49:42Z", "message": "Updated comment since 2.3.0 > since 2.3.2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMzc3Mjky", "url": "https://github.com/openmrs/openmrs-core/pull/3389#pullrequestreview-452377292", "createdAt": "2020-07-21T11:49:50Z", "commit": {"oid": "e53480dce0cfe3bb13edba5623bd43b0b38bb84d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMTo0OTo1MFrOG00WWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMTo0OTo1MFrOG00WWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAzNjgyNg==", "bodyText": "Same here :-)", "url": "https://github.com/openmrs/openmrs-core/pull/3389#discussion_r458036826", "createdAt": "2020-07-21T11:49:50Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/FormRecordable.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/**\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs;\n+\n+/**\n+ * Defines the methods to make a bridge between an OpenMrsObject and is position in the form.\n+ *\n+ * @since  2.3.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e53480dce0cfe3bb13edba5623bd43b0b38bb84d"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNjExMDkw", "url": "https://github.com/openmrs/openmrs-core/pull/3389#pullrequestreview-452611090", "createdAt": "2020-07-21T16:06:22Z", "commit": {"oid": "e53480dce0cfe3bb13edba5623bd43b0b38bb84d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNjowNjoyMlrOG0_Otw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNjowNjoyMlrOG0_Otw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODIxNTA5NQ==", "bodyText": "What about this if statement, didn't it get wiped through the changes?", "url": "https://github.com/openmrs/openmrs-core/pull/3389#discussion_r458215095", "createdAt": "2020-07-21T16:06:22Z", "author": {"login": "mks-d"}, "path": "api/src/main/java/org/openmrs/Obs.java", "diffHunk": "@@ -1175,93 +1169,15 @@ public void setDateCreated(Date dateCreated) {\n \t\tmarkAsDirty(getDateCreated(), dateCreated);\n \t\tsuper.setDateCreated(dateCreated);\n \t}\n-\t\n-\t/**\n-\t * Gets the namespace for the form field that was used to capture the obs details in the form\n-\t * \n-\t * @return the namespace\n-\t * @since 1.11\n-\t * @should return the namespace for a form field that has no path\n-\t * @should return the correct namespace for a form field with a path\n-\t * @should return null if the namespace is not specified\n-\t */\n-\tpublic String getFormFieldNamespace() {\n-\t\tif (StringUtils.isNotBlank(formNamespaceAndPath)) {\n-\t\t\t//Only the path was specified\n-\t\t\tif (formNamespaceAndPath.startsWith(FORM_NAMESPACE_PATH_SEPARATOR)) {\n-\t\t\t\treturn null;\n-\t\t\t}\n-\t\t\treturn formNamespaceAndPath.substring(0, formNamespaceAndPath.indexOf(FORM_NAMESPACE_PATH_SEPARATOR));\n-\t\t}\n-\t\t\n-\t\treturn formNamespaceAndPath;\n-\t}\n-\t\n-\t/**\n-\t * Gets the path for the form field that was used to capture the obs details in the form\n-\t * \n-\t * @return the the form field path\n-\t * @since 1.11\n-\t * @should return the path for a form field that has no namespace\n-\t * @should return the correct path for a form field with a namespace\n-\t * @should return null if the path is not specified\n-\t */\n-\tpublic String getFormFieldPath() {\n-\t\tif (StringUtils.isNotBlank(formNamespaceAndPath)) {\n-\t\t\t//Only the namespace was specified\n-\t\t\tif (formNamespaceAndPath.endsWith(FORM_NAMESPACE_PATH_SEPARATOR)) {\n-\t\t\t\treturn null;\n-\t\t\t}\n-\t\t\treturn formNamespaceAndPath.substring(formNamespaceAndPath.indexOf(FORM_NAMESPACE_PATH_SEPARATOR) + 1);\n-\t\t}\n-\t\t\n-\t\treturn formNamespaceAndPath;\n-\t}\n-\t\n+\n \t/**\n-\t * Sets the namespace and path of the form field that was used to capture the obs details in the\n-\t * form.<br>\n-\t * <b>Note:</b> Namespace and formFieldPath together must not exceed 254 characters in length,\n-\t * form applications can subtract the length of their namespace from 254 to determine the\n-\t * maximum length they can use for a form field path.\n-\t * \n-\t * @param namespace the namespace of the form field\n-\t * @param formFieldPath the path of the form field\n-\t * @since 1.11\n-\t * @should set the underlying formNamespaceAndPath in the correct pattern\n-\t * @should reject a namepace containing the separator\n-\t * @should reject a path containing the separator\n-\t * @should reject a namepace and path combination longer than the max length\n-\t * @should not mark the obs as dirty when the value has not been changed\n-\t * @should mark the obs as dirty when the value has been changed\n-\t * @should mark the obs as dirty when the value is changed from a null to a non null value\n-\t * @should mark the obs as dirty when the value is changed from a non null to a null value\n+\t * @see org.openmrs.FormRecordable#setFormField(String, String)\n \t */\n+\t@Override\n \tpublic void setFormField(String namespace, String formFieldPath) {\n-\t\tif (namespace == null && formFieldPath == null) {\n-\t\t\tmarkAsDirty(formNamespaceAndPath, null);\n-\t\t\tformNamespaceAndPath = null;\n-\t\t\treturn;\n-\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e53480dce0cfe3bb13edba5623bd43b0b38bb84d"}, "originalPosition": 103}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3b53c966c172a9668d9146213ff82453bc27425", "author": {"user": null}, "url": "https://github.com/openmrs/openmrs-core/commit/d3b53c966c172a9668d9146213ff82453bc27425", "committedDate": "2020-07-21T16:15:33Z", "message": "Updated comment since 2.3.0 > since 2.3.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00203e22168cdc9edf7976b9054963fd8f54fce5", "author": {"user": null}, "url": "https://github.com/openmrs/openmrs-core/commit/00203e22168cdc9edf7976b9054963fd8f54fce5", "committedDate": "2020-07-23T10:14:27Z", "message": "Updated class comment."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MDAyOTY5", "url": "https://github.com/openmrs/openmrs-core/pull/3389#pullrequestreview-454002969", "createdAt": "2020-07-23T10:20:32Z", "commit": {"oid": "00203e22168cdc9edf7976b9054963fd8f54fce5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4552, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}