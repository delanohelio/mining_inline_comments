{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5NzIxMjU2", "number": 102, "title": "SQL Extraction: show progress flag, show debug logs flag", "bodyText": "Instead of controlling log levels through the properties file, I got it to emit debug logs by adding the --debug flag.\nI added a flag --progress that prints out how much work is done to STDERR. This also means that the sequence of file paths to analyze is expanded first so that the total amount of needed work can be found.\nUnknown file types are now ignored rather than throwing an exception.", "createdAt": "2020-07-15T20:37:15Z", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102", "merged": true, "mergeCommit": {"oid": "d7b358235e46be2c5476a30055ead8360a7fedff"}, "closed": true, "closedAt": "2020-07-17T18:01:29Z", "author": {"login": "creativitRy"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1QqloAH2gAyNDQ5NzIxMjU2OjlmOTY1OTJhYWE3OTkxMzkxYTdkMDY4ZDQxNzk2MzgwZTk0YjM4N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc13RK0AH2gAyNDQ5NzIxMjU2OmFjYzg1OTFhZjA1YmVhYTEyMWY2Y2VmMjY2NDM4NTQ4NDZiM2EwMjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f96592aaa7991391a7d068d41796380e94b387f", "author": {"user": {"login": "creativitRy", "name": "Gahwon Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/9f96592aaa7991391a7d068d41796380e94b387f", "committedDate": "2020-07-15T20:29:04Z", "message": "SQL Extraction: show progress flag, show debug logs flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e", "author": {"user": {"login": "creativitRy", "name": "Gahwon Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/33960836029854fbbcbced8a42807d17ab02bc4e", "committedDate": "2020-07-15T21:21:24Z", "message": "Merge remote-tracking branch 'gcp/master'\n\n# Conflicts:\n#\ttools/sql_extraction/src/test/kotlin/SqlExtractorTest.kt"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDQ4OTQ1", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-449448945", "createdAt": "2020-07-16T01:34:32Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTozNDozM1rOGyW8mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTozNDozM1rOGyW8mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ1Nzk0NQ==", "bodyText": "nit: should you print the filePath somewhere? $filePath doesn't have much information or it would be replaced by the actual variable?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#discussion_r455457945", "createdAt": "2020-07-16T01:34:33Z", "author": {"login": "kikkyo"}, "path": "tools/sql_extraction/src/main/kotlin/DataFlowSolver.kt", "diffHunk": "@@ -29,6 +29,7 @@ class DataFlowSolver(private val frontends: List<FrontEnd>) {\n             }\n         }\n \n-        throw IllegalArgumentException(\"Cannot analyze $filePath. No frontend available.\")\n+        LOGGER.warn { \"Cannot analyze $filePath. No frontend available. Skipping file...\" }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDU5ODQ4", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-449459848", "createdAt": "2020-07-16T02:10:41Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMjoxMDo0MVrOGyXjHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMjoxMDo0MVrOGyXjHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2NzgwNA==", "bodyText": "Is it better practice to use mock annotation @mockk?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#discussion_r455467804", "createdAt": "2020-07-16T02:10:41Z", "author": {"login": "kikkyo"}, "path": "tools/sql_extraction/src/test/kotlin/DataFlowSolverTest.kt", "diffHunk": "@@ -39,13 +42,16 @@ class DataFlowSolverTest {\n     }\n \n     @Test\n-    fun `solver throws without any valid frontends`() {\n+    fun `solver returns empty sequence without any valid frontends`() {\n         val frontEnd = mockk<FrontEnd>()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDYxMTg5", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-449461189", "createdAt": "2020-07-16T02:15:26Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMjoxNToyNlrOGyXn7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMjoxNToyNlrOGyXn7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2OTAzNg==", "bodyText": "curious on the style too... why not 'SolverReturnsEmptySequence....'? Is this recommended?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#discussion_r455469036", "createdAt": "2020-07-16T02:15:26Z", "author": {"login": "kikkyo"}, "path": "tools/sql_extraction/src/test/kotlin/DataFlowSolverTest.kt", "diffHunk": "@@ -39,13 +42,16 @@ class DataFlowSolverTest {\n     }\n \n     @Test\n-    fun `solver throws without any valid frontends`() {\n+    fun `solver returns empty sequence without any valid frontends`() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMjA4MjQ1", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-450208245", "createdAt": "2020-07-16T20:53:31Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDo1MzozMlrOGy8ZPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDo1MzozMlrOGy8ZPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3MTQ4Nw==", "bodyText": "Do we have to specify both options to make it work?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#discussion_r456071487", "createdAt": "2020-07-16T20:53:32Z", "author": {"login": "kikkyo"}, "path": "tools/sql_extraction/src/main/kotlin/Cli.kt", "diffHunk": "@@ -74,13 +72,28 @@ private class Cli(\n         \"--pretty\", help = \"Pretty-print output JSON\"\n     ).flag()\n \n+    private val showProgress: Boolean by option(\n+        \"--progress\", help = \"Print progress to STDERR\"\n+    ).flag()\n+\n+    private val debug: Boolean by option(\n+        \"--debug\", \"--verbose\", help = \"Print debug logs to STDERR\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMjA5MDEy", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-450209012", "createdAt": "2020-07-16T20:54:44Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDo1NDo0NVrOGy8bkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDo1NDo0NVrOGy8bkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3MjA4MA==", "bodyText": "This setProperty looks a bit hard coded, do we have to update this if our dependency/libs change in future?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#discussion_r456072080", "createdAt": "2020-07-16T20:54:45Z", "author": {"login": "kikkyo"}, "path": "tools/sql_extraction/src/main/kotlin/Cli.kt", "diffHunk": "@@ -74,13 +72,28 @@ private class Cli(\n         \"--pretty\", help = \"Pretty-print output JSON\"\n     ).flag()\n \n+    private val showProgress: Boolean by option(\n+        \"--progress\", help = \"Print progress to STDERR\"\n+    ).flag()\n+\n+    private val debug: Boolean by option(\n+        \"--debug\", \"--verbose\", help = \"Print debug logs to STDERR\"\n+    ).flag()\n+\n     override fun run() {\n-        LOGGER.debug(\"Starting SQL Extraction from command line\")\n+        if (debug) {\n+            System.setProperty(org.slf4j.impl.SimpleLogger.DEFAULT_LOG_LEVEL_KEY, \"Debug\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMjA5NzQ5", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/102#pullrequestreview-450209749", "createdAt": "2020-07-16T20:55:54Z", "commit": {"oid": "33960836029854fbbcbced8a42807d17ab02bc4e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e631ed87016aefb248f66baa7b5695af844d03", "author": {"user": {"login": "creativitRy", "name": "Gahwon Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/91e631ed87016aefb248f66baa7b5695af844d03", "committedDate": "2020-07-16T22:27:18Z", "message": "Import SimpleLogger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acc8591af05beaa121f6cef26643854846b3a022", "author": {"user": {"login": "creativitRy", "name": "Gahwon Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/acc8591af05beaa121f6cef26643854846b3a022", "committedDate": "2020-07-17T17:27:36Z", "message": "Merge branch 'master' into master"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 663, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}