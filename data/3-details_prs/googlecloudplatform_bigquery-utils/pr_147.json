{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MDA1MDg5", "number": 147, "title": "Query_Breakdown/VSCode_Query_Breakdown: Integration Complete", "bodyText": "Integration between the VS Code Frontend and CLI Backend is complete\n\nJSON flag -j is added, so the output is now available in a JSON format\nThe program can now generate a stand-alone jar file which the VS Code Frontend runs\nquery_breakdown_runner.ts is created to write the execute function that returns a promise (for async) after executing the backend and parsing the results into JSON objects\nresultJson.ts is created to make the results from the backend into a structured JSON format\nextension.ts is updated to support the integration. It asynchronously runs query_breakdown_runner and receives the results in a JSON array format\nmore relevant documentation can be found in the code\n\nP.S: the code complies to Google's TS style according to gts (open source tool for Google's typescript style)", "createdAt": "2020-08-12T21:00:42Z", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147", "merged": true, "mergeCommit": {"oid": "1373c92195c6b7c248c23352e48b95f4fb104e3f"}, "closed": true, "closedAt": "2020-08-21T20:34:32Z", "author": {"login": "subinbean"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8T6wrgH2gAyNDY3MDA1MDg5OjQ3ZmIyZGQ3MzFkOGM3MWU4YzRiMTNmNjgwMTMxNDRhNzY0OWNjYWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBK6MBAH2gAyNDY3MDA1MDg5OmQ5ZGZkNDIzYzg0YTI5MjcyYjBiZTcxMGE2NDAwMzY0NmZhMTFhZDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "47fb2dd731d8c71e8c4b13f68013144a7649ccae", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/47fb2dd731d8c71e8c4b13f68013144a7649ccae", "committedDate": "2020-08-06T18:13:55Z", "message": "query_breakdown locationtracker now works with replacement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a6891f58d9a0a03b8b9eaecaa5327f9c7d4eec3", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/2a6891f58d9a0a03b8b9eaecaa5327f9c7d4eec3", "committedDate": "2020-08-06T18:38:48Z", "message": "stack now works to rearrange output order"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0d19792754f5177368bacf2c55a75a5d4596678", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/c0d19792754f5177368bacf2c55a75a5d4596678", "committedDate": "2020-08-06T18:57:59Z", "message": "test case for deletion and replacement at the same time added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b61ddfd58872dfa15216cc9081d4b13625b407f", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/9b61ddfd58872dfa15216cc9081d4b13625b407f", "committedDate": "2020-08-07T19:57:40Z", "message": "json flag added as well as variable programmed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23d74ba6069588f7872edf9aaccf5554752120c6", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/23d74ba6069588f7872edf9aaccf5554752120c6", "committedDate": "2020-08-08T00:02:06Z", "message": "added json support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2b01b2974c41063a72be65ce740109e8e9081a6", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/e2b01b2974c41063a72be65ce740109e8e9081a6", "committedDate": "2020-08-08T00:21:26Z", "message": "works as a stand-alone jar file now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01553a8c80f0d1534bf127d41acda6be31637325", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/01553a8c80f0d1534bf127d41acda6be31637325", "committedDate": "2020-08-08T01:40:59Z", "message": "Merge branch 'master' into milestone3_1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feb8a2f20f36a6807706d4e5c4e6614547439ded", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/feb8a2f20f36a6807706d4e5c4e6614547439ded", "committedDate": "2020-08-10T20:43:20Z", "message": "created query_breakdown_runner.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b2f48263a2a9a2e4e19cc73847b4395f2c3ad2a", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/1b2f48263a2a9a2e4e19cc73847b4395f2c3ad2a", "committedDate": "2020-08-10T22:35:27Z", "message": "query breakdown runner sketched"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acb043fc61f541bd846e645df84c4219a4f0c215", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/acb043fc61f541bd846e645df84c4219a4f0c215", "committedDate": "2020-08-11T19:18:38Z", "message": "methods sketched"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1cde39f3c6d666cf44dc64f6a2f5187ed423db5", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/b1cde39f3c6d666cf44dc64f6a2f5187ed423db5", "committedDate": "2020-08-11T19:19:07Z", "message": "result json file sketched"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6dbb8ea4a81643af8785045b849a843a226d61e", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/a6dbb8ea4a81643af8785045b849a843a226d61e", "committedDate": "2020-08-11T19:51:35Z", "message": "resultJson integrated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88a811d7eae4a15eea543fb24ddfadbc7b242d81", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/88a811d7eae4a15eea543fb24ddfadbc7b242d81", "committedDate": "2020-08-11T21:55:44Z", "message": "debugging-1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "306b21633cbc6fac9e794ab763a66b63c3628114", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/306b21633cbc6fac9e794ab763a66b63c3628114", "committedDate": "2020-08-12T00:17:53Z", "message": "integration is now finished and working!"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25c92eae4bed225450b0878bcb243d1a512a5bf2", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/25c92eae4bed225450b0878bcb243d1a512a5bf2", "committedDate": "2020-08-12T18:51:15Z", "message": "merge conflicts resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/751716ca54416ef54ba970e83eb373ecb62b7dd0", "committedDate": "2020-08-12T20:51:15Z", "message": "code cleaned up for pull request"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNzIzMzE0", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#pullrequestreview-470723314", "createdAt": "2020-08-19T18:16:56Z", "commit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoxNjo1NlrOHDTvPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoxNjo1NlrOHDTvPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIzMTE2NA==", "bodyText": "Seems , PATH should not be here?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#discussion_r473231164", "createdAt": "2020-08-19T18:16:56Z", "author": {"login": "feiling"}, "path": "tools/query_breakdown/src/main/java/com/google/bigquery/Main.java", "diffHunk": "@@ -2,34 +2,31 @@\n \n import static java.lang.System.exit;\n \n-import java.io.File;\n import org.apache.commons.cli.*;\n \n import java.io.IOException;\n-import java.util.Comparator;\n \n /**\n  * This file is the main file for the command line tool.\n- * Usage: query_breakdown -i <PATH> [-o <PATH>] [-l <INTEGER>]\n+ * Usage: query_breakdown -i <PATH> [-j] [-l <INTEGER>]\n  * -i, --inputFile, PATH: this command specifies the path to the file containing queries to be\n  *                    inputted into the tool. It is therefore mandatory\n- * -o, --outputFile, PATH: this command specifies the path to the file that the tool can write\n- *                    its results to. If not specified, the tool will simply print results on the\n- *                    console. It is therefore optional\n+ * -j, --json, PATH: this command specifies whether the program should output the results in a", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNzI0NDEy", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#pullrequestreview-470724412", "createdAt": "2020-08-19T18:18:35Z", "commit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoxODozNVrOHDTyfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoxODozNVrOHDTyfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIzMTk5OA==", "bodyText": "Seems PATH should be INTEGER", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#discussion_r473231998", "createdAt": "2020-08-19T18:18:35Z", "author": {"login": "feiling"}, "path": "tools/query_breakdown/src/main/java/com/google/bigquery/Main.java", "diffHunk": "@@ -2,34 +2,31 @@\n \n import static java.lang.System.exit;\n \n-import java.io.File;\n import org.apache.commons.cli.*;\n \n import java.io.IOException;\n-import java.util.Comparator;\n \n /**\n  * This file is the main file for the command line tool.\n- * Usage: query_breakdown -i <PATH> [-o <PATH>] [-l <INTEGER>]\n+ * Usage: query_breakdown -i <PATH> [-j] [-l <INTEGER>]\n  * -i, --inputFile, PATH: this command specifies the path to the file containing queries to be\n  *                    inputted into the tool. It is therefore mandatory\n- * -o, --outputFile, PATH: this command specifies the path to the file that the tool can write\n- *                    its results to. If not specified, the tool will simply print results on the\n- *                    console. It is therefore optional\n+ * -j, --json, PATH: this command specifies whether the program should output the results in a\n+ *                   json format. It is therefore optional\n  * -l, --limit, PATH: this command specifies the path to an integer that the tool takes as a", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNzI4NTUy", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#pullrequestreview-470728552", "createdAt": "2020-08-19T18:24:45Z", "commit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoyNDo0NVrOHDT_OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxODoyNDo0NVrOHDT_OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIzNTI1Nw==", "bodyText": "You should be able to simplify this by using a library like Jackson (https://en.wikipedia.org/wiki/Jackson_(API)). You can choose to do that in a future PR.", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#discussion_r473235257", "createdAt": "2020-08-19T18:24:45Z", "author": {"login": "feiling"}, "path": "tools/query_breakdown/src/main/java/com/google/bigquery/QueryBreakdown.java", "diffHunk": "@@ -62,23 +64,51 @@ public void run(String originalQuery, String outputFile, int errorLimit,\n       stack.push(current);\n       current = current.getParent();\n     }\n-\n-    // we then pop the stack and output results one by one\n-    while (!stack.empty()) {\n-      current = stack.pop();\n-      if (current.getErrorHandlingType().equals(\"DELETION\")) {\n-        // print out the result\n-        System.out.println(String.format(\"Unparseable portion: Start Line %1$s, End Line %2$s, \"\n-                + \"Start Column %3$s, End Column %4$s, %5$s\", current.getStartLine(),\n-            current.getEndLine(), current.getStartColumn(), current.getEndColumn(),\n-            current.getErrorHandlingType()));\n+    \n+    if (jsonOutput) {\n+      JSONArray jsonArray = new JSONArray();\n+      while(!stack.empty()) {\n+        current = stack.pop();\n+        JSONObject errorPosition = new JSONObject();\n+        errorPosition.put(\"startLine\", current.getStartLine());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "751716ca54416ef54ba970e83eb373ecb62b7dd0"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "717a8085c271daf6a9be0975bd30b9fd6f7a2c8d", "author": {"user": {"login": "subinbean", "name": "Subin Lee"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/717a8085c271daf6a9be0975bd30b9fd6f7a2c8d", "committedDate": "2020-08-19T21:58:42Z", "message": "PR comments addressed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNzgxMzE2", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/147#pullrequestreview-471781316", "createdAt": "2020-08-20T16:22:49Z", "commit": {"oid": "717a8085c271daf6a9be0975bd30b9fd6f7a2c8d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c87053ff3ea41a1b89fc863e50db4038db3b743", "author": {"user": {"login": "feiling", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/5c87053ff3ea41a1b89fc863e50db4038db3b743", "committedDate": "2020-08-20T16:22:55Z", "message": "Merge branch 'master' into milestone3_1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9dfd423c84a29272b0be710a64003646fa11ad8", "author": {"user": {"login": "feiling", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/d9dfd423c84a29272b0be710a64003646fa11ad8", "committedDate": "2020-08-21T20:33:46Z", "message": "Merge branch 'master' into milestone3_1"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 738, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}