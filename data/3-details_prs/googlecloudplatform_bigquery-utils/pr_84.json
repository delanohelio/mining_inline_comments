{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MjIyMDMx", "number": 84, "title": "Calendar functions", "bodyText": "Added week_number_of_month() and day_occurrence_of_month() functions", "createdAt": "2020-07-04T01:02:24Z", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84", "merged": true, "mergeCommit": {"oid": "7bd8ba2faa7ba8b22c2e6152b3e783eb2386cf67"}, "closed": true, "closedAt": "2021-08-27T21:36:04Z", "author": {"login": "epishova"}, "timelineItems": {"totalCount": 59, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbf_d5DgH2gAyNDQ0MjIyMDMxOjI3MzdiYzZkMmEzOTJmNGJkYjdiNjE4MjU5Y2Y4OTg2ZDBiMWQ4YzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABe4mKKBAFqTc0MDkwODU0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2737bc6d2a392f4bdb7b618259cf8986d0b1d8c2", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/2737bc6d2a392f4bdb7b618259cf8986d0b1d8c2", "committedDate": "2019-10-24T22:23:15Z", "message": "Changed repo description since migration directory contains other databases besides Teradata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e37290a1c9d48c4955aa902dc29d1843bf8613d", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/8e37290a1c9d48c4955aa902dc29d1843bf8613d", "committedDate": "2019-10-24T22:37:43Z", "message": "Implementation of translate function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b52784546a621b849ac7fd050a8df1a4f6bac07", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/1b52784546a621b849ac7fd050a8df1a4f6bac07", "committedDate": "2019-10-24T22:45:07Z", "message": "Implementation of otranslate function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "820311553687734642cb98ab76ac1d3d00035b34", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/820311553687734642cb98ab76ac1d3d00035b34", "committedDate": "2019-10-25T23:17:35Z", "message": "The function parses Redshift interval literal and converts it to seconds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5befad31659e0821ed3e19591e7999b1924c3114", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/5befad31659e0821ed3e19591e7999b1924c3114", "committedDate": "2019-11-07T17:53:14Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db8ff9e0f067f69b8c5cd9d31037e6feba40b1d3", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/db8ff9e0f067f69b8c5cd9d31037e6feba40b1d3", "committedDate": "2019-11-07T17:56:25Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9e9c9890dd75416c481529491fc901dd7aac6f4", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/c9e9c9890dd75416c481529491fc901dd7aac6f4", "committedDate": "2019-11-08T00:03:43Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6cb215dcaca6a13b209395c6d6c07d372c43da5", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/f6cb215dcaca6a13b209395c6d6c07d372c43da5", "committedDate": "2019-11-08T00:04:38Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39bac1925b949a95b7ecb7ad55c7ce237f92a424", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/39bac1925b949a95b7ecb7ad55c7ce237f92a424", "committedDate": "2019-11-08T00:11:33Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69014b3395b02859c8731075191a9d2c0d26caf8", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/69014b3395b02859c8731075191a9d2c0d26caf8", "committedDate": "2019-11-08T00:15:07Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d275dac233bd2d726b411f15909e6475ce1180d", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/9d275dac233bd2d726b411f15909e6475ce1180d", "committedDate": "2019-11-08T00:17:40Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82de3d277b333f6b2030013182d39ccdf843cdd6", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/82de3d277b333f6b2030013182d39ccdf843cdd6", "committedDate": "2019-11-08T00:35:43Z", "message": "Formatted code with BQ UI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4482e3cbee08538cbed3de1335e23d52f1af48d", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/d4482e3cbee08538cbed3de1335e23d52f1af48d", "committedDate": "2019-11-14T16:31:31Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ccf7d594ed1d3e0ecacabfd37056029a34a3f5e", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/7ccf7d594ed1d3e0ecacabfd37056029a34a3f5e", "committedDate": "2019-11-14T16:33:09Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41078ca7e0da3eb10b0bf73e898c87755a8aa870", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/41078ca7e0da3eb10b0bf73e898c87755a8aa870", "committedDate": "2019-11-14T16:35:26Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ff7114beeb33353cf6d98713d576336c2caed55", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/6ff7114beeb33353cf6d98713d576336c2caed55", "committedDate": "2019-11-14T16:41:36Z", "message": "Changed code formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c0761ff12ea8b531517c6577af7f1c10b2ec275", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/3c0761ff12ea8b531517c6577af7f1c10b2ec275", "committedDate": "2019-11-14T16:43:25Z", "message": "Merge branch 'master' of https://github.com/epishova/bigquery-utils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cf44f558a12519f32c040b8c0f3c77a4fcb6f7f", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/8cf44f558a12519f32c040b8c0f3c77a4fcb6f7f", "committedDate": "2019-11-14T16:49:07Z", "message": "Updated code formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "663ff31810c055b39bdb8f3364b2e15791b21732", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/663ff31810c055b39bdb8f3364b2e15791b21732", "committedDate": "2019-11-14T16:59:18Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "012aa7b80885a04fa9ff3c0c1afb10ea9921ab6a", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/012aa7b80885a04fa9ff3c0c1afb10ea9921ab6a", "committedDate": "2019-11-14T17:12:47Z", "message": "Changed code formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d9b1c29b1224eb3e69088881425257c0e8ddc21", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/0d9b1c29b1224eb3e69088881425257c0e8ddc21", "committedDate": "2019-11-14T17:13:19Z", "message": "Merge branch 'master' of https://github.com/epishova/bigquery-utils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf41a35a5417ede0b74e778afcebcc224e3d4fd9", "author": {"user": {"login": "freedomofnet", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/cf41a35a5417ede0b74e778afcebcc224e3d4fd9", "committedDate": "2019-11-14T17:49:07Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b6508848a93a3fef7dcea2e04c575ea43e52c9f", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/1b6508848a93a3fef7dcea2e04c575ea43e52c9f", "committedDate": "2020-02-13T23:11:16Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52fe01967637c501e3e09b81664472296afdbcee", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/52fe01967637c501e3e09b81664472296afdbcee", "committedDate": "2020-02-13T23:34:35Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f90ce1371c759cc1ba276485b4c97a99f0786ea5", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/f90ce1371c759cc1ba276485b4c97a99f0786ea5", "committedDate": "2020-02-13T23:37:59Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ca0550751f8c3a6932042c1de6a201e84470e86", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/5ca0550751f8c3a6932042c1de6a201e84470e86", "committedDate": "2020-05-11T01:23:55Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82123daae6dced87aa53c7ec1a6c086c917bc606", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/82123daae6dced87aa53c7ec1a6c086c917bc606", "committedDate": "2020-05-11T01:33:08Z", "message": "Merge with upstream/master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75b319119fa71db5fdb150941118b09dfe3cc43d", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/75b319119fa71db5fdb150941118b09dfe3cc43d", "committedDate": "2020-07-03T15:28:46Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d761b80734eab193494e1f37ae2b6061150f7b72", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/d761b80734eab193494e1f37ae2b6061150f7b72", "committedDate": "2020-07-04T00:48:33Z", "message": "Add calendar functions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/c8076abce410ff5029ebaf920c8346b8d6020d41", "committedDate": "2020-07-04T01:00:52Z", "message": "Add calendar functions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9174c4c124f5b095387a5df2772dafce3912f4b1", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/9174c4c124f5b095387a5df2772dafce3912f4b1", "committedDate": "2020-07-04T16:17:07Z", "message": "Add random_string function"}, "afterCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/c8076abce410ff5029ebaf920c8346b8d6020d41", "committedDate": "2020-07-04T01:00:52Z", "message": "Add calendar functions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNzg0ODA1", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-442784805", "createdAt": "2020-07-06T05:36:46Z", "commit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTozNjo0NlrOGtJYSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTozOTo1OFrOGtJbSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5Mjc3OA==", "bodyText": "We could probably shorten this signature by making it named week_of_month", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449992778", "createdAt": "2020-07-06T05:36:46Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/README.md", "diffHunk": "@@ -403,6 +415,16 @@ results:\n | facebook.com | NULL        | NULL             | NULL | rpc  |\n \n \n+### [week_number_of_month(date_expression ANY TYPE)](week_number_of_month.sql)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MjkxNQ==", "bodyText": "Add trailing new line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449992915", "createdAt": "2020-07-06T05:37:15Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/day_occurrence_of_month.sql", "diffHunk": "@@ -0,0 +1,29 @@\n+  \n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+-- day_occurrence_of_month: Returns the n th occurrence of the weekday in the month for the specified date.\n+-- Input: date_expression DATE or TIMESTAMP\n+-- Output: The result is an INTEGER value between 1 and 5, representing the n th occurrence of the weekday in the month.\n+CREATE OR REPLACE FUNCTION fn.day_occurrence_of_month(date_expression ANY TYPE) AS \n+(\n+  (\n+    SELECT \n+      IF(EXTRACT(DAYOFWEEK FROM DATE_TRUNC(CAST(date_expression AS DATE), MONTH)) > EXTRACT(DAYOFWEEK FROM date_expression),\n+        fn.week_number_of_month(date_expression),\n+        fn.week_number_of_month(date_expression) + 1)\n+  )\n+);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5Mjk0OA==", "bodyText": "Delete blank line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449992948", "createdAt": "2020-07-06T05:37:21Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/day_occurrence_of_month.sql", "diffHunk": "@@ -0,0 +1,29 @@\n+  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzExMQ==", "bodyText": "Place the EXTRACT call on the next line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993111", "createdAt": "2020-07-06T05:37:58Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/day_occurrence_of_month.sql", "diffHunk": "@@ -0,0 +1,29 @@\n+  \n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+-- day_occurrence_of_month: Returns the n th occurrence of the weekday in the month for the specified date.\n+-- Input: date_expression DATE or TIMESTAMP\n+-- Output: The result is an INTEGER value between 1 and 5, representing the n th occurrence of the weekday in the month.\n+CREATE OR REPLACE FUNCTION fn.day_occurrence_of_month(date_expression ANY TYPE) AS \n+(\n+  (\n+    SELECT \n+      IF(EXTRACT(DAYOFWEEK FROM DATE_TRUNC(CAST(date_expression AS DATE), MONTH)) > EXTRACT(DAYOFWEEK FROM date_expression),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzMwMA==", "bodyText": "What is expected if the input value is NULL?", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993300", "createdAt": "2020-07-06T05:38:52Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/test_cases.yaml", "diffHunk": "@@ -293,4 +293,23 @@ percentage_difference:\n   - test:\n     input: CAST(1.0 AS FLOAT64), CAST(1000000000 AS INT64)\n     expected_output: CAST(2.0 AS FLOAT64)\n- \n+week_number_of_month:\n+  - test:\n+    input: CAST(\"2020-07-03\" AS DATE)\n+    expected_output: CAST(0 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-08\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-10\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+day_occurrence_of_month:\n+  - test:\n+    input: CAST(\"2020-07-03\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-08\" AS DATE)\n+    expected_output: CAST(2 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-10\" AS DATE)\n+    expected_output: CAST(2 AS INT64)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzMzMQ==", "bodyText": "Add trailing new line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993331", "createdAt": "2020-07-06T05:39:03Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/test_cases.yaml", "diffHunk": "@@ -293,4 +293,23 @@ percentage_difference:\n   - test:\n     input: CAST(1.0 AS FLOAT64), CAST(1000000000 AS INT64)\n     expected_output: CAST(2.0 AS FLOAT64)\n- \n+week_number_of_month:\n+  - test:\n+    input: CAST(\"2020-07-03\" AS DATE)\n+    expected_output: CAST(0 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-08\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-10\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+day_occurrence_of_month:\n+  - test:\n+    input: CAST(\"2020-07-03\" AS DATE)\n+    expected_output: CAST(1 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-08\" AS DATE)\n+    expected_output: CAST(2 AS INT64)\n+  - test:\n+    input: CAST(\"2020-07-10\" AS DATE)\n+    expected_output: CAST(2 AS INT64)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzM3MQ==", "bodyText": "Add trailing new line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993371", "createdAt": "2020-07-06T05:39:12Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/week_number_of_month.sql", "diffHunk": "@@ -0,0 +1,27 @@\n+  \n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+-- week_number_of_month: Returns the number of weeks from the beginning of the month to the specified date\n+-- Input: date_expression DATE or TIMESTAMP\n+-- Output: The result is an INTEGER value between 1 and 5, representing the nth occurrence of the week in the month. The value 0 means the partial week\n+CREATE OR REPLACE FUNCTION fn.week_number_of_month(date_expression ANY TYPE) AS \n+(\n+  (\n+    SELECT \n+      EXTRACT(WEEK FROM date_expression) - EXTRACT(WEEK FROM DATE_TRUNC(CAST(date_expression AS DATE), MONTH))\n+  )\n+);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzQwMw==", "bodyText": "Delete blank line", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993403", "createdAt": "2020-07-06T05:39:18Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/week_number_of_month.sql", "diffHunk": "@@ -0,0 +1,27 @@\n+  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MzU0Nw==", "bodyText": "nth*", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r449993547", "createdAt": "2020-07-06T05:39:58Z", "author": {"login": "ryanmcdowell"}, "path": "udfs/community/README.md", "diffHunk": "@@ -72,6 +75,15 @@ results:\n | a   | b     |\n \n \n+### [day_occurrence_of_month(date_expression ANY TYPE)](day_occurrence_of_month.sql)\n+Returns the n th occurrence of the weekday in the month for the specified date. The result is an INTEGER value between 1 and 5.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8076abce410ff5029ebaf920c8346b8d6020d41"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15cbc711be801324f18f7c303fe4c728cad595c7", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/15cbc711be801324f18f7c303fe4c728cad595c7", "committedDate": "2020-07-11T23:47:27Z", "message": "Fixed formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b32f9bf50a79b07835838a50b6663ddd08162d0", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/9b32f9bf50a79b07835838a50b6663ddd08162d0", "committedDate": "2020-07-11T23:49:24Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a93a40895c4c3e45d12555ebd084be529735acf8", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/a93a40895c4c3e45d12555ebd084be529735acf8", "committedDate": "2020-07-12T00:58:31Z", "message": "Fix formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13ec55346db0d65b62432f1cde9aaac6a85452ff", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/13ec55346db0d65b62432f1cde9aaac6a85452ff", "committedDate": "2020-09-19T23:48:20Z", "message": "Added new line"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20410cde94b6a923a91b36b86ec10fb68a9e01c7", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/20410cde94b6a923a91b36b86ec10fb68a9e01c7", "committedDate": "2021-08-27T13:01:30Z", "message": "Merge branch 'master' into calendar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNTc0MTk5", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740574199", "createdAt": "2021-08-27T14:18:00Z", "commit": {"oid": "20410cde94b6a923a91b36b86ec10fb68a9e01c7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxNDoxODowMFrOKZKuZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxNDoxODowMFrOKZKuZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzQ3ODc1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    fn.week_number_of_month(date_expression),\n          \n          \n            \n                    fn.week_number_of_month(date_expression) + 1)\n          \n          \n            \n                    bqutil.fn.week_number_of_month(date_expression),\n          \n          \n            \n                    bqutil.fn.week_number_of_month(date_expression) + 1)", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697478756", "createdAt": "2021-08-27T14:18:00Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/day_occurrence_of_month.sql", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+-- day_occurrence_of_month: Returns the n th occurrence of the weekday in the month for the specified date.\n+-- Input: date_expression DATE or TIMESTAMP\n+-- Output: The result is an INTEGER value between 1 and 5, representing the n th occurrence of the weekday in the month.\n+CREATE OR REPLACE FUNCTION fn.day_occurrence_of_month(date_expression ANY TYPE) AS \n+(\n+  (\n+    SELECT \n+      IF(\n+      \tEXTRACT(DAYOFWEEK FROM DATE_TRUNC(CAST(date_expression AS DATE), MONTH))\n+      \t  > EXTRACT(DAYOFWEEK FROM date_expression),\n+        fn.week_number_of_month(date_expression),\n+        fn.week_number_of_month(date_expression) + 1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20410cde94b6a923a91b36b86ec10fb68a9e01c7"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/5fd00274ce412a694a32aa6e6717b90bda27931b", "committedDate": "2021-08-27T18:00:32Z", "message": "Add missing project id to UDF invocation within a UDF"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzg4MzQx", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740788341", "createdAt": "2021-08-27T18:26:03Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNjowM1rOKZUieQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNjowM1rOKZUieQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzYzOTU0NQ==", "bodyText": "Suggested change", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697639545", "createdAt": "2021-08-27T18:26:03Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/test_cases.yaml", "diffHunk": "@@ -451,4 +471,4 @@ linear_regression:\n   - test:\n     input: (SELECT [ (5.1,2.5), (5.0,2.0), (5.7,2.6), (6.0,2.2), (5.8,2.6), (5.5,2.3), (6.1,2.8), (5.5,2.5), (6.4,3.2), (5.6,3.0)])\n     expected_output: STRUCT(CAST(-0.4353361094588436 AS FLOAT64) AS a, CAST( 0.5300416418798544 AS FLOAT64) AS b, CAST(0.632366563565354 AS FLOAT64) AS r)\n-    \n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzg5MDUx", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740789051", "createdAt": "2021-08-27T18:27:01Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzowMVrOKZUkgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzowMVrOKZUkgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0MDA2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              bqutil.fn.week_number_of_month(DATE '2020-07-01'), \n          \n          \n            \n              bqutil.fn.week_number_of_month(DATE '2020-07-08');\n          \n          \n            \n              bqutil.fn.week_of_month(DATE '2020-07-01'), \n          \n          \n            \n              bqutil.fn.week_of_month(DATE '2020-07-08');", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697640066", "createdAt": "2021-08-27T18:27:01Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/README.md", "diffHunk": "@@ -674,6 +686,16 @@ results:\n | facebook.com | NULL        | NULL             | NULL | rpc  |\n \n \n+### [week_number_of_month(date_expression ANY TYPE)](week_number_of_month.sql)\n+Returns the number of weeks from the beginning of the month to the specified date. The result is an INTEGER value between 1 and 5, representing the nth occurrence of the week in the month. The value 0 means the partial week.\n+\n+```sql\n+SELECT \n+  bqutil.fn.week_number_of_month(DATE '2020-07-01'), \n+  bqutil.fn.week_number_of_month(DATE '2020-07-08');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzg5NDEz", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740789413", "createdAt": "2021-08-27T18:27:28Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzoyOFrOKZUlgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzoyOFrOKZUlgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0MDMyMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * [week_number_of_month](#week_number_of_monthdate_expression-any-type)\n          \n          \n            \n            * [week_of_month](#week_of_monthdate_expression-any-type)", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697640321", "createdAt": "2021-08-27T18:27:28Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/README.md", "diffHunk": "@@ -49,6 +50,8 @@ SELECT bqutil.fn.int(1.684)\n * [url_keys](#url_keysquery-string)\n * [url_param](#url_paramquery-string-p-string)\n * [url_parse](#url_parseurlstring-string-parttoextract-string)\n+* [week_number_of_month](#week_number_of_monthdate_expression-any-type)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzg5ODM0", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740789834", "createdAt": "2021-08-27T18:27:57Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzo1N1rOKZUmwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyNzo1N1rOKZUmwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0MDY0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ### [week_number_of_month(date_expression ANY TYPE)](week_number_of_month.sql)\n          \n          \n            \n            ### [week_of_month(date_expression ANY TYPE)](week_of_month.sql)", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697640640", "createdAt": "2021-08-27T18:27:57Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/README.md", "diffHunk": "@@ -674,6 +686,16 @@ results:\n | facebook.com | NULL        | NULL             | NULL | rpc  |\n \n \n+### [week_number_of_month(date_expression ANY TYPE)](week_number_of_month.sql)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzkwOTUw", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740790950", "createdAt": "2021-08-27T18:29:24Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyOToyNVrOKZUqeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyOToyNVrOKZUqeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0MTU5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    bqutil.fn.week_number_of_month(date_expression),\n          \n          \n            \n                    bqutil.fn.week_number_of_month(date_expression) + 1)\n          \n          \n            \n                    bqutil.fn.week_of_month(date_expression),\n          \n          \n            \n                    bqutil.fn.week_of_month(date_expression) + 1)", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697641592", "createdAt": "2021-08-27T18:29:25Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/day_occurrence_of_month.sql", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+-- day_occurrence_of_month: Returns the n th occurrence of the weekday in the month for the specified date.\n+-- Input: date_expression DATE or TIMESTAMP\n+-- Output: The result is an INTEGER value between 1 and 5, representing the n th occurrence of the weekday in the month.\n+CREATE OR REPLACE FUNCTION fn.day_occurrence_of_month(date_expression ANY TYPE) AS \n+(\n+  (\n+    SELECT \n+      IF(\n+      \tEXTRACT(DAYOFWEEK FROM DATE_TRUNC(CAST(date_expression AS DATE), MONTH))\n+      \t  > EXTRACT(DAYOFWEEK FROM date_expression),\n+        bqutil.fn.week_number_of_month(date_expression),\n+        bqutil.fn.week_number_of_month(date_expression) + 1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzkxMTg2", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740791186", "createdAt": "2021-08-27T18:29:43Z", "commit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyOTo0M1rOKZUrGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODoyOTo0M1rOKZUrGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0MTc1NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            week_number_of_month:\n          \n          \n            \n            week_of_month:", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697641754", "createdAt": "2021-08-27T18:29:43Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/test_cases.yaml", "diffHunk": "@@ -293,6 +293,26 @@ percentage_difference:\n   - test:\n     input: CAST(1.0 AS FLOAT64), CAST(1000000000 AS INT64)\n     expected_output: CAST(2.0 AS FLOAT64)\n+week_number_of_month:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fd00274ce412a694a32aa6e6717b90bda27931b"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a595bbbe3a219831a9b73e56992094537d7c351d", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/a595bbbe3a219831a9b73e56992094537d7c351d", "committedDate": "2021-08-27T18:39:18Z", "message": "Rename week_number_of_month to week_of_month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ce161a882fe79edf257322437d975902bc6ca73", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/2ce161a882fe79edf257322437d975902bc6ca73", "committedDate": "2021-08-27T18:39:26Z", "message": "Rename week_number_of_month to week_of_month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c249187b90082edbe8af86fdb4a43fc56bd943bc", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/c249187b90082edbe8af86fdb4a43fc56bd943bc", "committedDate": "2021-08-27T18:39:35Z", "message": "Rename week_number_of_month to week_of_month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e966e32b80b3062910a51cbd119ff637f8c3b452", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/e966e32b80b3062910a51cbd119ff637f8c3b452", "committedDate": "2021-08-27T18:39:42Z", "message": "Rename week_number_of_month to week_of_month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f9a8982048b177b42d2dbf02fef720890163597", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/1f9a8982048b177b42d2dbf02fef720890163597", "committedDate": "2021-08-27T18:39:59Z", "message": "Rename week_number_of_month to week_of_month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a22687142fd27da0e4da8f493fb5abea9e58768", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/8a22687142fd27da0e4da8f493fb5abea9e58768", "committedDate": "2021-08-27T18:40:11Z", "message": "Add trailing newline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwNzk5MDI4", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740799028", "createdAt": "2021-08-27T18:40:42Z", "commit": {"oid": "8a22687142fd27da0e4da8f493fb5abea9e58768"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODo0MDo0M1rOKZVCiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wOC0yN1QxODo0MDo0M1rOKZVCiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzY0Nzc1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                expected_output: STRUCT(CAST(-0.4353361094588436 AS FLOAT64) AS a, CAST( 0.5300416418798544 AS FLOAT64) AS b, CAST(0.632366563565354 AS FLOAT64) AS r)\n          \n          \n            \n                expected_output: STRUCT(CAST(-0.4353361094588436 AS FLOAT64) AS a, CAST( 0.5300416418798544 AS FLOAT64) AS b, CAST(0.632366563565354 AS FLOAT64) AS r)", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#discussion_r697647755", "createdAt": "2021-08-27T18:40:43Z", "author": {"login": "danieldeleo"}, "path": "udfs/community/test_cases.yaml", "diffHunk": "@@ -450,5 +470,4 @@ kruskal_wallis:\n linear_regression:\n   - test:\n     input: (SELECT [ (5.1,2.5), (5.0,2.0), (5.7,2.6), (6.0,2.2), (5.8,2.6), (5.5,2.3), (6.1,2.8), (5.5,2.5), (6.4,3.2), (5.6,3.0)])\n-    expected_output: STRUCT(CAST(-0.4353361094588436 AS FLOAT64) AS a, CAST( 0.5300416418798544 AS FLOAT64) AS b, CAST(0.632366563565354 AS FLOAT64) AS r)\n-    \n+    expected_output: STRUCT(CAST(-0.4353361094588436 AS FLOAT64) AS a, CAST( 0.5300416418798544 AS FLOAT64) AS b, CAST(0.632366563565354 AS FLOAT64) AS r)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a22687142fd27da0e4da8f493fb5abea9e58768"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed9799c17ec81c11ca194e8989da8ed75c8fb7e4", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/ed9799c17ec81c11ca194e8989da8ed75c8fb7e4", "committedDate": "2021-08-27T18:40:53Z", "message": "Add trailing newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4f09e9e4ed2fc71b6d576fb617d9d6ea3d5e13d", "author": {"user": {"login": "danieldeleo", "name": "Daniel De Leo"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/a4f09e9e4ed2fc71b6d576fb617d9d6ea3d5e13d", "committedDate": "2021-08-27T18:43:43Z", "message": "Merge branch 'master' into calendar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1b3caa94271f698af809f6a9df27a349606990d", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/f1b3caa94271f698af809f6a9df27a349606990d", "committedDate": "2021-08-27T19:01:17Z", "message": "Merge branch 'master' into calendar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6219448c89168b8fbad88eb83c0857575f96b229", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/6219448c89168b8fbad88eb83c0857575f96b229", "committedDate": "2021-08-27T21:19:41Z", "message": "Update day_occurrence_of_month.sql\n\nCopyright 2021"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20825bcc8d3eff49aa2e7b66b1725b57d55703bf", "author": {"user": {"login": "epishova", "name": "Anna Epishova"}}, "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/commit/20825bcc8d3eff49aa2e7b66b1725b57d55703bf", "committedDate": "2021-08-27T21:20:03Z", "message": "Update week_of_month.sql\n\nCopyright 2021"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwOTA0Mzcw", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740904370", "createdAt": "2021-08-27T21:27:18Z", "commit": {"oid": "20825bcc8d3eff49aa2e7b66b1725b57d55703bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQwOTA4NTQw", "url": "https://github.com/GoogleCloudPlatform/bigquery-utils/pull/84#pullrequestreview-740908540", "createdAt": "2021-08-27T21:35:38Z", "commit": {"oid": "20825bcc8d3eff49aa2e7b66b1725b57d55703bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 620, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}