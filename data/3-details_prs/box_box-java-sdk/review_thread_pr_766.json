{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MzU4MjY5", "number": 766, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoyODo0OFrOD4HgTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoyOTo1MlrOD4Hh9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMTY5ODA1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/box/sdk/BoxUser.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoyODo0OFrOGOxDnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMjowMTozOFrOGX0OAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEzNjk4OQ==", "bodyText": "Could use return JsonObject.readFrom(this.trackingCodes.toString()).\nhttps://www.javadoc.io/doc/com.eclipsesource.minimal-json/minimal-json/0.9.4/com/eclipsesource/json/JsonObject.html\nCould simplify code a bit, but don't think it's necessary. Either way works for me.", "url": "https://github.com/box/box-java-sdk/pull/766#discussion_r418136989", "createdAt": "2020-04-30T16:28:48Z", "author": {"login": "sujaygarlanka"}, "path": "src/main/java/com/box/sdk/BoxUser.java", "diffHunk": "@@ -1059,12 +1059,39 @@ public String getHostname() {\n \n         /**\n          * Gets the tracking defined for each entity.\n-         * @return a Map with traking codes.\n+         * @return a Map with tracking codes.\n          */\n         public Map<String, String> getTrackingCodes() {\n             return this.trackingCodes;\n         }\n \n+        /**\n+         * Allows admin to set attributes specific for a group of users.\n+         * @param trackingCodes a Map representing the user's new tracking codes\n+         */\n+        public void setTrackingCodes(Map<String, String> trackingCodes) {\n+            this.trackingCodes = trackingCodes;\n+            this.addPendingChange(\"tracking_codes\", this.trackingCodesJson());\n+        }\n+\n+        /**\n+         * Allows the admin to append new tracking codes to the previous existing list.\n+         * @param name the name or `key` of the attribute to set.\n+         * @param value the value of the attribute to set.\n+         */\n+        public void appendTrackingCodes(String name, String value) {\n+            this.getTrackingCodes().put(name, value);\n+            this.addPendingChange(\"tracking_codes\", this.trackingCodesJson());\n+        }\n+\n+        private JsonObject trackingCodesJson() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ae12c73b6118783ebafbc50476a54292b80c7a6"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYyNTk4NA==", "bodyText": "I can't actually do this because the Map isn't \"valid JSON\" at this point.  (It becomes valid later, when it's saved to the BoxUser.)", "url": "https://github.com/box/box-java-sdk/pull/766#discussion_r427625984", "createdAt": "2020-05-19T22:01:38Z", "author": {"login": "PJSimon"}, "path": "src/main/java/com/box/sdk/BoxUser.java", "diffHunk": "@@ -1059,12 +1059,39 @@ public String getHostname() {\n \n         /**\n          * Gets the tracking defined for each entity.\n-         * @return a Map with traking codes.\n+         * @return a Map with tracking codes.\n          */\n         public Map<String, String> getTrackingCodes() {\n             return this.trackingCodes;\n         }\n \n+        /**\n+         * Allows admin to set attributes specific for a group of users.\n+         * @param trackingCodes a Map representing the user's new tracking codes\n+         */\n+        public void setTrackingCodes(Map<String, String> trackingCodes) {\n+            this.trackingCodes = trackingCodes;\n+            this.addPendingChange(\"tracking_codes\", this.trackingCodesJson());\n+        }\n+\n+        /**\n+         * Allows the admin to append new tracking codes to the previous existing list.\n+         * @param name the name or `key` of the attribute to set.\n+         * @param value the value of the attribute to set.\n+         */\n+        public void appendTrackingCodes(String name, String value) {\n+            this.getTrackingCodes().put(name, value);\n+            this.addPendingChange(\"tracking_codes\", this.trackingCodesJson());\n+        }\n+\n+        private JsonObject trackingCodesJson() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEzNjk4OQ=="}, "originalCommit": {"oid": "1ae12c73b6118783ebafbc50476a54292b80c7a6"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMTcwMjI4OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/box/sdk/BoxUserTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoyOTo1MlrOGOxGQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMjowMTo0NFrOGX0OLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEzNzY2Nw==", "bodyText": "Same option as above.", "url": "https://github.com/box/box-java-sdk/pull/766#discussion_r418137667", "createdAt": "2020-04-30T16:29:52Z", "author": {"login": "sujaygarlanka"}, "path": "src/test/java/com/box/sdk/BoxUserTest.java", "diffHunk": "@@ -477,4 +480,94 @@ public void testDeserializationException() throws IOException {\n         BoxUser.Info userInfo = new BoxUser(this.api, userID).getInfo();\n         Assert.assertEquals(\"12345\", userInfo.getID());\n     }\n+\n+    @Test\n+    @Category(UnitTest.class)\n+    public void testCreateReadAddTrackingCodesSucceeds() throws IOException {\n+        final String userID = \"12345\";\n+        final String departmentID = \"8675\";\n+        final String companyID = \"1701\";\n+        final String usersURL = \"/users/\" + userID;\n+\n+        // Mock: Create two tracking codes\n+        Map<String, String> createTrackingCodes = new HashMap<String, String>();\n+        createTrackingCodes.put(\"Employee ID\", userID);\n+        createTrackingCodes.put(\"Department ID\", departmentID);\n+        String createBody = this.trackingCodesJson(createTrackingCodes).toString();\n+        String createResponse = TestConfig.getFixture(\"BoxUser/CreateTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.put(WireMock.urlPathEqualTo(usersURL))\n+            .withRequestBody(WireMock.equalToJson(createBody))\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(createResponse)));\n+\n+        // Mock: Verify change\n+        String twoTrackingCodesResponse = TestConfig.getFixture(\"BoxUser/GetUserTwoTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.get(WireMock.urlPathEqualTo(usersURL))\n+            .withQueryParam(\"fields\", WireMock.equalTo(\"tracking_codes\"))\n+            .inScenario(\"Get Tracking Code Scenario\")\n+            .whenScenarioStateIs(Scenario.STARTED)\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(twoTrackingCodesResponse))\n+            .willSetStateTo(\"1st Request\"));\n+\n+        // Mock: Add one more tracking code\n+        Map<String, String> appendTrackingCodes = new HashMap<String, String>();\n+        appendTrackingCodes.put(\"Employee ID\", userID);\n+        appendTrackingCodes.put(\"Department ID\", departmentID);\n+        appendTrackingCodes.put(\"Company ID\", companyID);\n+        String updateBody = this.trackingCodesJson(appendTrackingCodes).toString();\n+        String updateResponse = TestConfig.getFixture(\"BoxUser/UpdateTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.put(WireMock.urlPathEqualTo(usersURL))\n+            .withRequestBody(WireMock.equalToJson(updateBody))\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(updateResponse)));\n+\n+        // Mock: Verify change\n+        String threeTrackingCodesResponse = TestConfig.getFixture(\"BoxUser/GetUserThreeTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.get(WireMock.urlPathEqualTo(usersURL))\n+            .withQueryParam(\"fields\", WireMock.equalTo(\"tracking_codes\"))\n+            .inScenario(\"Get Tracking Code Scenario\")\n+            .whenScenarioStateIs(\"1st Request\")\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(threeTrackingCodesResponse))\n+            .willSetStateTo(\"2nd Request\"));\n+\n+        // Create two tracking codes\n+        BoxUser user = new BoxUser(this.api, userID);\n+        BoxUser.Info info = user.new Info();\n+        info.setTrackingCodes(createTrackingCodes);\n+        user.updateInfo(info);\n+\n+        // Verify change\n+        user = new BoxUser(this.api, userID);\n+        info = user.getInfo(\"tracking_codes\");\n+        Map<String, String> receivedTrackingCodes = info.getTrackingCodes();\n+        Assert.assertEquals(createTrackingCodes, receivedTrackingCodes);\n+\n+        // Add one more tracking code\n+        info.appendTrackingCodes(\"Company ID\", companyID);\n+        user.updateInfo(info);\n+\n+        // Verify change\n+        user = new BoxUser(this.api, userID);\n+        info = user.getInfo(\"tracking_codes\");\n+        receivedTrackingCodes = info.getTrackingCodes();\n+        Assert.assertEquals(appendTrackingCodes, receivedTrackingCodes);\n+    }\n+\n+    private JsonObject trackingCodesJson(Map<String, String> trackingCodes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ae12c73b6118783ebafbc50476a54292b80c7a6"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYyNjAzMA==", "bodyText": "I can't actually do this because the Map isn't \"valid JSON\" at this point.  (It becomes valid later, when it's saved to the BoxUser.)", "url": "https://github.com/box/box-java-sdk/pull/766#discussion_r427626030", "createdAt": "2020-05-19T22:01:44Z", "author": {"login": "PJSimon"}, "path": "src/test/java/com/box/sdk/BoxUserTest.java", "diffHunk": "@@ -477,4 +480,94 @@ public void testDeserializationException() throws IOException {\n         BoxUser.Info userInfo = new BoxUser(this.api, userID).getInfo();\n         Assert.assertEquals(\"12345\", userInfo.getID());\n     }\n+\n+    @Test\n+    @Category(UnitTest.class)\n+    public void testCreateReadAddTrackingCodesSucceeds() throws IOException {\n+        final String userID = \"12345\";\n+        final String departmentID = \"8675\";\n+        final String companyID = \"1701\";\n+        final String usersURL = \"/users/\" + userID;\n+\n+        // Mock: Create two tracking codes\n+        Map<String, String> createTrackingCodes = new HashMap<String, String>();\n+        createTrackingCodes.put(\"Employee ID\", userID);\n+        createTrackingCodes.put(\"Department ID\", departmentID);\n+        String createBody = this.trackingCodesJson(createTrackingCodes).toString();\n+        String createResponse = TestConfig.getFixture(\"BoxUser/CreateTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.put(WireMock.urlPathEqualTo(usersURL))\n+            .withRequestBody(WireMock.equalToJson(createBody))\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(createResponse)));\n+\n+        // Mock: Verify change\n+        String twoTrackingCodesResponse = TestConfig.getFixture(\"BoxUser/GetUserTwoTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.get(WireMock.urlPathEqualTo(usersURL))\n+            .withQueryParam(\"fields\", WireMock.equalTo(\"tracking_codes\"))\n+            .inScenario(\"Get Tracking Code Scenario\")\n+            .whenScenarioStateIs(Scenario.STARTED)\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(twoTrackingCodesResponse))\n+            .willSetStateTo(\"1st Request\"));\n+\n+        // Mock: Add one more tracking code\n+        Map<String, String> appendTrackingCodes = new HashMap<String, String>();\n+        appendTrackingCodes.put(\"Employee ID\", userID);\n+        appendTrackingCodes.put(\"Department ID\", departmentID);\n+        appendTrackingCodes.put(\"Company ID\", companyID);\n+        String updateBody = this.trackingCodesJson(appendTrackingCodes).toString();\n+        String updateResponse = TestConfig.getFixture(\"BoxUser/UpdateTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.put(WireMock.urlPathEqualTo(usersURL))\n+            .withRequestBody(WireMock.equalToJson(updateBody))\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(updateResponse)));\n+\n+        // Mock: Verify change\n+        String threeTrackingCodesResponse = TestConfig.getFixture(\"BoxUser/GetUserThreeTrackingCodes200\");\n+        WIRE_MOCK_CLASS_RULE.stubFor(WireMock.get(WireMock.urlPathEqualTo(usersURL))\n+            .withQueryParam(\"fields\", WireMock.equalTo(\"tracking_codes\"))\n+            .inScenario(\"Get Tracking Code Scenario\")\n+            .whenScenarioStateIs(\"1st Request\")\n+            .willReturn(WireMock.aResponse()\n+                .withHeader(\"Content-Type\", \"application/json\")\n+                .withBody(threeTrackingCodesResponse))\n+            .willSetStateTo(\"2nd Request\"));\n+\n+        // Create two tracking codes\n+        BoxUser user = new BoxUser(this.api, userID);\n+        BoxUser.Info info = user.new Info();\n+        info.setTrackingCodes(createTrackingCodes);\n+        user.updateInfo(info);\n+\n+        // Verify change\n+        user = new BoxUser(this.api, userID);\n+        info = user.getInfo(\"tracking_codes\");\n+        Map<String, String> receivedTrackingCodes = info.getTrackingCodes();\n+        Assert.assertEquals(createTrackingCodes, receivedTrackingCodes);\n+\n+        // Add one more tracking code\n+        info.appendTrackingCodes(\"Company ID\", companyID);\n+        user.updateInfo(info);\n+\n+        // Verify change\n+        user = new BoxUser(this.api, userID);\n+        info = user.getInfo(\"tracking_codes\");\n+        receivedTrackingCodes = info.getTrackingCodes();\n+        Assert.assertEquals(appendTrackingCodes, receivedTrackingCodes);\n+    }\n+\n+    private JsonObject trackingCodesJson(Map<String, String> trackingCodes) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEzNzY2Nw=="}, "originalCommit": {"oid": "1ae12c73b6118783ebafbc50476a54292b80c7a6"}, "originalPosition": 112}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1225, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}