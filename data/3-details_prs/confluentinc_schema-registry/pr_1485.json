{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNTc4Nzk4", "number": 1485, "title": "Add node information to SchemaRegistryProtocol", "bodyText": "As of right now, we cannot compute the number of nodes in an SR cluster because the nodes do not fully know about each other. This PR adds this information to the SchemaRegistryProtocol, used when Kafka election is enabled on the SR.", "createdAt": "2020-06-09T07:00:09Z", "url": "https://github.com/confluentinc/schema-registry/pull/1485", "merged": true, "mergeCommit": {"oid": "10337c35f7b22b969ba921318f1c2002996a769d"}, "closed": true, "closedAt": "2020-06-09T21:41:37Z", "author": {"login": "dragosvictor"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpegNxgH2gAyNDMxNTc4Nzk4OjFkNjJhM2FhMDVkYWFjMWMzOTBlNTFmYTVhYjk5MjM3ZjkyMTM2YzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpsEhEAFqTQyNzU2Mzk4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1d62a3aa05daac1c390e51fa5ab99237f92136c3", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/1d62a3aa05daac1c390e51fa5ab99237f92136c3", "committedDate": "2020-06-09T05:49:19Z", "message": "Add list of nodes to SchemaRegistryProtocol.Assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10d76dea5cea41157594d3d785d2d6aac6e7ffd7", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/10d76dea5cea41157594d3d785d2d6aac6e7ffd7", "committedDate": "2020-06-09T06:39:59Z", "message": "Verify node count metrics in election tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11ba87090b39f286488b4943b86e3ccfbac253d7", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/11ba87090b39f286488b4943b86e3ccfbac253d7", "committedDate": "2020-06-09T06:54:07Z", "message": "Wait until node count matches"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87660db32438f5e805ea7cf249107c6721b7dedc", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/87660db32438f5e805ea7cf249107c6721b7dedc", "committedDate": "2020-06-09T07:04:06Z", "message": "Cosmetic fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ec0814947818aaba25c2d83a8ee699ea015dfc4", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/7ec0814947818aaba25c2d83a8ee699ea015dfc4", "committedDate": "2020-06-09T17:31:45Z", "message": "Cleanup test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c42f60135a25a6ccb624fb94858738637702fe8", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/5c42f60135a25a6ccb624fb94858738637702fe8", "committedDate": "2020-06-09T17:55:58Z", "message": "Move test to separate file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73b4f1b64560928dd21d8ade6d795339ed0353b5", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/73b4f1b64560928dd21d8ade6d795339ed0353b5", "committedDate": "2020-06-09T17:58:46Z", "message": "Revert old test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0ee1a0fd0aab2a7f10846daff07a45d6c47e2da", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/e0ee1a0fd0aab2a7f10846daff07a45d6c47e2da", "committedDate": "2020-06-09T18:03:02Z", "message": "Clarify some comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6034a4d592f0640c2fb63331d128a5d64498dc4", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/f6034a4d592f0640c2fb63331d128a5d64498dc4", "committedDate": "2020-06-09T18:24:48Z", "message": "Fix toString"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78679b68f362e34d9644682127534341deb4a097", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/78679b68f362e34d9644682127534341deb4a097", "committedDate": "2020-06-09T18:26:44Z", "message": "Cosmetic fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NTI3Mjgy", "url": "https://github.com/confluentinc/schema-registry/pull/1485#pullrequestreview-427527282", "createdAt": "2020-06-09T20:42:30Z", "commit": {"oid": "78679b68f362e34d9644682127534341deb4a097"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDo0MjozMFrOGhbbsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMDo0MjozMFrOGhbbsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzcwNTY0OA==", "bodyText": "Maybe add a null check for nodes() as well?  In case of upgrades from an older version this may be the case.", "url": "https://github.com/confluentinc/schema-registry/pull/1485#discussion_r437705648", "createdAt": "2020-06-09T20:42:30Z", "author": {"login": "rayokota"}, "path": "core/src/main/java/io/confluent/kafka/schemaregistry/leaderelector/kafka/SchemaRegistryCoordinator.java", "diffHunk": "@@ -147,6 +148,9 @@ protected void onJoinComplete(\n   ) {\n     assignmentSnapshot = SchemaRegistryProtocol.deserializeAssignment(memberAssignment);\n     listener.onAssigned(assignmentSnapshot, generation);\n+    if (nodeCountMetric != null) {\n+      nodeCountMetric.set(assignmentSnapshot.nodes().size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78679b68f362e34d9644682127534341deb4a097"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08a8801d1c5b8551e3acec914bbae772b2df7a1b", "author": {"user": {"login": "dragosvictor", "name": "Dragos Misca"}}, "url": "https://github.com/confluentinc/schema-registry/commit/08a8801d1c5b8551e3acec914bbae772b2df7a1b", "committedDate": "2020-06-09T21:03:30Z", "message": "Null check assignment snapshots"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NTYzOTgy", "url": "https://github.com/confluentinc/schema-registry/pull/1485#pullrequestreview-427563982", "createdAt": "2020-06-09T21:37:44Z", "commit": {"oid": "08a8801d1c5b8551e3acec914bbae772b2df7a1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4485, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}