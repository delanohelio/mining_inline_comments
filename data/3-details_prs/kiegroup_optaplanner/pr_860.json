{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3NjY1Nzgy", "number": 860, "title": "Secure XML transformation against XXE", "bodyText": "Fixes a security vulnerability found by SonarCloud, see:\nhttps://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)", "createdAt": "2020-07-28T09:00:07Z", "url": "https://github.com/kiegroup/optaplanner/pull/860", "merged": true, "mergeCommit": {"oid": "ed61375f66cb2a8ea888b9acf9759524b081fa14"}, "closed": true, "closedAt": "2020-07-28T09:48:29Z", "author": {"login": "rsynek"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5SmHEgH2gAyNDU3NjY1NzgyOjU1YjNiYjM3MjlhNGRmNzRkZmE3NDdjY2ZhMzRmYzYwY2Y3ZTBjOWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5_UmSgFqTQ1ODM4MDg1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "55b3bb3729a4df74dfa747ccfa34fc60cf7e0c9a", "author": {"user": {"login": "rsynek", "name": "Radovan Synek"}}, "url": "https://github.com/kiegroup/optaplanner/commit/55b3bb3729a4df74dfa747ccfa34fc60cf7e0c9a", "committedDate": "2020-07-28T08:59:41Z", "message": "Secure XML transformation against XXE"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDQzNTA2", "url": "https://github.com/kiegroup/optaplanner/pull/860#pullrequestreview-456443506", "createdAt": "2020-07-28T09:05:55Z", "commit": {"oid": "55b3bb3729a4df74dfa747ccfa34fc60cf7e0c9a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MzgwODU0", "url": "https://github.com/kiegroup/optaplanner/pull/860#pullrequestreview-458380854", "createdAt": "2020-07-30T13:06:17Z", "commit": {"oid": "55b3bb3729a4df74dfa747ccfa34fc60cf7e0c9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzowNjoxN1rOG5iI3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzowNjoxN1rOG5iI3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk4MTM0Mw==", "bodyText": "@rsynek This TransformerFactory instance is not used to create a transformer. A fresh instance without these attributes is created on line 100 so this seems to have no effect.\nFurthermore, is this even needed? This method is only used to write our own classes to XML. The attack seems to be applicable to XML reading only.", "url": "https://github.com/kiegroup/optaplanner/pull/860#discussion_r462981343", "createdAt": "2020-07-30T13:06:17Z", "author": {"login": "yurloc"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/io/jaxb/JaxbIO.java", "diffHunk": "@@ -86,11 +87,20 @@ public void write(T root, Writer writer) {\n         }\n \n         // see https://stackoverflow.com/questions/46708498/jaxb-marshaller-indentation\n+        TransformerFactory transformerFactory = TransformerFactory.newInstance();\n         Transformer transformer;\n         try {\n+            /*\n+             * Disable usage of external entities, see:\n+             * https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)\n+             */\n+            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n+            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55b3bb3729a4df74dfa747ccfa34fc60cf7e0c9a"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3362, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}