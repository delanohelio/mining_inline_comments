{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NzkyOTAw", "number": 794, "title": "PLANNER-1991 ScoreHolder-related deprecations", "bodyText": "It's a bit unfortunate that I had to deprecate the ScoreHolder impl classes. But considering that there is no real IDE support for DRL, users hopefully won't even notice.", "createdAt": "2020-06-01T06:57:07Z", "url": "https://github.com/kiegroup/optaplanner/pull/794", "merged": true, "mergeCommit": {"oid": "09145174e0c57c72018d8f128bfe3d9ba692af18"}, "closed": true, "closedAt": "2020-06-02T13:40:15Z", "author": {"login": "triceo"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm6W3-gH2gAyNDI1NzkyOTAwOjExOTQ5NTk3YTczNDFkYzA2YjZjNDQ0ZDhhZjI1ZjA3MzdkYmMyN2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnVBPAgH2gAyNDI1NzkyOTAwOmRmOGUzMTEzYjgyZjJhODM0ZmM5MGEyZTZjM2EyOGUwZDNhOThmZGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "11949597a7341dc06b6c444d8af25f0737dbc27c", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/11949597a7341dc06b6c444d8af25f0737dbc27c", "committedDate": "2020-06-01T06:34:41Z", "message": "Base deprecations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41a9d33b4be7a96d8a1ca1cb5c215d47e28f9290", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/41a9d33b4be7a96d8a1ca1cb5c215d47e28f9290", "committedDate": "2020-06-01T06:40:11Z", "message": "Deprecate one more class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/958580c10c8538115d959d4ee0abfd47f4a867fc", "committedDate": "2020-06-01T06:47:46Z", "message": "Deal with the impact of deprecation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY2ODEx", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421766811", "createdAt": "2020-06-01T11:15:38Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNTozOFrOGdG_2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNTozOFrOGdG_2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NjUzNg==", "bodyText": "I don't think we can deprecate the actual ScoreHolders, like this one. As that means we're forcing people in scoreDRL to use deprecated code, with no alternative to migrate to.\nWhat we can do is deprecate the methods we don't want them to use, and once we branch 8.0, turn BendableScoreHolder etc into an interface with the exact same full class name while only remaining the methods that we allow them to use.", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433176536", "createdAt": "2020-06-01T11:15:38Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/buildin/bendable/BendableScoreHolder.java", "diffHunk": "@@ -30,7 +30,9 @@\n \n /**\n  * @see BendableScore\n+ * @deprecated to be replaced by an interface of the same name, removing many methods\n  */\n+@Deprecated\n public class BendableScoreHolder extends AbstractScoreHolder<BendableScore> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY3NjUz", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421767653", "createdAt": "2020-06-01T11:17:21Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzoyMVrOGdHCQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzoyMVrOGdHCQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NzE1NQ==", "bodyText": "Let's reference ScoreManager because if they're using this, they probably want to learn about ScoreManager.", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433177155", "createdAt": "2020-06-01T11:17:21Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/holder/ScoreHolder.java", "diffHunk": "@@ -50,15 +50,19 @@\n      * @param initScore {@code <= 0}, managed by OptaPlanner, needed as a parameter in the {@link Score}'s creation\n      *        method, see {@link Score#getInitScore()}\n      * @return never null, the {@link Score} of the working {@link PlanningSolution}\n+     * @deprecated for removal from public API", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY3NzQ4", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421767748", "createdAt": "2020-06-01T11:17:33Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzozM1rOGdHCkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzozM1rOGdHCkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NzIzNQ==", "bodyText": "Let's reference ScoreManager because if they're using this, they probably want to learn about ScoreManager.", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433177235", "createdAt": "2020-06-01T11:17:33Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/holder/ScoreHolder.java", "diffHunk": "@@ -81,7 +87,9 @@\n      * @return never null\n      * @throws IllegalStateException if {@link #isConstraintMatchEnabled()} is false\n      * @see ScoreDirector#getConstraintMatchTotals()\n+     * @deprecated for removal from public API", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY3Nzk0", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421767794", "createdAt": "2020-06-01T11:17:37Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzozN1rOGdHCtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzozN1rOGdHCtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NzI2OQ==", "bodyText": "Let's reference ScoreManager because if they're using this, they probably want to learn about ScoreManager.", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433177269", "createdAt": "2020-06-01T11:17:37Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/holder/ScoreHolder.java", "diffHunk": "@@ -92,7 +100,9 @@\n      * @return never null\n      * @throws IllegalStateException if {@link #isConstraintMatchEnabled()} is false\n      * @see ScoreDirector#getConstraintMatchTotalMap()\n+     * @deprecated for removal from public API", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY3ODM3", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421767837", "createdAt": "2020-06-01T11:17:41Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzo0MVrOGdHC1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNzo0MVrOGdHC1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NzMwMw==", "bodyText": "Let's reference ScoreManager because if they're using this, they probably want to learn about ScoreManager.", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433177303", "createdAt": "2020-06-01T11:17:41Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/holder/ScoreHolder.java", "diffHunk": "@@ -103,7 +113,9 @@\n      * @return never null\n      * @throws IllegalStateException if {@link #isConstraintMatchEnabled()} returns false\n      * @see ScoreDirector#getIndictmentMap()\n+     * @deprecated for removal from public API", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY5Mzk4", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421769398", "createdAt": "2020-06-01T11:20:53Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyMDo1M1rOGdHHjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyMDo1M1rOGdHHjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3ODUxMA==", "bodyText": "I am not sure about these changes.\nIn 8.0, where we have DefaultBendableScoreHolder implements BendableScoreHolder, we'll want to return BendableScoreHolder here (not DefaultBendableScoreHolder nor just ScoreHolder). Or wait - optaplanner-core will need something that has extractScore(), so it will need to return AbstractScoreHolder or InnerScoreHolder or DefaultBendableScoreHolder anyway...", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433178510", "createdAt": "2020-06-01T11:20:53Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/score/buildin/bendable/BendableScoreDefinition.java", "diffHunk": "@@ -109,7 +110,7 @@ public BendableScoreInliner buildScoreInliner(boolean constraintMatchEnabled) {\n     }\n \n     @Override\n-    public BendableScoreHolder buildScoreHolder(boolean constraintMatchEnabled) {\n+    public ScoreHolder buildScoreHolder(boolean constraintMatchEnabled) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzcwMzYz", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421770363", "createdAt": "2020-06-01T11:22:47Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyMjo0N1rOGdHKXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyMjo0N1rOGdHKXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3OTIyOQ==", "bodyText": "The real reason they are deprecated is because \"floating point numbers are not associative (A + B + C == C + B + A) and therefore they are not compatible with incremental score calculation\".", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433179229", "createdAt": "2020-06-01T11:22:47Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/score/buildin/hardsoftdouble/HardSoftDoubleScoreDefinition.java", "diffHunk": "@@ -20,11 +20,16 @@\n \n import org.optaplanner.core.api.score.buildin.hardsoftdouble.HardSoftDoubleScore;\n import org.optaplanner.core.api.score.buildin.hardsoftdouble.HardSoftDoubleScoreHolder;\n+import org.optaplanner.core.api.score.holder.ScoreHolder;\n import org.optaplanner.core.config.score.trend.InitializingScoreTrendLevel;\n import org.optaplanner.core.impl.score.definition.AbstractScoreDefinition;\n import org.optaplanner.core.impl.score.inliner.ScoreInliner;\n import org.optaplanner.core.impl.score.trend.InitializingScoreTrend;\n \n+/**\n+ * @deprecated Double-based scores are deprecated as floating point numbers can't represent a decimal number correctly.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzcxMjkx", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421771291", "createdAt": "2020-06-01T11:24:30Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyNDozMFrOGdHNDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToyNDozMFrOGdHNDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3OTkxOA==", "bodyText": "Would it be possible to prefix such comments with // TODO remove in 8.0?\nThe reason I like the \"8.0\" there is because we'll do a find in path for \"8.0\" after branching", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433179918", "createdAt": "2020-06-01T11:24:30Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/score/director/drools/DroolsScoreDirector.java", "diffHunk": "@@ -82,6 +82,9 @@ private void resetKieSession() {\n         }\n     }\n \n+    // The scoreHolder method is not actually deprecated for removal.\n+    // It will only be moved to a different type at a time when we can make that change in public API.\n+    @SuppressWarnings(\"deprecation\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzcyNTU3", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-421772557", "createdAt": "2020-06-01T11:26:59Z", "commit": {"oid": "958580c10c8538115d959d4ee0abfd47f4a867fc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f72e7675b11a14d8cd417cb5de8764036097edfd", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/f72e7675b11a14d8cd417cb5de8764036097edfd", "committedDate": "2020-06-01T11:45:49Z", "message": "Resolve code review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28928b328ce24f4e54084d32b472f989a6591b8a", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/28928b328ce24f4e54084d32b472f989a6591b8a", "committedDate": "2020-06-01T11:47:59Z", "message": "Finishing touches"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjQ4NDU5", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-422648459", "createdAt": "2020-06-02T12:58:30Z", "commit": {"oid": "28928b328ce24f4e54084d32b472f989a6591b8a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjo1ODozMFrOGdwYAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjo1ODozMFrOGdwYAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg1NDQ2NQ==", "bodyText": "It's still deprecated, but the others are not?", "url": "https://github.com/kiegroup/optaplanner/pull/794#discussion_r433854465", "createdAt": "2020-06-02T12:58:30Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/buildin/bendable/BendableScoreHolder.java", "diffHunk": "@@ -31,6 +31,7 @@\n /**\n  * @see BendableScore\n  */\n+@Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28928b328ce24f4e54084d32b472f989a6591b8a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjUwMjg0", "url": "https://github.com/kiegroup/optaplanner/pull/794#pullrequestreview-422650284", "createdAt": "2020-06-02T13:00:36Z", "commit": {"oid": "28928b328ce24f4e54084d32b472f989a6591b8a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df8e3113b82f2a834fc90a2e6c3a28e0d3a98fdf", "author": {"user": {"login": "triceo", "name": "Luk\u00e1\u0161 Petrovick\u00fd"}}, "url": "https://github.com/kiegroup/optaplanner/commit/df8e3113b82f2a834fc90a2e6c3a28e0d3a98fdf", "committedDate": "2020-06-02T13:38:29Z", "message": "Don't deprecate BendableScoreHolder"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3019, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}