{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMjU2OTc1", "number": 763, "title": "PLANNER-561 Fix OutOfMemoryException in finalistList", "bodyText": "", "createdAt": "2020-04-28T17:26:01Z", "url": "https://github.com/kiegroup/optaplanner/pull/763", "merged": true, "mergeCommit": {"oid": "74e1c877d85bc05a718dc572e0c136ccc974627a"}, "closed": true, "closedAt": "2020-04-30T08:28:08Z", "author": {"login": "ge0ffrey"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccHSmmgH2gAyNDEwMjU2OTc1OmUwMDViNTZjNWIxYjY2NzY4NDM4ZTRiNGFkMjdlOWRjMmFkZmEwZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccHeeXgFqTQwMjA2MjgwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e005b56c5b1b66768438e4b4ad27e9dc2adfa0f4", "author": {"user": {"login": "ge0ffrey", "name": "Geoffrey De Smet"}}, "url": "https://github.com/kiegroup/optaplanner/commit/e005b56c5b1b66768438e4b4ad27e9dc2adfa0f4", "committedDate": "2020-04-28T17:25:37Z", "message": "PLANNER-561 Fix OutOfMemoryException in finalistList"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMDYyODA2", "url": "https://github.com/kiegroup/optaplanner/pull/763#pullrequestreview-402062806", "createdAt": "2020-04-28T17:35:05Z", "commit": {"oid": "e005b56c5b1b66768438e4b4ad27e9dc2adfa0f4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNzozNTowNlrOGNfWJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNzozODowMVrOGNfdpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5ODI0Nw==", "bodyText": "Any particular reason why so many finalists would be a good idea?", "url": "https://github.com/kiegroup/optaplanner/pull/763#discussion_r416798247", "createdAt": "2020-04-28T17:35:06Z", "author": {"login": "triceo"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/localsearch/decider/forager/finalist/AbstractFinalistPodium.java", "diffHunk": "@@ -32,6 +32,8 @@\n  */\n public abstract class AbstractFinalistPodium extends LocalSearchPhaseLifecycleListenerAdapter implements FinalistPodium {\n \n+    protected static final int FINALIST_LIST_MAX_SIZE = 1_024_000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e005b56c5b1b66768438e4b4ad27e9dc2adfa0f4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjgwMDE2Nw==", "bodyText": "Wouldn't it make sense to instead remove the least recent finalist? Or perhaps the worst finalist?", "url": "https://github.com/kiegroup/optaplanner/pull/763#discussion_r416800167", "createdAt": "2020-04-28T17:38:01Z", "author": {"login": "triceo"}, "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/localsearch/decider/forager/finalist/AbstractFinalistPodium.java", "diffHunk": "@@ -44,6 +46,19 @@ public void stepStarted(LocalSearchStepScope stepScope) {\n         finalistList = new ArrayList<>(1024);\n     }\n \n+    protected void clearAndAddFinalist(LocalSearchMoveScope moveScope) {\n+        finalistList.clear();\n+        finalistList.add(moveScope);\n+    }\n+\n+    protected void addFinalist(LocalSearchMoveScope moveScope) {\n+        if (finalistList.size() >= FINALIST_LIST_MAX_SIZE) {\n+            // Avoid unbounded growth and OutOfMemoryException\n+            return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e005b56c5b1b66768438e4b4ad27e9dc2adfa0f4"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2960, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}