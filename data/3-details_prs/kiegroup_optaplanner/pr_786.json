{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNDUxNzQ2", "number": 786, "title": "Add JPA Persistence CI workflow", "bodyText": "Jira: https://issues.redhat.com/browse/PLANNER-1979", "createdAt": "2020-05-21T16:27:07Z", "url": "https://github.com/kiegroup/optaplanner/pull/786", "merged": true, "mergeCommit": {"oid": "880df6048432df8993305bd30e8816e5b8386a41"}, "closed": true, "closedAt": "2020-06-04T11:02:56Z", "author": {"login": "cuijulian"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjgUDlABqjMzNjEzOTY4MDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn7-oKAFqTQyNDMzMTQwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11673b22007a210b2ac3eb3dce45c31bc53bf501", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/11673b22007a210b2ac3eb3dce45c31bc53bf501", "committedDate": "2020-05-21T15:59:34Z", "message": "Add optaplanner-persistence-jpa ci workflow and test script"}, "afterCommit": {"oid": "ed8c1d01b214fea3d20c421ef4cc005c02216e79", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/ed8c1d01b214fea3d20c421ef4cc005c02216e79", "committedDate": "2020-05-21T16:32:03Z", "message": "Add optaplanner-persistence-jpa ci workflow and test script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed8c1d01b214fea3d20c421ef4cc005c02216e79", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/ed8c1d01b214fea3d20c421ef4cc005c02216e79", "committedDate": "2020-05-21T16:32:03Z", "message": "Add optaplanner-persistence-jpa ci workflow and test script"}, "afterCommit": {"oid": "f3ce6af4a625c1ddb1b935193d2c840e4349eeed", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/f3ce6af4a625c1ddb1b935193d2c840e4349eeed", "committedDate": "2020-05-22T14:41:38Z", "message": "Add CI workflow and script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3ce6af4a625c1ddb1b935193d2c840e4349eeed", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/f3ce6af4a625c1ddb1b935193d2c840e4349eeed", "committedDate": "2020-05-22T14:41:38Z", "message": "Add CI workflow and script"}, "afterCommit": {"oid": "32491f43996e5f95eae7f4323ac97095edf9800d", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/32491f43996e5f95eae7f4323ac97095edf9800d", "committedDate": "2020-05-22T14:50:02Z", "message": "Add CI workflow and script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1190217f6c85a3d1abb4d2b04caca30bcbef9860", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/1190217f6c85a3d1abb4d2b04caca30bcbef9860", "committedDate": "2020-05-25T20:27:32Z", "message": "Bulid with Maven"}, "afterCommit": {"oid": "91192492aa0f7227bbafe5d05a3bdf206a41accc", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/91192492aa0f7227bbafe5d05a3bdf206a41accc", "committedDate": "2020-05-25T20:34:38Z", "message": "Bulid with Maven"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91192492aa0f7227bbafe5d05a3bdf206a41accc", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/91192492aa0f7227bbafe5d05a3bdf206a41accc", "committedDate": "2020-05-25T20:34:38Z", "message": "Bulid with Maven"}, "afterCommit": {"oid": "2d5c6858a67ee9bb339db8a4a70b2b2f6f67b2f1", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/2d5c6858a67ee9bb339db8a4a70b2b2f6f67b2f1", "committedDate": "2020-05-25T20:39:48Z", "message": "Build with Maven"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/d7fab8a6ce2359319b8ef571268ae9e728ffa56b", "committedDate": "2020-06-02T17:02:39Z", "message": "Add JPA CI PostgreSQL container test workflow"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2d5c6858a67ee9bb339db8a4a70b2b2f6f67b2f1", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/2d5c6858a67ee9bb339db8a4a70b2b2f6f67b2f1", "committedDate": "2020-05-25T20:39:48Z", "message": "Build with Maven"}, "afterCommit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b", "author": {"user": null}, "url": "https://github.com/kiegroup/optaplanner/commit/d7fab8a6ce2359319b8ef571268ae9e728ffa56b", "committedDate": "2020-06-02T17:02:39Z", "message": "Add JPA CI PostgreSQL container test workflow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDcxODc4", "url": "https://github.com/kiegroup/optaplanner/pull/786#pullrequestreview-423471878", "createdAt": "2020-06-03T11:47:00Z", "commit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMTo0NzowMFrOGeYK4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMTo0NzowMFrOGeYK4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDUwNjQ2NQ==", "bodyText": "By default, locally the test should run with h2.\nReq: When I do \"mvn clean install\" for this module, it needs to run the tests and not require me to start up a database. So it must use an in memory database.\nWe can have a maven profile that adds postegresql and that is activated for this CI workflow.", "url": "https://github.com/kiegroup/optaplanner/pull/786#discussion_r434506465", "createdAt": "2020-06-03T11:47:00Z", "author": {"login": "ge0ffrey"}, "path": "optaplanner-persistence/optaplanner-persistence-jpa/pom.xml", "diffHunk": "@@ -22,6 +22,22 @@\n   </description>\n   <url>https://www.optaplanner.org</url>\n \n+  <properties>\n+    <java.module.name>org.optaplanner.persistence.jpa</java.module.name>\n+    <version.org.postgresql>42.2.12</version.org.postgresql>\n+  </properties>\n+\n+  <dependencyManagement>\n+    <dependencies>\n+      <dependency>\n+        <groupId>org.postgresql</groupId>\n+        <artifactId>postgresql</artifactId>\n+        <version>${version.org.postgresql}</version>\n+        <scope>test</scope>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNDcyMTU1", "url": "https://github.com/kiegroup/optaplanner/pull/786#pullrequestreview-423472155", "createdAt": "2020-06-03T11:47:24Z", "commit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTMzMTU5", "url": "https://github.com/kiegroup/optaplanner/pull/786#pullrequestreview-424133159", "createdAt": "2020-06-04T06:22:44Z", "commit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjoyMjo0NFrOGe3Wzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjozMDo0OVrOGe3ixQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxNzQyMg==", "bodyText": "Was this the reason why it didn't work?", "url": "https://github.com/kiegroup/optaplanner/pull/786#discussion_r435017422", "createdAt": "2020-06-04T06:22:44Z", "author": {"login": "rsynek"}, "path": ".github/workflows/jpa_integration_ci.yml", "diffHunk": "@@ -0,0 +1,42 @@\n+# Runs optaplanner-persistence-jpa module tests in a PostgreSQL container\n+\n+name: OptaPlanner Persistence JPA CI\n+\n+on:\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+\n+jobs:\n+  jpa-postgresql-container:\n+    runs-on: ubuntu-latest\n+    services:\n+      postgres:\n+        image: postgres\n+        env:\n+          POSTGRES_PASSWORD: postgres\n+        # Set health checks to wait until postgres has started\n+        options: >-\n+          --health-cmd pg_isready\n+          --health-interval 10s\n+          --health-timeout 5s\n+          --health-retries 5\n+        ports:\n+          # Maps tcp port 5432 on service container to the host\n+          - 5432:5432", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyMDQ4NQ==", "bodyText": "Maybe I would just move this dependencyManagement to the top-level pom.xml, so that it's clear what versions we declare atop of the kie-parent pom.", "url": "https://github.com/kiegroup/optaplanner/pull/786#discussion_r435020485", "createdAt": "2020-06-04T06:30:49Z", "author": {"login": "rsynek"}, "path": "optaplanner-persistence/optaplanner-persistence-jpa/pom.xml", "diffHunk": "@@ -22,6 +22,22 @@\n   </description>\n   <url>https://www.optaplanner.org</url>\n \n+  <properties>\n+    <java.module.name>org.optaplanner.persistence.jpa</java.module.name>\n+    <version.org.postgresql>42.2.12</version.org.postgresql>\n+  </properties>\n+\n+  <dependencyManagement>\n+    <dependencies>\n+      <dependency>\n+        <groupId>org.postgresql</groupId>\n+        <artifactId>postgresql</artifactId>\n+        <version>${version.org.postgresql}</version>\n+        <scope>test</scope>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDUwNjQ2NQ=="}, "originalCommit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MzMxNDA2", "url": "https://github.com/kiegroup/optaplanner/pull/786#pullrequestreview-424331406", "createdAt": "2020-06-04T11:01:56Z", "commit": {"oid": "d7fab8a6ce2359319b8ef571268ae9e728ffa56b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3000, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}