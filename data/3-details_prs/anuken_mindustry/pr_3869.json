{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NTk2OTkw", "number": 3869, "title": "[QoL] Chat Modes", "bodyText": "It is sometimes annoying when you have to send a lot of messages to your teammates and type \"/t\" every time, so I made an interesting solution:\nPressing Tab (can be changed in settings):\n\nPractical use:\n\nMarking as a draft as the implementation is not so good, and there are quite a few bugs.\nTODO:\n\n Fix all possible bugs.\n Translations for setting.\n Displaying the current mode in UI.\n\nCredits: @Remint32, @sk7725, @Volas171.", "createdAt": "2020-12-08T17:11:04Z", "url": "https://github.com/Anuken/Mindustry/pull/3869", "merged": true, "mergeCommit": {"oid": "43757a247ef3bd0508d25dce2c4c38846cb1fb1c"}, "closed": true, "closedAt": "2020-12-24T21:05:41Z", "author": {"login": "summetdev"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkNetWgFqTU0NzQ1NjM3OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpYhRyABqjQxNDc5MzY3ODc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDU2Mzc5", "url": "https://github.com/Anuken/Mindustry/pull/3869#pullrequestreview-547456379", "createdAt": "2020-12-08T17:20:49Z", "commit": {"oid": "d756361485a8b538cbc542968aa7c18a6f2f6d98"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3Njg0OTgy", "url": "https://github.com/Anuken/Mindustry/pull/3869#pullrequestreview-547684982", "createdAt": "2020-12-08T22:26:11Z", "commit": {"oid": "d756361485a8b538cbc542968aa7c18a6f2f6d98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMjoyNjoxMVrOIB5EKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMjoyNjoxMVrOIB5EKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg1NDQ0MA==", "bodyText": "Whitespace", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r538854440", "createdAt": "2020-12-08T22:26:11Z", "author": {"login": "skykatik"}, "path": "core/src/mindustry/ui/fragments/ChatFragment.java", "diffHunk": "@@ -216,14 +228,25 @@ public void hide(){\n     }\n \n     public void updateChat(){\n-        chatfield.setText(history.get(historyPos));\n-        chatfield.setCursorPosition(chatfield.getText().length());\n+        chatfield.setText(mode.normalizedPrefix() + history.get(historyPos));\n+        updateCursor();\n+    }\n+\n+    public void nextMode(){\n+        mode = mode.next();\n+        chatfield.setText(mode.normalizedPrefix() + chatfield.getText().substring(mode.prev().normalizedPrefix().length()));\n+        updateCursor();\n     }\n \n     public void clearChatInput(){\n         historyPos = 0;\n         history.set(0, \"\");\n-        chatfield.setText(\"\");\n+        chatfield.setText(mode.normalizedPrefix());\n+        updateCursor();\n+    }\n+\n+    public void updateCursor() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d756361485a8b538cbc542968aa7c18a6f2f6d98"}, "originalPosition": 80}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7ccd1d49458fb15a0b46316a4dd360de43bbb3b", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/b7ccd1d49458fb15a0b46316a4dd360de43bbb3b", "committedDate": "2020-12-09T07:54:06Z", "message": "korean bundle\n\nCredits to @sk7752."}, "afterCommit": {"oid": "c6d0ee2bc6d3fa1b2be004739804ca3ca5512117", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/c6d0ee2bc6d3fa1b2be004739804ca3ca5512117", "committedDate": "2020-12-09T15:20:36Z", "message": "Chat modes\n\nKorean translation by sk7725."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33fb7166c83ae3c64e3443e875960653f871e9c7", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/33fb7166c83ae3c64e3443e875960653f871e9c7", "committedDate": "2020-12-12T15:40:54Z", "message": "Cleanup"}, "afterCommit": {"oid": "419d64e6f7ac75a4f5a921f5fccd9f9066837341", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/419d64e6f7ac75a4f5a921f5fccd9f9066837341", "committedDate": "2020-12-12T15:46:27Z", "message": "[QoL] Chat modes\n\nKorean translation by sk7725."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0ODIxMjEw", "url": "https://github.com/Anuken/Mindustry/pull/3869#pullrequestreview-554821210", "createdAt": "2020-12-17T17:23:00Z", "commit": {"oid": "419d64e6f7ac75a4f5a921f5fccd9f9066837341"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoyMzowMFrOIIAUhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoyMzoyMVrOIIAVfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NDc3NQ==", "bodyText": "Tab is already used for the player list.", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r545264775", "createdAt": "2020-12-17T17:23:00Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/input/Binding.java", "diffHunk": "@@ -69,6 +69,7 @@\n     chat_history_prev(KeyCode.up),\n     chat_history_next(KeyCode.down),\n     chat_scroll(new Axis(KeyCode.scroll)),\n+    chat_mode(KeyCode.tab),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "419d64e6f7ac75a4f5a921f5fccd9f9066837341"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTAyMQ==", "bodyText": "Catching exceptions like these is just bad style; you should validate it instead.", "url": "https://github.com/Anuken/Mindustry/pull/3869#discussion_r545265021", "createdAt": "2020-12-17T17:23:21Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/ui/fragments/ChatFragment.java", "diffHunk": "@@ -216,14 +222,35 @@ public void hide(){\n     }\n \n     public void updateChat(){\n-        chatfield.setText(history.get(historyPos));\n-        chatfield.setCursorPosition(chatfield.getText().length());\n+        chatfield.setText(mode.normalizedPrefix() + history.get(historyPos));\n+        updateCursor();\n+    }\n+\n+    public void nextMode(){\n+        ChatMode prev = mode;\n+\n+        do{\n+            mode = mode.next();\n+        }while(!mode.isValid());\n+\n+        try{\n+            chatfield.setText(mode.normalizedPrefix() + chatfield.getText().substring(prev.normalizedPrefix().length()));\n+        }catch(IndexOutOfBoundsException e){ // in case the player removed a prefix", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "419d64e6f7ac75a4f5a921f5fccd9f9066837341"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7546d323f25b969126fecfe7e907f17856be883c", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/7546d323f25b969126fecfe7e907f17856be883c", "committedDate": "2020-12-24T18:58:58Z", "message": "[QoL] Chat modes\n\nCredits: Remint32 (idea); sk7725 (korean i18n); Volas171 (spanish i18n)."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91a128b092c62df87c15ea8122d2d52f2b08a18a", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/91a128b092c62df87c15ea8122d2d52f2b08a18a", "committedDate": "2020-12-23T20:13:34Z", "message": "Validation"}, "afterCommit": {"oid": "7546d323f25b969126fecfe7e907f17856be883c", "author": {"user": {"login": "summetdev", "name": "Andrew Antsiferov"}}, "url": "https://github.com/Anuken/Mindustry/commit/7546d323f25b969126fecfe7e907f17856be883c", "committedDate": "2020-12-24T18:58:58Z", "message": "[QoL] Chat modes\n\nCredits: Remint32 (idea); sk7725 (korean i18n); Volas171 (spanish i18n)."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2239, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}