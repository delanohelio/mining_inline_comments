{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4OTk4Mjcy", "number": 2069, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMDo1MTo1OFrOD9IDrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMTozOTo0NlrOD9ILiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDIxNzQwOnYy", "diffSide": "RIGHT", "path": "core/src/mindustry/world/blocks/production/Drill.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMDo1MTo1OFrOGWdduA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNDoyMTo1MVrOGWeI0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIwNDYwMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Draw.rect(\"drill-top\", req.drawx(), req.drawy(), 1f);\n          \n          \n            \n                    Draw.rect(topRegion, req.drawx(), req.drawy(), 1f);", "url": "https://github.com/Anuken/Mindustry/pull/2069#discussion_r426204600", "createdAt": "2020-05-17T00:51:58Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/world/blocks/production/Drill.java", "diffHunk": "@@ -73,57 +71,13 @@ public Drill(String name){\n     public void drawRequestConfigTop(BuildRequest req, Eachable<BuildRequest> list){\n         Tile tile = req.tile();\n         if(tile == null) return;\n+\n         countOre(req.tile());\n         if(returnItem == null) return;\n \n-        /* The code section below adds drill speed text right below the top of the block*/\n-        BitmapFont font = Fonts.outline;\n-        GlyphLayout layout = Pools.obtain(GlyphLayout.class, GlyphLayout::new);\n-        boolean ints = font.usesIntegerPositions();\n-        String text = Core.bundle.formatFloat(\"bar.schemdrillspeed\", 60f / (drillTime + hardnessDrillMultiplier * returnItem.hardness) * returnCount, 2);\n-        font.setUseIntegerPositions(false);\n-        font.getData().setScale(1f / 4f / Scl.scl(1f));\n-        layout.setText(font, text);\n-\n-        float width = renderer.pixelator.enabled() ? 0f : layout.width;\n-\n-        if(renderer.pixelator.enabled()) width = 0f;\n-\n-        font.setColor(Pal.accent);\n-        float dx = req.drawx(), dy = req.drawy() + size * tilesize/2f;\n-        font.draw(text, dx, dy - 1, Align.center);\n-\n-        font.setUseIntegerPositions(ints);\n-        font.setColor(Color.white);\n-        font.getData().setScale(1f);\n-        Draw.reset();\n-        Pools.free(layout);\n-        /* end of code section */\n-\n-        /* This commented code colors their ore region */\n         Draw.color(returnItem.color);\n         Draw.rect(\"drill-top\", req.drawx(), req.drawy(), 1f);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b1b7bf7fef8985d359b2f293c2fc2d41d8f23be"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNTYzMw==", "bodyText": "I didn't check before. but topRegion makes them look like they have a mole.\n\nOr was it the goal to make it look like that?", "url": "https://github.com/Anuken/Mindustry/pull/2069#discussion_r426215633", "createdAt": "2020-05-17T04:21:51Z", "author": {"login": "zatnas"}, "path": "core/src/mindustry/world/blocks/production/Drill.java", "diffHunk": "@@ -73,57 +71,13 @@ public Drill(String name){\n     public void drawRequestConfigTop(BuildRequest req, Eachable<BuildRequest> list){\n         Tile tile = req.tile();\n         if(tile == null) return;\n+\n         countOre(req.tile());\n         if(returnItem == null) return;\n \n-        /* The code section below adds drill speed text right below the top of the block*/\n-        BitmapFont font = Fonts.outline;\n-        GlyphLayout layout = Pools.obtain(GlyphLayout.class, GlyphLayout::new);\n-        boolean ints = font.usesIntegerPositions();\n-        String text = Core.bundle.formatFloat(\"bar.schemdrillspeed\", 60f / (drillTime + hardnessDrillMultiplier * returnItem.hardness) * returnCount, 2);\n-        font.setUseIntegerPositions(false);\n-        font.getData().setScale(1f / 4f / Scl.scl(1f));\n-        layout.setText(font, text);\n-\n-        float width = renderer.pixelator.enabled() ? 0f : layout.width;\n-\n-        if(renderer.pixelator.enabled()) width = 0f;\n-\n-        font.setColor(Pal.accent);\n-        float dx = req.drawx(), dy = req.drawy() + size * tilesize/2f;\n-        font.draw(text, dx, dy - 1, Align.center);\n-\n-        font.setUseIntegerPositions(ints);\n-        font.setColor(Color.white);\n-        font.getData().setScale(1f);\n-        Draw.reset();\n-        Pools.free(layout);\n-        /* end of code section */\n-\n-        /* This commented code colors their ore region */\n         Draw.color(returnItem.color);\n         Draw.rect(\"drill-top\", req.drawx(), req.drawy(), 1f);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIwNDYwMA=="}, "originalCommit": {"oid": "2b1b7bf7fef8985d359b2f293c2fc2d41d8f23be"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDIzNzI4OnYy", "diffSide": "RIGHT", "path": "core/src/mindustry/world/blocks/production/Drill.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMTozOTowNFrOGWdnuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNDoyMzowNVrOGWeJIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIwNzE2MA==", "bodyText": "Aren't you drawing it with 1 degree of rotation here?", "url": "https://github.com/Anuken/Mindustry/pull/2069#discussion_r426207160", "createdAt": "2020-05-17T01:39:04Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/world/blocks/production/Drill.java", "diffHunk": "@@ -66,6 +67,19 @@ public Drill(String name){\n         idleSoundVolume = 0.003f;\n     }\n \n+    @Override\n+    public void drawRequestConfigTop(BuildRequest req, Eachable<BuildRequest> list){\n+        Tile tile = req.tile();\n+        if(tile == null) return;\n+\n+        countOre(req.tile());\n+        if(returnItem == null) return;\n+\n+        Draw.color(returnItem.color);\n+        Draw.rect(topRegion, req.drawx(), req.drawy(), 1f);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7120e638e99fef7aea65edb02a6b25020e40a25"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNTcxMw==", "bodyText": "I didn't notice before as I copied it from draw(). Removing 1f doesn't seem to change anything so I'll remove that and from draw()", "url": "https://github.com/Anuken/Mindustry/pull/2069#discussion_r426215713", "createdAt": "2020-05-17T04:23:05Z", "author": {"login": "zatnas"}, "path": "core/src/mindustry/world/blocks/production/Drill.java", "diffHunk": "@@ -66,6 +67,19 @@ public Drill(String name){\n         idleSoundVolume = 0.003f;\n     }\n \n+    @Override\n+    public void drawRequestConfigTop(BuildRequest req, Eachable<BuildRequest> list){\n+        Tile tile = req.tile();\n+        if(tile == null) return;\n+\n+        countOre(req.tile());\n+        if(returnItem == null) return;\n+\n+        Draw.color(returnItem.color);\n+        Draw.rect(topRegion, req.drawx(), req.drawy(), 1f);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIwNzE2MA=="}, "originalCommit": {"oid": "c7120e638e99fef7aea65edb02a6b25020e40a25"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDIzNzUyOnYy", "diffSide": "RIGHT", "path": "core/src/mindustry/world/blocks/production/Drill.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMTozOTo0NlrOGWdn2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwMTozOTo0NlrOGWdn2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIwNzE5Mg==", "bodyText": "Technical fix: You should also skip drawing if !req.worldContext (so schematics don't grab world state).", "url": "https://github.com/Anuken/Mindustry/pull/2069#discussion_r426207192", "createdAt": "2020-05-17T01:39:46Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/world/blocks/production/Drill.java", "diffHunk": "@@ -66,6 +67,19 @@ public Drill(String name){\n         idleSoundVolume = 0.003f;\n     }\n \n+    @Override\n+    public void drawRequestConfigTop(BuildRequest req, Eachable<BuildRequest> list){\n+        Tile tile = req.tile();\n+        if(tile == null) return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7120e638e99fef7aea65edb02a6b25020e40a25"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4355, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}