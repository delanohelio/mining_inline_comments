{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1MjI0MDc0", "number": 4098, "title": "Prevents plastanium conveyor unload exploit", "bodyText": "a strange instachain design popped up on the discord overnight:\n(unloading straight from the loading dock itself / very fast / bad)\n\nthis pull adds an additional low performance (boolean instead of a function) check on the building entity itself.\ncurrently that value is always true since the block itself needs to be unloadable anyways, and i wasn't sure about whether or not to add it to the create, init, or both (of buildingcomp), but that would be a mirrored redundant check, dunno about it \ud83e\udd14", "createdAt": "2020-12-24T09:08:19Z", "url": "https://github.com/Anuken/Mindustry/pull/4098", "merged": true, "mergeCommit": {"oid": "9397bd57c4fbdd40156b127ea90f455f99f72b63"}, "closed": true, "closedAt": "2020-12-24T15:33:41Z", "author": {"login": "Quezler"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpP7t6AH2gAyNTQ1MjI0MDc0OjY1ZmRkYjI5NzIxMzdiMDcwNmMyMDhhM2M0ZmNhNzc5MzI5ZWJkZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpVhUoAH2gAyNTQ1MjI0MDc0OjM5MTM2YTMyNjc2NjQ2NjAzZjczYTI0ZTRiZWVjZTZkMTllZGZkOGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65fddb2972137b0706c208a3c4fca779329ebdd6", "author": {"user": {"login": "Quezler", "name": "Patrick 'Quezler' Mounier"}}, "url": "https://github.com/Anuken/Mindustry/commit/65fddb2972137b0706c208a3c4fca779329ebdd6", "committedDate": "2020-12-24T09:01:56Z", "message": "Prevent unloaders from unloading plast loading dock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NjAzMTA5", "url": "https://github.com/Anuken/Mindustry/pull/4098#pullrequestreview-558603109", "createdAt": "2020-12-24T14:46:19Z", "commit": {"oid": "65fddb2972137b0706c208a3c4fca779329ebdd6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNDo0NjoxOVrOILIy7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNDo0NjoxOVrOILIy7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODU0OTM1OA==", "bodyText": "This should be an overridable boolean method instead of an instance variable, to be in line with how everything else is implemented.", "url": "https://github.com/Anuken/Mindustry/pull/4098#discussion_r548549358", "createdAt": "2020-12-24T14:46:19Z", "author": {"login": "Anuken"}, "path": "core/src/mindustry/entities/comp/BuildingComp.java", "diffHunk": "@@ -63,6 +63,7 @@\n     transient boolean enabled = true;\n     transient float enabledControlTime;\n     transient String lastAccessed;\n+    transient boolean unloadable = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65fddb2972137b0706c208a3c4fca779329ebdd6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c89edfaf03abb1058210f600f4040054623fa2be", "author": {"user": {"login": "Quezler", "name": "Patrick 'Quezler' Mounier"}}, "url": "https://github.com/Anuken/Mindustry/commit/c89edfaf03abb1058210f600f4040054623fa2be", "committedDate": "2020-12-24T14:58:57Z", "message": "Use overridable boolean method unloadable instead"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8336ab07e9e2ee3bf0c6c1924da93358562d365b", "author": {"user": {"login": "Quezler", "name": "Patrick 'Quezler' Mounier"}}, "url": "https://github.com/Anuken/Mindustry/commit/8336ab07e9e2ee3bf0c6c1924da93358562d365b", "committedDate": "2020-12-24T15:00:22Z", "message": "Merge branch 'master' into loading-dock-loads\n\n# Conflicts:\n#\tcore/src/mindustry/world/blocks/distribution/StackConveyor.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NjI0NzY3", "url": "https://github.com/Anuken/Mindustry/pull/4098#pullrequestreview-558624767", "createdAt": "2020-12-24T15:01:50Z", "commit": {"oid": "8336ab07e9e2ee3bf0c6c1924da93358562d365b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNTowMTo1MFrOILJA-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNTowMTo1MFrOILJA-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODU1Mjk1Mg==", "bodyText": "redundant check inside Unloader.java though, should this just be hardcoded to true or simply remove the block level check in unloader and route it all through this function?", "url": "https://github.com/Anuken/Mindustry/pull/4098#discussion_r548552952", "createdAt": "2020-12-24T15:01:50Z", "author": {"login": "Quezler"}, "path": "core/src/mindustry/entities/comp/BuildingComp.java", "diffHunk": "@@ -384,6 +384,10 @@ public byte version(){\n     //endregion\n     //region handler methods\n \n+    public boolean unloadable(){\n+        return block.unloadable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8336ab07e9e2ee3bf0c6c1924da93358562d365b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NjI3MDI3", "url": "https://github.com/Anuken/Mindustry/pull/4098#pullrequestreview-558627027", "createdAt": "2020-12-24T15:03:21Z", "commit": {"oid": "8336ab07e9e2ee3bf0c6c1924da93358562d365b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNTowMzoyMVrOILJCGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxNTowMzoyMVrOILJCGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODU1MzI0Mw==", "bodyText": "press to implement the above comment, not sure if this will break on blocks with no building entity or something?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if(other.interactable(team) && other.block.unloadable && other.unloadable() && other.block.hasItems\n          \n          \n            \n                                if(other.interactable(team) && other.unloadable() && other.block.hasItems", "url": "https://github.com/Anuken/Mindustry/pull/4098#discussion_r548553243", "createdAt": "2020-12-24T15:03:21Z", "author": {"login": "Quezler"}, "path": "core/src/mindustry/world/blocks/storage/Unloader.java", "diffHunk": "@@ -61,7 +61,7 @@ public void updateTile(){\n                     int pos = (offset + i) % proximity.size;\n                     var other = proximity.get(pos);\n \n-                    if(other.interactable(team) && other.block.unloadable && other.block.hasItems\n+                    if(other.interactable(team) && other.block.unloadable && other.unloadable() && other.block.hasItems", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8336ab07e9e2ee3bf0c6c1924da93358562d365b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39136a32676646603f73a24e4beece6d19edfd8a", "author": {"user": {"login": "Quezler", "name": "Patrick 'Quezler' Mounier"}}, "url": "https://github.com/Anuken/Mindustry/commit/39136a32676646603f73a24e4beece6d19edfd8a", "committedDate": "2020-12-24T15:32:32Z", "message": "unloadable -> canUnload"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2203, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}