{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNjkyOTQx", "number": 1518, "title": "Support custom node images", "bodyText": "Resolves #1517.\nThe pull request brings support for custom node images on the backend side. From now on instance_image settings field will be used to override default node image from cluster configuration. Also pipeline start instanceImage entity field can be used to specify custom node image for a single launch.\nFor example the following configuration entry enforces custom node image for cloud instances.\n{\n  \"name\": \"default\",\n  \"configuration\": {\n    \"nonPause\": true,\n    \"instance_size\": \"instance_size\",\n    \"instance_image\": \"custom node image\",\n    \"instance_disk\": \"instance_disk\",\n    \"cmd_template\": \"cmd_template\",\n    \"language\": \"language\",\n    \"is_spot\": true\n  },\n  \"default\": true\n}\nAnd the following pipeline start entity enforces custom node image for a single launch cloud instance.\n{\n  \"instanceType\": \"instanceType\",\n  \"instanceImage\": \"custom node image\",\n  \"hddSize\": 1,\n  \"timeout\": 1,\n  \"cmdTemplate\": \"cmdTemplate\",\n  \"dockerImage\": \"dockerImage\",\n  \"params\": {},\n  \"isSpot\": true,\n  \"cloudRegionId\": 1,\n  \"nonPause\": true,\n  \"force\": true\n}", "createdAt": "2020-10-27T11:48:26Z", "url": "https://github.com/epam/cloud-pipeline/pull/1518", "merged": true, "mergeCommit": {"oid": "c8e1a8d4e2d45360c861d3b1910b066dff8e5e79"}, "closed": true, "closedAt": "2020-10-27T13:32:32Z", "author": {"login": "tcibinan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWnM8IAH2gAyNTEwNjkyOTQxOjdkZDMxOTkyOTg2YTdlYWRhNWEwZDRmOTE0NDZmMzQ4ZmI4ZTdjZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWpB-XAFqTUxNzcwNDU1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7dd31992986a7eada5a0d4f91446f348fb8e7ce3", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/7dd31992986a7eada5a0d4f91446f348fb8e7ce3", "committedDate": "2020-10-27T11:24:00Z", "message": "Support custom node images"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e504f2b4cd9d04d055c0597b5893798a9d25ce8", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/1e504f2b4cd9d04d055c0597b5893798a9d25ce8", "committedDate": "2020-10-27T12:17:20Z", "message": "Support custom node image overriding on run launch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjY1Mzc5", "url": "https://github.com/epam/cloud-pipeline/pull/1518#pullrequestreview-517665379", "createdAt": "2020-10-27T12:50:26Z", "commit": {"oid": "1e504f2b4cd9d04d055c0597b5893798a9d25ce8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo1MDoyNlrOHo6itg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo1MDoyNlrOHo6itg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY2NDI0Ng==", "bodyText": "I think we need to keep 'timeout' field as well", "url": "https://github.com/epam/cloud-pipeline/pull/1518#discussion_r512664246", "createdAt": "2020-10-27T12:50:26Z", "author": {"login": "mzueva"}, "path": "api/src/main/java/com/epam/pipeline/manager/pipeline/PipelineConfigurationManager.java", "diffHunk": "@@ -173,14 +173,14 @@ public PipelineConfiguration mergeParameters(PipelineStart runVO, PipelineConfig\n             configuration.setInstanceDisk(defaultConfig.getInstanceDisk());\n         }\n         if (runVO.getInstanceType() != null) {\n-            configuration.setInstanceType(String.valueOf(runVO.getInstanceType()));\n+            configuration.setInstanceType(runVO.getInstanceType());\n         } else {\n             configuration.setInstanceType(defaultConfig.getInstanceType());\n         }\n-        if (runVO.getTimeout() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e504f2b4cd9d04d055c0597b5893798a9d25ce8"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b76c83f1de74517b3650971b3c7585d0fd23797b", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/b76c83f1de74517b3650971b3c7585d0fd23797b", "committedDate": "2020-10-27T13:29:32Z", "message": "Return missing timeout configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NzA0NTU1", "url": "https://github.com/epam/cloud-pipeline/pull/1518#pullrequestreview-517704555", "createdAt": "2020-10-27T13:31:50Z", "commit": {"oid": "b76c83f1de74517b3650971b3c7585d0fd23797b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3683, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}