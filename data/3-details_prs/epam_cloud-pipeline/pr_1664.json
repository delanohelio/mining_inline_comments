{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNDc5ODk3", "number": 1664, "title": "Issue #1653: Added labels filter to the filterNodes method", "bodyText": "Issue #1653\nSigned-off-by: Iurii_Kofanov youkofan@gmail.com", "createdAt": "2020-12-18T11:18:16Z", "url": "https://github.com/epam/cloud-pipeline/pull/1664", "merged": true, "mergeCommit": {"oid": "b6c44ed0b4aa530595e59bdfba7875f489844e1e"}, "closed": true, "closedAt": "2020-12-28T13:21:22Z", "author": {"login": "YouKofan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnWRqSgH2gAyNTQyNDc5ODk3OmQ1ZGUwYzE3MmNiOWU3ZDAzMzliYTI5NDkzODUyMzNmYjU5NjExNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdqlxGFAFqTU1OTEzNTg5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d5de0c172cb9e7d0339ba2949385233fb5961145", "author": {"user": {"login": "YouKofan", "name": "Iurii Kofanov"}}, "url": "https://github.com/epam/cloud-pipeline/commit/d5de0c172cb9e7d0339ba2949385233fb5961145", "committedDate": "2020-12-18T11:17:29Z", "message": "Issue #1653: Added labels filter to the filterNodes method\n\nSigned-off-by: Iurii_Kofanov <youkofan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fbd29c0d962c26dd708bfbac5fac64be9307509", "author": {"user": {"login": "YouKofan", "name": "Iurii Kofanov"}}, "url": "https://github.com/epam/cloud-pipeline/commit/1fbd29c0d962c26dd708bfbac5fac64be9307509", "committedDate": "2020-12-21T10:21:35Z", "message": "Issue #1653: test added\n\nSigned-off-by: Iurii_Kofanov <youkofan@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjM3MTYx", "url": "https://github.com/epam/cloud-pipeline/pull/1664#pullrequestreview-557237161", "createdAt": "2020-12-22T17:16:59Z", "commit": {"oid": "1fbd29c0d962c26dd708bfbac5fac64be9307509"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzoxNzowMFrOIKCnNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNzoxNzozMVrOIKCoRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5OTQ3OA==", "bodyText": "I'd suggest to reuse labelsMap (line 145) as it used for filtering by labels - just what we need here.", "url": "https://github.com/epam/cloud-pipeline/pull/1664#discussion_r547399478", "createdAt": "2020-12-22T17:17:00Z", "author": {"login": "mzueva"}, "path": "api/src/main/java/com/epam/pipeline/manager/cluster/NodesManager.java", "diffHunk": "@@ -153,8 +153,14 @@ public void init() {\n                         address.getAddress().equalsIgnoreCase(filterNodesVO.getAddress());\n                 addressFilter = node ->\n                         node.getAddresses() != null && node.getAddresses()\n-                                .stream()\n-                                .filter(addressEqualsPredicate).count() > 0;\n+                                .stream().anyMatch(addressEqualsPredicate);\n+            }\n+            Predicate<NodeInstance> labelsFilter = node -> true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fbd29c0d962c26dd708bfbac5fac64be9307509"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5OTc0OQ==", "bodyText": "You can use MapUtils.isNotEmpty fro such check", "url": "https://github.com/epam/cloud-pipeline/pull/1664#discussion_r547399749", "createdAt": "2020-12-22T17:17:31Z", "author": {"login": "mzueva"}, "path": "api/src/main/java/com/epam/pipeline/manager/cluster/NodesManager.java", "diffHunk": "@@ -153,8 +153,14 @@ public void init() {\n                         address.getAddress().equalsIgnoreCase(filterNodesVO.getAddress());\n                 addressFilter = node ->\n                         node.getAddresses() != null && node.getAddresses()\n-                                .stream()\n-                                .filter(addressEqualsPredicate).count() > 0;\n+                                .stream().anyMatch(addressEqualsPredicate);\n+            }\n+            Predicate<NodeInstance> labelsFilter = node -> true;\n+            if (filterNodesVO.getLabels() != null && !filterNodesVO.getLabels().isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fbd29c0d962c26dd708bfbac5fac64be9307509"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8748064c1b1721419abcf2f87d7f664010f0c745", "author": {"user": {"login": "YouKofan", "name": "Iurii Kofanov"}}, "url": "https://github.com/epam/cloud-pipeline/commit/8748064c1b1721419abcf2f87d7f664010f0c745", "committedDate": "2020-12-24T07:30:34Z", "message": "Issue #1653: changed filtering principle in the filterNodes method\n\nSigned-off-by: Iurii_Kofanov <youkofan@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MTM1ODk4", "url": "https://github.com/epam/cloud-pipeline/pull/1664#pullrequestreview-559135898", "createdAt": "2020-12-28T13:02:10Z", "commit": {"oid": "8748064c1b1721419abcf2f87d7f664010f0c745"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3619, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}