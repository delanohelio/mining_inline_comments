{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3Nzg2MDk3", "number": 1150, "title": "Support tool symlinks", "bodyText": "Resolves issue #1122.\nThe pull request brings support for so-called tool symlinks. Tool symlink is a representation of some tool in a different tool group. Symlink inherits all the source tool parameters such as name, description, versions, issues and etc. If some of the source tool parameters are changed then its symlink parameters are changed as well. At the same time none of the symlink parameters can be modified.\nPermissions and owner of tool symlink can be modified separately from the source tool.\nAn additional API method POST /tool/symlink is added in order to create new symlink. It accepts body with just two fields:\n\ntoolId of the source tool,\ngroupId of the tool group to create symlink in.", "createdAt": "2020-06-04T11:59:46Z", "url": "https://github.com/epam/cloud-pipeline/pull/1150", "merged": true, "mergeCommit": {"oid": "2f2a5d1d21b2df0ec127d4b65d47d5a66544e911"}, "closed": true, "closedAt": "2020-06-05T13:28:14Z", "author": {"login": "tcibinan"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn8DS_AH2gAyNDI3Nzg2MDk3OjkwZDIxYTA5ZjYyMWYyOTQwODM2MThjMDIxOTBlOWE0YjlhZjBlMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoR-esgH2gAyNDI3Nzg2MDk3OmViZmEzMjU5NTFiYTA0N2U3NzE1MGExZGIzNWVmNGViZGE3NmMzMjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "90d21a09f621f294083618c02190e9a4b9af0e1a", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/90d21a09f621f294083618c02190e9a4b9af0e1a", "committedDate": "2020-06-04T11:07:02Z", "message": "Add support for tool symlinks on database level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81b7e88e0a0859f610022f58ee725b600a8b50a7", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/81b7e88e0a0859f610022f58ee725b600a8b50a7", "committedDate": "2020-06-04T11:07:03Z", "message": "Add support for symlinks owner update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a20cd5295976661a61bf56b820e576df1377307", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/3a20cd5295976661a61bf56b820e576df1377307", "committedDate": "2020-06-04T11:07:03Z", "message": "Add support for symlink icon loading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9dbd45d76717cea8d3e92a3ed1109ba56adc0e9", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/d9dbd45d76717cea8d3e92a3ed1109ba56adc0e9", "committedDate": "2020-06-04T11:07:04Z", "message": "Add basic support for symlinks creation and loading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8a96006c2bde506d05da0c0818e485475469724", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/f8a96006c2bde506d05da0c0818e485475469724", "committedDate": "2020-06-04T11:07:04Z", "message": "Adapt remaining tool manager methods for symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0088d44803793efba7ea3936ad327eeae9383a21", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/0088d44803793efba7ea3936ad327eeae9383a21", "committedDate": "2020-06-04T11:07:05Z", "message": "Adapt most tool related methods for symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48e3a010d29312435c1b9028e9e9a420226b0a69", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/48e3a010d29312435c1b9028e9e9a420226b0a69", "committedDate": "2020-06-04T11:07:05Z", "message": "Add support for tool symlinks contextual preferences loading"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fa7d300d0e8657dd869e7f1770311eaae989057", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/7fa7d300d0e8657dd869e7f1770311eaae989057", "committedDate": "2020-06-04T11:07:06Z", "message": "Add support for tool symlinks to docker registry sql queries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f227bccdedd1b5e9f483d956c3b3404511ae96e5", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/f227bccdedd1b5e9f483d956c3b3404511ae96e5", "committedDate": "2020-06-04T11:07:06Z", "message": "Repair tool icon query for tools which have symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25abcd51da2a1b337469cf95b8047958adacfea0", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/25abcd51da2a1b337469cf95b8047958adacfea0", "committedDate": "2020-06-04T11:07:07Z", "message": "Adapt tool version sql queries for symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5487470539b91d984e1af76241c70681250168f", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/c5487470539b91d984e1af76241c70681250168f", "committedDate": "2020-06-04T11:07:07Z", "message": "Reject all tool symlink version modifications"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6652f8d87a1a24055fed0f68c28c4f2d7257ed70", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/6652f8d87a1a24055fed0f68c28c4f2d7257ed70", "committedDate": "2020-06-04T11:09:02Z", "message": "Resolve checkstyle and pmd issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59c0b958bfddec5e0f042a6bbe637aad24e8de9f", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/59c0b958bfddec5e0f042a6bbe637aad24e8de9f", "committedDate": "2020-06-04T15:24:29Z", "message": "Resolve additional checkstyle and pmd issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc98c1eae036eb1329307ebed3e8a79c509f0edd", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/cc98c1eae036eb1329307ebed3e8a79c509f0edd", "committedDate": "2020-06-04T16:00:05Z", "message": "Add actual docker image pipeline run field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aad0639e1f298638db986003b0cacdd6584b6857", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/aad0639e1f298638db986003b0cacdd6584b6857", "committedDate": "2020-06-05T10:55:01Z", "message": "Adapt tool image history loading for symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdcaa12ab05be9977cd9d876babe0632965567d0", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/fdcaa12ab05be9977cd9d876babe0632965567d0", "committedDate": "2020-06-05T10:55:36Z", "message": "Move the migration to the recent date"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MTk5MzA1", "url": "https://github.com/epam/cloud-pipeline/pull/1150#pullrequestreview-425199305", "createdAt": "2020-06-05T10:57:44Z", "commit": {"oid": "cc98c1eae036eb1329307ebed3e8a79c509f0edd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDo1Nzo0NFrOGfp9iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMTo0ODo0OFrOGfrTbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0NjUzOQ==", "bodyText": "I think all operations read & write shall be forbidden (since user won't be able to pull a symlink anyway)", "url": "https://github.com/epam/cloud-pipeline/pull/1150#discussion_r435846539", "createdAt": "2020-06-05T10:57:44Z", "author": {"login": "mzueva"}, "path": "api/src/main/java/com/epam/pipeline/manager/docker/DockerRegistryManager.java", "diffHunk": "@@ -591,6 +591,12 @@ private Tool buildTool(DockerRegistry dockerRegistry, ToolGroup toolGroup, Strin\n                 }\n             }\n \n+            if (isSymlinkWriting(entity, permissions)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc98c1eae036eb1329307ebed3e8a79c509f0edd"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg2ODUyNg==", "bodyText": "Issues can be attached to symlinks", "url": "https://github.com/epam/cloud-pipeline/pull/1150#discussion_r435868526", "createdAt": "2020-06-05T11:48:48Z", "author": {"login": "mzueva"}, "path": "api/src/main/java/com/epam/pipeline/manager/issue/IssueManager.java", "diffHunk": "@@ -97,6 +103,7 @@ public Issue createIssue(IssueVO issueVO) {\n         EntityVO entityVO = issueVO.getEntity();\n         validateEntityParameters(entityVO);\n         AbstractSecuredEntity entity = ensureEntityExists(entityVO);\n+        validateEntityCanBeModified(entityVO);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc98c1eae036eb1329307ebed3e8a79c509f0edd"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebfa325951ba047e77150a1db35ef4ebda76c322", "author": {"user": {"login": "tcibinan", "name": "Andrey Tsibin"}}, "url": "https://github.com/epam/cloud-pipeline/commit/ebfa325951ba047e77150a1db35ef4ebda76c322", "committedDate": "2020-06-05T12:39:41Z", "message": "Reject both pull and push requests for symlinks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3846, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}