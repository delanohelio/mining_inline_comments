{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMjg0ODEy", "number": 9071, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwMzoxODo1NVrOD5PQvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwMzoxODo1NVrOD5PQvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMzQ1NDY4OnYy", "diffSide": "LEFT", "path": "extensions/arc/runtime/src/main/java/io/quarkus/arc/runtime/context/ArcContextProvider.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwMzoxODo1NVrOGQZLfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwODo1NDozOFrOGQgO-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg0Mjk0MQ==", "bodyText": "Most changes are from removing lambdas, the real change is removing the exception and just making it a noop.", "url": "https://github.com/quarkusio/quarkus/pull/9071#discussion_r419842941", "createdAt": "2020-05-05T03:18:55Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/arc/runtime/src/main/java/io/quarkus/arc/runtime/context/ArcContextProvider.java", "diffHunk": "@@ -28,46 +28,62 @@ public ThreadContextSnapshot currentContext(Map<String, String> map) {\n \n         // capture the state, null indicates no active context while capturing snapshot\n         InjectableContext.ContextState state = isContextActiveOnThisThread(arc) ? arc.requestContext().getState() : null;\n-        return () -> {\n-            // can be called later on, we should retrieve the container again\n-            ArcContainer arcContainer = Arc.container();\n-            if (arcContainer == null || !arcContainer.isRunning()) {\n-                throw new IllegalStateException(\"Arc context propagation was attempted but the container is not running.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026ccf4ffcb4822e93758d370be74d724dd0be3b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk1NjE5Mg==", "bodyText": "Sounds good for shutdown, but what if this happens in other scenarios? Shouldn't we at least log something?", "url": "https://github.com/quarkusio/quarkus/pull/9071#discussion_r419956192", "createdAt": "2020-05-05T08:50:26Z", "author": {"login": "manovotn"}, "path": "extensions/arc/runtime/src/main/java/io/quarkus/arc/runtime/context/ArcContextProvider.java", "diffHunk": "@@ -28,46 +28,62 @@ public ThreadContextSnapshot currentContext(Map<String, String> map) {\n \n         // capture the state, null indicates no active context while capturing snapshot\n         InjectableContext.ContextState state = isContextActiveOnThisThread(arc) ? arc.requestContext().getState() : null;\n-        return () -> {\n-            // can be called later on, we should retrieve the container again\n-            ArcContainer arcContainer = Arc.container();\n-            if (arcContainer == null || !arcContainer.isRunning()) {\n-                throw new IllegalStateException(\"Arc context propagation was attempted but the container is not running.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg0Mjk0MQ=="}, "originalCommit": {"oid": "026ccf4ffcb4822e93758d370be74d724dd0be3b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk1NzU3Mg==", "bodyText": "I don't think it matters, if the container is gone there is no request context anymore.", "url": "https://github.com/quarkusio/quarkus/pull/9071#discussion_r419957572", "createdAt": "2020-05-05T08:52:53Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/arc/runtime/src/main/java/io/quarkus/arc/runtime/context/ArcContextProvider.java", "diffHunk": "@@ -28,46 +28,62 @@ public ThreadContextSnapshot currentContext(Map<String, String> map) {\n \n         // capture the state, null indicates no active context while capturing snapshot\n         InjectableContext.ContextState state = isContextActiveOnThisThread(arc) ? arc.requestContext().getState() : null;\n-        return () -> {\n-            // can be called later on, we should retrieve the container again\n-            ArcContainer arcContainer = Arc.container();\n-            if (arcContainer == null || !arcContainer.isRunning()) {\n-                throw new IllegalStateException(\"Arc context propagation was attempted but the container is not running.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg0Mjk0MQ=="}, "originalCommit": {"oid": "026ccf4ffcb4822e93758d370be74d724dd0be3b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk1ODUyMA==", "bodyText": "Actually. never mind. Checking on history, this check was added specifically because of shutdown scenario.", "url": "https://github.com/quarkusio/quarkus/pull/9071#discussion_r419958520", "createdAt": "2020-05-05T08:54:38Z", "author": {"login": "manovotn"}, "path": "extensions/arc/runtime/src/main/java/io/quarkus/arc/runtime/context/ArcContextProvider.java", "diffHunk": "@@ -28,46 +28,62 @@ public ThreadContextSnapshot currentContext(Map<String, String> map) {\n \n         // capture the state, null indicates no active context while capturing snapshot\n         InjectableContext.ContextState state = isContextActiveOnThisThread(arc) ? arc.requestContext().getState() : null;\n-        return () -> {\n-            // can be called later on, we should retrieve the container again\n-            ArcContainer arcContainer = Arc.container();\n-            if (arcContainer == null || !arcContainer.isRunning()) {\n-                throw new IllegalStateException(\"Arc context propagation was attempted but the container is not running.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg0Mjk0MQ=="}, "originalCommit": {"oid": "026ccf4ffcb4822e93758d370be74d724dd0be3b"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3238, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}