{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMTEzNzE0", "number": 7991, "title": "Add note about class reading in class loading guide", "bodyText": "Hello Quarkus Team!\nI'm sending this PR due to the problem with class reading I experienced when migrating from 1.2.1.Final to 1.3.0.Final. After some digging I found this document, i.e. the Class Loading Reference guide, but it didn't help much. I went back to the code to check how other extensions are doing class reading. I nailed my problem down to the following points:\n\nA @BuildStep which reads classes needs to have loadsApplicationClasses set to true.\nA ClassLoader should be taken from Thread.currentThread().getContextClassLoader().\n\nAdding parameter itself did not help. Using appropriate class loader was also important.\nBefore I migrated to 1.3.0 I haven't had these issues. My build step did not use loadsApplicationClasses parameter, I got ClassLoader from getClass().getClassLoader(), and everything worked just fine.\nI hope the change I made in the guide will help extension writers in the future.\nThis concludes this PR.", "createdAt": "2020-03-19T16:41:07Z", "url": "https://github.com/quarkusio/quarkus/pull/7991", "merged": true, "mergeCommit": {"oid": "f7ba260994010c7d59dac7f8ece075f3fa21db70"}, "closed": true, "closedAt": "2020-03-20T12:23:16Z", "author": {"login": "sarxos"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPPa4YgFqTM3Nzk0MzcxMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPflZXgBqjMxNDkxMDM5Njk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTQzNzEy", "url": "https://github.com/quarkusio/quarkus/pull/7991#pullrequestreview-377943712", "createdAt": "2020-03-19T17:31:50Z", "commit": {"oid": "7bfa813f358fd701f4e8bd7188f9863d3ec4c27e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzozMTo1MFrOF45JEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzozMjozNlrOF45K5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIwMDc4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Whenever class bytecode needs to be read, a `@BuildStep` where class reading is done have\n          \n          \n            \n            to have `loadsApplicationClasses` parameter set to `true`. Otherwise the class will not be\n          \n          \n            \n            found.\n          \n          \n            \n            Whenever class bytecode needs to be read, a `@BuildStep` where class reading is done must have the `loadsApplicationClasses` parameter set to `true`. Otherwise the class will not be found.", "url": "https://github.com/quarkusio/quarkus/pull/7991#discussion_r395200787", "createdAt": "2020-03-19T17:31:50Z", "author": {"login": "gastaldi"}, "path": "docs/src/main/asciidoc/class-loading-reference.adoc", "diffHunk": "@@ -19,6 +19,30 @@ a normal production Quarkus application.\n For all other use cases (e.g. tests, dev mode, and building the application) Quarkus\n uses the class loading architecture outlined here.\n \n+== Reading Class Bytecode\n+\n+Whenever class bytecode needs to be read, a `@BuildStep` where class reading is done have\n+to have `loadsApplicationClasses` parameter set to `true`. Otherwise the class will not be\n+found.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bfa813f358fd701f4e8bd7188f9863d3ec4c27e"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIwMDkwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            It's also important to use correct `ClassLoader`. Best is to get it by calling the\n          \n          \n            \n            It's also important to use the correct `ClassLoader`. The recommended approach is to get it by calling the", "url": "https://github.com/quarkusio/quarkus/pull/7991#discussion_r395200903", "createdAt": "2020-03-19T17:32:01Z", "author": {"login": "gastaldi"}, "path": "docs/src/main/asciidoc/class-loading-reference.adoc", "diffHunk": "@@ -19,6 +19,30 @@ a normal production Quarkus application.\n For all other use cases (e.g. tests, dev mode, and building the application) Quarkus\n uses the class loading architecture outlined here.\n \n+== Reading Class Bytecode\n+\n+Whenever class bytecode needs to be read, a `@BuildStep` where class reading is done have\n+to have `loadsApplicationClasses` parameter set to `true`. Otherwise the class will not be\n+found.\n+\n+It's also important to use correct `ClassLoader`. Best is to get it by calling the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bfa813f358fd701f4e8bd7188f9863d3ec4c27e"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIwMTI1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Example `@BuildStep` may be similar to the following:\n          \n          \n            \n            Example:", "url": "https://github.com/quarkusio/quarkus/pull/7991#discussion_r395201253", "createdAt": "2020-03-19T17:32:36Z", "author": {"login": "gastaldi"}, "path": "docs/src/main/asciidoc/class-loading-reference.adoc", "diffHunk": "@@ -19,6 +19,30 @@ a normal production Quarkus application.\n For all other use cases (e.g. tests, dev mode, and building the application) Quarkus\n uses the class loading architecture outlined here.\n \n+== Reading Class Bytecode\n+\n+Whenever class bytecode needs to be read, a `@BuildStep` where class reading is done have\n+to have `loadsApplicationClasses` parameter set to `true`. Otherwise the class will not be\n+found.\n+\n+It's also important to use correct `ClassLoader`. Best is to get it by calling the\n+`Thread.currentThread().getContextClassLoader()` method.\n+\n+Example `@BuildStep` may be similar to the following:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bfa813f358fd701f4e8bd7188f9863d3ec4c27e"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTM2MDIw", "url": "https://github.com/quarkusio/quarkus/pull/7991#pullrequestreview-378136020", "createdAt": "2020-03-19T22:26:27Z", "commit": {"oid": "83f24a447ea8155fc96bdb194075abf7539f376f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d5c57e3db453cc3cbac0e45befef0cb73edb2b2", "author": {"user": {"login": "sarxos", "name": "Bartosz Firyn"}}, "url": "https://github.com/quarkusio/quarkus/commit/4d5c57e3db453cc3cbac0e45befef0cb73edb2b2", "committedDate": "2020-03-20T12:22:42Z", "message": "Add node about class reading in class loading guide"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83f24a447ea8155fc96bdb194075abf7539f376f", "author": {"user": {"login": "sarxos", "name": "Bartosz Firyn"}}, "url": "https://github.com/quarkusio/quarkus/commit/83f24a447ea8155fc96bdb194075abf7539f376f", "committedDate": "2020-03-19T17:50:05Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: George Gastaldi <gegastaldi@gmail.com>"}, "afterCommit": {"oid": "4d5c57e3db453cc3cbac0e45befef0cb73edb2b2", "author": {"user": {"login": "sarxos", "name": "Bartosz Firyn"}}, "url": "https://github.com/quarkusio/quarkus/commit/4d5c57e3db453cc3cbac0e45befef0cb73edb2b2", "committedDate": "2020-03-20T12:22:42Z", "message": "Add node about class reading in class loading guide"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3748, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}