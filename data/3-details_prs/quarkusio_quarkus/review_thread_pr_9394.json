{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MjM1NTM3", "number": 9394, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToyNzozOFrOD9cbFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzoyMTowOVrOD_q5gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NzU1NDEzOnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToyNzozOFrOGW8UYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMjoxMjowNlrOGX0etw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDExNA==", "bodyText": "Is it really costly? I would have imagined this to be always generated", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426710114", "createdAt": "2020-05-18T15:27:38Z", "author": {"login": "emmanuelbernard"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "diffHunk": "@@ -27,6 +29,16 @@\n     @ConfigItem(defaultValue = JAR)\n     public String type;\n \n+    /**\n+     * Experimental property that allows for the creation of a 'mutable' application that\n+     * can be re-augmented after creation.\n+     *\n+     * TODO: should this just be a different package type: 'mutable-jar'\n+     *\n+     */\n+    @ConfigProperty(defaultValue = \"true\")\n+    public boolean mutableApplication;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NTc3Mg==", "bodyText": "It results in a bigger application, as you need the -deployment artifacts (and their deps) in the final output. For a normal launch these are not loaded, so there is no memory usage or boot time overhead, but it does make the final image bigger.", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426965772", "createdAt": "2020-05-19T00:39:38Z", "author": {"login": "stuartwdouglas"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "diffHunk": "@@ -27,6 +29,16 @@\n     @ConfigItem(defaultValue = JAR)\n     public String type;\n \n+    /**\n+     * Experimental property that allows for the creation of a 'mutable' application that\n+     * can be re-augmented after creation.\n+     *\n+     * TODO: should this just be a different package type: 'mutable-jar'\n+     *\n+     */\n+    @ConfigProperty(defaultValue = \"true\")\n+    public boolean mutableApplication;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDExNA=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQxNTE1MA==", "bodyText": "should be default false then?", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r427415150", "createdAt": "2020-05-19T15:57:55Z", "author": {"login": "emmanuelbernard"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "diffHunk": "@@ -27,6 +29,16 @@\n     @ConfigItem(defaultValue = JAR)\n     public String type;\n \n+    /**\n+     * Experimental property that allows for the creation of a 'mutable' application that\n+     * can be re-augmented after creation.\n+     *\n+     * TODO: should this just be a different package type: 'mutable-jar'\n+     *\n+     */\n+    @ConfigProperty(defaultValue = \"true\")\n+    public boolean mutableApplication;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDExNA=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYzMDI2Mw==", "bodyText": "Oops, sorry, trying to do too many things at once and missed that.", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r427630263", "createdAt": "2020-05-19T22:12:06Z", "author": {"login": "stuartwdouglas"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "diffHunk": "@@ -27,6 +29,16 @@\n     @ConfigItem(defaultValue = JAR)\n     public String type;\n \n+    /**\n+     * Experimental property that allows for the creation of a 'mutable' application that\n+     * can be re-augmented after creation.\n+     *\n+     * TODO: should this just be a different package type: 'mutable-jar'\n+     *\n+     */\n+    @ConfigProperty(defaultValue = \"true\")\n+    public boolean mutableApplication;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDExNA=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NzU1NzE0OnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/builditem/BuildSystemTargetBuildItem.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToyODoxN1rOGW8WMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo0MDo1MFrOGXL8Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDU3OA==", "bodyText": "What are the reason for the rebuild Boolean a. Is it just to read from the dat model? Or is there more to it ?", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426710578", "createdAt": "2020-05-18T15:28:17Z", "author": {"login": "emmanuelbernard"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/builditem/BuildSystemTargetBuildItem.java", "diffHunk": "@@ -11,10 +11,12 @@\n \n     private final Path outputDirectory;\n     private final String baseName;\n+    private final boolean rebuild;\n \n-    public BuildSystemTargetBuildItem(Path outputDirectory, String baseName) {\n+    public BuildSystemTargetBuildItem(Path outputDirectory, String baseName, boolean rebuild) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NjA5MQ==", "bodyText": "When you rebuild you don't want to re-copy libraries, as they are already in place on disk. A normal build will also delete the target dir to start with a clean slate.", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426966091", "createdAt": "2020-05-19T00:40:50Z", "author": {"login": "stuartwdouglas"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/builditem/BuildSystemTargetBuildItem.java", "diffHunk": "@@ -11,10 +11,12 @@\n \n     private final Path outputDirectory;\n     private final String baseName;\n+    private final boolean rebuild;\n \n-    public BuildSystemTargetBuildItem(Path outputDirectory, String baseName) {\n+    public BuildSystemTargetBuildItem(Path outputDirectory, String baseName, boolean rebuild) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMDU3OA=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NzU3MjU2OnYy", "diffSide": "RIGHT", "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/AugmentEntryPoint.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNTozMTo1MVrOGW8f6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMjoxMjo0OVrOGX0f9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMzA2Nw==", "bodyText": "So there is a mutability main entry and a reaugment main entry? What\u2019s the difference?", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426713067", "createdAt": "2020-05-18T15:31:51Z", "author": {"login": "emmanuelbernard"}, "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/AugmentEntryPoint.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package io.quarkus.bootstrap.runner;\n+\n+import java.io.ObjectInputStream;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.net.URLDecoder;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Experimental class that allows Quarkus applications to be re-augmented\n+ * \n+ */\n+public class AugmentEntryPoint {\n+\n+    public static void main(String... args) throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NjUwMQ==", "bodyText": "This is the entry point to regenerate the app. As my transparent rebuild idea was not popular this must be invoked manually. For now while this is experimental this is just run using java -cp quarkus-run.jar io.quarkus.bootstrap.runner.AumentEntryPoint, once this feature is no longer experimental we will likely want an easier way to do this.", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r426966501", "createdAt": "2020-05-19T00:42:32Z", "author": {"login": "stuartwdouglas"}, "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/AugmentEntryPoint.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package io.quarkus.bootstrap.runner;\n+\n+import java.io.ObjectInputStream;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.net.URLDecoder;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Experimental class that allows Quarkus applications to be re-augmented\n+ * \n+ */\n+public class AugmentEntryPoint {\n+\n+    public static void main(String... args) throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMzA2Nw=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQxNjAzMw==", "bodyText": "ok but what about this one? MutabilityEntryPoint", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r427416033", "createdAt": "2020-05-19T15:59:10Z", "author": {"login": "emmanuelbernard"}, "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/AugmentEntryPoint.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package io.quarkus.bootstrap.runner;\n+\n+import java.io.ObjectInputStream;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.net.URLDecoder;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Experimental class that allows Quarkus applications to be re-augmented\n+ * \n+ */\n+public class AugmentEntryPoint {\n+\n+    public static void main(String... args) throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMzA2Nw=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYzMDU4Mw==", "bodyText": "Its just badly named, its purpose changed but not its name, I have renamed it.", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r427630583", "createdAt": "2020-05-19T22:12:49Z", "author": {"login": "stuartwdouglas"}, "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/AugmentEntryPoint.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package io.quarkus.bootstrap.runner;\n+\n+import java.io.ObjectInputStream;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.net.URLDecoder;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Experimental class that allows Quarkus applications to be re-augmented\n+ * \n+ */\n+public class AugmentEntryPoint {\n+\n+    public static void main(String... args) throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcxMzA2Nw=="}, "originalCommit": {"oid": "0995bdcfe448a3b976e1b91bc4537f3d422603ff"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MDg4NTM1OnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzoxODoyNFrOGad0Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzoxODoyNFrOGad0Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQwNDY3NQ==", "bodyText": "+1 to make it a different package type, since IIUC you can't really use mutableApplication with the other package types", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r430404675", "createdAt": "2020-05-26T13:18:24Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/PackageConfig.java", "diffHunk": "@@ -27,6 +29,16 @@\n     @ConfigItem(defaultValue = JAR)\n     public String type;\n \n+    /**\n+     * Experimental property that allows for the creation of a 'mutable' application that\n+     * can be re-augmented after creation.\n+     *\n+     * TODO: should this just be a different package type: 'mutable-jar'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98e0393664788f56169d055d585335f845ab8dd"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MDg5NzMxOnYy", "diffSide": "RIGHT", "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/ReAugmentEntryPoint.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzoyMTowOVrOGad7vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzoyMTowOVrOGad7vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQwNjU4OA==", "bodyText": "What is the reason to not use it?", "url": "https://github.com/quarkusio/quarkus/pull/9394#discussion_r430406588", "createdAt": "2020-05-26T13:21:09Z", "author": {"login": "geoand"}, "path": "independent-projects/bootstrap/runner/src/main/java/io/quarkus/bootstrap/runner/ReAugmentEntryPoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package io.quarkus.bootstrap.runner;\n+\n+import java.io.File;\n+import java.io.ObjectInputStream;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.net.URLDecoder;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.List;\n+\n+/**\n+ * Experimental class that allows Quarkus applications to be re-augmented\n+ *\n+ */\n+public class ReAugmentEntryPoint {\n+\n+    public static void main(String... args) throws Exception {\n+        System.setProperty(\"java.util.logging.manager\", org.jboss.logmanager.LogManager.class.getName());\n+        Timing.staticInitStarted();\n+\n+        String path = ReAugmentEntryPoint.class.getProtectionDomain().getCodeSource().getLocation().getPath();\n+        String decodedPath = URLDecoder.decode(path, \"UTF-8\");\n+        Path appRoot = new File(decodedPath).toPath().getParent().getParent();\n+\n+        try (ObjectInputStream in = new ObjectInputStream(\n+                Files.newInputStream(appRoot.resolve(\"deployment-quarkus/deployment-class-path.dat\")))) {\n+            List<String> paths = (List<String>) in.readObject();\n+            //yuck, should use runner class loader", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f98e0393664788f56169d055d585335f845ab8dd"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3075, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}