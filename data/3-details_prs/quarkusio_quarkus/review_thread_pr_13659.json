{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNzM2ODU4", "number": 13659, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMzowNTozM1rOFAO17g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo0NzoxMVrOFAptCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1Nzg3NTAyOnYy", "diffSide": "RIGHT", "path": "integration-tests/oidc-tenancy/src/main/java/io/quarkus/it/keycloak/TenantResource.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMzowNTozM1rOH-aqCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNDoyNTozOFrOH-eOOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMDUwNg==", "bodyText": "Instead of returning the property names via a getter, isn't better to introduce a UserInfo.contains(String) instead?", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r535210506", "createdAt": "2020-12-03T13:05:33Z", "author": {"login": "gastaldi"}, "path": "integration-tests/oidc-tenancy/src/main/java/io/quarkus/it/keycloak/TenantResource.java", "diffHunk": "@@ -40,7 +42,9 @@ public String userNameService(@PathParam(\"tenant\") String tenant) {\n         String name = getNameServiceType();\n         if (\"tenant-d\".equals(tenant) || \"tenant-b-no-discovery\".equals(tenant)) {\n             UserInfo userInfo = getUserInfo();\n-            name = name + \".\" + userInfo.getString(\"preferred_username\");\n+            if (userInfo.getPropertyNames().contains(PREFERRED_USERNAME)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb1c70cdcce0c37d5878cbf342a3e00035e9a61a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI1MTg4OQ==", "bodyText": "@gastaldi the user just wanted to see the whole set of property names as he was not sure what is in that UserInfo, here I just added this awkward check to test the new method :-), but yeah, let me add a shortcut as well, makes sense", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r535251889", "createdAt": "2020-12-03T14:03:45Z", "author": {"login": "sberyozkin"}, "path": "integration-tests/oidc-tenancy/src/main/java/io/quarkus/it/keycloak/TenantResource.java", "diffHunk": "@@ -40,7 +42,9 @@ public String userNameService(@PathParam(\"tenant\") String tenant) {\n         String name = getNameServiceType();\n         if (\"tenant-d\".equals(tenant) || \"tenant-b-no-discovery\".equals(tenant)) {\n             UserInfo userInfo = getUserInfo();\n-            name = name + \".\" + userInfo.getString(\"preferred_username\");\n+            if (userInfo.getPropertyNames().contains(PREFERRED_USERNAME)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMDUwNg=="}, "originalCommit": {"oid": "fb1c70cdcce0c37d5878cbf342a3e00035e9a61a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI2ODE0Mg==", "bodyText": "@gastaldi Just updated it, kept the getPropertyNames test check but also added contains check", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r535268142", "createdAt": "2020-12-03T14:24:41Z", "author": {"login": "sberyozkin"}, "path": "integration-tests/oidc-tenancy/src/main/java/io/quarkus/it/keycloak/TenantResource.java", "diffHunk": "@@ -40,7 +42,9 @@ public String userNameService(@PathParam(\"tenant\") String tenant) {\n         String name = getNameServiceType();\n         if (\"tenant-d\".equals(tenant) || \"tenant-b-no-discovery\".equals(tenant)) {\n             UserInfo userInfo = getUserInfo();\n-            name = name + \".\" + userInfo.getString(\"preferred_username\");\n+            if (userInfo.getPropertyNames().contains(PREFERRED_USERNAME)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMDUwNg=="}, "originalCommit": {"oid": "fb1c70cdcce0c37d5878cbf342a3e00035e9a61a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI2ODkyMQ==", "bodyText": "Looks good, thanks!", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r535268921", "createdAt": "2020-12-03T14:25:38Z", "author": {"login": "gastaldi"}, "path": "integration-tests/oidc-tenancy/src/main/java/io/quarkus/it/keycloak/TenantResource.java", "diffHunk": "@@ -40,7 +42,9 @@ public String userNameService(@PathParam(\"tenant\") String tenant) {\n         String name = getNameServiceType();\n         if (\"tenant-d\".equals(tenant) || \"tenant-b-no-discovery\".equals(tenant)) {\n             UserInfo userInfo = getUserInfo();\n-            name = name + \".\" + userInfo.getString(\"preferred_username\");\n+            if (userInfo.getPropertyNames().contains(PREFERRED_USERNAME)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMDUwNg=="}, "originalCommit": {"oid": "fb1c70cdcce0c37d5878cbf342a3e00035e9a61a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MjI3NTk0OnYy", "diffSide": "RIGHT", "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo0NzoxMVrOH_DG3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNzo0OToyMlrOIIsq7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3MzI0NQ==", "bodyText": "Missing onItem() before calling .transform(.", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r535873245", "createdAt": "2020-12-04T06:47:11Z", "author": {"login": "Sgitario"}, "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "diffHunk": "@@ -318,7 +318,7 @@ public class ProtectedResource {\n     @GET\n     public CompletionStage<List<Permission>> get() {\n         return identity.checkPermission(new AuthPermission(\"{resource_name}\"))\n-                .thenCompose(granted -> {\n+                .transform(granted -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "249b22eeb3f88f4c9131da153772778412a7528f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk5MTQwNw==", "bodyText": "Going to update it shortly", "url": "https://github.com/quarkusio/quarkus/pull/13659#discussion_r545991407", "createdAt": "2020-12-18T17:49:22Z", "author": {"login": "sberyozkin"}, "path": "docs/src/main/asciidoc/security-keycloak-authorization.adoc", "diffHunk": "@@ -318,7 +318,7 @@ public class ProtectedResource {\n     @GET\n     public CompletionStage<List<Permission>> get() {\n         return identity.checkPermission(new AuthPermission(\"{resource_name}\"))\n-                .thenCompose(granted -> {\n+                .transform(granted -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3MzI0NQ=="}, "originalCommit": {"oid": "249b22eeb3f88f4c9131da153772778412a7528f"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3761, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}