{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMjg0MTYx", "number": 12683, "title": "Provide helpful error-message for BindException on quarkus.http.port", "bodyText": "Fixes #4890", "createdAt": "2020-10-13T13:00:07Z", "url": "https://github.com/quarkusio/quarkus/pull/12683", "merged": true, "mergeCommit": {"oid": "ca4301e978784696c2221d92ed2c74fb9dc8a3bf"}, "closed": true, "closedAt": "2020-10-19T15:07:44Z", "author": {"login": "xumk"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSIdOXAFqTUwNzQyNDg4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUFmgHAFqTUxMTg2NzIzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NDI0ODg3", "url": "https://github.com/quarkusio/quarkus/pull/12683#pullrequestreview-507424887", "createdAt": "2020-10-13T13:19:02Z", "commit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NDU1MDI3", "url": "https://github.com/quarkusio/quarkus/pull/12683#pullrequestreview-507455027", "createdAt": "2020-10-13T13:48:08Z", "commit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODowOFrOHgnrfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODowOFrOHgnrfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ==", "bodyText": "What's the deal with this?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503966591", "createdAt": "2020-10-13T13:48:08Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NDU1NjEy", "url": "https://github.com/quarkusio/quarkus/pull/12683#pullrequestreview-507455612", "createdAt": "2020-10-13T13:48:40Z", "commit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODo0MFrOHgntTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODo0MFrOHgntTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NzA1Mw==", "bodyText": "These error messages are super useful, thanks!", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503967053", "createdAt": "2020-10-13T13:48:40Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20434c5a69b9623fa42e5f153d45b5527dea8b22", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/20434c5a69b9623fa42e5f153d45b5527dea8b22", "committedDate": "2020-10-13T14:07:38Z", "message": "assignment rootCause to deploymentProblem"}, "afterCommit": {"oid": "72dd941c464acef3458db03516bd374d923b53c6", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/72dd941c464acef3458db03516bd374d923b53c6", "committedDate": "2020-10-13T14:28:18Z", "message": "issue #4890 Provide helpful error-message for BindException on quarkus.http.port"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NTA0MTUx", "url": "https://github.com/quarkusio/quarkus/pull/12683#pullrequestreview-507504151", "createdAt": "2020-10-13T14:33:42Z", "commit": {"oid": "72dd941c464acef3458db03516bd374d923b53c6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca301016da4f82935f85487d4d337fead7bec3c8", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/ca301016da4f82935f85487d4d337fead7bec3c8", "committedDate": "2020-10-14T11:27:06Z", "message": "add helpful message for all run application"}, "afterCommit": {"oid": "9cee739a4a853e3de72bc9af8c87c02428298fdf", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/9cee739a4a853e3de72bc9af8c87c02428298fdf", "committedDate": "2020-10-14T11:28:35Z", "message": "issue #4890 Provide helpful error-message for BindException on quarkus.http.port"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c7a57e30531f5d73ab5f87daf33d36838b7d827", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/4c7a57e30531f5d73ab5f87daf33d36838b7d827", "committedDate": "2020-10-15T09:05:41Z", "message": "fix restart"}, "afterCommit": {"oid": "60d0f4b6b86949932ec0a33ad829e12571f531fa", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/60d0f4b6b86949932ec0a33ad829e12571f531fa", "committedDate": "2020-10-15T09:06:02Z", "message": "fix restart"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60d0f4b6b86949932ec0a33ad829e12571f531fa", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/60d0f4b6b86949932ec0a33ad829e12571f531fa", "committedDate": "2020-10-15T09:06:02Z", "message": "fix restart"}, "afterCommit": {"oid": "f8985f905553e70d5f3e33fc7283b94310f62eea", "author": {"user": {"login": "dependabot[bot]", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/f8985f905553e70d5f3e33fc7283b94310f62eea", "committedDate": "2020-10-15T09:12:26Z", "message": "Squash all commits"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8985f905553e70d5f3e33fc7283b94310f62eea", "author": {"user": {"login": "dependabot[bot]", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/f8985f905553e70d5f3e33fc7283b94310f62eea", "committedDate": "2020-10-15T09:12:26Z", "message": "Squash all commits"}, "afterCommit": {"oid": "502c7ea28c51e22b46903a25e62d089e06c951ee", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/502c7ea28c51e22b46903a25e62d089e06c951ee", "committedDate": "2020-10-15T09:16:27Z", "message": "solved #4890 Provide helpful error-message for BindException on quarkus.http.port"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "502c7ea28c51e22b46903a25e62d089e06c951ee", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/502c7ea28c51e22b46903a25e62d089e06c951ee", "committedDate": "2020-10-15T09:16:27Z", "message": "solved #4890 Provide helpful error-message for BindException on quarkus.http.port"}, "afterCommit": {"oid": "137bb83eb17bd429af7b0f05e8086d49994281f9", "author": {"user": {"login": "iocanel", "name": "Ioannis Canellos"}}, "url": "https://github.com/quarkusio/quarkus/commit/137bb83eb17bd429af7b0f05e8086d49994281f9", "committedDate": "2020-10-14T14:39:07Z", "message": "refactor: Split KubernetesProcessor into pieces"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "137bb83eb17bd429af7b0f05e8086d49994281f9", "author": {"user": {"login": "iocanel", "name": "Ioannis Canellos"}}, "url": "https://github.com/quarkusio/quarkus/commit/137bb83eb17bd429af7b0f05e8086d49994281f9", "committedDate": "2020-10-14T14:39:07Z", "message": "refactor: Split KubernetesProcessor into pieces"}, "afterCommit": {"oid": "4c7a57e30531f5d73ab5f87daf33d36838b7d827", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/4c7a57e30531f5d73ab5f87daf33d36838b7d827", "committedDate": "2020-10-15T09:05:41Z", "message": "fix restart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96f09aeed8efe63ad22fcd5090ceb2163d3e1b80", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/96f09aeed8efe63ad22fcd5090ceb2163d3e1b80", "committedDate": "2020-10-15T10:13:10Z", "message": "solved #4890 Provide helpful error-message for BindException on quarkus.http.port"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c7a57e30531f5d73ab5f87daf33d36838b7d827", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/4c7a57e30531f5d73ab5f87daf33d36838b7d827", "committedDate": "2020-10-15T09:05:41Z", "message": "fix restart"}, "afterCommit": {"oid": "96f09aeed8efe63ad22fcd5090ceb2163d3e1b80", "author": {"user": {"login": "xumk", "name": "Aleksey Ivashin"}}, "url": "https://github.com/quarkusio/quarkus/commit/96f09aeed8efe63ad22fcd5090ceb2163d3e1b80", "committedDate": "2020-10-15T10:13:10Z", "message": "solved #4890 Provide helpful error-message for BindException on quarkus.http.port"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExODY3MjM4", "url": "https://github.com/quarkusio/quarkus/pull/12683#pullrequestreview-511867238", "createdAt": "2020-10-19T15:07:18Z", "commit": {"oid": "96f09aeed8efe63ad22fcd5090ceb2163d3e1b80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1772, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}