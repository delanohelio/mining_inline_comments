{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MzkxNTg0", "number": 12156, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozODoxOFrOEvOtLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoyNzoxOFrOEv68Vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTU5NDcxOnYy", "diffSide": "RIGHT", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozODoxOFrOHkGAzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozODoxOFrOHkGAzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwOTI5Mw==", "bodyText": "That's io.quarkus.bootstrap.BootstrapConstants.DESCRIPTOR_PATH, btw.", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r507609293", "createdAt": "2020-10-19T09:38:18Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -93,6 +95,7 @@\n  */\n @Mojo(name = \"dev\", defaultPhase = LifecyclePhase.PREPARE_PACKAGE, requiresDependencyResolution = ResolutionScope.COMPILE_PLUS_RUNTIME)\n public class DevMojo extends AbstractMojo {\n+    private static final String EXT_PROPERTIES_PATH = \"META-INF/quarkus-extension.properties\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTYwMjUzOnYy", "diffSide": "RIGHT", "path": "independent-projects/bootstrap/app-model/src/main/java/io/quarkus/bootstrap/model/AppArtifactKey.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTo0MDoyOFrOHkGF0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQyMzozMTozNlrOHklOPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYxMDU3Ng==", "bodyText": "It doesn't look like this change is necessary. There is already public AppArtifactKey(String groupId, String artifactId, String classifier, String type)", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r507610576", "createdAt": "2020-10-19T09:40:28Z", "author": {"login": "aloubyansky"}, "path": "independent-projects/bootstrap/app-model/src/main/java/io/quarkus/bootstrap/model/AppArtifactKey.java", "diffHunk": "@@ -70,7 +70,7 @@ public static AppArtifactKey fromString(String str) {\n     protected final String classifier;\n     protected final String type;\n \n-    protected AppArtifactKey(String[] parts) {\n+    public AppArtifactKey(String[] parts) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODEyMDYzNw==", "bodyText": "It makes the code a lot simpler. This is the ctor that is used by the existing code that reads from quarkus-extensions.properties, I would need to copy the logic.", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r508120637", "createdAt": "2020-10-19T23:31:36Z", "author": {"login": "stuartwdouglas"}, "path": "independent-projects/bootstrap/app-model/src/main/java/io/quarkus/bootstrap/model/AppArtifactKey.java", "diffHunk": "@@ -70,7 +70,7 @@ public static AppArtifactKey fromString(String str) {\n     protected final String classifier;\n     protected final String type;\n \n-    protected AppArtifactKey(String[] parts) {\n+    public AppArtifactKey(String[] parts) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYxMDU3Ng=="}, "originalCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4Njg0MjQ3OnYy", "diffSide": "RIGHT", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoyNzoxOFrOHlLcLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoyNzoxOFrOHlLcLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc0Njc5Nw==", "bodyText": "There is AppArtifactKey.fromString(str) actually.", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r508746797", "createdAt": "2020-10-20T18:27:18Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -717,11 +720,35 @@ void prepare(final boolean triggerCompile) throws Exception {\n \n             //in most cases these are not used, however they need to be present for some\n             //parent-first cases such as logging\n+            //first we go through and get all the parent first artifacts\n+            Set<AppArtifactKey> parentFirstArtifacts = new HashSet<>();\n+            for (Artifact appDep : project.getArtifacts()) {\n+                if (appDep.getArtifactHandler().getExtension().equals(\"jar\")) {\n+                    try (ZipFile file = new ZipFile(appDep.getFile())) {\n+                        ZipEntry entry = file.getEntry(BootstrapConstants.DESCRIPTOR_PATH);\n+                        if (entry != null) {\n+                            Properties p = new Properties();\n+                            try (InputStream inputStream = file.getInputStream(entry)) {\n+                                p.load(inputStream);\n+                                String parentFirst = p.getProperty(AppModel.PARENT_FIRST_ARTIFACTS);\n+                                if (parentFirst != null) {\n+                                    String[] artifacts = parentFirst.split(\",\");\n+                                    for (String artifact : artifacts) {\n+                                        parentFirstArtifacts.add(new AppArtifactKey(artifact.split(\":\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 305, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}