{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NjE4MjUx", "number": 12076, "title": "AdditionalBeanBuildItem - clarify javadoc and improve the transformer", "bodyText": "clarify javadoc in the AdditionalBean annotation\nalso deprecate BeanArchiveIndexBuildItem#getAdditionalBeans()\n\nFollows up on #12051", "createdAt": "2020-09-14T13:29:23Z", "url": "https://github.com/quarkusio/quarkus/pull/12076", "merged": true, "mergeCommit": {"oid": "1e5c6d1303c38027995d51ce135cd172d16542d8"}, "closed": true, "closedAt": "2020-09-14T19:53:08Z", "author": {"login": "mkouba"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIzNm1gH2gAyNDg2NjE4MjUxOmJhYTEwODY3M2EwNTAwYmNlNWU4ZGU2ZWRhMjY0ZGM4MjQwMDhkOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI0fNfgFqTQ4Nzg1ODE5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "baa108673a0500bce5e8de6eda264dc824008d90", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/baa108673a0500bce5e8de6eda264dc824008d90", "committedDate": "2020-09-14T13:28:39Z", "message": "AdditionalBeanBuildItem - clarify javadoc and improve the transformer\n\n- clarify javadoc in the AdditionalBean annotation\n- also deprecate BeanArchiveIndexBuildItem#getAdditionalBeans()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3Nzc1NTI3", "url": "https://github.com/quarkusio/quarkus/pull/12076#pullrequestreview-487775527", "createdAt": "2020-09-14T13:36:27Z", "commit": {"oid": "baa108673a0500bce5e8de6eda264dc824008d90"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMzozNjoyN1rOHRURhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMzozNjoyN1rOHRURhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzkyMDAwNA==", "bodyText": "Nice!", "url": "https://github.com/quarkusio/quarkus/pull/12076#discussion_r487920004", "createdAt": "2020-09-14T13:36:27Z", "author": {"login": "geoand"}, "path": "extensions/arc/deployment/src/main/java/io/quarkus/arc/deployment/ArcProcessor.java", "diffHunk": "@@ -153,7 +153,21 @@ public ContextRegistrationPhaseBuildItem initialize(\n                     \" Please use one of \" + ArcConfig.ALLOWED_REMOVE_UNUSED_BEANS_VALUES);\n         }\n \n-        List<String> additionalBeansTypes = beanArchiveIndex.getAdditionalBeans();\n+        // bean type -> default scope (may be null)\n+        Map<String, DotName> additionalBeanTypes = new HashMap<>();\n+        for (AdditionalBeanBuildItem additionalBean : additionalBeans) {\n+            DotName defaultScope = additionalBean.getDefaultScope();\n+            for (String beanClass : additionalBean.getBeanClasses()) {\n+                DotName existingDefaultScope = additionalBeanTypes.get(beanClass);\n+                if (existingDefaultScope != null && defaultScope != null && !existingDefaultScope.equals(defaultScope)) {\n+                    throw new IllegalStateException(\"Different default scopes defined for additional bean class: \" + beanClass", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baa108673a0500bce5e8de6eda264dc824008d90"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODU4MTk3", "url": "https://github.com/quarkusio/quarkus/pull/12076#pullrequestreview-487858197", "createdAt": "2020-09-14T14:57:47Z", "commit": {"oid": "baa108673a0500bce5e8de6eda264dc824008d90"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 470, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}