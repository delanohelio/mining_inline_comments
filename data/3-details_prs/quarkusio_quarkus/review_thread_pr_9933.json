{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyODExMTIw", "number": 9933, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNTo1OTozMVrOEEjRhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMDo1Nzo0M1rOEJF1Yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMjA3Njg3OnYy", "diffSide": "RIGHT", "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/WithProfile.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNTo1OTozMVrOGiPhpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNTo1OTozMVrOGiPhpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU1OTE0Mg==", "bodyText": "Perhaps this should be called TestProfile?", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r438559142", "createdAt": "2020-06-11T05:59:31Z", "author": {"login": "geoand"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/WithProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface WithProfile {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a18bad995745e2e2d1a47064f67721d0ca05fe1"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMjA3ODMyOnYy", "diffSide": "RIGHT", "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/QuarkusTestProfile.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjowMDoxOVrOGiPimA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjowMDoxOVrOGiPimA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU1OTM4NA==", "bodyText": "I love the idea of having all per-test configuration under one class, really simplifies things both for users and for us :)", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r438559384", "createdAt": "2020-06-11T06:00:19Z", "author": {"login": "geoand"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/QuarkusTestProfile.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package io.quarkus.test.junit;\n+\n+import java.util.Collections;\n+import java.util.Map;\n+import java.util.Set;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ */\n+public interface QuarkusTestProfile {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a18bad995745e2e2d1a47064f67721d0ca05fe1"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NTU2ODAyOnYy", "diffSide": "RIGHT", "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/QuarkusTestExtension.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwODozNDowN1rOGkQ_WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwODozNDowN1rOGkQ_WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY4MDI4MA==", "bodyText": "FYI there is also quarkus.arc.exclude-types that allows you to exclude types from discovery, i.e. ignore the specified types. And it hase the same syntax as selected alternatives: https://github.com/quarkusio/quarkus/blob/master/extensions/arc/deployment/src/main/java/io/quarkus/arc/deployment/ArcConfig.java#L99-L113", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r440680280", "createdAt": "2020-06-16T08:34:07Z", "author": {"login": "mkouba"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/QuarkusTestExtension.java", "diffHunk": "@@ -114,10 +121,38 @@ private ExtensionState doJavaStart(ExtensionContext context) throws Throwable {\n                 }\n             }\n             originalCl = Thread.currentThread().getContextClassLoader();\n+            Map<String, String> sysPropRestore = new HashMap<>();\n+            sysPropRestore.put(ProfileManager.QUARKUS_TEST_PROFILE_PROP,\n+                    System.getProperty(ProfileManager.QUARKUS_TEST_PROFILE_PROP));\n \n             final QuarkusBootstrap.Builder runnerBuilder = QuarkusBootstrap.builder()\n                     .setIsolateDeployment(true)\n                     .setMode(QuarkusBootstrap.Mode.TEST);\n+            if (profile != null) {\n+                QuarkusTestProfile profileInstance = profile.newInstance();\n+                Map<String, String> additional = new HashMap<>(profileInstance.getConfigOverrides());\n+                if (!profileInstance.getEnabledAlternatives().isEmpty()) {\n+                    additional.put(\"quarkus.arc.selected-alternatives\", profileInstance.getEnabledAlternatives().stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTY4MjI3OnYy", "diffSide": "RIGHT", "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMDo1Nzo0M1rOGpcqlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMTowNzozN1rOGpc6Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw==", "bodyText": "IMHO it would make sense to define this interface as @Inherited in case someone wants to define it on a common superclass.\nFor JUnit 5 tests I am also used to be able to define my own composed annotations with meta-annotations, which I think could also be very useful for Quarkus' test annotations like @QuarkusTestResource and @TestProfile. But for this I will file a separate enhancement request.", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446114453", "createdAt": "2020-06-26T10:57:43Z", "author": {"login": "knutwannheden"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDk0OQ==", "bodyText": "Please do, that sounds useful", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446114949", "createdAt": "2020-06-26T10:59:00Z", "author": {"login": "geoand"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw=="}, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNzA0Mg==", "bodyText": "See #10297.", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446117042", "createdAt": "2020-06-26T11:04:21Z", "author": {"login": "knutwannheden"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw=="}, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNzU0MA==", "bodyText": "Should I file a separate enhancement request for declaring @QuarkusTestResource and @TestProfile as @Inherited?", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446117540", "createdAt": "2020-06-26T11:05:28Z", "author": {"login": "knutwannheden"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw=="}, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExODQwMQ==", "bodyText": "Sure yeah", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446118401", "createdAt": "2020-06-26T11:07:31Z", "author": {"login": "geoand"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw=="}, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExODQ0Mg==", "bodyText": "See #10297.\n\nThanks", "url": "https://github.com/quarkusio/quarkus/pull/9933#discussion_r446118442", "createdAt": "2020-06-26T11:07:37Z", "author": {"login": "geoand"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/TestProfile.java", "diffHunk": "@@ -0,0 +1,31 @@\n+package io.quarkus.test.junit;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Defines a 'test profile'. Tests run under a test profile\n+ * will have different configuration options to other tests.\n+ *\n+ * Due to the global nature of Quarkus if a previous test was\n+ * run under a different profile then Quarkus will need to be\n+ * restarted when the profile changes. Unfortunately there\n+ * is currently no way to order tests based on profile, however\n+ * this can be done manually by running tests in alphabetical\n+ * order and putting all tests with the same profile in the same\n+ * package.\n+ */\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.TYPE)\n+public @interface TestProfile {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNDQ1Mw=="}, "originalCommit": {"oid": "2f7b40c343c81c61212c3497b6594f3b68d29feb"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2852, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}