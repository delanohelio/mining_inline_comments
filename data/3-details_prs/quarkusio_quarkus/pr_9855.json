{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwOTgwOTk0", "number": 9855, "title": "Add global quarkus.tls.trust-all configuration property", "bodyText": "This branch adds a global config property quarkus.tls.trust-all. Thus, extensions which needs a property to enable/disable tls verification could use it.\nThere are some failed tests.\nHere is the problem:\nThe quarkus.tls.trust-all property has a default value to false.\nWhen configuring an other property (quarkus.vault.tls.skip-verify) as:\n@ConfigItem(defaultValue = \"${quarkus.tls.trust-all}\")\n\nThis will end with an error resolving the property. But when setting quarkus.tls.trust-all property in application.properties, the resolution will be ok.\nI think using Optional could fix it but it means handling default value in each extension.\nclose #8975\nclose #12266", "createdAt": "2020-06-08T09:20:41Z", "url": "https://github.com/quarkusio/quarkus/pull/9855", "merged": true, "mergeCommit": {"oid": "45c1c590d46735bd78cccf2366583f1442fa754b"}, "closed": true, "closedAt": "2020-11-19T14:55:15Z", "author": {"login": "glefloch"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpTnh4gFqTQyNjQ0NDA5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddaiX9gBqjQwMDU3ODE5NDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NDQ0MDk2", "url": "https://github.com/quarkusio/quarkus/pull/9855#pullrequestreview-426444096", "createdAt": "2020-06-08T17:08:20Z", "commit": {"oid": "af35a6804e7a2ba06477b63591328feffc95cdf3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNzowODoyMVrOGgn4hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNzowODoyMVrOGgn4hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2MTA2Mg==", "bodyText": "I'm not sure it should be deprecated. There has to be an option for each extension to choose to differ from the global value. The example I suggested during the forum discussion: Vault is internal, OIDC server is not.\nSo I'd rename quarkus.oidc.tls.verification to quarkus.oidc.tls.trust-all (initialized by default to quarkus.tls.trust-all as per your PR) without the deprecated tag (and similarly for the other extensions). We can then update the migration guide. And docs to recommend quarkus.tls.trust-all but the users would still have an option to override it with quarkus.oidc.tls.trust-all for OIDC or quarkus.vault.tls.trust-all for Vault, etc...", "url": "https://github.com/quarkusio/quarkus/pull/9855#discussion_r436861062", "createdAt": "2020-06-08T17:08:21Z", "author": {"login": "sberyozkin"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/OidcTenantConfig.java", "diffHunk": "@@ -120,31 +120,14 @@\n \n     @ConfigGroup\n     public static class Tls {\n-        public enum Verification {\n-            /**\n-             * Certificates are validated and hostname verification is enabled. This is the default value.\n-             */\n-            REQUIRED,\n-            /**\n-             * All certificated are trusted and hostname verification is disabled.\n-             */\n-            NONE\n-        }\n \n         /**\n-         * Certificate validation and hostname verification, which can be one of the following values from enum\n-         * {@link Verification}. Default is required.\n+         * Enable or disable certificate validation and hostname verification. Enable by default.\n+         * \n+         * @deprecated use quarkus.tls.trust-all instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af35a6804e7a2ba06477b63591328feffc95cdf3"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af35a6804e7a2ba06477b63591328feffc95cdf3", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/af35a6804e7a2ba06477b63591328feffc95cdf3", "committedDate": "2020-06-08T08:37:17Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "01ecba51b00531b2ad72d9a3fbe5d5cd9312dabc", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/01ecba51b00531b2ad72d9a3fbe5d5cd9312dabc", "committedDate": "2020-06-12T13:17:43Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01ecba51b00531b2ad72d9a3fbe5d5cd9312dabc", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/01ecba51b00531b2ad72d9a3fbe5d5cd9312dabc", "committedDate": "2020-06-12T13:17:43Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "6066b2034efb75d1d2c0b082443dabd5a229c5d1", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/6066b2034efb75d1d2c0b082443dabd5a229c5d1", "committedDate": "2020-06-15T07:14:35Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6066b2034efb75d1d2c0b082443dabd5a229c5d1", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/6066b2034efb75d1d2c0b082443dabd5a229c5d1", "committedDate": "2020-06-15T07:14:35Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "8d7214edc65b14f82ca1a3befaaa0c27c59f0f10", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/8d7214edc65b14f82ca1a3befaaa0c27c59f0f10", "committedDate": "2020-06-16T13:04:57Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d7214edc65b14f82ca1a3befaaa0c27c59f0f10", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/8d7214edc65b14f82ca1a3befaaa0c27c59f0f10", "committedDate": "2020-06-16T13:04:57Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "7575ce415e2faf68aebb254165bc103eff4677f2", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/7575ce415e2faf68aebb254165bc103eff4677f2", "committedDate": "2020-06-17T07:09:16Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7575ce415e2faf68aebb254165bc103eff4677f2", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/7575ce415e2faf68aebb254165bc103eff4677f2", "committedDate": "2020-06-17T07:09:16Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "cfe3d0bed1113882d03723a6d01aadb81a8e0e0a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/cfe3d0bed1113882d03723a6d01aadb81a8e0e0a", "committedDate": "2020-09-25T14:51:47Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cfe3d0bed1113882d03723a6d01aadb81a8e0e0a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/cfe3d0bed1113882d03723a6d01aadb81a8e0e0a", "committedDate": "2020-09-25T14:51:47Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "6d18886f7359996b6f6be171ff4bb6feded46c56", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/6d18886f7359996b6f6be171ff4bb6feded46c56", "committedDate": "2020-10-02T15:15:09Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d18886f7359996b6f6be171ff4bb6feded46c56", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/6d18886f7359996b6f6be171ff4bb6feded46c56", "committedDate": "2020-10-02T15:15:09Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "d9d8d88668b3e4b854f35a43e01fb0ee92a29baa", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/d9d8d88668b3e4b854f35a43e01fb0ee92a29baa", "committedDate": "2020-10-27T18:57:39Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9d8d88668b3e4b854f35a43e01fb0ee92a29baa", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/d9d8d88668b3e4b854f35a43e01fb0ee92a29baa", "committedDate": "2020-10-27T18:57:39Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa", "committedDate": "2020-11-03T20:10:28Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODU5NDcy", "url": "https://github.com/quarkusio/quarkus/pull/9855#pullrequestreview-522859472", "createdAt": "2020-11-03T20:42:49Z", "commit": {"oid": "fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjcyMjEw", "url": "https://github.com/quarkusio/quarkus/pull/9855#pullrequestreview-527272210", "createdAt": "2020-11-10T14:43:05Z", "commit": {"oid": "fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDo0MzowNVrOHwf0nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDo0MzowNVrOHwf0nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYxNTA3MQ==", "bodyText": "@glefloch Hi, in this specific example, should it be && ? (assuming tlsConfig.trustAll is true by default)\nIMHO, keeping the extension specific properties is OK because it can let the users be specific about the concrete extensions, but hence the extension specific setting should take the priority ?", "url": "https://github.com/quarkusio/quarkus/pull/9855#discussion_r520615071", "createdAt": "2020-11-10T14:43:05Z", "author": {"login": "sberyozkin"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java", "diffHunk": "@@ -199,7 +201,7 @@ private TenantConfigContext createTenantContext(Vertx vertx, OidcTenantConfig oi\n             options.setProxyOptions(proxyOpt.get());\n         }\n \n-        if (oidcConfig.tls.verification == Verification.NONE) {\n+        if (oidcConfig.tls.verification == Verification.NONE || tlsConfig.trustAll) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa"}, "originalPosition": 52}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/fc312a2a3d0d31c6e4009edcaaae7a1635bff1fa", "committedDate": "2020-11-03T20:10:28Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "70e460e9971a29066b704b14cfa6574204ba718a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/70e460e9971a29066b704b14cfa6574204ba718a", "committedDate": "2020-11-10T15:06:43Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70e460e9971a29066b704b14cfa6574204ba718a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/70e460e9971a29066b704b14cfa6574204ba718a", "committedDate": "2020-11-10T15:06:43Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "36364395696c6d5e661b80c9d89bafd2e43d9b87", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/36364395696c6d5e661b80c9d89bafd2e43d9b87", "committedDate": "2020-11-10T15:26:14Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36364395696c6d5e661b80c9d89bafd2e43d9b87", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/36364395696c6d5e661b80c9d89bafd2e43d9b87", "committedDate": "2020-11-10T15:26:14Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "2a99722c47338c190fc91c005d3185540299f441", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/2a99722c47338c190fc91c005d3185540299f441", "committedDate": "2020-11-11T20:22:38Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a99722c47338c190fc91c005d3185540299f441", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/2a99722c47338c190fc91c005d3185540299f441", "committedDate": "2020-11-11T20:22:38Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "625fcd4a08906ea054d759dd749013ec8d766071", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/625fcd4a08906ea054d759dd749013ec8d766071", "committedDate": "2020-11-16T16:29:10Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "625fcd4a08906ea054d759dd749013ec8d766071", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/625fcd4a08906ea054d759dd749013ec8d766071", "committedDate": "2020-11-16T16:29:10Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "5744ce388470a1fe280e0278a854f13e81e0683a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/5744ce388470a1fe280e0278a854f13e81e0683a", "committedDate": "2020-11-17T09:45:07Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5744ce388470a1fe280e0278a854f13e81e0683a", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/5744ce388470a1fe280e0278a854f13e81e0683a", "committedDate": "2020-11-17T09:45:07Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "618c3fe0877de5976d9be48aa81ce9d05339806f", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/618c3fe0877de5976d9be48aa81ce9d05339806f", "committedDate": "2020-11-17T13:23:58Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNDE5NTc5", "url": "https://github.com/quarkusio/quarkus/pull/9855#pullrequestreview-532419579", "createdAt": "2020-11-17T14:31:12Z", "commit": {"oid": "618c3fe0877de5976d9be48aa81ce9d05339806f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4896db2a8276506964fa4d031211f63c97655d5", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/b4896db2a8276506964fa4d031211f63c97655d5", "committedDate": "2020-11-17T14:35:52Z", "message": "Add global quarkus.tls.trust-all configuration property"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "618c3fe0877de5976d9be48aa81ce9d05339806f", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/618c3fe0877de5976d9be48aa81ce9d05339806f", "committedDate": "2020-11-17T13:23:58Z", "message": "Add global quarkus.tls.trust-all configuration property"}, "afterCommit": {"oid": "b4896db2a8276506964fa4d031211f63c97655d5", "author": {"user": {"login": "glefloch", "name": "Guillaume Le Floch"}}, "url": "https://github.com/quarkusio/quarkus/commit/b4896db2a8276506964fa4d031211f63c97655d5", "committedDate": "2020-11-17T14:35:52Z", "message": "Add global quarkus.tls.trust-all configuration property"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4310, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}