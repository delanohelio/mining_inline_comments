{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMDU5MDUx", "number": 13296, "title": "Introduce cache injection and NoOpCache", "bodyText": "This PR lays some groundwork for the programmatic caching API (#8140). The vast majority of the changes here come from #8631 and has been discussed there already. I recently added NoOpCache which hasn't been reviewed though.\nSo why create a new PR instead of keeping all this in #8631? For two reasons:\n\nI had a talk yesterday with @phillip-kruger about some enhancements (stats for example) he wanted to submit for the cache extension and these enhancements require the ability to inject a cache (which was already developed in #8631).\nMost of this PR content is about internal implementation, it only contains one annotation and two interfaces which will be part of the programmatic API: @CacheName , Cache and CacheManager. I didn't put in this PR any of the API methods from #8631 related to cached data (data retrieval or invalidation) since it was still being discussed. That's why the Cache interface is empty for now. @phillip-kruger will probably be the first one to add a method in this interface.\n\nThis PR does not change anything in terms of behaviour for the annotations caching API when the extension is enabled. When it is disabled, the only change is the introduction of NoOpCache. The old way to disable the extension at build time wasn't compatible with the programmatic API, hence this new type of cache.\nThis PR does not contain any change to the doc, that's intentional. I don't think we should document the programmatic API or the ability to inject a cache before there is at least one method in the Cache interface.\nI think this can be merged even if #8631 is still a WIP with a few open discussions as long as @CacheName , Cache and CacheManager are accepted as new members of the undocumented caching API (it seemed OK in #8631).", "createdAt": "2020-11-14T20:53:12Z", "url": "https://github.com/quarkusio/quarkus/pull/13296", "merged": true, "mergeCommit": {"oid": "3f816ad7bbda7afbc2dc88de46987c41b8e35b39"}, "closed": true, "closedAt": "2020-12-11T13:07:47Z", "author": {"login": "gwenneg"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcipCvgBqjM5OTY3NzgxNzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlHqAXgFqTU1MDA4MTc2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a52669db6d6d90fdc6de9b10eae157f18b6543bd", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/a52669db6d6d90fdc6de9b10eae157f18b6543bd", "committedDate": "2020-11-14T20:47:11Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "eef343940080c408ae015fc887f7901d396f6f5b", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/eef343940080c408ae015fc887f7901d396f6f5b", "committedDate": "2020-11-14T21:28:31Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eef343940080c408ae015fc887f7901d396f6f5b", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/eef343940080c408ae015fc887f7901d396f6f5b", "committedDate": "2020-11-14T21:28:31Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "97755312c16e510fcdce953f31c062967c7ce87a", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/97755312c16e510fcdce953f31c062967c7ce87a", "committedDate": "2020-11-23T22:03:52Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "97755312c16e510fcdce953f31c062967c7ce87a", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/97755312c16e510fcdce953f31c062967c7ce87a", "committedDate": "2020-11-23T22:03:52Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "35212e59210903193fdcdfd2b175c9e4d6977d08", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/35212e59210903193fdcdfd2b175c9e4d6977d08", "committedDate": "2020-11-25T20:00:34Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDc1ODUw", "url": "https://github.com/quarkusio/quarkus/pull/13296#pullrequestreview-539475850", "createdAt": "2020-11-26T17:17:05Z", "commit": {"oid": "35212e59210903193fdcdfd2b175c9e4d6977d08"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNzoxNzowNVrOH6jRCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNzoxNzowNVrOH6jRCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE1NzI1Ng==", "bodyText": "You allow it for methods here but you don't check the method case in the processor. Is it normal?", "url": "https://github.com/quarkusio/quarkus/pull/13296#discussion_r531157256", "createdAt": "2020-11-26T17:17:05Z", "author": {"login": "gsmet"}, "path": "extensions/cache/runtime/src/main/java/io/quarkus/cache/CacheName.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package io.quarkus.cache;\n+\n+import static java.lang.annotation.ElementType.FIELD;\n+import static java.lang.annotation.ElementType.METHOD;\n+import static java.lang.annotation.ElementType.PARAMETER;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+import javax.enterprise.util.Nonbinding;\n+import javax.inject.Qualifier;\n+\n+/**\n+ * <p>\n+ * Use this annotation to inject a {@link Cache} and interact with it programmatically.\n+ * </p>\n+ * <p>\n+ * Code example:\n+ * \n+ * <pre>\n+ * {@literal @}ApplicationScoped\n+ * public class CachedService {\n+ * \n+ *     {@literal @}CacheName(\"my-cache\")\n+ *     Cache cache;\n+ *     \n+ *     // Interact with the cache.\n+ * }\n+ * </pre>\n+ * </p>\n+ * \n+ * @see CacheManager\n+ */\n+@Qualifier\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target({ FIELD, METHOD, PARAMETER })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35212e59210903193fdcdfd2b175c9e4d6977d08"}, "originalPosition": 37}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35212e59210903193fdcdfd2b175c9e4d6977d08", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/35212e59210903193fdcdfd2b175c9e4d6977d08", "committedDate": "2020-11-25T20:00:34Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "committedDate": "2020-12-10T18:07:48Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/b3b6e0f114dce6f92f83103ed3521a42ef17c9c4", "committedDate": "2020-12-10T18:07:48Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "33288856544881f3819eca74ba454ef2149bb1a7", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/33288856544881f3819eca74ba454ef2149bb1a7", "committedDate": "2020-12-11T00:02:05Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "committedDate": "2020-12-11T08:30:19Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33288856544881f3819eca74ba454ef2149bb1a7", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/33288856544881f3819eca74ba454ef2149bb1a7", "committedDate": "2020-12-11T00:02:05Z", "message": "Introduce cache injection and NoOpCache"}, "afterCommit": {"oid": "ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "author": {"user": {"login": "gwenneg", "name": "Gwenneg Lepage"}}, "url": "https://github.com/quarkusio/quarkus/commit/ddd838252c0670dc2bfca48b0f91eb9d636d66e6", "committedDate": "2020-12-11T08:30:19Z", "message": "Introduce cache injection and NoOpCache"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDgxNzY3", "url": "https://github.com/quarkusio/quarkus/pull/13296#pullrequestreview-550081767", "createdAt": "2020-12-11T13:07:40Z", "commit": {"oid": "ddd838252c0670dc2bfca48b0f91eb9d636d66e6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1379, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}