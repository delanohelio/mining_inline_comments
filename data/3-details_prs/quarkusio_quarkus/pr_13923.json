{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxMTc2NDEw", "number": 13923, "title": "ArC - make it possible to exclude interceptors, bindings, qualifiers, etc.", "bodyText": "and stereotypes from discovery via \"quarkus.arc.exclude-types\"\n\ncurrently only bean classes are excluded", "createdAt": "2020-12-16T13:46:26Z", "url": "https://github.com/quarkusio/quarkus/pull/13923", "merged": true, "mergeCommit": {"oid": "b06c505cee4fdc40e4a4f7ecb9970500fa0c977a"}, "closed": true, "closedAt": "2020-12-18T13:52:31Z", "author": {"login": "mkouba"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmvZszABqjQxMTk4MzAwNzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnDYZtgFqTU1NDU5MjY5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "513e9ca0bc088f5389081939f27e770e7ea2a1f5", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/513e9ca0bc088f5389081939f27e770e7ea2a1f5", "committedDate": "2020-12-16T13:45:15Z", "message": "ArC - make it possible to exclude interceptors, bindings, qualifiers...\n\nand stereotypes from discovery via \"quarkus.arc.exclude-types\"\n- currently only bean classes are excluded"}, "afterCommit": {"oid": "1fd216be2b0ad203f5040c73b237428f5894a229", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/1fd216be2b0ad203f5040c73b237428f5894a229", "committedDate": "2020-12-16T13:59:48Z", "message": "ArC - make it possible to exclude interceptors, bindings, qualifiers...\n\nand stereotypes from discovery via \"quarkus.arc.exclude-types\"\n- currently only bean classes are excluded"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0NTIwOTYy", "url": "https://github.com/quarkusio/quarkus/pull/13923#pullrequestreview-554520962", "createdAt": "2020-12-17T11:36:29Z", "commit": {"oid": "1fd216be2b0ad203f5040c73b237428f5894a229"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMTozNjoyOVrOIHxgvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMTozNjoyOVrOIHxgvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAyMjE0MA==", "bodyText": "Container annotations are not bindings/qualifiers themselves. This should be left untouched.", "url": "https://github.com/quarkusio/quarkus/pull/13923#discussion_r545022140", "createdAt": "2020-12-17T11:36:29Z", "author": {"login": "manovotn"}, "path": "independent-projects/arc/processor/src/main/java/io/quarkus/arc/processor/BeanDeployment.java", "diffHunk": "@@ -513,31 +513,43 @@ private void buildContextPut(String key, Object value) {\n         }\n     }\n \n-    private static Map<DotName, ClassInfo> findQualifiers(IndexView index) {\n+    private Map<DotName, ClassInfo> findQualifiers(IndexView index) {\n         Map<DotName, ClassInfo> qualifiers = new HashMap<>();\n         for (AnnotationInstance qualifier : index.getAnnotations(DotNames.QUALIFIER)) {\n-            qualifiers.put(qualifier.target().asClass().name(), qualifier.target().asClass());\n+            ClassInfo qualifierClass = qualifier.target().asClass();\n+            if (isExcluded(qualifierClass)) {\n+                continue;\n+            }\n+            qualifiers.put(qualifierClass.name(), qualifierClass);\n         }\n         return qualifiers;\n     }\n \n-    private static Map<DotName, ClassInfo> findContainerAnnotations(Map<DotName, ClassInfo> annotations, IndexView index) {\n+    private Map<DotName, ClassInfo> findContainerAnnotations(Map<DotName, ClassInfo> annotations, IndexView index) {\n         Map<DotName, ClassInfo> containerAnnotations = new HashMap<>();\n         for (ClassInfo annotation : annotations.values()) {\n             AnnotationInstance repeatableMetaAnnotation = annotation.classAnnotation(DotNames.REPEATABLE);\n             if (repeatableMetaAnnotation != null) {\n                 DotName containerAnnotationName = repeatableMetaAnnotation.value().asClass().name();\n-                containerAnnotations.put(containerAnnotationName, getClassByName(index, containerAnnotationName));\n+                ClassInfo containerClass = getClassByName(index, containerAnnotationName);\n+                if (isExcluded(containerClass)) {\n+                    continue;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd216be2b0ad203f5040c73b237428f5894a229"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5690c0573fb866f074f831e67eafb0e3cbe32f59", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/5690c0573fb866f074f831e67eafb0e3cbe32f59", "committedDate": "2020-12-17T12:53:30Z", "message": "ArC - make it possible to exclude interceptors, bindings, qualifiers...\n\nand stereotypes from discovery via \"quarkus.arc.exclude-types\"\n- currently only bean classes are excluded"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1fd216be2b0ad203f5040c73b237428f5894a229", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/1fd216be2b0ad203f5040c73b237428f5894a229", "committedDate": "2020-12-16T13:59:48Z", "message": "ArC - make it possible to exclude interceptors, bindings, qualifiers...\n\nand stereotypes from discovery via \"quarkus.arc.exclude-types\"\n- currently only bean classes are excluded"}, "afterCommit": {"oid": "5690c0573fb866f074f831e67eafb0e3cbe32f59", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/5690c0573fb866f074f831e67eafb0e3cbe32f59", "committedDate": "2020-12-17T12:53:30Z", "message": "ArC - make it possible to exclude interceptors, bindings, qualifiers...\n\nand stereotypes from discovery via \"quarkus.arc.exclude-types\"\n- currently only bean classes are excluded"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0NTkyNjkx", "url": "https://github.com/quarkusio/quarkus/pull/13923#pullrequestreview-554592691", "createdAt": "2020-12-17T13:16:39Z", "commit": {"oid": "5690c0573fb866f074f831e67eafb0e3cbe32f59"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4205, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}