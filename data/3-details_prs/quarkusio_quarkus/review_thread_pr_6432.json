{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NzE1NDEz", "number": 6432, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMTo0MDo1MlrODWOYYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMTo0MToyNFrODWOY4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0NjMwODgzOnYy", "diffSide": "RIGHT", "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceHandleImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMTo0MDo1MlrOFa3G9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMjozMjo1MlrOFa4IPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcxMDE5Ng==", "bodyText": "getActiveContext can return null if no context is active, we should probably check that.", "url": "https://github.com/quarkusio/quarkus/pull/6432#discussion_r363710196", "createdAt": "2020-01-07T11:40:52Z", "author": {"login": "manovotn"}, "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceHandleImpl.java", "diffHunk": "@@ -61,10 +60,14 @@ public T get() {\n     @Override\n     public void destroy() {\n         if (instance != null && destroyed.compareAndSet(false, true)) {\n-            if (bean.getScope().equals(Dependent.class)) {\n-                destroyInternal();\n+            if (destroyLogic != null) {\n+                destroyLogic.accept(instance);\n             } else {\n-                Arc.container().getActiveContext(bean.getScope()).destroy(bean);\n+                if (bean.getScope().equals(Dependent.class)) {\n+                    destroyInternal();\n+                } else {\n+                    Arc.container().getActiveContext(bean.getScope()).destroy(bean);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae660fe701c7d460a2311c3edc62003e5a6394df"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcyNjkxMA==", "bodyText": "Good point. I did not check the existing code...", "url": "https://github.com/quarkusio/quarkus/pull/6432#discussion_r363726910", "createdAt": "2020-01-07T12:32:52Z", "author": {"login": "mkouba"}, "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceHandleImpl.java", "diffHunk": "@@ -61,10 +60,14 @@ public T get() {\n     @Override\n     public void destroy() {\n         if (instance != null && destroyed.compareAndSet(false, true)) {\n-            if (bean.getScope().equals(Dependent.class)) {\n-                destroyInternal();\n+            if (destroyLogic != null) {\n+                destroyLogic.accept(instance);\n             } else {\n-                Arc.container().getActiveContext(bean.getScope()).destroy(bean);\n+                if (bean.getScope().equals(Dependent.class)) {\n+                    destroyInternal();\n+                } else {\n+                    Arc.container().getActiveContext(bean.getScope()).destroy(bean);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcxMDE5Ng=="}, "originalCommit": {"oid": "ae660fe701c7d460a2311c3edc62003e5a6394df"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0NjMxMDA5OnYy", "diffSide": "RIGHT", "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMTo0MToyNFrOFa3HuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxMzozNjowN1rOFa5ggg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcxMDM5Mw==", "bodyText": "Why Object, the instance should still be of type T, right?", "url": "https://github.com/quarkusio/quarkus/pull/6432#discussion_r363710393", "createdAt": "2020-01-07T11:41:24Z", "author": {"login": "manovotn"}, "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceImpl.java", "diffHunk": "@@ -120,7 +113,7 @@ public boolean isAmbiguous() {\n     }\n \n     @Override\n-    public void destroy(T instance) {\n+    public void destroy(Object instance) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae660fe701c7d460a2311c3edc62003e5a6394df"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcyNzI0MA==", "bodyText": "Because of the generics hell... yes, it should be T but it should be safe use Object too and it simplifies the code a little bit.", "url": "https://github.com/quarkusio/quarkus/pull/6432#discussion_r363727240", "createdAt": "2020-01-07T12:33:56Z", "author": {"login": "mkouba"}, "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceImpl.java", "diffHunk": "@@ -120,7 +113,7 @@ public boolean isAmbiguous() {\n     }\n \n     @Override\n-    public void destroy(T instance) {\n+    public void destroy(Object instance) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcxMDM5Mw=="}, "originalCommit": {"oid": "ae660fe701c7d460a2311c3edc62003e5a6394df"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzc0OTUwNg==", "bodyText": "Yea, Object works too. It's just that I saw T everywhere else, so this struck me as weird :)", "url": "https://github.com/quarkusio/quarkus/pull/6432#discussion_r363749506", "createdAt": "2020-01-07T13:36:07Z", "author": {"login": "manovotn"}, "path": "independent-projects/arc/runtime/src/main/java/io/quarkus/arc/impl/InstanceImpl.java", "diffHunk": "@@ -120,7 +113,7 @@ public boolean isAmbiguous() {\n     }\n \n     @Override\n-    public void destroy(T instance) {\n+    public void destroy(Object instance) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzcxMDM5Mw=="}, "originalCommit": {"oid": "ae660fe701c7d460a2311c3edc62003e5a6394df"}, "originalPosition": 71}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1305, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}