{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxMDkyOTky", "number": 13918, "title": "Add GenericType to the signature of ServerMessageBodyWriter methods", "bodyText": "This is done in a way that doesn't make us look up the types using generics\nThe instigator for this was that Qson needs this generic type", "createdAt": "2020-12-16T11:23:19Z", "url": "https://github.com/quarkusio/quarkus/pull/13918", "merged": true, "mergeCommit": {"oid": "c4b2e77b7787bcd70c58923f4614640b2320f7fa"}, "closed": true, "closedAt": "2020-12-16T16:28:44Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmtJ_iAH2gAyNTQxMDkyOTkyOjQzNDQwNGI5ZjZmY2VkN2U0ZDE3NzU3OTIyYzQ0YzE2ZTlhYzEzMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmvoiBAFqTU1MzcyNjE4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "434404b9f6fced7e4d17757922c44c16e9ac1310", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/434404b9f6fced7e4d17757922c44c16e9ac1310", "committedDate": "2020-12-16T11:23:00Z", "message": "Add GenericType to the signature of ServerMessageBodyWriter methods\n\nThis is done in a way that doesn't make us look up the types using generics\n\nThe instigator for this was that Qson needs this generic type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNjcyNzM0", "url": "https://github.com/quarkusio/quarkus/pull/13918#pullrequestreview-553672734", "createdAt": "2020-12-16T13:14:45Z", "commit": {"oid": "2e3836b28cfba69703ad41b7a963c3a48cc1b8f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxMzoxNDo0NVrOIHEtLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxMzoxNDo0NVrOIHEtLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDI4ODA0NA==", "bodyText": "Perhaps currentClass.typeParameters() can be extracted to a local variable here", "url": "https://github.com/quarkusio/quarkus/pull/13918#discussion_r544288044", "createdAt": "2020-12-16T13:14:45Z", "author": {"login": "gastaldi"}, "path": "independent-projects/resteasy-reactive/common/processor/src/main/java/org/jboss/resteasy/reactive/common/processor/EndpointIndexer.java", "diffHunk": "@@ -609,29 +618,40 @@ protected static String toClassName(Type indexType, ClassInfo currentClass, Clas\n                 if (typeVariable.bounds().isEmpty()) {\n                     return Object.class.getName();\n                 }\n-                int pos = -1;\n-                for (int i = 0; i < currentClass.typeParameters().size(); ++i) {\n-                    if (currentClass.typeParameters().get(i).identifier().equals(typeVariable.identifier())) {\n-                        pos = i;\n-                        break;\n-                    }\n-                }\n-                if (pos != -1) {\n-                    List<Type> params = JandexUtil.resolveTypeParameters(actualEndpointClass.name(), currentClass.name(),\n-                            indexView);\n \n-                    Type resolved = params.get(pos);\n-                    if (resolved.kind() != Type.Kind.TYPE_VARIABLE\n-                            || !resolved.asTypeVariable().identifier().equals(typeVariable.identifier())) {\n-                        return toClassName(resolved, currentClass, actualEndpointClass, indexView);\n-                    }\n-                }\n-                return toClassName(typeVariable.bounds().get(0), currentClass, actualEndpointClass, indexView);\n+                return toClassName(resolveTypeVariable(typeVariable, currentClass, actualEndpointClass, indexView),\n+                        currentClass, actualEndpointClass, indexView);\n             default:\n                 throw new RuntimeException(\"Unknown parameter type \" + indexType);\n         }\n     }\n \n+    private static Type resolveTypeVariable(TypeVariable typeVariable, ClassInfo currentClass, ClassInfo actualEndpointClass,\n+            IndexView indexView) {\n+        if (typeVariable.bounds().isEmpty()) {\n+            return Type.create(DotName.createSimple(Object.class.getName()), Kind.CLASS);\n+        }\n+        int pos = -1;\n+        for (int i = 0; i < currentClass.typeParameters().size(); ++i) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e3836b28cfba69703ad41b7a963c3a48cc1b8f0"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e3836b28cfba69703ad41b7a963c3a48cc1b8f0", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/2e3836b28cfba69703ad41b7a963c3a48cc1b8f0", "committedDate": "2020-12-16T12:31:25Z", "message": "Resolve type variable if it's used as a return type\n\nThis was encountered when trying to run of the Qson tests against RESTEasy Reactive"}, "afterCommit": {"oid": "02f36ded060d2578847098677f0ee42472491db1", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/02f36ded060d2578847098677f0ee42472491db1", "committedDate": "2020-12-16T13:19:17Z", "message": "Resolve type variable if it's used as a return type\n\nThis was encountered when trying to run of the Qson tests against RESTEasy Reactive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0991068251a44e37fcef7cc0da6ce01b05698d8", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/e0991068251a44e37fcef7cc0da6ce01b05698d8", "committedDate": "2020-12-16T14:05:34Z", "message": "Resolve type variable if it \u03b9s used as a return type in RESTEasy Reactive\n\nThis was encountered when trying to run of the Qson tests against RESTEasy Reactive"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02f36ded060d2578847098677f0ee42472491db1", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/02f36ded060d2578847098677f0ee42472491db1", "committedDate": "2020-12-16T13:19:17Z", "message": "Resolve type variable if it's used as a return type\n\nThis was encountered when trying to run of the Qson tests against RESTEasy Reactive"}, "afterCommit": {"oid": "e0991068251a44e37fcef7cc0da6ce01b05698d8", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/e0991068251a44e37fcef7cc0da6ce01b05698d8", "committedDate": "2020-12-16T14:05:34Z", "message": "Resolve type variable if it \u03b9s used as a return type in RESTEasy Reactive\n\nThis was encountered when trying to run of the Qson tests against RESTEasy Reactive"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNzI2MTgz", "url": "https://github.com/quarkusio/quarkus/pull/13918#pullrequestreview-553726183", "createdAt": "2020-12-16T14:16:10Z", "commit": {"oid": "e0991068251a44e37fcef7cc0da6ce01b05698d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4201, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}