{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MDc2MTQ3", "number": 11429, "title": "Hibernate Validator: don't skip interface annotation lookup if impl method has annotations", "bodyText": "Fixes #11341 (the main problem, not the 400 vs. 500 problem).\nThis basically just drops the method.annotations().isEmpty() check in MethodValidatedAnnotationsTransformer.\nBefore this fix the added test yielded:\n[ERROR] Failures:\n[ERROR]   HibernateValidatorFunctionalityTest.testRestEndPointInterfaceValidationWithAnnotationOnImplMethod:93 1 expectation failed.\nExpected status code <500> but was <200>.\n\nTurns out that the custom annotation does indeed have to be annotated with @InterceptorBinding, otherwise the test will not show the behaviour as reported in #11341 (results in 400 instead of 200). I did not dig deeper to find out why this makes a difference (maybe some jandex thing).", "createdAt": "2020-08-17T21:26:31Z", "url": "https://github.com/quarkusio/quarkus/pull/11429", "merged": true, "mergeCommit": {"oid": "f7aef7ca5029b46b0eec7c5fa36b08d69c824449"}, "closed": true, "closedAt": "2020-08-18T15:27:31Z", "author": {"login": "famod"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_5WL8AFqTQ2ODg0NzA5Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAIum3gFqTQ2OTU2OTY4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4ODQ3MDky", "url": "https://github.com/quarkusio/quarkus/pull/11429#pullrequestreview-468847092", "createdAt": "2020-08-17T21:32:07Z", "commit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjowN1rOHB7lEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjowN1rOHB7lEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA==", "bodyText": "So we could discuss this 400 vs. 500 problem in this PR (as suggested here: #11341 (comment)) or we could do it separately (Zulip?).\nThe main challenge I see is that MethodValidatedAnnotationsTransformer is only aware of a single transformation target at a time but to check potentially present interfaces for JAX-RS annotations, the transformer needs MethodInfo/ClassInfo for those interfaces.\nI guess the constructor of MethodValidatedAnnotationsTransformer has to be extended with more context...", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r471786768", "createdAt": "2020-08-17T21:32:07Z", "author": {"login": "famod"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b606c2a5bf994fdc29dafecadfc2929214bf256", "author": {"user": {"login": "famod", "name": "Falko Modler"}}, "url": "https://github.com/quarkusio/quarkus/commit/5b606c2a5bf994fdc29dafecadfc2929214bf256", "committedDate": "2020-08-18T12:10:11Z", "message": "Validation: don't skip iface annotation lookup if impl method has annotation(s)\n\nFixes #11341"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDI1MjY0", "url": "https://github.com/quarkusio/quarkus/pull/11429#pullrequestreview-469425264", "createdAt": "2020-08-18T12:54:05Z", "commit": {"oid": "5b606c2a5bf994fdc29dafecadfc2929214bf256"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTY5Njgw", "url": "https://github.com/quarkusio/quarkus/pull/11429#pullrequestreview-469569680", "createdAt": "2020-08-18T15:27:23Z", "commit": {"oid": "5b606c2a5bf994fdc29dafecadfc2929214bf256"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 800, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}