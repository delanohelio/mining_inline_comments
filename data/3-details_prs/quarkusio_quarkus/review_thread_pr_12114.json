{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MzQzMTg1", "number": 12114, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNjo1OVrOEjpuVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMzowODoyNlrOEkC-dQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODE5MjIzOnYy", "diffSide": "LEFT", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/ContainerAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNjo1OVrOHSH6uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNjo1OVrOHSH6uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2NjEzNw==", "bodyText": "LOL - This really through me off regarding where your AddEnvVarDecorator was being used :)", "url": "https://github.com/quarkusio/quarkus/pull/12114#discussion_r488766137", "createdAt": "2020-09-15T15:36:59Z", "author": {"login": "geoand"}, "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/ContainerAdapter.java", "diffHunk": "@@ -5,7 +5,6 @@\n import io.dekorate.kubernetes.config.Env;\n import io.dekorate.kubernetes.config.Mount;\n import io.dekorate.kubernetes.config.Port;\n-import io.dekorate.kubernetes.decorator.AddEnvVarDecorator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3ff3534346eb63b83431095e71ba04f59f7edde"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODE5NjA2OnYy", "diffSide": "RIGHT", "path": "integration-tests/kubernetes/quarkus-standard-way/src/test/java/io/quarkus/it/kubernetes/KubernetesWithSidecarAndJibTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNTozNzo0OVrOHSH9HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxOTowMDoxNlrOHSQAnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2Njc0OQ==", "bodyText": "Can we also assert that the env vars are not added to the application container?", "url": "https://github.com/quarkusio/quarkus/pull/12114#discussion_r488766749", "createdAt": "2020-09-15T15:37:49Z", "author": {"login": "geoand"}, "path": "integration-tests/kubernetes/quarkus-standard-way/src/test/java/io/quarkus/it/kubernetes/KubernetesWithSidecarAndJibTest.java", "diffHunk": "@@ -91,6 +91,10 @@ private void assertSidecar(io.fabric8.kubernetes.api.model.PodSpec podSpec) {\n                     assertThat(c.getPorts()).singleElement().satisfies(p -> {\n                         assertThat(p.getContainerPort()).isEqualTo(3000);\n                     });\n+                    assertThat(c.getEnv()).singleElement().satisfies(e -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3ff3534346eb63b83431095e71ba04f59f7edde"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg5ODcxOQ==", "bodyText": "Done.", "url": "https://github.com/quarkusio/quarkus/pull/12114#discussion_r488898719", "createdAt": "2020-09-15T19:00:16Z", "author": {"login": "metacosm"}, "path": "integration-tests/kubernetes/quarkus-standard-way/src/test/java/io/quarkus/it/kubernetes/KubernetesWithSidecarAndJibTest.java", "diffHunk": "@@ -91,6 +91,10 @@ private void assertSidecar(io.fabric8.kubernetes.api.model.PodSpec podSpec) {\n                     assertThat(c.getPorts()).singleElement().satisfies(p -> {\n                         assertThat(p.getContainerPort()).isEqualTo(3000);\n                     });\n+                    assertThat(c.getEnv()).singleElement().satisfies(e -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2Njc0OQ=="}, "originalCommit": {"oid": "d3ff3534346eb63b83431095e71ba04f59f7edde"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MjMyOTQ5OnYy", "diffSide": "RIGHT", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/AddEnvVarDecorator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMzowODoyNlrOHSv-9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMzowODoyNlrOHSv-9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQyMjU4Mg==", "bodyText": "I like it!", "url": "https://github.com/quarkusio/quarkus/pull/12114#discussion_r489422582", "createdAt": "2020-09-16T13:08:26Z", "author": {"login": "iocanel"}, "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/AddEnvVarDecorator.java", "diffHunk": "@@ -0,0 +1,30 @@\n+package io.quarkus.kubernetes.deployment;\n+\n+import io.dekorate.deps.kubernetes.api.model.ContainerBuilder;\n+import io.dekorate.kubernetes.config.Env;\n+import io.dekorate.kubernetes.decorator.AddSidecarDecorator;\n+import io.dekorate.kubernetes.decorator.ContainerDecorator;\n+import io.dekorate.kubernetes.decorator.Decorator;\n+import io.dekorate.kubernetes.decorator.ResourceProvidingDecorator;\n+\n+/**\n+ * Delegate to dekorate's version to sidestep the fact that the dekorate version of AddEnvVarDecorator inherits from\n+ * ApplicationContainerDecorator which expects metadata to be present, which doesn't happen in our context. We sidestep the\n+ * issue by wrapping the original behavior and calling its andThenVisit method, which does the work when not skipped.\n+ */\n+public class AddEnvVarDecorator extends Decorator<ContainerBuilder> {\n+    private final io.dekorate.kubernetes.decorator.AddEnvVarDecorator delegate;\n+\n+    public AddEnvVarDecorator(Env env) {\n+        delegate = new io.dekorate.kubernetes.decorator.AddEnvVarDecorator(env);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "473683d9df862183ee5d1f02257bee0920f49734"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 272, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}