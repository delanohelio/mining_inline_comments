{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NjQ5OTMx", "number": 10652, "title": "[Qute] Allow nested content for user defined tags", "bodyText": "Hello.\nHere is a first PR for a quick modification in Qute.\nIt will allow nested content in user defined tags. For a simple example, if I defined tags\\my-tag.html as this :\n<div class=\"{class}\">\n    {nested}\n</div>\nI can then call it this way :\n{#my-tag class='large div'}\n    <b>Hello !</b>\n{\\}\nnested being a special key as it already is.", "createdAt": "2020-07-10T21:22:42Z", "url": "https://github.com/quarkusio/quarkus/pull/10652", "merged": true, "mergeCommit": {"oid": "2ec4c584ecde727c55e66ef2c051a3081a97e4cd"}, "closed": true, "closedAt": "2020-07-20T12:48:06Z", "author": {"login": "jlannoy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1bnbJAFqTQ0OTY2NjUwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2wSVsAFqTQ1MTUzNjU0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjY2NTA4", "url": "https://github.com/quarkusio/quarkus/pull/10652#pullrequestreview-449666508", "createdAt": "2020-07-16T09:14:34Z", "commit": {"oid": "e178825694676811ea170f88c395fbb4a7f1d71b"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNDc4NDM5", "url": "https://github.com/quarkusio/quarkus/pull/10652#pullrequestreview-450478439", "createdAt": "2020-07-17T08:41:01Z", "commit": {"oid": "e178825694676811ea170f88c395fbb4a7f1d71b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwODo0MTowMVrOGzKohg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwODo0MTowMVrOGzKohg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMwNDc3NA==", "bodyText": "Well, this is not a correct approach as the invocation of CompletableFuture.get() blocks. It should not be a big problem in most cases but we do attempt to keep the \"resolution\" part of rendering non-blocking. I need to think about this a little. It seems that our API does not cover this specific use case...", "url": "https://github.com/quarkusio/quarkus/pull/10652#discussion_r456304774", "createdAt": "2020-07-17T08:41:01Z", "author": {"login": "mkouba"}, "path": "independent-projects/qute/core/src/main/java/io/quarkus/qute/UserTagSectionHelper.java", "diffHunk": "@@ -28,8 +30,27 @@ public UserTagSectionHelper(Supplier<Template> templateSupplier, Map<String, Exp\n             if (t1 != null) {\n                 result.completeExceptionally(t1);\n             } else {\n-                // Execute the template with the params as the root context object\n+\n                 try {\n+\n+                    // Execute nested code for later usage in the user tag\n+                    CompletableFuture<ResultNode> nestedResult = new CompletableFuture<>();\n+                    context.execute(context.resolutionContext().createChild(r1, null)).whenComplete((r2, t2) -> {\n+                        if (t2 != null) {\n+                            result.completeExceptionally(t2);\n+                        } else {\n+                            nestedResult.complete(r2);\n+                        }\n+                    });\n+                    if (result.isCompletedExceptionally()) {\n+                        return;\n+                    }\n+\n+                    StringBuilder sb = new StringBuilder();\n+                    nestedResult.get().process((s) -> sb.append(s));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e178825694676811ea170f88c395fbb4a7f1d71b"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "920f490d609f0ceaee458c13f3d31a29b0216e57", "author": {"user": {"login": "jlannoy", "name": "J Lannoy"}}, "url": "https://github.com/quarkusio/quarkus/commit/920f490d609f0ceaee458c13f3d31a29b0216e57", "committedDate": "2020-07-17T14:57:48Z", "message": "Implement nested content for user-defined tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ceb1ecd3fb345bd47b64e3176a64b70a96ef950", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/6ceb1ecd3fb345bd47b64e3176a64b70a96ef950", "committedDate": "2020-07-17T15:01:52Z", "message": "UserTagSectionHelper - non-blocking nested content implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNTM2NTQ0", "url": "https://github.com/quarkusio/quarkus/pull/10652#pullrequestreview-451536544", "createdAt": "2020-07-20T11:53:28Z", "commit": {"oid": "6ceb1ecd3fb345bd47b64e3176a64b70a96ef950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3501, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}