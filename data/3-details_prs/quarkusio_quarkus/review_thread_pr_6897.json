{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MjUxNTQz", "number": 6897, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo0NjozOVrODcCd-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo0NjozOVrODcCd-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNzI3MTYyOnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo0NjozOVrOFj3tlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo1NDoyMVrOFj384w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ==", "bodyText": "Better call process.destroy() in a finally block just in case", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373157271", "createdAt": "2020-01-30T19:46:39Z", "author": {"login": "gastaldi"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzczMA==", "bodyText": "Good idea", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373157730", "createdAt": "2020-01-30T19:47:38Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ=="}, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1OTQxNw==", "bodyText": "Done", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373159417", "createdAt": "2020-01-30T19:51:02Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ=="}, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1OTY0Ng==", "bodyText": "Maybe have a look at that change by Stuart: #6031 .", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373159646", "createdAt": "2020-01-30T19:51:29Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ=="}, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE2MTE4Nw==", "bodyText": "Hm... In this case we aren't really reading anything from the process output, we just want to wait for it, so I don't think the change is needed, right?", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373161187", "createdAt": "2020-01-30T19:54:21Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ=="}, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1061, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}