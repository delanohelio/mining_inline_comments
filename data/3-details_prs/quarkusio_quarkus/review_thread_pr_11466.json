{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMTU2Nzcw", "number": 11466, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMzowMjoxMVrOEaM_EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMzowMjoxMVrOEaM_EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1OTExMTg0OnYy", "diffSide": "RIGHT", "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMzowMjoxMVrOHDe1Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMTozNzozN1rOHD81Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    || resolvedContext.oidcConfig.roles.source.isPresent()\n          \n          \n            \n                                            && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n          \n          \n            \n                                    || (resolvedContext.oidcConfig.roles.source.isPresent()\n          \n          \n            \n                                            && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken))) {", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473412890", "createdAt": "2020-08-19T23:02:11Z", "author": {"login": "gastaldi"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxNDQ3Nw==", "bodyText": "You can also write\nresolvedContext.oidcConfig.roles.source.orElse(null) == Source.accesstoken\n\nif you want to simplify it \ud83d\ude09", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473414477", "createdAt": "2020-08-19T23:04:25Z", "author": {"login": "gastaldi"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA=="}, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg0MzI5Nw==", "bodyText": "HI @gastaldi That is not a bug AFAIK, the && expression takes priority over ||, agreed ?", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473843297", "createdAt": "2020-08-20T10:07:02Z", "author": {"login": "sberyozkin"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA=="}, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg0NDAwMA==", "bodyText": "HI @gastaldi That is not a bug AFAIK, the && expression takes priority over ||, agreed ?", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473844000", "createdAt": "2020-08-20T10:07:53Z", "author": {"login": "sberyozkin"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA=="}, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1MDM4Ng==", "bodyText": "@gastaldi but I'll just commit resolvedContext.oidcConfig.roles.source.orElse(null) == Source.accesstoken though as it will simplify the expression :-)", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473850386", "createdAt": "2020-08-20T10:15:30Z", "author": {"login": "sberyozkin"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA=="}, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkwNDQ2Ng==", "bodyText": "HI @gastaldi That is not a bug AFAIK, the && expression takes priority over ||, agreed ?\n\nAh yes, I forgot this minor detail, but the actual code looks better now \ud83d\ude09", "url": "https://github.com/quarkusio/quarkus/pull/11466#discussion_r473904466", "createdAt": "2020-08-20T11:37:37Z", "author": {"login": "gastaldi"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcIdentityProvider.java", "diffHunk": "@@ -79,7 +79,8 @@ public SecurityIdentity get() {\n \n         if (request.getToken() instanceof IdTokenCredential\n                 && (resolvedContext.oidcConfig.authentication.verifyAccessToken\n-                        || resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {\n+                        || resolvedContext.oidcConfig.roles.source.isPresent()\n+                                && resolvedContext.oidcConfig.roles.source.get() == Source.accesstoken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQxMjg5MA=="}, "originalCommit": {"oid": "210885bb799ed72e021446b19e96204dcf48cfea"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 604, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}