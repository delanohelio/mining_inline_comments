{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NzI4NDc2", "number": 7777, "title": "fix: container-image integration with knative", "bodyText": "Fixes: #7736\nThe generated resources for knative are lacking container names.\nThis means that all container specific decorators are broken.\nUntil, this is addressed in Dekorate itself, this pull request adds the missing name.\nThe pr also includes integration test for the issue as described in #7736.", "createdAt": "2020-03-11T14:36:51Z", "url": "https://github.com/quarkusio/quarkus/pull/7777", "merged": true, "mergeCommit": {"oid": "da0c5fb12f1b2fcc52afabc80fbd22c06cbea038"}, "closed": true, "closedAt": "2020-03-12T12:10:46Z", "author": {"login": "iocanel"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM2hhsAH2gAyMzg2NzI4NDc2OjBhODc3Zjg4ZjBhMTA2ZDhiY2MwOGM1ZGZhOTQ1YjViZGE2NzM4OTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcM6nG5gFqTM3MzQ5OTg5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891", "author": {"user": {"login": "iocanel", "name": "Ioannis Canellos"}}, "url": "https://github.com/quarkusio/quarkus/commit/0a877f88f0a106d8bcc08c5dfa945b5bda673891", "committedDate": "2020-03-12T07:24:40Z", "message": "fix: container-image integration with knative"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bed6a214b29d901cdb7e5deecbdcd0f089407010", "author": {"user": {"login": "iocanel", "name": "Ioannis Canellos"}}, "url": "https://github.com/quarkusio/quarkus/commit/bed6a214b29d901cdb7e5deecbdcd0f089407010", "committedDate": "2020-03-11T14:34:04Z", "message": "fix: container-image integration with knative"}, "afterCommit": {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891", "author": {"user": {"login": "iocanel", "name": "Ioannis Canellos"}}, "url": "https://github.com/quarkusio/quarkus/commit/0a877f88f0a106d8bcc08c5dfa945b5bda673891", "committedDate": "2020-03-12T07:24:40Z", "message": "fix: container-image integration with knative"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNDk5MTIy", "url": "https://github.com/quarkusio/quarkus/pull/7777#pullrequestreview-373499122", "createdAt": "2020-03-12T12:09:06Z", "commit": {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjowOTowNlrOF1b-Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjowOTowNlrOF1b-Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU3NzE0Mw==", "bodyText": "Nice improvement :)", "url": "https://github.com/quarkusio/quarkus/pull/7777#discussion_r391577143", "createdAt": "2020-03-12T12:09:06Z", "author": {"login": "geoand"}, "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesProcessor.java", "diffHunk": "@@ -374,14 +374,13 @@ private void applyBuildItems(Session session,\n         String openshiftName = openshiftConfig.name.orElse(name);\n         String knativeName = knativeConfig.name.orElse(name);\n \n-        containerImageBuildItem.ifPresent(\n-                c -> session.resources().decorate(KUBERNETES, new ApplyContainerImageDecorator(kubernetesName, c.getImage())));\n-        containerImageBuildItem\n-                .ifPresent(c -> session.resources().decorate(OPENSHIFT,\n-                        new ApplyContainerImageDecorator(openshiftName, c.getImage())));\n-        containerImageBuildItem\n-                .ifPresent(c -> session.resources().decorate(KNATIVE,\n-                        new ApplyContainerImageDecorator(knativeName, c.getImage())));\n+        session.resources().decorate(KNATIVE, new AddMissingContainerNameDecorator(knativeName, knativeName));\n+\n+        containerImageBuildItem.ifPresent(c -> {\n+            session.resources().decorate(OPENSHIFT, new ApplyContainerImageDecorator(openshiftName, c.getImage()));\n+            session.resources().decorate(KUBERNETES, new ApplyContainerImageDecorator(kubernetesName, c.getImage()));\n+            session.resources().decorate(KNATIVE, new ApplyContainerImageDecorator(knativeName, c.getImage()));\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNDk5ODk4", "url": "https://github.com/quarkusio/quarkus/pull/7777#pullrequestreview-373499898", "createdAt": "2020-03-12T12:10:23Z", "commit": {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3824, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}