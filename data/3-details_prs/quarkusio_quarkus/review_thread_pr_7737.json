{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTc3ODI5", "number": 7737, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxMzo1NVrODmwHww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxODo1NVrODmwQTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxOTYwODk5OnYy", "diffSide": "RIGHT", "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxMzo1NVrOF0WSPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoyMjoxNVrOF0WpNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzNTM4OQ==", "bodyText": "Should the FIXME be removed?", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390435389", "createdAt": "2020-03-10T16:13:55Z", "author": {"login": "Sanne"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ0MTI2OQ==", "bodyText": "ah yes :)", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390441269", "createdAt": "2020-03-10T16:22:15Z", "author": {"login": "FroMage"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzNTM4OQ=="}, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxOTYzMDg3OnYy", "diffSide": "RIGHT", "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxODo1NVrOF0Wfww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoyMjowOFrOF0Woxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzODg1MQ==", "bodyText": "the code owner.replace('/', '.')) could be extracted since you need it twice?\nWhile at it, might be useful to extract the regex into a constant? Entirely optional of course: I'm aware I'm nitpicking.", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390438851", "createdAt": "2020-03-10T16:18:55Z", "author": {"login": "Sanne"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?\n         if ((opcode == Opcodes.GETFIELD\n                 || opcode == Opcodes.PUTFIELD)\n+                // if we're in the constructor, do not replace field accesses to this type and its supertypes\n+                // otherwise we risk running setters that depend on initialisation\n+                && (!this.methodName.equals(\"<init>\")\n+                        || !targetIsInHierarchy(this.owner.replace('/', '.'), owner.replace('/', '.')))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQ0MTE1OA==", "bodyText": "It's not a regex ;) But I have moved it up.", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390441158", "createdAt": "2020-03-10T16:22:08Z", "author": {"login": "FroMage"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?\n         if ((opcode == Opcodes.GETFIELD\n                 || opcode == Opcodes.PUTFIELD)\n+                // if we're in the constructor, do not replace field accesses to this type and its supertypes\n+                // otherwise we risk running setters that depend on initialisation\n+                && (!this.methodName.equals(\"<init>\")\n+                        || !targetIsInHierarchy(this.owner.replace('/', '.'), owner.replace('/', '.')))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzODg1MQ=="}, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4796, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}