{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2NTEwNTg1", "number": 12462, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoxNjo1MFrOEpniCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzo0MzozOVrOEp0bhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMDc0NzYxOnYy", "diffSide": "RIGHT", "path": "extensions/micrometer/deployment/src/main/java/io/quarkus/micrometer/deployment/binder/mpmetrics/MicroprofileMetricsProcessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoxNjo1MFrOHbZcEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoxNjo1MFrOHbZcEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5MDM4NQ==", "bodyText": "We can't word the warning this way unless/until the smallrye-metrics and micrometer extensions can be enabled at the same time.  What might be better is to warn that the MP Metrics API is being supported in a compatibility mode, which may be subject to change over time. (or something).", "url": "https://github.com/quarkusio/quarkus/pull/12462#discussion_r498490385", "createdAt": "2020-10-01T20:16:50Z", "author": {"login": "ebullient"}, "path": "extensions/micrometer/deployment/src/main/java/io/quarkus/micrometer/deployment/binder/mpmetrics/MicroprofileMetricsProcessor.java", "diffHunk": "@@ -62,6 +62,25 @@ AdditionalBeanBuildItem registerBeanClasses() {\n                 .build();\n     }\n \n+    @BuildStep(onlyIf = MicroprofileMetricsEnabled.class)\n+    void logWarningForMpMetricsUsage(CombinedIndexBuildItem combinedIndexBuildItem) {\n+        IndexView index = combinedIndexBuildItem.getIndex();\n+        boolean mpMetricsPresent = false;\n+\n+        // Find usage of MP Metrics annotations\n+        for (DotName annotation : MetricDotNames.individualMetrics) {\n+            if (index.getAnnotations(annotation).size() > 0) {\n+                mpMetricsPresent = true;\n+                break;\n+            }\n+        }\n+\n+        if (mpMetricsPresent) {\n+            log.warn(\"Use of MicroProfile Metrics annotations with the `quarkus-micrometer` extension in future Quarkus \" +\n+                    \"versions will require using the `quarkus-smallrye-metrics` extension instead.\");\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "194611471e8f2fbde78c7c7794530d1829b10a3c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMDc0ODkxOnYy", "diffSide": "RIGHT", "path": "extensions/micrometer/runtime/src/main/java/io/quarkus/micrometer/runtime/config/MicroprofileMetricsConfig.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoxNzoxN1rOHbZc7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMDoxNzoxN1rOHbZc7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ5MDYwNA==", "bodyText": "Same as above.", "url": "https://github.com/quarkusio/quarkus/pull/12462#discussion_r498490604", "createdAt": "2020-10-01T20:17:17Z", "author": {"login": "ebullient"}, "path": "extensions/micrometer/runtime/src/main/java/io/quarkus/micrometer/runtime/config/MicroprofileMetricsConfig.java", "diffHunk": "@@ -14,15 +14,18 @@\n      * Microprofile Metrics support.\n      * <p>\n      * Support for Microprofile metrics will be enabled if micrometer\n-     * support is enabled, and this value is true. You need to also\n-     * include the microprofile api jar to your dependencies:\n+     * support is enabled and the MicroProfile Metrics dependency is present:\n      *\n      * <pre>\n      * &lt;dependency&gt;\n      *   &lt;groupId&gt;org.eclipse.microprofile.metrics&lt;/groupId&gt;\n      *   &lt;artifactId&gt;microprofile-metrics-api&lt;/artifactId&gt;\n      * &lt;/dependency&gt;\n      * </pre>\n+     * <p>\n+     * Future versions of the micrometer extension will not include compatibility\n+     * for MicroProfile Metrics. A future version will require the\n+     * `quarkus-smallrye-metrics` extension for MicroProfile Metrics APIs with micrometer.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "194611471e8f2fbde78c7c7794530d1829b10a3c"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMjg2MDg1OnYy", "diffSide": "RIGHT", "path": "extensions/micrometer/runtime/src/main/java/io/quarkus/micrometer/runtime/config/MicroprofileMetricsConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzo0MzozOVrOHbuKeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzo1MDowM1rOHbuZmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyOTk0Ng==", "bodyText": "You can probably remove \"This application uses the MP Metrics API.\" from the javadoc.", "url": "https://github.com/quarkusio/quarkus/pull/12462#discussion_r498829946", "createdAt": "2020-10-02T13:43:39Z", "author": {"login": "ebullient"}, "path": "extensions/micrometer/runtime/src/main/java/io/quarkus/micrometer/runtime/config/MicroprofileMetricsConfig.java", "diffHunk": "@@ -14,15 +14,19 @@\n      * Microprofile Metrics support.\n      * <p>\n      * Support for Microprofile metrics will be enabled if micrometer\n-     * support is enabled, and this value is true. You need to also\n-     * include the microprofile api jar to your dependencies:\n+     * support is enabled and the MicroProfile Metrics dependency is present:\n      *\n      * <pre>\n      * &lt;dependency&gt;\n      *   &lt;groupId&gt;org.eclipse.microprofile.metrics&lt;/groupId&gt;\n      *   &lt;artifactId&gt;microprofile-metrics-api&lt;/artifactId&gt;\n      * &lt;/dependency&gt;\n      * </pre>\n+     * <p>\n+     * This application uses the MP Metrics API.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f069ddcd90064fd8e0d663de1644e3a6f59805c0"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzMzgxNw==", "bodyText": "Fixed now", "url": "https://github.com/quarkusio/quarkus/pull/12462#discussion_r498833817", "createdAt": "2020-10-02T13:50:03Z", "author": {"login": "kenfinnigan"}, "path": "extensions/micrometer/runtime/src/main/java/io/quarkus/micrometer/runtime/config/MicroprofileMetricsConfig.java", "diffHunk": "@@ -14,15 +14,19 @@\n      * Microprofile Metrics support.\n      * <p>\n      * Support for Microprofile metrics will be enabled if micrometer\n-     * support is enabled, and this value is true. You need to also\n-     * include the microprofile api jar to your dependencies:\n+     * support is enabled and the MicroProfile Metrics dependency is present:\n      *\n      * <pre>\n      * &lt;dependency&gt;\n      *   &lt;groupId&gt;org.eclipse.microprofile.metrics&lt;/groupId&gt;\n      *   &lt;artifactId&gt;microprofile-metrics-api&lt;/artifactId&gt;\n      * &lt;/dependency&gt;\n      * </pre>\n+     * <p>\n+     * This application uses the MP Metrics API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyOTk0Ng=="}, "originalCommit": {"oid": "f069ddcd90064fd8e0d663de1644e3a6f59805c0"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4338, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}