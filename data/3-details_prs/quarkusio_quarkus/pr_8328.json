{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2OTcyNjg2", "number": 8328, "title": "Upgrade to Hibernate Search 6.0.0.Beta6", "bodyText": "The last commit is not really necessary, but I made this change as I was working on adding more unit tests related to configuration properties... and I then gave up on that.", "createdAt": "2020-04-01T12:46:37Z", "url": "https://github.com/quarkusio/quarkus/pull/8328", "merged": true, "mergeCommit": {"oid": "c446d97ac1305d428c23ace6dc82b5fe8119200b"}, "closed": true, "closedAt": "2020-04-06T10:47:57Z", "author": {"login": "yrodiere"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTdOmLAFqTM4NTg5ODI1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcU8ag_AFqTM4ODEzMjcyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1ODk4MjUz", "url": "https://github.com/quarkusio/quarkus/pull/8328#pullrequestreview-385898253", "createdAt": "2020-04-01T19:48:21Z", "commit": {"oid": "0f8b660bd8df2fd375c7a5f4a3166032972e2d2f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo0ODoyMVrOF_QD4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo1MjowMVrOF_QL0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2Nzc0NA==", "bodyText": "Could you add a short paragraph to describe when one might want to tune this?", "url": "https://github.com/quarkusio/quarkus/pull/8328#discussion_r401867744", "createdAt": "2020-04-01T19:48:21Z", "author": {"login": "Sanne"}, "path": "extensions/hibernate-search-elasticsearch/runtime/src/main/java/io/quarkus/hibernate/search/elasticsearch/runtime/HibernateSearchElasticsearchRuntimeConfig.java", "diffHunk": "@@ -118,6 +119,12 @@\n         @ConfigItem\n         DiscoveryConfig discovery;\n \n+        /**\n+         * Configuration for the thread pool assigned to the backend.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f8b660bd8df2fd375c7a5f4a3166032972e2d2f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2OTc3Nw==", "bodyText": "I'm not entirely sure what a reasonable default would be here - so bear with me as I only know the high level picture.\nI wonder if this is a reasonable value for an high-performance index. But maybe we should default to small and lean for a Quarkus default?", "url": "https://github.com/quarkusio/quarkus/pull/8328#discussion_r401869777", "createdAt": "2020-04-01T19:52:01Z", "author": {"login": "Sanne"}, "path": "extensions/hibernate-search-elasticsearch/runtime/src/main/java/io/quarkus/hibernate/search/elasticsearch/runtime/HibernateSearchElasticsearchRuntimeConfig.java", "diffHunk": "@@ -455,4 +461,30 @@ public String getHibernateSearchString() {\n         @ConfigItem(defaultValueDocumentation = \"10S\")\n         Optional<Duration> requiredStatusWaitTimeout;\n     }\n+\n+    // We can't set actual default values in this section,\n+    // otherwise \"quarkus.hibernate-search.elasticsearch.index-defaults\" will be ignored.\n+    @ConfigGroup\n+    public static class ElasticsearchIndexIndexingConfig {\n+        /**\n+         * The number of indexing queues assigned to each index.\n+         */\n+        // We can't set an actual default value here: see comment on this class.\n+        @ConfigItem(defaultValueDocumentation = \"10\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe5a6154e798f2d907377c738b3cfc5751182824"}, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de09c0463ed3d8a16c5e475429870825718e98b1", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/de09c0463ed3d8a16c5e475429870825718e98b1", "committedDate": "2020-04-02T06:58:25Z", "message": "hsearch-es: Document in more details the indexing settings"}, "afterCommit": {"oid": "a96736cac8806bb2a2f6341e3d334eb59e018ab9", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/a96736cac8806bb2a2f6341e3d334eb59e018ab9", "committedDate": "2020-04-02T07:04:31Z", "message": "hsearch-es: Document in more details the indexing settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NDM1MzUz", "url": "https://github.com/quarkusio/quarkus/pull/8328#pullrequestreview-386435353", "createdAt": "2020-04-02T13:40:02Z", "commit": {"oid": "a96736cac8806bb2a2f6341e3d334eb59e018ab9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMzo0MDowMlrOF_rsmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxMzo0MDowMlrOF_rsmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMyMDUzOQ==", "bodyText": "s/you will likely want/you might want/", "url": "https://github.com/quarkusio/quarkus/pull/8328#discussion_r402320539", "createdAt": "2020-04-02T13:40:02Z", "author": {"login": "Sanne"}, "path": "extensions/hibernate-search-elasticsearch/runtime/src/main/java/io/quarkus/hibernate/search/elasticsearch/runtime/HibernateSearchElasticsearchRuntimeConfig.java", "diffHunk": "@@ -399,18 +419,45 @@ public String getHibernateSearchString() {\n         EntityLoadingCacheLookupStrategy strategy;\n     }\n \n-    // We can't set actual default values in this section,\n-    // otherwise \"quarkus.hibernate-search.elasticsearch.index-defaults\" will be ignored.\n     @ConfigGroup\n-    public static class LifecycleConfig {\n+    public static class SchemaManagementConfig {\n \n         /**\n          * The strategy used for index lifecycle.\n          */\n         // We can't set an actual default value here: see comment on this class.\n-        @ConfigItem(defaultValueDocumentation = \"create\")\n-        Optional<IndexLifecycleStrategyName> strategy;\n+        @ConfigItem(defaultValue = \"create-or-validate\")\n+        SchemaManagementStrategyName strategy;\n+\n+    }\n \n+    @ConfigGroup\n+    public static class ThreadPoolConfig {\n+        /**\n+         * The size of the thread pool assigned to the backend.\n+         * <p>\n+         * Note that number is <em>per backend</em>, not per index.\n+         * Adding more indexes will not add more threads.\n+         * <p>\n+         * As all operations happening in this thread-pool are non-blocking,\n+         * raising its size above the number of processor cores available to the JVM will not bring noticeable performance\n+         * benefit.\n+         * The only reason to alter this setting would be to reduce the number of threads;\n+         * for example, in an application with a single index with a single indexing queue,\n+         * running on a machine with 64 processor cores,\n+         * you will likely want to bring the number of threads to a more reasonable number like 1 or 4.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a96736cac8806bb2a2f6341e3d334eb59e018ab9"}, "originalPosition": 94}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf405091c4327e654b3ed21b3233b632f8e8bc70", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/cf405091c4327e654b3ed21b3233b632f8e8bc70", "committedDate": "2020-04-02T13:48:01Z", "message": "hsearch-es: Upgrade to Hibernate Search 6.0.0.Beta6"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b485d96d13a9a4c11ea676c34dc7ba5d238c036", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/7b485d96d13a9a4c11ea676c34dc7ba5d238c036", "committedDate": "2020-04-02T13:48:01Z", "message": "hsearch-es: Add an option to configure the thread pool size"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92c6e409d56e97e90cd2d7247d9e8ec42a7201b1", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/92c6e409d56e97e90cd2d7247d9e8ec42a7201b1", "committedDate": "2020-04-02T13:48:02Z", "message": "hsearch-es: Add options to configure indexing queues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "961d95b3b8e02c2c104f6ef2bf96d82f822580c8", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/961d95b3b8e02c2c104f6ef2bf96d82f822580c8", "committedDate": "2020-04-02T13:48:02Z", "message": "hsearch-es: Clarify the name of some unit tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a96736cac8806bb2a2f6341e3d334eb59e018ab9", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/a96736cac8806bb2a2f6341e3d334eb59e018ab9", "committedDate": "2020-04-02T07:04:31Z", "message": "hsearch-es: Document in more details the indexing settings"}, "afterCommit": {"oid": "85fd3eb0ba8963e56818faa3c1ae2a894b34fd38", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/85fd3eb0ba8963e56818faa3c1ae2a894b34fd38", "committedDate": "2020-04-02T13:48:02Z", "message": "hsearch-es: Document in more details the indexing settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "689e440d75f3a8c2a4650beaf52e495743a2f3d0", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/689e440d75f3a8c2a4650beaf52e495743a2f3d0", "committedDate": "2020-04-02T13:53:57Z", "message": "hsearch-es: Document in more details the thread pool size setting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f84f07f3e222640a52b7b7479510833dc9971aa", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/4f84f07f3e222640a52b7b7479510833dc9971aa", "committedDate": "2020-04-02T13:53:58Z", "message": "hsearch-es: Document in more details the indexing settings"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "85fd3eb0ba8963e56818faa3c1ae2a894b34fd38", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/85fd3eb0ba8963e56818faa3c1ae2a894b34fd38", "committedDate": "2020-04-02T13:48:02Z", "message": "hsearch-es: Document in more details the indexing settings"}, "afterCommit": {"oid": "4f84f07f3e222640a52b7b7479510833dc9971aa", "author": {"user": {"login": "yrodiere", "name": "Yoann Rodi\u00e8re"}}, "url": "https://github.com/quarkusio/quarkus/commit/4f84f07f3e222640a52b7b7479510833dc9971aa", "committedDate": "2020-04-02T13:53:58Z", "message": "hsearch-es: Document in more details the indexing settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MTMyNzI5", "url": "https://github.com/quarkusio/quarkus/pull/8328#pullrequestreview-388132729", "createdAt": "2020-04-06T10:46:24Z", "commit": {"oid": "cf405091c4327e654b3ed21b3233b632f8e8bc70"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDo0NjoyNVrOGBSBPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDo0NjoyNVrOGBSBPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk5Njk5MA==", "bodyText": "Could you write something I would include in the migration guide?", "url": "https://github.com/quarkusio/quarkus/pull/8328#discussion_r403996990", "createdAt": "2020-04-06T10:46:25Z", "author": {"login": "gsmet"}, "path": "docs/src/main/asciidoc/hibernate-search-elasticsearch.adoc", "diffHunk": "@@ -537,8 +537,8 @@ quarkus.hibernate-orm.sql-load-script=import.sql <4>\n \n quarkus.hibernate-search.elasticsearch.version=7 <5>\n quarkus.hibernate-search.elasticsearch.analysis.configurer=org.acme.hibernate.search.elasticsearch.config.AnalysisConfigurer <6>\n-quarkus.hibernate-search.elasticsearch.index-defaults.lifecycle.strategy=drop-and-create <7>\n-quarkus.hibernate-search.elasticsearch.index-defaults.lifecycle.required-status=yellow <8>\n+quarkus.hibernate-search.schema-management.strategy=drop-and-create <7>\n+quarkus.hibernate-search.elasticsearch.index-defaults.schema-management.required-status=yellow <8>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf405091c4327e654b3ed21b3233b632f8e8bc70"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4676, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}