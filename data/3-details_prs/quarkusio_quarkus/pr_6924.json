{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5NzA3NjQ4", "number": 6924, "title": "Add OIDC token grace period, better support for namespace-qualified claim paths and redirects", "bodyText": "Fixes #6853.\n(redirect-path support on the master is very limited: not possible to redirect to any other path but the one which the current request path starts from)\nFixes #6842.\n(namespace qualified claim paths)\nFixes #6836.\n(Token expiration grace period)\nAlso adds an ability to set the extra authentication request parameters as asked by @emmanuelBayle", "createdAt": "2020-01-31T18:18:24Z", "url": "https://github.com/quarkusio/quarkus/pull/6924", "merged": true, "mergeCommit": {"oid": "ed9b0e9006dab1d1c11b1f17ecea928134cb4365"}, "closed": true, "closedAt": "2020-02-06T14:02:01Z", "author": {"login": "sberyozkin"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_zxoyAFqTM1MTcwNTIyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBnkjnABqjMwMTMxNjg1MDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNzA1MjIz", "url": "https://github.com/quarkusio/quarkus/pull/6924#pullrequestreview-351705223", "createdAt": "2020-01-31T18:51:32Z", "commit": {"oid": "88557948afc958c89efea941b3aa9f17170e21ab"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88557948afc958c89efea941b3aa9f17170e21ab", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/88557948afc958c89efea941b3aa9f17170e21ab", "committedDate": "2020-01-31T18:04:46Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "1573ceec9843a66de87eab1fd0a5c244dfa0a966", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/1573ceec9843a66de87eab1fd0a5c244dfa0a966", "committedDate": "2020-02-02T19:47:09Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1573ceec9843a66de87eab1fd0a5c244dfa0a966", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/1573ceec9843a66de87eab1fd0a5c244dfa0a966", "committedDate": "2020-02-02T19:47:09Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "4bee27226df86f1533d683b022f948249a9df035", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/4bee27226df86f1533d683b022f948249a9df035", "committedDate": "2020-02-03T11:17:52Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bee27226df86f1533d683b022f948249a9df035", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/4bee27226df86f1533d683b022f948249a9df035", "committedDate": "2020-02-03T11:17:52Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "63b6a4c04b9fed6dc5e5efbf28a14f86bf2089e9", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/63b6a4c04b9fed6dc5e5efbf28a14f86bf2089e9", "committedDate": "2020-02-03T11:23:00Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "63b6a4c04b9fed6dc5e5efbf28a14f86bf2089e9", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/63b6a4c04b9fed6dc5e5efbf28a14f86bf2089e9", "committedDate": "2020-02-03T11:23:00Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "c1312a5ab8ae9bda9bd24795b135248e12eb637b", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/c1312a5ab8ae9bda9bd24795b135248e12eb637b", "committedDate": "2020-02-03T11:29:22Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyOTEyMzQ5", "url": "https://github.com/quarkusio/quarkus/pull/6924#pullrequestreview-352912349", "createdAt": "2020-02-04T11:43:08Z", "commit": {"oid": "c1312a5ab8ae9bda9bd24795b135248e12eb637b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1312a5ab8ae9bda9bd24795b135248e12eb637b", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/c1312a5ab8ae9bda9bd24795b135248e12eb637b", "committedDate": "2020-02-03T11:29:22Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "d2f1dd78a2c40fb04c148632c119eaadce4f8112", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/d2f1dd78a2c40fb04c148632c119eaadce4f8112", "committedDate": "2020-02-04T16:07:37Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNjMzMzU3", "url": "https://github.com/quarkusio/quarkus/pull/6924#pullrequestreview-353633357", "createdAt": "2020-02-05T11:06:56Z", "commit": {"oid": "d2f1dd78a2c40fb04c148632c119eaadce4f8112"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMTowNjo1NlrOFlz8Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMTowNjo1NlrOFlz8Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTE5MjY2Mg==", "bodyText": "@sberyozkin I let you change that one to use debugf. Ping me when it's done. Thanks!", "url": "https://github.com/quarkusio/quarkus/pull/6924#discussion_r375192662", "createdAt": "2020-02-05T11:06:56Z", "author": {"login": "gsmet"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/CodeAuthenticationMechanism.java", "diffHunk": "@@ -162,7 +177,10 @@ private static QuarkusSecurityIdentity augmentIdentity(SecurityIdentity security\n         }\n \n         params.put(\"code\", code);\n-        params.put(\"redirect_uri\", buildCodeRedirectUri(context, absoluteUri, getDynamicPath(context, absoluteUri)));\n+        String redirectPath = getRedirectPath(context, absoluteUri);\n+        String redirectUriParam = buildRedirectUri(context, absoluteUri, redirectPath);\n+        LOG.debug(\"Token request redirect_uri parameter: \" + redirectUriParam);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2f1dd78a2c40fb04c148632c119eaadce4f8112"}, "originalPosition": 86}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2f1dd78a2c40fb04c148632c119eaadce4f8112", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/d2f1dd78a2c40fb04c148632c119eaadce4f8112", "committedDate": "2020-02-04T16:07:37Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "45a5700fc95327d9c2ffadfe64d6d08a159cba72", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/45a5700fc95327d9c2ffadfe64d6d08a159cba72", "committedDate": "2020-02-05T11:12:21Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNjcxOTYz", "url": "https://github.com/quarkusio/quarkus/pull/6924#pullrequestreview-353671963", "createdAt": "2020-02-05T12:17:49Z", "commit": {"oid": "45a5700fc95327d9c2ffadfe64d6d08a159cba72"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNjc3NTgw", "url": "https://github.com/quarkusio/quarkus/pull/6924#pullrequestreview-353677580", "createdAt": "2020-02-05T12:28:09Z", "commit": {"oid": "45a5700fc95327d9c2ffadfe64d6d08a159cba72"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b64e80c5bf5f8bb4f691b30fa255028aaf17dcb", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/3b64e80c5bf5f8bb4f691b30fa255028aaf17dcb", "committedDate": "2020-02-06T09:45:58Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45a5700fc95327d9c2ffadfe64d6d08a159cba72", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/45a5700fc95327d9c2ffadfe64d6d08a159cba72", "committedDate": "2020-02-05T11:12:21Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}, "afterCommit": {"oid": "3b64e80c5bf5f8bb4f691b30fa255028aaf17dcb", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/3b64e80c5bf5f8bb4f691b30fa255028aaf17dcb", "committedDate": "2020-02-06T09:45:58Z", "message": "Add OIDC token grace period, namespace-qualified claim path check, complete redirect support"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 28, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}