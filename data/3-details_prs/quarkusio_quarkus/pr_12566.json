{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4ODg0NjI0", "number": 12566, "title": "Change default media type to JSON", "bodyText": "This adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@produces(MediaType.APPLICATION_JSON) and\n@consumes(MediaType.APPLICATION_JSON) everywhere.\nThe old behaviour can be retained by setting:\nquarkus.resteasy-json.default-json=false\nin application.properties.", "createdAt": "2020-10-06T23:13:02Z", "url": "https://github.com/quarkusio/quarkus/pull/12566", "merged": true, "mergeCommit": {"oid": "151c461fd263065006075aef1b17b06408c677ee"}, "closed": true, "closedAt": "2020-10-13T20:11:07Z", "author": {"login": "stuartwdouglas"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQNR2OgFqTUwMzg5ODEzMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSOVrIgFqTUwNzc4OTU2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzODk4MTMx", "url": "https://github.com/quarkusio/quarkus/pull/12566#pullrequestreview-503898131", "createdAt": "2020-10-07T13:48:17Z", "commit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c5c997659f366062f27a5e785466be00b0b3f76b", "committedDate": "2020-10-06T23:07:37Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "81122f3fd289522e99c98ef0c8b6e48fd86fd078", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/81122f3fd289522e99c98ef0c8b6e48fd86fd078", "committedDate": "2020-10-07T23:09:36Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81122f3fd289522e99c98ef0c8b6e48fd86fd078", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/81122f3fd289522e99c98ef0c8b6e48fd86fd078", "committedDate": "2020-10-07T23:09:36Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "18456a9c07cab100c643118b04c42fd8c0e71501", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/18456a9c07cab100c643118b04c42fd8c0e71501", "committedDate": "2020-10-07T23:30:22Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDYyODQ4", "url": "https://github.com/quarkusio/quarkus/pull/12566#pullrequestreview-504462848", "createdAt": "2020-10-08T06:30:01Z", "commit": {"oid": "18456a9c07cab100c643118b04c42fd8c0e71501"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNjozMDowMVrOHePuEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNjozMDowMVrOHePuEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQ3Njg4Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If you don't want JSON my default you can set `quarkus.resteasy-json.default-json=false` and the default will change back to `application/octet-stream`. If you set this\n          \n          \n            \n            If you don't want JSON by default you can set `quarkus.resteasy-json.default-json=false` and the default will change back to `application/octet-stream`. If you set this", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r501476883", "createdAt": "2020-10-08T06:30:01Z", "author": {"login": "Ladicek"}, "path": "docs/src/main/asciidoc/rest-json.adoc", "diffHunk": "@@ -172,9 +167,13 @@ depending on the extension you chose when initializing the project.\n \n [NOTE]\n ====\n-While RESTEasy supports auto-negotiation, when using Quarkus, it is very important to define the `@Produces` and `@Consumes` annotations.\n-They are analyzed at build time and Quarkus restricts the number of JAX-RS providers included in the native executable to the minimum required by the application.\n-It allows to reduce the size of the native executable.\n+When JSON extension is installed such as `quarkus-resteasy-jsonb` Quarkus will use this by default for most return values, unless the media type is explicitly set via\n+and `@Produces` or `@Consumes` annotation (there are some exceptions for well known types, such as `String` and `File`, which default to `text/plain` and `application/octet-stream`\n+respectively).\n+\n+If you don't want JSON my default you can set `quarkus.resteasy-json.default-json=false` and the default will change back to `application/octet-stream`. If you set this", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18456a9c07cab100c643118b04c42fd8c0e71501"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18456a9c07cab100c643118b04c42fd8c0e71501", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/18456a9c07cab100c643118b04c42fd8c0e71501", "committedDate": "2020-10-07T23:30:22Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "committedDate": "2020-10-08T07:02:04Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "committedDate": "2020-10-08T07:02:04Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "ecef387445b6684976220db5e3b2d9ab14f3372d", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/ecef387445b6684976220db5e3b2d9ab14f3372d", "committedDate": "2020-10-08T07:06:59Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecef387445b6684976220db5e3b2d9ab14f3372d", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/ecef387445b6684976220db5e3b2d9ab14f3372d", "committedDate": "2020-10-08T07:06:59Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "committedDate": "2020-10-08T07:08:18Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "committedDate": "2020-10-08T07:08:18Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "6dd700049e95aae5f94e6d59892772b6f7d2bf79", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/6dd700049e95aae5f94e6d59892772b6f7d2bf79", "committedDate": "2020-10-08T07:44:08Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6dd700049e95aae5f94e6d59892772b6f7d2bf79", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/6dd700049e95aae5f94e6d59892772b6f7d2bf79", "committedDate": "2020-10-08T07:44:08Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "committedDate": "2020-10-09T04:51:21Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNjg1ODA5", "url": "https://github.com/quarkusio/quarkus/pull/12566#pullrequestreview-503685809", "createdAt": "2020-10-07T09:21:37Z", "commit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwOToyMTozN1rOHdqW3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNDo0NDowMVrOHgBujA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDczMw==", "bodyText": "Should be called QuarkusJsonbSerializer for consistency with other classes.", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r500864733", "createdAt": "2020-10-07T09:21:37Z", "author": {"login": "gsmet"}, "path": "extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.quarkus.resteasy.jsonb;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.OutputStream;\n+import java.io.Reader;\n+import java.lang.annotation.Annotation;\n+import java.lang.reflect.Type;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.concurrent.CompletionStage;\n+\n+import javax.activation.DataSource;\n+import javax.annotation.Priority;\n+import javax.ws.rs.Consumes;\n+import javax.ws.rs.Priorities;\n+import javax.ws.rs.Produces;\n+import javax.ws.rs.WebApplicationException;\n+import javax.ws.rs.core.HttpHeaders;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.MultivaluedMap;\n+import javax.ws.rs.core.StreamingOutput;\n+import javax.ws.rs.ext.Provider;\n+\n+import org.jboss.resteasy.plugins.providers.FileRange;\n+import org.jboss.resteasy.plugins.providers.jsonb.JsonBindingProvider;\n+import org.jboss.resteasy.spi.AsyncOutputStream;\n+import org.jboss.resteasy.spi.AsyncStreamingOutput;\n+\n+/**\n+ * provider that can produce JSON by default, removing the need for @Produces and @Consumes everywhere\n+ */\n+@Provider\n+@Produces(MediaType.WILDCARD)\n+@Consumes(MediaType.WILDCARD)\n+@Priority(Priorities.USER - 200)\n+public class QuarkusJSONBSerializer extends JsonBindingProvider {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDg4Mg==", "bodyText": "It's not API so it should be in the runtime package.", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r500864882", "createdAt": "2020-10-07T09:21:52Z", "author": {"login": "gsmet"}, "path": "extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.quarkus.resteasy.jsonb;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0NDc4MA==", "bodyText": "And same for the Jackson one.", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r503344780", "createdAt": "2020-10-12T14:44:01Z", "author": {"login": "gsmet"}, "path": "extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.quarkus.resteasy.jsonb;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDg4Mg=="}, "originalCommit": {"oid": "c5c997659f366062f27a5e785466be00b0b3f76b"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "committedDate": "2020-10-13T00:13:00Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "committedDate": "2020-10-09T04:51:21Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}, "afterCommit": {"oid": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "committedDate": "2020-10-13T00:13:00Z", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3Nzg5NTY2", "url": "https://github.com/quarkusio/quarkus/pull/12566#pullrequestreview-507789566", "createdAt": "2020-10-13T20:10:13Z", "commit": {"oid": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1885, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}