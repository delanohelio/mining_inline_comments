{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5ODczMDQ0", "number": 11115, "title": "Export Neo4j driver as dedicated BuildItem.", "bodyText": "This change allows other extensions to retrieve the driver during their deployment process and use it as dependency.\nBackground: I'm writing another extension and I need the driver in it. So my extension will depend on Neo4j. I thought Arc respectively CDI would also allow the Driver to be injected, but I'm pretty sure I'm wrong on that.\nSo with the dedicated Neo4jDriverBuildItem in addition to the CDI producer (both working on the same Driver value), the Neo4j extension provides the instance to the application and possible other extensions.", "createdAt": "2020-07-31T07:35:11Z", "url": "https://github.com/quarkusio/quarkus/pull/11115", "merged": true, "mergeCommit": {"oid": "d936363ef6a4d85aa2601c9da40c97318209e99a"}, "closed": true, "closedAt": "2020-08-05T12:56:45Z", "author": {"login": "michael-simons"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6V3EpgFqTQ1OTI1OTY2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc76x71gFqTQ2MTYzNjAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MjU5NjYw", "url": "https://github.com/quarkusio/quarkus/pull/11115#pullrequestreview-459259660", "createdAt": "2020-07-31T15:21:51Z", "commit": {"oid": "6726974f8b5fc11d458d52c2e16c470cfabf5ddd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToyMTo1MVrOG6MeAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNToyMTo1MVrOG6MeAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NDg4Mg==", "bodyText": "I don't think that will work, you need to use a RuntimeValue<Driver>. We have plenty of examples if you look for RuntimeValue in the code.", "url": "https://github.com/quarkusio/quarkus/pull/11115#discussion_r463674882", "createdAt": "2020-07-31T15:21:51Z", "author": {"login": "gsmet"}, "path": "extensions/neo4j/deployment/src/main/java/io/quarkus/neo4j/deployment/Neo4jDriverProcessor.java", "diffHunk": "@@ -33,11 +35,13 @@ AdditionalBeanBuildItem createDriverProducer() {\n \n     @BuildStep\n     @Record(ExecutionTime.RUNTIME_INIT)\n-    void configureDriverProducer(Neo4jDriverRecorder recorder, BeanContainerBuildItem beanContainerBuildItem,\n+    Neo4jDriverBuildItem configureDriverProducer(Neo4jDriverRecorder recorder, BeanContainerBuildItem beanContainerBuildItem,\n             Neo4jConfiguration configuration,\n             ShutdownContextBuildItem shutdownContext) {\n \n-        recorder.configureNeo4jProducer(beanContainerBuildItem.getValue(), configuration, shutdownContext);\n+        Driver driver = recorder.initializeDriver(configuration, shutdownContext);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6726974f8b5fc11d458d52c2e16c470cfabf5ddd"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2c95c29fbb6d7e51f680c69a39c000b4e358324", "author": {"user": {"login": "michael-simons", "name": "Michael Simons"}}, "url": "https://github.com/quarkusio/quarkus/commit/a2c95c29fbb6d7e51f680c69a39c000b4e358324", "committedDate": "2020-08-03T09:44:38Z", "message": "Export Neo4j driver as dedicated BuildItem.\n\nThis change allows other extensions to retrieve the driver during their deployment process and use it as dependency. The driver is wrapped as  RuntimeValue<Driver> so that it can be safely passed between different runtime steps."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30446f51c56bb5c0b1126850b0a19e06e232388f", "author": {"user": {"login": "michael-simons", "name": "Michael Simons"}}, "url": "https://github.com/quarkusio/quarkus/commit/30446f51c56bb5c0b1126850b0a19e06e232388f", "committedDate": "2020-08-03T06:56:48Z", "message": "Wrap driver instancen in RuntimeValue<Driver>."}, "afterCommit": {"oid": "a2c95c29fbb6d7e51f680c69a39c000b4e358324", "author": {"user": {"login": "michael-simons", "name": "Michael Simons"}}, "url": "https://github.com/quarkusio/quarkus/commit/a2c95c29fbb6d7e51f680c69a39c000b4e358324", "committedDate": "2020-08-03T09:44:38Z", "message": "Export Neo4j driver as dedicated BuildItem.\n\nThis change allows other extensions to retrieve the driver during their deployment process and use it as dependency. The driver is wrapped as  RuntimeValue<Driver> so that it can be safely passed between different runtime steps."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNjM2MDMy", "url": "https://github.com/quarkusio/quarkus/pull/11115#pullrequestreview-461636032", "createdAt": "2020-08-05T12:56:39Z", "commit": {"oid": "a2c95c29fbb6d7e51f680c69a39c000b4e358324"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1044, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}