{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NjI2ODY4", "number": 7302, "title": "Show a proper error message when @Inject is used in NativeTest", "bodyText": "Fixes: #7300", "createdAt": "2020-02-20T08:51:51Z", "url": "https://github.com/quarkusio/quarkus/pull/7302", "merged": true, "mergeCommit": {"oid": "c13dad146aa3b77b7a5172fe7c4405f8cefd7f98"}, "closed": true, "closedAt": "2020-02-21T06:58:00Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGHUV9gBqjMwNTQ5Mjg5Mjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGS5sQABqjMwNTg1MTEzMjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9c7362f7778b041977ac366e9c9e712bed548614", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/9c7362f7778b041977ac366e9c9e712bed548614", "committedDate": "2020-02-20T08:51:29Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}, "afterCommit": {"oid": "da246f6a74de040df5ef43cb34ae9176d49a0058", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/da246f6a74de040df5ef43cb34ae9176d49a0058", "committedDate": "2020-02-20T09:01:00Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzI4ODkw", "url": "https://github.com/quarkusio/quarkus/pull/7302#pullrequestreview-361728890", "createdAt": "2020-02-20T09:01:37Z", "commit": {"oid": "da246f6a74de040df5ef43cb34ae9176d49a0058"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowMTozN1rOFsLFcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwOTowMTozN1rOFsLFcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2MzI4Mw==", "bodyText": "in QuarkusTest tests -> in NativeImageTest tests?", "url": "https://github.com/quarkusio/quarkus/pull/7302#discussion_r381863283", "createdAt": "2020-02-20T09:01:37Z", "author": {"login": "Ladicek"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/NativeTestExtension.java", "diffHunk": "@@ -71,6 +75,23 @@ public void beforeAll(ExtensionContext extensionContext) throws Exception {\n         }\n     }\n \n+    private void ensureNoInjectAnnotationIsUsed(Class<?> testClass) {\n+        Class<?> current = testClass;\n+        while (current.getSuperclass() != null) {\n+            for (Field field : current.getDeclaredFields()) {\n+                Inject injectAnnotation = field.getAnnotation(Inject.class);\n+                if (injectAnnotation != null) {\n+                    throw new JUnitException(\n+                            \"@Inject is not supported in QuarkusTest tests. Offending field is \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da246f6a74de040df5ef43cb34ae9176d49a0058"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da246f6a74de040df5ef43cb34ae9176d49a0058", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/da246f6a74de040df5ef43cb34ae9176d49a0058", "committedDate": "2020-02-20T09:01:00Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}, "afterCommit": {"oid": "5e15c459c4a1a7dbd94f6b9cd5d01aa22abcedcd", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/5e15c459c4a1a7dbd94f6b9cd5d01aa22abcedcd", "committedDate": "2020-02-20T09:03:39Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5e15c459c4a1a7dbd94f6b9cd5d01aa22abcedcd", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/5e15c459c4a1a7dbd94f6b9cd5d01aa22abcedcd", "committedDate": "2020-02-20T09:03:39Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}, "afterCommit": {"oid": "ddd0bcf90d94264d3f1cbffadaafebe8e3002ca3", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/ddd0bcf90d94264d3f1cbffadaafebe8e3002ca3", "committedDate": "2020-02-20T11:15:51Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ddd0bcf90d94264d3f1cbffadaafebe8e3002ca3", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/ddd0bcf90d94264d3f1cbffadaafebe8e3002ca3", "committedDate": "2020-02-20T11:15:51Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}, "afterCommit": {"oid": "1f8e4fdcadcbce25528dadb84d5f43645360ad68", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/1f8e4fdcadcbce25528dadb84d5f43645360ad68", "committedDate": "2020-02-20T11:25:31Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f8e4fdcadcbce25528dadb84d5f43645360ad68", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/1f8e4fdcadcbce25528dadb84d5f43645360ad68", "committedDate": "2020-02-20T11:25:31Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}, "afterCommit": {"oid": "d481e834d9e9cb0d3065a1c3a54e28f4e620a26f", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d481e834d9e9cb0d3065a1c3a54e28f4e620a26f", "committedDate": "2020-02-20T13:00:18Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "434cc9fefe7c6e8919bfe646b22598c281ab209d", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/434cc9fefe7c6e8919bfe646b22598c281ab209d", "committedDate": "2020-02-20T14:13:48Z", "message": "Remove unused injection into test"}, "afterCommit": {"oid": "d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3", "committedDate": "2020-02-20T16:07:29Z", "message": "Remove unused injection into test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTY5NjQy", "url": "https://github.com/quarkusio/quarkus/pull/7302#pullrequestreview-362169642", "createdAt": "2020-02-20T19:23:48Z", "commit": {"oid": "d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOToyMzo0OVrOFsgH3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOToyMzo0OVrOFsgH3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjIwNzk2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * {@link @QuarkusTest} so the test class structure must be take this into account\n          \n          \n            \n             * {@link @QuarkusTest} so the test class structure must take this into account.", "url": "https://github.com/quarkusio/quarkus/pull/7302#discussion_r382207965", "createdAt": "2020-02-20T19:23:49Z", "author": {"login": "gsmet"}, "path": "test-framework/junit5/src/main/java/io/quarkus/test/junit/NativeImageTest.java", "diffHunk": "@@ -20,6 +20,9 @@\n  * run, it is expected that the JVM tests will be standard unit tests that are\n  * executed by surefire, while the native image tests will be integration tests\n  * executed by failsafe.\n+ * This also means that injection of beans into a test class using {@code @Inject} is not supported\n+ * in native image tests. Such injection is only possible in tests injected with\n+ * {@link @QuarkusTest} so the test class structure must be take this into account", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d0761d1bd1286e91b17c108f5c7b954f1dd0d5f3", "committedDate": "2020-02-20T16:07:29Z", "message": "Remove unused injection into test"}, "afterCommit": {"oid": "a17b6a81c8d2ad8d35b1ee7f578d3295d538a3ad", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/a17b6a81c8d2ad8d35b1ee7f578d3295d538a3ad", "committedDate": "2020-02-20T19:41:11Z", "message": "Remove unused injection into test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTg3NzE0", "url": "https://github.com/quarkusio/quarkus/pull/7302#pullrequestreview-362187714", "createdAt": "2020-02-20T19:51:12Z", "commit": {"oid": "a17b6a81c8d2ad8d35b1ee7f578d3295d538a3ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cea862dbab1f9133ff5e0d7d9cdbef11e2d1e27", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/2cea862dbab1f9133ff5e0d7d9cdbef11e2d1e27", "committedDate": "2020-02-20T22:30:41Z", "message": "Show a proper error message when @Inject is used in NativeTest\n\nFixes: #7300"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ee107619d767109c278695b38105e8059432e6d", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/4ee107619d767109c278695b38105e8059432e6d", "committedDate": "2020-02-20T22:30:41Z", "message": "Remove unused injection into test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a17b6a81c8d2ad8d35b1ee7f578d3295d538a3ad", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/a17b6a81c8d2ad8d35b1ee7f578d3295d538a3ad", "committedDate": "2020-02-20T19:41:11Z", "message": "Remove unused injection into test"}, "afterCommit": {"oid": "4ee107619d767109c278695b38105e8059432e6d", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/4ee107619d767109c278695b38105e8059432e6d", "committedDate": "2020-02-20T22:30:41Z", "message": "Remove unused injection into test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4146, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}