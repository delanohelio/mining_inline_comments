{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5ODc4MTMz", "number": 12213, "title": "Mutiny 0.8.1", "bodyText": "Upgrading to Mutiny 0.8.1:\n\nfix compilation errors against parametric types,\ninstall a dropped exception handler/logger,\nconfigure a thread blocking checker that reports blocking Vert.x event-loops.\n\nFixes #11614", "createdAt": "2020-09-20T09:12:04Z", "url": "https://github.com/quarkusio/quarkus/pull/12213", "merged": true, "mergeCommit": {"oid": "1e90a5b5132fe09971cbd4765c30f61b535ec87f"}, "closed": true, "closedAt": "2020-09-21T15:13:33Z", "author": {"login": "jponge"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKqjdGgH2gAyNDg5ODc4MTMzOjljOGRiYzhkYjFmNzkzZjBjYmQ2MzhlNmFjNDM5MDdmMjgyY2IwOWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLE6FcAFqTQ5MjcyMDAwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9c8dbc8db1f793f0cbd638e6ac43907f282cb09b", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/9c8dbc8db1f793f0cbd638e6ac43907f282cb09b", "committedDate": "2020-09-20T08:31:13Z", "message": "Bump to Mutiny 0.8.0\n\nAlso fix parametric types in the code base."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aad1071c8a6e1c4c688be1c190ca5a63bbb772a5", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/aad1071c8a6e1c4c688be1c190ca5a63bbb772a5", "committedDate": "2020-09-20T08:31:14Z", "message": "Mutiny dropped exception logging handler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f189a75e93df77ec3f2ff73434cbebaf8d24351a", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/f189a75e93df77ec3f2ff73434cbebaf8d24351a", "committedDate": "2020-09-20T08:31:15Z", "message": "Configure the Mutiny thread blocking checker\n\nForbid blocking a Vert.x event-loop."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c161615270d340e2ab77285e37c28162939a33d2", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/c161615270d340e2ab77285e37c28162939a33d2", "committedDate": "2020-09-20T13:25:51Z", "message": "Remove the logger from the heap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/fcd0acef18a66e07b455a3f078501671bf5e83c1", "committedDate": "2020-09-20T16:26:39Z", "message": "Move Mutiny infrastructure initialization to STATIC_INIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMjk5Mjg5", "url": "https://github.com/quarkusio/quarkus/pull/12213#pullrequestreview-492299289", "createdAt": "2020-09-21T06:14:27Z", "commit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNjoxNDoyN1rOHVBwRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNjoxNjozMVrOHVByww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxMDg4Nw==", "bodyText": "[Picky] - We could have done everything in a single method.", "url": "https://github.com/quarkusio/quarkus/pull/12213#discussion_r491810887", "createdAt": "2020-09-21T06:14:27Z", "author": {"login": "cescoffier"}, "path": "extensions/mutiny/deployment/src/main/java/io/quarkus/mutiny/deployment/MutinyProcessor.java", "diffHunk": "@@ -23,4 +23,16 @@ public void initExecutor(ExecutorBuildItem executorBuildItem, MutinyInfrastructu\n         ExecutorService executor = executorBuildItem.getExecutorProxy();\n         recorder.configureMutinyInfrastructure(executor);\n     }\n+\n+    @BuildStep\n+    @Record(ExecutionTime.STATIC_INIT)\n+    public void defineDroppedExceptionHandler(MutinyInfrastructure recorder) {\n+        recorder.configureDroppedExceptionHandler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxMTEzMg==", "bodyText": "Should we cache the logger?", "url": "https://github.com/quarkusio/quarkus/pull/12213#discussion_r491811132", "createdAt": "2020-09-21T06:15:13Z", "author": {"login": "cescoffier"}, "path": "extensions/mutiny/runtime/src/main/java/io/quarkus/mutiny/runtime/MutinyInfrastructure.java", "diffHunk": "@@ -11,4 +15,23 @@\n     public void configureMutinyInfrastructure(ExecutorService exec) {\n         Infrastructure.setDefaultExecutor(exec);\n     }\n+\n+    public void configureDroppedExceptionHandler() {\n+        Infrastructure.setDroppedExceptionHandler(new Consumer<Throwable>() {\n+            @Override\n+            public void accept(Throwable throwable) {\n+                Logger.getLogger(MutinyInfrastructure.class).error(\"Mutiny had to drop the following exception\", throwable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxMTI1NQ==", "bodyText": "Can we add the drop site too?", "url": "https://github.com/quarkusio/quarkus/pull/12213#discussion_r491811255", "createdAt": "2020-09-21T06:15:37Z", "author": {"login": "cescoffier"}, "path": "extensions/mutiny/runtime/src/main/java/io/quarkus/mutiny/runtime/MutinyInfrastructure.java", "diffHunk": "@@ -11,4 +15,23 @@\n     public void configureMutinyInfrastructure(ExecutorService exec) {\n         Infrastructure.setDefaultExecutor(exec);\n     }\n+\n+    public void configureDroppedExceptionHandler() {\n+        Infrastructure.setDroppedExceptionHandler(new Consumer<Throwable>() {\n+            @Override\n+            public void accept(Throwable throwable) {\n+                Logger.getLogger(MutinyInfrastructure.class).error(\"Mutiny had to drop the following exception\", throwable);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxMTEzMg=="}, "originalCommit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxMTUyMw==", "bodyText": "Can you add a comment about why we use that strategy (avoid depending on Vert.x explicitly, also avoid to select worker threads).", "url": "https://github.com/quarkusio/quarkus/pull/12213#discussion_r491811523", "createdAt": "2020-09-21T06:16:31Z", "author": {"login": "cescoffier"}, "path": "extensions/mutiny/runtime/src/main/java/io/quarkus/mutiny/runtime/MutinyInfrastructure.java", "diffHunk": "@@ -11,4 +15,23 @@\n     public void configureMutinyInfrastructure(ExecutorService exec) {\n         Infrastructure.setDefaultExecutor(exec);\n     }\n+\n+    public void configureDroppedExceptionHandler() {\n+        Infrastructure.setDroppedExceptionHandler(new Consumer<Throwable>() {\n+            @Override\n+            public void accept(Throwable throwable) {\n+                Logger.getLogger(MutinyInfrastructure.class).error(\"Mutiny had to drop the following exception\", throwable);\n+            }\n+        });\n+    }\n+\n+    public void configureThreadBlockingChecker() {\n+        Infrastructure.setCanCallerThreadBeBlockedSupplier(new BooleanSupplier() {\n+            @Override\n+            public boolean getAsBoolean() {\n+                String threadName = Thread.currentThread().getName();\n+                return !threadName.contains(\"vertx-eventloop-thread-\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd0acef18a66e07b455a3f078501671bf5e83c1"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10b93d016aa7d39625e7ce1d5735ad40c9b0d7fe", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/10b93d016aa7d39625e7ce1d5735ad40c9b0d7fe", "committedDate": "2020-09-21T08:30:16Z", "message": "Address PR feedback"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c111d834c1ab261dfa5b87ece4be01f5d01b5c14", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/c111d834c1ab261dfa5b87ece4be01f5d01b5c14", "committedDate": "2020-09-21T08:06:52Z", "message": "Address PR feedback"}, "afterCommit": {"oid": "10b93d016aa7d39625e7ce1d5735ad40c9b0d7fe", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/10b93d016aa7d39625e7ce1d5735ad40c9b0d7fe", "committedDate": "2020-09-21T08:30:16Z", "message": "Address PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62441971ee90246e8183a49780556299dc1e8f7f", "author": {"user": {"login": "jponge", "name": "Julien Ponge"}}, "url": "https://github.com/quarkusio/quarkus/commit/62441971ee90246e8183a49780556299dc1e8f7f", "committedDate": "2020-09-21T12:29:42Z", "message": "Bump to Mutiny 0.8.1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNzIwMDA1", "url": "https://github.com/quarkusio/quarkus/pull/12213#pullrequestreview-492720005", "createdAt": "2020-09-21T15:13:28Z", "commit": {"oid": "62441971ee90246e8183a49780556299dc1e8f7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 379, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}