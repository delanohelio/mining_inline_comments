{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNDE5MDcy", "number": 11232, "title": "Gradle: avoid resolving deprecated compileOnly configuration", "bodyText": "Fixes #11182\nBesides avoiding resolution of compileOnly configuration which is deprecated for resolution, this change includes a better (proper) approach to resolve devmode classpath by defining a custom configuration that extends from compile and runtime configurations.\nLombok-based project is included as a testcase.", "createdAt": "2020-08-05T14:25:50Z", "url": "https://github.com/quarkusio/quarkus/pull/11232", "merged": true, "mergeCommit": {"oid": "d4134e73c4795f17790579122650c293877639c3"}, "closed": true, "closedAt": "2020-08-06T21:40:05Z", "author": {"login": "aloubyansky"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc78pGygFqTQ2MTc1NzA2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8UayfABqjM2MzA0MDA4NjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNzU3MDYy", "url": "https://github.com/quarkusio/quarkus/pull/11232#pullrequestreview-461757062", "createdAt": "2020-08-05T15:06:49Z", "commit": {"oid": "8fa0e79f7addf0cabd26be556ccac7f5b0eeb8ca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNTowNjo0OVrOG8N-Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNTowNjo0OVrOG8N-Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc5NjYzNQ==", "bodyText": "This static field is in fact a critical issue because an instance of this class will be shared between builds (and probably also projects).", "url": "https://github.com/quarkusio/quarkus/pull/11232#discussion_r465796635", "createdAt": "2020-08-05T15:06:49Z", "author": {"login": "aloubyansky"}, "path": "devtools/gradle/src/main/java/io/quarkus/gradle/builder/QuarkusModelBuilder.java", "diffHunk": "@@ -48,17 +46,27 @@\n import io.quarkus.gradle.tasks.QuarkusGradleUtils;\n import io.quarkus.runtime.LaunchMode;\n \n-public class QuarkusModelBuilder implements ParameterizedToolingModelBuilder {\n+public class QuarkusModelBuilder implements ParameterizedToolingModelBuilder<ModelParameter> {\n \n-    private static final List<String> scannedConfigurations = new LinkedList();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fa0e79f7addf0cabd26be556ccac7f5b0eeb8ca"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8fa0e79f7addf0cabd26be556ccac7f5b0eeb8ca", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/8fa0e79f7addf0cabd26be556ccac7f5b0eeb8ca", "committedDate": "2020-08-05T14:25:17Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}, "afterCommit": {"oid": "ead334854b4d16845b6550d4cf1476885b669699", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/ead334854b4d16845b6550d4cf1476885b669699", "committedDate": "2020-08-05T15:09:55Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNzY1OTY3", "url": "https://github.com/quarkusio/quarkus/pull/11232#pullrequestreview-461765967", "createdAt": "2020-08-05T15:16:21Z", "commit": {"oid": "ead334854b4d16845b6550d4cf1476885b669699"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODA1MTQz", "url": "https://github.com/quarkusio/quarkus/pull/11232#pullrequestreview-461805143", "createdAt": "2020-08-05T15:59:41Z", "commit": {"oid": "ead334854b4d16845b6550d4cf1476885b669699"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNTo1OTo0MVrOG8QN5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNTo1OTo0MVrOG8QN5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzMzQ0Nw==", "bodyText": "It's not exactly doing the same thing so asking: is the order the same as before when we added things to the list below?\nThe order is different but considering the operations are different, maybe it's the same (or is of no importance).\nJust wanted to be sure.", "url": "https://github.com/quarkusio/quarkus/pull/11232#discussion_r465833447", "createdAt": "2020-08-05T15:59:41Z", "author": {"login": "gsmet"}, "path": "devtools/gradle/src/main/java/io/quarkus/gradle/builder/QuarkusModelBuilder.java", "diffHunk": "@@ -48,17 +46,27 @@\n import io.quarkus.gradle.tasks.QuarkusGradleUtils;\n import io.quarkus.runtime.LaunchMode;\n \n-public class QuarkusModelBuilder implements ParameterizedToolingModelBuilder {\n+public class QuarkusModelBuilder implements ParameterizedToolingModelBuilder<ModelParameter> {\n \n-    private static final List<String> scannedConfigurations = new LinkedList();\n+    private static Configuration classpathConfig(Project project, LaunchMode mode) {\n+        if (LaunchMode.TEST.equals(mode)) {\n+            return project.getConfigurations().getByName(JavaPlugin.TEST_RUNTIME_CLASSPATH_CONFIGURATION_NAME);\n+        }\n+        if (LaunchMode.DEVELOPMENT.equals(mode)) {\n+            return project.getConfigurations().create(\"quarkusDevMode\").extendsFrom(\n+                    project.getConfigurations().getByName(JavaPlugin.COMPILE_CLASSPATH_CONFIGURATION_NAME),\n+                    project.getConfigurations().getByName(JavaPlugin.RUNTIME_CLASSPATH_CONFIGURATION_NAME));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ead334854b4d16845b6550d4cf1476885b669699"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ead334854b4d16845b6550d4cf1476885b669699", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/ead334854b4d16845b6550d4cf1476885b669699", "committedDate": "2020-08-05T15:09:55Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}, "afterCommit": {"oid": "6724068f455afff5b550d5280d2ca3fa60fd3b38", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/6724068f455afff5b550d5280d2ca3fa60fd3b38", "committedDate": "2020-08-05T16:24:55Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMDA5NjI1", "url": "https://github.com/quarkusio/quarkus/pull/11232#pullrequestreview-462009625", "createdAt": "2020-08-05T20:44:14Z", "commit": {"oid": "6724068f455afff5b550d5280d2ca3fa60fd3b38"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMDo0NDoxNFrOG8Z7kA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMDo0NDoxNFrOG8Z7kA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk5MjU5Mg==", "bodyText": "Is this dependency needed here?", "url": "https://github.com/quarkusio/quarkus/pull/11232#discussion_r465992592", "createdAt": "2020-08-05T20:44:14Z", "author": {"login": "glefloch"}, "path": "integration-tests/gradle/build.gradle", "diffHunk": "@@ -34,6 +34,7 @@ dependencies {\n     testImplementation 'org.assertj:assertj-core:3.16.1'\n     testImplementation 'org.junit.jupiter:junit-jupiter:5.6.2'\n     testImplementation 'org.awaitility:awaitility:4.0.3'\n+    testImplementation \"org.projectlombok:lombok:${lombokVersion}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6724068f455afff5b550d5280d2ca3fa60fd3b38"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6724068f455afff5b550d5280d2ca3fa60fd3b38", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/6724068f455afff5b550d5280d2ca3fa60fd3b38", "committedDate": "2020-08-05T16:24:55Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}, "afterCommit": {"oid": "c7f68824b549be9ca1cef48b4901d5ddb435f784", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/c7f68824b549be9ca1cef48b4901d5ddb435f784", "committedDate": "2020-08-06T11:40:57Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c7f68824b549be9ca1cef48b4901d5ddb435f784", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/c7f68824b549be9ca1cef48b4901d5ddb435f784", "committedDate": "2020-08-06T11:40:57Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}, "afterCommit": {"oid": "280eeb4be332566d42ba03c89095168eb55b2bd9", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/280eeb4be332566d42ba03c89095168eb55b2bd9", "committedDate": "2020-08-06T12:38:36Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "280eeb4be332566d42ba03c89095168eb55b2bd9", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/280eeb4be332566d42ba03c89095168eb55b2bd9", "committedDate": "2020-08-06T12:38:36Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}, "afterCommit": {"oid": "df94c2c68c9d1461f2ecbee868e9ce498118d01d", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/df94c2c68c9d1461f2ecbee868e9ce498118d01d", "committedDate": "2020-08-06T12:43:12Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "27462b994d82dfcd896a0f6ae332461945de4845", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/27462b994d82dfcd896a0f6ae332461945de4845", "committedDate": "2020-08-06T13:48:22Z", "message": "attempting to capture the logs from the build"}, "afterCommit": {"oid": "918ff4f3d564f7545914ddea1f343942219f28a9", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/918ff4f3d564f7545914ddea1f343942219f28a9", "committedDate": "2020-08-06T14:07:10Z", "message": "attempting to capture the logs from the build"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "918ff4f3d564f7545914ddea1f343942219f28a9", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/918ff4f3d564f7545914ddea1f343942219f28a9", "committedDate": "2020-08-06T14:07:10Z", "message": "attempting to capture the logs from the build"}, "afterCommit": {"oid": "baf7d56e2c194e4fa08a84e51d7f0f3e468af594", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/baf7d56e2c194e4fa08a84e51d7f0f3e468af594", "committedDate": "2020-08-06T14:57:40Z", "message": "attempting to capture the logs from the build"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "baf7d56e2c194e4fa08a84e51d7f0f3e468af594", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/baf7d56e2c194e4fa08a84e51d7f0f3e468af594", "committedDate": "2020-08-06T14:57:40Z", "message": "attempting to capture the logs from the build"}, "afterCommit": {"oid": "22ab33c0096e8d026e6e75eb519d07adf1ca7e49", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/22ab33c0096e8d026e6e75eb519d07adf1ca7e49", "committedDate": "2020-08-06T15:58:06Z", "message": "attempting to capture the logs from the build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e6581c8287086b4f2211d5791a49c2c56e4f313", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/3e6581c8287086b4f2211d5791a49c2c56e4f313", "committedDate": "2020-08-06T18:48:39Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "22ab33c0096e8d026e6e75eb519d07adf1ca7e49", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/22ab33c0096e8d026e6e75eb519d07adf1ca7e49", "committedDate": "2020-08-06T15:58:06Z", "message": "attempting to capture the logs from the build"}, "afterCommit": {"oid": "3e6581c8287086b4f2211d5791a49c2c56e4f313", "author": {"user": {"login": "aloubyansky", "name": "Alexey Loubyansky"}}, "url": "https://github.com/quarkusio/quarkus/commit/3e6581c8287086b4f2211d5791a49c2c56e4f313", "committedDate": "2020-08-06T18:48:39Z", "message": "Gradle: avoid resolving deprecated compileOnly configuration"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 915, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}