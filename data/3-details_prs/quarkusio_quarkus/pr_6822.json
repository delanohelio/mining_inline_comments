{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3OTI4ODE2", "number": 6822, "title": "Fix broken copy json resources", "bodyText": "This fixes the cache quickstart that broke due to my previous change in the same file (albeit the quickstart didn't exist then :)).", "createdAt": "2020-01-28T10:15:53Z", "url": "https://github.com/quarkusio/quarkus/pull/6822", "merged": true, "mergeCommit": {"oid": "2b66772bbcf9887cbfa6150263c7c530a3c648d7"}, "closed": true, "closedAt": "2020-01-29T09:58:35Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-6nX4AFqTM0OTc5Mjc4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_B1rxAFqTM0OTkzNjI1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NzkyNzgw", "url": "https://github.com/quarkusio/quarkus/pull/6822#pullrequestreview-349792780", "createdAt": "2020-01-29T00:14:40Z", "commit": {"oid": "226a960fa716bc754eadca5a8ea7f5f2571d282b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwMDoxNDo0MVrOFi5AJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQwMDoxNDo0MVrOFi5AJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjEyOTgzMQ==", "bodyText": "Files.find needs to be in a try with resources block, as the stream needs to be closed.", "url": "https://github.com/quarkusio/quarkus/pull/6822#discussion_r372129831", "createdAt": "2020-01-29T00:14:41Z", "author": {"login": "stuartwdouglas"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/JarResultBuildStep.java", "diffHunk": "@@ -378,31 +379,43 @@ public NativeImageSourceJarBuildItem buildNativeImageJar(CurateOutcomeBuildItem\n      */\n     private void copyJsonConfigFiles(ApplicationArchivesBuildItem applicationArchivesBuildItem, Path thinJarDirectory)\n             throws IOException {\n-        // archiveLocation contains the location of the application jar at this point\n-        Path appJarPath = applicationArchivesBuildItem.getRootArchive().getArchiveLocation();\n-        try (FileSystem jarFileSystem = FileSystems.newFileSystem(appJarPath, null)) {\n-            try (Stream<Path> stream = Files.find(jarFileSystem.getPath(\"/\"), 1, new BiPredicate<Path, BasicFileAttributes>() {\n+        Path archiveLocation = applicationArchivesBuildItem.getRootArchive().getArchiveLocation();\n+        if (Files.isDirectory(archiveLocation)) { // this is the use case where the native image is built as part of the regular build\n+            Files.find(archiveLocation, 1, IS_JSON_FILE_PREDICATE).forEach(new Consumer<Path>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "226a960fa716bc754eadca5a8ea7f5f2571d282b"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18090bd3ce24ae696ddf9b2cb9fdfaaf85ee864d", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/18090bd3ce24ae696ddf9b2cb9fdfaaf85ee864d", "committedDate": "2020-01-29T07:41:16Z", "message": "Ensure that json config file copying works under all circumstances"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7dc582c91b907521391735cdd80a0d07f9de1b4", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/b7dc582c91b907521391735cdd80a0d07f9de1b4", "committedDate": "2020-01-29T07:41:19Z", "message": "Make one of the integration tests use the new way of building native image"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "226a960fa716bc754eadca5a8ea7f5f2571d282b", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/226a960fa716bc754eadca5a8ea7f5f2571d282b", "committedDate": "2020-01-28T10:13:50Z", "message": "Make one of the integration tests use the new way of building native image"}, "afterCommit": {"oid": "b7dc582c91b907521391735cdd80a0d07f9de1b4", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/b7dc582c91b907521391735cdd80a0d07f9de1b4", "committedDate": "2020-01-29T07:41:19Z", "message": "Make one of the integration tests use the new way of building native image"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5OTM2MjU3", "url": "https://github.com/quarkusio/quarkus/pull/6822#pullrequestreview-349936257", "createdAt": "2020-01-29T08:40:42Z", "commit": {"oid": "b7dc582c91b907521391735cdd80a0d07f9de1b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 160, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}