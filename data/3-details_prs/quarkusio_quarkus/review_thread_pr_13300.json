{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMTkxNTMx", "number": 13300, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMzowODoyOVrOE6Rftg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMjowMjoyMFrOE88dbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NTM5NTEwOnYy", "diffSide": "RIGHT", "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "isResolved": true, "comments": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QyMzowODoyOVrOH1PNJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwOTozMzoxNlrOH5qjsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg==", "bodyText": "Hi Vincent @vsevel\nCan you please remind what was the difference between\nquarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n\nand\nquarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n\n?\nPlease also update the docs", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r525585702", "createdAt": "2020-11-17T23:08:29Z", "author": {"login": "sberyozkin"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYyNTA4NA==", "bodyText": "@sberyozkin hello Sergey,  quarkus.vault.secret-config-kv-path=multi/default1,multi/default2 will mount the content of paths multi/default1 and multi/default2 as MP config properties with no prefix.\nso if foo=bar is in path multi/default1, you will be able to read foo by doing:\n@ConfigProperty(name = \"foo\")\nString foo;\n\nwhereas quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2 will mount those properties with a prefix. so if bob=dylan is in multi/singer1, then you will be able to access it through:\n@ConfigProperty(name = \"singer.bob\")\nString bob;\n\nthis allows to handle name conflicts of properties named identically in different paths. the most obvious example is if multiple paths contain key password.\n\nPlease also update the docs\n\ndoc is up to date. the only example in the guides was for property quarkus.vault.secret-config-kv-path, which did not change. quarkus.vault.secret-config-kv-prefix.singer.paths is documented through the javadoc, which is up to date.\ncheers.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r525625084", "createdAt": "2020-11-18T00:57:20Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjAxOTc5Nw==", "bodyText": "Hi Vincent @vsevel Thanks; your explanation about the docs makes sense, and indeed, about the properties, I'm just wondering if the one extra segment in a new property name can be collapsed.\nIt was :\nquarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n\nnow it is\nquarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2\n\nSo instead of secret-config-kv-path it is secret-config-kv-prefix, and instead of singer (in this concrete case) it is singer.paths,\nbut we also still have the original non prefix case:\nquarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n\nwhere it is secret-config-kv-path (not secret-config-kv-paths).\nit feels like it can be simpler (possibly more consistent) to have\nquarkus.vault.secret-config-kv-path-prefix.singer=multi/singer1,multi/singer2\n\nand then we'd have\n# without prefix\nquarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n\n# with prefix, instead of the old\n# quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\nquarkus.vault.secret-config-kv-path-prefix.singer=multi/singer1,multi/singer2\n\nWhat do you think ?", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r526019797", "createdAt": "2020-11-18T11:38:16Z", "author": {"login": "sberyozkin"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA0NDQwMw==", "bodyText": "sounds good. I remember trying different things. I am wondering if I got some issues with: Map<String, List<String>>. I am going to try.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r526044403", "createdAt": "2020-11-18T12:21:26Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA4NTM3Mg==", "bodyText": "so I checked. technically it works. but there is an issue with doc generation.\nin the configuration reference property name is quarkus.vault.secret-config-kv-path-prefix, and we would want it to be something like quarkus.vault.secret-config-kv-path-prefix.\"prefix\".\nand the type is Map<String,List<String>>, when that should be string (like in the quarkus.vault.credentials-provider.\"credentials-provider\".kv-key property), or better string list.\nso what should we do:\n\ngo on with your proposition, and accept the approximate documentation (and may be create an improvement issue)\nor stay with I was able to make work", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r526085372", "createdAt": "2020-11-18T13:26:01Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQxMTQ5NQ==", "bodyText": "I'm not sure I understand the doc gen issue. @gsmet Hi Guiilaume, can you comment please as well ?", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r526411495", "createdAt": "2020-11-18T20:50:07Z", "author": {"login": "sberyozkin"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyNzIyNg==", "bodyText": "to be explicit, here is the generated html with property public Map<String, List<String>> secretConfigKvPathPrefix:\n<tr>\n<td class=\"tableblock halign-left valign-top\"><div class=\"content\"><div class=\"paragraph\">\n<p><a id=\"quarkus-vault_quarkus.vault.secret-config-kv-path-prefix-secret-config-kv-path-prefix\"></a><code><a href=\"#quarkus-vault_quarkus.vault.secret-config-kv-path-prefix-secret-config-kv-path-prefix\">quarkus.vault.secret-config-kv-path-prefix</a></code></p>\n</div>\n<div class=\"openblock description\">\n<div class=\"content\">\n<div class=\"paragraph\">\n<p>List of comma separated vault paths in kv store,\nwhere all properties will be available as <strong>prefixed</strong> MP config properties.</p>\n</div>\n<div class=\"paragraph\">\n<p>For instance if the application properties contains\n<code>quarkus.vault.secret-config-kv-path-prefix.myprefix=config</code>, and\nvault path <code>secret/config</code> contains <code>foo=bar</code>, then <code>myprefix.foo</code>\nwill be available in the MP config.</p>\n</div>\n<div class=\"paragraph\">\n<p>If the same property is available in 2 different paths for the same prefix, the last one\nwill win.</p>\n</div>\n<div class=\"paragraph\">\n<p>See also the documentation for the <code>kv-secret-engine-mount-path</code> property for some insights on how\nthe full Vault url gets built.</p>\n</div>\n</div>\n</div></div></td>\n<td class=\"tableblock halign-left valign-middle\"><p class=\"tableblock\"><code>Map&lt;String,List&lt;String&gt;&gt;</code></p></td>\n<td class=\"tableblock halign-left valign-middle\"></td>\n</tr>\n\nYou can see the name is quarkus.vault.secret-config-kv-path-prefix and the type is Map&lt;String,List&lt;String&gt;&gt;\nYou would hope that Map<String, List<String>> foo properties could be annotated with an attribute such as keyName=\"my-key\", so that we would have in the html:\n\nproperty name: quarkus.my-ext.foo.\"my-key\"\nproperty type: list of comma separated strings\n\nI think it is better to have the property correct in code, and work on the html renderer later, rather than compromise on the property name, just to make the html look good now.\nso I would go with your proposition @sberyozkin", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r526427226", "createdAt": "2020-11-18T21:18:55Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODU5MTc2Mg==", "bodyText": "@vsevel can you add a commit with your new proposal so that @machi1990 can have a look to the doc generation issue? Thanks!", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528591762", "createdAt": "2020-11-23T10:10:20Z", "author": {"login": "gsmet"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODYxMDQ5MA==", "bodyText": "@vsevel tag me along once that is done. I'll be able to have a look at this as part of this PR or on separate follow up PR.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528610490", "createdAt": "2020-11-23T10:41:59Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY0MzE3Nw==", "bodyText": "hi @machi1990 thanks for your help\nI have committed the change\nhere is the associated code", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528643177", "createdAt": "2020-11-23T11:42:10Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg2NjEzNQ==", "bodyText": "Thanks @vsevel looking at the thread again,  normally a @ConfigDocMapKey(\"prefix\") should have fixed the issue.\nbut this won't work since the map is a \"pass through map\" i.e it does not point to a @ConfigGroup but point to a terminal type e.g String, List, Duration etc. For those kind of maps we do not append the prefix but instead show the type of the map with expected generic values in this case Map<String, List<String>>.\nI've added vsevel@cd98df9 to the on top of your change. Let me know if that works for you.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528866135", "createdAt": "2020-11-23T17:13:16Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODkyOTc2Mg==", "bodyText": "@machi1990 I have seen your commit, and I think you are reverting back to my original quarkus.vault.secret-config-kv-prefix.X.paths proposition that @sberyozkin challenged, and counter-proposed quarkus.vault.secret-config-kv-path-prefix.X\nI was able to make this work. but it did not feel right to Sergey, and I agree with him on this.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528929762", "createdAt": "2020-11-23T19:01:30Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk1NTgzNw==", "bodyText": "@machi1990 I have seen your commit, and I think you are reverting back to my original quarkus.vault.secret-config-kv-prefix.X.paths proposition that @sberyozkin challenged, and counter-proposed quarkus.vault.secret-config-kv-path-prefix.X\nI was able to make this work. but it did not feel right to Sergey, and I agree with him on this.\n\n@vsevel not quite the same approach, I am using parent naming\n  @ConfigItem(name = ConfigItem.PARENT)\n   List<String> paths;\nThis means that the paths  will inherit the enclosing group name and the final configuration will be  quarkus.vault.secret-config-kv-path-prefix.\"prefix\". See a screenshot of the attached generated doc.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528955837", "createdAt": "2020-11-23T19:48:43Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk1NzU4MQ==", "bodyText": "@vsevel I noticed a test failure and had to force push on top of my initial commit.\nDo you mind re-checking this and see if it fits @sberyozkin for the suggested naming and your own requirement for the doc?", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r528957581", "createdAt": "2020-11-23T19:51:47Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc3Mzk2OA==", "bodyText": "hi @machi1990 it looks very good indeed. 2 minor comments: is it possible to make it not required (i.e. the map could be empty)? and would it be possible to make it named quarkus.vault.secret-config-kv-path.\"prefix\" instead of quarkus.vault.secret-config-kv-path-prefix.\"prefix\" (which was @sberyozkin 's initial request) - knowing that there is already a property quarkus.vault.secret-config-kv-path. (with no prefix), which might end up colliding?\nI rebuilt the full project, and all tests passed for me.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r529773968", "createdAt": "2020-11-24T18:01:37Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgxNzYzMw==", "bodyText": "I think Map are optional by default. In regard to the name \"quarkus.vault.secret-config-kv-path-prefix.\"prefix\"\", I think if we change the field name of the map, it will do it. I might have missed it when doing the refactor. I'll push a commit.\nEdit: I've no way to test it, can you change the field to\n /**\n     * KV store paths configuration.\n     */\n    @ConfigItem(name = \"secret-config-kv-path\")\n    @ConfigDocMapKey(\"prefix\")\n    public Map<String, KvPathConfig> secretConfigKvPathPrefix;\nAnd test if that works. From the doc generation perspective it should work, but I'll like the map will have an empty prefix if quarkus.vault.secret-config-kv-path=path1,path2 is given. So this brings question of whether the old property\n@ConfigItem\n public Optional<List<String>> secretConfigKvPath;\nwould still be needed as you can infer it from secretConfigKvPathPrefix.\nCan you try it out and let me know? Thanks.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r529817633", "createdAt": "2020-11-24T19:13:59Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTg1Nzk5OA==", "bodyText": "hello @machi1990, I specified:\n    @ConfigItem(name = \"secret-config-kv-path\")\n    @ConfigDocMapKey(\"prefix\")\n    public Map<String, KvPathConfig> secretConfigKvPathPrefix;\n\nThen I tried 2 things:\nwithout public Optional<List<String>> secretConfigKvPath\nwith properties:\nquarkus.vault.secret-config-kv-path=multi/default1,multi/default2\nquarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n\nI get:\nconfig secretConfigKvPath = Optional.empty\nconfig secretConfigKvPathPrefix = {singer=SecretConfigKvPathConfig{paths=[multi/singer1, multi/singer2]}}\n\nso this does not work as hoped. we would have expected to have another entry for entry key \"\" and value multi/default1,multi/default2.\nwith public Optional<List<String>> secretConfigKvPath\nI get:\nconfig secretConfigKvPath = Optional[[multi/default1, multi/default2]]\nconfig secretConfigKvPathPrefix = {singer=SecretConfigKvPathConfig{paths=[multi/singer1, multi/singer2]}}\n\nso we have to have the additional secretConfigKvPath variable, but that is a very small compromise.\nI tried also using an Optional<Map<String, KvPathConfig>> secretConfigKvPathPrefix, but initialization fails with a  No Converter registered for class io.quarkus.vault.runtime.config.VaultRuntimeConfig$KvPathConfig.\nso apart from having to keep an extra var secretConfigKvPath to handle the case of the empty prefix, and the secretConfigKvPathPrefix that is marked required in doc this looks perfect.\nany opportunity to solve those 2 issues, or we call it a day?\nI pushed cec6dd2e\nthanks again.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r529857998", "createdAt": "2020-11-24T20:28:02Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTg4NTg3NA==", "bodyText": "Thanks @vsevel for checking it out.\nLet's keep the public Optional<List<String>> secretConfigKvPath then and glad the proposed approach work out.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r529885874", "createdAt": "2020-11-24T21:21:58Z", "author": {"login": "machi1990"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIyODE0NQ==", "bodyText": "sounds good. thanks so much for your help @machi1990", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r530228145", "createdAt": "2020-11-25T09:33:16Z", "author": {"login": "vsevel"}, "path": "integration-tests/vault/src/test/resources/application-vault-multi-path.properties", "diffHunk": "@@ -2,7 +2,7 @@ quarkus.vault.url=https://localhost:8200\n quarkus.vault.authentication.userpass.username=bob\n quarkus.vault.authentication.userpass.password=sinclair\n quarkus.vault.secret-config-kv-path=multi/default1,multi/default2\n-quarkus.vault.secret-config-kv-path.singer=multi/singer1,multi/singer2\n+quarkus.vault.secret-config-kv-prefix.singer.paths=multi/singer1,multi/singer2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU4NTcwMg=="}, "originalCommit": {"oid": "1eca99cfcb40d131be7ace1872635990cfe734f5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyMzQwNTkwOnYy", "diffSide": "RIGHT", "path": "extensions/vault/runtime/src/main/java/io/quarkus/vault/runtime/config/VaultSecretConfigKvPrefixPathsConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMjowMjoyMFrOH5XbEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwOTozMjozMlrOH5qhyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTkxNDY0MA==", "bodyText": "This class is no longer used, right? We can remove this or and keep https://github.com/quarkusio/quarkus/pull/13300/files#diff-ccdd86f7203916d7b0e179ba75491f1b532fe12f8c747f676b28ef0a05950420R263 with proper renaming or vice versa.", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r529914640", "createdAt": "2020-11-24T22:02:20Z", "author": {"login": "machi1990"}, "path": "extensions/vault/runtime/src/main/java/io/quarkus/vault/runtime/config/VaultSecretConfigKvPrefixPathsConfig.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package io.quarkus.vault.runtime.config;\n+\n+import java.util.List;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class VaultSecretConfigKvPrefixPathsConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cec6dd2e95d2d97cd06910573892d6d07a76103f"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDIyNzY1Ng==", "bodyText": "you are correct. I have cleaned up the obsolete code. thanks", "url": "https://github.com/quarkusio/quarkus/pull/13300#discussion_r530227656", "createdAt": "2020-11-25T09:32:32Z", "author": {"login": "vsevel"}, "path": "extensions/vault/runtime/src/main/java/io/quarkus/vault/runtime/config/VaultSecretConfigKvPrefixPathsConfig.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package io.quarkus.vault.runtime.config;\n+\n+import java.util.List;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+\n+@ConfigGroup\n+public class VaultSecretConfigKvPrefixPathsConfig {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTkxNDY0MA=="}, "originalCommit": {"oid": "cec6dd2e95d2d97cd06910573892d6d07a76103f"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3919, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}