{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2NzQ1ODky", "number": 12470, "title": "Update SmallRye Reactive Messaging to 2.4.0 and Mutiny to 0.9.0", "bodyText": "This PR updates SmallRye Reactive Messaging to version 2.4.0.\nNoteworthy changes:\n\n\nCore\n\nHealth checks improvements\nMessage converter support to transform messages on the fly\nMutiny emitter (#11572)\n\n\n\nKafka\n\nNew Kafka Record payload type to simplify the reception and sending of key/value pair\nDisable auto commit by default\nNew commit strategy (auto-commit, latest, throttled)\nCloud Event support\nTracing support with Open Telemetry (#9449)\n\n\n\nAMQP\n\nAMQP TTL fix\n\n\n\nFull release note: https://github.com/smallrye/smallrye-reactive-messaging/releases/tag/2.4.0\n\nFixes #11572\nFixes #12454\nFixes #10265", "createdAt": "2020-10-02T07:50:16Z", "url": "https://github.com/quarkusio/quarkus/pull/12470", "merged": true, "mergeCommit": {"oid": "64f01df0e620315cdc5e1ed2e40f802d23561af4"}, "closed": true, "closedAt": "2020-10-03T06:34:48Z", "author": {"login": "cescoffier"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOmgbJgFqTUwMTE2Mzk2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOnc9LAFqTUwMTIyMDMzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMTYzOTY3", "url": "https://github.com/quarkusio/quarkus/pull/12470#pullrequestreview-501163967", "createdAt": "2020-10-02T14:03:30Z", "commit": {"oid": "45bd6b444d701883314a34959b64b25582d9c884"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNDowMzozMFrOHbu5QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNDowMzozMFrOHbu5QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg0MTkyMQ==", "bodyText": "As this is being used to retrieve the blocking annotation as well, maybe rename to getAnnotation and change onOverflowAnnotation to onAnnotation?", "url": "https://github.com/quarkusio/quarkus/pull/12470#discussion_r498841921", "createdAt": "2020-10-02T14:03:30Z", "author": {"login": "kenfinnigan"}, "path": "extensions/smallrye-reactive-messaging/deployment/src/main/java/io/quarkus/smallrye/reactivemessaging/deployment/SmallRyeReactiveMessagingProcessor.java", "diffHunk": "@@ -221,27 +201,37 @@ void validateBeanDeployment(\n                                             .getTargetInfo()));\n                 } else {\n                     String channelName = instance.value().asString();\n-                    Optional<AnnotationInstance> overflow = annotationStore.getAnnotations(injectionPoint.getTarget())\n-                            .stream()\n-                            .filter(ai -> ReactiveMessagingDotNames.LEGACY_ON_OVERFLOW\n-                                    .equals(ai.name()))\n-                            .filter(ai -> {\n-                                if (ai.target().kind() == AnnotationTarget.Kind.METHOD_PARAMETER && injectionPoint\n-                                        .isParam()) {\n-                                    return ai.target().asMethodParameter().position() == injectionPoint.getPosition();\n-                                }\n-                                return true;\n-                            })\n-                            .findAny();\n+                    Optional<AnnotationInstance> overflow = getOverflow(annotationStore, injectionPoint,\n+                            ReactiveMessagingDotNames.LEGACY_ON_OVERFLOW);\n \n                     createEmitter(emitters, injectionPoint, channelName, overflow, broadcast);\n                 }\n             }\n         }\n     }\n \n+    private Optional<AnnotationInstance> getOverflow(AnnotationStore annotationStore, InjectionPointInfo injectionPoint,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45bd6b444d701883314a34959b64b25582d9c884"}, "originalPosition": 94}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "624f82cb254b98ab65866f60881d851b2b0d28d4", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/624f82cb254b98ab65866f60881d851b2b0d28d4", "committedDate": "2020-10-02T14:35:53Z", "message": "Update SmallRye Reactive Messaging to version 2.4.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79f6d82eb184117cf976654d800f9d3fc7a79021", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/79f6d82eb184117cf976654d800f9d3fc7a79021", "committedDate": "2020-10-02T14:35:56Z", "message": "Integrate the expected payload type extraction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3598333e0dade31d6ee725f488b0b9695ce9f9e8", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/3598333e0dade31d6ee725f488b0b9695ce9f9e8", "committedDate": "2020-10-02T14:35:56Z", "message": "Move all emitter and channel tests in a dedicated package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62d0df3f7d78b4452b1ad44fde5a5cfd6b4758cb", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/62d0df3f7d78b4452b1ad44fde5a5cfd6b4758cb", "committedDate": "2020-10-02T14:38:20Z", "message": "Add support for mutiny emitter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "363ac6a1fdf8cda790e60653ff6e42c9574017b5", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/363ac6a1fdf8cda790e60653ff6e42c9574017b5", "committedDate": "2020-10-02T14:38:22Z", "message": "Implement converter support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d1b4d7b637d949725b69a5efff7a1685117a6e5", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/6d1b4d7b637d949725b69a5efff7a1685117a6e5", "committedDate": "2020-10-02T14:38:22Z", "message": "Integrate the update of the MutinyEmitter API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "committedDate": "2020-10-02T14:38:22Z", "message": "Update Mutiny to 0.9.0 (performance fix)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "45bd6b444d701883314a34959b64b25582d9c884", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/45bd6b444d701883314a34959b64b25582d9c884", "committedDate": "2020-10-02T07:39:35Z", "message": "Update Mutiny to 0.9.0 (performance fix)"}, "afterCommit": {"oid": "ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "author": {"user": {"login": "cescoffier", "name": "Clement Escoffier"}}, "url": "https://github.com/quarkusio/quarkus/commit/ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d", "committedDate": "2020-10-02T14:38:22Z", "message": "Update Mutiny to 0.9.0 (performance fix)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMjIwMzMw", "url": "https://github.com/quarkusio/quarkus/pull/12470#pullrequestreview-501220330", "createdAt": "2020-10-02T15:10:06Z", "commit": {"oid": "ab8ba2627c05bbe1f7be5048cb5e3bcd8cbc330d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1839, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}