{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MTQxMjM1", "number": 7226, "title": "Introduce QuarkusProdModeTest", "bodyText": "The main motivation is to get rid of maven invoker style tests that are pretty much impossible to debug", "createdAt": "2020-02-17T13:37:52Z", "url": "https://github.com/quarkusio/quarkus/pull/7226", "merged": true, "mergeCommit": {"oid": "13c054a80c7d60d786dc7b75fb3c950e0bed0f32"}, "closed": true, "closedAt": "2020-02-18T11:27:39Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFO3_iABqjMwNDQxMDg4MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFgKk0gFqTM2MDI2MTI5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c29b1b4e11f7a20ea1f803e9b34ae216fa72936c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/c29b1b4e11f7a20ea1f803e9b34ae216fa72936c", "committedDate": "2020-02-17T13:35:39Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}, "afterCommit": {"oid": "4ec78903638d3c12a422808bd306d7281d008d90", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/4ec78903638d3c12a422808bd306d7281d008d90", "committedDate": "2020-02-17T15:11:54Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5ODE1ODQ0", "url": "https://github.com/quarkusio/quarkus/pull/7226#pullrequestreview-359815844", "createdAt": "2020-02-17T15:27:55Z", "commit": {"oid": "4ec78903638d3c12a422808bd306d7281d008d90"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNToyNzo1NVrOFqoTsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNToyNzo1NVrOFqoTsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI0NDkxMg==", "bodyText": "If we are doing that, why not copy them while walking the dependency tree?", "url": "https://github.com/quarkusio/quarkus/pull/7226#discussion_r380244912", "createdAt": "2020-02-17T15:27:55Z", "author": {"login": "aloubyansky"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/JarResultBuildStep.java", "diffHunk": "@@ -415,43 +434,71 @@ private void doThinJarGeneration(CurateOutcomeBuildItem curateOutcomeBuildItem,\n \n         final List<AppDependency> appDeps = curateOutcomeBuildItem.getEffectiveModel().getUserDependencies();\n \n-        copyLibraryJars(transformedClasses, libDir, classPath, appDeps);\n+        Map<AppDependency, List<Path>> classesOfNonJarDependencies = copyLibraryJars(transformedClasses, libDir, classPath,\n+                appDeps, services);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ec78903638d3c12a422808bd306d7281d008d90"}, "originalPosition": 159}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ec78903638d3c12a422808bd306d7281d008d90", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/4ec78903638d3c12a422808bd306d7281d008d90", "committedDate": "2020-02-17T15:11:54Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}, "afterCommit": {"oid": "1e03eb3c240831ee117815cd2416fb3e8a6a9ddb", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/1e03eb3c240831ee117815cd2416fb3e8a6a9ddb", "committedDate": "2020-02-17T15:38:56Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5ODIzOTI2", "url": "https://github.com/quarkusio/quarkus/pull/7226#pullrequestreview-359823926", "createdAt": "2020-02-17T15:39:52Z", "commit": {"oid": "4ec78903638d3c12a422808bd306d7281d008d90"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1e03eb3c240831ee117815cd2416fb3e8a6a9ddb", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/1e03eb3c240831ee117815cd2416fb3e8a6a9ddb", "committedDate": "2020-02-17T15:38:56Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}, "afterCommit": {"oid": "8b97f8890ef94104fdfa74c999485c7037a07e0c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/8b97f8890ef94104fdfa74c999485c7037a07e0c", "committedDate": "2020-02-17T20:32:59Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b97f8890ef94104fdfa74c999485c7037a07e0c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/8b97f8890ef94104fdfa74c999485c7037a07e0c", "committedDate": "2020-02-17T20:32:59Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}, "afterCommit": {"oid": "93225491e60737a360f25447ac1d75a6c9125656", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/93225491e60737a360f25447ac1d75a6c9125656", "committedDate": "2020-02-17T20:36:33Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5OTk1MDkz", "url": "https://github.com/quarkusio/quarkus/pull/7226#pullrequestreview-359995093", "createdAt": "2020-02-17T22:52:37Z", "commit": {"oid": "93225491e60737a360f25447ac1d75a6c9125656"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QyMjo1MjozOFrOFqxL6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QyMjo1MjozOFrOFqxL6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDM5MDM3Ng==", "bodyText": "Wouldn't !Files.isDirectory() be more appropriate here? I know it is not likely to happen but you could have a directory that ends in .jar.", "url": "https://github.com/quarkusio/quarkus/pull/7226#discussion_r380390376", "createdAt": "2020-02-17T22:52:38Z", "author": {"login": "stuartwdouglas"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/JarResultBuildStep.java", "diffHunk": "@@ -284,6 +237,72 @@ public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)\n         return new JarBuildItem(runnerJar, originalJar, null);\n     }\n \n+    private boolean isAppDepAJar(AppArtifact artifact) {\n+        return \"jar\".equals(artifact.getType());\n+    }\n+\n+    private boolean isAppDepPathAJar(AppArtifact artifact) {\n+        return artifact.getPath().getFileName().toString().endsWith(\".jar\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93225491e60737a360f25447ac1d75a6c9125656"}, "originalPosition": 89}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c5f62dfa22294ac503bde999a3271c8eb9b7e54", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/5c5f62dfa22294ac503bde999a3271c8eb9b7e54", "committedDate": "2020-02-18T07:10:24Z", "message": "Ensure that Quarkus dependencies picked up by localProjectDiscovery are copied to jar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef99352cafcc1c7e544df0973d8c89670a045eb6", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/ef99352cafcc1c7e544df0973d8c89670a045eb6", "committedDate": "2020-02-18T07:10:28Z", "message": "Introduce QuarkusProdModeTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28e2b6a1b22f93aa2bcf53a56165446c1c26f7da", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/28e2b6a1b22f93aa2bcf53a56165446c1c26f7da", "committedDate": "2020-02-18T07:11:45Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93225491e60737a360f25447ac1d75a6c9125656", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/93225491e60737a360f25447ac1d75a6c9125656", "committedDate": "2020-02-17T20:36:33Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}, "afterCommit": {"oid": "28e2b6a1b22f93aa2bcf53a56165446c1c26f7da", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/28e2b6a1b22f93aa2bcf53a56165446c1c26f7da", "committedDate": "2020-02-18T07:11:45Z", "message": "Convert kubernetes integration tests to QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwMjYxMjkw", "url": "https://github.com/quarkusio/quarkus/pull/7226#pullrequestreview-360261290", "createdAt": "2020-02-18T11:24:13Z", "commit": {"oid": "28e2b6a1b22f93aa2bcf53a56165446c1c26f7da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4983, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}