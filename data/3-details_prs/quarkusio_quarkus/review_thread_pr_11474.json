{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMjg3OTk5", "number": 11474, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNToyNTowOVrOEalc-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNToyNjo0NVrOEalfwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzEyMDU4OnYy", "diffSide": "RIGHT", "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/CodestartProcessor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNToyNTowOVrOHEG0og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzowODo0NFrOHEeTsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2ODEzMA==", "bodyText": "What's wrong with \"*\".equals(codestartFileStrategy.getFilter()) ? \ud83d\ude1b", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474068130", "createdAt": "2020-08-20T15:25:09Z", "author": {"login": "gastaldi"}, "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/CodestartProcessor.java", "diffHunk": "@@ -137,12 +132,25 @@ public void writeFiles() throws IOException {\n         for (Map.Entry<String, List<CodestartFile>> e : files.entrySet()) {\n             final String relativePath = e.getKey();\n             Files.createDirectories(targetDirectory.resolve(relativePath).getParent());\n-            getStrategy(relativePath).orElse(CodestartFileStrategyHandler.DEFAULT_STRATEGY)\n+            getStrategy(relativePath).orElse(getSelectedDefaultStrategy())\n                     .process(targetDirectory, relativePath, e.getValue(), data);\n         }\n     }\n \n-    private Optional<CodestartFileStrategyHandler> getStrategy(final String key) {\n+    DefaultCodestartFileStrategyHandler getSelectedDefaultStrategy() {\n+        for (CodestartFileStrategy codestartFileStrategy : strategies) {\n+            if (Objects.equals(codestartFileStrategy.getFilter(), \"*\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MjkxMg==", "bodyText": "I guess the result is the same but I always favor Objects.equals then I don't have to think too much about NPE (even if in that case it's not the case :p)", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474452912", "createdAt": "2020-08-21T07:08:44Z", "author": {"login": "ia3andy"}, "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/CodestartProcessor.java", "diffHunk": "@@ -137,12 +132,25 @@ public void writeFiles() throws IOException {\n         for (Map.Entry<String, List<CodestartFile>> e : files.entrySet()) {\n             final String relativePath = e.getKey();\n             Files.createDirectories(targetDirectory.resolve(relativePath).getParent());\n-            getStrategy(relativePath).orElse(CodestartFileStrategyHandler.DEFAULT_STRATEGY)\n+            getStrategy(relativePath).orElse(getSelectedDefaultStrategy())\n                     .process(targetDirectory, relativePath, e.getValue(), data);\n         }\n     }\n \n-    private Optional<CodestartFileStrategyHandler> getStrategy(final String key) {\n+    DefaultCodestartFileStrategyHandler getSelectedDefaultStrategy() {\n+        for (CodestartFileStrategy codestartFileStrategy : strategies) {\n+            if (Objects.equals(codestartFileStrategy.getFilter(), \"*\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2ODEzMA=="}, "originalCommit": {"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzEyNzY4OnYy", "diffSide": "RIGHT", "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/strategy/ReplaceCodestartFileStrategyHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNToyNjo0NVrOHEG47A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzowNjoyNlrOHEeM2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2OTIyOA==", "bodyText": "This throws FileAlreadyExistsException if targetPath.getParent() already exists", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474069228", "createdAt": "2020-08-20T15:26:45Z", "author": {"login": "gastaldi"}, "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/strategy/ReplaceCodestartFileStrategyHandler.java", "diffHunk": "@@ -4,16 +4,23 @@\n import java.io.IOException;\n import java.nio.file.Files;\n import java.nio.file.Path;\n+import java.nio.file.StandardCopyOption;\n import java.util.List;\n import java.util.Map;\n \n-final class ReplaceCodestartFileStrategyHandler implements CodestartFileStrategyHandler {\n+final class ReplaceCodestartFileStrategyHandler implements DefaultCodestartFileStrategyHandler {\n \n     @Override\n     public String name() {\n         return \"replace\";\n     }\n \n+    @Override\n+    public void copyStaticFile(Path sourcePath, Path targetPath) throws IOException {\n+        Files.createDirectories(targetPath.getParent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MTE2MA==", "bodyText": "@gastaldi yeah, only if the file exists AND is not a directory, which makes sense here:\n\"Creates a directory by creating all nonexistent parent directories first. Unlike the createDirectory method, an exception is NOT thrown if the directory could not be created because it already exists.\"", "url": "https://github.com/quarkusio/quarkus/pull/11474#discussion_r474451160", "createdAt": "2020-08-21T07:06:26Z", "author": {"login": "ia3andy"}, "path": "independent-projects/tools/codestarts/src/main/java/io/quarkus/devtools/codestarts/strategy/ReplaceCodestartFileStrategyHandler.java", "diffHunk": "@@ -4,16 +4,23 @@\n import java.io.IOException;\n import java.nio.file.Files;\n import java.nio.file.Path;\n+import java.nio.file.StandardCopyOption;\n import java.util.List;\n import java.util.Map;\n \n-final class ReplaceCodestartFileStrategyHandler implements CodestartFileStrategyHandler {\n+final class ReplaceCodestartFileStrategyHandler implements DefaultCodestartFileStrategyHandler {\n \n     @Override\n     public String name() {\n         return \"replace\";\n     }\n \n+    @Override\n+    public void copyStaticFile(Path sourcePath, Path targetPath) throws IOException {\n+        Files.createDirectories(targetPath.getParent());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2OTIyOA=="}, "originalCommit": {"oid": "bbe207d183f7bf14e3a3e30687cef8560c866d4c"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 607, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}