{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyNDExNzcw", "number": 13694, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwOTo0MToxN1rOFAtqJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwOTo0MToxN1rOFAtqJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MjkyMzkxOnYy", "diffSide": "RIGHT", "path": "extensions/hibernate-orm/deployment/src/test/java/io/quarkus/hibernate/orm/multiplepersistenceunits/MultiplePersistenceUnitsCdiSessionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwOTo0MToxN1rOH_IxGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwOTo0NzoxOVrOH_JBYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk2NTk3Ng==", "bodyText": "ok that's interesting. Didn't expect to be able to combine PersistenceUnit on Session, but it's nice.", "url": "https://github.com/quarkusio/quarkus/pull/13694#discussion_r535965976", "createdAt": "2020-12-04T09:41:17Z", "author": {"login": "Sanne"}, "path": "extensions/hibernate-orm/deployment/src/test/java/io/quarkus/hibernate/orm/multiplepersistenceunits/MultiplePersistenceUnitsCdiSessionTest.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package io.quarkus.hibernate.orm.multiplepersistenceunits;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import javax.inject.Inject;\n+import javax.transaction.Transactional;\n+\n+import org.hibernate.Session;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+\n+import io.quarkus.hibernate.orm.PersistenceUnit;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.DefaultEntity;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.inventory.Plane;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.user.User;\n+import io.quarkus.test.QuarkusUnitTest;\n+\n+public class MultiplePersistenceUnitsCdiSessionTest {\n+\n+    @RegisterExtension\n+    static QuarkusUnitTest runner = new QuarkusUnitTest()\n+            .setArchiveProducer(() -> ShrinkWrap.create(JavaArchive.class)\n+                    .addClass(DefaultEntity.class)\n+                    .addClass(User.class)\n+                    .addClass(Plane.class)\n+                    .addAsResource(\"application-multiple-persistence-units.properties\", \"application.properties\"));\n+\n+    @Inject\n+    Session defaultSession;\n+\n+    @Inject\n+    @PersistenceUnit(\"users\")\n+    Session usersSession;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "219c4505dba96fdf3e33c53dca3562854a171a6f"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk3MDE0NQ==", "bodyText": "This is Quarkus' own PersistenceUnit annotation, io.quarkus.hibernate.orm.PersistenceUnit. With the standard annotations you have to use @PersistenceContext; see MultiplePersistenceUnitsResourceInjectionSessionTest or SinglePersistenceUnitResourceInjectionSessionTest.", "url": "https://github.com/quarkusio/quarkus/pull/13694#discussion_r535970145", "createdAt": "2020-12-04T09:47:19Z", "author": {"login": "yrodiere"}, "path": "extensions/hibernate-orm/deployment/src/test/java/io/quarkus/hibernate/orm/multiplepersistenceunits/MultiplePersistenceUnitsCdiSessionTest.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package io.quarkus.hibernate.orm.multiplepersistenceunits;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import javax.inject.Inject;\n+import javax.transaction.Transactional;\n+\n+import org.hibernate.Session;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+\n+import io.quarkus.hibernate.orm.PersistenceUnit;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.DefaultEntity;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.inventory.Plane;\n+import io.quarkus.hibernate.orm.multiplepersistenceunits.model.config.user.User;\n+import io.quarkus.test.QuarkusUnitTest;\n+\n+public class MultiplePersistenceUnitsCdiSessionTest {\n+\n+    @RegisterExtension\n+    static QuarkusUnitTest runner = new QuarkusUnitTest()\n+            .setArchiveProducer(() -> ShrinkWrap.create(JavaArchive.class)\n+                    .addClass(DefaultEntity.class)\n+                    .addClass(User.class)\n+                    .addClass(Plane.class)\n+                    .addAsResource(\"application-multiple-persistence-units.properties\", \"application.properties\"));\n+\n+    @Inject\n+    Session defaultSession;\n+\n+    @Inject\n+    @PersistenceUnit(\"users\")\n+    Session usersSession;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk2NTk3Ng=="}, "originalCommit": {"oid": "219c4505dba96fdf3e33c53dca3562854a171a6f"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3779, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}