{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMjg0MTYx", "number": 12683, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODowOFrOEtDHlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODo0MFrOEtDIug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NjcyNDY4OnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODowOFrOHgnrfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxNDowODoxMFrOHgop5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ==", "bodyText": "What's the deal with this?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503966591", "createdAt": "2020-10-13T13:48:08Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk3NDc4Mg==", "bodyText": "@geoand can you give a more detailed comment, please?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503974782", "createdAt": "2020-10-13T13:58:11Z", "author": {"login": "xumk"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ=="}, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk3NDg0Mw==", "bodyText": "And shouldn't we call close();?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503974843", "createdAt": "2020-10-13T13:58:16Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ=="}, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk3Nzg4NQ==", "bodyText": "Good catch. I think deploymentProblem = rootCause; needs to be assigned here and System.exit shouldn't be explicitly called?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503977885", "createdAt": "2020-10-13T14:02:07Z", "author": {"login": "gastaldi"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ=="}, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk4MjU0Nw==", "bodyText": "Yeah, I don't see why System.exit is being called here. Can you explain?", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503982547", "createdAt": "2020-10-13T14:08:09Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ=="}, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk4MjU2NA==", "bodyText": "@gastaldi ok. I added it", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503982564", "createdAt": "2020-10-13T14:08:10Z", "author": {"login": "xumk"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {\n+                    int port = ConfigProviderResolver.instance().getConfig()\n+                            .getOptionalValue(\"quarkus.http.port\", Integer.class).orElse(8080);\n+                    log.error(\"Port \" + port + \" seems to be in use by another process. \" +\n+                            \"Quarkus may already be running or the port is used by another application.\");\n+                    if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+                        log.info(\"Use 'netstat -a -b -n -o' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'taskkill /PID <pid>' or via the Task Manager.\");\n+                    } else {\n+                        log.info(\"Use 'netstat -anop | grep \" + port + \"' to identify the process occupying the port.\");\n+                        log.info(\"You can try to kill it with 'kill -9 <pid>'.\");\n+                    }\n+                    System.exit(-1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NjU5MQ=="}, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NjcyNzYyOnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODo0MFrOHgntTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo0ODo0MFrOHgntTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NzA1Mw==", "bodyText": "These error messages are super useful, thanks!", "url": "https://github.com/quarkusio/quarkus/pull/12683#discussion_r503967053", "createdAt": "2020-10-13T13:48:40Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/dev/IsolatedDevModeMain.java", "diffHunk": "@@ -108,9 +109,28 @@ public void accept(Integer integer) {\n                 runner = start.runMainClass(context.getArgs());\n                 firstStartCompleted = true;\n             } catch (Throwable t) {\n-                deploymentProblem = t;\n-                if (!augmentDone) {\n-                    log.error(\"Failed to start quarkus\", t);\n+                Throwable rootCause = t;\n+                while (rootCause.getCause() != null) {\n+                    rootCause = rootCause.getCause();\n+                }\n+                if (rootCause instanceof BindException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "981011f3b063cca6bb560a807487437739103cb8"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4294, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}