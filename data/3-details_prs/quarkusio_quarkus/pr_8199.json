{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MjMyMjQx", "number": 8199, "title": "Added ability for custom manifest entries in MANIFEST.MF", "bodyText": "Building off work done in PR 4698.\nUser would just need to specify the new Manifest Entries in the quarkus-maven-plugin configuration of their pom files.\nThe BuildMojo will parse this configuration and add them to the Properties passed to the Quarkus Builder.\nJarResultBuildSteps will parse that property and add the values into the Manifest entires.\nTest are performed in the PackageIT to verify these entries are not available when the pom doesn't specify them, and they are available in the manifest when the configuration is added to the pom.", "createdAt": "2020-03-26T15:12:28Z", "url": "https://github.com/quarkusio/quarkus/pull/8199", "merged": true, "mergeCommit": {"oid": "6e7f7eb80de72caf96114491dfe912a39aab9c85"}, "closed": true, "closedAt": "2020-04-01T05:52:19Z", "author": {"login": "aaron-rogers82"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRjFp_gFqTM4MjQzODE0MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTRLWzAFqTM4NTI4MTQ0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDM4MTQw", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-382438140", "createdAt": "2020-03-26T21:35:38Z", "commit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTozNTozOVrOF8bXnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTozNTozOVrOF8bXnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwNzI5Mg==", "bodyText": "Configuration of the Mojo is really legacy at this point so there isn't much point in adding more. All Quarkus configuration is now done via the Quarkus Config System (of which ManifestConfig which you have already changed is a part)", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r398907292", "createdAt": "2020-03-26T21:35:39Z", "author": {"login": "geoand"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/BuildMojo.java", "diffHunk": "@@ -117,6 +121,31 @@\n     @Parameter(property = \"ignoredEntries\")\n     private String[] ignoredEntries;\n \n+    /**\n+     * Custom entries into the Manifest can be configured like:\n+     * <code><pre>\n+     * &#x3C;configuration&#x3E;\n+     *   &#x3C;manifestSections&#x3E;\n+     *     &#x3C;manifestSection&#x3E;\n+     *       &#x3C;name&#x3E;Custom Entries&#x3C;/name&#x3E;\n+     *       &#x3C;manifestEntries&#x3E;\n+     *          &#x3C;manifestEntry&#x3E;\n+     *             &#x3C;entryKey&#x3E;Entry_Key1&#x3C;/entryKey&#x3E;\n+     *             &#x3C;entryValue&#x3E;Entry Value 1&#x3C;/entryValue&#x3E;\n+     *          &#x3C;/manifestEntry&#x3E;\n+     *          &#x3C;manifestEntry&#x3E;\n+     *             &#x3C;entryKey&#x3E;Entry_Key2&#x3C;/entryKey&#x3E;\n+     *             &#x3C;entryValue&#x3E;Entry Value 2&#x3C;/entryValue&#x3E;\n+     *          &#x3C;/manifestEntry&#x3E;\n+     *       &#x3C;/manifestEntries&#x3E;\n+     *     &#x3C;/manifestSection&#x3E;\n+     *   &#x3C;/manifestSections&#x3E;\n+     * &#x3C;/configuration&#x3E;\n+     * </pre></code>\n+     */\n+    @Parameter(property = \"manifestSections\")\n+    private List<ManifestSection> manifestSections;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDQ4MDkz", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-382448093", "createdAt": "2020-03-26T21:53:43Z", "commit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTo1Mzo0NFrOF8b4iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTo1Mzo0NFrOF8b4iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkxNTcyMQ==", "bodyText": "We can probably drop this file", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r398915721", "createdAt": "2020-03-26T21:53:44Z", "author": {"login": "geoand"}, "path": "integration-tests/maven/src/test/resources/projects/custom-manifest-section/src/main/resources/META-INF/resources/index.html", "diffHunk": "@@ -0,0 +1,153 @@\n+<!DOCTYPE html>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDQ4NTEw", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-382448510", "createdAt": "2020-03-26T21:54:33Z", "commit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTo1NDozM1rOF8b5_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMTo1NDozM1rOF8b5_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkxNjA5NA==", "bodyText": "Let's put the configuration in the properties and not have the Mojo configuration at all, since that is how we expect users will configure things", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r398916094", "createdAt": "2020-03-26T21:54:33Z", "author": {"login": "geoand"}, "path": "integration-tests/maven/src/test/resources/projects/custom-manifest-section/pom.xml", "diffHunk": "@@ -0,0 +1,105 @@\n+<?xml version=\"1.0\"?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+  <modelVersion>4.0.0</modelVersion>\n+  <groupId>org.acme</groupId>\n+  <artifactId>acme</artifactId>\n+  <version>1.0-SNAPSHOT</version>\n+  <properties>\n+    <quarkus.platform.group-id>io.quarkus</quarkus.platform.group-id>\n+    <quarkus.platform.artifact-id>quarkus-bom</quarkus.platform.artifact-id>\n+    <quarkus.platform.version>@project.version@</quarkus.platform.version>\n+    <quarkus-plugin.version>@project.version@</quarkus-plugin.version>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+  </properties>\n+  <dependencyManagement>\n+    <dependencies>\n+      <dependency>\n+        <groupId>${quarkus.platform.group-id}</groupId>\n+        <artifactId>${quarkus.platform.artifact-id}</artifactId>\n+        <version>${quarkus.platform.version}</version>\n+        <type>pom</type>\n+        <scope>import</scope>\n+      </dependency>\n+    </dependencies>\n+  </dependencyManagement>\n+  <dependencies>\n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-resteasy</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-arc</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-junit5</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>io.rest-assured</groupId>\n+      <artifactId>rest-assured</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+  </dependencies>\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>io.quarkus</groupId>\n+        <artifactId>quarkus-maven-plugin</artifactId>\n+        <version>${quarkus-plugin.version}</version>\n+        <configuration>\n+          <manifestSections>\n+            <manifestSection>\n+              <name>Test Information</name>\n+              <manifestEntries>\n+                <manifestEntry>\n+                  <entryKey>Test-Key-1</entryKey>\n+                  <entryValue>Test Value 1</entryValue>\n+                </manifestEntry>\n+                <manifestEntry>\n+                  <entryKey>Test-Key-2</entryKey>\n+                  <entryValue>Test Value 2</entryValue>\n+                </manifestEntry>\n+              </manifestEntries>\n+            </manifestSection>\n+          </manifestSections>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyODIwNzE5", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-382820719", "createdAt": "2020-03-27T12:40:52Z", "commit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0MDo1MlrOF8vZUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0MDo1MlrOF8vZUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTIzNTQxMA==", "bodyText": "@geoand As we will just be using the property, should I simplify these separators to just \":\" and \"=\"?", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r399235410", "createdAt": "2020-03-27T12:40:52Z", "author": {"login": "aaron-rogers82"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/JarResultBuildStep.java", "diffHunk": "@@ -116,6 +116,9 @@\n     private static final OpenOption[] DEFAULT_OPEN_OPTIONS = { TRUNCATE_EXISTING, WRITE, CREATE };\n     private static final BiPredicate<Path, BasicFileAttributes> IS_JSON_FILE_PREDICATE = new IsJsonFilePredicate();\n \n+    private static final String MANIFEST_SECTION_SEPARATOR = \"::\";\n+    private static final String MANIFEST_ENTRY_KV_SEPARATOR = \"\\\\=\\\\|\\\\|\\\\=\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6acbbb107170f1eefeb674ad6ebd7aa8d9c4b02c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzODUwNTgy", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-383850582", "createdAt": "2020-03-30T13:26:26Z", "commit": {"oid": "1ae7dd2217d46284c7ad69166843528fae7832ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMzoyNjoyNlrOF9plfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMzoyNjoyNlrOF9plfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDE4ODc5Nw==", "bodyText": "@aloubyansky @stuartwdouglas are you OK with this format?", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r400188797", "createdAt": "2020-03-30T13:26:26Z", "author": {"login": "geoand"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/ManifestConfig.java", "diffHunk": "@@ -12,4 +15,11 @@\n     @ConfigItem(defaultValue = \"true\")\n     public boolean addImplementationEntries;\n \n+    /**\n+     * Custom manifest sections to be added to the MANIFEST.MF file.\n+     * An example of the user defined property:\n+     * quarkus.package.manifest.manifest-sections={Section Name}:{Key1}={Value1},{Section Name}:{Key2}={Value2}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ae7dd2217d46284c7ad69166843528fae7832ad"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MzMxMTc3", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-384331177", "createdAt": "2020-03-31T00:49:57Z", "commit": {"oid": "1ae7dd2217d46284c7ad69166843528fae7832ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwMDo0OTo1N1rOF-BaSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwMDo0OTo1N1rOF-BaSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTE0NA==", "bodyText": "I think it should be possible to test this using QuarkusProdModeTest rather than a maven integration test. QuarkusProdModeTest is much more lightweight and a lot faster to run, so should be used where possible.", "url": "https://github.com/quarkusio/quarkus/pull/8199#discussion_r400579144", "createdAt": "2020-03-31T00:49:57Z", "author": {"login": "stuartwdouglas"}, "path": "integration-tests/maven/src/test/resources/projects/custom-manifest-section/pom.xml", "diffHunk": "@@ -0,0 +1,90 @@\n+<?xml version=\"1.0\"?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ae7dd2217d46284c7ad69166843528fae7832ad"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0f72c85095bd1101924deb69b64ae6d02accfaa", "author": {"user": null}, "url": "https://github.com/quarkusio/quarkus/commit/f0f72c85095bd1101924deb69b64ae6d02accfaa", "committedDate": "2020-03-31T18:22:25Z", "message": "Added ability for custom manifest sections entries to be added to manifest.mf"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MjgxNDQ2", "url": "https://github.com/quarkusio/quarkus/pull/8199#pullrequestreview-385281446", "createdAt": "2020-04-01T05:51:26Z", "commit": {"oid": "f0f72c85095bd1101924deb69b64ae6d02accfaa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3646, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}