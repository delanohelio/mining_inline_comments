{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MjI3MzA4", "number": 6735, "title": "Micrometer compatibility mode for Metrics", "bodyText": "Fixes #6544", "createdAt": "2020-01-23T07:51:31Z", "url": "https://github.com/quarkusio/quarkus/pull/6735", "merged": true, "mergeCommit": {"oid": "bdebda3322ed908c89e1cfee37ad2a3e8912801e"}, "closed": true, "closedAt": "2020-01-30T15:09:37Z", "author": {"login": "jmartisk"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9FYQqAH2gAyMzY2MjI3MzA4OmJkZGM5YzYwNjQ2ZWFkN2JkOTJkNTZkMWNlODI5ZWQ1YmMzNjJkYjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-sfNqgFqTM0OTE3NzIzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0", "author": {"user": {"login": "jmartisk", "name": "Jan Martiska"}}, "url": "https://github.com/quarkusio/quarkus/commit/bddc9c60646ead7bd92d56d1ce829ed5bc362db0", "committedDate": "2020-01-23T07:40:20Z", "message": "Micrometer compatibility mode for Metrics"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NDE1MDIz", "url": "https://github.com/quarkusio/quarkus/pull/6735#pullrequestreview-348415023", "createdAt": "2020-01-27T00:44:25Z", "commit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwMDo0NDoyNVrOFh2jAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwMDo0NDoyNVrOFh2jAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA0MTAyNQ==", "bodyText": "thanks \ud83d\udc4d", "url": "https://github.com/quarkusio/quarkus/pull/6735#discussion_r371041025", "createdAt": "2020-01-27T00:44:25Z", "author": {"login": "wedamartinez"}, "path": "extensions/smallrye-metrics/deployment/src/main/java/io/quarkus/smallrye/metrics/deployment/SmallRyeMetricsProcessor.java", "diffHunk": "@@ -103,6 +103,15 @@\n         @ConfigItem(name = \"extensions.enabled\", defaultValue = \"true\")\n         public boolean extensionsEnabled;\n \n+        /**\n+         * Apply Micrometer compatibility mode, where instead of regular 'base' and 'vendor' metrics,\n+         * Quarkus exposes the same 'jvm' metrics that Micrometer does. Application metrics are unaffected by this mode.\n+         * The use case is to facilitate migration from Micrometer-based metrics, because original dashboards for JVM metrics\n+         * will continue working without having to rewrite them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc3MDMy", "url": "https://github.com/quarkusio/quarkus/pull/6735#pullrequestreview-349177032", "createdAt": "2020-01-28T07:47:36Z", "commit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0NzozNlrOFibkVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNzo0NzozNlrOFibkVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY0NzU3NA==", "bodyText": "I was just about to ask how the code knows to not expose metrics in GraalVM mode and stumbled upon this before I could :).\n\ud83d\udc4d", "url": "https://github.com/quarkusio/quarkus/pull/6735#discussion_r371647574", "createdAt": "2020-01-28T07:47:36Z", "author": {"login": "geoand"}, "path": "extensions/smallrye-metrics/runtime/src/main/java/io/quarkus/smallrye/metrics/runtime/SmallRyeMetricsRecorder.java", "diffHunk": "@@ -583,4 +604,193 @@ private void memoryPoolMetrics(MetricRegistry registry, List<String> names) {\n         }\n     }\n \n+    private void micrometerJvmGcMetrics(MetricRegistry registry, List<String> names, ShutdownContext shutdown) {\n+        if (!ImageInfo.inImageCode()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTc3MjM5", "url": "https://github.com/quarkusio/quarkus/pull/6735#pullrequestreview-349177239", "createdAt": "2020-01-28T07:48:09Z", "commit": {"oid": "bddc9c60646ead7bd92d56d1ce829ed5bc362db0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 128, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}