{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTYwMzgx", "number": 10283, "title": "Turn reactive datasource pools into synthetic beans", "bodyText": "resolves #10059", "createdAt": "2020-06-25T17:28:54Z", "url": "https://github.com/quarkusio/quarkus/pull/10283", "merged": true, "mergeCommit": {"oid": "51d385ae5fcb909921899f3692331c3560afdeec"}, "closed": true, "closedAt": "2020-06-27T18:18:41Z", "author": {"login": "mkouba"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcux0XwgH2gAyNDQwMTYwMzgxOjdjMjQwMWFjZDI2MTc5ZmI3MzZmMWU3Njk2ZmZkOTI3YWI2N2E2M2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvD6b-ABqjM0ODY3ODc0NzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c2401acd26179fb736f1e7696ffd927ab67a63e", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7c2401acd26179fb736f1e7696ffd927ab67a63e", "committedDate": "2020-06-25T17:09:09Z", "message": "Turn PgPoolProducer.pgPool() into synthetic bean\n\n- resolves #10059"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a4c1c4329bfd6f8224ac6f370e945e61c582169", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7a4c1c4329bfd6f8224ac6f370e945e61c582169", "committedDate": "2020-06-25T17:26:19Z", "message": "Turn MySQLPoolProducer.mysqlPool() into synthetic bean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32e90e6205f8d459f0180bd9d64cd25a391545f1", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/32e90e6205f8d459f0180bd9d64cd25a391545f1", "committedDate": "2020-06-25T17:26:45Z", "message": "Turn DB2PoolProducer.db2Pool() into synthetic bean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d40baaf45b900458bafa9296bbff493702f37899", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/d40baaf45b900458bafa9296bbff493702f37899", "committedDate": "2020-06-26T06:58:24Z", "message": "VertxProcessor - collect event consumers during bean registration phase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MTA1Mjgy", "url": "https://github.com/quarkusio/quarkus/pull/10283#pullrequestreview-438105282", "createdAt": "2020-06-26T08:23:17Z", "commit": {"oid": "d40baaf45b900458bafa9296bbff493702f37899"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwODoyMzoxN1rOGpYKFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwODoyMzoxN1rOGpYKFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA0MDU5OA==", "bodyText": "Out of curiosity, the bean container will invoke this just once and keep a reference to the result, correct?", "url": "https://github.com/quarkusio/quarkus/pull/10283#discussion_r446040598", "createdAt": "2020-06-26T08:23:17Z", "author": {"login": "tsegismont"}, "path": "extensions/reactive-pg-client/runtime/src/main/java/io/quarkus/reactive/pg/client/runtime/PgPoolProducer.java", "diffHunk": "@@ -13,43 +14,16 @@\n \n     private static final Logger LOGGER = Logger.getLogger(PgPoolProducer.class);\n \n-    private volatile PgPool pgPool;\n-    private io.vertx.mutiny.pgclient.PgPool mutinyPgPool;\n-\n-    /**\n-     * @deprecated The Axle API is deprecated and will be removed in the future, use {@link #mutinyPgPool} instead.\n-     */\n-    @Deprecated\n-    private io.vertx.axle.pgclient.PgPool axlePgPool;\n-    /**\n-     * @deprecated The RX API is deprecated and will be removed in the future, use {@link #mutinyPgPool} instead.\n-     */\n-    @Deprecated\n-    private io.vertx.reactivex.pgclient.PgPool rxPgPool;\n-\n-    void initialize(PgPool pgPool) {\n-        this.pgPool = pgPool;\n-    }\n-\n-    /**\n-     * @return the <em>bare</em> PostGreSQL Pool instance.\n-     */\n-    @Singleton\n-    @Produces\n-    public PgPool pgPool() {\n-        return pgPool;\n-    }\n+    @Inject\n+    PgPool pgPool;\n \n     /**\n      * @return the <em>mutiny</em> PostGreSQL Pool instance. The instance is created lazily.\n      */\n     @Singleton\n     @Produces\n-    public synchronized io.vertx.mutiny.pgclient.PgPool mutinyPgPool() {\n-        if (mutinyPgPool == null) {\n-            mutinyPgPool = io.vertx.mutiny.pgclient.PgPool.newInstance(pgPool);\n-        }\n-        return mutinyPgPool;\n+    public io.vertx.mutiny.pgclient.PgPool mutinyPgPool() {\n+        return io.vertx.mutiny.pgclient.PgPool.newInstance(pgPool);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d40baaf45b900458bafa9296bbff493702f37899"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MjA3NDE5", "url": "https://github.com/quarkusio/quarkus/pull/10283#pullrequestreview-438207419", "createdAt": "2020-06-26T11:06:20Z", "commit": {"oid": "7c29ed46e5731b2ffd20b131d0013f9fa7109790"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMTowNjoyMFrOGpc4AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMTowNjoyMFrOGpc4AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjExNzg4OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // Synthetic bean for MySQLPool\n          \n          \n            \n                    // Synthetic bean for DB2Pool", "url": "https://github.com/quarkusio/quarkus/pull/10283#discussion_r446117889", "createdAt": "2020-06-26T11:06:20Z", "author": {"login": "gsmet"}, "path": "extensions/reactive-db2-client/deployment/src/main/java/io/quarkus/reactive/db2/client/deployment/ReactiveDB2ClientProcessor.java", "diffHunk": "@@ -55,11 +58,16 @@ ServiceStartBuildItem build(BuildProducer<FeatureBuildItem> feature,\n             return serviceStart;\n         }\n \n-        RuntimeValue<DB2Pool> db2PoolValue = recorder.configureDB2Pool(vertx.getVertx(), beanContainer.getValue(),\n+        RuntimeValue<DB2Pool> db2PoolValue = recorder.configureDB2Pool(vertx.getVertx(),\n                 dataSourcesRuntimeConfig, dataSourceReactiveRuntimeConfig, dataSourceReactiveDB2Config,\n                 shutdown);\n         db2Pool.produce(new DB2PoolBuildItem(db2PoolValue));\n \n+        // Synthetic bean for MySQLPool", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c29ed46e5731b2ffd20b131d0013f9fa7109790"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MjkyNjAz", "url": "https://github.com/quarkusio/quarkus/pull/10283#pullrequestreview-438292603", "createdAt": "2020-06-26T13:25:22Z", "commit": {"oid": "d40baaf45b900458bafa9296bbff493702f37899"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca9783a67b4657d5e55ed8d4334bad03c13662d4", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/ca9783a67b4657d5e55ed8d4334bad03c13662d4", "committedDate": "2020-06-26T14:13:50Z", "message": "Reactive client beans - add io.vertx.sqlclient.Pool as a bean type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c29ed46e5731b2ffd20b131d0013f9fa7109790", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7c29ed46e5731b2ffd20b131d0013f9fa7109790", "committedDate": "2020-06-26T08:46:22Z", "message": "Reactive client beans - add io.vertx.sqlclient.Pool as a bean type"}, "afterCommit": {"oid": "ca9783a67b4657d5e55ed8d4334bad03c13662d4", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/ca9783a67b4657d5e55ed8d4334bad03c13662d4", "committedDate": "2020-06-26T14:13:50Z", "message": "Reactive client beans - add io.vertx.sqlclient.Pool as a bean type"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3724, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}