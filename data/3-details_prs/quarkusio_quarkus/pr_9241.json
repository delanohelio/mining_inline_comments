{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NzYyMDU5", "number": 9241, "title": "Introduce the ability to read runtime configuration from Consul", "bodyText": "", "createdAt": "2020-05-12T14:26:17Z", "url": "https://github.com/quarkusio/quarkus/pull/9241", "merged": true, "mergeCommit": {"oid": "adbe1de767d0cf09187a0f364cfd92d67876adda"}, "closed": true, "closedAt": "2020-05-15T15:17:02Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcglMaLAFqTQxMDEwMDI5MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABchgu2VgFqTQxMjU3OTY2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMTAwMjkx", "url": "https://github.com/quarkusio/quarkus/pull/9241#pullrequestreview-410100291", "createdAt": "2020-05-12T14:27:48Z", "commit": {"oid": "ca4c61beddd32e1e9c42232ecad67b61d592586e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNDoyNzo0OFrOGUJaeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNDozMDoyOFrOGUJivA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc3ODkzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static final String CONSUL_CONFIG = \"config-config\";\n          \n          \n            \n                public static final String CONSUL_CONFIG = \"consul-config\";", "url": "https://github.com/quarkusio/quarkus/pull/9241#discussion_r423778938", "createdAt": "2020-05-12T14:27:48Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/builditem/FeatureBuildItem.java", "diffHunk": "@@ -18,6 +18,7 @@\n     public static final String CACHE = \"cache\";\n     public static final String CDI = \"cdi\";\n     public static final String CONFIG_YAML = \"config-yaml\";\n+    public static final String CONSUL_CONFIG = \"config-config\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4c61beddd32e1e9c42232ecad67b61d592586e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc3OTQwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <description>Read runtime configuration from Consul Key - Value stor</description>\n          \n          \n            \n                <description>Read runtime configuration from Consul Key - Value store</description>", "url": "https://github.com/quarkusio/quarkus/pull/9241#discussion_r423779403", "createdAt": "2020-05-12T14:28:25Z", "author": {"login": "gsmet"}, "path": "extensions/consul-config/runtime/pom.xml", "diffHunk": "@@ -0,0 +1,79 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>io.quarkus</groupId>\n+        <artifactId>quarkus-consul-config-parent</artifactId>\n+        <version>999-SNAPSHOT</version>\n+    </parent>\n+\n+    <artifactId>quarkus-consul-config</artifactId>\n+    <name>Quarkus - Consul Config - Runtime</name>\n+    <description>Read runtime configuration from Consul Key - Value stor</description>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4c61beddd32e1e9c42232ecad67b61d592586e"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc4MDI2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * When this is used, the keys that end up in the user configuration are the keys of the of the properties file,\n          \n          \n            \n                 * When this is used, the keys that end up in the user configuration are the keys of the properties file,", "url": "https://github.com/quarkusio/quarkus/pull/9241#discussion_r423780266", "createdAt": "2020-05-12T14:29:29Z", "author": {"login": "gsmet"}, "path": "extensions/consul-config/runtime/src/main/java/io/quarkus/consul/config/runtime/ConsulConfig.java", "diffHunk": "@@ -0,0 +1,117 @@\n+package io.quarkus.consul.config.runtime;\n+\n+import java.net.InetSocketAddress;\n+import java.time.Duration;\n+import java.util.LinkedHashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+import io.quarkus.runtime.annotations.ConfigPhase;\n+import io.quarkus.runtime.annotations.ConfigRoot;\n+\n+@ConfigRoot(name = \"consul-config\", phase = ConfigPhase.BOOTSTRAP)\n+public class ConsulConfig {\n+\n+    /**\n+     * If set to true, the application will attempt to look up the configuration from Consul\n+     */\n+    @ConfigItem(defaultValue = \"false\")\n+    boolean enabled;\n+\n+    /**\n+     * Consul agent related configuration\n+     */\n+    @ConfigItem\n+    AgentConfig agent;\n+\n+    /**\n+     * Common prefix that all keys share when looking up the keys from Consul.\n+     * The prefix is <b>not</b> included in the keys of the user configuration\n+     */\n+    @ConfigItem\n+    Optional<String> prefix;\n+\n+    /**\n+     * Keys whose value is a raw string.\n+     * When this is used, the keys that end up in the user configuration are the keys specified her with '/' replaced by '.'\n+     */\n+    @ConfigItem\n+    Optional<List<String>> rawValueKeys;\n+\n+    /**\n+     * Keys whose value represents a properties file.\n+     * When this is used, the keys that end up in the user configuration are the keys of the of the properties file,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4c61beddd32e1e9c42232ecad67b61d592586e"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc4MTA1Mg==", "bodyText": "Don't we need a trustStore configuration? Also might be a good idea to check other extensions for consistency on this.", "url": "https://github.com/quarkusio/quarkus/pull/9241#discussion_r423781052", "createdAt": "2020-05-12T14:30:28Z", "author": {"login": "gsmet"}, "path": "extensions/consul-config/runtime/src/main/java/io/quarkus/consul/config/runtime/ConsulConfig.java", "diffHunk": "@@ -0,0 +1,117 @@\n+package io.quarkus.consul.config.runtime;\n+\n+import java.net.InetSocketAddress;\n+import java.time.Duration;\n+import java.util.LinkedHashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import io.quarkus.runtime.annotations.ConfigGroup;\n+import io.quarkus.runtime.annotations.ConfigItem;\n+import io.quarkus.runtime.annotations.ConfigPhase;\n+import io.quarkus.runtime.annotations.ConfigRoot;\n+\n+@ConfigRoot(name = \"consul-config\", phase = ConfigPhase.BOOTSTRAP)\n+public class ConsulConfig {\n+\n+    /**\n+     * If set to true, the application will attempt to look up the configuration from Consul\n+     */\n+    @ConfigItem(defaultValue = \"false\")\n+    boolean enabled;\n+\n+    /**\n+     * Consul agent related configuration\n+     */\n+    @ConfigItem\n+    AgentConfig agent;\n+\n+    /**\n+     * Common prefix that all keys share when looking up the keys from Consul.\n+     * The prefix is <b>not</b> included in the keys of the user configuration\n+     */\n+    @ConfigItem\n+    Optional<String> prefix;\n+\n+    /**\n+     * Keys whose value is a raw string.\n+     * When this is used, the keys that end up in the user configuration are the keys specified her with '/' replaced by '.'\n+     */\n+    @ConfigItem\n+    Optional<List<String>> rawValueKeys;\n+\n+    /**\n+     * Keys whose value represents a properties file.\n+     * When this is used, the keys that end up in the user configuration are the keys of the of the properties file,\n+     * not these keys\n+     */\n+    @ConfigItem\n+    Optional<List<String>> propertiesValueKeys;\n+\n+    /**\n+     * If set to true, the application will not start if any of the configured config sources cannot be located\n+     */\n+    @ConfigItem(defaultValue = \"true\")\n+    boolean failOnMissingKey;\n+\n+    Map<String, ValueType> keysAsMap() {\n+        Map<String, ValueType> result = new LinkedHashMap<>();\n+        if (rawValueKeys.isPresent()) {\n+            for (String key : rawValueKeys.get()) {\n+                result.put(key, ValueType.RAW);\n+            }\n+        }\n+        if (propertiesValueKeys.isPresent()) {\n+            for (String key : propertiesValueKeys.get()) {\n+                result.put(key, ValueType.PROPERTIES);\n+            }\n+        }\n+        return result;\n+    }\n+\n+    @ConfigGroup\n+    public static class AgentConfig {\n+\n+        /**\n+         * Consul agent host\n+         */\n+        @ConfigItem(defaultValue = \"localhost:8500\")\n+        InetSocketAddress hostPort;\n+\n+        /**\n+         * Whether or not to use HTTPS when communicating with the agent\n+         */\n+        @ConfigItem(defaultValue = \"false\")\n+        boolean useHttps;\n+\n+        /**\n+         * Consul token to be provided when authentication is enabled\n+         */\n+        @ConfigItem\n+        Optional<String> token;\n+\n+        /**\n+         * When using HTTPS, whether or not to trust self-signed certificatd\n+         */\n+        @ConfigItem(defaultValue = \"false\")\n+        boolean trustCerts;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca4c61beddd32e1e9c42232ecad67b61d592586e"}, "originalPosition": 98}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd030c006bdfa65f85ca024613fd8e35db35ef2c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/dd030c006bdfa65f85ca024613fd8e35db35ef2c", "committedDate": "2020-05-12T14:42:35Z", "message": "Update core/deployment/src/main/java/io/quarkus/deployment/builditem/FeatureBuildItem.java\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}, "afterCommit": {"oid": "d77c4f7395045a4481ab11e3d561a224eb4890f2", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d77c4f7395045a4481ab11e3d561a224eb4890f2", "committedDate": "2020-05-12T14:43:10Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d77c4f7395045a4481ab11e3d561a224eb4890f2", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d77c4f7395045a4481ab11e3d561a224eb4890f2", "committedDate": "2020-05-12T14:43:10Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}, "afterCommit": {"oid": "2b4e15b299890e4d1201477812c082e95afb7b00", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/2b4e15b299890e4d1201477812c082e95afb7b00", "committedDate": "2020-05-13T08:43:06Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df66ad45da4cac4aa1d4e761550117eae42f8757", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/df66ad45da4cac4aa1d4e761550117eae42f8757", "committedDate": "2020-05-15T11:50:56Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b4e15b299890e4d1201477812c082e95afb7b00", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/2b4e15b299890e4d1201477812c082e95afb7b00", "committedDate": "2020-05-13T08:43:06Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}, "afterCommit": {"oid": "df66ad45da4cac4aa1d4e761550117eae42f8757", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/df66ad45da4cac4aa1d4e761550117eae42f8757", "committedDate": "2020-05-15T11:50:56Z", "message": "Introduce the ability to read runtime configuration from Consul\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNTc5NjY2", "url": "https://github.com/quarkusio/quarkus/pull/9241#pullrequestreview-412579666", "createdAt": "2020-05-15T11:53:43Z", "commit": {"oid": "df66ad45da4cac4aa1d4e761550117eae42f8757"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3421, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}