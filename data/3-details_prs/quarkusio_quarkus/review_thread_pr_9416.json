{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NTQ2MjE4", "number": 9416, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo0ODowOFrOD9mTwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMTo0MjoyMVrOD-B6sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTE3Mzc4OnYy", "diffSide": "RIGHT", "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwMDo0ODowOFrOGXMDcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNDozNzowMVrOGXPirQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ==", "bodyText": "Are classifiers relevant here?", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r426967921", "createdAt": "2020-05-19T00:48:08Z", "author": {"login": "stuartwdouglas"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -832,11 +832,16 @@ public void stop() throws InterruptedException {\n         for (LocalProject project : localProject.getSelfWithLocalDeps()) {\n             inProject.add(project.getKey());\n             if (project.getClassesDir() != null &&\n-            //if this project also contains Quarkus extensions we do no want to include these in the discovery\n-            //a bit of an edge case, but if you try and include a sample project with your extension you will\n-            //run into problems without this\n-                    (Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-extension.properties\")) ||\n-                            Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-build-steps.list\")))) {\n+                    (\n+                    // if it is not found among project.getArtifacts() it shouldn't be included (e.g. a local test dependency)\n+                    localProject != project", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "596a418aa0448751654fd0a2cd7bea41bea2419b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyMjI1Mw==", "bodyText": "It's interesting, I thought they should be checked too. But I couldn't get test scope deps into it. I guess it's related to the phase the dev mode is running in.\nJavadoc says the content of project.getArtifacts() will depend on the phase and which dependencies have been resolved, iiuc. I tried mvn clean test quarkus:dev. That would actually run tests before the devmode. But the test dependencies still wouldn't be found in project.getArtifactMap()", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427022253", "createdAt": "2020-05-19T04:24:50Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -832,11 +832,16 @@ public void stop() throws InterruptedException {\n         for (LocalProject project : localProject.getSelfWithLocalDeps()) {\n             inProject.add(project.getKey());\n             if (project.getClassesDir() != null &&\n-            //if this project also contains Quarkus extensions we do no want to include these in the discovery\n-            //a bit of an edge case, but if you try and include a sample project with your extension you will\n-            //run into problems without this\n-                    (Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-extension.properties\")) ||\n-                            Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-build-steps.list\")))) {\n+                    (\n+                    // if it is not found among project.getArtifacts() it shouldn't be included (e.g. a local test dependency)\n+                    localProject != project", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ=="}, "originalCommit": {"oid": "596a418aa0448751654fd0a2cd7bea41bea2419b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyNTA2OQ==", "bodyText": "Actually, it's a good opportunity to check the type of the dependency. Sometimes people add dependencies on POMs, just for the transitive dependencies. I'll add that here and the check for the scope anyway.", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427025069", "createdAt": "2020-05-19T04:37:01Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -832,11 +832,16 @@ public void stop() throws InterruptedException {\n         for (LocalProject project : localProject.getSelfWithLocalDeps()) {\n             inProject.add(project.getKey());\n             if (project.getClassesDir() != null &&\n-            //if this project also contains Quarkus extensions we do no want to include these in the discovery\n-            //a bit of an edge case, but if you try and include a sample project with your extension you will\n-            //run into problems without this\n-                    (Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-extension.properties\")) ||\n-                            Files.exists(project.getClassesDir().resolve(\"META-INF/quarkus-build-steps.list\")))) {\n+                    (\n+                    // if it is not found among project.getArtifacts() it shouldn't be included (e.g. a local test dependency)\n+                    localProject != project", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2NzkyMQ=="}, "originalCommit": {"oid": "596a418aa0448751654fd0a2cd7bea41bea2419b"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzY5NzE0OnYy", "diffSide": "RIGHT", "path": "integration-tests/maven/src/test/resources/projects/test-module-dependency/app/src/main/resources/META-INF/resources/index.html", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMTo0MjoyMVrOGX4Zvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwNTozNjo1OFrOGX77CA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5NDUyNw==", "bodyText": "Do we really need this? I think we likely have a heap of these in the tests that are not actually used.", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427694527", "createdAt": "2020-05-20T01:42:21Z", "author": {"login": "stuartwdouglas"}, "path": "integration-tests/maven/src/test/resources/projects/test-module-dependency/app/src/main/resources/META-INF/resources/index.html", "diffHunk": "@@ -0,0 +1,152 @@\n+<!DOCTYPE html>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7a00654822bd66fbac6d90f3c1ec301142c35c1"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzc1MTg0OA==", "bodyText": "In this specific test we don't. A typical devmode test in our testsuite though would first check the static html response. And then the rest.", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427751848", "createdAt": "2020-05-20T05:35:43Z", "author": {"login": "aloubyansky"}, "path": "integration-tests/maven/src/test/resources/projects/test-module-dependency/app/src/main/resources/META-INF/resources/index.html", "diffHunk": "@@ -0,0 +1,152 @@\n+<!DOCTYPE html>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5NDUyNw=="}, "originalCommit": {"oid": "a7a00654822bd66fbac6d90f3c1ec301142c35c1"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzc1MjIwMA==", "bodyText": "There is plenty of resources we could cleanup. Like docker files, native tests, pom's including native profiles that aren't used in our tests.", "url": "https://github.com/quarkusio/quarkus/pull/9416#discussion_r427752200", "createdAt": "2020-05-20T05:36:58Z", "author": {"login": "aloubyansky"}, "path": "integration-tests/maven/src/test/resources/projects/test-module-dependency/app/src/main/resources/META-INF/resources/index.html", "diffHunk": "@@ -0,0 +1,152 @@\n+<!DOCTYPE html>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5NDUyNw=="}, "originalCommit": {"oid": "a7a00654822bd66fbac6d90f3c1ec301142c35c1"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3085, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}