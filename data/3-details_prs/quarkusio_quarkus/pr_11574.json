{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNjIzOTYz", "number": 11574, "title": "By default use lower heap settings while launching Quarkus application from QuarkusProdModeTest", "bodyText": "ProcessBuilder documentation states that it inherits the environment of the parent process. The commit here explicitly sets the -Xmx to a lower value for some of these processes that get launched during tests to avoid inheriting Maven's heap settings (which appears to be 2048m in CI jobs).\nPlease do not merge this. This is an experiment to see if this helps get us past some of the CI issues we are currently seeing. If this does work, then this change needs to be done in a better and more configurable/controlled manner.", "createdAt": "2020-08-24T16:14:30Z", "url": "https://github.com/quarkusio/quarkus/pull/11574", "merged": true, "mergeCommit": {"oid": "d46adc82bcaa5972bee76a0ca70cad119ee5e41a"}, "closed": true, "closedAt": "2020-08-28T01:42:50Z", "author": {"login": "jaikiran"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCsTdtABqjM2OTQ5NzM4ODg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdC9VecgFqTQ3NjU2MjQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a1ef0f6f18c7ba34a021766b9035b1dd658ff5e", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/0a1ef0f6f18c7ba34a021766b9035b1dd658ff5e", "committedDate": "2020-08-24T16:11:01Z", "message": "Experiment with heap settings for QuarkusProdModeTest"}, "afterCommit": {"oid": "1d98d720b559f6ddcd64b1e9cb40245274f3083c", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/1d98d720b559f6ddcd64b1e9cb40245274f3083c", "committedDate": "2020-08-26T14:01:03Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d98d720b559f6ddcd64b1e9cb40245274f3083c", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/1d98d720b559f6ddcd64b1e9cb40245274f3083c", "committedDate": "2020-08-26T14:01:03Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}, "afterCommit": {"oid": "3a75709a4603fe480f934ed7f3e19e36bdc45414", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/3a75709a4603fe480f934ed7f3e19e36bdc45414", "committedDate": "2020-08-27T04:21:38Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NTU2MDY1", "url": "https://github.com/quarkusio/quarkus/pull/11574#pullrequestreview-476556065", "createdAt": "2020-08-27T09:44:33Z", "commit": {"oid": "3a75709a4603fe480f934ed7f3e19e36bdc45414"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwOTo0NDozM1rOHIIpBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwOTo0NDozM1rOHIIpBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI5MjIzMA==", "bodyText": "Is it something we should remove or you really want to print the command?", "url": "https://github.com/quarkusio/quarkus/pull/11574#discussion_r478292230", "createdAt": "2020-08-27T09:44:33Z", "author": {"login": "gsmet"}, "path": "test-framework/junit5-internal/src/main/java/io/quarkus/test/QuarkusProdModeTest.java", "diffHunk": "@@ -458,16 +468,22 @@ private void startBuiltResult(Path builtResultArtifact) throws IOException {\n         List<String> command = new ArrayList<>(systemProperties.size() + 3);\n         if (builtResultArtifact.getFileName().toString().endsWith(\".jar\")) {\n             command.add(JavaBinFinder.findBin());\n+            if (this.jvmArgs != null) {\n+                command.addAll(this.jvmArgs);\n+            }\n             command.addAll(systemProperties);\n             command.add(\"-jar\");\n             command.add(builtResultArtifact.toAbsolutePath().toString());\n         } else {\n             command.add(builtResultArtifact.toAbsolutePath().toString());\n+            if (this.jvmArgs != null) {\n+                command.addAll(this.jvmArgs);\n+            }\n             command.addAll(systemProperties);\n         }\n \n         command.addAll(Arrays.asList(commandLineParameters));\n-\n+        System.out.println(\"Launching \" + command);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a75709a4603fe480f934ed7f3e19e36bdc45414"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ec4ff377eb0d0c61ceb749008f734e8f36a9e8d", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/5ec4ff377eb0d0c61ceb749008f734e8f36a9e8d", "committedDate": "2020-08-27T09:49:30Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3a75709a4603fe480f934ed7f3e19e36bdc45414", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/3a75709a4603fe480f934ed7f3e19e36bdc45414", "committedDate": "2020-08-27T04:21:38Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}, "afterCommit": {"oid": "5ec4ff377eb0d0c61ceb749008f734e8f36a9e8d", "author": {"user": {"login": "jaikiran", "name": "Jaikiran"}}, "url": "https://github.com/quarkusio/quarkus/commit/5ec4ff377eb0d0c61ceb749008f734e8f36a9e8d", "committedDate": "2020-08-27T09:49:30Z", "message": "By default use lower heap settings while launching Quarkus application process from QuarkusProdModeTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NTYyNDM5", "url": "https://github.com/quarkusio/quarkus/pull/11574#pullrequestreview-476562439", "createdAt": "2020-08-27T09:52:45Z", "commit": {"oid": "5ec4ff377eb0d0c61ceb749008f734e8f36a9e8d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 701, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}