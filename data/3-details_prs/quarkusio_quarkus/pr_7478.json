{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMjUxNTQ5", "number": 7478, "title": "Banner updates", "bodyText": "Add property that controls whether or not the banner will be displayed\nMake banner only show up in dev-mode dev-mode and prod-mode\nMove banner to core\nChange subtitle of banner (and show it only when the default banner is not being used)", "createdAt": "2020-02-28T07:48:04Z", "url": "https://github.com/quarkusio/quarkus/pull/7478", "merged": true, "mergeCommit": {"oid": "d06498afec0748157b3f5a3287ff4de6d2d1cd08"}, "closed": true, "closedAt": "2020-03-04T19:05:21Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIrKPngFqTM2NjIxMjEyNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKZEIkAFqTM2ODkwMjE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MjEyMTI2", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-366212126", "createdAt": "2020-02-28T07:54:34Z", "commit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwNzo1NDozNVrOFvsNzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwNzo1NDozNVrOFvsNzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU1MTgyMg==", "bodyText": "question: what does that do/help ?", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r385551822", "createdAt": "2020-02-28T07:54:35Z", "author": {"login": "maxandersen"}, "path": "extensions/banner/deployment/src/main/java/io/quarkus/banner/deployment/BannerProcessor.java", "diffHunk": "@@ -21,7 +21,7 @@\n \n     private static final Logger logger = Logger.getLogger(BannerProcessor.class);\n \n-    @BuildStep(loadsApplicationClasses = true)\n+    @BuildStep(loadsApplicationClasses = true, onlyIf = IsBanner.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MzU3Njk2", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-366357696", "createdAt": "2020-02-28T12:18:55Z", "commit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMjoxODo1NVrOFvzIHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMjoxOTozNVrOFvzJJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY2NTA1NA==", "bodyText": "I would have made it runtime so I would read the banner in any case and just condition the display at runtime.", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r385665054", "createdAt": "2020-02-28T12:18:55Z", "author": {"login": "gsmet"}, "path": "extensions/banner/deployment/src/main/java/io/quarkus/banner/deployment/BannerConfig.java", "diffHunk": "@@ -5,6 +5,13 @@\n \n @ConfigRoot(name = \"banner\")\n public class BannerConfig {\n+\n+    /**\n+     * Whether or not the banner will be displayed\n+     */\n+    @ConfigItem(defaultValue = \"true\")\n+    public boolean enabled;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY2NTMxOQ==", "bodyText": "Not really a big fan of this pattern of injecting the config in the supplier. Well and it won't work if we want to make it runtime :).", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r385665319", "createdAt": "2020-02-28T12:19:35Z", "author": {"login": "gsmet"}, "path": "extensions/banner/deployment/src/main/java/io/quarkus/banner/deployment/BannerProcessor.java", "diffHunk": "@@ -21,7 +21,7 @@\n \n     private static final Logger logger = Logger.getLogger(BannerProcessor.class);\n \n-    @BuildStep(loadsApplicationClasses = true)\n+    @BuildStep(loadsApplicationClasses = true, onlyIf = IsBanner.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0798d599dc19a9b342f4fa58a0ae3a56766c1aee", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/0798d599dc19a9b342f4fa58a0ae3a56766c1aee", "committedDate": "2020-02-28T07:47:48Z", "message": "Add property that controls whether or not the banner will be displayed"}, "afterCommit": {"oid": "e57a8eaeed1dad3f13a2fe2d346f84662e598d28", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/e57a8eaeed1dad3f13a2fe2d346f84662e598d28", "committedDate": "2020-03-03T09:35:51Z", "message": "Make banner only show up in dev-mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDI0MjE0", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368024214", "createdAt": "2020-03-03T14:29:30Z", "commit": {"oid": "52f894c90bf9304c26e6a8c1c77a9a757f4be984"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoyOTozMVrOFxIA1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDoyOTozMVrOFxIA1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA1NTgzMA==", "bodyText": "Shouldn't it be something like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @BuildStep(onlyIf = IsDevelopment.class)\n          \n          \n            \n                @BuildStep(onlyIf = { IsBanner.class, IsDevelopment.class })", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387055830", "createdAt": "2020-03-03T14:29:31Z", "author": {"login": "gastaldi"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/BannerProcessor.java", "diffHunk": "@@ -8,27 +8,30 @@\n \n import org.jboss.logging.Logger;\n \n-import io.quarkus.banner.runtime.BannerRecorder;\n+import io.quarkus.BannerConfig;\n+import io.quarkus.IsBanner;\n import io.quarkus.builder.Version;\n+import io.quarkus.deployment.IsDevelopment;\n import io.quarkus.deployment.annotations.BuildStep;\n import io.quarkus.deployment.annotations.ExecutionTime;\n import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.ConsoleFormatterBannerBuildItem;\n import io.quarkus.deployment.builditem.HotDeploymentWatchedFileBuildItem;\n import io.quarkus.deployment.util.FileUtil;\n+import io.quarkus.runtime.BannerRecorder;\n \n public class BannerProcessor {\n \n     private static final Logger logger = Logger.getLogger(BannerProcessor.class);\n \n-    @BuildStep(loadsApplicationClasses = true)\n+    @BuildStep(loadsApplicationClasses = true, onlyIf = { IsBanner.class, IsDevelopment.class })\n     @Record(ExecutionTime.RUNTIME_INIT)\n     public ConsoleFormatterBannerBuildItem recordBanner(BannerRecorder recorder, BannerConfig config) {\n         String bannerText = readBannerFile(config);\n         return new ConsoleFormatterBannerBuildItem(recorder.provideBannerSupplier(bannerText));\n     }\n \n-    @BuildStep\n+    @BuildStep(onlyIf = IsDevelopment.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52f894c90bf9304c26e6a8c1c77a9a757f4be984"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDI3NDc4", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368027478", "createdAt": "2020-03-03T14:33:23Z", "commit": {"oid": "52f894c90bf9304c26e6a8c1c77a9a757f4be984"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDozMzoyM1rOFxIKog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNDozMzoyM1rOFxIKog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA1ODMzOA==", "bodyText": "Minor but could we still have an io.quarkus.banner package? I find it weird to have that one in the root package.", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387058338", "createdAt": "2020-03-03T14:33:23Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/BannerConfig.java", "diffHunk": "@@ -1,10 +1,17 @@\n-package io.quarkus.banner.deployment;\n+package io.quarkus;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "52f894c90bf9304c26e6a8c1c77a9a757f4be984"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b912df52309e13273aacd2c1ee4a91f753899080", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/b912df52309e13273aacd2c1ee4a91f753899080", "committedDate": "2020-03-03T14:46:49Z", "message": "Change banner subtitle according if the default has been changed"}, "afterCommit": {"oid": "3ed381b2dd75d85fb961a310036bf7468d0ce31a", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/3ed381b2dd75d85fb961a310036bf7468d0ce31a", "committedDate": "2020-03-03T14:59:03Z", "message": "Move banner to core and to prod run as well"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MjE4NTgy", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368218582", "createdAt": "2020-03-03T18:26:43Z", "commit": {"oid": "3ed381b2dd75d85fb961a310036bf7468d0ce31a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxODoyNjo0M1rOFxRZFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxODoyNjo0M1rOFxRZFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzIwOTQ5NA==", "bodyText": "Any chance we could avoid the lambda? It will end up being executed at runtime, right?", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387209494", "createdAt": "2020-03-03T18:26:43Z", "author": {"login": "gsmet"}, "path": "core/runtime/src/main/java/io/quarkus/runtime/BannerRecorder.java", "diffHunk": "@@ -0,0 +1,18 @@\n+package io.quarkus.runtime;\n+\n+import java.util.Optional;\n+import java.util.function.Supplier;\n+\n+import io.quarkus.runtime.annotations.Recorder;\n+\n+@Recorder\n+public class BannerRecorder {\n+\n+    public RuntimeValue<Optional<Supplier<String>>> provideBannerSupplier(String bannerText,\n+            BannerRuntimeConfig bannerRuntimeConfig) {\n+        if (bannerRuntimeConfig.enabled) {\n+            return new RuntimeValue<>(Optional.of(() -> bannerText));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ed381b2dd75d85fb961a310036bf7468d0ce31a"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ed381b2dd75d85fb961a310036bf7468d0ce31a", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/3ed381b2dd75d85fb961a310036bf7468d0ce31a", "committedDate": "2020-03-03T14:59:03Z", "message": "Move banner to core and to prod run as well"}, "afterCommit": {"oid": "cd0a892a0ba1f30034fd0f04a468e8b5f74e6885", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/cd0a892a0ba1f30034fd0f04a468e8b5f74e6885", "committedDate": "2020-03-03T20:12:46Z", "message": "Move banner to core and to prod run as well"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd0a892a0ba1f30034fd0f04a468e8b5f74e6885", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/cd0a892a0ba1f30034fd0f04a468e8b5f74e6885", "committedDate": "2020-03-03T20:12:46Z", "message": "Move banner to core and to prod run as well"}, "afterCommit": {"oid": "a20329e2f937c54a4b3d56e7c6dd7d553c781a2e", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/a20329e2f937c54a4b3d56e7c6dd7d553c781a2e", "committedDate": "2020-03-04T06:52:25Z", "message": "Move banner to core and to prod run as well"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTUyMzE0", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368552314", "createdAt": "2020-03-04T07:28:11Z", "commit": {"oid": "a20329e2f937c54a4b3d56e7c6dd7d553c781a2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNzoyODoxMlrOFxiaRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNzoyODoxMlrOFxiaRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ4ODMyNA==", "bodyText": "this will only trigger if users override the banner name and don't just put default_banner.txt into their classpath root ...which I would think most would do because then they don't need to add anything to application.properties\nshould we instead have it be that if default path can't be resolved then we load our internal resource ?", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387488324", "createdAt": "2020-03-04T07:28:12Z", "author": {"login": "maxandersen"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/BannerProcessor.java", "diffHunk": "@@ -38,8 +42,12 @@ private String readBannerFile(BannerConfig config) {\n         if (resource != null) {\n             try (InputStream is = resource.openStream()) {\n                 byte[] content = FileUtil.readFileContents(is);\n-                String bannerTitle = new String(content, StandardCharsets.UTF_8);\n-                return bannerTitle + \"\\n:: Quarkus :: v\" + Version.getVersion() + '\\n';\n+                StringBuilder bannerTitle = new StringBuilder(new String(content, StandardCharsets.UTF_8));\n+                bannerTitle.append('\\n');\n+                if (!config.isDefaultPath()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a20329e2f937c54a4b3d56e7c6dd7d553c781a2e"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTUyNTE2", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368552516", "createdAt": "2020-03-04T07:28:42Z", "commit": {"oid": "a20329e2f937c54a4b3d56e7c6dd7d553c781a2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNzoyODo0MlrOFxibLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNzoyODo0MlrOFxibLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ4ODU1Ng==", "bodyText": "I got a PR on geoand#1 but for right padding but for some reason that gives me a NPE in the java compiler ;)", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387488556", "createdAt": "2020-03-04T07:28:42Z", "author": {"login": "maxandersen"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/BannerProcessor.java", "diffHunk": "@@ -38,8 +42,12 @@ private String readBannerFile(BannerConfig config) {\n         if (resource != null) {\n             try (InputStream is = resource.openStream()) {\n                 byte[] content = FileUtil.readFileContents(is);\n-                String bannerTitle = new String(content, StandardCharsets.UTF_8);\n-                return bannerTitle + \"\\n:: Quarkus :: v\" + Version.getVersion() + '\\n';\n+                StringBuilder bannerTitle = new StringBuilder(new String(content, StandardCharsets.UTF_8));\n+                bannerTitle.append('\\n');\n+                if (!config.isDefaultPath()) {\n+                    bannerTitle.append(\"Powered by Quarkus v\").append(Version.getVersion()).append('\\n');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a20329e2f937c54a4b3d56e7c6dd7d553c781a2e"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa13764d98f6c40cfd3a17c6aff8ac85648f0cf1", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/fa13764d98f6c40cfd3a17c6aff8ac85648f0cf1", "committedDate": "2020-03-04T12:19:32Z", "message": "Display the banner subtitle only when the default banner is not being used"}, "afterCommit": {"oid": "6b3d6fbbc5027f05c9025afaac99ee1dac778f7c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/6b3d6fbbc5027f05c9025afaac99ee1dac778f7c", "committedDate": "2020-03-04T12:28:44Z", "message": "Display the banner subtitle only when the default banner is not being used"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b3d6fbbc5027f05c9025afaac99ee1dac778f7c", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/6b3d6fbbc5027f05c9025afaac99ee1dac778f7c", "committedDate": "2020-03-04T12:28:44Z", "message": "Display the banner subtitle only when the default banner is not being used"}, "afterCommit": {"oid": "765a229a0916fbdd7b4e1248a0c0e0d993e5fc57", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/765a229a0916fbdd7b4e1248a0c0e0d993e5fc57", "committedDate": "2020-03-04T12:36:15Z", "message": "Display the banner subtitle only when the default banner is not being used"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "765a229a0916fbdd7b4e1248a0c0e0d993e5fc57", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/765a229a0916fbdd7b4e1248a0c0e0d993e5fc57", "committedDate": "2020-03-04T12:36:15Z", "message": "Display the banner subtitle only when the default banner is not being used"}, "afterCommit": {"oid": "8b08df800334d0a7fbb8b69c8d15f9d2930461f1", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/8b08df800334d0a7fbb8b69c8d15f9d2930461f1", "committedDate": "2020-03-04T12:36:44Z", "message": "Display the banner subtitle only when the default banner is not being used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3000b56027c8f608835744b8ae9bba3aabc8d4e2", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/3000b56027c8f608835744b8ae9bba3aabc8d4e2", "committedDate": "2020-03-04T13:37:13Z", "message": "Add property that controls whether or not the banner will be displayed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "262beb5b9f1bee74689d6c82e1c26343e5c74f42", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/262beb5b9f1bee74689d6c82e1c26343e5c74f42", "committedDate": "2020-03-04T13:37:13Z", "message": "Make banner only show up in dev-mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fbcc7dbf4f413cf8c7e4f7521719c3c27a13f4f", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/7fbcc7dbf4f413cf8c7e4f7521719c3c27a13f4f", "committedDate": "2020-03-04T13:37:13Z", "message": "Move banner to core and to prod run as well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a635de95470d2ea69a9a70dff0185fdccb8b90e", "author": {"user": {"login": "maxandersen", "name": "Max Rydahl Andersen"}}, "url": "https://github.com/quarkusio/quarkus/commit/8a635de95470d2ea69a9a70dff0185fdccb8b90e", "committedDate": "2020-03-04T13:37:13Z", "message": "right pad banner title"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df70aedd4ca74d92ff4cad0def3b575009d90c65", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/df70aedd4ca74d92ff4cad0def3b575009d90c65", "committedDate": "2020-03-04T13:37:13Z", "message": "Display the banner subtitle only when the default banner is not being used"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b08df800334d0a7fbb8b69c8d15f9d2930461f1", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/8b08df800334d0a7fbb8b69c8d15f9d2930461f1", "committedDate": "2020-03-04T12:36:44Z", "message": "Display the banner subtitle only when the default banner is not being used"}, "afterCommit": {"oid": "df70aedd4ca74d92ff4cad0def3b575009d90c65", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/df70aedd4ca74d92ff4cad0def3b575009d90c65", "committedDate": "2020-03-04T13:37:13Z", "message": "Display the banner subtitle only when the default banner is not being used"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODc1Mjc2", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368875276", "createdAt": "2020-03-04T15:28:32Z", "commit": {"oid": "df70aedd4ca74d92ff4cad0def3b575009d90c65"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNToyODozMlrOFxx2rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNToyODozMlrOFxx2rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0MTM1Nw==", "bodyText": "The more and more I think about it i think we are better of just always print this tag line...", "url": "https://github.com/quarkusio/quarkus/pull/7478#discussion_r387741357", "createdAt": "2020-03-04T15:28:32Z", "author": {"login": "maxandersen"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/steps/BannerProcessor.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package io.quarkus.deployment.steps;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.net.URISyntaxException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.FileSystem;\n+import java.nio.file.FileSystems;\n+import java.nio.file.Files;\n+import java.util.AbstractMap;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.Enumeration;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Scanner;\n+\n+import org.jboss.logging.Logger;\n+\n+import io.quarkus.banner.BannerConfig;\n+import io.quarkus.builder.Version;\n+import io.quarkus.deployment.IsTest;\n+import io.quarkus.deployment.annotations.BuildStep;\n+import io.quarkus.deployment.annotations.ExecutionTime;\n+import io.quarkus.deployment.annotations.Record;\n+import io.quarkus.deployment.builditem.ConsoleFormatterBannerBuildItem;\n+import io.quarkus.deployment.builditem.HotDeploymentWatchedFileBuildItem;\n+import io.quarkus.deployment.util.FileUtil;\n+import io.quarkus.runtime.BannerRecorder;\n+import io.quarkus.runtime.BannerRuntimeConfig;\n+\n+public class BannerProcessor {\n+\n+    private static final Logger logger = Logger.getLogger(BannerProcessor.class);\n+\n+    @BuildStep(loadsApplicationClasses = true, onlyIfNot = { IsTest.class })\n+    @Record(ExecutionTime.RUNTIME_INIT)\n+    public ConsoleFormatterBannerBuildItem recordBanner(BannerRecorder recorder, BannerConfig config,\n+            BannerRuntimeConfig bannerRuntimeConfig) {\n+        String bannerText = readBannerFile(config);\n+        return new ConsoleFormatterBannerBuildItem(recorder.provideBannerSupplier(bannerText, bannerRuntimeConfig));\n+    }\n+\n+    @BuildStep\n+    HotDeploymentWatchedFileBuildItem watchBannerChanges(BannerConfig config) {\n+        return new HotDeploymentWatchedFileBuildItem(config.path);\n+    }\n+\n+    private String readBannerFile(BannerConfig config) {\n+        try {\n+            Map.Entry<URL, Boolean> entry = getBanner(config);\n+            URL bannerResourceURL = entry.getKey();\n+            if (bannerResourceURL == null) {\n+                logger.warn(\"Could not locate banner file\");\n+                return \"\";\n+            }\n+            try (InputStream is = bannerResourceURL.openStream()) {\n+                byte[] content = FileUtil.readFileContents(is);\n+                String bannerTitle = new String(content, StandardCharsets.UTF_8);\n+\n+                int width = 0;\n+                Scanner scanner = new Scanner(bannerTitle);\n+                while (scanner.hasNextLine()) {\n+                    width = Math.max(width, scanner.nextLine().length());\n+                }\n+\n+                String tagline = \"\\n\";\n+                Boolean isDefaultBanner = entry.getValue();\n+                if (!isDefaultBanner) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df70aedd4ca74d92ff4cad0def3b575009d90c65"}, "originalPosition": 71}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4OTAyMTky", "url": "https://github.com/quarkusio/quarkus/pull/7478#pullrequestreview-368902192", "createdAt": "2020-03-04T15:57:28Z", "commit": {"oid": "df70aedd4ca74d92ff4cad0def3b575009d90c65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4054, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}