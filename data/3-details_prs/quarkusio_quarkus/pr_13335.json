{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMjAyMzc1", "number": 13335, "title": "Create a new Resteasy Context Map", "bodyText": "This provides a slight performance advantage,\nbut most importantly will prevent an existing\nclient context from interfering with the server one.\nThis can happen if the authentication layer is using\nthe REST client to access external services.\nFixes #13317", "createdAt": "2020-11-17T07:29:22Z", "url": "https://github.com/quarkusio/quarkus/pull/13335", "merged": true, "mergeCommit": {"oid": "acdd04dd75c04deace57558171414e16c88e4fe2"}, "closed": true, "closedAt": "2020-11-18T12:48:30Z", "author": {"login": "stuartwdouglas"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddUgT9AFqTUzMjA4MzMzMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddqps2AFqTUzMzI0Njk0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDgzMzMy", "url": "https://github.com/quarkusio/quarkus/pull/13335#pullrequestreview-532083332", "createdAt": "2020-11-17T07:34:26Z", "commit": {"oid": "8eab583c28406ca229b3383c6137aa5571268ada"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDk2MzEx", "url": "https://github.com/quarkusio/quarkus/pull/13335#pullrequestreview-532096311", "createdAt": "2020-11-17T07:57:22Z", "commit": {"oid": "8eab583c28406ca229b3383c6137aa5571268ada"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTI1Mzc0", "url": "https://github.com/quarkusio/quarkus/pull/13335#pullrequestreview-532125374", "createdAt": "2020-11-17T08:32:22Z", "commit": {"oid": "8eab583c28406ca229b3383c6137aa5571268ada"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwODozMjoyM1rOH0pntw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwODozMjoyM1rOH0pntw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDk2OTkxMQ==", "bodyText": "I think you should be using the variant that creates a new Closeable context : addCloseableContextDataLevel that you can use in a try-with-resource.", "url": "https://github.com/quarkusio/quarkus/pull/13335#discussion_r524969911", "createdAt": "2020-11-17T08:32:23Z", "author": {"login": "FroMage"}, "path": "extensions/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/standalone/VertxRequestHandler.java", "diffHunk": "@@ -127,8 +129,10 @@ private void dispatch(RoutingContext routingContext, InputStream is, VertxOutput\n                     dispatcher.getDispatcher(), vertxResponse, requestContext, executor);\n             vertxRequest.setInputStream(is);\n             try {\n-                ResteasyContext.pushContext(SecurityContext.class, new QuarkusResteasySecurityContext(request, routingContext));\n-                ResteasyContext.pushContext(RoutingContext.class, routingContext);\n+                Map<Class<?>, Object> map = new HashMap<>();\n+                map.put(SecurityContext.class, new QuarkusResteasySecurityContext(request, routingContext));\n+                map.put(RoutingContext.class, routingContext);\n+                ResteasyContext.pushContextDataMap(map);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8eab583c28406ca229b3383c6137aa5571268ada"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "912d62eb7832d1f3914c847671be45e3212695b4", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/912d62eb7832d1f3914c847671be45e3212695b4", "committedDate": "2020-11-17T21:45:52Z", "message": "Create a new Resteasy Context Map\n\nThis provides a slight performance advantage,\nbut most importantly will prevent an existing\nclient context from interfering with the server one.\n\nThis can happen if the authentication layer is using\nthe REST client to access external services.\n\nFixes #13317"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8eab583c28406ca229b3383c6137aa5571268ada", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/8eab583c28406ca229b3383c6137aa5571268ada", "committedDate": "2020-11-17T07:27:13Z", "message": "Create a new Resteasy Context Map\n\nThis provides a slight performance advantage,\nbut most importantly will prevent an existing\nclient context from interfering with the server one.\n\nThis can happen if the authentication layer is using\nthe REST client to access external services.\n\nFixes #13317"}, "afterCommit": {"oid": "912d62eb7832d1f3914c847671be45e3212695b4", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/912d62eb7832d1f3914c847671be45e3212695b4", "committedDate": "2020-11-17T21:45:52Z", "message": "Create a new Resteasy Context Map\n\nThis provides a slight performance advantage,\nbut most importantly will prevent an existing\nclient context from interfering with the server one.\n\nThis can happen if the authentication layer is using\nthe REST client to access external services.\n\nFixes #13317"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMjQ2OTQ0", "url": "https://github.com/quarkusio/quarkus/pull/13335#pullrequestreview-533246944", "createdAt": "2020-11-18T09:22:36Z", "commit": {"oid": "912d62eb7832d1f3914c847671be45e3212695b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1399, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}