{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwMDU5OTEx", "number": 10772, "title": "RESTEasy - skip reflect. reg. for all types from javax.json package", "bodyText": "Follows up on #10751", "createdAt": "2020-07-16T09:52:32Z", "url": "https://github.com/quarkusio/quarkus/pull/10772", "merged": true, "mergeCommit": {"oid": "d3df912810d03b6a4e2d331f99eb072f95740d08"}, "closed": true, "closedAt": "2020-07-16T14:30:29Z", "author": {"login": "mkouba"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1cObPAFqTQ0OTY5ODA1OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1dlbmAFqTQ0OTc2MTEyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5Njk4MDU4", "url": "https://github.com/quarkusio/quarkus/pull/10772#pullrequestreview-449698058", "createdAt": "2020-07-16T09:56:27Z", "commit": {"oid": "77cc76fa34dc787632c7dccb10450f070b931773"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTo1NjoyN1rOGyj0Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTo1NjoyN1rOGyj0Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY2ODc5OQ==", "bodyText": "To be totally safe, I think you need to add a dot at the end of the package name. It's not a biggie for this one but might be in the future for other packages.\nIt's probably better to do it here than in the startsWith as it will avoid creating new strings.", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455668799", "createdAt": "2020-07-16T09:56:27Z", "author": {"login": "gsmet"}, "path": "extensions/resteasy-common/deployment/src/main/java/io/quarkus/resteasy/common/deployment/ResteasyDotNames.java", "diffHunk": "@@ -95,4 +99,8 @@ public boolean test(DotName name) {\n             // Vert-x\n             DotName.createSimple(\"io.vertx.core.json.JsonArray\"),\n             DotName.createSimple(\"io.vertx.core.json.JsonObject\")));\n+    \n+    private static final String[] PACKAGES_IGNORED_FOR_REFLECTION = {\n+            \"javax.json\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77cc76fa34dc787632c7dccb10450f070b931773"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5Njk5OTI3", "url": "https://github.com/quarkusio/quarkus/pull/10772#pullrequestreview-449699927", "createdAt": "2020-07-16T09:59:08Z", "commit": {"oid": "77cc76fa34dc787632c7dccb10450f070b931773"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTo1OTowOFrOGyj6GA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOTo1OTowOFrOGyj6GA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY3MDI5Ng==", "bodyText": "Wouldn't these also need to go away?", "url": "https://github.com/quarkusio/quarkus/pull/10772#discussion_r455670296", "createdAt": "2020-07-16T09:59:08Z", "author": {"login": "geoand"}, "path": "extensions/resteasy-common/deployment/src/main/java/io/quarkus/resteasy/common/deployment/ResteasyDotNames.java", "diffHunk": "@@ -63,19 +63,23 @@\n     private static class IgnoreForReflectionPredicate implements Predicate<DotName> {\n \n         @Override\n-        public boolean test(DotName name) {\n-            return ResteasyDotNames.TYPES_IGNORED_FOR_REFLECTION.contains(name)\n-                    || ReflectiveHierarchyBuildItem.DefaultIgnorePredicate.INSTANCE.test(name);\n+        public boolean test(DotName dotName) {\n+            if (ResteasyDotNames.TYPES_IGNORED_FOR_REFLECTION.contains(dotName)\n+                    || ReflectiveHierarchyBuildItem.DefaultIgnorePredicate.INSTANCE.test(dotName)) {\n+                return true;\n+            }\n+            String name = dotName.toString();\n+            for (String packageName : PACKAGES_IGNORED_FOR_REFLECTION) {\n+                if (name.startsWith(packageName)) {\n+                    return true;\n+                }\n+            }\n+            return false;\n         }\n     }\n \n     // Types ignored for reflection used by the RESTEasy and SmallRye REST client extensions.\n     private static final Set<DotName> TYPES_IGNORED_FOR_REFLECTION = new HashSet<>(Arrays.asList(\n-            // javax.json\n-            DotName.createSimple(\"javax.json.JsonObject\"),\n-            DotName.createSimple(\"javax.json.JsonArray\"),\n-            DotName.createSimple(\"javax.json.JsonValue\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77cc76fa34dc787632c7dccb10450f070b931773"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f18bad467e9ff05b6efe1161db72d1c287abf3c", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/6f18bad467e9ff05b6efe1161db72d1c287abf3c", "committedDate": "2020-07-16T11:17:41Z", "message": "RESTEasy - skip reflect. reg. for all types from javax.json package"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77cc76fa34dc787632c7dccb10450f070b931773", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/77cc76fa34dc787632c7dccb10450f070b931773", "committedDate": "2020-07-16T09:51:26Z", "message": "RESTEasy - skip reflect. reg. for all types from javax.json package"}, "afterCommit": {"oid": "6f18bad467e9ff05b6efe1161db72d1c287abf3c", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/6f18bad467e9ff05b6efe1161db72d1c287abf3c", "committedDate": "2020-07-16T11:17:41Z", "message": "RESTEasy - skip reflect. reg. for all types from javax.json package"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzYxMTI0", "url": "https://github.com/quarkusio/quarkus/pull/10772#pullrequestreview-449761124", "createdAt": "2020-07-16T11:32:12Z", "commit": {"oid": "6f18bad467e9ff05b6efe1161db72d1c287abf3c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1166, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}