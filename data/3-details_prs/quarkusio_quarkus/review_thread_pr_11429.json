{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MDc2MTQ3", "number": 11429, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjowN1rOEZOsBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjowN1rOEZOsBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0ODkwNTAwOnYy", "diffSide": "RIGHT", "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjowN1rOHB7lEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzozNDoxN1rOHJF0uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA==", "bodyText": "So we could discuss this 400 vs. 500 problem in this PR (as suggested here: #11341 (comment)) or we could do it separately (Zulip?).\nThe main challenge I see is that MethodValidatedAnnotationsTransformer is only aware of a single transformation target at a time but to check potentially present interfaces for JAX-RS annotations, the transformer needs MethodInfo/ClassInfo for those interfaces.\nI guess the constructor of MethodValidatedAnnotationsTransformer has to be extended with more context...", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r471786768", "createdAt": "2020-08-17T21:32:07Z", "author": {"login": "famod"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjEzODA0OA==", "bodyText": "I think you could do something like method.declaringClass().interfaceTypes() and call .annotations() on the items of the list.", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r472138048", "createdAt": "2020-08-18T12:26:06Z", "author": {"login": "gsmet"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA=="}, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE0MzgwNg==", "bodyText": "The issue with it is that you basically only have a view of all the annotations of the type, they are not split by method.\nI think you could make calls to the bean archive index by getting it through the BeanArchiveIndexBuildItem. But I'm not entirely sure it's safe to use it in the AnnotationsTransformer. @mkouba WDYT?", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r472143806", "createdAt": "2020-08-18T12:35:23Z", "author": {"login": "gsmet"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA=="}, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDMyNjA5MA==", "bodyText": "Let's continue in #11506.", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r474326090", "createdAt": "2020-08-20T23:29:38Z", "author": {"login": "famod"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA=="}, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI5NDY1MQ==", "bodyText": "So in theory, you should be able to do TransformationContext#get(io.quarkus.arc.processor.BuildExtension.Key.INDEX) inside the AnnotationsTransformer.transform() method... or even TransformationContext#get(io.quarkus.arc.processor.BuildExtension.Key.ANNOTATION_STORE) but this could be tricky (I can smell stack overflow ;-).", "url": "https://github.com/quarkusio/quarkus/pull/11429#discussion_r479294651", "createdAt": "2020-08-28T13:34:17Z", "author": {"login": "mkouba"}, "path": "integration-tests/hibernate-validator/src/test/java/io/quarkus/it/hibernate/validator/HibernateValidatorFunctionalityTest.java", "diffHunk": "@@ -69,6 +69,36 @@ public void testRestEndPointValidation() {\n                 .body(is(\"42\"));\n     }\n \n+    @Test\n+    public void testRestEndPointInterfaceValidation() {\n+        RestAssured.when()\n+                .get(\"/hibernate-validator/test/rest-end-point-interface-validation/plop/\")\n+                .then()\n+                // 500 until this is fixed: https://github.com/quarkusio/quarkus/issues/11341#issuecomment-673146350", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4Njc2OA=="}, "originalCommit": {"oid": "f21487b355148fcd727a78f71760150c82ac2749"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 583, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}