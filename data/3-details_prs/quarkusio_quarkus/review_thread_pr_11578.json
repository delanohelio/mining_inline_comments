{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNjk4MTgx", "number": 11578, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxODo0NjowMlrOEbsrIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMjowMzoyNFrOEciuig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3NDc4OTQ0OnYy", "diffSide": "RIGHT", "path": "build-parent/pom.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxODo0NjowMlrOHFx40Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNDoyNzo1N1rOHK44MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTgyMjI4OQ==", "bodyText": "@galderz is there a 20.2.0-compatible Mandrel version to be released soon?", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r475822289", "createdAt": "2020-08-24T18:46:02Z", "author": {"login": "gastaldi"}, "path": "build-parent/pom.xml", "diffHunk": "@@ -33,7 +33,7 @@\n         <!-- These properties are needed in order for them to be resolvable by the documentation -->\n         <!-- The Graal version we suggest using in documentation - as that's\n            what we work with by self downloading it: -->\n-        <graal-sdk.version-for-documentation>20.1.0</graal-sdk.version-for-documentation>\n+        <graal-sdk.version-for-documentation>20.2.0</graal-sdk.version-for-documentation>\n         <mandrel.version-for-documentation>20.1.0.1.Final</mandrel.version-for-documentation>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0e6117566c8be6c0bf0b9335b681b819afe0122"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE3OTY5Ng==", "bodyText": "We're working to release a Mandrel 20.2.0 beta. There's one PR we'd like to get it to fix an timezone name issue. For 20.2.0 final, we need to wait until JDK 11.0.9 comes out.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r481179696", "createdAt": "2020-09-01T14:27:57Z", "author": {"login": "galderz"}, "path": "build-parent/pom.xml", "diffHunk": "@@ -33,7 +33,7 @@\n         <!-- These properties are needed in order for them to be resolvable by the documentation -->\n         <!-- The Graal version we suggest using in documentation - as that's\n            what we work with by self downloading it: -->\n-        <graal-sdk.version-for-documentation>20.1.0</graal-sdk.version-for-documentation>\n+        <graal-sdk.version-for-documentation>20.2.0</graal-sdk.version-for-documentation>\n         <mandrel.version-for-documentation>20.1.0.1.Final</mandrel.version-for-documentation>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTgyMjI4OQ=="}, "originalCommit": {"oid": "a0e6117566c8be6c0bf0b9335b681b819afe0122"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3NzQ2MzI0OnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwODowODowNlrOHGMiCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMzoxMjozNFrOHGXapQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1ODgyNA==", "bodyText": "Yeah so that's where I think we need some tweaking because doing that, we will recommend using 20.1 in the log message if people are using an older version which is not what we want to do.\nI think we need two constants: the minimal version and the current one.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r476258824", "createdAt": "2020-08-25T08:08:06Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -658,6 +658,7 @@ private static void objcopy(String... args) {\n             static final Version SNAPSHOT_MANDREL = new Version(\"Snapshot\", Integer.MAX_VALUE, Integer.MAX_VALUE,\n                     Distribution.MANDREL);\n             static final Version VERSION_20_1 = new Version(\"GraalVM 20.1\", 20, 1, Distribution.ORACLE);\n+            // Keeping 20.1 until Mandrel is updated\n             static final Version CURRENT = VERSION_20_1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d91a046e948c4b1b4317c52f011303aef9d9be3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1OTY3Mg==", "bodyText": "Btw, I wouldn't mind if I didn't think this would happen at each upgrade. There will always be a delay between Mandrel and GraalVM and we might release a version where both versions are not aligned.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r476259672", "createdAt": "2020-08-25T08:09:35Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -658,6 +658,7 @@ private static void objcopy(String... args) {\n             static final Version SNAPSHOT_MANDREL = new Version(\"Snapshot\", Integer.MAX_VALUE, Integer.MAX_VALUE,\n                     Distribution.MANDREL);\n             static final Version VERSION_20_1 = new Version(\"GraalVM 20.1\", 20, 1, Distribution.ORACLE);\n+            // Keeping 20.1 until Mandrel is updated\n             static final Version CURRENT = VERSION_20_1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1ODgyNA=="}, "originalCommit": {"oid": "d91a046e948c4b1b4317c52f011303aef9d9be3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM5MzcyMA==", "bodyText": "We can't release a final Mandrel 20.2 yet because we're depending on Java 11.0.9 changes coming up. GraalVM control their JDK (labs JDK) and they added some changes to the underlying JDK that is used for GraalVM 20.2. We're playing catch up here, unable to release final until 11.0.9 comes out.\nI think we should maybe rename CURRENT to MINIMUM, to signal that's the minimum version that we support. That's all CURRENT is used for, to detect which is the minimum version.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r476393720", "createdAt": "2020-08-25T12:00:49Z", "author": {"login": "galderz"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -658,6 +658,7 @@ private static void objcopy(String... args) {\n             static final Version SNAPSHOT_MANDREL = new Version(\"Snapshot\", Integer.MAX_VALUE, Integer.MAX_VALUE,\n                     Distribution.MANDREL);\n             static final Version VERSION_20_1 = new Version(\"GraalVM 20.1\", 20, 1, Distribution.ORACLE);\n+            // Keeping 20.1 until Mandrel is updated\n             static final Version CURRENT = VERSION_20_1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1ODgyNA=="}, "originalCommit": {"oid": "d91a046e948c4b1b4317c52f011303aef9d9be3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM5Mzk2OA==", "bodyText": "Having said that, we plan to release a Mandrel 20.2 beta shortly.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r476393968", "createdAt": "2020-08-25T12:01:16Z", "author": {"login": "galderz"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -658,6 +658,7 @@ private static void objcopy(String... args) {\n             static final Version SNAPSHOT_MANDREL = new Version(\"Snapshot\", Integer.MAX_VALUE, Integer.MAX_VALUE,\n                     Distribution.MANDREL);\n             static final Version VERSION_20_1 = new Version(\"GraalVM 20.1\", 20, 1, Distribution.ORACLE);\n+            // Keeping 20.1 until Mandrel is updated\n             static final Version CURRENT = VERSION_20_1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1ODgyNA=="}, "originalCommit": {"oid": "d91a046e948c4b1b4317c52f011303aef9d9be3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjQzNzE1Nw==", "bodyText": "No current is also used in the log message. So we need both MINIMUM and CURRENT.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r476437157", "createdAt": "2020-08-25T13:12:34Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -658,6 +658,7 @@ private static void objcopy(String... args) {\n             static final Version SNAPSHOT_MANDREL = new Version(\"Snapshot\", Integer.MAX_VALUE, Integer.MAX_VALUE,\n                     Distribution.MANDREL);\n             static final Version VERSION_20_1 = new Version(\"GraalVM 20.1\", 20, 1, Distribution.ORACLE);\n+            // Keeping 20.1 until Mandrel is updated\n             static final Version CURRENT = VERSION_20_1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI1ODgyNA=="}, "originalCommit": {"oid": "d91a046e948c4b1b4317c52f011303aef9d9be3a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MzY0NTU0OnYy", "diffSide": "RIGHT", "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMjowMzoyNFrOHHI15Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOTozMTowNVrOHHat1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzI0Njk0OQ==", "bodyText": "I'm not really happy with the wording change. I would keep the message as is, just using CURRENT and major.minor.\nI prefer recommending only one version even if we don't force the upgrade.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r477246949", "createdAt": "2020-08-26T12:03:24Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -495,10 +496,16 @@ private RuntimeException imageGenerationFailed(int exitValue, List<String> comma\n     private void checkGraalVMVersion(GraalVM.Version version) {\n         log.info(\"Running Quarkus native-image plugin on \" + version.getFullVersion());\n         if (version.isObsolete()) {\n-            final int major = GraalVM.Version.CURRENT.major;\n-            final int minor = GraalVM.Version.CURRENT.minor;\n-            throw new IllegalStateException(\"Out of date version of GraalVM detected: \" + version.getFullVersion() + \".\"\n-                    + \" Quarkus currently supports \" + major + \".\" + minor + \". Please upgrade GraalVM to this version.\");\n+            String currentVersion = GraalVM.Version.CURRENT.getFullVersion();\n+            if (GraalVM.Version.CURRENT != GraalVM.Version.MINIMUM) {\n+                currentVersion += \" (minimum: \" + GraalVM.Version.MINIMUM.getFullVersion() + \")\";\n+            }\n+            String msg = String.format(\"Out of date version of GraalVM detected: %s.\"\n+                    + \" Quarkus currently supports %s. Please upgrade to %s.\",\n+                    version.getFullVersion(),\n+                    currentVersion,\n+                    GraalVM.Version.CURRENT.getFullVersion());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f519ea8dfbb77508cdb07d37ae0e68596642cb16"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM0MDUyMg==", "bodyText": "Just to be clear: you recommend to display only the current version in the message and use the minimum just to check if the GraalVM used is obsolete?", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r477340522", "createdAt": "2020-08-26T14:22:08Z", "author": {"login": "gastaldi"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -495,10 +496,16 @@ private RuntimeException imageGenerationFailed(int exitValue, List<String> comma\n     private void checkGraalVMVersion(GraalVM.Version version) {\n         log.info(\"Running Quarkus native-image plugin on \" + version.getFullVersion());\n         if (version.isObsolete()) {\n-            final int major = GraalVM.Version.CURRENT.major;\n-            final int minor = GraalVM.Version.CURRENT.minor;\n-            throw new IllegalStateException(\"Out of date version of GraalVM detected: \" + version.getFullVersion() + \".\"\n-                    + \" Quarkus currently supports \" + major + \".\" + minor + \". Please upgrade GraalVM to this version.\");\n+            String currentVersion = GraalVM.Version.CURRENT.getFullVersion();\n+            if (GraalVM.Version.CURRENT != GraalVM.Version.MINIMUM) {\n+                currentVersion += \" (minimum: \" + GraalVM.Version.MINIMUM.getFullVersion() + \")\";\n+            }\n+            String msg = String.format(\"Out of date version of GraalVM detected: %s.\"\n+                    + \" Quarkus currently supports %s. Please upgrade to %s.\",\n+                    version.getFullVersion(),\n+                    currentVersion,\n+                    GraalVM.Version.CURRENT.getFullVersion());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzI0Njk0OQ=="}, "originalCommit": {"oid": "f519ea8dfbb77508cdb07d37ae0e68596642cb16"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzOTc5Ng==", "bodyText": "Yes, I would keep the current message as is. And use the minimum version to determine if we should display it.\nThat's what we did before Galder's refactoring. This way we encourage people to migrate to the currently supported (and tested) version.", "url": "https://github.com/quarkusio/quarkus/pull/11578#discussion_r477539796", "createdAt": "2020-08-26T19:31:05Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -495,10 +496,16 @@ private RuntimeException imageGenerationFailed(int exitValue, List<String> comma\n     private void checkGraalVMVersion(GraalVM.Version version) {\n         log.info(\"Running Quarkus native-image plugin on \" + version.getFullVersion());\n         if (version.isObsolete()) {\n-            final int major = GraalVM.Version.CURRENT.major;\n-            final int minor = GraalVM.Version.CURRENT.minor;\n-            throw new IllegalStateException(\"Out of date version of GraalVM detected: \" + version.getFullVersion() + \".\"\n-                    + \" Quarkus currently supports \" + major + \".\" + minor + \". Please upgrade GraalVM to this version.\");\n+            String currentVersion = GraalVM.Version.CURRENT.getFullVersion();\n+            if (GraalVM.Version.CURRENT != GraalVM.Version.MINIMUM) {\n+                currentVersion += \" (minimum: \" + GraalVM.Version.MINIMUM.getFullVersion() + \")\";\n+            }\n+            String msg = String.format(\"Out of date version of GraalVM detected: %s.\"\n+                    + \" Quarkus currently supports %s. Please upgrade to %s.\",\n+                    version.getFullVersion(),\n+                    currentVersion,\n+                    GraalVM.Version.CURRENT.getFullVersion());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzI0Njk0OQ=="}, "originalCommit": {"oid": "f519ea8dfbb77508cdb07d37ae0e68596642cb16"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 502, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}