{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExOTMzMDE3", "number": 8995, "title": "Improve transformer dev mode performance", "bodyText": "", "createdAt": "2020-05-01T01:45:05Z", "url": "https://github.com/quarkusio/quarkus/pull/8995", "merged": true, "mergeCommit": {"oid": "b38dac7796eccc00ac932d0a8ae51b5116d8692e"}, "closed": true, "closedAt": "2020-05-06T03:43:36Z", "author": {"login": "stuartwdouglas"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcc364JgBqjMyOTE5OTg2OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceG3WjAFqTQwNTM4MDQ2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2a95a15694941e0872f47edee76f5050d670992", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/b2a95a15694941e0872f47edee76f5050d670992", "committedDate": "2020-05-01T01:44:24Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}, "afterCommit": {"oid": "a9fc18c12e29111b5278d1f533335332d9154901", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/a9fc18c12e29111b5278d1f533335332d9154901", "committedDate": "2020-05-01T02:04:46Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be2302ec35eb50806ad75f4012f251342f7fe539", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/be2302ec35eb50806ad75f4012f251342f7fe539", "committedDate": "2020-05-01T02:50:31Z", "message": "Improve getResources performance"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9fc18c12e29111b5278d1f533335332d9154901", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/a9fc18c12e29111b5278d1f533335332d9154901", "committedDate": "2020-05-01T02:04:46Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}, "afterCommit": {"oid": "fcae90b56202897bc0128ac82b0fda8fa2b61869", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/fcae90b56202897bc0128ac82b0fda8fa2b61869", "committedDate": "2020-05-01T02:50:36Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19e7bdbc5547ae4306fb6f0d85499a97076f19b4", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/19e7bdbc5547ae4306fb6f0d85499a97076f19b4", "committedDate": "2020-05-01T03:56:48Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fcae90b56202897bc0128ac82b0fda8fa2b61869", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/fcae90b56202897bc0128ac82b0fda8fa2b61869", "committedDate": "2020-05-01T02:50:36Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}, "afterCommit": {"oid": "19e7bdbc5547ae4306fb6f0d85499a97076f19b4", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/19e7bdbc5547ae4306fb6f0d85499a97076f19b4", "committedDate": "2020-05-01T03:56:48Z", "message": "Do transformation eagerly in dev mode\n\nIt's the most expensive part of bootstrap,\nmight as well get all the cores involved"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0OTY3NTM0", "url": "https://github.com/quarkusio/quarkus/pull/8995#pullrequestreview-404967534", "createdAt": "2020-05-04T13:06:03Z", "commit": {"oid": "19e7bdbc5547ae4306fb6f0d85499a97076f19b4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzowNjowNFrOGP_Y1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxMzowNjowNFrOGP_Y1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQyMDM3Mw==", "bodyText": "What if you have only one core in a container?", "url": "https://github.com/quarkusio/quarkus/pull/8995#discussion_r419420373", "createdAt": "2020-05-04T13:06:04Z", "author": {"login": "gsmet"}, "path": "core/deployment/src/main/java/io/quarkus/runner/bootstrap/StartupActionImpl.java", "diffHunk": "@@ -66,12 +72,47 @@ public StartupActionImpl(CuratedApplication curatedApplication, BuildResult buil\n             runtimeClassLoader = baseClassLoader;\n         }\n         this.runtimeClassLoader = runtimeClassLoader;\n+        handleEagerClasses(runtimeClassLoader, eagerClasses);\n+    }\n+\n+    private void handleEagerClasses(QuarkusClassLoader runtimeClassLoader, Set<String> eagerClasses) {\n+        int availableProcessors = Runtime.getRuntime().availableProcessors();\n+        if (availableProcessors == 1) {\n+            return;\n+        }\n+        //leave one processor for the main startup thread\n+        ExecutorService loadingExecutor = Executors.newFixedThreadPool(availableProcessors - 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e7bdbc5547ae4306fb6f0d85499a97076f19b4"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MzgwNDYx", "url": "https://github.com/quarkusio/quarkus/pull/8995#pullrequestreview-405380461", "createdAt": "2020-05-04T22:03:42Z", "commit": {"oid": "19e7bdbc5547ae4306fb6f0d85499a97076f19b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4409, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}