{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxOTM3NzEx", "number": 7498, "title": "Add logging of hibernate orm bind params", "bodyText": "\"quarkus.hibernate-orm.log.sql\" now supports an extended option, which enables logging of bind params\ncloses #3075", "createdAt": "2020-02-29T19:56:48Z", "url": "https://github.com/quarkusio/quarkus/pull/7498", "merged": true, "mergeCommit": {"oid": "8501c9ffd2b4b1a4bc9604e0a078ffd208ad138c"}, "closed": true, "closedAt": "2020-03-26T21:54:00Z", "author": {"login": "Postremus"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJM8J7AFqTM2NjgyNTA3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRjV6CAFqTM4MjQ0NzkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODI1MDc3", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-366825077", "createdAt": "2020-02-29T23:15:57Z", "commit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQyMzoxNTo1N1rOFwLYRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQyMzoxNTo1N1rOFwLYRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA2MjQwNw==", "bodyText": "Shouldn't this be defaultValue=false?", "url": "https://github.com/quarkusio/quarkus/pull/7498#discussion_r386062407", "createdAt": "2020-02-29T23:15:57Z", "author": {"login": "machi1990"}, "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfig.java", "diffHunk": "@@ -279,10 +279,19 @@ public boolean isAnyPropertySet() {\n         /**\n          * Show SQL logs and format them nicely.\n          * <p>\n+         * true logs sql statements\n+         * extended logs sql statements and bind parameter values\n+         * <p>\n          * Setting it to true is obviously not recommended in production.\n          */\n-        @ConfigItem(defaultValue = \"false\")\n-        public boolean sql;\n+        @ConfigItem(defaultValueDocumentation = \"false\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODQ1MTA1", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-366845105", "createdAt": "2020-03-01T09:11:30Z", "commit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQwOToxMTozMVrOFwNGhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQwOToxMjozMVrOFwNGxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA5MDYyOQ==", "bodyText": "Please don't rely on the ordinal, it's prone to errors in case someone re-orders the enum constants down the road. I think simply checking for the two enum constants is good enough; or, if you'd want something more generic, add methods to the enum such as boolean logsSql() (returning true for TRUE and EXTENDED) and boolean logsParameters().", "url": "https://github.com/quarkusio/quarkus/pull/7498#discussion_r386090629", "createdAt": "2020-03-01T09:11:31Z", "author": {"login": "gunnarmorling"}, "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java", "diffHunk": "@@ -642,9 +644,14 @@ private void handleHibernateORMWithNoPersistenceXml(\n                                 fetchSize.toString()));\n \n                 // Logging\n-                if (hibernateConfig.log.sql) {\n-                    desc.getProperties().setProperty(AvailableSettings.SHOW_SQL, \"true\");\n-                    desc.getProperties().setProperty(AvailableSettings.FORMAT_SQL, \"true\");\n+                if (hibernateConfig.log.sql.isPresent()) {\n+                    HibernateOrmConfig.HibernateOrmConfigLog.HibernateOrmConfigLogSqlValue value = hibernateConfig.log.sql\n+                            .get();\n+                    if (value.ordinal() >= HibernateOrmConfig.HibernateOrmConfigLog.HibernateOrmConfigLogSqlValue.TRUE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA5MDY5NQ==", "bodyText": "Why is it optional, if there is a default value?", "url": "https://github.com/quarkusio/quarkus/pull/7498#discussion_r386090695", "createdAt": "2020-03-01T09:12:31Z", "author": {"login": "gunnarmorling"}, "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfig.java", "diffHunk": "@@ -279,10 +279,19 @@ public boolean isAnyPropertySet() {\n         /**\n          * Show SQL logs and format them nicely.\n          * <p>\n+         * true logs sql statements\n+         * extended logs sql statements and bind parameter values\n+         * <p>\n          * Setting it to true is obviously not recommended in production.\n          */\n-        @ConfigItem(defaultValue = \"false\")\n-        public boolean sql;\n+        @ConfigItem(defaultValueDocumentation = \"false\")\n+        public Optional<HibernateOrmConfigLogSqlValue> sql;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODU3NTk1", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-366857595", "createdAt": "2020-03-01T12:59:16Z", "commit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMjo1OToxNlrOFwODUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMjo1OToxNlrOFwODUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEwNjE5NQ==", "bodyText": "Yeah definitely not.", "url": "https://github.com/quarkusio/quarkus/pull/7498#discussion_r386106195", "createdAt": "2020-03-01T12:59:16Z", "author": {"login": "dmlloyd"}, "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfig.java", "diffHunk": "@@ -279,10 +279,19 @@ public boolean isAnyPropertySet() {\n         /**\n          * Show SQL logs and format them nicely.\n          * <p>\n+         * true logs sql statements\n+         * extended logs sql statements and bind parameter values\n+         * <p>\n          * Setting it to true is obviously not recommended in production.\n          */\n-        @ConfigItem(defaultValue = \"false\")\n-        public boolean sql;\n+        @ConfigItem(defaultValueDocumentation = \"false\")\n+        public Optional<HibernateOrmConfigLogSqlValue> sql;\n+\n+        public enum HibernateOrmConfigLogSqlValue {\n+            FALSE,\n+            TRUE,\n+            EXTENDED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30c90a9f7edb278d477b2b4f96e2ad17cc468950", "author": {"user": {"login": "Postremus", "name": "Martin Panzer"}}, "url": "https://github.com/quarkusio/quarkus/commit/30c90a9f7edb278d477b2b4f96e2ad17cc468950", "committedDate": "2020-03-06T20:52:02Z", "message": "Add logging of hibernate orm bind params\n\"quarkus.hibernate-orm.log.bindparam\" added for logging of bind parameters"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0267ff4124b69c3dbcab4c8600d02983bd3e8edd", "author": {"user": {"login": "Postremus", "name": "Martin Panzer"}}, "url": "https://github.com/quarkusio/quarkus/commit/0267ff4124b69c3dbcab4c8600d02983bd3e8edd", "committedDate": "2020-02-29T17:43:08Z", "message": "Add logging of hibernate orm bind params\n\"quarkus.hibernate-orm.log.sql\" now supports an extended option, which enables logging of bind params\ncloses #3075"}, "afterCommit": {"oid": "30c90a9f7edb278d477b2b4f96e2ad17cc468950", "author": {"user": {"login": "Postremus", "name": "Martin Panzer"}}, "url": "https://github.com/quarkusio/quarkus/commit/30c90a9f7edb278d477b2b4f96e2ad17cc468950", "committedDate": "2020-03-06T20:52:02Z", "message": "Add logging of hibernate orm bind params\n\"quarkus.hibernate-orm.log.bindparam\" added for logging of bind parameters"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NTgxNTY4", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-374581568", "createdAt": "2020-03-13T20:08:53Z", "commit": {"oid": "30c90a9f7edb278d477b2b4f96e2ad17cc468950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDA4MjA4", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-382408208", "createdAt": "2020-03-26T20:52:29Z", "commit": {"oid": "30c90a9f7edb278d477b2b4f96e2ad17cc468950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDQ3OTM4", "url": "https://github.com/quarkusio/quarkus/pull/7498#pullrequestreview-382447938", "createdAt": "2020-03-26T21:53:24Z", "commit": {"oid": "30c90a9f7edb278d477b2b4f96e2ad17cc468950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4060, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}