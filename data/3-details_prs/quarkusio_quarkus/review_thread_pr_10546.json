{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1ODY5MDU1", "number": 10546, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoxNzo0OFrOEMWIJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoxOToyN1rOEMWJmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMzgwOTAxOnYy", "diffSide": "RIGHT", "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoxNzo0OFrOGuZnVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoyOTowNFrOGuZ3kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzM0OQ==", "bodyText": "So the only difference compared to the injected observer param is that the Vertx instance is only obtained if there is at least one bean that extends AbstractVerticle?", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451307349", "createdAt": "2020-07-08T06:17:48Z", "author": {"login": "mkouba"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -115,6 +110,8 @@ void undeployVerticles(@Observes @BeforeDestroyed(ApplicationScoped.class) Objec\n                     // Only existing instances are considered\n                     try {\n                         AbstractVerticle verticle = (AbstractVerticle) instance;\n+                        io.vertx.mutiny.core.Vertx mutiny = beanManager.createInstance()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwODk5Mg==", "bodyText": "One already created bean, which generally won't happen until runtime when you actually have vert.x.\nCurrently if you fail in static init then this method is called, but vert.x is not ready yet (as it is a runtime bean), so you get an extra unrelated exception in your logs (and possible unclean shutdown).", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451308992", "createdAt": "2020-07-08T06:22:32Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -115,6 +110,8 @@ void undeployVerticles(@Observes @BeforeDestroyed(ApplicationScoped.class) Objec\n                     // Only existing instances are considered\n                     try {\n                         AbstractVerticle verticle = (AbstractVerticle) instance;\n+                        io.vertx.mutiny.core.Vertx mutiny = beanManager.createInstance()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzM0OQ=="}, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMxMTUwNQ==", "bodyText": "I see. That makes sense.", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451311505", "createdAt": "2020-07-08T06:29:04Z", "author": {"login": "mkouba"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -115,6 +110,8 @@ void undeployVerticles(@Observes @BeforeDestroyed(ApplicationScoped.class) Objec\n                     // Only existing instances are considered\n                     try {\n                         AbstractVerticle verticle = (AbstractVerticle) instance;\n+                        io.vertx.mutiny.core.Vertx mutiny = beanManager.createInstance()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzM0OQ=="}, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMzgxMjczOnYy", "diffSide": "RIGHT", "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoxOToyN1rOGuZpjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNjoyOTowN1rOGuZ3sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzkxNg==", "bodyText": "So what happens if a user code injects Vertx?", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451307916", "createdAt": "2020-07-08T06:19:27Z", "author": {"login": "mkouba"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -34,25 +33,22 @@\n \n     private static final Logger LOGGER = Logger.getLogger(VertxProducer.class);\n \n-    @Inject\n-    Vertx vertx;\n-\n     @Singleton\n     @Produces\n-    public EventBus eventbus() {\n+    public EventBus eventbus(Vertx vertx) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwOTE4MQ==", "bodyText": "It's undeployVerticles that is the problem, if it was in a different class these would be fine.", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451309181", "createdAt": "2020-07-08T06:23:02Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -34,25 +33,22 @@\n \n     private static final Logger LOGGER = Logger.getLogger(VertxProducer.class);\n \n-    @Inject\n-    Vertx vertx;\n-\n     @Singleton\n     @Produces\n-    public EventBus eventbus() {\n+    public EventBus eventbus(Vertx vertx) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzkxNg=="}, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMxMTUzNg==", "bodyText": "OK.", "url": "https://github.com/quarkusio/quarkus/pull/10546#discussion_r451311536", "createdAt": "2020-07-08T06:29:07Z", "author": {"login": "mkouba"}, "path": "extensions/vertx/runtime/src/main/java/io/quarkus/vertx/runtime/VertxProducer.java", "diffHunk": "@@ -34,25 +33,22 @@\n \n     private static final Logger LOGGER = Logger.getLogger(VertxProducer.class);\n \n-    @Inject\n-    Vertx vertx;\n-\n     @Singleton\n     @Produces\n-    public EventBus eventbus() {\n+    public EventBus eventbus(Vertx vertx) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwNzkxNg=="}, "originalCommit": {"oid": "a30ab3fb2cafba18c76cab2e6a104e4f5d95db85"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2604, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}