{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5OTgxOTY0", "number": 11459, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwODozODowOVrOEaaHWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwODozODowOVrOEaaHWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MTI2Mjk4OnYy", "diffSide": "RIGHT", "path": "extensions/smallrye-graphql/deployment/src/main/java/io/quarkus/smallrye/graphql/deployment/SmallRyeGraphQLProcessor.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwODozODowOVrOHD0fbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMjowNjo0OFrOHD9yGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc2Nzc5MQ==", "bodyText": "I'm not sure it's the right fix.\nWhat I think would be right is:\n\nregister the owner with a class build item\nregister the return types of the GraphQL methods with a hierarchy build item\n\nIf you have a hierarchy of complex objects for the return type, I think what you did will not work.", "url": "https://github.com/quarkusio/quarkus/pull/11459#discussion_r473767791", "createdAt": "2020-08-20T08:38:09Z", "author": {"login": "gsmet"}, "path": "extensions/smallrye-graphql/deployment/src/main/java/io/quarkus/smallrye/graphql/deployment/SmallRyeGraphQLProcessor.java", "diffHunk": "@@ -156,11 +155,7 @@ void buildExecutionService(\n         recorder.createExecutionService(beanContainer.getValue(), schema);\n \n         // Make sure the complex object from the application can work in native mode\n-        for (String c : getClassesToRegisterForReflection(schema)) {\n-            DotName name = DotName.createSimple(c);\n-            org.jboss.jandex.Type type = org.jboss.jandex.Type.create(name, org.jboss.jandex.Type.Kind.CLASS);\n-            reflectiveHierarchyProducer.produce(new ReflectiveHierarchyBuildItem(type, index));\n-        }\n+        reflectiveClassProducer.produce(new ReflectiveClassBuildItem(true, true, getSchemaJavaClasses(schema)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88fe7aff41b6040dd429edbca0da710b60052d80"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc3MjE2OA==", "bodyText": "We already know the hierarchy as the model build that, but I am happy to change as you suggest. Let me add a test case with that scenario then we can see.", "url": "https://github.com/quarkusio/quarkus/pull/11459#discussion_r473772168", "createdAt": "2020-08-20T08:43:07Z", "author": {"login": "phillip-kruger"}, "path": "extensions/smallrye-graphql/deployment/src/main/java/io/quarkus/smallrye/graphql/deployment/SmallRyeGraphQLProcessor.java", "diffHunk": "@@ -156,11 +155,7 @@ void buildExecutionService(\n         recorder.createExecutionService(beanContainer.getValue(), schema);\n \n         // Make sure the complex object from the application can work in native mode\n-        for (String c : getClassesToRegisterForReflection(schema)) {\n-            DotName name = DotName.createSimple(c);\n-            org.jboss.jandex.Type type = org.jboss.jandex.Type.create(name, org.jboss.jandex.Type.Kind.CLASS);\n-            reflectiveHierarchyProducer.produce(new ReflectiveHierarchyBuildItem(type, index));\n-        }\n+        reflectiveClassProducer.produce(new ReflectiveClassBuildItem(true, true, getSchemaJavaClasses(schema)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc2Nzc5MQ=="}, "originalCommit": {"oid": "88fe7aff41b6040dd429edbca0da710b60052d80"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkyMDAyNw==", "bodyText": "Hey @gsmet - I added some tests to test parent and child classes. All seems ok. The model we build already discover all the classes needed. So this fix should be ok. Let me know.", "url": "https://github.com/quarkusio/quarkus/pull/11459#discussion_r473920027", "createdAt": "2020-08-20T12:06:48Z", "author": {"login": "phillip-kruger"}, "path": "extensions/smallrye-graphql/deployment/src/main/java/io/quarkus/smallrye/graphql/deployment/SmallRyeGraphQLProcessor.java", "diffHunk": "@@ -156,11 +155,7 @@ void buildExecutionService(\n         recorder.createExecutionService(beanContainer.getValue(), schema);\n \n         // Make sure the complex object from the application can work in native mode\n-        for (String c : getClassesToRegisterForReflection(schema)) {\n-            DotName name = DotName.createSimple(c);\n-            org.jboss.jandex.Type type = org.jboss.jandex.Type.create(name, org.jboss.jandex.Type.Kind.CLASS);\n-            reflectiveHierarchyProducer.produce(new ReflectiveHierarchyBuildItem(type, index));\n-        }\n+        reflectiveClassProducer.produce(new ReflectiveClassBuildItem(true, true, getSchemaJavaClasses(schema)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc2Nzc5MQ=="}, "originalCommit": {"oid": "88fe7aff41b6040dd429edbca0da710b60052d80"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 602, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}