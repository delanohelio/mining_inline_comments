{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5Nzk0MDM3", "number": 6928, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMjoxNzoyMFrODcX2Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMzo1NzozN1rODco-ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMDc3Mzc4OnYy", "diffSide": "RIGHT", "path": "core/runtime/src/main/java/io/quarkus/runtime/configuration/ConfigUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMjoxNzoyMFrOFkZdFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMjoxNzoyMFrOFkZdFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxMDEwMw==", "bodyText": "@gastaldi you were totally right about this :)", "url": "https://github.com/quarkusio/quarkus/pull/6928#discussion_r373710103", "createdAt": "2020-01-31T22:17:20Z", "author": {"login": "dmlloyd"}, "path": "core/runtime/src/main/java/io/quarkus/runtime/configuration/ConfigUtils.java", "diffHunk": "@@ -86,32 +95,68 @@ public static void addSourceProvider(SmallRyeConfigBuilder builder, ConfigSource\n         }\n     }\n \n-    static final class EnvConfigSource implements ConfigSource {\n+    static class EnvConfigSource implements ConfigSource {\n         static final Pattern REP_PATTERN = Pattern.compile(\"[^a-zA-Z0-9_]\");\n \n-        private final int ordinal;\n-\n-        EnvConfigSource(final int ordinal) {\n-            this.ordinal = ordinal;\n+        EnvConfigSource() {\n         }\n \n         public int getOrdinal() {\n-            return ordinal;\n+            return 300;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9f5b981e5967858e7959e26d86fbf3e454280df"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMzU4MTM4OnYy", "diffSide": "RIGHT", "path": "core/runtime/src/main/java/io/quarkus/runtime/configuration/ConfigUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMzo1NzozN1rOFkyMcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxNDoxMTowNFrOFkynZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNTQ0Mw==", "bodyText": "Not a big deal, but maybe it would be nice to debug log any IOExceptions thrown here", "url": "https://github.com/quarkusio/quarkus/pull/6928#discussion_r374115443", "createdAt": "2020-02-03T13:57:37Z", "author": {"login": "gastaldi"}, "path": "core/runtime/src/main/java/io/quarkus/runtime/configuration/ConfigUtils.java", "diffHunk": "@@ -86,32 +95,68 @@ public static void addSourceProvider(SmallRyeConfigBuilder builder, ConfigSource\n         }\n     }\n \n-    static final class EnvConfigSource implements ConfigSource {\n+    static class EnvConfigSource implements ConfigSource {\n         static final Pattern REP_PATTERN = Pattern.compile(\"[^a-zA-Z0-9_]\");\n \n-        private final int ordinal;\n-\n-        EnvConfigSource(final int ordinal) {\n-            this.ordinal = ordinal;\n+        EnvConfigSource() {\n         }\n \n         public int getOrdinal() {\n-            return ordinal;\n+            return 300;\n         }\n \n         public Map<String, String> getProperties() {\n             return Collections.emptyMap();\n         }\n \n         public String getValue(final String propertyName) {\n-            return System.getenv(REP_PATTERN.matcher(propertyName.toUpperCase(Locale.ROOT)).replaceAll(\"_\"));\n+            return getRawValue(REP_PATTERN.matcher(propertyName.toUpperCase(Locale.ROOT)).replaceAll(\"_\"));\n+        }\n+\n+        String getRawValue(final String name) {\n+            return System.getenv(name);\n         }\n \n         public String getName() {\n             return \"System environment\";\n         }\n     }\n \n+    static class DotEnvConfigSource extends EnvConfigSource {\n+        private final Map<String, String> values;\n+\n+        DotEnvConfigSource() {\n+            this(Paths.get(System.getProperty(\"user.dir\", \".\"), \".env\"));\n+        }\n+\n+        DotEnvConfigSource(Path path) {\n+            Map<String, String> values = new HashMap<>();\n+            try (InputStream is = Files.newInputStream(path)) {\n+                try (InputStreamReader isr = new InputStreamReader(is, StandardCharsets.UTF_8)) {\n+                    final Properties properties = new Properties();\n+                    properties.load(isr);\n+                    for (String name : properties.stringPropertyNames()) {\n+                        values.put(name, properties.getProperty(name));\n+                    }\n+                }\n+            } catch (IOException ignored) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "207976341c56e0a37e5dfd63edc415738feb6459"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDEyMjM0MQ==", "bodyText": "Fixed \ud83d\udc4d", "url": "https://github.com/quarkusio/quarkus/pull/6928#discussion_r374122341", "createdAt": "2020-02-03T14:11:04Z", "author": {"login": "dmlloyd"}, "path": "core/runtime/src/main/java/io/quarkus/runtime/configuration/ConfigUtils.java", "diffHunk": "@@ -86,32 +95,68 @@ public static void addSourceProvider(SmallRyeConfigBuilder builder, ConfigSource\n         }\n     }\n \n-    static final class EnvConfigSource implements ConfigSource {\n+    static class EnvConfigSource implements ConfigSource {\n         static final Pattern REP_PATTERN = Pattern.compile(\"[^a-zA-Z0-9_]\");\n \n-        private final int ordinal;\n-\n-        EnvConfigSource(final int ordinal) {\n-            this.ordinal = ordinal;\n+        EnvConfigSource() {\n         }\n \n         public int getOrdinal() {\n-            return ordinal;\n+            return 300;\n         }\n \n         public Map<String, String> getProperties() {\n             return Collections.emptyMap();\n         }\n \n         public String getValue(final String propertyName) {\n-            return System.getenv(REP_PATTERN.matcher(propertyName.toUpperCase(Locale.ROOT)).replaceAll(\"_\"));\n+            return getRawValue(REP_PATTERN.matcher(propertyName.toUpperCase(Locale.ROOT)).replaceAll(\"_\"));\n+        }\n+\n+        String getRawValue(final String name) {\n+            return System.getenv(name);\n         }\n \n         public String getName() {\n             return \"System environment\";\n         }\n     }\n \n+    static class DotEnvConfigSource extends EnvConfigSource {\n+        private final Map<String, String> values;\n+\n+        DotEnvConfigSource() {\n+            this(Paths.get(System.getProperty(\"user.dir\", \".\"), \".env\"));\n+        }\n+\n+        DotEnvConfigSource(Path path) {\n+            Map<String, String> values = new HashMap<>();\n+            try (InputStream is = Files.newInputStream(path)) {\n+                try (InputStreamReader isr = new InputStreamReader(is, StandardCharsets.UTF_8)) {\n+                    final Properties properties = new Properties();\n+                    properties.load(isr);\n+                    for (String name : properties.stringPropertyNames()) {\n+                        values.put(name, properties.getProperty(name));\n+                    }\n+                }\n+            } catch (IOException ignored) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNTQ0Mw=="}, "originalCommit": {"oid": "207976341c56e0a37e5dfd63edc415738feb6459"}, "originalPosition": 85}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1079, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}