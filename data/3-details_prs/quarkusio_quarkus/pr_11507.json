{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxMzIxMDUw", "number": 11507, "title": "Manage Quartz Jobs through ArC", "bodyText": "Fixes #11496", "createdAt": "2020-08-21T01:21:06Z", "url": "https://github.com/quarkusio/quarkus/pull/11507", "merged": true, "mergeCommit": {"oid": "75aa0b6b8f61f2c153650361e08106ea9957ef05"}, "closed": true, "closedAt": "2020-08-22T01:36:30Z", "author": {"login": "gastaldi"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdA6w8FgBqjM2Nzc3MDA2MjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBITTWgFqTQ3MjY2NzkyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "76e69c6473e16dac739985b7ac152e906eb8eebe", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/76e69c6473e16dac739985b7ac152e906eb8eebe", "committedDate": "2020-08-21T01:20:46Z", "message": "Manage Jobs through ArC\n\nFixes #11496"}, "afterCommit": {"oid": "5d814cac178b371aeda0c2096f42542a0f61e8d3", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/5d814cac178b371aeda0c2096f42542a0f61e8d3", "committedDate": "2020-08-21T01:45:02Z", "message": "Manage Jobs through ArC\n\nFixes #11496"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMzMxNjk0", "url": "https://github.com/quarkusio/quarkus/pull/11507#pullrequestreview-472331694", "createdAt": "2020-08-21T09:11:53Z", "commit": {"oid": "5d814cac178b371aeda0c2096f42542a0f61e8d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMzMzOTA0", "url": "https://github.com/quarkusio/quarkus/pull/11507#pullrequestreview-472333904", "createdAt": "2020-08-21T09:15:11Z", "commit": {"oid": "5d814cac178b371aeda0c2096f42542a0f61e8d3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMzM5NTMx", "url": "https://github.com/quarkusio/quarkus/pull/11507#pullrequestreview-472339531", "createdAt": "2020-08-21T09:23:22Z", "commit": {"oid": "5d814cac178b371aeda0c2096f42542a0f61e8d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwOToyMzoyM1rOHEldEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwOToyMzoyM1rOHEldEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU3MDAwMA==", "bodyText": "Just a side note - do we somehow automatically register all implementations of Job as beans? I didn't find any such logic in quartz processors but it might be just lack of caffeine on my side :)", "url": "https://github.com/quarkusio/quarkus/pull/11507#discussion_r474570000", "createdAt": "2020-08-21T09:23:23Z", "author": {"login": "manovotn"}, "path": "extensions/quartz/deployment/src/test/java/io/quarkus/quartz/test/InjectJobTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package io.quarkus.quartz.test;\n+\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.enterprise.event.Observes;\n+import javax.enterprise.inject.Produces;\n+import javax.inject.Inject;\n+import javax.inject.Singleton;\n+\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.asset.StringAsset;\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+import org.quartz.Job;\n+import org.quartz.JobBuilder;\n+import org.quartz.JobDetail;\n+import org.quartz.JobExecutionContext;\n+import org.quartz.JobExecutionException;\n+import org.quartz.Scheduler;\n+import org.quartz.SchedulerException;\n+import org.quartz.SimpleScheduleBuilder;\n+import org.quartz.Trigger;\n+import org.quartz.TriggerBuilder;\n+\n+import io.quarkus.arc.Arc;\n+import io.quarkus.runtime.StartupEvent;\n+import io.quarkus.test.QuarkusUnitTest;\n+\n+public class InjectJobTest {\n+\n+    @RegisterExtension\n+    static final QuarkusUnitTest test = new QuarkusUnitTest()\n+            .setArchiveProducer(() -> ShrinkWrap.create(JavaArchive.class)\n+                    .addClasses(Starter.class, Service.class, CountDownLatchProducer.class)\n+                    .addAsResource(new StringAsset(\"quarkus.quartz.force-start=true\"),\n+                            \"application.properties\"));\n+\n+    @Test\n+    public void testSimpleScheduledJobs() throws InterruptedException {\n+        CountDownLatch latch = Arc.container().instance(CountDownLatch.class).get();\n+        assertTrue(latch.await(5, TimeUnit.SECONDS), \"Latch count: \" + latch.getCount());\n+    }\n+\n+    @ApplicationScoped\n+    public static class CountDownLatchProducer {\n+        @Produces\n+        @Singleton\n+        CountDownLatch LATCH = new CountDownLatch(2);\n+    }\n+\n+    @ApplicationScoped\n+    public static class Service {\n+\n+        @Inject\n+        CountDownLatch latch;\n+\n+        public void execute() {\n+            latch.countDown();\n+        }\n+\n+    }\n+\n+    public static class Starter implements Job {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d814cac178b371aeda0c2096f42542a0f61e8d3"}, "originalPosition": 68}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d780cca14f578b5f85a6499bc268a2668a608ad8", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/d780cca14f578b5f85a6499bc268a2668a608ad8", "committedDate": "2020-08-21T14:40:57Z", "message": "Update Quartz documentation"}, "afterCommit": {"oid": "3d95e74219767a1aa5efd4b3474658825b8a6675", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/3d95e74219767a1aa5efd4b3474658825b8a6675", "committedDate": "2020-08-21T14:42:56Z", "message": "Update Quartz documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNTUyMjYz", "url": "https://github.com/quarkusio/quarkus/pull/11507#pullrequestreview-472552263", "createdAt": "2020-08-21T14:46:20Z", "commit": {"oid": "3d95e74219767a1aa5efd4b3474658825b8a6675"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d95e74219767a1aa5efd4b3474658825b8a6675", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/3d95e74219767a1aa5efd4b3474658825b8a6675", "committedDate": "2020-08-21T14:42:56Z", "message": "Update Quartz documentation"}, "afterCommit": {"oid": "c1bf056a19a28d42e61667aa79f3d48ed7b3ba7a", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/c1bf056a19a28d42e61667aa79f3d48ed7b3ba7a", "committedDate": "2020-08-21T14:53:33Z", "message": "Update Quartz documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e26899fd79aa89da54bb4391331015368d4f0a7", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/1e26899fd79aa89da54bb4391331015368d4f0a7", "committedDate": "2020-08-21T16:31:33Z", "message": "Manage Jobs through ArC\n\nFixes #11496"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1bf056a19a28d42e61667aa79f3d48ed7b3ba7a", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/c1bf056a19a28d42e61667aa79f3d48ed7b3ba7a", "committedDate": "2020-08-21T14:53:33Z", "message": "Update Quartz documentation"}, "afterCommit": {"oid": "cc3ea94b564fd6dad193fa55371aa686cdedba36", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/cc3ea94b564fd6dad193fa55371aa686cdedba36", "committedDate": "2020-08-21T16:31:34Z", "message": "Update Quartz documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "102f6156ac92478bad532b9f20ae5e1fd76a614a", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/102f6156ac92478bad532b9f20ae5e1fd76a614a", "committedDate": "2020-08-21T17:02:24Z", "message": "Update Quartz documentation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc3ea94b564fd6dad193fa55371aa686cdedba36", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/cc3ea94b564fd6dad193fa55371aa686cdedba36", "committedDate": "2020-08-21T16:31:34Z", "message": "Update Quartz documentation"}, "afterCommit": {"oid": "102f6156ac92478bad532b9f20ae5e1fd76a614a", "author": {"user": {"login": "gastaldi", "name": "George Gastaldi"}}, "url": "https://github.com/quarkusio/quarkus/commit/102f6156ac92478bad532b9f20ae5e1fd76a614a", "committedDate": "2020-08-21T17:02:24Z", "message": "Update Quartz documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNjY3OTIx", "url": "https://github.com/quarkusio/quarkus/pull/11507#pullrequestreview-472667921", "createdAt": "2020-08-21T17:31:29Z", "commit": {"oid": "102f6156ac92478bad532b9f20ae5e1fd76a614a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 857, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}