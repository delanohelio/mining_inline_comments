{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NDY2Njgx", "number": 11718, "title": "Add OIDC session-age-extension property", "bodyText": "Fixes #11715.\nAs reported in #11715, RT is lost after the ID token expiry given that RT is kept in the session.\nAs it happens token.lifespan-grace does allow to extend the session but using token.lifespan-grace specifically to extend the session is risky if it goes beyond a few secs since token.lifespan-grace is really about avoiding the token issued-at or expiry errors which can be caused by the clock skew.\nThis PR introduces a dedicated authentication.session-age-extension property. This property is ignored unless token.refresh-expired is set, because there is no reason right now to let the users extend the session in other cases because the session validity is tied in to the ID token validity and if no token.refresh-expired is set then ID token verification failure will cause the redirect.\nIf token.refresh-expired is set then the session will be auto-extended by 5 mins - again - there is no security risk at all since the session validity is about the ID token validity. But what it gives is for the option to refresh the tokens assuming the OP session is still active.\nIn practice the users may want to set to 30 mins or so, hence the Duration format is in minutes.\nI've updated the test to use the new property instead of relying on the lifespan-grace", "createdAt": "2020-08-28T15:17:22Z", "url": "https://github.com/quarkusio/quarkus/pull/11718", "merged": true, "mergeCommit": {"oid": "13ee30a0cf72ebdad9c278006eb47df8e20816ee"}, "closed": true, "closedAt": "2020-08-31T17:30:32Z", "author": {"login": "sberyozkin"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDWXY6AH2gAyNDc1NDY2NjgxOmFjZGU0ZTNhMTNmNzhjNGJmODYwNWMzN2VmMzJkOTU3YTI2OTg4Y2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDbf8QAFqTQ3ODAyMzQ4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "acde4e3a13f78c4bf8605c37ef32d957a26988cd", "author": {"user": {"login": "sberyozkin", "name": null}}, "url": "https://github.com/quarkusio/quarkus/commit/acde4e3a13f78c4bf8605c37ef32d957a26988cd", "committedDate": "2020-08-28T15:02:28Z", "message": "Add OIDC session-age-extension property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3OTEyMzU4", "url": "https://github.com/quarkusio/quarkus/pull/11718#pullrequestreview-477912358", "createdAt": "2020-08-28T17:38:20Z", "commit": {"oid": "acde4e3a13f78c4bf8605c37ef32d957a26988cd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzozODoyMVrOHJPEoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzozODoyMVrOHJPEoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ0NjE3Nw==", "bodyText": "Why minutes and not seconds as the code uses seconds?", "url": "https://github.com/quarkusio/quarkus/pull/11718#discussion_r479446177", "createdAt": "2020-08-28T17:38:21Z", "author": {"login": "gastaldi"}, "path": "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/OidcTenantConfig.java", "diffHunk": "@@ -673,6 +673,17 @@ public void setSource(Source source) {\n         @ConfigItem(defaultValue = \"false\")\n         public boolean userInfoRequired;\n \n+        /**\n+         * Session age extension in minutes.\n+         * The user session age property is set to the value of the ID token life-span by default and\n+         * the user will be redirected to the OIDC provider to re-authenticate once the session has expired.\n+         * If this property is set to a non-zero value then the expired ID token can be refreshed before\n+         * the session has expired.\n+         * This property will be ignored if the `token.refresh-expired` property has not been enabled.\n+         */\n+        @ConfigItem(defaultValue = \"5M\")\n+        public Duration sessionAgeExtension = Duration.ofMinutes(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acde4e3a13f78c4bf8605c37ef32d957a26988cd"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MDIzNDgw", "url": "https://github.com/quarkusio/quarkus/pull/11718#pullrequestreview-478023480", "createdAt": "2020-08-28T21:01:20Z", "commit": {"oid": "acde4e3a13f78c4bf8605c37ef32d957a26988cd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 632, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}