{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxODEzMjc5", "number": 8516, "title": "Type-safe message bundles powered by Qute", "bodyText": "NOTE: The docs are updated too: https://github.com/quarkusio/quarkus/pull/8516/files#diff-2cca36cb4d8997f164012dd9f0bd2d6c\n...\nThe basic idea is that each message is potentially a very simple template.\nExample\nFirst you need to define the default message bundle interface:\n@MessageBundle // the name is defaulted to \"msg\" and is used as a namespace in templates expressions\npublic interface Messages {\n\n    @Message(\"Hello {name}!\") // value is a qute template\n    String hello_name(String name); // name is a param that can be used in the template\n}\nQuarkus generates the implementations during build and you can use the bundles:\n\ndirectly in your code MessageBundles.get(Messages.class).hello_name(\"Jachym\")\n@Inject Messages messages and call the bundle methods\nin the templates: {msg:hello_name('Jachym')}\n\nMessage Keys\nKeys are used in qute templates. The @MessageBundle can be used to define the default strategy used to generate message keys for methods. By default, the annotated element's name is used as-is. Other possibilities are (1) de-camel-cased and hyphenated; helloName() -> hello-name, (2) de-camel-cased and parts separated by underscores; helloName() -> hello_name. @Message can override this strategy and even define a custom key.\nLocalization\nYou can define a localized bundle interface that extends the default interface:\n@Localized(\"cs\")\npublic interface CzechMessages extends Messages {\n\n    @Message(\"Ahoj {name}!\") // localized template\n    @Override\n    String hello_name(String name);\n}\nAlternatively, you can create an UTF-8 encoded file located in src/main/resources/messages; e.g. msg_de.properties. The file name consists of the relevant bundle name (msg) and underscore followed by the locate tag (IETF).\nhello_name=Hallo {name}!\nValidation\nMessage templates are validated:\n\nall expressions without a namespace must map to a param; e.g. Hello {foo} -> the method must have a param of name foo\nall expressions are validated against the types of the parameters; e.g. Hello {foo.bar} where the parem foo is of type org.acme.Foo -> org.acme.Foo must have a property of name bar\na warning is logged for each unused param\n\nExpressions that reference a message bundle method, such as {msg:hello(name)}, are validated too.\nTODO\n\n Finish working prototype + validation\n Update docs\n Support localized properties file\n Generate qute resolvers for all parameter types\n Verify the limits of the generated implementations (each impl is also a registered as a namespace resolver)\n\nI've verified that the current impl is able to handle ~ 1000 messages; if we split the generated resolve() method and group messages (a strategy already used in io.quarkus.arc.processor.ComponentsProviderGenerator) we could handle much more\nafter the split 5000 messages is not a problem (except that we generate a huge class of course)", "createdAt": "2020-04-10T08:27:44Z", "url": "https://github.com/quarkusio/quarkus/pull/8516", "merged": true, "mergeCommit": {"oid": "a4028e3df42096673d627b240c06e057a1824498"}, "closed": true, "closedAt": "2020-06-30T08:41:56Z", "author": {"login": "mkouba"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWNRv1AFqTM5MTM0MzQ5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwAe-mgFqTQzOTEwNzExNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzQzNDkw", "url": "https://github.com/quarkusio/quarkus/pull/8516#pullrequestreview-391343490", "createdAt": "2020-04-10T09:00:33Z", "commit": {"oid": "5053c6008bc6e9fd484477754babecbe57b7a22f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwOTowMDozM1rOGD1PsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwOTowMDozM1rOGD1PsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY3MTI4MA==", "bodyText": "should be interface here.", "url": "https://github.com/quarkusio/quarkus/pull/8516#discussion_r406671280", "createdAt": "2020-04-10T09:00:33Z", "author": {"login": "FroMage"}, "path": "extensions/qute/runtime/src/main/java/io/quarkus/qute/i18n/MessageBundle.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package io.quarkus.qute.i18n;\n+\n+import static java.lang.annotation.ElementType.TYPE;\n+import static java.lang.annotation.RetentionPolicy.RUNTIME;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Marks a message bundle interface.\n+ * \n+ * Each method of such interface represents a single message.\n+ * \n+ * <pre>\n+ * &#64;MessageBundle(\"msg\")\n+ * class MyBundle {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053c6008bc6e9fd484477754babecbe57b7a22f"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f64734af4b1591fb196d285391ab4bf0c79e6dfb", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/f64734af4b1591fb196d285391ab4bf0c79e6dfb", "committedDate": "2020-04-14T09:39:11Z", "message": "Use default name in @MessageBundle, validate multiple bundles with the\nsame name"}, "afterCommit": {"oid": "7622750c3484691fd02c99ec737d7d9b07840861", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7622750c3484691fd02c99ec737d7d9b07840861", "committedDate": "2020-06-18T14:18:14Z", "message": "Type-safe message bundles powered by Qute"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "494a265092104e73a665962aceba261700c34acc", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/494a265092104e73a665962aceba261700c34acc", "committedDate": "2020-06-19T08:09:56Z", "message": "Add MessageBundle#locale()"}, "afterCommit": {"oid": "bf7fc09860592f4a5723988d39f9f05c9a302167", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/bf7fc09860592f4a5723988d39f9f05c9a302167", "committedDate": "2020-06-23T09:32:16Z", "message": "Validate message bundle methods referenced in templates"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a35a35dea359794fa77384669a08b2d84683c05c", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/a35a35dea359794fa77384669a08b2d84683c05c", "committedDate": "2020-06-23T20:02:28Z", "message": "Update docs"}, "afterCommit": {"oid": "a255115156dbb7f280850d0ad53e093961d73a27", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/a255115156dbb7f280850d0ad53e093961d73a27", "committedDate": "2020-06-23T20:05:14Z", "message": "Update docs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a255115156dbb7f280850d0ad53e093961d73a27", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/a255115156dbb7f280850d0ad53e093961d73a27", "committedDate": "2020-06-23T20:05:14Z", "message": "Update docs"}, "afterCommit": {"oid": "fed054947aae8eb09abe294b312cfd84389bc730", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/fed054947aae8eb09abe294b312cfd84389bc730", "committedDate": "2020-06-23T20:23:19Z", "message": "Update docs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fed054947aae8eb09abe294b312cfd84389bc730", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/fed054947aae8eb09abe294b312cfd84389bc730", "committedDate": "2020-06-23T20:23:19Z", "message": "Update docs"}, "afterCommit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/9a350fe3f46f5b90d4ca4e4291fa64c4621618de", "committedDate": "2020-06-24T06:14:16Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2Mzk2OTE2", "url": "https://github.com/quarkusio/quarkus/pull/8516#pullrequestreview-436396916", "createdAt": "2020-06-24T07:37:54Z", "commit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwNzozNzo1NFrOGoGfDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwNzozNzo1NFrOGoGfDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcwMjQ3OA==", "bodyText": "\"prevent type-safe errors\" sounds weird :-) You probably meant just \"prevent errors\".", "url": "https://github.com/quarkusio/quarkus/pull/8516#discussion_r444702478", "createdAt": "2020-06-24T07:37:54Z", "author": {"login": "Ladicek"}, "path": "docs/src/main/asciidoc/qute-reference.adoc", "diffHunk": "@@ -986,10 +986,92 @@ class DetailResource {\n \n In the development mode, all files located in `src/main/resources/templates` are watched for changes and modifications are immediately visible.\n \n-=== Configuration Reference\n+=== Type-safe Message Bundles\n+\n+==== Basic Concepts\n+\n+The basic idea is that every message is potentially a very simple template.\n+In order to prevent type-safe errors a message is defined as an annotated method of a *message bundle interface*.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDAyNTA2", "url": "https://github.com/quarkusio/quarkus/pull/8516#pullrequestreview-436402506", "createdAt": "2020-06-24T07:46:30Z", "commit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwNzo0NjozMFrOGoGwTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwNzo0NjozMFrOGoGwTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcwNjg5NA==", "bodyText": "I [hope that I] understand why this is, but it seems quite counter-intuitive. If it can't be the default locale of the runtime JVM, then it should probably be highlighted in the user documentation more prominently.", "url": "https://github.com/quarkusio/quarkus/pull/8516#discussion_r444706894", "createdAt": "2020-06-24T07:46:30Z", "author": {"login": "Ladicek"}, "path": "extensions/qute/runtime/src/main/java/io/quarkus/qute/i18n/MessageBundle.java", "diffHunk": "@@ -0,0 +1,67 @@\n+package io.quarkus.qute.i18n;\n+\n+import static java.lang.annotation.ElementType.TYPE;\n+import static java.lang.annotation.RetentionPolicy.RUNTIME;\n+\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Denotes a message bundle interface.\n+ * <p>\n+ * Each method represents a single message:\n+ * \n+ * <pre>\n+ * &#64;MessageBundle\n+ * interface MyBundle {\n+ * \n+ *     &#64;Message(\"Hello {name}!\")\n+ *     String hello_world(String name);\n+ * }\n+ * </pre>\n+ */\n+@Retention(RUNTIME)\n+@Target(TYPE)\n+public @interface MessageBundle {\n+\n+    /**\n+     * Constant value for {@link #locale()} indicating that the default locale of the Java Virtual Machine used to build the\n+     * application should be used.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a350fe3f46f5b90d4ca4e4291fa64c4621618de", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/9a350fe3f46f5b90d4ca4e4291fa64c4621618de", "committedDate": "2020-06-24T06:14:16Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}, "afterCommit": {"oid": "bd35da654cb2aef3dbff7ae7fcdf4c64591619d1", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/bd35da654cb2aef3dbff7ae7fcdf4c64591619d1", "committedDate": "2020-06-24T08:39:46Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd35da654cb2aef3dbff7ae7fcdf4c64591619d1", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/bd35da654cb2aef3dbff7ae7fcdf4c64591619d1", "committedDate": "2020-06-24T08:39:46Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}, "afterCommit": {"oid": "7614d35af892ebd00db62b899fd3f481d0d8797c", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7614d35af892ebd00db62b899fd3f481d0d8797c", "committedDate": "2020-06-24T10:03:28Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7614d35af892ebd00db62b899fd3f481d0d8797c", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/7614d35af892ebd00db62b899fd3f481d0d8797c", "committedDate": "2020-06-24T10:03:28Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}, "afterCommit": {"oid": "bc5d95a053a14481ebc69e03f2fea40c4569fa47", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/bc5d95a053a14481ebc69e03f2fea40c4569fa47", "committedDate": "2020-06-25T15:35:34Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc5d95a053a14481ebc69e03f2fea40c4569fa47", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/bc5d95a053a14481ebc69e03f2fea40c4569fa47", "committedDate": "2020-06-25T15:35:34Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}, "afterCommit": {"oid": "d58d94e3b1597918cc1b7e4b311c6d12cf6521db", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/d58d94e3b1597918cc1b7e4b311c6d12cf6521db", "committedDate": "2020-06-29T08:58:12Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2f388ce695d40e7629e3f601a3cad506f333633", "author": {"user": {"login": "mkouba", "name": "Martin Kouba"}}, "url": "https://github.com/quarkusio/quarkus/commit/c2f388ce695d40e7629e3f601a3cad506f333633", "committedDate": "2020-06-29T09:08:25Z", "message": "Type-safe message bundles powered by Qute\n\n- message bundle methods are validated\n- message bundle methods referenced in templates are validated\n- localization files are supported"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MTA3MTE1", "url": "https://github.com/quarkusio/quarkus/pull/8516#pullrequestreview-439107115", "createdAt": "2020-06-29T12:48:18Z", "commit": {"oid": "c2f388ce695d40e7629e3f601a3cad506f333633"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4536, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}