{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MDI4MTIx", "number": 10165, "title": "Warn when a spring-web class is not annotated with @RestController", "bodyText": "Fixes: #10164", "createdAt": "2020-06-22T15:43:26Z", "url": "https://github.com/quarkusio/quarkus/pull/10165", "merged": true, "mergeCommit": {"oid": "4f809fc61cdddc888dc09d72d67542aec2e6be7b"}, "closed": true, "closedAt": "2020-06-22T18:20:01Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctyyJVAH2gAyNDM4MDI4MTIxOjk0ZDg1NzMyNWQyMjk2MTJhN2I2ODg3ZDdhZDllMmY0YjAyZDU3YmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABctzWuJgFqTQzNTA4MzQ3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94d857325d229612a7b6887d7ad9e2f4b02d57ba", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/94d857325d229612a7b6887d7ad9e2f4b02d57ba", "committedDate": "2020-06-22T15:42:42Z", "message": "Warn when a spring-web class is not annotated with @RestController\n\nFixes: #10164"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MDgzNDc5", "url": "https://github.com/quarkusio/quarkus/pull/10165#pullrequestreview-435083479", "createdAt": "2020-06-22T16:22:06Z", "commit": {"oid": "94d857325d229612a7b6887d7ad9e2f4b02d57ba"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyMjowNlrOGnIA_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyMjowNlrOGnIA_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY3ODk3NA==", "bodyText": "Sounds like we should fail the build instead? Thinking how confused would I be if the app started and the endpoints would not be there.", "url": "https://github.com/quarkusio/quarkus/pull/10165#discussion_r443678974", "createdAt": "2020-06-22T16:22:06Z", "author": {"login": "gastaldi"}, "path": "extensions/spring-web/deployment/src/main/java/io/quarkus/spring/web/deployment/SpringWebProcessor.java", "diffHunk": "@@ -190,6 +195,35 @@ public void accept(ResteasyDeployment resteasyDeployment) {\n         reflectiveClass.produce(new ReflectiveClassBuildItem(true, false, false, SpringResourceBuilder.class.getName()));\n     }\n \n+    /**\n+     * Make sure the controllers have the proper annotation and warn if not\n+     */\n+    private void validateControllers(BeanArchiveIndexBuildItem beanArchiveIndexBuildItem) {\n+        Collection<AnnotationInstance> annotations = beanArchiveIndexBuildItem.getIndex().getAnnotations(REQUEST_MAPPING);\n+        Set<DotName> classesWithoutRestController = new HashSet<>();\n+        for (AnnotationInstance annotation : annotations) {\n+            ClassInfo targetClass;\n+            if (annotation.target().kind() == AnnotationTarget.Kind.CLASS) {\n+                targetClass = annotation.target().asClass();\n+            } else if (annotation.target().kind() == AnnotationTarget.Kind.METHOD) {\n+                targetClass = annotation.target().asMethod().declaringClass();\n+            } else {\n+                continue;\n+            }\n+\n+            if (targetClass.classAnnotation(REST_CONTROLLER_ANNOTATION) == null) {\n+                classesWithoutRestController.add(targetClass.name());\n+            }\n+        }\n+\n+        if (!classesWithoutRestController.isEmpty()) {\n+            for (DotName dotName : classesWithoutRestController) {\n+                LOGGER.warn(\"Class '\" + dotName\n+                        + \"' uses '@RequestMapping' but was not annotated with '@RestContoller' and will therefore be ignored.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94d857325d229612a7b6887d7ad9e2f4b02d57ba"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4285, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}