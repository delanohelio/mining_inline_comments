{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4Mjc1MDE2", "number": 10176, "title": "Make sure request resumes on correct thread", "bodyText": "Fixes #9693", "createdAt": "2020-06-23T02:28:48Z", "url": "https://github.com/quarkusio/quarkus/pull/10176", "merged": true, "mergeCommit": {"oid": "25c6a788c124f9d6fcce5d72b1daba12f368049c"}, "closed": true, "closedAt": "2020-07-08T23:30:59Z", "author": {"login": "stuartwdouglas"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABct8cVyABqjM0NzA5MDg1Mjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcy7HyYAFqTQ0NDgwOTkxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2eeff9253f5dbcff1af22e7d7d6746095e5eae4", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/e2eeff9253f5dbcff1af22e7d7d6746095e5eae4", "committedDate": "2020-06-23T02:26:50Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}, "afterCommit": {"oid": "91c3744217f35352c5d2a3e5e8b8bf177baa8568", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/91c3744217f35352c5d2a3e5e8b8bf177baa8568", "committedDate": "2020-06-23T02:57:43Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91c3744217f35352c5d2a3e5e8b8bf177baa8568", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/91c3744217f35352c5d2a3e5e8b8bf177baa8568", "committedDate": "2020-06-23T02:57:43Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}, "afterCommit": {"oid": "573372278f96f0277bb8386aa49f4f913affeeb0", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/573372278f96f0277bb8386aa49f4f913affeeb0", "committedDate": "2020-07-06T02:41:46Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "573372278f96f0277bb8386aa49f4f913affeeb0", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/573372278f96f0277bb8386aa49f4f913affeeb0", "committedDate": "2020-07-06T02:41:46Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}, "afterCommit": {"oid": "73e1aaa9e91cd8ee7e7b9c31e0958c0d59aacf78", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/73e1aaa9e91cd8ee7e7b9c31e0958c0d59aacf78", "committedDate": "2020-07-06T09:32:19Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73e1aaa9e91cd8ee7e7b9c31e0958c0d59aacf78", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/73e1aaa9e91cd8ee7e7b9c31e0958c0d59aacf78", "committedDate": "2020-07-06T09:32:19Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}, "afterCommit": {"oid": "a1496926893a4027c4797022d1ad6fe7f7c7fe64", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/a1496926893a4027c4797022d1ad6fe7f7c7fe64", "committedDate": "2020-07-07T04:39:46Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODMyNDMw", "url": "https://github.com/quarkusio/quarkus/pull/10176#pullrequestreview-443832430", "createdAt": "2020-07-07T12:16:46Z", "commit": {"oid": "629de0a9434817f3e41821f604e4a340f920b86f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxNjo0NlrOGt725Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxNjo0NlrOGt725Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxOTgxMw==", "bodyText": "This change shouldn't be needed anymore.", "url": "https://github.com/quarkusio/quarkus/pull/10176#discussion_r450819813", "createdAt": "2020-07-07T12:16:46Z", "author": {"login": "tsegismont"}, "path": "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/devmode/VertxHttpHotReplacementSetup.java", "diffHunk": "@@ -39,7 +40,8 @@ void handleHotReplacementRequest(RoutingContext routingContext) {\n             routingContext.next();\n             return;\n         }\n-        routingContext.vertx().executeBlocking(new Handler<Promise<Boolean>>() {\n+        ConnectionBase connectionBase = (ConnectionBase) routingContext.request().connection();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "629de0a9434817f3e41821f604e4a340f920b86f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODM1ODQ5", "url": "https://github.com/quarkusio/quarkus/pull/10176#pullrequestreview-443835849", "createdAt": "2020-07-07T12:21:41Z", "commit": {"oid": "629de0a9434817f3e41821f604e4a340f920b86f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoyMTo0MVrOGt8A3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoyMTo0MVrOGt8A3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgyMjM2NA==", "bodyText": "How about updating TestRoute so that the handler calls executing blocking, and we verify that the context when calling executingBlocking and when the callback is involved is the same:\nVertx vertx = rc.vertx()\nexpected = vertx.getOrCreateContext();\nvertx.executeBlocking(Promise::complete, ar -> {\n  actual = vertx.getOrCreateContext();\n  // expected should be the same as actual\n  // before AND after hot reload\n})", "url": "https://github.com/quarkusio/quarkus/pull/10176#discussion_r450822364", "createdAt": "2020-07-07T12:21:41Z", "author": {"login": "tsegismont"}, "path": "extensions/vertx-web/deployment/src/test/java/io/quarkus/vertx/web/VertxWebDevModeTestCase.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package io.quarkus.vertx.web;\n+\n+import java.util.function.Function;\n+\n+import org.hamcrest.Matchers;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.JavaArchive;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+\n+import io.quarkus.test.QuarkusDevModeTest;\n+import io.restassured.RestAssured;\n+\n+public class VertxWebDevModeTestCase {\n+\n+    @RegisterExtension\n+    static QuarkusDevModeTest runner = new QuarkusDevModeTest()\n+            .setArchiveProducer(() -> ShrinkWrap.create(JavaArchive.class)\n+                    .addClasses(TestRoute.class));\n+\n+    @Test\n+    public void testRunningInDevMode() {\n+        RestAssured.given()\n+                .body(\"OK\")\n+                .post(\"/test\")\n+                .then().statusCode(200)\n+                .body(Matchers.equalTo(\"test route\"));\n+\n+        runner.modifySourceFile(TestRoute.class, new Function<String, String>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "629de0a9434817f3e41821f604e4a340f920b86f"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d42e123b4eda3095a14ef45fb0737b15d90bea67", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/d42e123b4eda3095a14ef45fb0737b15d90bea67", "committedDate": "2020-07-08T13:26:19Z", "message": "Make sure request resumes on correct thread\n\nFixes #9693"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "629de0a9434817f3e41821f604e4a340f920b86f", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/629de0a9434817f3e41821f604e4a340f920b86f", "committedDate": "2020-07-07T07:13:05Z", "message": "Don't create a new Vert.x on dev mode restart"}, "afterCommit": {"oid": "59e314f9159ccccf6db014e290095e4d258dd1f6", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/59e314f9159ccccf6db014e290095e4d258dd1f6", "committedDate": "2020-07-08T13:33:53Z", "message": "Don't create a new Vert.x on dev mode restart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f781d24f1626d9fa55a60a577f2d6c92e099240", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/6f781d24f1626d9fa55a60a577f2d6c92e099240", "committedDate": "2020-07-08T13:36:00Z", "message": "Don't create a new Vert.x on dev mode restart"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59e314f9159ccccf6db014e290095e4d258dd1f6", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/59e314f9159ccccf6db014e290095e4d258dd1f6", "committedDate": "2020-07-08T13:33:53Z", "message": "Don't create a new Vert.x on dev mode restart"}, "afterCommit": {"oid": "6f781d24f1626d9fa55a60a577f2d6c92e099240", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/6f781d24f1626d9fa55a60a577f2d6c92e099240", "committedDate": "2020-07-08T13:36:00Z", "message": "Don't create a new Vert.x on dev mode restart"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0ODA5OTEy", "url": "https://github.com/quarkusio/quarkus/pull/10176#pullrequestreview-444809912", "createdAt": "2020-07-08T14:15:12Z", "commit": {"oid": "6f781d24f1626d9fa55a60a577f2d6c92e099240"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4288, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}