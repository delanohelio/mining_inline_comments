{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NzkwNDU2", "number": 13189, "title": "Avoid ObjectMapper CDI warning in Funky Google Cloud Functions", "bodyText": "This avoid a nasty CDI warning on startup\n================================================================================\nCDI: programmatic lookup problem detected\n-----------------------------------------\nAt least one bean matched the required type and qualifiers but was marked as unused and removed during build\nRemoved beans:\n  - PRODUCER_METHOD bean io.quarkus.jackson.ObjectMapperProducer#objectMapper() [types=[interface java.io.Serializable, class com.fasterxml.jackson.core.TreeCodec, class com.fasterxml.jackson.core.ObjectCodec, class com.fasterxml.jackson.databind.ObjectMapper, interface com.fasterxml.jackson.core.Versioned], qualifiers=[@javax.enterprise.inject.Default(), @javax.enterprise.inject.Any()]]\nRequired type: class com.fasterxml.jackson.databind.ObjectMapper\nRequired qualifiers: [@javax.enterprise.inject.Default()]\nSolutions:\n  - Application developers can eliminate false positives via the @Unremovable annotation\n  - Extensions can eliminate false positives via build items, e.g. using the UnremovableBeanBuildItem\n  - See also https://quarkus.io/guides/cdi-reference#remove_unused_beans\n================================================================================", "createdAt": "2020-11-09T14:09:44Z", "url": "https://github.com/quarkusio/quarkus/pull/13189", "merged": true, "mergeCommit": {"oid": "34f6334e1fe7e843f6241a3d997f96db35506e21"}, "closed": true, "closedAt": "2020-11-09T18:08:56Z", "author": {"login": "loicmathieu"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABda1ufggFqTUyNjMxNTY1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABda2Li4gFqTUyNjM0Nzg0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MzE1NjU2", "url": "https://github.com/quarkusio/quarkus/pull/13189#pullrequestreview-526315656", "createdAt": "2020-11-09T14:35:00Z", "commit": {"oid": "935aa6508160696c258408d2321410562ec9c067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTowMFrOHvxp1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTowMFrOHvxp1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1ODY0NQ==", "bodyText": "Is this change normal?", "url": "https://github.com/quarkusio/quarkus/pull/13189#discussion_r519858645", "createdAt": "2020-11-09T14:35:00Z", "author": {"login": "gsmet"}, "path": "integration-tests/funqy-google-cloud-functions/src/main/resources/application.properties", "diffHunk": "@@ -1,4 +1,2 @@\n-quarkus.funqy.export=helloHttpWorld\n-#quarkus.funqy.export=helloHttpWorldAsync\n+quarkus.funqy.export=helloGCSWorld", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "935aa6508160696c258408d2321410562ec9c067"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MzE1OTky", "url": "https://github.com/quarkusio/quarkus/pull/13189#pullrequestreview-526315992", "createdAt": "2020-11-09T14:35:19Z", "commit": {"oid": "935aa6508160696c258408d2321410562ec9c067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNToxOVrOHvxqzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNToxOVrOHvxqzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1ODg5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void markObjectMapper(BuildProducer<UnremovableBeanBuildItem> unremovable) {\n          \n          \n            \n                public void markObjectMapperUnremovable(BuildProducer<UnremovableBeanBuildItem> unremovable) {\n          \n      \n    \n    \n  \n\n?", "url": "https://github.com/quarkusio/quarkus/pull/13189#discussion_r519858892", "createdAt": "2020-11-09T14:35:19Z", "author": {"login": "gsmet"}, "path": "extensions/funqy/funqy-google-cloud-functions/deployment/src/main/java/io/quarkus/funqy/gcp/functions/deployment/bindings/FunqyCloudFunctionsBuildStep.java", "diffHunk": "@@ -47,4 +52,12 @@ public void init(List<FunctionBuildItem> functions,\n     public void choose(FunqyConfig config, FunqyCloudFunctionsBindingRecorder recorder) {\n         recorder.chooseInvoker(config);\n     }\n+\n+    @BuildStep\n+    public void markObjectMapper(BuildProducer<UnremovableBeanBuildItem> unremovable) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "935aa6508160696c258408d2321410562ec9c067"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0436803b35189e7857e5b9e86ee4d19f25f7affb", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/0436803b35189e7857e5b9e86ee4d19f25f7affb", "committedDate": "2020-11-09T14:44:00Z", "message": "fix: avoid CDI warning in ObjectMapper"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b187e8c3ea566e1a8a400690bfe134dae7f0f95d", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/b187e8c3ea566e1a8a400690bfe134dae7f0f95d", "committedDate": "2020-11-09T14:39:15Z", "message": "Update extensions/funqy/funqy-google-cloud-functions/deployment/src/main/java/io/quarkus/funqy/gcp/functions/deployment/bindings/FunqyCloudFunctionsBuildStep.java\n\nCo-authored-by: Guillaume Smet <guillaume.smet@gmail.com>"}, "afterCommit": {"oid": "0436803b35189e7857e5b9e86ee4d19f25f7affb", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/0436803b35189e7857e5b9e86ee4d19f25f7affb", "committedDate": "2020-11-09T14:44:00Z", "message": "fix: avoid CDI warning in ObjectMapper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MzQ0MjAx", "url": "https://github.com/quarkusio/quarkus/pull/13189#pullrequestreview-526344201", "createdAt": "2020-11-09T15:02:56Z", "commit": {"oid": "0436803b35189e7857e5b9e86ee4d19f25f7affb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MzQ3ODQy", "url": "https://github.com/quarkusio/quarkus/pull/13189#pullrequestreview-526347842", "createdAt": "2020-11-09T15:06:31Z", "commit": {"oid": "0436803b35189e7857e5b9e86ee4d19f25f7affb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNTowNjozMVrOHvzHCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNTowNjozMVrOHvzHCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg4MjUwNw==", "bodyText": "BTW, not mandatory, but I think that just making the ObjectMapper unremovable would be sufficient. The producer will follow.", "url": "https://github.com/quarkusio/quarkus/pull/13189#discussion_r519882507", "createdAt": "2020-11-09T15:06:31Z", "author": {"login": "gsmet"}, "path": "extensions/funqy/funqy-google-cloud-functions/deployment/src/main/java/io/quarkus/funqy/gcp/functions/deployment/bindings/FunqyCloudFunctionsBuildStep.java", "diffHunk": "@@ -47,4 +52,12 @@ public void init(List<FunctionBuildItem> functions,\n     public void choose(FunqyConfig config, FunqyCloudFunctionsBindingRecorder recorder) {\n         recorder.chooseInvoker(config);\n     }\n+\n+    @BuildStep\n+    public void markObjectMapperUnremovable(BuildProducer<UnremovableBeanBuildItem> unremovable) {\n+        unremovable.produce(new UnremovableBeanBuildItem(\n+                new UnremovableBeanBuildItem.BeanClassNameExclusion(ObjectMapper.class.getName())));\n+        unremovable.produce(new UnremovableBeanBuildItem(\n+                new UnremovableBeanBuildItem.BeanClassNameExclusion(ObjectMapperProducer.class.getName())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0436803b35189e7857e5b9e86ee4d19f25f7affb"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1500, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}