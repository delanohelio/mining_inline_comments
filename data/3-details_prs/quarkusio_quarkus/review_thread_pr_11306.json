{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTg5NDYx", "number": 11306, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNjoyOTo0NVrOEW3qTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOTowMTozMFrOEX9mTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNDE2MDc3OnYy", "diffSide": "RIGHT", "path": "independent-projects/tools/platform-descriptor-api/src/main/java/io/quarkus/platform/descriptor/CombinedQuarkusPlatformDescriptor.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNjoyOTo0NVrOG-WTQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzowNToxNVrOG-XkIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDI3Mw==", "bodyText": "master appears to be platforms.get(0)?\nThis does not look consistent with how other pieces (extensions, managed deps) are merged, i.e. in other places what appears first wins while here the last platform overrides the previous one, including the master.", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468030273", "createdAt": "2020-08-10T16:29:45Z", "author": {"login": "aloubyansky"}, "path": "independent-projects/tools/platform-descriptor-api/src/main/java/io/quarkus/platform/descriptor/CombinedQuarkusPlatformDescriptor.java", "diffHunk": "@@ -79,6 +82,16 @@ public String getQuarkusVersion() {\n         return master.getQuarkusVersion();\n     }\n \n+    @Override\n+    public Map<String, Object> getMetadata() {\n+        Map<String, Object> metadata = new LinkedHashMap<>();\n+        metadata.putAll(master.getMetadata());\n+        for (QuarkusPlatformDescriptor platform : platforms) {\n+            metadata.putAll(platform.getMetadata());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "04c65cebb669727897b17f68b7e1fb9adc3e7ea4"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDQ5NQ==", "bodyText": "Otherwise, it looks good to me.", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468030495", "createdAt": "2020-08-10T16:30:09Z", "author": {"login": "aloubyansky"}, "path": "independent-projects/tools/platform-descriptor-api/src/main/java/io/quarkus/platform/descriptor/CombinedQuarkusPlatformDescriptor.java", "diffHunk": "@@ -79,6 +82,16 @@ public String getQuarkusVersion() {\n         return master.getQuarkusVersion();\n     }\n \n+    @Override\n+    public Map<String, Object> getMetadata() {\n+        Map<String, Object> metadata = new LinkedHashMap<>();\n+        metadata.putAll(master.getMetadata());\n+        for (QuarkusPlatformDescriptor platform : platforms) {\n+            metadata.putAll(platform.getMetadata());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDI3Mw=="}, "originalCommit": {"oid": "04c65cebb669727897b17f68b7e1fb9adc3e7ea4"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA1MDk3OA==", "bodyText": "I reversed the put operations, see if that makes sense", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468050978", "createdAt": "2020-08-10T17:05:15Z", "author": {"login": "gastaldi"}, "path": "independent-projects/tools/platform-descriptor-api/src/main/java/io/quarkus/platform/descriptor/CombinedQuarkusPlatformDescriptor.java", "diffHunk": "@@ -79,6 +82,16 @@ public String getQuarkusVersion() {\n         return master.getQuarkusVersion();\n     }\n \n+    @Override\n+    public Map<String, Object> getMetadata() {\n+        Map<String, Object> metadata = new LinkedHashMap<>();\n+        metadata.putAll(master.getMetadata());\n+        for (QuarkusPlatformDescriptor platform : platforms) {\n+            metadata.putAll(platform.getMetadata());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDI3Mw=="}, "originalCommit": {"oid": "04c65cebb669727897b17f68b7e1fb9adc3e7ea4"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNjg3NzY0OnYy", "diffSide": "LEFT", "path": "devtools/platform-descriptor-json/src/main/java/io/quarkus/platform/descriptor/loader/json/impl/QuarkusJsonPlatformDescriptorLoaderImpl.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwOToyNjowMlrOG-vurQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMDo1Mzo1N1rOG-ylyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0Njg5Mw==", "bodyText": "As the plan is to backport it, I would prefer we don't change this behavior and only do it in a follow-up PR for 1.8.", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468446893", "createdAt": "2020-08-11T09:26:02Z", "author": {"login": "gsmet"}, "path": "devtools/platform-descriptor-json/src/main/java/io/quarkus/platform/descriptor/loader/json/impl/QuarkusJsonPlatformDescriptorLoaderImpl.java", "diffHunk": "@@ -20,7 +21,7 @@ public QuarkusJsonPlatformDescriptor load(final QuarkusJsonPlatformDescriptorLoa\n                     try {\n                         ObjectMapper mapper = new ObjectMapper()\n                                 .enable(JsonParser.Feature.ALLOW_COMMENTS)\n-                                .enable(JsonParser.Feature.ALLOW_NUMERIC_LEADING_ZEROS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9398e6a6e997c4dce49a21ce349e832ec3cd449"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ2ODE5MQ==", "bodyText": "yeah, I would leave that change out to reduce change. Not that i even know why we ever would have a file with leading zeros ;)", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468468191", "createdAt": "2020-08-11T10:03:30Z", "author": {"login": "maxandersen"}, "path": "devtools/platform-descriptor-json/src/main/java/io/quarkus/platform/descriptor/loader/json/impl/QuarkusJsonPlatformDescriptorLoaderImpl.java", "diffHunk": "@@ -20,7 +21,7 @@ public QuarkusJsonPlatformDescriptor load(final QuarkusJsonPlatformDescriptorLoa\n                     try {\n                         ObjectMapper mapper = new ObjectMapper()\n                                 .enable(JsonParser.Feature.ALLOW_COMMENTS)\n-                                .enable(JsonParser.Feature.ALLOW_NUMERIC_LEADING_ZEROS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0Njg5Mw=="}, "originalCommit": {"oid": "b9398e6a6e997c4dce49a21ce349e832ec3cd449"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ3ODAzMw==", "bodyText": "Sure. FYI that property is deprecated for a long time now and should be removed in future Jackson versions", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468478033", "createdAt": "2020-08-11T10:22:55Z", "author": {"login": "gastaldi"}, "path": "devtools/platform-descriptor-json/src/main/java/io/quarkus/platform/descriptor/loader/json/impl/QuarkusJsonPlatformDescriptorLoaderImpl.java", "diffHunk": "@@ -20,7 +21,7 @@ public QuarkusJsonPlatformDescriptor load(final QuarkusJsonPlatformDescriptorLoa\n                     try {\n                         ObjectMapper mapper = new ObjectMapper()\n                                 .enable(JsonParser.Feature.ALLOW_COMMENTS)\n-                                .enable(JsonParser.Feature.ALLOW_NUMERIC_LEADING_ZEROS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0Njg5Mw=="}, "originalCommit": {"oid": "b9398e6a6e997c4dce49a21ce349e832ec3cd449"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ5Mzc2OQ==", "bodyText": "I have no objection trying to remove it in 1.8.", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r468493769", "createdAt": "2020-08-11T10:53:57Z", "author": {"login": "gsmet"}, "path": "devtools/platform-descriptor-json/src/main/java/io/quarkus/platform/descriptor/loader/json/impl/QuarkusJsonPlatformDescriptorLoaderImpl.java", "diffHunk": "@@ -20,7 +21,7 @@ public QuarkusJsonPlatformDescriptor load(final QuarkusJsonPlatformDescriptorLoa\n                     try {\n                         ObjectMapper mapper = new ObjectMapper()\n                                 .enable(JsonParser.Feature.ALLOW_COMMENTS)\n-                                .enable(JsonParser.Feature.ALLOW_NUMERIC_LEADING_ZEROS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0Njg5Mw=="}, "originalCommit": {"oid": "b9398e6a6e997c4dce49a21ce349e832ec3cd449"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzNTYxOTM0OnYy", "diffSide": "RIGHT", "path": "devtools/platform-descriptor-json/src/test/resources/fakeextensions.json", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOTowMTozMFrOHACmSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMjowNTowN1rOHAIf0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNDYxOQ==", "bodyText": "@gastaldi @aloubyansky mind that when we actually set this data, we will need:\n\"repositories\" : {\n    \"id\": \"redhat\",\n    \"url\": \"https://maven.repository.redhat.com\",\n    \"releases-enabled\": \"true\",\n    \"snapshots-enabled\": \"false\"\n},\n\"plugin-repositories\" : {\n    \"id\": \"redhat\",\n    \"url\": \"https://maven.repository.redhat.com\",\n    \"releases-enabled\": \"true\",\n    \"snapshots-enabled\": \"false\"\n}", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r469804619", "createdAt": "2020-08-13T09:01:30Z", "author": {"login": "ia3andy"}, "path": "devtools/platform-descriptor-json/src/test/resources/fakeextensions.json", "diffHunk": "@@ -1,5 +1,27 @@\n \n {\n+    \"any-future-property\" : \"blah\",\n+    \"metadata\":{\n+        \"application-properties\": {\n+            \"quarkus.native.builder-image\" : \"foo-bar\"\n+        },\n+        \"maven\" :  {\n+            \"repositories\" : {\n+                \"id\": \"redhat\",\n+                \"url\": \"https://maven.repository.redhat.com\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aac805a6f9c136de0174ea619991a3193f1f61ec"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgzOTQ0Mw==", "bodyText": "@gastaldi @aloubyansky @maxandersen   well it's also an array:\n            \"repositories\" : [\n                {\n                    \"id\": \"redhat\",\n                    \"url\": \"https://maven.repository.redhat.com\",\n                    \"releases-enabled\": \"true\",\n                    \"snapshots-enabled\": \"false\"\n                }\n            ],\n            \"plugin-repositories\" : [\n                {\n                    \"id\": \"redhat\",\n                    \"url\": \"https://maven.repository.redhat.com\",\n                    \"releases-enabled\": \"true\",\n                    \"snapshots-enabled\": \"false\"\n                }\n            ]", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r469839443", "createdAt": "2020-08-13T10:00:26Z", "author": {"login": "ia3andy"}, "path": "devtools/platform-descriptor-json/src/test/resources/fakeextensions.json", "diffHunk": "@@ -1,5 +1,27 @@\n \n {\n+    \"any-future-property\" : \"blah\",\n+    \"metadata\":{\n+        \"application-properties\": {\n+            \"quarkus.native.builder-image\" : \"foo-bar\"\n+        },\n+        \"maven\" :  {\n+            \"repositories\" : {\n+                \"id\": \"redhat\",\n+                \"url\": \"https://maven.repository.redhat.com\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNDYxOQ=="}, "originalCommit": {"oid": "aac805a6f9c136de0174ea619991a3193f1f61ec"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkwMDAzNQ==", "bodyText": "@ia3andy that's not a problem, the changes in this PR only expose the metadata attribute as a Map that can contain other Maps. Also @maxandersen suggested using a separate snapshot-repositories instead of the snapshot-enabled flag which I think it makes sense :)", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r469900035", "createdAt": "2020-08-13T12:02:49Z", "author": {"login": "gastaldi"}, "path": "devtools/platform-descriptor-json/src/test/resources/fakeextensions.json", "diffHunk": "@@ -1,5 +1,27 @@\n \n {\n+    \"any-future-property\" : \"blah\",\n+    \"metadata\":{\n+        \"application-properties\": {\n+            \"quarkus.native.builder-image\" : \"foo-bar\"\n+        },\n+        \"maven\" :  {\n+            \"repositories\" : {\n+                \"id\": \"redhat\",\n+                \"url\": \"https://maven.repository.redhat.com\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNDYxOQ=="}, "originalCommit": {"oid": "aac805a6f9c136de0174ea619991a3193f1f61ec"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkwMTI2Nw==", "bodyText": "@gastaldi nop, it's a bad idea (sorry @maxandersen :)) it would be really hard to consume in the templates if we used snapshot-repositories.. let's stick to the maven structure..", "url": "https://github.com/quarkusio/quarkus/pull/11306#discussion_r469901267", "createdAt": "2020-08-13T12:05:07Z", "author": {"login": "ia3andy"}, "path": "devtools/platform-descriptor-json/src/test/resources/fakeextensions.json", "diffHunk": "@@ -1,5 +1,27 @@\n \n {\n+    \"any-future-property\" : \"blah\",\n+    \"metadata\":{\n+        \"application-properties\": {\n+            \"quarkus.native.builder-image\" : \"foo-bar\"\n+        },\n+        \"maven\" :  {\n+            \"repositories\" : {\n+                \"id\": \"redhat\",\n+                \"url\": \"https://maven.repository.redhat.com\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNDYxOQ=="}, "originalCommit": {"oid": "aac805a6f9c136de0174ea619991a3193f1f61ec"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 722, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}