{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MjUxNTQz", "number": 6897, "title": "Show image pull output when using a builder image", "bodyText": "Fixes: #6892", "createdAt": "2020-01-30T19:43:23Z", "url": "https://github.com/quarkusio/quarkus/pull/6897", "merged": true, "mergeCommit": {"oid": "48f1610037dcaaa524fc8718ab51e7e4751a94af"}, "closed": true, "closedAt": "2020-01-31T09:26:41Z", "author": {"login": "geoand"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_f9wQAFqTM1MTA5NTA5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_o9qpgBqjI5OTU5MzQ4OTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMDk1MDkz", "url": "https://github.com/quarkusio/quarkus/pull/6897#pullrequestreview-351095093", "createdAt": "2020-01-30T19:46:39Z", "commit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo0NjozOVrOFj3tlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTo0NjozOVrOFj3tlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE1NzI3MQ==", "bodyText": "Better call process.destroy() in a finally block just in case", "url": "https://github.com/quarkusio/quarkus/pull/6897#discussion_r373157271", "createdAt": "2020-01-30T19:46:39Z", "author": {"login": "gastaldi"}, "path": "core/deployment/src/main/java/io/quarkus/deployment/pkg/steps/NativeImageBuildStep.java", "diffHunk": "@@ -108,6 +108,22 @@ public NativeImageBuildItem build(NativeConfig nativeConfig, NativeImageSourceJa\n                 nativeImage.add(\"--publish=\" + DEBUG_BUILD_PROCESS_PORT + \":\" + DEBUG_BUILD_PROCESS_PORT);\n             }\n             Collections.addAll(nativeImage, \"--rm\", nativeConfig.builderImage);\n+\n+            if (\"docker\".equals(containerRuntime) || \"podman\".equals(containerRuntime)) {\n+                // we pull the docker image in order to give users an indication of which step the process is at\n+                // it's not strictly necessary we do this, however if we don't the subsequent version command\n+                // will appear to block and no output will be shown\n+                log.info(\"Pulling image \" + nativeConfig.builderImage);\n+                try {\n+                    Process pullProcess = new ProcessBuilder(Arrays.asList(containerRuntime, \"pull\", nativeConfig.builderImage))\n+                            .inheritIO()\n+                            .start();\n+                    pullProcess.waitFor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb65e2bbf54d77f489d96d64cdc799f0a4e7267e", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/cb65e2bbf54d77f489d96d64cdc799f0a4e7267e", "committedDate": "2020-01-30T19:42:26Z", "message": "Show image pull output when using a builder image\n\nFixes: #6892"}, "afterCommit": {"oid": "d18b6ba8a9b174a2bb096e186e6f34db17bc9725", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d18b6ba8a9b174a2bb096e186e6f34db17bc9725", "committedDate": "2020-01-30T19:49:34Z", "message": "Show image pull output when using a builder image\n\nFixes: #6892"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTA0ODkw", "url": "https://github.com/quarkusio/quarkus/pull/6897#pullrequestreview-351104890", "createdAt": "2020-01-30T20:02:26Z", "commit": {"oid": "d18b6ba8a9b174a2bb096e186e6f34db17bc9725"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3ff8b84265f7014325ddbf742af2d4813788cfe", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/c3ff8b84265f7014325ddbf742af2d4813788cfe", "committedDate": "2020-01-31T06:15:32Z", "message": "Show image pull output when using a builder image\n\nFixes: #6892"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d18b6ba8a9b174a2bb096e186e6f34db17bc9725", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/d18b6ba8a9b174a2bb096e186e6f34db17bc9725", "committedDate": "2020-01-30T19:49:34Z", "message": "Show image pull output when using a builder image\n\nFixes: #6892"}, "afterCommit": {"oid": "c3ff8b84265f7014325ddbf742af2d4813788cfe", "author": {"user": {"login": "geoand", "name": "Georgios Andrianakis"}}, "url": "https://github.com/quarkusio/quarkus/commit/c3ff8b84265f7014325ddbf742af2d4813788cfe", "committedDate": "2020-01-31T06:15:32Z", "message": "Show image pull output when using a builder image\n\nFixes: #6892"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 14, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}