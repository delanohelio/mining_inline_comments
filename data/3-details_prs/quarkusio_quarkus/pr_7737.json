{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTc3ODI5", "number": 7737, "title": "Do not turn fields into accessors in Hibernate ORM entity constructors", "bodyText": "", "createdAt": "2020-03-10T14:46:51Z", "url": "https://github.com/quarkusio/quarkus/pull/7737", "merged": true, "mergeCommit": {"oid": "080f634e9ebcc4fc693151b19968efa7d56b0448"}, "closed": true, "closedAt": "2020-03-10T18:38:30Z", "author": {"login": "FroMage"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMTxY9gBqjMxMTUwNzYzNTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMVIHvgFqTM3MjEyMDM3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba1351b39555f1f2be806c717b2a4eee23495371", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/quarkusio/quarkus/commit/ba1351b39555f1f2be806c717b2a4eee23495371", "committedDate": "2020-03-10T14:45:34Z", "message": "Fix for #7721: do not turn fields into accessors in constructors"}, "afterCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/quarkusio/quarkus/commit/b855cd89b5717d78370baaa6a356bff94f81949c", "committedDate": "2020-03-10T14:55:10Z", "message": "Fix for #7721: do not turn fields into accessors in constructors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTA1OTgz", "url": "https://github.com/quarkusio/quarkus/pull/7737#pullrequestreview-372105983", "createdAt": "2020-03-10T16:13:55Z", "commit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxMzo1NVrOF0WSPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxMzo1NVrOF0WSPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzNTM4OQ==", "bodyText": "Should the FIXME be removed?", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390435389", "createdAt": "2020-03-10T16:13:55Z", "author": {"login": "Sanne"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTEwNDQy", "url": "https://github.com/quarkusio/quarkus/pull/7737#pullrequestreview-372110442", "createdAt": "2020-03-10T16:18:54Z", "commit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxODo1NVrOF0Wfww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjoxODo1NVrOF0Wfww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQzODg1MQ==", "bodyText": "the code owner.replace('/', '.')) could be extracted since you need it twice?\nWhile at it, might be useful to extract the regex into a constant? Entirely optional of course: I'm aware I'm nitpicking.", "url": "https://github.com/quarkusio/quarkus/pull/7737#discussion_r390438851", "createdAt": "2020-03-10T16:18:55Z", "author": {"login": "Sanne"}, "path": "extensions/panache/panache-common/deployment/src/main/java/io/quarkus/panache/common/deployment/PanacheFieldAccessMethodVisitor.java", "diffHunk": "@@ -28,6 +28,10 @@ public void visitFieldInsn(int opcode, String owner, String fieldName, String de\n         // FIXME: do not substitute to accessors to this or super fields inside constructor?\n         if ((opcode == Opcodes.GETFIELD\n                 || opcode == Opcodes.PUTFIELD)\n+                // if we're in the constructor, do not replace field accesses to this type and its supertypes\n+                // otherwise we risk running setters that depend on initialisation\n+                && (!this.methodName.equals(\"<init>\")\n+                        || !targetIsInHierarchy(this.owner.replace('/', '.'), owner.replace('/', '.')))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/quarkusio/quarkus/commit/2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "committedDate": "2020-03-10T16:21:44Z", "message": "Fix for #7721: do not turn fields into accessors in constructors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b855cd89b5717d78370baaa6a356bff94f81949c", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/quarkusio/quarkus/commit/b855cd89b5717d78370baaa6a356bff94f81949c", "committedDate": "2020-03-10T14:55:10Z", "message": "Fix for #7721: do not turn fields into accessors in constructors"}, "afterCommit": {"oid": "2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "author": {"user": {"login": "FroMage", "name": "St\u00e9phane \u00c9pardaud"}}, "url": "https://github.com/quarkusio/quarkus/commit/2a24f0f4569d0ca759a41359d98a9847dc44f5ea", "committedDate": "2020-03-10T16:21:44Z", "message": "Fix for #7721: do not turn fields into accessors in constructors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTIwMzcy", "url": "https://github.com/quarkusio/quarkus/pull/7737#pullrequestreview-372120372", "createdAt": "2020-03-10T16:30:03Z", "commit": {"oid": "2a24f0f4569d0ca759a41359d98a9847dc44f5ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3793, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}