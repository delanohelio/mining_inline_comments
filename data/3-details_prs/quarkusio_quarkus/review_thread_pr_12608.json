{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwMTA5MTIx", "number": 12608, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODo0ODo1NFrOErvwjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODo0ODo1NFrOErvwjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MzA2NzAyOnYy", "diffSide": "RIGHT", "path": "docs/src/main/asciidoc/micrometer.adoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODo0ODo1NFrOHer_AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxOTowMjoxOFrOHesd4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzOTk2OQ==", "bodyText": "Remove the extra \"the\" before \"this example\"", "url": "https://github.com/quarkusio/quarkus/pull/12608#discussion_r501939969", "createdAt": "2020-10-08T18:48:54Z", "author": {"login": "kenfinnigan"}, "path": "docs/src/main/asciidoc/micrometer.adoc", "diffHunk": "@@ -280,6 +280,42 @@ jvm_memory_committed_bytes{area=\"nonheap\",id=\"CodeHeap 'non-profiled nmethods'\",\n Note that metrics appear lazily, you often won't see any data for your endpoint until\n something tries to access it, etc.\n \n+== Adding custom configuration or common tags\n+\n+Micrometer uses `MeterFilter` instances to customize the metrics emitted by `MeterRegistry` instances.\n+The Micrometer extension will detect `MeterFilter` CDI beans and use them when initializing `MeterRegistry` instances.\n+\n+[source,java]\n+----\n+@Singleton\n+public class CustomConfiguration {\n+\n+    @ConfigProperty(name = \"deployment.env\")\n+    String deploymentEnv;\n+\n+    /** Define common tags that apply only to a Prometheus Registry */\n+    @Produces\n+    @Singleton\n+    @MeterFilterConstraint(applyTo = PrometheusMeterRegistry.class)\n+    public MeterFilter configurePrometheusRegistries() {\n+        return MeterFilter.commonTags(Arrays.asList(\n+                Tag.of(\"registry\", \"prometheus\")));\n+    }\n+\n+    /** Define common tags that apply globally */\n+    @Produces\n+    @Singleton\n+    public MeterFilter configureAllRegistries() {\n+        return MeterFilter.commonTags(Arrays.asList(\n+                Tag.of(\"env\", deploymentEnv)));\n+    }\n+}\n+----\n+\n+In the this example, a singleton CDI bean will produce two different `MeterFilter` beans. One will be applied only to", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef2acb82f688b7ae2b15a2b4264ae0b070a2ba4"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk0Nzg3NQ==", "bodyText": "woops! good catch, thanks!", "url": "https://github.com/quarkusio/quarkus/pull/12608#discussion_r501947875", "createdAt": "2020-10-08T19:02:18Z", "author": {"login": "ebullient"}, "path": "docs/src/main/asciidoc/micrometer.adoc", "diffHunk": "@@ -280,6 +280,42 @@ jvm_memory_committed_bytes{area=\"nonheap\",id=\"CodeHeap 'non-profiled nmethods'\",\n Note that metrics appear lazily, you often won't see any data for your endpoint until\n something tries to access it, etc.\n \n+== Adding custom configuration or common tags\n+\n+Micrometer uses `MeterFilter` instances to customize the metrics emitted by `MeterRegistry` instances.\n+The Micrometer extension will detect `MeterFilter` CDI beans and use them when initializing `MeterRegistry` instances.\n+\n+[source,java]\n+----\n+@Singleton\n+public class CustomConfiguration {\n+\n+    @ConfigProperty(name = \"deployment.env\")\n+    String deploymentEnv;\n+\n+    /** Define common tags that apply only to a Prometheus Registry */\n+    @Produces\n+    @Singleton\n+    @MeterFilterConstraint(applyTo = PrometheusMeterRegistry.class)\n+    public MeterFilter configurePrometheusRegistries() {\n+        return MeterFilter.commonTags(Arrays.asList(\n+                Tag.of(\"registry\", \"prometheus\")));\n+    }\n+\n+    /** Define common tags that apply globally */\n+    @Produces\n+    @Singleton\n+    public MeterFilter configureAllRegistries() {\n+        return MeterFilter.commonTags(Arrays.asList(\n+                Tag.of(\"env\", deploymentEnv)));\n+    }\n+}\n+----\n+\n+In the this example, a singleton CDI bean will produce two different `MeterFilter` beans. One will be applied only to", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzOTk2OQ=="}, "originalCommit": {"oid": "3ef2acb82f688b7ae2b15a2b4264ae0b070a2ba4"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4258, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}