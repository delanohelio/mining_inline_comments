{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNjI1Mjc0", "number": 8579, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMDo1NzoxNlrODyS_jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMDo1NzoxNlrODyS_jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MDY2NTc1OnYy", "diffSide": "RIGHT", "path": "extensions/vertx-web/deployment/src/main/java/io/quarkus/vertx/web/deployment/VertxWebProcessor.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMDo1NzoxNlrOGGQurw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNTo1ODo0OFrOGGVtRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIxODczNQ==", "bodyText": "This is RUNTIME_INIT, isn't the bean container started in STATIC_INIT so will always be ready?", "url": "https://github.com/quarkusio/quarkus/pull/8579#discussion_r409218735", "createdAt": "2020-04-16T00:57:16Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/vertx-web/deployment/src/main/java/io/quarkus/vertx/web/deployment/VertxWebProcessor.java", "diffHunk": "@@ -211,7 +212,9 @@ void addAdditionalRoutes(\n             BuildProducer<RouteBuildItem> routeProducer,\n             BuildProducer<FilterBuildItem> filterProducer,\n             List<RequireBodyHandlerBuildItem> bodyHandlerRequired,\n-            BeanArchiveIndexBuildItem beanArchive) throws IOException {\n+            BeanArchiveIndexBuildItem beanArchive,\n+            // Make sure the routes are produced after the CDI container is ready - we need to initialize some state in the generated RouteHandler constructors\n+            BeanContainerBuildItem beanContainer) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc03260539ab7783f62ffa1fb342a6165987fdb"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIyMDYzMA==", "bodyText": "I think you also want to produce a ServiceStartBuildItem to make sure that this is ready when the HTTP port is opened.", "url": "https://github.com/quarkusio/quarkus/pull/8579#discussion_r409220630", "createdAt": "2020-04-16T01:04:16Z", "author": {"login": "stuartwdouglas"}, "path": "extensions/vertx-web/deployment/src/main/java/io/quarkus/vertx/web/deployment/VertxWebProcessor.java", "diffHunk": "@@ -211,7 +212,9 @@ void addAdditionalRoutes(\n             BuildProducer<RouteBuildItem> routeProducer,\n             BuildProducer<FilterBuildItem> filterProducer,\n             List<RequireBodyHandlerBuildItem> bodyHandlerRequired,\n-            BeanArchiveIndexBuildItem beanArchive) throws IOException {\n+            BeanArchiveIndexBuildItem beanArchive,\n+            // Make sure the routes are produced after the CDI container is ready - we need to initialize some state in the generated RouteHandler constructors\n+            BeanContainerBuildItem beanContainer) throws IOException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIxODczNQ=="}, "originalCommit": {"oid": "6fc03260539ab7783f62ffa1fb342a6165987fdb"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMwMDI5NQ==", "bodyText": "This is RUNTIME_INIT, isn't the bean container started in STATIC_INIT so will always be ready?\n\nAh yes, that's a good point.\n\nI think you also want to produce a ServiceStartBuildItem to make sure that this is ready when the HTTP port is opened.\n\nThat shouldn't be necessary because this build step produces RouteBuildItem which is consumed by a build step that is a dependant of a build step that produces ServiceStartBuildItem(\"vertx-http\").", "url": "https://github.com/quarkusio/quarkus/pull/8579#discussion_r409300295", "createdAt": "2020-04-16T05:58:48Z", "author": {"login": "mkouba"}, "path": "extensions/vertx-web/deployment/src/main/java/io/quarkus/vertx/web/deployment/VertxWebProcessor.java", "diffHunk": "@@ -211,7 +212,9 @@ void addAdditionalRoutes(\n             BuildProducer<RouteBuildItem> routeProducer,\n             BuildProducer<FilterBuildItem> filterProducer,\n             List<RequireBodyHandlerBuildItem> bodyHandlerRequired,\n-            BeanArchiveIndexBuildItem beanArchive) throws IOException {\n+            BeanArchiveIndexBuildItem beanArchive,\n+            // Make sure the routes are produced after the CDI container is ready - we need to initialize some state in the generated RouteHandler constructors\n+            BeanContainerBuildItem beanContainer) throws IOException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIxODczNQ=="}, "originalCommit": {"oid": "6fc03260539ab7783f62ffa1fb342a6165987fdb"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3509, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}