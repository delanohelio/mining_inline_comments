{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MzkxNTg0", "number": 12156, "title": "Only include bootstrap dependencies in quarkus:dev ClassPath", "bodyText": "The rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\nFixes #12136", "createdAt": "2020-09-17T04:17:21Z", "url": "https://github.com/quarkusio/quarkus/pull/12156", "merged": true, "mergeCommit": {"oid": "cd539607c23e6a10b0bb63abc80a047669514504"}, "closed": true, "closedAt": "2020-10-22T07:03:05Z", "author": {"login": "stuartwdouglas"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdT8nRqABqjM4OTEyNjIwNzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdU8eGTAFqTUxNDQxNTE5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c65599f00a362171f235b7137c4f86ab02ffc87b", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c65599f00a362171f235b7137c4f86ab02ffc87b", "committedDate": "2020-09-17T04:15:34Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}, "afterCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/61e6d525ea74c1b49c952ac69cb740ca5b1ad51e", "committedDate": "2020-10-19T04:38:50Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNTgzMTM1", "url": "https://github.com/quarkusio/quarkus/pull/12156#pullrequestreview-511583135", "createdAt": "2020-10-19T09:38:18Z", "commit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozODoxOFrOHkGAzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTozODoxOFrOHkGAzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYwOTI5Mw==", "bodyText": "That's io.quarkus.bootstrap.BootstrapConstants.DESCRIPTOR_PATH, btw.", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r507609293", "createdAt": "2020-10-19T09:38:18Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -93,6 +95,7 @@\n  */\n @Mojo(name = \"dev\", defaultPhase = LifecyclePhase.PREPARE_PACKAGE, requiresDependencyResolution = ResolutionScope.COMPILE_PLUS_RUNTIME)\n public class DevMojo extends AbstractMojo {\n+    private static final String EXT_PROPERTIES_PATH = \"META-INF/quarkus-extension.properties\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNTg0ODE3", "url": "https://github.com/quarkusio/quarkus/pull/12156#pullrequestreview-511584817", "createdAt": "2020-10-19T09:40:28Z", "commit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTo0MDoyOFrOHkGF0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTo0MDoyOFrOHkGF0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYxMDU3Ng==", "bodyText": "It doesn't look like this change is necessary. There is already public AppArtifactKey(String groupId, String artifactId, String classifier, String type)", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r507610576", "createdAt": "2020-10-19T09:40:28Z", "author": {"login": "aloubyansky"}, "path": "independent-projects/bootstrap/app-model/src/main/java/io/quarkus/bootstrap/model/AppArtifactKey.java", "diffHunk": "@@ -70,7 +70,7 @@ public static AppArtifactKey fromString(String str) {\n     protected final String classifier;\n     protected final String type;\n \n-    protected AppArtifactKey(String[] parts) {\n+    public AppArtifactKey(String[] parts) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61e6d525ea74c1b49c952ac69cb740ca5b1ad51e", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/61e6d525ea74c1b49c952ac69cb740ca5b1ad51e", "committedDate": "2020-10-19T04:38:50Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}, "afterCommit": {"oid": "c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a", "committedDate": "2020-10-19T23:37:17Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMDE3MDc3", "url": "https://github.com/quarkusio/quarkus/pull/12156#pullrequestreview-513017077", "createdAt": "2020-10-20T18:27:18Z", "commit": {"oid": "c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoyNzoxOFrOHlLcLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxODoyNzoxOFrOHlLcLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc0Njc5Nw==", "bodyText": "There is AppArtifactKey.fromString(str) actually.", "url": "https://github.com/quarkusio/quarkus/pull/12156#discussion_r508746797", "createdAt": "2020-10-20T18:27:18Z", "author": {"login": "aloubyansky"}, "path": "devtools/maven/src/main/java/io/quarkus/maven/DevMojo.java", "diffHunk": "@@ -717,11 +720,35 @@ void prepare(final boolean triggerCompile) throws Exception {\n \n             //in most cases these are not used, however they need to be present for some\n             //parent-first cases such as logging\n+            //first we go through and get all the parent first artifacts\n+            Set<AppArtifactKey> parentFirstArtifacts = new HashSet<>();\n+            for (Artifact appDep : project.getArtifacts()) {\n+                if (appDep.getArtifactHandler().getExtension().equals(\"jar\")) {\n+                    try (ZipFile file = new ZipFile(appDep.getFile())) {\n+                        ZipEntry entry = file.getEntry(BootstrapConstants.DESCRIPTOR_PATH);\n+                        if (entry != null) {\n+                            Properties p = new Properties();\n+                            try (InputStream inputStream = file.getInputStream(entry)) {\n+                                p.load(inputStream);\n+                                String parentFirst = p.getProperty(AppModel.PARENT_FIRST_ARTIFACTS);\n+                                if (parentFirst != null) {\n+                                    String[] artifacts = parentFirst.split(\",\");\n+                                    for (String artifact : artifacts) {\n+                                        parentFirstArtifacts.add(new AppArtifactKey(artifact.split(\":\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "847ece98fa44615530d6a49aeffdad6e7adba337", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/847ece98fa44615530d6a49aeffdad6e7adba337", "committedDate": "2020-10-22T04:26:30Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/c674393bd154723b9a2b49ac9dd2e78d4f6d6d4a", "committedDate": "2020-10-19T23:37:17Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}, "afterCommit": {"oid": "847ece98fa44615530d6a49aeffdad6e7adba337", "author": {"user": {"login": "stuartwdouglas", "name": "Stuart Douglas"}}, "url": "https://github.com/quarkusio/quarkus/commit/847ece98fa44615530d6a49aeffdad6e7adba337", "committedDate": "2020-10-22T04:26:30Z", "message": "Only include bootstrap dependencies in quarkus:dev ClassPath\n\nThe rest of the depenencies are resolved in the bootstrap resolver,\nhaving them on the ClassPath only causes problems.\n\nA similar fix could be applied to Gradle, however I am not sure\nhow to filter the dependencies to only include those required\nfor bootstrap.\n\nFixes #12136"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NDE1MTk4", "url": "https://github.com/quarkusio/quarkus/pull/12156#pullrequestreview-514415198", "createdAt": "2020-10-22T07:02:54Z", "commit": {"oid": "847ece98fa44615530d6a49aeffdad6e7adba337"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 513, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}