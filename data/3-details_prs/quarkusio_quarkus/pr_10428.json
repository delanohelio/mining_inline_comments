{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNDg1NDgw", "number": 10428, "title": "Add a doc workflow", "bodyText": "Add a Github workflow for doc only PR.\nIt uses the Sonatype repo to download Quarkus dependencies instead of building them.\nIt only builds the Asciidoc documention.", "createdAt": "2020-07-02T12:29:35Z", "url": "https://github.com/quarkusio/quarkus/pull/10428", "merged": true, "mergeCommit": {"oid": "627bb966874f33f60a8e5f35b5443b5bceecd3b0"}, "closed": true, "closedAt": "2020-07-04T11:52:01Z", "author": {"login": "loicmathieu"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcw-JFYgFqTQ0MTYzNTc4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxmrJ5AFqTQ0MjYwNTU2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNjM1Nzg4", "url": "https://github.com/quarkusio/quarkus/pull/10428#pullrequestreview-441635788", "createdAt": "2020-07-02T12:37:00Z", "commit": {"oid": "a87d807bd574f1ac429dcad3cb49c710c60a3e00"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMjozNzowMFrOGsK6mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMjozODoxNlrOGsK9ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODk2OTM3MQ==", "bodyText": "Why a specific mvn settings?", "url": "https://github.com/quarkusio/quarkus/pull/10428#discussion_r448969371", "createdAt": "2020-07-02T12:37:00Z", "author": {"login": "gsmet"}, "path": ".github/workflows/doc-build.yml", "diffHunk": "@@ -0,0 +1,61 @@\n+name: Quarkus Documentation CI\n+\n+on:\n+  push:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+  pull_request:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+\n+\n+jobs:\n+  build-doc:\n+    name: \"Documentation Build\"\n+    runs-on: ubuntu-latest\n+    # Skip draft PRs and those with WIP in the subject, rerun as soon as its removed\n+    if: \"github.event_name != 'pull_request' || ( \\\n+             github.event.pull_request.draft == false && \\\n+             github.event.pull_request.state != 'closed' && \\\n+             contains(github.event.pull_request.title, 'wip ') == false && \\\n+             contains(github.event.pull_request.title, '[wip]') == false && \\\n+             (\n+               github.event.action != 'edited' || \\\n+               contains(github.event.changes.title.from, 'wip ') || \\\n+               contains(github.event.changes.title.from, '[wip]') \\\n+             ) \\\n+           )\"\n+    steps:\n+      - uses: actions/checkout@v2\n+      - uses: n1hility/cancel-previous-runs@v2\n+        with:\n+          token: ${{ secrets.GITHUB_TOKEN }}\n+      - name: Set up JDK 11\n+        # Uses sha for added security since tags can be updated\n+        uses: joschi/setup-jdk@b9cc6eabf7e7e3889766b5cee486f874c9e1bd2d\n+        with:\n+          java-version: 11\n+      - name: Compute cache restore key\n+        # Always recompute on a push so that the maven repo doesnt grow indefinitely with old versions\n+        run: |\n+          if ${{ github.event_name == 'pull_request' }}; then echo \"::set-env name=COMPUTED_RESTORE_KEY::q2maven-\"; fi\n+      - name: Cache Maven Repository\n+        id: cache-maven\n+        uses: n1hility/cache@v2\n+        with:\n+          path: ~/.m2/repository\n+          # Improves the reusability of the cache to limit key changes\n+          key: q2maven-${{ hashFiles('bom/runtime/pom.xml') }}\n+          restore-keys: ${{ env.COMPUTED_RESTORE_KEY }}\n+          restore-only: ${{ github.event_name == 'pull_request' }}\n+      - name: Build\n+        run: |\n+          mvn -e -B --settings .github/doc-mvn-settings.xml clean package -pl docs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a87d807bd574f1ac429dcad3cb49c710c60a3e00"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODk2OTY1MA==", "bodyText": "I wonder if we should avoid storing the cache, given there's a good chance it won't bring anything useful.", "url": "https://github.com/quarkusio/quarkus/pull/10428#discussion_r448969650", "createdAt": "2020-07-02T12:37:32Z", "author": {"login": "gsmet"}, "path": ".github/workflows/doc-build.yml", "diffHunk": "@@ -0,0 +1,61 @@\n+name: Quarkus Documentation CI\n+\n+on:\n+  push:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+  pull_request:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+\n+\n+jobs:\n+  build-doc:\n+    name: \"Documentation Build\"\n+    runs-on: ubuntu-latest\n+    # Skip draft PRs and those with WIP in the subject, rerun as soon as its removed\n+    if: \"github.event_name != 'pull_request' || ( \\\n+             github.event.pull_request.draft == false && \\\n+             github.event.pull_request.state != 'closed' && \\\n+             contains(github.event.pull_request.title, 'wip ') == false && \\\n+             contains(github.event.pull_request.title, '[wip]') == false && \\\n+             (\n+               github.event.action != 'edited' || \\\n+               contains(github.event.changes.title.from, 'wip ') || \\\n+               contains(github.event.changes.title.from, '[wip]') \\\n+             ) \\\n+           )\"\n+    steps:\n+      - uses: actions/checkout@v2\n+      - uses: n1hility/cancel-previous-runs@v2\n+        with:\n+          token: ${{ secrets.GITHUB_TOKEN }}\n+      - name: Set up JDK 11\n+        # Uses sha for added security since tags can be updated\n+        uses: joschi/setup-jdk@b9cc6eabf7e7e3889766b5cee486f874c9e1bd2d\n+        with:\n+          java-version: 11\n+      - name: Compute cache restore key\n+        # Always recompute on a push so that the maven repo doesnt grow indefinitely with old versions\n+        run: |\n+          if ${{ github.event_name == 'pull_request' }}; then echo \"::set-env name=COMPUTED_RESTORE_KEY::q2maven-\"; fi\n+      - name: Cache Maven Repository\n+        id: cache-maven\n+        uses: n1hility/cache@v2\n+        with:\n+          path: ~/.m2/repository\n+          # Improves the reusability of the cache to limit key changes\n+          key: q2maven-${{ hashFiles('bom/runtime/pom.xml') }}\n+          restore-keys: ${{ env.COMPUTED_RESTORE_KEY }}\n+          restore-only: ${{ github.event_name == 'pull_request' }}\n+      - name: Build\n+        run: |\n+          mvn -e -B --settings .github/doc-mvn-settings.xml clean package -pl docs\n+      - name: Tar Maven Repo\n+        shell: bash\n+        run: tar -czf maven-repo.tgz -C ~ .m2/repository\n+      - name: Persist Maven Repo\n+        uses: actions/upload-artifact@v1\n+        with:\n+          name: maven-repo\n+          path: maven-repo.tgz", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a87d807bd574f1ac429dcad3cb49c710c60a3e00"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODk3MDA5MA==", "bodyText": "I think I would run it anyway in this case so that we can have early feedback on the doc. Usually, that's not the doc that is the issue.", "url": "https://github.com/quarkusio/quarkus/pull/10428#discussion_r448970090", "createdAt": "2020-07-02T12:38:16Z", "author": {"login": "gsmet"}, "path": ".github/workflows/doc-build.yml", "diffHunk": "@@ -0,0 +1,61 @@\n+name: Quarkus Documentation CI\n+\n+on:\n+  push:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+  pull_request:\n+    paths:\n+      - 'docs/src/main/asciidoc/**'\n+\n+\n+jobs:\n+  build-doc:\n+    name: \"Documentation Build\"\n+    runs-on: ubuntu-latest\n+    # Skip draft PRs and those with WIP in the subject, rerun as soon as its removed\n+    if: \"github.event_name != 'pull_request' || ( \\\n+             github.event.pull_request.draft == false && \\\n+             github.event.pull_request.state != 'closed' && \\\n+             contains(github.event.pull_request.title, 'wip ') == false && \\\n+             contains(github.event.pull_request.title, '[wip]') == false && \\\n+             (\n+               github.event.action != 'edited' || \\\n+               contains(github.event.changes.title.from, 'wip ') || \\\n+               contains(github.event.changes.title.from, '[wip]') \\\n+             ) \\\n+           )\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a87d807bd574f1ac429dcad3cb49c710c60a3e00"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a87d807bd574f1ac429dcad3cb49c710c60a3e00", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/a87d807bd574f1ac429dcad3cb49c710c60a3e00", "committedDate": "2020-07-02T12:10:55Z", "message": "Add a doc workflow"}, "afterCommit": {"oid": "89de645a66efbef726cef23b3b6e4877945c7216", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/89de645a66efbef726cef23b3b6e4877945c7216", "committedDate": "2020-07-02T13:55:15Z", "message": "WIP : fake FAQ"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92288ca5cae2f097059a87b79e7cb2c414591be9", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/92288ca5cae2f097059a87b79e7cb2c414591be9", "committedDate": "2020-07-02T14:44:10Z", "message": "Add a doc workflow"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89de645a66efbef726cef23b3b6e4877945c7216", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/89de645a66efbef726cef23b3b6e4877945c7216", "committedDate": "2020-07-02T13:55:15Z", "message": "WIP : fake FAQ"}, "afterCommit": {"oid": "92288ca5cae2f097059a87b79e7cb2c414591be9", "author": {"user": {"login": "loicmathieu", "name": "Lo\u00efc Mathieu"}}, "url": "https://github.com/quarkusio/quarkus/commit/92288ca5cae2f097059a87b79e7cb2c414591be9", "committedDate": "2020-07-02T14:44:10Z", "message": "Add a doc workflow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNjA1NTY4", "url": "https://github.com/quarkusio/quarkus/pull/10428#pullrequestreview-442605568", "createdAt": "2020-07-04T11:51:54Z", "commit": {"oid": "92288ca5cae2f097059a87b79e7cb2c414591be9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3612, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}