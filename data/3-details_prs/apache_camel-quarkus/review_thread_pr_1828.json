{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNDAwMDEz", "number": 1828, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMjoxOTo1MVrOEnA9kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODo1Mjo1M1rOEnXjtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MzQ1NjgyOnYy", "diffSide": "RIGHT", "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMjoxOTo1MVrOHXXv5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODo1OTozMVrOHX7KNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI2ODM5MA==", "bodyText": "Maybe we should not do this. See my comments in #1807.", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494268390", "createdAt": "2020-09-24T12:19:51Z", "author": {"login": "jamesnetherton"}, "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "diffHunk": "@@ -17,30 +17,23 @@\n package org.apache.camel.quarkus.component.stringtemplate.deployment;\n \n import io.quarkus.deployment.annotations.BuildStep;\n-import io.quarkus.deployment.annotations.ExecutionTime;\n-import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.FeatureBuildItem;\n-import io.quarkus.deployment.pkg.steps.NativeBuild;\n-import org.apache.camel.quarkus.core.JvmOnlyRecorder;\n-import org.jboss.logging.Logger;\n+import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;\n+import org.apache.camel.support.DefaultExchange;\n \n class StringtemplateProcessor {\n \n-    private static final Logger LOG = Logger.getLogger(StringtemplateProcessor.class);\n     private static final String FEATURE = \"camel-stringtemplate\";\n \n     @BuildStep\n     FeatureBuildItem feature() {\n         return new FeatureBuildItem(FEATURE);\n     }\n \n-    /**\n-     * Remove this once this extension starts supporting the native mode.\n-     */\n-    @BuildStep(onlyIf = NativeBuild.class)\n-    @Record(value = ExecutionTime.RUNTIME_INIT)\n-    void warnJvmInNative(JvmOnlyRecorder recorder) {\n-        JvmOnlyRecorder.warnJvmInNative(LOG, FEATURE); // warn at build time\n-        recorder.warnJvmInNative(FEATURE); // warn at runtime\n+    @BuildStep\n+    ReflectiveClassBuildItem registerForReflectionWithMethods() {\n+        return new ReflectiveClassBuildItem(true, false,\n+                //required for values in properties\n+                DefaultExchange.class.getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "156b1610f18c74e0d72132cdda1c1c85713e39a1"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI5ODczOA==", "bodyText": "If it may be security vulnerability, I'll remove corresponding test, I'll remove this build item and add into limitations, that this feature is not supported in native mode. @jamesnetherton Do you agree?", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494298738", "createdAt": "2020-09-24T13:03:23Z", "author": {"login": "JiriOndrusek"}, "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "diffHunk": "@@ -17,30 +17,23 @@\n package org.apache.camel.quarkus.component.stringtemplate.deployment;\n \n import io.quarkus.deployment.annotations.BuildStep;\n-import io.quarkus.deployment.annotations.ExecutionTime;\n-import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.FeatureBuildItem;\n-import io.quarkus.deployment.pkg.steps.NativeBuild;\n-import org.apache.camel.quarkus.core.JvmOnlyRecorder;\n-import org.jboss.logging.Logger;\n+import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;\n+import org.apache.camel.support.DefaultExchange;\n \n class StringtemplateProcessor {\n \n-    private static final Logger LOG = Logger.getLogger(StringtemplateProcessor.class);\n     private static final String FEATURE = \"camel-stringtemplate\";\n \n     @BuildStep\n     FeatureBuildItem feature() {\n         return new FeatureBuildItem(FEATURE);\n     }\n \n-    /**\n-     * Remove this once this extension starts supporting the native mode.\n-     */\n-    @BuildStep(onlyIf = NativeBuild.class)\n-    @Record(value = ExecutionTime.RUNTIME_INIT)\n-    void warnJvmInNative(JvmOnlyRecorder recorder) {\n-        JvmOnlyRecorder.warnJvmInNative(LOG, FEATURE); // warn at build time\n-        recorder.warnJvmInNative(FEATURE); // warn at runtime\n+    @BuildStep\n+    ReflectiveClassBuildItem registerForReflectionWithMethods() {\n+        return new ReflectiveClassBuildItem(true, false,\n+                //required for values in properties\n+                DefaultExchange.class.getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI2ODM5MA=="}, "originalCommit": {"oid": "156b1610f18c74e0d72132cdda1c1c85713e39a1"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMwOTc2OA==", "bodyText": "Fine with me \ud83d\udc4d", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494309768", "createdAt": "2020-09-24T13:19:18Z", "author": {"login": "jamesnetherton"}, "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "diffHunk": "@@ -17,30 +17,23 @@\n package org.apache.camel.quarkus.component.stringtemplate.deployment;\n \n import io.quarkus.deployment.annotations.BuildStep;\n-import io.quarkus.deployment.annotations.ExecutionTime;\n-import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.FeatureBuildItem;\n-import io.quarkus.deployment.pkg.steps.NativeBuild;\n-import org.apache.camel.quarkus.core.JvmOnlyRecorder;\n-import org.jboss.logging.Logger;\n+import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;\n+import org.apache.camel.support.DefaultExchange;\n \n class StringtemplateProcessor {\n \n-    private static final Logger LOG = Logger.getLogger(StringtemplateProcessor.class);\n     private static final String FEATURE = \"camel-stringtemplate\";\n \n     @BuildStep\n     FeatureBuildItem feature() {\n         return new FeatureBuildItem(FEATURE);\n     }\n \n-    /**\n-     * Remove this once this extension starts supporting the native mode.\n-     */\n-    @BuildStep(onlyIf = NativeBuild.class)\n-    @Record(value = ExecutionTime.RUNTIME_INIT)\n-    void warnJvmInNative(JvmOnlyRecorder recorder) {\n-        JvmOnlyRecorder.warnJvmInNative(LOG, FEATURE); // warn at build time\n-        recorder.warnJvmInNative(FEATURE); // warn at runtime\n+    @BuildStep\n+    ReflectiveClassBuildItem registerForReflectionWithMethods() {\n+        return new ReflectiveClassBuildItem(true, false,\n+                //required for values in properties\n+                DefaultExchange.class.getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI2ODM5MA=="}, "originalCommit": {"oid": "156b1610f18c74e0d72132cdda1c1c85713e39a1"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDQyMQ==", "bodyText": "I've fixed it as I suggested. (also discovered a bug in camel component - https://issues.apache.org/jira/browse/CAMEL-15577)", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494844421", "createdAt": "2020-09-25T08:52:13Z", "author": {"login": "JiriOndrusek"}, "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "diffHunk": "@@ -17,30 +17,23 @@\n package org.apache.camel.quarkus.component.stringtemplate.deployment;\n \n import io.quarkus.deployment.annotations.BuildStep;\n-import io.quarkus.deployment.annotations.ExecutionTime;\n-import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.FeatureBuildItem;\n-import io.quarkus.deployment.pkg.steps.NativeBuild;\n-import org.apache.camel.quarkus.core.JvmOnlyRecorder;\n-import org.jboss.logging.Logger;\n+import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;\n+import org.apache.camel.support.DefaultExchange;\n \n class StringtemplateProcessor {\n \n-    private static final Logger LOG = Logger.getLogger(StringtemplateProcessor.class);\n     private static final String FEATURE = \"camel-stringtemplate\";\n \n     @BuildStep\n     FeatureBuildItem feature() {\n         return new FeatureBuildItem(FEATURE);\n     }\n \n-    /**\n-     * Remove this once this extension starts supporting the native mode.\n-     */\n-    @BuildStep(onlyIf = NativeBuild.class)\n-    @Record(value = ExecutionTime.RUNTIME_INIT)\n-    void warnJvmInNative(JvmOnlyRecorder recorder) {\n-        JvmOnlyRecorder.warnJvmInNative(LOG, FEATURE); // warn at build time\n-        recorder.warnJvmInNative(FEATURE); // warn at runtime\n+    @BuildStep\n+    ReflectiveClassBuildItem registerForReflectionWithMethods() {\n+        return new ReflectiveClassBuildItem(true, false,\n+                //required for values in properties\n+                DefaultExchange.class.getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI2ODM5MA=="}, "originalCommit": {"oid": "156b1610f18c74e0d72132cdda1c1c85713e39a1"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0ODU2NQ==", "bodyText": "Maybe we should not do this. See my comments in #1807.\n\nI thought the same when I saw it, but I was not able to find the place where Claus mentioned that allowContextMapAll is a security vulnerabilty fix. Thanks for mentioning #1807 @jamesnetherton !", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494848565", "createdAt": "2020-09-25T08:59:31Z", "author": {"login": "ppalaga"}, "path": "extensions/stringtemplate/deployment/src/main/java/org/apache/camel/quarkus/component/stringtemplate/deployment/StringtemplateProcessor.java", "diffHunk": "@@ -17,30 +17,23 @@\n package org.apache.camel.quarkus.component.stringtemplate.deployment;\n \n import io.quarkus.deployment.annotations.BuildStep;\n-import io.quarkus.deployment.annotations.ExecutionTime;\n-import io.quarkus.deployment.annotations.Record;\n import io.quarkus.deployment.builditem.FeatureBuildItem;\n-import io.quarkus.deployment.pkg.steps.NativeBuild;\n-import org.apache.camel.quarkus.core.JvmOnlyRecorder;\n-import org.jboss.logging.Logger;\n+import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;\n+import org.apache.camel.support.DefaultExchange;\n \n class StringtemplateProcessor {\n \n-    private static final Logger LOG = Logger.getLogger(StringtemplateProcessor.class);\n     private static final String FEATURE = \"camel-stringtemplate\";\n \n     @BuildStep\n     FeatureBuildItem feature() {\n         return new FeatureBuildItem(FEATURE);\n     }\n \n-    /**\n-     * Remove this once this extension starts supporting the native mode.\n-     */\n-    @BuildStep(onlyIf = NativeBuild.class)\n-    @Record(value = ExecutionTime.RUNTIME_INIT)\n-    void warnJvmInNative(JvmOnlyRecorder recorder) {\n-        JvmOnlyRecorder.warnJvmInNative(LOG, FEATURE); // warn at build time\n-        recorder.warnJvmInNative(FEATURE); // warn at runtime\n+    @BuildStep\n+    ReflectiveClassBuildItem registerForReflectionWithMethods() {\n+        return new ReflectiveClassBuildItem(true, false,\n+                //required for values in properties\n+                DefaultExchange.class.getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI2ODM5MA=="}, "originalCommit": {"oid": "156b1610f18c74e0d72132cdda1c1c85713e39a1"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5NzE1ODk0OnYy", "diffSide": "RIGHT", "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "isResolved": true, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODo1Mjo1M1rOHX67eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxMDoyMToyNVrOHX95kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg==", "bodyText": "I've added test for native to verify that parameter allowContextMapAll is disabled.\nBut because there are usually no special tests for native mode, I'd like to ask. @jamesnetherton , @ppalaga   Should I keep it or remove it?", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494844792", "createdAt": "2020-09-25T08:52:53Z", "author": {"login": "JiriOndrusek"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NzE3OQ==", "bodyText": "No problem with having a special test for native. We definitely had such in the past, not sure we still have them elsewhere.", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494847179", "createdAt": "2020-09-25T08:56:57Z", "author": {"login": "ppalaga"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg1NDQ5OA==", "bodyText": "We should agree on whether this is the right thing to do.\nOriginally, I saw the 'fix' to #1807 as purely a documentation exercise. Where we just state for each affected extension that contextMapAll = true will not work in native mode.\nPotentially forcing contextMapAll to false is a bit confusing because you would run into problems at runtime. Where as without it, the native build would fail, so it's sort like a 'fail fast'.", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494854498", "createdAt": "2020-09-25T09:10:19Z", "author": {"login": "jamesnetherton"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg1OTIxNg==", "bodyText": "So, removing substitution (which forcescontextMapAll = true), rewriting limitations (that exchange.properties won't work) and removing test, should be the correct solution, yes?", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494859216", "createdAt": "2020-09-25T09:19:01Z", "author": {"login": "JiriOndrusek"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg2MDk0OQ==", "bodyText": "IMO, yes. @ppalaga WDYT?", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494860949", "createdAt": "2020-09-25T09:21:54Z", "author": {"login": "jamesnetherton"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg2MzkwMA==", "bodyText": "I think about documentation like this one:\n\nIf property allowContextMapAll is set to true there is a limitation in native mode. Reflective calls to methods\nof several classes in camel are not allowed (for example org.apache.camel.support.DefaultExchange). Therefore\nsome expression won't work (for example `<exchange.properties.*>).\nYou can allow reflective calls to such classes (for example by application.properties), but keep in mind that it brings\nsome security risks.\n\nWDYT? @ppalaga , @jamesnetherton", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494863900", "createdAt": "2020-09-25T09:27:01Z", "author": {"login": "JiriOndrusek"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg3NTkyNw==", "bodyText": "+1 for removing the substitution and letting the native compilation fail", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494875927", "createdAt": "2020-09-25T09:47:40Z", "author": {"login": "ppalaga"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg3ODEzMA==", "bodyText": "Sounds ok to me. Maybe tweak some expression to some expressions.", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494878130", "createdAt": "2020-09-25T09:51:24Z", "author": {"login": "jamesnetherton"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg5MzQ1Nw==", "bodyText": "done", "url": "https://github.com/apache/camel-quarkus/pull/1828#discussion_r494893457", "createdAt": "2020-09-25T10:21:25Z", "author": {"login": "JiriOndrusek"}, "path": "integration-tests/stringtemplate/src/test/java/org/apache/camel/quarkus/component/stringtemplate/it/StringtemplateIT.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.quarkus.component.stringtemplate.it;\n+\n+import java.util.Collections;\n+\n+import io.quarkus.test.junit.NativeImageTest;\n+import io.restassured.RestAssured;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+\n+@NativeImageTest\n+class StringtemplateIT extends StringtemplateTest {\n+\n+    @Test\n+    public void testDisabledContextMapAll() {\n+        //allowContextMapAll has to be disabled in native mode\n+        RestAssured.given()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDg0NDc5Mg=="}, "originalCommit": {"oid": "2393ad2516408e1de75ac2844bf65035ed364b34"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4532, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}