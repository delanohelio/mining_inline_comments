{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1NTk5ODU5", "number": 10149, "title": "Add availability and consistency docs.", "bodyText": "Describes transactional ingestion and atomic replacement. Also, this patch\ndeletes some bad advice from the javadocs for SegmentTransactionalInsertAction.", "createdAt": "2020-07-07T19:07:25Z", "url": "https://github.com/apache/druid/pull/10149", "merged": true, "mergeCommit": {"oid": "11c0da809711c03f21e7e60ec1d4bfd2826fe8f2"}, "closed": true, "closedAt": "2020-07-07T22:22:53Z", "author": {"login": "gianm"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyqr8BAH2gAyNDQ1NTk5ODU5OjMyMTM0NWE4Y2I4MGQ5OTYyZWZkMTc0MzczNGY3NDg1ZDNiZDg5ZDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcytfbUgFqTQ0NDI5MDc3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "321345a8cb80d9962efd1743734f7485d3bd89d9", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/321345a8cb80d9962efd1743734f7485d3bd89d9", "committedDate": "2020-07-07T19:06:18Z", "message": "Add availability and consistency docs.\n\nDescribes transactional ingestion and atomic replacement. Also, this patch\ndeletes some bad advice from the javadocs for SegmentTransactionalInsertAction."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MjE4NDUw", "url": "https://github.com/apache/druid/pull/10149#pullrequestreview-444218450", "createdAt": "2020-07-07T20:17:24Z", "commit": {"oid": "321345a8cb80d9962efd1743734f7485d3bd89d9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoxNzoyNFrOGuOEeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QyMDoxNzoyNFrOGuOEeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTExODIwMg==", "bodyText": "partially-ingested data discarded -> partially-ingested data \"is\" discarded", "url": "https://github.com/apache/druid/pull/10149#discussion_r451118202", "createdAt": "2020-07-07T20:17:24Z", "author": {"login": "surekhasaharan"}, "path": "docs/design/architecture.md", "diffHunk": "@@ -213,6 +213,75 @@ this will generally start off `true` and then become `false` as the segment is p\n published segments. Generally this is a transient state, and segments in this state will soon have their `used` flag\n automatically set to false.\n \n+### Availability and consistency\n+\n+Druid has an architectural separation between ingestion and querying, as described above in\n+[Indexing and handoff](#indexing-and-handoff). This means that when understanding Druid's availability and\n+consistency properties, we must look at each function separately.\n+\n+On the **ingestion side**, Druid's primary [ingestion methods](../ingestion/index.md#ingestion-methods) are all\n+pull-based and offer transactional guarantees. This means that you are guaranteed that ingestion using these will\n+publish in an all-or-nothing manner:\n+\n+- Supervised \"seekable-stream\" ingestion methods like [Kafka](../development/extensions-core/kafka-ingestion.md) and\n+[Kinesis](../development/extensions-core/kinesis-ingestion.md). With these methods, Druid commits stream offsets to its\n+[metadata store](#metadata-storage) alongside segment metadata, in the same transaction. Note that ingestion of data\n+that has not yet been published can be rolled back if ingestion tasks fail. In this case, partially-ingested data\n+discarded, and Druid will resume ingestion from the last committed set of stream offsets. This ensures exactly-once", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "321345a8cb80d9962efd1743734f7485d3bd89d9"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MjYxNzE2", "url": "https://github.com/apache/druid/pull/10149#pullrequestreview-444261716", "createdAt": "2020-07-07T21:25:56Z", "commit": {"oid": "321345a8cb80d9962efd1743734f7485d3bd89d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "761d4e67e5d2fd99b52fae3244bbd10e146dd135", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/761d4e67e5d2fd99b52fae3244bbd10e146dd135", "committedDate": "2020-07-07T21:30:03Z", "message": "Fix missing word."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MjkwNzc4", "url": "https://github.com/apache/druid/pull/10149#pullrequestreview-444290778", "createdAt": "2020-07-07T22:22:21Z", "commit": {"oid": "761d4e67e5d2fd99b52fae3244bbd10e146dd135"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1816, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}