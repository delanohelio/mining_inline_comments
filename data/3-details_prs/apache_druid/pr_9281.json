{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4MzM2NTUw", "number": 9281, "title": "Add LookupJoinableFactory.", "bodyText": "Enables joins where the right-hand side is a lookup. Includes an\nintegration test.\nAlso, includes changes to LookupExtractorFactoryContainerProvider:\n\nAdd \"getAllLookupNames\", which will be needed to eventually connect\nlookups to Druid's SQL catalog.\nConvert \"get\" from nullable to Optional return.\nSwap out most usages of LookupReferencesManager in favor of the\nsimpler LookupExtractorFactoryContainerProvider interface.", "createdAt": "2020-01-29T02:06:15Z", "url": "https://github.com/apache/druid/pull/9281", "merged": true, "mergeCommit": {"oid": "204ba9966f94d3e99be980ec9b2817eda0931ee2"}, "closed": true, "closedAt": "2020-01-30T22:46:21Z", "author": {"login": "gianm"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-8KuRgH2gAyMzY4MzM2NTUwOmExNWY4YjFhYjE5ZDA5MDBhZWMwYjIyODhlNWU3NTVkYjUxYzNkOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_iSSHAFqTM1MTExMjU5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a15f8b1ab19d0900aec0b2288e5e755db51c3d8b", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/a15f8b1ab19d0900aec0b2288e5e755db51c3d8b", "committedDate": "2020-01-29T02:04:15Z", "message": "Add LookupJoinableFactory.\n\nEnables joins where the right-hand side is a lookup. Includes an\nintegration test.\n\nAlso, includes changes to LookupExtractorFactoryContainerProvider:\n\n1) Add \"getAllLookupNames\", which will be needed to eventually connect\n   lookups to Druid's SQL catalog.\n2) Convert \"get\" from nullable to Optional return.\n3) Swap out most usages of LookupReferencesManager in favor of the\n   simpler LookupExtractorFactoryContainerProvider interface."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82c9f6652c064275fcc7de57c15de01c212fd14e", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/82c9f6652c064275fcc7de57c15de01c212fd14e", "committedDate": "2020-01-29T03:04:07Z", "message": "Merge branch 'master' into lookup-joinable-factory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be6feecedad317e8087ddaccb96fb3ff916a4502", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/be6feecedad317e8087ddaccb96fb3ff916a4502", "committedDate": "2020-01-29T03:10:34Z", "message": "Fixes for tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a11b6df5794db7a986111680103745120b71bd4", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/4a11b6df5794db7a986111680103745120b71bd4", "committedDate": "2020-01-29T04:06:07Z", "message": "Fix another test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05e76b884ce170871ec8ef78d1d91740f008fb51", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/05e76b884ce170871ec8ef78d1d91740f008fb51", "committedDate": "2020-01-29T06:10:02Z", "message": "Java 11 message fix."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06122ea779f3e0df89ae0881b3e4b89c70295d21", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/06122ea779f3e0df89ae0881b3e4b89c70295d21", "committedDate": "2020-01-29T15:10:19Z", "message": "Fixups."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "512a87a184c5b8a5d467158849fd426f710c2612", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/512a87a184c5b8a5d467158849fd426f710c2612", "committedDate": "2020-01-30T08:31:02Z", "message": "Merge branch 'master' into lookup-joinable-factory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33d7908c0bd956129530839cd18b80321c05d768", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/33d7908c0bd956129530839cd18b80321c05d768", "committedDate": "2020-01-30T17:05:50Z", "message": "Fixup benchmark class."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTc1Nzg3", "url": "https://github.com/apache/druid/pull/9281#pullrequestreview-351175787", "createdAt": "2020-01-30T22:06:56Z", "commit": {"oid": "33d7908c0bd956129530839cd18b80321c05d768"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTEyNTk1", "url": "https://github.com/apache/druid/pull/9281#pullrequestreview-351112595", "createdAt": "2020-01-30T20:15:46Z", "commit": {"oid": "33d7908c0bd956129530839cd18b80321c05d768"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMDoxNTo0NlrOFj4jwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMDoxNzoxN1rOFj4mVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE3MTEzOA==", "bodyText": "Do you want to add a similar assert below for LookupJoinableFactory?", "url": "https://github.com/apache/druid/pull/9281#discussion_r373171138", "createdAt": "2020-01-30T20:15:46Z", "author": {"login": "ccaominh"}, "path": "server/src/test/java/org/apache/druid/guice/JoinableFactoryModuleTest.java", "diffHunk": "@@ -63,7 +66,7 @@ public void testInjectDefaultBindingsShouldBeInjected()\n   {\n     Map<Class<? extends DataSource>, JoinableFactory> joinableFactories =\n         injector.getInstance(Key.get(new TypeLiteral<Map<Class<? extends DataSource>, JoinableFactory>>() {}));\n-    Assert.assertEquals(1, joinableFactories.size());\n+    Assert.assertEquals(2, joinableFactories.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33d7908c0bd956129530839cd18b80321c05d768"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE3MTc5Ng==", "bodyText": "Maybe JoinableFactoryModule.FACTORY_MAPPINGS can be made visible for testing so that this can be changed to FACTORY_MAPPINGS.size() + 1 and the test does not need to updated again if another default mapping is added later.", "url": "https://github.com/apache/druid/pull/9281#discussion_r373171796", "createdAt": "2020-01-30T20:17:17Z", "author": {"login": "ccaominh"}, "path": "server/src/test/java/org/apache/druid/guice/JoinableFactoryModuleTest.java", "diffHunk": "@@ -75,23 +78,25 @@ public void testJoinableFactoryCanBind()\n             .joinableFactoryBinder(binder).addBinding(NoopDataSource.class).toInstance(NoopJoinableFactory.INSTANCE));\n     Map<Class<? extends DataSource>, JoinableFactory> joinableFactories =\n         injector.getInstance(Key.get(new TypeLiteral<Map<Class<? extends DataSource>, JoinableFactory>>() {}));\n-    Assert.assertEquals(2, joinableFactories.size());\n+    Assert.assertEquals(3, joinableFactories.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33d7908c0bd956129530839cd18b80321c05d768"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3045, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}