{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NTUzNDU2", "number": 10710, "title": "fix web-console show json bug", "bodyText": "Description\nBecause of use json-bigint parse json in web-console/src/singletons/api.ts, json object will has some fields with type bigInt. This type will cause exception when using JSON.stringify. I fix it by cast value which is bigInt to string.\nWhen use Kafka as datasource, task payload will contains some partition information. If partition has a large offset, it will trigger this bug like this:\n\nUse this commit, correct content will display, like this:\n\n\n\n\nFixed the bug ...\nRenamed the class ...\nAdded a forbidden-apis entry ...\n\n\n\n\n\nThis PR has:\n\n been self-reviewed.\n\n using the concurrency checklist (Remove this item if the PR doesn't have any relation to concurrency.)\n\n\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added or updated version, license, or notice information in licenses.yaml\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n added integration tests.\n been tested in a test Druid cluster.\n\n\n\nKey changed/added classes in this PR\n\nMyFoo\nOurBar\nTheirBaz", "createdAt": "2020-12-25T08:42:04Z", "url": "https://github.com/apache/druid/pull/10710", "merged": true, "mergeCommit": {"oid": "3624acbcf84781f1e9780aeea28c8d6d6ccf44b3"}, "closed": true, "closedAt": "2021-01-08T22:55:56Z", "author": {"login": "bananaaggle"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpj3rCgH2gAyNTQ1NTUzNDU2OjgxYjZlYWViMGE3ZWE3NGFmNWZiYmYwMDQ1ZDhjNjYzYjJlOWFhNjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABduQ2G8AFqTU2NDYzNTg3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61", "committedDate": "2020-12-25T08:15:37Z", "message": "fix web-console show json bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzczMjE4", "url": "https://github.com/apache/druid/pull/10710#pullrequestreview-560773218", "createdAt": "2021-01-04T04:18:32Z", "commit": {"oid": "81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMDgwMTM3", "url": "https://github.com/apache/druid/pull/10710#pullrequestreview-563080137", "createdAt": "2021-01-06T22:26:14Z", "commit": {"oid": "81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQyMjoyNjoxNFrOIPYLZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQyMjoyNjoxNFrOIPYLZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjk5NTY4NA==", "bodyText": "This is cool but it would be better to use the stringify function that comes with json-bigint\nJust do import * as JSONBig from 'json-bigint-native';\nand then replace all JSON.stringify with JSONBig.stringify", "url": "https://github.com/apache/druid/pull/10710#discussion_r552995684", "createdAt": "2021-01-06T22:26:14Z", "author": {"login": "vogievetsky"}, "path": "web-console/src/components/show-json/show-json.tsx", "diffHunk": "@@ -41,7 +41,13 @@ export const ShowJson = React.memo(function ShowJson(props: ShowJsonProps) {\n       const resp = await Api.instance.get(endpoint);\n       let data = resp.data;\n       if (transform) data = transform(data);\n-      return typeof data === 'string' ? data : JSON.stringify(data, undefined, 2);\n+      return typeof data === 'string'\n+        ? data\n+        : JSON.stringify(\n+            data,\n+            (_, value) => (typeof value === 'bigint' ? value.toString() : value),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMDgwODg5", "url": "https://github.com/apache/druid/pull/10710#pullrequestreview-563080889", "createdAt": "2021-01-06T22:27:58Z", "commit": {"oid": "81b6eaeb0a7ea74af5fbbf0045d8c663b2e9aa61"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce8fa2cb30aacc280064d45cd10a4f9148cc3ef6", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/ce8fa2cb30aacc280064d45cd10a4f9148cc3ef6", "committedDate": "2021-01-07T06:28:13Z", "message": "replace all JSON.stringify"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0NjM1ODc5", "url": "https://github.com/apache/druid/pull/10710#pullrequestreview-564635879", "createdAt": "2021-01-08T22:55:20Z", "commit": {"oid": "ce8fa2cb30aacc280064d45cd10a4f9148cc3ef6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3224, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}