{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxODc5Njkw", "number": 10688, "title": "Historical unloads damaged segments automatically when lazy on start.", "bodyText": "Description\nThe feature mentioned in #6988 is very useful and can greatly improve the speed of historical node restart. But there are some potential risks due to push the loading work to query time.\nIf segment files like meta.smoosh or data.smoosh which Historical is served already are damaged, Historical with lazyOnStart enable can restart successfully but will not detect file corruption during restarting. When queries hit these damaged files, these queries will fail and will not expose which specific files are damaged like mentioned in #10608\nTests\nHere are the undamaged segment files.\n\nFirst case : meta.smoosh is damaged, for example\nRemove a line video_cro_network_name,0,997718245,1000412345 in that meta.smoosh file.\n\nRestart Historical node with lazy on start enable.\nSecond case : data.smoosh is damaged, for example\nDelete several bytes in that 00000.smoosh file randomly.\nRestart Historical node with lazy on start enable.\nIn all scenarios, Historical can restart successfully, but queries will failed.\n2020-11-26T10:56:14,031 INFO [DruidSchema-Cache-0] org.apache.druid.server.log.LoggingRequestLogger - 2020-11-26T10:56:14.026Z\t\t{\"queryType\":\"segmentMetadata\",\"dataSource\":{\"type\":\"table\",\"name\":\"traffic__ops_feed__realtime__second__dev__lazy__test\"},\"intervals\":{\"type\":\"segments\",\"segments\":[{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":0},{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":1},{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":2},{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":3},{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":4},{\"itvl\":\"2020-11-26T03:00:00.000Z/2020-11-26T04:00:00.000Z\",\"ver\":\"2020-11-26T03:30:17.710Z\",\"part\":5}]},\"toInclude\":{\"type\":\"all\"},\"merge\":false,\"context\":{\"queryId\":\"a022fbbf-d2fa-408b-bd21-698645c74f62\"},\"analysisTypes\":[],\"usingDefaultInterval\":false,\"lenientAggregatorMerge\":false,\"descending\":false,\"granularity\":{\"type\":\"all\"}}\t{\"query/time\":4,\"query/bytes\":-1,\"success\":false,\"identity\":\"allowAll\",\"exception\":\"java.lang.RuntimeException: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: (SequenceInputStream); line: -1, column: -1])\\n at [Source: (SequenceInputStream); line: -1, column: 8041]\"}\n2020-11-26T10:56:14,031 WARN [DruidSchema-Cache-0] org.apache.druid.sql.calcite.schema.DruidSchema - Metadata refresh failed, trying again soon.\njava.lang.RuntimeException: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: (SequenceInputStream); line: -1, column: -1])\n at [Source: (SequenceInputStream); line: -1, column: 8041]\n\tat org.apache.druid.client.JsonParserIterator.next(JsonParserIterator.java:119) ~[druid-server-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.BaseSequence.makeYielder(BaseSequence.java:90) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.BaseSequence.toYielder(BaseSequence.java:69) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.MappedSequence.toYielder(MappedSequence.java:49) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.ParallelMergeCombiningSequence$ResultBatch.fromSequence(ParallelMergeCombiningSequence.java:847) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.ParallelMergeCombiningSequence$SequenceBatcher.block(ParallelMergeCombiningSequence.java:897) ~[druid-core-0.17.1.jar:0.17.1]\n\tat java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3313) ~[?:1.8.0_221]\n\tat org.apache.druid.java.util.common.guava.ParallelMergeCombiningSequence$SequenceBatcher.getBatchYielder(ParallelMergeCombiningSequence.java:886) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.ParallelMergeCombiningSequence$YielderBatchedResultsCursor.initialize(ParallelMergeCombiningSequence.java:993) ~[druid-core-0.17.1.jar:0.17.1]\n\tat org.apache.druid.java.util.common.guava.ParallelMergeCombiningSequence$PrepareMergeCombineInputsAction.compute(ParallelMergeCombiningSequence.java:702) ~[druid-core-0.17.1.jar:0.17.1]\n\tat java.util.concurrent.RecursiveAction.exec(RecursiveAction.java:189) ~[?:1.8.0_221]\n\tat java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289) ~[?:1.8.0_221]\n\tat java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056) ~[?:1.8.0_221]\n\tat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692) ~[?:1.8.0_221]\n\tat java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157) ~[?:1.8.0_221]\nCaused by: com.fasterxml.jackson.core.io.JsonEOFException: Unexpected end-of-input: expected close marker for Array (start marker at [Source: (SequenceInputStream); line: -1, column: -1])\n at [Source: (SequenceInputStream); line: -1, column: 8041]\n\tat com.fasterxml.jackson.core.base.ParserMinimalBase._reportInvalidEOF(ParserMinimalBase.java:664) ~[jackson-core-2.10.1.jar:2.10.1]\n\tat com.fasterxml.jackson.dataformat.smile.SmileParserBase._handleEOF(SmileParserBase.java:746) ~[jackson-dataformat-smile-2.10.1.jar:2.10.1]\n\tat com.fasterxml.jackson.dataformat.smile.SmileParser._eofAsNextToken(SmileParser.java:2691) ~[jackson-dataformat-smile-2.10.1.jar:2.10.1]\n\tat com.fasterxml.jackson.dataformat.smile.SmileParser.nextToken(SmileParser.java:378) ~[jackson-dataformat-smile-2.10.1.jar:2.10.1]\n\tat org.apache.druid.client.JsonParserIterator.next(JsonParserIterator.java:115) ~[druid-server-0.17.1.jar:0.17.1]\n\t... 14 more\n\nSolution\nThis PR make Historical with lazy on start have the ability that:\nFailed queries caused by damaged segment files will trigger unload action automatically. After the unload, the coordinator will ask another historical to load this segment.\nThrough this PR, the system heals itself and the administrator need to do nothing.\n\nThis PR has:\n\n been self-reviewed.\n\n using the concurrency checklist (Remove this item if the PR doesn't have any relation to concurrency.)\n\n\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added or updated version, license, or notice information in licenses.yaml\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n added integration tests.\n been tested in a test Druid cluster.\n\n\n\nKey changed/added classes in this PR\n\nIndexIO.java", "createdAt": "2020-12-17T13:51:34Z", "url": "https://github.com/apache/druid/pull/10688", "merged": true, "mergeCommit": {"oid": "2590ad4f67fab99760eb4562d84b34e8aa55f6c1"}, "closed": true, "closedAt": "2021-01-17T03:53:31Z", "author": {"login": "zhangyue19921010"}, "timelineItems": {"totalCount": 43, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdtCmQ_AH2gAyNTQxODc5NjkwOjBhNmViMzA4ZjVmM2MwMTA5OWY2Y2Y1NDBkZDY3ZWFhY2M0Zjg1ZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdw55PvgFqTU2OTk4NDQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0a6eb308f5f3c01099f6cf540dd67eaacc4f85ed", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/0a6eb308f5f3c01099f6cf540dd67eaacc4f85ed", "committedDate": "2021-01-05T03:45:26Z", "message": "ready to test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c3e69770ccfed29ac0e5d77fbd3fa6495493da5", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/4c3e69770ccfed29ac0e5d77fbd3fa6495493da5", "committedDate": "2021-01-05T03:47:57Z", "message": "tested on dev cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/7775658a57209265762bc41e30b90d7774a3e362", "committedDate": "2021-01-05T04:38:27Z", "message": "tested"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/7775658a57209265762bc41e30b90d7774a3e362", "committedDate": "2021-01-05T04:38:27Z", "message": "tested"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzU1MTA3", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-562355107", "createdAt": "2021-01-06T06:34:48Z", "commit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNjozNDo0OFrOIOzhqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNjo0MTowNFrOIOzpAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NTE3OQ==", "bodyText": "Use a more meaningful name, like SegmentLazyLoadFailCallback", "url": "https://github.com/apache/druid/pull/10688#discussion_r552395179", "createdAt": "2021-01-06T06:34:48Z", "author": {"login": "kaijianding"}, "path": "core/src/main/java/org/apache/druid/coordination/CommonCallback.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.coordination;\n+\n+public interface CommonCallback", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NTU0MA==", "bodyText": "add blank line here", "url": "https://github.com/apache/druid/pull/10688#discussion_r552395540", "createdAt": "2021-01-06T06:36:02Z", "author": {"login": "kaijianding"}, "path": "processing/src/main/java/org/apache/druid/segment/IndexIO.java", "diffHunk": "@@ -182,16 +183,16 @@ public void validateTwoSegments(final IndexableAdapter adapter1, final Indexable\n \n   public QueryableIndex loadIndex(File inDir) throws IOException\n   {\n-    return loadIndex(inDir, false);\n+    return loadIndex(inDir, false, CommonCallback.NOOP);\n   }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NzA1OQ==", "bodyText": "why RuntimeException here?", "url": "https://github.com/apache/druid/pull/10688#discussion_r552397059", "createdAt": "2021-01-06T06:41:04Z", "author": {"login": "kaijianding"}, "path": "processing/src/main/java/org/apache/druid/segment/IndexIO.java", "diffHunk": "@@ -644,7 +649,7 @@ public QueryableIndex load(File inDir, ObjectMapper mapper, boolean lazy) throws\n     }\n \n     private ColumnHolder deserializeColumn(ObjectMapper mapper, ByteBuffer byteBuffer, SmooshedFileMapper smooshedFiles)\n-        throws IOException\n+        throws IOException, RuntimeException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzY2MDkz", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-562366093", "createdAt": "2021-01-06T07:05:14Z", "commit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzowNToxNFrOIO0EaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzowNToxNFrOIO0EaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQwNDA3Mw==", "bodyText": "I guess this interface should be in org.apache.druid.segment, beside the IndexIO", "url": "https://github.com/apache/druid/pull/10688#discussion_r552404073", "createdAt": "2021-01-06T07:05:14Z", "author": {"login": "kaijianding"}, "path": "core/src/main/java/org/apache/druid/coordination/CommonCallback.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.coordination;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzcwNjQ4", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-562370648", "createdAt": "2021-01-06T07:17:38Z", "commit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzoxNzozOVrOIO0SXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzoxNzozOVrOIO0SXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQwNzY0Ng==", "bodyText": "why not just use Runnable? There is even a Runnables.getNoopRunnable()", "url": "https://github.com/apache/druid/pull/10688#discussion_r552407646", "createdAt": "2021-01-06T07:17:39Z", "author": {"login": "clintropolis"}, "path": "core/src/main/java/org/apache/druid/coordination/CommonCallback.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.coordination;\n+\n+public interface CommonCallback", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMzc0MzAx", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-562374301", "createdAt": "2021-01-06T07:26:52Z", "commit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzoyNjo1MlrOIO0eiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNzoyNjo1MlrOIO0eiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQxMDc2Mw==", "bodyText": "add a new @param in the method comment", "url": "https://github.com/apache/druid/pull/10688#discussion_r552410763", "createdAt": "2021-01-06T07:26:52Z", "author": {"login": "kaijianding"}, "path": "server/src/main/java/org/apache/druid/server/SegmentManager.java", "diffHunk": "@@ -219,9 +220,9 @@ private TableDataSource getTableDataSource(DataSourceAnalysis analysis)\n    *\n    * @throws SegmentLoadingException if the segment cannot be loaded\n    */\n-  public boolean loadSegment(final DataSegment segment, boolean lazy) throws SegmentLoadingException\n+  public boolean loadSegment(final DataSegment segment, boolean lazy, CommonCallback loadFailed) throws SegmentLoadingException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7775658a57209265762bc41e30b90d7774a3e362"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b9595e5ebe3b67ae0795402a1c799a69d7a821f", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/6b9595e5ebe3b67ae0795402a1c799a69d7a821f", "committedDate": "2021-01-07T02:26:04Z", "message": "code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff6deb5a1c99f725902e0655efbdfbbdfc3b6c5e", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/ff6deb5a1c99f725902e0655efbdfbbdfc3b6c5e", "committedDate": "2021-01-07T03:40:41Z", "message": "add UTs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fefdff30f57c621a9dead0ecb1b68b0453b7c69", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/9fefdff30f57c621a9dead0ecb1b68b0453b7c69", "committedDate": "2021-01-07T03:53:07Z", "message": "add UTs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13710d9d2eb46d57a8fb4ec920706303024bd33e", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/13710d9d2eb46d57a8fb4ec920706303024bd33e", "committedDate": "2021-01-07T06:36:39Z", "message": "ut passed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f67b334ad9a0a6d9e46855a4505e8c0fda6cf13b", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/f67b334ad9a0a6d9e46855a4505e8c0fda6cf13b", "committedDate": "2021-01-07T06:37:45Z", "message": "ut passed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dd33e2571f913c7c1b4dcb8d36dbf4f2c209389", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/7dd33e2571f913c7c1b4dcb8d36dbf4f2c209389", "committedDate": "2021-01-07T07:04:35Z", "message": "opti imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd4fd45a0a1a24acec5e91696c97f99173b76321", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/dd4fd45a0a1a24acec5e91696c97f99173b76321", "committedDate": "2021-01-07T07:51:02Z", "message": "Merge branch 'master' into historical-lazyOnStart-with-fileCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eac89198e4079772fa56d100b18ba4b8aa964e93", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/eac89198e4079772fa56d100b18ba4b8aa964e93", "committedDate": "2021-01-07T08:10:30Z", "message": "done"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1eca76b4ae50733b9d922c4a94c356d18d51201", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/e1eca76b4ae50733b9d922c4a94c356d18d51201", "committedDate": "2021-01-07T08:39:46Z", "message": "done"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d567da3d1a493d63fac36705a371cb9742dc0da", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/3d567da3d1a493d63fac36705a371cb9742dc0da", "committedDate": "2021-01-08T02:40:11Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34f98f024e7a0cc02f9e187e919d8b1886cffc38", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/34f98f024e7a0cc02f9e187e919d8b1886cffc38", "committedDate": "2021-01-08T03:01:33Z", "message": "Merge branch 'master' into historical-lazyOnStart-with-fileCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b82e6c64ded714a0285afac83876e1d4827edaf", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/6b82e6c64ded714a0285afac83876e1d4827edaf", "committedDate": "2021-01-08T04:22:01Z", "message": "modify uts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5737724fa8e9fb8e88a716d30ba610a62527169", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/c5737724fa8e9fb8e88a716d30ba610a62527169", "committedDate": "2021-01-09T00:29:08Z", "message": "Merge branch 'master' into historical-lazyOnStart-with-fileCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f113ed3e803b1bc8e110190b86bf7362a1844c69", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/f113ed3e803b1bc8e110190b86bf7362a1844c69", "committedDate": "2021-01-09T11:50:27Z", "message": "modify logs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1OTAxMjg5", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-565901289", "createdAt": "2021-01-12T02:55:59Z", "commit": {"oid": "f113ed3e803b1bc8e110190b86bf7362a1844c69"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwMjo1NTo1OVrOIRvuLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQwMjo1NTo1OVrOIRvuLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTQ3ODU3NQ==", "bodyText": "I suggest this interface should be in org.apache.druid.segment, beside the IndexIO", "url": "https://github.com/apache/druid/pull/10688#discussion_r555478575", "createdAt": "2021-01-12T02:55:59Z", "author": {"login": "kaijianding"}, "path": "processing/src/main/java/org/apache/druid/segment/coordination/SegmentLazyLoadFailCallback.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.segment.coordination;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f113ed3e803b1bc8e110190b86bf7362a1844c69"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bfca47513fad5274ec0c9578291622e1b8ed2c3", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/5bfca47513fad5274ec0c9578291622e1b8ed2c3", "committedDate": "2021-01-12T03:27:19Z", "message": "changing the package of SegmentLazyLoadFailCallback.java to org.apache.druid.segment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6284c5f26614810289331d74e41a625c955de8f8", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/6284c5f26614810289331d74e41a625c955de8f8", "committedDate": "2021-01-12T03:29:39Z", "message": "Merge branch 'master' into historical-lazyOnStart-with-fileCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d9115a568b8e98a407362cac1f6cca7644d1e8", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/c7d9115a568b8e98a407362cac1f6cca7644d1e8", "committedDate": "2021-01-12T03:48:28Z", "message": "merge from master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba5dd23355f5aad070743702a5ad501c068a2e72", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/ba5dd23355f5aad070743702a5ad501c068a2e72", "committedDate": "2021-01-12T08:54:34Z", "message": "modify import orders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c892323446b07a33284a983f86094e8f7902b32", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/5c892323446b07a33284a983f86094e8f7902b32", "committedDate": "2021-01-12T09:07:53Z", "message": "merge from master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7714f81bfcf21bf0c581a2b1135a9c27a0f82b07", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/7714f81bfcf21bf0c581a2b1135a9c27a0f82b07", "committedDate": "2021-01-12T09:17:31Z", "message": "merge from master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65f17df837e066379b2ef0f1d4c8465aecf35875", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/65f17df837e066379b2ef0f1d4c8465aecf35875", "committedDate": "2021-01-12T14:25:25Z", "message": "modify logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd46d753abd1d5417d55566b9d88aea62aa819de", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/dd46d753abd1d5417d55566b9d88aea62aa819de", "committedDate": "2021-01-12T16:30:26Z", "message": "modify docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15a4c3e8770acb1a992114d7121de8f6f0b89ed8", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/15a4c3e8770acb1a992114d7121de8f6f0b89ed8", "committedDate": "2021-01-12T19:58:21Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80accce200c0c9bf555f644ee88eafd82225e983", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/80accce200c0c9bf555f644ee88eafd82225e983", "committedDate": "2021-01-12T21:23:57Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78f5ff3d836c8e66ee1c2b7313710a8eaf7e8290", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/78f5ff3d836c8e66ee1c2b7313710a8eaf7e8290", "committedDate": "2021-01-13T03:43:12Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dec7bd5130d2c244c83ad8fbf15faafaa7357e3", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/9dec7bd5130d2c244c83ad8fbf15faafaa7357e3", "committedDate": "2021-01-13T10:33:23Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bb59ce5a3ddacffc68cad659a12e5fc9735c599", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/6bb59ce5a3ddacffc68cad659a12e5fc9735c599", "committedDate": "2021-01-13T16:23:25Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5aa6102aac6cb8d6399962c819bebe21666cf1d", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/b5aa6102aac6cb8d6399962c819bebe21666cf1d", "committedDate": "2021-01-13T23:48:39Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3ODI1NzU5", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-567825759", "createdAt": "2021-01-14T03:24:16Z", "commit": {"oid": "b5aa6102aac6cb8d6399962c819bebe21666cf1d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fdbc257c1c8f59260fc71a749ee9f3c0e1e8d0f", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/4fdbc257c1c8f59260fc71a749ee9f3c0e1e8d0f", "committedDate": "2021-01-14T08:06:56Z", "message": "Merge branch 'master' into historical-lazyOnStart-with-fileCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a510bee83be87f85720d87c51ed82755d52b7d25", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/a510bee83be87f85720d87c51ed82755d52b7d25", "committedDate": "2021-01-14T23:56:01Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fef72a7ad29c1a0937b7cc45f8f706c7e546b62a", "author": {"user": null}, "url": "https://github.com/apache/druid/commit/fef72a7ad29c1a0937b7cc45f8f706c7e546b62a", "committedDate": "2021-01-15T01:50:33Z", "message": "modify logs to rerun ci"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY4ODc3NDEz", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-568877413", "createdAt": "2021-01-15T06:09:04Z", "commit": {"oid": "fef72a7ad29c1a0937b7cc45f8f706c7e546b62a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQwNjowOTowNFrOIUCanQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQwNjowOTowNFrOIUCanQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Nzg4MjAxMw==", "bodyText": "what is this change for?", "url": "https://github.com/apache/druid/pull/10688#discussion_r557882013", "createdAt": "2021-01-15T06:09:04Z", "author": {"login": "clintropolis"}, "path": ".travis.yml", "diffHunk": "@@ -154,7 +154,7 @@ jobs:\n         # Set MAVEN_OPTS for Surefire launcher. Skip remoteresources to avoid intermittent connection timeouts when\n         # resolving the SIGAR dependency.\n         - >\n-          MAVEN_OPTS='-Xmx800m' ${MVN} test -pl ${MAVEN_PROJECTS}\n+          MAVEN_OPTS='-Xmx1100m' ${MVN} test -pl ${MAVEN_PROJECTS}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fef72a7ad29c1a0937b7cc45f8f706c7e546b62a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY5OTg0NDM5", "url": "https://github.com/apache/druid/pull/10688#pullrequestreview-569984439", "createdAt": "2021-01-17T03:52:44Z", "commit": {"oid": "fef72a7ad29c1a0937b7cc45f8f706c7e546b62a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3203, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}