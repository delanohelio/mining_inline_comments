{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2ODIwOTEz", "number": 9375, "title": "Add support for optional aws credentials for s3 for ingestion", "bodyText": "Add support for optional cloud (aws, gcs, etc.) credentials for s3 for ingestion\nDescription\nCloud InputSource (such as S3, etc.) should be able to support taking in credentials optionally in order to be able to read from multiple buckets/location. This is in order to use different credentials than the default (i.e. the one provided in the common runtime property) and also to be able to use different credentials for each ingestion.\nMotivation:\nThis address the proposal #9305\nThis PR has:\n\n been self-reviewed.\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added or updated version, license, or notice information in licenses.yaml\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths.\n added integration tests.\n been tested in a test Druid cluster.", "createdAt": "2020-02-18T20:31:53Z", "url": "https://github.com/apache/druid/pull/9375", "merged": true, "mergeCommit": {"oid": "92fb83726b0275cb936fbed21a183c81b55df419"}, "closed": true, "closedAt": "2020-02-26T04:59:54Z", "author": {"login": "maytasm"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDYQOfAH2gAyMzc2ODIwOTEzOjdjNjBiOGU4OGZkZWU5M2U4NWM1YzU4OGQzZTA2MWY1NTc1NWFkZjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcH8XVygFqTM2NDU2NjcxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c60b8e88fdee93e85c5c588d3e061f55755adf0", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/7c60b8e88fdee93e85c5c588d3e061f55755adf0", "committedDate": "2020-02-11T21:03:18Z", "message": "Add support for optional cloud (aws, gcs, etc.) credentials for s3 for ingestion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30c24343b60d825dabf86037d15ceade78e32882", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/30c24343b60d825dabf86037d15ceade78e32882", "committedDate": "2020-02-18T20:30:23Z", "message": "Add support for optional cloud (aws, gcs, etc.) credentials for s3 for ingestion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "501dc4b565ba890587d2605baefe5b509747b8c1", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/501dc4b565ba890587d2605baefe5b509747b8c1", "committedDate": "2020-02-19T01:13:52Z", "message": "Add support for optional cloud (aws, gcs, etc.) credentials for s3 for ingestion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "111fa05a6aa56e3600893c1c317db67bb6d7e8c9", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/111fa05a6aa56e3600893c1c317db67bb6d7e8c9", "committedDate": "2020-02-19T18:59:22Z", "message": "Merge remote-tracking branch 'upstream/master' into IMPLY-1582"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc6b252535e79c5b6b17e84f3466323b74d61ae3", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/dc6b252535e79c5b6b17e84f3466323b74d61ae3", "committedDate": "2020-02-19T19:21:34Z", "message": "fix build failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a216b4a6e9e19573fea6363ac12dfb2f35135a7", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/8a216b4a6e9e19573fea6363ac12dfb2f35135a7", "committedDate": "2020-02-19T20:24:53Z", "message": "fix failing build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13a9181730043e4d3d466510b4938be450321b45", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/13a9181730043e4d3d466510b4938be450321b45", "committedDate": "2020-02-19T21:19:55Z", "message": "fix failing build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f83962931718f222f4b96ff84cb077591827708", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/5f83962931718f222f4b96ff84cb077591827708", "committedDate": "2020-02-19T23:00:51Z", "message": "Code cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/960fcaa0e15b23291a77ae23631240fd0bcaefe8", "committedDate": "2020-02-20T02:30:45Z", "message": "fix failing test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNjExMzEx", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-361611311", "createdAt": "2020-02-20T03:24:30Z", "commit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMzoyNDozMFrOFsBrkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMzoyNDozMFrOFsBrkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTcwOTIwMg==", "bodyText": "This should probably be added to https://druid.apache.org/docs/latest/ingestion/native-batch.html#s3-input-source. Similar comment for the other modified input sources.", "url": "https://github.com/apache/druid/pull/9375#discussion_r381709202", "createdAt": "2020-02-20T03:24:30Z", "author": {"login": "ccaominh"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -46,13 +51,25 @@\n   @JsonCreator\n   public S3InputSource(\n       @JacksonInject ServerSideEncryptingAmazonS3 s3Client,\n+      @JacksonInject AmazonS3ClientBuilder amazonS3ClientBuilder,\n+      @JacksonInject S3StorageConfig storageConfig,\n       @JsonProperty(\"uris\") @Nullable List<URI> uris,\n       @JsonProperty(\"prefixes\") @Nullable List<URI> prefixes,\n-      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects\n+      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects,\n+      @JsonProperty(\"properties\") @Nullable CloudConfigProperties cloudConfigProperties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTU2NjA2", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-362156606", "createdAt": "2020-02-20T19:04:15Z", "commit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOTowNDoxNlrOFsffiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOTowNDoxNlrOFsffiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE5NzY0MA==", "bodyText": "Do we want to support Azure with this too? If so Azure is a bit different; requires an account id, and secret key. Can this be extended for that easily?", "url": "https://github.com/apache/druid/pull/9375#discussion_r382197640", "createdAt": "2020-02-20T19:04:16Z", "author": {"login": "zachjsh"}, "path": "core/src/main/java/org/apache/druid/data/input/impl/CloudConfigProperties.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.data.input.impl;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.google.common.base.Preconditions;\n+import org.apache.druid.metadata.PasswordProvider;\n+\n+import javax.annotation.Nullable;\n+import java.util.Objects;\n+\n+public class CloudConfigProperties\n+{\n+  @JsonCreator\n+  public CloudConfigProperties(\n+      @JsonProperty(\"accessKeyId\") @Nullable PasswordProvider accessKeyId,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMjYzNjcx", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-362263671", "createdAt": "2020-02-20T21:57:48Z", "commit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMTo1Nzo0OVrOFskj_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMTo1ODo1NFrOFskl9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI4MDcwMw==", "bodyText": "I wonder if this class is too synthetic, and instead should not be a shared base type, and rather be input source specific. Like I imagine it could be useful in the future to support additional properties, but beyond the 'username' and 'password' model that is common to all clouds, further stuff probably starts to get really cloud specific and probably not a lot of benefit being down here.\nIt might be better if in this PR you would add a S3InputSourceConfig or whatever directly to S3InputSource and not pass it down to the base type, since it doesn't actually seem to be of any use there, and also not modify azure and google cloud since they can add their own specific implementations when support is added for credentials override there (and use their own terminology for username/password). @maytasm3 / @jihoonson what do you think?", "url": "https://github.com/apache/druid/pull/9375#discussion_r382280703", "createdAt": "2020-02-20T21:57:49Z", "author": {"login": "clintropolis"}, "path": "core/src/main/java/org/apache/druid/data/input/impl/CloudConfigProperties.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.data.input.impl;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.google.common.base.Preconditions;\n+import org.apache.druid.metadata.PasswordProvider;\n+\n+import javax.annotation.Nullable;\n+import java.util.Objects;\n+\n+public class CloudConfigProperties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjI4MTIwNQ==", "bodyText": "I don't think the other docs should be modified yet, only s3, since the others are not wired up to anything there like it is in S3InputSource.", "url": "https://github.com/apache/druid/pull/9375#discussion_r382281205", "createdAt": "2020-02-20T21:58:54Z", "author": {"login": "clintropolis"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -46,13 +51,25 @@\n   @JsonCreator\n   public S3InputSource(\n       @JacksonInject ServerSideEncryptingAmazonS3 s3Client,\n+      @JacksonInject AmazonS3ClientBuilder amazonS3ClientBuilder,\n+      @JacksonInject S3StorageConfig storageConfig,\n       @JsonProperty(\"uris\") @Nullable List<URI> uris,\n       @JsonProperty(\"prefixes\") @Nullable List<URI> prefixes,\n-      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects\n+      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects,\n+      @JsonProperty(\"properties\") @Nullable CloudConfigProperties cloudConfigProperties", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTcwOTIwMg=="}, "originalCommit": {"oid": "960fcaa0e15b23291a77ae23631240fd0bcaefe8"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3a6216c9581134d6910ab951d93cb6d533b52c0", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/f3a6216c9581134d6910ab951d93cb6d533b52c0", "committedDate": "2020-02-24T04:52:24Z", "message": "Removed CloudConfigProperties and make specific class for each cloudInputSource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b585dd533af8d4894667c0245fee4f04dfdfabd", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/2b585dd533af8d4894667c0245fee4f04dfdfabd", "committedDate": "2020-02-24T05:00:40Z", "message": "Removed CloudConfigProperties and make specific class for each cloudInputSource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "234dc14dbd5cdb8ec2540e7f3ce9119732da13a8", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/234dc14dbd5cdb8ec2540e7f3ce9119732da13a8", "committedDate": "2020-02-24T05:09:49Z", "message": "pass s3ConfigProperties for split"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc1f1082018e476953fc19332f14539b03488862", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/dc1f1082018e476953fc19332f14539b03488862", "committedDate": "2020-02-24T06:26:04Z", "message": "lazy init s3client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e01443b092578953a90e500a9227c1e1ac7348c", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/1e01443b092578953a90e500a9227c1e1ac7348c", "committedDate": "2020-02-24T08:13:47Z", "message": "update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad62c83efbc7ddb4bbaa52a10edd74568a137ad3", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/ad62c83efbc7ddb4bbaa52a10edd74568a137ad3", "committedDate": "2020-02-24T08:46:14Z", "message": "fix merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/64d2720829fbc7ed32a40afb3bbd36e9920370fe", "committedDate": "2020-02-24T18:44:05Z", "message": "fix docs check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNjk1Njc3", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-363695677", "createdAt": "2020-02-24T20:58:18Z", "commit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMDo1ODoxOFrOFtvnJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMToxNzoyMlrOFtwKnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUxMDMwOQ==", "bodyText": "This should live in the s3 extension, not in druid-core", "url": "https://github.com/apache/druid/pull/9375#discussion_r383510309", "createdAt": "2020-02-24T20:58:18Z", "author": {"login": "clintropolis"}, "path": "core/src/main/java/org/apache/druid/data/input/impl/S3ConfigProperties.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.data.input.impl;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.google.common.base.Preconditions;\n+import org.apache.druid.metadata.PasswordProvider;\n+\n+import javax.annotation.Nullable;\n+import java.util.Objects;\n+\n+/**\n+ * Contains properties for s3 access configuration.\n+ * Properties can be specified by ingestionSpec and override system default.\n+ */\n+public class S3ConfigProperties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUxMDk2Mg==", "bodyText": "nit: formatting looks sort of funny here to me, unfortunately i think this is one of the few things style checks don't catch", "url": "https://github.com/apache/druid/pull/9375#discussion_r383510962", "createdAt": "2020-02-24T20:59:43Z", "author": {"login": "clintropolis"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -76,7 +114,41 @@ protected S3Entity createEntity(InputSplit<CloudObjectLocation> split)\n   @Override\n   public SplittableInputSource<CloudObjectLocation> withSplit(InputSplit<CloudObjectLocation> split)\n   {\n-    return new S3InputSource(s3Client, inputDataConfig, null, null, ImmutableList.of(split.get()));\n+    return new S3InputSource(\n+        s3Client.get(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUxMTE4Mg==", "bodyText": "nit: this could be one line", "url": "https://github.com/apache/druid/pull/9375#discussion_r383511182", "createdAt": "2020-02-24T21:00:15Z", "author": {"login": "clintropolis"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -76,7 +114,41 @@ protected S3Entity createEntity(InputSplit<CloudObjectLocation> split)\n   @Override\n   public SplittableInputSource<CloudObjectLocation> withSplit(InputSplit<CloudObjectLocation> split)\n   {\n-    return new S3InputSource(s3Client, inputDataConfig, null, null, ImmutableList.of(split.get()));\n+    return new S3InputSource(\n+        s3Client.get(),\n+       null,\n+       null,\n+        inputDataConfig,\n+       null,\n+       null,\n+       ImmutableList.of(split.get()),\n+       getS3ConfigProperties()\n+    );\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Objects.hash(\n+        super.hashCode(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUxNzI3OQ==", "bodyText": "hmm, should the check that one of s3Client or amazonS3ClientBuilder and storageConfig  are not null be done eagerly instead of in the supplier? (i'm not certain either way, just thinking out loud)", "url": "https://github.com/apache/druid/pull/9375#discussion_r383517279", "createdAt": "2020-02-24T21:13:08Z", "author": {"login": "clintropolis"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -19,50 +19,88 @@\n \n package org.apache.druid.data.input.s3;\n \n+import com.amazonaws.auth.AWSStaticCredentialsProvider;\n+import com.amazonaws.auth.BasicAWSCredentials;\n+import com.amazonaws.services.s3.AmazonS3ClientBuilder;\n import com.amazonaws.services.s3.model.S3ObjectSummary;\n import com.fasterxml.jackson.annotation.JacksonInject;\n import com.fasterxml.jackson.annotation.JsonCreator;\n import com.fasterxml.jackson.annotation.JsonProperty;\n import com.google.common.base.Preconditions;\n+import com.google.common.base.Supplier;\n+import com.google.common.base.Suppliers;\n import com.google.common.collect.ImmutableList;\n import org.apache.druid.data.input.InputSplit;\n import org.apache.druid.data.input.impl.CloudObjectInputSource;\n import org.apache.druid.data.input.impl.CloudObjectLocation;\n+import org.apache.druid.data.input.impl.S3ConfigProperties;\n import org.apache.druid.data.input.impl.SplittableInputSource;\n import org.apache.druid.storage.s3.S3InputDataConfig;\n+import org.apache.druid.storage.s3.S3StorageConfig;\n import org.apache.druid.storage.s3.S3StorageDruidModule;\n import org.apache.druid.storage.s3.S3Utils;\n import org.apache.druid.storage.s3.ServerSideEncryptingAmazonS3;\n \n import javax.annotation.Nullable;\n import java.net.URI;\n import java.util.List;\n+import java.util.Objects;\n import java.util.stream.Stream;\n import java.util.stream.StreamSupport;\n \n public class S3InputSource extends CloudObjectInputSource<S3Entity>\n {\n-  private final ServerSideEncryptingAmazonS3 s3Client;\n+  // We lazily initialize s3Client to avoid costly s3 operation when we only need S3InputSource for stored information\n+  // (such as for task logs) and not for ingestion. (This cost only applies for new s3Client created with\n+  // s3ConfigProperties given).\n+  private final Supplier<ServerSideEncryptingAmazonS3> s3Client;\n+  @JsonProperty(\"properties\")\n+  private final S3ConfigProperties s3ConfigProperties;\n   private final S3InputDataConfig inputDataConfig;\n \n   @JsonCreator\n   public S3InputSource(\n       @JacksonInject ServerSideEncryptingAmazonS3 s3Client,\n+      @JacksonInject AmazonS3ClientBuilder amazonS3ClientBuilder,\n+      @JacksonInject S3StorageConfig storageConfig,\n       @JacksonInject S3InputDataConfig inputDataConfig,\n       @JsonProperty(\"uris\") @Nullable List<URI> uris,\n       @JsonProperty(\"prefixes\") @Nullable List<URI> prefixes,\n-      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects\n+      @JsonProperty(\"objects\") @Nullable List<CloudObjectLocation> objects,\n+      @JsonProperty(\"properties\") @Nullable S3ConfigProperties s3ConfigProperties\n   )\n   {\n     super(S3StorageDruidModule.SCHEME, uris, prefixes, objects);\n-    this.s3Client = Preconditions.checkNotNull(s3Client, \"s3Client\");\n     this.inputDataConfig = Preconditions.checkNotNull(inputDataConfig, \"S3DataSegmentPusherConfig\");\n+    this.s3ConfigProperties = s3ConfigProperties;\n+    this.s3Client = Suppliers.memoize(\n+        () -> {\n+          if (amazonS3ClientBuilder != null && storageConfig != null && s3ConfigProperties != null) {\n+            if (s3ConfigProperties.isCredentialsConfigured()) {\n+              BasicAWSCredentials creds = new BasicAWSCredentials(\n+                  s3ConfigProperties.getAccessKeyId().getPassword(),\n+                  s3ConfigProperties.getSecretAccessKey().getPassword());\n+              amazonS3ClientBuilder.withCredentials(new AWSStaticCredentialsProvider(creds));\n+            }\n+            return new ServerSideEncryptingAmazonS3(amazonS3ClientBuilder.build(), storageConfig.getServerSideEncryption());\n+          } else {\n+            return Preconditions.checkNotNull(s3Client, \"s3Client\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUxOTM4OA==", "bodyText": "I think these can just be shortened to S3 access key and S3 secret key", "url": "https://github.com/apache/druid/pull/9375#discussion_r383519388", "createdAt": "2020-02-24T21:17:22Z", "author": {"login": "clintropolis"}, "path": "docs/ingestion/native-batch.md", "diffHunk": "@@ -846,6 +847,15 @@ S3 Object:\n |bucket|Name of the S3 bucket|None|yes|\n |path|The path where data is located.|None|yes|\n \n+Properties Object:\n+\n+|property|description|default|required?|\n+|--------|-----------|-------|---------|\n+|accessKeyId|S3 access key for this S3 InputSource|None|yes if secretAccessKey is given|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNzE0NzY5", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-363714769", "createdAt": "2020-02-24T21:30:19Z", "commit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMTozMDoyMFrOFtwj7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMTo1MDoyNVrOFtxKMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUyNTg2OA==", "bodyText": "Not your change but..\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To connect to your S3 bucket (whether deep storage bucket or source bucket), Druid use the following credentials providers chain\n          \n          \n            \n            Druid uses the following credentials provider chain to connect to your S3 bucket (whether a deep storage bucket or source bucket).", "url": "https://github.com/apache/druid/pull/9375#discussion_r383525868", "createdAt": "2020-02-24T21:30:20Z", "author": {"login": "sthetland"}, "path": "docs/development/extensions-core/s3.md", "diffHunk": "@@ -64,6 +64,7 @@ In addition to this you need to set additional configuration, specific for [deep\n ### S3 authentication methods\n \n To connect to your S3 bucket (whether deep storage bucket or source bucket), Druid use the following credentials providers chain", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUzMDgyMw==", "bodyText": "I think the doc normally uses a carrot to format note-style paragraphs, like the ones on https://druid.apache.org/docs/latest/tutorials/cluster.html#with-zookeeper-on-master for example.\nI'd use that style, or this could just be a regular second sentence in the paragraph. In either case, I'd rephrase a bit:\n\nYou can override the default credentials provider chain by specifying an access key using Properties Object parameters in the ingestionSpec.", "url": "https://github.com/apache/druid/pull/9375#discussion_r383530823", "createdAt": "2020-02-24T21:40:43Z", "author": {"login": "sthetland"}, "path": "docs/development/extensions-core/s3.md", "diffHunk": "@@ -64,6 +64,7 @@ In addition to this you need to set additional configuration, specific for [deep\n ### S3 authentication methods\n \n To connect to your S3 bucket (whether deep storage bucket or source bucket), Druid use the following credentials providers chain\n+**Note :** *Below authentication chain can be overridden for connecting to source bucket by specifying the [properties](../../ingestion/native-batch.md#s3-input-source) parameter in the ingestionSpec.*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUzMjQzNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |properties|Properties Object for overriding default S3 configuration. See below for more information.|None|No (Default configurations will be use if not given)\n          \n          \n            \n            |properties|Properties Object for overriding the default S3 configuration. See below for more information.|None|No (defaults will be used if not given)", "url": "https://github.com/apache/druid/pull/9375#discussion_r383532435", "createdAt": "2020-02-24T21:43:55Z", "author": {"login": "sthetland"}, "path": "docs/ingestion/native-batch.md", "diffHunk": "@@ -838,6 +838,7 @@ Sample specs:\n |uris|JSON array of URIs where S3 objects to be ingested are located.|None|`uris` or `prefixes` or `objects` must be set|\n |prefixes|JSON array of URI prefixes for the locations of S3 objects to be ingested.|None|`uris` or `prefixes` or `objects` must be set|\n |objects|JSON array of S3 Objects to be ingested.|None|`uris` or `prefixes` or `objects` must be set|\n+|properties|Properties Object for overriding default S3 configuration. See below for more information.|None|No (Default configurations will be use if not given)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUzNTY2NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            **Note :** *If any property is not given in the Properties Object, then the current default server value will be use.*\n          \n          \n            \n            Default values are used for any property not overridden in the Properties Object.\n          \n      \n    \n    \n  \n\nCaveat to my edit suggestion: it says \"any property\" but really it's just S3 access key that are supported, no? To avoid the premature generalization, could say something like:\n\"If you don't provide an access key, the default S3 credentials provider chain is used.\" (With a link to the relevant section in s3.md).", "url": "https://github.com/apache/druid/pull/9375#discussion_r383535664", "createdAt": "2020-02-24T21:50:25Z", "author": {"login": "sthetland"}, "path": "docs/ingestion/native-batch.md", "diffHunk": "@@ -846,6 +847,15 @@ S3 Object:\n |bucket|Name of the S3 bucket|None|yes|\n |path|The path where data is located.|None|yes|\n \n+Properties Object:\n+\n+|property|description|default|required?|\n+|--------|-----------|-------|---------|\n+|accessKeyId|S3 access key for this S3 InputSource|None|yes if secretAccessKey is given|\n+|secretAccessKey|S3 secret key for this S3 InputSource|None|yes if accessKeyId is given|\n+\n+**Note :** *If any property is not given in the Properties Object, then the current default server value will be use.*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNzMwNTA3", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-363730507", "createdAt": "2020-02-24T21:57:03Z", "commit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMTo1NzowM1rOFtxW7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQyMTo1NzowM1rOFtxW7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzUzODkyNw==", "bodyText": "nit: suggest s3ClientSupplier.", "url": "https://github.com/apache/druid/pull/9375#discussion_r383538927", "createdAt": "2020-02-24T21:57:03Z", "author": {"login": "jihoonson"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -19,50 +19,88 @@\n \n package org.apache.druid.data.input.s3;\n \n+import com.amazonaws.auth.AWSStaticCredentialsProvider;\n+import com.amazonaws.auth.BasicAWSCredentials;\n+import com.amazonaws.services.s3.AmazonS3ClientBuilder;\n import com.amazonaws.services.s3.model.S3ObjectSummary;\n import com.fasterxml.jackson.annotation.JacksonInject;\n import com.fasterxml.jackson.annotation.JsonCreator;\n import com.fasterxml.jackson.annotation.JsonProperty;\n import com.google.common.base.Preconditions;\n+import com.google.common.base.Supplier;\n+import com.google.common.base.Suppliers;\n import com.google.common.collect.ImmutableList;\n import org.apache.druid.data.input.InputSplit;\n import org.apache.druid.data.input.impl.CloudObjectInputSource;\n import org.apache.druid.data.input.impl.CloudObjectLocation;\n+import org.apache.druid.data.input.impl.S3ConfigProperties;\n import org.apache.druid.data.input.impl.SplittableInputSource;\n import org.apache.druid.storage.s3.S3InputDataConfig;\n+import org.apache.druid.storage.s3.S3StorageConfig;\n import org.apache.druid.storage.s3.S3StorageDruidModule;\n import org.apache.druid.storage.s3.S3Utils;\n import org.apache.druid.storage.s3.ServerSideEncryptingAmazonS3;\n \n import javax.annotation.Nullable;\n import java.net.URI;\n import java.util.List;\n+import java.util.Objects;\n import java.util.stream.Stream;\n import java.util.stream.StreamSupport;\n \n public class S3InputSource extends CloudObjectInputSource<S3Entity>\n {\n-  private final ServerSideEncryptingAmazonS3 s3Client;\n+  // We lazily initialize s3Client to avoid costly s3 operation when we only need S3InputSource for stored information\n+  // (such as for task logs) and not for ingestion. (This cost only applies for new s3Client created with\n+  // s3ConfigProperties given).\n+  private final Supplier<ServerSideEncryptingAmazonS3> s3Client;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d2720829fbc7ed32a40afb3bbd36e9920370fe"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13c2d6e9f3380a1a1e8cc0fdad197bf9c9499ee4", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/13c2d6e9f3380a1a1e8cc0fdad197bf9c9499ee4", "committedDate": "2020-02-25T01:06:55Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "062e487ba4131a12d08dcdb7cf7daf2c67e4a3fd", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/062e487ba4131a12d08dcdb7cf7daf2c67e4a3fd", "committedDate": "2020-02-25T02:30:22Z", "message": "add ServerSideEncryptingAmazonS3.Builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af0c9235800b736c44d378a7e93abe2a6e8d5401", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/af0c9235800b736c44d378a7e93abe2a6e8d5401", "committedDate": "2020-02-25T02:47:32Z", "message": "resolve merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ac7dc7d8c3fb9fcbd7320b0d94eb2686759b7c4", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/1ac7dc7d8c3fb9fcbd7320b0d94eb2686759b7c4", "committedDate": "2020-02-25T02:49:17Z", "message": "fix failing checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/05395fde480c13f67180a92627d9bf6d82726a3c", "committedDate": "2020-02-25T03:00:53Z", "message": "fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MDQ4NTI1", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-364048525", "createdAt": "2020-02-25T10:54:12Z", "commit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDo1NDoxMlrOFuBmJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDo1NDoxMlrOFuBmJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzgwNDk2NQ==", "bodyText": "this maybe should be named S3InputSourceConfig or something to be more consistently named with other config-ish classes (there is not any types of the form {name}Properties.java in druid currently, and I associate the word to java.util.Properties which this isn't related to)", "url": "https://github.com/apache/druid/pull/9375#discussion_r383804965", "createdAt": "2020-02-25T10:54:12Z", "author": {"login": "clintropolis"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSourceProperties.java", "diffHunk": "@@ -0,0 +1,103 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.data.input.s3;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.google.common.base.Preconditions;\n+import org.apache.druid.metadata.PasswordProvider;\n+\n+import javax.annotation.Nullable;\n+import java.util.Objects;\n+\n+/**\n+ * Contains properties for s3 input source.\n+ * Properties can be specified by ingestionSpec which will override system default.\n+ */\n+public class S3InputSourceProperties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzI0MTg4", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-364324188", "createdAt": "2020-02-25T17:39:37Z", "commit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNzozOTozN1rOFuPGRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNzo0MjoxOVrOFuPMTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAyNjE4Mw==", "bodyText": "modify -> modified?", "url": "https://github.com/apache/druid/pull/9375#discussion_r384026183", "createdAt": "2020-02-25T17:39:37Z", "author": {"login": "jihoonson"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/storage/s3/S3StorageDruidModule.java", "diffHunk": "@@ -166,9 +166,11 @@ public void configure(Binder binder)\n     binder.bind(S3TaskLogs.class).in(LazySingleton.class);\n   }\n \n+  // This provides ServerSideEncryptingAmazonS3.Builder with default configs from Guice injection initially set.\n+  // However, this builder can then be modify and have configuration(s) inside", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAyNzcyNQ==", "bodyText": "Do we still need this s3Client parameter to reuse the singleton client? If so, please leave a comment about it.", "url": "https://github.com/apache/druid/pull/9375#discussion_r384027725", "createdAt": "2020-02-25T17:42:19Z", "author": {"login": "jihoonson"}, "path": "extensions-core/s3-extensions/src/main/java/org/apache/druid/data/input/s3/S3InputSource.java", "diffHunk": "@@ -42,32 +46,66 @@\n import java.net.URI;\n import java.util.Iterator;\n import java.util.List;\n+import java.util.Objects;\n import java.util.stream.Collectors;\n import java.util.stream.Stream;\n \n public class S3InputSource extends CloudObjectInputSource\n {\n-  private final ServerSideEncryptingAmazonS3 s3Client;\n+  // We lazily initialize ServerSideEncryptingAmazonS3 to avoid costly s3 operation when we only need S3InputSource\n+  // for stored information (such as for task logs) and not for ingestion.\n+  // (This cost only applies for new ServerSideEncryptingAmazonS3 created with s3InputSourceProperties given).\n+  private final Supplier<ServerSideEncryptingAmazonS3> s3ClientSupplier;\n+  @JsonProperty(\"properties\")\n+  private final S3InputSourceProperties s3InputSourceProperties;\n   private final S3InputDataConfig inputDataConfig;\n \n   @JsonCreator\n   public S3InputSource(\n       @JacksonInject ServerSideEncryptingAmazonS3 s3Client,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05395fde480c13f67180a92627d9bf6d82726a3c"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe3aa7402b160e0e389c5e7184d3e384c20de5db", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/fe3aa7402b160e0e389c5e7184d3e384c20de5db", "committedDate": "2020-02-25T22:38:36Z", "message": "wrap the ServerSideEncryptingAmazonS3.Builder in a provider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e119516ee9d45ddfbe24a336445828b532608bd6", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/e119516ee9d45ddfbe24a336445828b532608bd6", "committedDate": "2020-02-25T22:57:28Z", "message": "added java docs for S3InputSource constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00b3e1dee1c1fa88cebaf693ee1ec3071e891713", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/00b3e1dee1c1fa88cebaf693ee1ec3071e891713", "committedDate": "2020-02-25T23:00:05Z", "message": "added java docs for S3InputSource constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09e0d6ea7efbf9c03c029d307e8b2fdbf7009ffe", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/09e0d6ea7efbf9c03c029d307e8b2fdbf7009ffe", "committedDate": "2020-02-26T00:20:11Z", "message": "remove wrap the ServerSideEncryptingAmazonS3.Builder in a provider"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTYwNzI0", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-364560724", "createdAt": "2020-02-26T01:06:29Z", "commit": {"oid": "09e0d6ea7efbf9c03c029d307e8b2fdbf7009ffe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTY2NzE4", "url": "https://github.com/apache/druid/pull/9375#pullrequestreview-364566718", "createdAt": "2020-02-26T01:23:21Z", "commit": {"oid": "09e0d6ea7efbf9c03c029d307e8b2fdbf7009ffe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2929, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}