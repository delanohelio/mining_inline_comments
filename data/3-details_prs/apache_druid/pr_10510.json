{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMDk5ODc5", "number": 10510, "title": "Add docs and integration tests for Auto-compaction snapshot status API", "bodyText": "Add docs and integration tests for Auto-compaction snapshot status API\nDescription\nThis is a follow up PR to #10371\nThis PR adds documentation and integration tests for Auto-compaction snapshot status API of the above referenced PR.\nThis PR has:\n\n been self-reviewed.\n\n using the concurrency checklist (Remove this item if the PR doesn't have any relation to concurrency.)\n\n\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added or updated version, license, or notice information in licenses.yaml\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n added integration tests.\n been tested in a test Druid cluster.", "createdAt": "2020-10-13T08:33:41Z", "url": "https://github.com/apache/druid/pull/10510", "merged": true, "mergeCommit": {"oid": "9056d113d0a605671e7ee3fb2d4341671e600997"}, "closed": true, "closedAt": "2020-10-14T13:42:23Z", "author": {"login": "maytasm"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSEVP1AH2gAyNTAyMDk5ODc5OjQ3Zjc2NjI1MWQ1YWEzMmIwMmVhNzk4ODRiMGMxYWEzZTljMDhlZjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSdY0vAFqTUwODM1OTM1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "47f766251d5aa32b02ea79884b0c1aa3e9c08ef1", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/47f766251d5aa32b02ea79884b0c1aa3e9c08ef1", "committedDate": "2020-10-13T08:30:42Z", "message": "add docs and IT for Auto-compaction snapshot status API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06c8323653bcd3323ebed05d8cdfbb5d3d0dec6b", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/06c8323653bcd3323ebed05d8cdfbb5d3d0dec6b", "committedDate": "2020-10-13T19:51:03Z", "message": "fix spellings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/97c0779b762aca19dc0f739fc56431fbe4b6eacd", "committedDate": "2020-10-13T22:47:36Z", "message": "fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTEzNDgw", "url": "https://github.com/apache/druid/pull/10510#pullrequestreview-507913480", "createdAt": "2020-10-14T00:18:57Z", "commit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "state": "COMMENTED", "comments": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwMDoxODo1OFrOHg91jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwMDozMTo1N1rOHg-Dsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyOTYxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n          \n          \n            \n            Returns the status and statistics from the latest auto compaction run of all dataSources which have/had auto compaction enabled.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504329613", "createdAt": "2020-10-14T00:18:58Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMyOTcxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n          \n          \n            \n            The response payload includes a list of `latestStatus` objects. Each `latestStatus` represents the status for a dataSource (which has/had auto compaction enabled).", "url": "https://github.com/apache/druid/pull/10510#discussion_r504329717", "createdAt": "2020-10-14T00:19:18Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMDAwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Note that {dataSource} given must has/had auto compaction enabled.\n          \n          \n            \n            Note that {dataSource} given must have/had auto compaction enabled.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504330000", "createdAt": "2020-10-14T00:20:11Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `intervalCountCompacted`: total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `intervalCountSkipped`: total number of intervals of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+\n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status?dataSource={dataSource}`\n+\n+Similar to the API `/druid/coordinator/v1/compaction/status` above but filters response to only return information for the {dataSource} given. \n+Note that {dataSource} given must has/had auto compaction enabled.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMDc5NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n          \n          \n            \n            |`segment/compacted/count`|Total number of segments of this datasource that are already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504330794", "createdAt": "2020-10-14T00:23:01Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMTg4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n          \n          \n            \n            |`compactTask/maxSlot/count`|Max number of task slots that can be used for auto compaction tasks in the auto compaction run.| |Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504331882", "createdAt": "2020-10-14T00:27:06Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMTkxOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n          \n          \n            \n            |`compact/task/count`|Number of tasks issued in the auto compaction run.| |Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504331919", "createdAt": "2020-10-14T00:27:15Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMTk5MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n          \n          \n            \n            |`compactTask/availableSlot/count`|Number of available task slots that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504331990", "createdAt": "2020-10-14T00:27:29Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjA5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n          \n          \n            \n            |`segment/waitCompact/bytes`|Total bytes of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction).|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332092", "createdAt": "2020-10-14T00:27:59Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjE0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n          \n          \n            \n            |`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction).|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332146", "createdAt": "2020-10-14T00:28:09Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjIwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n          \n          \n            \n            |`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction).|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332205", "createdAt": "2020-10-14T00:28:23Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjI4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n          \n          \n            \n            |`segment/compacted/bytes`|Total bytes of this datasource that are already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332284", "createdAt": "2020-10-14T00:28:44Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjM3Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`interval/compacted/count`|Total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n          \n          \n            \n            |`interval/compacted/count`|Total number of intervals of this datasource that are already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332372", "createdAt": "2020-10-14T00:29:04Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`interval/compacted/count`|Total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjQ2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/skipCompact/bytes`|Total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n          \n          \n            \n            |`segment/skipCompact/bytes`|Total bytes of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332460", "createdAt": "2020-10-14T00:29:19Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`interval/compacted/count`|Total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/skipCompact/bytes`|Total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjUwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`segment/skipCompact/count`|Total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n          \n          \n            \n            |`segment/skipCompact/count`|Total number of segments of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332503", "createdAt": "2020-10-14T00:29:28Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`interval/compacted/count`|Total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/skipCompact/bytes`|Total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n+|`segment/skipCompact/count`|Total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjU2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`interval/skipCompact/count`|Total number of intervals of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n          \n          \n            \n            |`interval/skipCompact/count`|Total number of intervals of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332561", "createdAt": "2020-10-14T00:29:38Z", "author": {"login": "jon-wei"}, "path": "docs/operations/metrics.md", "diffHunk": "@@ -222,13 +222,25 @@ These metrics are for the Druid Coordinator and are reset each time the Coordina\n |`segment/dropQueue/count`|Number of segments to drop.|server.|Varies.|\n |`segment/size`|Total size of used segments in a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|Varies.|\n |`segment/count`|Number of used segments belonging to a data source. Emitted only for data sources to which at least one used segment belongs.|dataSource.|< max|\n-|`segment/overShadowed/count`|Number of overshadowed segments.||Varies.|\n+|`segment/overShadowed/count`|Number of overshadowed segments.| |Varies.|\n |`segment/unavailable/count`|Number of segments (not including replicas) left to load until segments that should be loaded in the cluster are available for queries.|dataSource.|0|\n |`segment/underReplicated/count`|Number of segments (including replicas) left to load until segments that should be loaded in the cluster are available for queries.|tier, dataSource.|0|\n |`tier/historical/count`|Number of available historical nodes in each tier.|tier.|Varies.|\n |`tier/replication/factor`|Configured maximum replication factor in each tier.|tier.|Varies.|\n |`tier/required/capacity`|Total capacity in bytes required in each tier.|tier.|Varies.|\n |`tier/total/capacity`|Total capacity in bytes available in each tier.|tier.|Varies.|\n+|`compact/task/count`|Number of task issued in the auto compaction run.| |Varies.|\n+|`compactTask/maxSlot/count`|Number of max task slot that can be used for auto compaction tasks in the auto compaction run.| |Varies.|\n+|`compactTask/availableSlot/count`|Number of available task slot that can be used for auto compaction tasks in the auto compaction run. (this is max slot minus any currently running compaction task)| |Varies.|\n+|`segment/waitCompact/bytes`|Total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/waitCompact/count`|Total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`interval/waitCompact/count`|Total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction).|datasource.|Varies.|\n+|`segment/compacted/bytes`|Total byte of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/compacted/count`|Total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`interval/compacted/count`|Total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.|datasource.|Varies.|\n+|`segment/skipCompact/bytes`|Total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n+|`segment/skipCompact/count`|Total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|\n+|`interval/skipCompact/count`|Total number of intervals of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.|datasource.|Varies.|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjgwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n          \n          \n            \n            * `bytesAwaitingCompaction`: total bytes of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction)", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332800", "createdAt": "2020-10-14T00:30:25Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjg0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n          \n          \n            \n            * `bytesCompacted`: total bytes of this datasource that are already compacted with the spec set in the auto compaction config.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332849", "createdAt": "2020-10-14T00:30:37Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMjkzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n          \n          \n            \n            * `bytesSkipped`: total bytes of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504332932", "createdAt": "2020-10-14T00:30:51Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzAwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n          \n          \n            \n            * `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction)", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333000", "createdAt": "2020-10-14T00:31:05Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzA0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n          \n          \n            \n            * `segmentCountCompacted`: total number of segments of this datasource that are already compacted with the spec set in the auto compaction config.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333041", "createdAt": "2020-10-14T00:31:15Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzA5OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n          \n          \n            \n            * `segmentCountSkipped`: total number of segments of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333098", "createdAt": "2020-10-14T00:31:25Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzE0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n          \n          \n            \n            * `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that are eligible for auto compaction)", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333140", "createdAt": "2020-10-14T00:31:36Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzE3Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `intervalCountCompacted`: total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.\n          \n          \n            \n            * `intervalCountCompacted`: total number of intervals of this datasource that are already compacted with the spec set in the auto compaction config.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333172", "createdAt": "2020-10-14T00:31:46Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `intervalCountCompacted`: total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMzMzIzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `intervalCountSkipped`: total number of intervals of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n          \n          \n            \n            * `intervalCountSkipped`: total number of intervals of this datasource that are skipped (not eligible for auto compaction) by the auto compaction.", "url": "https://github.com/apache/druid/pull/10510#discussion_r504333234", "createdAt": "2020-10-14T00:31:57Z", "author": {"login": "jon-wei"}, "path": "docs/operations/api-reference.md", "diffHunk": "@@ -410,6 +410,32 @@ Returns total size and count for each datasource for each interval within given\n Returns the total size of segments awaiting compaction for the given dataSource. \n This is only valid for dataSource which has compaction enabled. \n \n+##### GET\n+\n+* `/druid/coordinator/v1/compaction/status`\n+\n+Returns the status and statistics from the latest auto compaction run of all dataSource which has/had auto compaction enabled.\n+The response payload includes a list of `latestStatus` object. Each `latestStatus` represent the status for a dataSource (which has/had auto compaction enabled). \n+The `latestStatus` object has the following keys:\n+* `dataSource`: name of the datasource for this status information\n+* `scheduleStatus`: auto compaction scheduling status. Possible values are `NOT_ENABLED` and `RUNNING`. Returns `RUNNING ` if the dataSource has an active auto compaction config submitted otherwise, `NOT_ENABLED`\n+* `bytesAwaitingCompaction`: total byte of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `bytesCompacted`: total byte of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `bytesSkipped`: total byte of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `segmentCountAwaitingCompaction`: total number of segments of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `segmentCountCompacted`: total number of segments of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `segmentCountSkipped`: total number of segments of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.\n+* `intervalCountAwaitingCompaction`: total number of intervals of this datasource waiting to be compacted by the auto compaction (only consider intervals/segments that is eligible for auto compaction)\n+* `intervalCountCompacted`: total number of intervals of this datasource that is already compacted with the spec set in the auto compaction config.\n+* `intervalCountSkipped`: total number of intervals of this datasource that is skipped (not eligible for auto compaction) by the auto compaction.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97c0779b762aca19dc0f739fc56431fbe4b6eacd"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26d0be938f7c12b8931049f2715f1b9dd541707a", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/26d0be938f7c12b8931049f2715f1b9dd541707a", "committedDate": "2020-10-14T00:44:02Z", "message": "address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTI3Nzk3", "url": "https://github.com/apache/druid/pull/10510#pullrequestreview-507927797", "createdAt": "2020-10-14T01:07:46Z", "commit": {"oid": "26d0be938f7c12b8931049f2715f1b9dd541707a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MzU5MzUx", "url": "https://github.com/apache/druid/pull/10510#pullrequestreview-508359351", "createdAt": "2020-10-14T13:42:14Z", "commit": {"oid": "26d0be938f7c12b8931049f2715f1b9dd541707a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3376, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}