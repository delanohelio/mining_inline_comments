{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5NDQ0MDU3", "number": 10070, "title": "Fix balancer strategy", "bodyText": "Fixes #10067, #10068 and #10069\nDescription\nFound multiple bugs in balancer strategy which are described in the issues above.\n\nThis PR has:\n\n been self-reviewed.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n\n\nKey changed/added classes in this PR\n\nCostBalancerStrategy\nRandomBalancerStrategy", "createdAt": "2020-06-24T19:55:34Z", "url": "https://github.com/apache/druid/pull/10070", "merged": true, "mergeCommit": {"oid": "422a8af14e932d4da0cd7b78d4b729884dd25a34"}, "closed": true, "closedAt": "2020-06-25T11:15:01Z", "author": {"login": "pjain1"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctt19AAH2gAyNDM5NDQ0MDU3OmIyNzUzNTc1NWRmZjY2Nzc2NTU5MWU0MzgyNDQyMTU3ZTdiNzE3YmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcurnPvgH2gAyNDM5NDQ0MDU3OmEwYjBkZjMyMDAwODdmZWQwYTNiMjU0NDUyM2U3OGY0YWQ4N2Y0MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b27535755dff667765591e4382442157e7b717bb", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/b27535755dff667765591e4382442157e7b717bb", "committedDate": "2020-06-22T09:57:20Z", "message": "fix server overassignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd42e98754c9f82bf46bc18256018ec9e64b285", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/9bd42e98754c9f82bf46bc18256018ec9e64b285", "committedDate": "2020-06-24T12:53:16Z", "message": "fix random balancer strategy, add more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c731ae946ca1bfff229402db8245c723c5a022c7", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/c731ae946ca1bfff229402db8245c723c5a022c7", "committedDate": "2020-06-24T12:55:02Z", "message": "comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b6492dc2ac5f93de0ef794cfdba13f4286f4497", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/1b6492dc2ac5f93de0ef794cfdba13f4286f4497", "committedDate": "2020-06-24T18:03:01Z", "message": "added more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "819e8bcc04a4e1c2cd930ae9e529950e495e6883", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/819e8bcc04a4e1c2cd930ae9e529950e495e6883", "committedDate": "2020-06-24T19:51:40Z", "message": "fix forbidden apis"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2OTg1NjEw", "url": "https://github.com/apache/druid/pull/10070#pullrequestreview-436985610", "createdAt": "2020-06-24T20:33:25Z", "commit": {"oid": "819e8bcc04a4e1c2cd930ae9e529950e495e6883"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDozMzoyNVrOGoiHEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDozMzoyNVrOGoiHEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTE1NTA4OQ==", "bodyText": "minor nit:mark return type as nullable", "url": "https://github.com/apache/druid/pull/10070#discussion_r445155089", "createdAt": "2020-06-24T20:33:25Z", "author": {"login": "nishantmonu51"}, "path": "server/src/main/java/org/apache/druid/server/coordinator/RandomBalancerStrategy.java", "diffHunk": "@@ -28,20 +28,22 @@\n import java.util.NavigableSet;\n import java.util.Set;\n import java.util.concurrent.ThreadLocalRandom;\n+import java.util.stream.Collectors;\n \n public class RandomBalancerStrategy implements BalancerStrategy\n {\n   @Override\n   public ServerHolder findNewSegmentHomeReplicator(DataSegment proposalSegment, List<ServerHolder> serverHolders)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "819e8bcc04a4e1c2cd930ae9e529950e495e6883"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2OTk2MzY4", "url": "https://github.com/apache/druid/pull/10070#pullrequestreview-436996368", "createdAt": "2020-06-24T20:49:59Z", "commit": {"oid": "819e8bcc04a4e1c2cd930ae9e529950e495e6883"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0b0df3200087fed0a3b2544523e78f4ad87f412", "author": {"user": {"login": "pjain1", "name": "Parag Jain"}}, "url": "https://github.com/apache/druid/commit/a0b0df3200087fed0a3b2544523e78f4ad87f412", "committedDate": "2020-06-25T09:55:23Z", "message": "fix typo"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2146, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}