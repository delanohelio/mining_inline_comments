{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxNjc3MTUw", "number": 10422, "title": "add light weight version of /druid/coordinator/v1/lookups/nodeStatus", "bodyText": "Description\nAdds a light weight verison of /druid/coordinator/v1/lookups/nodeStatus, which currently include the lookup spec JSON, which can be sort of large for inline map lookups:\n{\n  \"__default\": {\n    \"localhost:8083\": {\n      \"current\": {\n        \"lookup_table\": {\n          \"version\": \"2020-06-11T10:48:17.033Z\",\n          \"lookupExtractorFactory\": {\n            \"type\": \"cachedNamespace\",\n            \"extractionNamespace\": {\n              \"type\": \"uri\",\n              \"uri\": null,\n              \"uriPrefix\": \"file:/Users/clint/workspace/data/druid/lookups/lookup-simple.json\",\n              \"fileRegex\": null,\n              \"namespaceParseSpec\": {\n                \"format\": \"simpleJson\"\n              },\n              \"pollPeriod\": \"PT0S\"\n            },\n            \"firstCacheTimeout\": 0,\n            \"injective\": true\n          }\n        }\n      },\n      \"toLoad\": {},\n      \"toDrop\": []\n    }\n  }\n}\nUsing /druid/coordinator/v1/lookups/nodeStatus?detailed=false will instead just include the 'version' string instead of the complete lookup JSON spec:\n{\n  \"__default\": {\n    \"localhost:8083\": {\n      \"current\": {\n        \"lookup_table\": \"2020-06-11T10:48:17.033Z\"\n      },\n      \"toLoad\": {},\n      \"toDrop\": []\n    }\n  }\n}\nThe new parameter defaults to true if not set to preserve existing behavior.\n\nThis PR has:\n\n been self-reviewed.\n added documentation for new or modified features or behaviors.\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n added integration tests.\n been tested in a test Druid cluster.", "createdAt": "2020-09-23T10:31:12Z", "url": "https://github.com/apache/druid/pull/10422", "merged": true, "mergeCommit": {"oid": "dad69481f0023cb76ed03bbab2e51642f6a3fa67"}, "closed": true, "closedAt": "2020-09-24T06:36:54Z", "author": {"login": "clintropolis"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLpjMWgH2gAyNDkxNjc3MTUwOjBkNjIzMGRjMmUyOTA2MDAxOWY3ODdkZDg3OWE4NWJjNjc3NzE4YzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdL7UDJAFqTQ5NTI1ODMxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d6230dc2e29060019f787dd879a85bc677718c1", "author": {"user": {"login": "clintropolis", "name": "Clint Wylie"}}, "url": "https://github.com/apache/druid/commit/0d6230dc2e29060019f787dd879a85bc677718c1", "committedDate": "2020-09-23T09:54:57Z", "message": "add light weight version /druid/coordinator/v1/lookups/nodeStatus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTc2MzQw", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-494576340", "createdAt": "2020-09-23T11:53:17Z", "commit": {"oid": "0d6230dc2e29060019f787dd879a85bc677718c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMTo1MzoxN1rOHWouXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMTo1MzoxN1rOHWouXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ5Nzk1MQ==", "bodyText": "nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `GET /druid/coordinator/v1/lookups/nodeStatus` with optional query parameter `discover` to discover tiers or configured lookup tiers are listed. The default response will include the which lookups are loaded, being loaded, or being dropped on each node for each tier, including the complete lookup spec. Add the optional query parameter `detailed=false` to only include the 'version' of the lookup instead of the complete spec.\n          \n          \n            \n            `GET /druid/coordinator/v1/lookups/nodeStatus` with optional query parameter `discover` to discover tiers or configured lookup tiers are listed. The response will include the lookups which are loaded, being loaded, or being dropped on each node for each tier. By default, complete lookup spec is included in response for each lookup. Add the optional query parameter `detailed=false` to only include the 'version' of the lookup instead of the complete spec.", "url": "https://github.com/apache/druid/pull/10422#discussion_r493497951", "createdAt": "2020-09-23T11:53:17Z", "author": {"login": "abhishekagarwal87"}, "path": "docs/querying/lookups.md", "diffHunk": "@@ -347,7 +347,7 @@ These end points can be used to get the propagation status of configured lookups\n \n ### List lookup state of all processes\n \n-`GET /druid/coordinator/v1/lookups/nodeStatus` with optional query parameter `discover` to discover tiers or configured lookup tiers are listed.\n+`GET /druid/coordinator/v1/lookups/nodeStatus` with optional query parameter `discover` to discover tiers or configured lookup tiers are listed. The default response will include the which lookups are loaded, being loaded, or being dropped on each node for each tier, including the complete lookup spec. Add the optional query parameter `detailed=false` to only include the 'version' of the lookup instead of the complete spec.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d6230dc2e29060019f787dd879a85bc677718c1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTc4OTI2", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-494578926", "createdAt": "2020-09-23T11:56:32Z", "commit": {"oid": "0d6230dc2e29060019f787dd879a85bc677718c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMTo1NjozMlrOHWo6kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMTo1NjozMlrOHWo6kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzUwMTA3NA==", "bodyText": "another nit: does it make sense to break this function into smaller functions ?", "url": "https://github.com/apache/druid/pull/10422#discussion_r493501074", "createdAt": "2020-09-23T11:56:32Z", "author": {"login": "abhishekagarwal87"}, "path": "server/src/main/java/org/apache/druid/server/http/LookupCoordinatorResource.java", "diffHunk": "@@ -540,9 +542,12 @@ LookupStatus getLookupStatus(\n   @Produces({MediaType.APPLICATION_JSON})\n   @Path(\"/nodeStatus\")\n   public Response getAllNodesStatus(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d6230dc2e29060019f787dd879a85bc677718c1"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0", "author": {"user": {"login": "clintropolis", "name": "Clint Wylie"}}, "url": "https://github.com/apache/druid/commit/1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0", "committedDate": "2020-09-23T20:30:30Z", "message": "review stuffs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDMyNjky", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-495032692", "createdAt": "2020-09-23T20:42:52Z", "commit": {"oid": "1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDg3NzY3", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-495087767", "createdAt": "2020-09-23T22:18:39Z", "commit": {"oid": "1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MjE1NTgy", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-495215582", "createdAt": "2020-09-24T04:44:57Z", "commit": {"oid": "1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MjU4MzE4", "url": "https://github.com/apache/druid/pull/10422#pullrequestreview-495258318", "createdAt": "2020-09-24T06:36:42Z", "commit": {"oid": "1a8f58e67c61eb5ffb54be7a20de19d6dfffd7c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3253, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}