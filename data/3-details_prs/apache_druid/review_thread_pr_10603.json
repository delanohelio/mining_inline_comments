{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2ODI2MjA5", "number": 10603, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMDo0NzoyNFrOE9BFUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMDo0NzoyNFrOE9BFUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDE2MzM3OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/apache/druid/server/coordinator/DruidCoordinator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMDo0NzoyNFrOH5e4kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMToxOToxMFrOH5feeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAzNjg4Mw==", "bodyText": "will it be ok to just use \"duty.getClass().getName()\" for this use case instead of extending the interface?", "url": "https://github.com/apache/druid/pull/10603#discussion_r530036883", "createdAt": "2020-11-25T00:47:24Z", "author": {"login": "himanshug"}, "path": "server/src/main/java/org/apache/druid/server/coordinator/DruidCoordinator.java", "diffHunk": "@@ -801,14 +811,24 @@ public void run()\n               && coordLeaderSelector.isLeader()\n               && startingLeaderCounter == coordLeaderSelector.localTerm()) {\n \n+            final long start = System.nanoTime();\n             params = duty.run(params);\n+            final long end = System.nanoTime();\n \n             if (params == null) {\n               // This duty wanted to cancel the run. No log message, since the duty should have logged a reason.\n               return;\n+            } else {\n+              params.getCoordinatorStats().addToDutyStat(\"runtime\", duty.getDutyAlias(), TimeUnit.NANOSECONDS.toMillis(end - start));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15525fbab893b4438fbaedd3663724c71ff720d9"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA0NjU4NQ==", "bodyText": "ya, I realized that would probably have been better after I looked at what I ended up with for alias values", "url": "https://github.com/apache/druid/pull/10603#discussion_r530046585", "createdAt": "2020-11-25T01:19:10Z", "author": {"login": "capistrant"}, "path": "server/src/main/java/org/apache/druid/server/coordinator/DruidCoordinator.java", "diffHunk": "@@ -801,14 +811,24 @@ public void run()\n               && coordLeaderSelector.isLeader()\n               && startingLeaderCounter == coordLeaderSelector.localTerm()) {\n \n+            final long start = System.nanoTime();\n             params = duty.run(params);\n+            final long end = System.nanoTime();\n \n             if (params == null) {\n               // This duty wanted to cancel the run. No log message, since the duty should have logged a reason.\n               return;\n+            } else {\n+              params.getCoordinatorStats().addToDutyStat(\"runtime\", duty.getDutyAlias(), TimeUnit.NANOSECONDS.toMillis(end - start));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAzNjg4Mw=="}, "originalCommit": {"oid": "15525fbab893b4438fbaedd3663724c71ff720d9"}, "originalPosition": 91}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2869, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}