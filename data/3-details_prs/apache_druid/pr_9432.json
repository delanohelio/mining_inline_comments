{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMDYyODk3", "number": 9432, "title": "Web console: expose props for S3", "bodyText": "This exposes the new props for the s3 input source (added in #9375) in the web console:", "createdAt": "2020-02-27T20:41:16Z", "url": "https://github.com/apache/druid/pull/9432", "merged": true, "mergeCommit": {"oid": "3b536eea7f5bdb4c6f299fd39fffbe7c67c982a9"}, "closed": true, "closedAt": "2020-03-18T22:32:13Z", "author": {"login": "vogievetsky"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIhf-SAH2gAyMzgxMDYyODk3OjQ1ZmM5YWViMGVjODc2ZWNlYWJiNTRlNmFlMWI4NmYxOTY3N2EwZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcO_GWxgFqTM3NzI4MzI0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8", "committedDate": "2020-02-27T20:39:16Z", "message": "expose props for S3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzE1ODQ0", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-366715844", "createdAt": "2020-02-28T22:11:09Z", "commit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzM0NTUz", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-366734553", "createdAt": "2020-02-28T23:01:31Z", "commit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMzowMTozMlrOFwFNPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMzowMTozMlrOFwFNPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk2MTI3Ng==", "bodyText": "provided in which config?\nAlso default configuration -> access key used for deep storage?\nSame comment on line 1229", "url": "https://github.com/apache/druid/pull/9432#discussion_r385961276", "createdAt": "2020-02-28T23:01:32Z", "author": {"login": "suneet-s"}, "path": "web-console/src/utils/ingestion-spec.tsx", "diffHunk": "@@ -1206,6 +1206,30 @@ export function getIoConfigFormFields(ingestionComboType: IngestionComboType): F\n             </>\n           ),\n         },\n+        {\n+          name: 'inputSource.properties.accessKeyId',\n+          label: 'Access key ID',\n+          type: 'string',\n+          placeholder: '(optional)',\n+          info: (\n+            <>\n+              <p>S3 access key for this S3 bucket.</p>\n+              <p>Setting this will override the default configuration provided in the config.</p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzM1MDQy", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-366735042", "createdAt": "2020-02-28T23:03:02Z", "commit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMzowMzowMlrOFwFOzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMzowMzowMlrOFwFOzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk2MTY3OQ==", "bodyText": "Druid lets you specify these fields using PasswordProvider - so you can specify an environment variable instead of pasting in your access key in the ingestion spec. Can we do this through the console?", "url": "https://github.com/apache/druid/pull/9432#discussion_r385961679", "createdAt": "2020-02-28T23:03:02Z", "author": {"login": "suneet-s"}, "path": "web-console/src/utils/ingestion-spec.tsx", "diffHunk": "@@ -1206,6 +1206,30 @@ export function getIoConfigFormFields(ingestionComboType: IngestionComboType): F\n             </>\n           ),\n         },\n+        {\n+          name: 'inputSource.properties.accessKeyId',\n+          label: 'Access key ID',\n+          type: 'string',\n+          placeholder: '(optional)',\n+          info: (\n+            <>\n+              <p>S3 access key for this S3 bucket.</p>\n+              <p>Setting this will override the default configuration provided in the config.</p>\n+            </>\n+          ),\n+        },\n+        {\n+          name: 'inputSource.properties.secretAccessKey',\n+          label: 'Secret access key',\n+          type: 'string',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzM2Mjc4", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-366736278", "createdAt": "2020-02-28T23:07:06Z", "commit": {"oid": "45fc9aeb0ec876eceabb54e6ae1b86f19677a0d8"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76748e7c9f3b75467bf2f9c3d4af9a63f7165ee3", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/76748e7c9f3b75467bf2f9c3d4af9a63f7165ee3", "committedDate": "2020-03-08T07:13:31Z", "message": "added env inputs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "934bbd6155d9095fb57030d3b2d91b97ffb43da6", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/934bbd6155d9095fb57030d3b2d91b97ffb43da6", "committedDate": "2020-03-17T19:14:57Z", "message": "merge master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2Mzg0NjIw", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-376384620", "createdAt": "2020-03-17T20:34:31Z", "commit": {"oid": "934bbd6155d9095fb57030d3b2d91b97ffb43da6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMDozNDozMVrOF3s-vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMDozNDozMVrOF3s-vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzk1Mjk1OQ==", "bodyText": "The name is different depending on the type of password provider. It's called variable for EnvironmentVariablePasswordProvider while it's called password for DefaultPasswordProvider.", "url": "https://github.com/apache/druid/pull/9432#discussion_r393952959", "createdAt": "2020-03-17T20:34:31Z", "author": {"login": "jihoonson"}, "path": "web-console/src/utils/ingestion-spec.tsx", "diffHunk": "@@ -1226,6 +1226,75 @@ export function getIoConfigFormFields(ingestionComboType: IngestionComboType): F\n             </>\n           ),\n         },\n+        {\n+          name: 'inputSource.properties.accessKeyId.type',\n+          label: 'Access key ID type',\n+          type: 'string',\n+          suggestions: [undefined, 'environment', 'default'],\n+          info: (\n+            <>\n+              <p>S3 access key for this S3 bucket.</p>\n+              <p>Setting this will override the default configuration provided in the config.</p>\n+            </>\n+          ),\n+          adjustment: (ioConfig: IoConfig) => {\n+            return deepSet(\n+              ioConfig,\n+              'inputSource.properties.secretAccessKey.type',\n+              deepGet(ioConfig, 'inputSource.properties.accessKeyId.type'),\n+            );\n+          },\n+        },\n+        {\n+          name: 'inputSource.properties.accessKeyId.variable',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "934bbd6155d9095fb57030d3b2d91b97ffb43da6"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "408f2db234cea8fce9dc92a222e205126ce8df6d", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/408f2db234cea8fce9dc92a222e205126ce8df6d", "committedDate": "2020-03-17T20:44:41Z", "message": "add scarry warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0375e971bc0e7c48732851df0655b546f9dfb851", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/0375e971bc0e7c48732851df0655b546f9dfb851", "committedDate": "2020-03-17T21:32:00Z", "message": "use .password"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3d30dfa1a99fabc57fa61921215a56ad9cf4732", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/d3d30dfa1a99fabc57fa61921215a56ad9cf4732", "committedDate": "2020-03-17T23:05:09Z", "message": "put the warning front and center"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NDY1MTU0", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-376465154", "createdAt": "2020-03-17T23:08:38Z", "commit": {"oid": "d3d30dfa1a99fabc57fa61921215a56ad9cf4732"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMzowODozOVrOF3xL6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QyMzowODozOVrOF3xL6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDAyMTg2Nw==", "bodyText": "Can we provide a recommendation on what a better alternative is (ie use the environment variable password provider instead)", "url": "https://github.com/apache/druid/pull/9432#discussion_r394021867", "createdAt": "2020-03-17T23:08:39Z", "author": {"login": "suneet-s"}, "path": "web-console/src/views/load-data-view/load-data-view.tsx", "diffHunk": "@@ -1076,11 +1076,21 @@ export class LoadDataView extends React.PureComponent<LoadDataViewProps, LoadDat\n             <LearnMore href={getIngestionDocLink(spec)} />\n           </Callout>\n           {ingestionComboType ? (\n-            <AutoForm\n-              fields={getIoConfigFormFields(ingestionComboType)}\n-              model={ioConfig}\n-              onChange={c => this.updateSpecPreview(deepSet(spec, 'spec.ioConfig', c))}\n-            />\n+            <>\n+              <AutoForm\n+                fields={getIoConfigFormFields(ingestionComboType)}\n+                model={ioConfig}\n+                onChange={c => this.updateSpecPreview(deepSet(spec, 'spec.ioConfig', c))}\n+              />\n+              {deepGet(spec, 'spec.ioConfig.inputSource.properties.secretAccessKey.password') && (\n+                <FormGroup>\n+                  <Callout intent={Intent.WARNING}>\n+                    Inlining the access key into the ingestion spec is dangerous as it might appear\n+                    in server log files and can be seen by anyone accessing this console.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3d30dfa1a99fabc57fa61921215a56ad9cf4732"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MDg1NzY2", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-377085766", "createdAt": "2020-03-18T17:29:29Z", "commit": {"oid": "d3d30dfa1a99fabc57fa61921215a56ad9cf4732"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzoyOToyOVrOF4PoPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzoyOToyOVrOF4PoPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUyMDYzNg==", "bodyText": "Trying out github's multi-line suggestion \ud83e\udd1ewith Steve's suggested re-wording\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                Inlining the access key into the ingestion spec is dangerous as it might appear\n          \n          \n            \n                                in server log files and can be seen by anyone accessing this console.\n          \n          \n            \n                                This key will be visible to anyone accessing this console and may appear in server logs. \n          \n          \n            \n                                For production scenarios, use of a more secure secret key type is strongly recommended.", "url": "https://github.com/apache/druid/pull/9432#discussion_r394520636", "createdAt": "2020-03-18T17:29:29Z", "author": {"login": "suneet-s"}, "path": "web-console/src/views/load-data-view/load-data-view.tsx", "diffHunk": "@@ -1076,11 +1076,21 @@ export class LoadDataView extends React.PureComponent<LoadDataViewProps, LoadDat\n             <LearnMore href={getIngestionDocLink(spec)} />\n           </Callout>\n           {ingestionComboType ? (\n-            <AutoForm\n-              fields={getIoConfigFormFields(ingestionComboType)}\n-              model={ioConfig}\n-              onChange={c => this.updateSpecPreview(deepSet(spec, 'spec.ioConfig', c))}\n-            />\n+            <>\n+              <AutoForm\n+                fields={getIoConfigFormFields(ingestionComboType)}\n+                model={ioConfig}\n+                onChange={c => this.updateSpecPreview(deepSet(spec, 'spec.ioConfig', c))}\n+              />\n+              {deepGet(spec, 'spec.ioConfig.inputSource.properties.secretAccessKey.password') && (\n+                <FormGroup>\n+                  <Callout intent={Intent.WARNING}>\n+                    Inlining the access key into the ingestion spec is dangerous as it might appear\n+                    in server log files and can be seen by anyone accessing this console.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3d30dfa1a99fabc57fa61921215a56ad9cf4732"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14468d630d6bdebac4cf17eaa26ce658523eb4f8", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/14468d630d6bdebac4cf17eaa26ce658523eb4f8", "committedDate": "2020-03-18T17:34:35Z", "message": "Update web-console/src/views/load-data-view/load-data-view.tsx\n\nCo-Authored-By: Suneet Saldanha <44787917+suneet-s@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MDk3Mzc5", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-377097379", "createdAt": "2020-03-18T17:44:10Z", "commit": {"oid": "14468d630d6bdebac4cf17eaa26ce658523eb4f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2557fa2135dae21b88d1dff88af595fde94aa2c", "author": {"user": {"login": "vogievetsky", "name": "Vadim Ogievetsky"}}, "url": "https://github.com/apache/druid/commit/b2557fa2135dae21b88d1dff88af595fde94aa2c", "committedDate": "2020-03-18T20:25:24Z", "message": "let prettier rewrap the text"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MjgzMjQw", "url": "https://github.com/apache/druid/pull/9432#pullrequestreview-377283240", "createdAt": "2020-03-18T22:31:59Z", "commit": {"oid": "b2557fa2135dae21b88d1dff88af595fde94aa2c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2966, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}