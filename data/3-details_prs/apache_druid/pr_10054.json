{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2ODQ5Mzg5", "number": 10054, "title": "Add safeguard to make sure new Rules added are aware of Rule usage in loadstatus API", "bodyText": "Add safeguard to make sure new Rules added are aware of Rule usage in loadstatus API\nDescription\nAs a followup to #10048\nAdd safeguard to make sure new Rules subclasses added in the future are aware of Rule usage in loadstatus API.\nThis PR has:\n\n been self-reviewed.\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added or updated version, license, or notice information in licenses.yaml\n added comments explaining the \"why\" and the intent of the code wherever would not be obvious for an unfamiliar reader.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n added integration tests.\n been tested in a test Druid cluster.", "createdAt": "2020-06-19T02:15:43Z", "url": "https://github.com/apache/druid/pull/10054", "merged": true, "mergeCommit": {"oid": "191572ad5e250628ce7ab27259d1fe175a10b7a6"}, "closed": true, "closedAt": "2020-06-20T03:18:57Z", "author": {"login": "maytasm"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcspZ04AH2gAyNDM2ODQ5Mzg5OjM0YzdkYmYyNGYzYjIzZGQ5ZDUwNTFmYTg0MDIwMGQ1ZWJmMDI5NTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcs-8ZZAFqTQzNDM5ODcwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "34c7dbf24f3b23dd9d5051fa840200d5ebf02955", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/34c7dbf24f3b23dd9d5051fa840200d5ebf02955", "committedDate": "2020-06-19T02:13:04Z", "message": "Add safeguard to make sure new Rules added are aware of Rule usuage in loadstatus API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNzY2MzE1", "url": "https://github.com/apache/druid/pull/10054#pullrequestreview-433766315", "createdAt": "2020-06-19T02:38:38Z", "commit": {"oid": "34c7dbf24f3b23dd9d5051fa840200d5ebf02955"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMjozODozOFrOGmGMEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMjozODozOFrOGmGMEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYwMDQ2Ng==", "bodyText": "It seems leaky to tie this call to an API method, rather, what is being captured here is whether or not a Rule will load data instead of dropping data, because not all rules that load data are of type LoadRule. Should this just be isLoadRule() or something to that effect?", "url": "https://github.com/apache/druid/pull/10054#discussion_r442600466", "createdAt": "2020-06-19T02:38:38Z", "author": {"login": "clintropolis"}, "path": "server/src/main/java/org/apache/druid/server/coordinator/rules/Rule.java", "diffHunk": "@@ -51,6 +51,14 @@\n \n   boolean appliesTo(Interval interval, DateTime referenceTimestamp);\n \n+  /**\n+   * Returns whether this Rules should be matched and considered in loadstatus API.\n+   * In general, Rules that load segment onto any Druid node should return true.\n+   * Any Rule that returns true for this method should add a compute logic (as if case condition) for the particular\n+   * Rule class in {@link DruidCoordinator#computeUnderReplicationCountsPerDataSourcePerTierForSegments}\n+   */\n+  boolean matchLoadStatusCount();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34c7dbf24f3b23dd9d5051fa840200d5ebf02955"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODAwNDM3", "url": "https://github.com/apache/druid/pull/10054#pullrequestreview-433800437", "createdAt": "2020-06-19T04:51:34Z", "commit": {"oid": "34c7dbf24f3b23dd9d5051fa840200d5ebf02955"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b6dc750ebd27525d833387968fa50130ed8f492", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/9b6dc750ebd27525d833387968fa50130ed8f492", "committedDate": "2020-06-19T09:06:17Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529022449da9762b4f47f0f541843b747bc6bb65", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/529022449da9762b4f47f0f541843b747bc6bb65", "committedDate": "2020-06-19T09:07:07Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0714ddbe3d593700416a8e29d39691c74b69e917", "author": {"user": {"login": "maytasm", "name": "Maytas Monsereenusorn"}}, "url": "https://github.com/apache/druid/commit/0714ddbe3d593700416a8e29d39691c74b69e917", "committedDate": "2020-06-19T09:52:08Z", "message": "add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0Mzk0ODAx", "url": "https://github.com/apache/druid/pull/10054#pullrequestreview-434394801", "createdAt": "2020-06-20T02:03:42Z", "commit": {"oid": "0714ddbe3d593700416a8e29d39691c74b69e917"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0Mzk4NzA5", "url": "https://github.com/apache/druid/pull/10054#pullrequestreview-434398709", "createdAt": "2020-06-20T03:18:50Z", "commit": {"oid": "0714ddbe3d593700416a8e29d39691c74b69e917"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2129, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}