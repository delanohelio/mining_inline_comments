{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NzcwMjYz", "number": 10449, "title": "Fix the offset setting in GoogleStorage#get", "bodyText": "Fixes #7076.\nDescription\nUpgraded the GCP HTTP client libraries to bring in the fix for googleapis/google-http-java-client#447\nAlso added tests using MockHttpTransport to verify that skipping is happening as expected. There was another bug in the\norg.apache.druid.storage.google.GoogleStorage#get(java.lang.String, java.lang.String, long).  offset was being set on the media downloader which is not actually used when executeMediaAsInputStream is invoked. So setting the offset was a no-op.\n\nThis PR has:\n\n been self-reviewed.\n added or updated version, license, or notice information in licenses.yaml\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.", "createdAt": "2020-09-29T11:46:35Z", "url": "https://github.com/apache/druid/pull/10449", "merged": true, "mergeCommit": {"oid": "d057c5149fe5a20c98f3e60af9189e4a1f7ad9ce"}, "closed": true, "closedAt": "2020-10-01T15:38:59Z", "author": {"login": "abhishekagarwal87"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNml-FgH2gAyNDk0NzcwMjYzOmVkMjUxNzkwZDQ0M2M3Y2ExNWEwNmUxYzk0ZjkwNjY0OWViNjg3ZGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNr89QgFqTQ5ODczNzI2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ed251790d443c7ca15a06e1c94f906649eb687de", "author": {"user": {"login": "abhishekagarwal87", "name": "Abhishek Agarwal"}}, "url": "https://github.com/apache/druid/commit/ed251790d443c7ca15a06e1c94f906649eb687de", "committedDate": "2020-09-29T11:36:07Z", "message": "Fix the offset in get of GCP object"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e1a713967fed0bc0d63c58c6e44a905495c0246", "author": {"user": {"login": "abhishekagarwal87", "name": "Abhishek Agarwal"}}, "url": "https://github.com/apache/druid/commit/0e1a713967fed0bc0d63c58c6e44a905495c0246", "committedDate": "2020-09-29T11:53:53Z", "message": "upgrade compute dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9652a121ca3434d96d1b1a88ad8a61bb8d7c6f3", "author": {"user": {"login": "abhishekagarwal87", "name": "Abhishek Agarwal"}}, "url": "https://github.com/apache/druid/commit/d9652a121ca3434d96d1b1a88ad8a61bb8d7c6f3", "committedDate": "2020-09-29T13:07:52Z", "message": "fix version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NzA1OTg0", "url": "https://github.com/apache/druid/pull/10449#pullrequestreview-498705984", "createdAt": "2020-09-29T17:11:00Z", "commit": {"oid": "d9652a121ca3434d96d1b1a88ad8a61bb8d7c6f3"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNzoxMTowMVrOHZ4n1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNzoxNjowM1rOHZ4ziw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjkwNDE0OQ==", "bodyText": "Since it appears in a couple places for this method, may be useful to have a named constant in this method for the value 5, similar to what was done in testStreamTaskLogWithNegative().", "url": "https://github.com/apache/druid/pull/10449#discussion_r496904149", "createdAt": "2020-09-29T17:11:01Z", "author": {"login": "ccaominh"}, "path": "extensions-core/google-extensions/src/test/java/org/apache/druid/storage/google/GoogleTaskLogsTest.java", "diffHunk": "@@ -134,19 +134,21 @@ public void testStreamTaskLogWithoutOffset() throws Exception\n   public void testStreamTaskLogWithPositiveOffset() throws Exception\n   {\n     final String testLog = \"hello this is a log\";\n+    final String expectedLog = testLog.substring(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9652a121ca3434d96d1b1a88ad8a61bb8d7c6f3"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjkwNzE0Nw==", "bodyText": "Similar to what was previously done in extensions-core/google-extensions/pom.xml, does it make sense to have the 1.26.0 suffix value provided by the com.google.apis.client.version property?", "url": "https://github.com/apache/druid/pull/10449#discussion_r496907147", "createdAt": "2020-09-29T17:16:03Z", "author": {"login": "ccaominh"}, "path": "pom.xml", "diffHunk": "@@ -118,8 +118,9 @@\n         <!-- When upgrading ZK, edit docs and integration tests as well (integration-tests/docker-base/setup.sh) -->\n         <zookeeper.version>3.4.14</zookeeper.version>\n         <checkerframework.version>2.5.7</checkerframework.version>\n-        <com.google.apis.client.version>1.25.0</com.google.apis.client.version>\n-        <com.google.apis.compute.version>v1-rev214-1.25.0</com.google.apis.compute.version>\n+        <com.google.apis.client.version>1.26.0</com.google.apis.client.version>\n+        <com.google.apis.compute.version>v1-rev20190607-1.26.0</com.google.apis.compute.version>\n+        <com.google.apis.storage.version>v1-rev20190523-1.26.0</com.google.apis.storage.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9652a121ca3434d96d1b1a88ad8a61bb8d7c6f3"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "137065056c0c461235ac1cbf50965d411e75a7a7", "author": {"user": {"login": "abhishekagarwal87", "name": "Abhishek Agarwal"}}, "url": "https://github.com/apache/druid/commit/137065056c0c461235ac1cbf50965d411e75a7a7", "committedDate": "2020-09-29T17:36:50Z", "message": "review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99679fe32177fd3478ff9f08646d1fe83a18e565", "author": {"user": {"login": "abhishekagarwal87", "name": "Abhishek Agarwal"}}, "url": "https://github.com/apache/druid/commit/99679fe32177fd3478ff9f08646d1fe83a18e565", "committedDate": "2020-09-29T17:43:35Z", "message": "missed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NzM3MjY0", "url": "https://github.com/apache/druid/pull/10449#pullrequestreview-498737264", "createdAt": "2020-09-29T17:50:45Z", "commit": {"oid": "99679fe32177fd3478ff9f08646d1fe83a18e565"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3307, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}