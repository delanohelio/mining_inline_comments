{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyOTQyMzE2", "number": 10320, "title": "ExpressionFilter: Use index for expressions of single multi-value columns.", "bodyText": "Previously, this was disallowed, because expressions treated multi-values\nas nulls. But now, if there's a single multi-value column that can be\nmapped over, it's okay to use the index. Expression selectors already do\nthis.", "createdAt": "2020-08-25T05:13:31Z", "url": "https://github.com/apache/druid/pull/10320", "merged": true, "mergeCommit": {"oid": "f53785c52cef372dd5c456260329dfd5e39011e2"}, "closed": true, "closedAt": "2020-08-25T06:29:32Z", "author": {"login": "gianm"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCQIn3gH2gAyNDcyOTQyMzE2OjU1NjBmYzE0MDc1OWY3OTI0OTMzMjI1ZThiNDI3YTc4MGViNTU1MmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCQtRkgFqTQ3NDE1MjUwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5560fc140759f7924933225e8b427a780eb5552b", "author": {"user": {"login": "gianm", "name": "Gian Merlino"}}, "url": "https://github.com/apache/druid/commit/5560fc140759f7924933225e8b427a780eb5552b", "committedDate": "2020-08-25T05:12:59Z", "message": "ExpressionFilter: Use index for expressions of single multi-value columns.\n\nPreviously, this was disallowed, because expressions treated multi-values\nas nulls. But now, if there's a single multi-value column that can be\nmapped over, it's okay to use the index. Expression selectors already do\nthis."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0MTUyNTA5", "url": "https://github.com/apache/druid/pull/10320#pullrequestreview-474152509", "createdAt": "2020-08-25T05:49:18Z", "commit": {"oid": "5560fc140759f7924933225e8b427a780eb5552b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwNTo0OToxOFrOHGIfmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwNTo0OToxOFrOHGIfmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjE5MjY2Nw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/apache/druid/pull/10320#discussion_r476192667", "createdAt": "2020-08-25T05:49:18Z", "author": {"login": "clintropolis"}, "path": "processing/src/main/java/org/apache/druid/segment/virtual/ExpressionSelectors.java", "diffHunk": "@@ -226,9 +226,7 @@ public static DimensionSelector makeDimensionSelector(\n       if (capabilities != null\n           && capabilities.getType() == ValueType.STRING\n           && capabilities.isDictionaryEncoded().isTrue()\n-          && !capabilities.hasMultipleValues().isUnknown()\n-          && !exprDetails.hasInputArrays()\n-          && !exprDetails.isOutputArray()\n+          && canMapOverDictionary(exprDetails, capabilities.hasMultipleValues())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5560fc140759f7924933225e8b427a780eb5552b"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3492, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}