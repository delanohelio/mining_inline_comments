{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0ODk0NzQ4", "number": 10203, "title": "Support unit on byte-related properties", "bodyText": "Description\nThis PR solves #9998\nIn Druid, there're lots of byte-related properties. In the world of big data, the value of these properties are usually very large.\nFor example,\ndruid.server.maxSize=300000000000 \n\nAt first glance of this configuration, it's hard to tell how many bytes druid.server.maxSize hold. User have to count the number digit by digit to know it's 300_000_000_000.  Changing its value is also error-prone.\nSo this PR adds support of unit suffix to the value of these properties, like how we specify the value of Xms or Xmx properties of JVM,  to make configurations more convenient and intuitive.\nWith this PR, we could set druid.server.maxSize as below:\ndruid.server.maxSize=300m\n# or\ndruid.server.maxSize=300g\n# or\ndruid.server.maxSize=3t\n\nBecause K(or M/G/T) is ambiguous in computer, whether it's 1000 or 1024 is context related. This PR defines the supported units and their bases as follow\n\n\n\nUnit\nDescription\nBase\n\n\n\n\nK\nKilo Decimal Byte\n1_000\n\n\nM\nMega Decimal Byte\n1_000_000\n\n\nG\nGiga Decimal Byte\n1_000_000_000\n\n\nT\nTera Decimal Byte\n1_000_000_000_000\n\n\nP\nPeta Decimal Byte\n1_000_000_000_000_000\n\n\nKiB\nKilo Binary Byte\n1024\n\n\nMiB\nMega Binary Byte\n1024 * 1024\n\n\nGiB\nGiga Binary Byte\n1024 * 1024 * 1024\n\n\nTiB\nTera Binary Byte\n1024 * 1024 * 1024 * 1024\n\n\nPiB\nPeta Binary Byte\n1024 * 1024 * 1024 * 1024 * 1024\n\n\n\nSo,\ndruid.server.maxSize=300m # 300_000_000 bytes\n\ndruid.server.maxSize=300MiB # 300*1024*1024 bytes\n\nOf course, the old ways are still supported\ndruid.server.maxSize=300000000 # 300M bytes\n\nImplementation\nThis PR\n\n\nadds a HumanReadableBytes class to parse the new format of value and turns it into long-format value. With this class, it's easy to turn number formatted property into this new format\n\n\nadds a HumanReadableBytesRange annotation to constraint the range of a HumanReadableBytes property\n\n\nchanges 8 properties to support this feature\n\ndruid.cache.sizeInBytes\ndruid.indexer.runner.maxZnodeBytes\ndruid.processing.buffer.sizeBytes\ndruid.server.maxSize\ndruid.server.http.maxScatterGatherBytes\ndruid.broker.http.maxQueuedBytes\ndruid.processing.buffer.sizeBytes\nmaxSize within druid.segmentCache.locations\n\n\n\nchanges the default value of properties above in example configuration files to use the simplified format\n\n\n\nThis PR has:\n\n been self-reviewed.\n added documentation for new or modified features or behaviors.\n added Javadocs for most classes and all non-trivial methods. Linked related entities via Javadoc links.\n added unit tests or modified existing tests to cover new code paths, ensuring the threshold for code coverage is met.\n been tested in a test Druid cluster.", "createdAt": "2020-07-22T05:44:54Z", "url": "https://github.com/apache/druid/pull/10203", "merged": true, "mergeCommit": {"oid": "646fa84d043a075e64efa0d65205a17b066204e9"}, "closed": true, "closedAt": "2020-07-31T01:58:49Z", "author": {"login": "FrankChen021"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3S8eoAH2gAyNDU0ODk0NzQ4OjJlMWNjMmI3NDQ0NTk4MjU3YzlkY2IyNGRiMzBkZjAyYTFlNmEzMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6GZfpAFqTQ1ODc2NTE1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e1cc2b7444598257c9dcb24db30df02a1e6a31a", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/2e1cc2b7444598257c9dcb24db30df02a1e6a31a", "committedDate": "2020-07-22T04:16:16Z", "message": "support unit suffix on byte-related properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1fd4a6eda026ab74bf1ee2f9a0b81bbae7b8579", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/b1fd4a6eda026ab74bf1ee2f9a0b81bbae7b8579", "committedDate": "2020-07-22T04:17:39Z", "message": "add doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0549e2bc71b91ed7c48454b4836ca6c21aab8062", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/0549e2bc71b91ed7c48454b4836ca6c21aab8062", "committedDate": "2020-07-22T05:18:25Z", "message": "change default value of byte-related properites in example files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "115580a2282b333b2625409b29f378ea1461080c", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/115580a2282b333b2625409b29f378ea1461080c", "committedDate": "2020-07-22T05:18:39Z", "message": "fix coding style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2858729489126c4ece6a93cfbb72b9ece536d22e", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/2858729489126c4ece6a93cfbb72b9ece536d22e", "committedDate": "2020-07-22T05:47:38Z", "message": "fix doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52e2aeaa8caaa7f4eafa91e62a275a1186ee38a6", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/52e2aeaa8caaa7f4eafa91e62a275a1186ee38a6", "committedDate": "2020-07-23T01:21:52Z", "message": "fix CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/3f64c7b55ff10e36f64c198b363f8ca65f3a59b0", "committedDate": "2020-07-23T02:34:50Z", "message": "suppress spelling errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NjM1MzMy", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-454635332", "createdAt": "2020-07-24T05:01:53Z", "commit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "state": "COMMENTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwNTowMTo1M1rOG2jMKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwNTo1NTo0NFrOG2j50g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1Mjg0Mw==", "bodyText": "Please use StringUtils.toLowerCase() instead.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459852843", "createdAt": "2020-07-24T05:01:53Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable\n+{\n+  public static final Bytes ZERO = new Bytes(0L);\n+\n+  private long value;\n+\n+  public Bytes(String value)\n+  {\n+    this.value = Bytes.parse(value);\n+  }\n+\n+  public Bytes(long value)\n+  {\n+    this.value = value;\n+  }\n+\n+  public long getValue()\n+  {\n+    return value;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof Bytes) {\n+      return value == ((Bytes) thatObj).value;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(value);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(value);\n+  }\n+\n+  public static Bytes valueOf(int bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static Bytes valueOf(long bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"number is null\");\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1MjkzMg==", "bodyText": "Please use StringUtils.toLowerCase() instead.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459852932", "createdAt": "2020-07-24T05:02:25Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable\n+{\n+  public static final Bytes ZERO = new Bytes(0L);\n+\n+  private long value;\n+\n+  public Bytes(String value)\n+  {\n+    this.value = Bytes.parse(value);\n+  }\n+\n+  public Bytes(long value)\n+  {\n+    this.value = value;\n+  }\n+\n+  public long getValue()\n+  {\n+    return value;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof Bytes) {\n+      return value == ((Bytes) thatObj).value;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(value);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(value);\n+  }\n+\n+  public static Bytes valueOf(int bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static Bytes valueOf(long bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"number is null\");\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());\n+    int len = number.length();\n+    if (len == 0) {\n+      throw new IAE(\"number is empty\");\n+    }\n+\n+    return parseInner(number);\n+  }\n+\n+  /**\n+   * parse the case-insensitive string number, which is either:\n+   * <p>\n+   * a number string\n+   * <p>\n+   * or\n+   * <p>\n+   * a number string with a suffix which indicates the unit the of number\n+   * the unit must be one of following\n+   * k - kilobyte = 1000\n+   * m - megabyte = 1,000,000\n+   * g - gigabyte = 1,000,000,000\n+   * t - terabyte = 1,000,000,000,000\n+   * p - petabyte = 1,000,000,000,000,000\n+   * KiB - kilo binary byte = 1024\n+   * MiB - mega binary byte = 1024*1204\n+   * GiB - giga binary byte = 1024*1024*1024\n+   * TiB - tera binary byte = 1024*1024*1024*1024\n+   * PiB - peta binary byte = 1024*1024*1024*1024*1024\n+   * <p>\n+   *\n+   * @param nullValue to be returned when given number is null or empty\n+   * @return nullValue if input is null or empty\n+   * value of number\n+   * @throws IAE if the input is invalid\n+   */\n+  public static long parse(String number, long nullValue)\n+  {\n+    if (number == null) {\n+      return nullValue;\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NTYzOQ==", "bodyText": "nit: Bytes seems too broad. For example, Bytes.getValue() doesn't seem intuitive enough to me what it would return. Maybe HumanReadableBytes could be a more readable name.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459855639", "createdAt": "2020-07-24T05:16:32Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NjY0NQ==", "bodyText": "This wouldn't cause integer overflow because the max is limited as Integer.MAX_VALUE, but this seems fragile and easy to make a mistake. How about adding asInt() which has a check for integer overflow?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459856645", "createdAt": "2020-07-24T05:21:27Z", "author": {"login": "jihoonson"}, "path": "indexing-service/src/main/java/org/apache/druid/indexing/overlord/config/RemoteTaskRunnerConfig.java", "diffHunk": "@@ -81,15 +83,14 @@ public Period getTaskCleanupTimeout()\n \n   public int getMaxZnodeBytes()\n   {\n-    return maxZnodeBytes;\n+    return (int) maxZnodeBytes.getValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NzIwMQ==", "bodyText": "I guess we can call Bytes.parse() without default value since bufferSizeConfigured() has default?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459857201", "createdAt": "2020-07-24T05:24:15Z", "author": {"login": "jihoonson"}, "path": "processing/src/main/java/org/apache/druid/query/DruidProcessingConfig.java", "diffHunk": "@@ -40,9 +41,14 @@\n   private AtomicReference<Integer> computedBufferSizeBytes = new AtomicReference<>();\n \n   @Config({\"druid.computation.buffer.size\", \"${base_path}.buffer.sizeBytes\"})\n+  public String bufferSizeConfigured()\n+  {\n+    return \"-1\";\n+  }\n+\n   public int intermediateComputeSizeBytesConfigured()\n   {\n-    return DEFAULT_PROCESSING_BUFFER_SIZE_BYTES;\n+    return (int) Bytes.parse(bufferSizeConfigured(), DEFAULT_PROCESSING_BUFFER_SIZE_BYTES);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NzI4Nw==", "bodyText": "Please make it as a static variable.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459857287", "createdAt": "2020-07-24T05:24:42Z", "author": {"login": "jihoonson"}, "path": "processing/src/main/java/org/apache/druid/query/DruidProcessingConfig.java", "diffHunk": "@@ -40,9 +41,14 @@\n   private AtomicReference<Integer> computedBufferSizeBytes = new AtomicReference<>();\n \n   @Config({\"druid.computation.buffer.size\", \"${base_path}.buffer.sizeBytes\"})\n+  public String bufferSizeConfigured()\n+  {\n+    return \"-1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NzUxNA==", "bodyText": "Please add simple javadoc about what this annotation is and how it is used.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459857514", "createdAt": "2020-07-24T05:25:39Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/BytesRange.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import javax.validation.Constraint;\n+import javax.validation.ConstraintValidator;\n+import javax.validation.ConstraintValidatorContext;\n+import javax.validation.Payload;\n+import java.lang.annotation.Documented;\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+@Target({\n+    ElementType.FIELD,\n+    ElementType.PARAMETER\n+})\n+@Retention(RetentionPolicy.RUNTIME)\n+@Documented\n+@Constraint(validatedBy = BytesRange.DateRangeValidator.class)\n+public @interface BytesRange", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1OTEzNA==", "bodyText": "Hmm, this method can be called several times during processing a query. Why not returning Bytes in bufferSizeConfigured() instead of String?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459859134", "createdAt": "2020-07-24T05:32:50Z", "author": {"login": "jihoonson"}, "path": "processing/src/main/java/org/apache/druid/query/DruidProcessingConfig.java", "diffHunk": "@@ -40,9 +41,14 @@\n   private AtomicReference<Integer> computedBufferSizeBytes = new AtomicReference<>();\n \n   @Config({\"druid.computation.buffer.size\", \"${base_path}.buffer.sizeBytes\"})\n+  public String bufferSizeConfigured()\n+  {\n+    return \"-1\";\n+  }\n+\n   public int intermediateComputeSizeBytesConfigured()\n   {\n-    return DEFAULT_PROCESSING_BUFFER_SIZE_BYTES;\n+    return (int) Bytes.parse(bufferSizeConfigured(), DEFAULT_PROCESSING_BUFFER_SIZE_BYTES);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg1NzIwMQ=="}, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg2MDA4Mw==", "bodyText": "nit: ExpectedException is preferred since you can verify the error message as well as the exception type. This is useful since even when the same type of exception is thrown, exceptions from different area of code can have different messages.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459860083", "createdAt": "2020-07-24T05:37:02Z", "author": {"login": "jihoonson"}, "path": "core/src/test/java/org/apache/druid/java/util/common/BytesTest.java", "diffHunk": "@@ -0,0 +1,300 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import javax.validation.ConstraintViolation;\n+import javax.validation.Validation;\n+import javax.validation.Validator;\n+import javax.validation.groups.Default;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class BytesTest\n+{\n+  @Test\n+  public void testNumberString()\n+  {\n+    Assert.assertEquals(1, Bytes.parse(\"1\", 0L));\n+    Assert.assertEquals(10000000, Bytes.parse(\"10000000\", 0));\n+  }\n+\n+  @Test\n+  public void testWithWhiteSpace()\n+  {\n+    Assert.assertEquals(12345, Bytes.parse(\" 12345 \", 0));\n+    Assert.assertEquals(12345, Bytes.parse(\"\\t12345\\t\", 0));\n+  }\n+\n+  @Test\n+  public void testK()\n+  {\n+    Assert.assertEquals(1000, Bytes.parse(\"1k\", 0));\n+    Assert.assertEquals(1000, Bytes.parse(\"1K\", 0));\n+  }\n+\n+  @Test\n+  public void testM()\n+  {\n+    Assert.assertEquals(1000_000, Bytes.parse(\"1m\", 0));\n+    Assert.assertEquals(1000_000, Bytes.parse(\"1M\", 0));\n+  }\n+\n+  @Test\n+  public void testG()\n+  {\n+    Assert.assertEquals(1000_000_000, Bytes.parse(\"1g\", 0));\n+    Assert.assertEquals(1000_000_000, Bytes.parse(\"1G\", 0));\n+  }\n+\n+  @Test\n+  public void testT()\n+  {\n+    Assert.assertEquals(1000_000_000_000L, Bytes.parse(\"1t\", 0));\n+    Assert.assertEquals(1000_000_000_000L, Bytes.parse(\"1T\", 0));\n+  }\n+\n+  @Test\n+  public void testKiB()\n+  {\n+    Assert.assertEquals(1024, Bytes.parse(\"1kib\", 0));\n+    Assert.assertEquals(9 * 1024, Bytes.parse(\"9KiB\", 0));\n+    Assert.assertEquals(9 * 1024, Bytes.parse(\"9Kib\", 0));\n+  }\n+\n+  @Test\n+  public void testMb()\n+  {\n+    Assert.assertEquals(1024 * 1024, Bytes.parse(\"1mib\", 0));\n+    Assert.assertEquals(9 * 1024 * 1024, Bytes.parse(\"9MiB\", 0));\n+    Assert.assertEquals(9 * 1024 * 1024, Bytes.parse(\"9Mib\", 0));\n+  }\n+\n+  @Test\n+  public void testGiB()\n+  {\n+    Assert.assertEquals(1024 * 1024 * 1024, Bytes.parse(\"1gib\", 0));\n+    Assert.assertEquals(1024 * 1024 * 1024, Bytes.parse(\"1GiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024, Bytes.parse(\"9Gib\", 0));\n+  }\n+\n+  @Test\n+  public void testTiB()\n+  {\n+    Assert.assertEquals(1024 * 1024 * 1024 * 1024L, Bytes.parse(\"1tib\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9TiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9Tib\", 0));\n+  }\n+\n+  @Test\n+  public void testPiB()\n+  {\n+    Assert.assertEquals(1024L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"1pib\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9PiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9Pib\", 0));\n+  }\n+\n+  @Test\n+  public void testDefault()\n+  {\n+    Assert.assertEquals(-123, Bytes.parse(\" \", -123));\n+    Assert.assertEquals(-456, Bytes.parse(null, -456));\n+    Assert.assertEquals(-789, Bytes.parse(\"\\t\", -789));\n+  }\n+\n+  @Test\n+  public void testException()\n+  {\n+    try {\n+      Bytes.parse(\"b\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 132}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg2MDU3Mg==", "bodyText": "We usually name a test class to have the Test suffix if it has unit tests. How about TestBytesRange?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459860572", "createdAt": "2020-07-24T05:39:08Z", "author": {"login": "jihoonson"}, "path": "core/src/test/java/org/apache/druid/java/util/common/BytesTest.java", "diffHunk": "@@ -0,0 +1,300 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+import javax.validation.ConstraintViolation;\n+import javax.validation.Validation;\n+import javax.validation.Validator;\n+import javax.validation.groups.Default;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+public class BytesTest\n+{\n+  @Test\n+  public void testNumberString()\n+  {\n+    Assert.assertEquals(1, Bytes.parse(\"1\", 0L));\n+    Assert.assertEquals(10000000, Bytes.parse(\"10000000\", 0));\n+  }\n+\n+  @Test\n+  public void testWithWhiteSpace()\n+  {\n+    Assert.assertEquals(12345, Bytes.parse(\" 12345 \", 0));\n+    Assert.assertEquals(12345, Bytes.parse(\"\\t12345\\t\", 0));\n+  }\n+\n+  @Test\n+  public void testK()\n+  {\n+    Assert.assertEquals(1000, Bytes.parse(\"1k\", 0));\n+    Assert.assertEquals(1000, Bytes.parse(\"1K\", 0));\n+  }\n+\n+  @Test\n+  public void testM()\n+  {\n+    Assert.assertEquals(1000_000, Bytes.parse(\"1m\", 0));\n+    Assert.assertEquals(1000_000, Bytes.parse(\"1M\", 0));\n+  }\n+\n+  @Test\n+  public void testG()\n+  {\n+    Assert.assertEquals(1000_000_000, Bytes.parse(\"1g\", 0));\n+    Assert.assertEquals(1000_000_000, Bytes.parse(\"1G\", 0));\n+  }\n+\n+  @Test\n+  public void testT()\n+  {\n+    Assert.assertEquals(1000_000_000_000L, Bytes.parse(\"1t\", 0));\n+    Assert.assertEquals(1000_000_000_000L, Bytes.parse(\"1T\", 0));\n+  }\n+\n+  @Test\n+  public void testKiB()\n+  {\n+    Assert.assertEquals(1024, Bytes.parse(\"1kib\", 0));\n+    Assert.assertEquals(9 * 1024, Bytes.parse(\"9KiB\", 0));\n+    Assert.assertEquals(9 * 1024, Bytes.parse(\"9Kib\", 0));\n+  }\n+\n+  @Test\n+  public void testMb()\n+  {\n+    Assert.assertEquals(1024 * 1024, Bytes.parse(\"1mib\", 0));\n+    Assert.assertEquals(9 * 1024 * 1024, Bytes.parse(\"9MiB\", 0));\n+    Assert.assertEquals(9 * 1024 * 1024, Bytes.parse(\"9Mib\", 0));\n+  }\n+\n+  @Test\n+  public void testGiB()\n+  {\n+    Assert.assertEquals(1024 * 1024 * 1024, Bytes.parse(\"1gib\", 0));\n+    Assert.assertEquals(1024 * 1024 * 1024, Bytes.parse(\"1GiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024, Bytes.parse(\"9Gib\", 0));\n+  }\n+\n+  @Test\n+  public void testTiB()\n+  {\n+    Assert.assertEquals(1024 * 1024 * 1024 * 1024L, Bytes.parse(\"1tib\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9TiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9Tib\", 0));\n+  }\n+\n+  @Test\n+  public void testPiB()\n+  {\n+    Assert.assertEquals(1024L * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"1pib\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9PiB\", 0));\n+    Assert.assertEquals(9L * 1024 * 1024 * 1024 * 1024 * 1024, Bytes.parse(\"9Pib\", 0));\n+  }\n+\n+  @Test\n+  public void testDefault()\n+  {\n+    Assert.assertEquals(-123, Bytes.parse(\" \", -123));\n+    Assert.assertEquals(-456, Bytes.parse(null, -456));\n+    Assert.assertEquals(-789, Bytes.parse(\"\\t\", -789));\n+  }\n+\n+  @Test\n+  public void testException()\n+  {\n+    try {\n+      Bytes.parse(\"b\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+\n+    try {\n+      Bytes.parse(\"1 b\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+\n+    try {\n+      Bytes.parse(\"tb\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+\n+    try {\n+      Bytes.parse(\"1 mb\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+\n+    try {\n+      Bytes.parse(\"gb\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+\n+    try {\n+      Bytes.parse(\"tb\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+      Assert.assertTrue(true);\n+    }\n+  }\n+\n+  @Test\n+  public void testOverflow()\n+  {\n+    try {\n+      Bytes.parse(\"123456789123456789123\", 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / 1000 + 1) + \"k\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / 1000_000 + 1) + \"m\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / 1000_000_000L + 1) + \"g\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / 1000_000_000_000L + 1) + \"t\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / 1024 + 1) + \"kb\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / (1024 * 1024) + 1) + \"mb\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / (1024L * 1024 * 1024) + 1) + \"gb\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+\n+    try {\n+      String max = (Long.MAX_VALUE / (1024L * 1024 * 1024 * 1024) + 1) + \"tb\";\n+      Bytes.parse(max, 0);\n+      Assert.assertFalse(\"IAE should be thrown\", true);\n+    }\n+    catch (IAE e) {\n+    }\n+  }\n+\n+  @Test\n+  public void testJSON() throws JsonProcessingException\n+  {\n+    ObjectMapper mapper = new ObjectMapper();\n+    Bytes bytes = new Bytes(\"5m\");\n+    String serialized = mapper.writeValueAsString(bytes);\n+    Bytes deserialized = mapper.readValue(serialized, Bytes.class);\n+    Assert.assertEquals(bytes, deserialized);\n+  }\n+\n+  public static class BytesRangeTest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 264}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg2MzI2NQ==", "bodyText": "Why not checking overflow here too?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459863265", "createdAt": "2020-07-24T05:50:38Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable\n+{\n+  public static final Bytes ZERO = new Bytes(0L);\n+\n+  private long value;\n+\n+  public Bytes(String value)\n+  {\n+    this.value = Bytes.parse(value);\n+  }\n+\n+  public Bytes(long value)\n+  {\n+    this.value = value;\n+  }\n+\n+  public long getValue()\n+  {\n+    return value;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof Bytes) {\n+      return value == ((Bytes) thatObj).value;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(value);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(value);\n+  }\n+\n+  public static Bytes valueOf(int bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static Bytes valueOf(long bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"number is null\");\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());\n+    int len = number.length();\n+    if (len == 0) {\n+      throw new IAE(\"number is empty\");\n+    }\n+\n+    return parseInner(number);\n+  }\n+\n+  /**\n+   * parse the case-insensitive string number, which is either:\n+   * <p>\n+   * a number string\n+   * <p>\n+   * or\n+   * <p>\n+   * a number string with a suffix which indicates the unit the of number\n+   * the unit must be one of following\n+   * k - kilobyte = 1000\n+   * m - megabyte = 1,000,000\n+   * g - gigabyte = 1,000,000,000\n+   * t - terabyte = 1,000,000,000,000\n+   * p - petabyte = 1,000,000,000,000,000\n+   * KiB - kilo binary byte = 1024\n+   * MiB - mega binary byte = 1024*1204\n+   * GiB - giga binary byte = 1024*1024*1024\n+   * TiB - tera binary byte = 1024*1024*1024*1024\n+   * PiB - peta binary byte = 1024*1024*1024*1024*1024\n+   * <p>\n+   *\n+   * @param nullValue to be returned when given number is null or empty\n+   * @return nullValue if input is null or empty\n+   * value of number\n+   * @throws IAE if the input is invalid\n+   */\n+  public static long parse(String number, long nullValue)\n+  {\n+    if (number == null) {\n+      return nullValue;\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());\n+    if (number.length() == 0) {\n+      return nullValue;\n+    }\n+    return parseInner(number);\n+  }\n+\n+  private static long parseInner(String number)\n+  {\n+    int index = number.length() - 1;\n+    boolean isBinary = false;\n+    char unit = number.charAt(index--);\n+    if (unit == 'b') {\n+      if (index < 2) {\n+        throw new IAE(\"invalid format of number[%s]\", number);\n+      }\n+      if (number.charAt(index--) != 'i') {\n+        throw new IAE(\"invalid format of number[%s]\", number);\n+      }\n+\n+      unit = number.charAt(index--);\n+      isBinary = true;\n+    }\n+    long base = 1;\n+    switch (unit) {\n+      case 'k':\n+        base = isBinary ? 1024 : 1_000;\n+        break;\n+\n+      case 'm':\n+        base = isBinary ? 1024 * 1024 : 1_000_000;\n+        break;\n+\n+      case 'g':\n+        base = isBinary ? 1024 * 1024 * 1024 : 1_000_000_000;\n+        break;\n+\n+      case 't':\n+        base = isBinary ? 1024 * 1024 * 1024 * 1024L : 1_000_000_000_000L;\n+        break;\n+\n+      case 'p':\n+        base = isBinary ? 1024L * 1024 * 1024 * 1024 * 1024 : 1_000_000_000_000_000L;\n+        break;\n+\n+      default:\n+        if (!Character.isDigit(unit)) {\n+          throw new IAE(\"invalid character in number[%s]\", number);\n+        }\n+        break;\n+    }\n+\n+    try {\n+      if (base > 1 && index >= 0) {\n+        long value = Long.parseLong(number.substring(0, index + 1)) * base;\n+        if (value < base) {\n+          throw new IAE(\"number [%s] overflow\", number);\n+        }\n+        return value;\n+      } else {\n+        return Long.parseLong(number);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 191}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg2MzY1Ng==", "bodyText": "Out of curiosity, why does this compare against base instead of 0?", "url": "https://github.com/apache/druid/pull/10203#discussion_r459863656", "createdAt": "2020-07-24T05:52:15Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable\n+{\n+  public static final Bytes ZERO = new Bytes(0L);\n+\n+  private long value;\n+\n+  public Bytes(String value)\n+  {\n+    this.value = Bytes.parse(value);\n+  }\n+\n+  public Bytes(long value)\n+  {\n+    this.value = value;\n+  }\n+\n+  public long getValue()\n+  {\n+    return value;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof Bytes) {\n+      return value == ((Bytes) thatObj).value;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(value);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(value);\n+  }\n+\n+  public static Bytes valueOf(int bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static Bytes valueOf(long bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"number is null\");\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());\n+    int len = number.length();\n+    if (len == 0) {\n+      throw new IAE(\"number is empty\");\n+    }\n+\n+    return parseInner(number);\n+  }\n+\n+  /**\n+   * parse the case-insensitive string number, which is either:\n+   * <p>\n+   * a number string\n+   * <p>\n+   * or\n+   * <p>\n+   * a number string with a suffix which indicates the unit the of number\n+   * the unit must be one of following\n+   * k - kilobyte = 1000\n+   * m - megabyte = 1,000,000\n+   * g - gigabyte = 1,000,000,000\n+   * t - terabyte = 1,000,000,000,000\n+   * p - petabyte = 1,000,000,000,000,000\n+   * KiB - kilo binary byte = 1024\n+   * MiB - mega binary byte = 1024*1204\n+   * GiB - giga binary byte = 1024*1024*1024\n+   * TiB - tera binary byte = 1024*1024*1024*1024\n+   * PiB - peta binary byte = 1024*1024*1024*1024*1024\n+   * <p>\n+   *\n+   * @param nullValue to be returned when given number is null or empty\n+   * @return nullValue if input is null or empty\n+   * value of number\n+   * @throws IAE if the input is invalid\n+   */\n+  public static long parse(String number, long nullValue)\n+  {\n+    if (number == null) {\n+      return nullValue;\n+    }\n+\n+    number = number.trim().toLowerCase(Locale.getDefault());\n+    if (number.length() == 0) {\n+      return nullValue;\n+    }\n+    return parseInner(number);\n+  }\n+\n+  private static long parseInner(String number)\n+  {\n+    int index = number.length() - 1;\n+    boolean isBinary = false;\n+    char unit = number.charAt(index--);\n+    if (unit == 'b') {\n+      if (index < 2) {\n+        throw new IAE(\"invalid format of number[%s]\", number);\n+      }\n+      if (number.charAt(index--) != 'i') {\n+        throw new IAE(\"invalid format of number[%s]\", number);\n+      }\n+\n+      unit = number.charAt(index--);\n+      isBinary = true;\n+    }\n+    long base = 1;\n+    switch (unit) {\n+      case 'k':\n+        base = isBinary ? 1024 : 1_000;\n+        break;\n+\n+      case 'm':\n+        base = isBinary ? 1024 * 1024 : 1_000_000;\n+        break;\n+\n+      case 'g':\n+        base = isBinary ? 1024 * 1024 * 1024 : 1_000_000_000;\n+        break;\n+\n+      case 't':\n+        base = isBinary ? 1024 * 1024 * 1024 * 1024L : 1_000_000_000_000L;\n+        break;\n+\n+      case 'p':\n+        base = isBinary ? 1024L * 1024 * 1024 * 1024 * 1024 : 1_000_000_000_000_000L;\n+        break;\n+\n+      default:\n+        if (!Character.isDigit(unit)) {\n+          throw new IAE(\"invalid character in number[%s]\", number);\n+        }\n+        break;\n+    }\n+\n+    try {\n+      if (base > 1 && index >= 0) {\n+        long value = Long.parseLong(number.substring(0, index + 1)) * base;\n+        if (value < base) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 186}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg2NDUzMA==", "bodyText": "All error messages should start with a capital letter. Please fix other places too.", "url": "https://github.com/apache/druid/pull/10203#discussion_r459864530", "createdAt": "2020-07-24T05:55:44Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/Bytes.java", "diffHunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+import java.util.Locale;\n+\n+@JsonSerialize(using = BytesSerializer.class)\n+public class Bytes implements Serializable\n+{\n+  public static final Bytes ZERO = new Bytes(0L);\n+\n+  private long value;\n+\n+  public Bytes(String value)\n+  {\n+    this.value = Bytes.parse(value);\n+  }\n+\n+  public Bytes(long value)\n+  {\n+    this.value = value;\n+  }\n+\n+  public long getValue()\n+  {\n+    return value;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof Bytes) {\n+      return value == ((Bytes) thatObj).value;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(value);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(value);\n+  }\n+\n+  public static Bytes valueOf(int bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static Bytes valueOf(long bytes)\n+  {\n+    return new Bytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"number is null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f64c7b55ff10e36f64c198b363f8ca65f3a59b0"}, "originalPosition": 87}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbc61c2ace7cd2d5166cce2806d3bfa52ea1b497", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/fbc61c2ace7cd2d5166cce2806d3bfa52ea1b497", "committedDate": "2020-07-27T03:13:50Z", "message": "improve code according to comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f58d268a81e27066f4970c3468fefc8351394bdd", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/f58d268a81e27066f4970c3468fefc8351394bdd", "committedDate": "2020-07-27T03:26:44Z", "message": "rename Bytes to HumanReadableBytes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "023b908d76192c6387dae54a6aeb900a2e0ea893", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/023b908d76192c6387dae54a6aeb900a2e0ea893", "committedDate": "2020-07-27T06:53:20Z", "message": "add getBytesInInt to get value safely"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8464960c40d1a44bb732d404b116899b474a3d7b", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/8464960c40d1a44bb732d404b116899b474a3d7b", "committedDate": "2020-07-27T08:09:38Z", "message": "improve doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dfb1360ca2c21430b3ea4fd7ce9d4dc23bd9301", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/2dfb1360ca2c21430b3ea4fd7ce9d4dc23bd9301", "committedDate": "2020-07-27T08:11:36Z", "message": "fix problem reported by CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/c86454be59a1f3f34f2d596a82ea9a3c1a009114", "committedDate": "2020-07-27T10:04:44Z", "message": "fix problem reported by CI"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Mzg3NzI5", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-456387729", "createdAt": "2020-07-28T07:53:49Z", "commit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNzo1Mzo0OVrOG4A7Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNzo1OTowNFrOG4YKdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4ODU0Nw==", "bodyText": "I missed this before. Does Serializable do anything here? It doesn't seem so.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461388547", "createdAt": "2020-07-28T07:53:49Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/HumanReadableBytes.java", "diffHunk": "@@ -0,0 +1,210 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+\n+@JsonSerialize(using = HumanReadableBytesSerializer.class)\n+public class HumanReadableBytes implements Serializable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQwNjk1Ng==", "bodyText": "It would be nice to log that the number might be out of range of long.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461406956", "createdAt": "2020-07-28T08:25:51Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/HumanReadableBytes.java", "diffHunk": "@@ -128,71 +135,76 @@ public static long parse(String number, long nullValue)\n       return nullValue;\n     }\n \n-    number = number.trim().toLowerCase(Locale.getDefault());\n+    number = number.trim();\n     if (number.length() == 0) {\n       return nullValue;\n     }\n     return parseInner(number);\n   }\n \n-  private static long parseInner(String number)\n+  private static long parseInner(String rawNumber)\n   {\n-    int index = number.length() - 1;\n-    boolean isBinary = false;\n-    char unit = number.charAt(index--);\n+    String number = StringUtils.toLowerCase(rawNumber);\n+    if (number.charAt(0) == '-') {\n+      throw new IAE(\"Invalid format of number: %s. Negative value is not allowed.\", rawNumber);\n+    }\n+\n+    int lastDigitIndex = number.length() - 1;\n+    boolean isBinaryByte = false;\n+    char unit = number.charAt(lastDigitIndex--);\n     if (unit == 'b') {\n-      if (index < 2) {\n-        throw new IAE(\"invalid format of number[%s]\", number);\n+      //unit ends with 'b' must be format of KiB/MiB/GiB/TiB/PiB, so at least 3 extra characters are required\n+      if (lastDigitIndex < 2) {\n+        throw new IAE(\"Invalid format of number: %s\", rawNumber);\n       }\n-      if (number.charAt(index--) != 'i') {\n-        throw new IAE(\"invalid format of number[%s]\", number);\n+      if (number.charAt(lastDigitIndex--) != 'i') {\n+        throw new IAE(\"Invalid format of number: %s\", rawNumber);\n       }\n \n-      unit = number.charAt(index--);\n-      isBinary = true;\n+      unit = number.charAt(lastDigitIndex--);\n+      isBinaryByte = true;\n     }\n+\n     long base = 1;\n     switch (unit) {\n       case 'k':\n-        base = isBinary ? 1024 : 1_000;\n+        base = isBinaryByte ? 1024 : 1_000;\n         break;\n \n       case 'm':\n-        base = isBinary ? 1024 * 1024 : 1_000_000;\n+        base = isBinaryByte ? 1024 * 1024 : 1_000_000;\n         break;\n \n       case 'g':\n-        base = isBinary ? 1024 * 1024 * 1024 : 1_000_000_000;\n+        base = isBinaryByte ? 1024 * 1024 * 1024 : 1_000_000_000;\n         break;\n \n       case 't':\n-        base = isBinary ? 1024 * 1024 * 1024 * 1024L : 1_000_000_000_000L;\n+        base = isBinaryByte ? 1024 * 1024 * 1024 * 1024L : 1_000_000_000_000L;\n         break;\n \n       case 'p':\n-        base = isBinary ? 1024L * 1024 * 1024 * 1024 * 1024 : 1_000_000_000_000_000L;\n+        base = isBinaryByte ? 1024L * 1024 * 1024 * 1024 * 1024 : 1_000_000_000_000_000L;\n         break;\n \n       default:\n+        lastDigitIndex++;\n         if (!Character.isDigit(unit)) {\n-          throw new IAE(\"invalid character in number[%s]\", number);\n+          throw new IAE(\"Invalid format of number: %s\", rawNumber);\n         }\n         break;\n     }\n \n     try {\n-      if (base > 1 && index >= 0) {\n-        long value = Long.parseLong(number.substring(0, index + 1)) * base;\n-        if (value < base) {\n-          throw new IAE(\"number [%s] overflow\", number);\n-        }\n-        return value;\n-      } else {\n-        return Long.parseLong(number);\n+      long value = Long.parseLong(number.substring(0, lastDigitIndex + 1)) * base;\n+      if (base > 1 && value < base) {\n+        //for base == 1, overflow has been checked in parseLong\n+        throw new IAE(\"Number overflow: %s\", rawNumber);\n       }\n+      return value;\n     }\n     catch (NumberFormatException e) {\n-      throw new IAE(\"invalid format of number[%s]\", number);\n+      throw new IAE(\"Invalid format of number: %s\", rawNumber);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 204}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTcxNjA2Mg==", "bodyText": "Can be final.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461716062", "createdAt": "2020-07-28T16:31:44Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/HumanReadableBytes.java", "diffHunk": "@@ -0,0 +1,210 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+\n+@JsonSerialize(using = HumanReadableBytesSerializer.class)\n+public class HumanReadableBytes implements Serializable\n+{\n+  public static final HumanReadableBytes ZERO = new HumanReadableBytes(0L);\n+\n+  private long bytes;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc2NjA1MQ==", "bodyText": "The custom serializer doesn't seem necessary. AFAIT, this class never gets serialized. In deserializing, Jackson will magically finds the proper constructor depending on the parameter type.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461766051", "createdAt": "2020-07-28T17:53:50Z", "author": {"login": "jihoonson"}, "path": "core/src/main/java/org/apache/druid/java/util/common/HumanReadableBytes.java", "diffHunk": "@@ -0,0 +1,210 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+import java.io.Serializable;\n+\n+@JsonSerialize(using = HumanReadableBytesSerializer.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc2NzQ2OA==", "bodyText": "There is a mismatch in this example and the above statement. It should be 1t.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461767468", "createdAt": "2020-07-28T17:56:04Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,83 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+````\n+druid.cache.sizeInBytes=3000000000 #3 * 1000_000_000\n+````\n+\n+\n+## A number with a unit suffix\n+\n+Sometimes value in bytes could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Here comes another way, a number with a unit suffix.\n+\n+Given the total size of disks is 1T, the configuration can be\n+\n+````\n+druid.segmentCache.locations=[{\"path\":\"/segment-cache\",\"maxSize\":\"1g\"}]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc2OTMzNA==", "bodyText": "nit: this doesn't have to be done in this PR, but I think it would be nice to allow KB, MB, etc as aliases for decimal units.", "url": "https://github.com/apache/druid/pull/10203#discussion_r461769334", "createdAt": "2020-07-28T17:59:04Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,83 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+````\n+druid.cache.sizeInBytes=3000000000 #3 * 1000_000_000\n+````\n+\n+\n+## A number with a unit suffix\n+\n+Sometimes value in bytes could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Here comes another way, a number with a unit suffix.\n+\n+Given the total size of disks is 1T, the configuration can be\n+\n+````\n+druid.segmentCache.locations=[{\"path\":\"/segment-cache\",\"maxSize\":\"1g\"}]\n+````\n+\n+### Supported Units\n+In the world of computer, a unit like `K` is ambiguous. It means 1000 or 1024 in different contexts, for more information please see [Here](https://en.wikipedia.org/wiki/Binary_prefix).\n+\n+To make it clear, the base of units are defined as below\n+\n+| Unit | Description | Base |\n+|---|---|---|\n+| K | Kilo Decimal Byte | 1000 |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c86454be59a1f3f34f2d596a82ea9a3c1a009114"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e43e17a5dccf9dc952565196a2e2e0178c28a786", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/e43e17a5dccf9dc952565196a2e2e0178c28a786", "committedDate": "2020-07-29T03:05:21Z", "message": "resolve code review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/8d971695482878cd7262c5c5921340cd55380ff0", "committedDate": "2020-07-29T10:27:32Z", "message": "improve error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDc1NTAy", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457475502", "createdAt": "2020-07-29T12:34:41Z", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo0MVrOG42U9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo0MVrOG42U9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2MzU0MA==", "bodyText": "The error message is best to be consistent with the previous one. In addition, perhaps it is more appropriate to use blank instead of empty here.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462263540", "createdAt": "2020-07-29T12:34:41Z", "author": {"login": "asdf2014"}, "path": "core/src/main/java/org/apache/druid/java/util/common/HumanReadableBytes.java", "diffHunk": "@@ -0,0 +1,208 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.druid.java.util.common;\n+\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+\n+@JsonSerialize(using = HumanReadableBytesSerializer.class)\n+public class HumanReadableBytes\n+{\n+  public static final HumanReadableBytes ZERO = new HumanReadableBytes(0L);\n+\n+  private final long bytes;\n+\n+  public HumanReadableBytes(String bytes)\n+  {\n+    this.bytes = HumanReadableBytes.parse(bytes);\n+  }\n+\n+  public HumanReadableBytes(long bytes)\n+  {\n+    this.bytes = bytes;\n+  }\n+\n+  public long getBytes()\n+  {\n+    return bytes;\n+  }\n+\n+  public int getBytesInInt()\n+  {\n+    if (bytes > Integer.MAX_VALUE) {\n+      throw new ISE(\"Number overflow\");\n+    }\n+\n+    return (int) bytes;\n+  }\n+\n+  @Override\n+  public boolean equals(Object thatObj)\n+  {\n+    if (thatObj == null) {\n+      return false;\n+    }\n+    if (thatObj instanceof HumanReadableBytes) {\n+      return bytes == ((HumanReadableBytes) thatObj).bytes;\n+    } else {\n+      return false;\n+    }\n+  }\n+\n+  @Override\n+  public int hashCode()\n+  {\n+    return Long.hashCode(bytes);\n+  }\n+\n+  @Override\n+  public String toString()\n+  {\n+    return String.valueOf(bytes);\n+  }\n+\n+  public static HumanReadableBytes valueOf(int bytes)\n+  {\n+    return new HumanReadableBytes(bytes);\n+  }\n+\n+  public static HumanReadableBytes valueOf(long bytes)\n+  {\n+    return new HumanReadableBytes(bytes);\n+  }\n+\n+  public static long parse(String number)\n+  {\n+    if (number == null) {\n+      throw new IAE(\"Invalid format of number: number is null\");\n+    }\n+\n+    number = number.trim();\n+    if (number.length() == 0) {\n+      throw new IAE(\"Invalid format of number: Number is empty\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "originalPosition": 98}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDc1NjEw", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457475610", "createdAt": "2020-07-29T12:34:51Z", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo1MVrOG42VQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo1MVrOG42VQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2MzYxOA==", "bodyText": "There should not be four ` symbols but three.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462263618", "createdAt": "2020-07-29T12:34:51Z", "author": {"login": "asdf2014"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,85 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+````", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDc1NzAy", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457475702", "createdAt": "2020-07-29T12:34:59Z", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo1OVrOG42VkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNDo1OVrOG42VkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2MzY5Nw==", "bodyText": "The type of code block should be specified as properties. The others should be the same.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462263697", "createdAt": "2020-07-29T12:34:59Z", "author": {"login": "asdf2014"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,85 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+````\n+druid.cache.sizeInBytes=3000000000 #3 * 1000_000_000\n+````\n+\n+\n+## A number with a unit suffix\n+\n+Sometimes value in bytes could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Here comes another way, a number with a unit suffix.\n+\n+Given the total size of disks is 1T, the configuration can be\n+\n+````", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDc1ODA4", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457475808", "createdAt": "2020-07-29T12:35:08Z", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNTowOVrOG42V4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjozNTowOVrOG42V4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2Mzc3OQ==", "bodyText": "Please keep this blank line.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462263779", "createdAt": "2020-07-29T12:35:09Z", "author": {"login": "asdf2014"}, "path": "website/.spelling", "diffHunk": "@@ -1771,3 +1774,17 @@ CVE-2019-17571\n CVE-2019-12399\n CVE-2018-17196\n bin.tar.gz\n+ - ../docs/configuration/human-readable-byte.md\n+3G\n+1000_000\n+1000_000_000\n+1000_000_000_000\n+1000_000_000_000_000\n+Giga\n+Tera\n+Peta\n+KiB\n+MiB\n+GiB\n+TiB\n+PiB", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDc2NDEx", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457476411", "createdAt": "2020-07-29T12:35:59Z", "commit": {"oid": "8d971695482878cd7262c5c5921340cd55380ff0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75da8c606a2ef74b5e143b3043bb25e3866f9e5c", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/75da8c606a2ef74b5e143b3043bb25e3866f9e5c", "committedDate": "2020-07-29T13:46:41Z", "message": "improve code & doc according to comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/0123e93f7a0d2a1f3de08daafbb8459ec212d618", "committedDate": "2020-07-29T15:55:40Z", "message": "fix CI problem"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3OTEwNDg1", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-457910485", "createdAt": "2020-07-29T21:27:14Z", "commit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMToyNzoxNFrOG5K1cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMTo1MDozNFrOG5LgWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU5OTUzOA==", "bodyText": "I think in bytes is correct.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462599538", "createdAt": "2020-07-29T21:27:14Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -33,21 +33,22 @@ These properties can be configured through 2 ways:\n \n Given the cache size is 3G, there's a configuration as below\n \n-````\n-druid.cache.sizeInBytes=3000000000 #3 * 1000_000_000\n-````\n+```properties\n+# 3G bytes = 3_000_000_000 bytes\n+druid.cache.sizeInBytes=3000000000 \n+```\n \n \n ## A number with a unit suffix\n \n-Sometimes value in bytes could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Sometimes value in byte could be very large in Druid, it's counterintuitive to set value of these properties as above.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU5OTgxMg==", "bodyText": "Maybe Given a disk of 1T is better.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462599812", "createdAt": "2020-07-29T21:27:48Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -33,21 +33,22 @@ These properties can be configured through 2 ways:\n \n Given the cache size is 3G, there's a configuration as below\n \n-````\n-druid.cache.sizeInBytes=3000000000 #3 * 1000_000_000\n-````\n+```properties\n+# 3G bytes = 3_000_000_000 bytes\n+druid.cache.sizeInBytes=3000000000 \n+```\n \n \n ## A number with a unit suffix\n \n-Sometimes value in bytes could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Sometimes value in byte could be very large in Druid, it's counterintuitive to set value of these properties as above.\n Here comes another way, a number with a unit suffix.\n \n-Given the total size of disks is 1T, the configuration can be\n+Given the size of disk is 1T, the configuration can be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYwMzAzMQ==", "bodyText": "in bytes here too.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462603031", "createdAt": "2020-07-29T21:34:20Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,88 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYwMzc0MQ==", "bodyText": "Same here too.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462603741", "createdAt": "2020-07-29T21:35:48Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,88 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYwNDk5MA==", "bodyText": "I think it should be case-insensitive since it's a single word.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462604990", "createdAt": "2020-07-29T21:38:33Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,88 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+```properties\n+# 3G bytes = 3_000_000_000 bytes\n+druid.cache.sizeInBytes=3000000000 \n+```\n+\n+\n+## A number with a unit suffix\n+\n+Sometimes value in byte could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Here comes another way, a number with a unit suffix.\n+\n+Given the size of disk is 1T, the configuration can be\n+\n+```properties\n+druid.segmentCache.locations=[{\"path\":\"/segment-cache\",\"maxSize\":\"1t\"}]\n+```\n+\n+Note: in above example, both `1t` and `1T` are acceptable since it's case insensitive.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYxMDUyMA==", "bodyText": "Hmm.. I'm not sure whether or not counterintuitive is being used correctly here. AFAIK, it means something which doesn't seems true intuitively but is actually true. Maybe it would be more clear by rephrasing this paragraph to When you have to put a large number for some configuration, it is easy to make a mistake such as extra or missing 0s. Druid supports a better way, a number with a unit suffix.", "url": "https://github.com/apache/druid/pull/10203#discussion_r462610520", "createdAt": "2020-07-29T21:50:34Z", "author": {"login": "jihoonson"}, "path": "docs/configuration/human-readable-byte.md", "diffHunk": "@@ -0,0 +1,88 @@\n+---\n+id: human-readable-byte\n+title: \"Human-readable Byte Configuration Reference\"\n+---\n+\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  -->\n+\n+\n+This page documents all configuration properties related to bytes.\n+\n+These properties can be configured through 2 ways: \n+1. a simple number in byte\n+2. a number with a unit suffix\n+\n+## A number in byte\n+\n+Given the cache size is 3G, there's a configuration as below\n+\n+```properties\n+# 3G bytes = 3_000_000_000 bytes\n+druid.cache.sizeInBytes=3000000000 \n+```\n+\n+\n+## A number with a unit suffix\n+\n+Sometimes value in byte could be very large in Druid, it's counterintuitive to set value of these properties as above.\n+Here comes another way, a number with a unit suffix.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0123e93f7a0d2a1f3de08daafbb8459ec212d618"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a78b55cb8fcfc65554f17eabffd8bae821d07026", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/a78b55cb8fcfc65554f17eabffd8bae821d07026", "committedDate": "2020-07-30T05:29:10Z", "message": "improve doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36638034e16a2c40235062385fb6b09e842d3f71", "author": {"user": {"login": "FrankChen021", "name": "Frank Chen"}}, "url": "https://github.com/apache/druid/commit/36638034e16a2c40235062385fb6b09e842d3f71", "committedDate": "2020-07-30T09:43:14Z", "message": "suppress spelling check errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NzY1MTU4", "url": "https://github.com/apache/druid/pull/10203#pullrequestreview-458765158", "createdAt": "2020-07-30T21:20:58Z", "commit": {"oid": "36638034e16a2c40235062385fb6b09e842d3f71"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1874, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}