{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NjA2NTM5", "number": 435, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MToyOFrOEsff3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowNToyOFrOExFDEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg4ODYzOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MToyOVrOHfw53g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjo1MjoyM1rOHnA5_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTE1MA==", "bodyText": "add licence header", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503069150", "createdAt": "2020-10-12T06:41:29Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzcyNTgyNA==", "bodyText": "License header has been added", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503725824", "createdAt": "2020-10-13T07:28:40Z", "author": {"login": "MithraicMagic"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTE1MA=="}, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3MTM1Nw==", "bodyText": "Move the licence header to the top of the file", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510671357", "createdAt": "2020-10-23T06:52:23Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTE1MA=="}, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5MjExOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MjozM1rOHfw7sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MjozM1rOHfw7sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTYxOQ==", "bodyText": "Remove this line", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503069619", "createdAt": "2020-10-12T06:42:33Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5MzY1OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MzoxOFrOHfw8pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MzoxOFrOHfw8pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTg2Mg==", "bodyText": "rename the field to argumentRequestMessage", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503069862", "createdAt": "2020-10-12T06:43:18Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5NDI1OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MzozMVrOHfw8-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0MzozMVrOHfw8-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA2OTk0Nw==", "bodyText": "rename the field to argumentResponseMessage", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503069947", "createdAt": "2020-10-12T06:43:31Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5NDkyOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0Mzo1NVrOHfw9Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNzo1NTo1NFrOHgZ_kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MDA1NA==", "bodyText": "give this field a descriptive name like argumentMessageType", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503070054", "createdAt": "2020-10-12T06:43:55Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0MjM1Mw==", "bodyText": "Renamed this field and added a new argumentDeviceIdentification field, since argumentStringOne was used for capturing both messageType and deviceIdentification.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503742353", "createdAt": "2020-10-13T07:55:54Z", "author": {"login": "MithraicMagic"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MDA1NA=="}, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5NzEzOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NDo0OFrOHfw-yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NDo0OFrOHfw-yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MDQwOQ==", "bodyText": "give this field a descriptive name like argumentIpAddress", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503070409", "createdAt": "2020-10-12T06:44:48Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringTwo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDg5Nzg4OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NTowMFrOHfw_Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NTowMFrOHfw_Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MDUwMw==", "bodyText": "give this field a descriptive name like argumentPriority", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503070503", "createdAt": "2020-10-12T06:45:00Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringTwo;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<Integer> argumentInt;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDkwNDYyOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NzoyM1rOHfxC5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0NzoyM1rOHfxC5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MTQ2Mg==", "bodyText": "rename expectedRM to expectedRequestMessage (also in other tests)\nrefactor the creation of a request message to a method, so it can be used in other tests as well", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503071462", "createdAt": "2020-10-12T06:47:23Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringTwo;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<Integer> argumentInt;\n+\n+\t@BeforeEach\n+\tpublic void init() throws UnknownEntityException {\n+\t\twhen(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+\t}\n+\t\n+\t@Test\n+\tpublic void testSetEventNotifications() throws FunctionalException {\n+\t\tfinal List<EventNotificationType> eventNotifications = Arrays.asList(\n+\t\t\t\tEventNotificationType.COMM_EVENTS,\n+\t\t\t\tEventNotificationType.DIAG_EVENTS);\n+\t\tfinal Device device = mock(Device.class);\n+\t\twhen(device.getIpAddress()).thenReturn(\"testIp\");\n+\t\twhen(this.deviceDomainService.searchActiveDevice(\"testDevice\", ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\t\t\n+\t\tthis.deviceManagementService.setEventNotifications(\"testOrganisation\", \"testDevice\", \"testUid\",\n+\t\t\t\teventNotifications, \"testMessageType\", 1);\n+\n+\t\tverify(this.osgpCoreRequestManager).send(this.argumentReqM.capture(), this.argumentStringOne.capture(),\n+\t\t\t\tthis.argumentInt.capture(), this.argumentStringTwo.capture());\n+\n+\t\tfinal RequestMessage expectedRM = new RequestMessage(\"testUid\", \"testOrganisation\", \"testDevice\",\n+\t\t\t\tnew EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+\t\t\t\t\t\torg.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1MDkwODY5OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0OTowMFrOHfxFKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNjo0OTowMFrOHfxFKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA3MjA0MQ==", "bodyText": "refactor values you are going to check on in the assert part of the tests to constants", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r503072041", "createdAt": "2020-10-12T06:49:00Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,217 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.mockito.junit.jupiter.MockitoSettings;\n+import org.mockito.quality.Strictness;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+@ExtendWith(MockitoExtension.class)\n+@MockitoSettings(strictness = Strictness.LENIENT)\n+public class DeviceManagementServiceTest {\n+\t\n+\t@Mock\n+\tprivate TransactionalDeviceService transactionalDeviceService;\n+\t\n+\t@Mock\n+\tprivate DeviceDomainService deviceDomainService;\n+\t\n+\t@Mock\n+\tprivate DomainCoreMapper domainCoreMapper;\n+\t\n+\t@Mock\n+\tprivate OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\t\n+\t@Mock\n+\tprivate WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+\t@Mock\n+\tprivate OrganisationDomainService organisationDomainService;\n+\t\n+\t@InjectMocks\n+\tprivate DeviceManagementService deviceManagementService;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<RequestMessage> argumentReqM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<ResponseMessage> argumentResM;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringOne;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<String> argumentStringTwo;\n+\n+\t@Captor\n+\tprivate ArgumentCaptor<Integer> argumentInt;\n+\n+\t@BeforeEach\n+\tpublic void init() throws UnknownEntityException {\n+\t\twhen(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+\t}\n+\t\n+\t@Test\n+\tpublic void testSetEventNotifications() throws FunctionalException {\n+\t\tfinal List<EventNotificationType> eventNotifications = Arrays.asList(\n+\t\t\t\tEventNotificationType.COMM_EVENTS,\n+\t\t\t\tEventNotificationType.DIAG_EVENTS);\n+\t\tfinal Device device = mock(Device.class);\n+\t\twhen(device.getIpAddress()).thenReturn(\"testIp\");\n+\t\twhen(this.deviceDomainService.searchActiveDevice(\"testDevice\", ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\t\t\n+\t\tthis.deviceManagementService.setEventNotifications(\"testOrganisation\", \"testDevice\", \"testUid\",\n+\t\t\t\teventNotifications, \"testMessageType\", 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "042bc2f3426827e05795a38d7afd4c2be234dc35"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk0Mzc2OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjo1MTo0OVrOHnA4_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjo1MTo0OVrOHnA4_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3MTEwMw==", "bodyText": "Formatting is not ok, check your settings.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510671103", "createdAt": "2020-10-23T06:51:49Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3MDQ1OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMTowMFrOHnBIZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMTowMFrOHnBIZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NTA0Nw==", "bodyText": "import EventNotificationTypeDto so you don't need to give the package name here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510675047", "createdAt": "2020-10-23T07:01:00Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 119}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3MzMxOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMTo1N1rOHnBKDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMTo1N1rOHnBKDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NTQ2OA==", "bodyText": "Refactor 1 to a constant TEST_PRIORITY", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510675468", "createdAt": "2020-10-23T07:01:57Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 112}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3NjI3OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzowNFrOHnBLxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzowNFrOHnBLxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NTkwOA==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510675908", "createdAt": "2020-10-23T07:03:04Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3NjY4OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzoxM1rOHnBMBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzoxM1rOHnBMBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NTk3NA==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510675974", "createdAt": "2020-10-23T07:03:13Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 130}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3NzI2OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzoyNlrOHnBMXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzoyNlrOHnBMXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NjA2Mg==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510676062", "createdAt": "2020-10-23T07:03:26Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3NzcyOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzozOVrOHnBMrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzozOVrOHnBMrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NjE0Mw==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510676143", "createdAt": "2020-10-23T07:03:39Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(this.domainCoreMapper.map(certification,\n+                org.opensmartgridplatform.dto.valueobjects.CertificationDto.class));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 154}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3ODE5OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzo0OFrOHnBM-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzo0OFrOHnBM-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NjIxNw==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510676217", "createdAt": "2020-10-23T07:03:48Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(this.domainCoreMapper.map(certification,\n+                org.opensmartgridplatform.dto.valueobjects.CertificationDto.class));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testSetDeviceVerificationKeyIsNull() throws FunctionalException {\n+        this.deviceManagementService.setDeviceVerificationKey(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 161}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3ODY5OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzo1OVrOHnBNRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowMzo1OVrOHnBNRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NjI5Mw==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510676293", "createdAt": "2020-10-23T07:03:59Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(this.domainCoreMapper.map(certification,\n+                org.opensmartgridplatform.dto.valueobjects.CertificationDto.class));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testSetDeviceVerificationKeyIsNull() throws FunctionalException {\n+        this.deviceManagementService.setDeviceVerificationKey(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the verification\n+        verifyNoInteractions(this.osgpCoreRequestManager);\n+    }\n+\n+    @Test\n+    public void testSetDeviceVerificationKey() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        this.deviceManagementService.setDeviceVerificationKey(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, \"testKey\",\n+                TEST_MESSAGE_TYPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 173}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk3OTI1OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowNDowOFrOHnBNjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowNDowOFrOHnBNjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NjM2Nw==", "bodyText": "use TEST_PRIORITY here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510676367", "createdAt": "2020-10-23T07:04:08Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(this.domainCoreMapper.map(certification,\n+                org.opensmartgridplatform.dto.valueobjects.CertificationDto.class));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testSetDeviceVerificationKeyIsNull() throws FunctionalException {\n+        this.deviceManagementService.setDeviceVerificationKey(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the verification\n+        verifyNoInteractions(this.osgpCoreRequestManager);\n+    }\n+\n+    @Test\n+    public void testSetDeviceVerificationKey() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        this.deviceManagementService.setDeviceVerificationKey(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, \"testKey\",\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\"testKey\");\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 182}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODk4Mzg0OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowNToyOFrOHnBQFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzowNToyOFrOHnBQFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NzAxMw==", "bodyText": "import CertificationDto so you don't need to give the package name here", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/435#discussion_r510677013", "createdAt": "2020-10-23T07:05:28Z", "author": {"login": "robindenadel"}, "path": "osgp/platform/osgp-adapter-domain-core/src/test/java/org/opensmartgridplatform/adapter/domain/core/application/services/DeviceManagementServiceTest.java", "diffHunk": "@@ -0,0 +1,231 @@\n+package org.opensmartgridplatform.adapter.domain.core.application.services;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.verifyNoInteractions;\n+import static org.mockito.Mockito.when;\n+\n+import java.io.Serializable;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+import org.mockito.ArgumentCaptor;\n+import org.mockito.Captor;\n+import org.mockito.InjectMocks;\n+import org.mockito.Mock;\n+import org.mockito.junit.jupiter.MockitoExtension;\n+import org.opensmartgridplatform.adapter.domain.core.application.mapping.DomainCoreMapper;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.core.OsgpCoreRequestMessageSender;\n+import org.opensmartgridplatform.adapter.domain.core.infra.jms.ws.WebServiceResponseMessageSender;\n+import org.opensmartgridplatform.domain.core.entities.Device;\n+import org.opensmartgridplatform.domain.core.entities.Organisation;\n+import org.opensmartgridplatform.domain.core.exceptions.UnknownEntityException;\n+import org.opensmartgridplatform.domain.core.services.DeviceDomainService;\n+import org.opensmartgridplatform.domain.core.services.OrganisationDomainService;\n+import org.opensmartgridplatform.domain.core.valueobjects.CdmaSettings;\n+import org.opensmartgridplatform.domain.core.valueobjects.Certification;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceLifecycleStatus;\n+import org.opensmartgridplatform.domain.core.valueobjects.EventNotificationType;\n+import org.opensmartgridplatform.dto.valueobjects.EventNotificationMessageDataContainerDto;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.infra.jms.RequestMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessage;\n+import org.opensmartgridplatform.shared.infra.jms.ResponseMessageResultType;\n+\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+\n+@ExtendWith(MockitoExtension.class)\n+public class DeviceManagementServiceTest {\n+\n+    private static final String TEST_ORGANISATION = \"testOrganisation\";\n+    private static final String TEST_DEVICE = \"testDevice\";\n+    private static final String TEST_IP = \"testIp\";\n+    private static final String TEST_UID = \"testUid\";\n+    private static final String TEST_MESSAGE_TYPE = \"testMessageType\";\n+\n+    @Mock\n+    private TransactionalDeviceService transactionalDeviceService;\n+\n+    @Mock\n+    private DeviceDomainService deviceDomainService;\n+\n+    @Mock\n+    private DomainCoreMapper domainCoreMapper;\n+\n+    @Mock\n+    private OsgpCoreRequestMessageSender osgpCoreRequestManager;\n+\n+    @Mock\n+    private WebServiceResponseMessageSender webServiceResponseMessageSender;\n+\n+    @Mock\n+    private OrganisationDomainService organisationDomainService;\n+\n+    @InjectMocks\n+    private DeviceManagementService deviceManagementService;\n+\n+    @Captor\n+    private ArgumentCaptor<RequestMessage> argumentRequestMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<ResponseMessage> argumentResponseMessage;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentMessageType;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentIpAddress;\n+\n+    @Captor\n+    private ArgumentCaptor<String> argumentDeviceIdentification;\n+\n+    @Captor\n+    private ArgumentCaptor<Integer> argumentPriority;\n+\n+    @BeforeEach\n+    public void init() throws UnknownEntityException {\n+        when(this.organisationDomainService.searchOrganisation(any())).thenReturn(new Organisation());\n+    }\n+\n+    @Test\n+    public void testSetEventNotifications() throws FunctionalException {\n+        final List<EventNotificationType> eventNotifications = Arrays.asList(EventNotificationType.COMM_EVENTS,\n+                EventNotificationType.DIAG_EVENTS);\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+\n+        this.deviceManagementService.setEventNotifications(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                eventNotifications, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(\n+                new EventNotificationMessageDataContainerDto(this.domainCoreMapper.mapAsList(eventNotifications,\n+                        org.opensmartgridplatform.dto.valueobjects.EventNotificationTypeDto.class)));\n+\n+        assertThat(this.argumentRequestMessage.getValue()).usingRecursiveComparison().isEqualTo(expectedRequestMessage);\n+        assertThat(this.argumentMessageType.getValue()).isEqualTo(TEST_MESSAGE_TYPE);\n+        assertThat(this.argumentPriority.getValue()).isEqualTo(1);\n+        assertThat(this.argumentIpAddress.getValue()).isEqualTo(TEST_IP);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertificationIsNull() throws FunctionalException {\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID, null,\n+                TEST_MESSAGE_TYPE, 1);\n+\n+        //This method is not called since it comes after the check of the certificate\n+        verifyNoInteractions(this.domainCoreMapper);\n+    }\n+\n+    @Test\n+    public void testUpdateDeviceSslCertification() throws FunctionalException {\n+        final Device device = mock(Device.class);\n+        when(device.getIpAddress()).thenReturn(TEST_IP);\n+        when(this.deviceDomainService.searchActiveDevice(TEST_DEVICE, ComponentType.DOMAIN_CORE)).thenReturn(device);\n+        final Certification certification = new Certification(\"testUrl\", \"testDomain\");\n+\n+        this.deviceManagementService.updateDeviceSslCertification(TEST_ORGANISATION, TEST_DEVICE, TEST_UID,\n+                certification, TEST_MESSAGE_TYPE, 1);\n+\n+        verify(this.osgpCoreRequestManager).send(this.argumentRequestMessage.capture(),\n+                this.argumentMessageType.capture(), this.argumentPriority.capture(), this.argumentIpAddress.capture());\n+\n+        final RequestMessage expectedRequestMessage = this.createNewRequestMessage(this.domainCoreMapper.map(certification,\n+                org.opensmartgridplatform.dto.valueobjects.CertificationDto.class));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f55fc92905535fe980310db71a46bfe40f21259a"}, "originalPosition": 150}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3511, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}