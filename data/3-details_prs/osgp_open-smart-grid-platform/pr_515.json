{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMzY0OTMy", "number": 515, "title": "Feature/slim 2323 get outages", "bodyText": "implementation of GetOutages which reads the meters power failure event log and returns all entries.", "createdAt": "2020-11-17T12:16:19Z", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515", "merged": true, "mergeCommit": {"oid": "df17e52dd554e7cef12a59b9b93b4caee92e766e"}, "closed": true, "closedAt": "2020-11-25T14:55:52Z", "author": {"login": "jboon"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbyN_4AH2gAyNTIyMzY0OTMyOmMzY2VjNGY3Yzc5YjMwYWQ1NTVkMjkyOGIzYzkzYjYxODQxYjkzYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdf_ARMAH2gAyNTIyMzY0OTMyOmYyZjMxMzA4NjRiYjg3ZjMyODUwOTA4ZDgzMjhjYWRhYjBhYjM2YmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c3cec4f7c79b30ad555d2928b3c93b61841b93bb", "author": {"user": {"login": "kroesctrl", "name": "Gerben Kroes"}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/c3cec4f7c79b30ad555d2928b3c93b61841b93bb", "committedDate": "2020-11-12T13:03:44Z", "message": "Added GetOutages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "675f939f4e6bd37e71ab69280a5b7b4dbc1a7979", "author": {"user": {"login": "harrymiddelburgetall", "name": "Harry Middelburg"}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/675f939f4e6bd37e71ab69280a5b7b4dbc1a7979", "committedDate": "2020-11-12T18:01:37Z", "message": "First implementation of GetOutages in DLMS adapter protocol"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40f859dfeed4271e81853c7a31982c02fb091d34", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/40f859dfeed4271e81853c7a31982c02fb091d34", "committedDate": "2020-11-12T21:59:04Z", "message": "added bundle request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba62679b481ed1b102275b1162b9bc4cabdf9e91", "author": {"user": {"login": "kroesctrl", "name": "Gerben Kroes"}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/ba62679b481ed1b102275b1162b9bc4cabdf9e91", "committedDate": "2020-11-13T14:12:35Z", "message": "Changed to Get Outages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43cf13050a409b23c17f38ab25f91d1b0e5624ad", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/43cf13050a409b23c17f38ab25f91d1b0e5624ad", "committedDate": "2020-11-13T19:09:26Z", "message": "request mapping and authorization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bed213cfd83fa2958443bb16d975d12d2855b0af", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/bed213cfd83fa2958443bb16d975d12d2855b0af", "committedDate": "2020-11-17T12:13:44Z", "message": "mapping and converting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08e4ce28cb5c6687add02f8d1879497b4c521f90", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/08e4ce28cb5c6687add02f8d1879497b4c521f90", "committedDate": "2020-11-17T15:31:23Z", "message": "added GetOutagesResponse to possible result objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/3e199c78f633cc37bd741834b2b9812c05440ebc", "committedDate": "2020-11-17T20:41:29Z", "message": "removed power failure feature from FindEvents; added cucumber tests for GetOutages through bundle process"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMTQ1MTA2", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533145106", "createdAt": "2020-11-18T06:50:06Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1MDowNlrOH1fUvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzowMzo0MVrOH1foMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg0OTc5MQ==", "bodyText": "back to \"normal\" +1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525849791", "createdAt": "2020-11-18T06:50:06Z", "author": {"login": "coendamen"}, "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/mapping/EventConverter.java", "diffHunk": "@@ -47,8 +47,6 @@\n             event.setTimestamp(timestamp);\n             event.setEventCounter(source.getEventCounter());\n             event.setEventLogCategory(EventLogCategory.fromValue(source.getEventLogCategory().name()));\n-            event.setDuration(source.getDuration());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDI1Nw==", "bodyText": "there is no validation code here? not needed ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525850257", "createdAt": "2020-11-18T06:51:17Z", "author": {"login": "coendamen"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */\n+    @Override\n+    public void validate() throws FunctionalException {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDU4Ng==", "bodyText": "this was bad !", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525850586", "createdAt": "2020-11-18T06:52:16Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToEventListConverter.java", "diffHunk": "@@ -63,64 +64,30 @@ private EventDto getDefaultEvent(final DataObject eventDataObject, final EventLo\n                     \"eventData size should be \" + eventLogCategory.getNumberOfEventElements());\n         }\n \n-        EventDto event = null;\n-\n-        if (eventLogCategory == EventLogCategoryDto.POWER_FAILURE_EVENT_LOG) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTUyMA==", "bodyText": "possible NPE here? can eventData.get(0) value be null itself ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525851520", "createdAt": "2020-11-18T06:54:49Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToOutageListConverter.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.adapter.protocol.dlms.application.mapping;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.DateTime;\n+import org.openmuc.jdlms.datatypes.DataObject;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.commands.utils.DlmsHelper;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ProtocolAdapterException;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.GetOutagesRequestDto;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.OutageDto;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Slf4j\n+@Component(value = \"dataObjectToOutageListConverter\")\n+public class DataObjectToOutageListConverter {\n+\n+    private static final String EVENT_DATA_VALUE_IS_NOT_A_NUMBER = \"eventData value is not a number\";\n+    private static final int NUMBER_OF_ELEMENTS = 2;\n+    private final DlmsHelper dlmsHelper;\n+\n+    @Autowired\n+    public DataObjectToOutageListConverter(final DlmsHelper dlmsHelper) {\n+        this.dlmsHelper = dlmsHelper;\n+    }\n+\n+    public List<OutageDto> convert(final DataObject source, final GetOutagesRequestDto getOutagesRequestDto)\n+            throws ProtocolAdapterException {\n+        final List<OutageDto> eventList = new ArrayList<OutageDto>();\n+        if (source == null) {\n+            throw new ProtocolAdapterException(\"DataObject should not be null\");\n+        }\n+\n+        final List<DataObject> dataObjects = source.getValue();\n+        for (final DataObject dataObject : dataObjects) {\n+            eventList.add(this.getOutageDto(dataObject));\n+        }\n+\n+        return eventList;\n+\n+    }\n+\n+    private OutageDto getOutageDto(final DataObject outageDataObject) throws ProtocolAdapterException {\n+\n+        final List<DataObject> outageData = outageDataObject.getValue();\n+\n+        if (outageData == null) {\n+            throw new ProtocolAdapterException(\"outageData DataObject should not be null\");\n+        }\n+\n+        if (outageData.size() != NUMBER_OF_ELEMENTS) {\n+            throw new ProtocolAdapterException(\"outageData size should be \" + NUMBER_OF_ELEMENTS);\n+        }\n+\n+        final DateTime endTime = this.extractDateTime(outageData);\n+        final Long duration = this.extractEventDuration(outageData);\n+\n+        OutageDto outage = new OutageDto(endTime, duration);\n+\n+        log.info(\"Converted dataObject to outage: {}\", outage);\n+        return outage;\n+    }\n+\n+    private DateTime extractDateTime(final List<DataObject> eventData) throws ProtocolAdapterException {\n+        final DateTime dateTime = this.dlmsHelper.convertDataObjectToDateTime(eventData.get(0)).asDateTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTg5OA==", "bodyText": "could be removed or changed to debug ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525851898", "createdAt": "2020-11-18T06:55:46Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MjM0NQ==", "bodyText": "there can be more getOutageRequest at the same time? this seems strange, normally there is one request executed in the command executor", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525852345", "createdAt": "2020-11-18T06:56:57Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());\n+\n+        for (final GetOutagesRequestDto getOutagesRequestDto : getOutagesRequestList.getGetOutagesRequestList()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDE3Mg==", "bodyText": "for my understanding, why is there a request list? and not a single request to get the outages from a meter?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525854172", "createdAt": "2020-11-18T07:01:57Z", "author": {"login": "coendamen"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.dto.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+import java.util.List;\n+\n+public class GetOutagesRequestList implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDc3MA==", "bodyText": "minOccurs=\"1\" maxOccurs=\"1\" can be ommitted as they are the default.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525854770", "createdAt": "2020-11-18T07:03:41Z", "author": {"login": "coendamen"}, "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-management.xsd", "diffHunk": "@@ -28,6 +28,36 @@\n     </xsd:complexType>\n   </xsd:element>\n \n+  <xsd:complexType name=\"GetOutagesRequestData\">\n+    <xsd:complexContent>\n+      <xsd:extension base=\"common:Query\">\n+        <xsd:sequence>\n+        </xsd:sequence>\n+      </xsd:extension>\n+    </xsd:complexContent>\n+  </xsd:complexType>\n+\n+  <!-- Outage containing endTime and duration -->\n+  <xsd:complexType name=\"Outage\">\n+    <xsd:sequence>\n+      <xsd:element name=\"endTime\" type=\"xsd:dateTime\"\n+                   minOccurs=\"1\" maxOccurs=\"1\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMTYzNzcw", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533163770", "createdAt": "2020-11-18T07:29:08Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzoyOTowOVrOH1gOxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzozMToxNFrOH1gSog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg2NDY0Ng==", "bodyText": "Shouldn't it be possible to get this type of events with the FindEvents request?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525864646", "createdAt": "2020-11-18T07:29:09Z", "author": {"login": "harrymiddelburgetall"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/FindEventsCommandExecutor.java", "diffHunk": "@@ -65,7 +65,6 @@\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.COMMUNICATION_SESSION_LOG, new ObisCode(\"0.0.99.98.4.255\"));\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.M_BUS_EVENT_LOG,           new ObisCode(\"0.0.99.98.3.255\"));\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.POWER_QUALITY_EVENT_LOG,   new ObisCode(\"0.0.99.98.5.255\"));\n-        EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.POWER_FAILURE_EVENT_LOG,   new ObisCode(\"1.0.99.97.0.255\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg2NTYzNA==", "bodyText": "Shouldn't it be possible to get this type of events with the FindEvents request?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525865634", "createdAt": "2020-11-18T07:31:14Z", "author": {"login": "harrymiddelburgetall"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/EventLogCategoryDto.java", "diffHunk": "@@ -12,8 +12,7 @@\n     FRAUD_DETECTION_LOG(2),\n     COMMUNICATION_SESSION_LOG(3),\n     M_BUS_EVENT_LOG(2),\n-    POWER_QUALITY_EVENT_LOG(2),\n-    POWER_FAILURE_EVENT_LOG(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNTEwNTI4", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533510528", "createdAt": "2020-11-18T14:38:15Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDozODoxNlrOH1w3bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDozODoxNlrOH1w3bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEzNzE5Nw==", "bodyText": "This seemed like a perfectly logical place to handle the events from the power failure event log in the platform.\nIt is right between other event logs as described in DSMR 4.\nI'll leave this point at the comment here, but this would apply to all code changes replacing power failure event log by outages in GXF.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526137197", "createdAt": "2020-11-18T14:38:16Z", "author": {"login": "bvdzwet"}, "path": "integration-tests/cucumber-tests-platform-smartmetering/src/test/resources/features/osgp-adapter-ws-smartmetering/management/FindEvents.feature", "diffHunk": "@@ -48,11 +48,3 @@ Feature: SmartMetering Management - Find Events\n       | EndDate              | 2015-09-05T00:00:00.000Z |\n     Then 29 mbus events should be returned\n       | DeviceIdentification | TEST1024000000001 |\n-\n-  Scenario: find power failure events from a device", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNTkxNjc1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533591675", "createdAt": "2020-11-18T15:53:40Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNTo1Mzo0MVrOH10lHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNTo1Mzo0MVrOH10lHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE5ODA0Ng==", "bodyText": "Formatting is messed up, and if this is the only change, I wonder why this file is included in this pull request at all.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526198046", "createdAt": "2020-11-18T15:53:41Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-adapter-ws-shared/src/main/java/org/opensmartgridplatform/adapter/ws/shared/services/ResponseDataService.java", "diffHunk": "@@ -1,4 +1,4 @@\n-/**\n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjYxOTE5", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533661919", "createdAt": "2020-11-18T17:01:17Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzowMToxN1rOH134wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzowMToxN1rOH134wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI1MjIyNg==", "bodyText": "According to our way of working agreements, ending the version part of Flyway changes with a bunch of zeros should be avoided, to prevent the risk of conflicts.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526252226", "createdAt": "2020-11-18T17:01:17Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-core/src/main/resources/db/migration/V20201113200000000__Add_get_outages_to_device_function_mapping.sql", "diffHunk": "@@ -0,0 +1,10 @@\n+DO", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjcwODc1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533670875", "createdAt": "2020-11-18T17:10:10Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMDoxMVrOH14S7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMDoxMVrOH14S7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI1ODkyNA==", "bodyText": "Besides this change, that is tied to the decision between outages and power failure event logs, I noticed someone messed up the line endings of this file a year and four months ago.\nLine endings should only be newlines, not Windows style carriage return plus newline.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526258924", "createdAt": "2020-11-18T17:10:11Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/EventLogCategory.java", "diffHunk": "@@ -15,8 +15,7 @@\n     FRAUD_DETECTION_LOG,\r\n     COMMUNICATION_SESSION_LOG,\r\n     M_BUS_EVENT_LOG,\r\n-    POWER_QUALITY_EVENT_LOG,\r\n-    POWER_FAILURE_EVENT_LOG;\r\n+    POWER_QUALITY_EVENT_LOG;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjczMzMw", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533673330", "createdAt": "2020-11-18T17:12:18Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMjoxOVrOH14ZJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMjoxOVrOH14ZJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2MDUxOA==", "bodyText": "This file looks like it is new. In that case the copyright has the wrong name and year.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526260518", "createdAt": "2020-11-18T17:12:19Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNjg3MDQ0", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533687044", "createdAt": "2020-11-18T17:23:07Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoyMzowN1rOH143hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoyMzowN1rOH143hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2ODI5NA==", "bodyText": "For me, comments like this look like they haven't got something useful to offer over not adding anything.\nYou could consider leaving it out.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526268294", "createdAt": "2020-11-18T17:23:07Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzE1ODg1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533715885", "createdAt": "2020-11-18T17:42:23Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0MjoyM1rOH16c1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0MjoyM1rOH16c1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NDIyOQ==", "bodyText": "Code is not formatted according the conventions, missing final modifiers here.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526294229", "createdAt": "2020-11-18T17:42:23Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzIxMjA1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533721205", "createdAt": "2020-11-18T17:48:35Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0ODozNVrOH16siQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0ODozNVrOH16siQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5ODI0OQ==", "bodyText": "This license header is sometimes added with, sometimes without this \"empty line\" (just the asterisk). It looks a bit sloppy, and I think leaving the empty line out best fits the guidelines.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526298249", "createdAt": "2020-11-18T17:48:35Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/GetOutagesCommandExecutor.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzI3ODIz", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533727823", "createdAt": "2020-11-18T17:54:08Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NDowOVrOH168xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NDowOVrOH168xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwMjQwNQ==", "bodyText": "This file looks new, copyright should be for Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526302405", "createdAt": "2020-11-18T17:54:09Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/infra/messaging/processors/GetOutagesRequestMessageProcessor.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzMwMzA3", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533730307", "createdAt": "2020-11-18T17:56:58Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1Njo1OFrOH17HsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1Njo1OFrOH17HsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwNTIwMA==", "bodyText": "Looks like this should mention Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526305200", "createdAt": "2020-11-18T17:56:58Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestDto.java", "diffHunk": "@@ -0,0 +1,13 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzMwODg3", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533730887", "createdAt": "2020-11-18T17:57:36Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NzozNlrOH17JcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NzozNlrOH17JcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwNTY0OA==", "bodyText": "Looks like this should mention Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526305648", "createdAt": "2020-11-18T17:57:36Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzM2NDQ3", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533736447", "createdAt": "2020-11-18T18:04:12Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxODowNDoxMlrOH17Z4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxODowNDoxMlrOH17Z4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwOTg1Ng==", "bodyText": "My remarks about events versus outages aside, it seems illogical to replace FindEventsRequest by GetOutagesRequest while adding the GetOutagesResponse as an alternative to the FindEventsResponse.\nIs this a mistake or am I missing something where these two requests and responses don't have to match in pairs?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526309856", "createdAt": "2020-11-18T18:04:12Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-external-interface.xsd", "diffHunk": "@@ -28,7 +28,7 @@\n           <xsd:element ref=\"bun:GetPeriodicMeterReadsRequest\"/>\n           <xsd:element ref=\"bun:GetPowerQualityProfileRequest\"/>\n           <xsd:element ref=\"adm:SetMaintenanceStateRequest\"/>\n-          <xsd:element ref=\"bun:FindEventsRequest\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzM5NjU3", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#pullrequestreview-533739657", "createdAt": "2020-11-18T18:08:18Z", "commit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24261415e053cd7ced5e29427218ef0fc28ec113", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/24261415e053cd7ced5e29427218ef0fc28ec113", "committedDate": "2020-11-19T16:37:21Z", "message": "review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef4d60b54d98c240df43507571ae43f6fefd24bd", "author": {"user": {"login": "kroesctrl", "name": "Gerben Kroes"}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/ef4d60b54d98c240df43507571ae43f6fefd24bd", "committedDate": "2020-11-20T15:47:47Z", "message": "Fix by Carlo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5e9a6156326ae771a1294c3c21a9ee5a4b8e27f", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/a5e9a6156326ae771a1294c3c21a9ee5a4b8e27f", "committedDate": "2020-11-25T07:55:21Z", "message": "trigger build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c62be8cbcc8e294b6243eac882981ac482a17d31", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/c62be8cbcc8e294b6243eac882981ac482a17d31", "committedDate": "2020-11-25T11:13:16Z", "message": "Merge branch 'development' into feature/SLIM-2323_get_outages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2f3130864bb87f32850908d8328cadab0ab36bb", "author": {"user": {"login": "jboon", "name": null}}, "url": "https://github.com/OSGP/open-smart-grid-platform/commit/f2f3130864bb87f32850908d8328cadab0ab36bb", "committedDate": "2020-11-25T14:13:12Z", "message": "rolledback to development version"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3741, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}