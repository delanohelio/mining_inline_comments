{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMzY0OTMy", "number": 515, "reviewThreads": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1MDowNlrOE6a-1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxODowNDoxMlrOE6st9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk0OTMzOnYy", "diffSide": "LEFT", "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/mapping/EventConverter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1MDowNlrOH1fUvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNToyMzowN1rOH1zCmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg0OTc5MQ==", "bodyText": "back to \"normal\" +1", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525849791", "createdAt": "2020-11-18T06:50:06Z", "author": {"login": "coendamen"}, "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/mapping/EventConverter.java", "diffHunk": "@@ -47,8 +47,6 @@\n             event.setTimestamp(timestamp);\n             event.setEventCounter(source.getEventCounter());\n             event.setEventLogCategory(EventLogCategory.fromValue(source.getEventLogCategory().name()));\n-            event.setDuration(source.getDuration());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE3MjgyNw==", "bodyText": "I agree this makes the event converter a little less overloaded and simpler.\nHowever, it comes at the expense of breaking the larger context, in which events have different properties, by setting the power outages apart from other events as some more special case. I think they are just one other example of an event and a cleaner solution would leave the overall idea of the event intact.\nFor instance, the communication session events have a counter, that none of the other events from the other event logs have.\nThe power failure events have a duration, and do not share an event code that events from the other logs have.\nThe only property all events have is some event timestamp (though the meaning of this timestamp is derived from the context of the event log).", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526172827", "createdAt": "2020-11-18T15:23:07Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-adapter-ws-smartmetering/src/main/java/org/opensmartgridplatform/adapter/ws/smartmetering/application/mapping/EventConverter.java", "diffHunk": "@@ -47,8 +47,6 @@\n             event.setTimestamp(timestamp);\n             event.setEventCounter(source.getEventCounter());\n             event.setEventLogCategory(EventLogCategory.fromValue(source.getEventLogCategory().name()));\n-            event.setDuration(source.getDuration());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg0OTc5MQ=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk1MjUwOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1MToxN1rOH1fWkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDowNDo1MVrOH2gHsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDI1Nw==", "bodyText": "there is no validation code here? not needed ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525850257", "createdAt": "2020-11-18T06:51:17Z", "author": {"login": "coendamen"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */\n+    @Override\n+    public void validate() throws FunctionalException {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2NTEwNA==", "bodyText": "Sometimes (depending on the type a request) validation is not necessary.\nIn such cases a comment is needed to explain it is not simply forgotten (and to keep SonarQube quiet).\nSee for instance some other classes like GetConfigurationObjectRequestData.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526265104", "createdAt": "2020-11-18T17:18:45Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */\n+    @Override\n+    public void validate() throws FunctionalException {\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDI1Nw=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkxMDE5NQ==", "bodyText": "There are no input parameters to validate", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526910195", "createdAt": "2020-11-19T14:03:07Z", "author": {"login": "jboon"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */\n+    @Override\n+    public void validate() throws FunctionalException {\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDI1Nw=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkxMTQwOA==", "bodyText": "I added a comment that there no need for validation and corrected the copyright.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526911408", "createdAt": "2020-11-19T14:04:51Z", "author": {"login": "jboon"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */\n+    @Override\n+    public void validate() throws FunctionalException {\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDI1Nw=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk1NDY5OnYy", "diffSide": "LEFT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToEventListConverter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1MjoxNlrOH1fX2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDoxMDoxN1rOH2gWeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDU4Ng==", "bodyText": "this was bad !", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525850586", "createdAt": "2020-11-18T06:52:16Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToEventListConverter.java", "diffHunk": "@@ -63,64 +64,30 @@ private EventDto getDefaultEvent(final DataObject eventDataObject, final EventLo\n                     \"eventData size should be \" + eventLogCategory.getNumberOfEventElements());\n         }\n \n-        EventDto event = null;\n-\n-        if (eventLogCategory == EventLogCategoryDto.POWER_FAILURE_EVENT_LOG) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3OTk2OA==", "bodyText": "It wasn't the prettiest code, but I think it only highlighted already existing issues with handling the events that have subtle variations in the data they contain.\nI wouldn't be to cheerful resolving it by only dealing with the power failure event log as outage, ignoring the conceptual overlap and differences between all event logs.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526279968", "createdAt": "2020-11-18T17:33:43Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToEventListConverter.java", "diffHunk": "@@ -63,64 +64,30 @@ private EventDto getDefaultEvent(final DataObject eventDataObject, final EventLo\n                     \"eventData size should be \" + eventLogCategory.getNumberOfEventElements());\n         }\n \n-        EventDto event = null;\n-\n-        if (eventLogCategory == EventLogCategoryDto.POWER_FAILURE_EVENT_LOG) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDU4Ng=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkxNTE5NA==", "bodyText": "There is another story on the backlog that will make conditional logic inevitable. About the power failure log, this seemed to be a feature that was a whole different beast. We were mislead by the term event log, but ran into problems throughout the whole stack reminding us about this poor fit. Current implementation seems much better, simplifying things on all levels. But I'm sure we can still have a debate on the choices when picking different perspectives.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526915194", "createdAt": "2020-11-19T14:10:17Z", "author": {"login": "jboon"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToEventListConverter.java", "diffHunk": "@@ -63,64 +64,30 @@ private EventDto getDefaultEvent(final DataObject eventDataObject, final EventLo\n                     \"eventData size should be \" + eventLogCategory.getNumberOfEventElements());\n         }\n \n-        EventDto event = null;\n-\n-        if (eventLogCategory == EventLogCategoryDto.POWER_FAILURE_EVENT_LOG) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MDU4Ng=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk2MDg3OnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToOutageListConverter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1NDo0OVrOH1fbgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDoxMzoyN1rOH2gfCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTUyMA==", "bodyText": "possible NPE here? can eventData.get(0) value be null itself ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525851520", "createdAt": "2020-11-18T06:54:49Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToOutageListConverter.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.adapter.protocol.dlms.application.mapping;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.DateTime;\n+import org.openmuc.jdlms.datatypes.DataObject;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.commands.utils.DlmsHelper;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ProtocolAdapterException;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.GetOutagesRequestDto;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.OutageDto;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Slf4j\n+@Component(value = \"dataObjectToOutageListConverter\")\n+public class DataObjectToOutageListConverter {\n+\n+    private static final String EVENT_DATA_VALUE_IS_NOT_A_NUMBER = \"eventData value is not a number\";\n+    private static final int NUMBER_OF_ELEMENTS = 2;\n+    private final DlmsHelper dlmsHelper;\n+\n+    @Autowired\n+    public DataObjectToOutageListConverter(final DlmsHelper dlmsHelper) {\n+        this.dlmsHelper = dlmsHelper;\n+    }\n+\n+    public List<OutageDto> convert(final DataObject source, final GetOutagesRequestDto getOutagesRequestDto)\n+            throws ProtocolAdapterException {\n+        final List<OutageDto> eventList = new ArrayList<OutageDto>();\n+        if (source == null) {\n+            throw new ProtocolAdapterException(\"DataObject should not be null\");\n+        }\n+\n+        final List<DataObject> dataObjects = source.getValue();\n+        for (final DataObject dataObject : dataObjects) {\n+            eventList.add(this.getOutageDto(dataObject));\n+        }\n+\n+        return eventList;\n+\n+    }\n+\n+    private OutageDto getOutageDto(final DataObject outageDataObject) throws ProtocolAdapterException {\n+\n+        final List<DataObject> outageData = outageDataObject.getValue();\n+\n+        if (outageData == null) {\n+            throw new ProtocolAdapterException(\"outageData DataObject should not be null\");\n+        }\n+\n+        if (outageData.size() != NUMBER_OF_ELEMENTS) {\n+            throw new ProtocolAdapterException(\"outageData size should be \" + NUMBER_OF_ELEMENTS);\n+        }\n+\n+        final DateTime endTime = this.extractDateTime(outageData);\n+        final Long duration = this.extractEventDuration(outageData);\n+\n+        OutageDto outage = new OutageDto(endTime, duration);\n+\n+        log.info(\"Converted dataObject to outage: {}\", outage);\n+        return outage;\n+    }\n+\n+    private DateTime extractDateTime(final List<DataObject> eventData) throws ProtocolAdapterException {\n+        final DateTime dateTime = this.dlmsHelper.convertDataObjectToDateTime(eventData.get(0)).asDateTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkxNzM4Nw==", "bodyText": "For each item we get two values. They are essential to the data and are not expected to be a possible null-reference", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526917387", "createdAt": "2020-11-19T14:13:27Z", "author": {"login": "jboon"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/mapping/DataObjectToOutageListConverter.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.adapter.protocol.dlms.application.mapping;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.joda.time.DateTime;\n+import org.openmuc.jdlms.datatypes.DataObject;\n+import org.opensmartgridplatform.adapter.protocol.dlms.domain.commands.utils.DlmsHelper;\n+import org.opensmartgridplatform.adapter.protocol.dlms.exceptions.ProtocolAdapterException;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.GetOutagesRequestDto;\n+import org.opensmartgridplatform.dto.valueobjects.smartmetering.OutageDto;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Slf4j\n+@Component(value = \"dataObjectToOutageListConverter\")\n+public class DataObjectToOutageListConverter {\n+\n+    private static final String EVENT_DATA_VALUE_IS_NOT_A_NUMBER = \"eventData value is not a number\";\n+    private static final int NUMBER_OF_ELEMENTS = 2;\n+    private final DlmsHelper dlmsHelper;\n+\n+    @Autowired\n+    public DataObjectToOutageListConverter(final DlmsHelper dlmsHelper) {\n+        this.dlmsHelper = dlmsHelper;\n+    }\n+\n+    public List<OutageDto> convert(final DataObject source, final GetOutagesRequestDto getOutagesRequestDto)\n+            throws ProtocolAdapterException {\n+        final List<OutageDto> eventList = new ArrayList<OutageDto>();\n+        if (source == null) {\n+            throw new ProtocolAdapterException(\"DataObject should not be null\");\n+        }\n+\n+        final List<DataObject> dataObjects = source.getValue();\n+        for (final DataObject dataObject : dataObjects) {\n+            eventList.add(this.getOutageDto(dataObject));\n+        }\n+\n+        return eventList;\n+\n+    }\n+\n+    private OutageDto getOutageDto(final DataObject outageDataObject) throws ProtocolAdapterException {\n+\n+        final List<DataObject> outageData = outageDataObject.getValue();\n+\n+        if (outageData == null) {\n+            throw new ProtocolAdapterException(\"outageData DataObject should not be null\");\n+        }\n+\n+        if (outageData.size() != NUMBER_OF_ELEMENTS) {\n+            throw new ProtocolAdapterException(\"outageData size should be \" + NUMBER_OF_ELEMENTS);\n+        }\n+\n+        final DateTime endTime = this.extractDateTime(outageData);\n+        final Long duration = this.extractEventDuration(outageData);\n+\n+        OutageDto outage = new OutageDto(endTime, duration);\n+\n+        log.info(\"Converted dataObject to outage: {}\", outage);\n+        return outage;\n+    }\n+\n+    private DateTime extractDateTime(final List<DataObject> eventData) throws ProtocolAdapterException {\n+        final DateTime dateTime = this.dlmsHelper.convertDataObjectToDateTime(eventData.get(0)).asDateTime();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTUyMA=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk2MzUwOnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1NTo0NlrOH1fc-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDoxNDozNFrOH2giWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTg5OA==", "bodyText": "could be removed or changed to debug ?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525851898", "createdAt": "2020-11-18T06:55:46Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkxODIzMg==", "bodyText": "set to debug", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526918232", "createdAt": "2020-11-19T14:14:34Z", "author": {"login": "jboon"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MTg5OA=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk2NjQxOnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNjo1Njo1N1rOH1feuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNjozOTowN1rOH2ndCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MjM0NQ==", "bodyText": "there can be more getOutageRequest at the same time? this seems strange, normally there is one request executed in the command executor", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525852345", "createdAt": "2020-11-18T06:56:57Z", "author": {"login": "coendamen"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());\n+\n+        for (final GetOutagesRequestDto getOutagesRequestDto : getOutagesRequestList.getGetOutagesRequestList()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkyMDI3OA==", "bodyText": "good one, I'll have a look at this", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526920278", "createdAt": "2020-11-19T14:17:07Z", "author": {"login": "jboon"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());\n+\n+        for (final GetOutagesRequestDto getOutagesRequestDto : getOutagesRequestList.getGetOutagesRequestList()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MjM0NQ=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzMTU2MA==", "bodyText": "Probably an enthousiastic copy cat, it wasn't needed. Same List object detected in the FinfEvents flow, guess that inspired.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r527031560", "createdAt": "2020-11-19T16:39:07Z", "author": {"login": "jboon"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,\n+            GetOutagesRequestList getOutagesRequestList) throws ProtocolAdapterException {\n+\n+        final List<OutageDto> outages = new ArrayList<>();\n+\n+        log.info(\"getOutages setting up connection with meter {}\", device.getDeviceIdentification());\n+\n+        for (final GetOutagesRequestDto getOutagesRequestDto : getOutagesRequestList.getGetOutagesRequestList()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1MjM0NQ=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk3ODUyOnYy", "diffSide": "RIGHT", "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzowMTo1N1rOH1fl3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNjozOToyOVrOH2neJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDE3Mg==", "bodyText": "for my understanding, why is there a request list? and not a single request to get the outages from a meter?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525854172", "createdAt": "2020-11-18T07:01:57Z", "author": {"login": "coendamen"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.dto.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+import java.util.List;\n+\n+public class GetOutagesRequestList implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzMTg0NA==", "bodyText": "see comment above", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r527031844", "createdAt": "2020-11-19T16:39:29Z", "author": {"login": "jboon"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.dto.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+import java.util.List;\n+\n+public class GetOutagesRequestList implements Serializable {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDE3Mg=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5Njk4MjQwOnYy", "diffSide": "RIGHT", "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-management.xsd", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzowMzo0MVrOH1foMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDo0OTozNVrOH2iMRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDc3MA==", "bodyText": "minOccurs=\"1\" maxOccurs=\"1\" can be ommitted as they are the default.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525854770", "createdAt": "2020-11-18T07:03:41Z", "author": {"login": "coendamen"}, "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-management.xsd", "diffHunk": "@@ -28,6 +28,36 @@\n     </xsd:complexType>\n   </xsd:element>\n \n+  <xsd:complexType name=\"GetOutagesRequestData\">\n+    <xsd:complexContent>\n+      <xsd:extension base=\"common:Query\">\n+        <xsd:sequence>\n+        </xsd:sequence>\n+      </xsd:extension>\n+    </xsd:complexContent>\n+  </xsd:complexType>\n+\n+  <!-- Outage containing endTime and duration -->\n+  <xsd:complexType name=\"Outage\">\n+    <xsd:sequence>\n+      <xsd:element name=\"endTime\" type=\"xsd:dateTime\"\n+                   minOccurs=\"1\" maxOccurs=\"1\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk0NTM0OQ==", "bodyText": "true, removed this redundancy throughout the whole xsd, like a true boyscout", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526945349", "createdAt": "2020-11-19T14:49:35Z", "author": {"login": "jboon"}, "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-management.xsd", "diffHunk": "@@ -28,6 +28,36 @@\n     </xsd:complexType>\n   </xsd:element>\n \n+  <xsd:complexType name=\"GetOutagesRequestData\">\n+    <xsd:complexContent>\n+      <xsd:extension base=\"common:Query\">\n+        <xsd:sequence>\n+        </xsd:sequence>\n+      </xsd:extension>\n+    </xsd:complexContent>\n+  </xsd:complexType>\n+\n+  <!-- Outage containing endTime and duration -->\n+  <xsd:complexType name=\"Outage\">\n+    <xsd:sequence>\n+      <xsd:element name=\"endTime\" type=\"xsd:dateTime\"\n+                   minOccurs=\"1\" maxOccurs=\"1\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg1NDc3MA=="}, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NzA0NzI3OnYy", "diffSide": "LEFT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/FindEventsCommandExecutor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzoyOTowOVrOH1gOxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzoyOTowOVrOH1gOxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg2NDY0Ng==", "bodyText": "Shouldn't it be possible to get this type of events with the FindEvents request?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525864646", "createdAt": "2020-11-18T07:29:09Z", "author": {"login": "harrymiddelburgetall"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/FindEventsCommandExecutor.java", "diffHunk": "@@ -65,7 +65,6 @@\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.COMMUNICATION_SESSION_LOG, new ObisCode(\"0.0.99.98.4.255\"));\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.M_BUS_EVENT_LOG,           new ObisCode(\"0.0.99.98.3.255\"));\n         EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.POWER_QUALITY_EVENT_LOG,   new ObisCode(\"0.0.99.98.5.255\"));\n-        EVENT_LOG_CATEGORY_OBISCODE_MAP.put(EventLogCategoryDto.POWER_FAILURE_EVENT_LOG,   new ObisCode(\"1.0.99.97.0.255\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NzA1NDA5OnYy", "diffSide": "LEFT", "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/EventLogCategoryDto.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzozMToxNFrOH1gSog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwNzozMToxNFrOH1gSog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTg2NTYzNA==", "bodyText": "Shouldn't it be possible to get this type of events with the FindEvents request?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r525865634", "createdAt": "2020-11-18T07:31:14Z", "author": {"login": "harrymiddelburgetall"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/EventLogCategoryDto.java", "diffHunk": "@@ -12,8 +12,7 @@\n     FRAUD_DETECTION_LOG(2),\n     COMMUNICATION_SESSION_LOG(3),\n     M_BUS_EVENT_LOG(2),\n-    POWER_QUALITY_EVENT_LOG(2),\n-    POWER_FAILURE_EVENT_LOG(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5ODc5MTMzOnYy", "diffSide": "LEFT", "path": "integration-tests/cucumber-tests-platform-smartmetering/src/test/resources/features/osgp-adapter-ws-smartmetering/management/FindEvents.feature", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDozODoxNlrOH1w3bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNDozODoxNlrOH1w3bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEzNzE5Nw==", "bodyText": "This seemed like a perfectly logical place to handle the events from the power failure event log in the platform.\nIt is right between other event logs as described in DSMR 4.\nI'll leave this point at the comment here, but this would apply to all code changes replacing power failure event log by outages in GXF.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526137197", "createdAt": "2020-11-18T14:38:16Z", "author": {"login": "bvdzwet"}, "path": "integration-tests/cucumber-tests-platform-smartmetering/src/test/resources/features/osgp-adapter-ws-smartmetering/management/FindEvents.feature", "diffHunk": "@@ -48,11 +48,3 @@ Feature: SmartMetering Management - Find Events\n       | EndDate              | 2015-09-05T00:00:00.000Z |\n     Then 29 mbus events should be returned\n       | DeviceIdentification | TEST1024000000001 |\n-\n-  Scenario: find power failure events from a device", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTE3MjE3OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-adapter-ws-shared/src/main/java/org/opensmartgridplatform/adapter/ws/shared/services/ResponseDataService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNTo1Mzo0MVrOH10lHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNTo1Mzo0MVrOH10lHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE5ODA0Ng==", "bodyText": "Formatting is messed up, and if this is the only change, I wonder why this file is included in this pull request at all.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526198046", "createdAt": "2020-11-18T15:53:41Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-adapter-ws-shared/src/main/java/org/opensmartgridplatform/adapter/ws/shared/services/ResponseDataService.java", "diffHunk": "@@ -1,4 +1,4 @@\n-/**\n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTUwNjk2OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-core/src/main/resources/db/migration/V20201113200000000__Add_get_outages_to_device_function_mapping.sql", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzowMToxN1rOH134wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzowMToxN1rOH134wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI1MjIyNg==", "bodyText": "According to our way of working agreements, ending the version part of Flyway changes with a bunch of zeros should be avoided, to prevent the risk of conflicts.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526252226", "createdAt": "2020-11-18T17:01:17Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-core/src/main/resources/db/migration/V20201113200000000__Add_get_outages_to_device_function_mapping.sql", "diffHunk": "@@ -0,0 +1,10 @@\n+DO", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTU0ODA1OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/EventLogCategory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMDoxMVrOH14S7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMDoxMVrOH14S7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI1ODkyNA==", "bodyText": "Besides this change, that is tied to the decision between outages and power failure event logs, I noticed someone messed up the line endings of this file a year and four months ago.\nLine endings should only be newlines, not Windows style carriage return plus newline.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526258924", "createdAt": "2020-11-18T17:10:11Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/EventLogCategory.java", "diffHunk": "@@ -15,8 +15,7 @@\n     FRAUD_DETECTION_LOG,\r\n     COMMUNICATION_SESSION_LOG,\r\n     M_BUS_EVENT_LOG,\r\n-    POWER_QUALITY_EVENT_LOG,\r\n-    POWER_FAILURE_EVENT_LOG;\r\n+    POWER_QUALITY_EVENT_LOG;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTU1ODA2OnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMjoxOVrOH14ZJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoxMjoxOVrOH14ZJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2MDUxOA==", "bodyText": "This file looks like it is new. In that case the copyright has the wrong name and year.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526260518", "createdAt": "2020-11-18T17:12:19Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTYwNjUxOnYy", "diffSide": "RIGHT", "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoyMzowN1rOH143hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzoyMzowN1rOH143hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2ODI5NA==", "bodyText": "For me, comments like this look like they haven't got something useful to offer over not adding anything.\nYou could consider leaving it out.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526268294", "createdAt": "2020-11-18T17:23:07Z", "author": {"login": "bvdzwet"}, "path": "osgp/platform/osgp-domain-core/src/main/java/org/opensmartgridplatform/domain/core/valueobjects/smartmetering/GetOutagesRequestData.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/**\n+ * Copyright 2015 Smart Society Services B.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ */\n+package org.opensmartgridplatform.domain.core.valueobjects.smartmetering;\n+\n+import java.io.Serializable;\n+\n+import org.joda.time.DateTime;\n+import org.opensmartgridplatform.domain.core.valueobjects.DeviceFunction;\n+import org.opensmartgridplatform.shared.exceptionhandling.ComponentType;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalException;\n+import org.opensmartgridplatform.shared.exceptionhandling.FunctionalExceptionType;\n+\n+public class GetOutagesRequestData implements Serializable, ActionRequest {\n+\n+    /*\n+     * (non-Javadoc)\n+     * \n+     * @see\n+     * org.opensmartgridplatform.domain.core.valueobjects.smartmetering.ActionValueObject\n+     * #validate()\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTc2MDg5OnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0MjoyM1rOH16c1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0MjoyM1rOH16c1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NDIyOQ==", "bodyText": "Code is not formatted according the conventions, missing final modifiers here.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526294229", "createdAt": "2020-11-18T17:42:23Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/application/services/ManagementService.java", "diffHunk": "@@ -66,6 +72,21 @@ public EventMessageDataResponseDto findEvents(final DlmsConnectionManager conn,\n         return new EventMessageDataResponseDto(events);\n     }\n \n+    // === GET OUTAGES ===\n+    public GetOutagesResponseDto getOutages(DlmsConnectionManager conn, DlmsDevice device,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTc4NTQ1OnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/GetOutagesCommandExecutor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0ODozNVrOH16siQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0ODozNVrOH16siQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5ODI0OQ==", "bodyText": "This license header is sometimes added with, sometimes without this \"empty line\" (just the asterisk). It looks a bit sloppy, and I think leaving the empty line out best fits the guidelines.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526298249", "createdAt": "2020-11-18T17:48:35Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/domain/commands/misc/GetOutagesCommandExecutor.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/**\n+ * Copyright 2020 Alliander N.V.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTgxMDY3OnYy", "diffSide": "RIGHT", "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/infra/messaging/processors/GetOutagesRequestMessageProcessor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NDowOVrOH168xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NDowOVrOH168xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwMjQwNQ==", "bodyText": "This file looks new, copyright should be for Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526302405", "createdAt": "2020-11-18T17:54:09Z", "author": {"login": "bvdzwet"}, "path": "osgp/protocol-adapter-dlms/osgp-protocol-adapter-dlms/src/main/java/org/opensmartgridplatform/adapter/protocol/dlms/infra/messaging/processors/GetOutagesRequestMessageProcessor.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTgyNzM0OnYy", "diffSide": "RIGHT", "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestDto.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1Njo1OFrOH17HsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1Njo1OFrOH17HsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwNTIwMA==", "bodyText": "Looks like this should mention Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526305200", "createdAt": "2020-11-18T17:56:58Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestDto.java", "diffHunk": "@@ -0,0 +1,13 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTgyOTkzOnYy", "diffSide": "RIGHT", "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NzozNlrOH17JcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo1NzozNlrOH17JcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwNTY0OA==", "bodyText": "Looks like this should mention Alliander N.V. instead of Smart Society Services B.V.", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526305648", "createdAt": "2020-11-18T17:57:36Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-dto/src/main/java/org/opensmartgridplatform/dto/valueobjects/smartmetering/GetOutagesRequestList.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright 2020 Smart Society Services B.V.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5OTg1NTI0OnYy", "diffSide": "LEFT", "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-external-interface.xsd", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxODowNDoxMlrOH17Z4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxODowNDoxMlrOH17Z4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMwOTg1Ng==", "bodyText": "My remarks about events versus outages aside, it seems illogical to replace FindEventsRequest by GetOutagesRequest while adding the GetOutagesResponse as an alternative to the FindEventsResponse.\nIs this a mistake or am I missing something where these two requests and responses don't have to match in pairs?", "url": "https://github.com/OSGP/open-smart-grid-platform/pull/515#discussion_r526309856", "createdAt": "2020-11-18T18:04:12Z", "author": {"login": "bvdzwet"}, "path": "osgp/shared/osgp-ws-smartmetering/src/main/resources/schemas/sm-external-interface.xsd", "diffHunk": "@@ -28,7 +28,7 @@\n           <xsd:element ref=\"bun:GetPeriodicMeterReadsRequest\"/>\n           <xsd:element ref=\"bun:GetPowerQualityProfileRequest\"/>\n           <xsd:element ref=\"adm:SetMaintenanceStateRequest\"/>\n-          <xsd:element ref=\"bun:FindEventsRequest\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e199c78f633cc37bd741834b2b9812c05440ebc"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3594, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}