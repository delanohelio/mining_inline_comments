{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NjkyNDc2", "number": 17487, "title": "Improve thread finishing", "bodyText": "Improvements based on the logs here: #17324", "createdAt": "2020-09-03T14:57:07Z", "url": "https://github.com/hazelcast/hazelcast/pull/17487", "merged": true, "mergeCommit": {"oid": "735f75854815d30e1f9b5a1b65e5ca6c3c0ecd9f"}, "closed": true, "closedAt": "2020-09-09T13:43:59Z", "author": {"login": "ahmetmircik"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFS0gfABqjM3MjU0NzQyODg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHMYy9gFqTQ4NTAxOTQzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2e39888844856ee1960d9493d855ed74739c863", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c2e39888844856ee1960d9493d855ed74739c863", "committedDate": "2020-09-03T14:50:44Z", "message": "Shutdown executors properly"}, "afterCommit": {"oid": "fa3169f107d3993a88e1a1454f509b9c2e29bea5", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/fa3169f107d3993a88e1a1454f509b9c2e29bea5", "committedDate": "2020-09-03T16:02:13Z", "message": "Shutdown executors properly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa3169f107d3993a88e1a1454f509b9c2e29bea5", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/fa3169f107d3993a88e1a1454f509b9c2e29bea5", "committedDate": "2020-09-03T16:02:13Z", "message": "Shutdown executors properly"}, "afterCommit": {"oid": "554d6a3bf3175b88a6acd956a22d15b3a75975c6", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/554d6a3bf3175b88a6acd956a22d15b3a75975c6", "committedDate": "2020-09-03T19:24:15Z", "message": "Shutdown executors properly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0ODgxNjU4", "url": "https://github.com/hazelcast/hazelcast/pull/17487#pullrequestreview-484881658", "createdAt": "2020-09-09T10:42:44Z", "commit": {"oid": "3570ccda3fdcbb08efe74d5a94e70ee46b0197f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMDo0Mjo0NVrOHPBc1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMDo0Mjo0NVrOHPBc1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTUxNDQ1NA==", "bodyText": "If this thread is blocked inside tryReplicateExpiredWaitKeys() method, I don't think this change will help. I don't remember how raftNode.replicate(op).get() behaves when the local member is shutdown. We should investigate it too.", "url": "https://github.com/hazelcast/hazelcast/pull/17487#discussion_r485514454", "createdAt": "2020-09-09T10:42:45Z", "author": {"login": "mdogan"}, "path": "hazelcast/src/main/java/com/hazelcast/cp/internal/datastructures/spi/blocking/AbstractBlockingService.java", "diffHunk": "@@ -366,6 +367,9 @@ public void run() {\n         @Override\n         public void run() {\n             for (Entry<CPGroupId, Collection<BiTuple<String, UUID>>> e : getWaitKeysToExpire().entrySet()) {\n+                if (currentThread().isInterrupted()) {\n+                    break;\n+                }\n                 tryReplicateExpiredWaitKeys(e.getKey(), e.getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3570ccda3fdcbb08efe74d5a94e70ee46b0197f8"}, "originalPosition": 69}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3570ccda3fdcbb08efe74d5a94e70ee46b0197f8", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/3570ccda3fdcbb08efe74d5a94e70ee46b0197f8", "committedDate": "2020-09-04T11:43:19Z", "message": "wip"}, "afterCommit": {"oid": "7d34659a842cae834fe88ca5ef64dff6c5388ebc", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/7d34659a842cae834fe88ca5ef64dff6c5388ebc", "committedDate": "2020-09-09T12:06:01Z", "message": "Address Mehmet comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf3084683fb804ea7f35e31e648687515b49b196", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/bf3084683fb804ea7f35e31e648687515b49b196", "committedDate": "2020-09-09T12:10:28Z", "message": "Shutdown executors properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3f0fd41d3d1878b73ce1cb1b2b3e4a670780558", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/b3f0fd41d3d1878b73ce1cb1b2b3e4a670780558", "committedDate": "2020-09-09T12:10:28Z", "message": "wip now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd603dbe1977696af45b86ebf14b7c6312af04f5", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/dd603dbe1977696af45b86ebf14b7c6312af04f5", "committedDate": "2020-09-09T12:10:28Z", "message": "wip remove wait"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "056cadc227845c3844221439110a612cbfa4f0c8", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/056cadc227845c3844221439110a612cbfa4f0c8", "committedDate": "2020-09-09T12:10:28Z", "message": "handle thread interrupts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d97a77d172c6b48dcef3bb1ec006f5b627fbdbd", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/6d97a77d172c6b48dcef3bb1ec006f5b627fbdbd", "committedDate": "2020-09-09T12:10:28Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62e634cba0a7a71aecc9b40e3f73f09aa39fbb70", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/62e634cba0a7a71aecc9b40e3f73f09aa39fbb70", "committedDate": "2020-09-09T12:11:43Z", "message": "Address Mehmet comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7d34659a842cae834fe88ca5ef64dff6c5388ebc", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/7d34659a842cae834fe88ca5ef64dff6c5388ebc", "committedDate": "2020-09-09T12:06:01Z", "message": "Address Mehmet comments"}, "afterCommit": {"oid": "62e634cba0a7a71aecc9b40e3f73f09aa39fbb70", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/62e634cba0a7a71aecc9b40e3f73f09aa39fbb70", "committedDate": "2020-09-09T12:11:43Z", "message": "Address Mehmet comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0OTQ5MTQ1", "url": "https://github.com/hazelcast/hazelcast/pull/17487#pullrequestreview-484949145", "createdAt": "2020-09-09T12:20:00Z", "commit": {"oid": "62e634cba0a7a71aecc9b40e3f73f09aa39fbb70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDEzNzE2", "url": "https://github.com/hazelcast/hazelcast/pull/17487#pullrequestreview-485013716", "createdAt": "2020-09-09T13:34:42Z", "commit": {"oid": "62e634cba0a7a71aecc9b40e3f73f09aa39fbb70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDE5NDM0", "url": "https://github.com/hazelcast/hazelcast/pull/17487#pullrequestreview-485019434", "createdAt": "2020-09-09T13:40:39Z", "commit": {"oid": "62e634cba0a7a71aecc9b40e3f73f09aa39fbb70"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3267, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}