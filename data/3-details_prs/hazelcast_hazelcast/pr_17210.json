{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NjY2MDU1", "number": 17210, "title": "Resolved performance problem with PagingPredicate JDK8", "bodyText": "There is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort. This issue is resolved\nwith JDK9 but we need to fix the issue for a large number of people using\nJDK 8\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\nfix #17207", "createdAt": "2020-07-14T06:04:29Z", "url": "https://github.com/hazelcast/hazelcast/pull/17210", "merged": true, "mergeCommit": {"oid": "bb05e4f5726e6fe0f8347b94c76c56c91bb52aa9"}, "closed": true, "closedAt": "2020-07-15T09:47:17Z", "author": {"login": "pveentjer"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0vuDVgBqjM1NDI2MDY3MTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0zGXFgFqTQ0Nzk2NjE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b09959a6bb8797093421862b3e4ffc7b29b071cd", "author": {"user": {"login": "pveentjer", "name": "Peter Veentjer"}}, "url": "https://github.com/hazelcast/hazelcast/commit/b09959a6bb8797093421862b3e4ffc7b29b071cd", "committedDate": "2020-07-14T06:02:22Z", "message": "Resolved performance problem with PagingPredicate JDK8\n\nThere is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort.\n\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\n\nfix #17207"}, "afterCommit": {"oid": "f7825a6d5bef2425c4c6796e16aac2626edb7a21", "author": {"user": {"login": "pveentjer", "name": "Peter Veentjer"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f7825a6d5bef2425c4c6796e16aac2626edb7a21", "committedDate": "2020-07-14T06:05:45Z", "message": "Resolved performance problem with PagingPredicate JDK8\n\nThere is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort.\n\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\n\nfix #17207"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468", "author": {"user": {"login": "pveentjer", "name": "Peter Veentjer"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468", "committedDate": "2020-07-14T07:02:25Z", "message": "Resolved performance problem with PagingPredicate JDK8\n\nThere is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort.\n\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\n\nfix #17207"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f7825a6d5bef2425c4c6796e16aac2626edb7a21", "author": {"user": {"login": "pveentjer", "name": "Peter Veentjer"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f7825a6d5bef2425c4c6796e16aac2626edb7a21", "committedDate": "2020-07-14T06:05:45Z", "message": "Resolved performance problem with PagingPredicate JDK8\n\nThere is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort.\n\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\n\nfix #17207"}, "afterCommit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468", "author": {"user": {"login": "pveentjer", "name": "Peter Veentjer"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468", "committedDate": "2020-07-14T07:02:25Z", "message": "Resolved performance problem with PagingPredicate JDK8\n\nThere is a very severe performance issue with JDK 8 in combination with\nthe paging predicate. This is caused by SubList.sort.\n\nThe problem is fixed by switching from LinkedList to ArrayList in the\nQueryResult. Benchmarks are included in the ticket\n\nfix #17207"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTM5MjA2", "url": "https://github.com/hazelcast/hazelcast/pull/17210#pullrequestreview-447939206", "createdAt": "2020-07-14T09:25:03Z", "commit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNTowM1rOGxLodA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNTowM1rOGxLodA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyMzk4OA==", "bodyText": "QueryResult constructor has resultLimit, it can be better to pass it to ArrayList as an initial capacity. Seems initial capacity can be applied also for QueryResult#readData.\nUPDATE: I see that resultLimit cannot be used for capacity initialization.", "url": "https://github.com/hazelcast/hazelcast/pull/17210#discussion_r454223988", "createdAt": "2020-07-14T09:25:03Z", "author": {"login": "ahmetmircik"}, "path": "hazelcast/src/main/java/com/hazelcast/map/impl/query/QueryResult.java", "diffHunk": "@@ -62,7 +62,7 @@\n  */\n public class QueryResult implements Result<QueryResult>, Iterable<QueryResultRow> {\n \n-    private List rows = new LinkedList();\n+    private List rows = new ArrayList();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTM5MzIz", "url": "https://github.com/hazelcast/hazelcast/pull/17210#pullrequestreview-447939323", "createdAt": "2020-07-14T09:25:14Z", "commit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTY2MTQz", "url": "https://github.com/hazelcast/hazelcast/pull/17210#pullrequestreview-447966143", "createdAt": "2020-07-14T10:02:15Z", "commit": {"oid": "c9a0ee2acae9ce33dfbf8d6d7ab3c44ac03f3468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3564, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}