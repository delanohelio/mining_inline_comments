{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMjY0MTky", "number": 16887, "title": "Add support for processing WAN replication messages from 3.x members", "bodyText": "Adds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster.\nTesting is done by running the full WAN suite on 3.12 using compatibility framework to start 4.0 clusters with this change.\nEE: hazelcast/hazelcast-enterprise#3578\nCorresponding PRs for 4.0->3.12 replication:\n#16972\nhazelcast/hazelcast-enterprise#3597", "createdAt": "2020-04-14T15:43:22Z", "url": "https://github.com/hazelcast/hazelcast/pull/16887", "merged": true, "mergeCommit": {"oid": "25f3596eb9eebdc195edd4f38a73853c3f139da9"}, "closed": true, "closedAt": "2020-05-29T11:34:44Z", "author": {"login": "mmedenjak"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcemLhJgBqjMzMDc4NzIzNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcluw8DAFqTQyMDE3MjA5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9837d2584c3b5d78ff4fedaa0d572fc39ec10501", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/9837d2584c3b5d78ff4fedaa0d572fc39ec10501", "committedDate": "2020-04-16T15:50:24Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}, "afterCommit": {"oid": "2cc5e6ab0db103ef9ef78a52e1ecdd60d9a34470", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/2cc5e6ab0db103ef9ef78a52e1ecdd60d9a34470", "committedDate": "2020-05-06T10:27:12Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b1715bbf4775aa132b6ecc8e12ab61faacbe943", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/9b1715bbf4775aa132b6ecc8e12ab61faacbe943", "committedDate": "2020-05-11T08:51:14Z", "message": "wip"}, "afterCommit": {"oid": "ab40da62f9cbf199d0e7e96ce924162a9f4c971f", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/ab40da62f9cbf199d0e7e96ce924162a9f4c971f", "committedDate": "2020-05-11T11:12:55Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8166eec711ebc89892f6418ff0d9cbc5ea77ed0f", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/8166eec711ebc89892f6418ff0d9cbc5ea77ed0f", "committedDate": "2020-05-11T12:57:54Z", "message": "wip"}, "afterCommit": {"oid": "cdf8f2e68b85fba247b7e25fe5df414e38c0d9c7", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/cdf8f2e68b85fba247b7e25fe5df414e38c0d9c7", "committedDate": "2020-05-11T13:01:12Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f2cc19edbdcc829c736bebcb40de78776b1e895", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/2f2cc19edbdcc829c736bebcb40de78776b1e895", "committedDate": "2020-05-11T13:34:55Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}, "afterCommit": {"oid": "1a71ca7b7ec2917a7d0f86d747291f10a2e373fd", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/1a71ca7b7ec2917a7d0f86d747291f10a2e373fd", "committedDate": "2020-05-11T13:43:16Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "608d3ce05aa6233558d72b5757c6f767641a3d64", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/608d3ce05aa6233558d72b5757c6f767641a3d64", "committedDate": "2020-05-11T14:05:53Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}, "afterCommit": {"oid": "cff19cdad480d67298db53d80263fa5efa0c807e", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/cff19cdad480d67298db53d80263fa5efa0c807e", "committedDate": "2020-05-13T12:02:19Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "44239786d175d4b2ab17c258f68553c45bfddcc8", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/44239786d175d4b2ab17c258f68553c45bfddcc8", "committedDate": "2020-05-13T16:47:59Z", "message": "wip"}, "afterCommit": {"oid": "cff19cdad480d67298db53d80263fa5efa0c807e", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/cff19cdad480d67298db53d80263fa5efa0c807e", "committedDate": "2020-05-13T12:02:19Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDg2NzYx", "url": "https://github.com/hazelcast/hazelcast/pull/16887#pullrequestreview-414486761", "createdAt": "2020-05-19T14:12:52Z", "commit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDoxMjo1MlrOGXiYKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTowMjo1MVrOGYQR1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMzMzY3NA==", "bodyText": "Not a big thing, but it seems the constants other than DEFAULT_CACHE_ENTRY_VIEW can be removed.", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r427333674", "createdAt": "2020-05-19T14:12:52Z", "author": {"login": "blazember"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/compatibility/cache/CompatibilityCacheDataSerializerHook.java", "diffHunk": "@@ -0,0 +1,124 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.internal.compatibility.cache;\n+\n+import com.hazelcast.internal.compatibility.serialization.impl.CompatibilityFactoryIdHelper;\n+import com.hazelcast.internal.serialization.DataSerializerHook;\n+import com.hazelcast.nio.serialization.DataSerializableFactory;\n+\n+import static com.hazelcast.internal.compatibility.serialization.impl.CompatibilityFactoryIdHelper.CACHE_DS_FACTORY;\n+import static com.hazelcast.internal.compatibility.serialization.impl.CompatibilityFactoryIdHelper.CACHE_DS_FACTORY_ID;\n+\n+\n+/**\n+ * Data serializer hook containing (de)serialization information for\n+ * JCache-related classes used when communicating with 3.x members over WAN.\n+ */\n+@SuppressWarnings(\"unused\")\n+public final class CompatibilityCacheDataSerializerHook\n+        implements DataSerializerHook {\n+\n+    public static final int F_ID = CompatibilityFactoryIdHelper.getFactoryId(\n+            CACHE_DS_FACTORY, CACHE_DS_FACTORY_ID);\n+    public static final short GET = 1;\n+    public static final short CONTAINS_KEY = 2;\n+    public static final short PUT = 3;\n+    public static final short PUT_IF_ABSENT = 4;\n+    public static final short REMOVE = 5;\n+    public static final short GET_AND_REMOVE = 6;\n+    public static final short REPLACE = 7;\n+    public static final short GET_AND_REPLACE = 8;\n+    public static final short PUT_BACKUP = 9;\n+    public static final short PUT_ALL_BACKUP = 10;\n+    public static final short REMOVE_BACKUP = 11;\n+    public static final short CLEAR_BACKUP = 12;\n+    public static final short SIZE = 13;\n+    public static final short SIZE_FACTORY = 14;\n+    public static final short CLEAR = 15;\n+    public static final short CLEAR_FACTORY = 16;\n+    public static final short GET_ALL = 17;\n+    public static final short GET_ALL_FACTORY = 18;\n+    public static final short LOAD_ALL = 19;\n+    public static final short LOAD_ALL_FACTORY = 20;\n+    public static final short EXPIRY_POLICY = 21;\n+    public static final short KEY_ITERATOR = 22;\n+    public static final short KEY_ITERATION_RESULT = 23;\n+    public static final short ENTRY_PROCESSOR = 24;\n+    public static final short CLEAR_RESPONSE = 25;\n+    public static final short CREATE_CONFIG = 26;\n+    public static final short GET_CONFIG = 27;\n+    public static final short MANAGEMENT_CONFIG = 28;\n+    public static final short LISTENER_REGISTRATION = 29;\n+    public static final short DESTROY_CACHE = 30;\n+    public static final short CACHE_EVENT_DATA = 31;\n+    public static final short CACHE_EVENT_DATA_SET = 32;\n+    public static final short BACKUP_ENTRY_PROCESSOR = 33;\n+    public static final short REMOVE_ALL = 34;\n+    public static final short REMOVE_ALL_BACKUP = 35;\n+    public static final short REMOVE_ALL_FACTORY = 36;\n+    public static final short PUT_ALL = 37;\n+    public static final short LEGACY_MERGE = 38;\n+    public static final short INVALIDATION_MESSAGE = 39;\n+    public static final short BATCH_INVALIDATION_MESSAGE = 40;\n+    public static final short ENTRY_ITERATOR = 41;\n+    public static final short ENTRY_ITERATION_RESULT = 42;\n+    public static final short CACHE_PARTITION_LOST_EVENT_FILTER = 43;\n+    public static final short DEFAULT_CACHE_ENTRY_VIEW = 44;\n+    public static final short CACHE_REPLICATION = 45;\n+    public static final short CACHE_POST_JOIN = 46;\n+    public static final short CACHE_DATA_RECORD = 47;\n+    public static final short CACHE_OBJECT_RECORD = 48;\n+    public static final short CACHE_PARTITION_EVENT_DATA = 49;\n+\n+    public static final short CACHE_INVALIDATION_METADATA = 50;\n+    public static final short CACHE_INVALIDATION_METADATA_RESPONSE = 51;\n+    public static final short CACHE_ASSIGN_AND_GET_UUIDS = 52;\n+    public static final short CACHE_ASSIGN_AND_GET_UUIDS_FACTORY = 53;\n+    public static final short CACHE_NEAR_CACHE_STATE_HOLDER = 54;\n+    public static final short CACHE_EVENT_LISTENER_ADAPTOR = 55;\n+    public static final short EVENT_JOURNAL_SUBSCRIBE_OPERATION = 56;\n+    public static final short EVENT_JOURNAL_READ_OPERATION = 57;\n+    public static final short EVENT_JOURNAL_DESERIALIZING_CACHE_EVENT = 58;\n+    public static final short EVENT_JOURNAL_INTERNAL_CACHE_EVENT = 59;\n+    public static final short EVENT_JOURNAL_READ_RESULT_SET = 60;\n+    public static final int PRE_JOIN_CACHE_CONFIG = 61;\n+    public static final int CACHE_BROWSER_ENTRY_VIEW = 62;\n+    public static final int GET_CACHE_ENTRY_VIEW_PROCESSOR = 63;\n+\n+    public static final int MERGE_FACTORY = 64;\n+    public static final int MERGE = 65;\n+    public static final int ADD_CACHE_CONFIG_OPERATION = 66;\n+    public static final int SET_EXPIRY_POLICY = 67;\n+    public static final int SET_EXPIRY_POLICY_BACKUP = 68;\n+    public static final int EXPIRE_BATCH_BACKUP = 69;\n+    public static final int CACHE_DESTROY_EVENT_CONTEXT = 70;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2MjQ3NQ==", "bodyText": "Minor suggestion: we can create constructors that hide the false compatibility flag so that we have to touch only places where using the given classes in \"compatibility mode\" is possible.", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428062475", "createdAt": "2020-05-20T14:33:47Z", "author": {"login": "blazember"}, "path": "hazelcast/src/test/java/com/hazelcast/internal/serialization/impl/ByteArraySerializerAdapterTest.java", "diffHunk": "@@ -61,7 +61,7 @@ public void testAdaptor() throws Exception {\n         byte[] testByteArray = new byte[]{1, 2, 3};\n \n         ByteArrayObjectDataOutput out = new ByteArrayObjectDataOutput(10, mockSerializationService, ByteOrder.BIG_ENDIAN);\n-        ByteArrayObjectDataInput in = new ByteArrayObjectDataInput(out.buffer, mockSerializationService, ByteOrder.BIG_ENDIAN);\n+        ByteArrayObjectDataInput in = new ByteArrayObjectDataInput(out.buffer, mockSerializationService, ByteOrder.BIG_ENDIAN, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NTcxNg==", "bodyText": "Is this intentionally CHM?", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428085716", "createdAt": "2020-05-20T15:02:51Z", "author": {"login": "blazember"}, "path": "hazelcast/src/test/java/com/hazelcast/test/starter/HazelcastStarterUtils.java", "diffHunk": "@@ -202,4 +249,22 @@ public static void assertInstanceOfByClassName(String className, Object object)\n             throw new UnsupportedOperationException(\"Cannot locate collection type for \" + type);\n         }\n     }\n+\n+    public static Map<Object, Object> newMapFor(Class<?> type) {\n+        if (LinkedHashMap.class.isAssignableFrom(type)) {\n+            return new LinkedHashMap<Object, Object>();\n+        } else if (ConcurrentSkipListMap.class.isAssignableFrom(type)) {\n+            return new ConcurrentSkipListMap<Object, Object>();\n+        } else if (ConcurrentHashMap.class.isAssignableFrom(type)) {\n+            return new ConcurrentHashMap<Object, Object>();\n+        } else if (TreeMap.class.isAssignableFrom(type)) {\n+            return new TreeMap<Object, Object>();\n+        } else if (HashMap.class.isAssignableFrom(type)) {\n+            return new HashMap<Object, Object>();\n+        } else if (Map.class.isAssignableFrom(type)) {\n+            return new ConcurrentHashMap<Object, Object>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 93}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MTQzODQy", "url": "https://github.com/hazelcast/hazelcast/pull/16887#pullrequestreview-416143842", "createdAt": "2020-05-21T13:28:19Z", "commit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMzoyODoxOVrOGYyv_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNTo1NDozMlrOGY4sFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODY1MDQ5Mw==", "bodyText": "minor: rephrase error message?", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428650493", "createdAt": "2020-05-21T13:28:19Z", "author": {"login": "vbekiaris"}, "path": "hazelcast/src/test/java/com/hazelcast/test/starter/ReflectionUtils.java", "diffHunk": "@@ -176,6 +198,55 @@ public static void setFieldValueReflectively(Object arg, String fieldName, Objec\n         return fields;\n     }\n \n+    /**\n+     * Returns {@code true} if the provided {@code clazz} has a declared field\n+     * with the provided {@code name}.\n+     *\n+     * @param clazz     the class to check\n+     * @param fieldName the field name to check\n+     * @return {@code true} if a declared field exists, {@code false} otherwise.\n+     */\n+    public static boolean hasField(Class<?> clazz, String fieldName) {\n+        for (Field field : clazz.getDeclaredFields()) {\n+            if (field.getName().equals(fieldName)) {\n+                return true;\n+            }\n+        }\n+        Class<?> superClass = clazz.getSuperclass();\n+        while (superClass != null) {\n+            for (Field field : superClass.getDeclaredFields()) {\n+                if (field.getName().equals(fieldName)) {\n+                    return true;\n+                }\n+            }\n+            superClass = superClass.getSuperclass();\n+        }\n+        return false;\n+    }\n+\n+    public static Method getSetter(Class<?> otherConfigClass,\n+                                   Class<?> parameterType, String setterName) {\n+        try {\n+            return otherConfigClass.getMethod(setterName, parameterType);\n+        } catch (NoSuchMethodException e) {\n+            return null;\n+        }\n+    }\n+\n+    public static void invokeSetter(Object object, String setterName,\n+                                     Class<?> parameterClass, Object parameter) {\n+        Method setter = getSetter(object.getClass(), parameterClass, setterName);\n+        invokeMethod(setter, object, parameter);\n+    }\n+\n+    public static void invokeMethod(Method method, Object methodObj, Object methodParam) {\n+        try {\n+            method.invoke(methodObj, methodParam);\n+        } catch (IllegalAccessException | InvocationTargetException | IllegalArgumentException e) {\n+            debug(\"Could not update config via %s: %s\", method.getName(), e.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODcyMDE3OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Object create = getFieldValueReflectively(delegate, \"create\");\n          \n          \n            \n                    Duration create = getFieldValueReflectively(delegate, \"create\");\n          \n          \n            \n                    Duration access = getFieldValueReflectively(delegate, \"access\");\n          \n          \n            \n                    Duration update = getFieldValueReflectively(delegate, \"update\");\n          \n          \n            \n            \n          \n          \n            \n                    Object[] args = new Object[]{\n          \n          \n            \n                            create.getTimeUnit().toMillis(create.getDurationAmount()),\n          \n          \n            \n                            access.getTimeUnit().toMillis(access.getDurationAmount()),\n          \n          \n            \n                            update.getTimeUnit().toMillis(update.getDurationAmount()),\n          \n          \n            \n                    };\n          \n      \n    \n    \n  \n\nDuration is a javax.cache API class so it will not be loaded by the HazelcastAPIDelegatingClassLoader and we can use it directly here. Apart from the durationAmount part we also need to take into account the timeUnit part to get an accurate clone. Minimal test:\n        HazelcastExpiryPolicy policy = new HazelcastExpiryPolicy(3L, 5L, 4L, TimeUnit.SECONDS);\n        HazelcastExpiryPolicyConstructor constructor = new HazelcastExpiryPolicyConstructor(HazelcastExpiryPolicy.class);\n        HazelcastExpiryPolicy cloned = (HazelcastExpiryPolicy) constructor.createNew(policy);\n        assertEquals(policy, cloned);", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428720178", "createdAt": "2020-05-21T15:16:22Z", "author": {"login": "vbekiaris"}, "path": "hazelcast/src/test/java/com/hazelcast/test/starter/constructor/HazelcastExpiryPolicyConstructor.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.test.starter.constructor;\n+\n+import com.hazelcast.test.starter.HazelcastStarterConstructor;\n+\n+import java.lang.reflect.Constructor;\n+\n+import static com.hazelcast.test.starter.ReflectionUtils.getFieldValueReflectively;\n+\n+@HazelcastStarterConstructor(classNames = {\"com.hazelcast.cache.HazelcastExpiryPolicy\"})\n+public class HazelcastExpiryPolicyConstructor extends AbstractStarterObjectConstructor {\n+\n+    public HazelcastExpiryPolicyConstructor(Class<?> targetClass) {\n+        super(targetClass);\n+    }\n+\n+    @Override\n+    Object createNew0(Object delegate) throws Exception {\n+        Constructor<?> constructor = targetClass.getConstructor(Long.TYPE, Long.TYPE, Long.TYPE);\n+\n+        Object create = getFieldValueReflectively(delegate, \"create\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODczMDE0OQ==", "bodyText": "minor: could move raising FLAG_4_0 to Packet constructor as done in other PR", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428730149", "createdAt": "2020-05-21T15:31:58Z", "author": {"login": "vbekiaris"}, "path": "hazelcast/src/main/java/com/hazelcast/spi/impl/eventservice/impl/EventServiceImpl.java", "diffHunk": "@@ -583,7 +583,8 @@ private void sendEvent(Address subscriber, EventEnvelope eventEnvelope, int orde\n             }\n         } else {\n             Packet packet = new Packet(serializationService.toBytes(eventEnvelope), orderKey)\n-                    .setPacketType(Packet.Type.EVENT);\n+                    .setPacketType(Packet.Type.EVENT)\n+                    .raiseFlags(Packet.FLAG_4_0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc0Nzc5Nw==", "bodyText": "minor: clones EvictionConfig actually", "url": "https://github.com/hazelcast/hazelcast/pull/16887#discussion_r428747797", "createdAt": "2020-05-21T15:54:32Z", "author": {"login": "vbekiaris"}, "path": "hazelcast/src/test/java/com/hazelcast/test/starter/constructor/AbstractConfigConstructor.java", "diffHunk": "@@ -241,9 +253,306 @@ private static Object cloneSplitBrainProtectionFunctionImplementation(Object spl\n         }\n     }\n \n+    /**\n+     * Clones the built-in QuorumFunction implementations.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc2647122b3f8446f408d8c9c86d92efe82056af"}, "originalPosition": 256}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46dbc1069270ecb849f9801a968e4d3bd63b7059", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/46dbc1069270ecb849f9801a968e4d3bd63b7059", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eed8d8cce5469c2d7953b3d086f5bacfc397450c", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/eed8d8cce5469c2d7953b3d086f5bacfc397450c", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4053066139452da25f1170e443326bae898308f", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/e4053066139452da25f1170e443326bae898308f", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f45c7e2a6839995f052b058c1ff6191711f5b786", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f45c7e2a6839995f052b058c1ff6191711f5b786", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44e79fd5795e536e8f2cfbc98e567c6b9bbb7683", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/44e79fd5795e536e8f2cfbc98e567c6b9bbb7683", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37b12bc0128876afdf8d692313f14f1f857c4c9a", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/37b12bc0128876afdf8d692313f14f1f857c4c9a", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cc91eb1bddbe0b8485d14a3a00d3b03698722bf", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/5cc91eb1bddbe0b8485d14a3a00d3b03698722bf", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90450c9cc8cbdd461b6ad90ef5f0de041488e8de", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/90450c9cc8cbdd461b6ad90ef5f0de041488e8de", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c307fff46979a5d327f7c47efad7dad96add1fd7", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c307fff46979a5d327f7c47efad7dad96add1fd7", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0ab6c594603d9fe840c00bd87cf5cc808c5fc40", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c0ab6c594603d9fe840c00bd87cf5cc808c5fc40", "committedDate": "2020-05-25T15:44:05Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf6e5bd7511b16e281fc33f95172184363b5c33d", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/cf6e5bd7511b16e281fc33f95172184363b5c33d", "committedDate": "2020-05-25T15:44:53Z", "message": "Add support for processing WAN replication messages from 3.x members\n\nAdds support on PASSIVE (target) cluster to be able to deserialize and\nprocess WAN replication events from a 3.x ACTIVE (source) cluster."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "261c703ff52700cdcaa21fb416d0302d6818a125", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/261c703ff52700cdcaa21fb416d0302d6818a125", "committedDate": "2020-05-25T15:44:53Z", "message": "Address review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f0896bfe68873946fa253ca5dd6657c14b3c32d2", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f0896bfe68873946fa253ca5dd6657c14b3c32d2", "committedDate": "2020-05-25T15:11:17Z", "message": "Address review comments"}, "afterCommit": {"oid": "261c703ff52700cdcaa21fb416d0302d6818a125", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/261c703ff52700cdcaa21fb416d0302d6818a125", "committedDate": "2020-05-25T15:44:53Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cab685ab7742e1c7c3625ad6be20b2d8a13c73f2", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/cab685ab7742e1c7c3625ad6be20b2d8a13c73f2", "committedDate": "2020-05-26T06:30:54Z", "message": "Update hazelcast/src/test/java/com/hazelcast/test/starter/constructor/HazelcastExpiryPolicyConstructor.java\n\nCo-authored-by: Vassilis Bekiaris <vbekiaris@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "966bbbdc28db69b7bd2bbe65c59c322a2212a3df", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/966bbbdc28db69b7bd2bbe65c59c322a2212a3df", "committedDate": "2020-05-26T07:39:42Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fe1f52c055fafa8c08f318b0fd4ae3d78160ebb", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/3fe1f52c055fafa8c08f318b0fd4ae3d78160ebb", "committedDate": "2020-05-26T10:06:06Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe1966043e9d64366c496121e2d0dbbf3d24e388", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/fe1966043e9d64366c496121e2d0dbbf3d24e388", "committedDate": "2020-05-26T14:13:43Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ade3c588117d2039106b80b738d280ae7b42d05d", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/ade3c588117d2039106b80b738d280ae7b42d05d", "committedDate": "2020-05-27T06:38:58Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88f26b9870ac3b575d11dc29b5777f8be5ff7d80", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/88f26b9870ac3b575d11dc29b5777f8be5ff7d80", "committedDate": "2020-05-27T11:30:51Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc9d2b034072695ff9ebd92428fb932a52bec182", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/fc9d2b034072695ff9ebd92428fb932a52bec182", "committedDate": "2020-05-28T10:12:05Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMTExMDEz", "url": "https://github.com/hazelcast/hazelcast/pull/16887#pullrequestreview-420111013", "createdAt": "2020-05-28T13:34:00Z", "commit": {"oid": "88f26b9870ac3b575d11dc29b5777f8be5ff7d80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df7eb54ae2c1fbc5d0e03d022e5a659c6767c368", "author": {"user": {"login": "mmedenjak", "name": "Matko Medenjak"}}, "url": "https://github.com/hazelcast/hazelcast/commit/df7eb54ae2c1fbc5d0e03d022e5a659c6767c368", "committedDate": "2020-05-28T14:17:01Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMTcyMDk0", "url": "https://github.com/hazelcast/hazelcast/pull/16887#pullrequestreview-420172094", "createdAt": "2020-05-28T14:30:22Z", "commit": {"oid": "df7eb54ae2c1fbc5d0e03d022e5a659c6767c368"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3785, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}