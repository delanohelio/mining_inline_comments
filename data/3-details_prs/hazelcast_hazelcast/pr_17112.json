{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MDI0MzI0", "number": 17112, "title": "Add `auto-detection` to Hazelcast Configuration", "bodyText": "Adds the auto-detection feature (presented as Project X and here's the related PRD and TDD).\nI think it'll be a really nice improvement when it comes to Hazelcast usability and especially nice when you try Hazelcast in the Cloud.\nCC: @jerrinot @mesutcelik\n\nThe implementation itself is easy-peasy, but the most interesting are the considerations about the ** backward-compatibility**. I've included everything in the related TDD, but let me also summarize the thoughts here.\nWe have 3 options when it comes to setting Hazelcast default auto-detection behavior:\n\nKeep multicast as default and auto-detection as an option\nDefault Hazelcast Member discovery to auto-detection (with fallback to MulticastJoiner) and keep Hazelcast Client discovery as 127.0.0.1 by default\nDefault both Hazelcast Member discovery and Hazelcast Client discovery to auto-detection\n\nI suggest to use the 3rd option and go all in. In that case, here are the ** non-backward-compatible scenarios**:\n\nHazelcast Member Discovery\n\nRunning Hazelcast on AWS/GCP/Azure uses related plugin instead of Multicast (good thing, it's the whole point of this feature)\nYou need to specify <auto-detection enabled=\"false\"/> instead of <multicast enabled=\"false\"/> if you want to run standalone Hazelcast\n\n\nHazelcast Client Discovery\n\nRunning Hazelcast on AWS/GCP/Azure uses related plugin instead of trying 127.0.0.1 (good thing, it's the whole point of this feature)\n\n\n\n\nTo introduce this minimal backward-compatibility differences, I needed to allow the following configurations:\n<tcp-ip enabled=\"true\"/>\n\nAnd\n<auto-detection enabled=\"true\"/>\n<tcp-ip enabled=\"true\"/>\n\nSo, auto-detection can be co-enabled with other strategies and then this other strategy takes precedence. This is needed, because if I didn't do it this way, then all these existing configurations like this\n<multicast enabled=\"false\"/>\n<tcp-ip enabled=\"true\"/>\n\nwould need to be changed to this\n<auto-detection enabled=\"false\"/>\n<tcp-ip enabled=\"true\"/>\n\nAnd that would be \"super non-backward-compatible\".", "createdAt": "2020-06-19T10:33:31Z", "url": "https://github.com/hazelcast/hazelcast/pull/17112", "merged": true, "mergeCommit": {"oid": "8e6a8369c617b6e108c68bea4ec8e1a8d917da16"}, "closed": true, "closedAt": "2020-07-28T14:50:45Z", "author": {"login": "leszko"}, "timelineItems": {"totalCount": 53, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcriitzgH2gAyNDM3MDI0MzI0OmYxYzJiZTM3MTBhZDFkOWQ3ODFmNGFkODg0Zjk1M2NmYmU0NTVhYjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5W_YDAFqTQ1NjY2NzM1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f1c2be3710ad1d9d781f4ad884f953cfbe455ab1", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/f1c2be3710ad1d9d781f4ad884f953cfbe455ab1", "committedDate": "2020-06-15T15:39:31Z", "message": "Add Auto Detection for Hazelcast Member discovery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68b36acbfbc993aba2974a482efb29cbd208660c", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/68b36acbfbc993aba2974a482efb29cbd208660c", "committedDate": "2020-06-16T09:34:18Z", "message": "Minor Updates to Hazelcast member discovery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b21d81c2880867972323710f77055ad8f5b1b117", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/b21d81c2880867972323710f77055ad8f5b1b117", "committedDate": "2020-06-16T10:39:26Z", "message": "Add 'auto-detection' to Hazelcast Client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "367e07757638346b7dcd74679a708f79eb06f9f1", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/367e07757638346b7dcd74679a708f79eb06f9f1", "committedDate": "2020-06-16T13:11:50Z", "message": "Add 'auto-detection' to Spring Configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8050afeaf1cc7b298c8c760a9b4cb87bf9290c41", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/8050afeaf1cc7b298c8c760a9b4cb87bf9290c41", "committedDate": "2020-06-16T13:46:42Z", "message": "Make 'auto-detection' default"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e63140ffad76a171ca0612248b80bd866d72f32", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/5e63140ffad76a171ca0612248b80bd866d72f32", "committedDate": "2020-06-16T14:31:41Z", "message": "Make 'auto-detection' possible to enable with other join strategies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bdcd3ce302ac809dccacdd949c0f1740947e46d", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/6bdcd3ce302ac809dccacdd949c0f1740947e46d", "committedDate": "2020-06-17T08:20:40Z", "message": "Allow enabling `auto-detection` with other configurations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e1e2b0f5796d58c91269e794fd7188968c1158e", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/7e1e2b0f5796d58c91269e794fd7188968c1158e", "committedDate": "2020-06-17T08:33:13Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f33a84abfdea67213c4d785c86a5e4bd968097dd", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/f33a84abfdea67213c4d785c86a5e4bd968097dd", "committedDate": "2020-06-17T08:45:08Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0857d693aa3f590ff6c729725b08618ea2cd051c", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/0857d693aa3f590ff6c729725b08618ea2cd051c", "committedDate": "2020-06-17T09:07:49Z", "message": "Update default behavior for Hazelcast Client discovery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92f7d945de15708dff94a67b30ac926a703aeac8", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/92f7d945de15708dff94a67b30ac926a703aeac8", "committedDate": "2020-06-17T09:13:42Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7c24a30153d3e10edfca037ac8cd488257d6c01", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/b7c24a30153d3e10edfca037ac8cd488257d6c01", "committedDate": "2020-06-17T09:39:03Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73ca1e6d0cd5d1dd76cc4e07ac49b18890ebcca0", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/73ca1e6d0cd5d1dd76cc4e07ac49b18890ebcca0", "committedDate": "2020-06-17T10:29:41Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "461f96fbdadf5513232d307ff4cb6b4c8873ec79", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/461f96fbdadf5513232d307ff4cb6b4c8873ec79", "committedDate": "2020-06-17T10:36:42Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc3fb7af93a2a9fc9a21db4afb62b75268118bfd", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/cc3fb7af93a2a9fc9a21db4afb62b75268118bfd", "committedDate": "2020-06-17T11:46:37Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60f8c3fc38295ca0d4ab701db2cff9aba2e00ddf", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/60f8c3fc38295ca0d4ab701db2cff9aba2e00ddf", "committedDate": "2020-06-17T13:09:35Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a87c959dc7900f0a20474a6f6652ee1b5c356bc3", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/a87c959dc7900f0a20474a6f6652ee1b5c356bc3", "committedDate": "2020-06-17T14:44:18Z", "message": "Remove Aws Joiner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5846ef5fa7b8f3ff2b2dec93f6163598daf80e39", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/5846ef5fa7b8f3ff2b2dec93f6163598daf80e39", "committedDate": "2020-06-17T14:44:37Z", "message": "Add unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c5a3fbaa570d187d2a213b4cef0ef502a4d3e13", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/0c5a3fbaa570d187d2a213b4cef0ef502a4d3e13", "committedDate": "2020-06-18T10:57:20Z", "message": "Add unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4779014c112ce2e489a91f4e3260bd9a7dc5a91", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/b4779014c112ce2e489a91f4e3260bd9a7dc5a91", "committedDate": "2020-06-18T11:09:59Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4f38a09100e176c888e5f6afe5013dc4f23acac", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/b4f38a09100e176c888e5f6afe5013dc4f23acac", "committedDate": "2020-06-18T11:52:04Z", "message": "Add Spring Tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1656651c40b00d9d57ebd953cde18993ba85d052", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/1656651c40b00d9d57ebd953cde18993ba85d052", "committedDate": "2020-06-18T11:52:34Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8774f9325336d62536a6304df489790a4219b09", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/d8774f9325336d62536a6304df489790a4219b09", "committedDate": "2020-06-18T12:41:08Z", "message": "Changes after self code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "882d1ec594b377c2306de1ccf3097aab20dbcbec", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/882d1ec594b377c2306de1ccf3097aab20dbcbec", "committedDate": "2020-06-19T13:02:13Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba44b4dfeef0b187c56b24631fb06d067d40afc2", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/ba44b4dfeef0b187c56b24631fb06d067d40afc2", "committedDate": "2020-06-19T14:09:37Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDgwMDgz", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-439080083", "createdAt": "2020-06-29T12:14:32Z", "commit": {"oid": "ba44b4dfeef0b187c56b24631fb06d067d40afc2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMjoxNDozMlrOGqODIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMjoxNDozMlrOGqODIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjkyMzU1Mw==", "bodyText": "toString() missing -> JoinConfig.toString() relies on it.", "url": "https://github.com/hazelcast/hazelcast/pull/17112#discussion_r446923553", "createdAt": "2020-06-29T12:14:32Z", "author": {"login": "jerrinot"}, "path": "hazelcast/src/main/java/com/hazelcast/config/AutoDetectionConfig.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.config;\n+\n+/**\n+ * Configuration for the Discovery Strategy Auto Detection.\n+ * <p>\n+ * When enabled, it will walk through all available discovery strategies and detect the correct one for the current runtime\n+ * environment. For example, it will automatically use the {@code hazelcast-aws} plugin if run on an AWS instance.\n+ */\n+public class AutoDetectionConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba44b4dfeef0b187c56b24631fb06d067d40afc2"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MjQzNjA3", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-439243607", "createdAt": "2020-06-29T15:11:34Z", "commit": {"oid": "ba44b4dfeef0b187c56b24631fb06d067d40afc2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxMTozNFrOGqVi7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxMTozNFrOGqVi7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NjM4MQ==", "bodyText": "This part deserves a more detailed JavaDoc. It's a public API after one. As a SPI implementer this is the first question I have to ask:  What is the system going to prefer? I the strategy with the higher ordinals will be picked, but it should be explicit. Also I am not quite sure what the 'PLATFORM' level means.", "url": "https://github.com/hazelcast/hazelcast/pull/17112#discussion_r447046381", "createdAt": "2020-06-29T15:11:34Z", "author": {"login": "jerrinot"}, "path": "hazelcast/src/main/java/com/hazelcast/spi/discovery/DiscoveryStrategyFactory.java", "diffHunk": "@@ -73,4 +75,44 @@\n      * @return a set of expected configuration properties\n      */\n     Collection<PropertyDefinition> getConfigurationProperties();\n+\n+    /**\n+     * Checks whether the given discovery strategy may be applied with no additional config to the environment in which Hazelcast\n+     * is currently running.\n+     * <p>\n+     * Used by the auto detection mechanism to decide which strategy should be used.\n+     */\n+    default boolean isAutoDetectionApplicable() {\n+        return false;\n+    }\n+\n+    /**\n+     * Level of the discovery strategy.\n+     */\n+    default DiscoveryStrategyLevel discoveryStrategyLevel() {\n+        return UNKNOWN;\n+    }\n+\n+    /**\n+     * Level of the discovery strategy.\n+     * <p>\n+     * Discovery strategies can have different levels. They can be at the level of Cloud Virtual Machines, for example, AWS EC2\n+     * Instance or GCP Virtual Machine. They can also be at the level of some specific platform or framework, like Kubernetes.\n+     * <p>\n+     * It decides on the priority in the auto detection mechanism, because you can have a Kubernetes environment installed on\n+     * AWS EC2 Instances and then Hazelcast Kubernetes Discovery Strategy should take precedence over AWS Discovery Strategy.\n+     */\n+    enum DiscoveryStrategyLevel {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba44b4dfeef0b187c56b24631fb06d067d40afc2"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1922622e58f81882ec8f11a88b03c2a8dd7f6bb3", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/1922622e58f81882ec8f11a88b03c2a8dd7f6bb3", "committedDate": "2020-07-01T10:11:05Z", "message": "Change fall-back to: member-member => MulticastJoiner, client-member => 127.0.0.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c6ac824fed640d8d7d1e257eb1d480be75530b5", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/3c6ac824fed640d8d7d1e257eb1d480be75530b5", "committedDate": "2020-07-01T10:41:31Z", "message": "Add AutoDetectionConfig.toString()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c3da24fe9d654c5e9f18e28387f1acf260ec922", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/4c3da24fe9d654c5e9f18e28387f1acf260ec922", "committedDate": "2020-07-01T11:04:01Z", "message": "Improve Javadoc of DiscoveryStrategyFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37fa76966e9e577424315fb92a907cc0c4a3b04e", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/37fa76966e9e577424315fb92a907cc0c4a3b04e", "committedDate": "2020-07-01T13:12:21Z", "message": "Fix issue when multiple discovery strategies were enabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78fbe9178f993523d333874ad0492b4c03653724", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/78fbe9178f993523d333874ad0492b4c03653724", "committedDate": "2020-07-01T14:01:30Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91d542b86c311ad7e34ab2fa009c2378bb67d79f", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/91d542b86c311ad7e34ab2fa009c2378bb67d79f", "committedDate": "2020-07-01T14:08:04Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e74f373f24cd5c62736ccf8693170758ff644604", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/e74f373f24cd5c62736ccf8693170758ff644604", "committedDate": "2020-07-02T12:33:42Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cebfd0ad180611b832b878cc1513d1dffaf3369", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/1cebfd0ad180611b832b878cc1513d1dffaf3369", "committedDate": "2020-07-02T13:47:37Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69bdf9f996d915d58455942cb8d7b27196884680", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/69bdf9f996d915d58455942cb8d7b27196884680", "committedDate": "2020-07-03T07:46:41Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd8189d7144681dd9877410d8ffa6d842cfc37b8", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/dd8189d7144681dd9877410d8ffa6d842cfc37b8", "committedDate": "2020-07-03T10:44:00Z", "message": "Test ignoring AutoDetectionDefaultDiscoveryServiceTest tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65395e8b12b3862768b915975887208e25e850ca", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/65395e8b12b3862768b915975887208e25e850ca", "committedDate": "2020-07-03T10:57:06Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e82309c7e467106243257aa7f4e82d9748972ec4", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/e82309c7e467106243257aa7f4e82d9748972ec4", "committedDate": "2020-07-03T12:37:11Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9b259edb39995b4914f80cb5edab07333709e26", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/f9b259edb39995b4914f80cb5edab07333709e26", "committedDate": "2020-07-03T13:09:08Z", "message": "Fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbe1aecddf1781120f036d72b829f450df0e3ec7", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/dbe1aecddf1781120f036d72b829f450df0e3ec7", "committedDate": "2020-07-03T13:28:56Z", "message": "Fix issue with getJoiner()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6331ef2ffe0c64b99606ed53163bd113b9075208", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/6331ef2ffe0c64b99606ed53163bd113b9075208", "committedDate": "2020-07-03T14:45:15Z", "message": "Remove temporary @Ignore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzMjUwODcx", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-453250871", "createdAt": "2020-07-22T12:04:05Z", "commit": {"oid": "6331ef2ffe0c64b99606ed53163bd113b9075208"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxMjowNDowNVrOG1fWeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxMjowNDowNVrOG1fWeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODc0MTM2OA==", "bodyText": "probably should not to info, we are trying to reduce logging noise. see: #17243", "url": "https://github.com/hazelcast/hazelcast/pull/17112#discussion_r458741368", "createdAt": "2020-07-22T12:04:05Z", "author": {"login": "devOpsHazelcast"}, "path": "hazelcast/src/main/java/com/hazelcast/spi/discovery/impl/DefaultDiscoveryService.java", "diffHunk": "@@ -133,14 +134,25 @@ private boolean validateCandidate(DiscoveryNode candidate) {\n         try {\n             Collection<DiscoveryStrategyConfig> discoveryStrategyConfigs = new ArrayList<DiscoveryStrategyConfig>(\n                     settings.getAllDiscoveryConfigs());\n-\n             List<DiscoveryStrategyFactory> factories = collectFactories(discoveryStrategyConfigs, configClassLoader);\n \n             List<DiscoveryStrategy> discoveryStrategies = new ArrayList<DiscoveryStrategy>();\n             for (DiscoveryStrategyConfig config : discoveryStrategyConfigs) {\n                 DiscoveryStrategy discoveryStrategy = buildDiscoveryStrategy(config, factories);\n                 discoveryStrategies.add(discoveryStrategy);\n             }\n+\n+            if (discoveryStrategies.isEmpty() && settings.isAutoDetectionEnabled()) {\n+                logger.info(\"Discovery auto-detection enabled, looking for available discovery strategies\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6331ef2ffe0c64b99606ed53163bd113b9075208"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzMjcxMTQ4", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-453271148", "createdAt": "2020-07-22T12:33:14Z", "commit": {"oid": "6331ef2ffe0c64b99606ed53163bd113b9075208"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "935a9952b71d78772eb1e84bc72590fa8c432874", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/935a9952b71d78772eb1e84bc72590fa8c432874", "committedDate": "2020-07-22T12:43:57Z", "message": "Change logging from info to fine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d937fe19134e2c0b897a19725f9a027b6de4d317", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/d937fe19134e2c0b897a19725f9a027b6de4d317", "committedDate": "2020-07-22T13:44:08Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MzY5ODU0", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-456369854", "createdAt": "2020-07-28T07:28:07Z", "commit": {"oid": "935a9952b71d78772eb1e84bc72590fa8c432874"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "116e0f58228fb9e3320368ff94b27e025a33ec90", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/116e0f58228fb9e3320368ff94b27e025a33ec90", "committedDate": "2020-07-28T08:22:16Z", "message": "Add error handling if auto-detection from the given strategy throws an exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33ca77df79accdae4c6c49db7aa0a04a1291311d", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/33ca77df79accdae4c6c49db7aa0a04a1291311d", "committedDate": "2020-07-28T08:22:45Z", "message": "Merge branch 'master' of https://github.com/hazelcast/hazelcast into auto-detection-3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NDg0Njg1", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-456484685", "createdAt": "2020-07-28T10:00:31Z", "commit": {"oid": "33ca77df79accdae4c6c49db7aa0a04a1291311d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDowMDozMVrOG4FneA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDowMDozMVrOG4FneA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ2NTQ2NA==", "bodyText": "This branch seems unnecessary. Isn't this already covered on the last return statement?", "url": "https://github.com/hazelcast/hazelcast/pull/17112#discussion_r461465464", "createdAt": "2020-07-28T10:00:31Z", "author": {"login": "sancar"}, "path": "hazelcast/src/main/java/com/hazelcast/client/impl/clientside/ClusterDiscoveryServiceBuilder.java", "diffHunk": "@@ -132,22 +133,18 @@ private AddressProvider createAddressProvider(ClientConfig clientConfig, Discove\n         isDiscoveryConfigurationConsistent(addressListProvided, awsDiscoveryEnabled, gcpDiscoveryEnabled, azureDiscoveryEnabled,\n                 kubernetesDiscoveryEnabled, eurekaDiscoveryEnabled, discoverySpiEnabled, hazelcastCloudEnabled);\n \n-        if (discoveryService != null) {\n-            return new RemoteAddressProvider(() -> discoverAddresses(discoveryService), usePublicAddress(clientConfig));\n-        } else if (hazelcastCloudEnabled) {\n-            String discoveryToken;\n-            if (cloudConfig.isEnabled()) {\n-                discoveryToken = cloudConfig.getDiscoveryToken();\n-            } else {\n-                discoveryToken = cloudDiscoveryToken;\n-            }\n+        if (hazelcastCloudEnabled) {\n+            String discoveryToken = cloudDiscoveryToken(cloudConfig, cloudDiscoveryToken);\n             String cloudUrlBase = properties.getString(HazelcastCloudDiscovery.CLOUD_URL_BASE_PROPERTY);\n             String urlEndpoint = HazelcastCloudDiscovery.createUrlEndpoint(cloudUrlBase, discoveryToken);\n             int connectionTimeoutMillis = getConnectionTimeoutMillis(networkConfig);\n             HazelcastCloudDiscovery cloudDiscovery = new HazelcastCloudDiscovery(urlEndpoint, connectionTimeoutMillis);\n             return new RemoteAddressProvider(cloudDiscovery::discoverNodes, true);\n+        } else if (!networkConfig.getAddresses().isEmpty()) {\n+            return new DefaultAddressProvider(networkConfig);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33ca77df79accdae4c6c49db7aa0a04a1291311d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ada47824e599779601ef768dba367578e478596", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/7ada47824e599779601ef768dba367578e478596", "committedDate": "2020-07-28T13:26:36Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79627add5af5015db0f479af5bd8e295a68dfb56", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast/commit/79627add5af5015db0f479af5bd8e295a68dfb56", "committedDate": "2020-07-28T13:29:11Z", "message": "Refactor ClusterDiscoveryServiceBuilder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NjY3MzU0", "url": "https://github.com/hazelcast/hazelcast/pull/17112#pullrequestreview-456667354", "createdAt": "2020-07-28T14:06:54Z", "commit": {"oid": "79627add5af5015db0f479af5bd8e295a68dfb56"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3713, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}