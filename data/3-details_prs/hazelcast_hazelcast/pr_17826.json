{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1Mjc2MzI1", "number": 17826, "title": "Release acquired sessions on failure for SessionAwareSemaphore", "bodyText": "In case of an unspecified exception, acquire, tryAcquire and\ndrainPermits methods were not releasing the acquired permits.\nThis is an attempt to fix that problem by catching unspecified errors,\nreleasing the number of acquired permits, and rethrowing.\nI will prepare backports once this PR is approved and merged.", "createdAt": "2020-11-04T10:09:24Z", "url": "https://github.com/hazelcast/hazelcast/pull/17826", "merged": true, "mergeCommit": {"oid": "c726c9db8d3f533db5ffdf018ccdd6af43006ae2"}, "closed": true, "closedAt": "2021-03-08T11:34:32Z", "author": {"login": "mdumandag"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgNjEegBqjQwNDEwNzY1NjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeBF6BmgFqTYwNjE3MzYxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f9f706aa859e6f49a90d3971b92f951abc3fa91", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/7f9f706aa859e6f49a90d3971b92f951abc3fa91", "committedDate": "2020-11-04T10:03:51Z", "message": "Release acquired sessions on failure for SessionAwareSemaphore\n\nIn case of an unspecified exception, `acquire`, `tryAcquire` and\n`drainPermits` methods were not releasing the acquired permits.\nThis is an attempt to fix that problem by catching unspecified errors,\nreleasing the number of acquired permits, and rethrowing."}, "afterCommit": {"oid": "7d7fc0b59ecaab7f5442e71abd33ff299063157b", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/7d7fc0b59ecaab7f5442e71abd33ff299063157b", "committedDate": "2020-11-26T07:09:34Z", "message": "Release acquired sessions on failure for SessionAwareSemaphore\n\nIn case of an unspecified exception, `acquire`, `tryAcquire` and\n`drainPermits` methods were not releasing the acquired permits.\nThis is an attempt to fix that problem by catching unspecified errors,\nreleasing the number of acquired permits, and rethrowing."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MDgxOTEx", "url": "https://github.com/hazelcast/hazelcast/pull/17826#pullrequestreview-539081911", "createdAt": "2020-11-26T08:21:59Z", "commit": {"oid": "7d7fc0b59ecaab7f5442e71abd33ff299063157b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODoyMTo1OVrOH6QPew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODoyMTo1OVrOH6QPew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg0NTU2Mw==", "bodyText": "We return false for other exceptional cases. Does a user expect an exception from this method?", "url": "https://github.com/hazelcast/hazelcast/pull/17826#discussion_r530845563", "createdAt": "2020-11-26T08:21:59Z", "author": {"login": "petrpleshachkov"}, "path": "hazelcast/src/main/java/com/hazelcast/client/cp/internal/datastructures/semaphore/SessionAwareSemaphoreProxy.java", "diffHunk": "@@ -147,6 +151,9 @@ public boolean tryAcquire(int permits, long timeout, TimeUnit unit) {\n             } catch (WaitKeyCancelledException e) {\n                 sessionManager.releaseSession(this.groupId, sessionId, permits);\n                 return false;\n+            } catch (Throwable t) {\n+                sessionManager.releaseSession(this.groupId, sessionId, permits);\n+                throw rethrow(t);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d7fc0b59ecaab7f5442e71abd33ff299063157b"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MDg5MzQz", "url": "https://github.com/hazelcast/hazelcast/pull/17826#pullrequestreview-539089343", "createdAt": "2020-11-26T08:32:06Z", "commit": {"oid": "7d7fc0b59ecaab7f5442e71abd33ff299063157b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMzI3MDE3", "url": "https://github.com/hazelcast/hazelcast/pull/17826#pullrequestreview-551327017", "createdAt": "2020-12-14T12:39:55Z", "commit": {"oid": "8203101b8942a61db419efdf5ba22ab9a8813e07"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8203101b8942a61db419efdf5ba22ab9a8813e07", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/8203101b8942a61db419efdf5ba22ab9a8813e07", "committedDate": "2020-11-26T09:27:18Z", "message": "catch only RuntimeExceptions"}, "afterCommit": {"oid": "ef89f0a46a06cfdb555f005cc84cbbead137e366", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/ef89f0a46a06cfdb555f005cc84cbbead137e366", "committedDate": "2021-01-22T10:22:19Z", "message": "add unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTc0MTgzMTEy", "url": "https://github.com/hazelcast/hazelcast/pull/17826#pullrequestreview-574183112", "createdAt": "2021-01-22T11:39:09Z", "commit": {"oid": "b7e92d2e87a2b1efe135832f04d278c1a90c2718"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c020f9323149bbd6049eed14bb9285449049016", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/4c020f9323149bbd6049eed14bb9285449049016", "committedDate": "2021-03-03T09:59:49Z", "message": "Release acquired sessions on failure for SessionAwareSemaphore\n\nIn case of an unspecified exception, `acquire`, `tryAcquire` and\n`drainPermits` methods were not releasing the acquired permits.\nThis is an attempt to fix that problem by catching unspecified errors,\nreleasing the number of acquired permits, and rethrowing."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "555227e53055c3e3e90ffe77d1b4a79a93db419f", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/555227e53055c3e3e90ffe77d1b4a79a93db419f", "committedDate": "2021-03-03T09:59:49Z", "message": "catch only RuntimeExceptions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "016a487bbc46daba03ea99cb6ff8424d953b009d", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/016a487bbc46daba03ea99cb6ff8424d953b009d", "committedDate": "2021-03-03T09:59:49Z", "message": "add unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1b9c6d27a6392b36a90abc65e3db9cf86d409b4", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d1b9c6d27a6392b36a90abc65e3db9cf86d409b4", "committedDate": "2021-03-03T10:00:30Z", "message": "add missing copyright headers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7e92d2e87a2b1efe135832f04d278c1a90c2718", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/b7e92d2e87a2b1efe135832f04d278c1a90c2718", "committedDate": "2021-01-22T10:33:12Z", "message": "add missing copyright headers"}, "afterCommit": {"oid": "d1b9c6d27a6392b36a90abc65e3db9cf86d409b4", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d1b9c6d27a6392b36a90abc65e3db9cf86d409b4", "committedDate": "2021-03-03T10:00:30Z", "message": "add missing copyright headers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c159ded258643b1b3ca013e5393edf5c5418efe1", "author": {"user": {"login": "mdumandag", "name": "Metin Dumandag"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c159ded258643b1b3ca013e5393edf5c5418efe1", "committedDate": "2021-03-03T10:07:19Z", "message": "update copyright years"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA2MTczNjEw", "url": "https://github.com/hazelcast/hazelcast/pull/17826#pullrequestreview-606173610", "createdAt": "2021-03-08T10:55:13Z", "commit": {"oid": "c159ded258643b1b3ca013e5393edf5c5418efe1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3122, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}