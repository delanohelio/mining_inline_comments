{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNDczMTI0", "number": 17388, "title": "Expose upsert/inject information for SQL tables", "bodyText": "To enable INSERTs for auto-discovered maps on Jet side.", "createdAt": "2020-08-21T07:42:58Z", "url": "https://github.com/hazelcast/hazelcast/pull/17388", "merged": true, "mergeCommit": {"oid": "d73f7180b6c0eab31b2e3e01f0c74266db62d1d3"}, "closed": true, "closedAt": "2020-08-25T06:02:43Z", "author": {"login": "gierlachg"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAc7BtgH2gAyNDcxNDczMTI0OjIwZTUxMGNmODEwNTkyMTZkOTE3ZGJjNzFiZjBiNWY3MzA4ZjU2ZmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCDJ27AFqTQ3MzUyMjI0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "20e510cf81059216d917dbc71bf0b5f7308f56fe", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/20e510cf81059216d917dbc71bf0b5f7308f56fe", "committedDate": "2020-08-19T14:59:03Z", "message": "Introduce UpsertDescriptors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1fefdb3ad51051734b233a677a0465158079da8", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f1fefdb3ad51051734b233a677a0465158079da8", "committedDate": "2020-08-20T08:22:49Z", "message": "Merge branch 'master' into upserts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48223cb498aeea568bc007d6aebafab1d202fd7e", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/48223cb498aeea568bc007d6aebafab1d202fd7e", "committedDate": "2020-08-20T11:45:11Z", "message": "Merge Pojo & Primitive upsert descriptor into Java one"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f869a68bc573d5e5fe8d2e05032a07537d7b8b0b", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/f869a68bc573d5e5fe8d2e05032a07537d7b8b0b", "committedDate": "2020-08-20T14:28:46Z", "message": "Simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "606cba61ebdbb83912b5a2f01fbfc0d2e01ef743", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/606cba61ebdbb83912b5a2f01fbfc0d2e01ef743", "committedDate": "2020-08-20T14:30:51Z", "message": "Add equals() & hashCode() to upsert descriptors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49a11f878e25f5393ed96387a1709c594b19a478", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/49a11f878e25f5393ed96387a1709c594b19a478", "committedDate": "2020-08-21T07:31:44Z", "message": "Tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "295b18dad5f7a10d7b8720ddb6fc5b0413a6d803", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/295b18dad5f7a10d7b8720ddb6fc5b0413a6d803", "committedDate": "2020-08-21T07:34:01Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dcdd77699630a9bf29c8faee11b169ea61385e9", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/6dcdd77699630a9bf29c8faee11b169ea61385e9", "committedDate": "2020-08-21T07:40:07Z", "message": "Merge remote-tracking branch 'upstream/master' into upserts\n\n# Conflicts:\n#\thazelcast-sql/src/test/java/com/hazelcast/sql/impl/expression/ExpressionTestBase.java\n#\thazelcast/src/main/java/com/hazelcast/sql/impl/schema/map/AbstractMapTable.java\n#\thazelcast/src/main/java/com/hazelcast/sql/impl/schema/map/PartitionedMapTable.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e176b69754deeb1cefecb77df71242313d589da9", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/e176b69754deeb1cefecb77df71242313d589da9", "committedDate": "2020-08-21T07:50:15Z", "message": "Make checkstyle happier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a1baff453e608ac944d81e217dfa27cc508e37c", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/8a1baff453e608ac944d81e217dfa27cc508e37c", "committedDate": "2020-08-21T08:50:58Z", "message": "Fix serialization test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de335d911697e2861f625cb321c635ff9db0b4c7", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/de335d911697e2861f625cb321c635ff9db0b4c7", "committedDate": "2020-08-21T09:00:20Z", "message": "Merge remote-tracking branch 'upstream/master' into upserts\n\n# Conflicts:\n#\thazelcast/src/main/java/com/hazelcast/sql/impl/SqlDataSerializerHook.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b907dd5d36e50c821744fb08ffe56f476df16dce", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/b907dd5d36e50c821744fb08ffe56f476df16dce", "committedDate": "2020-08-24T08:30:18Z", "message": "Rework"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "451abbec95f3ce81cf01f26768e04cf8af2dfc1c", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/451abbec95f3ce81cf01f26768e04cf8af2dfc1c", "committedDate": "2020-08-24T08:31:14Z", "message": "Merge branch 'master' into upserts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a021ea482de9519a83ee5dc0f6992b0af473f89d", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/a021ea482de9519a83ee5dc0f6992b0af473f89d", "committedDate": "2020-08-24T09:03:35Z", "message": "Merge 'master' int oupserts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/ae736076f49ebe4474121d187fa0e0ce3fc0fb58", "committedDate": "2020-08-24T10:26:13Z", "message": "Naming"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMzQyODAw", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473342800", "createdAt": "2020-08-24T10:29:24Z", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMzQ4ODM0", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473348834", "createdAt": "2020-08-24T10:39:47Z", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMDozOTo0N1rOHFe3cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMDozOTo0N1rOHFe3cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUxMDY0Mg==", "bodyText": "I'd prefer something more pointing to the use, such as keyResolverPluginData", "url": "https://github.com/hazelcast/hazelcast/pull/17388#discussion_r475510642", "createdAt": "2020-08-24T10:39:47Z", "author": {"login": "viliam-durina"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/schema/map/AbstractMapTable.java", "diffHunk": "@@ -37,6 +37,8 @@\n     private final String mapName;\n     private final QueryTargetDescriptor keyDescriptor;\n     private final QueryTargetDescriptor valueDescriptor;\n+    private final Object keyAppendix;\n+    private final Object valueAppendix;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDQzMzMw", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473443330", "createdAt": "2020-08-24T13:03:34Z", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzowMzozNVrOHFjXWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzowMzozNVrOHFjXWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU4NDM0NA==", "bodyText": "Minor comment - the name is not very specific. I would name it something like JetMapMetadataResolver or alike, to highlight that is:\n\nComes from Jet\nDeals with metadata", "url": "https://github.com/hazelcast/hazelcast/pull/17388#discussion_r475584344", "createdAt": "2020-08-24T13:03:35Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/schema/map/MapResolverPlugin.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.sql.impl.schema.map;\n+\n+import com.hazelcast.map.IMap;\n+import com.hazelcast.replicatedmap.ReplicatedMap;\n+\n+/**\n+ * Plugin mechanism, allowing to perform additional analysis of\n+ * {@link IMap}/{@link ReplicatedMap} keys & values on sample based schema resolution.\n+ * <p/>\n+ * Used by Jet.\n+ */\n+@FunctionalInterface\n+public interface MapResolverPlugin {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDQ0NTkw", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473444590", "createdAt": "2020-08-24T13:05:14Z", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzowNToxNFrOHFja0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzowNToxNFrOHFja0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU4NTIzNA==", "bodyText": "Also minor comment.\nIn the resolver's code, you either pass here Class of ClassDefinition as the first argument. It is ok from IMDG perspective, but are you ok with a necessity of casts inside Jet implementation?\nIf you leave the interface as is, I would propose adding JavaDoc about expected arguments.", "url": "https://github.com/hazelcast/hazelcast/pull/17388#discussion_r475585234", "createdAt": "2020-08-24T13:05:14Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/schema/map/MapResolverPlugin.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.sql.impl.schema.map;\n+\n+import com.hazelcast.map.IMap;\n+import com.hazelcast.replicatedmap.ReplicatedMap;\n+\n+/**\n+ * Plugin mechanism, allowing to perform additional analysis of\n+ * {@link IMap}/{@link ReplicatedMap} keys & values on sample based schema resolution.\n+ * <p/>\n+ * Used by Jet.\n+ */\n+@FunctionalInterface\n+public interface MapResolverPlugin {\n+\n+    /**\n+     * Return an appendix that is attached to the resolved {@link AbstractMapTable}.\n+     */\n+    Object resolve(Object object, boolean key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDQ0ODY5", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473444869", "createdAt": "2020-08-24T13:05:37Z", "commit": {"oid": "ae736076f49ebe4474121d187fa0e0ce3fc0fb58"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611ed2fa04fe61bfb83e4fafaff7e0401a674f0e", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/611ed2fa04fe61bfb83e4fafaff7e0401a674f0e", "committedDate": "2020-08-24T13:40:19Z", "message": "Naming"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTEyMjgx", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473512281", "createdAt": "2020-08-24T13:54:25Z", "commit": {"oid": "611ed2fa04fe61bfb83e4fafaff7e0401a674f0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2f935287aadc17fec73c3191183ade5121a1bc2", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d2f935287aadc17fec73c3191183ade5121a1bc2", "committedDate": "2020-08-24T13:57:10Z", "message": "Formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTIyMjQz", "url": "https://github.com/hazelcast/hazelcast/pull/17388#pullrequestreview-473522243", "createdAt": "2020-08-24T14:05:34Z", "commit": {"oid": "d2f935287aadc17fec73c3191183ade5121a1bc2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3414, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}