{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NDc5MjQy", "number": 17530, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMTo1NzowOFrOEjFwFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMTo1NzowOFrOEjFwFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MjI5ODQ0OnYy", "diffSide": "RIGHT", "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMTo1NzowOFrOHRQTrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxMjo1NjowOVrOHRSb3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg1NTAyMg==", "bodyText": "In which situation the owner can be null?", "url": "https://github.com/hazelcast/hazelcast/pull/17530#discussion_r487855022", "createdAt": "2020-09-14T11:57:08Z", "author": {"login": "petrpleshachkov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "diffHunk": "@@ -190,6 +193,17 @@ public static SqlColumnMetadata getColumnMetadata(String columnName, QueryDataTy\n         for (Partition part : parts) {\n             Member owner = part.getOwner();\n \n+            if (owner == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb314381ea283a540c482e05630fcfc4ee140662"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg4NjcwMA==", "bodyText": "I cannot explain the exact situations when the partition could be unassigned. Some of them - member failure, FROZEN cluster state. The main thing is that the null is in the contract of this method (see JavaDoc):\n\nIt can be that null is returned if the owner of a partition has not been established", "url": "https://github.com/hazelcast/hazelcast/pull/17530#discussion_r487886700", "createdAt": "2020-09-14T12:51:25Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "diffHunk": "@@ -190,6 +193,17 @@ public static SqlColumnMetadata getColumnMetadata(String columnName, QueryDataTy\n         for (Partition part : parts) {\n             Member owner = part.getOwner();\n \n+            if (owner == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg1NTAyMg=="}, "originalCommit": {"oid": "cb314381ea283a540c482e05630fcfc4ee140662"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg4NzU2MQ==", "bodyText": "The partition table is also calculated lazily so if you create a new cluster and don't call any partition operations, the partition table is not established yet and owners are null.", "url": "https://github.com/hazelcast/hazelcast/pull/17530#discussion_r487887561", "createdAt": "2020-09-14T12:52:45Z", "author": {"login": "mmedenjak"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "diffHunk": "@@ -190,6 +193,17 @@ public static SqlColumnMetadata getColumnMetadata(String columnName, QueryDataTy\n         for (Partition part : parts) {\n             Member owner = part.getOwner();\n \n+            if (owner == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg1NTAyMg=="}, "originalCommit": {"oid": "cb314381ea283a540c482e05630fcfc4ee140662"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg4ODM4Mw==", "bodyText": "Does it mean that one member failure would trigger this exception for any SQL query?", "url": "https://github.com/hazelcast/hazelcast/pull/17530#discussion_r487888383", "createdAt": "2020-09-14T12:54:04Z", "author": {"login": "petrpleshachkov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "diffHunk": "@@ -190,6 +193,17 @@ public static SqlColumnMetadata getColumnMetadata(String columnName, QueryDataTy\n         for (Partition part : parts) {\n             Member owner = part.getOwner();\n \n+            if (owner == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg1NTAyMg=="}, "originalCommit": {"oid": "cb314381ea283a540c482e05630fcfc4ee140662"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg4OTg4NQ==", "bodyText": "Member failure may trigger temporal errors until the partition table is recalculated.", "url": "https://github.com/hazelcast/hazelcast/pull/17530#discussion_r487889885", "createdAt": "2020-09-14T12:56:09Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/QueryUtils.java", "diffHunk": "@@ -190,6 +193,17 @@ public static SqlColumnMetadata getColumnMetadata(String columnName, QueryDataTy\n         for (Partition part : parts) {\n             Member owner = part.getOwner();\n \n+            if (owner == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzg1NTAyMg=="}, "originalCommit": {"oid": "cb314381ea283a540c482e05630fcfc4ee140662"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 216, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}