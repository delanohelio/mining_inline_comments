{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNjQyNDM4", "number": 17155, "title": "Nullify owned partitions instead of reloading", "bodyText": "when needed loading will be happening in place.", "createdAt": "2020-07-01T11:39:33Z", "url": "https://github.com/hazelcast/hazelcast/pull/17155", "merged": true, "mergeCommit": {"oid": "50f9f5ed5cd3f4118afc9f17c862333dfba99f58"}, "closed": true, "closedAt": "2020-08-27T15:47:12Z", "author": {"login": "ahmetmircik"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwssQ0gBqjM1MDMyMjc0MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDBcchgBqjM2OTk5NzgxMTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c958e0bd985586bca02ad227b4c2d59bd1222cd1", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/c958e0bd985586bca02ad227b4c2d59bd1222cd1", "committedDate": "2020-07-01T15:34:49Z", "message": "wip"}, "afterCommit": {"oid": "4450197045d993810b871e3127c3660518661ce9", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/4450197045d993810b871e3127c3660518661ce9", "committedDate": "2020-07-01T16:18:29Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e588b4e27a9fd28383a11c3c853ce6d7bd9075dc", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/e588b4e27a9fd28383a11c3c853ce6d7bd9075dc", "committedDate": "2020-07-01T17:34:28Z", "message": "Fix dependency problem"}, "afterCommit": {"oid": "d1dc844babe62b76e6d4b969c743a485529d032d", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d1dc844babe62b76e6d4b969c743a485529d032d", "committedDate": "2020-07-01T17:40:12Z", "message": "Fix dependency problem"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e72a4a7c3134483f5699a58f40cac34d3605bf0c", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/e72a4a7c3134483f5699a58f40cac34d3605bf0c", "committedDate": "2020-07-01T17:55:31Z", "message": "Fix checkstyle"}, "afterCommit": {"oid": "d9ee85d9bcaaea38c862697e64ef232cb2179bb3", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d9ee85d9bcaaea38c862697e64ef232cb2179bb3", "committedDate": "2020-07-01T19:38:40Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9ee85d9bcaaea38c862697e64ef232cb2179bb3", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d9ee85d9bcaaea38c862697e64ef232cb2179bb3", "committedDate": "2020-07-01T19:38:40Z", "message": "Nullify owned partitions instead of reloading"}, "afterCommit": {"oid": "8d9d5edc8cc3591bae1c620158b1490aea7cf299", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/8d9d5edc8cc3591bae1c620158b1490aea7cf299", "committedDate": "2020-07-02T13:48:53Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d9d5edc8cc3591bae1c620158b1490aea7cf299", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/8d9d5edc8cc3591bae1c620158b1490aea7cf299", "committedDate": "2020-07-02T13:48:53Z", "message": "Nullify owned partitions instead of reloading"}, "afterCommit": {"oid": "6003f162a39990264a4aaf5fe75bf2c68179f11b", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/6003f162a39990264a4aaf5fe75bf2c68179f11b", "committedDate": "2020-07-03T08:52:14Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6003f162a39990264a4aaf5fe75bf2c68179f11b", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/6003f162a39990264a4aaf5fe75bf2c68179f11b", "committedDate": "2020-07-03T08:52:14Z", "message": "Nullify owned partitions instead of reloading"}, "afterCommit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/787057f06b2e6745d50d39566df35840010d2aa4", "committedDate": "2020-08-17T09:00:07Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NTA5OTcx", "url": "https://github.com/hazelcast/hazelcast/pull/17155#pullrequestreview-476509971", "createdAt": "2020-08-27T08:44:24Z", "commit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NjYyODY3", "url": "https://github.com/hazelcast/hazelcast/pull/17155#pullrequestreview-476662867", "createdAt": "2020-08-27T12:19:35Z", "commit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMjoxOTozNVrOHINtnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMjoxOTozNVrOHINtnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM3NTMyNw==", "bodyText": "What did we gain with this change? When was it an issue?", "url": "https://github.com/hazelcast/hazelcast/pull/17155#discussion_r478375327", "createdAt": "2020-08-27T12:19:35Z", "author": {"login": "mmedenjak"}, "path": "hazelcast/src/main/java/com/hazelcast/map/impl/MapServiceContextImpl.java", "diffHunk": "@@ -483,17 +485,22 @@ public PartitionIdSet getOwnedPartitions() {\n      */\n     @Override\n     public void reloadOwnedPartitions() {\n-        final IPartitionService partitionService = nodeEngine.getPartitionService();\n+        IPartitionService partitionService = nodeEngine.getPartitionService();\n         for (; ; ) {\n-            final PartitionIdSet expected = ownedPartitions.get();\n-            final Collection<Integer> partitions = partitionService.getMemberPartitions(nodeEngine.getThisAddress());\n-            final PartitionIdSet newSet = immutablePartitionIdSet(partitionService.getPartitionCount(), partitions);\n+            PartitionIdSet expected = ownedPartitions.get();\n+            Collection<Integer> partitions = partitionService.getMemberPartitions(nodeEngine.getThisAddress());\n+            PartitionIdSet newSet = immutablePartitionIdSet(partitionService.getPartitionCount(), partitions);\n             if (ownedPartitions.compareAndSet(expected, newSet)) {\n                 return;\n             }\n         }\n     }\n \n+    @Override\n+    public void nullifyOwnedPartitions() {\n+        ownedPartitions.set(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzM3NTIw", "url": "https://github.com/hazelcast/hazelcast/pull/17155#pullrequestreview-476737520", "createdAt": "2020-08-27T13:47:32Z", "commit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9390cbe1ebb51b00ed6d4d442c39ba409482b4d7", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/9390cbe1ebb51b00ed6d4d442c39ba409482b4d7", "committedDate": "2020-08-27T14:39:41Z", "message": "Nullify owned partitions instead of reloading"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "787057f06b2e6745d50d39566df35840010d2aa4", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/787057f06b2e6745d50d39566df35840010d2aa4", "committedDate": "2020-08-17T09:00:07Z", "message": "Nullify owned partitions instead of reloading"}, "afterCommit": {"oid": "9390cbe1ebb51b00ed6d4d442c39ba409482b4d7", "author": {"user": {"login": "ahmetmircik", "name": "Ahmet Mircik"}}, "url": "https://github.com/hazelcast/hazelcast/commit/9390cbe1ebb51b00ed6d4d442c39ba409482b4d7", "committedDate": "2020-08-27T14:39:41Z", "message": "Nullify owned partitions instead of reloading"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3516, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}