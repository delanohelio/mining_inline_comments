{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NTY3MDc4", "number": 17550, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNzo0MzowNlrOEj7evw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNzo0NDoyMVrOEj7goA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTEwMTQzOnYy", "diffSide": "RIGHT", "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNzo0MzowNlrOHSkPdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTozNTo1NlrOHSoniw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTIzMDE5Ng==", "bodyText": "What is the motivation for returning null? It is inconsistent with the behavior of the iterator() method. and makes the code prone to NPE. The previous behavior does not have this problem.", "url": "https://github.com/hazelcast/hazelcast/pull/17550#discussion_r489230196", "createdAt": "2020-09-16T07:43:06Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "diffHunk": "@@ -41,33 +41,24 @@\n  * }\n  * </pre>\n  *\n- * <p>\n  * <h4>Usage for update count</h4>\n  *\n  * <pre>\n  *     long updated = hazelcastInstance.getSql().execute(\"UPDATE ...\").updateCount();\n  * </pre>\n  *\n  * You don't need to call {@link #close()} in this case.\n+ *\n+ * <h4>Determining the type of the result</h4>\n+ *\n+ * To determine whether the result contains rows or an update count, call\n+ * {@link #updateCount()}. If it returns -1, the result is rows, otherwise\n+ * it's update count.\n  */\n public interface SqlResult extends Iterable<SqlRow>, AutoCloseable {\n \n     /**\n-     * If this result represents a row set, this method returns {@code false}.\n-     * If this result represents an update count (such as for a DML query), it\n-     * returns {@code true}.\n-     *\n-     * @return {@code false} for a rows result and {@code true} for an update\n-     *     count result\n-     */\n-    boolean isUpdateCount();\n-\n-    /**\n-     * Gets row metadata.\n-     *\n-     * @throws IllegalStateException if this result doesn't have rows (i.e.\n-     *     when {@link #isUpdateCount()} returns {@code true})\n-     * @return row metadata\n+     * Gets the row metadata or {@code null} if this result is an update count.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71b8446a9ddcebbbaca6f6060eacc7bbf72882af"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwMTg5OQ==", "bodyText": "It's stale Javadoc, I first returned null but changed it for the same reason. Fixed.", "url": "https://github.com/hazelcast/hazelcast/pull/17550#discussion_r489301899", "createdAt": "2020-09-16T09:35:56Z", "author": {"login": "viliam-durina"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "diffHunk": "@@ -41,33 +41,24 @@\n  * }\n  * </pre>\n  *\n- * <p>\n  * <h4>Usage for update count</h4>\n  *\n  * <pre>\n  *     long updated = hazelcastInstance.getSql().execute(\"UPDATE ...\").updateCount();\n  * </pre>\n  *\n  * You don't need to call {@link #close()} in this case.\n+ *\n+ * <h4>Determining the type of the result</h4>\n+ *\n+ * To determine whether the result contains rows or an update count, call\n+ * {@link #updateCount()}. If it returns -1, the result is rows, otherwise\n+ * it's update count.\n  */\n public interface SqlResult extends Iterable<SqlRow>, AutoCloseable {\n \n     /**\n-     * If this result represents a row set, this method returns {@code false}.\n-     * If this result represents an update count (such as for a DML query), it\n-     * returns {@code true}.\n-     *\n-     * @return {@code false} for a rows result and {@code true} for an update\n-     *     count result\n-     */\n-    boolean isUpdateCount();\n-\n-    /**\n-     * Gets row metadata.\n-     *\n-     * @throws IllegalStateException if this result doesn't have rows (i.e.\n-     *     when {@link #isUpdateCount()} returns {@code true})\n-     * @return row metadata\n+     * Gets the row metadata or {@code null} if this result is an update count.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTIzMDE5Ng=="}, "originalCommit": {"oid": "71b8446a9ddcebbbaca6f6060eacc7bbf72882af"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTEwNjI0OnYy", "diffSide": "LEFT", "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNzo0NDoyMVrOHSkSZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0MjozOVrOHSo4Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTIzMDk0OQ==", "bodyText": "I think that instead of asking the user to do updateCount() == -1 to check for the result type, we should leave this method in the inversed form. This is more convenient and easier to use, and makes no harm to the API:\nboolean isResultSet() {\n    return updateCount() == -1;\n}", "url": "https://github.com/hazelcast/hazelcast/pull/17550#discussion_r489230949", "createdAt": "2020-09-16T07:44:21Z", "author": {"login": "devozerov"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "diffHunk": "@@ -41,33 +41,24 @@\n  * }\n  * </pre>\n  *\n- * <p>\n  * <h4>Usage for update count</h4>\n  *\n  * <pre>\n  *     long updated = hazelcastInstance.getSql().execute(\"UPDATE ...\").updateCount();\n  * </pre>\n  *\n  * You don't need to call {@link #close()} in this case.\n+ *\n+ * <h4>Determining the type of the result</h4>\n+ *\n+ * To determine whether the result contains rows or an update count, call\n+ * {@link #updateCount()}. If it returns -1, the result is rows, otherwise\n+ * it's update count.\n  */\n public interface SqlResult extends Iterable<SqlRow>, AutoCloseable {\n \n     /**\n-     * If this result represents a row set, this method returns {@code false}.\n-     * If this result represents an update count (such as for a DML query), it\n-     * returns {@code true}.\n-     *\n-     * @return {@code false} for a rows result and {@code true} for an update\n-     *     count result\n-     */\n-    boolean isUpdateCount();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71b8446a9ddcebbbaca6f6060eacc7bbf72882af"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjExOQ==", "bodyText": "Agree, fixed.", "url": "https://github.com/hazelcast/hazelcast/pull/17550#discussion_r489306119", "createdAt": "2020-09-16T09:42:39Z", "author": {"login": "viliam-durina"}, "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlResult.java", "diffHunk": "@@ -41,33 +41,24 @@\n  * }\n  * </pre>\n  *\n- * <p>\n  * <h4>Usage for update count</h4>\n  *\n  * <pre>\n  *     long updated = hazelcastInstance.getSql().execute(\"UPDATE ...\").updateCount();\n  * </pre>\n  *\n  * You don't need to call {@link #close()} in this case.\n+ *\n+ * <h4>Determining the type of the result</h4>\n+ *\n+ * To determine whether the result contains rows or an update count, call\n+ * {@link #updateCount()}. If it returns -1, the result is rows, otherwise\n+ * it's update count.\n  */\n public interface SqlResult extends Iterable<SqlRow>, AutoCloseable {\n \n     /**\n-     * If this result represents a row set, this method returns {@code false}.\n-     * If this result represents an update count (such as for a DML query), it\n-     * returns {@code true}.\n-     *\n-     * @return {@code false} for a rows result and {@code true} for an update\n-     *     count result\n-     */\n-    boolean isUpdateCount();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTIzMDk0OQ=="}, "originalCommit": {"oid": "71b8446a9ddcebbbaca6f6060eacc7bbf72882af"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 230, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}