{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMDQxMzA2", "number": 16627, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNTowMTozMVrODefHXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNTowMTozMVrODefHXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMjkzNjYyOnYy", "diffSide": "RIGHT", "path": "hazelcast/src/main/java/com/hazelcast/internal/partition/operation/FetchPartitionStateOperation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNTowMTozMVrOFnpTxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwNzoyNjoyNFrOFn_NCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzExNTU5MQ==", "bodyText": "should we still throw IllegalStateException if the caller is different than clusterService.getMasterAddress() here?", "url": "https://github.com/hazelcast/hazelcast/pull/16627#discussion_r377115591", "createdAt": "2020-02-10T15:01:31Z", "author": {"login": "metanet"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/partition/operation/FetchPartitionStateOperation.java", "diffHunk": "@@ -42,12 +42,11 @@ public FetchPartitionStateOperation() {\n     @Override\n     public void run() {\n         Address caller = getCallerAddress();\n-        NodeEngine nodeEngine = getNodeEngine();\n-        Address master = nodeEngine.getMasterAddress();\n-        if (!caller.equals(master)) {\n-            String msg = caller + \" requested our partition table but it's not our known master. \" + \"Master: \" + master;\n+        InternalPartitionServiceImpl service = getService();\n+        if (!service.isMemberMaster(caller)) {\n+            String msg = caller + \" requested our partition table but it's not our known master.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de8e7ef29522a87b144c6f0f0e3ec636f72ab4ae"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQ3NDMxNA==", "bodyText": "yes, \ud83d\udc4d It seems we already have tests for both cases.", "url": "https://github.com/hazelcast/hazelcast/pull/16627#discussion_r377474314", "createdAt": "2020-02-11T07:26:24Z", "author": {"login": "mdogan"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/partition/operation/FetchPartitionStateOperation.java", "diffHunk": "@@ -42,12 +42,11 @@ public FetchPartitionStateOperation() {\n     @Override\n     public void run() {\n         Address caller = getCallerAddress();\n-        NodeEngine nodeEngine = getNodeEngine();\n-        Address master = nodeEngine.getMasterAddress();\n-        if (!caller.equals(master)) {\n-            String msg = caller + \" requested our partition table but it's not our known master. \" + \"Master: \" + master;\n+        InternalPartitionServiceImpl service = getService();\n+        if (!service.isMemberMaster(caller)) {\n+            String msg = caller + \" requested our partition table but it's not our known master.\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzExNTU5MQ=="}, "originalCommit": {"oid": "de8e7ef29522a87b144c6f0f0e3ec636f72ab4ae"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 817, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}