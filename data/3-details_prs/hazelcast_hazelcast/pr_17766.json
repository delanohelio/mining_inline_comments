{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMjkzMjMx", "number": 17766, "title": "Downgrade surefire plugin to resolve OOM issues in 3.0.0-M4", "bodyText": "This PR downgrades the Surefire plugin version and workarounds the parallelTest profile problem (on older Surefire plugin).\nAfter the Surefire plugin upgrade in #17728 we experienced OOM errors on several Jenkins jobs which seems to be related.\nThe tests are not properly filtered when generating test result files. Many result files contain results from methods belonging to another test class.\nFor instance the result files TEST-*.xml in hazelcast/target/surefire-reports of investigated failed job have in summary 9.7GB:\nhttp://jenkins.hazelcast.com/view/Official%20Builds/job/Hazelcast-4.master-OracleJDK8/115/console", "createdAt": "2020-10-26T20:37:44Z", "url": "https://github.com/hazelcast/hazelcast/pull/17766", "merged": true, "mergeCommit": {"oid": "7b514c7437e075e05559584e0a31941a5d9a67bf"}, "closed": true, "closedAt": "2020-10-27T16:48:02Z", "author": {"login": "kwart"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWnRiEgFqTUxNzU5NjIzMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWo7UlAFqTUxNzY5NzA4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NTk2MjMy", "url": "https://github.com/hazelcast/hazelcast/pull/17766#pullrequestreview-517596232", "createdAt": "2020-10-27T11:23:57Z", "commit": {"oid": "1892b828f5238a653d0ec3b2a63338d62d86135c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMToyMzo1N1rOHo3RAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMToyMzo1N1rOHo3RAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYxMDU2Mg==", "bodyText": "This looks a bit different than the profile we have in the EE repo's module. I think we need to consolidate the two, such as we need to make sure the tests in the OS module don't \"phone home\". The EE module also allows running the QuickTests. Not sure that's needed, we have only ModulePathTests in that module.", "url": "https://github.com/hazelcast/hazelcast/pull/17766#discussion_r512610562", "createdAt": "2020-10-27T11:23:57Z", "author": {"login": "blazember"}, "path": "modulepath-tests/pom.xml", "diffHunk": "@@ -118,4 +118,25 @@\n             <scope>test</scope>\n         </dependency>\n     </dependencies>\n+\n+    <profiles>\n+        <profile>\n+            <id>parallelTest</id>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-surefire-plugin</artifactId>\n+                        <version>${maven.surefire.plugin.version}</version>\n+                        <executions>\n+                            <execution>\n+                                <id>default-test</id>\n+                                <phase>none</phase>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n+    </profiles>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1892b828f5238a653d0ec3b2a63338d62d86135c"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjI5NDA3", "url": "https://github.com/hazelcast/hazelcast/pull/17766#pullrequestreview-517629407", "createdAt": "2020-10-27T12:04:46Z", "commit": {"oid": "1892b828f5238a653d0ec3b2a63338d62d86135c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d51459ffbe09c69272471794155c486649c55f93", "author": {"user": {"login": "kwart", "name": "Josef Cacek"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d51459ffbe09c69272471794155c486649c55f93", "committedDate": "2020-10-27T12:58:39Z", "message": "Downgrade surefire plugin to resolve OOM issues in 3.0.0-M4"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1892b828f5238a653d0ec3b2a63338d62d86135c", "author": {"user": {"login": "kwart", "name": "Josef Cacek"}}, "url": "https://github.com/hazelcast/hazelcast/commit/1892b828f5238a653d0ec3b2a63338d62d86135c", "committedDate": "2020-10-26T20:28:49Z", "message": "Downgrade surefire plugin to resolve OOM issues in 3.0.0-M4"}, "afterCommit": {"oid": "d51459ffbe09c69272471794155c486649c55f93", "author": {"user": {"login": "kwart", "name": "Josef Cacek"}}, "url": "https://github.com/hazelcast/hazelcast/commit/d51459ffbe09c69272471794155c486649c55f93", "committedDate": "2020-10-27T12:58:39Z", "message": "Downgrade surefire plugin to resolve OOM issues in 3.0.0-M4"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3Njc5MzAx", "url": "https://github.com/hazelcast/hazelcast/pull/17766#pullrequestreview-517679301", "createdAt": "2020-10-27T13:06:17Z", "commit": {"oid": "d51459ffbe09c69272471794155c486649c55f93"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMzowNjoxN1rOHo7LVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMzowNjoxN1rOHo7LVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY3NDY0NQ==", "bodyText": "Shouldn't we remove only the module args from here? I would also retain the comments.", "url": "https://github.com/hazelcast/hazelcast/pull/17766#discussion_r512674645", "createdAt": "2020-10-27T13:06:17Z", "author": {"login": "blazember"}, "path": "modulepath-tests/pom.xml", "diffHunk": "@@ -50,39 +61,6 @@\n                     <release>9</release>\n                 </configuration>\n             </plugin>\n-            <plugin>\n-                <groupId>org.apache.maven.plugins</groupId>\n-                <artifactId>maven-surefire-plugin</artifactId>\n-                <configuration combine.self=\"override\">\n-                    <!--\n-                    Allow access to Operating system metrics:\n-                        open jdk.management/com.sun.management.internal\n-\n-                    Avoid warnings caused by reflection in\n-                    SelectorOptimizer:\n-                        open java.base/sun.nio.ch\n-                    FilteringClassLoader:\n-                        open java.base/java.lang\n-                    TimedMemberStateFactoryHelper:\n-                        open java.management/sun.management\n-\n-                    Powermock issue workaround (https://github.com/powermock/powermock/issues/905):\n-                        export java.xml/jdk.xml.internal\n-                     -->\n-                    <argLine>\n-                        ${vmHeapSettings}\n-                        --add-opens jdk.management/com.sun.management.internal=com.hazelcast.core\n-                        --add-opens java.base/sun.nio.ch=com.hazelcast.core\n-                        --add-opens java.base/java.lang=com.hazelcast.core\n-                        --add-opens java.management/sun.management=com.hazelcast.core\n-                        --add-exports java.xml/jdk.xml.internal=com.hazelcast.core\n-                        --illegal-access=warn\n-                        -Dhazelcast.phone.home.enabled=false\n-                        -Dlog4j.skipJansi=true\n-                        ${extraVmArgs}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d51459ffbe09c69272471794155c486649c55f93"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3Njk3MDg5", "url": "https://github.com/hazelcast/hazelcast/pull/17766#pullrequestreview-517697089", "createdAt": "2020-10-27T13:24:35Z", "commit": {"oid": "d51459ffbe09c69272471794155c486649c55f93"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3099, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}