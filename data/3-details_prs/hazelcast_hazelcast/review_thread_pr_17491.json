{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4ODI0MDcy", "number": 17491, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoyNzo1NVrOEgXPsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoyNzo1NVrOEgXPsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzcwNzM3OnYy", "diffSide": "RIGHT", "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMjoyNzo1NVrOHNLnmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwOTo0NzoxN1rOHN4nSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU4Mzg5Ng==", "bodyText": "Just for the record, as we discussed in private, the default config has to be loaded from the hazelcast.jar always, therefore, Config.class.getClassloader() should be the right one here and TCCL should be used only in the other load methods.", "url": "https://github.com/hazelcast/hazelcast/pull/17491#discussion_r483583896", "createdAt": "2020-09-04T12:27:55Z", "author": {"login": "blazember"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "diffHunk": "@@ -146,7 +146,7 @@ protected void loadDefaultConfigurationFromClasspath(String defaultConfigFile) {\n \n     protected boolean loadConfigurationFromClasspath(String configFileName) {\n         try {\n-            URL url = Config.class.getClassLoader().getResource(configFileName);\n+            URL url = Thread.currentThread().getContextClassLoader().getResource(configFileName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2a80de62aa33ac9eb1fe3c0a8bf2c969860b884"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYzNzg5Nw==", "bodyText": "I tested this setup on Quarkus in dev mode and works correctly \ud83d\udc4d", "url": "https://github.com/hazelcast/hazelcast/pull/17491#discussion_r483637897", "createdAt": "2020-09-04T14:06:45Z", "author": {"login": "pivovarit"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "diffHunk": "@@ -146,7 +146,7 @@ protected void loadDefaultConfigurationFromClasspath(String defaultConfigFile) {\n \n     protected boolean loadConfigurationFromClasspath(String configFileName) {\n         try {\n-            URL url = Config.class.getClassLoader().getResource(configFileName);\n+            URL url = Thread.currentThread().getContextClassLoader().getResource(configFileName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU4Mzg5Ng=="}, "originalCommit": {"oid": "c2a80de62aa33ac9eb1fe3c0a8bf2c969860b884"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMxNTk0Mg==", "bodyText": "@pivovarit Could you please update the PR accordingly?", "url": "https://github.com/hazelcast/hazelcast/pull/17491#discussion_r484315942", "createdAt": "2020-09-07T09:38:42Z", "author": {"login": "blazember"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "diffHunk": "@@ -146,7 +146,7 @@ protected void loadDefaultConfigurationFromClasspath(String defaultConfigFile) {\n \n     protected boolean loadConfigurationFromClasspath(String configFileName) {\n         try {\n-            URL url = Config.class.getClassLoader().getResource(configFileName);\n+            URL url = Thread.currentThread().getContextClassLoader().getResource(configFileName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU4Mzg5Ng=="}, "originalCommit": {"oid": "c2a80de62aa33ac9eb1fe3c0a8bf2c969860b884"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMxODQzMQ==", "bodyText": "It's done already. I think that this comment is just hanging on an outdated change. Check the file:\n\n  \n    \n      hazelcast/hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java\n    \n    \n        Lines 131 to 138\n      in\n      c2a80de\n    \n    \n    \n    \n\n        \n          \n           configurationUrl = Config.class.getClassLoader().getResource(defaultConfigFile); \n        \n\n        \n          \n            \n        \n\n        \n          \n           if (configurationUrl == null) { \n        \n\n        \n          \n               throw new HazelcastException(String.format(\"Could not find '%s' in the classpath! This may be due to a \" \n        \n\n        \n          \n                       + \"wrong-packaged or corrupted jar file.\", defaultConfigFile)); \n        \n\n        \n          \n           } \n        \n\n        \n          \n            \n        \n\n        \n          \n           in = Config.class.getClassLoader().getResourceAsStream(defaultConfigFile);", "url": "https://github.com/hazelcast/hazelcast/pull/17491#discussion_r484318431", "createdAt": "2020-09-07T09:42:45Z", "author": {"login": "pivovarit"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "diffHunk": "@@ -146,7 +146,7 @@ protected void loadDefaultConfigurationFromClasspath(String defaultConfigFile) {\n \n     protected boolean loadConfigurationFromClasspath(String configFileName) {\n         try {\n-            URL url = Config.class.getClassLoader().getResource(configFileName);\n+            URL url = Thread.currentThread().getContextClassLoader().getResource(configFileName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU4Mzg5Ng=="}, "originalCommit": {"oid": "c2a80de62aa33ac9eb1fe3c0a8bf2c969860b884"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDMyMTA5OA==", "bodyText": "Ah, I probably commented on the wrong method. This one is loadConfigurationFromClasspath, loadDefaultConfigurationFromClasspath indeed uses Config classloader as exoected.", "url": "https://github.com/hazelcast/hazelcast/pull/17491#discussion_r484321098", "createdAt": "2020-09-07T09:47:17Z", "author": {"login": "blazember"}, "path": "hazelcast/src/main/java/com/hazelcast/internal/config/AbstractConfigLocator.java", "diffHunk": "@@ -146,7 +146,7 @@ protected void loadDefaultConfigurationFromClasspath(String defaultConfigFile) {\n \n     protected boolean loadConfigurationFromClasspath(String configFileName) {\n         try {\n-            URL url = Config.class.getClassLoader().getResource(configFileName);\n+            URL url = Thread.currentThread().getContextClassLoader().getResource(configFileName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU4Mzg5Ng=="}, "originalCommit": {"oid": "c2a80de62aa33ac9eb1fe3c0a8bf2c969860b884"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 198, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}