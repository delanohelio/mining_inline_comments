{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2NjgyMTUz", "number": 291, "title": "Upgrade nmslib to v2.0.8 in JNI library", "bodyText": "Issue #, if available:\n#290\nDescription of changes:\nThis PR upgrades nmslib to v2.0.8 for our JNI library. Placed in WIP state because I would like to test version upgrade and a few other things.\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-12-30T00:28:01Z", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291", "merged": true, "mergeCommit": {"oid": "8537d2012cf98c100c5949856733e73b24d94986"}, "closed": true, "closedAt": "2021-01-06T23:53:14Z", "author": {"login": "jmazanec15"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdrCujLAH2gAyNTQ2NjgyMTUzOjMwMjgyYTY0ZTM5Y2Q5MThjNTc2NjBiN2QxNzQzMmQzY2IwNThhOWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtm5WuAFqTU2MzA2NTI3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "30282a64e39cd918c57660b7d17432d3cb058a9b", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/30282a64e39cd918c57660b7d17432d3cb058a9b", "committedDate": "2020-12-29T22:46:38Z", "message": "Upgrade library naming from 206 to 207"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "932ae00f9de5a913683c35ca300b7f6d36686a67", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/932ae00f9de5a913683c35ca300b7f6d36686a67", "committedDate": "2020-12-29T23:49:09Z", "message": "Update nmslib to 2.0.7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dc106167e8e4ead649dc9c8eb9fd8c7d2ea58a7", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/1dc106167e8e4ead649dc9c8eb9fd8c7d2ea58a7", "committedDate": "2021-01-03T16:59:56Z", "message": "Bump nmslib to v2.0.8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/a3b6ac744ab7ca8595068f96c5b06ad64691d9e4", "committedDate": "2021-01-05T18:15:35Z", "message": "Update tests to use l2 squared (as opposed to l2)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMDc3MzE1", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#pullrequestreview-562077315", "createdAt": "2021-01-05T19:39:46Z", "commit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQxOTozOTo0NlrOIOkraA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQxOTozOTo0NlrOIOkraA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjE1MTkxMg==", "bodyText": "assertEquals(expected, actual, ... )", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#discussion_r552151912", "createdAt": "2021-01-05T19:39:46Z", "author": {"login": "VijayanB"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/index/codec/KNNCodecTestCase.java", "diffHunk": "@@ -153,8 +153,8 @@ public void testMultiFieldsKnnIndex(Codec codec) throws Exception {\n         IndexSearcher searcher = new IndexSearcher(reader);\n         float score = searcher.search(new KNNQuery(\"test_vector\", new float[] {1.0f, 0.0f, 0.0f}, 1, \"dummy\"), 10).scoreDocs[0].score;\n         float score1 = searcher.search(new KNNQuery(\"my_vector\", new float[] {1.0f, 2.0f}, 1, \"dummy\"), 10).scoreDocs[0].score;\n-        assertEquals(score, 0.1667f, 0.01f);\n-        assertEquals(score1, 0.0714f, 0.01f);\n+        assertEquals(score, 1.0f/(1 + 25), 0.01f);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMDgwOTMz", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#pullrequestreview-562080933", "createdAt": "2021-01-05T19:45:25Z", "commit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQxOTo0NToyNVrOIOk2rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQxOTo0NToyNVrOIOk2rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjE1NDc5OA==", "bodyText": "why can't we create a \"latest\" as enum value, so that we don't have to update this line every time. What do you think?", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#discussion_r552154798", "createdAt": "2021-01-05T19:45:25Z", "author": {"login": "VijayanB"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/knn/index/util/NmsLibVersion.java", "diffHunk": "@@ -20,14 +20,14 @@\n     /**\n      * Latest available nmslib version\n      */\n-    V206(\"206\"){\n+    V208(\"208\"){\n         @Override\n         public String indexLibraryVersion() {\n-            return \"KNNIndexV2_0_6\";\n+            return \"KNNIndexV2_0_8\";\n         }\n     };\n \n-    public static final NmsLibVersion LATEST = V206;\n+    public static final NmsLibVersion LATEST = V208;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMTk3MjQ5", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#pullrequestreview-562197249", "createdAt": "2021-01-05T22:56:52Z", "commit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQyMjo1Njo1MlrOIOqlAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQyMjo1Njo1MlrOIOqlAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjI0ODU3Ng==", "bodyText": "Lets keep the versioning in the interface so that it would be easy to support backward compatibility when we find one.  lets add v208 similar to v206", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#discussion_r552248576", "createdAt": "2021-01-05T22:56:52Z", "author": {"login": "vamshin"}, "path": "jni/include/com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex.h", "diffHunk": "@@ -1,50 +1,50 @@\n /* DO NOT EDIT THIS FILE - it is machine generated */\n #include <jni.h>\n-/* Header for class com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex */\n+/* Header for class com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex */\n \n-#ifndef _Included_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n-#define _Included_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+#ifndef _Included_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n+#define _Included_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n #ifdef __cplusplus\n extern \"C\" {\n #endif\n /*\n- * Class:     com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+ * Class:     com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n  * Method:    saveIndex\n  * Signature: ([I[[FLjava/lang/String;[Ljava/lang/String;Ljava/lang/String;)V\n  */\n-JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex_saveIndex\n+JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex_saveIndex\n   (JNIEnv *, jclass, jintArray, jobjectArray, jstring, jobjectArray, jstring);\n \n /*\n- * Class:     com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+ * Class:     com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n  * Method:    queryIndex\n  * Signature: (J[FI)[Lcom/amazon/opendistroforelasticsearch/knn/index/KNNQueryResult;\n  */\n-JNIEXPORT jobjectArray JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex_queryIndex\n+JNIEXPORT jobjectArray JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex_queryIndex\n   (JNIEnv *, jclass, jlong, jfloatArray, jint);\n \n /*\n- * Class:     com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+ * Class:     com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n  * Method:    init\n  * Signature: (Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)J\n  */\n-JNIEXPORT jlong JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex_init\n+JNIEXPORT jlong JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex_init\n   (JNIEnv *, jclass, jstring, jobjectArray, jstring);\n \n /*\n- * Class:     com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+ * Class:     com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n  * Method:    gc\n  * Signature: (J)V\n  */\n-JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex_gc\n+JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex_gc\n   (JNIEnv *, jclass, jlong);\n \n /*\n- * Class:     com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex\n+ * Class:     com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex\n  * Method:    initLibrary\n  * Signature: ()V\n  */\n-JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_v206_KNNIndex_initLibrary\n+JNIEXPORT void JNICALL Java_com_amazon_opendistroforelasticsearch_knn_index_nmslib_KNNIndex_initLibrary", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b6ac744ab7ca8595068f96c5b06ad64691d9e4"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f3eaf53573532a54809350efec729438fb96ea1", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/6f3eaf53573532a54809350efec729438fb96ea1", "committedDate": "2021-01-05T23:41:17Z", "message": "revert naming convention for lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee3f6c38cd59355958fa715c4adc89cbc5564d30", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/ee3f6c38cd59355958fa715c4adc89cbc5564d30", "committedDate": "2021-01-05T23:49:55Z", "message": "fix order in assert in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyMjg5NzA2", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#pullrequestreview-562289706", "createdAt": "2021-01-06T02:47:26Z", "commit": {"oid": "ee3f6c38cd59355958fa715c4adc89cbc5564d30"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMDY1Mjc4", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/291#pullrequestreview-563065278", "createdAt": "2021-01-06T22:02:52Z", "commit": {"oid": "ee3f6c38cd59355958fa715c4adc89cbc5564d30"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1299, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}