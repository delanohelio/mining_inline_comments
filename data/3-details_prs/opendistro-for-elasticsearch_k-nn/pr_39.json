{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMTM4MjY3", "number": 39, "title": "Add IndexWrapper to JNI code to reduce manual memory management and recreation of space on queries", "bodyText": "Note: Supercedes #38\nDescription\nThis change adds IndexWrapper into the JNI layer similar to how nmslib does it in their python bindings. This avoids the need to recreate the space on all queries as well as provides automatic deletion upon deletion of the IndexWrapper.", "createdAt": "2020-02-05T01:18:57Z", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/39", "merged": true, "mergeCommit": {"oid": "e79bbc4ad5e2e93dc17a0c9edd4d8686b7c7f290"}, "closed": true, "closedAt": "2020-02-05T04:38:50Z", "author": {"login": "jschmitz28"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBLrZnAH2gAyMzcxMTM4MjY3OjVlYjhlNzY3YjFlZGE1YTFlMGZkNmYyNzM2OWI0OTk1Nzg1NTk5NDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBOkhRAFqTM1MzQ2MjIwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5eb8e767b1eda5a1e0fd6f27369b499578559942", "author": {"user": null}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/5eb8e767b1eda5a1e0fd6f27369b499578559942", "committedDate": "2020-02-05T01:16:22Z", "message": "Add index wrapper to avoid manual memory management and re-creation of space object on all queries, and simplify error handling logic a bit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffa55746df5774def669ca9121baa789a081034c", "author": {"user": null}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/ffa55746df5774def669ca9121baa789a081034c", "committedDate": "2020-02-05T01:16:27Z", "message": "Add back in exception handling logic that was in place before"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDMwMzE3", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/39#pullrequestreview-353430317", "createdAt": "2020-02-05T02:19:44Z", "commit": {"oid": "ffa55746df5774def669ca9121baa789a081034c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwMjoxOTo0NFrOFlp6mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwMjoxOTo0NFrOFlp6mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTAyODM3Nw==", "bodyText": "+1", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/39#discussion_r375028377", "createdAt": "2020-02-05T02:19:44Z", "author": {"login": "vamshin"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/knn/index/v1736/KNNIndex.java", "diffHunk": "@@ -87,6 +87,12 @@ public long getIndexSize() {\n     public void close() {\n         Lock writeLock = readWriteLock.writeLock();\n         writeLock.lock();\n+\n+        // Autocloseable documentation recommends making close idempotent. We don't expect to doubly close\n+        // but this will help prevent a crash in that situation.\n+        if (this.isClosed) {\n+            return;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffa55746df5774def669ca9121baa789a081034c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDYyMjA2", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/39#pullrequestreview-353462206", "createdAt": "2020-02-05T04:38:34Z", "commit": {"oid": "ffa55746df5774def669ca9121baa789a081034c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1316, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}