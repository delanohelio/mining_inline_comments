{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNTQ3Mjk0", "number": 233, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMjo0OToxM1rOEl3coA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMjo1MzozMVrOEl3gYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4MTQxMjE2OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/plugin/action/RestKNNStatsHandlerIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMjo0OToxM1rOHVlDSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMzoyNDozOFrOHVlv7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjM4OTE5NQ==", "bodyText": "Can we add similar test with multiple shards?", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/233#discussion_r492389195", "createdAt": "2020-09-21T22:49:13Z", "author": {"login": "vamshin"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/plugin/action/RestKNNStatsHandlerIT.java", "diffHunk": "@@ -164,6 +170,62 @@ public void testInvalidNodeIdStats() throws Exception {\n         assertEquals(0, nodeStats.size());\n     }\n \n+    /**\n+     *  Test checks that script stats are properly updated\n+     */\n+    public void testScriptStats() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49c71cd9a94b19e20d167d9a7bd87018a090ca0f"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQwMDYyMg==", "bodyText": "Sure", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/233#discussion_r492400622", "createdAt": "2020-09-21T23:24:38Z", "author": {"login": "jmazanec15"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/plugin/action/RestKNNStatsHandlerIT.java", "diffHunk": "@@ -164,6 +170,62 @@ public void testInvalidNodeIdStats() throws Exception {\n         assertEquals(0, nodeStats.size());\n     }\n \n+    /**\n+     *  Test checks that script stats are properly updated\n+     */\n+    public void testScriptStats() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjM4OTE5NQ=="}, "originalCommit": {"oid": "49c71cd9a94b19e20d167d9a7bd87018a090ca0f"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4MTQyMTc2OnYy", "diffSide": "RIGHT", "path": "README.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMjo1MzozMVrOHVlIzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQyMzowNzoxMFrOHVlaYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjM5MDYwNw==", "bodyText": "I think these errors are counted at shard level. We could update the documentation accordingly. Also you might want to check if all the above metrics at shard level or index level", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/233#discussion_r492390607", "createdAt": "2020-09-21T22:53:31Z", "author": {"login": "vamshin"}, "path": "README.md", "diffHunk": "@@ -352,6 +352,18 @@ The total time in nanoseconds it has taken to load items into cache (cumulative)\n #### indices_in_cache\n For each index that has graphs in the cache, this stat provides the number of graphs that index has and the total graph_memory_usage that index is using in Kilobytes.\n \n+#### script_compilations\n+The number of times the knn script is compiled. This value should only be 0 or 1 most of the time. However, if the cache containing the compiled scripts is filled, it may cause the script to be recompiled.\n+\n+#### script_compilation_errors\n+The number of errors during script compilation.\n+\n+#### script_query_requests\n+The number of query requests that use the k-NN score script.\n+\n+#### script_query_errors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49c71cd9a94b19e20d167d9a7bd87018a090ca0f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjM5NTEwNw==", "bodyText": "Yes, they are at shard level. I updated README", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/233#discussion_r492395107", "createdAt": "2020-09-21T23:07:10Z", "author": {"login": "jmazanec15"}, "path": "README.md", "diffHunk": "@@ -352,6 +352,18 @@ The total time in nanoseconds it has taken to load items into cache (cumulative)\n #### indices_in_cache\n For each index that has graphs in the cache, this stat provides the number of graphs that index has and the total graph_memory_usage that index is using in Kilobytes.\n \n+#### script_compilations\n+The number of times the knn script is compiled. This value should only be 0 or 1 most of the time. However, if the cache containing the compiled scripts is filled, it may cause the script to be recompiled.\n+\n+#### script_compilation_errors\n+The number of errors during script compilation.\n+\n+#### script_query_requests\n+The number of query requests that use the k-NN score script.\n+\n+#### script_query_errors", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjM5MDYwNw=="}, "originalCommit": {"oid": "49c71cd9a94b19e20d167d9a7bd87018a090ca0f"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2667, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}