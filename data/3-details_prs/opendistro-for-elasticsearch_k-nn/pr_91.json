{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyODUzNzAz", "number": 91, "title": "Add gradle functionality to create multi-node cluster", "bodyText": "Issue #, if available:\n#46\nDescription of changes:\nAdded logic in build.gradle to run multi-node cluster locally for testing and integration tests. Verified that ./gradlew integTests -PnumNodes=N for N = 2 and 3 passes. Additionally, verified that a debugger can be attached to each node at the same time.\nAlong with this, I updated documentation.\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-04-13T21:36:32Z", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91", "merged": true, "mergeCommit": {"oid": "8c7ca00a96a3198cee46a263d241fef96f8f640f"}, "closed": true, "closedAt": "2020-04-20T17:52:22Z", "author": {"login": "jmazanec15"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXTJ9ggH2gAyNDAyODUzNzAzOmMxNjczM2EyMzc2ZWFiNGY5YWNiNDJiMzZiMThmOTczZDYyNmEzOGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZiyFaAFqTM5NjY3NTg3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c16733a2376eab4f9acb42b36b18f973d626a38f", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/c16733a2376eab4f9acb42b36b18f973d626a38f", "committedDate": "2020-04-13T18:25:25Z", "message": "WIP - added multi-node to build.gradle - test failing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4d1bf21b92505a677c272adf393cb898fdc80ab", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/b4d1bf21b92505a677c272adf393cb898fdc80ab", "committedDate": "2020-04-13T21:22:00Z", "message": "support multinode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDYzOTI3", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91#pullrequestreview-392463927", "createdAt": "2020-04-13T21:48:57Z", "commit": {"oid": "b4d1bf21b92505a677c272adf393cb898fdc80ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMTo0ODo1N1rOGE2kMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMTo0ODo1N1rOGE2kMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc0MTQ5MA==", "bodyText": "update the comment?", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91#discussion_r407741490", "createdAt": "2020-04-13T21:48:57Z", "author": {"login": "vamshin"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/index/KNNCircuitBreakerIT.java", "diffHunk": "@@ -44,7 +44,7 @@ private void tripCb() throws Exception {\n         // Create Single Shard Index so that all data is hosted on a single node", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d1bf21b92505a677c272adf393cb898fdc80ab"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aac1db2b05686b293947683f0f2eae9a69606af1", "author": {"user": {"login": "jmazanec15", "name": "Jack Mazanec"}}, "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/aac1db2b05686b293947683f0f2eae9a69606af1", "committedDate": "2020-04-13T22:09:03Z", "message": "updated test based on number of nodes in cluster"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTQ1NDYw", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91#pullrequestreview-392545460", "createdAt": "2020-04-14T01:34:17Z", "commit": {"oid": "aac1db2b05686b293947683f0f2eae9a69606af1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMTozNDoxN1rOGE6-wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMTozNDoxN1rOGE6-wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgxMzgyNg==", "bodyText": "+1.\nAre there any other tests with replicas that need to be taken care of?", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91#discussion_r407813826", "createdAt": "2020-04-14T01:34:17Z", "author": {"login": "vamshin"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/knn/index/KNNCircuitBreakerIT.java", "diffHunk": "@@ -41,10 +41,11 @@ private void tripCb() throws Exception {\n         // Set circuit breaker limit to 1 KB\n         updateClusterSettings(\"knn.memory.circuit_breaker.limit\", \"1kb\");\n \n-        // Create Single Shard Index so that all data is hosted on a single node\n+        // Create index with 1 primary and numNodes-1 replicas so that the data will be on every node in the cluster\n+        int numNodes = Integer.parseInt(System.getProperty(\"cluster.number_of_nodes\"));\n         Settings settings = Settings.builder()\n                 .put(\"number_of_shards\", 1)\n-                .put(\"number_of_replicas\", 2)\n+                .put(\"number_of_replicas\", numNodes - 1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aac1db2b05686b293947683f0f2eae9a69606af1"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2Njc1ODc5", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/91#pullrequestreview-396675879", "createdAt": "2020-04-20T17:45:40Z", "commit": {"oid": "aac1db2b05686b293947683f0f2eae9a69606af1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1348, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}