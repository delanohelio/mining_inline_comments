{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMjIxODUw", "number": 145, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MTo1N1rODkKwhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyOTowN1rODpZTNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MjUxNTkxOnYy", "diffSide": "RIGHT", "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MTo1N1rOFwV5qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwNjoxNzo0NFrOF3PItQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNDc5Mg==", "bodyText": "\u9ed8\u8ba450s\u6709\u70b9\u957f\uff0c\u9002\u5f53\u5e94\u8be5\u8ba9\u51fa\u94fe\u63a5\uff0c30s\u5427\uff0c\u8fd9\u4e2a\u94fe\u63a5kie server\u7684\u8d85\u65f6\u5e94\u5f53\u6ce8\u610f\uff0c\u5fc5\u987b\u662f\u6709\u5173\u8054\u7684\uff0ckie\u7684\u8d85\u65f6\u65f6\u95f4\u5fc5\u987b\u5927\u4e8ewait\u65f6\u95f4\uff0c\u68c0\u67e5\u4e0b\u3002\n\u7b2c\u4e8c\u70b9\uff0c\u5982\u679cwait\u65f6\u95f4\u662f30s\uff0c\u5f88\u53ef\u80fdserver\u94fe\u63a5\u88ab\u6cbe\u6ee1\u4e86\uff0c\u90a3\u4e48\u4e00\u4e2a\u5ba2\u6237\u7aef\u91ca\u653e\u7684\u5b9e\u8df5\u4e5f\u662f30s\uff0c\u8fd9\u6837\u6ca1\u62a2\u5230\u8fde\u63a5\u7684\uff0c\u5728\u4e0b\u4e00\u6b21\u8d77\u7801\u80fd\u62a2\u5230\u3002\u4e3a\u4e86\u4fdd\u8bc1\u53ef\u9760\u6027\uff0c\u8d85\u65f6\u65f6\u95f4\u81f3\u5c11\u5e94\u5f53\u662f\u81f3\u5c11\u662fwait\u7684\u4e24\u500d\uff0c\u592a\u53c8\u4e0d\u5b9c\u8fc7\u9ad8\uff0c\u5efa\u8bae90s", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r386234792", "createdAt": "2020-03-02T07:41:57Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjgzNjAwOQ==", "bodyText": "90s\u6307\u7684\u662f spring\u5ba2\u6237\u7aef\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u8fd8\u662f\uff0ckie server\u7684\u8fde\u63a5\u6c60\u6ee1\u7b49\u5f85\u65f6\u95f4", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r392836009", "createdAt": "2020-03-16T07:52:21Z", "author": {"login": "GuoYL123"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNDc5Mg=="}, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ2Mzk4OQ==", "bodyText": "socketTimeOut \u8bbe\u7f6e50s", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r393463989", "createdAt": "2020-03-17T06:17:44Z", "author": {"login": "GuoYL123"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNDc5Mg=="}, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MjUxOTUxOnYy", "diffSide": "RIGHT", "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MzozNVrOFwV7sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MzozNVrOFwV7sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNTMxNA==", "bodyText": "longPollingWait  \u53ef\u4ee5\u65e0\u9700\u4e00\u884c\u6ce8\u91ca\uff0c\u53ea\u9700\u8981\u6539\u540d\u4e3aPollingWaitTimeInSeconds", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r386235314", "createdAt": "2020-03-02T07:43:35Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NzI1NDQ3OnYy", "diffSide": "RIGHT", "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNjo1NTowNVrOF4iAaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMjoyNDoxM1rOF5GIUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgyMTczOQ==", "bodyText": "Maybe this code can added later, do not put unused code here, and create a task for this. For each version of sch, must notice the versions of suppoted kie.", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394821739", "createdAt": "2020-03-19T06:55:05Z", "author": {"login": "liubao68"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQxMzU4NQ==", "bodyText": "I\u2018ve delete the code , but I save the interface for next pr.", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r395413585", "createdAt": "2020-03-20T02:24:13Z", "author": {"login": "GuoYL123"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgyMTczOQ=="}, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NzMyNjUxOnYy", "diffSide": "RIGHT", "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyODo0NlrOF4itHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMjoxNDo1MVrOF5GBwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzE4MQ==", "bodyText": "\u8fd9\u4e2atrue \u548cfalse\u53c2\u6570\u4e0d\u6613\u8bfb\uff0c\u5c01\u88c5\u4e3a\u4e0d\u540c\u65b9\u6cd5\u540d\u533a\u5206\u5c31\u884c\u4e86", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394833181", "createdAt": "2020-03-19T07:28:46Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -76,10 +78,15 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n     project = project != null && !project.isEmpty() ? project : ConfigConstants.DEFAULT_PROJECT;\n     if (!StringUtils.isEmpty(serviceCombConfigProperties.getServerType())\n         && serviceCombConfigProperties.getServerType().equals(\"kie\")) {\n+      //\u4e0a\u4f20\u672c\u5730\u914d\u7f6e\n       if (!isupdatedConfig.get() && updateToKie(serviceCombConfigProperties)) {\n         isupdatedConfig.compareAndSet(false, true);\n       }\n-      return loadFromKie(serviceCombConfigProperties, project);\n+      if (serviceCombConfigProperties.getEnableLongPolling()) {\n+        return loadFromKie(serviceCombConfigProperties, project, true);\n+      } else {\n+        return loadFromKie(serviceCombConfigProperties, project, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQxMTkwNg==", "bodyText": "\u5c01\u88c5\u4e0d\u540c\u65b9\u6cd5\u53ef\u80fd\u4f1a\u4ea7\u751f\u91cd\u590d\u4ee3\u7801", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r395411906", "createdAt": "2020-03-20T02:14:51Z", "author": {"login": "GuoYL123"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -76,10 +78,15 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n     project = project != null && !project.isEmpty() ? project : ConfigConstants.DEFAULT_PROJECT;\n     if (!StringUtils.isEmpty(serviceCombConfigProperties.getServerType())\n         && serviceCombConfigProperties.getServerType().equals(\"kie\")) {\n+      //\u4e0a\u4f20\u672c\u5730\u914d\u7f6e\n       if (!isupdatedConfig.get() && updateToKie(serviceCombConfigProperties)) {\n         isupdatedConfig.compareAndSet(false, true);\n       }\n-      return loadFromKie(serviceCombConfigProperties, project);\n+      if (serviceCombConfigProperties.getEnableLongPolling()) {\n+        return loadFromKie(serviceCombConfigProperties, project, true);\n+      } else {\n+        return loadFromKie(serviceCombConfigProperties, project, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzE4MQ=="}, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NzMyNzI0OnYy", "diffSide": "RIGHT", "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyOTowN1rOF4itlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMjoyNDoyNlrOF5GIdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzMwMQ==", "bodyText": "\u5220\u6389\u6ce8\u91ca\u4ee3\u7801", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394833301", "createdAt": "2020-03-19T07:29:07Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery\n+//    if (configCenterConfig.isEmpty()) {\n+//      autoDisvoceryKie();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQxMzYyMA==", "bodyText": "done", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r395413620", "createdAt": "2020-03-20T02:24:26Z", "author": {"login": "GuoYL123"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery\n+//    if (configCenterConfig.isEmpty()) {\n+//      autoDisvoceryKie();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzMwMQ=="}, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1988, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}