{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMjIxODUw", "number": 145, "title": "support kie long polling&discovery / remove spring-fox ui", "bodyText": "", "createdAt": "2020-03-02T07:37:34Z", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145", "merged": true, "mergeCommit": {"oid": "1bc1d6c2a49935f285d11fcde17be45b31da2558"}, "closed": true, "closedAt": "2020-03-25T06:33:21Z", "author": {"login": "GuoYL123"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJop7aAH2gAyMzgyMjIxODUwOjM0Y2U3OWY0MWZiMTlkMGIyOTBkODA5OTY1OTQ1YTI4MjQwZTk3MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQo8-8gBqjMxNTc3NjE1NjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/34ce79f41fb19d0b290d809965945a28240e9717", "committedDate": "2020-03-02T07:33:24Z", "message": "support kie long polling / remove spring-fox ui"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2OTk2MDg2", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#pullrequestreview-366996086", "createdAt": "2020-03-02T07:41:57Z", "commit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MTo1N1rOFwV5qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQwNzo0MzozNVrOFwV7sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNDc5Mg==", "bodyText": "\u9ed8\u8ba450s\u6709\u70b9\u957f\uff0c\u9002\u5f53\u5e94\u8be5\u8ba9\u51fa\u94fe\u63a5\uff0c30s\u5427\uff0c\u8fd9\u4e2a\u94fe\u63a5kie server\u7684\u8d85\u65f6\u5e94\u5f53\u6ce8\u610f\uff0c\u5fc5\u987b\u662f\u6709\u5173\u8054\u7684\uff0ckie\u7684\u8d85\u65f6\u65f6\u95f4\u5fc5\u987b\u5927\u4e8ewait\u65f6\u95f4\uff0c\u68c0\u67e5\u4e0b\u3002\n\u7b2c\u4e8c\u70b9\uff0c\u5982\u679cwait\u65f6\u95f4\u662f30s\uff0c\u5f88\u53ef\u80fdserver\u94fe\u63a5\u88ab\u6cbe\u6ee1\u4e86\uff0c\u90a3\u4e48\u4e00\u4e2a\u5ba2\u6237\u7aef\u91ca\u653e\u7684\u5b9e\u8df5\u4e5f\u662f30s\uff0c\u8fd9\u6837\u6ca1\u62a2\u5230\u8fde\u63a5\u7684\uff0c\u5728\u4e0b\u4e00\u6b21\u8d77\u7801\u80fd\u62a2\u5230\u3002\u4e3a\u4e86\u4fdd\u8bc1\u53ef\u9760\u6027\uff0c\u8d85\u65f6\u65f6\u95f4\u81f3\u5c11\u5e94\u5f53\u662f\u81f3\u5c11\u662fwait\u7684\u4e24\u500d\uff0c\u592a\u53c8\u4e0d\u5b9c\u8fc7\u9ad8\uff0c\u5efa\u8bae90s", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r386234792", "createdAt": "2020-03-02T07:41:57Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIzNTMxNA==", "bodyText": "longPollingWait  \u53ef\u4ee5\u65e0\u9700\u4e00\u884c\u6ce8\u91ca\uff0c\u53ea\u9700\u8981\u6539\u540d\u4e3aPollingWaitTimeInSeconds", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r386235314", "createdAt": "2020-03-02T07:43:35Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/ServiceCombConfigProperties.java", "diffHunk": "@@ -131,6 +131,17 @@ public void setServerType(String serverType) {\n \n     private int waitTime = 10 * 1000;\n \n+    //unit s\n+    private int longPollingWait = 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34ce79f41fb19d0b290d809965945a28240e9717"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6365575c2e41d06400612b583bb734822de76e50", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/6365575c2e41d06400612b583bb734822de76e50", "committedDate": "2020-03-12T08:22:26Z", "message": "modify as comment / auto discovery kie"}, "afterCommit": {"oid": "eb016a314d30d64b154b9f90047fc35e962fbabe", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/eb016a314d30d64b154b9f90047fc35e962fbabe", "committedDate": "2020-03-12T08:40:32Z", "message": "modify as comment / auto discovery kie"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2636735bd4e51181d105ceb40ed6f2d21eb5f48b", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/2636735bd4e51181d105ceb40ed6f2d21eb5f48b", "committedDate": "2020-03-12T09:34:56Z", "message": "modify as comment / auto discovery kie"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eb016a314d30d64b154b9f90047fc35e962fbabe", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/eb016a314d30d64b154b9f90047fc35e962fbabe", "committedDate": "2020-03-12T08:40:32Z", "message": "modify as comment / auto discovery kie"}, "afterCommit": {"oid": "2636735bd4e51181d105ceb40ed6f2d21eb5f48b", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/2636735bd4e51181d105ceb40ed6f2d21eb5f48b", "committedDate": "2020-03-12T09:34:56Z", "message": "modify as comment / auto discovery kie"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fcad0420fb75d3410c0101e1c0ce55bcfcbf1c5", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/4fcad0420fb75d3410c0101e1c0ce55bcfcbf1c5", "committedDate": "2020-03-16T03:57:24Z", "message": "disable auto discovery kie"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb05b4fcf22157a3fc08fa4cf8a1d41b5ed086db", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/fb05b4fcf22157a3fc08fa4cf8a1d41b5ed086db", "committedDate": "2020-03-16T03:55:07Z", "message": "disable auto discovery kie"}, "afterCommit": {"oid": "d7ce3eb91aa0d6617a47a688626993d710e757e6", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/d7ce3eb91aa0d6617a47a688626993d710e757e6", "committedDate": "2020-03-16T14:23:11Z", "message": "long polling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d7ce3eb91aa0d6617a47a688626993d710e757e6", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/d7ce3eb91aa0d6617a47a688626993d710e757e6", "committedDate": "2020-03-16T14:23:11Z", "message": "long polling"}, "afterCommit": {"oid": "5d1950fef9c2cfbe33397939cf5807cd7ba13bc5", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/5d1950fef9c2cfbe33397939cf5807cd7ba13bc5", "committedDate": "2020-03-16T14:25:31Z", "message": "long polling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d1950fef9c2cfbe33397939cf5807cd7ba13bc5", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/5d1950fef9c2cfbe33397939cf5807cd7ba13bc5", "committedDate": "2020-03-16T14:25:31Z", "message": "long polling"}, "afterCommit": {"oid": "047b6f4c7956f5f80f7c02e6e2f94d52a6a3290f", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/047b6f4c7956f5f80f7c02e6e2f94d52a6a3290f", "committedDate": "2020-03-17T01:05:02Z", "message": "long polling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "047b6f4c7956f5f80f7c02e6e2f94d52a6a3290f", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/047b6f4c7956f5f80f7c02e6e2f94d52a6a3290f", "committedDate": "2020-03-17T01:05:02Z", "message": "long polling"}, "afterCommit": {"oid": "198d01d27b52635186cced17d8cf0593464d7f8e", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/198d01d27b52635186cced17d8cf0593464d7f8e", "committedDate": "2020-03-17T01:35:32Z", "message": "long polling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57e3f39daaf2beb38472a8f85748648ef4d9f4fa", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/57e3f39daaf2beb38472a8f85748648ef4d9f4fa", "committedDate": "2020-03-17T04:01:58Z", "message": "long polling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "198d01d27b52635186cced17d8cf0593464d7f8e", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/198d01d27b52635186cced17d8cf0593464d7f8e", "committedDate": "2020-03-17T01:35:32Z", "message": "long polling"}, "afterCommit": {"oid": "57e3f39daaf2beb38472a8f85748648ef4d9f4fa", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/57e3f39daaf2beb38472a8f85748648ef4d9f4fa", "committedDate": "2020-03-17T04:01:58Z", "message": "long polling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49", "committedDate": "2020-03-17T06:40:50Z", "message": "enable long polling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDYxMDE1", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#pullrequestreview-377461015", "createdAt": "2020-03-19T06:55:05Z", "commit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNjo1NTowNVrOF4iAaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNjo1NTowNVrOF4iAaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgyMTczOQ==", "bodyText": "Maybe this code can added later, do not put unused code here, and create a task for this. For each version of sch, must notice the versions of suppoted kie.", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394821739", "createdAt": "2020-03-19T06:55:05Z", "author": {"login": "liubao68"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDc0OTky", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#pullrequestreview-377474992", "createdAt": "2020-03-19T07:28:46Z", "commit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyODo0NlrOF4itHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzoyOTowN1rOF4itlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzE4MQ==", "bodyText": "\u8fd9\u4e2atrue \u548cfalse\u53c2\u6570\u4e0d\u6613\u8bfb\uff0c\u5c01\u88c5\u4e3a\u4e0d\u540c\u65b9\u6cd5\u540d\u533a\u5206\u5c31\u884c\u4e86", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394833181", "createdAt": "2020-03-19T07:28:46Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -76,10 +78,15 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n     project = project != null && !project.isEmpty() ? project : ConfigConstants.DEFAULT_PROJECT;\n     if (!StringUtils.isEmpty(serviceCombConfigProperties.getServerType())\n         && serviceCombConfigProperties.getServerType().equals(\"kie\")) {\n+      //\u4e0a\u4f20\u672c\u5730\u914d\u7f6e\n       if (!isupdatedConfig.get() && updateToKie(serviceCombConfigProperties)) {\n         isupdatedConfig.compareAndSet(false, true);\n       }\n-      return loadFromKie(serviceCombConfigProperties, project);\n+      if (serviceCombConfigProperties.getEnableLongPolling()) {\n+        return loadFromKie(serviceCombConfigProperties, project, true);\n+      } else {\n+        return loadFromKie(serviceCombConfigProperties, project, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMzMwMQ==", "bodyText": "\u5220\u6389\u6ce8\u91ca\u4ee3\u7801", "url": "https://github.com/huaweicloud/spring-cloud-huawei/pull/145#discussion_r394833301", "createdAt": "2020-03-19T07:29:07Z", "author": {"login": "tianxiaoliang"}, "path": "spring-cloud-huawei-config/src/main/java/com/huaweicloud/config/client/ServiceCombConfigClient.java", "diffHunk": "@@ -150,10 +157,14 @@ public ServiceCombConfigClient(String urls, HttpTransport httpTransport) {\n    * @throws RemoteOperationException\n    */\n   public Map<String, String> loadFromKie(ServiceCombConfigProperties serviceCombConfigProperties,\n-      String project)\n+      String project, boolean isWatch)\n       throws RemoteOperationException {\n     Response response = null;\n     Map<String, String> result = new HashMap<>();\n+    //todo : wait for kie support discovery\n+//    if (configCenterConfig.isEmpty()) {\n+//      autoDisvoceryKie();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e1ec7c13b965b59f37cb30cbdc79968c0c6aa49"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d21930c20b0a307bc28878f74b02a61d3e8c1bd0", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/d21930c20b0a307bc28878f74b02a61d3e8c1bd0", "committedDate": "2020-03-20T02:23:18Z", "message": "delete useless code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae84d698dede380fdcd21730f2e2cd95c4b4eab6", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/ae84d698dede380fdcd21730f2e2cd95c4b4eab6", "committedDate": "2020-03-24T01:51:27Z", "message": "chang label env to environment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3adc43a3cb68a8b4674b033926fe5a83480f4f7", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/c3adc43a3cb68a8b4674b033926fe5a83480f4f7", "committedDate": "2020-03-23T12:50:56Z", "message": "chang label env to environment"}, "afterCommit": {"oid": "ae84d698dede380fdcd21730f2e2cd95c4b4eab6", "author": {"user": {"login": "GuoYL123", "name": "GuoYL"}}, "url": "https://github.com/huaweicloud/spring-cloud-huawei/commit/ae84d698dede380fdcd21730f2e2cd95c4b4eab6", "committedDate": "2020-03-24T01:51:27Z", "message": "chang label env to environment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1821, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}