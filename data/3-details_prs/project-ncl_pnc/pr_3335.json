{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MzQ1NTA3", "number": 3335, "title": "[NCL-5812] Update equals & hashCode on model entities to work with JPA", "bodyText": "An entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed 1\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code 2\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\nChecklist:\n\n Have you added a note in the CHANGELOG wiki for your change if user-facing?\n Have you added unit tests for your change?", "createdAt": "2020-10-01T15:22:04Z", "url": "https://github.com/project-ncl/pnc/pull/3335", "merged": true, "mergeCommit": {"oid": "a91a8abcb6ec6fcb697f21cf0e59104536a0192f"}, "closed": true, "closedAt": "2020-10-12T12:39:14Z", "author": {"login": "janinko"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPhHYrABqjM4Mzk2Nzc3NjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRw0BogBqjM4NjU3ODE3MDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d2f118deaa4e45872a90254e3d52301f94a2fae", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/8d2f118deaa4e45872a90254e3d52301f94a2fae", "committedDate": "2020-10-01T15:04:09Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}, "afterCommit": {"oid": "be886d4a46e4c9897bac6b611035b08793a27cce", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/be886d4a46e4c9897bac6b611035b08793a27cce", "committedDate": "2020-10-05T10:20:51Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0217d20ebbc46d2dd0e669f7af873244b5fa2eac", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/0217d20ebbc46d2dd0e669f7af873244b5fa2eac", "committedDate": "2020-10-05T11:18:58Z", "message": "twst"}, "afterCommit": {"oid": "ba888f7bdeae46ce91fee9daff752a23b8e514ca", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/ba888f7bdeae46ce91fee9daff752a23b8e514ca", "committedDate": "2020-10-05T11:48:36Z", "message": "twst"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba888f7bdeae46ce91fee9daff752a23b8e514ca", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/ba888f7bdeae46ce91fee9daff752a23b8e514ca", "committedDate": "2020-10-05T11:48:36Z", "message": "twst"}, "afterCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/4dc36ad9c111b04b34737d98a4a1c604579788cf", "committedDate": "2020-10-05T12:54:32Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjI5NDA0", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502229404", "createdAt": "2020-10-05T16:33:17Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozMzoxN1rOHck8tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozMzoxN1rOHck8tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcyNzU0MQ==", "bodyText": "Isn't it idRev != null && idRev.equals(((ArtifactAudited) o).getIdRev()); ?", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499727541", "createdAt": "2020-10-05T16:33:17Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/ArtifactAudited.java", "diffHunk": "@@ -130,17 +131,14 @@ public String toString() {\n     public boolean equals(Object o) {\n         if (this == o)\n             return true;\n-        if (o == null || getClass() != o.getClass())\n+        if (!(o instanceof ArtifactAudited))\n             return false;\n-\n-        ArtifactAudited that = (ArtifactAudited) o;\n-\n-        return (idRev != null ? idRev.equals(that.getIdRev()) : false);\n+        return idRev != null && idRev.equals(((ArtifactAudited) o).getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjMwNzQz", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502230743", "createdAt": "2020-10-05T16:35:02Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNTowM1rOHclA1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNTowM1rOHclA1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcyODU5OQ==", "bodyText": "idRev != null && idRev.equals(((BuildConfigurationAudited) o).getIdRev());", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499728599", "createdAt": "2020-10-05T16:35:03Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/BuildConfigurationAudited.java", "diffHunk": "@@ -224,17 +225,14 @@ public String toString() {\n     public boolean equals(Object o) {\n         if (this == o)\n             return true;\n-        if (o == null || getClass() != o.getClass())\n+        if (!(o instanceof ArtifactAudited))\n             return false;\n-\n-        BuildConfigurationAudited that = (BuildConfigurationAudited) o;\n-\n-        return (idRev != null ? idRev.equals(that.getIdRev()) : false);\n+        return idRev != null && idRev.equals(((ArtifactAudited) o).getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjMwOTk2", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502230996", "createdAt": "2020-10-05T16:35:21Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNToyMVrOHclBmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNToyMVrOHclBmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcyODc5Mg==", "bodyText": "(!(o instanceof BuildConfigurationAudited))", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499728792", "createdAt": "2020-10-05T16:35:21Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/BuildConfigurationAudited.java", "diffHunk": "@@ -224,17 +225,14 @@ public String toString() {\n     public boolean equals(Object o) {\n         if (this == o)\n             return true;\n-        if (o == null || getClass() != o.getClass())\n+        if (!(o instanceof ArtifactAudited))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjMyMjg3", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502232287", "createdAt": "2020-10-05T16:37:06Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNzowNlrOHclFdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozNzowNlrOHclFdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcyOTc4Mw==", "bodyText": "(!(o instanceof BuildConfigurationSet))", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499729783", "createdAt": "2020-10-05T16:37:06Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/BuildConfigurationSet.java", "diffHunk": "@@ -212,18 +212,16 @@ public void setArchived(boolean archived) {\n     public boolean equals(Object o) {\n         if (this == o)\n             return true;\n-        if (o == null || getClass() != o.getClass())\n+        if (!(o instanceof BuildConfigSetRecord))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjMzMzIy", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502233322", "createdAt": "2020-10-05T16:38:32Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozODozM1rOHclIrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjozODozM1rOHclIrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTczMDYwNQ==", "bodyText": "I would also modify the unique constraint to be the same? systemImageId and systemImageRepositoryUrl", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499730605", "createdAt": "2020-10-05T16:38:33Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/BuildEnvironment.java", "diffHunk": "@@ -19,6 +19,7 @@\n \n import java.util.HashMap;\n import java.util.Map;\n+import java.util.Objects;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjM1MTY5", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502235169", "createdAt": "2020-10-05T16:40:59Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjo0MDo1OVrOHclOIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjo0MDo1OVrOHclOIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTczMjAwMw==", "bodyText": "return id != null && id.equals(((Product) o).getId());", "url": "https://github.com/project-ncl/pnc/pull/3335#discussion_r499732003", "createdAt": "2020-10-05T16:40:59Z", "author": {"login": "vibe13"}, "path": "model/src/main/java/org/jboss/pnc/model/Product.java", "diffHunk": "@@ -208,6 +208,22 @@ public boolean addVersion(ProductVersion version) {\n         return productVersions.add(version);\n     }\n \n+    @Override\n+    public boolean equals(Object o) {\n+        if (this == o)\n+            return true;\n+        if (!(o instanceof Product))\n+            return false;\n+        return id != null && id.equals(((BuildConfigSetRecord) o).getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjM5MTc2", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502239176", "createdAt": "2020-10-05T16:46:19Z", "commit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4dc36ad9c111b04b34737d98a4a1c604579788cf", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/4dc36ad9c111b04b34737d98a4a1c604579788cf", "committedDate": "2020-10-05T12:54:32Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}, "afterCommit": {"oid": "fd10c657da25170b4e8d1db64047f3f663ae6d43", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/fd10c657da25170b4e8d1db64047f3f663ae6d43", "committedDate": "2020-10-05T17:01:31Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyOTMyNzc3", "url": "https://github.com/project-ncl/pnc/pull/3335#pullrequestreview-502932777", "createdAt": "2020-10-06T13:13:36Z", "commit": {"oid": "932d4987498fa8e6afc18947b295735148190244"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "932d4987498fa8e6afc18947b295735148190244", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/932d4987498fa8e6afc18947b295735148190244", "committedDate": "2020-10-06T12:25:06Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}, "afterCommit": {"oid": "b7eaedd85220c00f3b5004b0c9c4579415ed19bb", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/b7eaedd85220c00f3b5004b0c9c4579415ed19bb", "committedDate": "2020-10-06T15:23:53Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7eaedd85220c00f3b5004b0c9c4579415ed19bb", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/b7eaedd85220c00f3b5004b0c9c4579415ed19bb", "committedDate": "2020-10-06T15:23:53Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}, "afterCommit": {"oid": "faa0d5a59586e4751f0e26808005029e3f1a7e19", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/faa0d5a59586e4751f0e26808005029e3f1a7e19", "committedDate": "2020-10-07T10:23:11Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8195faf9b58eb8b5a44802769c52da083ee95d86", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/8195faf9b58eb8b5a44802769c52da083ee95d86", "committedDate": "2020-10-07T11:37:40Z", "message": "[NCL-5812] Update equals & hashCode on model entities to work with JPA\n\nAn entity must be equal to itself across all JPA object states: transient,\nattached, detached, removed [1]\n\nThe entities should use business key (unique, unmodifiable fields) in equals &\nhashCode when possible, in the rest cases they can use primary key for equals\nand constant for hash code [2]\n\nEntities with business key:\nBuildEnvironment\nBuildRecordAttribute\nGenericSetting\nRepositoryConfiguration\nTargetRepository\nUser\n\nSome entities don't have business key but their ID is generated prior\npersistence to DB, so we can use the ID without problems:\nBuildConfiguration\nBuildRecord\nBuildRecordPushResult\nProductMilestoneRelease\n\nAudited classes are only read from DB so their ID is unmodifiable:\nArtifactAudited\nBuildConfigurationAudited\n\nEnitities that don't have business key and their ID is generated when stored to\nDB must have constat for their hash code:\nArtifact\nBuildConfigSetRecord\nBuildConfigurationSet\nProduct\nProductMilestone\nProductRelease\nProductVersion\nProject\n\n[1]: https://vladmihalcea.com/hibernate-facts-equals-and-hashcode/\n[2]: https://vladmihalcea.com/how-to-implement-equals-and-hashcode-using-the-jpa-entity-identifier/"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "faa0d5a59586e4751f0e26808005029e3f1a7e19", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/faa0d5a59586e4751f0e26808005029e3f1a7e19", "committedDate": "2020-10-07T10:23:11Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}, "afterCommit": {"oid": "d3d9efb395def659be7d693662b4f1bd7e9c3e91", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/d3d9efb395def659be7d693662b4f1bd7e9c3e91", "committedDate": "2020-10-07T11:37:40Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e7ddcb6fc4060f297e0cb1a0f6e067004bf9170", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/9e7ddcb6fc4060f297e0cb1a0f6e067004bf9170", "committedDate": "2020-10-12T09:45:49Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d3d9efb395def659be7d693662b4f1bd7e9c3e91", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/d3d9efb395def659be7d693662b4f1bd7e9c3e91", "committedDate": "2020-10-07T11:37:40Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}, "afterCommit": {"oid": "9e7ddcb6fc4060f297e0cb1a0f6e067004bf9170", "author": {"user": {"login": "janinko", "name": "Honza Br\u00e1zdil"}}, "url": "https://github.com/project-ncl/pnc/commit/9e7ddcb6fc4060f297e0cb1a0f6e067004bf9170", "committedDate": "2020-10-12T09:45:49Z", "message": "[NCL-5812] Add unique constraint to Build Environment entity"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2534, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}