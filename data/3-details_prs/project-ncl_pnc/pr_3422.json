{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3MzUzNjkw", "number": 3422, "title": "[NCL-6237] Could set closed milestone as current", "bodyText": "Checklist:\n\n Have you added a note in the CHANGELOG wiki for your change if user-facing?\n Have you added unit tests for your change?", "createdAt": "2020-11-25T10:48:40Z", "url": "https://github.com/project-ncl/pnc/pull/3422", "merged": true, "mergeCommit": {"oid": "0af4ab191b669a502c7476aae9d088fcb683ed5f"}, "closed": true, "closedAt": "2020-12-07T09:05:21Z", "author": {"login": "jomrazek"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf9WsWgFqTUzODQzMjQ3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiiIPZAFqTU0Mzg5NDYzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NDMyNDc3", "url": "https://github.com/project-ncl/pnc/pull/3422#pullrequestreview-538432477", "createdAt": "2020-11-25T12:10:24Z", "commit": {"oid": "f87e3492583c6a00baf6d9af1a5dc17e11209b99"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMjoxMDoyNFrOH5wkuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMjoxNDo1NVrOH5wuKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDMyNjcxNQ==", "bodyText": "use Product milestone mapper method to get id mapper to map the milestone id.", "url": "https://github.com/project-ncl/pnc/pull/3422#discussion_r530326715", "createdAt": "2020-11-25T12:10:24Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/ProductVersionProviderImpl.java", "diffHunk": "@@ -158,6 +164,25 @@ private void validateGroupConfigsBeforeUpdating(String id, ProductVersion restEn\n         }\n     }\n \n+    private void validateMilestone(String id, ProductVersion entity) {\n+        if (entity.getCurrentProductMilestone() != null) {\n+            Integer newMilestoneId = Integer.parseInt(entity.getCurrentProductMilestone().getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87e3492583c6a00baf6d9af1a5dc17e11209b99"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDMyODg0Mw==", "bodyText": "newMilestoneId can't be null, because if entity.getCurrentProductMilestone().getId() is null, then you get NPE.", "url": "https://github.com/project-ncl/pnc/pull/3422#discussion_r530328843", "createdAt": "2020-11-25T12:14:27Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/ProductVersionProviderImpl.java", "diffHunk": "@@ -158,6 +164,25 @@ private void validateGroupConfigsBeforeUpdating(String id, ProductVersion restEn\n         }\n     }\n \n+    private void validateMilestone(String id, ProductVersion entity) {\n+        if (entity.getCurrentProductMilestone() != null) {\n+            Integer newMilestoneId = Integer.parseInt(entity.getCurrentProductMilestone().getId());\n+            if (newMilestoneId != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87e3492583c6a00baf6d9af1a5dc17e11209b99"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDMyOTEzMQ==", "bodyText": "use Product version mapper method to get id mapper to map the product version id.", "url": "https://github.com/project-ncl/pnc/pull/3422#discussion_r530329131", "createdAt": "2020-11-25T12:14:55Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/ProductVersionProviderImpl.java", "diffHunk": "@@ -158,6 +164,25 @@ private void validateGroupConfigsBeforeUpdating(String id, ProductVersion restEn\n         }\n     }\n \n+    private void validateMilestone(String id, ProductVersion entity) {\n+        if (entity.getCurrentProductMilestone() != null) {\n+            Integer newMilestoneId = Integer.parseInt(entity.getCurrentProductMilestone().getId());\n+            if (newMilestoneId != null) {\n+                org.jboss.pnc.model.ProductVersion productVersion = repository.queryById(Integer.parseInt(id));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f87e3492583c6a00baf6d9af1a5dc17e11209b99"}, "originalPosition": 51}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f87e3492583c6a00baf6d9af1a5dc17e11209b99", "author": {"user": {"login": "jomrazek", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/f87e3492583c6a00baf6d9af1a5dc17e11209b99", "committedDate": "2020-11-25T10:47:28Z", "message": "[NCL-6237] Could set closed milestone as current"}, "afterCommit": {"oid": "7a543d98725d7584d572f2593c1c0de0ee90481b", "author": {"user": {"login": "jomrazek", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/7a543d98725d7584d572f2593c1c0de0ee90481b", "committedDate": "2020-11-25T13:47:54Z", "message": "[NCL-6237] Could set closed milestone as current"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MzU5OTM0", "url": "https://github.com/project-ncl/pnc/pull/3422#pullrequestreview-539359934", "createdAt": "2020-11-26T14:27:22Z", "commit": {"oid": "7a543d98725d7584d572f2593c1c0de0ee90481b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNDoyNzoyMlrOH6dnZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNDoyNzoyMlrOH6dnZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2NDY3OQ==", "bodyText": "mapper is not ProductMilestoneMapper, is it?", "url": "https://github.com/project-ncl/pnc/pull/3422#discussion_r531064679", "createdAt": "2020-11-26T14:27:22Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/ProductVersionProviderImpl.java", "diffHunk": "@@ -158,6 +164,23 @@ private void validateGroupConfigsBeforeUpdating(String id, ProductVersion restEn\n         }\n     }\n \n+    private void validateMilestone(String id, ProductVersion entity) {\n+        if (entity.getCurrentProductMilestone() != null) {\n+            Integer newMilestoneId = mapper.getIdMapper().toEntity(entity.getCurrentProductMilestone().getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a543d98725d7584d572f2593c1c0de0ee90481b"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76842e236325aa66af16c95e6a600b329fbe7125", "author": {"user": {"login": "jomrazek", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/76842e236325aa66af16c95e6a600b329fbe7125", "committedDate": "2020-11-26T16:01:17Z", "message": "[NCL-6237] Could set closed milestone as current"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a543d98725d7584d572f2593c1c0de0ee90481b", "author": {"user": {"login": "jomrazek", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/7a543d98725d7584d572f2593c1c0de0ee90481b", "committedDate": "2020-11-25T13:47:54Z", "message": "[NCL-6237] Could set closed milestone as current"}, "afterCommit": {"oid": "76842e236325aa66af16c95e6a600b329fbe7125", "author": {"user": {"login": "jomrazek", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/76842e236325aa66af16c95e6a600b329fbe7125", "committedDate": "2020-11-26T16:01:17Z", "message": "[NCL-6237] Could set closed milestone as current"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODk0NjM1", "url": "https://github.com/project-ncl/pnc/pull/3422#pullrequestreview-543894635", "createdAt": "2020-12-03T12:16:26Z", "commit": {"oid": "76842e236325aa66af16c95e6a600b329fbe7125"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2495, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}