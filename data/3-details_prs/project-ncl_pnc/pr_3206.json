{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3NzU1MDUx", "number": 3206, "title": "[NCL-5885] DONE WS message wrongly sent after final NO_REBUILD_REQUIRED", "bodyText": "Checklist:\n\n Have you added a note in the CHANGELOG wiki for your change if user-facing?\n Have you added unit tests for your change?", "createdAt": "2020-07-28T11:44:05Z", "url": "https://github.com/project-ncl/pnc/pull/3206", "merged": true, "mergeCommit": {"oid": "0a89c7de9326c53ca9f100b9c2cfdcc67f6bc118"}, "closed": true, "closedAt": "2020-07-29T13:52:07Z", "author": {"login": "michalovjan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5VtWDAH2gAyNDU3NzU1MDUxOjhiZTc5MDU3MDA5MDBmZDgzZDZiM2RmMjAwMWNkYjhjMWFmZmFjYTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5rReLAFqTQ1NzUzNTYxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/8be7905700900fd83d6b3df2001cdb8c1affaca6", "committedDate": "2020-07-28T12:37:18Z", "message": "[NCL-5885] fix unexpected WS message with status DONE after NO_REBUILD_REQUIRED"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd0a8bb21dedf2a04ebc4fbc31f01cf9894ae444", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/bd0a8bb21dedf2a04ebc4fbc31f01cf9894ae444", "committedDate": "2020-07-28T11:38:06Z", "message": "[NCL-5885] fix unexpected WS message with status DONE after NO_REBUILD_REQUIRED"}, "afterCommit": {"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/8be7905700900fd83d6b3df2001cdb8c1affaca6", "committedDate": "2020-07-28T12:37:18Z", "message": "[NCL-5885] fix unexpected WS message with status DONE after NO_REBUILD_REQUIRED"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NjEyMzI1", "url": "https://github.com/project-ncl/pnc/pull/3206#pullrequestreview-456612325", "createdAt": "2020-07-28T13:08:52Z", "commit": {"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMzowODo1MlrOG4LtKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMzowODo1MlrOG4LtKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU2NTIyNg==", "bodyText": "Can you merge this with the condition above L543?", "url": "https://github.com/project-ncl/pnc/pull/3206#discussion_r461565226", "createdAt": "2020-07-28T13:08:52Z", "author": {"login": "matejonnet"}, "path": "build-coordinator/src/main/java/org/jboss/pnc/coordinator/builder/DefaultBuildCoordinator.java", "diffHunk": "@@ -561,7 +561,9 @@ private void updateBuildTaskStatus(BuildTask task, BuildCoordinationStatus statu\n \n         userLog.info(\"Build status updated to {}; previous: {}\", status, oldStatus);\n \n-        if (BuildStatus.fromBuildCoordinationStatus(oldStatus) != BuildStatus.fromBuildCoordinationStatus(status)) {\n+        BuildStatus oldBuildStatus = BuildStatus.fromBuildCoordinationStatus(oldStatus);\n+        BuildStatus newBuildStatus = BuildStatus.fromBuildCoordinationStatus(status);\n+        if ((oldBuildStatus != newBuildStatus) && !(oldBuildStatus.isFinal() && newBuildStatus.isFinal())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8be7905700900fd83d6b3df2001cdb8c1affaca6"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afad1601222e28c5425c20f24c41e890266807cf", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/afad1601222e28c5425c20f24c41e890266807cf", "committedDate": "2020-07-29T12:32:52Z", "message": "[NCL-5885] add condition clarifying comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7dac55bcc3fef1c999434003f7e3e884aba4ff0b", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/7dac55bcc3fef1c999434003f7e3e884aba4ff0b", "committedDate": "2020-07-29T12:26:53Z", "message": "[NCL-5885] add condition clarifying comments"}, "afterCommit": {"oid": "afad1601222e28c5425c20f24c41e890266807cf", "author": {"user": {"login": "michalovjan", "name": null}}, "url": "https://github.com/project-ncl/pnc/commit/afad1601222e28c5425c20f24c41e890266807cf", "committedDate": "2020-07-29T12:32:52Z", "message": "[NCL-5885] add condition clarifying comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NTM1NjE5", "url": "https://github.com/project-ncl/pnc/pull/3206#pullrequestreview-457535619", "createdAt": "2020-07-29T13:44:46Z", "commit": {"oid": "afad1601222e28c5425c20f24c41e890266807cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2564, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}