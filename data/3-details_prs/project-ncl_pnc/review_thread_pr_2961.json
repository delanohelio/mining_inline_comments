{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMjA5MDM0", "number": 2961, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxMDozNVrODvh_qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNzozNFrODviJwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMTY2NjMyOnYy", "diffSide": "RIGHT", "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxMDozNVrOGCAfWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjo0MDoyOVrOGCBkVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc1ODM2Mw==", "bodyText": "Here you are changing the creationUser of existing BC. This method creates new BC-audited for existing BC. It's called createRevision because from API point it is creating new entity, but it's actually just updating the BC.", "url": "https://github.com/project-ncl/pnc/pull/2961#discussion_r404758363", "createdAt": "2020-04-07T12:10:35Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "diffHunk": "@@ -219,6 +239,9 @@ public BuildConfigurationRevision createRevision(String id, BuildConfiguration b\n             return buildConfigurationRevisionMapper.toDTO(latestRevision);\n         }\n         bcEntity.setCreationTime(latestRevision.getCreationTime());\n+        org.jboss.pnc.model.User user = userService.currentUser();\n+        bcEntity.setCreationUser(user);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae30a557e2774b8c9635bfaf1823931cdea679db"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc3NjAyMw==", "bodyText": "ah good point, thanks for the clarification, the name tricked me, I am now going to update just the lastModificationUser", "url": "https://github.com/project-ncl/pnc/pull/2961#discussion_r404776023", "createdAt": "2020-04-07T12:40:29Z", "author": {"login": "vibe13"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "diffHunk": "@@ -219,6 +239,9 @@ public BuildConfigurationRevision createRevision(String id, BuildConfiguration b\n             return buildConfigurationRevisionMapper.toDTO(latestRevision);\n         }\n         bcEntity.setCreationTime(latestRevision.getCreationTime());\n+        org.jboss.pnc.model.User user = userService.currentUser();\n+        bcEntity.setCreationUser(user);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc1ODM2Mw=="}, "originalCommit": {"oid": "ae30a557e2774b8c9635bfaf1823931cdea679db"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMTY5MTU5OnYy", "diffSide": "RIGHT", "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNzoyM1rOGCAuhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjo0NzoyMVrOGCB1ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc2MjI0NQ==", "bodyText": "Dependencies are not audited. Should we update the user even when no audited data got changed?", "url": "https://github.com/project-ncl/pnc/pull/2961#discussion_r404762245", "createdAt": "2020-04-07T12:17:23Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "diffHunk": "@@ -308,6 +335,7 @@ public void addDependency(String configId, String dependencyId) {\n \n         logger.debug(\"Didn't throw any validation errors\");\n         buildConfig.addDependency(dependency);\n+        buildConfig.setLastModificationUser(user);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae30a557e2774b8c9635bfaf1823931cdea679db"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc4MDM4OA==", "bodyText": "I would have done that by default, if anything got changed in the BuildConfiguration, I would have updated the lastModificationUser, even if the changes were not audited. But that would indeed cause some confusion now, as users would see a lastModificationUser changed but possibly no corresponding revision in the list...so yep, better not updating it at the moment. Thanks!", "url": "https://github.com/project-ncl/pnc/pull/2961#discussion_r404780388", "createdAt": "2020-04-07T12:47:21Z", "author": {"login": "vibe13"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "diffHunk": "@@ -308,6 +335,7 @@ public void addDependency(String configId, String dependencyId) {\n \n         logger.debug(\"Didn't throw any validation errors\");\n         buildConfig.addDependency(dependency);\n+        buildConfig.setLastModificationUser(user);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc2MjI0NQ=="}, "originalCommit": {"oid": "ae30a557e2774b8c9635bfaf1823931cdea679db"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMTY5MjE3OnYy", "diffSide": "RIGHT", "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNzozNFrOGCAu3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNzozNFrOGCAu3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc2MjMzNQ==", "bodyText": "^", "url": "https://github.com/project-ncl/pnc/pull/2961#discussion_r404762335", "createdAt": "2020-04-07T12:17:34Z", "author": {"login": "janinko"}, "path": "facade/src/main/java/org/jboss/pnc/facade/providers/BuildConfigurationProviderImpl.java", "diffHunk": "@@ -316,12 +344,14 @@ public void removeDependency(String configId, String dependencyId) {\n \n         org.jboss.pnc.model.BuildConfiguration buildConfig = repository.queryById(Integer.valueOf(configId));\n         org.jboss.pnc.model.BuildConfiguration dependency = repository.queryById(Integer.valueOf(dependencyId));\n+        org.jboss.pnc.model.User user = userService.currentUser();\n \n         ValidationBuilder.validateObject(buildConfig, WhenUpdating.class)\n                 .validateCondition(buildConfig != null, \"No build config exists with id: \" + configId)\n                 .validateCondition(dependency != null, \"No dependency build config exists with id: \" + dependencyId);\n \n         buildConfig.removeDependency(dependency);\n+        buildConfig.setLastModificationUser(user);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae30a557e2774b8c9635bfaf1823931cdea679db"}, "originalPosition": 108}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1841, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}