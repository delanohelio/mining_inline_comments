{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzEwNDc3", "number": 7975, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyMzozOFrODlWI6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDo1MVrODlZLsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNDg2NjMzOnYy", "diffSide": "RIGHT", "path": "assignment/tool/pom.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyMzozOFrOFyL5Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNToxNFrOFyL8vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2Nzk3OQ==", "bodyText": "Please, remove this. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388167979", "createdAt": "2020-03-05T09:23:38Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/pom.xml", "diffHunk": "@@ -36,10 +36,10 @@\n             <groupId>${project.groupId}</groupId>\n             <artifactId>sakai-assignment-api</artifactId>\n         </dependency>\n-        <dependency>\n+        <!--dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2ODg5Mw==", "bodyText": "will do!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388168893", "createdAt": "2020-03-05T09:25:14Z", "author": {"login": "adrianfish"}, "path": "assignment/tool/pom.xml", "diffHunk": "@@ -36,10 +36,10 @@\n             <groupId>${project.groupId}</groupId>\n             <artifactId>sakai-assignment-api</artifactId>\n         </dependency>\n-        <dependency>\n+        <!--dependency>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2Nzk3OQ=="}, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNDg3OTg5OnYy", "diffSide": "RIGHT", "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoxM1rOFyMBPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyODo0MFrOFyMETw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDA0Nw==", "bodyText": "Spacing...", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170047", "createdAt": "2020-03-05T09:27:13Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDgzMQ==", "bodyText": "good spot, forgot that.", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170831", "createdAt": "2020-03-05T09:28:40Z", "author": {"login": "adrianfish"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDA0Nw=="}, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNDg4MDczOnYy", "diffSide": "RIGHT", "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoyOVrOFyMBzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoyOVrOFyMBzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDE5MA==", "bodyText": "Please, remove this. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170190", "createdAt": "2020-03-05T09:27:29Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){\n+                /*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNTM2MzgxOnYy", "diffSide": "RIGHT", "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDoyOFrOFyQm7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDoyOFrOFyQm7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTIzMQ==", "bodyText": "Please @adrianfish, could you remove 429, 431 and 438?. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245231", "createdAt": "2020-03-05T11:50:28Z", "author": {"login": "jesusmmp"}, "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -386,43 +420,51 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n       height: height,\n       startupFocus: true,\n     });\n-    editor.on(\"change\", () => this.modified = true);\n+    editor.on(\"change\", () => this.modified = true );\n     return editor;\n   }\n \n   toggleInlineFeedback(e, cancelling) {\n \n-    if (!this.inlineFeedbackMode) {\n-      this.inlineFeedbackMode = true;\n+    //if (!this.inlineFeedbackMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "originalPosition": 369}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNTM2NDk3OnYy", "diffSide": "RIGHT", "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDo1MVrOFyQnnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDo1MVrOFyQnnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTQwNQ==", "bodyText": "Please, remove this one too. Thanks", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245405", "createdAt": "2020-03-05T11:50:51Z", "author": {"login": "jesusmmp"}, "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -170,6 +191,9 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n   renderSaved() {\n     return html`<span class=\"saved fa fa-check-circle\" title=\"${this.i18n[\"saved_successfully\"]}\" style=\"display: ${this.saved ? \"inline\" : \"none\"};\"></span>`;\n   }\n+            //<a href=\"javascript:;\" id=\"grader-rubric-link\" @click=${this.toggleRubric} title=\"${this.assignmentsI18n[\"grading_rubric\"]}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "originalPosition": 146}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2391, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}