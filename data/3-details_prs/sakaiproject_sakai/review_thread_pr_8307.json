{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3ODM4NTYy", "number": 8307, "reviewThreads": {"totalCount": 70, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDoyMDoyNVrOEHg1Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDo0OFrOEJm6gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzEzNDAyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDoyMDoyNVrOGm6pLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDoyMDoyNVrOGm6pLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ1OTg4NQ==", "bodyText": "Looks like there's a label missing for this input. That makes it hard for people using screen readers or voice control to use the input.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443459885", "createdAt": "2020-06-22T10:20:25Z", "author": {"login": "accesslint"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6e02f5cfe515e25a0bc967c4e4ded6ca501ce7b"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE4ODQ2OnYy", "diffSide": "RIGHT", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Criterion.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzoxNlrOGm7K-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzoxNlrOGm7K-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODUzOA==", "bodyText": "Wrong indentation", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468538", "createdAt": "2020-06-22T10:37:16Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Criterion.java", "diffHunk": "@@ -72,6 +72,7 @@\n \n     @Lob\n     private String description;\n+\tprivate double weight;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE4ODgyOnYy", "diffSide": "RIGHT", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Rubric.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzoyNFrOGm7LNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzoyNFrOGm7LNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODU5OA==", "bodyText": "Wrong indentation", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468598", "createdAt": "2020-06-22T10:37:24Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Rubric.java", "diffHunk": "@@ -70,6 +70,7 @@\n \n     private String title;\n     private String description;\n+\tprivate boolean weighted;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE4OTY3OnYy", "diffSide": "RIGHT", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineCriterion.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzozOVrOGm7LqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozNzozOVrOGm7LqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODcxMg==", "bodyText": "Wrong indentation", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468712", "createdAt": "2020-06-22T10:37:39Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineCriterion.java", "diffHunk": "@@ -32,14 +32,16 @@\n import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n \n @Projection(name = \"inlineCriterion\", types = { Criterion.class })\n-@JsonPropertyOrder({\"id\", \"title\", \"description\", \"metadata\", \"ratings\"})\n+@JsonPropertyOrder({\"id\", \"title\", \"weight\", \"description\", \"metadata\", \"ratings\"})\n public interface InlineCriterion {\n \n     Long getId();\n \n     String getTitle();\n \n     String getDescription();\n+\t\n+\tdouble getWeight();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5MjMwOnYy", "diffSide": "RIGHT", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineRubric.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozODozOVrOGm7NXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozODozOVrOGm7NXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTE0OQ==", "bodyText": "Wrong indentation", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469149", "createdAt": "2020-06-22T10:38:39Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineRubric.java", "diffHunk": "@@ -33,14 +33,16 @@\n import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n \n @Projection(name = \"inlineRubric\", types = { Rubric.class })\n-@JsonPropertyOrder({\"id\", \"title\", \"description\", \"metadata\", \"criterions\"})\n+@JsonPropertyOrder({\"id\", \"title\", \"description\", \"weighted\", \"metadata\", \"criterions\"})\n public interface InlineRubric {\n \n     Long getId();\n \n     String getTitle();\n \n     String getDescription();\n+\t\n+\tboolean getWeighted();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NDM5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOToyN1rOGm7Oww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOToyN1rOGm7Oww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTUwNw==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469507", "createdAt": "2020-06-22T10:39:27Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div style=\"margin-bottom: -5px;margin-top: 5px;display: flex;align-items: center;flex-wrap:wrap\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NDc5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTozNFrOGm7O_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTozNFrOGm7O_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTU2Nw==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469567", "createdAt": "2020-06-22T10:39:34Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div style=\"margin-bottom: -5px;margin-top: 5px;display: flex;align-items: center;flex-wrap:wrap\">\n+                        <span style=\"font-size: 12px;margin-right: 8px;\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NTI3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTo0N1rOGm7PWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTo0N1rOGm7PWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTY1Ng==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469656", "createdAt": "2020-06-22T10:39:47Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NTQ5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTo1MlrOGm7Peg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDozOTo1MlrOGm7Peg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTY5MA==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469690", "createdAt": "2020-06-22T10:39:52Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NTgxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MDowMFrOGm7PqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MDowMFrOGm7PqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTczNw==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469737", "createdAt": "2020-06-22T10:40:00Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >\n+                        <span class=\"control-label\" style=\"font-size: 12px;\">%</span>\n+                      ` : html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" title=\"${tr(\"total_weight_wrong\")}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5NjIzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MDowOFrOGm7P5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MDowOFrOGm7P5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTc5Nw==", "bodyText": "Can we use classes instead of direct styles?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469797", "createdAt": "2020-06-22T10:40:08Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >\n+                        <span class=\"control-label\" style=\"font-size: 12px;\">%</span>\n+                      ` : html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" title=\"${tr(\"total_weight_wrong\")}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzE5OTYwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MToyMVrOGm7SCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMDo0MToyMVrOGm7SCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ3MDM0NQ==", "bodyText": "Wrong indentation", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443470345", "createdAt": "2020-06-22T10:41:21Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +188,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MzQ2OTYxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMjoxMjozOFrOGm98NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxMjoxMjozOFrOGm98NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzUxMzkwOQ==", "bodyText": "I guess once is enough! ;)", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443513909", "createdAt": "2020-06-22T12:12:38Z", "author": {"login": "bgarciaentornos"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY2MDE4OnYy", "diffSide": "RIGHT", "path": "library/src/morpheus-master/sass/modules/tool/rubrics/_rubrics.scss", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMToyNjowOFrOGoOBkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzozMzo0NVrOGpWt6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjAwMw==", "bodyText": "Small thing. Can we have spaces after the selector in our css? Makes it a bit easier to read,", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444826003", "createdAt": "2020-06-24T11:26:08Z", "author": {"login": "adrianfish"}, "path": "library/src/morpheus-master/sass/modules/tool/rubrics/_rubrics.scss", "diffHunk": "@@ -322,6 +322,47 @@\n                 color: $rubrics-crit-item-title-color;\n             }\n         }\n+        .criterion-weight{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxNzAwMA==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446017000", "createdAt": "2020-06-26T07:33:45Z", "author": {"login": "brdebr"}, "path": "library/src/morpheus-master/sass/modules/tool/rubrics/_rubrics.scss", "diffHunk": "@@ -322,6 +322,47 @@\n                 color: $rubrics-crit-item-title-color;\n             }\n         }\n+        .criterion-weight{", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjAwMw=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY2MzQ2OnYy", "diffSide": "RIGHT", "path": "rubrics/api/src/main/bundle/rubrics.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMToyNzoxN1rOGoODqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMToyNzoxN1rOGoODqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjUzNg==", "bodyText": "Typo there. I know the word's one of those really weird English words ... :)", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444826536", "createdAt": "2020-06-24T11:27:17Z", "author": {"login": "adrianfish"}, "path": "rubrics/api/src/main/bundle/rubrics.properties", "diffHunk": "@@ -42,6 +47,8 @@ modified=Modified\n actions=Actions\n share=Share {}\n share_label=Share\n+weighted_label=Weigthed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY3MjgwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMDoyNlrOGoOJtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMDoyNlrOGoOJtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyODA4NA==", "bodyText": "Can just use double quotes here.\n: \"\"", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444828084", "createdAt": "2020-06-24T11:30:26Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div class=\"criterion-weight\">\n+                        <span>\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </span>\n+                        <span>${c.weight}</span>\n+                        <span>\n+                          %\n+                        </span>\n+                    </div>`\n+                  : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY3Njc5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMTo0MFrOGoOMGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMTo0MFrOGoOMGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyODY5Ng==", "bodyText": "Same. no template needed here, just double quotes.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444828696", "createdAt": "2020-06-24T11:31:40Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -32,7 +45,17 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n                     <div tabindex=\"0\" title=\"${tr(\"rating_title\")}: ${r.title}. ${tr(\"rating_description\")}: ${r.description}. ${tr(\"point_value\")}: ${r.points.toLocaleString(this.locale)}\" class=\"rating-item\" id=\"rating_item_${r.id}\" on-save-ratings=\"saveRatings\" @on-delete-rating=\"${this.deleteCriterionRating}\">\n                       <h5 class=\"criterion-item-title\">${r.title}</h5>\n                       <p>${r.description}</p>\n-                      <span class=\"points\">${r.points.toLocaleString(this.locale)} ${tr(\"points\")}</span>\n+                      <span class=\"points\">\n+                        ${this.weighted && r.points > 0 ?\n+                          html`\n+                            <b>\n+                              (${(r.points * (c.weight / 100)).toFixed(2)})\n+                            </b>`\n+                          : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY4MDQzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMjo1NlrOGoOOMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMjo1NlrOGoOOMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTIzMw==", "bodyText": "You don't need the type here, just weighted: Boolean, etc. I know you're copying the pattern, but you don't need the extra chars.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829233", "createdAt": "2020-06-24T11:32:56Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -16,6 +16,9 @@ export class SakaiRubricCriteria extends RubricsElement {\n     return {\n       token: { type: String },\n       rubricId: { attribute: \"rubric-id\", type: String },\n+      weighted: { type: Boolean },\n+      totalWeight: { type: String },\n+      validWeight: { type: Boolean },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY4MzE2OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMzo1NVrOGoOP7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozMzo1NVrOGoOP7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTY3Ng==", "bodyText": "Just double quotes needed here.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829676", "createdAt": "2020-06-24T11:33:55Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </label>\n+                      <input\n+                        id=\"weight_input_${c.id}\"\n+                        data-criterion-id=\"${c.id}\"\n+                        type=\"text\"\n+                        class=\"form-control\"\n+                        placeholder=\"0.0\"\n+                        @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                        value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                      <span class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        %\n+                      </span>\n+                    </div>\n+                </div>` : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY4NDIwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozNDoxOVrOGoOQkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozNDoxOVrOGoOQkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTg0Mg==", "bodyText": "double quotes", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829842", "createdAt": "2020-06-24T11:34:19Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -95,11 +126,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n         </div>\n       `)}\n       </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"total-weight\">\n+          <span class=\"control-label\">${tr('total_weight', [this.totalWeight])}</span>\n+        </div>`\n+        : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY5MjM3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozNjo0N1rOGoOVjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozNjo0N1rOGoOVjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMTExNw==", "bodyText": "You need to be consistent with the html bit here. I'd put the html on the same line as the ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444831117", "createdAt": "2020-06-24T11:36:47Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTY5OTYwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozOTowNlrOGoOZ2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozOTowNlrOGoOZ2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjIxOA==", "bodyText": "try and stick to the same kind of quotes. I use doubles - in future I think we'll all be using the backtick `, but not yet.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832218", "createdAt": "2020-06-24T11:39:06Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </label>\n+                      <input\n+                        id=\"weight_input_${c.id}\"\n+                        data-criterion-id=\"${c.id}\"\n+                        type=\"text\"\n+                        class=\"form-control\"\n+                        placeholder=\"0.0\"\n+                        @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                        value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcwMDczOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozOToyNlrOGoOaiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTozOToyNlrOGoOaiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjM5Mg==", "bodyText": "Try and stick to double quotes", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832392", "createdAt": "2020-06-24T11:39:26Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcwMjgzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0MDowN1rOGoObww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0MDowN1rOGoObww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjcwNw==", "bodyText": "Just double quotes needed, no html template tag.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832707", "createdAt": "2020-06-24T11:40:07Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -95,11 +126,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n         </div>\n       `)}\n       </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"total-weight\">\n+          <span class=\"control-label\">${tr('total_weight', [this.totalWeight])}</span>\n+        </div>`\n+        : html``\n+      }\n       <br>\n-      <button class=\"add-criterion\" @click=\"${this.createCriterion}\">\n-        <span tabindex=\"0\" role=\"button\" class=\"add fa fa-plus\"></span>\n-        <sr-lang key=\"add_criterion\">Add Criterion</sr-lang>\n-      </button>\n+      <div>\n+        ${this.weighted ? html`\n+          <button class=\"save-weights\" @click=\"${this.saveWeights}\" ?disabled=\"${!this.validWeight}\">\n+            <span tabindex=\"0\" role=\"button\" class=\"add fa fa-save\"></span>\n+            <sr-lang key=\"save_weights\">Save Weights</sr-lang>\n+          </button>`\n+          : html``\n+        }\n+        <button class=\"add-criterion\" @click=\"${this.createCriterion}\">\n+          <span tabindex=\"0\" role=\"button\" class=\"add fa fa-plus\"></span>\n+          <sr-lang key=\"add_criterion\">Add Criterion</sr-lang>\n+        </button>\n+      </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"save-success has-success\" style=\"display:none;\">\n+          <span class=\"control-label\">${tr(\"saved_successfully\")}</span>\n+        </div>`\n+        : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcxMTAwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0Mjo0OVrOGoOg3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0Mjo0OVrOGoOg3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDAxMg==", "bodyText": "Most of the rubrics code has a newline after the function name.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444834012", "createdAt": "2020-06-24T11:42:49Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 89}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcxNzEwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0NDo0NFrOGoOkhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzozNTowOVrOGpWweA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDk1MA==", "bodyText": "Make this function a lambda and you don't need the var self = this line. This is the surrounding function's scope.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444834950", "createdAt": "2020-06-24T11:44:44Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxNzY1Ng==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446017656", "createdAt": "2020-06-26T07:35:09Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDk1MA=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcyMjQyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0NjoxNVrOGoOnmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzozNzo0M1rOGpW1Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNTczOA==", "bodyText": "Just out of curiosity, why do you need this debounce function? Why do you need to pull functions out of the normal render cycle?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444835738", "createdAt": "2020-06-24T11:46:15Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {\n+        fn.apply(self, args);\n+      }, delay);\n+    };\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxODg0Ng==", "bodyText": "Mostly for UX and to don't modify the DOM at each key press.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446018846", "createdAt": "2020-06-26T07:37:43Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {\n+        fn.apply(self, args);\n+      }, delay);\n+    };\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNTczOA=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 98}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcyNjE3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0NzoyNlrOGoOp6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0NzoyNlrOGoOp6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNjMzMQ==", "bodyText": "space after the function name and before the brace", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444836331", "createdAt": "2020-06-24T11:47:26Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -192,6 +258,24 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.criteriaMap.delete(e.detail.id);\n     this.requestUpdate();\n     this.letShareKnow();\n+    this.dispatchEvent(new CustomEvent('refresh-total-weight', { detail: { criteria: this.criteria } }));\n+  }\n+\n+  emitWeightChanged(e){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTcyOTg3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0ODozM1rOGoOsQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0ODozM1rOGoOsQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNjkzMQ==", "bodyText": "weighted: Boolean will do it.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444836931", "createdAt": "2020-06-24T11:48:33Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -6,7 +6,7 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n   static get properties() {\n \n     return {\n-      criteria: { type: Array },\n+      criteria: { type: Array }, weighted: { type: Boolean }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczMDc0OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0ODo1MFrOGoOsxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0ODo1MFrOGoOsxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzA2MQ==", "bodyText": "bring html onto same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837061", "createdAt": "2020-06-24T11:48:50Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -19,6 +19,19 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczMTQ1OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OTowMlrOGoOtKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OTowMlrOGoOtKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzE2Mw==", "bodyText": "Just double quotes will do the job", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837163", "createdAt": "2020-06-24T11:49:02Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -19,6 +19,19 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                html`\n+                  <div class=\"criterion-weight\">\n+                      <span>\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </span>\n+                      <span>${c.weight}</span>\n+                      <span>\n+                        %\n+                      </span>\n+                  </div>`\n+                : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczMjI3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OToxOFrOGoOtrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OToxOFrOGoOtrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzI5Mg==", "bodyText": "bring html onto the same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837292", "createdAt": "2020-06-24T11:49:18Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -30,7 +43,15 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n                       <p>${r.description}</p>\n                     </div>\n                     <span class=\"points\">\n-                      ${r.points.toLocaleString(this.locale)} <sr-lang key=\"points\">Points</sr-lang>\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczMjc1OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OToyN1rOGoOt_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OToyN1rOGoOt_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzM3Mw==", "bodyText": "double quotes", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837373", "createdAt": "2020-06-24T11:49:27Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -30,7 +43,15 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n                       <p>${r.description}</p>\n                     </div>\n                     <span class=\"points\">\n-                      ${r.points.toLocaleString(this.locale)} <sr-lang key=\"points\">Points</sr-lang>\n+                      ${this.weighted && r.points > 0 ?\n+                        html`\n+                          <b>\n+                            (${(r.points * (c.weight / 100)).toFixed(2)})\n+                          </b>`\n+                        : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczNDUyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OTo1OFrOGoOvCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo0OTo1OFrOGoOvCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzY0Mw==", "bodyText": "Just weighted: Boolean", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837643", "createdAt": "2020-06-24T11:49:58Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -14,6 +14,7 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n       evaluationDetails: { attribute: \"evaluation-details\", type: Array },\n       preview: Boolean,\n       entityId: { attribute: \"entity-id\", type: String },\n+      weighted: { type: Boolean }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczNjI4OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MDozM1rOGoOwLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MDozM1rOGoOwLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzkzNA==", "bodyText": "html on same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837934", "createdAt": "2020-06-24T11:50:33Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -56,6 +57,19 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                  html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczNzQyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MDo1MFrOGoOwwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MDo1MFrOGoOwwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODA4MQ==", "bodyText": "double quotes only needed", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838081", "createdAt": "2020-06-24T11:50:50Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -56,6 +57,19 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                  html`\n+                    <div class=\"criterion-weight\">\n+                        <span>\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </span>\n+                        <span>${c.weight}</span>\n+                        <span>\n+                          %\n+                        </span>\n+                    </div>`\n+                  : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTczOTYxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MTozMFrOGoOyGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MTozMFrOGoOyGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODQyNQ==", "bodyText": "html on same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838425", "createdAt": "2020-06-24T11:51:30Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +78,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc0MTY0OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MjoxM1rOGoOzdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MjoxM1rOGoOzdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODc3NQ==", "bodyText": "double quotes", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838775", "createdAt": "2020-06-24T11:52:13Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +78,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`\n+                          <b>\n+                            (${(r.points * (c.weight / 100)).toFixed(2)})\n+                          </b>`\n+                        : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc0NTcyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MzozMVrOGoO19A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1MzozMVrOGoO19A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTQxMg==", "bodyText": "Use double quotes here, no html needed.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839412", "createdAt": "2020-06-24T11:53:31Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`\n+                <div class=\"criterion-weight\">\n+                    <span>\n+                      <sr-lang key=\"weight\">Weight</sr-lang>\n+                    </span>\n+                    <span>${c.weight}</span>\n+                    <span>\n+                      %\n+                    </span>\n+                </div>`\n+              : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc0NzA5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1Mzo1OVrOGoO20w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzozOToxNVrOGpW3tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTYzNQ==", "bodyText": "is % universal across locales?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839635", "createdAt": "2020-06-24T11:53:59Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`\n+                <div class=\"criterion-weight\">\n+                    <span>\n+                      <sr-lang key=\"weight\">Weight</sr-lang>\n+                    </span>\n+                    <span>${c.weight}</span>\n+                    <span>\n+                      %", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxOTUwOQ==", "bodyText": "I think so, but just in case I added it as a translation key.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446019509", "createdAt": "2020-06-26T07:39:15Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`\n+                <div class=\"criterion-weight\">\n+                    <span>\n+                      <sr-lang key=\"weight\">Weight</sr-lang>\n+                    </span>\n+                    <span>${c.weight}</span>\n+                    <span>\n+                      %", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTYzNQ=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc0NzgzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NDoxNVrOGoO3Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NDoxNVrOGoO3Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTc0Nw==", "bodyText": "html on same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839747", "createdAt": "2020-06-24T11:54:15Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc0OTkxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NDo1MlrOGoO4gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NDo1MlrOGoO4gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDA2Ng==", "bodyText": "formatting needed here, space after if, space before {", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840066", "createdAt": "2020-06-24T11:54:52Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -270,9 +293,15 @@ export class SakaiRubricGrading extends RubricsElement {\n       var ratingElements = this.querySelectorAll(`#criterion_row_${criterion.id} .rating-item`);\n       ratingElements.forEach(i => i.classList.remove('selected'));\n       clickedRatingElement.classList.add(\"selected\");\n-      criterion.selectedvalue = rating.points;\n+      var auxPoints;\n+      if(this.rubric.weighted){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc1MDMwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NTowMlrOGoO41g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NTowMlrOGoO41g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDE1MA==", "bodyText": "formatting", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840150", "createdAt": "2020-06-24T11:55:02Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -270,9 +293,15 @@ export class SakaiRubricGrading extends RubricsElement {\n       var ratingElements = this.querySelectorAll(`#criterion_row_${criterion.id} .rating-item`);\n       ratingElements.forEach(i => i.classList.remove('selected'));\n       clickedRatingElement.classList.add(\"selected\");\n-      criterion.selectedvalue = rating.points;\n+      var auxPoints;\n+      if(this.rubric.weighted){\n+        auxPoints = (rating.points * (criterion.weight / 100)).toFixed(2);\n+      }else{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc1MzM3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-preview.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NjowM1rOGoO6zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NjowM1rOGoO6zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDY1NQ==", "bodyText": "You don't need the quotes around the expression here.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840655", "createdAt": "2020-06-24T11:56:03Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-preview.js", "diffHunk": "@@ -47,6 +47,7 @@ export class SakaiRubricPreview extends RubricsElement {\n         token=\"${this.token}\"\n         criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n         gradeFieldId=\"${this.gradeFieldId}\"\n+        ?weighted=\"${this.rubric.weighted}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc1NDkxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-readonly.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NjozNlrOGoO71A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1NjozNlrOGoO71A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDkxNg==", "bodyText": "no quotes needed around the boolean attribute expression", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840916", "createdAt": "2020-06-24T11:56:36Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-readonly.js", "diffHunk": "@@ -49,7 +49,7 @@ export class SakaiRubricReadonly extends RubricsElement {\n \n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_shared_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n-          <sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\"></sakai-rubric-criteria-readonly>\n+          <sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" ?weighted=\"${this.rubric.weighted}\"></sakai-rubric-criteria-readonly>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2MDY0OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1ODozOVrOGoO_jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzozOTo0MlrOGpW4hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MTg2OQ==", "bodyText": "You don't need the type bit on these new props, unless you actually expect to use them as attributes. If they are attributes you need to make sure the attribute id weighted-icon and total-weight, otherwise you're going against the html spec.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444841869", "createdAt": "2020-06-24T11:58:39Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -28,7 +32,7 @@ export class SakaiRubric extends RubricsElement {\n   }\n \n   static get properties() {\n-    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String }};\n+    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String } , weightedIcon: { type: String } , totalWeight: { type: String } , validWeight: { type: Boolean } };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxOTcxNg==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446019716", "createdAt": "2020-06-26T07:39:42Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -28,7 +32,7 @@ export class SakaiRubric extends RubricsElement {\n   }\n \n   static get properties() {\n-    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String }};\n+    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String } , weightedIcon: { type: String } , totalWeight: { type: String } , validWeight: { type: Boolean } };", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MTg2OQ=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2MTUwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1ODo1NlrOGoPAFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1ODo1NlrOGoPAFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjAwNw==", "bodyText": "typo here", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842007", "createdAt": "2020-06-24T11:58:56Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -46,14 +50,15 @@ export class SakaiRubric extends RubricsElement {\n     this._rubric = newValue;\n     if (!this._rubric.criterions) this._rubric.criterions = [];\n     this.updateRubricConfig.url = `/rubrics-service/rest/rubrics/${newValue.id}?projection=inlineRubric`;\n+    this.handleWeighLink();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2MzY3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1OTozM1rOGoPBdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1OTozM1rOGoPBdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjM1Nw==", "bodyText": "html on same line as ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842357", "createdAt": "2020-06-24T11:59:33Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -78,6 +83,20 @@ export class SakaiRubric extends RubricsElement {\n         <div class=\"hidden-xs\"><sakai-rubric-modified-date modified=\"${this.rubric.metadata.modified}\"></sakai-rubric-modified-date></div>\n \n         <div class=\"actions\">\n+          ${!this.rubric.metadata.locked ?\n+            html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2NDM2OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1OTo0MlrOGoPB2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMTo1OTo0MlrOGoPB2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjQ1Nw==", "bodyText": "double quotes", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842457", "createdAt": "2020-06-24T11:59:42Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -78,6 +83,20 @@ export class SakaiRubric extends RubricsElement {\n         <div class=\"hidden-xs\"><sakai-rubric-modified-date modified=\"${this.rubric.metadata.modified}\"></sakai-rubric-modified-date></div>\n \n         <div class=\"actions\">\n+          ${!this.rubric.metadata.locked ?\n+            html`\n+            <div class=\"action-container\">\n+              <span class=\"hidden-sm hidden-xs sr-only\">\n+                ${this.rubric.weighted ?\n+                  html`<sr-lang key=\"weighted_label\">weighted_label</sr-lang>`\n+                  :\n+                  html`<sr-lang key=\"standard_label\">standard_label</sr-lang>`\n+                }\n+              </span>\n+              <span role=\"button\" title=\"${this.weightLabel}\" tabindex=\"0\" class=\"weighted fa ${this.weightedIcon}\" @click=\"${this.weightedChange}\"></span>\n+            </div>`\n+          : html``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2NjExOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDowOVrOGoPC4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDowOVrOGoPC4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjcyMQ==", "bodyText": "no doubles needed here", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842721", "createdAt": "2020-06-24T12:00:09Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`\n+              <sakai-rubric-criteria-readonly\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                ?weighted=\"${this.rubric.weighted}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2NjgwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDoyMlrOGoPDUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDoyMlrOGoPDUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjgzMw==", "bodyText": "html on the same line as the ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842833", "createdAt": "2020-06-24T12:00:22Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2ODA1OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDo0N1rOGoPEGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMDo0N1rOGoPEGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzAzMw==", "bodyText": "no doubles needed here.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843033", "createdAt": "2020-06-24T12:00:47Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`\n+              <sakai-rubric-criteria-readonly\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                ?weighted=\"${this.rubric.weighted}\"\n+              />`\n             :\n-            html`<sakai-rubric-criteria rubric-id=\"${this.rubric.id}\" criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria>`\n+            html`\n+              <sakai-rubric-criteria\n+                rubric-id=\"${this.rubric.id}\"\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                @criterion-created=\"${this.handleCriterionCreated}\"\n+                @save-weights=\"${this.handleSaveWeights}\"\n+                @weight-changed=\"${this.handleCriterionWeightChange}\"\n+                @refresh-total-weight=\"${this.handleRefreshTotalWeight}\"\n+                ?weighted=\"${this.rubric.weighted}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc2OTI3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMToxM1rOGoPE4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMToxM1rOGoPE4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzIzMw==", "bodyText": "could you add a newline after the function name?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843233", "createdAt": "2020-06-24T12:01:13Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc3MzE0OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMjoyMFrOGoPHLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMjoyMFrOGoPHLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzgyMA==", "bodyText": "newline after the function name.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843820", "createdAt": "2020-06-24T12:02:20Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 105}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc3Njg2OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowMzozNlrOGoPJrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0MDoyOVrOGpW5xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDQ2MQ==", "bodyText": "I'd prefer you to use vanilla js here. We're trying to not use jquery unless it offers a massive advantage.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444844461", "createdAt": "2020-06-24T12:03:36Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMDAzOQ==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446020039", "createdAt": "2020-06-26T07:40:29Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDQ2MQ=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc3OTEzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowNDoyN1rOGoPLGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowNDoyN1rOGoPLGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDgyNQ==", "bodyText": "I like a newline after the { in multiline lambdas. It helps with clarity.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444844825", "createdAt": "2020-06-24T12:04:27Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 108}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc4NjE2OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowNjo1MFrOGoPPsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0MDo0MFrOGpW6Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjAwMg==", "bodyText": "use  lambdas here to avoid the _this = this, or self = this pattern.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846002", "createdAt": "2020-06-24T12:06:50Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMDEzOQ==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446020139", "createdAt": "2020-06-26T07:40:40Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjAwMg=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 118}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc4ODczOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowNzo0MlrOGoPRWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowNzo0MlrOGoPRWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjQyNA==", "bodyText": "use lambdas", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846424", "createdAt": "2020-06-24T12:07:42Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 122}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc4OTcxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowODowMVrOGoPSAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowODowMVrOGoPSAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjU5Mg==", "bodyText": "formatting", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846592", "createdAt": "2020-06-24T12:08:01Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc5MzgzOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjowOToyM1rOGoPUqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0NDozMVrOGpXBRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzI3NQ==", "bodyText": "could you not use this.updateComplete.then( () => here instead of these timeouts?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444847275", "createdAt": "2020-06-24T12:09:23Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMTk1Ng==", "bodyText": "I think that would make it appear/disappear instantly, instead of having a wait time so the user can see the success message.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446021956", "createdAt": "2020-06-26T07:44:31Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzI3NQ=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc5Njg5OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxMDoxNFrOGoPWdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0NDo0OVrOGpXBzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzczNQ==", "bodyText": "if you don't intend this to change, use const ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444847735", "createdAt": "2020-06-24T12:10:14Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjA5Mw==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022093", "createdAt": "2020-06-26T07:44:49Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzczNQ=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 145}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTc5OTQwOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxMTowNFrOGoPYDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0NDo1NFrOGpXB_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0ODE0Mw==", "bodyText": "This should be handled in lit-element via a class property.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444848143", "createdAt": "2020-06-24T12:11:04Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 149}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjE0Mg==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022142", "createdAt": "2020-06-26T07:44:54Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0ODE0Mw=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 149}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgxMDcyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNDo1MVrOGoPfOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNzo0NTowNlrOGpXCWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0OTk3OA==", "bodyText": "This stuff should be handled by lit-element. All you need to do is set a property on your class and the render should add the class. All this manipulation of the dom using selectors is a big lit-element anti pattern.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444849978", "createdAt": "2020-06-24T12:14:51Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');\n+      this.validWeight = true;\n+    } else {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').addClass('has-error');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjIzNA==", "bodyText": "Done", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022234", "createdAt": "2020-06-26T07:45:06Z", "author": {"login": "brdebr"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');\n+      this.validWeight = true;\n+    } else {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').addClass('has-error');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0OTk3OA=="}, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 152}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgxNzIyOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNjo0N1rOGoPjJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNjo0N1rOGoPjJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MDk4MQ==", "bodyText": "If you can avoid modding the dom outside of lit-element, you should. Could you just add a property to the class that controls the addition of this class?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444850981", "createdAt": "2020-06-24T12:16:47Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');\n+      this.validWeight = true;\n+    } else {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').addClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').addClass('has-error');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 153}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgxODg0OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzoyMFrOGoPkOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzoyMFrOGoPkOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTI1OA==", "bodyText": "Typo, and a few formatting issues.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851258", "createdAt": "2020-06-24T12:17:20Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 195}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgxOTgxOnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzozNFrOGoPkwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzozNFrOGoPkwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTM5Mw==", "bodyText": "spaces after if and before {", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851393", "createdAt": "2020-06-24T12:17:34Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 196}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgyMDU3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzo0OFrOGoPlPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxNzo0OFrOGoPlPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTUxOA==", "bodyText": "spaces after } and before {", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851518", "createdAt": "2020-06-24T12:17:48Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){\n+      this.weightedIcon = 'fa-percent'\n+      this.weightLabel = tr(\"weighted_label\")\n+    }else{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 199}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgyMTQ1OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxODowMlrOGoPlxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxODowMlrOGoPlxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTY1NQ==", "bodyText": "try and stick to double quotes.", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851655", "createdAt": "2020-06-24T12:18:02Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){\n+      this.weightedIcon = 'fa-percent'\n+      this.weightLabel = tr(\"weighted_label\")\n+    }else{\n+      this.weightedIcon = 'fa-hashtag'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 200}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3MTgyMTk3OnYy", "diffSide": "RIGHT", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxODoxNVrOGoPmHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxMjoxODoxNVrOGoPmHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTc0MQ==", "bodyText": "typo", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851741", "createdAt": "2020-06-24T12:18:15Z", "author": {"login": "adrianfish"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -190,6 +326,7 @@ export class SakaiRubric extends RubricsElement {\n \n       this.rubric = data;\n       this.dispatchEvent(new SharingChangeEvent());\n+      this.handleWeighLink();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "411195b90190297170173fbd1ce774d276edb689"}, "originalPosition": 212}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NTEwMjA5OnYy", "diffSide": "RIGHT", "path": "webcomponents/tool/src/main/frontend/js/rubrics/sakai-rubric-criterion-student.js", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDo0OFrOGqL8fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMjowMzoxNlrOGqNqBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4OTA4Nw==", "bodyText": "Move the html onto the same line as your ? ?", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446889087", "createdAt": "2020-06-29T11:10:48Z", "author": {"login": "adrianfish"}, "path": "webcomponents/tool/src/main/frontend/js/rubrics/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +77,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a6ef5f5ba6c38f2e6862150a6ee24a4c14e788b"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjkxNzEyNw==", "bodyText": "Done, missed that one \ud83d\ude05", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446917127", "createdAt": "2020-06-29T12:03:16Z", "author": {"login": "brdebr"}, "path": "webcomponents/tool/src/main/frontend/js/rubrics/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +77,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4OTA4Nw=="}, "originalCommit": {"oid": "1a6ef5f5ba6c38f2e6862150a6ee24a4c14e788b"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2221, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}