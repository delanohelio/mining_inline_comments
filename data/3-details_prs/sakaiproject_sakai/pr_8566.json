{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NTQyNzY1", "number": 8566, "title": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups", "bodyText": "", "createdAt": "2020-09-14T11:32:15Z", "url": "https://github.com/sakaiproject/sakai/pull/8566", "merged": true, "mergeCommit": {"oid": "1a19682df70ef5c66ac9cfb595fc40a5b06cc8d9"}, "closed": true, "closedAt": "2020-10-14T22:28:47Z", "author": {"login": "feralvarez95"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLZfTMgFqTQ5MzU3MDY3Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSjf89gFqTUwODcxNzIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNTcwNjcz", "url": "https://github.com/sakaiproject/sakai/pull/8566#pullrequestreview-493570673", "createdAt": "2020-09-22T15:12:09Z", "commit": {"oid": "8cddd595db4b6f186c7a327d68e09098ae91c384"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMjowOVrOHV_IQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMjowOVrOHV_IQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjgxNjQ0OQ==", "bodyText": "this should be a list() as more than one group/section should be returned.", "url": "https://github.com/sakaiproject/sakai/pull/8566#discussion_r492816449", "createdAt": "2020-09-22T15:12:09Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/MessageForumsForumManagerImpl.java", "diffHunk": "@@ -1527,6 +1527,7 @@ public String getAllowedGroupForRestrictedTopic(final Long topicId, final String\n \t\t\t\t.getNamedQuery(\"findAllowedGroupInTopic\")\n \t\t\t\t.setLong(\"id\", topicId)\n \t\t\t\t.setString(\"permissionLevelName\", permissionName)\n+\t\t\t\t.setMaxResults(1)\n \t\t\t\t.uniqueResult();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cddd595db4b6f186c7a327d68e09098ae91c384"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cddd595db4b6f186c7a327d68e09098ae91c384", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/8cddd595db4b6f186c7a327d68e09098ae91c384", "committedDate": "2020-09-14T11:31:15Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}, "afterCommit": {"oid": "71db8e1f8e0a27ae5cad850d076c55cbbb2b5db8", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/71db8e1f8e0a27ae5cad850d076c55cbbb2b5db8", "committedDate": "2020-09-24T10:40:53Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "71db8e1f8e0a27ae5cad850d076c55cbbb2b5db8", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/71db8e1f8e0a27ae5cad850d076c55cbbb2b5db8", "committedDate": "2020-09-24T10:40:53Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}, "afterCommit": {"oid": "5dc1d0689ff28812f7b7ae6fcf448c60f4431161", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/5dc1d0689ff28812f7b7ae6fcf448c60f4431161", "committedDate": "2020-10-14T08:23:38Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74f805cb1baaaf6b83454296f18fa333d38d8367", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/74f805cb1baaaf6b83454296f18fa333d38d8367", "committedDate": "2020-10-14T08:40:21Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5dc1d0689ff28812f7b7ae6fcf448c60f4431161", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/5dc1d0689ff28812f7b7ae6fcf448c60f4431161", "committedDate": "2020-10-14T08:23:38Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}, "afterCommit": {"oid": "74f805cb1baaaf6b83454296f18fa333d38d8367", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/74f805cb1baaaf6b83454296f18fa333d38d8367", "committedDate": "2020-10-14T08:40:21Z", "message": "SAK-44292: FORUMS: Error unique result while Automatically create multiple topics for groups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9661f9d2cce75d55b48f30ea8e0d94c305f49ad", "author": {"user": {"login": "ottenhoff", "name": "Sam Ottenhoff"}}, "url": "https://github.com/sakaiproject/sakai/commit/f9661f9d2cce75d55b48f30ea8e0d94c305f49ad", "committedDate": "2020-10-14T19:27:48Z", "message": "Use siteId"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NzE2MDA1", "url": "https://github.com/sakaiproject/sakai/pull/8566#pullrequestreview-508716005", "createdAt": "2020-10-14T20:47:35Z", "commit": {"oid": "f9661f9d2cce75d55b48f30ea8e0d94c305f49ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMDo0NzozNVrOHhkeKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMDo0NzozNVrOHhkeKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk2MjYwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for(String group: groupTitle) {\n          \n          \n            \n                      \t  if(groups.stream().map(site::getGroup).anyMatch(g -> g.getTitle().equals(group)))\n          \n          \n            \n                      \t\t  return true;\n          \n          \n            \n                        }\n          \n          \n            \n                        return groups.stream().map(site::getGroup).anyMatch(g -> groupTitle.contains(g.getTitle()));", "url": "https://github.com/sakaiproject/sakai/pull/8566#discussion_r504962600", "createdAt": "2020-10-14T20:47:35Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/ui/UIPermissionsManagerImpl.java", "diffHunk": "@@ -130,7 +130,10 @@ private boolean isInstructorForAllowedGroup(Long forumId, boolean isForum) {\n         try {\n             Site site = siteService.getSite(siteId);\n             Set<String> groups = getGroupsWithMember(site, getCurrentUserId());\n-            return groups.stream().map(site::getGroup).anyMatch(g -> g.getTitle().equals(groupTitle));\n+            for(String group: groupTitle) {\n+          \t  if(groups.stream().map(site::getGroup).anyMatch(g -> g.getTitle().equals(group)))\n+          \t\t  return true;\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9661f9d2cce75d55b48f30ea8e0d94c305f49ad"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f7624b2b856f5775144cf09643888e8d16be499", "author": {"user": {"login": "ern", "name": "Earle Nietzel"}}, "url": "https://github.com/sakaiproject/sakai/commit/4f7624b2b856f5775144cf09643888e8d16be499", "committedDate": "2020-10-14T20:48:32Z", "message": "updated lambda for matching group title"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NzE3MjE2", "url": "https://github.com/sakaiproject/sakai/pull/8566#pullrequestreview-508717216", "createdAt": "2020-10-14T20:49:27Z", "commit": {"oid": "4f7624b2b856f5775144cf09643888e8d16be499"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2632, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}