{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2Mzk1NjIx", "number": 8647, "title": "SAK-44397: Bugs fixes for SAK-42856: Provide a way to reply private", "bodyText": "Bugs fixes for SAK-42856: Provide a way to reply private", "createdAt": "2020-10-01T16:38:59Z", "url": "https://github.com/sakaiproject/sakai/pull/8647", "merged": true, "mergeCommit": {"oid": "579238aec75514aca7a7f10a78e3e15e6243997f"}, "closed": true, "closedAt": "2020-10-30T13:07:15Z", "author": {"login": "victorGomollon"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOT7H6gH2gAyNDk2Mzk1NjIxOmEyM2ZmOWFkMzU5ODA0NWUyM2I3MDI5ZWUzNjBhNGFlNjUzMDRkOGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXmedEgFqTUyMDY0NzkxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a23ff9ad3598045e23b7029ee360a4ae65304d8f", "author": {"user": {"login": "victorGomollon", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/a23ff9ad3598045e23b7029ee360a4ae65304d8f", "committedDate": "2020-10-01T16:24:57Z", "message": "SAK-44397: Bugs fixes for SAK-42856: Provide a way to reply private\nmessages from external mail"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzI1Mzg3", "url": "https://github.com/sakaiproject/sakai/pull/8647#pullrequestreview-500725387", "createdAt": "2020-10-01T21:17:42Z", "commit": {"oid": "a23ff9ad3598045e23b7029ee360a4ae65304d8f"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMToxNzo0M1rOHbbIjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMToxOTozMFrOHbbLRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUxODE1Nw==", "bodyText": "use the ServerConfigurationService api vs the cover", "url": "https://github.com/sakaiproject/sakai/pull/8647#discussion_r498518157", "createdAt": "2020-10-01T21:17:43Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/ui/PrivateMessageManagerImpl.java", "diffHunk": "@@ -1184,7 +1184,7 @@ private String getSystemAndReplyEmail(String defaultEmail, User currentUser, Mes\n \t\t    else\n \t\t\t    systemEmail = ServerConfigurationService.getString(FROM_ADDRESS, defaultEmail);\n \t    }\n-\t\tif ((\"all\".equals(ServerConfigurationService.getString(REAL_REPLY, \"none\")) || contextId.contains(ServerConfigurationService.getString(REAL_REPLY, \"none\"))) && systemEmail.equalsIgnoreCase(ServerConfigurationService.getString(FROM_ADDRESS, defaultEmail))) {\n+\t\tif (ServerConfigurationService.getStrings(REAL_REPLY)!=null && (\"all\".equals(ServerConfigurationService.getString(REAL_REPLY, \"none\")) || Arrays.asList(ServerConfigurationService.getStrings(REAL_REPLY)).contains(contextId)) && systemEmail.equalsIgnoreCase(ServerConfigurationService.getString(FROM_ADDRESS, defaultEmail))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23ff9ad3598045e23b7029ee360a4ae65304d8f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUxODIxNQ==", "bodyText": "use the ServerConfigurationService api vs the cover", "url": "https://github.com/sakaiproject/sakai/pull/8647#discussion_r498518215", "createdAt": "2020-10-01T21:17:51Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/ui/PrivateMessageManagerImpl.java", "diffHunk": "@@ -1452,7 +1452,7 @@ private String buildMessageBody(PrivateMessage message) {\n \t      getResourceBundleString(EMAIL_FOOTER1) + \" \" + ServerConfigurationService.getString(\"ui.service\",\"Sakai\") +\n \t  \" \" + getResourceBundleString(EMAIL_FOOTER2) + \" \\\"\" +\n \t  siteTitle + \"\\\" \" + getResourceBundleString(EMAIL_FOOTER3) + \"\\n\";\n-\t  if ((\"all\".equals(ServerConfigurationService.getString(REAL_REPLY, \"none\")) || contextId.contains(ServerConfigurationService.getString(REAL_REPLY, \"none\")))){\n+\t  if (ServerConfigurationService.getStrings(REAL_REPLY)!=null && (\"all\".equals(ServerConfigurationService.getString(REAL_REPLY, \"none\")) || Arrays.asList(ServerConfigurationService.getStrings(REAL_REPLY)).contains(contextId))){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23ff9ad3598045e23b7029ee360a4ae65304d8f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUxODg1Mg==", "bodyText": "use Types", "url": "https://github.com/sakaiproject/sakai/pull/8647#discussion_r498518852", "createdAt": "2020-10-01T21:19:30Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/ui/PrivateMessageManagerImpl.java", "diffHunk": "@@ -2235,7 +2235,7 @@ public void processPvtMsgReplySentAction(PrivateMessage currentMessage, PrivateM\n \t\t\t\t  log.error(e.getMessage(), e);\n \t\t\t  }\n \n-\t\t\t  Event event = eventTrackingService.newEvent(DiscussionForumService.EVENT_MESSAGES_RESPONSE, getEventMessage(currentMessage, DiscussionForumService.MESSAGES_TOOL_ID, rrepMsg.getAuthorId(), ((PrivateMessageRecipientImpl)currentMessage.getRecipients().get(0)).getContextId()), null, true, NotificationService.NOTI_OPTIONAL, statement);\n+\t\t\t  Event event = eventTrackingService.newEvent(DiscussionForumService.EVENT_MESSAGES_RESPONSE, getEventMessage(currentMessage, DiscussionForumService.MESSAGES_TOOL_ID, rrepMsg.getAuthorId(), ((PrivateMessageRecipientImpl)currentMessage.getRecipients().get(0)).getContextId()), contextId, true, NotificationService.NOTI_OPTIONAL, statement);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23ff9ad3598045e23b7029ee360a4ae65304d8f"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9529e43927bb14141e89cf4b6bc70fd5a611167", "author": {"user": {"login": "victorGomollon", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/e9529e43927bb14141e89cf4b6bc70fd5a611167", "committedDate": "2020-10-08T09:14:17Z", "message": "SAK-44397: Resolved Issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyODU2OTk4", "url": "https://github.com/sakaiproject/sakai/pull/8647#pullrequestreview-512856998", "createdAt": "2020-10-20T15:23:33Z", "commit": {"oid": "e9529e43927bb14141e89cf4b6bc70fd5a611167"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNToyMzozM1rOHlCv9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNToyMzozM1rOHlCv9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODYwNDQwNw==", "bodyText": "use a local variable for serverConfigurationService.getStrings(REAL_REPLY)", "url": "https://github.com/sakaiproject/sakai/pull/8647#discussion_r508604407", "createdAt": "2020-10-20T15:23:33Z", "author": {"login": "ern"}, "path": "msgcntr/messageforums-component-impl/src/java/org/sakaiproject/component/app/messageforums/ui/PrivateMessageManagerImpl.java", "diffHunk": "@@ -1449,21 +1449,21 @@ private String buildMessageBody(PrivateMessage message) {\n \t  }\n \n \t  String footer = \"<p>----------------------<br>\" +\n-\t      getResourceBundleString(EMAIL_FOOTER1) + \" \" + ServerConfigurationService.getString(\"ui.service\",\"Sakai\") +\n+\t      getResourceBundleString(EMAIL_FOOTER1) + \" \" + serverConfigurationService.getString(\"ui.service\",\"Sakai\") +\n \t  \" \" + getResourceBundleString(EMAIL_FOOTER2) + \" \\\"\" +\n \t  siteTitle + \"\\\" \" + getResourceBundleString(EMAIL_FOOTER3) + \"\\n\";\n-\t  if ((\"all\".equals(ServerConfigurationService.getString(REAL_REPLY, \"none\")) || contextId.contains(ServerConfigurationService.getString(REAL_REPLY, \"none\")))){\n+\t  if (serverConfigurationService.getStrings(REAL_REPLY)!=null && (\"all\".equals(serverConfigurationService.getString(REAL_REPLY, \"none\")) || Arrays.asList(serverConfigurationService.getStrings(REAL_REPLY)).contains(contextId))){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9529e43927bb14141e89cf4b6bc70fd5a611167"}, "originalPosition": 114}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "104f79284e30b60557abd1d1cc24def1cc38593d", "author": {"user": {"login": "victorGomollon", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/104f79284e30b60557abd1d1cc24def1cc38593d", "committedDate": "2020-10-27T09:01:06Z", "message": "SAK-44397: use a local variable for\nserverConfigurationService.getStrings(REAL_REPLY)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNjQ3OTEx", "url": "https://github.com/sakaiproject/sakai/pull/8647#pullrequestreview-520647911", "createdAt": "2020-10-30T13:07:09Z", "commit": {"oid": "104f79284e30b60557abd1d1cc24def1cc38593d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2531, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}