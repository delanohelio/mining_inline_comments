{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzEwNDc3", "number": 7975, "title": "SAK-43319 Fixed various grade types in Grader.", "bodyText": "https://jira.sakaiproject.org/browse/SAK-43319\nReusing Assignments i18n bundle\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker", "createdAt": "2020-03-04T17:08:27Z", "url": "https://github.com/sakaiproject/sakai/pull/7975", "merged": true, "mergeCommit": {"oid": "2d50f7c19fdea4608f400a9e35a6e7daafbf16b5"}, "closed": true, "closedAt": "2020-03-05T18:14:27Z", "author": {"login": "adrianfish"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKm64hAFqTM2OTM2MDA3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKvNxFAFqTM2OTc4MTQ5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MzYwMDc3", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369360077", "createdAt": "2020-03-05T08:06:02Z", "commit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NDA3NDA3", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369407407", "createdAt": "2020-03-05T09:23:38Z", "commit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyMzozOFrOFyL5Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyMzozOFrOFyL5Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2Nzk3OQ==", "bodyText": "Please, remove this. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388167979", "createdAt": "2020-03-05T09:23:38Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/pom.xml", "diffHunk": "@@ -36,10 +36,10 @@\n             <groupId>${project.groupId}</groupId>\n             <artifactId>sakai-assignment-api</artifactId>\n         </dependency>\n-        <dependency>\n+        <!--dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NDEwMDkz", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369410093", "createdAt": "2020-03-05T09:27:13Z", "commit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoxM1rOFyMBPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoxM1rOFyMBPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDA0Nw==", "bodyText": "Spacing...", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170047", "createdAt": "2020-03-05T09:27:13Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NDEwMjc0", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369410274", "createdAt": "2020-03-05T09:27:29Z", "commit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoyOVrOFyMBzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwOToyNzoyOVrOFyMBzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDE5MA==", "bodyText": "Please, remove this. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170190", "createdAt": "2020-03-05T09:27:29Z", "author": {"login": "jesusmmp"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){\n+                /*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/ce36b0ea3bec4562fd6b395a29b716d220a1a1f0", "committedDate": "2020-03-04T17:06:30Z", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker"}, "afterCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/292de9ec1745c57bb0c0d99ff291284785700a6a", "committedDate": "2020-03-05T10:57:05Z", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NTA1NDM3", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369505437", "createdAt": "2020-03-05T11:50:28Z", "commit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDoyOFrOFyQm7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDoyOFrOFyQm7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTIzMQ==", "bodyText": "Please @adrianfish, could you remove 429, 431 and 438?. Thanks!", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245231", "createdAt": "2020-03-05T11:50:28Z", "author": {"login": "jesusmmp"}, "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -386,43 +420,51 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n       height: height,\n       startupFocus: true,\n     });\n-    editor.on(\"change\", () => this.modified = true);\n+    editor.on(\"change\", () => this.modified = true );\n     return editor;\n   }\n \n   toggleInlineFeedback(e, cancelling) {\n \n-    if (!this.inlineFeedbackMode) {\n-      this.inlineFeedbackMode = true;\n+    //if (!this.inlineFeedbackMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "originalPosition": 369}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NTA1NjU5", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369505659", "createdAt": "2020-03-05T11:50:51Z", "commit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDo1MVrOFyQnnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxMTo1MDo1MVrOFyQnnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTQwNQ==", "bodyText": "Please, remove this one too. Thanks", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245405", "createdAt": "2020-03-05T11:50:51Z", "author": {"login": "jesusmmp"}, "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -170,6 +191,9 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n   renderSaved() {\n     return html`<span class=\"saved fa fa-check-circle\" title=\"${this.i18n[\"saved_successfully\"]}\" style=\"display: ${this.saved ? \"inline\" : \"none\"};\"></span>`;\n   }\n+            //<a href=\"javascript:;\" id=\"grader-rubric-link\" @click=${this.toggleRubric} title=\"${this.assignmentsI18n[\"grading_rubric\"]}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a"}, "originalPosition": 146}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "committedDate": "2020-03-05T12:31:26Z", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/292de9ec1745c57bb0c0d99ff291284785700a6a", "committedDate": "2020-03-05T10:57:05Z", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker"}, "afterCommit": {"oid": "bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "committedDate": "2020-03-05T12:31:26Z", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NzgxNDk1", "url": "https://github.com/sakaiproject/sakai/pull/7975#pullrequestreview-369781495", "createdAt": "2020-03-05T17:45:54Z", "commit": {"oid": "bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2251, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}