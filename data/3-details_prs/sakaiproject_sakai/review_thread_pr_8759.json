{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTAzNzc3", "number": 8759, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNTo1NzoyNlrOEz2w-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNTo1NzoyNlrOEz2w-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyODEwMTA1OnYy", "diffSide": "RIGHT", "path": "lessonbuilder/tool/src/java/org/sakaiproject/lessonbuildertool/tool/producers/ShowPageProducer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNTo1NzoyNlrOHrViYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNTo1NzoyNlrOHrViYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIwMzY4MA==", "bodyText": "Perhaps there's a better way to do this in Lessons code? I'm not sure. I found this comment and code earlier in the file:\n\t\t    // assignments won't let us get the entity if we're not in the group, so set up permissions before other tests\n\t\t\tif (usable && i.isPrerequisite()) {\n\t\t\t    simplePageBean.checkItemPermissions(i, true);\n\t\t\t}\n\nHowever if I call this method in the location here, nothing changes and I still get a permission exception in AssignmentEntity when trying to resolve the entity to access the open date.", "url": "https://github.com/sakaiproject/sakai/pull/8759#discussion_r515203680", "createdAt": "2020-10-30T15:57:26Z", "author": {"login": "bjones86"}, "path": "lessonbuilder/tool/src/java/org/sakaiproject/lessonbuildertool/tool/producers/ShowPageProducer.java", "diffHunk": "@@ -4004,7 +4006,19 @@ protected static boolean makeLink(UIContainer container, String ID, SimplePageIt\n \n \t\tif (fake) {\n \t\t\tID = ID + \"-fake\";\n-\t\t\tUIOutput link = UIOutput.make(container, ID, i.getName());\n+\t\t\tString linkText = i.getName();\n+\t\t\tif (i.getType() == SimplePageItem.ASSIGNMENT) {\n+\t\t\t\tSecurityAdvisor yesMan = (String arg0, String arg1, String agr2) -> SecurityAdvisor.SecurityAdvice.ALLOWED;\n+\t\t\t\tsecurityService.pushAdvisor(yesMan);\n+\t\t\t\ttry {\n+\t\t\t\t\tAssignmentEntity assignment = (AssignmentEntity) assignmentEntity.getEntity(i.getSakaiId(), simplePageBean);\n+\t\t\t\t\tlinkText += \" \" + messageLocator.getMessage(\"simplepage.assignment.open_date\", new Object[] {assignment.getOpenDate()});\n+\t\t\t\t} catch (Exception ex) {}\n+\t\t\t\tfinally {\n+\t\t\t\t\tsecurityService.popAdvisor(yesMan);\n+\t\t\t\t}\n+\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee1c82d7f24f54cd145ff768ff969d72a4f6265c"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2474, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}