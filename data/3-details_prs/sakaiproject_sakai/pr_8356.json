{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MDgxNzg2", "number": 8356, "title": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with \"Don't allow partial credit\"", "bodyText": "", "createdAt": "2020-07-13T08:16:35Z", "url": "https://github.com/sakaiproject/sakai/pull/8356", "merged": true, "mergeCommit": {"oid": "e28b1b83755cd77e9ac0869d1b2c8efe38afe017"}, "closed": true, "closedAt": "2020-09-23T09:46:29Z", "author": {"login": "feralvarez95"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0d_ozAFqTQ0NzA4MjA5NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLow0uABqjM3OTcwMjgyMzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3MDgyMDk0", "url": "https://github.com/sakaiproject/sakai/pull/8356#pullrequestreview-447082094", "createdAt": "2020-07-13T09:26:54Z", "commit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODA5NTIw", "url": "https://github.com/sakaiproject/sakai/pull/8356#pullrequestreview-447809520", "createdAt": "2020-07-14T06:01:30Z", "commit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNTI1Mzk4", "url": "https://github.com/sakaiproject/sakai/pull/8356#pullrequestreview-452525398", "createdAt": "2020-07-21T14:38:35Z", "commit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDozODozNVrOG07LfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNDo0NDo1M1rOG07e8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODE0ODczMw==", "bodyText": "I know this was n't added by you but this number looks strange?", "url": "https://github.com/sakaiproject/sakai/pull/8356#discussion_r458148733", "createdAt": "2020-07-21T14:38:35Z", "author": {"login": "ern"}, "path": "samigo/samigo-services/src/java/org/sakaiproject/tool/assessment/services/GradingService.java", "diffHunk": "@@ -1003,9 +1030,19 @@ public int compare(ItemGradingData o1, ItemGradingData o2) {\n         \t\t}\n         \t}\n         }\n-        if ((TypeIfc.IMAGEMAP_QUESTION.equals(itemType))&&(NeededAllOk)&&((autoScore==-123456789)||!imageMapAllOk)){\n-        \tautoScore=0;\n-        \timageMapAllOk=false;\n+        \n+        if (TypeIfc.IMAGEMAP_QUESTION.equals(itemType) && neededAllOk){\n+        \tif(!imageMapAlreadyOk) {\n+        \t\tautoScore = 0;\n+        \t}else if(autoScore == -123456789){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODE1MDA1OQ==", "bodyText": "Update this with a newer style loop (for, foreach, lambda)", "url": "https://github.com/sakaiproject/sakai/pull/8356#discussion_r458150059", "createdAt": "2020-07-21T14:40:15Z", "author": {"login": "ern"}, "path": "samigo/samigo-services/src/java/org/sakaiproject/tool/assessment/services/GradingService.java", "diffHunk": "@@ -3391,6 +3428,26 @@ private boolean isCalcQuestion(List tempItemGradinglist, Map publishedItemHash)\n \t  }\n \t  return false;\n   }\n+  \n+  /**\n+   * IMAGE_MAP QUESTION\n+   * Simple to check to see if this is a calculated question. It's used in storeGrades() to see if the sort is necessary.\n+   */\n+  private boolean isImageMapQuestion(List tempItemGradinglist, Map publishedItemHash) {\n+\t  if (tempItemGradinglist == null) return false;\n+\t  if (tempItemGradinglist.isEmpty()) return false;\n+\t  \n+\t  Iterator iter = tempItemGradinglist.iterator();\n+\t  while(iter.hasNext()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODE1MzcxMg==", "bodyText": "It would be ideal to externalize this comparator so that in can be unit tested.\nAlso see springs NullSafeComparator or use java's newer lambda comparator which deals with nulls in a better way either is fine.\nExample org.sakaiproject.util.comparator.UserSortNameComparator or https://www.baeldung.com/java-8-comparator-comparing", "url": "https://github.com/sakaiproject/sakai/pull/8356#discussion_r458153712", "createdAt": "2020-07-21T14:44:53Z", "author": {"login": "ern"}, "path": "samigo/samigo-services/src/java/org/sakaiproject/tool/assessment/services/GradingService.java", "diffHunk": "@@ -912,6 +909,23 @@ public int compare(ItemGradingData o1, ItemGradingData o2) {\n \t      });\n       }\n       \n+    //IMAGEMAP_QUESTION - order by itemGradingId if it is an imageMap question\n+      if (isImageMapQuestion(tempItemGradinglist, publishedItemHash)) {\n+\t      Collections.sort(tempItemGradinglist, new Comparator<ItemGradingData>(){\n+\t    \t  public int compare(ItemGradingData o1, ItemGradingData o2) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a436ffee702e9003da5a8d1e67d0ff09f0b5543", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/7a436ffee702e9003da5a8d1e67d0ff09f0b5543", "committedDate": "2020-07-13T08:02:14Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "956e0bf47e802ea60b0fc4bcf6e987f5ecce971c", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/956e0bf47e802ea60b0fc4bcf6e987f5ecce971c", "committedDate": "2020-07-23T08:02:42Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "956e0bf47e802ea60b0fc4bcf6e987f5ecce971c", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/956e0bf47e802ea60b0fc4bcf6e987f5ecce971c", "committedDate": "2020-07-23T08:02:42Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "e508149507b33b62bc5d03ae2779aad0a766721c", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/e508149507b33b62bc5d03ae2779aad0a766721c", "committedDate": "2020-07-23T08:12:07Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e508149507b33b62bc5d03ae2779aad0a766721c", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/e508149507b33b62bc5d03ae2779aad0a766721c", "committedDate": "2020-07-23T08:12:07Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "1c3ce1cb5c3f98aa5530cfac88815aadf1be8fe8", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/1c3ce1cb5c3f98aa5530cfac88815aadf1be8fe8", "committedDate": "2020-07-23T08:14:44Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c3ce1cb5c3f98aa5530cfac88815aadf1be8fe8", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/1c3ce1cb5c3f98aa5530cfac88815aadf1be8fe8", "committedDate": "2020-07-23T08:14:44Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "3eee35d8fb7edc4aeeb8ef84102678589ea17ca2", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/3eee35d8fb7edc4aeeb8ef84102678589ea17ca2", "committedDate": "2020-07-23T09:15:52Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3eee35d8fb7edc4aeeb8ef84102678589ea17ca2", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/3eee35d8fb7edc4aeeb8ef84102678589ea17ca2", "committedDate": "2020-07-23T09:15:52Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "8068aab78e2b3e3b2bf9e0c33d361e46c2685b40", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/8068aab78e2b3e3b2bf9e0c33d361e46c2685b40", "committedDate": "2020-07-23T09:19:30Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8068aab78e2b3e3b2bf9e0c33d361e46c2685b40", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/8068aab78e2b3e3b2bf9e0c33d361e46c2685b40", "committedDate": "2020-07-23T09:19:30Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "c3af5bb3257ac42ff58da049fdff914af9ff4aed", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/c3af5bb3257ac42ff58da049fdff914af9ff4aed", "committedDate": "2020-07-23T11:13:24Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODIwODM4", "url": "https://github.com/sakaiproject/sakai/pull/8356#pullrequestreview-482820838", "createdAt": "2020-09-04T17:05:15Z", "commit": {"oid": "c3af5bb3257ac42ff58da049fdff914af9ff4aed"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzowNToxNVrOHNVyMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzowNToxNVrOHNVyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc1MDQ1MA==", "bodyText": "This comparator should have a unit test and I would also look at using:\norg.springframework.util.comparator.NullSafeComparator\nas it's accounts for nulls already.", "url": "https://github.com/sakaiproject/sakai/pull/8356#discussion_r483750450", "createdAt": "2020-09-04T17:05:15Z", "author": {"login": "ern"}, "path": "samigo/samigo-services/src/java/org/sakaiproject/tool/assessment/util/comparator/ImageMapGradingItemComparator.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package org.sakaiproject.tool.assessment.util.comparator;\r\n+\r\n+import java.util.Comparator;\r\n+import org.sakaiproject.tool.assessment.data.dao.grading.ItemGradingData;\r\n+\r\n+/**\r\n+ * This sorts ItemGrading items by itemGradingId.\r\n+ */\r\n+\r\n+public class ImageMapGradingItemComparator implements Comparator<ItemGradingData> {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3af5bb3257ac42ff58da049fdff914af9ff4aed"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3af5bb3257ac42ff58da049fdff914af9ff4aed", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/c3af5bb3257ac42ff58da049fdff914af9ff4aed", "committedDate": "2020-07-23T11:13:24Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "c0fdd94653c359181b4ca52715c25be1f38527be", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/c0fdd94653c359181b4ca52715c25be1f38527be", "committedDate": "2020-09-10T07:48:32Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNTU1MTQw", "url": "https://github.com/sakaiproject/sakai/pull/8356#pullrequestreview-493555140", "createdAt": "2020-09-22T14:58:49Z", "commit": {"oid": "c0fdd94653c359181b4ca52715c25be1f38527be"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "208747511a10a6b0930b867c361829bc815ea9f9", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/208747511a10a6b0930b867c361829bc815ea9f9", "committedDate": "2020-09-23T08:59:22Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0fdd94653c359181b4ca52715c25be1f38527be", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/c0fdd94653c359181b4ca52715c25be1f38527be", "committedDate": "2020-09-10T07:48:32Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}, "afterCommit": {"oid": "208747511a10a6b0930b867c361829bc815ea9f9", "author": {"user": null}, "url": "https://github.com/sakaiproject/sakai/commit/208747511a10a6b0930b867c361829bc815ea9f9", "committedDate": "2020-09-23T08:59:22Z", "message": "SAK-43564: Samigo hotspot answer is correct but grade is 0 with 'Don't allow partial credit'"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2827, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}