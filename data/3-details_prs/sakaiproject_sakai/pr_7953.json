{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwOTg0MjE5", "number": 7953, "title": "SAK-43339 Added group picker to permissions component", "bodyText": "https://jira.sakaiproject.org/browse/SAK-43339", "createdAt": "2020-02-27T17:40:39Z", "url": "https://github.com/sakaiproject/sakai/pull/7953", "merged": true, "mergeCommit": {"oid": "1e1c2f67e7109a7a4a1e1c038ed792cff34c920d"}, "closed": true, "closedAt": "2020-03-08T15:03:11Z", "author": {"login": "adrianfish"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIr3r0gFqTM2NjIxMDMxMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLqUksABqjMxMDg0NjMwMDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MjEwMzEw", "url": "https://github.com/sakaiproject/sakai/pull/7953#pullrequestreview-366210310", "createdAt": "2020-02-28T07:50:03Z", "commit": {"oid": "28e5bf576968a6d945e0f8550fecb12561ea9478"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwNzo1MDowNFrOFvsH2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwNzo1MDowNFrOFvsH2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU1MDI5Ng==", "bodyText": "Indentation (this and following lines)", "url": "https://github.com/sakaiproject/sakai/pull/7953#discussion_r385550296", "createdAt": "2020-02-28T07:50:04Z", "author": {"login": "bgarciaentornos"}, "path": "gradebookng/tool/src/java/org/sakaiproject/gradebookng/rest/GradebookNgEntityProvider.java", "diffHunk": "@@ -238,46 +242,29 @@ public String getComments(final EntityView view, final Map<String, Object> param\n \t\tfinal String siteId = (String) params.get(\"siteId\");\n \t\tfinal long assignmentId = NumberUtils.toLong((String) params.get(\"assignmentId\"));\n \t\tfinal String action = (String) params.get(\"action\");\n-\t\tfinal String groupId = (String) params.get(\"groupId\");\n+\t\tfinal String groupRef = (String) params.get(\"groupRef\");\n \t\tfinal String minScoreString  = (String) params.get(\"minScore\");\n \t\tfinal String maxScoreString = (String) params.get(\"maxScore\");\n \n-\t\tfinal String subject = (String) params.get(\"subject\");\n-\t\tfinal String body = (String) params.get(\"body\");\n-\n \t\t// check params supplied are valid\n-\t\tif (StringUtils.isBlank(siteId) || assignmentId == 0 || StringUtils.isBlank(subject) || StringUtils.isBlank(body)) {\n-\t\t\tthrow new IllegalArgumentException(\"You must supply siteId, assignmentId, subject and body\");\n+\t\tif (StringUtils.isBlank(siteId) || assignmentId == 0 || StringUtils.isEmpty(groupRef)) {\n+\t\t\tthrow new IllegalArgumentException(\"You must supply siteId, groupRef and assignmentId\");\n \t\t}\n \n \t\tcheckInstructorOrTA(siteId);\n \n \t\tfinal Double minScore = (!StringUtils.isEmpty(minScoreString)) ? Double.valueOf(minScoreString) : null;\n \t\tfinal Double maxScore = (!StringUtils.isEmpty(maxScoreString)) ? Double.valueOf(maxScoreString) : null;\n \n-\t\tSite site = null;\n-\t\ttry {\n-\t\t\tsite = siteService.getSite(siteId);\n-\t\t} catch(IdUnusedException idue) {\n-\t\t\tthrow new IllegalArgumentException(\"siteId \" + siteId + \" is invalid\");\n-\t\t}\n-\n-\t\tSet<String> recipients = null;\n-\t\tif (StringUtils.isEmpty(groupId)) {\n-\t\t\t// Start with the site users\n-\t\t\trecipients = site.getUsers();\n-\t\t\t// Remove the instructors\n-\t\t\trecipients.removeAll(site.getUsersIsAllowed(Authz.PERMISSION_GRADE_ALL));\n-\t\t} else {\n-\t\t\tGroup group = site.getGroup(groupId);\n-\t\t\tif (group == null) {\n-\t\t\t\tthrow new IllegalArgumentException(\"Invalid groupId supplied.\");\n-\t\t\t}\n-\t\t\t// Start with the group users\n-\t\t\trecipients = group.getUsers();\n+        Set<String> recipients = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28e5bf576968a6d945e0f8550fecb12561ea9478"}, "originalPosition": 80}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28e5bf576968a6d945e0f8550fecb12561ea9478", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/28e5bf576968a6d945e0f8550fecb12561ea9478", "committedDate": "2020-02-27T16:36:56Z", "message": "SAK-43339 Added group picker to permissions component\n\nhttps://jira.sakaiproject.org/browse/SAK-43339"}, "afterCommit": {"oid": "7a14055e0c414ef300a076c025bb533dec78d038", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/7a14055e0c414ef300a076c025bb533dec78d038", "committedDate": "2020-03-01T14:34:00Z", "message": "SAK-43339 Added group picker to permissions component\n\nhttps://jira.sakaiproject.org/browse/SAK-43339"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzUzMjEw", "url": "https://github.com/sakaiproject/sakai/pull/7953#pullrequestreview-367753210", "createdAt": "2020-03-03T07:35:08Z", "commit": {"oid": "7a14055e0c414ef300a076c025bb533dec78d038"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMTUxMzM3", "url": "https://github.com/sakaiproject/sakai/pull/7953#pullrequestreview-370151337", "createdAt": "2020-03-06T08:29:12Z", "commit": {"oid": "7a14055e0c414ef300a076c025bb533dec78d038"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6727c24c0e913974e2ec682e123f6da9a5cba4df", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/6727c24c0e913974e2ec682e123f6da9a5cba4df", "committedDate": "2020-03-08T13:49:51Z", "message": "SAK-43339 Added group picker to permissions component\n\nhttps://jira.sakaiproject.org/browse/SAK-43339"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a14055e0c414ef300a076c025bb533dec78d038", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/7a14055e0c414ef300a076c025bb533dec78d038", "committedDate": "2020-03-01T14:34:00Z", "message": "SAK-43339 Added group picker to permissions component\n\nhttps://jira.sakaiproject.org/browse/SAK-43339"}, "afterCommit": {"oid": "6727c24c0e913974e2ec682e123f6da9a5cba4df", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/6727c24c0e913974e2ec682e123f6da9a5cba4df", "committedDate": "2020-03-08T13:49:51Z", "message": "SAK-43339 Added group picker to permissions component\n\nhttps://jira.sakaiproject.org/browse/SAK-43339"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2229, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}