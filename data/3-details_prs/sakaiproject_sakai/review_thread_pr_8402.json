{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3ODM4NzY4", "number": 8402, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMDowOVrOES2wtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMjowMlrOES20DA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MjA3MDMxOnYy", "diffSide": "RIGHT", "path": "library/src/morpheus-master/js/src/sakai.morpheus.themeswitcher.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMDowOVrOG4Q_dQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMDowOVrOG4Q_dQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY1MTgyOQ==", "bodyText": "=== better than == here", "url": "https://github.com/sakaiproject/sakai/pull/8402#discussion_r461651829", "createdAt": "2020-07-28T15:00:09Z", "author": {"login": "bjones86"}, "path": "library/src/morpheus-master/js/src/sakai.morpheus.themeswitcher.js", "diffHunk": "@@ -0,0 +1,43 @@\n+//There is a bright flash of light theme before this is loaded and dark theme\n+//is set. Can this be moved higher in the DOM somehow or made more performant\n+//to avoid this?\n+\n+let themeSwitcher = document.getElementById(\"themeSwitcher\");\n+\n+SAK_THEME_SELECTION_KEY = portal.user.id + \"#theme\";\n+\n+if(themeSwitcher != null) {\n+    \n+    initTheme(); // on page load, if user has already selected a specific theme -> apply it\n+  \n+    themeSwitcher.addEventListener('click', setTheme, false);\n+\n+}\n+\n+function setTheme() {\n+\n+    // Set to dark mode\n+    if (themeSwitcher.getAttribute(\"aria-checked\") == \"true\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d8928eabea92bc82909b09daf552505a8ce74c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MjA3MjUzOnYy", "diffSide": "RIGHT", "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/SkinnableCharonPortal.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMDozN1rOG4RA0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMDozN1rOG4RA0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY1MjE3Nw==", "bodyText": "Whitespace is a little off here", "url": "https://github.com/sakaiproject/sakai/pull/8402#discussion_r461652177", "createdAt": "2020-07-28T15:00:37Z", "author": {"login": "bjones86"}, "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/SkinnableCharonPortal.java", "diffHunk": "@@ -1736,7 +1738,11 @@ public void includeBottom(PortalRenderContext rcontext, Site site)\n                         \t\t\tlog.error(e1.getMessage(), e1);\n                         \t\t}\n                         \t}\n-                        }\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t\n+\t\t\t\t\t\tif(sakaiThemeSwitcherEnabled) {\n+\t\t\t\t\t\t\trcontext.put(\"themeSwitcher\", true);\n+\t\t\t\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d8928eabea92bc82909b09daf552505a8ce74c"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MjA3NjQ3OnYy", "diffSide": "RIGHT", "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/site/DefaultSiteViewImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMToyN1rOG4RDQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMToyN1rOG4RDQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY1MjgwMQ==", "bodyText": "This can be reduced to one line:\nrenderContextMap.put(\"themeSwitcher\", serverConfigurationService.getBoolean(\"portal.themeswitcher\", true));", "url": "https://github.com/sakaiproject/sakai/pull/8402#discussion_r461652801", "createdAt": "2020-07-28T15:01:27Z", "author": {"login": "bjones86"}, "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/site/DefaultSiteViewImpl.java", "diffHunk": "@@ -164,6 +164,11 @@ public Object getRenderContextObject()\n \t\t} else {\n \t\t\trenderContextMap.put(\"tutorial\", false);\n \t\t}\n+\t\tif (serverConfigurationService.getBoolean(\"portal.themeswitcher\", true)) {\n+\t\t\trenderContextMap.put(\"themeSwitcher\", true);\n+\t\t} else {\n+\t\t\trenderContextMap.put(\"themeSwitcher\", false);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d8928eabea92bc82909b09daf552505a8ce74c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MjA3ODg0OnYy", "diffSide": "RIGHT", "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/site/MoreSiteViewImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMjowMlrOG4REzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTowMjowMlrOG4REzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY1MzE5Nw==", "bodyText": "Same here, one line:\nrenderContextMap.put(\"themeSwitcher\", serverConfigurationService.getBoolean(\"portal.themeswitcher\", true));", "url": "https://github.com/sakaiproject/sakai/pull/8402#discussion_r461653197", "createdAt": "2020-07-28T15:02:02Z", "author": {"login": "bjones86"}, "path": "portal/portal-impl/impl/src/java/org/sakaiproject/portal/charon/site/MoreSiteViewImpl.java", "diffHunk": "@@ -181,6 +181,11 @@ public Object getRenderContextObject()\n \t\t} else {\n \t\t\trenderContextMap.put(\"tutorial\", false);\n \t\t}\n+\t\tif (serverConfigurationService.getBoolean(\"portal.themeswitcher\", true)) {\n+\t\t\trenderContextMap.put(\"themeSwitcher\", true);\n+\t\t} else {\n+\t\t\trenderContextMap.put(\"themeSwitcher\", false);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d8928eabea92bc82909b09daf552505a8ce74c"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2799, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}