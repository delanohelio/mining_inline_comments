{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMTA1NzIw", "number": 7754, "title": "SAK-40813 Assignment extension feature", "bodyText": "Allows for an instructor to give a student that has NOT submitted yet a new accept until date that will override the assignment setting. This grants a first submission to a student that missed it the first time. After the first submission, the resubmission feature takes over in its unaltered form.", "createdAt": "2020-01-09T18:50:45Z", "url": "https://github.com/sakaiproject/sakai/pull/7754", "merged": true, "mergeCommit": {"oid": "9630795cc68f1cca975e8f06079d4db1a0ca10da"}, "closed": true, "closedAt": "2021-10-04T15:10:33Z", "author": {"login": "davidpbauer"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4ulGvgFqTM0MDc0MDI0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABfDdlfvgBqjUzODg3MzQzMzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNzQwMjQ3", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-340740247", "createdAt": "2020-01-09T18:50:50Z", "commit": {"oid": "2f9db210721b8708d5b0c2113129d11960584518"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxODo1MDo1MVrOFb__rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxODo1MDo1MVrOFb__rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkwNDM2Ng==", "bodyText": "Looks like there's a label missing for this input. That makes it hard for people using screen readers or voice control to use the input.", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r364904366", "createdAt": "2020-01-09T18:50:51Z", "author": {"login": "accesslint"}, "path": "assignment/tool/src/webapp/vm/assignment/chef_assignments_instructor_grading_submission.vm", "diffHunk": "@@ -680,7 +680,55 @@\n             #else\n                 #set($resubmitStyle=\"display:none\")\n             #end\n-            <div class=\"form-group\" id=\"tempAllowRes\" #if ($submissionType == 4) style=\"display:none\"#end>\n+  ##decide whether to show the Extension options\n+            #if($!displayExtensionOptions && $submissionType != 4)\n+                #set($extensionStyle=\"display:block\")\n+                #set($resubmitVisibility=\"display:none\")\n+            #else\n+                #set($extensionStyle=\"display:none\")\n+                #if($submissionType != 4)\n+                    #set($resubmitVisibility=\"display:block\")\n+                #else\n+                    #set($resubmitVisibility=\"display:none\")\n+                #end\n+            #end\n+\n+            <div class=\"form-group\" id=\"allowExtensionForm\" style=\"$extensionStyle\">\n+                <input type=\"checkbox\" id=\"allowExtensionToggle\" name=\"allowExtensionToggle\"\n+                    #if($extensionCloseTime && $submissionType != 4)\n+                       checked=\"checked\"\n+                    #end\n+                    onclick=\"if(checked){document.getElementById('allowExtensionTime').style.display = 'block';ASN.resizeFrame();}else{document.getElementById('allowExtensionTime').style.display = 'none';}\"\n+                />\n+                <label for=\"allowExtensionToggle\" >$tlang.getString(\"allowExtension\")</label>\n+                <label class=\"text-warning\" >$tlang.getString(\"allowExtensionCaption\")</label>\n+                <div id=\"allowExtensionTime\"\n+                    #if($extensionCloseTime && $submissionType != 4)\n+                        style=\"display: block\"\n+                    #else\n+                        style=\"display: none\"\n+                    #end\n+                >\n+                    <label >$tlang.getString(\"gen.acesubunt\")</label>\n+                    <input type=\"text\" id=\"allowExtensionDate\" name=\"allowExtensionDate\" class=\"datepicker\" value=\"\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f9db210721b8708d5b0c2113129d11960584518"}, "originalPosition": 35}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f9db210721b8708d5b0c2113129d11960584518", "author": {"user": {"login": "davidpbauer", "name": "David P. Bauer"}}, "url": "https://github.com/sakaiproject/sakai/commit/2f9db210721b8708d5b0c2113129d11960584518", "committedDate": "2020-01-09T18:45:10Z", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21."}, "afterCommit": {"oid": "22fdcdc735581888bef494a2ab278e452b512453", "author": {"user": {"login": "davidpbauer", "name": "David P. Bauer"}}, "url": "https://github.com/sakaiproject/sakai/commit/22fdcdc735581888bef494a2ab278e452b512453", "committedDate": "2020-01-09T19:09:29Z", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNzUwODY3", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-340750867", "createdAt": "2020-01-09T19:09:54Z", "commit": {"oid": "22fdcdc735581888bef494a2ab278e452b512453"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNDEyNDQ1", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-380412445", "createdAt": "2020-03-24T15:16:34Z", "commit": {"oid": "22fdcdc735581888bef494a2ab278e452b512453"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNToxNjozNFrOF61MuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxNToxNjozNFrOF61MuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIzMzMzNw==", "bodyText": "Is it possible to add the AssignmentConstants.ALLOW_EXTENSION_CLOSETIME as a parameter vs adding to the session state?\nWere try avoid adding anything new to the session state, as it's a bad pattern.", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r397233337", "createdAt": "2020-03-24T15:16:34Z", "author": {"login": "ern"}, "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentAction.java", "diffHunk": "@@ -13366,6 +13426,34 @@ public void doModel_answer(RunData data) {\n         }\n     }\n \n+    private void assignment_extension_option_into_context(Context context, SessionState state){\n+        String allowExtensionTimeString = null;\n+        if (state.getAttribute(AssignmentConstants.ALLOW_EXTENSION_CLOSETIME) != null){\n+            allowExtensionTimeString = (String) state.getAttribute(AssignmentConstants.ALLOW_EXTENSION_CLOSETIME);\n+            Instant extensionCloseTime = Instant.ofEpochMilli(Long.parseLong(allowExtensionTimeString));\n+            context.put(\"extensionCloseTime\", assignmentService.getUsersLocalDateTimeString(extensionCloseTime));\n+        }\n+        putTimePropertiesInContext(context, state, \"Extension\", ALLOW_EXTENSION_CLOSEMONTH, ALLOW_EXTENSION_CLOSEDAY, ALLOW_EXTENSION_CLOSEYEAR, ALLOW_EXTENSION_CLOSEHOUR, ALLOW_EXTENSION_CLOSEMIN);\n+    }\n+\n+    private void assignment_extension_option_into_state(Assignment a, AssignmentSubmission s, SessionState state){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22fdcdc735581888bef494a2ab278e452b512453"}, "originalPosition": 217}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "22fdcdc735581888bef494a2ab278e452b512453", "author": {"user": {"login": "davidpbauer", "name": "David P. Bauer"}}, "url": "https://github.com/sakaiproject/sakai/commit/22fdcdc735581888bef494a2ab278e452b512453", "committedDate": "2020-01-09T19:09:29Z", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21."}, "afterCommit": {"oid": "d1ff349ead3644d180a1911b872c4d4a8b5634d9", "author": {"user": {"login": "davidpbauer", "name": "David P. Bauer"}}, "url": "https://github.com/sakaiproject/sakai/commit/d1ff349ead3644d180a1911b872c4d4a8b5634d9", "committedDate": "2020-09-23T10:52:32Z", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTQ4MDgx", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-494548081", "createdAt": "2020-09-23T11:12:32Z", "commit": {"oid": "d1ff349ead3644d180a1911b872c4d4a8b5634d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d1ff349ead3644d180a1911b872c4d4a8b5634d9", "author": {"user": {"login": "davidpbauer", "name": "David P. Bauer"}}, "url": "https://github.com/sakaiproject/sakai/commit/d1ff349ead3644d180a1911b872c4d4a8b5634d9", "committedDate": "2020-09-23T10:52:32Z", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21."}, "afterCommit": {"oid": "2636206803672be2240c796f8a298ccf834f2b8d", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/2636206803672be2240c796f8a298ccf834f2b8d", "committedDate": "2020-09-23T11:12:45Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTQ5Njk5", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-494549699", "createdAt": "2020-09-23T11:14:52Z", "commit": {"oid": "2636206803672be2240c796f8a298ccf834f2b8d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "PRR_kwDOAbQ-jc4ttJ2K", "url": "https://github.com/sakaiproject/sakai/pull/7754#pullrequestreview-766811530", "createdAt": "2021-09-29T14:53:13Z", "commit": {"oid": "2636206803672be2240c796f8a298ccf834f2b8d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2636206803672be2240c796f8a298ccf834f2b8d", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/2636206803672be2240c796f8a298ccf834f2b8d", "committedDate": "2020-09-23T11:12:45Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}, "afterCommit": {"oid": "04cf375655e5c005a34052778311d0627367f779", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/04cf375655e5c005a34052778311d0627367f779", "committedDate": "2021-09-29T15:05:24Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b31383767c9e789610f113fdc60786cd4ec91888", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/b31383767c9e789610f113fdc60786cd4ec91888", "committedDate": "2021-09-30T15:49:25Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "04cf375655e5c005a34052778311d0627367f779", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/04cf375655e5c005a34052778311d0627367f779", "committedDate": "2021-09-29T15:05:24Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}, "afterCommit": {"oid": "b31383767c9e789610f113fdc60786cd4ec91888", "author": {"user": {"login": "jkozar2", "name": null}}, "url": "https://github.com/sakaiproject/sakai/commit/b31383767c9e789610f113fdc60786cd4ec91888", "committedDate": "2021-09-30T15:49:25Z", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1903, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}