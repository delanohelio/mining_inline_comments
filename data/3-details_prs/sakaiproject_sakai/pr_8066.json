{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyOTIxMDQw", "number": 8066, "title": "SAK-43357 allow rubrics component to save evaluations", "bodyText": "https://jira.sakaiproject.org/browse/SAK-43357", "createdAt": "2020-03-24T11:01:20Z", "url": "https://github.com/sakaiproject/sakai/pull/8066", "merged": true, "mergeCommit": {"oid": "544e4c94193954132bf7d2036435c3d8d6210462"}, "closed": true, "closedAt": "2020-03-24T15:06:06Z", "author": {"login": "adrianfish"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQwcSugH2gAyMzkyOTIxMDQwOmFjZTY2YTBmMTVlNTRlNmIwM2ZmNGQ3NmUzYmFjOTEwNDlmYWYzODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQzstmAFqTM4MDM1ODExOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ace66a0f15e54e6b03ff4d76e3bac91049faf381", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/ace66a0f15e54e6b03ff4d76e3bac91049faf381", "committedDate": "2020-03-24T10:35:13Z", "message": "SAK-43357 allow rubrics component to save evaluations\n\nhttps://jira.sakaiproject.org/browse/SAK-43357"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMjAxMTQz", "url": "https://github.com/sakaiproject/sakai/pull/8066#pullrequestreview-380201143", "createdAt": "2020-03-24T11:01:28Z", "commit": {"oid": "ace66a0f15e54e6b03ff4d76e3bac91049faf381"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMTowMToyOFrOF6rDVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMTowMToyOFrOF6rDVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzA2NzA5NQ==", "bodyText": "Looks like there's a label missing for this input. That makes it hard for people using screen readers or voice control to use the input.", "url": "https://github.com/sakaiproject/sakai/pull/8066#discussion_r397067095", "createdAt": "2020-03-24T11:01:28Z", "author": {"login": "accesslint"}, "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -41,73 +57,301 @@ export class SakaiRubricGrading extends RubricsElement {\n     }\n   }\n \n-  shouldUpdate(changedProperties) {\n-    return this.i18nLoaded && changedProperties.has(\"rubric\");\n-  }\n-\n   render() {\n \n     return html`\n       <h3 style=\"margin-bottom: 10px;\">${this.rubric.title}</h3>\n+      <div class=\"criterion grading style-scope sakai-rubric-criteria-grading\" style=\"margin-bottom: 10px;\">\n+      ${this.criteria.map(c => html`\n+        <div id=\"criterion_row_${c.id}\" class=\"criterion-row\">\n+          <div class=\"criterion-detail\">\n+            <h4 class=\"criterion-title\">${c.title}</h4>\n+            <p>${c.description}</p>\n+          </div>\n+          <div class=\"criterion-ratings\" style=\"margin-bottom: 15px !important;\">\n+            <div class=\"cr-table\">\n+              <div class=\"cr-table-row\">\n+              ${c.ratings.map(r => html`\n+                <div class=\"rating-item ${this.selectedRatings.includes(r.id) ? \"selected\" : \"\"}\" data-rating-id=\"${r.id}\" id=\"rating-item-${r.id}\" data-criterion-id=\"${c.id}\" @click=\"${this.toggleRating}\">\n+                  <h5 class=\"criterion-item-title\">${r.title}</h5>\n+                  <p>${r.description}</p>\n+                  <span class=\"points\" data-points=\"${r.points}\">${r.points.toLocaleString(this.locale)} <sr-lang key=\"points\">Points</sr-lang></span>\n+                </div>\n+              `)}\n+              </div>\n+            </div>\n+          </div>\n+          <div class=\"criterion-actions\">\n+            <sakai-rubric-grading-comment id=\"comment-for-${c.id}\" @comment-shown=${this.commentShown} @update-comment=\"${this.updateComment}\" criterion=\"${JSON.stringify(c)}\" evaluated-item-id=\"${this.evaluatedItemId}\" entity-id=\"${this.entityId}\"></sakai-rubric-grading-comment>\n+            <div>\n+              <strong id=\"points-display-${c.id}\" class=\"points-display ${this.getOverriddenClass(c.pointoverride, c.selectedvalue)}\">\n+                ${c.selectedvalue}\n+              </strong>\n+            </div>\n+            ${this.association.parameters.fineTunePoints ? html`\n+                <input type=\"number\" step=\"0.01\" min=\"0\" max=\"${ifDefined(c.pointrange ? c.pointrange.high : undefined)}\"\n+                    title=\"${tr(\"point_override_details\")}\"\n+                    data-criterion-id=\"${c.id}\"\n+                    name=\"rbcs-${this.evaluatedItemId}-${this.entityId}-criterion-override-${c.id}\"\n+                    class=\"fine-tune-points form-control hide-input-arrows\"\n+                    @input=${this.fineTuneRating}\n+                    .value=\"${c.pointoverride}\"\n+                />\n+              ` : \"\"}\n+            <input aria-labelledby=\"${tr(\"points\")}\" type=\"hidden\" id=\"rbcs-${this.evaluatedItemId}-${this.entityId}-criterion-${c.id}\" name=\"rbcs-${this.evaluatedItemId}-${this.entityId}-criterion-${c.id}\" .value=\"${c.selectedvalue}\">\n+            <input type=\"hidden\" name=\"rbcs-${this.evaluatedItemId}-${this.entityId}-criterionrating-${c.id}\" .value=\"${c.selectedRatingId}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ace66a0f15e54e6b03ff4d76e3bac91049faf381"}, "originalPosition": 121}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMzU4MTE5", "url": "https://github.com/sakaiproject/sakai/pull/8066#pullrequestreview-380358119", "createdAt": "2020-03-24T14:22:52Z", "commit": {"oid": "ace66a0f15e54e6b03ff4d76e3bac91049faf381"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2115, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}