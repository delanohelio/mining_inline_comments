{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNjUxMzky", "number": 7875, "title": "SAK-43118 Remove timezone from signup meeting dates.", "bodyText": "https://jira.sakaiproject.org/browse/SAK-43118", "createdAt": "2020-02-11T13:13:49Z", "url": "https://github.com/sakaiproject/sakai/pull/7875", "merged": true, "mergeCommit": {"oid": "0490997f989c53683f122b365d5a8b9bc3786b47"}, "closed": true, "closedAt": "2020-02-12T13:36:11Z", "author": {"login": "adrianfish"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDSSKVgFqTM1NjY4MTIzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDmcfZAFqTM1NzQ1Mzg3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NjgxMjM2", "url": "https://github.com/sakaiproject/sakai/pull/7875#pullrequestreview-356681236", "createdAt": "2020-02-11T14:05:59Z", "commit": {"oid": "338a04fef82489784cee170fef5ba6215e3375e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNDowNTo1OVrOFoKKVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNDowNTo1OVrOFoKKVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY1Mzg0NQ==", "bodyText": "a custom format doesn't seem right to me...... why doesn't the DateFormat above work?", "url": "https://github.com/sakaiproject/sakai/pull/7875#discussion_r377653845", "createdAt": "2020-02-11T14:05:59Z", "author": {"login": "ottenhoff"}, "path": "signup/tool/src/java/org/sakaiproject/signup/tool/jsf/UserLocale.java", "diffHunk": "@@ -34,39 +39,49 @@\n  * @author Peter Liu\n  */\n \n+@Slf4j\n public class UserLocale {\n \n \tprivate ResourceLoader rb = new ResourceLoader(\"messages\");\n-\tprivate SakaiFacade sakaiFacade;\n+\n+\t@Getter @Setter private SakaiFacade sakaiFacade;\n \n \tpublic String getLocale() {\n \t\treturn (String) this.rb.getLocale().toString();\n \t}\n-\n-\tpublic SakaiFacade getSakaiFacade() {\n-\t\treturn sakaiFacade;\n-\t}\n-\n-\tpublic void setSakaiFacade(SakaiFacade sakaiFacade) {\n-\t\tthis.sakaiFacade = sakaiFacade;\n-\t}\n \t\n \t/**\n \t * Get the date format from the locale\n \t * @return\n \t */\n \tpublic String getDateFormat() {\n-\t\tDateFormat df = DateFormat.getDateInstance(DateFormat.SHORT, (new ResourceLoader()).getLocale());\n-\t\treturn ((SimpleDateFormat)df).toPattern();\n+\n+\t\tLocale locale = new ResourceLoader().getLocale();\n+\t\tDateFormat df = DateFormat.getDateInstance(DateFormat.SHORT, locale);\n+\t\ttry {\n+\t\t\treturn ((SimpleDateFormat)df).toPattern();\n+\t\t} catch (ClassCastException cce) {\n+\t\t\tlog.warn(\"Failed to cast DateFormat into SimpleDateFormat for locale {}\", locale.toString());\n+\t\t\treturn new SimpleDateFormat().toPattern();\n+\t\t}\n \t}\n \n \t/**\n-\t * Get the date format from the locale with short timezone at end\n+\t * Get the date format from the locale\n \t * @return String representing a SimpleDateFormat for use with JSF convertDateTime\n \t */\n \tpublic String getFullDateTimeFormat() {\n-\t\tDateFormat df = DateFormat.getDateTimeInstance(DateFormat.LONG, DateFormat.LONG, this.rb.getLocale());\n-\t\treturn ((SimpleDateFormat)df).toPattern();\n+\n+\t\tLocale locale = this.rb.getLocale();\n+\t\tDateFormat df = DateFormat.getDateTimeInstance(DateFormat.LONG, DateFormat.SHORT, locale);\n+\t\ttry {\n+\t\t\tSimpleDateFormat sdf = (SimpleDateFormat) df;\n+\t\t\tsdf.applyLocalizedPattern(\"MMMM d, yyyy h:mm a\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "338a04fef82489784cee170fef5ba6215e3375e5"}, "originalPosition": 72}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "812e7af3ff7a03ad96355ac130746527e1c86493", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/812e7af3ff7a03ad96355ac130746527e1c86493", "committedDate": "2020-02-12T10:20:53Z", "message": "SAK-43118 Remove timezone from signup meeting dates.\n\nhttps://jira.sakaiproject.org/browse/SAK-43118"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "338a04fef82489784cee170fef5ba6215e3375e5", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/338a04fef82489784cee170fef5ba6215e3375e5", "committedDate": "2020-02-11T13:12:56Z", "message": "SAK-43118 Remove timezone from signup meeting dates.\n\nhttps://jira.sakaiproject.org/browse/SAK-43118"}, "afterCommit": {"oid": "812e7af3ff7a03ad96355ac130746527e1c86493", "author": {"user": {"login": "adrianfish", "name": "Adrian Fish"}}, "url": "https://github.com/sakaiproject/sakai/commit/812e7af3ff7a03ad96355ac130746527e1c86493", "committedDate": "2020-02-12T10:20:53Z", "message": "SAK-43118 Remove timezone from signup meeting dates.\n\nhttps://jira.sakaiproject.org/browse/SAK-43118"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDUzODc2", "url": "https://github.com/sakaiproject/sakai/pull/7875#pullrequestreview-357453876", "createdAt": "2020-02-12T13:35:22Z", "commit": {"oid": "812e7af3ff7a03ad96355ac130746527e1c86493"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2329, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}