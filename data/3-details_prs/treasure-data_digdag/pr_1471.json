{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNDQ3NDEw", "number": 1471, "title": "Enhance command executor logging", "bodyText": "Add getErrorMessage() in CommandStatus SPI to enhance error handling of CommandExecutor.\nImplemented it in EcsCommandExecutor and py> operator.", "createdAt": "2020-10-27T03:52:11Z", "url": "https://github.com/treasure-data/digdag/pull/1471", "merged": true, "mergeCommit": {"oid": "217444574713f0726c9a30fa7d85e45303bb619b"}, "closed": true, "closedAt": "2020-11-11T07:05:16Z", "author": {"login": "yoyama"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXd6pgABqjM5MzkyNzY3NzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZwJDAABqjM5NjU1OTMwMjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "181bade9b5ab860ebf3c27df7fee96afc7f6970f", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/181bade9b5ab860ebf3c27df7fee96afc7f6970f", "committedDate": "2020-10-30T03:06:47Z", "message": "Modify getErrorReason(), add tests."}, "afterCommit": {"oid": "b619d2f1ce13a6c63869c45b914c893ae36ae4a1", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/b619d2f1ce13a6c63869c45b914c893ae36ae4a1", "committedDate": "2020-10-30T03:08:28Z", "message": "Modify getErrorReason(), add tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMzk0ODQz", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-520394843", "createdAt": "2020-10-30T06:02:35Z", "commit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNjowMjozNlrOHrCQYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNjoxOToxNFrOHrChxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDg4Nzc3Ng==", "bodyText": "ECS task always uses only 1 container?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514887776", "createdAt": "2020-10-30T06:02:36Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/main/java/io/digdag/standards/command/EcsCommandExecutor.java", "diffHunk": "@@ -386,6 +388,29 @@ else if (defaultCommandTaskTTL.isPresent() && isRunningLongerThanTTL(previousSta\n         return EcsCommandStatus.of(false, nextStatus);\n     }\n \n+    @VisibleForTesting\n+    static Optional<String> getErrorMessageFromTask(String cluster, String taskArn, EcsClient client)\n+    {\n+        Optional<String> errorMessage;\n+        try {\n+            final Task task = client.getTask(cluster, taskArn);\n+            if (task.getContainers().size() > 0) {\n+                errorMessage = Optional.of(task.getContainers().get(0).getReason());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDg4OTIzMw==", "bodyText": "Maybe this RuntimeException doesn't contain the root cause of the task failure. We need to catch RuntimeException here?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514889233", "createdAt": "2020-10-30T06:08:26Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/main/java/io/digdag/standards/command/EcsCommandExecutor.java", "diffHunk": "@@ -386,6 +388,29 @@ else if (defaultCommandTaskTTL.isPresent() && isRunningLongerThanTTL(previousSta\n         return EcsCommandStatus.of(false, nextStatus);\n     }\n \n+    @VisibleForTesting\n+    static Optional<String> getErrorMessageFromTask(String cluster, String taskArn, EcsClient client)\n+    {\n+        Optional<String> errorMessage;\n+        try {\n+            final Task task = client.getTask(cluster, taskArn);\n+            if (task.getContainers().size() > 0) {\n+                errorMessage = Optional.of(task.getContainers().get(0).getReason());\n+            }\n+            else {\n+                errorMessage = Optional.of(\"No container information\");\n+            }\n+        }\n+        catch (TaskSetNotFoundException e) {\n+            errorMessage = Optional.of(e.getErrorMessage());\n+\n+        }\n+        catch (RuntimeException re) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDg5MjIzMA==", "bodyText": "Is it okay if RuntimeException is finally handled as an unexpected exception?\nhttps://github.com/treasure-data/digdag/blob/v0_10/digdag-core/src/main/java/io/digdag/core/agent/OperatorManager.java#L174-L176\nMaybe TaskExecutionException is better?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514892230", "createdAt": "2020-10-30T06:19:14Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/main/java/io/digdag/standards/operator/PyOperatorFactory.java", "diffHunk": "@@ -149,38 +149,19 @@ private Config runCode(final Config state)\n                     // Remove the polling state after fetching the result so that the result fetch can be retried\n                     // without resubmitting the code.\n                     state.remove(\"commandStatus\");\n-\n-                    StringBuilder reason = new StringBuilder();\n-                    reason.append(\"Python command failed with code \").append(statusCode);\n-                    // If the error message and stacktrace are available in outFile,\n-                    // throw RuntimeException with them.\n+                    String reason = getErrorReason(status, commandContext);\n+                    throw new RuntimeException(reason);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNDExOTMy", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-520411932", "createdAt": "2020-10-30T06:53:30Z", "commit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNjo1MzozMFrOHrDHpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNzowMDoxOVrOHrDPbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkwMTkyNg==", "bodyText": "Better to add a new line at the end of this file?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514901926", "createdAt": "2020-10-30T06:53:30Z", "author": {"login": "szyn"}, "path": "digdag-standards/src/test/resources/io/digdag/standards/operator/py/output.json", "diffHunk": "@@ -0,0 +1 @@\n+{\"subtask_config\": {}, \"export_params\": {}, \"store_params\": {}, \"error\": {\"class\": \"NameError\", \"message\": \"name 'printaa' is not defined\", \"backtrace\": [\"Traceback (most recent call last):\\n\", \"  File \\\"./runner.py\\\", line 168, in <module>\\n    result = callable_type(**args)\\n\", \"  File \\\"/Users/you.yamagata/cs_work/CS-5411-py-tokenize/test1.py\\\", line 4, in func1\\n    printaa(\\\"func1 called\\\")\\n\", \"NameError: name 'printaa' is not defined\\n\"]}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkwMzkxNw==", "bodyText": "This file includes your local file path info, how about updating a more general one here?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514903917", "createdAt": "2020-10-30T07:00:19Z", "author": {"login": "szyn"}, "path": "digdag-standards/src/test/resources/io/digdag/standards/operator/py/output.json", "diffHunk": "@@ -0,0 +1 @@\n+{\"subtask_config\": {}, \"export_params\": {}, \"store_params\": {}, \"error\": {\"class\": \"NameError\", \"message\": \"name 'printaa' is not defined\", \"backtrace\": [\"Traceback (most recent call last):\\n\", \"  File \\\"./runner.py\\\", line 168, in <module>\\n    result = callable_type(**args)\\n\", \"  File \\\"/Users/you.yamagata/cs_work/CS-5411-py-tokenize/test1.py\\\", line 4, in func1\\n    printaa(\\\"func1 called\\\")\\n\", \"NameError: name 'printaa' is not defined\\n\"]}}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkwMTkyNg=="}, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNDIyNTY5", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-520422569", "createdAt": "2020-10-30T07:20:38Z", "commit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNzoyMDozOFrOHrDobw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNzoyMDozOFrOHrDobw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkxMDMxOQ==", "bodyText": "This {  should be put in next line", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514910319", "createdAt": "2020-10-30T07:20:38Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/test/java/io/digdag/standards/operator/PyOperatorFactoryTest.java", "diffHunk": "@@ -0,0 +1,80 @@\n+package io.digdag.standards.operator;\n+\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.google.common.base.Optional;\n+import com.google.common.io.Resources;\n+import io.digdag.client.DigdagClient;\n+import io.digdag.client.config.Config;\n+import io.digdag.client.config.ConfigFactory;\n+import io.digdag.spi.CommandContext;\n+import io.digdag.spi.CommandExecutor;\n+import io.digdag.spi.CommandStatus;\n+import io.digdag.spi.OperatorContext;\n+import io.digdag.spi.TaskRequest;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+\n+import static java.nio.charset.StandardCharsets.UTF_8;\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.is;\n+import static org.junit.Assert.assertThat;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.mock;\n+import io.digdag.standards.operator.PyOperatorFactory.PyOperator;\n+\n+public class PyOperatorFactoryTest\n+{\n+\t@Rule\n+\tpublic TemporaryFolder folder = new TemporaryFolder();\n+\n+\tprivate Path tempPath;\n+\tprivate PyOperatorFactory factory;\n+\tprivate Config config;\n+\tprivate ObjectMapper objectMapper = DigdagClient.objectMapper();\n+\tprivate CommandExecutor exec;\n+\tprivate OperatorContext operatorContext;\n+\tprivate TaskRequest taskRequest;\n+\n+\t@Before\n+\tpublic void setUp()\n+\t{\n+\t\ttempPath = folder.getRoot().toPath();\n+\n+\t\texec = mock(CommandExecutor.class);\n+\t\tfactory = new PyOperatorFactory(exec, objectMapper);\n+\t\tconfig = new ConfigFactory(objectMapper).create();\n+\t\toperatorContext = mock(OperatorContext.class);\n+\t\ttaskRequest = mock(TaskRequest.class);\n+\t\tdoReturn(tempPath).when(operatorContext).getProjectPath();\n+\t\tdoReturn(taskRequest).when(operatorContext).getTaskRequest();\n+\t\tdoReturn(config).when(taskRequest).getConfig();\n+\t}\n+\n+\t@Test\n+\tpublic void testGetErrorReason() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNDI4OTc1", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-520428975", "createdAt": "2020-10-30T07:34:08Z", "commit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNzozNDowOFrOHrD7WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwNzozNDowOFrOHrD7WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkxNTE2MA==", "bodyText": "This is because the CI sometimes failed in this test.", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r514915160", "createdAt": "2020-10-30T07:34:08Z", "author": {"login": "yoyama"}, "path": "digdag-tests/src/test/java/acceptance/DockerIT.java", "diffHunk": "@@ -184,7 +184,7 @@ public void verifyPyOnDocker()\n         // Wait for the attempt to complete\n         {\n             RestSessionAttempt attempt = null;\n-            for (int i = 0; i < 30; i++) {\n+            for (int i = 0; i < 60; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0bd01ec01f22a1fdb1222ef818e706f3d829a614", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/0bd01ec01f22a1fdb1222ef818e706f3d829a614", "committedDate": "2020-11-04T02:44:49Z", "message": "Fix NPE when getting errorMessage in TaskSetNotFoundException"}, "afterCommit": {"oid": "da3ad72b8ed5c23d71e67df5bc2abe219f61d18d", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/da3ad72b8ed5c23d71e67df5bc2abe219f61d18d", "committedDate": "2020-11-04T02:46:28Z", "message": "Fix NPE when getting errorMessage in TaskSetNotFoundException"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDk0NDY3", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-524094467", "createdAt": "2020-11-05T09:54:51Z", "commit": {"oid": "774764bb33c265eb4676fb066fa9db032b7aee7b"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOTo1NDo1MVrOHt7kKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMDowOTo0MlrOHt8JcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkyMzg4MQ==", "bodyText": "Maybe this line should be separated into multiple lines?", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r517923881", "createdAt": "2020-11-05T09:54:51Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/main/java/io/digdag/standards/command/EcsCommandExecutor.java", "diffHunk": "@@ -386,6 +389,27 @@ else if (defaultCommandTaskTTL.isPresent() && isRunningLongerThanTTL(previousSta\n         return EcsCommandStatus.of(false, nextStatus);\n     }\n \n+    @VisibleForTesting\n+    static Optional<String> getErrorMessageFromTask(String cluster, String taskArn, EcsClient client)\n+    {\n+        Optional<String> errorMessage = Optional.absent();\n+        try {\n+            final Task task = client.getTask(cluster, taskArn);\n+            final List<String> reasons = task.getContainers().stream().map(c -> c.getReason()).filter(r -> !Strings.isNullOrEmpty(r)).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "774764bb33c265eb4676fb066fa9db032b7aee7b"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkzMjE5MA==", "bodyText": "I see. Throwing the same exception sounds reasonable.\n@muga Just out of curiosity, was there any specific reason to use RuntimeException not TaskExecutionException? https://github.com/treasure-data/digdag/blame/85fd6bdcec06a362f1b16d8de2284168c4e35619/digdag-standards/src/main/java/io/digdag/standards/operator/PyOperatorFactory.java#L149", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r517932190", "createdAt": "2020-11-05T10:07:45Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/main/java/io/digdag/standards/operator/PyOperatorFactory.java", "diffHunk": "@@ -149,38 +149,19 @@ private Config runCode(final Config state)\n                     // Remove the polling state after fetching the result so that the result fetch can be retried\n                     // without resubmitting the code.\n                     state.remove(\"commandStatus\");\n-\n-                    StringBuilder reason = new StringBuilder();\n-                    reason.append(\"Python command failed with code \").append(statusCode);\n-                    // If the error message and stacktrace are available in outFile,\n-                    // throw RuntimeException with them.\n+                    String reason = getErrorReason(status, commandContext);\n+                    throw new RuntimeException(reason);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDg5MjIzMA=="}, "originalCommit": {"oid": "cb17e61dea5da93a9bd21b3ffd8f91be971a3ec5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkzMzQyNA==", "bodyText": "\ud83d\udcaf", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r517933424", "createdAt": "2020-11-05T10:09:42Z", "author": {"login": "komamitsu"}, "path": "digdag-standards/src/test/java/io/digdag/standards/command/EcsCommandExecutorTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package io.digdag.standards.command;\n+\n+import com.amazonaws.services.ecs.model.Container;\n+import com.amazonaws.services.ecs.model.Task;\n+import com.amazonaws.services.ecs.model.TaskSetNotFoundException;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.google.common.base.Optional;\n+import io.digdag.client.config.Config;\n+import io.digdag.client.config.ConfigFactory;\n+import io.digdag.core.archive.ProjectArchiveLoader;\n+import io.digdag.core.storage.StorageManager;\n+import io.digdag.spi.CommandContext;\n+import io.digdag.spi.CommandLogger;\n+import io.digdag.spi.CommandRequest;\n+import io.digdag.spi.CommandStatus;\n+import io.digdag.spi.TaskRequest;\n+import io.digdag.standards.command.ecs.EcsClient;\n+import io.digdag.standards.command.ecs.EcsClientConfig;\n+import io.digdag.standards.command.ecs.EcsClientFactory;\n+import io.digdag.standards.command.EcsCommandExecutor.EcsCommandStatus;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.mockito.runners.MockitoJUnitRunner;\n+\n+import java.util.Arrays;\n+\n+import static org.hamcrest.Matchers.is;\n+import static org.junit.Assert.assertThat;\n+import static org.junit.Assert.fail;\n+import static org.mockito.Mockito.any;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.doThrow;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.when;\n+\n+@RunWith(MockitoJUnitRunner.class)\n+public class EcsCommandExecutorTest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "774764bb33c265eb4676fb066fa9db032b7aee7b"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTEyNDc0", "url": "https://github.com/treasure-data/digdag/pull/1471#pullrequestreview-524112474", "createdAt": "2020-11-05T10:16:45Z", "commit": {"oid": "774764bb33c265eb4676fb066fa9db032b7aee7b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMDoxNjo0NVrOHt8a3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMDoxNjo0NVrOHt8a3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkzNzg4NA==", "bodyText": "[just an idea] Maybe we'd better merge isFinished and statusCode into an Optional<Integer> in the future so that we can avoid unexpectedly using status code when not finished.", "url": "https://github.com/treasure-data/digdag/pull/1471#discussion_r517937884", "createdAt": "2020-11-05T10:16:45Z", "author": {"login": "komamitsu"}, "path": "digdag-spi/src/main/java/io/digdag/spi/CommandStatus.java", "diffHunk": "@@ -13,11 +14,20 @@\n     boolean isFinished();\n \n     /**\n-     * Return exit code of command finished. It7s valid only when isFiished returns true.\n+     * Return exit code of command finished. It is valid only when isFinished returns true.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "774764bb33c265eb4676fb066fa9db032b7aee7b"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fb313a7729ff94ef44494b142f4dca76676f2e3", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/6fb313a7729ff94ef44494b142f4dca76676f2e3", "committedDate": "2020-11-06T05:30:17Z", "message": "Add error message in CommandStatus and implement it in EcsCommandExecutor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b9018bfef1f7757b2cc8408bb6bc9f7cdf6ea2f", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/4b9018bfef1f7757b2cc8408bb6bc9f7cdf6ea2f", "committedDate": "2020-11-06T05:30:17Z", "message": "Add error handling and refactoring."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82818c3f7159057d0fc528bb2b4d4a658da89104", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/82818c3f7159057d0fc528bb2b4d4a658da89104", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix getErrorMessageFromTask()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80ea67cba35355c6fc38337f593f44d2eb6e789b", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/80ea67cba35355c6fc38337f593f44d2eb6e789b", "committedDate": "2020-11-06T05:30:17Z", "message": "Add test cases."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05dc847fb55ee5d08acda05695119ad5863ce3e6", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/05dc847fb55ee5d08acda05695119ad5863ce3e6", "committedDate": "2020-11-06T05:30:17Z", "message": "Increase wait to mitigate CI error."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3d5640315faa88a6e05aecdef5f5a3129a8139a", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/a3d5640315faa88a6e05aecdef5f5a3129a8139a", "committedDate": "2020-11-06T05:30:17Z", "message": "Modify getErrorReason(), add tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "662a1850ad7838828a9b1a2971f57f6e31cf2104", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/662a1850ad7838828a9b1a2971f57f6e31cf2104", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix a test error in PyIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b30e7b23799c5c76fa23f767b300934706c5ac51", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/b30e7b23799c5c76fa23f767b300934706c5ac51", "committedDate": "2020-11-06T05:30:17Z", "message": "Refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e46bb23f7d65c7db687d5d58642eee44bf53f53", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/8e46bb23f7d65c7db687d5d58642eee44bf53f53", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix some issues based on the PR reviews."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31ddf1639a293771b1e9fd87dae738db53d89401", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/31ddf1639a293771b1e9fd87dae738db53d89401", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix an issue on coding style."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60a1b29821e195e3a0e4930e0f851874cc268fd4", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/60a1b29821e195e3a0e4930e0f851874cc268fd4", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix NPE when getting errorMessage in TaskSetNotFoundException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31c55a17e47632bc8ff64f450f795760f5e377a3", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/31c55a17e47632bc8ff64f450f795760f5e377a3", "committedDate": "2020-11-06T05:30:17Z", "message": "Fix null porcessing issue in getErrorMessageFromTask()."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dac754282d3785c210c0adf8d86a2bea5769b9f", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/8dac754282d3785c210c0adf8d86a2bea5769b9f", "committedDate": "2020-11-06T05:30:17Z", "message": "Minor refactoring add ToDo comment for future enhancements."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33c670ace81486f3b09bca8683945a1d2e41ae2a", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/33c670ace81486f3b09bca8683945a1d2e41ae2a", "committedDate": "2020-11-06T00:45:53Z", "message": "Minor refactoring add ToDo comment for future enhancements."}, "afterCommit": {"oid": "8dac754282d3785c210c0adf8d86a2bea5769b9f", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/8dac754282d3785c210c0adf8d86a2bea5769b9f", "committedDate": "2020-11-06T05:30:17Z", "message": "Minor refactoring add ToDo comment for future enhancements."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4068, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}