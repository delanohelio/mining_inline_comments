{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMzc1MTc1", "number": 1484, "title": "Enable to fall back to default configuration to support the common configuration for multiple ECS cluster", "bodyText": "What does this PR change?\nSupport falling back to the default configuration prefix for EcsClientConfig so that users can use the common configuration items for several ECS cluster names.\nBackground\nCurrently, access_key_id and secret_access_key are expected to be stored into systemConfig with the following keys respectively.\n\nagent.command_executor.ecs.#{cluster_name}.access_key_id\nagent.command_executor.ecs.#{cluster_name}.secret_access_key\n\nBut in some use cases (e.g. using multiple clusters), we need to specify same access_key_id and secret_access_key for multiple ECS cluster names.\nThis PR enables it by falling back to default prefix if specified cluster_name does not match to those on systemConfig.\ne.g. When there are the following keys in systemConfig and digdag  user specifies cluster2 as a cluster name,\n\nagent.command_executor.ecs.cluster1.access_key_id\nagent.command_executor.ecs.cluster1.secret_access_key\n\nthe following items will be fetched instead.\n\nagent.command_executor.ecs.__default_config__.access_key_id\nagent.command_executor.ecs.__default_config__.secret_access_key", "createdAt": "2020-11-13T06:17:43Z", "url": "https://github.com/treasure-data/digdag/pull/1484", "merged": true, "mergeCommit": {"oid": "d2652d686ad701cf61506fc99c6c809f9861a166"}, "closed": true, "closedAt": "2020-11-16T06:57:15Z", "author": {"login": "serihiro"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcA66oAH2gAyNTIwMzc1MTc1OjhiMzFiYWJkZjU0MmE1MWVjOWIxZjU1MGE4YzkxMmNkNjRlMzMxYjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdc-OMeAFqTUzMDkyODM2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8b31babdf542a51ec9b1f550a8c912cd64e331b8", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/8b31babdf542a51ec9b1f550a8c912cd64e331b8", "committedDate": "2020-11-13T06:11:28Z", "message": "Enable to fall back to default config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e686a2d3ec52cf3efdf29ea21659dd638432497f", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/e686a2d3ec52cf3efdf29ea21659dd638432497f", "committedDate": "2020-11-13T06:11:28Z", "message": "Add test cases for EcsClientConfig"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f495b227115eef99622568cde4b44eb05ba8acbc", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/f495b227115eef99622568cde4b44eb05ba8acbc", "committedDate": "2020-11-13T06:11:28Z", "message": "Fix key format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "342922c651e6f77de1fa847f302c2ef7f707c28c", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/342922c651e6f77de1fa847f302c2ef7f707c28c", "committedDate": "2020-11-13T06:11:28Z", "message": "Revise comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb35cf213c5afe896f3b385ad1ceb78ff12f6dec", "author": {"user": null}, "url": "https://github.com/treasure-data/digdag/commit/cb35cf213c5afe896f3b385ad1ceb78ff12f6dec", "committedDate": "2020-11-13T06:26:55Z", "message": "Refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5ODMyMDEx", "url": "https://github.com/treasure-data/digdag/pull/1484#pullrequestreview-529832011", "createdAt": "2020-11-13T07:42:30Z", "commit": {"oid": "cb35cf213c5afe896f3b385ad1ceb78ff12f6dec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNzo0MjozMFrOHyhh-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNzo0MjozMFrOHyhh-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjc0MDIxNw==", "bodyText": "Could you explain this change? May be for keeping naming rule.\nIs there any compatibility issue (in our side)?", "url": "https://github.com/treasure-data/digdag/pull/1484#discussion_r522740217", "createdAt": "2020-11-13T07:42:30Z", "author": {"login": "yoyama"}, "path": "digdag-standards/src/main/java/io/digdag/standards/command/ecs/EcsClientConfig.java", "diffHunk": "@@ -109,7 +120,7 @@ private static EcsClientConfig buildEcsClientConfig(String clusterName, Config e\n                 .withCapacityProviderName(ecsConfig.getOptional(\"capacity_provider_name\", String.class))\n                 .withContainerCpu(ecsConfig.getOptional(\"container_cpu\", Integer.class))\n                 .withContainerMemory(ecsConfig.getOptional(\"container_memory\", Integer.class))\n-                .withStartedBy(ecsConfig.getOptional(\"startedBy\", String.class))\n+                .withStartedBy(ecsConfig.getOptional(\"started_by\", String.class))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb35cf213c5afe896f3b385ad1ceb78ff12f6dec"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwOTI4MzY4", "url": "https://github.com/treasure-data/digdag/pull/1484#pullrequestreview-530928368", "createdAt": "2020-11-16T05:36:44Z", "commit": {"oid": "cb35cf213c5afe896f3b385ad1ceb78ff12f6dec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4087, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}