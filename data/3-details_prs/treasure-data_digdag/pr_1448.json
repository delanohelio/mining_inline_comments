{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1MDQwODEz", "number": 1448, "title": "Show error message when tasks failed with config error in WorkflowExecutor", "bodyText": "Follow up of #1413\nSimilar to #950\nCurrently, when an error occurs due to misconfiguration at a subtask, it could silently fail without any messages because of a log with a trace level as follows.\n\n  \n    \n      digdag/digdag-core/src/main/java/io/digdag/core/workflow/WorkflowExecutor.java\n    \n    \n        Lines 1249 to 1252\n      in\n      069ed09\n    \n    \n    \n    \n\n        \n          \n           private boolean taskFailed(TaskControl lockedTask, Config error) \n        \n\n        \n          \n           { \n        \n\n        \n          \n               logger.trace(\"Task failed with error {} with no retry: {}\", \n        \n\n        \n          \n                       error, lockedTask.get()); \n        \n    \n  \n\n\nIt would be better to output the log at the error level in case of such an error. This PR supports to show error messages as well.", "createdAt": "2020-08-28T01:53:14Z", "url": "https://github.com/treasure-data/digdag/pull/1448", "merged": true, "mergeCommit": {"oid": "11a0e76428256751ba55032ec01f580554764aba"}, "closed": true, "closedAt": "2020-09-07T06:12:12Z", "author": {"login": "szyn"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC3AN7AH2gAyNDc1MDQwODEzOmY1ZjRjNmQ1ZmZjOWMzYTYyNzk4ODE2ZmI5NDQwMmI4OTRjYzBmN2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE3tSxgFqTQ4MDU5NTc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f5f4c6d5ffc9c3a62798816fb94402b894cc0f7a", "author": {"user": {"login": "szyn", "name": "Shota Suzuki"}}, "url": "https://github.com/treasure-data/digdag/commit/f5f4c6d5ffc9c3a62798816fb94402b894cc0f7a", "committedDate": "2020-08-27T02:30:06Z", "message": "Show error message when tasks failed with config error in WorkflowExecutor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MzY1OTkw", "url": "https://github.com/treasure-data/digdag/pull/1448#pullrequestreview-478365990", "createdAt": "2020-08-31T07:02:31Z", "commit": {"oid": "f5f4c6d5ffc9c3a62798816fb94402b894cc0f7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwNzowMjozMVrOHJs7Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwNzowMjozMVrOHJs7Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkzNTI4Mw==", "bodyText": "Looks good.\nBut I'm also wondering if we'd better change the log level of \n  \n    \n      digdag/digdag-core/src/main/java/io/digdag/core/workflow/WorkflowExecutor.java\n    \n    \n         Line 1251\n      in\n      cefde0d\n    \n    \n    \n    \n\n        \n          \n           logger.trace(\"Task failed with error {} with no retry: {}\", \n        \n    \n  \n\n to warn or error", "url": "https://github.com/treasure-data/digdag/pull/1448#discussion_r479935283", "createdAt": "2020-08-31T07:02:31Z", "author": {"login": "komamitsu"}, "path": "digdag-core/src/main/java/io/digdag/core/workflow/WorkflowExecutor.java", "diffHunk": "@@ -1330,7 +1330,11 @@ private boolean taskSucceeded(TaskControl lockedTask,\n         }\n         catch (ConfigException ex) {\n             // Subtask config or _check task config has a problem (e.g. more than one operator).\n-            return taskFailed(lockedTask, buildExceptionErrorConfig(ex).toConfig(cf));\n+            Config errorConfig = buildExceptionErrorConfig(ex).toConfig(cf);\n+            logger.error(\"Configuration error at task {}: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f4c6d5ffc9c3a62798816fb94402b894cc0f7a"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNTk1NzU3", "url": "https://github.com/treasure-data/digdag/pull/1448#pullrequestreview-480595757", "createdAt": "2020-09-02T08:27:12Z", "commit": {"oid": "f5f4c6d5ffc9c3a62798816fb94402b894cc0f7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4051, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}