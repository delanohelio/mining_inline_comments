{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNTYyNTI2", "number": 761, "title": "fix(plugins): Refactor PluginSdk to also allow using plugin class", "bodyText": "I thought I could be lazy and just pass Any::class.java to the SdkFactory instead of the extension class, which is not available. This didn't work so hot because the resource loader SDK uses the value to load resources from the class path.\nWith this fix in, it looks like all of our plugins load as-is without modification under V2.", "createdAt": "2020-08-25T23:46:05Z", "url": "https://github.com/spinnaker/kork/pull/761", "merged": true, "mergeCommit": {"oid": "4d8f1f58402501852f152f62b58075373ffe0053"}, "closed": true, "closedAt": "2020-08-26T17:35:08Z", "author": {"login": "robzienert"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCgEE_AFqTQ3NTA1ODUyMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCvSD8gBqjM2OTU4ODI4NDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDU4NTIy", "url": "https://github.com/spinnaker/kork/pull/761#pullrequestreview-475058522", "createdAt": "2020-08-25T23:46:30Z", "commit": {"oid": "3216418cd38fd25073a65e875ed23b0bc5c8d997"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzo0NjozMFrOHGyKDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzo0NjozMFrOHGyKDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njg3NTI3Ng==", "bodyText": "This is the actual fix. Literally everything else is extra.", "url": "https://github.com/spinnaker/kork/pull/761#discussion_r476875276", "createdAt": "2020-08-25T23:46:30Z", "author": {"login": "robzienert"}, "path": "kork-plugins/src/main/kotlin/com/netflix/spinnaker/kork/plugins/v2/context/PluginSdksRegisteringCustomizer.kt", "diffHunk": "@@ -34,7 +34,7 @@ class PluginSdksRegisteringCustomizer(\n   override fun accept(plugin: Plugin, context: ConfigurableApplicationContext) {\n     val sdk = PluginSdksImpl(\n       serviceApplicationContext.getBeansOfType(SdkFactory::class.java).values\n-        .map { it.create(Any::class.java, plugin.wrapper) }\n+        .map { it.create(plugin.javaClass, plugin.wrapper) }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3216418cd38fd25073a65e875ed23b0bc5c8d997"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDU5NDg1", "url": "https://github.com/spinnaker/kork/pull/761#pullrequestreview-475059485", "createdAt": "2020-08-25T23:49:30Z", "commit": {"oid": "3216418cd38fd25073a65e875ed23b0bc5c8d997"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53bfb2ac6bc3df9653dd248ff6cea81432e96724", "author": {"user": {"login": "robzienert", "name": "Rob Zienert"}}, "url": "https://github.com/spinnaker/kork/commit/53bfb2ac6bc3df9653dd248ff6cea81432e96724", "committedDate": "2020-08-26T17:30:13Z", "message": "fix(plugins): Refactor PluginSdk to also allow using plugin class"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3216418cd38fd25073a65e875ed23b0bc5c8d997", "author": {"user": {"login": "robzienert", "name": "Rob Zienert"}}, "url": "https://github.com/spinnaker/kork/commit/3216418cd38fd25073a65e875ed23b0bc5c8d997", "committedDate": "2020-08-25T23:43:37Z", "message": "fix(plugins): Refactor PluginSdk to also allow using plugin class"}, "afterCommit": {"oid": "53bfb2ac6bc3df9653dd248ff6cea81432e96724", "author": {"user": {"login": "robzienert", "name": "Rob Zienert"}}, "url": "https://github.com/spinnaker/kork/commit/53bfb2ac6bc3df9653dd248ff6cea81432e96724", "committedDate": "2020-08-26T17:30:13Z", "message": "fix(plugins): Refactor PluginSdk to also allow using plugin class"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1472, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}