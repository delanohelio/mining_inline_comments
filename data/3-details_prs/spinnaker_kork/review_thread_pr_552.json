{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4NDYwMTQ2", "number": 552, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzowNzoxM1rODoIOtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzoxMDo1OFrODoIPdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDA0NDY4OnYy", "diffSide": "RIGHT", "path": "kork-core/src/main/java/com/netflix/spinnaker/kork/version/ServiceVersion.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzowNzoxM1rOF2gE0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzowNzoxM1rOF2gE0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5Mjk0Ng==", "bodyText": "lol oops \ud83d\udcaf", "url": "https://github.com/spinnaker/kork/pull/552#discussion_r392692946", "createdAt": "2020-03-15T17:07:13Z", "author": {"login": "robzienert"}, "path": "kork-core/src/main/java/com/netflix/spinnaker/kork/version/ServiceVersion.java", "diffHunk": "@@ -62,7 +62,10 @@ public String resolve() {\n         }\n       }\n \n-      resolvedServiceVersion = UNKNOWN_VERSION;\n+      if (resolvedServiceVersion == null || resolvedServiceVersion.isEmpty()) {\n+        log.warn(\"Unable to determine the service version, setting it to unknown\");\n+        resolvedServiceVersion = UNKNOWN_VERSION;\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8e88f2319ac6bd543e12a9d352dbbd0097ece1"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNDA0NjYxOnYy", "diffSide": "RIGHT", "path": "kork-plugins/src/main/kotlin/com/netflix/spinnaker/kork/plugins/update/SpinnakerUpdateManager.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzoxMDo1OFrOF2gF0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzoxMDo1OFrOF2gF0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MzIwMQ==", "bodyText": "nit: Seeing 0.0.0 across two different files. Worth making a const somewhere instead?", "url": "https://github.com/spinnaker/kork/pull/552#discussion_r392693201", "createdAt": "2020-03-15T17:10:58Z", "author": {"login": "robzienert"}, "path": "kork-plugins/src/main/kotlin/com/netflix/spinnaker/kork/plugins/update/SpinnakerUpdateManager.kt", "diffHunk": "@@ -108,8 +108,15 @@ class SpinnakerUpdateManager(\n     val versionManager = SpinnakerServiceVersionManager(serviceName)\n     val lastPluginRelease: MutableMap<String, PluginRelease> = mutableMapOf()\n \n+    // If service version cannot be determined(i.e 0.0.0),\n+    // just check if the release requirement mentions the service to see if the plugin is applicable. This case should\n+    // never happen, we should always know the system version but if it happens we can at least give a matching plugin\n+    // to the service name in question.\n+    //\n+    // If version is determined, check the version constraint explicitly to decide if the plugin is applicable or not.\n     for (release in pluginInfo.releases) {\n-      if (systemVersion == \"0.0.0\" || versionManager.checkVersionConstraint(systemVersion, release.requires)) {\n+      if ((systemVersion == \"0.0.0\" && release.requires.contains(serviceName, ignoreCase = true)) ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf8e88f2319ac6bd543e12a9d352dbbd0097ece1"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3619, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}