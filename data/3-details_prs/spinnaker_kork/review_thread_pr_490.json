{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzMyMjE4", "number": 490, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjozMzo0NlrODbC_aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjozMzo0NlrODbC_aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5Njg3MTQ0OnYy", "diffSide": "RIGHT", "path": "kork-security/src/main/java/com/netflix/spinnaker/security/AuthenticatedRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjozMzo0NlrOFiT0zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjo0MzowNlrOFiUDSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyMDcxOA==", "bodyText": "will .toString() result in same as .getHeader()", "url": "https://github.com/spinnaker/kork/pull/490#discussion_r371520718", "createdAt": "2020-01-27T22:33:46Z", "author": {"login": "marchello2000"}, "path": "kork-security/src/main/java/com/netflix/spinnaker/security/AuthenticatedRequest.java", "diffHunk": "@@ -217,23 +196,74 @@ private static void setOrRemoveMdc(String key, String value) {\n    */\n   public static Optional<String> getSpinnakerRequestId() {\n     return Optional.of(\n-        Optional.ofNullable(MDC.get(Header.REQUEST_ID.getHeader()))\n+        get(Header.REQUEST_ID)\n             .orElse(\n                 getSpinnakerExecutionId()\n                     .map(id -> format(\"%s:%s\", id, UUID.randomUUID().toString()))\n                     .orElse(UUID.randomUUID().toString())));\n   }\n \n   public static Optional<String> getSpinnakerUserOrigin() {\n-    return Optional.ofNullable(MDC.get(Header.USER_ORIGIN.getHeader()));\n+    return get(Header.USER_ORIGIN);\n   }\n \n   public static Optional<String> getSpinnakerExecutionId() {\n-    return Optional.ofNullable(MDC.get(Header.EXECUTION_ID.getHeader()));\n+    return get(Header.EXECUTION_ID);\n   }\n \n   public static Optional<String> getSpinnakerApplication() {\n-    return Optional.ofNullable(MDC.get(Header.APPLICATION.getHeader()));\n+    return get(Header.APPLICATION);\n+  }\n+\n+  public static Optional<String> get(Header header) {\n+    return Optional.ofNullable(MDC.get(header.getHeader()));\n+  }\n+\n+  public static void setAccounts(String accounts) {\n+    set(Header.ACCOUNTS, accounts);\n+  }\n+\n+  public static void setUser(String user) {\n+    set(Header.USER, user);\n+  }\n+\n+  public static void setUserOrigin(String value) {\n+    set(Header.USER_ORIGIN, value);\n+  }\n+\n+  public static void setRequestId(String value) {\n+    set(Header.REQUEST_ID, value);\n+  }\n+\n+  public static void setExecutionId(String value) {\n+    set(Header.EXECUTION_ID, value);\n+  }\n+\n+  public static void setApplication(String value) {\n+    set(Header.APPLICATION, value);\n+  }\n+\n+  public static void set(Header header, String value) {\n+    set(header.toString(), value);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "04e184dde5effb5a5ead5e9d8f29a87dbf161157"}, "originalPosition": 130}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNDQyNQ==", "bodyText": "nope, good catch", "url": "https://github.com/spinnaker/kork/pull/490#discussion_r371524425", "createdAt": "2020-01-27T22:43:06Z", "author": {"login": "dreynaud"}, "path": "kork-security/src/main/java/com/netflix/spinnaker/security/AuthenticatedRequest.java", "diffHunk": "@@ -217,23 +196,74 @@ private static void setOrRemoveMdc(String key, String value) {\n    */\n   public static Optional<String> getSpinnakerRequestId() {\n     return Optional.of(\n-        Optional.ofNullable(MDC.get(Header.REQUEST_ID.getHeader()))\n+        get(Header.REQUEST_ID)\n             .orElse(\n                 getSpinnakerExecutionId()\n                     .map(id -> format(\"%s:%s\", id, UUID.randomUUID().toString()))\n                     .orElse(UUID.randomUUID().toString())));\n   }\n \n   public static Optional<String> getSpinnakerUserOrigin() {\n-    return Optional.ofNullable(MDC.get(Header.USER_ORIGIN.getHeader()));\n+    return get(Header.USER_ORIGIN);\n   }\n \n   public static Optional<String> getSpinnakerExecutionId() {\n-    return Optional.ofNullable(MDC.get(Header.EXECUTION_ID.getHeader()));\n+    return get(Header.EXECUTION_ID);\n   }\n \n   public static Optional<String> getSpinnakerApplication() {\n-    return Optional.ofNullable(MDC.get(Header.APPLICATION.getHeader()));\n+    return get(Header.APPLICATION);\n+  }\n+\n+  public static Optional<String> get(Header header) {\n+    return Optional.ofNullable(MDC.get(header.getHeader()));\n+  }\n+\n+  public static void setAccounts(String accounts) {\n+    set(Header.ACCOUNTS, accounts);\n+  }\n+\n+  public static void setUser(String user) {\n+    set(Header.USER, user);\n+  }\n+\n+  public static void setUserOrigin(String value) {\n+    set(Header.USER_ORIGIN, value);\n+  }\n+\n+  public static void setRequestId(String value) {\n+    set(Header.REQUEST_ID, value);\n+  }\n+\n+  public static void setExecutionId(String value) {\n+    set(Header.EXECUTION_ID, value);\n+  }\n+\n+  public static void setApplication(String value) {\n+    set(Header.APPLICATION, value);\n+  }\n+\n+  public static void set(Header header, String value) {\n+    set(header.toString(), value);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyMDcxOA=="}, "originalCommit": {"oid": "04e184dde5effb5a5ead5e9d8f29a87dbf161157"}, "originalPosition": 130}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3683, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}