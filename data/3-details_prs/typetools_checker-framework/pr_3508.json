{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NDYxNjg2", "number": 3508, "title": "Make @DefaultFor and @DefaultQualifierForUse consistent.", "bodyText": "The implementation of @DefaultFor, a meta-annotation, and @DefaultForUse, a class declaration annotation is inconsistent with the manual.  This pull request fixes that.\n\nWriting @DefaultFor(types=MyClass.class)  as a meta-annotation for annotation A should be the same as writing @DefaultQualifierForUse(A.class)  on the declaration of MyClass.\nDefaults specified by @DefaultFor(types=...), @DefaultFor(typeKinds=...), or @DefaulQualifierForUse do not apply to local variables. This is currently implemented for local variables with declared types, but not primitive types.\nThese defaults apply to types, not expressions.\n\nCasts and new arrays:\nThe qualifier for unannotated casts and new array expressions is \"propagated\", quasi-inference, in the PropagationTreeAnnotator. The \"propagated\" qualifier should not be above the upper bound qualifier for the type.  This fixes a bug that was uncovered by the other changes in this pull request.\nThe changes to the Signedness Checker tests the changes in this pull request.  The Lock Checker and the Nullness Checker both needed to adapt to theses changes.\nMerge with typetools/checker-framework-inference#166.\n(@mernst this includes the changes to the Signedness Checker from your signedness-upperboundfor branch. I think you can delete it now.)", "createdAt": "2020-07-24T19:52:09Z", "url": "https://github.com/typetools/checker-framework/pull/3508", "merged": true, "mergeCommit": {"oid": "1234f8059e247b90d3f0dcab1cb478c4e934aa8e"}, "closed": true, "closedAt": "2020-07-31T21:28:36Z", "author": {"login": "smillst"}, "timelineItems": {"totalCount": 51, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1RuiQgH2gAyNDU2NDYxNjg2OjkyNzI1ZTE0YjFiZjE4MjJhMjhiNmEzNjc2Y2Y3Y2E5MGFjOTFjYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6YSsnAH2gAyNDU2NDYxNjg2OmU4ZGM1NzE3NDE4OGZmZGQxMDg4OWRhNDExMmJhN2M1ODNhYzBhYWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "92725e14b1bf1822a28b6a3676cf7ca90ac91ca2", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/92725e14b1bf1822a28b6a3676cf7ca90ac91ca2", "committedDate": "2020-07-15T21:43:17Z", "message": "Add @UpperBoundFor annotations for char, double, float, & boxed variants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ae66eea1cf827ce014041e564a051355fa5d9bb", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/5ae66eea1cf827ce014041e564a051355fa5d9bb", "committedDate": "2020-07-15T21:50:02Z", "message": "Tweak manual"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64c580da86f6d48f9ec64c2726890c1fab293f1b", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/64c580da86f6d48f9ec64c2726890c1fab293f1b", "committedDate": "2020-07-15T21:55:22Z", "message": "More documentation improvements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5af5620e168450f2b3349a7fd7ee8ce484bb2ce", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/c5af5620e168450f2b3349a7fd7ee8ce484bb2ce", "committedDate": "2020-07-16T22:23:41Z", "message": "Merge ../checker-framework-branch-master into signedness-upperboundfor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d777b7cc971f2f7c06b3bc715f2d8b08f4da5d58", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/d777b7cc971f2f7c06b3bc715f2d8b08f4da5d58", "committedDate": "2020-07-16T22:24:48Z", "message": "Merge ../checker-framework-branch-master into signedness-upperboundfor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b3de28feb14bc504955cefecd271ddeb51ee24a", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/0b3de28feb14bc504955cefecd271ddeb51ee24a", "committedDate": "2020-07-16T22:36:06Z", "message": "Merge ../checker-framework-branch-master into signedness-upperboundfor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4edb3447d6a1bca8f015c3f1fb1dee08fa995aa", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/d4edb3447d6a1bca8f015c3f1fb1dee08fa995aa", "committedDate": "2020-07-20T14:07:24Z", "message": "Merge ../checker-framework-branch-master into signedness-upperboundfor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0334ed821175ef2409d8c26c5dfb920faaf3b87f", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/0334ed821175ef2409d8c26c5dfb920faaf3b87f", "committedDate": "2020-07-20T14:12:18Z", "message": "Remove incorrect documentation about defaulting\n\n@UpperBound does not affect defaulting."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9966b92b93faff0203392527f39355d972cb9f7", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/c9966b92b93faff0203392527f39355d972cb9f7", "committedDate": "2020-07-20T19:28:56Z", "message": "Checkpoint."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "466ef6b59c66d7e4fa2c2b4fc01697ffc7eed33f", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/466ef6b59c66d7e4fa2c2b4fc01697ffc7eed33f", "committedDate": "2020-07-22T17:38:16Z", "message": "hold."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67e1cc874ace6a8d96d7c08717dca332cfc72ee1", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/67e1cc874ace6a8d96d7c08717dca332cfc72ee1", "committedDate": "2020-07-22T20:15:42Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa0099af309bc3225e06200e2a55cc2d895d69ec", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/aa0099af309bc3225e06200e2a55cc2d895d69ec", "committedDate": "2020-07-23T16:14:55Z", "message": "hold."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b899d05a366b632301eed4aa17c47981aca2650d", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/b899d05a366b632301eed4aa17c47981aca2650d", "committedDate": "2020-07-23T16:35:57Z", "message": "Hold."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38d6b23036a3b0d53f857d0ad73aa7906be2086f", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/38d6b23036a3b0d53f857d0ad73aa7906be2086f", "committedDate": "2020-07-23T16:51:07Z", "message": "hold."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e83e073c5b89df62d19df3aeee7afe797420a41", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/7e83e073c5b89df62d19df3aeee7afe797420a41", "committedDate": "2020-07-23T17:28:14Z", "message": "hold."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77a18a13ea5803bed7dd3f7984a50ce91cde1eb9", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/77a18a13ea5803bed7dd3f7984a50ce91cde1eb9", "committedDate": "2020-07-23T17:44:41Z", "message": "Fix Lock Checker."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b137ac8591e568d92264fa5bff14fc5866a43d5", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/6b137ac8591e568d92264fa5bff14fc5866a43d5", "committedDate": "2020-07-23T19:18:57Z", "message": "Add comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baf4c07248ad3f3e846043454aa05b8b4075da44", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/baf4c07248ad3f3e846043454aa05b8b4075da44", "committedDate": "2020-07-23T19:19:14Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "378ec3a49266ea010ac0fb3f64b9388b84f0fd61", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/378ec3a49266ea010ac0fb3f64b9388b84f0fd61", "committedDate": "2020-07-23T20:03:42Z", "message": "Add Javadoc."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dea1636db818f3f5dc8d5cef7ffa29032321d471", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/dea1636db818f3f5dc8d5cef7ffa29032321d471", "committedDate": "2020-07-24T15:59:47Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a231ea01330608add9ad8663e52e50a4552d223b", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/a231ea01330608add9ad8663e52e50a4552d223b", "committedDate": "2020-07-24T16:01:14Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be4a6f2e050ff5f376ffdb49796f5ff9b989e4e3", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/be4a6f2e050ff5f376ffdb49796f5ff9b989e4e3", "committedDate": "2020-07-24T16:37:40Z", "message": "Fix Arrays."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6f796b3335dce206a9c768851e799e96c630f37", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/b6f796b3335dce206a9c768851e799e96c630f37", "committedDate": "2020-07-24T16:38:06Z", "message": "."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b57c7a9c37bc7ae47f7f4f6827b416c2c54f3cc8", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/b57c7a9c37bc7ae47f7f4f6827b416c2c54f3cc8", "committedDate": "2020-07-24T16:40:50Z", "message": "Uncomment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7005bca7d538b739304dba5d8bd469f8f21ad11", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/b7005bca7d538b739304dba5d8bd469f8f21ad11", "committedDate": "2020-07-24T17:48:00Z", "message": "Reformat."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2b274440f31f266be7eff03326c722719a2f495", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/c2b274440f31f266be7eff03326c722719a2f495", "committedDate": "2020-07-24T17:52:49Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "caa542744beabeb7ef10fd984b48371b474fa026", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/caa542744beabeb7ef10fd984b48371b474fa026", "committedDate": "2020-07-24T18:37:50Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1dccde29340f451be820205923d019f5104128e", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/c1dccde29340f451be820205923d019f5104128e", "committedDate": "2020-07-24T19:22:19Z", "message": "Tweak."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83e28901b9c8121a6fe4761528135bc619047086", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/83e28901b9c8121a6fe4761528135bc619047086", "committedDate": "2020-07-24T21:47:13Z", "message": "Fix Javadoc style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f3b7aeb8399aac958a86050cf2f3130cf7a681c", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/3f3b7aeb8399aac958a86050cf2f3130cf7a681c", "committedDate": "2020-07-25T00:53:43Z", "message": "Merge ../checker-framework-branch-master into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/632d72e67be7dc38e1359b847e715ae6e9806c6b", "committedDate": "2020-07-25T14:34:19Z", "message": "Add more tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3OTU0NTkw", "url": "https://github.com/typetools/checker-framework/pull/3508#pullrequestreview-457954590", "createdAt": "2020-07-29T22:58:19Z", "commit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMjo1ODoyMFrOG5NI_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzoyMTo1NVrOG5NmfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYzNzMwOA==", "bodyText": "I guess the @Unsigned is the invalid one. Could you split it up in two methods to make clearer?", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462637308", "createdAt": "2020-07-29T22:58:20Z", "author": {"login": "wmdietl"}, "path": "checker/tests/signedness/LocalVarDefaults.java", "diffHunk": "@@ -0,0 +1,29 @@\n+import org.checkerframework.checker.signedness.qual.Signed;\n+import org.checkerframework.checker.signedness.qual.Unsigned;\n+\n+public class LocalVarDefaults {\n+\n+    void methodInt(@Unsigned int unsignedInt, @Signed int signedInt) {\n+        int local = unsignedInt;\n+        int local2 = signedInt;\n+    }\n+\n+    // :: error: (type.invalid.annotations.on.use)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYzODIwNg==", "bodyText": "Could you clarify the javadoc? It's confusing given the method name that this applies to anything other than declared types.\nCan you call out explicitly what happens with ARRAY (and what else? intersection?)", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462638206", "createdAt": "2020-07-29T23:00:55Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/common/basetype/BaseTypeValidator.java", "diffHunk": "@@ -95,7 +95,7 @@ public boolean isValid(AnnotatedTypeMirror type, Tree tree) {\n      * @return whether or not the top-level type should be checked\n      */\n     protected boolean shouldCheckTopLevelDeclaredType(AnnotatedTypeMirror type, Tree tree) {\n-        if (type.getKind() != TypeKind.DECLARED) {\n+        if (type.getKind() != TypeKind.DECLARED && !type.getKind().isPrimitive()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjYzOTMwNw==", "bodyText": "Can you add a comment why the order is different for expressions?", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462639307", "createdAt": "2020-07-29T23:04:06Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/type/GenericAnnotatedTypeFactory.java", "diffHunk": "@@ -1513,9 +1527,15 @@ protected void addComputedTypeAnnotations(\n                 : \"GenericAnnotatedTypeFactory.addComputedTypeAnnotations: \"\n                         + \" root needs to be set when used on trees; factory: \"\n                         + this.getClass();\n-        addAnnotationsFromDefaultQualifierForUse(TreeUtils.elementFromTree(tree), type);\n+\n+        if (!TreeUtils.isExpressionTree(tree)) {\n+            addAnnotationsFromDefaultQualifierForUse(TreeUtils.elementFromTree(tree), type);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY0MDMzMg==", "bodyText": "Could you update the javadoc?\nThis now also applies the defaultForTypeAnnotator, which is surprising given the method name.\nIt looks like null is passed as element to change what would happen by default, so calling that out would be good.\nI was also surprised by the special case for primitives, so giving a reason for that would be good.", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462640332", "createdAt": "2020-07-29T23:07:28Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/type/GenericAnnotatedTypeFactory.java", "diffHunk": "@@ -1839,20 +1859,28 @@ public void postAsMemberOf(\n      */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY0MzEyMQ==", "bodyText": "I would prefer something more descriptive than the type, although \"type to test\" is also not much better.", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462643121", "createdAt": "2020-07-29T23:16:24Z", "author": {"login": "wmdietl"}, "path": "javacutil/src/main/java/org/checkerframework/javacutil/TypesUtils.java", "diffHunk": "@@ -248,9 +248,25 @@ public static boolean isIntegral(TypeMirror type) {\n         }\n     }\n \n+    /**\n+     * Returns true iff the argument is a boxed floating point type.\n+     *\n+     * @param type type mirror", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY0MzUwNg==", "bodyText": "At some point we should figure out and document what the proper way is. Name defines a contentEquals, which might be more direct than calling toString. However, for multiple comparisons one approach might be more efficient.", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462643506", "createdAt": "2020-07-29T23:17:44Z", "author": {"login": "wmdietl"}, "path": "javacutil/src/main/java/org/checkerframework/javacutil/TypesUtils.java", "diffHunk": "@@ -248,9 +248,25 @@ public static boolean isIntegral(TypeMirror type) {\n         }\n     }\n \n+    /**\n+     * Returns true iff the argument is a boxed floating point type.\n+     *\n+     * @param type type mirror\n+     * @return whether the argument is a boxed floating point type\n+     */\n+    public static boolean isBoxedFloating(TypeMirror type) {\n+        if (type.getKind() != TypeKind.DECLARED) {\n+            return false;\n+        }\n+\n+        String qualifiedName = getQualifiedName((DeclaredType) type).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY0NDA0MQ==", "bodyText": "Nit. Make the validator capitalization consistent with the use in the class javadoc.", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462644041", "createdAt": "2020-07-29T23:19:30Z", "author": {"login": "wmdietl"}, "path": "checker/src/main/java/org/checkerframework/checker/nullness/NullnessVisitor.java", "diffHunk": "@@ -648,4 +652,38 @@ public Void visitAnnotation(AnnotationTree node, Void p) {\n         // All annotation arguments are non-null and initialized, so no need to check them.\n         return null;\n     }\n+\n+    @Override\n+    protected TypeValidator createTypeValidator() {\n+        return new NullnessValidator(checker, this, atypeFactory);\n+    }\n+\n+    /**\n+     * Nullness Validator. Check that primitive types are annotated with {@code @NonNull} even if\n+     * they are the type of a local variable.\n+     */\n+    private static class NullnessValidator extends BaseTypeValidator {\n+\n+        /**\n+         * Create Nullness validator.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY0NDg2MA==", "bodyText": "It looks like all the signed char casts are removed from this test. Should at least one remain and expect an error? Or what is supposed to happen if somebody writes that?", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r462644860", "createdAt": "2020-07-29T23:21:55Z", "author": {"login": "wmdietl"}, "path": "checker/tests/signedness/CastedShifts.java", "diffHunk": "@@ -36,35 +36,25 @@ public void CastedIntShifts(@Unsigned int unsigned, @Signed int signed) {\n         byteRes = (@Signed byte) (signed >> 0);\n \n         // Cast to char.\n-        @UnknownSignedness char charRes;\n+        char charRes;\n \n         // Shifting right by 23, the introduced bits are cast away\n         charRes = (@Unsigned char) (unsigned >>> 23);\n         charRes = (@Unsigned char) (unsigned >> 23);\n-        charRes = (@Signed char) (signed >>> 23);\n-        charRes = (@Signed char) (signed >> 23);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "632d72e67be7dc38e1359b847e715ae6e9806c6b"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ec0ad69a595f2a5cc946d58e2e3e91087a779d3", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/4ec0ad69a595f2a5cc946d58e2e3e91087a779d3", "committedDate": "2020-07-30T15:57:39Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15408fe27004c2d185e106b9eacf4a860d161689", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/15408fe27004c2d185e106b9eacf4a860d161689", "committedDate": "2020-07-30T15:57:45Z", "message": "Merge branch 'defaultFor' of github.com:smillst/checker-framework into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f96528779eb9b7f58e042a26eb6b163730f015a", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/6f96528779eb9b7f58e042a26eb6b163730f015a", "committedDate": "2020-07-30T16:08:51Z", "message": "Code Review."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1bad929cb2df4e605a888a49dfc3b472b349c2d", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/d1bad929cb2df4e605a888a49dfc3b472b349c2d", "committedDate": "2020-07-30T18:51:10Z", "message": "Add Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cda8fb777f0c07e21211ed9d7c032267ee8996b", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/2cda8fb777f0c07e21211ed9d7c032267ee8996b", "committedDate": "2020-07-30T18:52:00Z", "message": "Merge branch 'defaultFor' of github.com:smillst/checker-framework into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fed35423131bcf6284fef3386edffb46797d9095", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/fed35423131bcf6284fef3386edffb46797d9095", "committedDate": "2020-07-30T18:52:30Z", "message": "Merge ../checker-framework-branch-master into defaultFor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4ODQ0OTMx", "url": "https://github.com/typetools/checker-framework/pull/3508#pullrequestreview-458844931", "createdAt": "2020-07-31T00:19:04Z", "commit": {"oid": "fed35423131bcf6284fef3386edffb46797d9095"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDoxOTowNFrOG54C3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDoyMzozNlrOG54HjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0MDI1Mg==", "bodyText": "Could you deprecate this method and introduce a better name?\nIt makes no sense to use DeclaredType in the method name if it actually is also for primitive types.", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r463340252", "createdAt": "2020-07-31T00:19:04Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/common/basetype/BaseTypeValidator.java", "diffHunk": "@@ -86,16 +86,19 @@ public boolean isValid(AnnotatedTypeMirror type, Tree tree) {\n     }\n \n     /**\n-     * Should the top-level declared type be checked?\n+     * Should the top-level declared or primitive type be checked?\n+     *\n+     * <p>If {@code type} is not a declared or primitive type, then this method returns true.\n      *\n      * <p>Top-level type is not checked if tree is a local variable or an expression tree.\n      *\n      * @param type AnnotatedTypeMirror being validated\n      * @param tree a Tree whose type is {@code type}\n-     * @return whether or not the top-level type should be checked\n+     * @return whether or not the top-level type should be checked, if {@code type} is a declared or\n+     *     primitive type.\n      */\n     protected boolean shouldCheckTopLevelDeclaredType(AnnotatedTypeMirror type, Tree tree) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fed35423131bcf6284fef3386edffb46797d9095"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0MDc1Mg==", "bodyText": "The August release will be the next minor release. So isn't now the right time to make this change?", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r463340752", "createdAt": "2020-07-31T00:20:46Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/type/GenericAnnotatedTypeFactory.java", "diffHunk": "@@ -1841,25 +1868,37 @@ public void postAsMemberOf(\n      * Adds default qualifiers bases on the underlying type of {@code type} to {@code type}. If\n      * {@code element} is a local variable, then the defaults are not added.\n      *\n+     * <p>(This uses both the {@link DefaultQualifierForUseTypeAnnotator} and {@link\n+     * DefaultForTypeAnnotator}.)\n+     *\n      * @param element possibly null element whose type is {@code type}\n      * @param type the type to which defaults are added\n      */\n+    // TODO: rename in the next minor release.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fed35423131bcf6284fef3386edffb46797d9095"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0MTQ1Mw==", "bodyText": "In other recent pull requests you used quals as the name for such qualifier sets.\nMaybe addQualOrBound would also be a better method name?", "url": "https://github.com/typetools/checker-framework/pull/3508#discussion_r463341453", "createdAt": "2020-07-31T00:23:36Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/type/treeannotator/PropagationTreeAnnotator.java", "diffHunk": "@@ -204,4 +209,27 @@ private boolean hasPrimaryAnnotationInAllHierarchies(AnnotatedTypeMirror type) {\n         }\n         return annotated;\n     }\n+\n+    /**\n+     * Adds the qualifiers in {@code annos} to {@code type} that are below the qualifier upper bound\n+     * of type and for which type does not already have annotation in the same hierarchy. If a\n+     * qualifier in {@code annos} is above the bound, then the bound is added to {@code type}\n+     * instead.\n+     *\n+     * @param type annotations are added to this type\n+     * @param annos annotations to add to type\n+     */\n+    private void addAnnoOrBound(AnnotatedTypeMirror type, Set<? extends AnnotationMirror> annos) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fed35423131bcf6284fef3386edffb46797d9095"}, "originalPosition": 81}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bfadf3dd5099d31bda17964343e93e5dba9e470", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/9bfadf3dd5099d31bda17964343e93e5dba9e470", "committedDate": "2020-07-31T00:39:19Z", "message": "Code review."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a54cc79718e741901d6d2a112a55f21175b8f30", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/6a54cc79718e741901d6d2a112a55f21175b8f30", "committedDate": "2020-07-31T00:39:42Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fd332b4f9bf0a1c1f8f6cd9dd1be445527cb6db", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/2fd332b4f9bf0a1c1f8f6cd9dd1be445527cb6db", "committedDate": "2020-07-31T00:50:27Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28d8b7715b7b901a298035f14ae496411e988557", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/28d8b7715b7b901a298035f14ae496411e988557", "committedDate": "2020-07-31T17:12:40Z", "message": "Fix method name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzM0NzU2", "url": "https://github.com/typetools/checker-framework/pull/3508#pullrequestreview-459334756", "createdAt": "2020-07-31T17:18:10Z", "commit": {"oid": "28d8b7715b7b901a298035f14ae496411e988557"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48e691a72552e6e2c020c42b3febf9f6c107e027", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/48e691a72552e6e2c020c42b3febf9f6c107e027", "committedDate": "2020-07-31T17:37:40Z", "message": "Add Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7488450f141da6e0c013b3858148a61299880636", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/7488450f141da6e0c013b3858148a61299880636", "committedDate": "2020-07-31T17:38:18Z", "message": "Merge ../checker-framework-branch-master into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12b089d8fe43a905b2e4f612ee3e055b0527bda1", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/12b089d8fe43a905b2e4f612ee3e055b0527bda1", "committedDate": "2020-07-31T17:38:52Z", "message": "Merge ../checker-framework-branch-master into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b312cbbcdb545f769a3b74f8ba6df0b96cb9f809", "author": {"user": {"login": "smillst", "name": "Suzanne Millstein"}}, "url": "https://github.com/typetools/checker-framework/commit/b312cbbcdb545f769a3b74f8ba6df0b96cb9f809", "committedDate": "2020-07-31T18:06:42Z", "message": "Merge remote-tracking branch 'origin/master' into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8886da9a04433cdbadc3033ae37674a81ea553ef", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/8886da9a04433cdbadc3033ae37674a81ea553ef", "committedDate": "2020-07-31T18:06:44Z", "message": "Expand Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba1053f5444115980d7cb59b5395855aa3c0ef9f", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/ba1053f5444115980d7cb59b5395855aa3c0ef9f", "committedDate": "2020-07-31T18:07:14Z", "message": "Merge branch 'defaultFor' of github.com:smillst/checker-framework into defaultFor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8dc57174188ffdd10889da4112ba7c583ac0aac", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/e8dc57174188ffdd10889da4112ba7c583ac0aac", "committedDate": "2020-07-31T18:11:50Z", "message": "Trivial change to trigger CI"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2711, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}