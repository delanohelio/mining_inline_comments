{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MDYwMTE5", "number": 3100, "title": "Avoid the false \"cannot find stub file\" warnings.", "bodyText": "I am currently working on a compound checker (ValueChecker as the sub checker). When I ran the compound checker with a stub file (passed by \"-Astubs\" argument) which is in the jar file of that compound checker, I got a \"cannot find stub file\" warning. It is because that ValueChecker cannot find that stub file (which is not needed by the ValueChecker).\nHere is a potential solution: let all the parent checkers (the parent checker, the parent of the parent checker, ...) try to find the target stub file. If one can find, there is no need to report a \"cannot find stub file\" warning.", "createdAt": "2020-02-21T01:30:26Z", "url": "https://github.com/typetools/checker-framework/pull/3100", "merged": true, "mergeCommit": {"oid": "f09bda8d4bab4e47b3a1eef732b743baf2af46d2"}, "closed": true, "closedAt": "2020-02-27T21:49:33Z", "author": {"login": "xingweitian"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGUoUVAH2gAyMzc4MDYwMTE5OjUyNTkwYmI5M2YzMDVhNmI5ZmE2M2QwMGFlMDkzMDYzMzlkYzAxZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIifpegFqTM2NjAyMzU2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "52590bb93f305a6b9fa63d00ae09306339dc01f7", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/52590bb93f305a6b9fa63d00ae09306339dc01f7", "committedDate": "2020-02-21T00:31:46Z", "message": "Also check ancestor checkers to avoid a false warning."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d77aa81cc47fe8bdb03eb4bd5be3af0ae886a1cb", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/d77aa81cc47fe8bdb03eb4bd5be3af0ae886a1cb", "committedDate": "2020-02-21T01:27:33Z", "message": "Tweaks."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyOTQxNDkz", "url": "https://github.com/typetools/checker-framework/pull/3100#pullrequestreview-362941493", "createdAt": "2020-02-21T21:56:59Z", "commit": {"oid": "d77aa81cc47fe8bdb03eb4bd5be3af0ae886a1cb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQyMTo1Njo1OVrOFtFxhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQyMjoxMTo0NFrOFtGHMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjgyNDgzNw==", "bodyText": "Instead of making this field public, please add a getter method next to the existing setter.", "url": "https://github.com/typetools/checker-framework/pull/3100#discussion_r382824837", "createdAt": "2020-02-21T21:56:59Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java", "diffHunk": "@@ -461,7 +461,7 @@\n      * in the case of a compound checker, the compound checker is the parent, not the checker that\n      * was run prior to this one by the compound checker.\n      */\n-    protected SourceChecker parentChecker;\n+    public SourceChecker parentChecker;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d77aa81cc47fe8bdb03eb4bd5be3af0ae886a1cb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjgzMDM4NQ==", "bodyText": "I think you should try to pull this check out before the first use of checker.getClass() on line 192 and simply perform the same logic for either the first checker or one of the parent checkers.\nThis would include checking for the topLevelResource for each possible checker.", "url": "https://github.com/typetools/checker-framework/pull/3100#discussion_r382830385", "createdAt": "2020-02-21T22:11:44Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/stub/StubTypes.java", "diffHunk": "@@ -202,15 +202,31 @@ public void parseStubFiles() {\n                                         + \".class, but is at the top level of a jar file: \"\n                                         + topLevelResource);\n                     } else {\n-                        checker.message(\n-                                Kind.WARNING,\n-                                \"Did not find stub file \"\n-                                        + stubPath\n-                                        + \" on classpath or within directory \"\n-                                        + new File(stubPath).getAbsolutePath()\n-                                        + (stubPathFull.equals(stubPath)\n-                                                ? \"\"\n-                                                : (\" or at \" + stubPathFull)));\n+                        // When using a compound checker, the target stub file may be found by the\n+                        // current checker's parent checkers. Also check this to avoid a false\n+                        // warning.\n+                        SourceChecker parentChecker = checker.parentChecker;\n+                        boolean findByParentCheckers = false;\n+                        while (parentChecker != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d77aa81cc47fe8bdb03eb4bd5be3af0ae886a1cb"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15a6206778ff7afd216d6160512b0e7132aedaa2", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/15a6206778ff7afd216d6160512b0e7132aedaa2", "committedDate": "2020-02-21T23:22:21Z", "message": "Resolve comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df03ab239efe7ecb18fe6ec00b4a47642521597a", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/df03ab239efe7ecb18fe6ec00b4a47642521597a", "committedDate": "2020-02-21T23:51:41Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4a54d73fbd642e80b08e91051278b3b3de562d7", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/a4a54d73fbd642e80b08e91051278b3b3de562d7", "committedDate": "2020-02-22T00:29:02Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "380f85ea2ec0609e7c19126379d4eb25d06d19c7", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/380f85ea2ec0609e7c19126379d4eb25d06d19c7", "committedDate": "2020-02-22T00:31:14Z", "message": "Tweaks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "737095340253ad59d6d362d9b136615c6ba9e411", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/737095340253ad59d6d362d9b136615c6ba9e411", "committedDate": "2020-02-24T22:08:35Z", "message": "Resolve comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d6b1174a51f6f6f5deb9533daa63307f1d68f4a", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/3d6b1174a51f6f6f5deb9533daa63307f1d68f4a", "committedDate": "2020-02-24T22:08:53Z", "message": "Merge remote-tracking branch 'typetools/master' into avoid-unecessary-cannot-find-stub-file-warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa58aaf18901df6ed935c64684ae6f1112bd20ad", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/fa58aaf18901df6ed935c64684ae6f1112bd20ad", "committedDate": "2020-02-24T23:28:41Z", "message": "Merge remote-tracking branch 'typetools/master' into avoid-unecessary-cannot-find-stub-file-warning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MjYzMDc0", "url": "https://github.com/typetools/checker-framework/pull/3100#pullrequestreview-364263074", "createdAt": "2020-02-25T16:02:23Z", "commit": {"oid": "fa58aaf18901df6ed935c64684ae6f1112bd20ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNjowMjoyM1rOFuL9iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNjowMjoyM1rOFuL9iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzk3NDc5NQ==", "bodyText": "@xingweitian Can you add the missing @param to make the tests pass. You didn't touch that method, but it is \"close\" to what you added.", "url": "https://github.com/typetools/checker-framework/pull/3100#discussion_r383974795", "createdAt": "2020-02-25T16:02:23Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/source/SourceChecker.java", "diffHunk": "@@ -515,6 +515,11 @@ protected void setParentChecker(SourceChecker parentChecker) {\n         this.parentChecker = parentChecker;\n     }\n \n+    /** @return the parent checker of the current checker */\n+    public SourceChecker getParentChecker() {\n+        return this.parentChecker;\n+    }\n+\n     /** Invoked when the current compilation unit root changes. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa58aaf18901df6ed935c64684ae6f1112bd20ad"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f33d1c90467390d5c1d357a98721367507815fb", "author": {"user": {"login": "xingweitian", "name": "Weitian Xing"}}, "url": "https://github.com/typetools/checker-framework/commit/5f33d1c90467390d5c1d357a98721367507815fb", "committedDate": "2020-02-25T20:13:11Z", "message": "Add Javadoc."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDE4NzU2", "url": "https://github.com/typetools/checker-framework/pull/3100#pullrequestreview-366018756", "createdAt": "2020-02-27T21:40:36Z", "commit": {"oid": "5f33d1c90467390d5c1d357a98721367507815fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDIzNTY1", "url": "https://github.com/typetools/checker-framework/pull/3100#pullrequestreview-366023565", "createdAt": "2020-02-27T21:48:49Z", "commit": {"oid": "5f33d1c90467390d5c1d357a98721367507815fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3072, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}