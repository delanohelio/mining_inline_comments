{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNDIwNDE1", "number": 3087, "title": "Reuse existing functions for TypeKind unboxing and range determination", "bodyText": "The repository in #2942 isn't available anymore. This PR tries to finish that work.", "createdAt": "2020-02-11T00:24:00Z", "url": "https://github.com/typetools/checker-framework/pull/3087", "merged": true, "mergeCommit": {"oid": "101d12a5c8f06eb4a8f64723a0ffe95014411107"}, "closed": true, "closedAt": "2020-02-13T20:21:19Z", "author": {"login": "wmdietl"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC_VcFAH2gAyMzczNDIwNDE1OjAyMmI0OThhMDFiZTIwZTRjZTE5MWNlOWY2Mzk0ODA3YmU4NWRhYTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcEAKp4gH2gAyMzczNDIwNDE1OjdlNWIxNTQwY2MxNDAyZGE4NzI5YTI1NjEwZmEzYWE5MGUwYTVkZmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "022b498a01be20e4ce191ce9f6394807be85daa3", "author": {"user": {"login": "smonteiro", "name": "Sidney Monteiro"}}, "url": "https://github.com/typetools/checker-framework/commit/022b498a01be20e4ce191ce9f6394807be85daa3", "committedDate": "2020-02-10T16:01:22Z", "message": "added unit test for create(TypeKind)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06ae3dee3c3bc9ad66dd20f92f4704ae66ddeb27", "author": {"user": {"login": "smonteiro", "name": "Sidney Monteiro"}}, "url": "https://github.com/typetools/checker-framework/commit/06ae3dee3c3bc9ad66dd20f92f4704ae66ddeb27", "committedDate": "2020-02-10T16:01:22Z", "message": "remove trailing spaces from source code pasted int"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ec3bdf6a5531631d832e66f1ff68723a19fffa6", "author": {"user": {"login": "smonteiro", "name": "Sidney Monteiro"}}, "url": "https://github.com/typetools/checker-framework/commit/1ec3bdf6a5531631d832e66f1ff68723a19fffa6", "committedDate": "2020-02-10T16:01:22Z", "message": "import TypeKInd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de441eab370c2412b4c631d130729448d29fe275", "author": {"user": {"login": "smonteiro", "name": "Sidney Monteiro"}}, "url": "https://github.com/typetools/checker-framework/commit/de441eab370c2412b4c631d130729448d29fe275", "committedDate": "2020-02-10T16:01:25Z", "message": "reformat"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a74ce5a909d4a2a5fcd15080c07b57b9b400410c", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/a74ce5a909d4a2a5fcd15080c07b57b9b400410c", "committedDate": "2020-02-10T16:27:21Z", "message": "Recreate changes from https://github.com/typetools/checker-framework/pull/2942 as that branch is gone."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aee4e0d386530a40a690c134e4714dddf5e607f3", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/aee4e0d386530a40a690c134e4714dddf5e607f3", "committedDate": "2020-02-10T17:50:58Z", "message": "Remove duplicated tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20adcf5e66fe54db1a0e0ffcaaf88da0a9d9e026", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/20adcf5e66fe54db1a0e0ffcaaf88da0a9d9e026", "committedDate": "2020-02-10T21:57:46Z", "message": "Adapt expected exception."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08b63eb06e15a39d7fbf6d86543c4ccd860f5cd8", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/08b63eb06e15a39d7fbf6d86543c4ccd860f5cd8", "committedDate": "2020-02-11T00:21:34Z", "message": "Merge branch 'master' of github.com:typetools/checker-framework into smonteiro-useExistingFunctionsImproveRange"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d0b7e6b6b23e6b33ee029f04738dbfd8a40b3b4", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/2d0b7e6b6b23e6b33ee029f04738dbfd8a40b3b4", "committedDate": "2020-02-12T23:34:55Z", "message": "Fix invalid uses."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea0e0630648a4959d792fa5b72f8429074c0af8f", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/ea0e0630648a4959d792fa5b72f8429074c0af8f", "committedDate": "2020-02-12T23:35:11Z", "message": "Merge branch 'master' of github.com:typetools/checker-framework into smonteiro-useExistingFunctionsImproveRange"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NDA1OTM3", "url": "https://github.com/typetools/checker-framework/pull/3087#pullrequestreview-358405937", "createdAt": "2020-02-13T17:20:38Z", "commit": {"oid": "ea0e0630648a4959d792fa5b72f8429074c0af8f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNzoyMDozOFrOFpcoWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNzoyMDozOFrOFpcoWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAwNTAxNg==", "bodyText": "This should mention that type must be a boxed integral type.", "url": "https://github.com/typetools/checker-framework/pull/3087#discussion_r379005016", "createdAt": "2020-02-13T17:20:38Z", "author": {"login": "smillst"}, "path": "framework/src/main/java/org/checkerframework/common/value/ValueAnnotatedTypeFactory.java", "diffHunk": "@@ -437,54 +390,22 @@ public long getToValueFromIntRange(AnnotatedTypeMirror atm) {\n             return AnnotationUtils.getElementValue(anno, \"to\", Long.class, false);\n         }\n \n-        long to;\n         TypeMirror type = atm.getUnderlyingType();\n-        switch (type.getKind()) {\n-            case INT:\n-                to = Integer.MAX_VALUE;\n-                break;\n-            case SHORT:\n-                to = Short.MAX_VALUE;\n-                break;\n-            case BYTE:\n-                to = Byte.MAX_VALUE;\n-                break;\n-            case CHAR:\n-                to = Character.MAX_VALUE;\n-                break;\n-            case LONG:\n-                to = Long.MAX_VALUE;\n-                break;\n-            case DECLARED:\n-                String qualifiedName = TypesUtils.getQualifiedName((DeclaredType) type).toString();\n-                switch (qualifiedName) {\n-                    case \"java.lang.Integer\":\n-                        to = Integer.MAX_VALUE;\n-                        break;\n-                    case \"java.lang.Short\":\n-                        to = Short.MAX_VALUE;\n-                        break;\n-                    case \"java.lang.Byte\":\n-                        to = Byte.MAX_VALUE;\n-                        break;\n-                    case \"java.lang.Character\":\n-                        to = Character.MAX_VALUE;\n-                        break;\n-                    case \"java.lang.Long\":\n-                        to = Long.MAX_VALUE;\n-                        break;\n-                    default:\n-                        throw new UserError(\n-                                \"Illegal type \\\"@IntRange \"\n-                                        + qualifiedName\n-                                        + \"\\\". @IntRange can be applied to Java integral types.\");\n-                }\n-                break;\n-            default:\n-                throw new BugInCF(\n-                        \"Tried to apply a default to an IntRange annotation that was neither an integral primitive nor a declared type.\");\n+        return Range.create(toPrimitiveIntegralTypeKind(type)).to;\n+    }\n+\n+    /**\n+     * Determine the primitive integral TypeKind for the given type.\n+     *\n+     * @param type the type to convert", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea0e0630648a4959d792fa5b72f8429074c0af8f"}, "originalPosition": 127}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e5b1540cc1402da8729a25610fa3aa90e0a5dfc", "author": {"user": {"login": "wmdietl", "name": "Werner Dietl"}}, "url": "https://github.com/typetools/checker-framework/commit/7e5b1540cc1402da8729a25610fa3aa90e0a5dfc", "committedDate": "2020-02-13T19:33:25Z", "message": "Improve javadoc."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3060, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}