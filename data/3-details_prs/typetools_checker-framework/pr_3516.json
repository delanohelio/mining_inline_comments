{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3Mjc3Mzcy", "number": 3516, "title": "Visualize CFGs without package names", "bodyText": "This makes the CFG smaller and easier to read.  In rare cases when there are multiple classes with the same name, it might hide important information.  If that comes up, we can introduce a flag to print classes in fully-qualified form.\nContains changes from #3514, which should be merged first.", "createdAt": "2020-07-27T16:41:27Z", "url": "https://github.com/typetools/checker-framework/pull/3516", "merged": true, "mergeCommit": {"oid": "7200178afb244635b8dfdd01919922e0f0198463"}, "closed": true, "closedAt": "2020-07-31T19:53:35Z", "author": {"login": "mernst"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc42mnzAH2gAyNDU3Mjc3MzcyOjdkZTBjNTJjNzNmMTZmYzJmNzFkN2E0ZDE2ODkxM2U4ZGE4MTFiZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6ZvhCgFqTQ1OTQyNzAyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7de0c52c73f16fc2f71d7a4d168913e8da811bf3", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/7de0c52c73f16fc2f71d7a4d168913e8da811bf3", "committedDate": "2020-07-27T00:22:54Z", "message": "Improve CFG visualization documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e830e6f4b6a56ea28fe69a6d291a77f9a3ef451", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/7e830e6f4b6a56ea28fe69a6d291a77f9a3ef451", "committedDate": "2020-07-27T01:11:54Z", "message": "Add some more documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "299320f0acec2ab09b44a9695c67bbfd3b752f52", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/299320f0acec2ab09b44a9695c67bbfd3b752f52", "committedDate": "2020-07-27T01:27:26Z", "message": "More documentation improvements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8d442091603277afad448baa368b80eeee242da", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/b8d442091603277afad448baa368b80eeee242da", "committedDate": "2020-07-27T03:27:17Z", "message": "Visualize CFGs without package names\n\nThis makes the CFG smaller and easier to read.  In rare cases when there are\nmultiple classes with the same name, it might hide important information.  If\nthat comes up, we can introduce a flag to print classes in fully-qualified form."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d68d96821dd2934f18256d310eeee259ee1d8c82", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/d68d96821dd2934f18256d310eeee259ee1d8c82", "committedDate": "2020-07-27T03:32:50Z", "message": "Merge ../checker-framework-branch-master into cfgviz-documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d69290545a6f65d58de260b05d8acfce0661bf2", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/1d69290545a6f65d58de260b05d8acfce0661bf2", "committedDate": "2020-07-27T03:33:09Z", "message": "Merge ../checker-framework-fork-mernst-branch-cfgviz-documentation into cfgviz-nopackage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd41ff4f5f3d8272ecb509f2b15595e985a1fe63", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/fd41ff4f5f3d8272ecb509f2b15595e985a1fe63", "committedDate": "2020-07-27T03:50:09Z", "message": "Handle another typekind"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e07fa4e0b82076fe70fe3c2709bdd68e81919a7", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/0e07fa4e0b82076fe70fe3c2709bdd68e81919a7", "committedDate": "2020-07-27T03:57:46Z", "message": "Make output more concise"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44e04326147b6066d5f2bc64a19955b87e8b39d5", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/44e04326147b6066d5f2bc64a19955b87e8b39d5", "committedDate": "2020-07-27T04:56:49Z", "message": "Add Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdda8038459505d6257031997bb1d4808fc1b8b8", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/cdda8038459505d6257031997bb1d4808fc1b8b8", "committedDate": "2020-07-27T14:37:05Z", "message": "Add Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4fea823f632c827cb5c4e4eb9bd7abe6c56227a", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/b4fea823f632c827cb5c4e4eb9bd7abe6c56227a", "committedDate": "2020-07-27T14:39:40Z", "message": "Add nullness type annotation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "310a8e47d8add9dc0a2118703be03d0bc628da1f", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/310a8e47d8add9dc0a2118703be03d0bc628da1f", "committedDate": "2020-07-28T00:18:22Z", "message": "Merge ../checker-framework-branch-master into cfgviz-documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b1614893348f3d5f56c1cf250332f29a9f11a4f", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/5b1614893348f3d5f56c1cf250332f29a9f11a4f", "committedDate": "2020-07-28T00:18:30Z", "message": "Merge ../checker-framework-fork-mernst-branch-cfgviz-documentation into cfgviz-nopackage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9056b1170907d2f1f88e6abe50452ce45f44c684", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/9056b1170907d2f1f88e6abe50452ce45f44c684", "committedDate": "2020-07-29T05:20:23Z", "message": "Merge ../checker-framework-branch-master into cfgviz-documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7376940026a65b41d8e9733891d85b51705400d", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/f7376940026a65b41d8e9733891d85b51705400d", "committedDate": "2020-07-29T05:20:32Z", "message": "Merge ../checker-framework-fork-mernst-branch-cfgviz-documentation into cfgviz-nopackage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3OTcwOTg3", "url": "https://github.com/typetools/checker-framework/pull/3516#pullrequestreview-457970987", "createdAt": "2020-07-29T23:43:57Z", "commit": {"oid": "f7376940026a65b41d8e9733891d85b51705400d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzo0Mzo1N1rOG5OA0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzo1MjoxMlrOG5OK2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY1MTYwMg==", "bodyText": "Can this field also be protected final?", "url": "https://github.com/typetools/checker-framework/pull/3516#discussion_r462651602", "createdAt": "2020-07-29T23:43:57Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/flow/CFAbstractValue.java", "diffHunk": "@@ -51,9 +55,21 @@\n     /** The analysis class this value belongs to. */\n     protected final CFAbstractAnalysis<V, ?, ?> analysis;\n \n+    /** The underlying (Java) type in this abstract value. */\n     protected final TypeMirror underlyingType;\n+    /** The annotations in this abstract value. */\n     protected final Set<AnnotationMirror> annotations;\n \n+    /** Formats annotations without their package names. */\n+    AnnotationFormatter annoFormatter = new DefaultAnnotationFormatter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7376940026a65b41d8e9733891d85b51705400d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY1NDE2OA==", "bodyText": "I'm a bit concerned about adding this field. We create many abstract values and this will make that more costly.\nWe only call toString/toStringSimple when we debug/visualize the CFG, so it would overall probably be much better to only create the formatter in toStringSimple.\nWhat do you think?", "url": "https://github.com/typetools/checker-framework/pull/3516#discussion_r462654168", "createdAt": "2020-07-29T23:52:12Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/flow/CFAbstractValue.java", "diffHunk": "@@ -51,9 +55,21 @@\n     /** The analysis class this value belongs to. */\n     protected final CFAbstractAnalysis<V, ?, ?> analysis;\n \n+    /** The underlying (Java) type in this abstract value. */\n     protected final TypeMirror underlyingType;\n+    /** The annotations in this abstract value. */\n     protected final Set<AnnotationMirror> annotations;\n \n+    /** Formats annotations without their package names. */\n+    AnnotationFormatter annoFormatter = new DefaultAnnotationFormatter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7376940026a65b41d8e9733891d85b51705400d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5b8c3b5689cbb81fb1c79999277303e154c8c42", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/c5b8c3b5689cbb81fb1c79999277303e154c8c42", "committedDate": "2020-07-30T18:40:23Z", "message": "Merge ../checker-framework-branch-master into cfgviz-nopackage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53b0b9b9c110fe552fb13616cdf0b018e260b3bb", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/53b0b9b9c110fe552fb13616cdf0b018e260b3bb", "committedDate": "2020-07-30T18:45:49Z", "message": "Make defaultAnnotationFormatter field static"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4ODQ4NTE5", "url": "https://github.com/typetools/checker-framework/pull/3516#pullrequestreview-458848519", "createdAt": "2020-07-31T00:31:45Z", "commit": {"oid": "53b0b9b9c110fe552fb13616cdf0b018e260b3bb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDozMTo0NVrOG54P_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwMDozNDowNlrOG54SUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0MzYxMg==", "bodyText": "Any reason to not make it final?\nI would probably still move this into toStringSimple, because that's the only place that uses this field and that method won't be used much. But I'm fine with a static field.", "url": "https://github.com/typetools/checker-framework/pull/3516#discussion_r463343612", "createdAt": "2020-07-31T00:31:45Z", "author": {"login": "wmdietl"}, "path": "framework/src/main/java/org/checkerframework/framework/flow/CFAbstractValue.java", "diffHunk": "@@ -48,12 +51,25 @@\n  */\n public abstract class CFAbstractValue<V extends CFAbstractValue<V>> implements AbstractValue<V> {\n \n+    /** Formats annotations without their package names. */\n+    protected static DefaultAnnotationFormatter defaultAnnotationFormatter =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b0b9b9c110fe552fb13616cdf0b018e260b3bb"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzM0NDIxMQ==", "bodyText": "Now that this method is public, we should move it to TypesUtils - the parameter type is TypeMirror, so that's where I would expect such a method.", "url": "https://github.com/typetools/checker-framework/pull/3516#discussion_r463344211", "createdAt": "2020-07-31T00:34:06Z", "author": {"login": "wmdietl"}, "path": "javacutil/src/main/java/org/checkerframework/javacutil/ElementUtils.java", "diffHunk": "@@ -215,20 +215,27 @@ public static String getSimpleName(ExecutableElement element) {\n      * @param type a type\n      * @return the simple type name, without annotations\n      */\n-    private static String simpleTypeName(TypeMirror type) {\n+    public static String simpleTypeName(TypeMirror type) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b0b9b9c110fe552fb13616cdf0b018e260b3bb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad184f1314506ad15bcef3ec5c38c387581b623e", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/ad184f1314506ad15bcef3ec5c38c387581b623e", "committedDate": "2020-07-31T01:05:16Z", "message": "Merge ../checker-framework-branch-master into cfgviz-nopackage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3b83db7f5a0a1befc1d6e51f6f1468c8786ad55", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/e3b83db7f5a0a1befc1d6e51f6f1468c8786ad55", "committedDate": "2020-07-31T04:27:03Z", "message": "Address code review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96b6d5446471ecfb0caca3098f9a72653f7eb4a4", "author": {"user": {"login": "mernst", "name": "Michael Ernst"}}, "url": "https://github.com/typetools/checker-framework/commit/96b6d5446471ecfb0caca3098f9a72653f7eb4a4", "committedDate": "2020-07-31T05:43:42Z", "message": "Merge ../checker-framework-branch-master into cfgviz-nopackage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NDI3MDI2", "url": "https://github.com/typetools/checker-framework/pull/3516#pullrequestreview-459427026", "createdAt": "2020-07-31T19:53:13Z", "commit": {"oid": "96b6d5446471ecfb0caca3098f9a72653f7eb4a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2725, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}