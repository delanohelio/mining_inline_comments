{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNTA0NjUx", "number": 3284, "title": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support", "bodyText": "What is the purpose of the change\nThis is an interface change in preparation for container support.\nHow was the change tested\n\nSet up a standalone storm cluster on Rhel6 node\nMade sure default case (no resource isolation plugin) works as expected by submitting example topologies and validate it works as usual.\nEnabled cgroup as the resource isolation plugin (and ResourceAwareScheduler as the scheduler); tested example topologies with different cluster & topo configuration, validates the cpu and memory are managed correctly as the original code.", "createdAt": "2020-06-09T02:54:42Z", "url": "https://github.com/apache/storm/pull/3284", "merged": true, "mergeCommit": {"oid": "879087e19f048f222cd01972bf538daa80ec7dba"}, "closed": true, "closedAt": "2020-06-10T20:35:48Z", "author": {"login": "Ethanlm"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpcIJWgBqjM0MjI4MTMxNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp_emOgFqTQyODM5NDAyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9e987381bcce0b72be5bddc4c7fe8d2ddc06322", "author": {"user": {"login": "Ethanlm", "name": "Meng (Ethan) Li "}}, "url": "https://github.com/apache/storm/commit/c9e987381bcce0b72be5bddc4c7fe8d2ddc06322", "committedDate": "2020-06-09T02:47:15Z", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support"}, "afterCommit": {"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "author": {"user": {"login": "Ethanlm", "name": "Meng (Ethan) Li "}}, "url": "https://github.com/apache/storm/commit/c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "committedDate": "2020-06-09T03:03:00Z", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NDIxNjU2", "url": "https://github.com/apache/storm/pull/3284#pullrequestreview-427421656", "createdAt": "2020-06-09T18:15:26Z", "commit": {"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxNToyNlrOGhWl9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxNToyNlrOGhWl9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNjM1Nw==", "bodyText": "Does this method (or its variant getAllPids) need to be in the ResourceIsolationInterface?", "url": "https://github.com/apache/storm/pull/3284#discussion_r437626357", "createdAt": "2020-06-09T18:15:26Z", "author": {"login": "bipinprasad"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -305,8 +302,7 @@ private void prefixNumaPinning(List<String> command, String numaId) {\n         return newCommand;\n     }\n \n-    @Override\n-    public Set<Long> getRunningPids(String workerId) throws IOException {\n+    private Set<Long> getRunningPids(String workerId) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda"}, "originalPosition": 144}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NDI0NDQw", "url": "https://github.com/apache/storm/pull/3284#pullrequestreview-427424440", "createdAt": "2020-06-09T18:19:08Z", "commit": {"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxOTowOFrOGhWuLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxODoxOTowOFrOGhWuLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyODQ2Mw==", "bodyText": "instead of assert (which will not be active at runtime), do we want to raise an IllegalArgumentException here? If resourceIsolationManager is null, then there will be NPE anyway elsewhere.", "url": "https://github.com/apache/storm/pull/3284#discussion_r437628463", "createdAt": "2020-06-09T18:19:08Z", "author": {"login": "bipinprasad"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/BasicContainer.java", "diffHunk": "@@ -130,14 +130,15 @@ public BasicContainer(ContainerType type, Map<String, Object> conf, String super\n         super(type, conf, supervisorId, supervisorPort, port, assignment,\n             resourceIsolationManager, workerId, topoConf, ops, metricsRegistry, containerMemoryTracker);\n         assert (localState != null);\n+        assert (resourceIsolationManager != null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14b762ac5190939af038612c1160936b45cefcdf", "author": {"user": {"login": "Ethanlm", "name": "Meng (Ethan) Li "}}, "url": "https://github.com/apache/storm/commit/14b762ac5190939af038612c1160936b45cefcdf", "committedDate": "2020-06-09T21:47:15Z", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "15ac86643928f54abedc46d661281e9cff9ec82d", "author": {"user": {"login": "Ethanlm", "name": "Meng (Ethan) Li "}}, "url": "https://github.com/apache/storm/commit/15ac86643928f54abedc46d661281e9cff9ec82d", "committedDate": "2020-06-09T20:25:57Z", "message": "[STORM-3271] remove assert"}, "afterCommit": {"oid": "14b762ac5190939af038612c1160936b45cefcdf", "author": {"user": {"login": "Ethanlm", "name": "Meng (Ethan) Li "}}, "url": "https://github.com/apache/storm/commit/14b762ac5190939af038612c1160936b45cefcdf", "committedDate": "2020-06-09T21:47:15Z", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NTgxNzAx", "url": "https://github.com/apache/storm/pull/3284#pullrequestreview-427581701", "createdAt": "2020-06-09T22:12:30Z", "commit": {"oid": "14b762ac5190939af038612c1160936b45cefcdf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4Mzk0MDIw", "url": "https://github.com/apache/storm/pull/3284#pullrequestreview-428394020", "createdAt": "2020-06-10T20:14:25Z", "commit": {"oid": "14b762ac5190939af038612c1160936b45cefcdf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4597, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}