{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzODY4MTIw", "number": 3237, "title": "STORM-3259: Adds NUMA awareness to enable worker pinning", "bodyText": "", "createdAt": "2020-03-25T22:54:55Z", "url": "https://github.com/apache/storm/pull/3237", "merged": true, "mergeCommit": {"oid": "ec4065a4150bb6c2b924e3019885d4cc474c8a4e"}, "closed": true, "closedAt": "2020-04-16T15:15:29Z", "author": {"login": "govind-menon"}, "timelineItems": {"totalCount": 32, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRfJXggBqjMxNjkxOTE1NjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXV-WbgFqTM5MjQ2MDU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd6b5f9a47d99d6a466a2e206c71d0ee00601a22", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/cd6b5f9a47d99d6a466a2e206c71d0ee00601a22", "committedDate": "2020-03-25T22:54:38Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning"}, "afterCommit": {"oid": "1e6e711e1c2fac5d54dc2a54ed423b7c3b45b9e0", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/1e6e711e1c2fac5d54dc2a54ed423b7c3b45b9e0", "committedDate": "2020-03-26T16:59:49Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0Nzc3OTI5", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-384777929", "createdAt": "2020-03-31T14:16:11Z", "commit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDoxNjoxMVrOF-X-pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMDo1M1rOF-an7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0ODkwMA==", "bodyText": "port should just be int or Integer", "url": "https://github.com/apache/storm/pull/3237#discussion_r400948900", "createdAt": "2020-03-31T14:16:11Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/utils/Utils.java", "diffHunk": "@@ -124,11 +124,47 @@\n     private static String memoizedLocalHostnameString = null;\n     public static final Pattern TOPOLOGY_KEY_PATTERN = Pattern.compile(\"^[\\\\w \\\\t\\\\._-]+$\", Pattern.UNICODE_CHARACTER_CLASS);\n \n+    public static final String NUMA_MEMORY_IN_MB = \"numa.memory.mb\";\n+    public static final String NUMA_CORES = \"numa.cores\";\n+    public static final String NUMA_PORTS = \"numa.ports\";\n+    public static final String NUMA_GENERIC_RESOURCES_MAP = \"numa.generic.resources.map\";\n+\n     static {\n         localConf = readStormConfig();\n         serializationDelegate = getSerializationDelegate(localConf);\n     }\n \n+    /**\n+     * Return supervisor numa configuration.\n+     * @param stormConf stormConf\n+     * @return getNumaMap\n+     */\n+    public static Map<String, Object> getNumaMap(Map<String, Object> stormConf) {\n+        Object numa = stormConf.get(Config.SUPERVISOR_NUMA_META);\n+        if (numa == null) {\n+            return Collections.emptyMap();\n+        }\n+        return (Map<String, Object>) numa;\n+    }\n+\n+    /**\n+     * getNumaIdForPort.\n+     * @param port port\n+     * @param stormConf stormConf\n+     * @return getNumaIdForPort\n+     */\n+    public static String getNumaIdForPort(Number port, Map<String, Object> stormConf) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0OTA3OQ==", "bodyText": "Map should be Map<String, Object>", "url": "https://github.com/apache/storm/pull/3237#discussion_r400949079", "createdAt": "2020-03-31T14:16:24Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/utils/Utils.java", "diffHunk": "@@ -124,11 +124,47 @@\n     private static String memoizedLocalHostnameString = null;\n     public static final Pattern TOPOLOGY_KEY_PATTERN = Pattern.compile(\"^[\\\\w \\\\t\\\\._-]+$\", Pattern.UNICODE_CHARACTER_CLASS);\n \n+    public static final String NUMA_MEMORY_IN_MB = \"numa.memory.mb\";\n+    public static final String NUMA_CORES = \"numa.cores\";\n+    public static final String NUMA_PORTS = \"numa.ports\";\n+    public static final String NUMA_GENERIC_RESOURCES_MAP = \"numa.generic.resources.map\";\n+\n     static {\n         localConf = readStormConfig();\n         serializationDelegate = getSerializationDelegate(localConf);\n     }\n \n+    /**\n+     * Return supervisor numa configuration.\n+     * @param stormConf stormConf\n+     * @return getNumaMap\n+     */\n+    public static Map<String, Object> getNumaMap(Map<String, Object> stormConf) {\n+        Object numa = stormConf.get(Config.SUPERVISOR_NUMA_META);\n+        if (numa == null) {\n+            return Collections.emptyMap();\n+        }\n+        return (Map<String, Object>) numa;\n+    }\n+\n+    /**\n+     * getNumaIdForPort.\n+     * @param port port\n+     * @param stormConf stormConf\n+     * @return getNumaIdForPort\n+     */\n+    public static String getNumaIdForPort(Number port, Map<String, Object> stormConf) {\n+        Map<String, Object> validatedNumaMap = getNumaMap(stormConf);\n+        for (Entry<String, Object> numaEntry : validatedNumaMap.entrySet()) {\n+            Map numaMap  = (Map<String, Object>) numaEntry.getValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0OTg0NQ==", "bodyText": "Map should be Map<String, Object>", "url": "https://github.com/apache/storm/pull/3237#discussion_r400949845", "createdAt": "2020-03-31T14:17:21Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/validation/ConfigValidation.java", "diffHunk": "@@ -416,6 +423,41 @@ public void validateInteger(String name, Object o) {\n         }\n     }\n \n+    public static class NumaEntryValidator extends Validator {\n+\n+        @Override\n+        public void validateField(String name, Object o) {\n+            if (o == null) {\n+                return;\n+            }\n+            Map numa = (Map<String, Object>) o;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk1MDc1Mg==", "bodyText": "Set should be Set<Integer>;  HashSet should be HashSet<>", "url": "https://github.com/apache/storm/pull/3237#discussion_r400950752", "createdAt": "2020-03-31T14:18:29Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/validation/ConfigValidation.java", "diffHunk": "@@ -416,6 +423,41 @@ public void validateInteger(String name, Object o) {\n         }\n     }\n \n+    public static class NumaEntryValidator extends Validator {\n+\n+        @Override\n+        public void validateField(String name, Object o) {\n+            if (o == null) {\n+                return;\n+            }\n+            Map numa = (Map<String, Object>) o;\n+            for (String key : new String[]{NUMA_CORES, NUMA_MEMORY_IN_MB, NUMA_PORTS}) {\n+                if (!numa.containsKey(key)) {\n+                    throw new IllegalArgumentException(\n+                            \"The numa configuration key [\" + key + \"] is missing!\"\n+                    );\n+                }\n+            }\n+\n+            List<Integer> cores = (List<Integer>) numa.get(NUMA_CORES);\n+            Set coreSet = new HashSet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk1MjU0Mg==", "bodyText": "initialization can be removed here", "url": "https://github.com/apache/storm/pull/3237#discussion_r400952542", "createdAt": "2020-03-31T14:20:38Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -50,6 +54,7 @@\n     private CgroupCommon rootCgroup;\n     private String rootDir;\n     private Map<String, Object> conf;\n+    protected Map<String, Object> validatedNumaMap = new ConcurrentHashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2NzA3NQ==", "bodyText": "This changes Container attribute supervisorId when it mkLaunchCommand, which means the supervisorId is different depending on whether it calles mkLaunchCommand or not. I am afraid it might introduce confusions.", "url": "https://github.com/apache/storm/pull/3237#discussion_r400967075", "createdAt": "2020-03-31T14:39:14Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/BasicContainer.java", "diffHunk": "@@ -665,8 +666,10 @@ protected String javaCmd(String cmd) {\n         commandList.addAll(classPathParams);\n         commandList.add(getWorkerMain(topoVersion));\n         commandList.add(topologyId);\n+        if (numaId != null) {\n+            supervisorId += Constants.NUMA_ID_SEPARATOR + numaId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk5MjIzOA==", "bodyText": "Is this a different implementation than what we have internally?\nInternally you used numactl. Here seems to be using cgroup directly. Is this well tested?", "url": "https://github.com/apache/storm/pull/3237#discussion_r400992238", "createdAt": "2020-03-31T15:10:53Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -203,6 +209,30 @@ public void reserveResourcesForWorker(String workerId, Integer totalMem, Integer\n             }\n         }\n \n+        if (numaId != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODMzNzgw", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-384833780", "createdAt": "2020-03-31T15:11:41Z", "commit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMTo0MVrOF-aqUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMTo0MVrOF-aqUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk5Mjg0OQ==", "bodyText": "Should be Map<String, Object>,  HashMap<>", "url": "https://github.com/apache/storm/pull/3237#discussion_r400992849", "createdAt": "2020-03-31T15:11:41Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/test/java/org/apache/storm/TestCgroups.java", "diffHunk": "@@ -43,6 +45,16 @@\n     public void testSetupAndTearDown() throws IOException {\n         Config config = new Config();\n         config.putAll(Utils.readDefaultConfig());\n+\n+        Map numaNode = new HashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODM1NTAw", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-384835500", "createdAt": "2020-03-31T15:13:27Z", "commit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMzoyN1rOF-avtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMzoyN1rOF-avtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk5NDIzMA==", "bodyText": "This should include key/value type too.", "url": "https://github.com/apache/storm/pull/3237#discussion_r400994230", "createdAt": "2020-03-31T15:13:27Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/test/java/org/apache/storm/TestCgroups.java", "diffHunk": "@@ -43,6 +45,16 @@\n     public void testSetupAndTearDown() throws IOException {\n         Config config = new Config();\n         config.putAll(Utils.readDefaultConfig());\n+\n+        Map numaNode = new HashMap();\n+        numaNode.put(Utils.NUMA_CORES, Collections.singletonList(\"0\"));\n+        numaNode.put(Utils.NUMA_PORTS, Collections.singletonList(8081));\n+        numaNode.put(Utils.NUMA_MEMORY_IN_MB, 2048);\n+        Map numaMap = new HashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODA3MDYx", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-384807061", "createdAt": "2020-03-31T14:45:09Z", "commit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDo0NTowOVrOF-ZYRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNDo1MDozNFrOF-Zplg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk3MTg0Ng==", "bodyText": "Seems like all these file changes might be better added to SupervisorUtils?", "url": "https://github.com/apache/storm/pull/3237#discussion_r400971846", "createdAt": "2020-03-31T14:45:09Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/utils/Utils.java", "diffHunk": "@@ -124,11 +124,47 @@\n     private static String memoizedLocalHostnameString = null;\n     public static final Pattern TOPOLOGY_KEY_PATTERN = Pattern.compile(\"^[\\\\w \\\\t\\\\._-]+$\", Pattern.UNICODE_CHARACTER_CLASS);\n \n+    public static final String NUMA_MEMORY_IN_MB = \"numa.memory.mb\";\n+    public static final String NUMA_CORES = \"numa.cores\";\n+    public static final String NUMA_PORTS = \"numa.ports\";\n+    public static final String NUMA_GENERIC_RESOURCES_MAP = \"numa.generic.resources.map\";\n+\n     static {\n         localConf = readStormConfig();\n         serializationDelegate = getSerializationDelegate(localConf);\n     }\n \n+    /**\n+     * Return supervisor numa configuration.\n+     * @param stormConf stormConf\n+     * @return getNumaMap\n+     */\n+    public static Map<String, Object> getNumaMap(Map<String, Object> stormConf) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk3NjI3OA==", "bodyText": "I think we should add a doc describing this feature.", "url": "https://github.com/apache/storm/pull/3237#discussion_r400976278", "createdAt": "2020-03-31T14:50:34Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/Config.java", "diffHunk": "@@ -1096,6 +1096,24 @@\n     @IsPositiveNumber\n     @NotNull\n     public static final String SUPERVISOR_WORKER_TIMEOUT_SECS = \"supervisor.worker.timeout.secs\";\n+\n+    /**\n+     * A map with keys mapped to each NUMA Node on the supervisor that will be used", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/bde274c792efc3cea0eada85f9231236ff135554", "committedDate": "2020-03-30T20:53:43Z", "message": "STORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch."}, "afterCommit": {"oid": "55917162935041ab0efc027890926b077122db38", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/55917162935041ab0efc027890926b077122db38", "committedDate": "2020-03-31T21:18:28Z", "message": "STORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a710d67514c5749f9256ace8e64d1dffe4f813f", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9a710d67514c5749f9256ace8e64d1dffe4f813f", "committedDate": "2020-03-31T21:31:56Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}, "afterCommit": {"oid": "9514392cdf0de851e9bf4d45597aacb4c287ab4e", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9514392cdf0de851e9bf4d45597aacb4c287ab4e", "committedDate": "2020-03-31T21:33:06Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9514392cdf0de851e9bf4d45597aacb4c287ab4e", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9514392cdf0de851e9bf4d45597aacb4c287ab4e", "committedDate": "2020-03-31T21:33:06Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}, "afterCommit": {"oid": "8b5363ef7bd30ca4a27ed64b1a4bd524fe45e1af", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/8b5363ef7bd30ca4a27ed64b1a4bd524fe45e1af", "committedDate": "2020-03-31T21:34:27Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b5363ef7bd30ca4a27ed64b1a4bd524fe45e1af", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/8b5363ef7bd30ca4a27ed64b1a4bd524fe45e1af", "committedDate": "2020-03-31T21:34:27Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}, "afterCommit": {"oid": "cceb0e1152a4935d8cc48847a74eb2ed88cb7d61", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/cceb0e1152a4935d8cc48847a74eb2ed88cb7d61", "committedDate": "2020-03-31T21:35:05Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cceb0e1152a4935d8cc48847a74eb2ed88cb7d61", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/cceb0e1152a4935d8cc48847a74eb2ed88cb7d61", "committedDate": "2020-03-31T21:35:05Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}, "afterCommit": {"oid": "571a758f6bd8016d47c7032c3519665c75109641", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/571a758f6bd8016d47c7032c3519665c75109641", "committedDate": "2020-03-31T21:57:11Z", "message": "STORM-3259: Addresses review comments on NUMA pinning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NjI3NjAw", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-385627600", "createdAt": "2020-04-01T14:14:49Z", "commit": {"oid": "571a758f6bd8016d47c7032c3519665c75109641"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDoxNDo1MFrOF_Cr-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDoxOToyMVrOF_C4nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY0ODYzMw==", "bodyText": "Can we add a tracking JIRA?", "url": "https://github.com/apache/storm/pull/3237#discussion_r401648633", "createdAt": "2020-04-01T14:14:50Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/Config.java", "diffHunk": "@@ -1096,6 +1096,24 @@\n     @IsPositiveNumber\n     @NotNull\n     public static final String SUPERVISOR_WORKER_TIMEOUT_SECS = \"supervisor.worker.timeout.secs\";\n+\n+    /**\n+     * A map with keys mapped to each NUMA Node on the supervisor that will be used", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk3NjI3OA=="}, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY1MDA1Mg==", "bodyText": "That makes sense.", "url": "https://github.com/apache/storm/pull/3237#discussion_r401650052", "createdAt": "2020-04-01T14:16:45Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/utils/Utils.java", "diffHunk": "@@ -124,11 +124,47 @@\n     private static String memoizedLocalHostnameString = null;\n     public static final Pattern TOPOLOGY_KEY_PATTERN = Pattern.compile(\"^[\\\\w \\\\t\\\\._-]+$\", Pattern.UNICODE_CHARACTER_CLASS);\n \n+    public static final String NUMA_MEMORY_IN_MB = \"numa.memory.mb\";\n+    public static final String NUMA_CORES = \"numa.cores\";\n+    public static final String NUMA_PORTS = \"numa.ports\";\n+    public static final String NUMA_GENERIC_RESOURCES_MAP = \"numa.generic.resources.map\";\n+\n     static {\n         localConf = readStormConfig();\n         serializationDelegate = getSerializationDelegate(localConf);\n     }\n \n+    /**\n+     * Return supervisor numa configuration.\n+     * @param stormConf stormConf\n+     * @return getNumaMap\n+     */\n+    public static Map<String, Object> getNumaMap(Map<String, Object> stormConf) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk3MTg0Ng=="}, "originalCommit": {"oid": "bde274c792efc3cea0eada85f9231236ff135554"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY1MTg2OQ==", "bodyText": "This one seems to be used only in storm-server.  Can we make this one SupervisorUtils?\nPlease update the java doc to indicate this is specific to a single supervisor.  stormConf could be renamed supervisorConf for clarity on this.", "url": "https://github.com/apache/storm/pull/3237#discussion_r401651869", "createdAt": "2020-04-01T14:19:21Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/utils/Utils.java", "diffHunk": "@@ -124,11 +124,47 @@\n     private static String memoizedLocalHostnameString = null;\n     public static final Pattern TOPOLOGY_KEY_PATTERN = Pattern.compile(\"^[\\\\w \\\\t\\\\._-]+$\", Pattern.UNICODE_CHARACTER_CLASS);\n \n+    public static final String NUMA_MEMORY_IN_MB = \"numa.memory.mb\";\n+    public static final String NUMA_CORES = \"numa.cores\";\n+    public static final String NUMA_PORTS = \"numa.ports\";\n+    public static final String NUMA_GENERIC_RESOURCES_MAP = \"numa.generic.resources.map\";\n+\n     static {\n         localConf = readStormConfig();\n         serializationDelegate = getSerializationDelegate(localConf);\n     }\n \n+    /**\n+     * Return supervisor numa configuration.\n+     * @param stormConf stormConf\n+     * @return getNumaMap\n+     */\n+    public static Map<String, Object> getNumaMap(Map<String, Object> stormConf) {\n+        Object numa = stormConf.get(Config.SUPERVISOR_NUMA_META);\n+        if (numa == null) {\n+            return Collections.emptyMap();\n+        }\n+        return (Map<String, Object>) numa;\n+    }\n+\n+    /**\n+     * getNumaIdForPort.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "571a758f6bd8016d47c7032c3519665c75109641"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9f0abe51b62496c7f46fa33e46e2f3093f8aabf", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/c9f0abe51b62496c7f46fa33e46e2f3093f8aabf", "committedDate": "2020-04-01T20:34:53Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/01dbf8a06b8d3fe1205794aa69f4091e0783cd07", "committedDate": "2020-04-01T20:37:05Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODAwMDk2", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-386800096", "createdAt": "2020-04-02T21:46:10Z", "commit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMTo0NjoxMFrOF_9pPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMTo1Mzo0MVrOF_92MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYxNDU4OQ==", "bodyText": "L112 and L114 conflict.  And validatedNumaMap doesn't seem to be used anywhere", "url": "https://github.com/apache/storm/pull/3237#discussion_r402614589", "createdAt": "2020-04-02T21:46:10Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -102,6 +109,9 @@ public void prepare(Map<String, Object> conf) throws IOException {\n             throw new RuntimeException(\"Cgroup error, please check /proc/cgroups\");\n         }\n         this.prepareSubSystem(this.conf);\n+        validatedNumaMap = Utils.getNumaMap(conf);\n+        workerToNumaId = new ConcurrentHashMap();\n+        validatedNumaMap = new ConcurrentHashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYxNTE5Mw==", "bodyText": "missing @param numaId", "url": "https://github.com/apache/storm/pull/3237#discussion_r402615193", "createdAt": "2020-04-02T21:47:32Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/ResourceIsolationInterface.java", "diffHunk": "@@ -37,7 +37,7 @@\n      * @param workerMemory the amount of memory for the worker or null if not enforced\n      * @param workerCpu the amount of cpu for the worker or null if not enforced\n      */\n-    void reserveResourcesForWorker(String workerId, Integer workerMemory, Integer workerCpu);\n+    void reserveResourcesForWorker(String workerId, Integer workerMemory, Integer workerCpu, String numaId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYxNzkwNA==", "bodyText": "numaId not used anywhere?", "url": "https://github.com/apache/storm/pull/3237#discussion_r402617904", "createdAt": "2020-04-02T21:53:41Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/BasicContainer.java", "diffHunk": "@@ -615,7 +616,7 @@ protected String javaCmd(String cmd) {\n      * @throws IOException on any error.\n      */\n     private List<String> mkLaunchCommand(final int memOnheap, final String stormRoot,\n-                                         final String jlp) throws IOException {\n+                                         final String jlp, final String numaId) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01dbf8a06b8d3fe1205794aa69f4091e0783cd07", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/01dbf8a06b8d3fe1205794aa69f4091e0783cd07", "committedDate": "2020-04-01T20:37:05Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "390a97a47faae8383aee4e9821d444225f1d6649", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/390a97a47faae8383aee4e9821d444225f1d6649", "committedDate": "2020-04-03T15:09:26Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "390a97a47faae8383aee4e9821d444225f1d6649", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/390a97a47faae8383aee4e9821d444225f1d6649", "committedDate": "2020-04-03T15:09:26Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "1a88d046ea8f92de7e064640a6317b6dc1fe3669", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/1a88d046ea8f92de7e064640a6317b6dc1fe3669", "committedDate": "2020-04-03T15:19:46Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1a88d046ea8f92de7e064640a6317b6dc1fe3669", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/1a88d046ea8f92de7e064640a6317b6dc1fe3669", "committedDate": "2020-04-03T15:19:46Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "f45951c16f42c82d6f59d63db368dc0994c6d4e0", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/f45951c16f42c82d6f59d63db368dc0994c6d4e0", "committedDate": "2020-04-06T19:33:42Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MTcwMjY3", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-389170267", "createdAt": "2020-04-07T14:25:43Z", "commit": {"oid": "f45951c16f42c82d6f59d63db368dc0994c6d4e0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoyNTo0M1rOGCGKHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoyNTo0M1rOGCGKHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg1MTIyOA==", "bodyText": "This should be removed according to the change in BasicContainer. mkLaunchCommand", "url": "https://github.com/apache/storm/pull/3237#discussion_r404851228", "createdAt": "2020-04-07T14:25:43Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/Container.java", "diffHunk": "@@ -130,6 +131,10 @@ protected Container(ContainerType type, Map<String, Object> conf, String supervi\n         this.ops = ops;\n         this.conf = conf;\n         this.supervisorId = supervisorId;\n+        String numaId = SupervisorUtils.getNumaIdForPort(port, conf);\n+        if (numaId != null) {\n+            this.supervisorId +=  Constants.NUMA_ID_SEPARATOR + numaId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f45951c16f42c82d6f59d63db368dc0994c6d4e0"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f45951c16f42c82d6f59d63db368dc0994c6d4e0", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/f45951c16f42c82d6f59d63db368dc0994c6d4e0", "committedDate": "2020-04-06T19:33:42Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7", "committedDate": "2020-04-07T15:23:06Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MzU5MTk1", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-389359195", "createdAt": "2020-04-07T17:57:49Z", "commit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNzo1Nzo0OVrOGCPhaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNzo1Nzo0OVrOGCPhaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAwNDY0OQ==", "bodyText": "Is this used anywhere?", "url": "https://github.com/apache/storm/pull/3237#discussion_r405004649", "createdAt": "2020-04-07T17:57:49Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -102,6 +109,8 @@ public void prepare(Map<String, Object> conf) throws IOException {\n             throw new RuntimeException(\"Cgroup error, please check /proc/cgroups\");\n         }\n         this.prepareSubSystem(this.conf);\n+        validatedNumaMap = Utils.getNumaMap(conf);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NDY0OTA2", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-389464906", "createdAt": "2020-04-07T20:27:47Z", "commit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMDoyNzo0N1rOGCU0bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMDoyNzo0N1rOGCU0bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA5MTQzNg==", "bodyText": "I think line should be pulled into buildSupervisorInfo(). It appears that the intent is to create as many supervisorInfo records as there are Config.SUPERVISOR_NUMA_META entries with any leftover creating another SupervisorInfo(). And private buildSupervisorInfo() method is never called with validatedNumaMap of null. Each of these supervisorInfos creating a heartbeat-er.", "url": "https://github.com/apache/storm/pull/3237#discussion_r405091436", "createdAt": "2020-04-07T20:27:47Z", "author": {"login": "bipinprasad"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/timer/SupervisorHeartbeat.java", "diffHunk": "@@ -87,12 +153,16 @@ private SupervisorInfo buildSupervisorInfo(Map<String, Object> conf, Supervisor\n             ret.put(stringNumberEntry.getKey(), stringNumberEntry.getValue().doubleValue());\n         }\n \n+        LOG.debug(NormalizedResources.RESOURCE_NAME_NORMALIZER.normalizedResourceMap(ret).toString());\n         return NormalizedResources.RESOURCE_NAME_NORMALIZER.normalizedResourceMap(ret);\n     }\n \n     @Override\n     public void run() {\n-        SupervisorInfo supervisorInfo = buildSupervisorInfo(conf, supervisor);\n-        stormClusterState.supervisorHeartbeat(supervisorId, supervisorInfo);\n+        Map<String, Object> validatedNumaMap = Utils.getNumaMap(conf);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7"}, "originalPosition": 152}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/10a2d1c03de04ea85e59184e0eff6d3a6a0ec6d7", "committedDate": "2020-04-07T15:23:06Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "a56d727f46393493b7bd16b0bded31ef001fba3b", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/a56d727f46393493b7bd16b0bded31ef001fba3b", "committedDate": "2020-04-09T14:55:54Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwOTQ0MjY1", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-390944265", "createdAt": "2020-04-09T16:23:43Z", "commit": {"oid": "a56d727f46393493b7bd16b0bded31ef001fba3b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNjoyMzo0NFrOGDgDRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNjoyMzo0NFrOGDgDRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMyNDAzOQ==", "bodyText": "can this be removed?", "url": "https://github.com/apache/storm/pull/3237#discussion_r406324039", "createdAt": "2020-04-09T16:23:44Z", "author": {"login": "Ethanlm"}, "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -50,6 +55,8 @@\n     private CgroupCommon rootCgroup;\n     private String rootDir;\n     private Map<String, Object> conf;\n+    private Map<String, String> workerToNumaId;\n+    protected Map<String, Object> validatedNumaMap;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56d727f46393493b7bd16b0bded31ef001fba3b"}, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a56d727f46393493b7bd16b0bded31ef001fba3b", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/a56d727f46393493b7bd16b0bded31ef001fba3b", "committedDate": "2020-04-09T14:55:54Z", "message": "STORM-3259: Addresses 2nd round of review comments"}, "afterCommit": {"oid": "9bf1dbc51498f37b64bb7eb558d4973887e5f80b", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9bf1dbc51498f37b64bb7eb558d4973887e5f80b", "committedDate": "2020-04-09T17:03:05Z", "message": "STORM-3259: Addresses 2nd round of review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38c2052d5b549897903605a0973633e6778aac91", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/38c2052d5b549897903605a0973633e6778aac91", "committedDate": "2020-04-10T17:59:31Z", "message": "STORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}, "afterCommit": {"oid": "9809635d75c3edb11adfb4f539cc40b7ef8f1503", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9809635d75c3edb11adfb4f539cc40b7ef8f1503", "committedDate": "2020-04-10T18:07:19Z", "message": "STORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9809635d75c3edb11adfb4f539cc40b7ef8f1503", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/9809635d75c3edb11adfb4f539cc40b7ef8f1503", "committedDate": "2020-04-10T18:07:19Z", "message": "STORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}, "afterCommit": {"oid": "d776127d1238852ddacd04fe53912856048bf95a", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/d776127d1238852ddacd04fe53912856048bf95a", "committedDate": "2020-04-10T18:09:46Z", "message": "STORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNjI0NDAz", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-391624403", "createdAt": "2020-04-10T19:39:39Z", "commit": {"oid": "d776127d1238852ddacd04fe53912856048bf95a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d776127d1238852ddacd04fe53912856048bf95a", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/d776127d1238852ddacd04fe53912856048bf95a", "committedDate": "2020-04-10T18:09:46Z", "message": "STORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}, "afterCommit": {"oid": "130a077a9f7ffcb9fd8eabe1465172f374c2e4d2", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/130a077a9f7ffcb9fd8eabe1465172f374c2e4d2", "committedDate": "2020-04-10T19:57:45Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning\n\nSTORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch.\n\nSTORM-3259: Addresses review comments on NUMA pinning\n\nSTORM-3259: Addresses 2nd round of review comments\n\nSTORM-3259: Moves getNumaConf to SupervisorUtils from Utils\n\nSTORM-3259: Cleanup of unnecessary changes\n\nSTORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjc0ODcx", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-392274871", "createdAt": "2020-04-13T16:54:10Z", "commit": {"oid": "130a077a9f7ffcb9fd8eabe1465172f374c2e4d2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDMyMTc4", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-392432178", "createdAt": "2020-04-13T20:54:38Z", "commit": {"oid": "130a077a9f7ffcb9fd8eabe1465172f374c2e4d2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMDo1NDozOVrOGE09qQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMDo1NDozOVrOGE09qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzcxNTI0MQ==", "bodyText": "remove unused import", "url": "https://github.com/apache/storm/pull/3237#discussion_r407715241", "createdAt": "2020-04-13T20:54:39Z", "author": {"login": "kishorvpatil"}, "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/Container.java", "diffHunk": "@@ -37,6 +37,7 @@\n import java.util.Set;\n import org.apache.commons.lang.StringUtils;\n import org.apache.storm.Config;\n+import org.apache.storm.Constants;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "130a077a9f7ffcb9fd8eabe1465172f374c2e4d2"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "632d32039031c7e6bbe29ecce2d9833c1a677b76", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/632d32039031c7e6bbe29ecce2d9833c1a677b76", "committedDate": "2020-04-13T21:36:35Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning\n\nSTORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch.\n\nSTORM-3259: Addresses review comments on NUMA pinning\n\nSTORM-3259: Addresses 2nd round of review comments\n\nSTORM-3259: Moves getNumaConf to SupervisorUtils from Utils\n\nSTORM-3259: Cleanup of unnecessary changes\n\nSTORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "130a077a9f7ffcb9fd8eabe1465172f374c2e4d2", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/130a077a9f7ffcb9fd8eabe1465172f374c2e4d2", "committedDate": "2020-04-10T19:57:45Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning\n\nSTORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch.\n\nSTORM-3259: Addresses review comments on NUMA pinning\n\nSTORM-3259: Addresses 2nd round of review comments\n\nSTORM-3259: Moves getNumaConf to SupervisorUtils from Utils\n\nSTORM-3259: Cleanup of unnecessary changes\n\nSTORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}, "afterCommit": {"oid": "632d32039031c7e6bbe29ecce2d9833c1a677b76", "author": {"user": {"login": "govind-menon", "name": "Govind Menon"}}, "url": "https://github.com/apache/storm/commit/632d32039031c7e6bbe29ecce2d9833c1a677b76", "committedDate": "2020-04-13T21:36:35Z", "message": "STORM-3259: Adds NUMA awareness to enable worker pinning\n\nSTORM-3259: Properly sends supervisor assignments on topology kill. Originally done by Aaron Gresch.\n\nSTORM-3259: Addresses review comments on NUMA pinning\n\nSTORM-3259: Addresses 2nd round of review comments\n\nSTORM-3259: Moves getNumaConf to SupervisorUtils from Utils\n\nSTORM-3259: Cleanup of unnecessary changes\n\nSTORM-3259: Creates separate storm-server specific constants and helper files and moves NUMA to them"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDYwNTQ4", "url": "https://github.com/apache/storm/pull/3237#pullrequestreview-392460548", "createdAt": "2020-04-13T21:42:27Z", "commit": {"oid": "632d32039031c7e6bbe29ecce2d9833c1a677b76"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4539, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}