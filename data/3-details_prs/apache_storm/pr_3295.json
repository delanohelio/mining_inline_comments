{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNjEzMzQx", "number": 3295, "title": "STORM-3660: Remove use of queues for updating credentials", "bodyText": "What is the purpose of the change\n\nThe change would eliminate use of __credentials stream  and corresponding control message to invoke ICredentialsListener method on component. Instead now each Executor has its own flag where need for refreshing credentials is flagged by worker any time there is change in credentials.\n\nHow was the change tested\nAfter launching topology, wait for workertokens to be refreshed by nimbus, I noticed below changes in the worker log suggesting each executor has received the newer worker tokens:\n2020-06-25 18:07:43.289 o.a.s.s.a.ClientAuthUtils main-EventThread [INFO] Replaced WorkerToken for service type DRPC\n2020-06-25 18:07:43.289 o.a.s.s.a.ClientAuthUtils main-EventThread [INFO] Replaced WorkerToken for service type SUPERVISOR\n2020-06-25 18:07:43.289 o.a.s.e.Executor Thread-18-split-executor[10, 10] [INFO] The credentials are being updated [10, 10].\n2020-06-25 18:07:43.289 o.a.s.e.Executor Thread-25-count-executor[3, 3] [INFO] The credentials are being updated [3, 3].\n2020-06-25 18:07:43.294 o.a.s.e.Executor Thread-29-split-executor[9, 9] [INFO] The credentials are being updated [9, 9].\n2020-06-25 18:07:43.296 o.a.s.e.Executor Thread-20-count-executor[6, 6] [INFO] The credentials are being updated [6, 6].\n2020-06-25 18:07:43.298 o.a.s.e.Executor Thread-26-__acker-executor[1, 1] [INFO] The credentials are being updated [1, 1].\n2020-06-25 18:07:43.298 o.a.s.e.Executor Thread-19-split-executor[8, 8] [INFO] The credentials are being updated [8, 8].\n2020-06-25 18:07:43.309 o.a.s.e.Executor Thread-28-spout-executor[11, 11] [INFO] The credentials are being updated [11, 11].\n2020-06-25 18:07:43.309 o.a.s.e.Executor Thread-21-count-executor[4, 4] [INFO] The credentials are being updated [4, 4].\n2020-06-25 18:07:43.309 o.a.s.e.Executor Thread-16-spout-executor[14, 14] [INFO] The credentials are being updated [14, 14].\n2020-06-25 18:07:43.309 o.a.s.e.Executor Thread-17-spout-executor[12, 12] [INFO] The credentials are being updated [12, 12].\n2020-06-25 18:07:43.311 o.a.s.e.Executor Thread-27-spout-executor[13, 13] [INFO] The credentials are being updated [13, 13].\n2020-06-25 18:07:43.316 o.a.s.e.Executor Thread-23-split-executor[7, 7] [INFO] The credentials are being updated [7, 7].\n2020-06-25 18:07:43.316 o.a.s.e.Executor Thread-24-count-executor[5, 5] [INFO] The credentials are being updated [5, 5].```", "createdAt": "2020-06-26T14:20:02Z", "url": "https://github.com/apache/storm/pull/3295", "merged": true, "mergeCommit": {"oid": "93a7f770d508668bc7af183e08535813fff6f805"}, "closed": true, "closedAt": "2020-07-14T15:10:49Z", "author": {"login": "kishorvpatil"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvENHSAFqTQzODM0NzYyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczqccXAFqTQ0NjcwODQ5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzQ3NjI1", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-438347625", "createdAt": "2020-06-26T14:34:28Z", "commit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzY2NzI2", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-438366726", "createdAt": "2020-06-26T14:58:11Z", "commit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNDo1ODoxMVrOGpkHCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNDo1ODoxMVrOGpkHCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjIzNjQyNQ==", "bodyText": "I think maybe we should first set  this.needToRefreshCreds to false and then update the creds.  Imagine we uploaded credentials twice in a row and this loaded the first creds and the thread paused.  It would then clear the update flag and miss the second credentials upload.", "url": "https://github.com/apache/storm/pull/3295#discussion_r446236425", "createdAt": "2020-06-26T14:58:11Z", "author": {"login": "agresch"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -270,6 +273,15 @@ public ExecutorShutdown execute() throws Exception {\n \n     @Override\n     public void accept(Object event) {\n+        if (this.needToRefreshCreds) {\n+            LOG.info(\"The credentials are being updated {}.\", executorId);\n+            Credentials creds = this.workerData.getCredentials();\n+            idToTask.stream().map(Task::getTaskObject).filter(taskObject -> taskObject instanceof ICredentialsListener)\n+                    .forEach(taskObject -> {\n+                        ((ICredentialsListener) taskObject).setCredentials(creds == null ? null : creds.get_creds());\n+                    });\n+            this.needToRefreshCreds = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzkyMDkz", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-438392093", "createdAt": "2020-06-26T15:30:44Z", "commit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNTozMDo0NFrOGplPtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNTozMDo0NFrOGplPtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI1NTAzMQ==", "bodyText": "Minor: Does this method name and signature needs to change since it is setting a flag and not using the supplied parameter?", "url": "https://github.com/apache/storm/pull/3295#discussion_r446255031", "createdAt": "2020-06-26T15:30:44Z", "author": {"login": "bipinprasad"}, "path": "storm-client/src/jvm/org/apache/storm/executor/ExecutorShutdown.java", "diffHunk": "@@ -60,16 +60,7 @@ public ExecutorStats renderStats() {\n \n     @Override\n     public void credentialsChanged(Credentials credentials) {\n-        TupleImpl tuple = new TupleImpl(executor.getWorkerTopologyContext(), new Values(credentials),\n-                                        Constants.SYSTEM_COMPONENT_ID, (int) Constants.SYSTEM_TASK_ID,\n-                                        Constants.CREDENTIALS_CHANGED_STREAM_ID);\n-        AddressedTuple addressedTuple = new AddressedTuple(AddressedTuple.BROADCAST_DEST, tuple);\n-        try {\n-            executor.getReceiveQueue().publish(addressedTuple);\n-            executor.getReceiveQueue().flush();\n-        } catch (InterruptedException e) {\n-            throw new RuntimeException(e);\n-        }\n+        executor.needToRefreshCreds = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzkyMzI4", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-438392328", "createdAt": "2020-06-26T15:31:02Z", "commit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/f8c56e2e4d26a1d41dcccb097b8642ad705d14ba", "committedDate": "2020-06-26T20:45:36Z", "message": "STORM-3660: Remove use of queues for updating credentials"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c4fd31087a4ffcc6d01ec7895c92ff1693c9973", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/5c4fd31087a4ffcc6d01ec7895c92ff1693c9973", "committedDate": "2020-06-26T14:14:17Z", "message": "STORM-3660: Remove use of queues for updating credentials"}, "afterCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/f8c56e2e4d26a1d41dcccb097b8642ad705d14ba", "committedDate": "2020-06-26T20:45:36Z", "message": "STORM-3660: Remove use of queues for updating credentials"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMDY4MzI5", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-440068329", "createdAt": "2020-06-30T14:23:27Z", "commit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDoyMzoyOFrOGq-4DQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNjowNDoyOFrOGrDkyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcyMzUzMw==", "bodyText": "This can be private", "url": "https://github.com/apache/storm/pull/3295#discussion_r447723533", "createdAt": "2020-06-30T14:23:28Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -124,6 +126,7 @@\n     protected int idToTaskBase;\n     protected String hostname;\n     private static final double msDurationFactor = 1.0 / TimeUnit.MILLISECONDS.toNanos(1);\n+    protected boolean needToRefreshCreds = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczNTI2Mw==", "bodyText": "This can be private", "url": "https://github.com/apache/storm/pull/3295#discussion_r447735263", "createdAt": "2020-06-30T14:38:20Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/daemon/worker/WorkerState.java", "diffHunk": "@@ -152,6 +153,7 @@\n     private final AtomicLong nextLoadUpdate = new AtomicLong(0);\n     private final boolean trySerializeLocal;\n     private final Collection<IAutoCredentials> autoCredentials;\n+    AtomicReference<Credentials> credentialsAtom;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczOTA4Ng==", "bodyText": "This can be debug.", "url": "https://github.com/apache/storm/pull/3295#discussion_r447739086", "createdAt": "2020-06-30T14:43:04Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -270,6 +273,15 @@ public ExecutorShutdown execute() throws Exception {\n \n     @Override\n     public void accept(Object event) {\n+        if (this.needToRefreshCreds) {\n+            this.needToRefreshCreds = false;\n+            LOG.info(\"The credentials are being updated {}.\", executorId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc5NTEwOQ==", "bodyText": "I am seeing possible race condition here.\nBecause  executor.credentialsChanged happens before this.workerState.credentialsAtom.set(newCreds) is invoked, executor could trigger credential update before the newCreds is not updated yet.", "url": "https://github.com/apache/storm/pull/3295#discussion_r447795109", "createdAt": "2020-06-30T15:56:36Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/daemon/worker/Worker.java", "diffHunk": "@@ -415,13 +414,13 @@ public void updateBlobUpdates() throws IOException {\n \n     public void checkCredentialsChanged() {\n         Credentials newCreds = workerState.stormClusterState.credentials(topologyId, null);\n-        if (!ObjectUtils.equals(newCreds, credentialsAtom.get())) {\n+        if (!ObjectUtils.equals(newCreds, this.workerState.credentialsAtom.get())) {\n             // This does not have to be atomic, worst case we update when one is not needed\n             ClientAuthUtils.updateSubject(subject, autoCreds, (null == newCreds) ? null : newCreds.get_creds());\n             for (IRunningExecutor executor : executorsAtom.get()) {\n                 executor.credentialsChanged(newCreds);\n             }\n-            credentialsAtom.set(newCreds);\n+            this.workerState.credentialsAtom.set(newCreds);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc5OTAwMg==", "bodyText": "There seems to be a race condition here.\nThe executor thread consumes from receiveQ and every time it consumes one tuple, the accept method is invoked and needToRefreshCreds is checked.\nThis needToRefreshCreds variable is accessed by others threads (which invoke credentialsChanged) and the value will be updated to true.\nSo first of all, needToRefreshCreds needs to be at least violate. But violate doesn't seem enough because needToRefreshCreds is set to false in this executor thread, and set to true in other threads.\nBetween checking if needToRefreshCreds is true and setting it to be false in the executor thread, needToRefreshCreds could be modified to true in other threads but this information is lost.", "url": "https://github.com/apache/storm/pull/3295#discussion_r447799002", "createdAt": "2020-06-30T16:02:11Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -270,6 +273,15 @@ public ExecutorShutdown execute() throws Exception {\n \n     @Override\n     public void accept(Object event) {\n+        if (this.needToRefreshCreds) {\n+            this.needToRefreshCreds = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgwMDUyMw==", "bodyText": "An issue about checking the value here is it might be blocked.\nThis accept is only called when receiveQueue.consume is called. But it could be blocked so credential update will be delayed.", "url": "https://github.com/apache/storm/pull/3295#discussion_r447800523", "createdAt": "2020-06-30T16:04:28Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -270,6 +273,15 @@ public ExecutorShutdown execute() throws Exception {\n \n     @Override\n     public void accept(Object event) {\n+        if (this.needToRefreshCreds) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8c56e2e4d26a1d41dcccb097b8642ad705d14ba"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a87ba6d14e8d9da9532a914cf6e5dec6c3d813d6", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/a87ba6d14e8d9da9532a914cf6e5dec6c3d813d6", "committedDate": "2020-07-01T13:56:51Z", "message": "Adjust excecutor creds refresh"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "319de216988553c30bd8ddfc878d0da5f49fd141", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/319de216988553c30bd8ddfc878d0da5f49fd141", "committedDate": "2020-07-01T13:42:35Z", "message": "Adjust excecutor creds refresh"}, "afterCommit": {"oid": "a87ba6d14e8d9da9532a914cf6e5dec6c3d813d6", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/a87ba6d14e8d9da9532a914cf6e5dec6c3d813d6", "committedDate": "2020-07-01T13:56:51Z", "message": "Adjust excecutor creds refresh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "899312945724858bd5dfde4ca13b27a5290cec5b", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/899312945724858bd5dfde4ca13b27a5290cec5b", "committedDate": "2020-07-01T14:13:56Z", "message": "Merge branch 'master' of github.com:apache/storm into storm3660"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwOTY0NTYw", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-440964560", "createdAt": "2020-07-01T15:14:13Z", "commit": {"oid": "899312945724858bd5dfde4ca13b27a5290cec5b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxNDoxM1rOGrqQXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxNDo1NlrOGrqSbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNDI2OQ==", "bodyText": "Maybe we should change it to be DEBUG since this is on a critical path (even though this method might not be called very frequently)", "url": "https://github.com/apache/storm/pull/3295#discussion_r448434269", "createdAt": "2020-07-01T15:14:13Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -291,6 +294,22 @@ public void accept(Object event) {\n         }\n     }\n \n+    public void setNeedToRefreshCreds() {\n+        this.needToRefreshCreds = true;\n+    }\n+\n+    protected void updateExecCredsIfRequired() {\n+        if (this.needToRefreshCreds) {\n+            this.needToRefreshCreds = false;\n+            LOG.info(\"The credentials are being updated {}.\", executorId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "899312945724858bd5dfde4ca13b27a5290cec5b"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzNDc5Nw==", "bodyText": "This needs to be volatile  to make sure the changes from other threads can be seen immediately", "url": "https://github.com/apache/storm/pull/3295#discussion_r448434797", "createdAt": "2020-07-01T15:14:56Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -124,6 +126,7 @@\n     protected int idToTaskBase;\n     protected String hostname;\n     private static final double msDurationFactor = 1.0 / TimeUnit.MILLISECONDS.toNanos(1);\n+    private boolean needToRefreshCreds = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "899312945724858bd5dfde4ca13b27a5290cec5b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a817ff8e6c692154426355f58c82fd38e26801c1", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/a817ff8e6c692154426355f58c82fd38e26801c1", "committedDate": "2020-07-09T15:30:45Z", "message": "Use AtomicBoolean for needToRefreshCreds field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1ODQxMTAz", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-445841103", "createdAt": "2020-07-09T17:52:08Z", "commit": {"oid": "a817ff8e6c692154426355f58c82fd38e26801c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNzo1MjowOFrOGvbugQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNzo1MjowOFrOGvbugQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MDUyOQ==", "bodyText": "The initial value should be false to avoid unnecessary update at the beginning.", "url": "https://github.com/apache/storm/pull/3295#discussion_r452390529", "createdAt": "2020-07-09T17:52:08Z", "author": {"login": "Ethanlm"}, "path": "storm-client/src/jvm/org/apache/storm/executor/Executor.java", "diffHunk": "@@ -124,6 +126,7 @@\n     protected int idToTaskBase;\n     protected String hostname;\n     private static final double msDurationFactor = 1.0 / TimeUnit.MILLISECONDS.toNanos(1);\n+    private AtomicBoolean needToRefreshCreds = new AtomicBoolean(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a817ff8e6c692154426355f58c82fd38e26801c1"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d61d17b71ad42b19bd9fb581d0e1ff38770b2615", "author": {"user": {"login": "kishorvpatil", "name": "Kishor Patil"}}, "url": "https://github.com/apache/storm/commit/d61d17b71ad42b19bd9fb581d0e1ff38770b2615", "committedDate": "2020-07-10T21:10:10Z", "message": "STORM-3660: Update default to false on needToRefreshCreds"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzA4NDkw", "url": "https://github.com/apache/storm/pull/3295#pullrequestreview-446708490", "createdAt": "2020-07-10T21:23:18Z", "commit": {"oid": "d61d17b71ad42b19bd9fb581d0e1ff38770b2615"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4618, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}