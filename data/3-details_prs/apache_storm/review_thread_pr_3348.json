{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NjA4Nzgy", "number": 3348, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNTozOTowNFrOFC_YDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNTozNzozOFrOFFqJiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4Njc5ODIyOnYy", "diffSide": "RIGHT", "path": ".travis.yml", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNTozOTowNFrOICbF1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNjo1OTo1NlrOIF7yWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxMTkyNQ==", "bodyText": "The default dist configured above we use is trusty. Should we upgrade the default dist to focal? (it can be a separate work)", "url": "https://github.com/apache/storm/pull/3348#discussion_r539411925", "createdAt": "2020-12-09T15:39:04Z", "author": {"login": "Ethanlm"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg4MTYwNQ==", "bodyText": "Currently, the \"arm64-graviton2\" resources are only available in Xenial, Bonic, Focal dists of Ubuntu, please see the Travis doc\uff0c I just picked a lastest version.", "url": "https://github.com/apache/storm/pull/3348#discussion_r539881605", "createdAt": "2020-12-10T06:19:03Z", "author": {"login": "liusheng"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxMTkyNQ=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1NjkwNA==", "bodyText": "Yeah, I was thinking maybe we can simply this by updating \n  \n    \n      storm/.travis.yml\n    \n    \n         Line 28\n      in\n      fe2f710\n    \n    \n    \n    \n\n        \n          \n           dist: trusty", "url": "https://github.com/apache/storm/pull/3348#discussion_r540256904", "createdAt": "2020-12-10T15:23:10Z", "author": {"login": "Ethanlm"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxMTkyNQ=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA5MzMzOQ==", "bodyText": "OK, let's me try", "url": "https://github.com/apache/storm/pull/3348#discussion_r543093339", "createdAt": "2020-12-15T06:59:56Z", "author": {"login": "liusheng"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxMTkyNQ=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjgxNjEwOnYy", "diffSide": "RIGHT", "path": ".travis.yml", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNTo0MjoxNVrOICbQ9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNzowMjoyM1rOIF72ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxNDc3NA==", "bodyText": "Is it possible to use arm64 directly?\nhttps://docs.travis-ci.com/user/reference/overview/#linux-travisyml-examples", "url": "https://github.com/apache/storm/pull/3348#discussion_r539414774", "createdAt": "2020-12-09T15:42:15Z", "author": {"login": "Ethanlm"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge\n+      arch: arm64-graviton2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg4MTU5MA==", "bodyText": "Hmm,  we have tried using the common arm64 resources, but many modules(especially Integration-Test) are unstable and easy to fail. the new added arm64-graviton is anounced a better performance ARM resources, so switch to use it.\nMaybe we can try back to use the arm64 resources as we have migrated from travis-ci.org to travis-ci.com to see if the problems still occur.", "url": "https://github.com/apache/storm/pull/3348#discussion_r539881590", "createdAt": "2020-12-10T06:19:01Z", "author": {"login": "liusheng"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge\n+      arch: arm64-graviton2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxNDc3NA=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1ODY2Mw==", "bodyText": "Can you link to the announcement? It looks like they all should work as indicated in the https://docs.travis-ci.com/user/reference/overview/#linux-travisyml-examples and I don't see performance concerns.\nThe arm64 configuration seems more clean and simple", "url": "https://github.com/apache/storm/pull/3348#discussion_r540258663", "createdAt": "2020-12-10T15:25:15Z", "author": {"login": "Ethanlm"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge\n+      arch: arm64-graviton2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxNDc3NA=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA5NDQzNQ==", "bodyText": "There is not annoucement, just be cause I have tested many times, the ARM CI jobs are very easy to fail due to timeout errors previously. I have tested again in the PR #3361, it looks like now the common arm64 resource is OK to run the ARM CI job :), so let's switch to use the arm64 resources", "url": "https://github.com/apache/storm/pull/3348#discussion_r543094435", "createdAt": "2020-12-15T07:02:23Z", "author": {"login": "liusheng"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge\n+      arch: arm64-graviton2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQxNDc3NA=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4Njg1MDEwOnYy", "diffSide": "RIGHT", "path": ".travis.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNTo0ODowNFrOICbluQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNjoxODo1OVrOIC3wVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQyMDA4OQ==", "bodyText": "What does group mean here?", "url": "https://github.com/apache/storm/pull/3348#discussion_r539420089", "createdAt": "2020-12-09T15:48:04Z", "author": {"login": "Ethanlm"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg4MTU1Nw==", "bodyText": "sorry, this is unnecessary, my mistake.", "url": "https://github.com/apache/storm/pull/3348#discussion_r539881557", "createdAt": "2020-12-10T06:18:59Z", "author": {"login": "liusheng"}, "path": ".travis.yml", "diffHunk": "@@ -41,6 +40,48 @@ matrix:\n   include:\n     - arch: s390x\n       jdk: openjdk11\n+    - dist: focal\n+      group: edge", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTQyMDA4OQ=="}, "originalCommit": {"oid": "b1452deebeb042a611a7e0bbde5b01ddda0ff1f1"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxNDc3NjQ5OnYy", "diffSide": "RIGHT", "path": "integration-test/run-it.sh", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNTozNzoyN1rOIGRs1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNTowNzo1MlrOIHJ9xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjM3NQ==", "bodyText": "Is this change still needed after the change to arm64 and xenial", "url": "https://github.com/apache/storm/pull/3348#discussion_r543452375", "createdAt": "2020-12-15T15:37:27Z", "author": {"login": "Ethanlm"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -36,10 +36,13 @@ then\n   chmod o+rx /home/travis\n fi\n list_storm_processes || true\n-# increasing swap space so we can run lots of workers\n-sudo dd if=/dev/zero of=/swapfile.img bs=4096 count=1M\n-sudo mkswap /swapfile.img\n-sudo swapon /swapfile.img\n+if [ \"$(uname -m)\" != aarch64 ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAwOTE2OQ==", "bodyText": "yes, there still have problems of swap support on Travis ARM64 resources, you can take a look the error:\nhttps://travis-ci.com/github/apache/storm/jobs/460842259", "url": "https://github.com/apache/storm/pull/3348#discussion_r544009169", "createdAt": "2020-12-16T06:11:17Z", "author": {"login": "liusheng"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -36,10 +36,13 @@ then\n   chmod o+rx /home/travis\n fi\n list_storm_processes || true\n-# increasing swap space so we can run lots of workers\n-sudo dd if=/dev/zero of=/swapfile.img bs=4096 count=1M\n-sudo mkswap /swapfile.img\n-sudo swapon /swapfile.img\n+if [ \"$(uname -m)\" != aarch64 ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjM3NQ=="}, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDM3NDIxMw==", "bodyText": "Thanks for validating.\nFor future reference, the log is\n+sudo dd if=/dev/zero of=/swapfile.img bs=4096 count=1M\n1048576+0 records in\n1048576+0 records out\n4294967296 bytes (4.3 GB, 4.0 GiB) copied, 27.2215 s, 158 MB/s\n+sudo mkswap /swapfile.img\nSetting up swapspace version 1, size = 4 GiB (4294963200 bytes)\nno label, UUID=ba655d1c-230e-4feb-a06a-e342c114d7eb\n+sudo swapon /swapfile.img\nswapon: /swapfile.img: insecure permissions 0644, 0600 suggested.\nswapon: /swapfile.img: skipping - it appears to have holes.\nThe command \"if [[ $(uname -m) != 's390x' ]]; then /bin/bash ./dev-tools/travis/travis-script.sh `pwd` $MODULES; fi\" exited with 255.", "url": "https://github.com/apache/storm/pull/3348#discussion_r544374213", "createdAt": "2020-12-16T15:07:52Z", "author": {"login": "Ethanlm"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -36,10 +36,13 @@ then\n   chmod o+rx /home/travis\n fi\n list_storm_processes || true\n-# increasing swap space so we can run lots of workers\n-sudo dd if=/dev/zero of=/swapfile.img bs=4096 count=1M\n-sudo mkswap /swapfile.img\n-sudo swapon /swapfile.img\n+if [ \"$(uname -m)\" != aarch64 ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjM3NQ=="}, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxNDc3NzcxOnYy", "diffSide": "RIGHT", "path": "integration-test/run-it.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNTozNzozOFrOIGRtfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjozODowMFrOIHh_1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjU0MA==", "bodyText": "Is this change still needed after the change to arm64 and xenial", "url": "https://github.com/apache/storm/pull/3348#discussion_r543452540", "createdAt": "2020-12-15T15:37:38Z", "author": {"login": "Ethanlm"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -101,3 +104,7 @@ for i in {1..20} ; do\n done\n list_storm_processes\n mvn test -DfailIfNoTests=false -DskipTests=false -Dstorm.version=${STORM_VERSION} -Dui.url=http://localhost:8744\n+\n+# Kill all storm processes after tests running, otherwise the Travis CI(ARM) will still wait and then fail by\n+# timeout error even though all the tests passed\n+sudo pkill -9 -u storm", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDM3ODE1OQ==", "bodyText": "Saw this in your test job  https://travis-ci.com/github/apache/storm/jobs/460903786\nNo output has been received in the last 10m0s, this potentially indicates a stalled build or something wrong with the build itself.\nCheck the details on how to adjust your build configuration on: https://docs.travis-ci.com/user/common-build-problems/#build-times-out-because-no-output-was-received\nThe build has been terminated\n\nIs this what you saw before?", "url": "https://github.com/apache/storm/pull/3348#discussion_r544378159", "createdAt": "2020-12-16T15:12:44Z", "author": {"login": "Ethanlm"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -101,3 +104,7 @@ for i in {1..20} ; do\n done\n list_storm_processes\n mvn test -DfailIfNoTests=false -DskipTests=false -Dstorm.version=${STORM_VERSION} -Dui.url=http://localhost:8744\n+\n+# Kill all storm processes after tests running, otherwise the Travis CI(ARM) will still wait and then fail by\n+# timeout error even though all the tests passed\n+sudo pkill -9 -u storm", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjU0MA=="}, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDczOTUzOQ==", "bodyText": "yes, I have tried again in #3361, you can take a look the CI logs: https://travis-ci.com/github/apache/storm/jobs/460903786\nat the end of the log, even all the intgration tests ran sucessfully, but the job didn't exit immediately and then failed due to timeout.\n0.11s$ rm -rf $HOME/.m2/repository/org/apache/storm\ncache.2\nstore build cache\nDone. Your build exited with 0.\nNo output has been received in the last 10m0s, this potentially indicates a stalled build or something wrong with the build itself.\nCheck the details on how to adjust your build configuration on: https://docs.travis-ci.com/user/common-build-problems/#build-times-out-because-no-output-was-received\nThe build has been terminated", "url": "https://github.com/apache/storm/pull/3348#discussion_r544739539", "createdAt": "2020-12-17T01:17:58Z", "author": {"login": "liusheng"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -101,3 +104,7 @@ for i in {1..20} ; do\n done\n list_storm_processes\n mvn test -DfailIfNoTests=false -DskipTests=false -Dstorm.version=${STORM_VERSION} -Dui.url=http://localhost:8744\n+\n+# Kill all storm processes after tests running, otherwise the Travis CI(ARM) will still wait and then fail by\n+# timeout error even though all the tests passed\n+sudo pkill -9 -u storm", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjU0MA=="}, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc2Nzk1OQ==", "bodyText": "Thanks", "url": "https://github.com/apache/storm/pull/3348#discussion_r544767959", "createdAt": "2020-12-17T02:38:00Z", "author": {"login": "Ethanlm"}, "path": "integration-test/run-it.sh", "diffHunk": "@@ -101,3 +104,7 @@ for i in {1..20} ; do\n done\n list_storm_processes\n mvn test -DfailIfNoTests=false -DskipTests=false -Dstorm.version=${STORM_VERSION} -Dui.url=http://localhost:8744\n+\n+# Kill all storm processes after tests running, otherwise the Travis CI(ARM) will still wait and then fail by\n+# timeout error even though all the tests passed\n+sudo pkill -9 -u storm", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1MjU0MA=="}, "originalCommit": {"oid": "9446eb2b6cdc6c443e87246cf56991f17d4767f1"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4217, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}