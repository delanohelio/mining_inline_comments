{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NzgxNTYz", "number": 5465, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwOToyMzowMlrOErhjFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNjoyODoyNFrOErsZCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MDczODc4OnYy", "diffSide": "RIGHT", "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwOToyMzowMlrOHeVnqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwOToyMzowMlrOHeVnqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTU3MzU0Nw==", "bodyText": "#5464", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501573547", "createdAt": "2020-10-08T09:23:02Z", "author": {"login": "findepi"}, "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "diffHunk": "@@ -100,6 +107,36 @@ public void tearDown()\n         executor.shutdownNow();\n     }\n \n+    @Test\n+    public void testRuntimeQueriesTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(started), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.queries\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+\n+        MaterializedRow row = Iterables.getOnlyElement(result.toTestTypes().getMaterializedRows());\n+        List<Object> fields = row.getFields();\n+        assertThat(fields).hasSize(4);\n+        for (int i = 0; i < fields.size(); i++) {\n+            final int fieldNumber = i;\n+            Object value = fields.get(fieldNumber);\n+            assertThat(value)\n+                    .as(\"value for field \" + fieldNumber)\n+                    .isNotNull()\n+                    .isInstanceOfSatisfying(LocalDateTime.class, localDatetime -> {\n+                        // TODO (https://github.com/prestosql/presto/issues/5464) map to `timestamp with time zone`", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MTA2NzE3OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDo0Nzo0NVrOHeYwdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMToxNDowN1rOHeZn1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNDk1MA==", "bodyText": "I am a bit concerned about backward compatibility of this change. Not sure how commonly are those system schemas used by Presto users.", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501624950", "createdAt": "2020-10-08T10:47:45Z", "author": {"login": "losipiuk"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -62,7 +65,7 @@ public TransactionsSystemTable(Metadata metadata, TransactionManager transaction\n                 .column(\"isolation_level\", createUnboundedVarcharType())\n                 .column(\"read_only\", BOOLEAN)\n                 .column(\"auto_commit_context\", BOOLEAN)\n-                .column(\"create_time\", TIMESTAMP_MILLIS)\n+                .column(\"create_time\", TIMESTAMP_TZ_MILLIS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYzNTY0Mg==", "bodyText": "See\n#4772\n#4756\n#4753\n#4752\ni guess system connector simply got missed during that effort, but @electrum @dain may know better.", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501635642", "createdAt": "2020-10-08T11:07:32Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -62,7 +65,7 @@ public TransactionsSystemTable(Metadata metadata, TransactionManager transaction\n                 .column(\"isolation_level\", createUnboundedVarcharType())\n                 .column(\"read_only\", BOOLEAN)\n                 .column(\"auto_commit_context\", BOOLEAN)\n-                .column(\"create_time\", TIMESTAMP_MILLIS)\n+                .column(\"create_time\", TIMESTAMP_TZ_MILLIS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNDk1MA=="}, "originalCommit": null, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYzOTEyNg==", "bodyText": "fair", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501639126", "createdAt": "2020-10-08T11:14:07Z", "author": {"login": "losipiuk"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -62,7 +65,7 @@ public TransactionsSystemTable(Metadata metadata, TransactionManager transaction\n                 .column(\"isolation_level\", createUnboundedVarcharType())\n                 .column(\"read_only\", BOOLEAN)\n                 .column(\"auto_commit_context\", BOOLEAN)\n-                .column(\"create_time\", TIMESTAMP_MILLIS)\n+                .column(\"create_time\", TIMESTAMP_TZ_MILLIS)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNDk1MA=="}, "originalCommit": null, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MTA2OTAwOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDo0ODoyMVrOHeYxrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMToxMDoxNlrOHeZgAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNTI2Mg==", "bodyText": "possible?", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501625262", "createdAt": "2020-10-08T10:48:21Z", "author": {"login": "losipiuk"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -114,4 +117,13 @@ private static Block createStringsBlock(List<CatalogName> values)\n         }\n         return builder.build();\n     }\n+\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n+    {\n+        if (dateTime == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYzNTc4Ng==", "bodyText": "idk", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501635786", "createdAt": "2020-10-08T11:07:44Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -114,4 +117,13 @@ private static Block createStringsBlock(List<CatalogName> values)\n         }\n         return builder.build();\n     }\n+\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n+    {\n+        if (dateTime == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNTI2Mg=="}, "originalCommit": null, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYzNzEyMA==", "bodyText": "fixed", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501637120", "createdAt": "2020-10-08T11:10:16Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/TransactionsSystemTable.java", "diffHunk": "@@ -114,4 +117,13 @@ private static Block createStringsBlock(List<CatalogName> values)\n         }\n         return builder.build();\n     }\n+\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n+    {\n+        if (dateTime == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyNTI2Mg=="}, "originalCommit": null, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MTA4NzkzOnYy", "diffSide": "RIGHT", "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMDo1MzoyN1rOHeY8zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMToxMzoyN1rOHeZmig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyODExMQ==", "bodyText": "can you add test for system.runtime.transactions?", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501628111", "createdAt": "2020-10-08T10:53:27Z", "author": {"login": "losipiuk"}, "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "diffHunk": "@@ -100,6 +105,52 @@ public void tearDown()\n         executor.shutdownNow();\n     }\n \n+    @Test\n+    public void testRuntimeQueriesTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(started), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.queries\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+\n+        MaterializedRow row = Iterables.getOnlyElement(result.toTestTypes().getMaterializedRows());\n+        List<Object> fields = row.getFields();\n+        assertThat(fields).hasSize(4);\n+        for (int i = 0; i < fields.size(); i++) {\n+            Object value = fields.get(i);\n+            assertThat((ZonedDateTime) value)\n+                    .as(\"value for field \" + i)\n+                    .isNotNull()\n+                    .isAfterOrEqualTo(timeBefore)\n+                    .isBeforeOrEqualTo(timeAfter);\n+        }\n+    }\n+\n+    @Test\n+    public void testRuntimeTasksTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(start), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.tasks\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+\n+        MaterializedRow row = Iterables.getOnlyElement(result.toTestTypes().getMaterializedRows());\n+        List<Object> fields = row.getFields();\n+        assertThat(fields).hasSize(4);\n+        for (int i = 0; i < fields.size(); i++) {\n+            Object value = fields.get(i);\n+            assertThat((ZonedDateTime) value)\n+                    .as(\"value for field \" + i)\n+                    .isNotNull()\n+                    .isAfterOrEqualTo(timeBefore)\n+                    .isBeforeOrEqualTo(timeAfter);\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYzODc5NA==", "bodyText": "added", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501638794", "createdAt": "2020-10-08T11:13:27Z", "author": {"login": "findepi"}, "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "diffHunk": "@@ -100,6 +105,52 @@ public void tearDown()\n         executor.shutdownNow();\n     }\n \n+    @Test\n+    public void testRuntimeQueriesTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(started), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.queries\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+\n+        MaterializedRow row = Iterables.getOnlyElement(result.toTestTypes().getMaterializedRows());\n+        List<Object> fields = row.getFields();\n+        assertThat(fields).hasSize(4);\n+        for (int i = 0; i < fields.size(); i++) {\n+            Object value = fields.get(i);\n+            assertThat((ZonedDateTime) value)\n+                    .as(\"value for field \" + i)\n+                    .isNotNull()\n+                    .isAfterOrEqualTo(timeBefore)\n+                    .isBeforeOrEqualTo(timeAfter);\n+        }\n+    }\n+\n+    @Test\n+    public void testRuntimeTasksTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(start), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.tasks\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+\n+        MaterializedRow row = Iterables.getOnlyElement(result.toTestTypes().getMaterializedRows());\n+        List<Object> fields = row.getFields();\n+        assertThat(fields).hasSize(4);\n+        for (int i = 0; i < fields.size(); i++) {\n+            Object value = fields.get(i);\n+            assertThat((ZonedDateTime) value)\n+                    .as(\"value for field \" + i)\n+                    .isNotNull()\n+                    .isAfterOrEqualTo(timeBefore)\n+                    .isBeforeOrEqualTo(timeAfter);\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYyODExMQ=="}, "originalCommit": null, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MjUwNTQ3OnYy", "diffSide": "RIGHT", "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNjoyNTo0NlrOHemnzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNzo0Mzo0M1rOHepi8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1MjEwOA==", "bodyText": "We can do a sanity check to make the test failure reason obvious in case the system clock happens to be adjusted in between the calls\nassertThat(timeAfter).isAfterOrEqualTo(timeBefore);", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501852108", "createdAt": "2020-10-08T16:25:46Z", "author": {"login": "electrum"}, "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "diffHunk": "@@ -100,6 +107,36 @@ public void tearDown()\n         executor.shutdownNow();\n     }\n \n+    @Test\n+    public void testRuntimeQueriesTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(started), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.queries\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMDAxOQ==", "bodyText": "if the clock is adjusted, we still can fail, even if timeAfter >= timeBefore, so not sure how helpful it would be", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501900019", "createdAt": "2020-10-08T17:43:43Z", "author": {"login": "findepi"}, "path": "presto-tests/src/test/java/io/prestosql/connector/system/TestSystemConnector.java", "diffHunk": "@@ -100,6 +107,36 @@ public void tearDown()\n         executor.shutdownNow();\n     }\n \n+    @Test\n+    public void testRuntimeQueriesTimestamps()\n+    {\n+        ZonedDateTime timeBefore = ZonedDateTime.now();\n+        computeActual(\"SELECT 1\");\n+        MaterializedResult result = computeActual(\"\" +\n+                \"SELECT max(created), max(started), max(last_heartbeat), max(\\\"end\\\") \" +\n+                \"FROM system.runtime.queries\");\n+        ZonedDateTime timeAfter = ZonedDateTime.now();\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1MjEwOA=="}, "originalCommit": null, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MjUxNTMxOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/connector/system/QuerySystemTable.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNjoyODoyNFrOHemuMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQwODoyNDozMVrOHfABvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1Mzc0Nw==", "bodyText": "We used the server time zone for JmxRecordSetProvider since that seems like the right thing to return. If the administrator chooses to run their server in a specific time zone, then that's probably what they want to see when looking at system tables. cc @dain", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501853747", "createdAt": "2020-10-08T16:28:24Z", "author": {"login": "electrum"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/QuerySystemTable.java", "diffHunk": "@@ -157,12 +158,12 @@ private static Long toMillis(Duration duration)\n         return duration.toMillis();\n     }\n \n-    // TODO (https://github.com/prestosql/presto/issues/5464) map to timestamp with time zone\n-    private static Long toTimeStamp(DateTime dateTime)\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n     {\n         if (dateTime == null) {\n             return null;\n         }\n-        return dateTime.getMillis() * MICROSECONDS_PER_MILLISECOND;\n+        // dateTime.getZone() is the server zone, should be of no interest to the user", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMTExNA==", "bodyText": "If we had an \"instant\" type, we would map to that. In the absence of \"instant\" type, we need to fill some zone, an we usually fill in UTC. eg\nhttps://github.com/prestosql/presto/blob/fbd4ca7f6ca1326a077fd06cd33b687cbfe17cf2/presto-postgresql/src/main/java/io/prestosql/plugin/postgresql/PostgreSqlClient.java#L617\nhttps://github.com/prestosql/presto/blob/91dbe5149ae593fc8f86d36a304f1f7e8dc9175c/presto-cassandra/src/main/java/io/prestosql/plugin/cassandra/CassandraRecordCursor.java#L109", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r501901114", "createdAt": "2020-10-08T17:45:26Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/QuerySystemTable.java", "diffHunk": "@@ -157,12 +158,12 @@ private static Long toMillis(Duration duration)\n         return duration.toMillis();\n     }\n \n-    // TODO (https://github.com/prestosql/presto/issues/5464) map to timestamp with time zone\n-    private static Long toTimeStamp(DateTime dateTime)\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n     {\n         if (dateTime == null) {\n             return null;\n         }\n-        return dateTime.getMillis() * MICROSECONDS_PER_MILLISECOND;\n+        // dateTime.getZone() is the server zone, should be of no interest to the user", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1Mzc0Nw=="}, "originalCommit": null, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI1OTQ4Ng==", "bodyText": "Also, the problem with server zone is that it may be a political zone.\nPresto engine has no problem representing (point-in-time, zone) pairs.\nHowever, due to how they are formatted for the client, client can no longer distinguish values within\nsummer\u2192winter DST change.\npresto> SELECT\n     ->     increment,\n     ->     from_unixtime(base + increment * 3600, 'America/Los_Angeles')\n     -> FROM (VALUES(1572766200)) t(base)\n     -> CROSS JOIN UNNEST(sequence(0, 3)) u(increment);\n     ->\n increment |                    _col1\n-----------+---------------------------------------------\n         0 | 2019-11-03 00:30:00.000 America/Los_Angeles\n         1 | 2019-11-03 01:30:00.000 America/Los_Angeles\n         2 | 2019-11-03 01:30:00.000 America/Los_Angeles\n         3 | 2019-11-03 02:30:00.000 America/Los_Angeles\n(4 rows)", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r502259486", "createdAt": "2020-10-09T08:09:29Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/QuerySystemTable.java", "diffHunk": "@@ -157,12 +158,12 @@ private static Long toMillis(Duration duration)\n         return duration.toMillis();\n     }\n \n-    // TODO (https://github.com/prestosql/presto/issues/5464) map to timestamp with time zone\n-    private static Long toTimeStamp(DateTime dateTime)\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n     {\n         if (dateTime == null) {\n             return null;\n         }\n-        return dateTime.getMillis() * MICROSECONDS_PER_MILLISECOND;\n+        // dateTime.getZone() is the server zone, should be of no interest to the user", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1Mzc0Nw=="}, "originalCommit": null, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI2ODM1MA==", "bodyText": "#5488", "url": "https://github.com/trinodb/trino/pull/5465#discussion_r502268350", "createdAt": "2020-10-09T08:24:31Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/connector/system/QuerySystemTable.java", "diffHunk": "@@ -157,12 +158,12 @@ private static Long toMillis(Duration duration)\n         return duration.toMillis();\n     }\n \n-    // TODO (https://github.com/prestosql/presto/issues/5464) map to timestamp with time zone\n-    private static Long toTimeStamp(DateTime dateTime)\n+    private static Long toTimestampWithTimeZoneMillis(DateTime dateTime)\n     {\n         if (dateTime == null) {\n             return null;\n         }\n-        return dateTime.getMillis() * MICROSECONDS_PER_MILLISECOND;\n+        // dateTime.getZone() is the server zone, should be of no interest to the user", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1Mzc0Nw=="}, "originalCommit": null, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4635, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}