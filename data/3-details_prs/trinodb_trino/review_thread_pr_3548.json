{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4OTY4NjYx", "number": 3548, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxOTozMToxNlrOD2YoVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxOTozMToxNlrOD2YoVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MzUzMjM2OnYy", "diffSide": "RIGHT", "path": "presto-parquet/src/test/java/io/prestosql/parquet/reader/TestMetadataReader.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxOTozMToxNlrOGMI9iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMDoxMzoxNFrOGMJc3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4MjkyMw==", "bodyText": "Maybe put the 13 into a constant so that it's clear where it comes from, especially since it's used further down.", "url": "https://github.com/trinodb/trino/pull/3548#discussion_r415382923", "createdAt": "2020-04-26T19:31:16Z", "author": {"login": "martint"}, "path": "presto-parquet/src/test/java/io/prestosql/parquet/reader/TestMetadataReader.java", "diffHunk": "@@ -130,95 +130,97 @@ public void testReadStatsBinary(Optional<String> fileCreatedBy)\n     public void testReadStatsBinaryUtf8OldWriter()\n     {\n         // [, bc\u00e9]: min is empty, max starts with ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"bc\u00e9\", null, null);\n \n         // [, \u00e9bc]: min is empty, max starts with non-ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"\u00e9bc\", null, null);\n \n         // [aa, b\u00e9]: no common prefix, first different are both ASCII, min is all ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"aa\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"aa\", \"b\u00e9\", \"aa\", \"c\");\n \n         // [abcd, abcdN]: common prefix, not only ASCII, one prefix of the other, last common ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, \"abcd\".getBytes(UTF_8), \"abce\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abcd\", \"abcdN\", \"abcd\", \"abce\");\n \n         // [abc\u00e9, abc\u00e9N]: common prefix, not only ASCII, one prefix of the other, last common non ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9\", \"abc\u00e9N\", \"abc\u00e9\", \"abd\");\n \n         // [abc\u00e9M, abc\u00e9N]: common prefix, not only ASCII, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9N\", \"abc\u00e9M\", \"abc\u00e9O\");\n \n         // [abc\u00e9Mab, abc\u00e9Nxy]: common prefix, not only ASCII, first different are both ASCII, more characters afterwards\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", \"abc\u00e9Mab\", \"abc\u00e9O\");\n \n         // [abc\u00e9M, abc\u00e9\\u00f7]: common prefix, not only ASCII, first different are both ASCII, but need to be chopped off (127)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", \"abc\u00e9M\", \"abd\");\n \n         // [abc\\u007f\u00e9, bcd\\u007f\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, \"abc\\u007f\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", \"abc\\u007f\", \"c\");\n \n         // [\u00e9, a]: no common prefix, first different are not both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"a\", null, null);\n \n         // [\u00e9, \u00ea]: no common prefix, first different are both not ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"\u00ea\", null, null);\n \n         // [a\u00e9, a\u00e9]: min = max (common prefix, first different are both not ASCII)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"a\u00e9\", \"a\u00e9\", \"a\u00e9\");\n \n         // [a\u00e9, b\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"a\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"b\u00e9\", \"a\", \"c\");\n     }\n \n-    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, int nullCount, byte[] min, byte[] max, int expectedNullCount, byte[] expectedMin, byte[] expectedMax)\n+    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, String min, String max, String expectedMin, String expectedMax)\n     {\n         Statistics statistics = new Statistics();\n-        statistics.setNull_count(nullCount);\n-        statistics.setMin(min);\n-        statistics.setMax(max);\n+        statistics.setNull_count(13);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a4bc767b38011e865db43154da6118fcf50ba97"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM5MDczOA==", "bodyText": "i will", "url": "https://github.com/trinodb/trino/pull/3548#discussion_r415390738", "createdAt": "2020-04-26T20:11:56Z", "author": {"login": "findepi"}, "path": "presto-parquet/src/test/java/io/prestosql/parquet/reader/TestMetadataReader.java", "diffHunk": "@@ -130,95 +130,97 @@ public void testReadStatsBinary(Optional<String> fileCreatedBy)\n     public void testReadStatsBinaryUtf8OldWriter()\n     {\n         // [, bc\u00e9]: min is empty, max starts with ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"bc\u00e9\", null, null);\n \n         // [, \u00e9bc]: min is empty, max starts with non-ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"\u00e9bc\", null, null);\n \n         // [aa, b\u00e9]: no common prefix, first different are both ASCII, min is all ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"aa\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"aa\", \"b\u00e9\", \"aa\", \"c\");\n \n         // [abcd, abcdN]: common prefix, not only ASCII, one prefix of the other, last common ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, \"abcd\".getBytes(UTF_8), \"abce\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abcd\", \"abcdN\", \"abcd\", \"abce\");\n \n         // [abc\u00e9, abc\u00e9N]: common prefix, not only ASCII, one prefix of the other, last common non ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9\", \"abc\u00e9N\", \"abc\u00e9\", \"abd\");\n \n         // [abc\u00e9M, abc\u00e9N]: common prefix, not only ASCII, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9N\", \"abc\u00e9M\", \"abc\u00e9O\");\n \n         // [abc\u00e9Mab, abc\u00e9Nxy]: common prefix, not only ASCII, first different are both ASCII, more characters afterwards\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", \"abc\u00e9Mab\", \"abc\u00e9O\");\n \n         // [abc\u00e9M, abc\u00e9\\u00f7]: common prefix, not only ASCII, first different are both ASCII, but need to be chopped off (127)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", \"abc\u00e9M\", \"abd\");\n \n         // [abc\\u007f\u00e9, bcd\\u007f\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, \"abc\\u007f\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", \"abc\\u007f\", \"c\");\n \n         // [\u00e9, a]: no common prefix, first different are not both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"a\", null, null);\n \n         // [\u00e9, \u00ea]: no common prefix, first different are both not ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"\u00ea\", null, null);\n \n         // [a\u00e9, a\u00e9]: min = max (common prefix, first different are both not ASCII)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"a\u00e9\", \"a\u00e9\", \"a\u00e9\");\n \n         // [a\u00e9, b\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"a\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"b\u00e9\", \"a\", \"c\");\n     }\n \n-    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, int nullCount, byte[] min, byte[] max, int expectedNullCount, byte[] expectedMin, byte[] expectedMax)\n+    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, String min, String max, String expectedMin, String expectedMax)\n     {\n         Statistics statistics = new Statistics();\n-        statistics.setNull_count(nullCount);\n-        statistics.setMin(min);\n-        statistics.setMax(max);\n+        statistics.setNull_count(13);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4MjkyMw=="}, "originalCommit": {"oid": "5a4bc767b38011e865db43154da6118fcf50ba97"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM5MDk0Mg==", "bodyText": "hm... i will not do it. It's like this in every other test method in this class.", "url": "https://github.com/trinodb/trino/pull/3548#discussion_r415390942", "createdAt": "2020-04-26T20:13:14Z", "author": {"login": "findepi"}, "path": "presto-parquet/src/test/java/io/prestosql/parquet/reader/TestMetadataReader.java", "diffHunk": "@@ -130,95 +130,97 @@ public void testReadStatsBinary(Optional<String> fileCreatedBy)\n     public void testReadStatsBinaryUtf8OldWriter()\n     {\n         // [, bc\u00e9]: min is empty, max starts with ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"bc\u00e9\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"bc\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"bc\u00e9\", null, null);\n \n         // [, \u00e9bc]: min is empty, max starts with non-ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, new byte[0], \"\u00e9bc\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\", \"\u00e9bc\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\", \"\u00e9bc\", null, null);\n \n         // [aa, b\u00e9]: no common prefix, first different are both ASCII, min is all ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"aa\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"aa\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"aa\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"aa\", \"b\u00e9\", \"aa\", \"c\");\n \n         // [abcd, abcdN]: common prefix, not only ASCII, one prefix of the other, last common ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abcd\".getBytes(UTF_8), \"abcdN\".getBytes(UTF_8), 13, \"abcd\".getBytes(UTF_8), \"abce\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abcd\", \"abcdN\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abcd\", \"abcdN\", \"abcd\", \"abce\");\n \n         // [abc\u00e9, abc\u00e9N]: common prefix, not only ASCII, one prefix of the other, last common non ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9\", \"abc\u00e9N\", \"abc\u00e9\", \"abd\");\n \n         // [abc\u00e9M, abc\u00e9N]: common prefix, not only ASCII, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9N\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9N\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9N\", \"abc\u00e9M\", \"abc\u00e9O\");\n \n         // [abc\u00e9Mab, abc\u00e9Nxy]: common prefix, not only ASCII, first different are both ASCII, more characters afterwards\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9Nxy\".getBytes(UTF_8), 13, \"abc\u00e9Mab\".getBytes(UTF_8), \"abc\u00e9O\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9Mab\", \"abc\u00e9Nxy\", \"abc\u00e9Mab\", \"abc\u00e9O\");\n \n         // [abc\u00e9M, abc\u00e9\\u00f7]: common prefix, not only ASCII, first different are both ASCII, but need to be chopped off (127)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\u00e9M\".getBytes(UTF_8), \"abc\u00e9\\u00f7\".getBytes(UTF_8), 13, \"abc\u00e9M\".getBytes(UTF_8), \"abd\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\u00e9M\", \"abc\u00e9\\u00f7\", \"abc\u00e9M\", \"abd\");\n \n         // [abc\\u007f\u00e9, bcd\\u007f\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"abc\\u007f\u00e9\".getBytes(UTF_8), \"bcd\\u007f\u00e9\".getBytes(UTF_8), 13, \"abc\\u007f\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"abc\\u007f\u00e9\", \"bcd\\u007f\u00e9\", \"abc\\u007f\", \"c\");\n \n         // [\u00e9, a]: no common prefix, first different are not both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"a\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"a\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"a\", null, null);\n \n         // [\u00e9, \u00ea]: no common prefix, first different are both not ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"\u00e9\".getBytes(UTF_8), \"\u00ea\".getBytes(UTF_8), 13, null, null);\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"\u00e9\", \"\u00ea\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"\u00e9\", \"\u00ea\", null, null);\n \n         // [a\u00e9, a\u00e9]: min = max (common prefix, first different are both not ASCII)\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8), 13, \"a\u00e9\".getBytes(UTF_8), \"a\u00e9\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"a\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"a\u00e9\", \"a\u00e9\", \"a\u00e9\");\n \n         // [a\u00e9, b\u00e9]: no common prefix, first different are both ASCII\n-        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, null, null);\n-        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, 13, \"a\u00e9\".getBytes(UTF_8), \"b\u00e9\".getBytes(UTF_8), 13, \"a\".getBytes(UTF_8), \"c\".getBytes(UTF_8));\n+        testReadStatsBinaryUtf8OldWriter(NO_CREATED_BY, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR, \"a\u00e9\", \"b\u00e9\", null, null);\n+        testReadStatsBinaryUtf8OldWriter(PARQUET_MR_1_8, \"a\u00e9\", \"b\u00e9\", \"a\", \"c\");\n     }\n \n-    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, int nullCount, byte[] min, byte[] max, int expectedNullCount, byte[] expectedMin, byte[] expectedMax)\n+    private void testReadStatsBinaryUtf8OldWriter(Optional<String> fileCreatedBy, String min, String max, String expectedMin, String expectedMax)\n     {\n         Statistics statistics = new Statistics();\n-        statistics.setNull_count(nullCount);\n-        statistics.setMin(min);\n-        statistics.setMax(max);\n+        statistics.setNull_count(13);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4MjkyMw=="}, "originalCommit": {"oid": "5a4bc767b38011e865db43154da6118fcf50ba97"}, "originalPosition": 115}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 252, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}