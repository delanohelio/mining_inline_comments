{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNDY3Mzg2", "number": 3375, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NTo1OFrODvt8gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDowMjoxMlrOD6Znsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzYyNDM1OnYy", "diffSide": "RIGHT", "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NTo1OFrOGCTvNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMDowMzoyM1rOGCT_vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzcxOQ==", "bodyText": "OVERWRITE should be a string, so:\n    SET SESSION hdfs.insert_existing_partitions_behavior = 'OVERWRITE'", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405073719", "createdAt": "2020-04-07T19:55:58Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = OVERWRITE", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3Nzk0OA==", "bodyText": "Fixed", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405077948", "createdAt": "2020-04-07T20:03:23Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = OVERWRITE", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzcxOQ=="}, "originalCommit": null, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzYyNTA2OnYy", "diffSide": "RIGHT", "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NjowOFrOGCTvpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMDowNTowMlrOGCUDdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ==", "bodyText": "Extra .g", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405073829", "createdAt": "2020-04-07T19:56:08Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NDIxNA==", "bodyText": "Why is hdfs used as an example name instead of hive?", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405074214", "createdAt": "2020-04-07T19:56:46Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NzI1Nw==", "bodyText": "imho it is misleading to use the name of the connector for the catalog name .. so I avoid that confusion whenever possible ..", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405077257", "createdAt": "2020-04-07T20:02:13Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3ODkwMg==", "bodyText": "Agreed. But hdfs is also a little misleading as it's too tied to the underlying technology and may make people think this is for hdfs only.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405078902", "createdAt": "2020-04-07T20:05:02Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ=="}, "originalCommit": null, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzYzNjc2OnYy", "diffSide": "RIGHT", "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "isResolved": true, "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1OToxMlrOGCT23w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjoxMzo0OFrOGQw8YA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ==", "bodyText": "There's another mode that's allowed: APPEND. We may want to document that, too, here or as a separate change.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405075679", "createdAt": "2020-04-07T19:59:12Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NzkyNg==", "bodyText": "Also, I think that the overwrite mode support is not available for s3 backed tables - since there is no concept of stage-and-move to target directory. We could also add that in the documentation.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405077926", "createdAt": "2020-04-07T20:03:20Z", "author": {"login": "rohangarg"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3ODY0Mg==", "bodyText": "I would like to link to the docs for that session property but still looking for a place to put that and then link to it. Do you think I should document it all here (ERROR as default, APPEND..) ?", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405078642", "createdAt": "2020-04-07T20:04:35Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3OTQwMg==", "bodyText": "Good to know .. I can add all that .. but probably not here in the migration docs but somewhere in the hive connector docs ... but where? Should I start a separate section about inserting data ? Or session properties? or add it to an existing section..", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405079402", "createdAt": "2020-04-07T20:06:01Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4MjA0Ng==", "bodyText": "Yeah, it makes sense to add it to the Hive connector docs. We don't have a section with the list of session properties, so maybe a dedicate section about insert behavior would be way to go. @electrum, do you have any thoughts?", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405082046", "createdAt": "2020-04-07T20:10:55Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA4NDU4MA==", "bodyText": "If I add it as insert behaviour section to the hive docs the migration section can be shorter and mostly point there.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405084580", "createdAt": "2020-04-07T20:15:34Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjEwNzA0MA==", "bodyText": "Can you please chime in here @electrum to decide what direction we should take this.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r416107040", "createdAt": "2020-04-27T19:58:26Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUxMDc4Ng==", "bodyText": "equivalent to hive insert overwrite", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r417510786", "createdAt": "2020-04-29T18:06:07Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzUxMTE0MA==", "bodyText": "We should mention this is equivalent to Hive's INSERT OVERWRITE syntax (documented at https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML)", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r417511140", "createdAt": "2020-04-29T18:06:45Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIzMjI4OA==", "bodyText": "Added as agreed.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r420232288", "createdAt": "2020-05-05T16:13:48Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ=="}, "originalCommit": null, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNTYzNzYzOnYy", "diffSide": "RIGHT", "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDowMjoxMlrOGSOOBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDoxNDoyMlrOGSOlfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2MDUxNg==", "bodyText": "Missing \"to\" after \"equivalent\"", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r421760516", "createdAt": "2020-05-07T20:02:12Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,17 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector, for\n+example ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = 'OVERWRITE';\n+    INSERT INTO hdfs.schema.table ...\n+\n+The resulting behavior is equivalent using `INSERT OVERWRITE", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2NjUyNQ==", "bodyText": "Fixed", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r421766525", "createdAt": "2020-05-07T20:14:22Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,17 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector, for\n+example ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = 'OVERWRITE';\n+    INSERT INTO hdfs.schema.table ...\n+\n+The resulting behavior is equivalent using `INSERT OVERWRITE", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2MDUxNg=="}, "originalCommit": null, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 364, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}