{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0Mzk0OTY5", "number": 5787, "title": "Restore null behavior", "bodyText": "", "createdAt": "2020-11-02T23:38:37Z", "url": "https://github.com/trinodb/trino/pull/5787", "merged": true, "mergeCommit": {"oid": "c1fd650b26017772550570fd1f3090591396e744"}, "closed": true, "closedAt": "2020-11-04T17:03:12Z", "author": {"login": "electrum"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYtSopAH2gAyNTE0Mzk0OTY5OmJjZWNhOWI3ZDg3MTUzMDE0ZDE1MmY2YTFlMTM0ZjQzODliNTU0OGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZD7_bgFqTUyMjk5NDQzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/bceca9b7d87153014d152f6a1e134f4389b5548f", "committedDate": "2020-11-02T23:37:30Z", "message": "Restore null behavior for greatest and least"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a8c195af01c548d1b02c18b822a4a5382741e79", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/3a8c195af01c548d1b02c18b822a4a5382741e79", "committedDate": "2020-11-02T23:37:43Z", "message": "Restore null behavior for array_max and array_min"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMTA4ODA3", "url": "https://github.com/trinodb/trino/pull/5787#pullrequestreview-522108807", "createdAt": "2020-11-02T23:41:22Z", "commit": {"oid": "3a8c195af01c548d1b02c18b822a4a5382741e79"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMzo0MToyMlrOHsarwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMzo0MToyMlrOHsarwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjMzNjU3Ng==", "bodyText": "Unrelated to this commit", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516336576", "createdAt": "2020-11-02T23:41:22Z", "author": {"login": "martint"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1275,8 +1275,10 @@ public void testLeast()\n     public void testGreatestWithNaN()\n     {\n         assertFunction(\"greatest(1.5E0, 0.0E0 / 0.0E0)\", DOUBLE, Double.NaN);\n+        assertFunction(\"greatest(1.5E0, 0.0E0 / 0.0E0, 2.7E0)\", DOUBLE, Double.NaN);\n         assertFunction(\"greatest(1.5E0, REAL '0.0' / REAL '0.0')\", DOUBLE, Double.NaN);\n-        assertFunction(\"greatest(null, REAL '0.0' / REAL '0.0')\", REAL, Float.NaN);\n+        assertFunction(\"greatest(1.5E0, REAL '0.0' / REAL '0.0', 2.7E0)\", DOUBLE, Double.NaN);\n+        assertFunction(\"greatest(null, REAL '0.0' / REAL '0.0')\", REAL, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a8c195af01c548d1b02c18b822a4a5382741e79"}, "originalPosition": 128}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMjcyMTE0", "url": "https://github.com/trinodb/trino/pull/5787#pullrequestreview-522272114", "createdAt": "2020-11-03T08:32:55Z", "commit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "state": "COMMENTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwODozMjo1NVrOHskU-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwODo0MToyN1rOHskmYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NDU4NQ==", "bodyText": "You do not even need to add a new test, nice.", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516494585", "createdAt": "2020-11-03T08:32:55Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NDk3OQ==", "bodyText": "// real", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516494979", "createdAt": "2020-11-03T08:33:42Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // smallint\n         assertFunction(\"greatest(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 2);\n         assertFunction(\"greatest(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -1);\n         assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 5);\n         assertFunction(\"greatest(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 5);\n+        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"greatest(1, 2)\", INTEGER, 2);\n         assertFunction(\"greatest(-1, -2)\", INTEGER, -1);\n         assertFunction(\"greatest(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 5);\n         assertFunction(\"greatest(-1)\", INTEGER, -1);\n-        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 5);\n+        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"greatest(10000000000, 20000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"greatest(-10000000000, -20000000000)\", BIGINT, -10000000000L);\n         assertFunction(\"greatest(5000000000, 4, 3, 2, 1000000000, 2, 3, 4, 1, 5000000000)\", BIGINT, 5000000000L);\n         assertFunction(\"greatest(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, 5000000000L);\n+        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n-        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NTQ1Mw==", "bodyText": "This is a test case for DOUBLE.\nMake it into a test case for REAL:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n          \n          \n            \n                    assertFunction(\"greatest(5, REAL '4', CAST(NULL AS real), 3)\", REAL, null);", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516495453", "createdAt": "2020-11-03T08:34:38Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // smallint\n         assertFunction(\"greatest(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 2);\n         assertFunction(\"greatest(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -1);\n         assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 5);\n         assertFunction(\"greatest(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 5);\n+        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"greatest(1, 2)\", INTEGER, 2);\n         assertFunction(\"greatest(-1, -2)\", INTEGER, -1);\n         assertFunction(\"greatest(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 5);\n         assertFunction(\"greatest(-1)\", INTEGER, -1);\n-        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 5);\n+        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"greatest(10000000000, 20000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"greatest(-10000000000, -20000000000)\", BIGINT, -10000000000L);\n         assertFunction(\"greatest(5000000000, 4, 3, 2, 1000000000, 2, 3, 4, 1, 5000000000)\", BIGINT, 5000000000L);\n         assertFunction(\"greatest(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, 5000000000L);\n+        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n-        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float\n         assertFunction(\"greatest(REAL '1.5', 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(REAL '-1.5', -2.3E0)\", DOUBLE, (double) -1.5f);\n         assertFunction(\"greatest(-1.5E0, REAL '-2.3', -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(REAL '1.5', REAL '-1.0' / 0.0E0, 1.0E0 / REAL '0.0')\", DOUBLE, (double) (1.0f / 0.0f));\n-        assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjE2MQ==", "bodyText": "Add a greatest and least test cases for DOUBLE and REAL with 1,NaN,3 and 1,NULL,NaN,4", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516496161", "createdAt": "2020-11-03T08:35:54Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // smallint\n         assertFunction(\"greatest(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 2);\n         assertFunction(\"greatest(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -1);\n         assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 5);\n         assertFunction(\"greatest(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 5);\n+        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"greatest(1, 2)\", INTEGER, 2);\n         assertFunction(\"greatest(-1, -2)\", INTEGER, -1);\n         assertFunction(\"greatest(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 5);\n         assertFunction(\"greatest(-1)\", INTEGER, -1);\n-        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 5);\n+        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"greatest(10000000000, 20000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"greatest(-10000000000, -20000000000)\", BIGINT, -10000000000L);\n         assertFunction(\"greatest(5000000000, 4, 3, 2, 1000000000, 2, 3, 4, 1, 5000000000)\", BIGINT, 5000000000L);\n         assertFunction(\"greatest(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, 5000000000L);\n+        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n-        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjQ1OA==", "bodyText": "Duplicate test case?", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516496458", "createdAt": "2020-11-03T08:36:31Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1190,8 +1190,8 @@ public void testGreatest()\n         assertFunction(\"greatest(1.0E0, 2)\", DOUBLE, 2.0);\n         assertFunction(\"greatest(1, 2.0E0)\", DOUBLE, 2.0);\n         assertFunction(\"greatest(1.0E0, 2)\", DOUBLE, 2.0);\n-        assertFunction(\"greatest(5.0E0, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n-        assertFunction(\"greatest(5.0E0, 4, CAST(NULL as BIGINT), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5.0E0, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n+        assertFunction(\"greatest(5.0E0, 4, CAST(NULL as BIGINT), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjUyNw==", "bodyText": "// real", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516496527", "createdAt": "2020-11-03T08:36:39Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1214,42 +1214,42 @@ public void testLeast()\n         assertFunction(\"least(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -2);\n         assertFunction(\"least(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 1);\n         assertFunction(\"least(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 3);\n+        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // integer\n         assertFunction(\"least(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -2);\n         assertFunction(\"least(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 3);\n+        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"least(1, 2)\", INTEGER, 1);\n         assertFunction(\"least(-1, -2)\", INTEGER, -2);\n         assertFunction(\"least(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 1);\n         assertFunction(\"least(-1)\", INTEGER, -1);\n-        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 3);\n+        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"least(10000000000, 20000000000)\", BIGINT, 10000000000L);\n         assertFunction(\"least(-10000000000, -20000000000)\", BIGINT, -20000000000L);\n         assertFunction(\"least(50000000000, 40000000000, 30000000000, 20000000000, 50000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"least(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, 300000000L);\n+        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"least(1.5E0, 2.3E0)\", DOUBLE, 1.5);\n         assertFunction(\"least(-1.5E0, -2.3E0)\", DOUBLE, -2.3);\n         assertFunction(\"least(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -2.3);\n         assertFunction(\"least(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.NEGATIVE_INFINITY);\n-        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 3.0);\n+        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjkwNA==", "bodyText": "This is a test case for DOUBLE.\nMake it into a test case for REAL:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertFunction(\"least(REAL '5', 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n          \n          \n            \n                    assertFunction(\"least(REAL '5', 4, CAST(NULL AS real), 3)\", REAL, null);", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516496904", "createdAt": "2020-11-03T08:37:23Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1214,42 +1214,42 @@ public void testLeast()\n         assertFunction(\"least(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -2);\n         assertFunction(\"least(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 1);\n         assertFunction(\"least(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 3);\n+        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // integer\n         assertFunction(\"least(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -2);\n         assertFunction(\"least(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 3);\n+        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"least(1, 2)\", INTEGER, 1);\n         assertFunction(\"least(-1, -2)\", INTEGER, -2);\n         assertFunction(\"least(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 1);\n         assertFunction(\"least(-1)\", INTEGER, -1);\n-        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 3);\n+        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"least(10000000000, 20000000000)\", BIGINT, 10000000000L);\n         assertFunction(\"least(-10000000000, -20000000000)\", BIGINT, -20000000000L);\n         assertFunction(\"least(50000000000, 40000000000, 30000000000, 20000000000, 50000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"least(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, 300000000L);\n+        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"least(1.5E0, 2.3E0)\", DOUBLE, 1.5);\n         assertFunction(\"least(-1.5E0, -2.3E0)\", DOUBLE, -2.3);\n         assertFunction(\"least(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -2.3);\n         assertFunction(\"least(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.NEGATIVE_INFINITY);\n-        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 3.0);\n+        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float\n         assertFunction(\"least(REAL '1.5', 2.3E0)\", DOUBLE, (double) 1.5f);\n         assertFunction(\"least(REAL '-1.5', -2.3E0)\", DOUBLE, -2.3);\n         assertFunction(\"least(-2.3E0, REAL '-0.4', -5/3)\", DOUBLE, -2.3);\n         assertFunction(\"least(1.5E0, REAL '-1.0' / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, (double) (-1.0f / 0.0f));\n-        assertFunction(\"least(REAL '5', 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 3.0);\n+        assertFunction(\"least(REAL '5', 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NzMzNQ==", "bodyText": "Actually the cases above are also for DOUBLE, not REAL", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516497335", "createdAt": "2020-11-03T08:38:15Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // smallint\n         assertFunction(\"greatest(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 2);\n         assertFunction(\"greatest(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -1);\n         assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 5);\n         assertFunction(\"greatest(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 5);\n+        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"greatest(1, 2)\", INTEGER, 2);\n         assertFunction(\"greatest(-1, -2)\", INTEGER, -1);\n         assertFunction(\"greatest(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 5);\n         assertFunction(\"greatest(-1)\", INTEGER, -1);\n-        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 5);\n+        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"greatest(10000000000, 20000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"greatest(-10000000000, -20000000000)\", BIGINT, -10000000000L);\n         assertFunction(\"greatest(5000000000, 4, 3, 2, 1000000000, 2, 3, 4, 1, 5000000000)\", BIGINT, 5000000000L);\n         assertFunction(\"greatest(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, 5000000000L);\n+        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n-        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float\n         assertFunction(\"greatest(REAL '1.5', 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(REAL '-1.5', -2.3E0)\", DOUBLE, (double) -1.5f);\n         assertFunction(\"greatest(-1.5E0, REAL '-2.3', -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(REAL '1.5', REAL '-1.0' / 0.0E0, 1.0E0 / REAL '0.0')\", DOUBLE, (double) (1.0f / 0.0f));\n-        assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NTQ1Mw=="}, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NzM2NA==", "bodyText": "Actually the cases above are also for DOUBLE, not REAL", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516497364", "createdAt": "2020-11-03T08:38:18Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1214,42 +1214,42 @@ public void testLeast()\n         assertFunction(\"least(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -2);\n         assertFunction(\"least(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 1);\n         assertFunction(\"least(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 3);\n+        assertFunction(\"least(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // integer\n         assertFunction(\"least(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -2);\n         assertFunction(\"least(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 1);\n         assertFunction(\"least(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 3);\n+        assertFunction(\"least(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"least(1, 2)\", INTEGER, 1);\n         assertFunction(\"least(-1, -2)\", INTEGER, -2);\n         assertFunction(\"least(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 1);\n         assertFunction(\"least(-1)\", INTEGER, -1);\n-        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 3);\n+        assertFunction(\"least(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"least(10000000000, 20000000000)\", BIGINT, 10000000000L);\n         assertFunction(\"least(-10000000000, -20000000000)\", BIGINT, -20000000000L);\n         assertFunction(\"least(50000000000, 40000000000, 30000000000, 20000000000, 50000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"least(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, 300000000L);\n+        assertFunction(\"least(500000000, 400000000, CAST(NULL as BIGINT), 300000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"least(1.5E0, 2.3E0)\", DOUBLE, 1.5);\n         assertFunction(\"least(-1.5E0, -2.3E0)\", DOUBLE, -2.3);\n         assertFunction(\"least(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -2.3);\n         assertFunction(\"least(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.NEGATIVE_INFINITY);\n-        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 3.0);\n+        assertFunction(\"least(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n \n         // float\n         assertFunction(\"least(REAL '1.5', 2.3E0)\", DOUBLE, (double) 1.5f);\n         assertFunction(\"least(REAL '-1.5', -2.3E0)\", DOUBLE, -2.3);\n         assertFunction(\"least(-2.3E0, REAL '-0.4', -5/3)\", DOUBLE, -2.3);\n         assertFunction(\"least(1.5E0, REAL '-1.0' / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, (double) (-1.0f / 0.0f));\n-        assertFunction(\"least(REAL '5', 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 3.0);\n+        assertFunction(\"least(REAL '5', 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjkwNA=="}, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5OTA0Mw==", "bodyText": "Before c95e937 the expected values here were different -- here and in some other places NaN was expected. See\nhttps://github.com/prestosql/presto/blob/f04fa5ca8de1015629a94693740dfbc641e55784/presto-main/src/test/java/io/prestosql/type/TestArrayOperators.java#L608-L612", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r516499043", "createdAt": "2020-11-03T08:41:27Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/type/TestArrayOperators.java", "diffHunk": "@@ -597,13 +597,13 @@ public void testArrayMin()\n         assertFunction(\"ARRAY_MIN(ARRAY [NaN()])\", DOUBLE, NaN);\n         assertFunction(\"ARRAY_MIN(ARRAY [NULL, NULL, NULL])\", UNKNOWN, null);\n         assertFunction(\"ARRAY_MIN(ARRAY [NaN(), NaN(), NaN()])\", DOUBLE, NaN);\n-        assertFunction(\"ARRAY_MIN(ARRAY [NULL, 2, 3])\", INTEGER, 2);\n+        assertFunction(\"ARRAY_MIN(ARRAY [NULL, 2, 3])\", INTEGER, null);\n         assertFunction(\"ARRAY_MIN(ARRAY [NaN(), 2, 3])\", DOUBLE, 2.0);\n-        assertFunction(\"ARRAY_MIN(ARRAY [NULL, NaN(), 1])\", DOUBLE, 1.0);\n-        assertFunction(\"ARRAY_MIN(ARRAY [NaN(), NULL, 3.0])\", DOUBLE, 3.0);\n-        assertFunction(\"ARRAY_MIN(ARRAY [1.0E0, NULL, 3])\", DOUBLE, 1.0E0);\n+        assertFunction(\"ARRAY_MIN(ARRAY [NULL, NaN(), 1])\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a8c195af01c548d1b02c18b822a4a5382741e79"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTk0NDM3", "url": "https://github.com/trinodb/trino/pull/5787#pullrequestreview-522994437", "createdAt": "2020-11-04T01:56:55Z", "commit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwMTo1Njo1NlrOHtGk9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwMTo1Njo1NlrOHtGk9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA1NTczMw==", "bodyText": "This PR only covers restoring null behavior.  NaN can be in another PR", "url": "https://github.com/trinodb/trino/pull/5787#discussion_r517055733", "createdAt": "2020-11-04T01:56:56Z", "author": {"login": "dain"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1142,42 +1142,42 @@ public void testGreatest()\n         assertFunction(\"greatest(TINYINT'-1', TINYINT'-2')\", TINYINT, (byte) -1);\n         assertFunction(\"greatest(TINYINT'5', TINYINT'4', TINYINT'3', TINYINT'2', TINYINT'1', TINYINT'2', TINYINT'3', TINYINT'4', TINYINT'1', TINYINT'5')\", TINYINT, (byte) 5);\n         assertFunction(\"greatest(TINYINT'-1')\", TINYINT, (byte) -1);\n-        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, (byte) 5);\n+        assertFunction(\"greatest(TINYINT'5', TINYINT'4', CAST(NULL AS TINYINT), TINYINT'3')\", TINYINT, null);\n \n         // smallint\n         assertFunction(\"greatest(SMALLINT'1', SMALLINT'2')\", SMALLINT, (short) 2);\n         assertFunction(\"greatest(SMALLINT'-1', SMALLINT'-2')\", SMALLINT, (short) -1);\n         assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', SMALLINT'3', SMALLINT'2', SMALLINT'1', SMALLINT'2', SMALLINT'3', SMALLINT'4', SMALLINT'1', SMALLINT'5')\", SMALLINT, (short) 5);\n         assertFunction(\"greatest(SMALLINT'-1')\", SMALLINT, (short) -1);\n-        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, (short) 5);\n+        assertFunction(\"greatest(SMALLINT'5', SMALLINT'4', CAST(NULL AS SMALLINT), SMALLINT'3')\", SMALLINT, null);\n \n         // integer\n         assertFunction(\"greatest(1, 2)\", INTEGER, 2);\n         assertFunction(\"greatest(-1, -2)\", INTEGER, -1);\n         assertFunction(\"greatest(5, 4, 3, 2, 1, 2, 3, 4, 1, 5)\", INTEGER, 5);\n         assertFunction(\"greatest(-1)\", INTEGER, -1);\n-        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, 5);\n+        assertFunction(\"greatest(5, 4, CAST(NULL AS INTEGER), 3)\", INTEGER, null);\n \n         // bigint\n         assertFunction(\"greatest(10000000000, 20000000000)\", BIGINT, 20000000000L);\n         assertFunction(\"greatest(-10000000000, -20000000000)\", BIGINT, -10000000000L);\n         assertFunction(\"greatest(5000000000, 4, 3, 2, 1000000000, 2, 3, 4, 1, 5000000000)\", BIGINT, 5000000000L);\n         assertFunction(\"greatest(-10000000000)\", BIGINT, -10000000000L);\n-        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, 5000000000L);\n+        assertFunction(\"greatest(5000000000, 4000000000, CAST(NULL as BIGINT), 3000000000)\", BIGINT, null);\n \n         // double\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n         assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n-        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5NjE2MQ=="}, "originalCommit": {"oid": "bceca9b7d87153014d152f6a1e134f4389b5548f"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2758, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}