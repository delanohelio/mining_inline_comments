{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MDc2ODMz", "number": 4595, "title": "More JDBC tests", "bodyText": "", "createdAt": "2020-07-27T10:44:31Z", "url": "https://github.com/trinodb/trino/pull/4595", "merged": true, "mergeCommit": {"oid": "804b1738ecc54cb75cf062cd63e9cbcc6f823922"}, "closed": true, "closedAt": "2020-07-29T06:37:26Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4_E9wgH2gAyNDU3MDc2ODMzOmMyNDdjOGZkY2FmODQxMzYxZmQzNTQ3Mzc2MmQ2Zjk1ZTcyYjllNDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5RuO5gFqTQ1NjM5MDI3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c247c8fdcaf841361fd35473762d6f95e72b9e44", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/c247c8fdcaf841361fd35473762d6f95e72b9e44", "committedDate": "2020-07-27T10:15:17Z", "message": "Split test method into multiple"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ed84506d48aef4f03fdf0827789d8e5eba7b623", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/8ed84506d48aef4f03fdf0827789d8e5eba7b623", "committedDate": "2020-07-27T10:41:31Z", "message": "Reorder tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb07517eec51de161bae6c96786a6ce7481fd087", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/eb07517eec51de161bae6c96786a6ce7481fd087", "committedDate": "2020-07-27T10:41:32Z", "message": "Add initial support for ResultSet#getObject with type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd8f4e3a0754054420021653cd0aa7271152958e", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/dd8f4e3a0754054420021653cd0aa7271152958e", "committedDate": "2020-07-27T10:41:58Z", "message": "Test map representation in JDBC ResultSet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed6e5fdb29e95841119d93048476b361d35b5fac", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/ed6e5fdb29e95841119d93048476b361d35b5fac", "committedDate": "2020-07-27T10:43:24Z", "message": "Test row representation in JDBC ResultSet"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NjcxMzUw", "url": "https://github.com/trinodb/trino/pull/4595#pullrequestreview-455671350", "createdAt": "2020-07-27T10:44:49Z", "commit": {"oid": "ed6e5fdb29e95841119d93048476b361d35b5fac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0NDo0OVrOG3dO4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0NDo0OVrOG3dO4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwMzgxMQ==", "bodyText": "#4594", "url": "https://github.com/trinodb/trino/pull/4595#discussion_r460803811", "createdAt": "2020-07-27T10:44:49Z", "author": {"login": "findepi"}, "path": "presto-jdbc/src/test/java/io/prestosql/jdbc/TestJdbcResultSet.java", "diffHunk": "@@ -246,10 +269,83 @@ public void testObjectTypes()\n         });\n     }\n \n+    @Test\n+    public void testIpAddress()\n+            throws Exception\n+    {\n+        checkRepresentation(\"IPADDRESS '1.2.3.4'\", Types.JAVA_OBJECT, \"1.2.3.4\");\n+    }\n+\n+    @Test\n+    public void testUuid()\n+            throws Exception\n+    {\n+        checkRepresentation(\"UUID '0397e63b-2b78-4b7b-9c87-e085fa225dd8'\", Types.JAVA_OBJECT, \"0397e63b-2b78-4b7b-9c87-e085fa225dd8\");\n+    }\n+\n+    @Test\n+    public void testArray()\n+            throws Exception\n+    {\n+        checkRepresentation(\"ARRAY[1, 2]\", Types.ARRAY, (rs, column) -> assertEquals(rs.getArray(column).getArray(), new int[] {1, 2}));\n+    }\n+\n+    @Test\n+    public void testMap()\n+            throws Exception\n+    {\n+        checkRepresentation(\"map(ARRAY['k1', 'k2'], ARRAY[BIGINT '42', -117])\", Types.JAVA_OBJECT, (rs, column) -> {\n+            assertEquals(rs.getObject(column), ImmutableMap.of(\"k1\", 42L, \"k2\", -117L));\n+            assertEquals(rs.getObject(column, Map.class), ImmutableMap.of(\"k1\", 42L, \"k2\", -117L));\n+        });\n+\n+        // NULL value\n+        checkRepresentation(\"map(ARRAY['k1', 'k2'], ARRAY[42, NULL])\", Types.JAVA_OBJECT, (rs, column) -> {\n+            Map<String, Integer> expected = new HashMap<>();\n+            expected.put(\"k1\", 42);\n+            expected.put(\"k2\", null);\n+            assertEquals(rs.getObject(column), expected);\n+            assertEquals(rs.getObject(column, Map.class), expected);\n+        });\n+    }\n+\n+    @Test\n+    public void testRow()\n+            throws Exception\n+    {\n+        // named row\n+        checkRepresentation(\"CAST(ROW(42, 'Presto') AS ROW(a_bigint bigint, a_varchar varchar(17)))\", Types.JAVA_OBJECT, (rs, column) -> {\n+            assertEquals(rs.getObject(column), ImmutableMap.of(\"a_bigint\", 42L, \"a_varchar\", \"Presto\"));\n+            assertEquals(rs.getObject(column, Map.class), ImmutableMap.of(\"a_bigint\", 42L, \"a_varchar\", \"Presto\"));\n+        });\n+\n+        // partially named row\n+        checkRepresentation(\"CAST(ROW(42, 'Presto') AS ROW(a_bigint bigint, varchar(17)))\", Types.JAVA_OBJECT, (rs, column) -> {\n+            assertEquals(rs.getObject(column), ImmutableMap.of(\"a_bigint\", 42L, \"field1\", \"Presto\"));\n+            assertEquals(rs.getObject(column, Map.class), ImmutableMap.of(\"a_bigint\", 42L, \"field1\", \"Presto\"));\n+        });\n+\n+        // anonymous row\n+        checkRepresentation(\"ROW(42, 'Presto')\", Types.JAVA_OBJECT, (rs, column) -> {\n+            assertEquals(rs.getObject(column), ImmutableMap.of(\"field0\", 42, \"field1\", \"Presto\"));\n+            assertEquals(rs.getObject(column, Map.class), ImmutableMap.of(\"field0\", 42, \"field1\", \"Presto\"));\n+        });\n+\n+        // name collision\n+        checkRepresentation(\"CAST(ROW(42, 'Presto') AS ROW(field1 integer, varchar(17)))\", Types.JAVA_OBJECT, (rs, column) -> {\n+            // TODO (https://github.com/prestosql/presto/issues/4594) both fields should be visible or exception thrown", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed6e5fdb29e95841119d93048476b361d35b5fac"}, "originalPosition": 156}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Njk2MzQz", "url": "https://github.com/trinodb/trino/pull/4595#pullrequestreview-455696343", "createdAt": "2020-07-27T11:27:46Z", "commit": {"oid": "ed6e5fdb29e95841119d93048476b361d35b5fac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MzkwMjc0", "url": "https://github.com/trinodb/trino/pull/4595#pullrequestreview-456390274", "createdAt": "2020-07-28T07:57:18Z", "commit": {"oid": "8ed84506d48aef4f03fdf0827789d8e5eba7b623"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNzo1NzoxOVrOG4BCxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNzo1NzoxOVrOG4BCxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MDUzMg==", "bodyText": "Can you explain what is the ordering rule and motivation in the commit message?", "url": "https://github.com/trinodb/trino/pull/4595#discussion_r461390532", "createdAt": "2020-07-28T07:57:19Z", "author": {"login": "kokosing"}, "path": "presto-jdbc/src/test/java/io/prestosql/jdbc/TestJdbcResultSet.java", "diffHunk": "@@ -116,13 +116,6 @@ public void testPrimitiveTypes()\n         checkRepresentation(\"cast('foo' as char(5))\", Types.CHAR, \"foo  \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ed84506d48aef4f03fdf0827789d8e5eba7b623"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4482, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}