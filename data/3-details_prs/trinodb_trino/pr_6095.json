{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NDUwMTEx", "number": 6095, "title": "Separate tested behavior from mechanics in the test", "bodyText": "Factor out the repetitive stanzas so that tested aspects are easier to\nsee. Since upon failure the actual failing query is reported, it does\nnot limit ability to hand-test selected cases.\nRelates to: #5692 (comment)", "createdAt": "2020-11-25T13:35:43Z", "url": "https://github.com/trinodb/trino/pull/6095", "merged": true, "mergeCommit": {"oid": "a10aaf1c6ee2ea8935e02d4ecb24499aa0229842"}, "closed": true, "closedAt": "2020-11-27T08:49:45Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgULdnAH2gAyNTI3NDUwMTExOjY1YWQ0ZjVhYWRlMWFjNTdiYTAwYTQ4Nzg4ZTczNjM1YzE4ZTRjYmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgV1W9AFqTUzOTQ2MDkxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65ad4f5aade1ac57ba00a48788e73635c18e4cbe", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/65ad4f5aade1ac57ba00a48788e73635c18e4cbe", "committedDate": "2020-11-26T14:53:26Z", "message": "Make testUnwrap more flexible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ab56b74100b3c2986af30dd9af7c4ac14fb5bb6", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/9ab56b74100b3c2986af30dd9af7c4ac14fb5bb6", "committedDate": "2020-11-26T14:53:26Z", "message": "Verify expected plan consistently\n\nSome assertion were using explicit matching while others were using\n`anyTree` for no apparent reason. Make the assertions consistent across\nthe class."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDAzMjM1", "url": "https://github.com/trinodb/trino/pull/6095#pullrequestreview-539403235", "createdAt": "2020-11-26T15:22:19Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNToyMjoxOVrOH6fqVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNToyMjoxOVrOH6fqVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA5ODE5Ng==", "bodyText": "is the casing of aND purposeful :)", "url": "https://github.com/trinodb/trino/pull/6095#discussion_r531098196", "createdAt": "2020-11-26T15:22:19Z", "author": {"login": "losipiuk"}, "path": "presto-main/src/test/java/io/prestosql/sql/planner/TestUnwrapCastInComparison.java", "diffHunk": "@@ -32,830 +32,364 @@\n     public void testEquals()\n     {\n         // representable\n-        assertPlan(\n-                \"SELECT * FROM (VALUES SMALLINT '0') t(a) WHERE a = DOUBLE '1'\",\n-                output(\n-                        filter(\"A = SMALLINT '1'\",\n-                                values(\"A\"))));\n+        testUnwrap(\"smallint\", \"a = DOUBLE '1'\", \"a = SMALLINT '1'\");\n \n-        assertPlan(\n-                \"SELECT * FROM (VALUES BIGINT '0') t(a) WHERE a = DOUBLE '1'\",\n-                output(\n-                        filter(\"A = BIGINT '1'\",\n-                                values(\"A\"))));\n+        testUnwrap(\"bigint\", \"a = DOUBLE '1'\", \"a = BIGINT '1'\");\n \n         // non-representable\n-        assertPlan(\n-                \"SELECT * FROM (VALUES SMALLINT '0') t(a) WHERE a = DOUBLE '1.1'\",\n-                output(\n-                        filter(\"A IS NULL AND NULL\",\n-                                values(\"A\"))));\n-        assertPlan(\n-                \"SELECT * FROM (VALUES SMALLINT '0') t(a) WHERE a = DOUBLE '1.9'\",\n-                output(\n-                        filter(\"A IS NULL AND NULL\",\n-                                values(\"A\"))));\n+        testUnwrap(\"smallint\", \"a = DOUBLE '1.1'\", \"A IS NULL aND NULL\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDA0OTU5", "url": "https://github.com/trinodb/trino/pull/6095#pullrequestreview-539404959", "createdAt": "2020-11-26T15:24:41Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "b00336e40027dc2cfe7ff80cab3b85efc44d0d84", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/b00336e40027dc2cfe7ff80cab3b85efc44d0d84", "committedDate": "2020-11-26T16:29:42Z", "message": "Separate tested behavior from mechanics in TestUnwrapCastInComparison\n\nFactor out the repetitive stanzas so that tested aspects are easier to\nsee. Since upon failure the actual failing query is reported, it does\nnot limit ability to hand-test selected cases."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "b00336e40027dc2cfe7ff80cab3b85efc44d0d84", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/b00336e40027dc2cfe7ff80cab3b85efc44d0d84", "committedDate": "2020-11-26T16:29:42Z", "message": "Separate tested behavior from mechanics in TestUnwrapCastInComparison\n\nFactor out the repetitive stanzas so that tested aspects are easier to\nsee. Since upon failure the actual failing query is reported, it does\nnot limit ability to hand-test selected cases."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDYwOTE4", "url": "https://github.com/trinodb/trino/pull/6095#pullrequestreview-539460918", "createdAt": "2020-11-26T16:49:06Z", "commit": {"oid": "b00336e40027dc2cfe7ff80cab3b85efc44d0d84"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2351, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}