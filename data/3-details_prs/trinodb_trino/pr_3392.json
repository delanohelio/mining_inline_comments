{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxMzc2OTA2", "number": 3392, "title": "Add starts_with function", "bodyText": "Motivation: Resolve #3394\nTasks\n\n Document\n Update presto-docs/src/main/sphinx/functions/list.rst", "createdAt": "2020-04-09T11:45:50Z", "url": "https://github.com/trinodb/trino/pull/3392", "merged": true, "mergeCommit": {"oid": "5344920384d78d816d3cefe42489c22b626ad71d"}, "closed": true, "closedAt": "2020-04-13T22:19:41Z", "author": {"login": "yuokada"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcV7GFOABqjMyMTc5NjUwMzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWe-zdABqjMyMjM2OTQ1Nzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNjQ1MTM1", "url": "https://github.com/trinodb/trino/pull/3392#pullrequestreview-391645135", "createdAt": "2020-04-10T20:26:57Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQyMDoyNjo1N1rOGEE5ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQyMDozMDo0NlrOGEFBOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkyNzcxNw==", "bodyText": "How about \"Tests whether substring is a prefix of string\".\n@mosabua, any suggestions?", "url": "https://github.com/trinodb/trino/pull/3392#discussion_r406927717", "createdAt": "2020-04-10T20:26:57Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/functions/string.rst", "diffHunk": "@@ -141,6 +141,10 @@ String Functions\n     Returns the starting position of the first instance of ``substring`` in\n     ``string``. Positions start with ``1``. If not found, ``0`` is returned.\n \n+.. function:: starts_with(string, substring) -> boolean\n+\n+    Returns boolean whether ``string`` starts with ``substring`` or not", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjkyOTcyMw==", "bodyText": "Can you add tests for:\n\nstrings that contain non-ascii unicode characters?\nwhere the string is shorter than the substring\nempty string and/or empty substring", "url": "https://github.com/trinodb/trino/pull/3392#discussion_r406929723", "createdAt": "2020-04-10T20:30:46Z", "author": {"login": "martint"}, "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestStringFunctions.java", "diffHunk": "@@ -284,6 +284,11 @@ public void testStringPosition()\n         testStrPosAndPosition(\"\", null, null);\n         testStrPosAndPosition(null, null, null);\n \n+        assertFunction(\"STARTS_WITH('foo', 'foo')\", BOOLEAN, true);\n+        assertFunction(\"STARTS_WITH('foo', 'bar')\", BOOLEAN, false);\n+        assertFunction(\"STARTS_WITH('foo_bar_baz', 'foo')\", BOOLEAN, true);\n+        assertFunction(\"STARTS_WITH('foo_bar_baz', 'bar')\", BOOLEAN, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzIxOTEz", "url": "https://github.com/trinodb/trino/pull/3392#pullrequestreview-391721913", "createdAt": "2020-04-11T01:14:42Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMToxNDo0MlrOGEJNwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMToxNToyNlrOGEJOAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjk5ODQ2NQ==", "bodyText": "substring and string should be surrounded by `\nAlso, there's an extra \" at the end of the sentence.", "url": "https://github.com/trinodb/trino/pull/3392#discussion_r406998465", "createdAt": "2020-04-11T01:14:42Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/functions/string.rst", "diffHunk": "@@ -141,6 +141,10 @@ String Functions\n     Returns the starting position of the first instance of ``substring`` in\n     ``string``. Positions start with ``1``. If not found, ``0`` is returned.\n \n+.. function:: starts_with(string, substring) -> boolean\n+\n+    Tests whether substring is a prefix of string\".", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjk5ODUzMA==", "bodyText": "else is unnecessary:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (source.length() < prefix.length()) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                    else {\n          \n          \n            \n                        return source.compareTo(0, prefix.length(), prefix, 0, prefix.length()) == 0;\n          \n          \n            \n                    }\n          \n          \n            \n                    if (source.length() < prefix.length()) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                    return source.compareTo(0, prefix.length(), prefix, 0, prefix.length()) == 0;", "url": "https://github.com/trinodb/trino/pull/3392#discussion_r406998530", "createdAt": "2020-04-11T01:15:26Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/StringFunctions.java", "diffHunk": "@@ -899,4 +899,18 @@ public static Slice concat(@LiteralParameter(\"x\") Long x, @SqlType(\"char(x)\") Sl\n \n         return result;\n     }\n+\n+    @Description(\"Determine whether source starts with prefix or not\")\n+    @ScalarFunction(\"starts_with\")\n+    @LiteralParameters({\"x\", \"y\"})\n+    @SqlType(StandardTypes.BOOLEAN)\n+    public static boolean startsWith(@SqlType(\"varchar(x)\") Slice source, @SqlType(\"varchar(y)\") Slice prefix)\n+    {\n+        if (source.length() < prefix.length()) {\n+            return false;\n+        }\n+        else {\n+            return source.compareTo(0, prefix.length(), prefix, 0, prefix.length()) == 0;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzI1NTgw", "url": "https://github.com/trinodb/trino/pull/3392#pullrequestreview-391725580", "createdAt": "2020-04-11T01:58:12Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzI5Nzk3", "url": "https://github.com/trinodb/trino/pull/3392#pullrequestreview-391729797", "createdAt": "2020-04-11T02:56:50Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMjo1Njo1MFrOGEJ1Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMjo1Njo1MFrOGEJ1Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwODUyNw==", "bodyText": "nit: We can remove (\"starts_with\") because the method name startsWith  will be translated to starts_with function.", "url": "https://github.com/trinodb/trino/pull/3392#discussion_r407008527", "createdAt": "2020-04-11T02:56:50Z", "author": {"login": "ebyhr"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/StringFunctions.java", "diffHunk": "@@ -899,4 +899,16 @@ public static Slice concat(@LiteralParameter(\"x\") Long x, @SqlType(\"char(x)\") Sl\n \n         return result;\n     }\n+\n+    @Description(\"Determine whether source starts with prefix or not\")\n+    @ScalarFunction(\"starts_with\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e0e2e13a72499b1a9b1fd004c5db24cde91e13", "author": {"user": {"login": "yuokada", "name": "Yukihiro Okada (Yuki)"}}, "url": "https://github.com/trinodb/trino/commit/91e0e2e13a72499b1a9b1fd004c5db24cde91e13", "committedDate": "2020-04-11T05:37:55Z", "message": "Add starts_with function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "91e0e2e13a72499b1a9b1fd004c5db24cde91e13", "author": {"user": {"login": "yuokada", "name": "Yukihiro Okada (Yuki)"}}, "url": "https://github.com/trinodb/trino/commit/91e0e2e13a72499b1a9b1fd004c5db24cde91e13", "committedDate": "2020-04-11T05:37:55Z", "message": "Add starts_with function"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1860, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}