{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1ODMxNDY3", "number": 3044, "title": "Add GitHub workflow for Azure tests", "bodyText": "", "createdAt": "2020-03-09T21:38:39Z", "url": "https://github.com/trinodb/trino/pull/3044", "merged": true, "mergeCommit": {"oid": "abdc5f24324c0862cbe9180ea3145e92a0f9f5ac"}, "closed": true, "closedAt": "2020-09-01T21:55:03Z", "author": {"login": "electrum"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMFTC1ABqjMxMTI1NTg4NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEs03fABqjM3MTY1NTkwNTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "2934e88bb84b01ac0041770784ebfde5a461199a", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/2934e88bb84b01ac0041770784ebfde5a461199a", "committedDate": "2020-03-09T23:08:01Z", "message": "Delete workflows for testing"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2934e88bb84b01ac0041770784ebfde5a461199a", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/2934e88bb84b01ac0041770784ebfde5a461199a", "committedDate": "2020-03-09T23:08:01Z", "message": "Delete workflows for testing"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "7fb6ae509b0a726eee9693c219276b32b4f47131", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/7fb6ae509b0a726eee9693c219276b32b4f47131", "committedDate": "2020-03-11T00:43:43Z", "message": "Delete workflows for testing"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fb6ae509b0a726eee9693c219276b32b4f47131", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/7fb6ae509b0a726eee9693c219276b32b4f47131", "committedDate": "2020-03-11T00:43:43Z", "message": "Delete workflows for testing"}, "afterCommit": {"oid": "16be19b55ed649ee9f8023decb24e5aee022de7e", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/16be19b55ed649ee9f8023decb24e5aee022de7e", "committedDate": "2020-03-11T01:31:01Z", "message": "Delete workflows for testing"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16be19b55ed649ee9f8023decb24e5aee022de7e", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/16be19b55ed649ee9f8023decb24e5aee022de7e", "committedDate": "2020-03-11T01:31:01Z", "message": "Delete workflows for testing"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/8cd801b4cb448ddb37954b24ceffdca237cc8661", "committedDate": "2020-03-21T16:56:51Z", "message": "Add GitHub workflow for Azure tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MjQ2Mjc5", "url": "https://github.com/trinodb/trino/pull/3044#pullrequestreview-379246279", "createdAt": "2020-03-23T09:15:53Z", "commit": {"oid": "a3290155a76932227b020ba26d7f5462c0e288a9"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToxNTo1NFrOF58jIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwOToyNzo1OFrOF58-pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNTE4NA==", "bodyText": "S3 -> Azure\n\n\nyou can squash Restart hive-server2 for Azure tests commit", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r396305184", "createdAt": "2020-03-23T09:15:54Z", "author": {"login": "findepi"}, "path": "presto-hive-hadoop2/bin/run_hive_abfs_tests.sh", "diffHunk": "@@ -18,6 +18,10 @@ exec_in_hadoop_master_container sed -i \\\n     -e \"s|%ABFS_ACCOUNT%|${ABFS_ACCOUNT}|g\" \\\n     /etc/hadoop/conf/core-site.xml\n \n+# restart hive-server2 to apply S3 changes in core-site.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3290155a76932227b020ba26d7f5462c0e288a9"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwNTU2Mg==", "bodyText": "Why? Is your intention to run this for  config-cdh5? (upcoming; already mentioned in this file)\nAdd a comment. Maybe\n# config-empty's Hive 1.2 does not support Azure storage", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r396305562", "createdAt": "2020-03-23T09:16:37Z", "author": {"login": "findepi"}, "path": ".github/workflows/module-tests.yml", "diffHunk": "@@ -51,6 +51,17 @@ jobs:\n           if [ \"${AWS_ACCESS_KEY_ID}\" != \"\" ]; then\n             ./mvnw test -B -Dair.check.skip-all -pl presto-hive -P test-hive-glue\n           fi\n+      - name: Run Hive Azure ABFS Tests\n+        if: matrix.config != 'config-empty'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMwOTIxMQ==", "bodyText": "for s3 tests we leverage auto-delete functionality to provide test isolation\nhttps://github.com/prestosql/presto/blob/cbf0d04b766d7a90c69e8dd7bc18a48779441749/presto-hive-hadoop2/bin/run_hive_s3_tests.sh#L10\nAzure has an equivalent: https://stackoverflow.com/a/56906611/65458\n@electrum @anusudarsan can we have this enabled?\notherwise I would want this folder to be called ..._2, to ensure no conflicts in installations running previous versions of these tests, that used different set of test files (one vs four)", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r396309211", "createdAt": "2020-03-23T09:22:58Z", "author": {"login": "findepi"}, "path": "presto-hive-hadoop2/bin/run_hive_abfs_tests.sh", "diffHunk": "@@ -18,6 +18,34 @@ exec_in_hadoop_master_container sed -i \\\n     -e \"s|%ABFS_ACCOUNT%|${ABFS_ACCOUNT}|g\" \\\n     /etc/hadoop/conf/core-site.xml\n \n+# restart hive-server2 to apply S3 changes in core-site.xml\n+docker exec \"$(hadoop_master_container)\" supervisorctl restart hive-server2\n+retry check_hadoop\n+\n+# create test table\n+table_path=\"abfs://${ABFS_CONTAINER}@${ABFS_ACCOUNT}.dfs.core.windows.net/presto_test_external_fs/\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMxMDM1MA==", "bodyText": "same comment as for abfs; & applies to wasb too", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r396310350", "createdAt": "2020-03-23T09:24:57Z", "author": {"login": "findepi"}, "path": "presto-hive-hadoop2/bin/run_hive_adl_tests.sh", "diffHunk": "@@ -21,9 +21,9 @@ exec_in_hadoop_master_container sed -i \\\n     /etc/hadoop/conf/core-site.xml\n \n # create test table\n-table_path=\"adl://${ADL_NAME}.azuredatalakestore.net/presto_test_external_fs_2/\"\n+table_path=\"adl://${ADL_NAME}.azuredatalakestore.net/presto_test_external_fs/\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMxMjIyOQ==", "bodyText": "What replaces this test?", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r396312229", "createdAt": "2020-03-23T09:27:58Z", "author": {"login": "findepi"}, "path": "presto-hive-hadoop2/src/test/java/io/prestosql/plugin/hive/TestHiveAzure.java", "diffHunk": "@@ -1,62 +0,0 @@\n-/*\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-package io.prestosql.plugin.hive;\n-\n-import com.google.common.collect.ImmutableSet;\n-import io.prestosql.plugin.hive.azure.HiveAzureConfig;\n-import io.prestosql.plugin.hive.azure.PrestoAzureConfigurationInitializer;\n-import org.testng.annotations.BeforeClass;\n-import org.testng.annotations.Parameters;\n-\n-import static com.google.common.base.Preconditions.checkArgument;\n-import static com.google.common.base.Strings.isNullOrEmpty;\n-\n-public class TestHiveAzure", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cd801b4cb448ddb37954b24ceffdca237cc8661", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/8cd801b4cb448ddb37954b24ceffdca237cc8661", "committedDate": "2020-03-21T16:56:51Z", "message": "Add GitHub workflow for Azure tests"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "5a14f7d35fd8aa0cc284fe0bf0f04303737d9ab5", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/5a14f7d35fd8aa0cc284fe0bf0f04303737d9ab5", "committedDate": "2020-08-28T22:37:28Z", "message": "HACK only run Azure tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "6d6882fb36eb3909c58fdae7a68603b37707a20d", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/6d6882fb36eb3909c58fdae7a68603b37707a20d", "committedDate": "2020-08-31T18:40:15Z", "message": "HACK only run Azure tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d6882fb36eb3909c58fdae7a68603b37707a20d", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/6d6882fb36eb3909c58fdae7a68603b37707a20d", "committedDate": "2020-08-31T18:40:15Z", "message": "HACK only run Azure tests"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "7fd81ff87db3aee8f3c9b99e5d61af66842be03c", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/7fd81ff87db3aee8f3c9b99e5d61af66842be03c", "committedDate": "2020-09-01T00:28:33Z", "message": "HACK only run Azure tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b53a9b733c1b47ef0f7cdb86d4f111c4ee02ba8d", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/b53a9b733c1b47ef0f7cdb86d4f111c4ee02ba8d", "committedDate": "2020-09-01T17:16:48Z", "message": "Rename S3 secret names to use uppercase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74bc6ae3426f2d0bdcede06bd3ed8ac5a4488c7f", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/74bc6ae3426f2d0bdcede06bd3ed8ac5a4488c7f", "committedDate": "2020-09-01T17:16:48Z", "message": "Remove unused Azure tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f6fcb2568033f2c01a5bd30117c9f74ae75ce21", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/5f6fcb2568033f2c01a5bd30117c9f74ae75ce21", "committedDate": "2020-09-01T17:16:48Z", "message": "Only run CI on push to master"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fd81ff87db3aee8f3c9b99e5d61af66842be03c", "author": {"user": {"login": "electrum", "name": "David Phillips"}}, "url": "https://github.com/trinodb/trino/commit/7fd81ff87db3aee8f3c9b99e5d61af66842be03c", "committedDate": "2020-09-01T00:28:33Z", "message": "HACK only run Azure tests"}, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMDE1ODQ0", "url": "https://github.com/trinodb/trino/pull/3044#pullrequestreview-480015844", "createdAt": "2020-09-01T18:38:09Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODozODowOVrOHLDYVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODozODowOVrOHLDYVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTc2NA==", "bodyText": "Why hash and cut the UUID? Using the full UUID doesn't make it any easier or harder to read, and it's not so many characters that it should cause problems.\nI'd suggest a slightly more verbose name, in case someone needs to find a particular test at any point, something like \"test-$(date +%Y-%m-%dT%H.%M.%S)-id-$(uuidgen)\".", "url": "https://github.com/trinodb/trino/pull/3044#discussion_r481351764", "createdAt": "2020-09-01T18:38:09Z", "author": {"login": "jirassimok"}, "path": "presto-hive-hadoop2/bin/run_hive_abfs_tests.sh", "diffHunk": "@@ -8,7 +8,11 @@ test -v ABFS_CONTAINER\n test -v ABFS_ACCOUNT\n test -v ABFS_ACCESS_KEY\n \n-start_docker_containers\n+cleanup_hadoop_docker_containers\n+start_hadoop_docker_containers\n+\n+test_directory=\"$(date '+%Y%m%d-%H%M%S')-$(uuidgen | sha1sum | cut -b 1-6)\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8251b47ea230378e9059f1fdbe977f7b161cb70", "author": {"user": {"login": "anusudarsan", "name": "Anu Sudarsan"}}, "url": "https://github.com/trinodb/trino/commit/a8251b47ea230378e9059f1fdbe977f7b161cb70", "committedDate": "2020-09-01T19:46:10Z", "message": "Add GitHub workflow for Azure tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a8251b47ea230378e9059f1fdbe977f7b161cb70", "author": {"user": {"login": "anusudarsan", "name": "Anu Sudarsan"}}, "url": "https://github.com/trinodb/trino/commit/a8251b47ea230378e9059f1fdbe977f7b161cb70", "committedDate": "2020-09-01T19:46:10Z", "message": "Add GitHub workflow for Azure tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2119, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}