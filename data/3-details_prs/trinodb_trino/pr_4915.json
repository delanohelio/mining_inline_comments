{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNjIyNTk2", "number": 4915, "title": "Test connector when running join with empty build side", "bodyText": "Test connector when running join with empty build side", "createdAt": "2020-08-21T13:07:13Z", "url": "https://github.com/trinodb/trino/pull/4915", "merged": true, "mergeCommit": {"oid": "e428f603d4a8b9a87fd853cc8f46fd1a5e303a02"}, "closed": true, "closedAt": "2020-08-25T18:27:49Z", "author": {"login": "kokosing"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBFRaLAFqTQ3MjUxMzQ0Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCWEaggBqjM2ODk3NjU3NjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNTEzNDQ2", "url": "https://github.com/trinodb/trino/pull/4915#pullrequestreview-472513446", "createdAt": "2020-08-21T13:59:42Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNjIzNjE3", "url": "https://github.com/trinodb/trino/pull/4915#pullrequestreview-472623617", "createdAt": "2020-08-21T16:20:37Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNjoyMDozN1rOHEzY1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNjoyMToxMVrOHEzaEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc5ODI5NA==", "bodyText": "You should also disable join reordering.", "url": "https://github.com/trinodb/trino/pull/4915#discussion_r474798294", "createdAt": "2020-08-21T16:20:37Z", "author": {"login": "findepi"}, "path": "presto-testing/src/main/java/io/prestosql/testing/AbstractTestIntegrationSmokeTest.java", "diffHunk": "@@ -196,6 +198,21 @@ public void testSelectAll()\n         assertQuery(\"SELECT * FROM orders\");\n     }\n \n+    /**\n+     * Test interactions between optimizer (including CBO), scheduling and connector metadata APIs.\n+     */\n+    @Test(timeOut = 300_000)\n+    public void testJoinWithEmptyBuildSide()\n+    {\n+        for (JoinDistributionType joinDistributionType : JoinDistributionType.values()) {\n+            Session session = Session.builder(getSession())\n+                    .setSystemProperty(JOIN_DISTRIBUTION_TYPE, joinDistributionType.toString())", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc5ODYxMQ==", "bodyText": "can we test with empty proble side as well?\njust in case eg quick termination of the source stage (of the build side) does not leave things lingering?", "url": "https://github.com/trinodb/trino/pull/4915#discussion_r474798611", "createdAt": "2020-08-21T16:21:11Z", "author": {"login": "findepi"}, "path": "presto-testing/src/main/java/io/prestosql/testing/AbstractTestIntegrationSmokeTest.java", "diffHunk": "@@ -196,6 +198,21 @@ public void testSelectAll()\n         assertQuery(\"SELECT * FROM orders\");\n     }\n \n+    /**\n+     * Test interactions between optimizer (including CBO), scheduling and connector metadata APIs.\n+     */\n+    @Test(timeOut = 300_000)\n+    public void testJoinWithEmptyBuildSide()\n+    {\n+        for (JoinDistributionType joinDistributionType : JoinDistributionType.values()) {\n+            Session session = Session.builder(getSession())\n+                    .setSystemProperty(JOIN_DISTRIBUTION_TYPE, joinDistributionType.toString())\n+                    .build();\n+            assertQuery(session, \"SELECT count(*) FROM nation JOIN region ON nation.regionkey = region.regionkey AND region.name = ''\", \"VALUES 0\");\n+            assertQuery(session, \"SELECT count(*) FROM nation JOIN region ON nation.regionkey = region.regionkey AND region.regionkey < 0\", \"VALUES 0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e597e7713d72f85a988fcc15c912c6fcc0b54a1", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/4e597e7713d72f85a988fcc15c912c6fcc0b54a1", "committedDate": "2020-08-25T12:07:23Z", "message": "Test connector when running join with empty build side"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "4e597e7713d72f85a988fcc15c912c6fcc0b54a1", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/4e597e7713d72f85a988fcc15c912c6fcc0b54a1", "committedDate": "2020-08-25T12:07:23Z", "message": "Test connector when running join with empty build side"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4049, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}