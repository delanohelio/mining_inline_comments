{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4MTgyNTIw", "number": 4839, "title": "Fixes JAVA_HOME in container image", "bodyText": "A follow up of #4642\nProblem\nThe JAVA_HOME has been changed after using new JDK package.", "createdAt": "2020-08-14T21:04:47Z", "url": "https://github.com/trinodb/trino/pull/4839", "merged": true, "mergeCommit": {"oid": "2d97150678b032e4c2dda21cc4f97f3aa8dea7be"}, "closed": true, "closedAt": "2020-09-16T21:03:44Z", "author": {"login": "shawnzhu"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-7W8ngBqjM2NTc3MjczNDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAcjMUgBqjM2NzEwNzcwOTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzY0NDc0", "url": "https://github.com/trinodb/trino/pull/4839#pullrequestreview-469764474", "createdAt": "2020-08-18T19:36:52Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTozNjo1MlrOHCjGkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTozODoyNVrOHCjJsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQzNDMyMQ==", "bodyText": "Do we need to override the entry point? It seems like running the command directly works:\ndocker run --rm \"${CONTAINER_NAME}\" /bin/bash -c '$JAVA_HOME/bin/java -version' &> /dev/null\n\nIf we use ' instead of \" we don't need to escape the $ in the argument.", "url": "https://github.com/trinodb/trino/pull/4839#discussion_r472434321", "createdAt": "2020-08-18T19:36:52Z", "author": {"login": "electrum"}, "path": "docker/container-test.sh", "diffHunk": "@@ -33,3 +33,10 @@ function test_container {\n     # Return proper exit code.\n     [[ ${RESULT} == '\"success\"' ]]\n }\n+\n+function test_javahome {\n+    # Check if JAVA_HOME works\n+    docker run --rm --entrypoint /bin/bash \"${CONTAINER_NAME}\" -c \"\\$JAVA_HOME/bin/java -version\" &> /dev/null", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQzNTEyMw==", "bodyText": "This needs to be called from the two build-* scripts. Alternatively, is it possible to integrate this into the above test_container method so all the tests are in one function?", "url": "https://github.com/trinodb/trino/pull/4839#discussion_r472435123", "createdAt": "2020-08-18T19:38:25Z", "author": {"login": "electrum"}, "path": "docker/container-test.sh", "diffHunk": "@@ -33,3 +33,10 @@ function test_container {\n     # Return proper exit code.\n     [[ ${RESULT} == '\"success\"' ]]\n }\n+\n+function test_javahome {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTM3Nzkw", "url": "https://github.com/trinodb/trino/pull/4839#pullrequestreview-469937790", "createdAt": "2020-08-19T00:49:11Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTQyMDUx", "url": "https://github.com/trinodb/trino/pull/4839#pullrequestreview-469942051", "createdAt": "2020-08-19T00:51:48Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMDo1MTo0OFrOHCriIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMDo1MTo0OFrOHCriIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU3MjQ0OA==", "bodyText": "The variable is CONTAINER_ID", "url": "https://github.com/trinodb/trino/pull/4839#discussion_r472572448", "createdAt": "2020-08-19T00:51:48Z", "author": {"login": "electrum"}, "path": "docker/container-test.sh", "diffHunk": "@@ -33,3 +33,14 @@ function test_container {\n     # Return proper exit code.\n     [[ ${RESULT} == '\"success\"' ]]\n }\n+\n+function test_javahome {\n+    # Check if JAVA_HOME works\n+    docker run --rm \"${CONTAINER_NAME}\" /bin/bash -c '$JAVA_HOME/bin/java -version' &> /dev/null", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50463ebe37a65c2c25ae40a744e52a9f737ba5f9", "author": {"user": {"login": "shawnzhu", "name": "Ke Zhu"}}, "url": "https://github.com/trinodb/trino/commit/50463ebe37a65c2c25ae40a744e52a9f737ba5f9", "committedDate": "2020-08-19T14:07:08Z", "message": "Fix JAVA_HOME in container image\n\nSigned-off-by: Ke Zhu <kzhu@us.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "a068455d37c6616266f3a4a2229c7bc7ca3f1b4c", "author": {"user": {"login": "shawnzhu", "name": "Ke Zhu"}}, "url": "https://github.com/trinodb/trino/commit/a068455d37c6616266f3a4a2229c7bc7ca3f1b4c", "committedDate": "2020-08-19T14:32:50Z", "message": "Add new test to verify if JAVA_HOME works\n\nSigned-off-by: Ke Zhu <kzhu@us.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a068455d37c6616266f3a4a2229c7bc7ca3f1b4c", "author": {"user": {"login": "shawnzhu", "name": "Ke Zhu"}}, "url": "https://github.com/trinodb/trino/commit/a068455d37c6616266f3a4a2229c7bc7ca3f1b4c", "committedDate": "2020-08-19T14:32:50Z", "message": "Add new test to verify if JAVA_HOME works\n\nSigned-off-by: Ke Zhu <kzhu@us.ibm.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4379, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}