{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MjkzNDY4", "number": 5376, "title": "Rename ParquetWriterConfig properties from hive.parquet to parquet", "bodyText": "", "createdAt": "2020-10-01T14:13:35Z", "url": "https://github.com/trinodb/trino/pull/5376", "merged": true, "mergeCommit": {"oid": "ddd81f6c6eef933d99a0e49622139c0ab79fc4f3"}, "closed": true, "closedAt": "2020-10-22T15:03:56Z", "author": {"login": "jirassimok"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOSE1mgFqTUwMDM5MzkwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUFh2QgFqTUxMTg2MjE1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMzkzOTA5", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-500393909", "createdAt": "2020-10-01T14:15:45Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNDoxNTo0NVrOHbMguA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNDoxNTo0NVrOHbMguA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI3ODU4NA==", "bodyText": "For convenience, here's where the comment thread on the commit is.", "url": "https://github.com/trinodb/trino/pull/5376#discussion_r498278584", "createdAt": "2020-10-01T14:15:45Z", "author": {"login": "jirassimok"}, "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/parquet/TestParquetWriterConfig.java", "diffHunk": "@@ -36,14 +36,28 @@ public void testDefaults()\n                 .setPageSize(DataSize.ofBytes(ParquetWriter.DEFAULT_PAGE_SIZE)));\n     }\n \n+    @Test\n+    public void testLegacyProperties()\n+    {\n+        assertDeprecatedEquivalence(\n+                ParquetWriterConfig.class,\n+                Map.of(\n+                        \"parquet.optimized-writer.enabled\", \"true\",\n+                        \"parquet.writer.block-size\", \"2PB\",\n+                        \"parquet.writer.page-size\", \"3PB\"),\n+                Map.of(\n+                        \"hive.parquet.optimized-writer.enabled\", \"true\",\n+                        \"hive.parquet.writer.block-size\", \"2PB\",\n+                        \"hive.parquet.writer.page-size\", \"3PB\"));\n+    }\n+\n     @Test\n     public void testExplicitPropertyMappings()\n     {\n-        Map<String, String> properties = new ImmutableMap.Builder<String, String>()\n-                .put(\"hive.parquet.optimized-writer.enabled\", \"true\")\n-                .put(\"hive.parquet.writer.block-size\", \"234MB\")\n-                .put(\"hive.parquet.writer.page-size\", \"11MB\")\n-                .build();\n+        Map<String, String> properties = Map.of(\n+                \"parquet.optimized-writer.enabled\", \"true\",\n+                \"parquet.writer.block-size\", \"234MB\",\n+                \"parquet.writer.page-size\", \"11MB\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNDExODQz", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-500411843", "createdAt": "2020-10-01T14:32:31Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzOTM2Mjc4", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-503936278", "createdAt": "2020-10-07T14:23:42Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDoyMzo0M1rOHd19jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNDoyMzo0M1rOHd19jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTA1NDg2MA==", "bodyText": "instead of adding @LegacyConfig you can bind the config as configBinder(binder).bindConfig(ParquetWriterConfig.class, \"hive\") in Hive", "url": "https://github.com/trinodb/trino/pull/5376#discussion_r501054860", "createdAt": "2020-10-07T14:23:43Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/parquet/ParquetWriterConfig.java", "diffHunk": "@@ -31,7 +32,8 @@ public DataSize getBlockSize()\n         return blockSize;\n     }\n \n-    @Config(\"hive.parquet.writer.block-size\")\n+    @Config(\"parquet.writer.block-size\")\n+    @LegacyConfig(\"hive.parquet.writer.block-size\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NzkwODg0", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-504790884", "createdAt": "2020-10-08T13:37:31Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMzozNzozMVrOHee-kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxMzozNzozMVrOHee-kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcyNjg2NQ==", "bodyText": "Should I make the same change (drop @LegacyConfig and use bindConfig with \"hive\" in HiveModule instead of) to ParquetReaderConfig? Right now, the usage of the reader and writer properteis is inconsistent, as seen here.\nBut ParquetReaderConfig has been using @LegacyConfig for nearly a year, since 5ab85b7.", "url": "https://github.com/trinodb/trino/pull/5376#discussion_r501726865", "createdAt": "2020-10-08T13:37:31Z", "author": {"login": "jirassimok"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveModule.java", "diffHunk": "@@ -119,7 +119,7 @@ public void configure(Binder binder)\n         fileWriterFactoryBinder.addBinding().to(RcFileFileWriterFactory.class).in(Scopes.SINGLETON);\n \n         configBinder(binder).bindConfig(ParquetReaderConfig.class);\n-        configBinder(binder).bindConfig(ParquetWriterConfig.class);\n+        configBinder(binder).bindConfig(ParquetWriterConfig.class, \"hive\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mzc4MDYz", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-509378063", "createdAt": "2020-10-15T13:28:11Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d0c1d93eab2dc55f859440d06c9bb7e93b446bf", "author": {"user": {"login": "jirassimok", "name": "Jacob Ilias Komissar"}}, "url": "https://github.com/trinodb/trino/commit/3d0c1d93eab2dc55f859440d06c9bb7e93b446bf", "committedDate": "2020-10-15T17:04:10Z", "message": "Rename ParquetWriterConfig properties from hive.parquet to parquet"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "3d0c1d93eab2dc55f859440d06c9bb7e93b446bf", "author": {"user": {"login": "jirassimok", "name": "Jacob Ilias Komissar"}}, "url": "https://github.com/trinodb/trino/commit/3d0c1d93eab2dc55f859440d06c9bb7e93b446bf", "committedDate": "2020-10-15T17:04:10Z", "message": "Rename ParquetWriterConfig properties from hive.parquet to parquet"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjg0MzM3", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-510284337", "createdAt": "2020-10-16T09:02:24Z", "commit": {"oid": "3d0c1d93eab2dc55f859440d06c9bb7e93b446bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExODYyMTU1", "url": "https://github.com/trinodb/trino/pull/5376#pullrequestreview-511862155", "createdAt": "2020-10-19T15:02:13Z", "commit": {"oid": "3d0c1d93eab2dc55f859440d06c9bb7e93b446bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3550, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}