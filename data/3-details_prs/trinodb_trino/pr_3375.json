{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNDY3Mzg2", "number": 3375, "title": "Add overwrite insert for Hive connector", "bodyText": "We should also make a table of properties from HiveSessionProperties somewhere .. but not sure where on the Hive docs page or if that is even a good idea since they are currently dispersed across different topics such as s3 ... so where should we add docs for this property specifically in your opinion @electrum\nFixes #485", "createdAt": "2020-04-07T19:48:02Z", "url": "https://github.com/trinodb/trino/pull/3375", "merged": true, "mergeCommit": {"oid": "58c58bd1d9db22f07ebb7adb2f638cebd8dd239c"}, "closed": true, "closedAt": "2020-05-12T18:20:33Z", "author": {"login": "mosabua"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVY5tjgFqTM4OTQ0MzMwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfDGEsgBqjMzMTQ0OTIzMjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NDQzMzA4", "url": "https://github.com/trinodb/trino/pull/3375#pullrequestreview-389443308", "createdAt": "2020-04-07T19:55:58Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NTo1OFrOGCTvNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1OToxMlrOGCT23w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzcxOQ==", "bodyText": "OVERWRITE should be a string, so:\n    SET SESSION hdfs.insert_existing_partitions_behavior = 'OVERWRITE'", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405073719", "createdAt": "2020-04-07T19:55:58Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = OVERWRITE", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ==", "bodyText": "Extra .g", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405073829", "createdAt": "2020-04-07T19:56:08Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NDIxNA==", "bodyText": "Why is hdfs used as an example name instead of hive?", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405074214", "createdAt": "2020-04-07T19:56:46Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,\n+e.g.g ``hdfs``, and set the property in the session before you run the insert", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzgyOQ=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3NTY3OQ==", "bodyText": "There's another mode that's allowed: APPEND. We may want to document that, too, here or as a separate change.", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r405075679", "createdAt": "2020-04-07T19:59:12Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,15 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector,", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Nzk0NjY3", "url": "https://github.com/trinodb/trino/pull/3375#pullrequestreview-407794667", "createdAt": "2020-05-07T20:02:12Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDowMjoxMlrOGSOOBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDowMjoxMlrOGSOOBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2MDUxNg==", "bodyText": "Missing \"to\" after \"equivalent\"", "url": "https://github.com/trinodb/trino/pull/3375#discussion_r421760516", "createdAt": "2020-05-07T20:02:12Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/migration/from-hive.rst", "diffHunk": "@@ -132,3 +132,17 @@ Presto query::\n \n     date_diff('day', startdate, enddate)\n \n+Overwriting data on insert\n+--------------------------\n+\n+By default, ``INSERT`` queries are not allowed to overwrite existing data. You\n+can use the catalog session property ``insert_existing_partitions_behavior`` to\n+allow overwrites. Prepend the name of the catalog using the Hive connector, for\n+example ``hdfs``, and set the property in the session before you run the insert\n+query::\n+\n+    SET SESSION hdfs.insert_existing_partitions_behavior = 'OVERWRITE';\n+    INSERT INTO hdfs.schema.table ...\n+\n+The resulting behavior is equivalent using `INSERT OVERWRITE", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b5740fc01f04e2c53da71c273525dca48fa89eb", "author": {"user": {"login": "mosabua", "name": "Manfred Moser"}}, "url": "https://github.com/trinodb/trino/commit/8b5740fc01f04e2c53da71c273525dca48fa89eb", "committedDate": "2020-05-07T20:13:49Z", "message": "Add overwrite insert for Hive connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8b5740fc01f04e2c53da71c273525dca48fa89eb", "author": {"user": {"login": "mosabua", "name": "Manfred Moser"}}, "url": "https://github.com/trinodb/trino/commit/8b5740fc01f04e2c53da71c273525dca48fa89eb", "committedDate": "2020-05-07T20:13:49Z", "message": "Add overwrite insert for Hive connector"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1835, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}