{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTU4MjI2", "number": 2399, "title": "s3 select improvements", "bodyText": "", "createdAt": "2020-01-03T11:28:07Z", "url": "https://github.com/trinodb/trino/pull/2399", "merged": true, "mergeCommit": {"oid": "e7a0291b96b600b2540f6e7f72fa48e07faffcb0"}, "closed": true, "closedAt": "2020-01-11T19:47:00Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2tc_bABqjI5MjAwODI0NzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5YlDEABqjI5NDA4MDU0NTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "d9a444f65315fa3f7c1c08253a73e33200b35d06", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/d9a444f65315fa3f7c1c08253a73e33200b35d06", "committedDate": "2020-01-04T23:07:51Z", "message": "Refactor choosing compression type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9a444f65315fa3f7c1c08253a73e33200b35d06", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/d9a444f65315fa3f7c1c08253a73e33200b35d06", "committedDate": "2020-01-04T23:07:51Z", "message": "Refactor choosing compression type"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "34485dce1fa8f89fb4aae32ba5a4cebcdc8f3df3", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/34485dce1fa8f89fb4aae32ba5a4cebcdc8f3df3", "committedDate": "2020-01-08T16:15:31Z", "message": "Refactor choosing compression type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMjI3NDY1", "url": "https://github.com/trinodb/trino/pull/2399#pullrequestreview-340227465", "createdAt": "2020-01-09T00:22:12Z", "commit": {"oid": "875ea00766535855f18b461182d52fc664eeb914"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDoyMjoxM1rOFbn01w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDoyMjoxM1rOFbn01w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUwODM3NQ==", "bodyText": "Maybe shorten to \"for gzip files\"\n// S3 Select supports skipping one line of headers, but it was returning incorrect results for gzip files\nOr just the file name test_table_with_header.csv.gz", "url": "https://github.com/trinodb/trino/pull/2399#discussion_r364508375", "createdAt": "2020-01-09T00:22:13Z", "author": {"login": "electrum"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/s3select/S3SelectPushdown.java", "diffHunk": "@@ -85,7 +87,20 @@ private static boolean isSerdeSupported(Properties schema)\n     private static boolean isInputFormatSupported(Properties schema)\n     {\n         String inputFormat = getInputFormatName(schema);\n-        return SUPPORTED_INPUT_FORMATS.contains(inputFormat);\n+\n+        if (TextInputFormat.class.getName().equals(inputFormat)) {\n+            if (!Objects.equals(schema.getProperty(SKIP_HEADER_COUNT_KEY, \"0\"), \"0\")) {\n+                // S3 Select supports skipping one line of headers, but it was returning incorrect results for presto-hive-hadoop2/conf/files/test_table_with_header.csv.gz", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "875ea00766535855f18b461182d52fc664eeb914"}, "originalPosition": 30}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34485dce1fa8f89fb4aae32ba5a4cebcdc8f3df3", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/34485dce1fa8f89fb4aae32ba5a4cebcdc8f3df3", "committedDate": "2020-01-08T16:15:31Z", "message": "Refactor choosing compression type"}, "afterCommit": {"oid": "812a87a55c17aea39651c3493b52195e807fd439", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/812a87a55c17aea39651c3493b52195e807fd439", "committedDate": "2020-01-10T17:58:46Z", "message": "Refactor choosing compression type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b748d44d3e72839e9b65132e92e21f53d13f6abb", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/b748d44d3e72839e9b65132e92e21f53d13f6abb", "committedDate": "2020-01-11T16:38:53Z", "message": "Assert expected data exactly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90e3b4e47e61df1bde0728e89039ca1a83f4a392", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/90e3b4e47e61df1bde0728e89039ca1a83f4a392", "committedDate": "2020-01-11T16:38:53Z", "message": "Disable S3 Select when skip header/footer is set\n\nS3 Select does not support skipping footer\n\nS3 Select supports skipping one line of header, but it not always was\nreturning correct results."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ca471404ca4df0f57f2a414351dcb64c75c63da", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/9ca471404ca4df0f57f2a414351dcb64c75c63da", "committedDate": "2020-01-11T16:38:53Z", "message": "Refactor choosing compression type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "812a87a55c17aea39651c3493b52195e807fd439", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/812a87a55c17aea39651c3493b52195e807fd439", "committedDate": "2020-01-10T17:58:46Z", "message": "Refactor choosing compression type"}, "afterCommit": {"oid": "9ca471404ca4df0f57f2a414351dcb64c75c63da", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/9ca471404ca4df0f57f2a414351dcb64c75c63da", "committedDate": "2020-01-11T16:38:53Z", "message": "Refactor choosing compression type"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "9ca471404ca4df0f57f2a414351dcb64c75c63da", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/9ca471404ca4df0f57f2a414351dcb64c75c63da", "committedDate": "2020-01-11T16:38:53Z", "message": "Refactor choosing compression type"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1012, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}