{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0ODIyMjAz", "number": 6429, "title": "Random cleanups", "bodyText": "", "createdAt": "2020-12-23T13:56:58Z", "url": "https://github.com/trinodb/trino/pull/6429", "merged": true, "mergeCommit": {"oid": "4e51233cc1ef193de4c5e2731aa7441fc8c8a59f"}, "closed": true, "closedAt": "2021-01-08T11:22:45Z", "author": {"login": "losipiuk"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdo_7kAgFqTU1Nzg5Njc2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABduFmyzgBqjQxODM2NTI4OTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3ODk2NzYx", "url": "https://github.com/trinodb/trino/pull/6429#pullrequestreview-557896761", "createdAt": "2020-12-23T14:21:09Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNDoyMTowOVrOIKmIdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNDoyMTowOVrOIKmIdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzk4MTQyOQ==", "bodyText": "Can this config be refreshed? I vaguely remember some topology providers have refresh. If so, this doesn't look thread-safe.", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r547981429", "createdAt": "2020-12-23T14:21:09Z", "author": {"login": "hashhar"}, "path": "presto-main/src/main/java/io/prestosql/execution/scheduler/SubnetTopologyConfig.java", "diffHunk": "@@ -35,11 +35,10 @@\n     @Config(\"node-scheduler.network-topology.subnet.cidr-prefix-lengths\")\n     public SubnetTopologyConfig setCidrPrefixLengths(String commaSeparatedLengths)\n     {\n-        List<Integer> lengths = Splitter.on(',').omitEmptyStrings().splitToList(commaSeparatedLengths).stream()\n+\n+        this.cidrPrefixLengths = Splitter.on(',').omitEmptyStrings().splitToList(commaSeparatedLengths).stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3ODk5ODc5", "url": "https://github.com/trinodb/trino/pull/6429#pullrequestreview-557899879", "createdAt": "2020-12-23T14:26:31Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNDoyNjozMVrOIKmSUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNDoyNjozMVrOIKmSUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzk4Mzk1Mg==", "bodyText": "Not equivalent. Will not allow null elements.", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r547983952", "createdAt": "2020-12-23T14:26:31Z", "author": {"login": "hashhar"}, "path": "presto-main/src/main/java/io/prestosql/server/protocol/QueryResultRows.java", "diffHunk": "@@ -218,9 +218,9 @@ private Object getLegacyValue(Object value, Type type)\n                 return value;\n             }\n \n-            return unmodifiableList(((List<Object>) value).stream()\n+            return ((List<Object>) value).stream()\n                     .map(element -> getLegacyValue(element, elementType))\n-                    .collect(toList()));\n+                    .collect(toUnmodifiableList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTU2NDQ5", "url": "https://github.com/trinodb/trino/pull/6429#pullrequestreview-558956449", "createdAt": "2020-12-27T20:14:33Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QyMDoxNDozNFrOILuBaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QyMDoyODoxOFrOILuGXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE1OTI3Mg==", "bodyText": "This is part of Drop unneeded semicolon commit", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549159272", "createdAt": "2020-12-27T20:14:34Z", "author": {"login": "findepi"}, "path": "presto-jdbc/src/test/java/io/prestosql/jdbc/TestJdbcVendorCompatibility.java", "diffHunk": "@@ -452,7 +452,7 @@ void tearDown()\n     private static class OracleReferenceDriver\n             implements ReferenceDriver\n     {\n-        private OracleContainer oracleServer;\n+        private final OracleContainer oracleServer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE1OTI3NA==", "bodyText": "This is part of Drop unneeded semicolon commit", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549159274", "createdAt": "2020-12-27T20:14:37Z", "author": {"login": "findepi"}, "path": "presto-jdbc/src/test/java/io/prestosql/jdbc/TestJdbcVendorCompatibility.java", "diffHunk": "@@ -537,7 +537,7 @@ public String toString()\n     private static class PostgresqlReferenceDriver\n             implements ReferenceDriver\n     {\n-        private PostgreSQLContainer<?> postgresqlContainer;\n+        private final PostgreSQLContainer<?> postgresqlContainer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE1OTU1OA==", "bodyText": "This is indeed redundant, but it seems we do this by convention pretty much for most of enums, i guess", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549159558", "createdAt": "2020-12-27T20:17:21Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/plan/IndexJoinNode.java", "diffHunk": "@@ -65,7 +65,7 @@ public IndexJoinNode(\n \n         private final String joinLabel;\n \n-        private Type(String joinLabel)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE1OTY3OQ==", "bodyText": ".distinct() is redundant (and would go on separate line, if retained)\n(if you want to keep it, please explain why)", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549159679", "createdAt": "2020-12-27T20:18:47Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/execution/scheduler/SqlQueryScheduler.java", "diffHunk": "@@ -649,9 +649,9 @@ public void abort()\n     private static ListenableFuture<?> whenAllStages(Collection<SqlStageExecution> stages, Predicate<StageState> predicate)\n     {\n         checkArgument(!stages.isEmpty(), \"stages is empty\");\n-        Set<StageId> stageIds = newConcurrentHashSet(stages.stream()\n-                .map(SqlStageExecution::getStageId)\n-                .collect(toSet()));\n+        Set<StageId> stageIds = stages.stream()\n+                .map(SqlStageExecution::getStageId).distinct()", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE2MDMyOQ==", "bodyText": "Would https://errorprone.info/bugpattern/StaticQualifiedUsingExpression catch this?", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549160329", "createdAt": "2020-12-27T20:26:04Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/sql/planner/iterative/rule/TestPruneAggregationColumns.java", "diffHunk": "@@ -74,7 +74,7 @@ private ProjectNode buildProjectedAggregation(PlanBuilder planBuilder, Predicate\n                 planBuilder.aggregation(aggregationBuilder -> aggregationBuilder\n                         .source(planBuilder.values(key))\n                         .singleGroupingSet(key)\n-                        .addAggregation(a, planBuilder.expression(\"count()\"), ImmutableList.of())\n-                        .addAggregation(b, planBuilder.expression(\"count()\"), ImmutableList.of())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE2MDM3OQ==", "bodyText": "do we typically static-import these?\n(the Access PlanBuilder.expressions in static manner commit adds static import in some cases and qualified call in some other places, intentional?)", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549160379", "createdAt": "2020-12-27T20:26:28Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/sql/planner/iterative/rule/TestPruneAggregationColumns.java", "diffHunk": "@@ -74,7 +74,7 @@ private ProjectNode buildProjectedAggregation(PlanBuilder planBuilder, Predicate\n                 planBuilder.aggregation(aggregationBuilder -> aggregationBuilder\n                         .source(planBuilder.values(key))\n                         .singleGroupingSet(key)\n-                        .addAggregation(a, planBuilder.expression(\"count()\"), ImmutableList.of())\n-                        .addAggregation(b, planBuilder.expression(\"count()\"), ImmutableList.of())));\n+                        .addAggregation(a, PlanBuilder.expression(\"count()\"), ImmutableList.of())\n+                        .addAggregation(b, PlanBuilder.expression(\"count()\"), ImmutableList.of())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE2MDU0MA==", "bodyText": "Remove unneeded casts\n\n\"Remove redundant casts\" ?", "url": "https://github.com/trinodb/trino/pull/6429#discussion_r549160540", "createdAt": "2020-12-27T20:28:18Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/timetz/TimeWithTimeZoneToVarcharCast.java", "diffHunk": "@@ -61,10 +61,10 @@ public static Slice cast(@LiteralParameter(\"p\") long precision, @SqlType(\"time(p\n     // Can't name this format() because we can't have a qualified reference to String.format() below\n     private static Slice formatAsString(int precision, long picos, int offsetMinutes)\n     {\n-        int size = (int) (8 + // hour:minute:second\n+        int size = 8 + // hour:minute:second", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "6281c956de79f7584ad0425476ac8be35bb6c1b2", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/6281c956de79f7584ad0425476ac8be35bb6c1b2", "committedDate": "2021-01-08T09:31:04Z", "message": "Replace negated isPresent with isEmpty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cdc2b4d43f799fcee8a56bd2988530f3b3c1eba", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/5cdc2b4d43f799fcee8a56bd2988530f3b3c1eba", "committedDate": "2021-01-08T09:31:05Z", "message": "Drop unneeded semicolon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a96dc91bc49246572330d7be273f7cf1153e0f1a", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/a96dc91bc49246572330d7be273f7cf1153e0f1a", "committedDate": "2021-01-08T09:31:05Z", "message": "Use method reference"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a279ca29d83b792136dc4c9e78adceccaf05d59", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/3a279ca29d83b792136dc4c9e78adceccaf05d59", "committedDate": "2021-01-08T09:31:05Z", "message": "Make fields final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d9eead03c278f7cb5711e9f134af0051109f0ab", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/7d9eead03c278f7cb5711e9f134af0051109f0ab", "committedDate": "2021-01-08T09:31:05Z", "message": "Remove unneeded field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df7acf69debba57a62fd27d63f01690815b86bdf", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/df7acf69debba57a62fd27d63f01690815b86bdf", "committedDate": "2021-01-08T09:31:05Z", "message": "Drop unneeded modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4aa23c5fb8a4ff473b4b6b95e2a5f41fcc956f1f", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/4aa23c5fb8a4ff473b4b6b95e2a5f41fcc956f1f", "committedDate": "2021-01-08T09:31:05Z", "message": "Use UTF_8 constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ba9eae7b6cbb533b9f212099846dc127cd09ea5", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/6ba9eae7b6cbb533b9f212099846dc127cd09ea5", "committedDate": "2021-01-08T09:31:05Z", "message": "Simplify building collection out of stream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5747f1f776781fd1c04251e59c58b1f39ae6334e", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/5747f1f776781fd1c04251e59c58b1f39ae6334e", "committedDate": "2021-01-08T09:31:05Z", "message": "Simplify assertion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49d0481a6481bf7c9da196df318f6319af574e3b", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/49d0481a6481bf7c9da196df318f6319af574e3b", "committedDate": "2021-01-08T09:31:05Z", "message": "Inline redundant variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69825ce9bcfe44f5313f8e5692366d802f675db6", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/69825ce9bcfe44f5313f8e5692366d802f675db6", "committedDate": "2021-01-08T09:49:18Z", "message": "Access method in static manner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "745c553f29a033f1f420ca8e19153751e9185eec", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/745c553f29a033f1f420ca8e19153751e9185eec", "committedDate": "2021-01-08T09:49:18Z", "message": "Enable StaticQualifiedUsingExpression error check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff9dada43df9c078d6f930440169c8258b4c8151", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/ff9dada43df9c078d6f930440169c8258b4c8151", "committedDate": "2021-01-08T09:49:18Z", "message": "Remove redundant casts"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "ff9dada43df9c078d6f930440169c8258b4c8151", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/ff9dada43df9c078d6f930440169c8258b4c8151", "committedDate": "2021-01-08T09:49:18Z", "message": "Remove redundant casts"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1917, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}