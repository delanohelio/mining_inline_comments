{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwMjM5MjMx", "number": 4474, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxMzo1MFrOEPaLkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwOTozMjo0NVrOEPd2DQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTkzMDQwOnYy", "diffSide": "RIGHT", "path": "presto-product-tests/bin/product-tests-suite-3.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxMzo1MFrOGzGoaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjozMDowMVrOGzG9tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzOTIwOQ==", "bodyText": "Why TestGrantRevoke at all?", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456239209", "createdAt": "2020-07-17T06:13:50Z", "author": {"login": "findepi"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,12 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# run very selective set of tests on singlenode-kerberos-hdfs-impersonation-with-data-protection so we do not add\n+# a lot to runtime\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\\n+    -- -t TestHiveStorageFormats.testOrcTableCreatedInPresto,TestGrantRevoke.testGrantRevoke -x \"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NDY2MQ==", "bodyText": "Not a good answer here. I think we can skip that. I left it here as representant of authentication group, but I agree this is not really relevant to data-transfer-protection. I will add one or two more which actually read data to make probability that those will be excluded via DISTRO_SKIP* variables.", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456244661", "createdAt": "2020-07-17T06:30:01Z", "author": {"login": "losipiuk"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,12 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# run very selective set of tests on singlenode-kerberos-hdfs-impersonation-with-data-protection so we do not add\n+# a lot to runtime\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\\n+    -- -t TestHiveStorageFormats.testOrcTableCreatedInPresto,TestGrantRevoke.testGrantRevoke -x \"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzOTIwOQ=="}, "originalCommit": null, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTkzMjM4OnYy", "diffSide": "RIGHT", "path": "presto-product-tests/bin/product-tests-suite-3.sh", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxNDo1MFrOGzGpoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxNDo1MFrOGzGpoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzOTUyMQ==", "bodyText": "That's a good thinking, but I do not think it needs to be put in a comment. It's seems obvious why you picked few tests. Unless you want to also explain why these particular tests.", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456239521", "createdAt": "2020-07-17T06:14:50Z", "author": {"login": "findepi"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,12 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# run very selective set of tests on singlenode-kerberos-hdfs-impersonation-with-data-protection so we do not add\n+# a lot to runtime", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTkzNDk5OnYy", "diffSide": "RIGHT", "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/iceberg.properties", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxNTo1MVrOGzGq_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjozMjozNVrOGzHBLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzOTg3MA==", "bodyText": "I guess iceberg catalog is not used in the test.", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456239870", "createdAt": "2020-07-17T06:15:51Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/iceberg.properties", "diffHunk": "@@ -0,0 +1,15 @@\n+connector.name=iceberg", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NTU0OQ==", "bodyText": "Dropped", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456245549", "createdAt": "2020-07-17T06:32:35Z", "author": {"login": "losipiuk"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/iceberg.properties", "diffHunk": "@@ -0,0 +1,15 @@\n+connector.name=iceberg", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzOTg3MA=="}, "originalCommit": null, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTkzNzQ3OnYy", "diffSide": "RIGHT", "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/hive.properties", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjoxNzowMlrOGzGsbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjozOTozOFrOGzHKqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0MDIzOQ==", "bodyText": "a TODO not to require hive-data-protection.xml?\n(also you may want to follow *-site.xml convention, as in hive-default-fs-site.xml)", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456240239", "createdAt": "2020-07-17T06:17:02Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/hive.properties", "diffHunk": "@@ -0,0 +1,19 @@\n+connector.name=hive-hadoop2\n+hive.metastore.uri=thrift://hadoop-master:9083\n+hive.config.resources=/docker/presto-product-tests/conf/presto/etc/hive-default-fs-site.xml,/docker/presto-product-tests/conf/presto/etc/hive-data-protection.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NzQxMQ==", "bodyText": "a TODO not to require hive-data-protection.xml?\n\nNot sure it is worth it. It looks like we should map the two properties which we have in .xml 1-1 to Presto properties. It can be done, but I am not 100% those are commonly use enough to justify that. I actually have code for one of those, already, but I shelved it to discuss if we really want it.", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456247411", "createdAt": "2020-07-17T06:38:01Z", "author": {"login": "losipiuk"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/hive.properties", "diffHunk": "@@ -0,0 +1,19 @@\n+connector.name=hive-hadoop2\n+hive.metastore.uri=thrift://hadoop-master:9083\n+hive.config.resources=/docker/presto-product-tests/conf/presto/etc/hive-default-fs-site.xml,/docker/presto-product-tests/conf/presto/etc/hive-data-protection.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0MDIzOQ=="}, "originalCommit": null, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0Nzk3OA==", "bodyText": "Fair", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456247978", "createdAt": "2020-07-17T06:39:38Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-kerberos-hdfs-impersonation-with-data-protection/hive.properties", "diffHunk": "@@ -0,0 +1,19 @@\n+connector.name=hive-hadoop2\n+hive.metastore.uri=thrift://hadoop-master:9083\n+hive.config.resources=/docker/presto-product-tests/conf/presto/etc/hive-default-fs-site.xml,/docker/presto-product-tests/conf/presto/etc/hive-data-protection.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0MDIzOQ=="}, "originalCommit": null, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NjUzMDY5OnYy", "diffSide": "RIGHT", "path": "presto-product-tests/bin/product-tests-suite-3.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwOTozMjo0NVrOGzMSxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDoxMzo0N1rOGzNi9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMzMTk3NQ==", "bodyText": "How does this environment is different to singlenode-kerberos-hdfs-impersonation-with-wire-encryption", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456331975", "createdAt": "2020-07-17T09:32:45Z", "author": {"login": "kokosing"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,11 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# Smoke run af a few tests in environment with dfs.data.transfer.protection=true. Arbitrary tests which access HDFS data were chosen.\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f2b17efbf56b2420ff0475e33f18d0c290f4c80"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMzMzUyNA==", "bodyText": "When it comes to hadoop config:\n    <property>\n        <name>dfs.data.transfer.protection</name>\n        <value>privacy</value>\n    </property>\n\ninstead of\n    <property>\n        <name>dfs.encrypt.data.transfer</name>\n        <value>true</value>\n    </property>", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456333524", "createdAt": "2020-07-17T09:35:54Z", "author": {"login": "losipiuk"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,11 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# Smoke run af a few tests in environment with dfs.data.transfer.protection=true. Arbitrary tests which access HDFS data were chosen.\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMzMTk3NQ=="}, "originalCommit": {"oid": "7f2b17efbf56b2420ff0475e33f18d0c290f4c80"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM1MjQ2Ng==", "bodyText": "I wish I could know that from reading the code...", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456352466", "createdAt": "2020-07-17T10:13:41Z", "author": {"login": "kokosing"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,11 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# Smoke run af a few tests in environment with dfs.data.transfer.protection=true. Arbitrary tests which access HDFS data were chosen.\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMzMTk3NQ=="}, "originalCommit": {"oid": "7f2b17efbf56b2420ff0475e33f18d0c290f4c80"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM1MjUwMg==", "bodyText": "Thanks!", "url": "https://github.com/trinodb/trino/pull/4474#discussion_r456352502", "createdAt": "2020-07-17T10:13:47Z", "author": {"login": "kokosing"}, "path": "presto-product-tests/bin/product-tests-suite-3.sh", "diffHunk": "@@ -22,5 +22,11 @@ presto-product-tests-launcher/bin/run-launcher test run \\\n     -- -g storage_formats,cli,hdfs_impersonation,authorization -x iceberg,\"${DISTRO_SKIP_GROUP}\" -e \"${DISTRO_SKIP_TEST}\" \\\n     || suite_exit_code=1\n \n+# Smoke run af a few tests in environment with dfs.data.transfer.protection=true. Arbitrary tests which access HDFS data were chosen.\n+presto-product-tests-launcher/bin/run-launcher test run \\\n+    --environment singlenode-kerberos-hdfs-impersonation-with-data-protection \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMzMTk3NQ=="}, "originalCommit": {"oid": "7f2b17efbf56b2420ff0475e33f18d0c290f4c80"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3666, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}