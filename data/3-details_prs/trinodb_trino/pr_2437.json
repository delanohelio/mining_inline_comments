{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNDc1MDUx", "number": 2437, "title": "Consolidate NULL read/write paths in JDBC connectors", "bodyText": "", "createdAt": "2020-01-08T14:05:33Z", "url": "https://github.com/trinodb/trino/pull/2437", "merged": true, "mergeCommit": {"oid": "88b0a8c73ae8f058e5b79fa43040618065ada88f"}, "closed": true, "closedAt": "2020-01-13T10:28:47Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4aWBAAFqTM0MDA4NDQzMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb55fQ6gFqTM0MTczNzAxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMDg0NDMx", "url": "https://github.com/trinodb/trino/pull/2437#pullrequestreview-340084431", "createdAt": "2020-01-08T19:15:32Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxOToxNTozM1rOFbhFuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxOToxNTozM1rOFbhFuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM5ODAwOQ==", "bodyText": "I am not sure about it. Now you could reuse existing write functions when you had to implement custom write functions. Now you need to extend all write functions. That was the point of having them separated.\nSame comment goes to read function. However that does hit me.", "url": "https://github.com/trinodb/trino/pull/2437#discussion_r364398009", "createdAt": "2020-01-08T19:15:33Z", "author": {"login": "kokosing"}, "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/WriteFunction.java", "diffHunk": "@@ -13,7 +13,16 @@\n  */\n package io.prestosql.plugin.jdbc;\n \n+import java.sql.PreparedStatement;\n+import java.sql.SQLException;\n+\n public interface WriteFunction\n {\n     Class<?> getJavaType();\n+\n+    default void setNull(PreparedStatement statement, int index)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "f26026b6efa4b240e4860c189ed4f87d4e203eee", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/f26026b6efa4b240e4860c189ed4f87d4e203eee", "committedDate": "2020-01-10T09:28:19Z", "message": "Move checking nulls to ReadFunction interface\n\nThis makes the `ReadFunction` interface more coherent & complete, while\nproviding clean API indication how the NULL values are handled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6a561c85216fedb977b5b822677f7112944b24c", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/e6a561c85216fedb977b5b822677f7112944b24c", "committedDate": "2020-01-10T09:28:20Z", "message": "Merge WriteNullFunction into WriteFunction interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "e6a561c85216fedb977b5b822677f7112944b24c", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/e6a561c85216fedb977b5b822677f7112944b24c", "committedDate": "2020-01-10T09:28:20Z", "message": "Merge WriteNullFunction into WriteFunction interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNzM3MDEy", "url": "https://github.com/trinodb/trino/pull/2437#pullrequestreview-341737012", "createdAt": "2020-01-13T10:07:07Z", "commit": {"oid": "f26026b6efa4b240e4860c189ed4f87d4e203eee"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMDowNzowN1rOFcx7QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxMDowNzowN1rOFcx7QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcyMjQzMw==", "bodyText": "Is there any other way to read null value from JDBC, that you heard of?", "url": "https://github.com/trinodb/trino/pull/2437#discussion_r365722433", "createdAt": "2020-01-13T10:07:07Z", "author": {"login": "kokosing"}, "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/ReadFunction.java", "diffHunk": "@@ -13,10 +13,23 @@\n  */\n package io.prestosql.plugin.jdbc;\n \n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+\n public interface ReadFunction\n {\n     Class<?> getJavaType();\n \n+    default boolean isNull(ResultSet resultSet, int columnIndex)\n+            throws SQLException\n+    {\n+        // JDBC is kind of dumb: we need to read the field and then ask\n+        // if it was null, which means we are wasting effort here.\n+        // We could save the result of the field access if it matters.\n+        resultSet.getObject(columnIndex);\n+        return resultSet.wasNull();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f26026b6efa4b240e4860c189ed4f87d4e203eee"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1048, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}