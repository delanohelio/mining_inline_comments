{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwOTA1MjMw", "number": 3587, "title": "Fix failure when unnest inputs are repeated", "bodyText": "The mappings to unnest are keyed based on input symbol.\nWhen input expression are repeated, the deduplication logic\nreplaces them with references to the same symbol. This\ncauses a conflict that results in a planning failure.", "createdAt": "2020-04-29T19:22:35Z", "url": "https://github.com/trinodb/trino/pull/3587", "merged": true, "mergeCommit": {"oid": "56dc6bb42950b4528d9157573afee869c81cc810"}, "closed": true, "closedAt": "2020-05-06T18:09:38Z", "author": {"login": "martint"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcczkX7gFqTQwMzg3MzU5MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcestp5ABqjMzMDk2NzgwMjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzODczNTkx", "url": "https://github.com/trinodb/trino/pull/3587#pullrequestreview-403873591", "createdAt": "2020-04-30T20:59:53Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMDo1OTo1M1rOGO6JHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMDo1OTo1M1rOGO6JHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4NTg1Mw==", "bodyText": "require non null", "url": "https://github.com/trinodb/trino/pull/3587#discussion_r418285853", "createdAt": "2020-04-30T20:59:53Z", "author": {"login": "kasiafi"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/plan/UnnestNode.java", "diffHunk": "@@ -129,6 +129,33 @@ public Type getJoinType()\n     @Override\n     public PlanNode replaceChildren(List<PlanNode> newChildren)\n     {\n-        return new UnnestNode(getId(), Iterables.getOnlyElement(newChildren), replicateSymbols, unnestSymbols, ordinalitySymbol, joinType, filter);\n+        return new UnnestNode(getId(), Iterables.getOnlyElement(newChildren), replicateSymbols, mappings, ordinalitySymbol, joinType, filter);\n+    }\n+\n+    public static class Mapping\n+    {\n+        private final Symbol input;\n+        private final List<Symbol> outputs;\n+\n+        @JsonCreator\n+        public Mapping(\n+                @JsonProperty(\"input\") Symbol input,\n+                @JsonProperty(\"outputs\") List<Symbol> outputs)\n+        {\n+            this.input = requireNonNull(input, \"input is null\");\n+            this.outputs = ImmutableList.copyOf(outputs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 101}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDE2MDA2", "url": "https://github.com/trinodb/trino/pull/3587#pullrequestreview-406016006", "createdAt": "2020-05-05T17:44:13Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56dc6bb42950b4528d9157573afee869c81cc810", "author": {"user": {"login": "martint", "name": "Martin Traverso"}}, "url": "https://github.com/trinodb/trino/commit/56dc6bb42950b4528d9157573afee869c81cc810", "committedDate": "2020-05-06T18:09:24Z", "message": "Fix failure when unnest inputs are repeated\n\nThe mappings to unnest are keyed based on input symbol.\nWhen input expression are repeated, the deduplication logic\nreplaces them with references to the same symbol. This\ncauses a conflict that results in a planning failure."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "56dc6bb42950b4528d9157573afee869c81cc810", "author": {"user": {"login": "martint", "name": "Martin Traverso"}}, "url": "https://github.com/trinodb/trino/commit/56dc6bb42950b4528d9157573afee869c81cc810", "committedDate": "2020-05-06T18:09:24Z", "message": "Fix failure when unnest inputs are repeated\n\nThe mappings to unnest are keyed based on input symbol.\nWhen input expression are repeated, the deduplication logic\nreplaces them with references to the same symbol. This\ncauses a conflict that results in a planning failure."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1327, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}