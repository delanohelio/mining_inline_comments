{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MTYzOTk5", "number": 3447, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxOToyNDozOVrODzQSKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxOToyNjoyMlrODzQSqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1MDcwNzYyOnYy", "diffSide": "RIGHT", "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/client/ElasticsearchClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxOToyNDozOVrOGHtljw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxOToyNDozOVrOGHtljw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc0MDExMQ==", "bodyText": "the ^ and $ are redundant", "url": "https://github.com/trinodb/trino/pull/3447#discussion_r410740111", "createdAt": "2020-04-18T19:24:39Z", "author": {"login": "findepi"}, "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/client/ElasticsearchClient.java", "diffHunk": "@@ -108,6 +111,8 @@\n     private static final JsonCodec<NodesResponse> NODES_RESPONSE_CODEC = jsonCodec(NodesResponse.class);\n     private static final ObjectMapper OBJECT_MAPPER = new ObjectMapperProvider().get();\n \n+    private static final Pattern ADDRESS_PATTERN = Pattern.compile(\"^((?<cname>[^/]+)/)?(?<ip>.+):(?<port>\\\\d+)$\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1MDcwODkxOnYy", "diffSide": "RIGHT", "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/client/ElasticsearchClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxOToyNjoyMlrOGHtmLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQwMTo0NToyMVrOGHwnkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc0MDI3MA==", "bodyText": "previously if the address was eg <ip> (no port), it would still be accepted\ni understand this is conscious not to accept it (perhaps impossible), but could be good to mention in cmt msg, or even splits commits into\n\nvalidate address pattern\nadd support for hostname/", "url": "https://github.com/trinodb/trino/pull/3447#discussion_r410740270", "createdAt": "2020-04-18T19:26:22Z", "author": {"login": "findepi"}, "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/client/ElasticsearchClient.java", "diffHunk": "@@ -657,6 +665,26 @@ public TimeStat getNextPageStats()\n         return handler.process(body);\n     }\n \n+    @VisibleForTesting\n+    static Optional<String> extractAddress(String address)\n+    {\n+        Matcher matcher = ADDRESS_PATTERN.matcher(address);\n+\n+        if (!matcher.matches()) {\n+            return Optional.empty();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc4OTc3Ng==", "bodyText": "Correct. It was accepted but it never happened in practice, as ES doesn't produce that kind of value.\nI'll add a comment in the commit message. I think splitting it is overkill, as I'd be just adding a commit and erase its effect on the next one.", "url": "https://github.com/trinodb/trino/pull/3447#discussion_r410789776", "createdAt": "2020-04-19T01:45:21Z", "author": {"login": "martint"}, "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/client/ElasticsearchClient.java", "diffHunk": "@@ -657,6 +665,26 @@ public TimeStat getNextPageStats()\n         return handler.process(body);\n     }\n \n+    @VisibleForTesting\n+    static Optional<String> extractAddress(String address)\n+    {\n+        Matcher matcher = ADDRESS_PATTERN.matcher(address);\n+\n+        if (!matcher.matches()) {\n+            return Optional.empty();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc0MDI3MA=="}, "originalCommit": null, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 154, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}