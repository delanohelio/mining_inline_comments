{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4ODE5NTI5", "number": 3342, "title": "Plugin class loader", "bodyText": "", "createdAt": "2020-04-04T23:43:51Z", "url": "https://github.com/trinodb/trino/pull/3342", "merged": true, "mergeCommit": {"oid": "3195d8a3bb6b1b87b63d7df010a7312e8b960c28"}, "closed": true, "closedAt": "2020-04-06T05:32:58Z", "author": {"login": "dain"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUeLMogH2gAyMzk4ODE5NTI5OjEyZTZmYTkxMjVjNjMwMzdiMDM1M2E2ZjNjOTMxODc1ZTBmY2I5NDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcU6eWsgFqTM4ODAzMTcyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "12e6fa9125c63037b0353a6f3c931875e0fcb940", "author": {"user": {"login": "dain", "name": "Dain Sundstrom"}}, "url": "https://github.com/trinodb/trino/commit/12e6fa9125c63037b0353a6f3c931875e0fcb940", "committedDate": "2020-04-04T23:33:57Z", "message": "Fix warnings in PluginClassLoader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0", "author": {"user": {"login": "dain", "name": "Dain Sundstrom"}}, "url": "https://github.com/trinodb/trino/commit/a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0", "committedDate": "2020-04-04T23:39:09Z", "message": "Use platform classloader in Java 8 and 11 for plugins"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3OTA4MDA3", "url": "https://github.com/trinodb/trino/pull/3342#pullrequestreview-387908007", "createdAt": "2020-04-06T02:56:33Z", "commit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MDMxNzIx", "url": "https://github.com/trinodb/trino/pull/3342#pullrequestreview-388031721", "createdAt": "2020-04-06T08:26:00Z", "commit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwODoyNjowMFrOGBM3lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwODozMjowNVrOGBNFlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzkxMjU5Ng==", "bodyText": "Are there any changes between java 9 and java 11 in regards to platform class loader? Was getPlatformClassLoader() method removed? Is there different model of classloaders?", "url": "https://github.com/trinodb/trino/pull/3342#discussion_r403912596", "createdAt": "2020-04-06T08:26:00Z", "author": {"login": "kokosing"}, "path": "presto-main/src/main/java/io/prestosql/server/PluginClassLoader.java", "diffHunk": "@@ -16,8 +16,6 @@\n import com.google.common.collect.ImmutableList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzkxMjc3MQ==", "bodyText": "This is a dedicated method on Java 9 to access class loader that you want to use here in Presto.", "url": "https://github.com/trinodb/trino/pull/3342#discussion_r403912771", "createdAt": "2020-04-06T08:26:18Z", "author": {"login": "kokosing"}, "path": "presto-main/src/main/java/io/prestosql/server/PluginClassLoader.java", "diffHunk": "@@ -143,21 +139,4 @@ private static String classNameToResource(String className)\n     {\n         return className.replace('.', '/');\n     }\n-\n-    @SuppressWarnings(\"JavaReflectionMemberAccess\")\n-    private static ClassLoader findPlatformClassLoader()\n-    {\n-        try {\n-            // use platform class loader on Java 9\n-            Method method = ClassLoader.class.getMethod(\"getPlatformClassLoader\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzkxMzYzMg==", "bodyText": "Commit message is invalid:\nYou says that: Use platform classloader in Java 8 and 11 for plugins, while we were already using platform classloader for java 9 and so I guess it was working as well for java 11.", "url": "https://github.com/trinodb/trino/pull/3342#discussion_r403913632", "createdAt": "2020-04-06T08:27:43Z", "author": {"login": "kokosing"}, "path": "presto-main/src/main/java/io/prestosql/server/PluginClassLoader.java", "diffHunk": "@@ -16,8 +16,6 @@\n import com.google.common.collect.ImmutableList;\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzkxNjE4Mw==", "bodyText": "This is the line that only be fixed. null (bootstrap CL) should be replaced with getSystemClassLoader().getParent()).", "url": "https://github.com/trinodb/trino/pull/3342#discussion_r403916183", "createdAt": "2020-04-06T08:32:05Z", "author": {"login": "kokosing"}, "path": "presto-main/src/main/java/io/prestosql/server/PluginClassLoader.java", "diffHunk": "@@ -141,21 +139,4 @@ private static String classNameToResource(String className)\n     {\n         return className.replace('.', '/');\n     }\n-\n-    @SuppressWarnings(\"JavaReflectionMemberAccess\")\n-    private static ClassLoader findPlatformClassLoader()\n-    {\n-        try {\n-            // use platform class loader on Java 9\n-            Method method = ClassLoader.class.getMethod(\"getPlatformClassLoader\");\n-            return (ClassLoader) method.invoke(null);\n-        }\n-        catch (NoSuchMethodException ignored) {\n-            // use null class loader on Java 8\n-            return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88548b8df1fad9a2f5cb8ada4865b4beed1d9a0"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1768, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}