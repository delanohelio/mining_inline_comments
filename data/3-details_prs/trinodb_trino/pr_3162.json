{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMTMxMzY1", "number": 3162, "title": "Use SizeOf for list, map and String sizing", "bodyText": "", "createdAt": "2020-03-19T17:14:13Z", "url": "https://github.com/trinodb/trino/pull/3162", "merged": true, "mergeCommit": {"oid": "6967cf65af3fa53613ed1185f88687a12197ba5e"}, "closed": true, "closedAt": "2020-07-03T21:23:48Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPPJ-WgFqTM3NzkyODkyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxPhwUgBqjM1MTAxOTkwNjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTI4OTI1", "url": "https://github.com/trinodb/trino/pull/3162#pullrequestreview-377928925", "createdAt": "2020-03-19T17:14:24Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzoxNDoyNVrOF44bQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzoxNDoyNVrOF44bQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE4OTA1Ng==", "bodyText": "Remember", "url": "https://github.com/trinodb/trino/pull/3162#discussion_r395189056", "createdAt": "2020-03-19T17:14:25Z", "author": {"login": "findepi"}, "path": "pom.xml", "diffHunk": "@@ -45,6 +45,7 @@\n \n         <dep.antlr.version>4.7.1</dep.antlr.version>\n         <dep.airlift.version>0.193</dep.airlift.version>\n+        <dep.slice.version>0.39-SNAPSHOT</dep.slice.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1ODE2NzU1", "url": "https://github.com/trinodb/trino/pull/3162#pullrequestreview-415816755", "createdAt": "2020-05-21T01:14:40Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMToxNDo0MVrOGYjCbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMToxOToyNlrOGYjHBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5MzA2OQ==", "bodyText": "This wrapping seems excessive. I understand why you'd do it for a longer list of names, but this class is a key/value pair, no need to be extensible.", "url": "https://github.com/trinodb/trino/pull/3162#discussion_r428393069", "createdAt": "2020-05-21T01:14:41Z", "author": {"login": "electrum"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HivePartitionKey.java", "diffHunk": "@@ -55,9 +56,11 @@ public String getValue()\n         return value;\n     }\n \n-    public int getEstimatedSizeInBytes()\n+    public long getEstimatedSizeInBytes()\n     {\n-        return INSTANCE_SIZE + name.length() * Character.BYTES + value.length() * Character.BYTES;\n+        return INSTANCE_SIZE +", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5MzExMQ==", "bodyText": "This class is to hold a single string. No need to wrap here.", "url": "https://github.com/trinodb/trino/pull/3162#discussion_r428393111", "createdAt": "2020-05-21T01:14:49Z", "author": {"login": "electrum"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveTypeName.java", "diffHunk": "@@ -42,9 +43,10 @@ public HiveType toHiveType()\n         return HiveType.valueOf(value);\n     }\n \n-    public int getEstimatedSizeInBytes()\n+    public long getEstimatedSizeInBytes()\n     {\n-        return INSTANCE_SIZE + value.length() * Character.BYTES;\n+        return INSTANCE_SIZE +", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NDI0Nw==", "bodyText": "We could add a helper estimatedSizeOf(HostAddress)\nreturn INSTANCE_SIZE + estimatedSizeOf(addresses, InternalHiveBlock::estimatedSize);", "url": "https://github.com/trinodb/trino/pull/3162#discussion_r428394247", "createdAt": "2020-05-21T01:19:26Z", "author": {"login": "electrum"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/InternalHiveSplit.java", "diffHunk": "@@ -275,14 +267,10 @@ public long getEnd()\n             return addresses;\n         }\n \n-        public int getEstimatedSizeInBytes()\n+        public long getEstimatedSizeInBytes()\n         {\n-            int result = INSTANCE_SIZE;\n-            result += sizeOfObjectArray(addresses.size());\n-            for (HostAddress address : addresses) {\n-                result += HOST_ADDRESS_INSTANCE_SIZE + address.getHostText().length() * Character.BYTES;\n-            }\n-            return result;\n+            return INSTANCE_SIZE", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 53}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5a43579b5e404d3ecf170c9ae35bbf2266ea75f", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/b5a43579b5e404d3ecf170c9ae35bbf2266ea75f", "committedDate": "2020-07-03T08:53:36Z", "message": "Update to Airbase 102"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8401397894f6c019d82486ffe41f7028ca230224", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/8401397894f6c019d82486ffe41f7028ca230224", "committedDate": "2020-07-03T08:53:36Z", "message": "Use SizeOf for list, map and String sizing"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8401397894f6c019d82486ffe41f7028ca230224", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/8401397894f6c019d82486ffe41f7028ca230224", "committedDate": "2020-07-03T08:53:36Z", "message": "Use SizeOf for list, map and String sizing"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1918, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}