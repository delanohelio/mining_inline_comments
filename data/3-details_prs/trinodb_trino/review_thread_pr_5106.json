{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyMjk3Nzk2", "number": 5106, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MDoxNVrOEhbLKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MjozMVrOEhbNpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNDgzNjg5OnYy", "diffSide": "RIGHT", "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MDoxNVrOHOu9Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MzowNFrOHOvB2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMTM5NQ==", "bodyText": "epochYear?", "url": "https://github.com/trinodb/trino/pull/5106#discussion_r485211395", "createdAt": "2020-09-08T21:40:15Z", "author": {"login": "martint"}, "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "diffHunk": "@@ -492,6 +492,30 @@ private static Block truncateVarbinary(Block block, int max)\n         return builder.build();\n     }\n \n+    @VisibleForTesting\n+    static long yearsEpoch(long millis)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMjYzNQ==", "bodyText": "Also, I'd rename the argument to epochMilli for clarity.", "url": "https://github.com/trinodb/trino/pull/5106#discussion_r485212635", "createdAt": "2020-09-08T21:43:04Z", "author": {"login": "martint"}, "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "diffHunk": "@@ -492,6 +492,30 @@ private static Block truncateVarbinary(Block block, int max)\n         return builder.build();\n     }\n \n+    @VisibleForTesting\n+    static long yearsEpoch(long millis)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMTM5NQ=="}, "originalCommit": null, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNDgzNzY4OnYy", "diffSide": "RIGHT", "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MDoyOFrOHOu9bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MDoyOFrOHOu9bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMTUwMA==", "bodyText": "epochMonth?", "url": "https://github.com/trinodb/trino/pull/5106#discussion_r485211500", "createdAt": "2020-09-08T21:40:28Z", "author": {"login": "martint"}, "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "diffHunk": "@@ -492,6 +492,30 @@ private static Block truncateVarbinary(Block block, int max)\n         return builder.build();\n     }\n \n+    @VisibleForTesting\n+    static long yearsEpoch(long millis)\n+    {\n+        return YEAR_FIELD.get(millis) - 1970;\n+    }\n+\n+    @VisibleForTesting\n+    static long monthsEpoch(long millis)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNDg0MzAwOnYy", "diffSide": "RIGHT", "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MjoyNFrOHOvAuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MjoyNFrOHOvAuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMjM0NQ==", "bodyText": "epochDay?", "url": "https://github.com/trinodb/trino/pull/5106#discussion_r485212345", "createdAt": "2020-09-08T21:42:24Z", "author": {"login": "martint"}, "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "diffHunk": "@@ -492,6 +492,30 @@ private static Block truncateVarbinary(Block block, int max)\n         return builder.build();\n     }\n \n+    @VisibleForTesting\n+    static long yearsEpoch(long millis)\n+    {\n+        return YEAR_FIELD.get(millis) - 1970;\n+    }\n+\n+    @VisibleForTesting\n+    static long monthsEpoch(long millis)\n+    {\n+        long year = yearsEpoch(millis);\n+        int month = MONTH_FIELD.get(millis) - 1;\n+        return (year * 12) + month;\n+    }\n+\n+    private static long daysEpoch(long millis)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 127}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNDg0MzI1OnYy", "diffSide": "RIGHT", "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MjozMVrOHOvA8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQyMTo0MjozMVrOHOvA8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxMjQwMA==", "bodyText": "epochHour?", "url": "https://github.com/trinodb/trino/pull/5106#discussion_r485212400", "createdAt": "2020-09-08T21:42:31Z", "author": {"login": "martint"}, "path": "presto-iceberg/src/main/java/io/prestosql/plugin/iceberg/PartitionTransforms.java", "diffHunk": "@@ -492,6 +492,30 @@ private static Block truncateVarbinary(Block block, int max)\n         return builder.build();\n     }\n \n+    @VisibleForTesting\n+    static long yearsEpoch(long millis)\n+    {\n+        return YEAR_FIELD.get(millis) - 1970;\n+    }\n+\n+    @VisibleForTesting\n+    static long monthsEpoch(long millis)\n+    {\n+        long year = yearsEpoch(millis);\n+        int month = MONTH_FIELD.get(millis) - 1;\n+        return (year * 12) + month;\n+    }\n+\n+    private static long daysEpoch(long millis)\n+    {\n+        return floorDiv(millis, MILLISECONDS_PER_DAY);\n+    }\n+\n+    private static long hoursEpoch(long millis)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 132}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3174, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}