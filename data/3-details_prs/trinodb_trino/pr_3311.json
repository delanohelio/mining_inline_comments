{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NTUxOTc0", "number": 3311, "title": "Add milliseconds to formatTime", "bodyText": "", "createdAt": "2020-04-02T12:38:48Z", "url": "https://github.com/trinodb/trino/pull/3311", "merged": true, "mergeCommit": {"oid": "5a0320cf19bc03b45456daf109f3e59a299eaedb"}, "closed": true, "closedAt": "2020-05-16T01:54:23Z", "author": {"login": "kabunchi"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTy85qgBqjMxOTM5MTE0MDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchn0mYABqjMzNDIzOTc4MDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2ODQ2Njkw", "url": "https://github.com/trinodb/trino/pull/3311#pullrequestreview-386846690", "createdAt": "2020-04-02T23:30:00Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzozMDowMFrOGAADiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQyMzozMTozNFrOGAAFRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDA4OA==", "bodyText": "I don't think we want to round here, since that would mean 59.5 would be the effective cutoff. We can do\nif (duration.toMillis() >= MINUTES.toMillis(1)) {", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654088", "createdAt": "2020-04-02T23:30:00Z", "author": {"login": "electrum"}, "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDI5Mg==", "bodyText": "This can delegate to formatTime", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654292", "createdAt": "2020-04-02T23:30:44Z", "author": {"login": "electrum"}, "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));\n+\n+        if (totalSeconds >= 60) {\n+            int minutes = totalSeconds / 60;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDUzNQ==", "bodyText": "Nit: the \"else\" is redundant, since the \"if\" always returns\nif (... above cutoff...) {\n    return formatTime(...);\n}\n\n... format with millis ...", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654535", "createdAt": "2020-04-02T23:31:34Z", "author": {"login": "electrum"}, "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));\n+\n+        if (totalSeconds >= 60) {\n+            int minutes = totalSeconds / 60;\n+            int seconds = totalSeconds % 60;\n+\n+            return format(\"%s:%02d\", minutes, seconds);\n+        } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMzc5MDUx", "url": "https://github.com/trinodb/trino/pull/3311#pullrequestreview-412379051", "createdAt": "2020-05-15T06:29:06Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODA4NjQ3", "url": "https://github.com/trinodb/trino/pull/3311#pullrequestreview-412808647", "createdAt": "2020-05-15T16:47:13Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNjo0NzoxM1rOGWMZ5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNjo0NzoxM1rOGWMZ5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyNTA5Mw==", "bodyText": "Actually, this could be simplified to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    int seconds = (int) (totalMillis / 1000);\n          \n          \n            \n                    int millis = (int) (totalMillis % 1000) / 10;\n          \n          \n            \n            \n          \n          \n            \n                    return format(\"%s.%02d\", seconds, millis);\n          \n          \n            \n                    return format(\"%.2f\", totalMillis / 1000.0);", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r425925093", "createdAt": "2020-05-15T16:47:13Z", "author": {"login": "martint"}, "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +166,20 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        long totalMillis = duration.toMillis();\n+\n+        if (totalMillis >= MINUTES.toMillis(1)) {\n+            return formatTime(duration);\n+        }\n+\n+        int seconds = (int) (totalMillis / 1000);\n+        int millis = (int) (totalMillis % 1000) / 10;\n+\n+        return format(\"%s.%02d\", seconds, millis);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "author": {"user": {"login": "kabunchi", "name": "Tal"}}, "url": "https://github.com/trinodb/trino/commit/88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "committedDate": "2020-05-15T20:08:00Z", "message": "Add milliseconds to final time format in case of short queries"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "author": {"user": {"login": "kabunchi", "name": "Tal"}}, "url": "https://github.com/trinodb/trino/commit/88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "committedDate": "2020-05-15T20:08:00Z", "message": "Add milliseconds to final time format in case of short queries"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1710, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}