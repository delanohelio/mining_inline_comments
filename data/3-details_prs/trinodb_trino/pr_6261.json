{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0Njc1Mjg3", "number": 6261, "title": "Add legacy hive view translation property to config property table", "bodyText": "Added entry in hive configuration property table to explain use of hive.legacy-hive-view-translation as per issue.", "createdAt": "2020-12-08T19:32:49Z", "url": "https://github.com/trinodb/trino/pull/6261", "merged": true, "mergeCommit": {"oid": "7c16f36c9a00a3e8cef9bcda79de92b7083b058b"}, "closed": true, "closedAt": "2020-12-09T22:51:27Z", "author": {"login": "m57lyra"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkQRQHAFqTU0NzYwODE5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkhcnfABqjQwOTA4NzYzMzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NjA4MTk2", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-547608196", "createdAt": "2020-12-08T20:35:49Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMDozNTo0OVrOIB0_JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMDozNTo0OVrOIB0_JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODc4NzYyMA==", "bodyText": "This isn't limited to CTEs. I'm not sure we want to document this at all, since this is a deprecated property that can produce incorrect results. This is really a hidden thing for people who were using the old version and understand the consequences.", "url": "https://github.com/trinodb/trino/pull/6261#discussion_r538787620", "createdAt": "2020-12-08T20:35:49Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/connector/hive.rst", "diffHunk": "@@ -310,6 +310,11 @@ Property Name                                      Description\n                                                    can be used to use a different location for each user.\n \n ``hive.translate-hive-views``                      Enable translation for Hive views. (experimental)            ``false``\n+\n+``hive.legacy-hive-view-translation``              Enable translation for Hive views with CTEs. Set this        ``false``", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NzAzMTMw", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-547703130", "createdAt": "2020-12-08T22:57:59Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NzIzMjU3", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-547723257", "createdAt": "2020-12-08T23:35:35Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMzozNTozNVrOIB7SZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMzozNTozNVrOIB7SZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg5MDg1Mg==", "bodyText": "I think the descriptions of hive.translate-hive-views and hive.legacy-hive-view-translation might be confusing for new users, since we mention that the first property is as experimental itself and mention the second one as \"legacy\". Also, I think we say experimental, because there're chances that things may evolve/break.\n@electrum Can we take an approach where we fallback to the legacy behavior when coral fails? This can be placed at https://github.com/prestosql/presto/blob/master/presto-hive/src/main/java/io/prestosql/plugin/hive/ViewReaderUtil.java#L183 .", "url": "https://github.com/trinodb/trino/pull/6261#discussion_r538890852", "createdAt": "2020-12-08T23:35:35Z", "author": {"login": "phd3"}, "path": "presto-docs/src/main/sphinx/connector/hive.rst", "diffHunk": "@@ -310,6 +310,13 @@ Property Name                                      Description\n                                                    can be used to use a different location for each user.\n \n ``hive.translate-hive-views``                      Enable translation for Hive views. (experimental)            ``false``\n+\n+``hive.legacy-hive-view-translation``              Use the legacy algorithm to translate Hive views.            ``false``", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MDU5NzM1", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-548059735", "createdAt": "2020-12-09T10:50:03Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMDo1MDowNFrOICOVlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMDo1MDowNFrOICOVlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIwMjk2Nw==", "bodyText": "I would drop the Set this property to ``true`` if you encounter unhandled AST token exceptions with the new experimental algorithm. part but do not feel strongly about it.", "url": "https://github.com/trinodb/trino/pull/6261#discussion_r539202967", "createdAt": "2020-12-09T10:50:04Z", "author": {"login": "losipiuk"}, "path": "presto-docs/src/main/sphinx/connector/hive.rst", "diffHunk": "@@ -310,6 +310,13 @@ Property Name                                      Description\n                                                    can be used to use a different location for each user.\n \n ``hive.translate-hive-views``                      Enable translation for Hive views. (experimental)            ``false``\n+\n+``hive.legacy-hive-view-translation``              Use the legacy algorithm to translate Hive views.            ``false``\n+                                                   Set this property to ``true`` if you encounter unhandled ", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MDU5Nzk4", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-548059798", "createdAt": "2020-12-09T10:50:08Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTU1MzU4", "url": "https://github.com/trinodb/trino/pull/6261#pullrequestreview-548155358", "createdAt": "2020-12-09T12:57:28Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1NzoyOFrOICTT4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMjo1NzoyOFrOICTT4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI4NDQ0OA==", "bodyText": "This is not limited to AST token expcetions (eg #6234), so\nit should be at least e.g., but i think we can remove the \"troubleshooting\" advice from here\ncc @losipiuk", "url": "https://github.com/trinodb/trino/pull/6261#discussion_r539284448", "createdAt": "2020-12-09T12:57:28Z", "author": {"login": "findepi"}, "path": "presto-docs/src/main/sphinx/connector/hive.rst", "diffHunk": "@@ -310,6 +310,13 @@ Property Name                                      Description\n                                                    can be used to use a different location for each user.\n \n ``hive.translate-hive-views``                      Enable translation for Hive views. (experimental)            ``false``\n+\n+``hive.legacy-hive-view-translation``              Use the legacy algorithm to translate Hive views.            ``false``\n+                                                   Set this property to ``true`` if you encounter unhandled \n+                                                   AST token exceptions with the new experimental algorithm. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a14421e58748ba69faaa926d694bc811d95f5a1d", "author": {"user": {"login": "m57lyra", "name": "Annie Elliott"}}, "url": "https://github.com/trinodb/trino/commit/a14421e58748ba69faaa926d694bc811d95f5a1d", "committedDate": "2020-12-09T16:35:30Z", "message": "Add legacy hive view translation property to config property table"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a14421e58748ba69faaa926d694bc811d95f5a1d", "author": {"user": {"login": "m57lyra", "name": "Annie Elliott"}}, "url": "https://github.com/trinodb/trino/commit/a14421e58748ba69faaa926d694bc811d95f5a1d", "committedDate": "2020-12-09T16:35:30Z", "message": "Add legacy hive view translation property to config property table"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2118, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}