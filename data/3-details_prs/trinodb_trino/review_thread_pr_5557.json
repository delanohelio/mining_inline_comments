{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzNTY5NzQ1", "number": 5557, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwODo0NzozOVrOEt4ojg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwODo0NzozOVrOEt4ojg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NTQ5MjYyOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/spiller/AesSpillCipher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwODo0NzozOVrOHh8mzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzowMDoxNFrOHiGkAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTM1ODAzMQ==", "bodyText": "The gist of the information from the commit message should be also captured as a code comment.\notherwise it's too easy for someone to roll this back into single doFinal in a remove \"redundant update call\" cleanup commit.", "url": "https://github.com/trinodb/trino/pull/5557#discussion_r505358031", "createdAt": "2020-10-15T08:47:39Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/spiller/AesSpillCipher.java", "diffHunk": "@@ -69,7 +69,8 @@ public int encrypt(byte[] data, int inputOffset, int length, byte[] destination,\n         Cipher cipher = createEncryptCipher(key);\n         System.arraycopy(cipher.getIV(), 0, destination, destinationOffset, ivBytes);\n         try {\n-            return ivBytes + cipher.doFinal(data, inputOffset, length, destination, destinationOffset + ivBytes);\n+            int n = cipher.update(data, inputOffset, length, destination, destinationOffset + ivBytes);\n+            return ivBytes + n + cipher.doFinal(destination, destinationOffset + ivBytes + n);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUyMTE1NQ==", "bodyText": "Done", "url": "https://github.com/trinodb/trino/pull/5557#discussion_r505521155", "createdAt": "2020-10-15T13:00:14Z", "author": {"login": "pettyjamesm"}, "path": "presto-main/src/main/java/io/prestosql/spiller/AesSpillCipher.java", "diffHunk": "@@ -69,7 +69,8 @@ public int encrypt(byte[] data, int inputOffset, int length, byte[] destination,\n         Cipher cipher = createEncryptCipher(key);\n         System.arraycopy(cipher.getIV(), 0, destination, destinationOffset, ivBytes);\n         try {\n-            return ivBytes + cipher.doFinal(data, inputOffset, length, destination, destinationOffset + ivBytes);\n+            int n = cipher.update(data, inputOffset, length, destination, destinationOffset + ivBytes);\n+            return ivBytes + n + cipher.doFinal(destination, destinationOffset + ivBytes + n);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTM1ODAzMQ=="}, "originalCommit": null, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4712, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}