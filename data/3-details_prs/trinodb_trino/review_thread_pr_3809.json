{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMjQ1MzAw", "number": 3809, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMjowNVrOD-iEfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMzo0MFrOD-iGTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2ODk2NTA4OnYy", "diffSide": "LEFT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMjowNVrOGYsKFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMTozMzo0OFrOGYvk1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0MjQ4Nw==", "bodyText": "This is redundant not because synchronization is not needed, but because it's already surrounded by synchronized (failedIrreversibleOperationDescriptions).\nMaybe introduce a local Object lock instead of synchronizing on lists?", "url": "https://github.com/trinodb/trino/pull/3809#discussion_r428542487", "createdAt": "2020-05-21T09:22:05Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "diffHunk": "@@ -1686,10 +1686,8 @@ private void executeIrreversibleMetastoreOperations()\n                         synchronized (failedIrreversibleOperationDescriptions) {\n                             failedIrreversibleOperationDescriptions.add(irreversibleMetastoreOperation.getDescription());\n                             // A limit is needed to avoid having a huge exception object. 5 was chosen arbitrarily.\n-                            synchronized (suppressedExceptions) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0OTI5OA==", "bodyText": "Maybe introduce a local Object lock instead of synchronizing on lists?\n\nWhat's the advantage?", "url": "https://github.com/trinodb/trino/pull/3809#discussion_r428549298", "createdAt": "2020-05-21T09:37:20Z", "author": {"login": "sopel39"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "diffHunk": "@@ -1686,10 +1686,8 @@ private void executeIrreversibleMetastoreOperations()\n                         synchronized (failedIrreversibleOperationDescriptions) {\n                             failedIrreversibleOperationDescriptions.add(irreversibleMetastoreOperation.getDescription());\n                             // A limit is needed to avoid having a huge exception object. 5 was chosen arbitrarily.\n-                            synchronized (suppressedExceptions) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0MjQ4Nw=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU5ODQ4NQ==", "bodyText": "Clarity of intent", "url": "https://github.com/trinodb/trino/pull/3809#discussion_r428598485", "createdAt": "2020-05-21T11:33:48Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "diffHunk": "@@ -1686,10 +1686,8 @@ private void executeIrreversibleMetastoreOperations()\n                         synchronized (failedIrreversibleOperationDescriptions) {\n                             failedIrreversibleOperationDescriptions.add(irreversibleMetastoreOperation.getDescription());\n                             // A limit is needed to avoid having a huge exception object. 5 was chosen arbitrarily.\n-                            synchronized (suppressedExceptions) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0MjQ4Nw=="}, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2ODk2ODcyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMzoyMVrOGYsMcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMzoyMVrOGYsMcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0MzA5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // none of the futures should fail because all exceptions are being caught\n          \n          \n            \n                            // none of the futures should fail because all exceptions are being handled explicitly", "url": "https://github.com/trinodb/trino/pull/3809#discussion_r428543090", "createdAt": "2020-05-21T09:23:21Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "diffHunk": "@@ -1695,7 +1695,8 @@ private void executeIrreversibleMetastoreOperations()\n             }\n \n             for (CompletableFuture<?> dropFuture : dropFutures.build()) {\n-                MoreFutures.getFutureValue(dropFuture, PrestoException.class);\n+                // none of the futures should fail because all exceptions are being caught", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2ODk2OTc0OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMzo0MFrOGYsNDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwOToyMzo0MFrOGYsNDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU0MzI0Ng==", "bodyText": "can static import", "url": "https://github.com/trinodb/trino/pull/3809#discussion_r428543246", "createdAt": "2020-05-21T09:23:40Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/SemiTransactionalHiveMetastore.java", "diffHunk": "@@ -1695,7 +1695,8 @@ private void executeIrreversibleMetastoreOperations()\n             }\n \n             for (CompletableFuture<?> dropFuture : dropFutures.build()) {\n-                MoreFutures.getFutureValue(dropFuture, PrestoException.class);\n+                // none of the futures should fail because all exceptions are being caught\n+                MoreFutures.getFutureValue(dropFuture);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4903, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}