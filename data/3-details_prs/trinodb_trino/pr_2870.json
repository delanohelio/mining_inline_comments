{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NTgxOTQy", "number": 2870, "title": "Format maps and lists with varbinary", "bodyText": "Fixes #2858", "createdAt": "2020-02-18T12:09:45Z", "url": "https://github.com/trinodb/trino/pull/2870", "merged": true, "mergeCommit": {"oid": "81f0c168b3d2529f2d403a2f4d3b32ca92a66cfa"}, "closed": true, "closedAt": "2020-03-05T09:04:21Z", "author": {"login": "wendigo"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI4BfHgFqTM2NjczMDc4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKbY4GABqjMwOTc5MzE3ODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzMwNzg3", "url": "https://github.com/trinodb/trino/pull/2870#pullrequestreview-366730787", "createdAt": "2020-02-28T22:50:13Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMjo1MDoxNFrOFwFAjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQyMjo1MzoyNlrOFwFEGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk1ODAzMA==", "bodyText": "move under createHexPairs so that the 3 hex-related functions stay together", "url": "https://github.com/trinodb/trino/pull/2870#discussion_r385958030", "createdAt": "2020-02-28T22:50:14Z", "author": {"login": "findepi"}, "path": "presto-cli/src/main/java/io/prestosql/cli/AlignedTablePrinter.java", "diffHunk": "@@ -186,6 +196,24 @@ static String formatHexDump(byte[] bytes)\n         return HEX_BYTE_JOINER.join(createHexPairs(bytes));\n     }\n \n+    static String formatList(List<? extends Object> list)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk1ODc5Mg==", "bodyText": "I think it would be better to explicitly format the list:\nreturn list.stream()\n .map(AlignedTablePrinter::formatValue)\n .collect(joining(\", \", \"[\", \"]));", "url": "https://github.com/trinodb/trino/pull/2870#discussion_r385958792", "createdAt": "2020-02-28T22:52:58Z", "author": {"login": "findepi"}, "path": "presto-cli/src/main/java/io/prestosql/cli/AlignedTablePrinter.java", "diffHunk": "@@ -186,6 +196,24 @@ static String formatHexDump(byte[] bytes)\n         return HEX_BYTE_JOINER.join(createHexPairs(bytes));\n     }\n \n+    static String formatList(List<? extends Object> list)\n+    {\n+        ImmutableList.Builder<Object> formattedList = ImmutableList.builder();\n+\n+        list.forEach(value -> formattedList.add(formatValue(value)));\n+\n+        return formattedList.build().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk1ODkzNg==", "bodyText": "should key be formatted as well?", "url": "https://github.com/trinodb/trino/pull/2870#discussion_r385958936", "createdAt": "2020-02-28T22:53:26Z", "author": {"login": "findepi"}, "path": "presto-cli/src/main/java/io/prestosql/cli/AlignedTablePrinter.java", "diffHunk": "@@ -186,6 +196,24 @@ static String formatHexDump(byte[] bytes)\n         return HEX_BYTE_JOINER.join(createHexPairs(bytes));\n     }\n \n+    static String formatList(List<? extends Object> list)\n+    {\n+        ImmutableList.Builder<Object> formattedList = ImmutableList.builder();\n+\n+        list.forEach(value -> formattedList.add(formatValue(value)));\n+\n+        return formattedList.build().toString();\n+    }\n+\n+    static String formatMap(Map<? extends Object, ? extends Object> map)\n+    {\n+        ImmutableMap.Builder<Object, Object> formattedMap = ImmutableMap.builder();\n+\n+        map.keySet().forEach(key -> formattedMap.put(key, formatValue(map.get(key))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzMzOTU0", "url": "https://github.com/trinodb/trino/pull/2870#pullrequestreview-368333954", "createdAt": "2020-03-03T21:22:44Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMToyMjo0NVrOFxW_Rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMToyMjo0NVrOFxW_Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwMTE5MQ==", "bodyText": "unused?", "url": "https://github.com/trinodb/trino/pull/2870#discussion_r387301191", "createdAt": "2020-03-03T21:22:45Z", "author": {"login": "findepi"}, "path": "presto-cli/src/main/java/io/prestosql/cli/AlignedTablePrinter.java", "diffHunk": "@@ -195,6 +206,26 @@ static String formatHexDump(byte[] bytes)\n         return HEX_SPLITTER.split(hexDump);\n     }\n \n+    static String formatList(List<? extends Object> list)\n+    {\n+        ImmutableList.Builder<Object> formattedList = ImmutableList.builder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 45}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4Mzg3ODY2", "url": "https://github.com/trinodb/trino/pull/2870#pullrequestreview-368387866", "createdAt": "2020-03-03T22:57:04Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMjo1NzowNFrOFxZsIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMjo1NzowNFrOFxZsIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzM0NTQ0Mw==", "bodyText": "Static import", "url": "https://github.com/trinodb/trino/pull/2870#discussion_r387345443", "createdAt": "2020-03-03T22:57:04Z", "author": {"login": "electrum"}, "path": "presto-cli/src/main/java/io/prestosql/cli/AlignedTablePrinter.java", "diffHunk": "@@ -195,6 +206,20 @@ static String formatHexDump(byte[] bytes)\n         return HEX_SPLITTER.split(hexDump);\n     }\n \n+    static String formatList(List<? extends Object> list)\n+    {\n+        return list.stream()\n+                .map(AlignedTablePrinter::formatValue)\n+                .collect(joining(\", \", \"[\", \"]\"));\n+    }\n+\n+    static String formatMap(Map<? extends Object, ? extends Object> map)\n+    {\n+        return map.entrySet().stream()\n+                .map(entry -> format(\"%s=%s\", formatValue(entry.getKey()), formatValue(entry.getValue())))\n+                .collect(Collectors.joining(\", \", \"{\", \"}\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d1289b193067c5744f8d46c564991fcac23738c", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/8d1289b193067c5744f8d46c564991fcac23738c", "committedDate": "2020-03-04T18:39:44Z", "message": "Format maps and lists with varbinary"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8d1289b193067c5744f8d46c564991fcac23738c", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/8d1289b193067c5744f8d46c564991fcac23738c", "committedDate": "2020-03-04T18:39:44Z", "message": "Format maps and lists with varbinary"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1586, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}