{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4NzEwNjE0", "number": 3341, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQyMDoxMjozMFrODu6cqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQyMDoxMjozMFrODu6cqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNTE4Njk4OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/TestPrestoS3FileSystem.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQyMDoxMjozMFrOGBDAhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQyMTowNTowNlrOGBDW8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1MTA0NQ==", "bodyText": "nit, move AWSSessionCredentials.class, sessionCredentials -> as new lines", "url": "https://github.com/trinodb/trino/pull/3341#discussion_r403751045", "createdAt": "2020-04-05T20:12:30Z", "author": {"login": "sopel39"}, "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/TestPrestoS3FileSystem.java", "diffHunk": "@@ -91,21 +94,31 @@ public void testStaticCredentials()\n         Configuration config = new Configuration(false);\n         config.set(S3_ACCESS_KEY, \"test_access_key\");\n         config.set(S3_SECRET_KEY, \"test_secret_key\");\n-        // the static credentials should be preferred\n \n         try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n-            verifyStaticCredentials(config, fs, \"s3n://test-bucket/\", \"test_access_key\", \"test_secret_key\");\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isNotInstanceOf(AWSSessionCredentials.class);\n+        }\n+\n+        config.set(S3_SESSION_TOKEN, \"test_token\");\n+        try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isInstanceOfSatisfying(AWSSessionCredentials.class, sessionCredentials ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ecd4814f05f910c022a2c526f36204ab9b6f115"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1Njc4Nw==", "bodyText": "This seems worse:\nassertThat(credentials).isInstanceOfSatisfying(\n        AWSSessionCredentials.class,\n        sessionCredentials -> assertEquals(sessionCredentials.getSessionToken(), \"test_token\"));\nWith the above, the class name is close to the isInstanceOf call, and the assertEquals is by itself (easier to read than when preceded by a lambda argument).", "url": "https://github.com/trinodb/trino/pull/3341#discussion_r403756787", "createdAt": "2020-04-05T21:05:06Z", "author": {"login": "electrum"}, "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/TestPrestoS3FileSystem.java", "diffHunk": "@@ -91,21 +94,31 @@ public void testStaticCredentials()\n         Configuration config = new Configuration(false);\n         config.set(S3_ACCESS_KEY, \"test_access_key\");\n         config.set(S3_SECRET_KEY, \"test_secret_key\");\n-        // the static credentials should be preferred\n \n         try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n-            verifyStaticCredentials(config, fs, \"s3n://test-bucket/\", \"test_access_key\", \"test_secret_key\");\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isNotInstanceOf(AWSSessionCredentials.class);\n+        }\n+\n+        config.set(S3_SESSION_TOKEN, \"test_token\");\n+        try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isInstanceOfSatisfying(AWSSessionCredentials.class, sessionCredentials ->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1MTA0NQ=="}, "originalCommit": {"oid": "7ecd4814f05f910c022a2c526f36204ab9b6f115"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 315, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}