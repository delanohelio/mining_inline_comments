{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MzkyNzIz", "number": 4722, "title": "Pinot Testing cluster", "bodyText": "Implement pinot testing cluster. Move shared dependency on TestingKafka to presto-testing.", "createdAt": "2020-08-07T05:09:39Z", "url": "https://github.com/trinodb/trino/pull/4722", "merged": true, "mergeCommit": {"oid": "6819ff2f276d69d2fdbb17a5c17d97bc36f9b37e"}, "closed": true, "closedAt": "2020-08-12T19:35:46Z", "author": {"login": "elonazoulay"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8eulDABqjM2MzE5Nzk2OTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-PQ8OABqjM2NDg4MjQyOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDk0NzU3", "url": "https://github.com/trinodb/trino/pull/4722#pullrequestreview-463094757", "createdAt": "2020-08-07T07:31:43Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNzozMTo0M1rOG9PlUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNzozNTozN1rOG9Pr7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MTYzNA==", "bodyText": "Maybe you want presto-testing-kafka?", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r466871634", "createdAt": "2020-08-07T07:31:43Z", "author": {"login": "kokosing"}, "path": "presto-testing/pom.xml", "diffHunk": "@@ -92,6 +92,16 @@\n             <artifactId>jackson-annotations</artifactId>\n         </dependency>\n \n+        <dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MTkyMw==", "bodyText": "TestingKafka is used by multiple modules for testing.\n\nWhat modules?\nIf you are copying it can you please remove testing kafka from other place and reuse your testing kafka?", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r466871923", "createdAt": "2020-08-07T07:32:25Z", "author": {"login": "kokosing"}, "path": "pom.xml", "diffHunk": "@@ -1114,6 +1114,12 @@\n                 <version>3.6.1</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MjExOQ==", "bodyText": "Please squash this commit with the first one.", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r466872119", "createdAt": "2020-08-07T07:32:51Z", "author": {"login": "kokosing"}, "path": "presto-kafka/src/test/java/io/prestosql/plugin/kafka/util/TestingKafka.java", "diffHunk": "@@ -1,92 +0,0 @@\n-/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MjgzMw==", "bodyText": "Is this extension needed for host mapper? If not please use separate commit.", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r466872833", "createdAt": "2020-08-07T07:34:32Z", "author": {"login": "kokosing"}, "path": "presto-pinot/src/main/java/io/prestosql/pinot/PinotConnectorFactory.java", "diffHunk": "@@ -23,12 +25,20 @@\n import org.weakref.jmx.guice.MBeanModule;\n \n import java.util.Map;\n+import java.util.Optional;\n \n import static java.util.Objects.requireNonNull;\n \n public class PinotConnectorFactory\n         implements ConnectorFactory\n {\n+    private final Optional<Module> extension;\n+\n+    public PinotConnectorFactory(Optional<Module> extension)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MzMyNA==", "bodyText": "Please squash that commit with Add TestingPinotCluster", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r466873324", "createdAt": "2020-08-07T07:35:37Z", "author": {"login": "kokosing"}, "path": "presto-pinot/src/test/java/io/prestosql/pinot/TestMinimalFunctionality.java", "diffHunk": "@@ -16,31 +16,39 @@\n import com.fasterxml.jackson.annotation.JsonCreator;\n import com.fasterxml.jackson.annotation.JsonProperty;\n import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import io.prestosql.pinot.client.PinotHostMapper;\n import io.prestosql.pinot.util.TestingPinotCluster;\n+import io.prestosql.pinot.util.TestingPinotHostMapper;\n+import io.prestosql.testing.AbstractTestQueryFramework;\n+import io.prestosql.testing.QueryRunner;\n import io.prestosql.testing.kafka.TestingKafka;\n import org.apache.kafka.clients.producer.KafkaProducer;\n import org.apache.kafka.clients.producer.ProducerRecord;\n import org.testng.annotations.AfterClass;\n-import org.testng.annotations.BeforeClass;\n import org.testng.annotations.Test;\n \n import java.time.Instant;\n import java.util.Arrays;\n import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n \n+import static com.google.inject.multibindings.OptionalBinder.newOptionalBinder;\n import static io.airlift.testing.Closeables.closeAllRuntimeException;\n import static java.util.Objects.requireNonNull;\n \n @Test(singleThreaded = true)\n public class TestMinimalFunctionality\n+        extends AbstractTestQueryFramework", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "646abe3bc32476f6697525e7dbd9db1b0e516a50", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/646abe3bc32476f6697525e7dbd9db1b0e516a50", "committedDate": "2020-08-07T10:47:59Z", "message": "Add pinot host mapper interface\n\nPinot returns host names for brokers and servers.\nAllow a mapping between what pinot returns and actual hostnames,\nfor example if pinot is running in docker."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "646abe3bc32476f6697525e7dbd9db1b0e516a50", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/646abe3bc32476f6697525e7dbd9db1b0e516a50", "committedDate": "2020-08-07T10:47:59Z", "message": "Add pinot host mapper interface\n\nPinot returns host names for brokers and servers.\nAllow a mapping between what pinot returns and actual hostnames,\nfor example if pinot is running in docker."}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1Mzc5NDAz", "url": "https://github.com/trinodb/trino/pull/4722#pullrequestreview-465379403", "createdAt": "2020-08-11T19:51:02Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOTo1MTowMlrOG_G4Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOTo1MTo0NlrOG_G5rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgyNjE1OQ==", "bodyText": "Unrelated change?", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r468826159", "createdAt": "2020-08-11T19:51:02Z", "author": {"login": "martint"}, "path": "presto-testing-kafka/src/main/java/io/prestosql/testing/kafka/TestingKafka.java", "diffHunk": "@@ -34,7 +34,7 @@\n \n     public TestingKafka()\n     {\n-        container = new KafkaContainer(\"5.4.1\");\n+        container = new KafkaContainer(\"5.4.1\").withNetworkAliases(\"kafka\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgyNjU0Mw==", "bodyText": "Why did this move?", "url": "https://github.com/trinodb/trino/pull/4722#discussion_r468826543", "createdAt": "2020-08-11T19:51:46Z", "author": {"login": "martint"}, "path": "presto-kafka/src/test/java/io/prestosql/plugin/kafka/util/TestUtils.java", "diffHunk": "@@ -19,29 +19,20 @@\n import io.prestosql.plugin.kafka.KafkaTopicDescription;\n import io.prestosql.spi.connector.SchemaTableName;\n import io.prestosql.testing.TestingPrestoClient;\n+import io.prestosql.testing.kafka.TestingKafka;\n import org.apache.kafka.clients.producer.KafkaProducer;\n \n import java.io.IOException;\n import java.util.AbstractMap;\n import java.util.Map;\n import java.util.Optional;\n-import java.util.Properties;\n \n import static java.lang.String.format;\n \n public final class TestUtils\n {\n     private TestUtils() {}\n \n-    static Properties toProperties(Map<String, String> map)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b826c262feb84429d7dff75bafd0cad3e4ae18a", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/7b826c262feb84429d7dff75bafd0cad3e4ae18a", "committedDate": "2020-08-12T17:56:00Z", "message": "Move TestUtils.toProperties to TestingKafka\n\nThis method is only used in TestingKafka"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb2b0088222a2320d3734e08919dc83af6443507", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/eb2b0088222a2320d3734e08919dc83af6443507", "committedDate": "2020-08-12T17:56:01Z", "message": "Move TestingKafka to presto-testing-kafka module\n\nTestingKafka can be used by multiple modules."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "944ef5210b1efe1ebb79daae7b94dd202a468f08", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/944ef5210b1efe1ebb79daae7b94dd202a468f08", "committedDate": "2020-08-12T17:56:02Z", "message": "Add network alias for TestingKafka\n\nThis is needed by test containers that access TestingKafka."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5bd701e2bd52b589485e58572b70be8d8400125", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/b5bd701e2bd52b589485e58572b70be8d8400125", "committedDate": "2020-08-12T17:56:03Z", "message": "Remove unused ObjectMapper from PinotPageSourceProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be7f75e614683ff588afc5239f0b8017e038640c", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/be7f75e614683ff588afc5239f0b8017e038640c", "committedDate": "2020-08-12T17:56:04Z", "message": "Add pinot host mapper interface\n\nPinot returns host names for brokers and servers.\nAllow a mapping between what pinot returns and actual hostnames,\nfor example if pinot is running in docker."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21d5121ad158ba0f5fcd77789a7d8ecf77564d10", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/21d5121ad158ba0f5fcd77789a7d8ecf77564d10", "committedDate": "2020-08-12T17:56:05Z", "message": "Add TestingPinotCluster"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "21d5121ad158ba0f5fcd77789a7d8ecf77564d10", "author": {"user": {"login": "elonazoulay", "name": "Elon Azoulay"}}, "url": "https://github.com/trinodb/trino/commit/21d5121ad158ba0f5fcd77789a7d8ecf77564d10", "committedDate": "2020-08-12T17:56:05Z", "message": "Add TestingPinotCluster"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4662, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}