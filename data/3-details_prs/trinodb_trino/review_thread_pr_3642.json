{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MDE4NTQz", "number": 3642, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxMzowMlrOD6KV2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyODoxNFrOD6MA0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzEzNDMzOnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryClient.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxMzowMlrOGR1oqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxMzowMlrOGR1oqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM1NzczOQ==", "bodyText": "ImmutableList -> List", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421357739", "createdAt": "2020-05-07T09:13:02Z", "author": {"login": "findepi"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryClient.java", "diffHunk": "@@ -150,31 +148,27 @@ TableResult query(String sql)\n         }\n     }\n \n-    String createSql(TableId table, ImmutableList<String> requiredColumns, String[] filters)\n+    String selectSql(TableId table, ImmutableList<String> requiredColumns)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzE0MDUxOnYy", "diffSide": "LEFT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryCredentialsSupplier.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNDozNlrOGR1sog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNDozNlrOGR1sog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM1ODc1NA==", "bodyText": "good that you removed unused fields\nwe should still validate the values are non null, as they are not validated otherwise (even implicitly) before the ctor returns", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421358754", "createdAt": "2020-05-07T09:14:36Z", "author": {"login": "findepi"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryCredentialsSupplier.java", "diffHunk": "@@ -29,14 +29,10 @@\n \n class BigQueryCredentialsSupplier\n {\n-    private final Optional<String> credentialsKey;\n-    private final Optional<String> credentialsFile;\n     private final Supplier<Optional<Credentials>> credentialsCreator;\n \n     public BigQueryCredentialsSupplier(Optional<String> credentialsKey, Optional<String> credentialsFile)\n     {\n-        this.credentialsKey = credentialsKey;\n-        this.credentialsFile = credentialsFile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzE0MzM0OnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNToyMVrOGR1udQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNToyMVrOGR1udQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM1OTIyMQ==", "bodyText": "please also move below logger, and add a blank line after static field", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421359221", "createdAt": "2020-05-07T09:15:21Z", "author": {"login": "findepi"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "diffHunk": "@@ -72,31 +70,23 @@\n public class BigQueryResultPageSource\n         implements ConnectorPageSource\n {\n-    static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();\n+    private static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzE1MDQ2OnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/ReadSessionCreator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNzoxOVrOGR1zEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToxNzoxOVrOGR1zEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM2MDQwMw==", "bodyText": "perhaps you can make the fields private too", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421360403", "createdAt": "2020-05-07T09:17:19Z", "author": {"login": "findepi"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/ReadSessionCreator.java", "diffHunk": "@@ -144,19 +143,19 @@ TableInfo getActualTable(\n         }\n     }\n \n-    static class DestinationTableBuilder\n+    private static class DestinationTableBuilder\n             implements Callable<TableInfo>\n     {\n         final BigQueryClient bigQueryClient;\n         final ReadSessionCreatorConfig config;\n-        final String querySql;\n+        final String query;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzM5MTgwOnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryMetadata.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyMzoxMlrOGR4Mhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyMzoxMlrOGR4Mhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM5OTY4Nw==", "bodyText": "nit: separate fields from constants with new line", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421399687", "createdAt": "2020-05-07T10:23:12Z", "author": {"login": "losipiuk"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryMetadata.java", "diffHunk": "@@ -62,18 +61,19 @@\n public class BigQueryMetadata\n         implements ConnectorMetadata\n {\n+    private static final Logger log = Logger.get(BigQueryMetadata.class);\n+\n     static final int NUMERIC_DATA_TYPE_PRECISION = 38;\n     static final int NUMERIC_DATA_TYPE_SCALE = 9;\n     static final String INFORMATION_SCHEMA = \"information_schema\";\n-    private static final Logger log = Logger.get(BigQueryMetadata.class);\n-    private BigQueryClient bigQueryClient;\n-    private String projectId;\n+    private final BigQueryClient bigQueryClient;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzQwMDAwOnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyNTozMlrOGR4Rqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyNTozMlrOGR4Rqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQwMTAwMg==", "bodyText": "List", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421401002", "createdAt": "2020-05-07T10:25:32Z", "author": {"login": "losipiuk"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "diffHunk": "@@ -72,31 +70,23 @@\n public class BigQueryResultPageSource\n         implements ConnectorPageSource\n {\n-    static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();\n+    private static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();\n     private static final Logger log = Logger.get(BigQueryResultPageSource.class);\n     private final BigQueryStorageClient bigQueryStorageClient;\n-    private final int maxReadRowsRetries;\n     private final BigQuerySplit split;\n-    private final BigQueryTableHandle table;\n-    private final ImmutableList<BigQueryColumnHandle> columns;\n     private final ImmutableList<Type> columnTypes;\n     private final AtomicLong readBytes;\n     private final PageBuilder pageBuilder;\n-    private Iterator<Storage.ReadRowsResponse> responses;\n-    private boolean closed;\n+    private final Iterator<Storage.ReadRowsResponse> responses;\n \n     public BigQueryResultPageSource(\n             BigQueryStorageClientFactory bigQueryStorageClientFactory,\n             int maxReadRowsRetries,\n             BigQuerySplit split,\n-            BigQueryTableHandle table,\n             ImmutableList<BigQueryColumnHandle> columns)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzQwMTYzOnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyNjowMFrOGR4SnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyNjowMFrOGR4SnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQwMTI0NA==", "bodyText": "Do we want to add requireNotNull check here?", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421401244", "createdAt": "2020-05-07T10:26:00Z", "author": {"login": "losipiuk"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/BigQueryResultPageSource.java", "diffHunk": "@@ -72,31 +70,23 @@\n public class BigQueryResultPageSource\n         implements ConnectorPageSource\n {\n-    static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();\n+    private static final AvroDecimalConverter DECIMAL_CONVERTER = new AvroDecimalConverter();\n     private static final Logger log = Logger.get(BigQueryResultPageSource.class);\n     private final BigQueryStorageClient bigQueryStorageClient;\n-    private final int maxReadRowsRetries;\n     private final BigQuerySplit split;\n-    private final BigQueryTableHandle table;\n-    private final ImmutableList<BigQueryColumnHandle> columns;\n     private final ImmutableList<Type> columnTypes;\n     private final AtomicLong readBytes;\n     private final PageBuilder pageBuilder;\n-    private Iterator<Storage.ReadRowsResponse> responses;\n-    private boolean closed;\n+    private final Iterator<Storage.ReadRowsResponse> responses;\n \n     public BigQueryResultPageSource(\n             BigQueryStorageClientFactory bigQueryStorageClientFactory,\n             int maxReadRowsRetries,\n             BigQuerySplit split,\n-            BigQueryTableHandle table,\n             ImmutableList<BigQueryColumnHandle> columns)\n     {\n         this.bigQueryStorageClient = bigQueryStorageClientFactory.createBigQueryStorageClient();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyMzQwODE3OnYy", "diffSide": "RIGHT", "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/ReadSessionCreator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyODoxNFrOGR4XEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyODoxNFrOGR4XEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQwMjM4Ng==", "bodyText": "Maybe add notNullCheck?", "url": "https://github.com/trinodb/trino/pull/3642#discussion_r421402386", "createdAt": "2020-05-07T10:28:14Z", "author": {"login": "losipiuk"}, "path": "presto-bigquery/src/main/java/io/prestosql/plugin/bigquery/ReadSessionCreator.java", "diffHunk": "@@ -144,19 +143,19 @@ TableInfo getActualTable(\n         }\n     }\n \n-    static class DestinationTableBuilder\n+    private static class DestinationTableBuilder\n             implements Callable<TableInfo>\n     {\n         final BigQueryClient bigQueryClient;\n         final ReadSessionCreatorConfig config;\n-        final String querySql;\n+        final String query;\n         final TableId table;\n \n-        DestinationTableBuilder(BigQueryClient bigQueryClient, ReadSessionCreatorConfig config, String querySql, TableId table)\n+        DestinationTableBuilder(BigQueryClient bigQueryClient, ReadSessionCreatorConfig config, String query, TableId table)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 49, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}