{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMTY3NDc0", "number": 3366, "title": "Disallow reading from Delta Lake tables in hive connector", "bodyText": "", "createdAt": "2020-04-07T10:04:42Z", "url": "https://github.com/trinodb/trino/pull/3366", "merged": true, "mergeCommit": {"oid": "6cdba2590e9115a076ffe10cd8faae0d584414e9"}, "closed": true, "closedAt": "2020-04-07T23:30:07Z", "author": {"login": "wendigo"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVT_LrAFqTM4OTE1OTMwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVXaNQABqjMyMTEwNTM1MjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MTU5MzAy", "url": "https://github.com/trinodb/trino/pull/3366#pullrequestreview-389159302", "createdAt": "2020-04-07T14:14:58Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNDo1OFrOGCFpLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNTozOVrOGCFrQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0Mjc5Ng==", "bodyText": "just use HIVE_UNSUPPORTED_FORMAT instead", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404842796", "createdAt": "2020-04-07T14:14:58Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveErrorCode.java", "diffHunk": "@@ -64,7 +64,8 @@\n     HIVE_CORRUPTED_COLUMN_STATISTICS(37, EXTERNAL),\n     HIVE_EXCEEDED_SPLIT_BUFFERING_LIMIT(38, USER_ERROR),\n     HIVE_UNKNOWN_COLUMN_STATISTIC_TYPE(39, INTERNAL_ERROR),\n-    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL)\n+    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL),\n+    HIVE_DELTA_LAKE_TABLE(40, USER_ERROR),", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzAxMQ==", "bodyText": "rm \"Managed\"", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843011", "createdAt": "2020-04-07T14:15:15Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -2296,6 +2303,12 @@ private static void validateBucketColumns(ConnectorTableMetadata tableMetadata)\n         }\n     }\n \n+    private static boolean isDeltaLakeManagedTable(Table table)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzMzMQ==", "bodyText": "rm \"managed\"", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843331", "createdAt": "2020-04-07T14:15:39Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -341,6 +344,10 @@ public HiveTableHandle getTableHandle(ConnectorSession session, SchemaTableName\n             return null;\n         }\n \n+        if (isDeltaLakeManagedTable(table.get())) {\n+            throw new PrestoException(HIVE_DELTA_LAKE_TABLE, \"Cannot query Delta Lake managed table\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "6796776bb5edcff998b9eb62afdf76b7dee53a5a", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/6796776bb5edcff998b9eb62afdf76b7dee53a5a", "committedDate": "2020-04-07T18:14:38Z", "message": "Disallow reading from Delta Lake tables in hive connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "6796776bb5edcff998b9eb62afdf76b7dee53a5a", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/6796776bb5edcff998b9eb62afdf76b7dee53a5a", "committedDate": "2020-04-07T18:14:38Z", "message": "Disallow reading from Delta Lake tables in hive connector"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1823, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}