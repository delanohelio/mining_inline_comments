{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3ODkzNTAy", "number": 5186, "title": "Fix flaky TestSqlTask tests", "bodyText": "Fixes: #5191", "createdAt": "2020-09-16T10:35:32Z", "url": "https://github.com/trinodb/trino/pull/5186", "merged": true, "mergeCommit": {"oid": "73fef2de98165c2da4f51bb252d2b35a1a82a0ca"}, "closed": true, "closedAt": "2020-09-16T18:08:57Z", "author": {"login": "sopel39"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJZu1QAH2gAyNDg3ODkzNTAyOjhhMjlhYTQ5NmEyMTAzYWRkODMwNzY4ZDhkZWE2MzczNDE4YjIxZTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJgPgPgFqTQ4OTg2NDIxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8a29aa496a2103add830768d8dea6373418b21e8", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/8a29aa496a2103add830768d8dea6373418b21e8", "committedDate": "2020-09-16T10:21:20Z", "message": "Fix flaky TestSqlTask#testDynamicFilters\n\nPrevent race condition between dynamic filter\nupdate and task entering FLUSHING state (due to\nnoMoreSplits set to true)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff814df88f08c7f47dc83c21762fb3e41498fede", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/ff814df88f08c7f47dc83c21762fb3e41498fede", "committedDate": "2020-09-16T10:30:38Z", "message": "Remove flaky assertion\n\nTask status future will be immediately\ndone when final task status is set. Therefore\nassertion that status version has changed is\nflaky (status version increment is executed\nin different thread)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NTA0NjM2", "url": "https://github.com/trinodb/trino/pull/5186#pullrequestreview-489504636", "createdAt": "2020-09-16T10:51:11Z", "commit": {"oid": "ff814df88f08c7f47dc83c21762fb3e41498fede"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMDo1MToxMVrOHSrRAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMDo1MToxMVrOHSrRAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM0NTI4MQ==", "bodyText": "This was failing with\nAssertionError: expected [1] but found [0]\n\nhow possible is that we could transition to FINISHED without changing the version field?\nwhat's the mechanics here?", "url": "https://github.com/trinodb/trino/pull/5186#discussion_r489345281", "createdAt": "2020-09-16T10:51:11Z", "author": {"login": "findepi"}, "path": "presto-main/src/test/java/io/prestosql/execution/TestSqlTask.java", "diffHunk": "@@ -139,7 +139,6 @@ public void testEmptyQuery()\n \n         taskInfo = sqlTask.getTaskInfo(STARTING_VERSION).get();\n         assertEquals(taskInfo.getTaskStatus().getState(), TaskState.FINISHED);\n-        assertEquals(taskInfo.getTaskStatus().getVersion(), STARTING_VERSION + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff814df88f08c7f47dc83c21762fb3e41498fede"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5ODY0MjEx", "url": "https://github.com/trinodb/trino/pull/5186#pullrequestreview-489864211", "createdAt": "2020-09-16T17:56:27Z", "commit": {"oid": "ff814df88f08c7f47dc83c21762fb3e41498fede"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3616, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}