{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNjQ5NDQy", "number": 2793, "title": "enable dynamic filtering by default", "bodyText": "", "createdAt": "2020-02-11T13:09:19Z", "url": "https://github.com/trinodb/trino/pull/2793", "merged": true, "mergeCommit": {"oid": "ddcbe76d60a06e611357256d836f46b992084bc6"}, "closed": true, "closedAt": "2020-03-02T11:54:46Z", "author": {"login": "sopel39"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDRfXXABqjMwMjY0NzQ2OTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJsZDHgBqjMwODc2MzIwMDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMzk0OTY0", "url": "https://github.com/trinodb/trino/pull/2793#pullrequestreview-361394964", "createdAt": "2020-02-19T19:59:04Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxOTo1OTowNVrOFr1m-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxOTo1OTowNVrOFr1m-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUxMTQxOQ==", "bodyText": "Since we are using a new instance of StatsRecordingPlanOptimizer for the 3 places where PredicatePushDown rule is applied, it looks like this will reset the stats each time for this rule (Check OptimizerStatsRecorder#register). Is that ok ? I think we would want to know the combined time taken of PredicatePushDown rule in all the invocations or record them all separately.", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r381511419", "createdAt": "2020-02-19T19:59:05Z", "author": {"login": "raunaqmorarka"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/PlanOptimizers.java", "diffHunk": "@@ -405,7 +403,7 @@ public PlanOptimizers(\n                 new CheckSubqueryNodesAreRewritten(),\n                 new StatsRecordingPlanOptimizer(\n                         optimizerStats,\n-                        new PredicatePushDown(metadata, typeAnalyzer, false)),\n+                        new StatsRecordingPlanOptimizer(optimizerStats, new PredicatePushDown(metadata, typeAnalyzer, false, false))),", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61d4609a49d270c64805db9e903d5a9887d0c6ef", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/61d4609a49d270c64805db9e903d5a9887d0c6ef", "committedDate": "2020-02-22T20:36:26Z", "message": "Fix removal of dynamic filters within join filter condition"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDUyNDc3", "url": "https://github.com/trinodb/trino/pull/2793#pullrequestreview-363052477", "createdAt": "2020-02-22T21:44:32Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQyMTo0NDozMlrOFtNCDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQyMTo1OTo0OVrOFtNFow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0Mzc1OQ==", "bodyText": "Typo in commit message: \"Prediacate\"", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r382943759", "createdAt": "2020-02-22T21:44:32Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/PlanOptimizers.java", "diffHunk": "@@ -279,8 +279,6 @@ public PlanOptimizers(\n                         .add(new RemoveTrivialFilters())", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0Mzk4MA==", "bodyText": "Hmm... this is going to have to change once we move PredicatePushdown to the iterative optimizer, as it will be interleaved with all other rules.", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r382943980", "createdAt": "2020-02-22T21:48:18Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/PlanOptimizers.java", "diffHunk": "@@ -407,7 +405,7 @@ public PlanOptimizers(\n                 new CheckSubqueryNodesAreRewritten(),\n                 new StatsRecordingPlanOptimizer(\n                         optimizerStats,\n-                        new PredicatePushDown(metadata, typeAnalyzer, false)),", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0NDA5NA==", "bodyText": "Can you add some details to the commit message explaining the motivation? I..e, what about grouped execution makes it incompatible with dynamic filters?", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r382944094", "createdAt": "2020-02-22T21:50:11Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/sql/planner/LocalExecutionPlanner.java", "diffHunk": "@@ -2042,7 +2042,7 @@ private PhysicalOperation createLookupJoin(\n             ImmutableList.Builder<OperatorFactory> factoriesBuilder = new ImmutableList.Builder<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0NDY1MQ==", "bodyText": "Can you add some details to the commit message explaining the motivation?", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r382944651", "createdAt": "2020-02-22T21:59:16Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/split/PageSourceManager.java", "diffHunk": "@@ -13,15 +13,13 @@\n  */", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0NDY3NQ==", "bodyText": "Same here, can you add a comment in the commit message explaining the motivation?", "url": "https://github.com/trinodb/trino/pull/2793#discussion_r382944675", "createdAt": "2020-02-22T21:59:49Z", "author": {"login": "martint"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HivePageSourceProvider.java", "diffHunk": "@@ -117,7 +117,7 @@ public ConnectorPageSource createPageSource(ConnectorTransactionHandle transacti\n                 hiveSplit.getFileSize(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63ddf227e74bdcf9f330b4c99e0efc1e8d3ee120", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/63ddf227e74bdcf9f330b4c99e0efc1e8d3ee120", "committedDate": "2020-03-02T11:47:46Z", "message": "Pushdown dynamic filters after reorder joins\n\nPredicate pushdown pushes dynamic filters down\nthe plan. At the end of planning, dynamic filters\nare removed from places where they are not valid (e.g build side,\nnested predicates). Because of this reorder joins should\noperate on plan that doesn't have dynamic filters as it might\ncause stats and cost misestimates."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "147e9f7ef728a8666edffd8af841d4e8351fa21d", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/147e9f7ef728a8666edffd8af841d4e8351fa21d", "committedDate": "2020-03-02T11:47:55Z", "message": "Remove redundant isEnableDynamicFiltering check\n\nWhen isEnableDynamicFiltering is disabled, then\ndynamic filters won't be added by planner."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86808348d2af56f18b701700e41e4f927d30bbc7", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/86808348d2af56f18b701700e41e4f927d30bbc7", "committedDate": "2020-03-02T11:47:55Z", "message": "Restore table scan printing of dynamic filters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6782d7e0bbea34d6b89512a9391254fcf5a8e156", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/6782d7e0bbea34d6b89512a9391254fcf5a8e156", "committedDate": "2020-03-02T11:53:09Z", "message": "Add check that dynamic filtering is not enabled with grouped execution\n\nDynamic filtering assumes that join build side is evaulated fixed\n(task_concurrency) amount of times. This constraint is not satisfied\nwhen grouped execution is enabled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26f118ad2d06760d3a2148f4e181ef517f2e7922", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/26f118ad2d06760d3a2148f4e181ef517f2e7922", "committedDate": "2020-03-02T11:54:09Z", "message": "Don't match dynamic filters in FilterMatcher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfae1a017f5f8a146e1311d8315b731dffafffac", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/cfae1a017f5f8a146e1311d8315b731dffafffac", "committedDate": "2020-03-02T11:54:09Z", "message": "Remove obsolete TODO"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "324058168d9950bb12234fe2f62a53008bf6640f", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/324058168d9950bb12234fe2f62a53008bf6640f", "committedDate": "2020-03-02T11:54:10Z", "message": "Add support for dynamic filter to TableScanOperator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "341ec2fa3be7915d45bde9b555d0808ff12a4ad8", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/341ec2fa3be7915d45bde9b555d0808ff12a4ad8", "committedDate": "2020-03-02T11:54:10Z", "message": "Use updatable page source when dynamic filter constraint is empty\n\nDynamic filter might filter data source entirely. In such case\nDELETE operation might fail if data source is not of UpdatablePageSource\ntype."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e869790404bd4693e4e95c2546e6aefd787b879", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/8e869790404bd4693e4e95c2546e6aefd787b879", "committedDate": "2020-03-02T11:54:10Z", "message": "Simplify dynamic filter before passing it to HivePageSourceFactory\n\nDynamic filter tuple domains might be relatively large and expensive\nto evaluate. They must be simplified so that dynamic filters do not incur\nadditional CPU cost if they are not filtering much."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3541ae2d7923097997a1daf28f867e8111f1cde5", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/3541ae2d7923097997a1daf28f867e8111f1cde5", "committedDate": "2020-03-02T11:54:10Z", "message": "Enable dynamic filtering by default"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "3541ae2d7923097997a1daf28f867e8111f1cde5", "author": {"user": {"login": "sopel39", "name": "Karol Sobczak"}}, "url": "https://github.com/trinodb/trino/commit/3541ae2d7923097997a1daf28f867e8111f1cde5", "committedDate": "2020-03-02T11:54:10Z", "message": "Enable dynamic filtering by default"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1666, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}