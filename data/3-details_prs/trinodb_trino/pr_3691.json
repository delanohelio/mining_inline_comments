{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1OTM4MzUw", "number": 3691, "title": "Limit pushdown for Kudu connector", "bodyText": "", "createdAt": "2020-05-11T08:09:42Z", "url": "https://github.com/trinodb/trino/pull/3691", "merged": true, "mergeCommit": {"oid": "c7fbf6a40e6c2c66e3ade199b778a504f7d500cd"}, "closed": true, "closedAt": "2020-10-28T10:36:55Z", "author": {"login": "Praveen2112"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgLlENABqjMzMjE4OTkxOTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdW4FVogBqjM5Mjk2NzYxMTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96", "author": {"user": {"login": "Praveen2112", "name": "Praveen Krishna"}}, "url": "https://github.com/trinodb/trino/commit/132c5aad4f2457f7886948cc154bc68eca949e96", "committedDate": "2020-05-11T08:40:54Z", "message": "Limit pushdown for Kudu connector"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MDQ1OTEz", "url": "https://github.com/trinodb/trino/pull/3691#pullrequestreview-409045913", "createdAt": "2020-05-11T10:22:09Z", "commit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxMDoyMjowOVrOGTWI-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxMDoyMjowOVrOGTWI-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkzODg3Mg==", "bodyText": "why is it not guaranteed?", "url": "https://github.com/trinodb/trino/pull/3691#discussion_r422938872", "createdAt": "2020-05-11T10:22:09Z", "author": {"login": "kokosing"}, "path": "presto-kudu/src/main/java/io/prestosql/plugin/kudu/KuduMetadata.java", "diffHunk": "@@ -450,8 +453,29 @@ public ConnectorTableProperties getTableProperties(ConnectorSession session, Con\n                 handle.getTable(clientSession),\n                 handle.getConstraint(),\n                 Optional.of(desiredColumns.build()),\n-                handle.isDeleteHandle());\n+                handle.isDeleteHandle(),\n+                handle.getLimit());\n \n         return Optional.of(new ProjectionApplicationResult<>(handle, projections, assignmentList.build()));\n     }\n+\n+    @Override\n+    public Optional<LimitApplicationResult<ConnectorTableHandle>> applyLimit(ConnectorSession session, ConnectorTableHandle table, long limit)\n+    {\n+        KuduTableHandle handle = (KuduTableHandle) table;\n+\n+        if (handle.getLimit().isPresent() && handle.getLimit().getAsLong() <= limit) {\n+            return Optional.empty();\n+        }\n+\n+        handle = new KuduTableHandle(\n+                handle.getSchemaTableName(),\n+                handle.getTable(clientSession),\n+                handle.getConstraint(),\n+                handle.getDesiredColumns(),\n+                handle.isDeleteHandle(),\n+                OptionalLong.of(limit));\n+\n+        return Optional.of(new LimitApplicationResult<>(handle, false));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MTA4MDg0", "url": "https://github.com/trinodb/trino/pull/3691#pullrequestreview-409108084", "createdAt": "2020-05-11T12:03:32Z", "commit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NTYxMDM4", "url": "https://github.com/trinodb/trino/pull/3691#pullrequestreview-409561038", "createdAt": "2020-05-11T21:58:27Z", "commit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1ODoyN1rOGTu30g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1ODoyN1rOGTu30g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDA4Mg==", "bodyText": "if limit is present, we cannot apply filter, can we?", "url": "https://github.com/trinodb/trino/pull/3691#discussion_r423344082", "createdAt": "2020-05-11T21:58:27Z", "author": {"login": "findepi"}, "path": "presto-kudu/src/main/java/io/prestosql/plugin/kudu/KuduMetadata.java", "diffHunk": "@@ -394,7 +396,8 @@ public ConnectorTableProperties getTableProperties(ConnectorSession session, Con\n                 handle.getTable(clientSession),\n                 newDomain,\n                 handle.getDesiredColumns(),\n-                handle.isDeleteHandle());\n+                handle.isDeleteHandle(),\n+                handle.getLimit());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "132c5aad4f2457f7886948cc154bc68eca949e96", "author": {"user": {"login": "Praveen2112", "name": "Praveen Krishna"}}, "url": "https://github.com/trinodb/trino/commit/132c5aad4f2457f7886948cc154bc68eca949e96", "committedDate": "2020-05-11T08:40:54Z", "message": "Limit pushdown for Kudu connector"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNTQzOTgx", "url": "https://github.com/trinodb/trino/pull/3691#pullrequestreview-492543981", "createdAt": "2020-09-21T12:26:52Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2NzE0NTQ3", "url": "https://github.com/trinodb/trino/pull/3691#pullrequestreview-516714547", "createdAt": "2020-10-26T12:10:08Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2fac6766ae3e528bafb42f7a4e407a9490bcc79", "author": {"user": {"login": "Praveen2112", "name": "Praveen Krishna"}}, "url": "https://github.com/trinodb/trino/commit/b2fac6766ae3e528bafb42f7a4e407a9490bcc79", "committedDate": "2020-10-28T07:03:53Z", "message": "Include bucketCount for hashCode and equals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c5e084c40bdd9e6511196696afa92fdb219f636", "author": {"user": {"login": "Praveen2112", "name": "Praveen Krishna"}}, "url": "https://github.com/trinodb/trino/commit/8c5e084c40bdd9e6511196696afa92fdb219f636", "committedDate": "2020-10-28T07:03:54Z", "message": "Limit pushdown for Kudu connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8c5e084c40bdd9e6511196696afa92fdb219f636", "author": {"user": {"login": "Praveen2112", "name": "Praveen Krishna"}}, "url": "https://github.com/trinodb/trino/commit/8c5e084c40bdd9e6511196696afa92fdb219f636", "committedDate": "2020-10-28T07:03:54Z", "message": "Limit pushdown for Kudu connector"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1462, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}