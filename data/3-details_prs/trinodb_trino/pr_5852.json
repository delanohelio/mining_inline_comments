{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NjA2NDc2", "number": 5852, "title": "Use static imports for String.format", "bodyText": "Use static imports for String.format", "createdAt": "2020-11-06T09:03:36Z", "url": "https://github.com/trinodb/trino/pull/5852", "merged": true, "mergeCommit": {"oid": "850b086ce710a1bc441da922c1906eccf4451c54"}, "closed": true, "closedAt": "2020-11-18T20:59:58Z", "author": {"login": "kokosing"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZzPRhgBqjM5NjYyMjk3Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdd0oGRABqjQwMTI3MjIyNDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0OTcwNjg2", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-524970686", "createdAt": "2020-11-06T09:08:46Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOTowODo0NlrOHultyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOTowODo0NlrOHultyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYxNDQ3Mw==", "bodyText": "Here comes the cost of this. There is a format method defined in StandardRepresentation", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r518614473", "createdAt": "2020-11-06T09:08:46Z", "author": {"login": "kokosing"}, "path": "presto-main/src/test/java/io/prestosql/sql/query/QueryAssertions.java", "diffHunk": "@@ -368,7 +368,7 @@ public String toStringOf(Object object)\n             {\n                 if (object instanceof SqlTimestamp) {\n                     SqlTimestamp timestamp = (SqlTimestamp) object;\n-                    return String.format(\n+                    return String./*suppress code style*/format(", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0OTcxMjMx", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-524971231", "createdAt": "2020-11-06T09:09:28Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOTowOToyOVrOHulvZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOToxMToxMVrOHuly_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYxNDg4NA==", "bodyText": "This belongs to a new commit", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r518614884", "createdAt": "2020-11-06T09:09:29Z", "author": {"login": "skrzypo987"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/timestamptz/ToIso8601.java", "diffHunk": "@@ -60,25 +60,25 @@ public static Slice toIso8601(@LiteralParameter(\"p\") long precision, @SqlType(\"t\n         long epochMillis = unpackMillisUtc(packedEpochMillis);\n         ZoneId zoneId = unpackZoneKey(packedEpochMillis).getZoneId();\n \n-        return utf8Slice(format((int) precision, epochMillis, 0, zoneId));\n+        return utf8Slice(toIso8621((int) precision, epochMillis, 0, zoneId));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYxNTI5MA==", "bodyText": "as well as this.\nPlease make a commit with only String.format -> format and then other(s) with the rest", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r518615290", "createdAt": "2020-11-06T09:10:11Z", "author": {"login": "skrzypo987"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/timetz/TimeWithTimeZoneToVarcharCast.java", "diffHunk": "@@ -48,18 +48,17 @@ public static Slice cast(@LiteralParameter(\"p\") long precision, @SqlType(\"time(p\n         long nanos = unpackTimeNanos(packedTime);\n         int offsetMinutes = unpackOffsetMinutes(packedTime);\n \n-        return formatAsString((int) precision, nanos * PICOSECONDS_PER_NANOSECOND, offsetMinutes);\n+        return toVarchar((int) precision, nanos * PICOSECONDS_PER_NANOSECOND, offsetMinutes);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYxNTgwNQ==", "bodyText": "same here", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r518615805", "createdAt": "2020-11-06T09:11:11Z", "author": {"login": "skrzypo987"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/cli/OptionsPrinter.java", "diffHunk": "@@ -34,7 +35,7 @@\n \n     private OptionsPrinter() {}\n \n-    public static String format(Object... objects)\n+    public static String formatOptions(Object... objects)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzY4NzI2", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-525368726", "createdAt": "2020-11-06T17:48:59Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNzo0ODo1OVrOHu3rww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNzo0ODo1OVrOHu3rww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkwODg2Nw==", "bodyText": "I intentionally didn't name it toVarchar when I wrote this because I wanted to convey the notion that this is about formatting the value in a string-like format. The fact that it's a varchar is a concern for the caller. See my comment below -- I think the fact that we have to work around naming (and this is not the only case) just to satisfy some convention around imports shows why this \"rule\" shouldn't be applied globally.", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r518908867", "createdAt": "2020-11-06T17:48:59Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/operator/scalar/timetz/TimeWithTimeZoneToVarcharCast.java", "diffHunk": "@@ -48,18 +48,17 @@ public static Slice cast(@LiteralParameter(\"p\") long precision, @SqlType(\"time(p\n         long nanos = unpackTimeNanos(packedTime);\n         int offsetMinutes = unpackOffsetMinutes(packedTime);\n \n-        return formatAsString((int) precision, nanos * PICOSECONDS_PER_NANOSECOND, offsetMinutes);\n+        return toVarchar((int) precision, nanos * PICOSECONDS_PER_NANOSECOND, offsetMinutes);\n     }\n \n     @LiteralParameters({\"x\", \"p\"})\n     @SqlType(\"varchar(x)\")\n     public static Slice cast(@LiteralParameter(\"p\") long precision, @SqlType(\"time(p) with time zone\") LongTimeWithTimeZone time)\n     {\n-        return formatAsString((int) precision, time.getPicoSeconds(), time.getOffsetMinutes());\n+        return toVarchar((int) precision, time.getPicoSeconds(), time.getOffsetMinutes());\n     }\n \n-    // Can't name this format() because we can't have a qualified reference to String.format() below\n-    private static Slice formatAsString(int precision, long picos, int offsetMinutes)\n+    private static Slice toVarchar(int precision, long picos, int offsetMinutes)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1ODM5NTQ3", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-525839547", "createdAt": "2020-11-08T19:55:57Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxOTo1NTo1OFrOHvZ6Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxOTo1NTo1OFrOHvZ6Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTQ2OTY1MA==", "bodyText": "code -> codec", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r519469650", "createdAt": "2020-11-08T19:55:58Z", "author": {"login": "ssheikin"}, "path": "presto-parquet/src/main/java/io/prestosql/parquet/writer/ParquetCompressor.java", "diffHunk": "@@ -47,7 +47,7 @@ static ParquetCompressor getCompressor(CompressionCodecName codec)\n             case UNCOMPRESSED:\n                 return null;\n         }\n-        throw new RuntimeException(String.format(\"%s codec is not supported\", codec));\n+        throw new RuntimeException(\"Not supported code: \" + codec);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwOTY1MDM1", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-530965035", "createdAt": "2020-11-16T07:27:57Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNzoyNzo1N1rOHzquWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNzoyNzo1N1rOHzquWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkzOTQxOQ==", "bodyText": "Is it possible to enforce this kind of formatting somewhere? (airlift?)\nNo change request.", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r523939419", "createdAt": "2020-11-16T07:27:57Z", "author": {"login": "skrzypo987"}, "path": "presto-kafka/src/test/java/io/prestosql/plugin/kafka/TestKafkaIntegrationPushDown.java", "diffHunk": "@@ -108,8 +108,7 @@ public void stopKafka()\n     public void testPartitionPushDown() throws ExecutionException, InterruptedException\n     {\n         createMessages(topicNamePartition);\n-        String sql = format(\"SELECT count(*) FROM default.%s WHERE _partition_id=1\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMjU3NjA2", "url": "https://github.com/trinodb/trino/pull/5852#pullrequestreview-531257606", "createdAt": "2020-11-16T12:02:13Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMjowMjoxM1rOHz6FOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMjowMjo1OVrOHz6IUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDE5MTAzNQ==", "bodyText": "nit: it would be better to inline the expression rather than to reuse the sql variable", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r524191035", "createdAt": "2020-11-16T12:02:13Z", "author": {"login": "findepi"}, "path": "presto-kafka/src/test/java/io/prestosql/plugin/kafka/TestKafkaIntegrationPushDown.java", "diffHunk": "@@ -120,20 +119,17 @@ public void testOffsetPushDown() throws ExecutionException, InterruptedException\n     {\n         createMessages(topicNameOffset);\n         DistributedQueryRunner queryRunner = getDistributedQueryRunner();\n-        String sql = format(\"SELECT count(*) FROM default.%s WHERE _partition_offset between 2 and 10\",\n-                topicNameOffset);\n+        String sql = format(\"SELECT count(*) FROM default.%s WHERE _partition_offset between 2 and 10\", topicNameOffset);\n \n         ResultWithQueryId<MaterializedResult> queryResult = queryRunner.executeWithQueryId(getSession(), sql);\n         assertEquals(getQueryInfo(queryRunner, queryResult).getQueryStats().getProcessedInputPositions(), 18);\n \n-        sql = format(\"SELECT count(*) FROM default.%s WHERE _partition_offset > 2 and _partition_offset < 10\",\n-                topicNameOffset);\n+        sql = format(\"SELECT count(*) FROM default.%s WHERE _partition_offset > 2 and _partition_offset < 10\", topicNameOffset);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDE5MTgyNQ==", "bodyText": "Not supported -> Unsupported", "url": "https://github.com/trinodb/trino/pull/5852#discussion_r524191825", "createdAt": "2020-11-16T12:02:59Z", "author": {"login": "findepi"}, "path": "presto-parquet/src/main/java/io/prestosql/parquet/writer/ParquetCompressor.java", "diffHunk": "@@ -47,7 +47,7 @@ static ParquetCompressor getCompressor(CompressionCodecName codec)\n             case UNCOMPRESSED:\n                 return null;\n         }\n-        throw new RuntimeException(String.format(\"%s codec is not supported\", codec));\n+        throw new RuntimeException(\"Not supported codec: \" + codec);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d6da44b3f49dd685ec4d274302c485e1334e0e8", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/0d6da44b3f49dd685ec4d274302c485e1334e0e8", "committedDate": "2020-11-18T20:58:53Z", "message": "Improve formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6987f02365a2cca1bec1f16c97b12d889c09def", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/b6987f02365a2cca1bec1f16c97b12d889c09def", "committedDate": "2020-11-18T20:58:53Z", "message": "Remove redundant String.format invocation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "850b086ce710a1bc441da922c1906eccf4451c54", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/850b086ce710a1bc441da922c1906eccf4451c54", "committedDate": "2020-11-18T20:58:53Z", "message": "Use static imports for String.format"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "850b086ce710a1bc441da922c1906eccf4451c54", "author": {"user": {"login": "kokosing", "name": "Grzegorz Kokosi\u0144ski"}}, "url": "https://github.com/trinodb/trino/commit/850b086ce710a1bc441da922c1906eccf4451c54", "committedDate": "2020-11-18T20:58:53Z", "message": "Use static imports for String.format"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2877, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}