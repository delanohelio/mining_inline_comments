{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5OTAxNjY2", "number": 2427, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMTo1NTozN1rODWa4yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjoyMTozMVrODWbFEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODM1Nzg2OnYy", "diffSide": "RIGHT", "path": "presto-base-jdbc/src/test/java/io/prestosql/plugin/jdbc/TestBaseJdbcConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMTo1NTozN1rOFbK6sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMTo1NTozN1rOFbK6sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDAzNDczOQ==", "bodyText": "We should remove setUnsupportedTypeHandling instead of setJdbcTypesMappedToVarchar", "url": "https://github.com/trinodb/trino/pull/2427#discussion_r364034739", "createdAt": "2020-01-08T01:55:37Z", "author": {"login": "ebyhr"}, "path": "presto-base-jdbc/src/test/java/io/prestosql/plugin/jdbc/TestBaseJdbcConfig.java", "diffHunk": "@@ -36,7 +36,6 @@ public void testDefaults()\n                 .setConnectionUrl(null)\n                 .setCaseInsensitiveNameMatching(false)\n                 .setCaseInsensitiveNameMatchingCacheTtl(new Duration(1, MINUTES))\n-                .setJdbcTypesMappedToVarchar(null)\n                 .setUnsupportedTypeHandling(UnsupportedTypeHandling.IGNORE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODM2MjM0OnYy", "diffSide": "LEFT", "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/BaseJdbcConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMTo1OTo0NFrOFbK9rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMTo1OTo0NFrOFbK9rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDAzNTUwMQ==", "bodyText": "Revert (other properties have @ConfigDescription)\nAlso, we can remove unused unsupportedTypeHandling variable.", "url": "https://github.com/trinodb/trino/pull/2427#discussion_r364035501", "createdAt": "2020-01-08T01:59:44Z", "author": {"login": "ebyhr"}, "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/BaseJdbcConfig.java", "diffHunk": "@@ -16,7 +16,6 @@\n import com.google.common.base.Splitter;\n import com.google.common.collect.ImmutableSet;\n import io.airlift.configuration.Config;\n-import io.airlift.configuration.ConfigDescription;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODM4NjUwOnYy", "diffSide": "LEFT", "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/BaseJdbcClient.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjoxOToxN1rOFbLL7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjoxOToxN1rOFbLL7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDAzOTE0OA==", "bodyText": "PostgreSqlClient also has the same logic.", "url": "https://github.com/trinodb/trino/pull/2427#discussion_r364039148", "createdAt": "2020-01-08T02:19:17Z", "author": {"login": "ebyhr"}, "path": "presto-base-jdbc/src/main/java/io/prestosql/plugin/jdbc/BaseJdbcClient.java", "diffHunk": "@@ -272,7 +272,10 @@ public BaseJdbcClient(\n                             .setComment(comment)\n                             .build());\n                 }\n-                verify(columnMapping.isPresent() || getUnsupportedTypeHandling(session) == IGNORE, \"Unsupported type handling is set to %s, but toPrestoType() returned empty\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0ODM4OTMxOnYy", "diffSide": "RIGHT", "path": "presto-phoenix/src/test/java/io/prestosql/plugin/phoenix/TestPhoenixIntegrationSmokeTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjoyMTozMVrOFbLNkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjoyMTozMVrOFbLNkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDAzOTU3MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    executeInPhoenix(\"DROP TABLE tpch.test_timestamp\");\n          \n          \n            \n                    assertUpdate(\"DROP TABLE test_timestamp\");", "url": "https://github.com/trinodb/trino/pull/2427#discussion_r364039571", "createdAt": "2020-01-08T02:21:31Z", "author": {"login": "ebyhr"}, "path": "presto-phoenix/src/test/java/io/prestosql/plugin/phoenix/TestPhoenixIntegrationSmokeTest.java", "diffHunk": "@@ -73,6 +76,36 @@ public void testMultipleSomeColumnsRangesPredicate()\n         assertQuery(\"SELECT orderkey, shippriority, clerk, totalprice, custkey FROM orders WHERE orderkey BETWEEN 10 AND 50 OR orderkey BETWEEN 100 AND 150\");\n     }\n \n+    @Test\n+    public void testUnsupportedType()\n+            throws Exception\n+    {\n+        executeInPhoenix(\"CREATE TABLE tpch.test_timestamp (pk bigint primary key, val1 timestamp)\");\n+        executeInPhoenix(\"UPSERT INTO tpch.test_timestamp (pk, val1) VALUES (1, null)\");\n+        executeInPhoenix(\"UPSERT INTO tpch.test_timestamp (pk, val1) VALUES (2, '2002-05-30T09:30:10.5')\");\n+        assertUpdate(\"INSERT INTO test_timestamp VALUES (3)\", 1);\n+        assertQuery(\"SELECT * FROM test_timestamp\", \"VALUES 1, 2, 3\");\n+        assertQuery(\n+                withUnsupportedType(CONVERT_TO_VARCHAR),\n+                \"SELECT * FROM test_timestamp\",\n+                \"VALUES \" +\n+                        \"(1, null), \" +\n+                        \"(2, '2002-05-30 09:30:10.500'), \" +\n+                        \"(3, null)\");\n+        assertQueryFails(\n+                withUnsupportedType(CONVERT_TO_VARCHAR),\n+                \"INSERT INTO test_timestamp VALUES (4, '2002-05-30 09:30:10.500')\",\n+                \"Underlying type that is mapped to VARCHAR is not supported for INSERT: TIMESTAMP\");\n+        executeInPhoenix(\"DROP TABLE tpch.test_timestamp\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 47}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1104, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}