{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMTY3NDc0", "number": 3366, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNDo1OFrODvlOoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNTozOVrODvlP5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjE5NjE2OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveErrorCode.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNDo1OFrOGCFpLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNDo1OFrOGCFpLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0Mjc5Ng==", "bodyText": "just use HIVE_UNSUPPORTED_FORMAT instead", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404842796", "createdAt": "2020-04-07T14:14:58Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveErrorCode.java", "diffHunk": "@@ -64,7 +64,8 @@\n     HIVE_CORRUPTED_COLUMN_STATISTICS(37, EXTERNAL),\n     HIVE_EXCEEDED_SPLIT_BUFFERING_LIMIT(38, USER_ERROR),\n     HIVE_UNKNOWN_COLUMN_STATISTIC_TYPE(39, INTERNAL_ERROR),\n-    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL)\n+    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL),\n+    HIVE_DELTA_LAKE_TABLE(40, USER_ERROR),", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjE5NzM4OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNToxNVrOGCFqAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNToxNVrOGCFqAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzAxMQ==", "bodyText": "rm \"Managed\"", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843011", "createdAt": "2020-04-07T14:15:15Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -2296,6 +2303,12 @@ private static void validateBucketColumns(ConnectorTableMetadata tableMetadata)\n         }\n     }\n \n+    private static boolean isDeltaLakeManagedTable(Table table)", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjE5OTQyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNTozOVrOGCFrQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDoxNTozOVrOGCFrQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzMzMQ==", "bodyText": "rm \"managed\"", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843331", "createdAt": "2020-04-07T14:15:39Z", "author": {"login": "findepi"}, "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -341,6 +344,10 @@ public HiveTableHandle getTableHandle(ConnectorSession session, SchemaTableName\n             return null;\n         }\n \n+        if (isDeltaLakeManagedTable(table.get())) {\n+            throw new PrestoException(HIVE_DELTA_LAKE_TABLE, \"Cannot query Delta Lake managed table\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 356, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}