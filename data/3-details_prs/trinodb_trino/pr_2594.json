{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MzIyODY5", "number": 2594, "title": "Convert singlenode-hdp3 to Launcher", "bodyText": "", "createdAt": "2020-01-23T11:51:30Z", "url": "https://github.com/trinodb/trino/pull/2594", "merged": true, "mergeCommit": {"oid": "53cdff53d4eb5d62dabe2322ac29b77ad5120729"}, "closed": true, "closedAt": "2020-01-28T12:27:14Z", "author": {"login": "wendigo"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9KO8cgBqjI5NzM2OTI1NzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-vE0TABqjI5ODUxMzYxNjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MzMzOTQ2", "url": "https://github.com/trinodb/trino/pull/2594#pullrequestreview-347333946", "createdAt": "2020-01-23T14:24:18Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNDoyNDoxOVrOFg_7wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNDoyOTozMFrOFhAIKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0NjI0Mg==", "bodyText": "This doesn't really belong here, to this class.\nIt's a convention of the module, not specific to this EnvironmentExtender\nFor now, i'd inline this back. We may find a good place for this later.", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370146242", "createdAt": "2020-01-23T14:24:19Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/env/common/Standard.java", "diffHunk": "@@ -35,10 +35,11 @@\n public final class Standard\n         implements EnvironmentExtender\n {\n-    public static final String CONTAINER_PRESTO_ETC = \"/docker/presto-product-tests/conf/presto/etc\";\n+    public static final String CONTAINER_BASE_PATH = \"/docker/presto-product-tests\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0NjkwNw==", "bodyText": "Add this right after singlenode.\nIt's arbitrary, i know, but my thinking is that we have hadoop-ish envs first (singlenodes in some order, then multinodes).\nLater we have hadoop-free ones.", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370146907", "createdAt": "2020-01-23T14:25:27Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/env/EnvironmentModule.java", "diffHunk": "@@ -68,6 +69,8 @@ public void configure(Binder binder)\n \n         environments.addBinding(\"singlenode-cassandra\").to(SinglenodeCassandra.class);\n \n+        environments.addBinding(\"singlenode-hdp3\").to(SinglenodeHdp3.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0ODM0NA==", "bodyText": "I noticed TwoKerberosHives uses (before & after conversion) entrypoint for this.\nLet's try to be consistent and try use entrypoint here too.", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370148344", "createdAt": "2020-01-23T14:27:46Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/env/environment/SinglenodeHdp3.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package io.prestosql.tests.product.launcher.env.environment;\n+\n+import com.google.common.collect.ImmutableList;\n+import io.prestosql.tests.product.launcher.docker.DockerFiles;\n+import io.prestosql.tests.product.launcher.env.Environment;\n+import io.prestosql.tests.product.launcher.env.EnvironmentOptions;\n+import io.prestosql.tests.product.launcher.env.common.AbstractEnvironmentProvider;\n+import io.prestosql.tests.product.launcher.env.common.Hadoop;\n+import io.prestosql.tests.product.launcher.env.common.Standard;\n+\n+import javax.inject.Inject;\n+\n+import static io.prestosql.tests.product.launcher.env.common.Standard.CONTAINER_BASE_PATH;\n+import static io.prestosql.tests.product.launcher.env.common.Standard.CONTAINER_TEMPTO_PROFILE_CONFIG;\n+import static java.util.Objects.requireNonNull;\n+import static org.testcontainers.containers.BindMode.READ_ONLY;\n+\n+public class SinglenodeHdp3\n+        extends AbstractEnvironmentProvider\n+{\n+    private final DockerFiles dockerFiles;\n+    private final String imagesVersion;\n+\n+    @Inject\n+    protected SinglenodeHdp3(DockerFiles dockerFiles, Standard standard, Hadoop hadoop, EnvironmentOptions environmentOptions)\n+    {\n+        super(ImmutableList.of(standard, hadoop));\n+        this.dockerFiles = requireNonNull(dockerFiles, \"dockerFiles is null\");\n+        this.imagesVersion = requireNonNull(environmentOptions.imagesVersion, \"environmentOptions.imagesVersion is null\");\n+    }\n+\n+    @Override\n+    protected void extendEnvironment(Environment.Builder builder)\n+    {\n+        String dockerImageName = \"prestodev/hdp3.1-hive:\" + imagesVersion;\n+\n+        builder.configureContainer(\"hadoop-master\", dockerContainer -> {\n+            dockerContainer.setDockerImageName(dockerImageName);\n+            dockerContainer.setCommand(CONTAINER_BASE_PATH + \"/conf/environment/singlenode-hdp3/docker-command.sh\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0ODkyOQ==", "bodyText": "apply-site-xml-override.sh should be moved, it isn't used by anyone else\nif you move this appropriately, you can retain /docker/presto-product-tests/conf/docker/files/apply-site-xml-override.sh path in the script", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370148929", "createdAt": "2020-01-23T14:28:42Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/common/hadoop/apply-site-xml-override.sh", "diffHunk": "@@ -0,0 +1,24 @@\n+#!/bin/bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE0OTQxNg==", "bodyText": "same here -- move this file", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370149416", "createdAt": "2020-01-23T14:29:30Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/common/hadoop/site-override.xslt", "diffHunk": "@@ -0,0 +1,17 @@\n+<!-- Copied from https://stackoverflow.com/a/31186191/65458 and adapted -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Mzk0MTk3", "url": "https://github.com/trinodb/trino/pull/2594#pullrequestreview-347394197", "createdAt": "2020-01-23T15:37:16Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNTozNzoxNlrOFhCuMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNTozOToyMVrOFhCy9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5MTkyMA==", "bodyText": "please revert", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370191920", "createdAt": "2020-01-23T15:37:16Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/env/common/Standard.java", "diffHunk": "@@ -35,7 +35,7 @@\n public final class Standard\n         implements EnvironmentExtender\n {\n-    public static final String CONTAINER_PRESTO_ETC = \"/docker/presto-product-tests/conf/presto/etc\";\n+    public static final String CONTAINER_PRESTO_ETC = \"/docker/presto-product-tests\" + \"/conf/presto/etc\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5MjMxMQ==", "bodyText": "nit: rename docker-command.sh to eg hadoop-entrypoint.sh", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370192311", "createdAt": "2020-01-23T15:37:54Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/env/environment/SinglenodeHdp3.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package io.prestosql.tests.product.launcher.env.environment;\n+\n+import com.google.common.collect.ImmutableList;\n+import io.prestosql.tests.product.launcher.docker.DockerFiles;\n+import io.prestosql.tests.product.launcher.env.Environment;\n+import io.prestosql.tests.product.launcher.env.EnvironmentOptions;\n+import io.prestosql.tests.product.launcher.env.common.AbstractEnvironmentProvider;\n+import io.prestosql.tests.product.launcher.env.common.Hadoop;\n+import io.prestosql.tests.product.launcher.env.common.Standard;\n+\n+import javax.inject.Inject;\n+\n+import static io.prestosql.tests.product.launcher.env.common.Standard.CONTAINER_TEMPTO_PROFILE_CONFIG;\n+import static java.util.Objects.requireNonNull;\n+import static org.testcontainers.containers.BindMode.READ_ONLY;\n+\n+public class SinglenodeHdp3\n+        extends AbstractEnvironmentProvider\n+{\n+    private final DockerFiles dockerFiles;\n+    private final String imagesVersion;\n+\n+    @Inject\n+    protected SinglenodeHdp3(DockerFiles dockerFiles, Standard standard, Hadoop hadoop, EnvironmentOptions environmentOptions)\n+    {\n+        super(ImmutableList.of(standard, hadoop));\n+        this.dockerFiles = requireNonNull(dockerFiles, \"dockerFiles is null\");\n+        this.imagesVersion = requireNonNull(environmentOptions.imagesVersion, \"environmentOptions.imagesVersion is null\");\n+    }\n+\n+    @Override\n+    protected void extendEnvironment(Environment.Builder builder)\n+    {\n+        String dockerImageName = \"prestodev/hdp3.1-hive:\" + imagesVersion;\n+\n+        builder.configureContainer(\"hadoop-master\", dockerContainer -> {\n+            dockerContainer.setDockerImageName(dockerImageName);\n+            dockerContainer.withCreateContainerCmdModifier(createContainerCmd ->\n+                    createContainerCmd.withEntrypoint(ImmutableList.of((\"/docker/presto-product-tests/conf/environment/singlenode-hdp3/docker-command.sh\"))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5MjczMg==", "bodyText": "apply-site-xml-override.sh should be moved, it isn't used by anyone else, is it?\n(same for site-override.xslt)", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370192732", "createdAt": "2020-01-23T15:38:38Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/docker/files/apply-site-xml-override.sh", "diffHunk": "@@ -0,0 +1,24 @@\n+#!/bin/bash", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5MzE0Mg==", "bodyText": "as the script is installed as an entrypoint, it now should end with exec \"$@\" instead of exec supervisord -c /etc/supervisord.conf", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370193142", "createdAt": "2020-01-23T15:39:21Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-hdp3/docker-command.sh", "diffHunk": "@@ -4,7 +4,7 @@ set -euo pipefail\n \n echo \"[$(date)] $0: configuring hadoop services\"\n \n-/docker/presto-product-tests/conf/docker/files/apply-site-xml-override.sh /etc/hive/conf/hive-site.xml /docker/presto-product-tests/conf/docker/singlenode-hdp3/hadoop-master/hive-site-overrides.xml\n+/docker/presto-product-tests/conf/docker/files/apply-site-xml-override.sh /etc/hive/conf/hive-site.xml /docker/presto-product-tests/conf/environment/singlenode-hdp3/hive-site-overrides.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3OTY3MjY5", "url": "https://github.com/trinodb/trino/pull/2594#pullrequestreview-347967269", "createdAt": "2020-01-24T13:56:19Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxMzo1NjoyMFrOFheXbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxMzo1NzoxN1rOFheZKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY0NDg0Nw==", "bodyText": "Remove the old copy of apply-site-xml-override.sh and site-override.xslt", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370644847", "createdAt": "2020-01-24T13:56:20Z", "author": {"login": "findepi"}, "path": "presto-product-tests/conf/docker/singlenode-hdp3/hadoop-master/docker-command.sh", "diffHunk": "@@ -1,11 +0,0 @@\n-#!/bin/bash\n-\n-set -euo pipefail\n-\n-echo \"[$(date)] $0: configuring hadoop services\"\n-\n-/docker/presto-product-tests/conf/docker/files/apply-site-xml-override.sh /etc/hive/conf/hive-site.xml /docker/presto-product-tests/conf/docker/singlenode-hdp3/hadoop-master/hive-site-overrides.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY0NTI4OA==", "bodyText": "This particular readme wasn't totally useless.\nRetain this as a javadoc of SinglenodeHdp3 class", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370645288", "createdAt": "2020-01-24T13:57:17Z", "author": {"login": "findepi"}, "path": "presto-product-tests/conf/docker/singlenode-hdp3/README", "diffHunk": "@@ -1,2 +0,0 @@\n-HDP 3.1 images (code) + HDP 3.1-like configuration.\n-See https://github.com/prestosql/presto/issues/1841 for more information.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzQ3MzEx", "url": "https://github.com/trinodb/trino/pull/2594#pullrequestreview-348347311", "createdAt": "2020-01-25T21:51:44Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo1MTo0NVrOFhxgNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQyMTo1MjozOVrOFhxgYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODM4OQ==", "bodyText": "If you reference site-override.xslt like this\n\n/full/path/to/site-override.xslt or\n\"${BASH_SOURCE%/*}/site-override.xslt\"\n\nyou don't need to cd in the hadoop-entrypoint.sh", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370958389", "createdAt": "2020-01-25T21:51:45Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-hdp3/apply-site-xml-override.sh", "diffHunk": "@@ -19,6 +19,6 @@ test -f \"${site_xml}\" || fail \"${site_xml} does not exist or is not a file\"\n test -f \"${overrides}\" || fail \"${overrides} does not exist or is not a file\"\n test ! -e \"${site_xml_new}\" || fail \"${site_xml_new} already exists\"\n \n-xsltproc --param override-path \"'${overrides}'\" /docker/presto-product-tests/conf/docker/files/site-override.xslt \"${site_xml}\" > \"${site_xml_new}\"\n+xsltproc --param override-path \"'${overrides}'\" site-override.xslt \"${site_xml}\" > \"${site_xml_new}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1ODQzMg==", "bodyText": "i guess you'd need to cd back to the original location.\nwhile bash has pushd, popd for this, i prefer not to cd at all. imo it makes scripts easier to understand", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r370958432", "createdAt": "2020-01-25T21:52:39Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-hdp3/hadoop-entrypoint.sh", "diffHunk": "@@ -0,0 +1,12 @@\n+#!/bin/bash\n+\n+set -euo pipefail\n+\n+echo \"[$(date)] $0: configuring hadoop services\"\n+\n+cd /docker/presto-product-tests/conf/environment/single-hdp3/", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NTgwMzU3", "url": "https://github.com/trinodb/trino/pull/2594#pullrequestreview-348580357", "createdAt": "2020-01-27T11:00:53Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMTowMDo1M1rOFh-z-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMTowNToxOVrOFh-7BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE3NjQ0MA==", "bodyText": "This should be sufficient:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n          \n          \n            \n            DIR=\"${BASH_SOURCE%/*}\"\n          \n      \n    \n    \n  \n\n(like we did in apply-site-xml-override.sh)", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r371176440", "createdAt": "2020-01-27T11:00:53Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-hdp3/hadoop-entrypoint.sh", "diffHunk": "@@ -0,0 +1,19 @@\n+#!/bin/bash\n+\n+set -euo pipefail\n+\n+fail() {\n+  echo \"$(basename \"$0\"): $*\" >&2\n+  exit 1\n+}\n+\n+DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE3NzMxMA==", "bodyText": "Please quote all variables in bash (https://google.github.io/styleguide/shell.xml#Variable_expansion):\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            $DIR/apply-site-xml-override.sh /etc/hive/conf/hive-site.xml \"$DIR/hive-site-overrides.xml\" || fail \"Could not apply hive-site-overrides.xml\"\n          \n          \n            \n            \"${DIR}/apply-site-xml-override.sh\" /etc/hive/conf/hive-site.xml \"${DIR}/hive-site-overrides.xml\" || fail \"Could not apply hive-site-overrides.xml\"\n          \n      \n    \n    \n  \n\nnit: you don't need to fail explicitly, because you run with set -e, so bash will exit with error upon any command that exits with non-0 exit code", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r371177310", "createdAt": "2020-01-27T11:03:00Z", "author": {"login": "findepi"}, "path": "presto-product-tests-launcher/src/main/resources/docker/presto-product-tests/conf/environment/singlenode-hdp3/hadoop-entrypoint.sh", "diffHunk": "@@ -0,0 +1,19 @@\n+#!/bin/bash\n+\n+set -euo pipefail\n+\n+fail() {\n+  echo \"$(basename \"$0\"): $*\" >&2\n+  exit 1\n+}\n+\n+DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\"\n+\n+echo \"[$(date)] $0: configuring hadoop services\"\n+\n+$DIR/apply-site-xml-override.sh /etc/hive/conf/hive-site.xml \"$DIR/hive-site-overrides.xml\" || fail \"Could not apply hive-site-overrides.xml\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE3ODI0NQ==", "bodyText": "could  you please presto-product-tests-launcher/bin/run-launcher, since hadoop-entrypoint needs to be confirmed by CI anyway?", "url": "https://github.com/trinodb/trino/pull/2594#discussion_r371178245", "createdAt": "2020-01-27T11:05:19Z", "author": {"login": "findepi"}, "path": "presto-product-tests/bin/product-tests-suite-7-non-generic.sh", "diffHunk": "@@ -46,10 +46,9 @@ presto-product-tests/bin/run_on_docker.sh \\\n     -g two_hives \\\n     || suite_exit_code=1\n \n-env HADOOP_BASE_IMAGE=\"not-used\" TESTS_HIVE_VERSION_MAJOR=\"3\" TESTS_HIVE_VERSION_MINOR=\"1\" \\\n-    presto-product-tests/bin/run_on_docker.sh \\\n-    singlenode-hdp3 \\\n-    -g hdp3_only,storage_formats,hive_transactional \\\n+TESTS_HIVE_VERSION_MAJOR=\"3\" TESTS_HIVE_VERSION_MINOR=\"1\" presto-product-tests-launcher/target/presto-product-tests-launcher-*-executable.jar test run \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "50d4925014bf51cfb7c908d720c8bd19acee959e", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/50d4925014bf51cfb7c908d720c8bd19acee959e", "committedDate": "2020-01-28T10:48:54Z", "message": "Convert singlenode-hdp3 environment to Launcher"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "50d4925014bf51cfb7c908d720c8bd19acee959e", "author": {"user": {"login": "wendigo", "name": "Mateusz \"Serafin\" Gajewski"}}, "url": "https://github.com/trinodb/trino/commit/50d4925014bf51cfb7c908d720c8bd19acee959e", "committedDate": "2020-01-28T10:48:54Z", "message": "Convert singlenode-hdp3 environment to Launcher"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 973, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}