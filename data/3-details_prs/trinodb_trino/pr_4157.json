{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4MTgxMjY4", "number": 4157, "title": "Add documentation for timestamp with time zone with precision", "bodyText": "", "createdAt": "2020-06-22T21:15:25Z", "url": "https://github.com/trinodb/trino/pull/4157", "merged": true, "mergeCommit": {"oid": "271c2dbd997c5b1285fdbf10fbf2c845d1e61ebb"}, "closed": true, "closedAt": "2020-06-25T21:36:45Z", "author": {"login": "mosabua"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABct4E4CgBqjM0NzAyOTc4OTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcu1au7ABqjM0ODQxOTQ3NDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Mjg1NjIz", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-435285623", "createdAt": "2020-06-22T21:26:16Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMToyNjoxNlrOGnRlLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToyMjowMVrOGoXMxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgzNTY5NQ==", "bodyText": "remove", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r443835695", "createdAt": "2020-06-22T21:26:16Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -217,8 +217,19 @@ See also :doc:`/functions/datetime` and :doc:`/language/timestamp`\n ``TIMESTAMP WITH TIME ZONE``\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-    Instant in time that includes the date and time of day with a time zone.\n-    Values of this type are rendered using the time zone from the value.\n+``TIMESTAMP``\n+^^^^^^^^^^^^^", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3NDczMg==", "bodyText": "precision ``p``", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444974732", "createdAt": "2020-06-24T15:19:53Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -100,26 +101,28 @@ Date and Time Functions\n         SELECT from_iso8601_date('2020-123');\n         -- 2020-05-02\n \n-.. function:: at_timezone(timestamp, zone) -> timestamp with time zone\n+.. function:: at_timezone(timestamp(p), zone) -> timestamp(p) with time zone\n \n-    Change the time zone component of ``timestamp`` to ``zone`` while preserving the instant in time.\n+    Change the time zone component of ``timestamp`` with precision ``p`` to\n+    ``zone`` while preserving the instant in time.\n \n-.. function:: with_timezone(timestamp, zone) -> timestamp with time zone\n+.. function:: with_timezone(timestamp(p), zone) -> timestamp(p) with time zone\n \n-    Returns a timestamp with time zone from ``timestamp`` and ``zone``.\n+    Returns a timestamp with time zone from ``timestamp`` with precision(p) and", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3NjMyNg==", "bodyText": "This is not quite true. TIMESTAMP and TIMESTAMP WITH TIMEZONE are different types with different semantics. In standard SQL, TIMESTAMP is more like DATE, with additional precision that includes hour/minute/second/fraction. TIMESTAMP W/ TZ represents an instant with an attached time zone.", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444976326", "createdAt": "2020-06-24T15:22:01Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -217,8 +217,18 @@ See also :doc:`/functions/datetime` and :doc:`/language/timestamp`\n ``TIMESTAMP WITH TIME ZONE``\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-    Instant in time that includes the date and time of day with a time zone.\n-    Values of this type are rendered using the time zone from the value.\n+    ``TIMESTAMP WITH TIME ZONE`` is an alias for ``TIMESTAMP(3) WITH TIME ZONE``\n+    (millisecond precision).\n+\n+``TIMESTAMP(P) WITH TIME ZONE``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    Instant in time that includes the date and time of day with ``P`` digits of\n+    precision for the fraction of seconds and with a time zone. Values of this\n+    type are rendered using the time zone from the user session.\n+\n+    Other behavior and usage is identical to :ref:`TIMESTAMP\n+    <timestamp-data-type>`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzU4NDA3", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-436758407", "createdAt": "2020-06-24T15:25:01Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToyNTowMVrOGoXVRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToyNTowMVrOGoXVRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3ODUwMw==", "bodyText": "This function now allows the form current_timestamp(precision), similar to localtimestamp(precision)", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444978503", "createdAt": "2020-06-24T15:25:01Z", "author": {"login": "martint"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -55,7 +55,8 @@ Date and Time Functions\n \n .. data:: current_timestamp\n \n-    Returns the current timestamp with time zone as of the start of the query.\n+    Returns the current timestamp(3) with time zone as of the start of the", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzY0ODY4", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-436764868", "createdAt": "2020-06-24T15:31:48Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNTozMTo0OFrOGoXpIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNTozNzowNlrOGoX3Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk4MzU4NA==", "bodyText": "This is currently a phrase, not a type, so it shouldn't have a precision. Let's do it like localtimestamp where we say\n\n, with 3 digits of subsecond precision.", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444983584", "createdAt": "2020-06-24T15:31:48Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -55,7 +55,8 @@ Date and Time Functions\n \n .. data:: current_timestamp\n \n-    Returns the current timestamp with time zone as of the start of the query.\n+    Returns the current timestamp(3) with time zone as of the start of the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3ODUwMw=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk4NDE2Nw==", "bodyText": "We'll need to add a current_timestamp(p) function as @martin mentions. Copy localtimestamp as much as possible.", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444984167", "createdAt": "2020-06-24T15:32:39Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -55,7 +55,8 @@ Date and Time Functions\n \n .. data:: current_timestamp\n \n-    Returns the current timestamp with time zone as of the start of the query.\n+    Returns the current timestamp(3) with time zone as of the start of the", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3ODUwMw=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk4NjMxMg==", "bodyText": "The timestamp argument should not change since this is an argument name, not a type. The only change should be adding precision to the return type. The description should not change.\n.. function:: at_timezone(timestamp, zone) -> timestamp(p) with time zone", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444986312", "createdAt": "2020-06-24T15:35:51Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -100,26 +101,28 @@ Date and Time Functions\n         SELECT from_iso8601_date('2020-123');\n         -- 2020-05-02\n \n-.. function:: at_timezone(timestamp, zone) -> timestamp with time zone\n+.. function:: at_timezone(timestamp(p), zone) -> timestamp(p) with time zone", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk4NjU5MQ==", "bodyText": "Same as at_timezone, only change the return type, not the argument name or description.", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444986591", "createdAt": "2020-06-24T15:36:15Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -100,26 +101,28 @@ Date and Time Functions\n         SELECT from_iso8601_date('2020-123');\n         -- 2020-05-02\n \n-.. function:: at_timezone(timestamp, zone) -> timestamp with time zone\n+.. function:: at_timezone(timestamp(p), zone) -> timestamp(p) with time zone\n \n-    Change the time zone component of ``timestamp`` to ``zone`` while preserving the instant in time.\n+    Change the time zone component of ``timestamp`` with precision ``p`` to\n+    ``zone`` while preserving the instant in time.\n \n-.. function:: with_timezone(timestamp, zone) -> timestamp with time zone\n+.. function:: with_timezone(timestamp(p), zone) -> timestamp(p) with time zone", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk4NzE4Mw==", "bodyText": "No need to wrap here", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r444987183", "createdAt": "2020-06-24T15:37:06Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -217,8 +217,18 @@ See also :doc:`/functions/datetime` and :doc:`/language/timestamp`\n ``TIMESTAMP WITH TIME ZONE``\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-    Instant in time that includes the date and time of day with a time zone.\n-    Values of this type are rendered using the time zone from the value.\n+    ``TIMESTAMP WITH TIME ZONE`` is an alias for ``TIMESTAMP(3) WITH TIME ZONE``\n+    (millisecond precision).\n+\n+``TIMESTAMP(P) WITH TIME ZONE``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    Instant in time that includes the date and time of day with ``P`` digits of\n+    precision for the fraction of seconds and with a time zone. Values of this\n+    type are rendered using the time zone from the user session.\n+\n+    Other behavior and usage is identical to :ref:`TIMESTAMP", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NzM0MzEy", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-437734312", "createdAt": "2020-06-25T18:02:52Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxODowMjo1MlrOGpF4Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxODowMjo1MlrOGpF4Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc0MTE0Nw==", "bodyText": "Typo \"simi\"", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r445741147", "createdAt": "2020-06-25T18:02:52Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -214,11 +214,23 @@ See also :doc:`/functions/datetime` and :doc:`/language/timestamp`\n         SELECT cast(TIMESTAMP '2020-06-10 15:55:23.383345' as TIMESTAMP(12));\n         -- 2020-06-10 15:55:23.383345000000\n \n+.. _timestamp-with-time-zone-data-type:\n+\n ``TIMESTAMP WITH TIME ZONE``\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-    Instant in time that includes the date and time of day with a time zone.\n-    Values of this type are rendered using the time zone from the value.\n+    ``TIMESTAMP WITH TIME ZONE`` is an alias for ``TIMESTAMP(3) WITH TIME ZONE``\n+    (millisecond precision).\n+\n+``TIMESTAMP(P) WITH TIME ZONE``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    Instant in time that includes the date and time of day with ``P`` digits of\n+    precision for the fraction of seconds and with a time zone. Values of this\n+    type are rendered using the time zone from the user session.\n+\n+    Other behavior and usage is simi to", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NzM0NDk2", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-437734496", "createdAt": "2020-06-25T18:03:07Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODYzMjUx", "url": "https://github.com/trinodb/trino/pull/4157#pullrequestreview-437863251", "createdAt": "2020-06-25T21:14:08Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMToxNDowOVrOGpMBeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMToxNDowOVrOGpMBeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg0MTc4NQ==", "bodyText": "Second sentence is copy/pasted wrong. Should be\n\nValues of this type are rendered using the time zone from the value.", "url": "https://github.com/trinodb/trino/pull/4157#discussion_r445841785", "createdAt": "2020-06-25T21:14:09Z", "author": {"login": "electrum"}, "path": "presto-docs/src/main/sphinx/language/types.rst", "diffHunk": "@@ -214,11 +214,20 @@ See also :doc:`/functions/datetime` and :doc:`/language/timestamp`\n         SELECT cast(TIMESTAMP '2020-06-10 15:55:23.383345' as TIMESTAMP(12));\n         -- 2020-06-10 15:55:23.383345000000\n \n+.. _timestamp-with-time-zone-data-type:\n+\n ``TIMESTAMP WITH TIME ZONE``\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-    Instant in time that includes the date and time of day with a time zone.\n-    Values of this type are rendered using the time zone from the value.\n+    ``TIMESTAMP WITH TIME ZONE`` is an alias for ``TIMESTAMP(3) WITH TIME ZONE``\n+    (millisecond precision).\n+\n+``TIMESTAMP(P) WITH TIME ZONE``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    Instant in time that includes the date and time of day with ``P`` digits of\n+    precision for the fraction of seconds and with a time zone. Values of this", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3490162a6f6e4d0edc4cd712f9714d9805162578", "author": {"user": {"login": "mosabua", "name": "Manfred Moser"}}, "url": "https://github.com/trinodb/trino/commit/3490162a6f6e4d0edc4cd712f9714d9805162578", "committedDate": "2020-06-25T21:20:34Z", "message": "Add documentation for timestamp with time zone with precision"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "3490162a6f6e4d0edc4cd712f9714d9805162578", "author": {"user": {"login": "mosabua", "name": "Manfred Moser"}}, "url": "https://github.com/trinodb/trino/commit/3490162a6f6e4d0edc4cd712f9714d9805162578", "committedDate": "2020-06-25T21:20:34Z", "message": "Add documentation for timestamp with time zone with precision"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 117, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}