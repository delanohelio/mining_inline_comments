{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5Mzc2Njk3", "number": 4869, "title": "Update hive-caching documentation for Rubix 0.3.16", "bodyText": "", "createdAt": "2020-08-18T10:28:10Z", "url": "https://github.com/trinodb/trino/pull/4869", "merged": true, "mergeCommit": {"oid": "746743999e110b4c2bcaf9ae2117330591193cfb"}, "closed": true, "closedAt": "2020-08-20T08:41:06Z", "author": {"login": "losipiuk"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAEkcsAFqTQ2OTE5OTcwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAlavkAFqTQ3MTA1NzE0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MTk5NzAx", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-469199701", "createdAt": "2020-08-18T10:36:37Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDozNjozN1rOHCNkiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDozNjozN1rOHCNkiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA4MTU0NQ==", "bodyText": "this is only valid for read-though mode, for async mode, we still need to account for jmx.current.\"metrics:name=rubix.bookkeeper.count.async_downloaded_mb\" \nqubole/rubix#438 will introduce total_system_source_mb_read global metrics", "url": "https://github.com/trinodb/trino/pull/4869#discussion_r472081545", "createdAt": "2020-08-18T10:36:37Z", "author": {"login": "sopel39"}, "path": "presto-docs/src/main/sphinx/connector/hive-caching.rst", "diffHunk": "@@ -177,16 +177,17 @@ The implementation of the cache exposes a `number of metrics\n :doc:`inspect these and other metrics directly in Presto with the JMX connector\n or in external tools </admin/jmx>`.\n \n-The following example query returns the total amount of data fetched by the\n-BookKeeper on the coordinator and all the separate nodes on the workers in the\n-default async mode:\n+If you are using JMX connector, basic caching statistics are exposed via\n+``jmx.current.\"rubix:catalog=<catalog_name>,name=stats\"`` table.\n+You can read more detailed statistics by querying ``jmx.current.\"rubix:catalog=<catalog_name>,name=stats``.\n+You need to replace ``<catalog_name>`` with name of you Hive catalog.\n+\n+The following example query returns the total amount of data fetched from source\n+filesystem by all Presto nodes:\n \n .. code-block:: sql\n \n-  SELECT fs.readfromremote + async_downloaded_mb.count\n-  FROM jmx.current.\"rubix:catalog=hive,name=stats\" fs,\n-       jmx.current.\"metrics:name=rubix.bookkeeper.count.async_downloaded_mb\" async_downloaded_mb\n-  WHERE fs.node = async_downloaded_mb.node;\n+  SELECT sum(mb_read_from_source) FROM jmx.current.\"rubix:catalog=hive,name=stats\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTY2MzI4", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-469566328", "createdAt": "2020-08-18T15:24:06Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToyNDowN1rOHCZxxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToyNDowN1rOHCZxxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI4MTU0Mg==", "bodyText": "Remove \"If you are using JXM connector\" sins this is already said earlier.\nBasic caching statistics for the catalog are available in the ``jmx.current.\"rubix:catalog=<catalog_name>,name=stats\"`` table. The table ``jmx.current.\"rubix:catalog=<catalog_name>,name=stats`` contains more detailed statistics.\n\nUse the above for the whole paragraph.", "url": "https://github.com/trinodb/trino/pull/4869#discussion_r472281542", "createdAt": "2020-08-18T15:24:07Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/connector/hive-caching.rst", "diffHunk": "@@ -177,16 +177,16 @@ The implementation of the cache exposes a `number of metrics\n :doc:`inspect these and other metrics directly in Presto with the JMX connector\n or in external tools </admin/jmx>`.\n \n-The following example query returns the total amount of data fetched by the\n-BookKeeper on the coordinator and all the separate nodes on the workers in the\n-default async mode:\n+If you are using JMX connector, basic caching statistics are exposed via", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTcxOTkx", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-469571991", "createdAt": "2020-08-18T15:29:13Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToyOToxM1rOHCaBSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToyOToxM1rOHCaBSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI4NTUxNQ==", "bodyText": "The following example query returns the average cache hit ratio for the ``hive`` catalog:", "url": "https://github.com/trinodb/trino/pull/4869#discussion_r472285515", "createdAt": "2020-08-18T15:29:13Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/connector/hive-caching.rst", "diffHunk": "@@ -177,16 +177,16 @@ The implementation of the cache exposes a `number of metrics\n :doc:`inspect these and other metrics directly in Presto with the JMX connector\n or in external tools </admin/jmx>`.\n \n-The following example query returns the total amount of data fetched by the\n-BookKeeper on the coordinator and all the separate nodes on the workers in the\n-default async mode:\n+If you are using JMX connector, basic caching statistics are exposed via\n+``jmx.current.\"rubix:catalog=<catalog_name>,name=stats\"`` table.\n+You can read more detailed statistics by querying ``jmx.current.\"rubix:catalog=<catalog_name>,name=stats``.\n+You need to replace ``<catalog_name>`` with name of you Hive catalog.\n+\n+The following example query returns average cache hit ratio for given Hive catalog.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTczMTcz", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-469573173", "createdAt": "2020-08-18T15:30:26Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTozMDoyNlrOHCaEwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTozMDoyNlrOHCaEwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI4NjQwMQ==", "bodyText": "SELECT avg(cache_hit) \nFROM jmx.current.\"rubix:catalog=hive,name=stats\" \nWHERE NOT is_nan(cache_hit);", "url": "https://github.com/trinodb/trino/pull/4869#discussion_r472286401", "createdAt": "2020-08-18T15:30:26Z", "author": {"login": "mosabua"}, "path": "presto-docs/src/main/sphinx/connector/hive-caching.rst", "diffHunk": "@@ -177,16 +177,16 @@ The implementation of the cache exposes a `number of metrics\n :doc:`inspect these and other metrics directly in Presto with the JMX connector\n or in external tools </admin/jmx>`.\n \n-The following example query returns the total amount of data fetched by the\n-BookKeeper on the coordinator and all the separate nodes on the workers in the\n-default async mode:\n+If you are using JMX connector, basic caching statistics are exposed via\n+``jmx.current.\"rubix:catalog=<catalog_name>,name=stats\"`` table.\n+You can read more detailed statistics by querying ``jmx.current.\"rubix:catalog=<catalog_name>,name=stats``.\n+You need to replace ``<catalog_name>`` with name of you Hive catalog.\n+\n+The following example query returns average cache hit ratio for given Hive catalog.\n \n .. code-block:: sql\n \n-  SELECT fs.readfromremote + async_downloaded_mb.count\n-  FROM jmx.current.\"rubix:catalog=hive,name=stats\" fs,\n-       jmx.current.\"metrics:name=rubix.bookkeeper.count.async_downloaded_mb\" async_downloaded_mb\n-  WHERE fs.node = async_downloaded_mb.node;\n+  SELECT avg(cache_hit) FROM jmx.current.\"rubix:catalog=hive,name=stats\" where not is_nan(cache_hit);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTczNjkz", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-469573693", "createdAt": "2020-08-18T15:31:01Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "e25dfbdaf6a5b1a45b91083e6b6c74e078dff610", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/e25dfbdaf6a5b1a45b91083e6b6c74e078dff610", "committedDate": "2020-08-18T16:01:41Z", "message": "Update hive-caching documentation for Rubix 0.3.16"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "e25dfbdaf6a5b1a45b91083e6b6c74e078dff610", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/e25dfbdaf6a5b1a45b91083e6b6c74e078dff610", "committedDate": "2020-08-18T16:01:41Z", "message": "Update hive-caching documentation for Rubix 0.3.16"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxMDU3MTQ2", "url": "https://github.com/trinodb/trino/pull/4869#pullrequestreview-471057146", "createdAt": "2020-08-20T00:52:56Z", "commit": {"oid": "e25dfbdaf6a5b1a45b91083e6b6c74e078dff610"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4427, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}