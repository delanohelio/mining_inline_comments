{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNTU4NTg1", "number": 6219, "title": "Ensure query-created event is called before query-completed event", "bodyText": "", "createdAt": "2020-12-07T10:21:48Z", "url": "https://github.com/trinodb/trino/pull/6219", "merged": true, "mergeCommit": {"oid": "f88b1154dd806825688d2ba012d9f6d9cc1b2812"}, "closed": true, "closedAt": "2020-12-07T11:47:37Z", "author": {"login": "losipiuk"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjzLisgFqTU0NjAyNTYxMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdj0B2SABqjQwNzkxODk1OTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MDI1NjEw", "url": "https://github.com/trinodb/trino/pull/6219#pullrequestreview-546025610", "createdAt": "2020-12-07T10:42:21Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxMDo0MjoyMVrOIAghOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxMDo0MjoyMVrOIAghOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzQwMzcwNw==", "bodyText": "That's not exactly true, is it? Actually, i think before this PR, there seemed to be no possibility for out of order on create/complete events.\nI think the more important bit is that this must be here so that query-created is fired before analysis, which may invoke plugins.", "url": "https://github.com/trinodb/trino/pull/6219#discussion_r537403707", "createdAt": "2020-12-07T10:42:21Z", "author": {"login": "findepi"}, "path": "presto-main/src/main/java/io/prestosql/dispatcher/LocalDispatchQueryFactory.java", "diffHunk": "@@ -109,6 +110,14 @@ public DispatchQuery createDispatchQuery(\n                 warningCollector,\n                 StatementUtils.getQueryType(preparedQuery.getStatement().getClass()));\n \n+        // It is important that `queryCreatedEvent` is called here. Moving it past the `executor.submit` below\n+        // can result in delivering query-completed event before query-created event.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MDY2OTcx", "url": "https://github.com/trinodb/trino/pull/6219#pullrequestreview-546066971", "createdAt": "2020-12-07T11:38:48Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81105c0afcd42c58569a6b69beb3d2c8faa7ee1f", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/81105c0afcd42c58569a6b69beb3d2c8faa7ee1f", "committedDate": "2020-12-07T11:41:30Z", "message": "Ensure query-created event is called before query-completed event"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "81105c0afcd42c58569a6b69beb3d2c8faa7ee1f", "author": {"user": {"login": "losipiuk", "name": "\u0141ukasz Osipiuk"}}, "url": "https://github.com/trinodb/trino/commit/81105c0afcd42c58569a6b69beb3d2c8faa7ee1f", "committedDate": "2020-12-07T11:41:30Z", "message": "Ensure query-created event is called before query-completed event"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2065, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}