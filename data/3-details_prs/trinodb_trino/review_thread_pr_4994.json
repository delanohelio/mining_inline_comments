{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MzY4Mzgy", "number": 4994, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMjowMDoyNFrOEdZyqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwOToyNzoxNFrOEeOyBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MjY2NzI4OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/operator/PagesIndex.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMjowMDoyNFrOHIivdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzo0MjozMVrOHJPMMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcxOTg2MA==", "bodyText": "Seems like a shame to add this memory overhead in all cases when in practice it's only necessary for empty channels. Maybe we only use this when channels.length == 0? It'll definitely make the code uglier but it seems maybe worthwhile to avoid the extra memory penalty when it can be avoided.", "url": "https://github.com/trinodb/trino/pull/4994#discussion_r478719860", "createdAt": "2020-08-27T22:00:24Z", "author": {"login": "pettyjamesm"}, "path": "presto-main/src/main/java/io/prestosql/operator/PagesIndex.java", "diffHunk": "@@ -84,8 +85,10 @@\n     private final List<Type> types;\n     private final LongArrayList valueAddresses;\n     private final ObjectArrayList<Block>[] channels;\n+    private final IntArrayList positionCounts;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ0ODExMw==", "bodyText": "I know, but it shouldn't be much overhead -- roughly an int per page.", "url": "https://github.com/trinodb/trino/pull/4994#discussion_r479448113", "createdAt": "2020-08-28T17:42:31Z", "author": {"login": "martint"}, "path": "presto-main/src/main/java/io/prestosql/operator/PagesIndex.java", "diffHunk": "@@ -84,8 +85,10 @@\n     private final List<Type> types;\n     private final LongArrayList valueAddresses;\n     private final ObjectArrayList<Block>[] channels;\n+    private final IntArrayList positionCounts;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcxOTg2MA=="}, "originalCommit": null, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMTM0OTE4OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/io/prestosql/operator/PagesIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwOToyNzoxNFrOHJxTTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwOToyNzoxNFrOHJxTTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDAwNjk4OA==", "bodyText": "please update io.prestosql.operator.PagesIndex#calculateEstimatedSize method too", "url": "https://github.com/trinodb/trino/pull/4994#discussion_r480006988", "createdAt": "2020-08-31T09:27:14Z", "author": {"login": "sopel39"}, "path": "presto-main/src/main/java/io/prestosql/operator/PagesIndex.java", "diffHunk": "@@ -112,6 +115,8 @@ private PagesIndex(\n             channels[i] = ObjectArrayList.wrap(new Block[1024], 0);\n         }\n \n+        positionCounts = new IntArrayList(1024);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3340, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}