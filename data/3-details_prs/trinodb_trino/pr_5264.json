{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwOTQzOTQ1", "number": 5264, "title": "Test LIMIT pushdown", "bodyText": "", "createdAt": "2020-09-22T13:33:39Z", "url": "https://github.com/trinodb/trino/pull/5264", "merged": true, "mergeCommit": {"oid": "dd07777fc73c5ddab23a5af337bd3e1a1d30229b"}, "closed": true, "closedAt": "2020-09-23T13:33:19Z", "author": {"login": "findepi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLYFOjAFqTQ5MzQ2Mzk1NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLrRGiABqjM3OTc3MDMxNTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNDYzOTU0", "url": "https://github.com/trinodb/trino/pull/5264#pullrequestreview-493463954", "createdAt": "2020-09-22T13:33:49Z", "commit": {"oid": "aad2e55bfc95d6769303709b4276702e3dd857ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzozMzo0OVrOHV6RqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzozMzo0OVrOHV6RqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjczNjkzNg==", "bodyText": "#5263", "url": "https://github.com/trinodb/trino/pull/5264#discussion_r492736936", "createdAt": "2020-09-22T13:33:49Z", "author": {"login": "findepi"}, "path": "presto-memsql/src/test/java/io/prestosql/plugin/memsql/TestMemSqlIntegrationSmokeTest.java", "diffHunk": "@@ -181,6 +182,19 @@ public void testInsertIntoNotNullColumn()\n         assertUpdate(\"DROP TABLE test_insert_not_null\");\n     }\n \n+    @Test\n+    public void testLimitPushdown()\n+    {\n+        assertThat(query(\"SELECT name FROM nation LIMIT 30\")).isCorrectlyPushedDown(); // Use high limit for result determinism\n+\n+        // with filter over numeric column\n+        assertThat(query(\"SELECT name FROM nation WHERE regionkey = 3 LIMIT 5\")).isCorrectlyPushedDown();\n+\n+        // with filter over varchar column\n+        // TODO (https://github.com/prestosql/presto/issues/5263) should be `.isNotFullyPushedDown(FilterNode.class)`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aad2e55bfc95d6769303709b4276702e3dd857ab"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0MzUwMTY0", "url": "https://github.com/trinodb/trino/pull/5264#pullrequestreview-494350164", "createdAt": "2020-09-23T07:29:07Z", "commit": {"oid": "aad2e55bfc95d6769303709b4276702e3dd857ab"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzoyOTowOFrOHWaCcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QwNzoyOTowOFrOHWaCcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1NzMyOA==", "bodyText": "what about aggregation and project? We have at the moment 4 variables (predicate, limit, projection and aggregation).\nHaving dedicated tests per each pushdown gives 4 tests, for pairs another 12 tests, for triples another test 4 tests, and for all cases at once another 1 tests. 21 in total.\nWhat are your thoughts to tackle that?", "url": "https://github.com/trinodb/trino/pull/5264#discussion_r493257328", "createdAt": "2020-09-23T07:29:08Z", "author": {"login": "kokosing"}, "path": "presto-druid/src/test/java/io/prestosql/plugin/druid/TestDruidIntegrationSmokeTest.java", "diffHunk": "@@ -272,4 +272,17 @@ public void testFilteringForTablesAndColumns()\n         actualColumns = computeActual(\"DESCRIBE \" + datasourceB);\n         Assert.assertEquals(actualColumns, expectedColumns);\n     }\n+\n+    @Test\n+    public void testLimitPushdown()\n+    {\n+        assertThat(query(\"SELECT name FROM nation LIMIT 30\")).isCorrectlyPushedDown(); // Use high limit for result determinism\n+\n+        // with filter over numeric column\n+        assertThat(query(\"SELECT name FROM nation WHERE regionkey = 3 LIMIT 5\")).isCorrectlyPushedDown();\n+\n+        // with filter over varchar column\n+        assertThat(query(\"SELECT name FROM nation WHERE name < 'EEE' LIMIT 5\")).isCorrectlyPushedDown();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aad2e55bfc95d6769303709b4276702e3dd857ab"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06b742c5dd075b8910aa8879a3e1edb216d84b7c", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/06b742c5dd075b8910aa8879a3e1edb216d84b7c", "committedDate": "2020-09-23T10:59:11Z", "message": "Fix test method name typo"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "84b0545b586718cf4e1c0cc66338db0a37b45f18", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/84b0545b586718cf4e1c0cc66338db0a37b45f18", "committedDate": "2020-09-22T15:32:01Z", "message": "Fix test method name typo"}, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTQ4ODI1", "url": "https://github.com/trinodb/trino/pull/5264#pullrequestreview-494548825", "createdAt": "2020-09-23T11:13:36Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMToxMzozNlrOHWmn4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMToxMzozNlrOHWmn4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ2MzUyMA==", "bodyText": "why not to add basic test case to io.prestosql.plugin.jdbc.TestJdbcIntegrationSmokeTest?", "url": "https://github.com/trinodb/trino/pull/5264#discussion_r493463520", "createdAt": "2020-09-23T11:13:36Z", "author": {"login": "sopel39"}, "path": "presto-druid/src/test/java/io/prestosql/plugin/druid/TestDruidIntegrationSmokeTest.java", "diffHunk": "@@ -272,4 +272,17 @@ public void testFilteringForTablesAndColumns()\n         actualColumns = computeActual(\"DESCRIBE \" + datasourceB);\n         Assert.assertEquals(actualColumns, expectedColumns);\n     }\n+\n+    @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTcwMDg1", "url": "https://github.com/trinodb/trino/pull/5264#pullrequestreview-494570085", "createdAt": "2020-09-23T11:44:46Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f79fe7d42f64e7e9c41a24efad48942f26a80617", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/f79fe7d42f64e7e9c41a24efad48942f26a80617", "committedDate": "2020-09-23T11:52:59Z", "message": "Test LIMIT pushdown"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "f79fe7d42f64e7e9c41a24efad48942f26a80617", "author": {"user": {"login": "findepi", "name": "Piotr Findeisen"}}, "url": "https://github.com/trinodb/trino/commit/f79fe7d42f64e7e9c41a24efad48942f26a80617", "committedDate": "2020-09-23T11:52:59Z", "message": "Test LIMIT pushdown"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3733, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}