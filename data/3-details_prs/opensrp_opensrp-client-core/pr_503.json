{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5OTQ5MTI4", "number": 503, "title": "Add FormSubmissionService tests", "bodyText": "", "createdAt": "2020-04-28T07:59:21Z", "url": "https://github.com/opensrp/opensrp-client-core/pull/503", "merged": true, "mergeCommit": {"oid": "142e8661353e3f32f1d389defed139e0de327a8d"}, "closed": true, "closedAt": "2020-04-28T12:42:50Z", "author": {"login": "Rkareko"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb_KmVAH2gAyNDA5OTQ5MTI4OjIxMTE4ODAwM2Q2ZDE3OTVmYjc2YzBmMTMxNTRhYjdiN2IxMjc0NzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccDBp2gH2gAyNDA5OTQ5MTI4OmFlNDZkOTFjOWNkODEyZGNhODM0YmNlZDE2ODg5YmZjMGYyNmEwNjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "211188003d6d1795fb76c0f13154ab7b7b127476", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/211188003d6d1795fb76c0f13154ab7b7b127476", "committedDate": "2020-04-28T07:57:38Z", "message": "Added new FormSubmissionService tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "645ea07ddcd1be53b9ce0c87aeba8a01d45f9f44", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/645ea07ddcd1be53b9ce0c87aeba8a01d45f9f44", "committedDate": "2020-04-28T08:03:44Z", "message": "Use explicit scoping for variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78cea7a66e9caa64552b876feaa5c13051bf15f4", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/78cea7a66e9caa64552b876feaa5c13051bf15f4", "committedDate": "2020-04-28T08:37:04Z", "message": "Added update FTS search test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d02779e6c92e79cbac027f02906209ba8a61c343", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/d02779e6c92e79cbac027f02906209ba8a61c343", "committedDate": "2020-04-28T08:47:59Z", "message": "Test updateFTSSearch for field with inner bind type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzU4Mzcx", "url": "https://github.com/opensrp/opensrp-client-core/pull/503#pullrequestreview-401758371", "createdAt": "2020-04-28T11:52:11Z", "commit": {"oid": "d02779e6c92e79cbac027f02906209ba8a61c343"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMTo1MjoxMVrOGNQQDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMTo1MjoxMVrOGNQQDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU1MDkyNg==", "bodyText": "Verify that false is returned & remove the unnecessary mocking on line 143", "url": "https://github.com/opensrp/opensrp-client-core/pull/503#discussion_r416550926", "createdAt": "2020-04-28T11:52:11Z", "author": {"login": "ekigamba"}, "path": "opensrp-app/src/test/java/org/smartregister/service/FormSubmissionServiceTest.java", "diffHunk": "@@ -96,4 +114,71 @@ public void shouldNotDelegateProcessingToZiggyServiceForProcessedSubmissions() t\n         inOrder.verify(formDataRepository).updateServerVersion(\"instance id 2\", \"1\");\n         inOrder.verify(allSettings).savePreviousFormSyncIndex(\"1\");\n     }\n+\n+    @Test\n+    public void testConstructor() {\n+        service = null;\n+        assertNull(service);\n+        service = new FormSubmissionService(ziggyService, formDataRepository, allSettings, allCommonsRepositoryMap);\n+        assertNotNull(service);\n+        assertNotNull(Whitebox.getInternalState(service, \"ziggyService\"));\n+        assertNotNull(Whitebox.getInternalState(service, \"formDataRepository\"));\n+        assertNotNull(Whitebox.getInternalState(service, \"allSettings\"));\n+        assertNotNull(Whitebox.getInternalState(service, \"allCommonsRepositoryMap\"));\n+\n+    }\n+\n+    @Test\n+    public void testPrivateUpdateFTSSearch() throws Exception {\n+        service = new FormSubmissionService(ziggyService, formDataRepository, allSettings, allCommonsRepositoryMap);\n+        when(allCommonsRepositoryMap.isEmpty()).thenReturn(false);\n+        when(allCommonsRepositoryMap.get(\"bindtype_1\")).thenReturn(allCommonsRepository);\n+        Whitebox.invokeMethod(service, \"updateFTSsearch\", \"bindtype_1\", \"entity_1\");\n+        verify(allCommonsRepository).updateSearch(\"entity_1\");\n+    }\n+\n+    @Test\n+    public void testPrivateUpdateFTSSearchWithEmptyAllC0mmonsrepositoryMap() throws Exception {\n+        when(allCommonsRepositoryMap.isEmpty()).thenReturn(true);\n+        when(allCommonsRepositoryMap.get(\"bindtype_1\")).thenReturn(allCommonsRepository);\n+        Whitebox.invokeMethod(service, \"updateFTSsearch\", \"bindtype_1\", \"entity_1\");\n+        verify(allCommonsRepository, times(0)).updateSearch(\"entity_1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02779e6c92e79cbac027f02906209ba8a61c343"}, "originalPosition": 84}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "496c6083c0cb8776027c1d022eef7b35754a5eb3", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/496c6083c0cb8776027c1d022eef7b35754a5eb3", "committedDate": "2020-04-28T12:14:18Z", "message": "Update unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21c52ee39af222e169ffe6efa31941194140d48a", "author": {"user": {"login": "Rkareko", "name": null}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/21c52ee39af222e169ffe6efa31941194140d48a", "committedDate": "2020-04-28T12:17:54Z", "message": "Merge branch 'master' into rkareko-tt-11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzgyNzE5", "url": "https://github.com/opensrp/opensrp-client-core/pull/503#pullrequestreview-401782719", "createdAt": "2020-04-28T12:27:10Z", "commit": {"oid": "21c52ee39af222e169ffe6efa31941194140d48a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae46d91c9cd812dca834bced16889bfc0f26a069", "author": {"user": {"login": "ekigamba", "name": "Ephraim Kigamba"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/ae46d91c9cd812dca834bced16889bfc0f26a069", "committedDate": "2020-04-28T12:27:29Z", "message": "Merge branch 'master' into rkareko-tt-11"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2552, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}