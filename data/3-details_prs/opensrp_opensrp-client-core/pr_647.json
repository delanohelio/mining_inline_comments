{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMTQ1NzE2", "number": 647, "title": "Track user assignments and update if they change, sync jurisdictions by Id", "bodyText": "Resolves #640", "createdAt": "2020-09-21T08:58:20Z", "url": "https://github.com/opensrp/opensrp-client-core/pull/647", "merged": true, "mergeCommit": {"oid": "c295cadfa8cebd699b8411de04b4744b9bb71a08"}, "closed": true, "closedAt": "2020-09-25T09:08:41Z", "author": {"login": "githengi"}, "timelineItems": {"totalCount": 47, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLsnpmABqjM3OTgxMjUyNzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMR4rMgFqTQ5NjIzNDAwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2815470716b9a251099d9c00be7df22bf50ff68", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b2815470716b9a251099d9c00be7df22bf50ff68", "committedDate": "2020-09-21T16:08:22Z", "message": "Remove parent  from hierarchy if only child is removed"}, "afterCommit": {"oid": "63fa94041f2decab43402f78bb32cdec54059b27", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/63fa94041f2decab43402f78bb32cdec54059b27", "committedDate": "2020-09-23T13:28:42Z", "message": "Remove parent  from hierarchy if only child is removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0615b57ba78c4ca90dbb3fd8710d4e73a86ca32", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/f0615b57ba78c4ca90dbb3fd8710d4e73a86ca32", "committedDate": "2020-09-24T06:41:14Z", "message": "Save assigned jurisdiction Ids during login"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a938a9f9599d873c3759b5e080b3eb158fa1d78", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/0a938a9f9599d873c3759b5e080b3eb158fa1d78", "committedDate": "2020-09-24T06:41:14Z", "message": "Remove unsed code used when reveal was using OpenMRS team management"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ff2774cadfd4f4375efcbb154d8f08c91ffd992", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/7ff2774cadfd4f4375efcbb154d8f08c91ffd992", "committedDate": "2020-09-24T06:41:14Z", "message": "Send jurisdiction Ids when synching locations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cca0278806636eeb7653dda78a6ef20c90327ec", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3cca0278806636eeb7653dda78a6ef20c90327ec", "committedDate": "2020-09-24T06:41:14Z", "message": "Validate user assignments after sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aa98aa11b0408063385e05dbe40e846cffbd9d6", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/7aa98aa11b0408063385e05dbe40e846cffbd9d6", "committedDate": "2020-09-24T06:41:14Z", "message": "Validate user assignments only if keycloak is configured"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b801d297a337b986ef61425f64ead1f4730785cb", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b801d297a337b986ef61425f64ead1f4730785cb", "committedDate": "2020-09-24T06:41:14Z", "message": "Support retrieving boolean preferences"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc2faf9c2f7ead5d9e4982552e7a32969c245c11", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/fc2faf9c2f7ead5d9e4982552e7a32969c245c11", "committedDate": "2020-09-24T06:41:14Z", "message": "Set locationIds if they exist"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "731f285637f81214d4bb5e1b5a90d6f96c5b1ed7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/731f285637f81214d4bb5e1b5a90d6f96c5b1ed7", "committedDate": "2020-09-24T06:41:15Z", "message": "delete locations and plans that a user no longer has access to"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5a8f5cb68878cbeeccb2ba211c45bbc2315f7bd", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b5a8f5cb68878cbeeccb2ba211c45bbc2315f7bd", "committedDate": "2020-09-24T06:41:15Z", "message": "Remove locations from location tree"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0726380808c0521a4ceac354ca0cf45cdb407b75", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/0726380808c0521a4ceac354ca0cf45cdb407b75", "committedDate": "2020-09-24T06:41:15Z", "message": "remove jurisdictions that use no longer has access on preferences"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b5c7aa7103451f94476bef0e6e3fc0281510af5", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3b5c7aa7103451f94476bef0e6e3fc0281510af5", "committedDate": "2020-09-24T06:41:15Z", "message": "Unit test remove locations from hiearchy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "626281b57cbe113a4051502e1c6ffd2f9c3cd490", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/626281b57cbe113a4051502e1c6ffd2f9c3cd490", "committedDate": "2020-09-24T06:41:15Z", "message": "Unit test removing locations are removed from the location hierachy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "750799aac50d8afc83664f9789408bcbaf5a2176", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/750799aac50d8afc83664f9789408bcbaf5a2176", "committedDate": "2020-09-24T06:41:15Z", "message": "Correct logic of removing locations from lcation tree"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c0b8bb172d877ebd473ceab1e6798401e58bb7f", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/9c0b8bb172d877ebd473ceab1e6798401e58bb7f", "committedDate": "2020-09-24T06:41:15Z", "message": "broadcast removed assignments if new assignments have not been added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a988626e435c1c21d77e342c1d6b411ccb0f0a9", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/4a988626e435c1c21d77e342c1d6b411ccb0f0a9", "committedDate": "2020-09-24T06:41:15Z", "message": "Evict location heirarchy cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a94f9e70faa88ee0f8a08ea75d5dc727756794d5", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/a94f9e70faa88ee0f8a08ea75d5dc727756794d5", "committedDate": "2020-09-24T06:41:15Z", "message": "Logoff if user default location is revoked"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49a2fad11263769fb0e0844b56d21febf738d34d", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/49a2fad11263769fb0e0844b56d21febf738d34d", "committedDate": "2020-09-24T06:41:16Z", "message": "reset sync when new assignments are assigned"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b096e71a388d5168b904c1b6a38d4ad756d09325", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b096e71a388d5168b904c1b6a38d4ad756d09325", "committedDate": "2020-09-24T06:41:46Z", "message": "bump up version as per semver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f1ca58f4ec5cb8e84cc68ae04d5e139e2e2fdac", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/0f1ca58f4ec5cb8e84cc68ae04d5e139e2e2fdac", "committedDate": "2020-09-24T06:41:46Z", "message": "Add a receiver for removed assignments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3cb7d471f670c14302a6680a09eccc1d2dd2316", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/c3cb7d471f670c14302a6680a09eccc1d2dd2316", "committedDate": "2020-09-24T06:41:46Z", "message": "Broadcast receiver allow registration of multiple listeners"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be619bbae79a11731e87acabeb1cfdfbdb880590", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/be619bbae79a11731e87acabeb1cfdfbdb880590", "committedDate": "2020-09-24T06:41:46Z", "message": "Add a unit testing if location is removed and parent is without children then parent is also removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e506fa328b677cacf0f7e19d0d593d49c0431e1", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3e506fa328b677cacf0f7e19d0d593d49c0431e1", "committedDate": "2020-09-24T06:41:46Z", "message": "Remove parent  from hierarchy if only child is removed"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "63fa94041f2decab43402f78bb32cdec54059b27", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/63fa94041f2decab43402f78bb32cdec54059b27", "committedDate": "2020-09-23T13:28:42Z", "message": "Remove parent  from hierarchy if only child is removed"}, "afterCommit": {"oid": "3e506fa328b677cacf0f7e19d0d593d49c0431e1", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3e506fa328b677cacf0f7e19d0d593d49c0431e1", "committedDate": "2020-09-24T06:41:46Z", "message": "Remove parent  from hierarchy if only child is removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e509426bd9b709a981c1bd9561022082833971a", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/6e509426bd9b709a981c1bd9561022082833971a", "committedDate": "2020-09-24T06:48:36Z", "message": "Remove unsed fields and optimize imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2021623f992d6f2c0d83ad01c700377514d5a52", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/d2021623f992d6f2c0d83ad01c700377514d5a52", "committedDate": "2020-09-24T07:01:39Z", "message": "Assert location cache is evicted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cad29ed71cd7e0e9d8a06cedacd42866b180e0b9", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/cad29ed71cd7e0e9d8a06cedacd42866b180e0b9", "committedDate": "2020-09-24T08:31:26Z", "message": "Add unit tests for new assignments and removed assignments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b4e0bb5026c8a1d3996712076625d915e9e8d9d", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/4b4e0bb5026c8a1d3996712076625d915e9e8d9d", "committedDate": "2020-09-24T10:43:00Z", "message": "Remove internal try catch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e316c141806f635f3ff45397bd01a0edeb4ef79", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/7e316c141806f635f3ff45397bd01a0edeb4ef79", "committedDate": "2020-09-24T10:50:26Z", "message": "unit test removing default location user is logged off"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a991faec653530f1a7ac95afcd0d8fa8409e595", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3a991faec653530f1a7ac95afcd0d8fa8409e595", "committedDate": "2020-09-24T13:34:29Z", "message": "Add receiver Unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "246538cf580ed6aead266b479d135f1b4c310789", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/246538cf580ed6aead266b479d135f1b4c310789", "committedDate": "2020-09-24T13:44:37Z", "message": "Add unit tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30df7336307f97d0ec119598a5983ea57130f4f3", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/30df7336307f97d0ec119598a5983ea57130f4f3", "committedDate": "2020-09-24T13:25:22Z", "message": "Add validator Unit tests"}, "afterCommit": {"oid": "246538cf580ed6aead266b479d135f1b4c310789", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/246538cf580ed6aead266b479d135f1b4c310789", "committedDate": "2020-09-24T13:44:37Z", "message": "Add unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3235f0fb0bf74af483411cd626c3352d5b1034c7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/3235f0fb0bf74af483411cd626c3352d5b1034c7", "committedDate": "2020-09-24T14:13:15Z", "message": "add teardown method and correct injecting mocks syntax"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7e98bf511eb1038cf050a0fe9efd9a59984b60f", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/c7e98bf511eb1038cf050a0fe9efd9a59984b60f", "committedDate": "2020-09-24T14:44:57Z", "message": "unit test get assignment throws error if null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47439c3205640f7c136f7cd923a90a650148f1ea", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/47439c3205640f7c136f7cd923a90a650148f1ea", "committedDate": "2020-09-24T15:42:50Z", "message": "Return boolean if validation succeeded"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "589cf986d2038acc645faf8e6e4ddb5df4211970", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/589cf986d2038acc645faf8e6e4ddb5df4211970", "committedDate": "2020-09-24T15:11:03Z", "message": "Return boolean if validation succeeded"}, "afterCommit": {"oid": "47439c3205640f7c136f7cd923a90a650148f1ea", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/47439c3205640f7c136f7cd923a90a650148f1ea", "committedDate": "2020-09-24T15:42:50Z", "message": "Return boolean if validation succeeded"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ceadbe31394e6f3231d3f9211c9b5bcfeac259a9", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/ceadbe31394e6f3231d3f9211c9b5bcfeac259a9", "committedDate": "2020-09-24T15:57:15Z", "message": "stub getFormattedBaseUrl"}, "afterCommit": {"oid": "b85c79371ac15f09654d533ad3ded702130662f7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b85c79371ac15f09654d533ad3ded702130662f7", "committedDate": "2020-09-24T16:16:23Z", "message": "stub getFormattedBaseUrl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6", "committedDate": "2020-09-24T16:30:20Z", "message": "stub getFormattedBaseUrl"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b85c79371ac15f09654d533ad3ded702130662f7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/b85c79371ac15f09654d533ad3ded702130662f7", "committedDate": "2020-09-24T16:16:23Z", "message": "stub getFormattedBaseUrl"}, "afterCommit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6", "committedDate": "2020-09-24T16:30:20Z", "message": "stub getFormattedBaseUrl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTk5NDA1", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#pullrequestreview-496199405", "createdAt": "2020-09-25T08:07:12Z", "commit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODowNzoxMlrOHX5X4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODowNzoxMlrOHX5X4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDgxOTI5Ng==", "bodyText": "Could we make this location_ids a constant", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#discussion_r494819296", "createdAt": "2020-09-25T08:07:12Z", "author": {"login": "Rkareko"}, "path": "opensrp-app/src/main/java/org/smartregister/sync/helper/LocationServiceHelper.java", "diffHunk": "@@ -161,6 +162,11 @@ private String fetchLocationsOrStructures(boolean isJurisdiction, Long serverVer\n         if (isJurisdiction) {\n             String preferenceLocationNames = allSharedPreferences.getPreference(OPERATIONAL_AREAS);\n             request.put(\"location_names\", new JSONArray(Arrays.asList(preferenceLocationNames.split(\",\"))));\n+\n+            String preferenceLocationIds = allSharedPreferences.getPreference(JURISDICTION_IDS);\n+            if (StringUtils.isNotBlank(preferenceLocationIds)) {\n+                request.put(\"location_ids\", new JSONArray(Arrays.asList(preferenceLocationIds.split(\",\"))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTgxODIw", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#pullrequestreview-496181820", "createdAt": "2020-09-25T07:41:35Z", "commit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNzo0MTozNVrOHX4jbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwODowMTozNVrOHX5Mjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDgwNTg3MQ==", "bodyText": "I think the parent might be null\nThis is a question. I see that we delete  the parent also if the node id was it's only child. I am not sure why that is?", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#discussion_r494805871", "createdAt": "2020-09-25T07:41:35Z", "author": {"login": "ekigamba"}, "path": "opensrp-app/src/main/java/org/smartregister/domain/jsonmapping/util/Tree.java", "diffHunk": "@@ -112,6 +112,23 @@ public void addNode(K id, String label, T node, K parentId) {\n         return null;\n     }\n \n+    /**\n+     * Delete nodes from location hierarchy\n+     *\n+     * @param id the id of the node to remove\n+     */\n+    public void deleteNode(K id) {\n+        TreeNode<K, T> node = getNode(id);\n+        removeNode(id);\n+        parentChildren.remove(id);\n+        LinkedHashSet<K> parent = parentChildren.get(node.getParent());\n+        if (parent != null && parent.size() == 1) {\n+            deleteNode(node.getParent());\n+        } else {\n+            parent.remove(id);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDgxNjM5OA==", "bodyText": "Nice catch", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#discussion_r494816398", "createdAt": "2020-09-25T08:01:35Z", "author": {"login": "ekigamba"}, "path": "opensrp-app/src/main/java/org/smartregister/receiver/ValidateAssignmentReceiver.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package org.smartregister.receiver;\n+\n+import android.content.BroadcastReceiver;\n+import android.content.Context;\n+import android.content.Intent;\n+import android.content.IntentFilter;\n+import android.os.Bundle;\n+\n+import org.smartregister.dto.UserAssignmentDTO;\n+import org.smartregister.sync.helper.ValidateAssignmentHelper;\n+\n+import java.io.Serializable;\n+import java.util.LinkedHashSet;\n+import java.util.Set;\n+\n+import timber.log.Timber;\n+\n+/**\n+ * Created by samuelgithengi on 9/21/20.\n+ */\n+public class ValidateAssignmentReceiver extends BroadcastReceiver {\n+\n+    private static ValidateAssignmentReceiver instance;\n+\n+    private Set<UserAssignmentListener> userAssignmentListeners;\n+\n+    public static void init(Context context) {\n+        if (instance != null) {\n+            destroy(context);\n+        }\n+        instance = new ValidateAssignmentReceiver();\n+        context.registerReceiver(instance,\n+                new IntentFilter(ValidateAssignmentHelper.ACTION_ASSIGNMENT_REMOVED));\n+    }\n+\n+    public static void destroy(Context context) {\n+        try {\n+            if (instance != null) {\n+                context.unregisterReceiver(instance);\n+                instance = null;\n+            }\n+        } catch (IllegalArgumentException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b89e5a05d1c79e4cbf83ac61163bc9ece2469e6"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "748791288fdccdf851a5cda51889bd7868c186ee", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/748791288fdccdf851a5cda51889bd7868c186ee", "committedDate": "2020-09-25T08:42:25Z", "message": "PR requested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MjI3MDU4", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#pullrequestreview-496227058", "createdAt": "2020-09-25T08:45:16Z", "commit": {"oid": "748791288fdccdf851a5cda51889bd7868c186ee"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a076c612f65100419e85fb6237efac2bd93e4ee7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/a076c612f65100419e85fb6237efac2bd93e4ee7", "committedDate": "2020-09-25T08:53:39Z", "message": "clean up"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "adf5a698ce066ef47ccb5196cd0b6748b7b58fec", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/adf5a698ce066ef47ccb5196cd0b6748b7b58fec", "committedDate": "2020-09-25T08:49:37Z", "message": "clean up"}, "afterCommit": {"oid": "a076c612f65100419e85fb6237efac2bd93e4ee7", "author": {"user": {"login": "githengi", "name": "Samuel Githengi"}}, "url": "https://github.com/opensrp/opensrp-client-core/commit/a076c612f65100419e85fb6237efac2bd93e4ee7", "committedDate": "2020-09-25T08:53:39Z", "message": "clean up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MjMzNTQ4", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#pullrequestreview-496233548", "createdAt": "2020-09-25T08:54:02Z", "commit": {"oid": "a076c612f65100419e85fb6237efac2bd93e4ee7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MjM0MDAw", "url": "https://github.com/opensrp/opensrp-client-core/pull/647#pullrequestreview-496234000", "createdAt": "2020-09-25T08:54:37Z", "commit": {"oid": "a076c612f65100419e85fb6237efac2bd93e4ee7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2490, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}