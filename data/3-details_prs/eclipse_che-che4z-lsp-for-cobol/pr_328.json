{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyOTA3MDAz", "number": 328, "title": "fix: POC - Resolve local URI", "bodyText": "Fix: The following implementation represent the translation of user's resource paths provided in the setting json to identify copybooks available for the analysis.\nClose #327\nThe resolve() API provided by the LocalCopybookResolver class allows to generate an URI list that removes:\n\nduplicated items\nany resource defined with * (i.e. /path/*)\ninvalid definition of resource (i.e. /path%folder/%subfolder)\n\nMoreover address path problems so that is possible define path using / or \\. Based on the OS the right path representation will be applied.\nFor POC purpose a command is made available (Resolve local Copybooks) that publish in a notification message the resolved URI of a resource defined in the setting.json\nThe command will be removed afterwards .\nNote\nVisual Studio Code and Che have different value for the workspaceFolder.\nI.E. if the folder used for test is called folder/subFolder/... the path to define in setting should be:\n\nsubfolder/.../cpyFile in VSC\nfolder/subfolder/.../cpyFile in Che\n\nNote-2\nThe current implementation define a setting configuration as shown below:\n \"broadcom-cobol-lsp.cpy-manager.paths.dsn\": [\n      \"HLQ.DSNAME1.COPY\"\n ],\n \"broadcom-cobol-lsp.cpy-manager.paths.local\": [\n      \"PHYSICAL PATH\"\n ]\nBut in Theia this structure by default is organize in this way:\n\"broadcom-cobol-lsp.cpy-manager.paths\": {\n    \"dsn\": [],\n    \"local\": []\n}\nAnd this representation brake our implementation and the support with autocomplete in the settings we used before. So my recommendation is to delete the predefined structure and fulfill the content using the autocomplete. A separate issue or a modification of the current implementation of this PR will be evaluated and I will update this thread ASAP.", "createdAt": "2020-05-04T11:57:25Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328", "merged": true, "mergeCommit": {"oid": "f4add7629a10cf0008a9674cf0f679cc701d4db8"}, "closed": true, "closedAt": "2020-05-11T13:48:02Z", "author": {"login": "zacanbrcom"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYKuV6AH2gAyNDEyOTA3MDAzOjY4MWNiNTA2ODFmZjAzYjg2MDI3MWJhNGE1YjFmZjAwMjcyNTYxNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgOnIIAFqTQwOTExNDIxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "681cb50681ff03b860271ba4a5b1ff0027256163", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/681cb50681ff03b860271ba4a5b1ff0027256163", "committedDate": "2020-04-16T11:09:56Z", "message": "Add test to parse json like settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6eeed9f91c19a641aa5a7a205a0009fa0f3af9a8", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/6eeed9f91c19a641aa5a7a205a0009fa0f3af9a8", "committedDate": "2020-04-20T11:15:33Z", "message": "Add test related to path validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7206ef3c6ecf1a70c7458486e90120e4056cc774", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7206ef3c6ecf1a70c7458486e90120e4056cc774", "committedDate": "2020-04-20T12:10:31Z", "message": "Refactor function to parse paths and exclude not valid URIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068c2c9a785c1bae55f26a66f7d54f01d4d10b9e", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/068c2c9a785c1bae55f26a66f7d54f01d4d10b9e", "committedDate": "2020-04-21T08:02:35Z", "message": "Introduce URI validation in the Local Copybook Resolver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4688e53c164c91308bc29ec131cca37ab004797d", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4688e53c164c91308bc29ec131cca37ab004797d", "committedDate": "2020-04-21T08:28:32Z", "message": "Apply better name for class and test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ee56be9ef044e78f42e2c80198b03a7af9fa270", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7ee56be9ef044e78f42e2c80198b03a7af9fa270", "committedDate": "2020-04-21T08:59:54Z", "message": "Add unit test to avoid duplicates in URI list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2a1ce36adf28b25a40ad2f2dc8553cbabe3fd3a", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c2a1ce36adf28b25a40ad2f2dc8553cbabe3fd3a", "committedDate": "2020-04-21T09:21:16Z", "message": "Polish test suite and minor changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b46aa04acefd5dd2aa9dc83e7aeac2942e10d00", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/5b46aa04acefd5dd2aa9dc83e7aeac2942e10d00", "committedDate": "2020-04-24T08:02:44Z", "message": "Minor changes on API naming and documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1e5c3b92494e4fd03523fd72df69f16d7f838e2", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a1e5c3b92494e4fd03523fd72df69f16d7f838e2", "committedDate": "2020-04-27T07:14:29Z", "message": "Minor changes on API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10088e5f4922c92c3d4bfa34f62da68451931f7e", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/10088e5f4922c92c3d4bfa34f62da68451931f7e", "committedDate": "2020-04-27T07:46:10Z", "message": "Fix setting key property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99749de70dcdc75e16bb60885d11a4b7c607e3e3", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/99749de70dcdc75e16bb60885d11a4b7c607e3e3", "committedDate": "2020-04-27T07:48:16Z", "message": "Merge remote-tracking branch 'remotes/origin/development' into POC_LocalURISetting\n\n# Conflicts:\n#\tclients/cobol-lsp-vscode-extension/src/extension.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c126fedc8f9d6548aa4f168c27ef2d08d5afc39", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/6c126fedc8f9d6548aa4f168c27ef2d08d5afc39", "committedDate": "2020-04-27T07:50:40Z", "message": "Address merge conflicts with development"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b5b992d46dd2a599c4ffd0e8950d3aeef2f547", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/91b5b992d46dd2a599c4ffd0e8950d3aeef2f547", "committedDate": "2020-04-27T09:04:08Z", "message": "Address conflict with existent path key in json definition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44157accf09b13c1ffa51c6862a89fed99894141", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/44157accf09b13c1ffa51c6862a89fed99894141", "committedDate": "2020-04-27T13:51:58Z", "message": "Add URI normalize to avoid unexpected result - as double slashes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "769570a795afea9bbae133deb465f213493cc702", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/769570a795afea9bbae133deb465f213493cc702", "committedDate": "2020-04-27T16:45:36Z", "message": "Fix key in order to support zowe and local scenario under common key paths"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8e167868e19de3e83b50fea77dd4b062b719eb1", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c8e167868e19de3e83b50fea77dd4b062b719eb1", "committedDate": "2020-04-28T15:44:47Z", "message": "Fix workspace path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04eb8d951a26e03aae0bd0c252594408f122da6a", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/04eb8d951a26e03aae0bd0c252594408f122da6a", "committedDate": "2020-04-30T10:26:14Z", "message": "Update API to return URI in the result array"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/b4bd6d42185aa995d91e1f1ee5de71203f358557", "committedDate": "2020-05-04T11:37:07Z", "message": "Apply minor enhancement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDE5NzMw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#pullrequestreview-406419730", "createdAt": "2020-05-06T08:55:08Z", "commit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwODo1Njo1NVrOGRJ2aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxMDo0NDo0NFrOGRNWxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0MDM2MQ==", "bodyText": "local is very common scope, how do you feel about to rename it to folders or local-folders or folders-uris?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420640361", "createdAt": "2020-05-06T08:56:55Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -71,13 +75,21 @@\n                     \"type\": \"string\",\n                     \"description\": \"Current default profile for copybook downloader\"\n                 },\n-                \"broadcom-cobol-lsp.cpy-manager.paths\": {\n+                \"broadcom-cobol-lsp.cpy-manager.paths.dsn\": {\n                     \"type\": \"array\",\n                     \"items\": {\n                         \"type\": \"string\"\n                     },\n                     \"description\": \"Default list of datasets to search for copybooks\",\n                     \"uniqueItems\": true\n+                },\n+                \"broadcom-cobol-lsp.cpy-manager.paths.local\": {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0Mjg1OQ==", "bodyText": "What is the value of this interface? can it be removed to reduce complexity?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420642859", "createdAt": "2020-05-06T09:01:14Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/CopybookResolver.ts", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+/**\n+ * This interface represent the base class that define the API to resolve a JSON segment or a list of paths\n+ * defined by the user in the settings configuration in a list of URI Paths available on the filesystem.\n+ */\n+export interface CopybookResolver {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NDIxOQ==", "bodyText": "I think you can remove this await", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420654219", "createdAt": "2020-05-06T09:21:57Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/commands/ResolveLocalCopybooks.ts", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as vscode from \"vscode\";\n+import {PATHS_LOCAL_KEY, SETTINGS_SECTION} from \"../constants\";\n+import {CopybookResolver} from \"../services/settings/CopybookResolver\";\n+\n+export async function resolveLocalCopybooks(copybookResolver: CopybookResolver) {\n+    if (!vscode.workspace.getConfiguration(SETTINGS_SECTION).has(PATHS_LOCAL_KEY)) {\n+        await vscode.window.showErrorMessage(\"Please, specify LOCAL paths for copybooks in settings.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NDU2Nw==", "bodyText": "It's still here, did you test it on che?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420654567", "createdAt": "2020-05-06T09:22:35Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/commands/ResolveLocalCopybooks.ts", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as vscode from \"vscode\";\n+import {PATHS_LOCAL_KEY, SETTINGS_SECTION} from \"../constants\";\n+import {CopybookResolver} from \"../services/settings/CopybookResolver\";\n+\n+export async function resolveLocalCopybooks(copybookResolver: CopybookResolver) {\n+    if (!vscode.workspace.getConfiguration(SETTINGS_SECTION).has(PATHS_LOCAL_KEY)) {\n+        await vscode.window.showErrorMessage(\"Please, specify LOCAL paths for copybooks in settings.\");\n+        return [];\n+    }\n+\n+    const result: string[] = copybookResolver.resolve(vscode.workspace.getConfiguration(SETTINGS_SECTION).get(PATHS_LOCAL_KEY));\n+    //TODO: Will be removed after test on CHE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NTk5NA==", "bodyText": "This await shouldn't be here, pls remove it. I know that it's not your change, sorry.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420655994", "createdAt": "2020-05-06T09:25:03Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksPathGenerator.ts", "diffHunk": "@@ -33,11 +33,11 @@ export class CopybooksPathGenerator {\n     }\n \n     async listDatasets(): Promise<string[]> {\n-        if (!vscode.workspace.getConfiguration(SETTINGS_SECTION).has(\"paths\")) {\n+        if (!vscode.workspace.getConfiguration(SETTINGS_SECTION).has(PATHS_ZOWE)) {\n             await vscode.window.showErrorMessage(\"Please, specify DATASET paths for copybooks in settings.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY5NDYyMQ==", "bodyText": "What is \"*\" for?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420694621", "createdAt": "2020-05-06T10:38:44Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/LocalCopybookResolver.ts", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import {URL} from \"url\";\n+import {CopybookResolver} from \"./CopybookResolver\";\n+import {SettingsUtils} from \"./util/SettingsUtils\";\n+\n+/**\n+ * This function construct an URI from a valid resource provided from the setting configuration\n+ * @param resource represent the file to search within the workspace folder list\n+ * @return an URI representation of the file or undefined if not found\n+ */\n+function getURIFromResource(resource: string): URL {\n+    for (const workspaceFolder of SettingsUtils.getWorkspacesURI()) {\n+        const uri: URL = new URL(path.join(workspaceFolder, resource));\n+        if (fs.existsSync(uri)) {\n+            return uri;\n+        }\n+    }\n+}\n+\n+function resolveURIList(list: string[]): string[] {\n+    const result: Set<string> = new Set<string>();\n+    list.filter(resource => resource !== \"*\").forEach(resource => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY5NTI1Mw==", "bodyText": "You can have resolveURIList as member of LocalCopybookResolver", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420695253", "createdAt": "2020-05-06T10:39:54Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/LocalCopybookResolver.ts", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import {URL} from \"url\";\n+import {CopybookResolver} from \"./CopybookResolver\";\n+import {SettingsUtils} from \"./util/SettingsUtils\";\n+\n+/**\n+ * This function construct an URI from a valid resource provided from the setting configuration\n+ * @param resource represent the file to search within the workspace folder list\n+ * @return an URI representation of the file or undefined if not found\n+ */\n+function getURIFromResource(resource: string): URL {\n+    for (const workspaceFolder of SettingsUtils.getWorkspacesURI()) {\n+        const uri: URL = new URL(path.join(workspaceFolder, resource));\n+        if (fs.existsSync(uri)) {\n+            return uri;\n+        }\n+    }\n+}\n+\n+function resolveURIList(list: string[]): string[] {\n+    const result: Set<string> = new Set<string>();\n+    list.filter(resource => resource !== \"*\").forEach(resource => {\n+        const URI: URL = getURIFromResource(resource);\n+        if (URI !== undefined) {\n+            result.add(URI.href);\n+        }\n+    });\n+    return [...result];\n+}\n+\n+/**\n+ * This class implement the resolution of paths defined into the configuration file in a list\n+ * of URIs that are present on the filesystem\n+ */\n+export class LocalCopybookResolver implements CopybookResolver {\n+    private static parse(list: string[]): string[] {\n+        if (list === undefined) {\n+            return [];\n+        }\n+        return resolveURIList(list).filter(uri => uri !== \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY5NTg4OA==", "bodyText": "Inline?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420695888", "createdAt": "2020-05-06T10:41:07Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/LocalCopybookResolver.ts", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import {URL} from \"url\";\n+import {CopybookResolver} from \"./CopybookResolver\";\n+import {SettingsUtils} from \"./util/SettingsUtils\";\n+\n+/**\n+ * This function construct an URI from a valid resource provided from the setting configuration\n+ * @param resource represent the file to search within the workspace folder list\n+ * @return an URI representation of the file or undefined if not found\n+ */\n+function getURIFromResource(resource: string): URL {\n+    for (const workspaceFolder of SettingsUtils.getWorkspacesURI()) {\n+        const uri: URL = new URL(path.join(workspaceFolder, resource));\n+        if (fs.existsSync(uri)) {\n+            return uri;\n+        }\n+    }\n+}\n+\n+function resolveURIList(list: string[]): string[] {\n+    const result: Set<string> = new Set<string>();\n+    list.filter(resource => resource !== \"*\").forEach(resource => {\n+        const URI: URL = getURIFromResource(resource);\n+        if (URI !== undefined) {\n+            result.add(URI.href);\n+        }\n+    });\n+    return [...result];\n+}\n+\n+/**\n+ * This class implement the resolution of paths defined into the configuration file in a list\n+ * of URIs that are present on the filesystem\n+ */\n+export class LocalCopybookResolver implements CopybookResolver {\n+    private static parse(list: string[]): string[] {\n+        if (list === undefined) {\n+            return [];\n+        }\n+        return resolveURIList(list).filter(uri => uri !== \"\");\n+    }\n+\n+    /**\n+     * @param list the provided list of physical path defined by the user\n+     * @return a list of resolved URIs, empty array if the input list doesn't contains any valid/found URIs\n+     */\n+    public resolve(list: string[]): string[] {\n+        return LocalCopybookResolver.parse(list);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY5Nzc5OA==", "bodyText": "It's better to check it by parsing https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r420697798", "createdAt": "2020-05-06T10:44:44Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/util/SettingsUtils.ts", "diffHunk": "@@ -0,0 +1,30 @@\n+import * as vscode from \"vscode\";\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+export class SettingsUtils {\n+    public static isValidJSON(json: string): boolean {\n+        return (json !== undefined && json.trim().length > 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4bd6d42185aa995d91e1f1ee5de71203f358557"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74390a5cc0f728ed5e767877e6d0f92daa83b590", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/74390a5cc0f728ed5e767877e6d0f92daa83b590", "committedDate": "2020-05-06T15:38:21Z", "message": "Address request change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Mzg0MTE1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#pullrequestreview-407384115", "createdAt": "2020-05-07T11:31:13Z", "commit": {"oid": "74390a5cc0f728ed5e767877e6d0f92daa83b590"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMTozMToxM1rOGR6UHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMTozMToxM1rOGR6UHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQzNDM5OA==", "bodyText": "Base on the definition list is always defined.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#discussion_r421434398", "createdAt": "2020-05-07T11:31:13Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/settings/LocalCopybookResolver.ts", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import {URL} from \"url\";\n+import {CopybookResolver} from \"./CopybookResolver\";\n+import {SettingsUtils} from \"./util/SettingsUtils\";\n+\n+/**\n+ * This class implement the resolution of paths defined into the configuration file in a list\n+ * of URIs that are present on the filesystem\n+ */\n+export class LocalCopybookResolver implements CopybookResolver {\n+\n+    /**\n+     * This function construct an URI from a valid resource provided from the setting configuration\n+     * @param resource represent the file to search within the workspace folder list\n+     * @return an URI representation of the file or undefined if not found\n+     */\n+    private static getURIFromResource(resource: string): URL {\n+        for (const workspaceFolder of SettingsUtils.getWorkspacesURI()) {\n+            const uri: URL = new URL(path.join(workspaceFolder, resource));\n+            if (fs.existsSync(uri)) {\n+                return uri;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * @param list the provided list of physical path defined by the user\n+     * @return a list of resolved URIs, empty array if the input list doesn't contains any valid/found URIs\n+     */\n+    public resolve(list: string[]): string[] {\n+        if (list === undefined) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74390a5cc0f728ed5e767877e6d0f92daa83b590"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Mzg0NDUx", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#pullrequestreview-407384451", "createdAt": "2020-05-07T11:31:49Z", "commit": {"oid": "74390a5cc0f728ed5e767877e6d0f92daa83b590"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7872930fe087faa1939f1885d322acddf2f19672", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7872930fe087faa1939f1885d322acddf2f19672", "committedDate": "2020-05-07T12:42:24Z", "message": "Address request change to readability improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MTE0MjE0", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/328#pullrequestreview-409114214", "createdAt": "2020-05-11T12:13:04Z", "commit": {"oid": "7872930fe087faa1939f1885d322acddf2f19672"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1076, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}