{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1OTEyMTgx", "number": 613, "title": "Support Termination Requests #590", "bodyText": "Support Termination Requests #590\nLSP spec says below about \"shutdown\" call:\n\"Clients must not send any notifications other than exit or requests to a server to which they have sent a shutdown request. If a server receives requests after a shutdown request those requests should error with InvalidRequest.\"\nWhile the VScode API doesn't mention anything specific about the call in references/vscode-api#Extension. It does mention it in references/activation-events\nAnd an issue vscode issue, mentions \"VScode only wait for shutdown (e.g. for the promise to be resolved) and wait in total 5 seconds. There is not waiting happening on exit.\"", "createdAt": "2020-11-05T09:12:57Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613", "merged": true, "mergeCommit": {"oid": "02107af57eb9d8749b7ba8f5d7fcabef4d023d84"}, "closed": true, "closedAt": "2020-11-12T13:27:39Z", "author": {"login": "ap891843"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZexK2AFqTUyNDA2MTY5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbxLg_gFqTUyNjA1NDcyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDYxNjk1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-524061695", "createdAt": "2020-11-05T09:16:12Z", "commit": {"oid": "8a0f40f85fb4b78b97a6de2aea54a61e31621a7d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNjoxMlrOHt6DWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNjoxMlrOHt6DWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5OTA5Nw==", "bodyText": "As per LSP spec, after this call no other service call can/should be handled. Should we have a logic to return no-valid from all our service after this call is made.\nWhy I didn't implement it?\nVScode actually never waits for us to call exit. Upon closing, it fires a shutdown call and then fires an exit call.\nDetails mentioned in the PR comment.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r517899097", "createdAt": "2020-11-05T09:16:12Z", "author": {"login": "ap891843"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -124,14 +125,21 @@ private void getLocaleFromClient() {\n     settingsService.getConfiguration(LOCALE.label).thenAccept(localeStore.notifyLocaleStore());\n   }\n \n+  public int getExitCode() {\n+    return exitCode;\n+  }\n+\n   @Override\n   public CompletableFuture<Object> shutdown() {\n+    LOG.info(\"LS for COBOL received shutdown request\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a0f40f85fb4b78b97a6de2aea54a61e31621a7d"}, "originalPosition": 33}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "981282cd9c826116cddab48c7adc787f904c7ccd", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/981282cd9c826116cddab48c7adc787f904c7ccd", "committedDate": "2020-11-05T13:45:15Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "a937bedb1e9f5635b0bcd9ac7662d2c1c326f13c", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a937bedb1e9f5635b0bcd9ac7662d2c1c326f13c", "committedDate": "2020-11-05T14:17:16Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a937bedb1e9f5635b0bcd9ac7662d2c1c326f13c", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a937bedb1e9f5635b0bcd9ac7662d2c1c326f13c", "committedDate": "2020-11-05T14:17:16Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "eaecb7b206caf31ae0a57991f10369bfcd2d1ebc", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/eaecb7b206caf31ae0a57991f10369bfcd2d1ebc", "committedDate": "2020-11-06T09:38:13Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eaecb7b206caf31ae0a57991f10369bfcd2d1ebc", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/eaecb7b206caf31ae0a57991f10369bfcd2d1ebc", "committedDate": "2020-11-06T09:38:13Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "34809dd3bd3a5cbc782375ce73145d2790781735", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/34809dd3bd3a5cbc782375ce73145d2790781735", "committedDate": "2020-11-06T09:45:41Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34809dd3bd3a5cbc782375ce73145d2790781735", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/34809dd3bd3a5cbc782375ce73145d2790781735", "committedDate": "2020-11-06T09:45:41Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/46dd72f92204022be93287a288a51758dda8b42b", "committedDate": "2020-11-06T09:59:43Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MDEyNTI1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-525012525", "createdAt": "2020-11-06T10:04:35Z", "commit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDowNDozNVrOHunsIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDoyOTo1N1rOHuohWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0NjgxOA==", "bodyText": "It is not clear to me what does this test checks from the description", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518646818", "createdAt": "2020-11-06T10:04:35Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/LanguageClientServiceTest.spec.ts", "diffHunk": "@@ -104,4 +104,12 @@ describe(\"LanguageClientService positive scenario\", () => {\n             },\n         });\n     });\n+\n+    test(\"Test LanguageClientService exit language server is calls exit on languageClient\", () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0ODg4NQ==", "bodyText": "Doesn't it mean that it will stop a new LanguageClient instance?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518648885", "createdAt": "2020-11-06T10:08:32Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/LanguageClientService.ts", "diffHunk": "@@ -43,11 +43,19 @@ export class LanguageClientService {\n     }\n \n     public start(): vscode.Disposable {\n-        const languageClient = new LanguageClient(LANGUAGE_ID,\n+        const languageClient = this.getLanguageClient();\n+        return languageClient.start();\n+    }\n+\n+    public stop(): Thenable<void> {\n+        return this.getLanguageClient().stop();\n+    }\n+\n+    private getLanguageClient() {\n+        return new LanguageClient(LANGUAGE_ID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0OTIyMg==", "bodyText": "Please, add a Javadoc", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518649222", "createdAt": "2020-11-06T10:09:08Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/CheckServerShutdownState.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package com.broadcom.lsp.cobol.core.annotation;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.METHOD)\n+public @interface CheckServerShutdownState {}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0OTM4Mw==", "bodyText": "Missing copyright header", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518649383", "createdAt": "2020-11-06T10:09:26Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/CheckServerShutdownState.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package com.broadcom.lsp.cobol.core.annotation;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0OTQ1NQ==", "bodyText": "Missing copyright header", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518649455", "createdAt": "2020-11-06T10:09:32Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/HandleShutdownState.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.broadcom.lsp.cobol.core.annotation;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY0OTg3NA==", "bodyText": "Missing Javadoc", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518649874", "createdAt": "2020-11-06T10:10:17Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/HandleShutdownState.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.broadcom.lsp.cobol.core.annotation;\n+\n+import com.broadcom.lsp.cobol.service.DisposableLanguageServer;\n+import com.google.inject.Inject;\n+import lombok.extern.slf4j.Slf4j;\n+import org.aopalliance.intercept.MethodInterceptor;\n+import org.aopalliance.intercept.MethodInvocation;\n+import org.eclipse.lsp4j.services.LanguageServer;\n+\n+import java.util.concurrent.CompletableFuture;\n+\n+@Slf4j\n+public class HandleShutdownState implements MethodInterceptor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1MTY0MQ==", "bodyText": "Not an LSP request, no need to check it", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518651641", "createdAt": "2020-11-06T10:13:37Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolTextDocumentService.java", "diffHunk": "@@ -213,11 +224,13 @@ private void interruptAnalysis(String uri) {\n   }\n \n   @Override\n+  @CheckServerShutdownState\n   public void didSave(DidSaveTextDocumentParams params) {\n     LOG.info(\"Document saved...\");\n   }\n \n   @Override\n+  @CheckServerShutdownState", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NjI3MQ==", "bodyText": "Nice idea to create a class for it, but it should be either static or a separate class because it is not strongly connected with the outer class.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518656271", "createdAt": "2020-11-06T10:22:20Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -145,4 +187,11 @@ private ExecuteCommandOptions collectExecuteCommandList() {\n     return new ExecuteCommandOptions(\n         stream(ErrorCode.values()).map(ErrorCode::name).collect(toList()));\n   }\n+\n+  /** Represents the JSON RPC response structure for shutdown command as per LSP specification */\n+  @AllArgsConstructor\n+  private class ShutdownResponse {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NzA2Mw==", "bodyText": "A misplaced comma in the comment, as well as in a comment below", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518657063", "createdAt": "2020-11-06T10:23:52Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -124,14 +127,53 @@ private void getLocaleFromClient() {\n     settingsService.getConfiguration(LOCALE.label).thenAccept(localeStore.notifyLocaleStore());\n   }\n \n+  @Override\n+  public int getExitCode() {\n+    return exitCode;\n+  }\n+\n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"LS for COBOL received shutdown request\");\n+    exitCode = 0;\n+    try {\n+      cancelAllProcessing();\n+    } catch (Exception exception) {\n+      return supplyAsync(() -> new ShutdownResponse(null, exception.getMessage()));\n+    }\n+    return supplyAsync(() -> new ShutdownResponse(null, String.valueOf(exitCode)));\n+  }\n+\n+  /**\n+   * Attempts to stop all actively executing tasks, halts the processing of waiting tasks, and\n+   * returns a list of the tasks that were awaiting execution. These tasks are drained (removed)\n+   * from the task queue upon return from this method.\n+   *\n+   * <p>There are no guarantees beyond best-effort attempts to stop processing actively executing\n+   * tasks. This implementation cancels tasks via Thread.interrupt(), so any task that fails to\n+   * respond to interrupts may never terminate.\n+   *\n+   * <p>Source:\n+   * https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#shutdownNow--\n+   */\n+  private void cancelAllProcessing() {\n+    // NOTE: shutdownNow principally is not a bad practice when we know what we are doing.\n+    //      Here in this case, since we are only stopping our own threads which don't\n+    //      require any clean up.It's ok. Java doc doesn't mention any bad practice for this.\n+\n+    // cancels all the running task and clears empty queue ,initiated on forkJoinPool.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1Nzc2Nw==", "bodyText": "Why did you remove this class?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518657767", "createdAt": "2020-11-06T10:25:09Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/strategy/Messages.java", "diffHunk": "@@ -1,51 +0,0 @@\n-/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY2MDQ0MQ==", "bodyText": "Please, don't use this type of DI in tests", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r518660441", "createdAt": "2020-11-06T10:29:57Z", "author": {"login": "temanbrcom"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/service/CobolTextDocumentServiceTest.java", "diffHunk": "@@ -437,6 +441,58 @@ void testImmediateClosingOfDocumentDoNotCauseNPE() {\n     verify(communications, timeout(2000)).cancelProgressNotification(UseCaseUtils.DOCUMENT_URI);\n   }\n \n+  /**\n+   * This method tests that after a shutdown request, {@link TextDocumentService} always return\n+   * SHUTDOWN_RESPONSE\n+   *\n+   * @throws ExecutionException\n+   * @throws InterruptedException\n+   */\n+  @Test\n+  void whenShutdownIsFired_ThenNewRequestReturnInvalidResponse()\n+      throws ExecutionException, InterruptedException {\n+    CobolTextDocumentService service =\n+        (CobolTextDocumentService)\n+            LangServerCtx.getInjector().getInstance(TextDocumentService.class);\n+    LanguageServer server = LangServerCtx.getInjector().getInstance(LanguageServer.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NjU1NTU2", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-525655556", "createdAt": "2020-11-07T14:12:03Z", "commit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNDoxMjowNFrOHvIUrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNDozNTowMlrOHvIcXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4MTQ4Ng==", "bodyText": "The test pass even if I remove those three lines. I suggest to remove them.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519181486", "createdAt": "2020-11-07T14:12:04Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/LanguageClientServiceTest.spec.ts", "diffHunk": "@@ -104,4 +104,12 @@ describe(\"LanguageClientService positive scenario\", () => {\n             },\n         });\n     });\n+\n+    test(\"Test LanguageClientService exit language server is calls exit on languageClient\", () => {\n+        jest.clearAllMocks();\n+        new JavaCheck().isJavaInstalled = jest.fn().mockResolvedValue(true);\n+        vscode.workspace.getConfiguration(expect.any(String)).get = jest.fn().mockReturnValue(9999);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4MTY0MQ==", "bodyText": "Could you please keep in on one line? Or add indentation on 39 line.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519181641", "createdAt": "2020-11-07T14:14:09Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/extension.ts", "diffHunk": "@@ -32,18 +32,18 @@ import {TelemetryService} from \"./services/reporter/TelemetryService\";\n import {createFileWithGivenPath, initializeSettings} from \"./services/Settings\";\n import {ZoweApi} from \"./services/ZoweApi\";\n \n+const zoweApi: ZoweApi = new ZoweApi();\n+const profileService: ProfileService = new ProfileService(zoweApi);\n+const copybooksPathGenerator: CopybooksPathGenerator = new CopybooksPathGenerator(profileService);\n+const copyBooksDownloader: CopybookDownloadService =\n+new CopybookDownloadService(zoweApi, profileService, copybooksPathGenerator);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4MjU0Mg==", "bodyText": "You don't really need to resolve this future asynchronously. Please, use this instead:\nreturn CompletableFuture.completedFuture(SHUTDOWN_RESPONSE);", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519182542", "createdAt": "2020-11-07T14:24:53Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/HandleShutdownState.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.broadcom.lsp.cobol.core.annotation;\n+\n+import com.broadcom.lsp.cobol.service.DisposableLanguageServer;\n+import com.google.inject.Inject;\n+import lombok.extern.slf4j.Slf4j;\n+import org.aopalliance.intercept.MethodInterceptor;\n+import org.aopalliance.intercept.MethodInvocation;\n+import org.eclipse.lsp4j.services.LanguageServer;\n+\n+import java.util.concurrent.CompletableFuture;\n+\n+@Slf4j\n+public class HandleShutdownState implements MethodInterceptor {\n+  private static final String SHUTDOWN_RESPONSE = \"InvalidRequest\";\n+  private LanguageServer server;\n+\n+  @Inject\n+  public void setServer(LanguageServer server) {\n+    this.server = server;\n+  }\n+\n+  @Override\n+  public Object invoke(MethodInvocation invocation) throws Throwable {\n+    if (server instanceof DisposableLanguageServer) {\n+      DisposableLanguageServer languageServer = (DisposableLanguageServer) server;\n+      if (languageServer.getExitCode() == DisposableLanguageServer.SHUTDOWN_EXIT_CODE) {\n+        LOG.info(invocation.getMethod().getName() + \" invoked after shutdown\");\n+        return CompletableFuture.supplyAsync(() -> SHUTDOWN_RESPONSE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4MzExNA==", "bodyText": "You can use CompletableFuture.completedFuture in both returns.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519183114", "createdAt": "2020-11-07T14:31:16Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -124,14 +127,53 @@ private void getLocaleFromClient() {\n     settingsService.getConfiguration(LOCALE.label).thenAccept(localeStore.notifyLocaleStore());\n   }\n \n+  @Override\n+  public int getExitCode() {\n+    return exitCode;\n+  }\n+\n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"LS for COBOL received shutdown request\");\n+    exitCode = 0;\n+    try {\n+      cancelAllProcessing();\n+    } catch (Exception exception) {\n+      return supplyAsync(() -> new ShutdownResponse(null, exception.getMessage()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4MzQ1NQ==", "bodyText": "It makes sense to update exitCode after successfully done the cancelAllProcessing call.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519183455", "createdAt": "2020-11-07T14:35:02Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -124,14 +127,53 @@ private void getLocaleFromClient() {\n     settingsService.getConfiguration(LOCALE.label).thenAccept(localeStore.notifyLocaleStore());\n   }\n \n+  @Override\n+  public int getExitCode() {\n+    return exitCode;\n+  }\n+\n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"LS for COBOL received shutdown request\");\n+    exitCode = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/46dd72f92204022be93287a288a51758dda8b42b", "committedDate": "2020-11-06T09:59:43Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "1558c42217b30cdc020cb322080086604886f646", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1558c42217b30cdc020cb322080086604886f646", "committedDate": "2020-11-09T08:48:12Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1558c42217b30cdc020cb322080086604886f646", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1558c42217b30cdc020cb322080086604886f646", "committedDate": "2020-11-09T08:48:12Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "6ceba3083767dcd1c9c3e81491e2552bba4445b9", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/6ceba3083767dcd1c9c3e81491e2552bba4445b9", "committedDate": "2020-11-09T09:07:04Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ceba3083767dcd1c9c3e81491e2552bba4445b9", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/6ceba3083767dcd1c9c3e81491e2552bba4445b9", "committedDate": "2020-11-09T09:07:04Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "da14f00c21184317c3d317d00dd596b2d91123e7", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/da14f00c21184317c3d317d00dd596b2d91123e7", "committedDate": "2020-11-09T13:01:22Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MTkxODc0", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-526191874", "createdAt": "2020-11-09T12:13:12Z", "commit": {"oid": "6ceba3083767dcd1c9c3e81491e2552bba4445b9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMjoxMzoxMlrOHvry_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMjoxMzoxMlrOHvry_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2MjY4Nw==", "bodyText": "It deserves some further investigation, but ok, let's leave the annotation there.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519762687", "createdAt": "2020-11-09T12:13:12Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolTextDocumentService.java", "diffHunk": "@@ -213,11 +224,13 @@ private void interruptAnalysis(String uri) {\n   }\n \n   @Override\n+  @CheckServerShutdownState\n   public void didSave(DidSaveTextDocumentParams params) {\n     LOG.info(\"Document saved...\");\n   }\n \n   @Override\n+  @CheckServerShutdownState", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1MTY0MQ=="}, "originalCommit": {"oid": "46dd72f92204022be93287a288a51758dda8b42b"}, "originalPosition": 98}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MTA5OTE1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-528109915", "createdAt": "2020-11-11T12:01:24Z", "commit": {"oid": "da14f00c21184317c3d317d00dd596b2d91123e7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMjowMToyNFrOHxKOwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMjowMjoxMVrOHxKQOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMwOTg5MA==", "bodyText": "I just tested it and noticed that this message should be \"COBOL LS server exits with code:\"", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521309890", "createdAt": "2020-11-11T12:01:24Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -126,12 +134,45 @@ private void getLocaleFromClient() {\n \n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"LS for COBOL received shutdown request\");\n+    try {\n+      cancelAllProcessing();\n+      exitCode = 0;\n+    } catch (Exception exception) {\n+      return CompletableFuture.completedFuture(new ShutdownResponse(null, exception.getMessage()));\n+    }\n+    return CompletableFuture.completedFuture(new ShutdownResponse(null, String.valueOf(exitCode)));\n+  }\n+\n+  /**\n+   * Attempts to stop all actively executing tasks, halts the processing of waiting tasks, and\n+   * returns a list of the tasks that were awaiting execution. These tasks are drained (removed)\n+   * from the task queue upon return from this method.\n+   *\n+   * <p>There are no guarantees beyond best-effort attempts to stop processing actively executing\n+   * tasks. This implementation cancels tasks via Thread.interrupt(), so any task that fails to\n+   * respond to interrupts may never terminate.\n+   *\n+   * <p>Source:\n+   * https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#shutdownNow--\n+   */\n+  private void cancelAllProcessing() {\n+    // NOTE: shutdownNow principally is not a bad practice when we know what we are doing.\n+    //      Here in this case, since we are only stopping our own threads which don't\n+    //      require any clean up.It's ok. Java doc doesn't mention any bad practice for this.\n+\n+    // cancels all the running task and clears empty queue on forkJoinPool.\n+    ForkJoinPool.commonPool().shutdownNow();\n+\n+    // cancels all the running task and clears empty queue on CobolTextDocumentService executor.\n+    ((CobolTextDocumentService) getTextDocumentService()).disposeAllOperation(this);\n+    LOG.info(\"All processing abandoned as per shutdown call\");\n   }\n \n   @Override\n   public void exit() {\n-    // not supported\n+    LOG.info(\"LS for COBOL exiting with code: \" + exitCode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da14f00c21184317c3d317d00dd596b2d91123e7"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMxMDI2NA==", "bodyText": "Should be \"COBOL LS received shutdown request\"", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521310264", "createdAt": "2020-11-11T12:02:11Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -126,12 +134,45 @@ private void getLocaleFromClient() {\n \n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"LS for COBOL received shutdown request\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da14f00c21184317c3d317d00dd596b2d91123e7"}, "originalPosition": 52}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da14f00c21184317c3d317d00dd596b2d91123e7", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/da14f00c21184317c3d317d00dd596b2d91123e7", "committedDate": "2020-11-09T13:01:22Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/f27c36e208b5c505752a6ca748c88433e9eddf97", "committedDate": "2020-11-11T13:58:07Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MjQ0MjAy", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-528244202", "createdAt": "2020-11-11T14:54:31Z", "commit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNDo1NDozMVrOHxQlAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNDo1NDozMVrOHxQlAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQxMzg4OA==", "bodyText": "Reverting back custom thread pool changes for this class.\nReason:\nManage thread for the process we initiate and let LSP4J manage its thread. This helps in the shutdown process where we shutdown the custom thread pool to shutdown all current processes.\n@asatklichov\n@grianbrcom\n@Nurkambay\n@temanbrcom", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521413888", "createdAt": "2020-11-11T14:54:31Z", "author": {"login": "ap891843"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/LangServerBootstrap.java", "diffHunk": "@@ -56,23 +54,19 @@ public static void main(String[] args)\n     Injector injector = initCtx();\n     LanguageServer server = injector.getInstance(LanguageServer.class);\n     ClientProvider provider = injector.getInstance(ClientProvider.class);\n-    CustomThreadPoolExecutor customExecutor = injector.getInstance(CustomThreadPoolExecutor.class);\n \n-    start(args, server, provider, customExecutor.getThreadPoolExecutor());\n+    start(args, server, provider);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MjcyOTc3", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-528272977", "createdAt": "2020-11-11T15:25:03Z", "commit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNToyNTowNFrOHxR4mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNTozMDo0NVrOHxSIIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQzNTI5MA==", "bodyText": "Should we shutdown also the scheduled pool here?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521435290", "createdAt": "2020-11-11T15:25:04Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolLanguageServer.java", "diffHunk": "@@ -126,12 +138,45 @@ private void getLocaleFromClient() {\n \n   @Override\n   public CompletableFuture<Object> shutdown() {\n-    return supplyAsync(() -> TRUE);\n+    LOG.info(\"COBOL LS received shutdown request\");\n+    try {\n+      cancelAllProcessing();\n+      exitCode = 0;\n+    } catch (Exception exception) {\n+      return CompletableFuture.completedFuture(new ShutdownResponse(null, exception.getMessage()));\n+    }\n+    return CompletableFuture.completedFuture(new ShutdownResponse(null, String.valueOf(exitCode)));\n+  }\n+\n+  /**\n+   * Attempts to stop all actively executing tasks, halts the processing of waiting tasks, and\n+   * returns a list of the tasks that were awaiting execution. These tasks are drained (removed)\n+   * from the task queue upon return from this method.\n+   *\n+   * <p>There are no guarantees beyond best-effort attempts to stop processing actively executing\n+   * tasks. This implementation cancels tasks via Thread.interrupt(), so any task that fails to\n+   * respond to interrupts may never terminate.\n+   *\n+   * <p>Source:\n+   * https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html#shutdownNow--\n+   */\n+  private void cancelAllProcessing() {\n+    // NOTE: shutdownNow principally is not a bad practice when we know what we are doing.\n+    //      Here in this case, since we are only stopping our own threads which don't\n+    //      require any clean up.It's ok. Java doc doesn't mention any bad practice for this.\n+\n+    // cancels all the running task and clears empty queue on forkJoinPool.\n+    ForkJoinPool.commonPool().shutdownNow();\n+\n+    // cancels all the running task on COBOL LS custom executor service.\n+    customThreadPoolExecutor.getThreadPoolExecutor().shutdownNow();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQzNjUzMg==", "bodyText": "Optional: this name seems very wordy, especially on the usages. Maybe, executors would be enough?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521436532", "createdAt": "2020-11-11T15:26:52Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolTextDocumentService.java", "diffHunk": "@@ -87,14 +92,16 @@\n       Completions completions,\n       Occurrences occurrences,\n       DataBusBroker dataBus,\n-      CodeActions actions) {\n+      CodeActions actions,\n+      CustomThreadPoolExecutor customThreadPoolExecutor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQzOTI2Nw==", "bodyText": "Replaceable with builder", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521439267", "createdAt": "2020-11-11T15:30:45Z", "author": {"login": "temanbrcom"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/service/CobolTextDocumentServiceTest.java", "diffHunk": "@@ -178,7 +183,14 @@ void disableCopybookAnalysisOnExtendedDoc() {\n \n   private CobolTextDocumentService buildServiceWithMockEngine(LanguageEngineFacade engine) {\n     return new CobolTextDocumentService(\n-        mock(Communications.class), engine, null, null, null, mock(DataBusBroker.class), null);\n+        mock(Communications.class),\n+        engine,\n+        null,\n+        null,\n+        null,\n+        mock(DataBusBroker.class),\n+        null,\n+        getCustomExecutor());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c1f079d128a2a4953172addb695dc16f86dc73c2", "committedDate": "2020-11-11T16:06:23Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f27c36e208b5c505752a6ca748c88433e9eddf97", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/f27c36e208b5c505752a6ca748c88433e9eddf97", "committedDate": "2020-11-11T13:58:07Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c1f079d128a2a4953172addb695dc16f86dc73c2", "committedDate": "2020-11-11T16:06:23Z", "message": "feat: Support Termination Requests #590\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MzIwOTMy", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-528320932", "createdAt": "2020-11-11T16:16:33Z", "commit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MzI2NTMw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-528326530", "createdAt": "2020-11-11T16:22:38Z", "commit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNjoyMjozOVrOHxUVRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNjoyMjozOVrOHxUVRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ3NTM5Nw==", "bodyText": "In this case, we will create a connection to DI that we are actually want to get rid of. Will work for now; may be fixed in #261", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r521475397", "createdAt": "2020-11-11T16:22:39Z", "author": {"login": "temanbrcom"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/service/DocumentExtensionTests.java", "diffHunk": "@@ -34,7 +35,7 @@\n  * extensions. If an extension of a document is unsupported (i.e. not \"cob\", \"cbl\" or \"cobol\"\n  * ignoring case) then the according to notification should be sent.\n  */\n-class DocumentExtensionTests {\n+class DocumentExtensionTests extends ConfigurableTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MDU0NzI2", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#pullrequestreview-526054726", "createdAt": "2020-11-09T09:15:26Z", "commit": {"oid": "6ceba3083767dcd1c9c3e81491e2552bba4445b9"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwOToxNToyNlrOHvlRsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMTo0MzowN1rOHx3DHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY1NTg1Nw==", "bodyText": "What if we write methods in lambda way?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r519655857", "createdAt": "2020-11-09T09:15:26Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/core/annotation/NonSyntheticMethodMatcher.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *    Broadcom, Inc. - initial API and implementation\n+ *\n+ */\n+\n+package com.broadcom.lsp.cobol.core.annotation;\n+\n+import com.google.inject.matcher.AbstractMatcher;\n+\n+import java.lang.reflect.Method;\n+\n+/**\n+ * Custom {@link com.google.inject.matcher.Matcher} to identify any synthetic method and returns\n+ * false if the method is synthetic\n+ */\n+public class NonSyntheticMethodMatcher extends AbstractMatcher<Method> {\n+\n+  /**\n+   * match any synthetic method and returns false if the method is synthetic\n+   *\n+   * @param method\n+   * @return true if method is non-synthetic and false otherwise\n+   */\n+  @Override\n+  public boolean matches(Method method) {\n+    return !method.isSynthetic();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ceba3083767dcd1c9c3e81491e2552bba4445b9"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA0NDE4OA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/613#discussion_r522044188", "createdAt": "2020-11-12T11:43:07Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/CobolTextDocumentService.java", "diffHunk": "@@ -108,70 +115,85 @@\n   }\n \n   @Override\n+  @CheckServerShutdownState\n   public CompletableFuture<Either<List<CompletionItem>, CompletionList>> completion(\n       CompletionParams params) {\n     String uri = params.getTextDocument().getUri();\n     return CompletableFuture.<Either<List<CompletionItem>, CompletionList>>supplyAsync(\n-            () -> Either.forRight(completions.collectFor(docs.get(uri), params)))\n+            () -> Either.forRight(completions.collectFor(docs.get(uri), params)),\n+            executors.getThreadPoolExecutor())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1f079d128a2a4953172addb695dc16f86dc73c2"}, "originalPosition": 82}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 871, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}