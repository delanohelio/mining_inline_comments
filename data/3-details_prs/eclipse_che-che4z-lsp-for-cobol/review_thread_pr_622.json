{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NjM4NzEx", "number": 622, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDoyMjo0MFrOE2BzEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzoxMDozMFrOE3U2JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MDg4MDE5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/LangServerBootstrap.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDoyMjo0MFrOHuoRxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDoyNDoyMVrOHuoVPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NjQ1Mw==", "bodyText": "Any specific reason to start the server using this executor service?\nIf we don't, we can use customExecutor to stop all server processing by shutting down the customExecutor during shutdown call before exit.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518656453", "createdAt": "2020-11-06T10:22:40Z", "author": {"login": "ap891843"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/LangServerBootstrap.java", "diffHunk": "@@ -78,30 +85,37 @@ private void start(\n     }\n   }\n \n-  Launcher<LanguageClient> launchServer(@NonNull String[] args, @NonNull LanguageServer server)\n+  Launcher<LanguageClient> launchServer(\n+      @NonNull String[] args,\n+      @NonNull LanguageServer server,\n+      @NonNull ExecutorService executorService)\n       throws IOException {\n     return isPipeEnabled(args)\n-        ? createServerLauncher(server, System.in, System.out)\n-        : createServerLauncherWithSocket(server);\n+        ? createServerLauncher(server, System.in, System.out, executorService)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NzM0Mg==", "bodyText": "Yes, shutdown I forgot ;) thanks", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518657342", "createdAt": "2020-11-06T10:24:21Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/LangServerBootstrap.java", "diffHunk": "@@ -78,30 +85,37 @@ private void start(\n     }\n   }\n \n-  Launcher<LanguageClient> launchServer(@NonNull String[] args, @NonNull LanguageServer server)\n+  Launcher<LanguageClient> launchServer(\n+      @NonNull String[] args,\n+      @NonNull LanguageServer server,\n+      @NonNull ExecutorService executorService)\n       throws IOException {\n     return isPipeEnabled(args)\n-        ? createServerLauncher(server, System.in, System.out)\n-        : createServerLauncherWithSocket(server);\n+        ? createServerLauncher(server, System.in, System.out, executorService)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1NjQ1Mw=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MDk3NTUzOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDo0OTo0MlrOHupLjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTo0ODoyM1rOHurBvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MTI0Ng==", "bodyText": "So, it creates a new executor on each call?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518671246", "createdAt": "2020-11-06T10:49:42Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+\n+import java.util.concurrent.*;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  @Inject\n+  public CustomThreadPoolExecutorService(\n+      @Named(\"CORE-POOL-SIZE\") int corePoolSize,\n+      @Named(\"MAX-POOL-SIZE\") int maximumPoolSize,\n+      @Named(\"KEEP-ALIVE-TIME-IN-SECONDS\") int keepAliveTim,\n+      @Named(\"CORE-POOL-SIZE-FOR-SCHEDULED-POOL\") int corePoolSizeForScheduledThreadPool) {\n+    this.corePoolSize = corePoolSize;\n+    this.maximumPoolSize = maximumPoolSize;\n+    this.keepAliveTime = keepAliveTime;\n+    this.corePoolSizeForScheduledThreadPool = corePoolSizeForScheduledThreadPool;\n+  }\n+\n+  private ExecutorService getThreadPoolExecutor(\n+      int corePoolSize, int maxPoolSize, long keepAliveTime) {\n+    return new ThreadPoolExecutor(\n+        corePoolSize,\n+        maxPoolSize,\n+        keepAliveTime,\n+        TimeUnit.SECONDS,\n+        new LinkedBlockingQueue<Runnable>());\n+  }\n+\n+  private ScheduledExecutorService getScheduledThreadPoolExecutor(\n+      int corePoolSizeForScheduledThreadPool) {\n+    return new ScheduledThreadPoolExecutor(corePoolSizeForScheduledThreadPool);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcwMTUwMA==", "bodyText": "Initial solution was based on util-class, yes I will make this single-loaded", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518701500", "createdAt": "2020-11-06T11:48:23Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+\n+import java.util.concurrent.*;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  @Inject\n+  public CustomThreadPoolExecutorService(\n+      @Named(\"CORE-POOL-SIZE\") int corePoolSize,\n+      @Named(\"MAX-POOL-SIZE\") int maximumPoolSize,\n+      @Named(\"KEEP-ALIVE-TIME-IN-SECONDS\") int keepAliveTim,\n+      @Named(\"CORE-POOL-SIZE-FOR-SCHEDULED-POOL\") int corePoolSizeForScheduledThreadPool) {\n+    this.corePoolSize = corePoolSize;\n+    this.maximumPoolSize = maximumPoolSize;\n+    this.keepAliveTime = keepAliveTime;\n+    this.corePoolSizeForScheduledThreadPool = corePoolSizeForScheduledThreadPool;\n+  }\n+\n+  private ExecutorService getThreadPoolExecutor(\n+      int corePoolSize, int maxPoolSize, long keepAliveTime) {\n+    return new ThreadPoolExecutor(\n+        corePoolSize,\n+        maxPoolSize,\n+        keepAliveTime,\n+        TimeUnit.SECONDS,\n+        new LinkedBlockingQueue<Runnable>());\n+  }\n+\n+  private ScheduledExecutorService getScheduledThreadPoolExecutor(\n+      int corePoolSizeForScheduledThreadPool) {\n+    return new ScheduledThreadPoolExecutor(corePoolSizeForScheduledThreadPool);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MTI0Ng=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MDk4MDIwOnYy", "diffSide": "RIGHT", "path": "server/src/test/java/com/broadcom/lsp/cobol/LangServerBootstrapTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDo1MTowMlrOHupOVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwODoyNjo0MVrOHvjiBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MTk1Nw==", "bodyText": "Could you, please, rewrite it to avoid using the LangServerCtx? We plan to get rid of this class", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518671957", "createdAt": "2020-11-06T10:51:02Z", "author": {"login": "temanbrcom"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/LangServerBootstrapTest.java", "diffHunk": "@@ -49,10 +65,12 @@ void initCtx() {\n \n     // Bound class in Service module\n     CobolLanguageServer server = getInjector().getInstance(CobolLanguageServer.class);\n+    CustomThreadPoolExecutor customExecutor = LangServerCtx.getInjector().getInstance(CustomThreadPoolExecutor.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcwMzUzOA==", "bodyText": "Ok, then   both server  and customExecutor  via constructor.  LangServerCtx is used in test, but can be removed.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518703538", "createdAt": "2020-11-06T11:52:29Z", "author": {"login": "asatklichov"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/LangServerBootstrapTest.java", "diffHunk": "@@ -49,10 +65,12 @@ void initCtx() {\n \n     // Bound class in Service module\n     CobolLanguageServer server = getInjector().getInstance(CobolLanguageServer.class);\n+    CustomThreadPoolExecutor customExecutor = LangServerCtx.getInjector().getInstance(CustomThreadPoolExecutor.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MTk1Nw=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYyNzI3MQ==", "bodyText": "Could you, please, rewrite it to avoid using the LangServerCtx? We plan to get rid of this class\n\nAs a part of  #621 this will be refactored", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519627271", "createdAt": "2020-11-09T08:26:41Z", "author": {"login": "asatklichov"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/LangServerBootstrapTest.java", "diffHunk": "@@ -49,10 +65,12 @@ void initCtx() {\n \n     // Bound class in Service module\n     CobolLanguageServer server = getInjector().getInstance(CobolLanguageServer.class);\n+    CustomThreadPoolExecutor customExecutor = LangServerCtx.getInjector().getInstance(CustomThreadPoolExecutor.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MTk1Nw=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MDk5MTI0OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/communications/ServerCommunications.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMDo1NDoxNlrOHupVJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwODozNzo1MFrOHvj6Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MzcwMw==", "bodyText": "Will schedule each task in a new executor", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r518673703", "createdAt": "2020-11-06T10:54:16Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/communications/ServerCommunications.java", "diffHunk": "@@ -83,7 +87,7 @@ public void notifyThatEngineNotFound(String languageType) {\n   public void notifyThatLoadingInProgress(String uri) {\n     String decodedUri = files.decodeURI(uri);\n     uriInProgress.add(decodedUri);\n-    executor.schedule(\n+    customExecutor.getScheduledThreadPoolExecutor().schedule(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYzMzQ4Mw==", "bodyText": "Will schedule each task in a new executor\n\ndone", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519633483", "createdAt": "2020-11-09T08:37:50Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/delegates/communications/ServerCommunications.java", "diffHunk": "@@ -83,7 +87,7 @@ public void notifyThatEngineNotFound(String languageType) {\n   public void notifyThatLoadingInProgress(String uri) {\n     String decodedUri = files.decodeURI(uri);\n     uriInProgress.add(decodedUri);\n-    executor.schedule(\n+    customExecutor.getScheduledThreadPoolExecutor().schedule(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY3MzcwMw=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NDM1OTgxOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/domain/modules/ServiceModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNDo1NDoxOFrOHvIjpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwODoyNTo0MlrOHvjgCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTMxOQ==", "bodyText": "Why are you bind CustomThreadPoolExecutor in two modules? I think that we can define it only in one place.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519185319", "createdAt": "2020-11-07T14:54:18Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/domain/modules/ServiceModule.java", "diffHunk": "@@ -50,6 +53,7 @@\n public class ServiceModule extends AbstractModule {\n   @Override\n   protected void configure() {\n+    bind(CustomThreadPoolExecutor.class).to(CustomThreadPoolExecutorService.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYyNjc2Mw==", "bodyText": "I created a new #621 to refactor our DI modules, there are are already duplications in app", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519626763", "createdAt": "2020-11-09T08:25:42Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/domain/modules/ServiceModule.java", "diffHunk": "@@ -50,6 +53,7 @@\n public class ServiceModule extends AbstractModule {\n   @Override\n   protected void configure() {\n+    bind(CustomThreadPoolExecutor.class).to(CustomThreadPoolExecutorService.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTMxOQ=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NDM2Njg5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowNDoxNlrOHvInIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwODo0MDo1MFrOHvkBIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIwOQ==", "bodyText": "I suppose that this getter also must return the same ThreadPool each time.\nI see that you want to rewrite getScheduledThreadPoolExecutor, I just want to mark this place for not to forget.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519186209", "createdAt": "2020-11-07T15:04:16Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+\n+import java.util.concurrent.*;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  @Inject\n+  public CustomThreadPoolExecutorService(\n+      @Named(\"CORE-POOL-SIZE\") int corePoolSize,\n+      @Named(\"MAX-POOL-SIZE\") int maximumPoolSize,\n+      @Named(\"KEEP-ALIVE-TIME-IN-SECONDS\") int keepAliveTim,\n+      @Named(\"CORE-POOL-SIZE-FOR-SCHEDULED-POOL\") int corePoolSizeForScheduledThreadPool) {\n+    this.corePoolSize = corePoolSize;\n+    this.maximumPoolSize = maximumPoolSize;\n+    this.keepAliveTime = keepAliveTime;\n+    this.corePoolSizeForScheduledThreadPool = corePoolSizeForScheduledThreadPool;\n+  }\n+\n+  private ExecutorService getThreadPoolExecutor(\n+      int corePoolSize, int maxPoolSize, long keepAliveTime) {\n+    return new ThreadPoolExecutor(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYzNTIzNA==", "bodyText": "I suppose that this getter also must return the same ThreadPool each time.\nI see that you want to rewrite getScheduledThreadPoolExecutor, I just want to mark this place for not to forget.\n\ndone", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519635234", "createdAt": "2020-11-09T08:40:50Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+\n+import java.util.concurrent.*;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  @Inject\n+  public CustomThreadPoolExecutorService(\n+      @Named(\"CORE-POOL-SIZE\") int corePoolSize,\n+      @Named(\"MAX-POOL-SIZE\") int maximumPoolSize,\n+      @Named(\"KEEP-ALIVE-TIME-IN-SECONDS\") int keepAliveTim,\n+      @Named(\"CORE-POOL-SIZE-FOR-SCHEDULED-POOL\") int corePoolSizeForScheduledThreadPool) {\n+    this.corePoolSize = corePoolSize;\n+    this.maximumPoolSize = maximumPoolSize;\n+    this.keepAliveTime = keepAliveTime;\n+    this.corePoolSizeForScheduledThreadPool = corePoolSizeForScheduledThreadPool;\n+  }\n+\n+  private ExecutorService getThreadPoolExecutor(\n+      int corePoolSize, int maxPoolSize, long keepAliveTime) {\n+    return new ThreadPoolExecutor(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIwOQ=="}, "originalCommit": {"oid": "ea27044a59b96aceb9db2c8e860090b07bc56442"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODYwMzAzOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMzoyMjo0MVrOHvutog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMzoyMjo0MVrOHvutog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgxMDQ2Ng==", "bodyText": "Why do you store those values?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519810466", "createdAt": "2020-11-09T13:22:41Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+import lombok.NonNull;\n+\n+import java.util.Map;\n+import java.util.concurrent.*;\n+\n+import static java.util.Collections.singletonMap;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private static final String CUSTOM_THREAD_POOL = \"CUSTOM_THREAD_POOL\";\n+  private static final String CUSTOM_SCHEDULED_THREAD_POOL = \"CUSTOM_SCHEDULED_THREAD_POOL\";\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c2f16d38e7dbf624fed54d4b2c6181c3c2a17d9"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODYwNDMwOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMzoyMzowMVrOHvuuYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMzo1NDo0NFrOHvv8HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgxMDY1Ng==", "bodyText": "Why don't store the executors without maps?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519810656", "createdAt": "2020-11-09T13:23:01Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+import lombok.NonNull;\n+\n+import java.util.Map;\n+import java.util.concurrent.*;\n+\n+import static java.util.Collections.singletonMap;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private static final String CUSTOM_THREAD_POOL = \"CUSTOM_THREAD_POOL\";\n+  private static final String CUSTOM_SCHEDULED_THREAD_POOL = \"CUSTOM_SCHEDULED_THREAD_POOL\";\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  private Map<String, ExecutorService> executorServiceMap = Map.of();\n+  private Map<String, ScheduledExecutorService> scheduledExecutorServiceMap = Map.of();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c2f16d38e7dbf624fed54d4b2c6181c3c2a17d9"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgzMDU1Ng==", "bodyText": "Why don't store the executors without maps?\nI will change it, but honestly initial solution (static class) was quite sufficient for our case. These injected services are exceeding its role.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519830556", "createdAt": "2020-11-09T13:54:44Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+import lombok.NonNull;\n+\n+import java.util.Map;\n+import java.util.concurrent.*;\n+\n+import static java.util.Collections.singletonMap;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {\n+\n+  private static final String CUSTOM_THREAD_POOL = \"CUSTOM_THREAD_POOL\";\n+  private static final String CUSTOM_SCHEDULED_THREAD_POOL = \"CUSTOM_SCHEDULED_THREAD_POOL\";\n+\n+  private int corePoolSize;\n+  private int maximumPoolSize;\n+  private int keepAliveTime;\n+  private int corePoolSizeForScheduledThreadPool;\n+\n+  private Map<String, ExecutorService> executorServiceMap = Map.of();\n+  private Map<String, ScheduledExecutorService> scheduledExecutorServiceMap = Map.of();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgxMDY1Ng=="}, "originalCommit": {"oid": "6c2f16d38e7dbf624fed54d4b2c6181c3c2a17d9"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODYyMTU1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMzoyNzoyNVrOHvu47Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDowNDozNVrOHvwWUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgxMzM1Nw==", "bodyText": "The name doesn't reflect the purpose of the class. It is either a Provider that just holds and returns the executors or an Executor, but in this case, it should not expose the nested executors and just provide the API to control the tasks.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519813357", "createdAt": "2020-11-09T13:27:25Z", "author": {"login": "temanbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+import lombok.NonNull;\n+\n+import java.util.Map;\n+import java.util.concurrent.*;\n+\n+import static java.util.Collections.singletonMap;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c2f16d38e7dbf624fed54d4b2c6181c3c2a17d9"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgzNzI2NA==", "bodyText": "Changed, will rebase and squash", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r519837264", "createdAt": "2020-11-09T14:04:35Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.broadcom.lsp.cobol.service.utils;\n+\n+import com.google.inject.Inject;\n+import com.google.inject.Singleton;\n+import com.google.inject.name.Named;\n+import lombok.NonNull;\n+\n+import java.util.Map;\n+import java.util.concurrent.*;\n+\n+import static java.util.Collections.singletonMap;\n+\n+/**\n+ * {@inheritDoc}\n+ *\n+ * <p>Implements API for our CustomThreadPoolExecutor created using ThreadPoolExecutor and\n+ * ScheduledThreadPoolExecutor.\n+ *\n+ * <p>The main configuration parameters are: corePoolSize, maximumPoolSize, and keepAliveTime. The\n+ * pool consists of a fixed number of core threads that are kept inside all the time, and some\n+ * excessive threads that may be spawned and then terminated when they are not needed anymore.\n+ */\n+@Singleton\n+public class CustomThreadPoolExecutorService implements CustomThreadPoolExecutor {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgxMzM1Nw=="}, "originalCommit": {"oid": "6c2f16d38e7dbf624fed54d4b2c6181c3c2a17d9"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NDQ4MDY4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzowOToxMVrOHwmr1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwODoyNDowMFrOHxC9ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyNzUxMQ==", "bodyText": "Please, add the LICENSE header.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r520727511", "createdAt": "2020-11-10T17:09:11Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutor.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package com.broadcom.lsp.cobol.service.utils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05a95eb60c9ef6fe0ad465dcb25eda581252bfda"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTE5MDc1Ng==", "bodyText": "Please, add the LICENSE header.\n\noops, done", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r521190756", "createdAt": "2020-11-11T08:24:00Z", "author": {"login": "asatklichov"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutor.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package com.broadcom.lsp.cobol.service.utils;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyNzUxMQ=="}, "originalCommit": {"oid": "05a95eb60c9ef6fe0ad465dcb25eda581252bfda"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NDQ4MTg1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzowOToyMVrOHwmsdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzowOToyMVrOHwmsdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyNzY2OQ==", "bodyText": "Please, add the LICENSE header.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r520727669", "createdAt": "2020-11-10T17:09:21Z", "author": {"login": "grianbrcom"}, "path": "server/src/main/java/com/broadcom/lsp/cobol/service/utils/CustomThreadPoolExecutorService.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.broadcom.lsp.cobol.service.utils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05a95eb60c9ef6fe0ad465dcb25eda581252bfda"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NDQ4Njc3OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/com/broadcom/lsp/cobol/utils/CustomThreadPoolExecutorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzoxMDozMFrOHwmvcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzoxMDozMFrOHwmvcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyODQzMg==", "bodyText": "Please, add the LICENSE header.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/622#discussion_r520728432", "createdAt": "2020-11-10T17:10:30Z", "author": {"login": "grianbrcom"}, "path": "server/src/test/java/com/broadcom/lsp/cobol/utils/CustomThreadPoolExecutorTest.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.broadcom.lsp.cobol.utils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05a95eb60c9ef6fe0ad465dcb25eda581252bfda"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3831, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}