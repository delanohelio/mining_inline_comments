{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMDExNjE1", "number": 331, "title": "fix: Create a .gitignore file if it doesn't exist #329", "bodyText": "Signed-off-by: asatklichov azat.satklichov@broadcom.com", "createdAt": "2020-05-04T15:11:00Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331", "merged": true, "mergeCommit": {"oid": "4711fbf198773545e2103eb0276250ab7a093268"}, "closed": true, "closedAt": "2020-05-26T13:17:26Z", "author": {"login": "asatklichov"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceA2LLgH2gAyNDEzMDExNjE1OjQwY2E5ZjdmM2M0NDVkZjg5NGZiZTdmMDUwYzQ1MDY0NTgwYTMxMGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclEX-KgFqTQxODI3Nzg2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "40ca9f7f3c445df894fbe7f050c45064580a310a", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/40ca9f7f3c445df894fbe7f050c45064580a310a", "committedDate": "2020-05-04T15:02:59Z", "message": "fix: Create a .gitignore file if it doesn't exist #329\n\nSigned-off-by: as892333 <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MTAxOTE0", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-405101914", "createdAt": "2020-05-04T15:33:51Z", "commit": {"oid": "40ca9f7f3c445df894fbe7f050c45064580a310a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "606b8d2d5528b61e0d82b7a40ba0631ba7686164", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/606b8d2d5528b61e0d82b7a40ba0631ba7686164", "committedDate": "2020-05-04T16:03:57Z", "message": "revert changes\n\nSigned-off-by: as892333 <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7b73fb7aa26dcb56224034fa70e80de9e908bfb", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/b7b73fb7aa26dcb56224034fa70e80de9e908bfb", "committedDate": "2020-05-14T09:45:28Z", "message": "Merge branch 'development' into create-gitignore-file-if-not-exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dcdbfffd494bdcb71dae71d9bcb62d9e431a1c2", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8dcdbfffd494bdcb71dae71d9bcb62d9e431a1c2", "committedDate": "2020-05-22T14:13:53Z", "message": "re-organize with .c4z folder and create .gitignore\n\nSigned-off-by: as892333 <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0061956b975d4042f2d599ff902d158db64c3c9", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c0061956b975d4042f2d599ff902d158db64c3c9", "committedDate": "2020-05-22T15:22:34Z", "message": "Merge branch 'development' into create-gitignore-file-if-not-exists\n\n# Conflicts:\n#\tclients/cobol-lsp-vscode-extension/src/services/CopybooksDownloader.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ee9409194bacfa933a513351d12c2be1afdc31e", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1ee9409194bacfa933a513351d12c2be1afdc31e", "committedDate": "2020-05-22T15:27:37Z", "message": "\"typo\"\n\nSigned-off-by: as892333 <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4924b731d2c1d4c6608a290057948c10f7e8938a", "committedDate": "2020-05-25T11:55:57Z", "message": "\"fix: re-organize with .c4z folder and create .gitignore #331\"\n\nSigned-off-by: Azat Satklichov <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NzY3MzU1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-417767355", "createdAt": "2020-05-25T15:05:28Z", "commit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxNTowNToyOFrOGaD9gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxNToyMDo1M1rOGaEW6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4MTA1OA==", "bodyText": "@ishche should it be here, what do you think? As well as package-lock.json changes?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r429981058", "createdAt": "2020-05-25T15:05:28Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -114,7 +114,7 @@\n         \"test\": \"jest -w 1\"\n     },\n     \"dependencies\": {\n-        \"@zowe/imperative\": \"^4.4.5\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4NTk3OA==", "bodyText": "This logging pattern doesn't meet the requirements because it should have a descriptive error message and the caught throwable.\nIt may be like: log.error(\"Error creating parent directories for path\", e);", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r429985978", "createdAt": "2020-05-25T15:16:58Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/utils/FileSystemUtils.java", "diffHunk": "@@ -165,6 +192,21 @@ public Path getPath(@Nonnull String basePath, @Nonnull String... more) {\n         .collect(Collectors.toList());\n   }\n \n+  /**\n+   * Creates a directory by creating all nonexistent parent directories first.\n+   *\n+   * @param path\n+   * @return\n+   */\n+  public Path createFolders(Path path) {\n+    try {\n+      return Files.createDirectories(path);\n+    } catch (IOException e) {\n+      log.error(e.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4NjQ2Ng==", "bodyText": "Good idea to refactor it like that!", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r429986466", "createdAt": "2020-05-25T15:18:07Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/utils/FileSystemUtils.java", "diffHunk": "@@ -150,6 +157,26 @@ public Path getPath(@Nonnull String basePath, @Nonnull String... more) {\n     return Paths.get(basePath, more);\n   }\n \n+  /**\n+   * Returns full path for copybook folder which is inside .ch4z folder\n+   *\n+   * @param workspacePath\n+   * @return - full path\n+   */\n+  public Path getCopybookFolderPath(String workspacePath) {\n+    return getPath(workspacePath, C4Z_FOLDER, COPYBOOKS_FOLDER);\n+  }\n+\n+  /**\n+   * Returns full path for cobdeps folder which is inside .ch4z folder\n+   *\n+   * @param workspacePath\n+   * @return - full path\n+   */\n+  public Path getCobolDependencyFolderPath(String workspacePath) {\n+    return getPath(workspacePath, C4Z_FOLDER, COBDEPS_FOLDER);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4NzU2Mg==", "bodyText": "I would prefer to have these and following cosmetic changes (i.e. typos, documentation etc.) as a part of a separate PR with tag #23", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r429987562", "createdAt": "2020-05-25T15:20:53Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-core-cobol-parser/src/test/java/com/ca/lsp/core/cobol/AbstractCobolLinePreprocessorTest.java", "diffHunk": "@@ -15,14 +15,15 @@\n \n import com.ca.lsp.core.cobol.model.ResultWithErrors;\n import com.ca.lsp.core.cobol.preprocessor.sub.CobolLine;\n+import com.ca.lsp.core.cobol.preprocessor.sub.line.reader.CobolLineReader;\n import com.ca.lsp.core.cobol.preprocessor.sub.line.reader.impl.CobolLineReaderImpl;\n \n import java.util.List;\n \n public abstract class AbstractCobolLinePreprocessorTest {\n \n   protected ResultWithErrors<List<CobolLine>> processText(String text) {\n-    CobolLineReaderImpl reader = new CobolLineReaderImpl();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDMxNTgw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-418031580", "createdAt": "2020-05-26T07:21:56Z", "commit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDY5NzM4", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-418069738", "createdAt": "2020-05-26T08:16:44Z", "commit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxNjo0NFrOGaTfOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoyMjo0N1rOGaTsiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNTQ1MA==", "bodyText": "findFiles uses a global pattern as argument. It's not OS specific AFAIK.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r430235450", "createdAt": "2020-05-26T08:16:44Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksDownloader.ts", "diffHunk": "@@ -33,7 +34,7 @@ export class CopybooksDownloader implements vscode.Disposable {\n         private pathGenerator: CopybooksPathGenerator) { }\n \n     public async redownloadDependencies(message: string = \"Redownload dependencies requested.\") {\n-        (await vscode.workspace.findFiles(DEPENDENCIES_FOLDER + \"/**/*.dep\")).forEach(dep => {\n+        (await vscode.workspace.findFiles(path.join(C4Z_FOLDER, DEPENDENCIES_FOLDER) + \"/**/*.dep\")).forEach(dep => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNzExMA==", "bodyText": "vscode.workspace.workspaceFolders[0] can be undefine", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r430237110", "createdAt": "2020-05-26T08:19:42Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/services/Settings.ts", "diffHunk": "@@ -28,4 +30,33 @@ export function initializeSettings() {\n \n function isUndefinedInWorkspace(property: string, index: number, array: string[]): boolean {\n     return vscode.workspace.getConfiguration(SETTINGS_SECTION).inspect(property).workspaceValue == undefined;\n+}\n+\n+\n+/**\n+ * New file (e.g .gitignore) will be created or edited if exits, under project folder (e.g. workspace/.c4z) with given  pattern\n+ * \n+ * @param path \n+ * @param fileName \n+ * @param pattern \n+ */\n+export function createFileWithGivenPath(folderPath: string, fileName: string, pattern: string): void {\n+\n+    const ch4zPath = path.join(vscode.workspace.workspaceFolders[0].uri.fsPath, folderPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzODg1Ng==", "bodyText": "Did you try the case if the user opens a new folder or change branch?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r430238856", "createdAt": "2020-05-26T08:22:47Z", "author": {"login": "ishche"}, "path": "clients/cobol-lsp-vscode-extension/src/extension.ts", "diffHunk": "@@ -92,11 +93,14 @@ export async function activate(context: vscode.ExtensionContext) {\n             new CopybooksCodeActionProvider(profileService)));\n }\n \n-function initWorkspaceTracker(downloader: CopybooksDownloader): vscode.Disposable {\n+function initWorkspaceWatcher(downloader: CopybooksDownloader): vscode.Disposable {\n     const watcher = vscode.workspace.createFileSystemWatcher(\"**/\"\n-        + DEPENDENCIES_FOLDER + \"/**/**.dep\", false, false, true);\n+        + path.join(C4Z_FOLDER, DEPENDENCIES_FOLDER) + \"/**/**.dep\", false, false, true);\n     watcher.onDidCreate(uri => downloader.downloadDependencies(uri,\n         \"Program contains dependencies to missing copybooks.\"));\n     watcher.onDidChange(uri => downloader.downloadDependencies(uri));\n+\n+    //create .gitignore file within .c4z folder\n+    createFileWithGivenPath(C4Z_FOLDER, GITIGNORE_FILE, \"/**\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4924b731d2c1d4c6608a290057948c10f7e8938a"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e8e8af521e7106c23074dc2acaa0b8888689165", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4e8e8af521e7106c23074dc2acaa0b8888689165", "committedDate": "2020-05-26T09:03:10Z", "message": "fix: refactor on review #331\n\nSigned-off-by: Azat Satklichov <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e08b6304dc09c03df6d26a86f98c42e5975ae333", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e08b6304dc09c03df6d26a86f98c42e5975ae333", "committedDate": "2020-05-26T10:12:31Z", "message": "Update package-lock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTc3NzQz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-418177743", "createdAt": "2020-05-26T10:43:24Z", "commit": {"oid": "4e8e8af521e7106c23074dc2acaa0b8888689165"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMDo0MzoyNFrOGaYptQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMDo0MzoyNFrOGaYptQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDMyMDA1Mw==", "bodyText": "In this case, it won't print the stack trace of the exception. To do that, you may use the method Logger#error(String, Throwable)", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#discussion_r430320053", "createdAt": "2020-05-26T10:43:24Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/utils/FileSystemUtils.java", "diffHunk": "@@ -202,7 +202,7 @@ public Path createFolders(Path path) {\n     try {\n       return Files.createDirectories(path);\n     } catch (IOException e) {\n-      log.error(e.getMessage());\n+      log.error(\"Error creating folders for \"+ path + \": \" + e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e8e8af521e7106c23074dc2acaa0b8888689165"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac65f46cecd95fd256269ba04b1c09d437cab95e", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/ac65f46cecd95fd256269ba04b1c09d437cab95e", "committedDate": "2020-05-26T10:44:01Z", "message": "fix: update activation event #331\n\nSigned-off-by: Azat Satklichov <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d830593b24e719ebea04987353deddcd0a30a573", "author": {"user": {"login": "asatklichov", "name": "Azat Satklichov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/d830593b24e719ebea04987353deddcd0a30a573", "committedDate": "2020-05-26T10:51:24Z", "message": "fix: err-log #331\n\nSigned-off-by: Azat Satklichov <azat.satklichov@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MjAyOTQy", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-418202942", "createdAt": "2020-05-26T11:22:36Z", "commit": {"oid": "d830593b24e719ebea04987353deddcd0a30a573"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4Mjc3ODYx", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/331#pullrequestreview-418277861", "createdAt": "2020-05-26T13:07:05Z", "commit": {"oid": "d830593b24e719ebea04987353deddcd0a30a573"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1079, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}