{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2Nzc2MTY4", "number": 452, "title": "fix: disable copybook analysis only on extended document", "bodyText": "Hotfix that address an issue introduce by #441\nIn particular when document is in did_change mode, copybooks analysis needs to be skipped ONLY if the document is an extended document.", "createdAt": "2020-08-12T13:34:24Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452", "merged": true, "mergeCommit": {"oid": "bf497cfd4431f8d1073c88eda669925f145d8a3c"}, "closed": true, "closedAt": "2020-08-13T09:44:18Z", "author": {"login": "zacanbrcom"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-LUyhgH2gAyNDY2Nzc2MTY4OjA2MjA3M2YzMWIxOTYxYTAyYTFjZTJlNzVhZDA3ODVjZmVhYjA5OTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-cilLAFqTQ2NjU5MjYxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "062073f31b1961a02a1ce2e75ad0785cfeab0999", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/062073f31b1961a02a1ce2e75ad0785cfeab0999", "committedDate": "2020-08-12T13:21:03Z", "message": "fix: disable copybook analysis only on extended document"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1OTQ0MjI3", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#pullrequestreview-465944227", "createdAt": "2020-08-12T13:59:35Z", "commit": {"oid": "062073f31b1961a02a1ce2e75ad0785cfeab0999"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1OTozNVrOG_iokw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1OTozNVrOG_iokw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4MDkxNQ==", "bodyText": "!\"SKIP\".equals(copybookProcessingMode)", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#discussion_r469280915", "createdAt": "2020-08-12T13:59:35Z", "author": {"login": "asatklichov"}, "path": "com.ca.lsp.cobol/lsp-core-cobol-parser/src/main/java/com/ca/lsp/core/cobol/preprocessor/sub/document/impl/CobolSemanticParserListenerImpl.java", "diffHunk": "@@ -138,7 +138,7 @@ public void exitCopyStatement(@Nonnull CopyStatementContext ctx) {\n      * define the copy book\n      */\n \n-    if (copybookProcessingMode.equals(\"ENABLED\")) {\n+    if (!copybookProcessingMode.equals(\"SKIP\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "062073f31b1961a02a1ce2e75ad0785cfeab0999"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc52f01d40f277932f12d33d8de7b8c35f05a2d3", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/dc52f01d40f277932f12d33d8de7b8c35f05a2d3", "committedDate": "2020-08-13T07:05:56Z", "message": "refactor: simplify logic getting rid of text document sync type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "803579668d2cef7a1ee25002a6e1040273dd7084", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/803579668d2cef7a1ee25002a6e1040273dd7084", "committedDate": "2020-08-13T07:06:22Z", "message": "Merge remote-tracking branch 'remotes/origin/development' into hotfix_did_change_cpy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90b21dd31c12b0d58f628a8fb2555b9dc60774d7", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/90b21dd31c12b0d58f628a8fb2555b9dc60774d7", "committedDate": "2020-08-13T08:45:43Z", "message": "fix: avoid partially copybook names to be in queue for download"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NTc1MzQz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#pullrequestreview-466575343", "createdAt": "2020-08-13T09:01:49Z", "commit": {"oid": "90b21dd31c12b0d58f628a8fb2555b9dc60774d7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOTowMTo0OVrOHACm9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwOTowNDowOFrOHACr8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNDc4OA==", "bodyText": "Shouldn't the modes here be the same?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#discussion_r469804788", "createdAt": "2020-08-13T09:01:49Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/service/DocumentExtensionTests.java", "diffHunk": "@@ -82,11 +82,11 @@ private void checkExtensionMatches(String extension) {\n     fireDidOpen(extension, uri);\n     verify(engine, timeout(10000).times(1)).analyze(uri, TEXT, CopybookProcessingMode.ENABLED);\n \n-    when(engine.analyze(uri, TEXT, CopybookProcessingMode.DISABLED))\n+    when(engine.analyze(uri, TEXT, CopybookProcessingMode.ENABLED))\n         .thenReturn(AnalysisResult.empty());\n     fireDidChange(uri);\n     verify(engine, timeout(10000))\n-        .analyze(uri, INCORRECT_TEXT_EXAMPLE, CopybookProcessingMode.DISABLED);\n+        .analyze(uri, INCORRECT_TEXT_EXAMPLE, CopybookProcessingMode.SKIP);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90b21dd31c12b0d58f628a8fb2555b9dc60774d7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTgwNjA2NQ==", "bodyText": "In fact, you may pass sync type as an enum value, not as a string, and just compare them by link equity", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#discussion_r469806065", "createdAt": "2020-08-13T09:04:08Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CopybookProcessingMode.java", "diffHunk": "@@ -14,32 +14,40 @@\n  */\n package com.ca.lsp.cobol.service;\n \n+import javax.annotation.Nonnull;\n+\n import static com.ca.lsp.cobol.service.utils.WorkspaceFileService.isFileUnderExtendedSourceFolder;\n \n-/** This enum class used to track text synchronization type for the processed document. */\n+/** This enum class used to allow or not the copybook analysis for the processed document. */\n public enum CopybookProcessingMode {\n   ENABLED,\n-  DISABLED;\n+  DISABLED,\n+  SKIP;\n \n   /**\n-   * This method verify if enable or disable copybook management based on two factors: 1) the file\n-   * is an extended source file, 2) the file is open in DID_OPEN|DID_CHANGE\n+   * This method allow to enable or disable copybook management based on two factors: 1) the file is\n+   * an extended source file, 2) the file is open in DID_OPEN|DID_CHANGE\n    *\n    * @param uri of the document opened in the editor by the client\n-   * @param textDocSyncType define the document sync mode that could be [{@link\n-   *     TextDocumentSyncType#DID_OPEN}|{@link TextDocumentSyncType#DID_CHANGE}]\n+   * @param textDocumentSyncType the sync type of the document [{@link\n+   *     TextDocumentSyncType#DID_OPEN} or {@link TextDocumentSyncType#DID_CHANGE}]\n    * @return A value of that could be [{@link CopybookProcessingMode#ENABLED}|{@link\n-   *     CopybookProcessingMode#DISABLED}]\n+   *     CopybookProcessingMode#DISABLED}] if the document is an extended document.\n    */\n   public static CopybookProcessingMode getCopybookProcessingMode(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90b21dd31c12b0d58f628a8fb2555b9dc60774d7"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28c4c6331ef41601af9d9130f949c2825b4c3498", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/28c4c6331ef41601af9d9130f949c2825b4c3498", "committedDate": "2020-08-13T09:16:16Z", "message": "fix: use enum instead of string and update test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NTkwMjQz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#pullrequestreview-466590243", "createdAt": "2020-08-13T09:21:14Z", "commit": {"oid": "28c4c6331ef41601af9d9130f949c2825b4c3498"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NTkyNjE3", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/452#pullrequestreview-466592617", "createdAt": "2020-08-13T09:24:30Z", "commit": {"oid": "28c4c6331ef41601af9d9130f949c2825b4c3498"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 981, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}