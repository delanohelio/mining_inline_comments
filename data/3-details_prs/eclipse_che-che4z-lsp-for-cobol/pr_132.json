{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMDYxMDc3", "number": 132, "title": "Engineering excellence for core #23", "bodyText": "Preparation for introducing DI for the language engine core.\nStage one is to remove the unused fields of data classes in order to simplify the syntax error definition.\nStage two is to remove the preprocessor listener and return the processing result of any class that is not generated in a pair with a list of errors in order to not to store any state inside functional classes.", "createdAt": "2020-01-09T16:56:05Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132", "merged": true, "mergeCommit": {"oid": "6f969b62caff9f75d88ee32db40e858b7fc34b7e"}, "closed": true, "closedAt": "2020-01-10T15:51:32Z", "author": {"login": "temanbrcom"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4VB1hAH2gAyMzYxMDYxMDc3OjIwOTk1NDYzZjJiODllZGU3ZjU2NDEzNDgwZjFjOTVjYjIwNDUwZmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5AbKigFqTM0MTE4ODY0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "20995463f2b89ede7f56413480f1c95cb20450ff", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/20995463f2b89ede7f56413480f1c95cb20450ff", "committedDate": "2020-01-08T13:04:42Z", "message": "Remove unused field tokenIndex of Position  #23"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32542bda7aa9f6380a34d16f414910d9cd09b128", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/32542bda7aa9f6380a34d16f414910d9cd09b128", "committedDate": "2020-01-08T15:13:32Z", "message": "Remove unused fields of SyntaxError #23"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMDQ1NjU4", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132#pullrequestreview-341045658", "createdAt": "2020-01-10T09:36:00Z", "commit": {"oid": "32542bda7aa9f6380a34d16f414910d9cd09b128"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwOTozNjowMFrOFcOqrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwOTozNjowMFrOFcOqrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTE0NDc0OA==", "bodyText": "ruleStack can be a very good part of our new mapping implementation idea", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132#discussion_r365144748", "createdAt": "2020-01-10T09:36:00Z", "author": {"login": "sergiuilie"}, "path": "com.ca.lsp.cobol/lsp-core-cobol-parser/src/main/java/com/ca/lsp/core/cobol/model/SyntaxError.java", "diffHunk": "@@ -19,22 +19,15 @@\n import lombok.Builder;\n import lombok.Value;\n \n-import java.util.List;\n-\n @Value\n public class SyntaxError {\n   private final Position position;\n-  private final List<String> ruleStack;\n-  private final int type;\n   private final String suggestion;\n   private final int severity;\n \n   @Builder(builderMethodName = \"syntaxerror\")\n-  public SyntaxError(\n-      Position position, List<String> ruleStack, int type, String suggestion, int severity) {\n+  public SyntaxError(Position position, String suggestion, int severity) {\n     this.position = position;\n-    this.ruleStack = ruleStack;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32542bda7aa9f6380a34d16f414910d9cd09b128"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c978e121611e7a9e431442d056f4814e30ee132", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2c978e121611e7a9e431442d056f4814e30ee132", "committedDate": "2020-01-10T10:09:26Z", "message": "Return rule stack tracing due to it may be useful for debug #23"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "063d736a1bff53512a94a265566845771cb0087c", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/063d736a1bff53512a94a265566845771cb0087c", "committedDate": "2020-01-10T10:12:51Z", "message": "Rename builder in order to keep naming convention #23"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMDgzMjIw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132#pullrequestreview-341083220", "createdAt": "2020-01-10T10:43:01Z", "commit": {"oid": "063d736a1bff53512a94a265566845771cb0087c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "266d2ee8e662ea1c67eaa8fb9847c7be99723fe0", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/266d2ee8e662ea1c67eaa8fb9847c7be99723fe0", "committedDate": "2020-01-10T11:26:36Z", "message": "Remove preprocessor listener usages to make classes functional GH-23\nAn iteration of preparation for introducing dependecy injection for enginge core. Replace providing a listener with returning of result in a pair with found errors.\nThis allows to get rid of the shared state between classes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "418e68c2c7a11b42fdf930678472f552244b7f69", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/418e68c2c7a11b42fdf930678472f552244b7f69", "committedDate": "2020-01-10T13:59:30Z", "message": "Merge branch 'development' into engineering-excellence"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6d0e8fd736b7d5a03029aad239efb09c50d777", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1e6d0e8fd736b7d5a03029aad239efb09c50d777", "committedDate": "2020-01-10T14:11:06Z", "message": "Fix merge conflicts after cleaning-up of data classes #23"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMTg4NjQz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132#pullrequestreview-341188643", "createdAt": "2020-01-10T14:17:26Z", "commit": {"oid": "1e6d0e8fd736b7d5a03029aad239efb09c50d777"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNDoxNzoyNlrOFcVTHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNDoxNzoyNlrOFcVTHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI1MzQwNA==", "bodyText": "should be final", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/132#discussion_r365253404", "createdAt": "2020-01-10T14:17:26Z", "author": {"login": "sergiuilie"}, "path": "com.ca.lsp.cobol/lsp-core-cobol-parser/src/main/java/com/ca/lsp/core/cobol/engine/CobolLanguageEngine.java", "diffHunk": "@@ -45,19 +45,22 @@ public CobolLanguageEngine(CobolSourceFormat sourceFormat) {\n     this.sourceFormat = sourceFormat;\n   }\n \n-  public ProcessingResult run(String in) {\n-    List<SyntaxError> errors = new CopyOnWriteArrayList<>();\n+  public ResultWithErrors<SemanticContext> run(String in) {\n+\n     CobolPreprocessorImpl preprocessor = new CobolPreprocessorImpl();\n-    preprocessor.setListener(new PreprocessorListener(errors));\n \n-    final PreprocessedInput preProcessedInput = preprocessor.process(in, sourceFormat);\n-    final CobolLexer lexer = new CobolLexer(CharStreams.fromString(preProcessedInput.getInput()));\n+    ResultWithErrors<PreprocessedInput> preProcessedInput = preprocessor.process(in, sourceFormat);\n+\n+    CobolLexer lexer =\n+        new CobolLexer(CharStreams.fromString(preProcessedInput.getResult().getInput()));\n+\n+    List<SyntaxError> errors = new ArrayList<>(preProcessedInput.getErrors());\n \n     lexer.removeErrorListeners();\n     lexer.addErrorListener(new VerboseListener(errors));\n \n-    final CommonTokenStream tokens = new CommonTokenStream(lexer);\n-    final CobolParser parser = new CobolParser(tokens);\n+    CommonTokenStream tokens = new CommonTokenStream(lexer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e6d0e8fd736b7d5a03029aad239efb09c50d777"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1162, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}