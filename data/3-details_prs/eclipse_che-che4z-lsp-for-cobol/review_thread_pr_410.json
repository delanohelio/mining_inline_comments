{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNzg2NjU4", "number": 410, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyNjoyMlrOEK1qQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyOTowMlrOEK1thQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5ODAwMzg2OnYy", "diffSide": "RIGHT", "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CopybookServiceImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyNjoyMlrOGsG8jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyNjoyMlrOGsG8jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkwNDMzNA==", "bodyText": "Maybe, it will be better to use Set of uris here.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/410#discussion_r448904334", "createdAt": "2020-07-02T10:26:22Z", "author": {"login": "grianbrcom"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CopybookServiceImpl.java", "diffHunk": "@@ -127,26 +126,36 @@ private void handleRequiredCopybookEvent(RequiredCopybookEvent event) {\n   /**\n    * Sends downloading requests to the Client for copybooks not presented locally, if any.\n    *\n-   * <p>A list of missed copybooks grouped by document URI.\n+   * <p>A list of missed copybooks grouped by document URI, including nested copybooks.\n    *\n    * @param event - document analysis done\n    */\n   private void handleAnalysisFinishedEvent(AnalysisFinishedEvent event) {\n-    String cobolFileName = files.getNameFromURI(event.getDocumentUri());\n-    if (copybooksForDownloading.containsKey(cobolFileName)) {\n-      settingsService\n-              .getConfigurations(copybooksForDownloading.remove(cobolFileName).stream()\n-                      .map(copybook -> Joiner.on(\".\").join(COPYBOOK_DOWNLOAD.label, cobolFileName, copybook))\n-                      .collect(Collectors.toList()));\n+    List<String> uris = new ArrayList<>(event.getUris());\n+    String documentUri = event.getDocumentUri();\n+    if (!uris.contains(documentUri)) uris.add(documentUri);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8c997fe47e6f63323fbd6a1734a8768c7ccc7e5"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5ODAxMjIxOnYy", "diffSide": "RIGHT", "path": "com.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/model/AnalysisFinishedEvent.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyOTowMlrOGsHBnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDozNzo1N1rOGsHTUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkwNTYyOQ==", "bodyText": "copybookUris will better suit here.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/410#discussion_r448905629", "createdAt": "2020-07-02T10:29:02Z", "author": {"login": "grianbrcom"}, "path": "com.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/model/AnalysisFinishedEvent.java", "diffHunk": "@@ -16,19 +16,26 @@\n \n import lombok.Builder;\n import lombok.Data;\n+import lombok.EqualsAndHashCode;\n import lombok.NoArgsConstructor;\n \n+import java.util.List;\n+\n /**\n- * This class is a signal object to show that analysis is finished. Contains the uri of analyzed document.\n+ * This class is a signal object to show that analysis finished. Contains the uri of analyzed\n+ * document.\n  */\n+@EqualsAndHashCode(callSuper = false)\n @NoArgsConstructor\n @Data\n-public class AnalysisFinishedEvent extends DataEvent{\n-    private String documentUri;\n+public class AnalysisFinishedEvent extends DataEvent {\n+  private String documentUri;\n+  private List<String> uris;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8c997fe47e6f63323fbd6a1734a8768c7ccc7e5"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkxMDE2MA==", "bodyText": "I agree, will do", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/410#discussion_r448910160", "createdAt": "2020-07-02T10:37:57Z", "author": {"login": "temanbrcom"}, "path": "com.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/model/AnalysisFinishedEvent.java", "diffHunk": "@@ -16,19 +16,26 @@\n \n import lombok.Builder;\n import lombok.Data;\n+import lombok.EqualsAndHashCode;\n import lombok.NoArgsConstructor;\n \n+import java.util.List;\n+\n /**\n- * This class is a signal object to show that analysis is finished. Contains the uri of analyzed document.\n+ * This class is a signal object to show that analysis finished. Contains the uri of analyzed\n+ * document.\n  */\n+@EqualsAndHashCode(callSuper = false)\n @NoArgsConstructor\n @Data\n-public class AnalysisFinishedEvent extends DataEvent{\n-    private String documentUri;\n+public class AnalysisFinishedEvent extends DataEvent {\n+  private String documentUri;\n+  private List<String> uris;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkwNTYyOQ=="}, "originalCommit": {"oid": "b8c997fe47e6f63323fbd6a1734a8768c7ccc7e5"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3898, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}