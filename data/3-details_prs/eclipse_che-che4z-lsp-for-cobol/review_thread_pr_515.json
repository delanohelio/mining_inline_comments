{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzOTU1MTU1", "number": 515, "reviewThreads": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOToyODo1OFrOEidkFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDozMzoxN1rOEkeNZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTcxNDE0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryReporterImpl.spec.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOToyODo1OVrOHQWgLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOToyODo1OVrOHQWgLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkwNzk0OQ==", "bodyText": "Optional: externalize this mock in beforeEach(..)  then it can be re-usable in below test", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486907949", "createdAt": "2020-09-11T09:28:59Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryReporterImpl.spec.ts", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const INVALID_TELEMETRY_KEY: string = \"INVALID_INSTRUMENTATION_KEY\";\n+\n+function generatePath(...pathSegments) {\n+    vscode.Uri.file = jest.fn().mockReturnValue({\n+        fsPath: path.join(path.join(__dirname, \"../../\"), ...pathSegments),\n+    });\n+}\n+\n+describe(\"Telemetry key retrieval functionality is able to return a decoded existing key or a default string\", () => {\n+    beforeEach(() => {\n+        jest.clearAllMocks();\n+    });\n+\n+    test(\"Given an existent flat file that contains telemetry key, then the content of that file is not empty and is returned\", async () => {\n+        (ExtensionUtils as any).getExtensionPath = jest.fn().mockReturnValue(path.join(__dirname, \"../../\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTcyODQzOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTozMTozNFrOHQWp0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTozMTozNFrOHQWp0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkxMDQxOA==", "bodyText": "Better naming for \"type\" like eventType.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486910418", "createdAt": "2020-09-11T09:31:34Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+\n+function runScenario(expectedNumberOfCalls, type: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTc2MjY0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTozNzo1MFrOHQXBFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMzo0OTowNFrOHQfobA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkxNjM3Mw==", "bodyText": "Regarding to method definition extracted startTime = Date.now() can be reused", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486916373", "createdAt": "2020-09-11T09:37:50Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+\n+function runScenario(expectedNumberOfCalls, type: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {\n+    if (type === \"log\") {\n+        TelemetryService.registerEvent(eventName, categories, undefined, telemetryMeasurements);\n+        expect(spySendTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    } else {\n+        TelemetryService.registerExceptionEvent(eventName, rootCause, categories);\n+        expect(spySendExceptionTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    }\n+}\n+\n+function setupScenario() {\n+    ExtensionUtils.getIDEName = jest.fn().mockReturnValue(\"testingIde\");\n+    ExtensionUtils.getPackageVersion = jest.fn().mockReturnValue(\"1.0\");\n+    (TelemetryReporterImpl as any).getTelemetryKeyId = jest.fn().mockReturnValue(\"key_id_for_testing_purposes\");\n+    (TelemetryService as any).getUsername = jest.fn().mockReturnValue(USERNAME);\n+    jest.mock(\"vscode-extension-telemetry\");\n+    spySendTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryEvent\");\n+    spySendExceptionTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryErrorEvent\");\n+}\n+\n+describe(\"TelemetryService information are consistent before send them to the telemetry server\", () => {\n+    beforeEach(() => {\n+        jest.clearAllMocks();\n+    });\n+    beforeAll(() => {\n+        setupScenario();\n+    });\n+    afterEach(() => {\n+        jest.clearAllMocks();\n+    });\n+\n+    test(\"Given a fulfilled telemetry event, the data is correctly collected and sent to the telemetry server\", () => {\n+        runScenario(1, \"log\", \"test\");\n+    });\n+\n+    test(\"Given a fulfilled telemetry measurement event, the data is contained as part of a telemetry event and their data are sent to the telemetry server\", () => {\n+        runScenario(1, \"log\", \"test the download\", undefined, undefined, new Map().set(\"time elapsed\", TelemetryService.calculateTimeElapsed(Date.now() - 100, Date.now())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA1NzUxNg==", "bodyText": "You mean something like:\nstartTime = Date.now();\nTelemetryService.calculateTimeElapsed(startTime,Date.now())\n\n?\nI avoided to define this variable just simulating a time elapsed of 0.1 with Date.now()-100 but I could change as above.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r487057516", "createdAt": "2020-09-11T13:49:04Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+\n+function runScenario(expectedNumberOfCalls, type: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {\n+    if (type === \"log\") {\n+        TelemetryService.registerEvent(eventName, categories, undefined, telemetryMeasurements);\n+        expect(spySendTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    } else {\n+        TelemetryService.registerExceptionEvent(eventName, rootCause, categories);\n+        expect(spySendExceptionTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    }\n+}\n+\n+function setupScenario() {\n+    ExtensionUtils.getIDEName = jest.fn().mockReturnValue(\"testingIde\");\n+    ExtensionUtils.getPackageVersion = jest.fn().mockReturnValue(\"1.0\");\n+    (TelemetryReporterImpl as any).getTelemetryKeyId = jest.fn().mockReturnValue(\"key_id_for_testing_purposes\");\n+    (TelemetryService as any).getUsername = jest.fn().mockReturnValue(USERNAME);\n+    jest.mock(\"vscode-extension-telemetry\");\n+    spySendTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryEvent\");\n+    spySendExceptionTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryErrorEvent\");\n+}\n+\n+describe(\"TelemetryService information are consistent before send them to the telemetry server\", () => {\n+    beforeEach(() => {\n+        jest.clearAllMocks();\n+    });\n+    beforeAll(() => {\n+        setupScenario();\n+    });\n+    afterEach(() => {\n+        jest.clearAllMocks();\n+    });\n+\n+    test(\"Given a fulfilled telemetry event, the data is correctly collected and sent to the telemetry server\", () => {\n+        runScenario(1, \"log\", \"test\");\n+    });\n+\n+    test(\"Given a fulfilled telemetry measurement event, the data is contained as part of a telemetry event and their data are sent to the telemetry server\", () => {\n+        runScenario(1, \"log\", \"test the download\", undefined, undefined, new Map().set(\"time elapsed\", TelemetryService.calculateTimeElapsed(Date.now() - 100, Date.now())));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkxNjM3Mw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTc5ODQ5OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTo0NDowNFrOHQXZYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMjo1OTozOVrOHQd0_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkyMjU5Mw==", "bodyText": "to be consistent, please declare to all", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486922593", "createdAt": "2020-09-11T09:44:04Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyMjkwNg==", "bodyText": "Sorry @asatklichov I didn't get what u mean", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r487022906", "createdAt": "2020-09-11T12:50:48Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkyMjU5Mw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNzk2NA==", "bodyText": "Sorry @asatklichov I didn't get what u mean\n\nType declaration, FAKE_ROOT_PATH : string", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r487027964", "createdAt": "2020-09-11T12:59:39Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkyMjU5Mw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTgyMDEwOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/extension.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTo0Nzo0OFrOHQXoAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTo0Nzo0OFrOHQXoAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkyNjMzOQ==", "bodyText": "has wrong", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486926339", "createdAt": "2020-09-11T09:47:48Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/extension.ts", "diffHunk": "@@ -47,6 +50,8 @@ export async function activate(context: vscode.ExtensionContext) {\n         await languageClientService.checkPrerequisites();\n     } catch (err) {\n         vscode.window.showErrorMessage(err.toString());\n+        TelemetryService.registerExceptionEvent(\"RuntimeException\", err.toString(), [\"bootstrap\", \"experiment-tag\"], \"Client have wrong Java version installed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTg1MDAxOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksCodeActionProvider.ts", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwOTo1MzoxMFrOHQX8aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODozMzowMlrOHR21fQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkzMTU2Mw==", "bodyText": "please rephrase \"User hover a miss copybook\"", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486931563", "createdAt": "2020-09-11T09:53:10Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksCodeActionProvider.ts", "diffHunk": "@@ -24,12 +25,14 @@ export class CopybooksCodeActionProvider implements vscode.CodeActionProvider {\n         if (!this.shouldHaveCodeAction(context)) {\n             return [];\n         }\n+        // Telemetry should be collected only if shouldHaveCodeAction is true\n+        TelemetryService.registerEvent(\"QuickFix for copybook activation\", [\"COBOL\", \"hover\", \"copybook\", \"quickfix\"], \"User hover a miss copybook\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzExNjYwMA==", "bodyText": "I tried to do my best to rephrase it not sure about the result \ud83d\udc7c", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r487116600", "createdAt": "2020-09-11T15:19:52Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksCodeActionProvider.ts", "diffHunk": "@@ -24,12 +25,14 @@ export class CopybooksCodeActionProvider implements vscode.CodeActionProvider {\n         if (!this.shouldHaveCodeAction(context)) {\n             return [];\n         }\n+        // Telemetry should be collected only if shouldHaveCodeAction is true\n+        TelemetryService.registerEvent(\"QuickFix for copybook activation\", [\"COBOL\", \"hover\", \"copybook\", \"quickfix\"], \"User hover a miss copybook\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkzMTU2Mw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ4NjI2OQ==", "bodyText": "Seems like here should be something like \"The user hovers a missed copybook\"", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488486269", "createdAt": "2020-09-15T08:33:02Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybooksCodeActionProvider.ts", "diffHunk": "@@ -24,12 +25,14 @@ export class CopybooksCodeActionProvider implements vscode.CodeActionProvider {\n         if (!this.shouldHaveCodeAction(context)) {\n             return [];\n         }\n+        // Telemetry should be collected only if shouldHaveCodeAction is true\n+        TelemetryService.registerEvent(\"QuickFix for copybook activation\", [\"COBOL\", \"hover\", \"copybook\", \"quickfix\"], \"User hover a miss copybook\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjkzMTU2Mw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTkxMzkzOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDowMzowMFrOHQYn-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMTowNjo0NFrOHR8heQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk0MjcxNA==", "bodyText": "This block can be removed (implicitly returns undefined), if logic performed valid content.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486942714", "createdAt": "2020-09-11T10:03:00Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }\n+\n+    private static instance: TelemetryReporterImpl;\n+\n+    /**\n+     * This method return the value of the instrumentation key necessary to create the telemetry reporter from an\n+     * external file configuration. If the file doesn't exists it returns a generic value that will not be valid\n+     * for collect telemetry event.\n+     */\n+    private static getTelemetryKeyId(): string {\n+        return fs.existsSync(this.getTelemetryResourcePath()) ? this.getInstrumentationKey() : TELEMETRY_DEFAULT_CONTENT;\n+    }\n+\n+    private static getTelemetryResourcePath() {\n+        return vscode.Uri.file(\n+            path.join(ExtensionUtils.getExtensionPath(), \"resources\", \"TELEMETRY_KEY\")).fsPath;\n+    }\n+\n+    private static getInstrumentationKey(): string {\n+        return Buffer.from(fs.readFileSync(this.getTelemetryResourcePath(), \"utf8\").replace(/(\\r\\n|\\n|\\r)/gm, \"\"), \"base64\").toString();\n+    }\n+\n+    private static covertData(content: TelemetryEvent) {\n+        return {\n+            categories: content.getCategories().toString(),\n+            event: content.getEventName(),\n+            IDE: ExtensionUtils.getIDEName(),\n+            notes: content.getNotes(),\n+            timestamp: content.getTimestamp(),\n+            rootCause: content.getRootCause(),\n+        };\n+    }\n+\n+    private static convertMeasurements(content: Map<string, number>): TelemetryMeasurement {\n+        if (!content) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3OTQ0OQ==", "bodyText": "You could also use casting if you would like to:\n    private static convertMeasurements(content: Map<string, number>): TelemetryMeasurement {\n        return content as unknown as TelemetryMeasurement;\n    }", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488579449", "createdAt": "2020-09-15T11:06:44Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }\n+\n+    private static instance: TelemetryReporterImpl;\n+\n+    /**\n+     * This method return the value of the instrumentation key necessary to create the telemetry reporter from an\n+     * external file configuration. If the file doesn't exists it returns a generic value that will not be valid\n+     * for collect telemetry event.\n+     */\n+    private static getTelemetryKeyId(): string {\n+        return fs.existsSync(this.getTelemetryResourcePath()) ? this.getInstrumentationKey() : TELEMETRY_DEFAULT_CONTENT;\n+    }\n+\n+    private static getTelemetryResourcePath() {\n+        return vscode.Uri.file(\n+            path.join(ExtensionUtils.getExtensionPath(), \"resources\", \"TELEMETRY_KEY\")).fsPath;\n+    }\n+\n+    private static getInstrumentationKey(): string {\n+        return Buffer.from(fs.readFileSync(this.getTelemetryResourcePath(), \"utf8\").replace(/(\\r\\n|\\n|\\r)/gm, \"\"), \"base64\").toString();\n+    }\n+\n+    private static covertData(content: TelemetryEvent) {\n+        return {\n+            categories: content.getCategories().toString(),\n+            event: content.getEventName(),\n+            IDE: ExtensionUtils.getIDEName(),\n+            notes: content.getNotes(),\n+            timestamp: content.getTimestamp(),\n+            rootCause: content.getRootCause(),\n+        };\n+    }\n+\n+    private static convertMeasurements(content: Map<string, number>): TelemetryMeasurement {\n+        if (!content) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk0MjcxNA=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk1MzU0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoxMzozMlrOHQZBcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoxMzozMlrOHQZBcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk0OTIzMg==", "bodyText": "shortened form: we can remove above private fields and just define within constructor like constructor(private ...", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486949232", "createdAt": "2020-09-11T10:13:32Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }\n+\n+    private static instance: TelemetryReporterImpl;\n+\n+    /**\n+     * This method return the value of the instrumentation key necessary to create the telemetry reporter from an\n+     * external file configuration. If the file doesn't exists it returns a generic value that will not be valid\n+     * for collect telemetry event.\n+     */\n+    private static getTelemetryKeyId(): string {\n+        return fs.existsSync(this.getTelemetryResourcePath()) ? this.getInstrumentationKey() : TELEMETRY_DEFAULT_CONTENT;\n+    }\n+\n+    private static getTelemetryResourcePath() {\n+        return vscode.Uri.file(\n+            path.join(ExtensionUtils.getExtensionPath(), \"resources\", \"TELEMETRY_KEY\")).fsPath;\n+    }\n+\n+    private static getInstrumentationKey(): string {\n+        return Buffer.from(fs.readFileSync(this.getTelemetryResourcePath(), \"utf8\").replace(/(\\r\\n|\\n|\\r)/gm, \"\"), \"base64\").toString();\n+    }\n+\n+    private static covertData(content: TelemetryEvent) {\n+        return {\n+            categories: content.getCategories().toString(),\n+            event: content.getEventName(),\n+            IDE: ExtensionUtils.getIDEName(),\n+            notes: content.getNotes(),\n+            timestamp: content.getTimestamp(),\n+            rootCause: content.getRootCause(),\n+        };\n+    }\n+\n+    private static convertMeasurements(content: Map<string, number>): TelemetryMeasurement {\n+        if (!content) {\n+            return undefined;\n+        }\n+\n+        const result: TelemetryMeasurement = {};\n+\n+        for (const [key, value] of content) {\n+            if (value) {\n+                result[key] = value;\n+            }\n+        }\n+        return result;\n+    }\n+\n+    private readonly telemetryKeyId: string;\n+    private reporter: TelemetryReporter;\n+\n+    private constructor(telemetryKeyId: string) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk3MTUxOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoxODo1N1rOHQZMFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoxODo1N1rOHQZMFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1MTk1Ng==", "bodyText": "shortened form(negation is slow): we can remove return, just:\nif (this.isValidEventName(eventName)){\nTelemetryFactory.getReporter()....\n}", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486951956", "createdAt": "2020-09-11T10:18:57Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!this.isValidEventName(eventName)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk3NTI4OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMDowMlrOHQZOag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMDowMlrOHQZOag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1MjU1NA==", "bodyText": "please define return type,  : void", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486952554", "createdAt": "2020-09-11T10:20:02Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk3NzQ1OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMDozNFrOHQZPoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMDozNFrOHQZPoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1Mjg2NQ==", "bodyText": "return type", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486952865", "createdAt": "2020-09-11T10:20:34Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!this.isValidEventName(eventName)) {\n+            return;\n+        }\n+        TelemetryFactory.getReporter().reportEvent(this.createTelemetryEvent(eventName, categories, notes, undefined, telemetryMeasurement));\n+\n+    }\n+\n+    /**\n+     * This method collect the exception data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param rootCause the stacktrace attached for debugging purpose.\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerExceptionEvent(eventName = \"RuntimeException\", rootCause: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk3OTY4OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMToxOVrOHQZQ-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyMToxOVrOHQZQ-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1MzIwOA==", "bodyText": "shortened faster-form:\nif (this.isValidEventName(eventName) && this.isValidRootCause(rootCause)) {\nTelemetryFactory.getReporter(). ..\n}", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486953208", "createdAt": "2020-09-11T10:21:19Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!this.isValidEventName(eventName)) {\n+            return;\n+        }\n+        TelemetryFactory.getReporter().reportEvent(this.createTelemetryEvent(eventName, categories, notes, undefined, telemetryMeasurement));\n+\n+    }\n+\n+    /**\n+     * This method collect the exception data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param rootCause the stacktrace attached for debugging purpose.\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerExceptionEvent(eventName = \"RuntimeException\", rootCause: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!(this.isValidEventName(eventName) && this.isValidRootCause(rootCause))) {\n+            return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NTk5Mjk0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDoyNTozOFrOHQZY0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNToyNTo1OFrOHQjdug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1NTIxNw==", "bodyText": "Will this work if rootCause = null ?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486955217", "createdAt": "2020-09-11T10:25:38Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!this.isValidEventName(eventName)) {\n+            return;\n+        }\n+        TelemetryFactory.getReporter().reportEvent(this.createTelemetryEvent(eventName, categories, notes, undefined, telemetryMeasurement));\n+\n+    }\n+\n+    /**\n+     * This method collect the exception data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param rootCause the stacktrace attached for debugging purpose.\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerExceptionEvent(eventName = \"RuntimeException\", rootCause: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!(this.isValidEventName(eventName) && this.isValidRootCause(rootCause))) {\n+            return;\n+        }\n+\n+        TelemetryFactory.getReporter().reportExceptionEvent(this.createTelemetryEvent(eventName, categories, notes, this.anonymizeContent(rootCause), telemetryMeasurement));\n+    }\n+\n+    private static isValidEventName(eventName: string): boolean {\n+        return eventName !== undefined && eventName.trim() !== \"\";\n+    }\n+\n+    private static createTelemetryEvent(eventName: string, categories: string[], notes: string, rootCause?: string, telemetryMeasurement?: Map<string, number>) {\n+        const telemetryEvent = new TelemetryEvent();\n+        telemetryEvent.setEventName(eventName);\n+        telemetryEvent.setCategories(this.resolveCategories(categories));\n+        telemetryEvent.setNotes(notes);\n+        telemetryEvent.setRootCause(rootCause);\n+        telemetryEvent.setMeasurements(telemetryMeasurement);\n+\n+        return telemetryEvent;\n+    }\n+\n+    private static resolveCategories(categories: string[]): string {\n+        return (categories) ? categories.toString() : \"N.D\";\n+    }\n+\n+    private static isValidRootCause(rootCause: string): boolean {\n+        return rootCause !== undefined && rootCause.trim() !== \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzEyMDMxNA==", "bodyText": "I will strongify it and provide unit test", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r487120314", "createdAt": "2020-09-11T15:25:58Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryService.ts", "diffHunk": "@@ -0,0 +1,98 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import {userInfo} from \"os\";\n+import {sep} from \"path\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryFactory} from \"./TelemetryFactory\";\n+\n+export class TelemetryService {\n+    /**\n+     *  This method calculate the time elapsed between two number representation of dates expressed as\n+     *  number of milliseconds elapsed since January 1, 1970 00:00:00 UTC.\n+     * @param startTime numeric representation of a starting time\n+     * @param endTime numeric representation of a ending time\n+     */\n+    public static calculateTimeElapsed(startTime: number, endTime: number): number | undefined {\n+        return ((startTime && endTime) && (endTime >= startTime)) ? ((endTime - startTime) / 1000) : undefined;\n+    }\n+\n+    /**\n+     * This method collect the data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerEvent(eventName: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!this.isValidEventName(eventName)) {\n+            return;\n+        }\n+        TelemetryFactory.getReporter().reportEvent(this.createTelemetryEvent(eventName, categories, notes, undefined, telemetryMeasurement));\n+\n+    }\n+\n+    /**\n+     * This method collect the exception data event for telemetry purpose, apply basic validation\n+     * and delegate the reporter service to sent them to the target telemetry server\n+     * @param eventName name assigned for the event for the telemetry\n+     * @param rootCause the stacktrace attached for debugging purpose.\n+     * @param categories optional list of keywords (act as tags)\n+     * @param notes optional brief description\n+     * @param telemetryMeasurement optional set of numeric data with a key name\n+     */\n+    public static registerExceptionEvent(eventName = \"RuntimeException\", rootCause: string, categories?: string[], notes?: string, telemetryMeasurement?: Map<string, number>) {\n+        if (!(this.isValidEventName(eventName) && this.isValidRootCause(rootCause))) {\n+            return;\n+        }\n+\n+        TelemetryFactory.getReporter().reportExceptionEvent(this.createTelemetryEvent(eventName, categories, notes, this.anonymizeContent(rootCause), telemetryMeasurement));\n+    }\n+\n+    private static isValidEventName(eventName: string): boolean {\n+        return eventName !== undefined && eventName.trim() !== \"\";\n+    }\n+\n+    private static createTelemetryEvent(eventName: string, categories: string[], notes: string, rootCause?: string, telemetryMeasurement?: Map<string, number>) {\n+        const telemetryEvent = new TelemetryEvent();\n+        telemetryEvent.setEventName(eventName);\n+        telemetryEvent.setCategories(this.resolveCategories(categories));\n+        telemetryEvent.setNotes(notes);\n+        telemetryEvent.setRootCause(rootCause);\n+        telemetryEvent.setMeasurements(telemetryMeasurement);\n+\n+        return telemetryEvent;\n+    }\n+\n+    private static resolveCategories(categories: string[]): string {\n+        return (categories) ? categories.toString() : \"N.D\";\n+    }\n+\n+    private static isValidRootCause(rootCause: string): boolean {\n+        return rootCause !== undefined && rootCause.trim() !== \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk1NTIxNw=="}, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NjAyNTA0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/model/TelemetryEvent.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDozNjoyNFrOHQZsfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMDozNjoyNFrOHQZsfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njk2MDI1NQ==", "bodyText": "I would suggest to redesign this private fields. In TS private fields usage is a bit different than Java. Another alternative is via constructor(public, .. ).  Thanks", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r486960255", "createdAt": "2020-09-11T10:36:24Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/model/TelemetryEvent.ts", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+export class TelemetryEvent {\n+    private readonly timestamp: string;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d879ce7d5d8912b2bb3079cf841dba7a9cfd2"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjM2ODcwOnYy", "diffSide": "RIGHT", "path": "README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODoyMDoxOFrOHR2UfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwOTowMDo0MlrOHR37UA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ3NzgyMA==", "bodyText": "Extra space on similar  Usage Data", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488477820", "createdAt": "2020-09-15T08:20:18Z", "author": {"login": "temanbrcom"}, "path": "README.md", "diffHunk": "@@ -129,3 +129,24 @@ The Find All References and Go To Definition functionalities are extended to wor\n * Inbuilt protection against recursive and missing copybooks. If the copybook is missing or contains looping code, an error displays, preventing issues only being discovered when the code is executed.  \n * Variables and paragraphs are defined across copybooks. This ensures consistency of code, and prevents issues in error diagnostics caused by incorrect variables or paragraphs in code. \n * Functionality to skip variable levels when called, reducing call time.\n+\n+### Privacy Notice\n+The extensions for Visual Studio Code developed by Broadcom Inc., including its corporate affiliates and subsidiaries, (\"Broadcom\") are provided free of charge, but in order to better understand and meet its users\u2019 needs, Broadcom may collect, use, analyze and retain anonymous users\u2019 metadata and interaction data, (collectively, \u201cUsage Data\u201d) and aggregate such Usage Data with similar  Usage Data of other Broadcom customers. Please, find more detailed information in License and Service Terms & Repository.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "326444b872e9b065970229cc419570cb7acfdc72"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODUwNDE0NA==", "bodyText": "fixed", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488504144", "createdAt": "2020-09-15T09:00:42Z", "author": {"login": "zeibura"}, "path": "README.md", "diffHunk": "@@ -129,3 +129,24 @@ The Find All References and Go To Definition functionalities are extended to wor\n * Inbuilt protection against recursive and missing copybooks. If the copybook is missing or contains looping code, an error displays, preventing issues only being discovered when the code is executed.  \n * Variables and paragraphs are defined across copybooks. This ensures consistency of code, and prevents issues in error diagnostics caused by incorrect variables or paragraphs in code. \n * Functionality to skip variable levels when called, reducing call time.\n+\n+### Privacy Notice\n+The extensions for Visual Studio Code developed by Broadcom Inc., including its corporate affiliates and subsidiaries, (\"Broadcom\") are provided free of charge, but in order to better understand and meet its users\u2019 needs, Broadcom may collect, use, analyze and retain anonymous users\u2019 metadata and interaction data, (collectively, \u201cUsage Data\u201d) and aggregate such Usage Data with similar  Usage Data of other Broadcom customers. Please, find more detailed information in License and Service Terms & Repository.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ3NzgyMA=="}, "originalCommit": {"oid": "326444b872e9b065970229cc419570cb7acfdc72"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjQyODQ5OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/commands/OpenSettingsCommand.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODozNDo1OFrOHR26HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODozNDo1OFrOHR26HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ4NzQ1Mw==", "bodyText": "The user invokes the open settings quick fix to see the copybook locations stored in the settings file", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488487453", "createdAt": "2020-09-15T08:34:58Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/commands/OpenSettingsCommand.ts", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as vscode from \"vscode\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+\n+export function gotoCopybookSettings(): void {\n+    TelemetryService.registerEvent(\"open settings\", [\"COBOL\", \"copybook\", \"settings\"], \"User invoke the open settings quickfix to saw the copybook locations stored in settings file config.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "326444b872e9b065970229cc419570cb7acfdc72"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjQzMjA3OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/commands/FetchCopybookCommand.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODozNTo0OVrOHR28Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODozNTo0OVrOHR28Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ4Nzk5OQ==", "bodyText": "The user tries to resolve a copybook that is not currently found", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488487999", "createdAt": "2020-09-15T08:35:49Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/commands/FetchCopybookCommand.ts", "diffHunk": "@@ -12,7 +12,9 @@\n  *   Broadcom, Inc. - initial API and implementation\n  */\n import {CopybookDownloadService} from \"../services/CopybookDownloadService\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n \n export function fetchCopybookCommand(copybook: string, downloader: CopybookDownloadService, programName: string) {\n+    TelemetryService.registerEvent(\"Fetch copybook\", [\"COBOL\", \"copybook\", \"quickfix\"], \"User try to resolve a copybook that is not currently found\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "326444b872e9b065970229cc419570cb7acfdc72"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NjUyOTkxOnYy", "diffSide": "RIGHT", "path": "README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo1OTo0MlrOHR340w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODo1OTo0MlrOHR340w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODUwMzUwNw==", "bodyText": "Please find more detailed information in License and Service Terms & Repository.\n\nIn where? Is this supposed to say \"in the license file in the repository\"?\nCan we just link to where the user can find more info?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488503507", "createdAt": "2020-09-15T08:59:42Z", "author": {"login": "zeibura"}, "path": "README.md", "diffHunk": "@@ -129,3 +129,24 @@ The Find All References and Go To Definition functionalities are extended to wor\n * Inbuilt protection against recursive and missing copybooks. If the copybook is missing or contains looping code, an error displays, preventing issues only being discovered when the code is executed.  \n * Variables and paragraphs are defined across copybooks. This ensures consistency of code, and prevents issues in error diagnostics caused by incorrect variables or paragraphs in code. \n * Functionality to skip variable levels when called, reducing call time.\n+\n+### Privacy Notice\n+The extensions for Visual Studio Code developed by Broadcom Inc., including its corporate affiliates and subsidiaries, (\"Broadcom\") are provided free of charge, but in order to better understand and meet its users\u2019 needs, Broadcom may collect, use, analyze and retain anonymous user metadata and interaction data, (collectively, \u201cUsage Data\u201d) and aggregate such Usage Data with similar Usage Data of other Broadcom customers. Please find more detailed information in License and Service Terms & Repository.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Njg4NTg2OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMDozMDoyMlrOHR7U0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMjoyOTo0OVrOHR_Z4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU1OTgyNw==", "bodyText": "You miss sep between USERNAME and \"folder1\". It will be good to use here something like this:\nconst FAKE_ROOT_PATH = path.join(\"C:\", \"Users\", USERNAME, \"folder1\", \"folder2\", \"folder3\");", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488559827", "createdAt": "2020-09-15T10:30:22Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNjY1OA==", "bodyText": "makes sense, thanks! ;)", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488626658", "createdAt": "2020-09-15T12:29:49Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU1OTgyNw=="}, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Njg5ODQyOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMDozMzo1NVrOHR7caQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMjoyOToxNFrOHR_Yfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU2MTc2OQ==", "bodyText": "You've already mocked the telemetry extension on line 26. One line can be deleted.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488561769", "createdAt": "2020-09-15T10:33:55Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+\n+function runScenario(expectedNumberOfCalls, type: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {\n+    if (type === \"log\") {\n+        TelemetryService.registerEvent(eventName, categories, undefined, telemetryMeasurements);\n+        expect(spySendTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    } else {\n+        TelemetryService.registerExceptionEvent(eventName, rootCause, categories);\n+        expect(spySendExceptionTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    }\n+}\n+\n+function setupScenario() {\n+    ExtensionUtils.getIDEName = jest.fn().mockReturnValue(\"testingIde\");\n+    ExtensionUtils.getPackageVersion = jest.fn().mockReturnValue(\"1.0\");\n+    (TelemetryReporterImpl as any).getTelemetryKeyId = jest.fn().mockReturnValue(\"key_id_for_testing_purposes\");\n+    (TelemetryService as any).getUsername = jest.fn().mockReturnValue(USERNAME);\n+    jest.mock(\"vscode-extension-telemetry\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNjMwMg==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488626302", "createdAt": "2020-09-15T12:29:14Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,112 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import {sep} from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {ExtensionUtils} from \"../services/settings/util/ExtensionUtils\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH = \"C:\" + sep + \"Users\" + sep + USERNAME + \"folder1\" + sep + \"folder2\" + sep + \"folder3\" + sep;\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+\n+function runScenario(expectedNumberOfCalls, type: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {\n+    if (type === \"log\") {\n+        TelemetryService.registerEvent(eventName, categories, undefined, telemetryMeasurements);\n+        expect(spySendTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    } else {\n+        TelemetryService.registerExceptionEvent(eventName, rootCause, categories);\n+        expect(spySendExceptionTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    }\n+}\n+\n+function setupScenario() {\n+    ExtensionUtils.getIDEName = jest.fn().mockReturnValue(\"testingIde\");\n+    ExtensionUtils.getPackageVersion = jest.fn().mockReturnValue(\"1.0\");\n+    (TelemetryReporterImpl as any).getTelemetryKeyId = jest.fn().mockReturnValue(\"key_id_for_testing_purposes\");\n+    (TelemetryService as any).getUsername = jest.fn().mockReturnValue(USERNAME);\n+    jest.mock(\"vscode-extension-telemetry\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU2MTc2OQ=="}, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Njk2ODEyOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/CopybookFix.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMDo1NDoxNVrOHR8Hqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMDo1NDoxNVrOHR8Hqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3Mjg0Mg==", "bodyText": "You can delete \"broadcom-cobol-lsp\" argument here because the command doesn't use arguments.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488572842", "createdAt": "2020-09-15T10:54:15Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/CopybookFix.ts", "diffHunk": "@@ -32,7 +32,7 @@ export class CopybookFix {\n         const actionSettings = \"Change settings\";\n         const action = await vscode.window.showErrorMessage(title, actionSettings);\n         if (action === actionSettings) {\n-            vscode.commands.executeCommand(\"workbench.action.openSettings\", \"broadcom-cobol-lsp\");\n+            vscode.commands.executeCommand(\"broadcom-cobol-lsp.cpy-manager.goto-settings\", \"broadcom-cobol-lsp\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Njk5ODM0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMTowMjo1N1rOHR8Z2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMjoyNzoxN1rOHR_Tqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3NzQ5Ng==", "bodyText": "Typo: convertData.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488577496", "createdAt": "2020-09-15T11:02:57Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }\n+\n+    private static instance: TelemetryReporterImpl;\n+\n+    /**\n+     * This method return the value of the instrumentation key necessary to create the telemetry reporter from an\n+     * external file configuration. If the file doesn't exists it returns a generic value that will not be valid\n+     * for collect telemetry event.\n+     */\n+    private static getTelemetryKeyId(): string {\n+        return fs.existsSync(this.getTelemetryResourcePath()) ? this.getInstrumentationKey() : TELEMETRY_DEFAULT_CONTENT;\n+    }\n+\n+    private static getTelemetryResourcePath() {\n+        return vscode.Uri.file(\n+            path.join(ExtensionUtils.getExtensionPath(), \"resources\", \"TELEMETRY_KEY\")).fsPath;\n+    }\n+\n+    private static getInstrumentationKey(): string {\n+        return Buffer.from(fs.readFileSync(this.getTelemetryResourcePath(), \"utf8\"), \"base64\").toString().trim();\n+    }\n+\n+    private static covertData(content: TelemetryEvent) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNTA2Nw==", "bodyText": "great catch! I didn't recognized it and the linter as well! Humans are way better!", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488625067", "createdAt": "2020-09-15T12:27:17Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }\n+\n+    private static instance: TelemetryReporterImpl;\n+\n+    /**\n+     * This method return the value of the instrumentation key necessary to create the telemetry reporter from an\n+     * external file configuration. If the file doesn't exists it returns a generic value that will not be valid\n+     * for collect telemetry event.\n+     */\n+    private static getTelemetryKeyId(): string {\n+        return fs.existsSync(this.getTelemetryResourcePath()) ? this.getInstrumentationKey() : TELEMETRY_DEFAULT_CONTENT;\n+    }\n+\n+    private static getTelemetryResourcePath() {\n+        return vscode.Uri.file(\n+            path.join(ExtensionUtils.getExtensionPath(), \"resources\", \"TELEMETRY_KEY\")).fsPath;\n+    }\n+\n+    private static getInstrumentationKey(): string {\n+        return Buffer.from(fs.readFileSync(this.getTelemetryResourcePath(), \"utf8\"), \"base64\").toString().trim();\n+    }\n+\n+    private static covertData(content: TelemetryEvent) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3NzQ5Ng=="}, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NzAwMDY2OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMTowMzo0M1rOHR8bPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMjoyNTozMlrOHR_PhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3Nzg1Mw==", "bodyText": "Why do you need that lazy initialization?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488577853", "createdAt": "2020-09-15T11:03:43Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYyNDAwNQ==", "bodyText": "Because this.getTelemetryKeyId() will scan the filesystem to read the content of the file and since its value is not supposed to change I prefer to have only one instance of the TelemetryReporterImpl", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488624005", "createdAt": "2020-09-15T12:25:32Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/reporter/TelemetryReporterImpl.ts", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {EXTENSION_ID, TELEMETRY_DEFAULT_CONTENT} from \"../../constants\";\n+import {ExtensionUtils} from \"../settings/util/ExtensionUtils\";\n+import {TelemetryEvent} from \"./model/TelemetryEvent\";\n+import {TelemetryMeasurement} from \"./model/TelemetryMeasurement\";\n+import {TelemetryReport} from \"./TelemetryReport\";\n+\n+export class TelemetryReporterImpl implements TelemetryReport {\n+    public static getInstance(): TelemetryReporterImpl {\n+        if (!TelemetryReporterImpl.instance) {\n+            TelemetryReporterImpl.instance = new TelemetryReporterImpl(this.getTelemetryKeyId());\n+        }\n+        return TelemetryReporterImpl.instance;\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU3Nzg1Mw=="}, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NzA5MjQyOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/package.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMTozMDoxMlrOHR9TaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxMTozMDoxMlrOHR9TaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU5MjIzMw==", "bodyText": "Command name and title don't match.\nThe command named with cpy-manager part, but in OpenSettingsCommand workbench.action.openSettings executed with only broadcom-cobol-lsp as a parameter.\nI see two options:\n\nchange the title to \"Open plugin settings\" and command to \"broadcom-cobol-lsp.goto-settings\"\nchange filtering string in OpenSettingsCommand to \"broadcom-cobol-lsp.cpy-manager\".", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r488592233", "createdAt": "2020-09-15T11:30:12Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -52,6 +52,10 @@\n             {\n                 \"command\": \"broadcom-cobol-lsp.cpy-manager.edit-dataset-paths\",\n                 \"title\": \"Edit dataset paths\"\n+            },\n+            {\n+                \"command\": \"broadcom-cobol-lsp.cpy-manager.goto-settings\",\n+                \"title\": \"Open Copybook location settings\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13649344ad3d6ce05ad099a1e7ec815cc1270704"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjAyNzAwOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/util/Utils.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNzoxNjoxOFrOHTUl7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwNzoxNjoxOFrOHTUl7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDAyMjM4MA==", "bodyText": "@zacanbrcom I believe this should be ||. It can't be null and undefined at the same time.\nreturn content !== null || content !== undefined;", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r490022380", "createdAt": "2020-09-17T07:16:18Z", "author": {"login": "asatklichov"}, "path": "clients/cobol-lsp-vscode-extension/src/services/util/Utils.ts", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+/**\n+ * This class collect utility methods for general purpose activities\n+ */\n+export class Utils {\n+    /**\n+     * This method provide a quick way to assure that a string is not null or undefined.\n+     * The idea is to have something similar to the util library {@link node.isNullOrUndefined} that is deprecated.\n+     * @param content the string value target of the validation\n+     * @return true if the content is not null or undefined, false otherwise\n+     */\n+    public static isNotNullOrUndefined(content: string): boolean {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc439cbe817a195c797862ff718dcee5edf61525"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2Njc3Mjk0OnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDoyNzo1MlrOHTbqQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDoyNzo1MlrOHTbqQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEzODE3Nw==", "bodyText": "You can clear all mocks after the tests. There is no need to do it before.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r490138177", "createdAt": "2020-09-17T10:27:52Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/TelemetryServiceTest.spec.ts", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as path from \"path\";\n+import TelemetryReporter from \"vscode-extension-telemetry\";\n+import {TelemetryService} from \"../services/reporter/TelemetryService\";\n+import {TelemetryReporterImpl} from \"../services/reporter/TelemetryReporterImpl\";\n+\n+const USERNAME: string = \"usernameToAnonymize\";\n+const FAKE_ROOT_PATH: string = path.join(\"C:\", \"Users\", USERNAME, \"folder1\", \"folder2\", \"folder3\");\n+let spySendTelemetry;\n+let spySendExceptionTelemetry;\n+jest.mock(\"vscode-extension-telemetry\");\n+jest.mock(\"../services/util/ExtensionUtils\");\n+\n+function runScenario(expectedNumberOfCalls, eventType: string, eventName?: string, categories?: string[], rootCause?: string, telemetryMeasurements?: Map<string, number>) {\n+    if (eventType === \"log\") {\n+        TelemetryService.registerEvent(eventName, categories, undefined, telemetryMeasurements);\n+        expect(spySendTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    } else {\n+        TelemetryService.registerExceptionEvent(eventName, rootCause, categories);\n+        expect(spySendExceptionTelemetry).toBeCalledTimes(expectedNumberOfCalls);\n+    }\n+}\n+\n+function setupScenario() {\n+    (TelemetryReporterImpl as any).getTelemetryKeyId = jest.fn().mockReturnValue(\"key_id_for_testing_purposes\");\n+    (TelemetryService as any).getUsername = jest.fn().mockReturnValue(USERNAME);\n+    spySendTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryEvent\");\n+    spySendExceptionTelemetry = jest.spyOn(TelemetryReporter.prototype, \"sendTelemetryErrorEvent\");\n+}\n+\n+describe(\"TelemetryService information are consistent before send them to the telemetry server\", () => {\n+    beforeEach(() => {\n+        jest.clearAllMocks();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95237f5da83e506579e2eed088ebe29c8b70660b"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2Njc5MTQxOnYy", "diffSide": "RIGHT", "path": "clients/cobol-lsp-vscode-extension/src/services/copybook/CopybookFix.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDozMzoxN1rOHTb1hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDo0MToxNVrOHTcF5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0MTA2MA==", "bodyText": "You don't have params for this command. You can call it this way:\nvscode.commands.executeCommand(\"broadcom-cobol-lsp.cpy-manager.goto-settings\");", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r490141060", "createdAt": "2020-09-17T10:33:17Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/copybook/CopybookFix.ts", "diffHunk": "@@ -32,7 +32,7 @@ export class CopybookFix {\n         const actionSettings = \"Change settings\";\n         const action = await vscode.window.showErrorMessage(title, actionSettings);\n         if (action === actionSettings) {\n-            vscode.commands.executeCommand(\"workbench.action.openSettings\", \"broadcom-cobol-lsp\");\n+            vscode.commands.executeCommand(\"broadcom-cobol-lsp.cpy-manager.goto-settings\", \"cpy-manager\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95237f5da83e506579e2eed088ebe29c8b70660b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NTI1NA==", "bodyText": "OK I will do it ;)", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/515#discussion_r490145254", "createdAt": "2020-09-17T10:41:15Z", "author": {"login": "zacanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/services/copybook/CopybookFix.ts", "diffHunk": "@@ -32,7 +32,7 @@ export class CopybookFix {\n         const actionSettings = \"Change settings\";\n         const action = await vscode.window.showErrorMessage(title, actionSettings);\n         if (action === actionSettings) {\n-            vscode.commands.executeCommand(\"workbench.action.openSettings\", \"broadcom-cobol-lsp\");\n+            vscode.commands.executeCommand(\"broadcom-cobol-lsp.cpy-manager.goto-settings\", \"cpy-manager\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0MTA2MA=="}, "originalCommit": {"oid": "95237f5da83e506579e2eed088ebe29c8b70660b"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3955, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}