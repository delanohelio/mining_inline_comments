{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5Nzk5MDU0", "number": 645, "title": "fix : [Experimental] LocalCopybookResolverTest fails randomly #626", "bodyText": "[Experimental] LocalCopybookResolverTest fails randomly #626\nSigned-off-by: ap891843 aman.prashant@broadcom.com", "createdAt": "2020-11-12T10:54:41Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645", "merged": true, "mergeCommit": {"oid": "1b5e4a8fce6477a0f7a379a9769b767ab5a87969"}, "closed": true, "closedAt": "2020-11-12T15:43:15Z", "author": {"login": "ap891843"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbwZSJgFqTUyODk3MTE1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdb0fsGAFqTUyOTIxNzk2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTcxMTU5", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-528971159", "createdAt": "2020-11-12T10:56:15Z", "commit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NjoxNVrOHx1YYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NjoxNVrOHx1YYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjAxNjg2NA==", "bodyText": "run coverage in band mode instead of running in parallel. Planning it to keep this flag for some time and observe the performance and the intermittent failing UI test.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#discussion_r522016864", "createdAt": "2020-11-12T10:56:15Z", "author": {"login": "ap891843"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -150,7 +150,7 @@\n         \"watch\": \"tsc -watch -p ./\",\n         \"postinstall\": \"node ./node_modules/vscode/bin/install\",\n         \"test\": \"jest -w 1 --unhandled-rejections=strict\",\n-        \"coverage\": \"jest --coverage\"\n+        \"coverage\": \"jest --coverage --runInBand\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTcxNzI2", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-528971726", "createdAt": "2020-11-12T10:57:02Z", "commit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NzowMlrOHx1aPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NzowMlrOHx1aPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjAxNzM0MQ==", "bodyText": "fix unhandledRejection cases.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#discussion_r522017341", "createdAt": "2020-11-12T10:57:02Z", "author": {"login": "ap891843"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/ChangeDefaultZoweProfileTest.spec.ts", "diffHunk": "@@ -15,6 +15,8 @@\n import {changeDefaultZoweProfile} from \"../commands/ChangeDefaultZoweProfile\";\n import { ProfileService } from \"../services/ProfileService\";\n import {ZoweApi} from \"../services/ZoweApi\";\n+\n+jest.mock(\"../services/ProfileService\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTcxODI1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-528971825", "createdAt": "2020-11-12T10:57:10Z", "commit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NzoxMFrOHx1aig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDo1NzoxMFrOHx1aig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjAxNzQxOA==", "bodyText": "fix unhandledRejection cases.", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#discussion_r522017418", "createdAt": "2020-11-12T10:57:10Z", "author": {"login": "ap891843"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/CopybookDownloadServiceTest.spec.ts", "diffHunk": "@@ -54,6 +54,7 @@ beforeEach(() => {\n });\n \n jest.mock(\"../services/reporter/TelemetryService\");\n+jest.mock(\"../services/ProfileService\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e4664df453b099bbf3f9bfdd53c109d76214e2e", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/6e4664df453b099bbf3f9bfdd53c109d76214e2e", "committedDate": "2020-11-12T10:53:07Z", "message": "fix : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "7c9fa76f76c11e12ad8500154040fc70111ffd3c", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7c9fa76f76c11e12ad8500154040fc70111ffd3c", "committedDate": "2020-11-12T13:16:42Z", "message": "fix : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c9fa76f76c11e12ad8500154040fc70111ffd3c", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7c9fa76f76c11e12ad8500154040fc70111ffd3c", "committedDate": "2020-11-12T13:16:42Z", "message": "fix : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "caf9d146e4faf5e91b6fa64e73ef4db21ca4654b", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/caf9d146e4faf5e91b6fa64e73ef4db21ca4654b", "committedDate": "2020-11-12T14:21:12Z", "message": "fix : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MTcxODU2", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-529171856", "createdAt": "2020-11-12T14:59:12Z", "commit": {"oid": "caf9d146e4faf5e91b6fa64e73ef4db21ca4654b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNDo1OToxMlrOHx-xBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNDo1OToxMlrOHx-xBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE3MDYzMQ==", "bodyText": "Why not to keep .not.toThrowError()?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#discussion_r522170631", "createdAt": "2020-11-12T14:59:12Z", "author": {"login": "grianbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/__tests__/LanguageClientServiceTest.spec.ts", "diffHunk": "@@ -51,29 +51,29 @@ const SERVER_ID = \"COBOL\";\n \n beforeEach(() => {\n     jest.clearAllMocks();\n-});\n-\n-describe(\"LanguageClientService negative scenario.\", () => {\n-\n-    test(\"LSP port not defined and jar path doesn't exists\", async () => {\n-        await expect(new LanguageClientService(undefined).checkPrerequisites())\n-        .rejects.toThrowError(\"LSP server for COBOL not found\");\n-}, 10000);\n+    vscode.workspace.getConfiguration(expect.any(String)).get = jest.fn().mockReturnValue(0);\n });\n \n const SERVER_STARTED_MSG = \"server started\";\n const SERVER_STOPPED_MSG = \"server stopped\";\n describe(\"LanguageClientService positive scenario\", () => {\n-\n     beforeEach(() => {\n-        jest.clearAllMocks();\n         languageClientService = new LanguageClientService(middleware);\n         new JavaCheck().isJavaInstalled = jest.fn().mockResolvedValue(true);\n+        vscode.workspace.getConfiguration(expect.any(String)).get = jest.fn().mockReturnValue(0);\n         fs.existsSync = jest.fn().mockReturnValue(true);\n     });\n \n     test(\"Test LanguageClientService checkPrerequisites passes\", async () => {\n-        expect(async () => await languageClientService.checkPrerequisites()).not.toThrowError();\n+        let message = false;\n+        fs.existsSync = jest.fn().mockReturnValue(true);\n+        vscode.workspace.getConfiguration(expect.any(String)).get = jest.fn().mockReturnValue(9999);\n+        try {\n+            await languageClientService.checkPrerequisites();\n+        } catch (error) {\n+            message = error;\n+        }\n+        expect(message).toBeFalsy();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "caf9d146e4faf5e91b6fa64e73ef4db21ca4654b"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MjA2NjIw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-529206620", "createdAt": "2020-11-12T15:31:54Z", "commit": {"oid": "caf9d146e4faf5e91b6fa64e73ef4db21ca4654b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9eb63ea6b98d1a8c35fd2aaf6f56349882ab179", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c9eb63ea6b98d1a8c35fd2aaf6f56349882ab179", "committedDate": "2020-11-12T15:36:20Z", "message": "test : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "caf9d146e4faf5e91b6fa64e73ef4db21ca4654b", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/caf9d146e4faf5e91b6fa64e73ef4db21ca4654b", "committedDate": "2020-11-12T14:21:12Z", "message": "fix : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}, "afterCommit": {"oid": "c9eb63ea6b98d1a8c35fd2aaf6f56349882ab179", "author": {"user": {"login": "ap891843", "name": "Aman Prashant"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c9eb63ea6b98d1a8c35fd2aaf6f56349882ab179", "committedDate": "2020-11-12T15:36:20Z", "message": "test : LocalCopybookResolverTest fails randomly #626\n\nSigned-off-by: ap891843 <aman.prashant@broadcom.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MjE3OTYw", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/645#pullrequestreview-529217960", "createdAt": "2020-11-12T15:42:52Z", "commit": {"oid": "c9eb63ea6b98d1a8c35fd2aaf6f56349882ab179"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 894, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}