{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwODAxNzcz", "number": 182, "title": "Zowe copybook tracker #208", "bodyText": "Address the issue #180 and extends the #141.\nThis POC consider a very basic scenario and didn't include a proper definition of setting.json that may be introduced later on.\nEnd user scenario\nCobol file opened with a missing copybook\nthe related dependency file is generated\nThe copybook tracker extension ask user credential to connect to mf and download the copybook into the .copybooks folder\nThe LSP trigger a new analysis for the cobol file and the syntax error of copybook not found disappear.", "createdAt": "2020-02-04T12:08:12Z", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182", "merged": true, "mergeCommit": {"oid": "9e4bc6861cf5c176d745aa2e2e21c168e09dfecf"}, "closed": true, "closedAt": "2020-03-03T16:26:35Z", "author": {"login": "zacanbrcom"}, "timelineItems": {"totalCount": 80, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6OA0TAH2gAyMzcwODAxNzczOjYxZTlmN2MxZjc2MGJkODlmMTRjMzRhNjlkMTc2Njg3Y2Y2OWRmZmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKEegcAFqTM2ODA5MjU2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "61e9f7c1f760bd89f14c34a69d176687cf69dfff", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/61e9f7c1f760bd89f14c34a69d176687cf69dfff", "committedDate": "2020-01-14T10:02:06Z", "message": "Base for copybook tracker. WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5aeb1caf212fab74fed0e1e32777abaa300becb", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c5aeb1caf212fab74fed0e1e32777abaa300becb", "committedDate": "2020-01-14T10:02:06Z", "message": "Introduce default paths setting. WIP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cdd9fea72b4e9fe95c1a6fa5f2fc7ff2596f962", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/5cdd9fea72b4e9fe95c1a6fa5f2fc7ff2596f962", "committedDate": "2020-01-14T10:02:06Z", "message": "zOSMF profile listing implementation. WIP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4af9d5eba454480c4ee5ed1ec13c23a76c0be60f", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4af9d5eba454480c4ee5ed1ec13c23a76c0be60f", "committedDate": "2020-01-14T10:02:06Z", "message": "Implement member list. WIP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0998507f591aa6e448e82aaf6cc3c82229369b0f", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/0998507f591aa6e448e82aaf6cc3c82229369b0f", "committedDate": "2020-01-14T10:02:06Z", "message": "Fetch content of members. WIP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a73b7d983a46c66bbc2d58d6bc64ba6fe3825e", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a1a73b7d983a46c66bbc2d58d6bc64ba6fe3825e", "committedDate": "2020-01-14T10:02:06Z", "message": "Add copyrights"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0357e0aa84000384be74cce655630473d9f59748", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/0357e0aa84000384be74cce655630473d9f59748", "committedDate": "2020-01-14T10:02:06Z", "message": "Add progress indication. WIP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d802acd65086298a9e54317abe2872aa50973e6c", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/d802acd65086298a9e54317abe2872aa50973e6c", "committedDate": "2020-01-15T11:34:15Z", "message": "Use zowe imperative for profiles and zOSMF access."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c52fbf4912daaa8a46e0c5bc9a296e7aa59bdeec", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c52fbf4912daaa8a46e0c5bc9a296e7aa59bdeec", "committedDate": "2020-01-15T13:11:54Z", "message": "Support .err files added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21c24e967f91507e485434079d984bdd19273de8", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/21c24e967f91507e485434079d984bdd19273de8", "committedDate": "2020-01-15T13:14:17Z", "message": "Remove TODOs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80f195f94fbc29019f30feb0fe822a99991c805a", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/80f195f94fbc29019f30feb0fe822a99991c805a", "committedDate": "2020-01-15T14:58:59Z", "message": "change extension to .dep"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "021a9828616f367e541654c441402a3ec339ca1e", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/021a9828616f367e541654c441402a3ec339ca1e", "committedDate": "2020-01-16T07:59:32Z", "message": "Introduce new event RUN_ANALYSIS covered by unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feb936585b6af83496e276bd3f7d63b7a7743826", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/feb936585b6af83496e276bd3f7d63b7a7743826", "committedDate": "2020-01-16T08:14:36Z", "message": "Generation dummy cobdeps folder with dep file for e2e test purpose"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b23c0f730a6fd18424bc92cac00a98ace551380b", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/b23c0f730a6fd18424bc92cac00a98ace551380b", "committedDate": "2020-01-16T08:49:14Z", "message": "Definition test class to cover end to end subscribe, unsubscribe and publish"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb962a9f95f5cf15901082faeb30200566447f6d", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/cb962a9f95f5cf15901082faeb30200566447f6d", "committedDate": "2020-01-21T09:09:21Z", "message": "Set default profile as default selection option."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1b4d208f6f0f9a8c4f012b9075f8cbc27fbb5f6", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e1b4d208f6f0f9a8c4f012b9075f8cbc27fbb5f6", "committedDate": "2020-01-24T09:01:28Z", "message": "Introduce unit test for dep file management"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "304b4f964642e3fede7e84a40f9892889030ae47", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/304b4f964642e3fede7e84a40f9892889030ae47", "committedDate": "2020-01-28T14:23:19Z", "message": "Refine implementation for a better error management in folder and dep file creation/update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "797746d138d63952fe7e28d866d57f1ca506c413", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/797746d138d63952fe7e28d866d57f1ca506c413", "committedDate": "2020-01-28T15:14:25Z", "message": "Merge remote-tracking branch 'remotes/origin/development' into 141_DepFileManagement\n\n# Conflicts:\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/api/CopybookEventFactory.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/factory/RunAnalysisSubscriberFactory.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/impl/RunAnalysisEventSubscriber.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/model/DataEventType.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/main/java/com/broadcom/lsp/domain/cobol/event/model/RunAnalysisEvent.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/test/java/com/broadcom/lsp/domain/cobol/event/CopybookEventSubscribersTest.java\n#\tcom.ca.lsp.cobol/lsp-core-domain/src/test/java/com/broadcom/lsp/domain/cobol/event/CopybookEventsTest.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/pom.xml\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/CobolWorkspaceServiceImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/MyLanguageServerImpl.java\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/service/WorkspaceServiceTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44f96bbc344991f5ab44615edc6617d67189a973", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/44f96bbc344991f5ab44615edc6617d67189a973", "committedDate": "2020-01-29T07:16:45Z", "message": "Adjustment after merge with development branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4d0c85621993867570c1a8a35e19efbe8249d31", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e4d0c85621993867570c1a8a35e19efbe8249d31", "committedDate": "2020-01-29T07:30:31Z", "message": "Fix search for copybook only in COPYBOOKS folder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdf75e221d57fb1201b5f3022655108dda4839e7", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/cdf75e221d57fb1201b5f3022655108dda4839e7", "committedDate": "2020-01-29T14:53:09Z", "message": "Update header and provide E2E integration test for FileSystemService with databus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "948cdf18150575154070d8fbd0d3d528d5145596", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/948cdf18150575154070d8fbd0d3d528d5145596", "committedDate": "2020-01-29T15:03:59Z", "message": "Merge remote-tracking branch 'remotes/origin/development' into 141_DepFileManagement\n\n# Conflicts:\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/usecases/AnalyzeCopybookCaching.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b38f8a70c7d877a63be3b3580759cf3a9321c6ad", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/b38f8a70c7d877a63be3b3580759cf3a9321c6ad", "committedDate": "2020-01-29T15:59:27Z", "message": "Consume documentURI information sent on the databus by the preprocessor in order to generate dependency files with the same name as the cobol file scanned by the preprocessor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c411fbcb268497a965fd1ede188ba54fc8e64d57", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/c411fbcb268497a965fd1ede188ba54fc8e64d57", "committedDate": "2020-01-30T17:17:02Z", "message": "Modify write function to address issues related to the concurrent writing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecf643c0f789e90ec1142e4b5736de9427261cea", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/ecf643c0f789e90ec1142e4b5736de9427261cea", "committedDate": "2020-01-31T09:09:30Z", "message": "Fix failed test after the introduction of DocumentURI and improved write dependency of file checking for not empty values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4809f9471923367ae12edc9ac4c5fdf3a3939caa", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4809f9471923367ae12edc9ac4c5fdf3a3939caa", "committedDate": "2020-01-31T11:06:14Z", "message": "Improve create and write on dependency file, cover edge cases that can happen due to failed sync with the filesystem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "489aa7b5b59c9f96571d26f2e5fcc1fa825adb6f", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/489aa7b5b59c9f96571d26f2e5fcc1fa825adb6f", "committedDate": "2020-02-02T09:26:09Z", "message": "Add notification message related to gitfs unsupported filesystem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "622c2f02756c07797b03159cec43fe66670908da", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/622c2f02756c07797b03159cec43fe66670908da", "committedDate": "2020-02-02T09:29:16Z", "message": "Merge remote-tracking branch 'remotes/origin/development' into 141_DepFileManagement\n\n# Conflicts:\n#\tcom.ca.lsp.cobol/lsp-service-cobol/src/main/java/com/ca/lsp/cobol/service/MyTextDocumentService.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb6cb57467192dc724fb5be3ceb958f35027fac3", "author": {"user": {"login": "zacanbrcom", "name": "Andrea Zaccaro"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/bb6cb57467192dc724fb5be3ceb958f35027fac3", "committedDate": "2020-02-02T11:15:05Z", "message": "Fix duplicates in pom, removed old TODO and unused variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78ef44b5986e311fe8e770aa43d24c531200be43", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/78ef44b5986e311fe8e770aa43d24c531200be43", "committedDate": "2020-02-03T14:46:12Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a32884ef0e030aadd2ffadbea2da6354c066dc9", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/3a32884ef0e030aadd2ffadbea2da6354c066dc9", "committedDate": "2020-02-03T14:47:04Z", "message": "Merge remote-tracking branch 'origin/141_DepFileManagement' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8da446de1a6fa02ef31ba0681a6815563a246369", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8da446de1a6fa02ef31ba0681a6815563a246369", "committedDate": "2020-02-04T09:24:28Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962", "committedDate": "2020-02-04T11:02:10Z", "message": "change copybooks folders name to .copybooks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyOTQ0OTg5", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-352944989", "createdAt": "2020-02-04T12:42:30Z", "commit": {"oid": "456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo0MjozMFrOFlSs9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMjo1MDoyNFrOFlS6WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY0ODA1NQ==", "bodyText": "Why do we store tslint config on the repository?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r374648055", "createdAt": "2020-02-04T12:42:30Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/tslint.json", "diffHunk": "@@ -31,7 +31,8 @@\n         \"arrow-parens\": [\n             true,\n             \"ban-single-arg-parens\"\n-        ]\n+        ],\n+        \"prettier\": true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY1MTQ4MA==", "bodyText": "\ud83d\ude20", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r374651480", "createdAt": "2020-02-04T12:50:24Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/CopybooksDownloader.ts", "diffHunk": "@@ -0,0 +1,143 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import { IProfile } from \"@zowe/imperative\";\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import { ProfilesMap, ZoweApi } from \"./ZoweApi\";\n+\n+export const DEPENDENCIES_FOLDER: string = \".cobdeps\";\n+export const COPYBOOKS_FOLDER: string = \".copybooks\";\n+\n+const SETTINGS_ROOT = \"cobol-language-support\";\n+\n+export class CopybooksDownloader {\n+    public constructor(private zoweApi: ZoweApi) { }\n+\n+    /**\n+     * @param copybooks array of copybooks names to download\n+     */\n+    // tslint:disable-next-line: cognitive-complexity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNDExOTg1", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-353411985", "createdAt": "2020-02-05T01:14:56Z", "commit": {"oid": "456d8f1a37a5d46e4adcceff3d9e31e5a4dcd962"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8b85f1ed93c5c843eca8f2fd8ef1eed965384ac", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/f8b85f1ed93c5c843eca8f2fd8ef1eed965384ac", "committedDate": "2020-02-07T10:09:31Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "429d30d7d57fde3a456fcfc31f068c3fa91f6780", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/429d30d7d57fde3a456fcfc31f068c3fa91f6780", "committedDate": "2020-02-11T13:29:51Z", "message": "Remove request library dependency and small refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d198644f3d519dfd8219cb5a1c0fe5f8b6c264b3", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/d198644f3d519dfd8219cb5a1c0fe5f8b6c264b3", "committedDate": "2020-02-11T13:31:06Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NjU4MDUz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-356658053", "createdAt": "2020-02-11T13:34:33Z", "commit": {"oid": "d198644f3d519dfd8219cb5a1c0fe5f8b6c264b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2f507cf9a62c5806ab277b6ddd4c66a71a6a21e", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e2f507cf9a62c5806ab277b6ddd4c66a71a6a21e", "committedDate": "2020-02-12T12:50:35Z", "message": "WIP. Ask to get copybooks. Get profile name base on filepath"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1248e9aeb62fb730e41fde799ca7880ee5a2f0ef", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1248e9aeb62fb730e41fde799ca7880ee5a2f0ef", "committedDate": "2020-02-13T15:59:33Z", "message": "Store profiles for programs in settings.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2025c82f7f5e0295b01faf2f55834d66f4cbc67b", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/2025c82f7f5e0295b01faf2f55834d66f4cbc67b", "committedDate": "2020-02-14T10:15:40Z", "message": "Listen to settings cahnges"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18b581907e457992c08876c5bb4e3dc84ae84319", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/18b581907e457992c08876c5bb4e3dc84ae84319", "committedDate": "2020-02-14T10:21:22Z", "message": "Add redownload all command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e951f0275a8fb867d2dc950552f591b1358a6377", "author": {"user": {"login": "sergiuilie", "name": "Sergiu Ilie"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e951f0275a8fb867d2dc950552f591b1358a6377", "committedDate": "2020-02-17T10:14:59Z", "message": "new look for package.json configuration structure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "badec55fb86db4c26c0640aed9df01748f9f971f", "author": {"user": {"login": "sergiuilie", "name": "Sergiu Ilie"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/badec55fb86db4c26c0640aed9df01748f9f971f", "committedDate": "2020-02-17T10:26:22Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NjQyNzg4", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-359642788", "createdAt": "2020-02-17T10:45:57Z", "commit": {"oid": "badec55fb86db4c26c0640aed9df01748f9f971f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NTo1N1rOFqgAIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NTo1N1rOFqgAIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEwODgzMg==", "bodyText": "in order to use autocomplete in settings.json we can not combine different properties under one structure to have something like:\nbroadcom-cobol-lsp.cpy-manager: { paths: {}, profiles: {} } \nthis link is useful for future implementation", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380108832", "createdAt": "2020-02-17T10:45:57Z", "author": {"login": "sergiuilie"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -38,7 +50,24 @@\n                     \".cob\"\n                 ]\n             }\n-        ]\n+        ],\n+        \"configuration\": {\n+            \"title\": \"Broadcom COBOL LSP\",\n+            \"properties\": {\n+                \"broadcom-cobol-lsp.cpy-manager.profiles\": {\n+                    \"type\": \"Object\",\n+                    \"description\": \"Program name to profile map\"\n+                },\n+                \"broadcom-cobol-lsp.cpy-manager.paths\": {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "badec55fb86db4c26c0640aed9df01748f9f971f"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5215140e56fabb833f1eabf512b4d4164c918fb", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e5215140e56fabb833f1eabf512b4d4164c918fb", "committedDate": "2020-02-17T10:49:21Z", "message": "update settings prefix in code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03acb651d2db803179be353bbb8530ab62e88149", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/03acb651d2db803179be353bbb8530ab62e88149", "committedDate": "2020-02-17T11:37:27Z", "message": "Fix compilation error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/5d5234dd434d511ba2e74337040bb7f7f4cb307c", "committedDate": "2020-02-17T12:00:49Z", "message": "Update messages on configuration change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5Nzg0MDQ4", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-359784048", "createdAt": "2020-02-17T14:43:24Z", "commit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDo0MzoyNVrOFqm0Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNTo1ODowOVrOFqpSpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIyMDQ5OQ==", "bodyText": "just a question, I do like the minimalistic style but do you think that for a newcomer it is easy to read and understand cb and ds variable names?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380220499", "createdAt": "2020-02-17T14:43:25Z", "author": {"login": "sergiuilie"}, "path": "clients/cobol-lsp-vscode-extension/src/CopybooksDownloader.ts", "diffHunk": "@@ -0,0 +1,151 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import * as fs from \"fs\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import { SETTINGS_SECTION } from \"./extension\";\n+import { ProfileService } from \"./ProfileService\";\n+import { ZoweApi } from \"./ZoweApi\";\n+\n+export const DEPENDENCIES_FOLDER: string = \".cobdeps\";\n+export const COPYBOOKS_FOLDER: string = \".copybooks\";\n+\n+export class CopybooksDownloader {\n+    public constructor(\n+        private zoweApi: ZoweApi,\n+        private profileService: ProfileService) { }\n+\n+    public async redownloadDependencies(message: string = \"Redownload dependencies requested.\") {\n+        (await vscode.workspace.findFiles(\".cobdeps/**/*.dep\")).forEach(dep => {\n+            const errFile = dep.fsPath.substr(0, dep.fsPath.length - 4) + \".err\";\n+            if (fs.existsSync(errFile)) {\n+                try {\n+                    fs.unlinkSync(errFile);\n+                } catch (error) {\n+                    vscode.window.showErrorMessage(error.toString());\n+                }\n+            }\n+            this.downloadDependencies(dep, message);\n+        });\n+    }\n+    /**\n+     * @param copybooks array of copybooks names to download\n+     */\n+    public async downloadDependencies(uri: vscode.Uri,\n+                                      message: string = \"Program contains dependencies to missing copybooks.\",\n+                                     ): Promise<void> {\n+        // TODO Maybe introduce download queue?\n+        const missingCopybooksFilePath = uri.fsPath.substr(0, uri.fsPath.length - \".dep\".length) + \".err\";\n+        const copybooks: string[] = fs.readFileSync(uri.fsPath).toString().split(\"\\n\")\n+            .filter(e => e.trim().length > 0)\n+            .map(e => e.trim());\n+        const missingCopybooks: string[] = this.readMissingCopybooks(missingCopybooksFilePath);\n+        if (vscode.workspace.workspaceFolders.length === 0) {\n+            vscode.window.showErrorMessage(\"No workspace folder opened.\");\n+            return;\n+        }\n+\n+        const cb: Set<string> = new Set(copybooks);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIzOTM2NQ==", "bodyText": "you don't get any error here? can you assign empty object to the settingsProfile?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380239365", "createdAt": "2020-02-17T15:17:30Z", "author": {"login": "sergiuilie"}, "path": "clients/cobol-lsp-vscode-extension/src/ProfileService.ts", "diffHunk": "@@ -0,0 +1,104 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import { IProfile } from \"@zowe/imperative\";\n+import * as path from \"path\";\n+import * as vscode from \"vscode\";\n+import { SETTINGS_SECTION } from \"./extension\";\n+import { ProfilesMap, ZoweApi } from \"./ZoweApi\";\n+\n+export class ProfileService {\n+    constructor(private zoweApi: ZoweApi) {\n+    }\n+\n+    public async getProfile(depFile: vscode.Uri): Promise<string> {\n+        const programName = this.getProgramNameFromDepFile(depFile);\n+        const detectedProfile = (await this.findProfileByDependenciesFile(depFile))\n+            || this.tryGetProfileFromSettings(programName);\n+        if (detectedProfile) {\n+            return detectedProfile;\n+        }\n+        const profiles: ProfilesMap = await this.zoweApi.listZOSMFProfiles();\n+        if (Object.keys(profiles).length === 0) {\n+            await vscode.window.showErrorMessage(\"Zowe profile is missing.\");\n+            return undefined;\n+        }\n+        if (Object.keys(profiles).length === 1) {\n+            return Object.keys(profiles)[0];\n+        }\n+        const defaultName = this.zoweApi.getDefaultProfileName();\n+        let items: vscode.QuickPickItem[] = [];\n+        Object.keys(profiles).forEach(name => {\n+            const profile: IProfile = profiles[name];\n+            const item: vscode.QuickPickItem = {\n+                description: profile.username + \"@\" + profile.host + \":\" + profile.port,\n+                label: name,\n+            };\n+            if (defaultName === name) {\n+                items = [item].concat(items);\n+            } else {\n+                items.push(item);\n+            }\n+        });\n+\n+        const selectedProfile = await vscode.window.showQuickPick(items,\n+            { placeHolder: defaultName, canPickMany: false });\n+        if (selectedProfile) {\n+            let settingsProfiles = vscode.workspace.getConfiguration().get(SETTINGS_SECTION + \".profiles\");\n+            settingsProfiles = settingsProfiles ? settingsProfiles : {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI0NDgwMA==", "bodyText": "we are depending a lot on this hardcoded parts from Zowe", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380244800", "createdAt": "2020-02-17T15:27:42Z", "author": {"login": "sergiuilie"}, "path": "clients/cobol-lsp-vscode-extension/src/ZoweApi.ts", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import { BasicProfileManager, IProfile, Session, RestClient, AbstractSession } from \"@zowe/imperative\";\n+import * as os from \"os\";\n+import * as path from \"path\";\n+\n+export interface ProfilesMap {\n+    [key: string]: IProfile;\n+}\n+\n+export class ZoweApi {\n+    private profileManager = new BasicProfileManager({\n+        profileRootDirectory: path.join(os.homedir(), \".zowe\", \"profiles\"),\n+        type: \"zosmf\",\n+    });\n+\n+    public async listZOSMFProfiles(): Promise<ProfilesMap> {\n+        const profiles: ProfilesMap = {};\n+        for (const loadedProfile of await this.profileManager.loadAll()) {\n+            if (loadedProfile.failNotFound) {\n+                profiles[loadedProfile.name] = loadedProfile.profile;\n+            }\n+        }\n+        return profiles;\n+    }\n+\n+    public getDefaultProfileName() {\n+        return this.profileManager.getDefaultProfileName();\n+    }\n+\n+    public async fetchMember(dataset: string, member: string, profileName: string): Promise<string> {\n+        const session: Session = await this.createSession(profileName);\n+\n+        // default should be https\n+        const rpath = `/zosmf/restfiles/ds/${dataset}(${member})`;\n+        return await RestClient.getExpectString(session, rpath, [{\n+            \"Content-Type\": \"application/json\", \"X-CSRF-ZOSMF-HEADER\": \"\" }]);\n+    }\n+\n+    public async listMembers(dataset: string, profileName: string): Promise<string[]> {\n+        // default should be https\n+        const session: Session = await this.createSession(profileName);\n+        const rpath = `/zosmf/restfiles/ds/${dataset}/member`;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI2MTAzMA==", "bodyText": "what does it have to do with the client?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380261030", "createdAt": "2020-02-17T15:58:09Z", "author": {"login": "sergiuilie"}, "path": "com.ca.lsp.cobol/lsp-service-cobol/src/test/java/com/ca/lsp/cobol/TestModule.java", "diffHunk": "@@ -16,6 +16,8 @@\n package com.ca.lsp.cobol;\n \n import com.broadcom.lsp.cdi.module.DefaultModule;\n+import com.broadcom.lsp.domain.cobol.databus.impl.AbstractDataBusBroker;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01a630026de83afe95de6f65d039369621d0ee20", "author": {"user": {"login": "temanbrcom", "name": "Andrei Temnikov"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/01a630026de83afe95de6f65d039369621d0ee20", "committedDate": "2020-02-17T16:00:46Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5ODQ5Njk3", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-359849697", "createdAt": "2020-02-17T16:18:45Z", "commit": {"oid": "01a630026de83afe95de6f65d039369621d0ee20"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNjoxODo0NlrOFqp7rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNjoxODo0NlrOFqp7rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI3MTUzNQ==", "bodyText": "can the profile be a string?", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r380271535", "createdAt": "2020-02-17T16:18:46Z", "author": {"login": "sergiuilie"}, "path": "clients/cobol-lsp-vscode-extension/package.json", "diffHunk": "@@ -38,7 +50,24 @@\n                     \".cob\"\n                 ]\n             }\n-        ]\n+        ],\n+        \"configuration\": {\n+            \"title\": \"Broadcom COBOL LSP\",\n+            \"properties\": {\n+                \"broadcom-cobol-lsp.cpy-manager.profiles\": {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01a630026de83afe95de6f65d039369621d0ee20"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a668a61869eda008896041a2a50d7ba8212514a", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8a668a61869eda008896041a2a50d7ba8212514a", "committedDate": "2020-02-17T22:20:23Z", "message": "Rename some variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4ac5786eb1f15660975bd41a3294737d066884b", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e4ac5786eb1f15660975bd41a3294737d066884b", "committedDate": "2020-02-17T22:20:28Z", "message": "Merge branch 'zowe-copybook-tracker' of github.com:eclipse/che-che4z-lsp-for-cobol into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbebecff6e913ffb93d86fd3efa359e156999261", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/bbebecff6e913ffb93d86fd3efa359e156999261", "committedDate": "2020-02-18T13:35:59Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad1c5aa87a65da02a121c058c2699527f451fe68", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/ad1c5aa87a65da02a121c058c2699527f451fe68", "committedDate": "2020-02-18T15:17:08Z", "message": "Don't create dataset folder if copybook isn't in"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afbbed7ce4c86b3e3fc6150a0f41cf1102c122ec", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/afbbed7ce4c86b3e3fc6150a0f41cf1102c122ec", "committedDate": "2020-02-18T15:25:52Z", "message": "Improve error handling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMTEwMTc2", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-361110176", "createdAt": "2020-02-19T13:32:29Z", "commit": {"oid": "afbbed7ce4c86b3e3fc6150a0f41cf1102c122ec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5793343b4c5b56d9d4d9ffa2640066e085d64152", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/5793343b4c5b56d9d4d9ffa2640066e085d64152", "committedDate": "2020-02-19T15:04:09Z", "message": "Update changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f2bde731981e7c34c9163e1e09da6573d4d07f9", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7f2bde731981e7c34c9163e1e09da6573d4d07f9", "committedDate": "2020-02-19T15:36:10Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cfb5640775a5ddc2eefcece55d8090a4fbdbb89", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/5cfb5640775a5ddc2eefcece55d8090a4fbdbb89", "committedDate": "2020-02-21T10:03:09Z", "message": "Suggest to edit path if there is a problem with dataset"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72e2a05e0338eb2b0382fca3baf4535384118cb0", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/72e2a05e0338eb2b0382fca3baf4535384118cb0", "committedDate": "2020-02-24T10:19:48Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1be290aebcd522838eae23ed4794f0060ca4fdf", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a1be290aebcd522838eae23ed4794f0060ca4fdf", "committedDate": "2020-02-24T13:54:55Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d9c6a3c4aad369c2f543195c23df14ab33bf97a", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4d9c6a3c4aad369c2f543195c23df14ab33bf97a", "committedDate": "2020-02-24T16:44:01Z", "message": "add queue and tests for it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ca963f39c3a6ff76610128a1dbf0b51e655e8ab", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/1ca963f39c3a6ff76610128a1dbf0b51e655e8ab", "committedDate": "2020-02-24T16:48:06Z", "message": "Reset resolve field in queue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f77b9f2837642d38d852fe22bd848c984536a49", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/4f77b9f2837642d38d852fe22bd848c984536a49", "committedDate": "2020-02-27T07:47:46Z", "message": "Merge branch 'development' into zowe-copybook-tracker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7efcde5ca1720e9815861ddc9363a2d917aaffd0", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/7efcde5ca1720e9815861ddc9363a2d917aaffd0", "committedDate": "2020-02-27T14:49:09Z", "message": "WIP download queue. Remove error files."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1f409b3cdf9f743d74583b6e4c4f8d8d36c7272", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a1f409b3cdf9f743d74583b6e4c4f8d8d36c7272", "committedDate": "2020-02-27T15:15:47Z", "message": "Fix lsp start issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd263c5c6c755c6e075e3367b7744a7cce0ed800", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/fd263c5c6c755c6e075e3367b7744a7cce0ed800", "committedDate": "2020-02-27T15:41:20Z", "message": "UX fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cdc3969b8c6ac262bb86609948e34d6591cb9c5", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8cdc3969b8c6ac262bb86609948e34d6591cb9c5", "committedDate": "2020-02-28T08:44:10Z", "message": "Add codeaction to setup dataset paths"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5a6414acdac61982b7c8ffe8312ae0135b87815", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/b5a6414acdac61982b7c8ffe8312ae0135b87815", "committedDate": "2020-02-28T09:51:52Z", "message": "Remove hardcoded version number from code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c261fafcb8657cb56d59a73333d76bbf0f6b720", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/8c261fafcb8657cb56d59a73333d76bbf0f6b720", "committedDate": "2020-02-28T09:59:06Z", "message": "Switch to default profile name for cb downloader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a019e0d22d1c141978fa258b2ed4c44f440b62cb", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/a019e0d22d1c141978fa258b2ed4c44f440b62cb", "committedDate": "2020-02-28T15:27:50Z", "message": "Impreve error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73c0fb7102adf4d63b3e08920e5d3f2bec9da80b", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/73c0fb7102adf4d63b3e08920e5d3f2bec9da80b", "committedDate": "2020-03-02T15:10:33Z", "message": "Read ZOWE_CLI_HOME to load profiles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80763785c77ab938720cd68d0744e4786aa9d522", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/80763785c77ab938720cd68d0744e4786aa9d522", "committedDate": "2020-03-02T20:20:27Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "988db31832da6db0dce486999e4553376133116d", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/988db31832da6db0dce486999e4553376133116d", "committedDate": "2020-03-03T10:35:11Z", "message": "Improve error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e604a5594e7e0b0c96979d8073cf6643d1e818e2", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/e604a5594e7e0b0c96979d8073cf6643d1e818e2", "committedDate": "2020-03-03T11:15:45Z", "message": "Fix ZOWE_CLI_HOME to expect .zowe in it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cca74db5700be2eec9348f00dd4e36b9d6d19fa", "author": {"user": {"login": "ishche", "name": "Yuriy Shekochihin"}}, "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/commit/9cca74db5700be2eec9348f00dd4e36b9d6d19fa", "committedDate": "2020-03-03T11:46:26Z", "message": "Fix error processing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDEwMjgy", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-368010282", "createdAt": "2020-03-03T14:13:24Z", "commit": {"oid": "9cca74db5700be2eec9348f00dd4e36b9d6d19fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MDkyNTYz", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#pullrequestreview-368092563", "createdAt": "2020-03-03T15:46:47Z", "commit": {"oid": "9cca74db5700be2eec9348f00dd4e36b9d6d19fa"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNTo0Njo0N1rOFxLVFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNTo0Njo0N1rOFxLVFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzExMDE2Ng==", "bodyText": "I agree I would prefer to have these values in some resource file", "url": "https://github.com/eclipse/che-che4z-lsp-for-cobol/pull/182#discussion_r387110166", "createdAt": "2020-03-03T15:46:47Z", "author": {"login": "temanbrcom"}, "path": "clients/cobol-lsp-vscode-extension/src/ZoweApi.ts", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Copyright (c) 2020 Broadcom.\n+ * The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.\n+ *\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Broadcom, Inc. - initial API and implementation\n+ */\n+\n+import { BasicProfileManager, IProfile, Session, RestClient, AbstractSession } from \"@zowe/imperative\";\n+import * as os from \"os\";\n+import * as path from \"path\";\n+\n+export interface ProfilesMap {\n+    [key: string]: IProfile;\n+}\n+\n+export class ZoweApi {\n+    private profileManager = new BasicProfileManager({\n+        profileRootDirectory: path.join(os.homedir(), \".zowe\", \"profiles\"),\n+        type: \"zosmf\",\n+    });\n+\n+    public async listZOSMFProfiles(): Promise<ProfilesMap> {\n+        const profiles: ProfilesMap = {};\n+        for (const loadedProfile of await this.profileManager.loadAll()) {\n+            if (loadedProfile.failNotFound) {\n+                profiles[loadedProfile.name] = loadedProfile.profile;\n+            }\n+        }\n+        return profiles;\n+    }\n+\n+    public getDefaultProfileName() {\n+        return this.profileManager.getDefaultProfileName();\n+    }\n+\n+    public async fetchMember(dataset: string, member: string, profileName: string): Promise<string> {\n+        const session: Session = await this.createSession(profileName);\n+\n+        // default should be https\n+        const rpath = `/zosmf/restfiles/ds/${dataset}(${member})`;\n+        return await RestClient.getExpectString(session, rpath, [{\n+            \"Content-Type\": \"application/json\", \"X-CSRF-ZOSMF-HEADER\": \"\" }]);\n+    }\n+\n+    public async listMembers(dataset: string, profileName: string): Promise<string[]> {\n+        // default should be https\n+        const session: Session = await this.createSession(profileName);\n+        const rpath = `/zosmf/restfiles/ds/${dataset}/member`;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI0NDgwMA=="}, "originalCommit": {"oid": "5d5234dd434d511ba2e74337040bb7f7f4cb307c"}, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1185, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}