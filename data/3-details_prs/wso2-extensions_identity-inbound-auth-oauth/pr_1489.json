{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NzE2MDMx", "number": 1489, "title": "Fix special character issues", "bodyText": "Proposed changes in this pull request\nResolves wso2/product-is#9738\nRestrict special characters during oidc/oauth2 scopes", "createdAt": "2020-11-06T12:33:33Z", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489", "merged": true, "mergeCommit": {"oid": "3cf3ed177f9db47f4205b289812d1666e1d5c93a"}, "closed": true, "closedAt": "2020-11-11T03:42:55Z", "author": {"login": "nilasini"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZ2GHrAH2gAyNTE2NzE2MDMxOjhlYmU0ZWExYTZlMjYzYTkzMDAyMDdjOTcyZDZkZDQ1MmM3MmQyZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbNGU6AFqTUyNzQ1Njc3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6", "author": {"user": {"login": "nilasini", "name": "nilasini"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/8ebe4ea1a6e263a9300207c972d6dd452c72d2d6", "committedDate": "2020-11-06T12:26:54Z", "message": "Fix special character issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjAyNzI1", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#pullrequestreview-527202725", "createdAt": "2020-11-10T13:32:22Z", "commit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozMjoyMlrOHwcqEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozMjoyMlrOHwcqEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2MzIxOA==", "bodyText": "Shall we have the regex as a constant", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#discussion_r520563218", "createdAt": "2020-11-10T13:32:22Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -1493,6 +1495,17 @@ private void validateScopeName(String scopeName) throws IdentityOAuthClientExcep\n         validateWhiteSpaces(scopeName);\n     }\n \n+    private void validateRegex(String scopeName) throws IdentityOAuthClientException {\n+\n+        String scopeValidatorRegex = \"^[^?#/()]*$\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjAyODcy", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#pullrequestreview-527202872", "createdAt": "2020-11-10T13:32:34Z", "commit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozMjozNFrOHwcqlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozMjozNFrOHwcqlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2MzM0OA==", "bodyText": "Any reason why we are fixing a depricated method? is it still in use?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#discussion_r520563348", "createdAt": "2020-11-10T13:32:34Z", "author": {"login": "janakamarasena"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/OAuthAdminServiceImpl.java", "diffHunk": "@@ -503,6 +503,7 @@ public void addScope(String scope, String[] claims) throws IdentityOAuthAdminExc\n         int tenantId = PrivilegedCarbonContext.getThreadLocalCarbonContext().getTenantId();\n         try {\n             if (StringUtils.isNotEmpty(scope)) {\n+                validateRegex(scope);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjA1NTA5", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#pullrequestreview-527205509", "createdAt": "2020-11-10T13:35:43Z", "commit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNTo0M1rOHwcyqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNTo0M1rOHwcyqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2NTQxNg==", "bodyText": "If we do not allow changing the regex, it would be user friendly if we say why the scope is invalid rather than saying it should adhere to a specific regex.\nSomething like \"Invalid scope name. A scope name cannot contain special characters x,y or z\"\nDo we have plans to make this regex configurable?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#discussion_r520565416", "createdAt": "2020-11-10T13:35:43Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/Oauth2ScopeConstants.java", "diffHunk": "@@ -49,6 +49,8 @@\n         ERROR_CODE_NOT_AUTHORIZED_ADD_INTERNAL_SCOPE(\"41008\", \"User %s is not authorized to add internal scopes\"),\n         ERROR_CODE_NOT_AUTHORIZED_UPDATE_INTERNAL_SCOPE(\"41009\", \"User %s is not authorized to update internal scopes\"),\n         ERROR_CODE_NOT_AUTHORIZED_DELETE_INTERNAL_SCOPE(\"41010\", \"User %s is not authorized to delete internal scopes\"),\n+        ERROR_CODE_BAD_REQUEST_SCOPE_NAME_NOT_SATIFIED_THE_REGEX(\"41011\", \"Scope name is not \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ebe4ea1a6e263a9300207c972d6dd452c72d2d6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0043446b86652560ae81c8d2d629247e60198af", "author": {"user": {"login": "nilasini", "name": "nilasini"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/b0043446b86652560ae81c8d2d629247e60198af", "committedDate": "2020-11-10T17:29:12Z", "message": "Resolve comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37ae502183bf6b288e23be82d10081c27cd49165", "author": {"user": {"login": "nilasini", "name": "nilasini"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/37ae502183bf6b288e23be82d10081c27cd49165", "committedDate": "2020-11-10T15:58:50Z", "message": "Resolve comments"}, "afterCommit": {"oid": "b0043446b86652560ae81c8d2d629247e60198af", "author": {"user": {"login": "nilasini", "name": "nilasini"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/b0043446b86652560ae81c8d2d629247e60198af", "committedDate": "2020-11-10T17:29:12Z", "message": "Resolve comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NDU2Nzcy", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1489#pullrequestreview-527456772", "createdAt": "2020-11-10T17:48:52Z", "commit": {"oid": "b0043446b86652560ae81c8d2d629247e60198af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3173, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}