{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0OTk2NDQ1", "number": 1357, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1MjoyN1rODy1vHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyNTozNlrOD0KxtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NjM1ODA1OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1MjoyN1rOGHHnCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxNzo0MVrOGI7kzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExNzg5OQ==", "bodyText": "Start with a capital letter and end with a full stop for the comments. Do this in all applicable places.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410117899", "createdAt": "2020-04-17T09:52:27Z", "author": {"login": "dewniMW"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,\n+                                           ServiceProvider serviceProvider) {\n+\n+        AuthenticatedUser authenticatedUser = getAuthenticatedUser(tokenReq, serviceProvider);\n+        AuthenticationContext authenticationContext = initializeAuthContext(authenticatedUser, serviceProvider);\n+        AuthenticationDataPublisher authnDataPublisherProxy =\n+                OAuth2ServiceComponentHolder.getAuthenticationDataPublisherProxy();\n+        if (authnDataPublisherProxy != null && authnDataPublisherProxy.isEnabled(authenticationContext)) {\n+            Map<String, Object> paramMap = new HashMap<>();\n+            paramMap.put(FrameworkConstants.AnalyticsAttributes.USER, authenticatedUser);\n+            Map<String, Object> unmodifiableParamMap = Collections.unmodifiableMap(paramMap);\n+            if (authenticated) {\n+                authnDataPublisherProxy\n+                        .publishAuthenticationStepSuccess(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationSuccess(null, authenticationContext, unmodifiableParamMap);\n+            } else {\n+                authnDataPublisherProxy.\n+                        publishAuthenticationStepFailure(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationFailure(null, authenticationContext,\n+                        unmodifiableParamMap);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * This method will create an AuthenticationContext object which needs to be passed to the publish methods.\n+     *\n+     * @param authenticatedUser User which tries to be authenticate.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     * @return An AuthenticationContest object with relevant details.\n+     */\n+    private AuthenticationContext initializeAuthContext(AuthenticatedUser authenticatedUser,\n+                                                        ServiceProvider serviceProvider) {\n+\n+        AuthenticationContext authenticationContext = new AuthenticationContext();\n+        String contextId = UUIDGenerator.generateUUID();\n+        authenticationContext.setContextIdentifier(contextId);\n+        authenticationContext.setTenantDomain(authenticatedUser.getTenantDomain());\n+        authenticationContext.setRequestType(OAUTH2);\n+        authenticationContext.setRememberMe(false);\n+        authenticationContext.setForceAuthenticate(true);\n+        authenticationContext.setPassiveAuthenticate(false);\n+        authenticationContext.setProperty(IS_INITIAL_LOGIN, true);\n+\n+        // setting sequenceConfig with authenticatedUser, serviceProvider", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 138}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxNzg2OQ==", "bodyText": "Modified", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412017869", "createdAt": "2020-04-21T09:17:41Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,\n+                                           ServiceProvider serviceProvider) {\n+\n+        AuthenticatedUser authenticatedUser = getAuthenticatedUser(tokenReq, serviceProvider);\n+        AuthenticationContext authenticationContext = initializeAuthContext(authenticatedUser, serviceProvider);\n+        AuthenticationDataPublisher authnDataPublisherProxy =\n+                OAuth2ServiceComponentHolder.getAuthenticationDataPublisherProxy();\n+        if (authnDataPublisherProxy != null && authnDataPublisherProxy.isEnabled(authenticationContext)) {\n+            Map<String, Object> paramMap = new HashMap<>();\n+            paramMap.put(FrameworkConstants.AnalyticsAttributes.USER, authenticatedUser);\n+            Map<String, Object> unmodifiableParamMap = Collections.unmodifiableMap(paramMap);\n+            if (authenticated) {\n+                authnDataPublisherProxy\n+                        .publishAuthenticationStepSuccess(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationSuccess(null, authenticationContext, unmodifiableParamMap);\n+            } else {\n+                authnDataPublisherProxy.\n+                        publishAuthenticationStepFailure(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationFailure(null, authenticationContext,\n+                        unmodifiableParamMap);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * This method will create an AuthenticationContext object which needs to be passed to the publish methods.\n+     *\n+     * @param authenticatedUser User which tries to be authenticate.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     * @return An AuthenticationContest object with relevant details.\n+     */\n+    private AuthenticationContext initializeAuthContext(AuthenticatedUser authenticatedUser,\n+                                                        ServiceProvider serviceProvider) {\n+\n+        AuthenticationContext authenticationContext = new AuthenticationContext();\n+        String contextId = UUIDGenerator.generateUUID();\n+        authenticationContext.setContextIdentifier(contextId);\n+        authenticationContext.setTenantDomain(authenticatedUser.getTenantDomain());\n+        authenticationContext.setRequestType(OAUTH2);\n+        authenticationContext.setRememberMe(false);\n+        authenticationContext.setForceAuthenticate(true);\n+        authenticationContext.setPassiveAuthenticate(false);\n+        authenticationContext.setProperty(IS_INITIAL_LOGIN, true);\n+\n+        // setting sequenceConfig with authenticatedUser, serviceProvider", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExNzg5OQ=="}, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 138}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NjM1OTk2OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1Mjo1OVrOGHHoPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxNzo1NVrOGI7lcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExODIwNA==", "bodyText": "Use java multiline comment", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410118204", "createdAt": "2020-04-17T09:52:59Z", "author": {"login": "dewniMW"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,\n+                                           ServiceProvider serviceProvider) {\n+\n+        AuthenticatedUser authenticatedUser = getAuthenticatedUser(tokenReq, serviceProvider);\n+        AuthenticationContext authenticationContext = initializeAuthContext(authenticatedUser, serviceProvider);\n+        AuthenticationDataPublisher authnDataPublisherProxy =\n+                OAuth2ServiceComponentHolder.getAuthenticationDataPublisherProxy();\n+        if (authnDataPublisherProxy != null && authnDataPublisherProxy.isEnabled(authenticationContext)) {\n+            Map<String, Object> paramMap = new HashMap<>();\n+            paramMap.put(FrameworkConstants.AnalyticsAttributes.USER, authenticatedUser);\n+            Map<String, Object> unmodifiableParamMap = Collections.unmodifiableMap(paramMap);\n+            if (authenticated) {\n+                authnDataPublisherProxy\n+                        .publishAuthenticationStepSuccess(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationSuccess(null, authenticationContext, unmodifiableParamMap);\n+            } else {\n+                authnDataPublisherProxy.\n+                        publishAuthenticationStepFailure(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationFailure(null, authenticationContext,\n+                        unmodifiableParamMap);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * This method will create an AuthenticationContext object which needs to be passed to the publish methods.\n+     *\n+     * @param authenticatedUser User which tries to be authenticate.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     * @return An AuthenticationContest object with relevant details.\n+     */\n+    private AuthenticationContext initializeAuthContext(AuthenticatedUser authenticatedUser,\n+                                                        ServiceProvider serviceProvider) {\n+\n+        AuthenticationContext authenticationContext = new AuthenticationContext();\n+        String contextId = UUIDGenerator.generateUUID();\n+        authenticationContext.setContextIdentifier(contextId);\n+        authenticationContext.setTenantDomain(authenticatedUser.getTenantDomain());\n+        authenticationContext.setRequestType(OAUTH2);\n+        authenticationContext.setRememberMe(false);\n+        authenticationContext.setForceAuthenticate(true);\n+        authenticationContext.setPassiveAuthenticate(false);\n+        authenticationContext.setProperty(IS_INITIAL_LOGIN, true);\n+\n+        // setting sequenceConfig with authenticatedUser, serviceProvider\n+        SequenceConfig sequenceConfig = new SequenceConfig();\n+        sequenceConfig.setAuthenticatedUser(authenticatedUser);\n+\n+        // setting applicationConfig with serviceProvider\n+        ApplicationConfig applicationConfig = new ApplicationConfig(serviceProvider);\n+        sequenceConfig.setApplicationConfig(applicationConfig);\n+\n+        sequenceConfig.setAuthenticatedIdPs(FrameworkConstants.LOCAL_IDP_NAME);\n+        authenticationContext.setSequenceConfig(sequenceConfig);\n+\n+        // setting the authenticated IDP for currentAuthenticatedIDPs to get\n+        // the tenant domain and other parameters when the login is a success", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 150}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxODAzMg==", "bodyText": "Modified.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412018032", "createdAt": "2020-04-21T09:17:55Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,\n+                                           ServiceProvider serviceProvider) {\n+\n+        AuthenticatedUser authenticatedUser = getAuthenticatedUser(tokenReq, serviceProvider);\n+        AuthenticationContext authenticationContext = initializeAuthContext(authenticatedUser, serviceProvider);\n+        AuthenticationDataPublisher authnDataPublisherProxy =\n+                OAuth2ServiceComponentHolder.getAuthenticationDataPublisherProxy();\n+        if (authnDataPublisherProxy != null && authnDataPublisherProxy.isEnabled(authenticationContext)) {\n+            Map<String, Object> paramMap = new HashMap<>();\n+            paramMap.put(FrameworkConstants.AnalyticsAttributes.USER, authenticatedUser);\n+            Map<String, Object> unmodifiableParamMap = Collections.unmodifiableMap(paramMap);\n+            if (authenticated) {\n+                authnDataPublisherProxy\n+                        .publishAuthenticationStepSuccess(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationSuccess(null, authenticationContext, unmodifiableParamMap);\n+            } else {\n+                authnDataPublisherProxy.\n+                        publishAuthenticationStepFailure(null, authenticationContext, unmodifiableParamMap);\n+                authnDataPublisherProxy.publishAuthenticationFailure(null, authenticationContext,\n+                        unmodifiableParamMap);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * This method will create an AuthenticationContext object which needs to be passed to the publish methods.\n+     *\n+     * @param authenticatedUser User which tries to be authenticate.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     * @return An AuthenticationContest object with relevant details.\n+     */\n+    private AuthenticationContext initializeAuthContext(AuthenticatedUser authenticatedUser,\n+                                                        ServiceProvider serviceProvider) {\n+\n+        AuthenticationContext authenticationContext = new AuthenticationContext();\n+        String contextId = UUIDGenerator.generateUUID();\n+        authenticationContext.setContextIdentifier(contextId);\n+        authenticationContext.setTenantDomain(authenticatedUser.getTenantDomain());\n+        authenticationContext.setRequestType(OAUTH2);\n+        authenticationContext.setRememberMe(false);\n+        authenticationContext.setForceAuthenticate(true);\n+        authenticationContext.setPassiveAuthenticate(false);\n+        authenticationContext.setProperty(IS_INITIAL_LOGIN, true);\n+\n+        // setting sequenceConfig with authenticatedUser, serviceProvider\n+        SequenceConfig sequenceConfig = new SequenceConfig();\n+        sequenceConfig.setAuthenticatedUser(authenticatedUser);\n+\n+        // setting applicationConfig with serviceProvider\n+        ApplicationConfig applicationConfig = new ApplicationConfig(serviceProvider);\n+        sequenceConfig.setApplicationConfig(applicationConfig);\n+\n+        sequenceConfig.setAuthenticatedIdPs(FrameworkConstants.LOCAL_IDP_NAME);\n+        authenticationContext.setSequenceConfig(sequenceConfig);\n+\n+        // setting the authenticated IDP for currentAuthenticatedIDPs to get\n+        // the tenant domain and other parameters when the login is a success", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExODIwNA=="}, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 150}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NjM2NDUzOnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1NDozMVrOGHHrTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxODoxNVrOGI7mVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExODk5MA==", "bodyText": "Add a new line", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410118990", "createdAt": "2020-04-17T09:54:31Z", "author": {"login": "dewniMW"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "diffHunk": "@@ -391,4 +393,25 @@ protected void unsetTokenBinderInfo(TokenBinderInfo tokenBinderInfo) {\n             OAuth2ServiceComponentHolder.getInstance().removeTokenBinder((TokenBinder) tokenBinderInfo);\n         }\n     }\n+\n+    @Reference(\n+            name = \"framework.authentication.data.publisher\",\n+            service = AuthenticationDataPublisher.class,\n+            cardinality = ReferenceCardinality.MULTIPLE,\n+            policy = ReferencePolicy.DYNAMIC,\n+            unbind = \"unsetAuthenticationDataPublisher\"\n+    )\n+    protected void setAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxODI2Mg==", "bodyText": "Modified.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412018262", "createdAt": "2020-04-21T09:18:15Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "diffHunk": "@@ -391,4 +393,25 @@ protected void unsetTokenBinderInfo(TokenBinderInfo tokenBinderInfo) {\n             OAuth2ServiceComponentHolder.getInstance().removeTokenBinder((TokenBinder) tokenBinderInfo);\n         }\n     }\n+\n+    @Reference(\n+            name = \"framework.authentication.data.publisher\",\n+            service = AuthenticationDataPublisher.class,\n+            cardinality = ReferenceCardinality.MULTIPLE,\n+            policy = ReferencePolicy.DYNAMIC,\n+            unbind = \"unsetAuthenticationDataPublisher\"\n+    )\n+    protected void setAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExODk5MA=="}, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NjM2NTI5OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1NDo0OVrOGHHr0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxODoyNVrOGI7m3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExOTEyMw==", "bodyText": "Add a new line", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410119123", "createdAt": "2020-04-17T09:54:49Z", "author": {"login": "dewniMW"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "diffHunk": "@@ -391,4 +393,25 @@ protected void unsetTokenBinderInfo(TokenBinderInfo tokenBinderInfo) {\n             OAuth2ServiceComponentHolder.getInstance().removeTokenBinder((TokenBinder) tokenBinderInfo);\n         }\n     }\n+\n+    @Reference(\n+            name = \"framework.authentication.data.publisher\",\n+            service = AuthenticationDataPublisher.class,\n+            cardinality = ReferenceCardinality.MULTIPLE,\n+            policy = ReferencePolicy.DYNAMIC,\n+            unbind = \"unsetAuthenticationDataPublisher\"\n+    )\n+    protected void setAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {\n+        if (FrameworkConstants.AnalyticsAttributes.AUTHN_DATA_PUBLISHER_PROXY.equalsIgnoreCase(dataPublisher.\n+                getName()) && dataPublisher.isEnabled(null)) {\n+            OAuth2ServiceComponentHolder.setAuthenticationDataPublisherProxy(dataPublisher);\n+        }\n+    }\n+\n+    protected void unsetAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxODM5OQ==", "bodyText": "Modified.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412018399", "createdAt": "2020-04-21T09:18:25Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "diffHunk": "@@ -391,4 +393,25 @@ protected void unsetTokenBinderInfo(TokenBinderInfo tokenBinderInfo) {\n             OAuth2ServiceComponentHolder.getInstance().removeTokenBinder((TokenBinder) tokenBinderInfo);\n         }\n     }\n+\n+    @Reference(\n+            name = \"framework.authentication.data.publisher\",\n+            service = AuthenticationDataPublisher.class,\n+            cardinality = ReferenceCardinality.MULTIPLE,\n+            policy = ReferencePolicy.DYNAMIC,\n+            unbind = \"unsetAuthenticationDataPublisher\"\n+    )\n+    protected void setAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {\n+        if (FrameworkConstants.AnalyticsAttributes.AUTHN_DATA_PUBLISHER_PROXY.equalsIgnoreCase(dataPublisher.\n+                getName()) && dataPublisher.isEnabled(null)) {\n+            OAuth2ServiceComponentHolder.setAuthenticationDataPublisherProxy(dataPublisher);\n+        }\n+    }\n+\n+    protected void unsetAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExOTEyMw=="}, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NjM2NzA4OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1NToyN1rOGHHtBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwOTo1NToyN1rOGHHtBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDExOTQzMQ==", "bodyText": "Why do we pass null to the isEnabled() method?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410119431", "createdAt": "2020-04-17T09:55:27Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponent.java", "diffHunk": "@@ -391,4 +393,25 @@ protected void unsetTokenBinderInfo(TokenBinderInfo tokenBinderInfo) {\n             OAuth2ServiceComponentHolder.getInstance().removeTokenBinder((TokenBinder) tokenBinderInfo);\n         }\n     }\n+\n+    @Reference(\n+            name = \"framework.authentication.data.publisher\",\n+            service = AuthenticationDataPublisher.class,\n+            cardinality = ReferenceCardinality.MULTIPLE,\n+            policy = ReferencePolicy.DYNAMIC,\n+            unbind = \"unsetAuthenticationDataPublisher\"\n+    )\n+    protected void setAuthenticationDataPublisher(AuthenticationDataPublisher dataPublisher) {\n+        if (FrameworkConstants.AnalyticsAttributes.AUTHN_DATA_PUBLISHER_PROXY.equalsIgnoreCase(dataPublisher.\n+                getName()) && dataPublisher.isEnabled(null)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0Njc3ODE3OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponentHolder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxMjoyMTozNFrOGHLwFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOToxODozN1rOGI7naQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE4NTc0OA==", "bodyText": "Add an empty line as the 1st line of the method. Check in other places as well.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r410185748", "createdAt": "2020-04-17T12:21:34Z", "author": {"login": "janakamarasena"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponentHolder.java", "diffHunk": "@@ -198,4 +200,23 @@ public void setOAuthAdminService(OAuthAdminServiceImpl oauthAdminService) {\n \n         this.oauthAdminService = oauthAdminService;\n     }\n+\n+    /**\n+     * Set Authentication Data Publisher Proxy instance.\n+     *\n+     * @param authenticationDataPublisherProxy\n+     */\n+    public static void setAuthenticationDataPublisherProxy(AuthenticationDataPublisher\n+                                                                   authenticationDataPublisherProxy) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAxODUzNw==", "bodyText": "Modified.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412018537", "createdAt": "2020-04-21T09:18:37Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/internal/OAuth2ServiceComponentHolder.java", "diffHunk": "@@ -198,4 +200,23 @@ public void setOAuthAdminService(OAuthAdminServiceImpl oauthAdminService) {\n \n         this.oauthAdminService = oauthAdminService;\n     }\n+\n+    /**\n+     * Set Authentication Data Publisher Proxy instance.\n+     *\n+     * @param authenticationDataPublisherProxy\n+     */\n+    public static void setAuthenticationDataPublisherProxy(AuthenticationDataPublisher\n+                                                                   authenticationDataPublisherProxy) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE4NTc0OA=="}, "originalCommit": {"oid": "397e811079d3936cc61587a525122f8889e3e115"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MDI5MTA4OnYy", "diffSide": "RIGHT", "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDoyNTozNlrOGI-ZOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMTo0ODozNlrOGJBe0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2NDA1Ng==", "bodyText": "Shall we make this method protected?\nWill be useful for anyone extending the grant handler.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412064056", "createdAt": "2020-04-21T10:25:36Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9d2f866a66f7fb6ff98408f425034d5ebfe7555"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjExNDY0Mg==", "bodyText": "Modified.", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1357#discussion_r412114642", "createdAt": "2020-04-21T11:48:36Z", "author": {"login": "ShanChathusanda93"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/token/handlers/grant/PasswordGrantHandler.java", "diffHunk": "@@ -174,6 +200,86 @@ private boolean validateUserCredentials(OAuth2AccessTokenReqDTO tokenReq, Servic\n         return true;\n     }\n \n+    /**\n+     * This method will publish the Password Grant Authentication data.\n+     *\n+     * @param tokenReq Token request which contains all the details of the request.\n+     * @param authenticated Boolean value which determines whether the user is authenticated or not.\n+     * @param serviceProvider Service provider which contains the details of the application.\n+     */\n+    private void publishAuthenticationData(OAuth2AccessTokenReqDTO tokenReq, boolean authenticated,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2NDA1Ng=="}, "originalCommit": {"oid": "b9d2f866a66f7fb6ff98408f425034d5ebfe7555"}, "originalPosition": 94}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3671, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}