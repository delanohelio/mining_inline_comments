{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwMTQ3MTIy", "number": 1515, "title": "change JSONObject type and rename \"event\" to \"events\"", "bodyText": "Proposed changes in this pull request\n\nChange the JSONObject type to net.minidev.json.JSONObject since org.json.JSONObject doesn't get serialized by nimbuds library\nChange the claim name event to events, to adhere to the OIDC specification\n\nFixes wso2/product-is#7680", "createdAt": "2020-12-15T10:34:19Z", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515", "merged": true, "mergeCommit": {"oid": "fdb6057ba11b6459e33154bd2c82713d5b6fc1fc"}, "closed": true, "closedAt": "2020-12-16T06:09:20Z", "author": {"login": "ThaminduR"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmX54qAFqTU1MjMxNTU3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmoqWWgFqTU1MzM4MTQzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzE1NTc3", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#pullrequestreview-552315577", "createdAt": "2020-12-15T10:35:55Z", "commit": {"oid": "47f189d30b428cd26bfe07b64421168927ce50f8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMDozNTo1NVrOIGEIxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMDozNzoxOFrOIGEMhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIzMDE0OQ==", "bodyText": "Lets add a constant for this", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#discussion_r543230149", "createdAt": "2020-12-15T10:35:55Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oidc.session/src/main/java/org/wso2/carbon/identity/oidc/session/backchannellogout/DefaultLogoutTokenBuilder.java", "diffHunk": "@@ -161,15 +161,15 @@ private JWTClaimsSet buildJwtToken(OIDCSessionState sessionState, String tenantD\n         long currentTimeInMillis = Calendar.getInstance().getTimeInMillis();\n         Date iat = new Date(currentTimeInMillis);\n         String sid = getSidClaim(sessionState);\n-        JSONObject event = new JSONObject().put(\"http://schemas.openidnet/event/backchannel-logout\",\n+        JSONObject event = new JSONObject().appendField(\"http://schemas.openidnet/event/backchannel-logout\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47f189d30b428cd26bfe07b64421168927ce50f8"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIzMTExMQ==", "bodyText": "@piraveena was the previous behaviour wrong according the spec?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#discussion_r543231111", "createdAt": "2020-12-15T10:37:18Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oidc.session/src/main/java/org/wso2/carbon/identity/oidc/session/backchannellogout/DefaultLogoutTokenBuilder.java", "diffHunk": "@@ -161,15 +161,15 @@ private JWTClaimsSet buildJwtToken(OIDCSessionState sessionState, String tenantD\n         long currentTimeInMillis = Calendar.getInstance().getTimeInMillis();\n         Date iat = new Date(currentTimeInMillis);\n         String sid = getSidClaim(sessionState);\n-        JSONObject event = new JSONObject().put(\"http://schemas.openidnet/event/backchannel-logout\",\n+        JSONObject event = new JSONObject().appendField(\"http://schemas.openidnet/event/backchannel-logout\",\n                 new JSONObject());\n \n         JWTClaimsSet.Builder jwtClaimsSetBuilder = new JWTClaimsSet.Builder();\n         jwtClaimsSetBuilder.subject(sub);\n         jwtClaimsSetBuilder.issuer(iss);\n         jwtClaimsSetBuilder.audience(audience);\n         jwtClaimsSetBuilder.claim(\"jti\", jti);\n-        jwtClaimsSetBuilder.claim(\"event\", event);\n+        jwtClaimsSetBuilder.claim(\"events\", event);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47f189d30b428cd26bfe07b64421168927ce50f8"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzM5Mzg1", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#pullrequestreview-552339385", "createdAt": "2020-12-15T11:06:04Z", "commit": {"oid": "09e790c015d97acdf73780ab3a4af4e027c70a78"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMTowNjowNFrOIGFYLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMTowNjowNFrOIGFYLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI1MDQ3Ng==", "bodyText": "change it to private", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#discussion_r543250476", "createdAt": "2020-12-15T11:06:04Z", "author": {"login": "piraveena"}, "path": "components/org.wso2.carbon.identity.oidc.session/src/main/java/org/wso2/carbon/identity/oidc/session/backchannellogout/DefaultLogoutTokenBuilder.java", "diffHunk": "@@ -72,6 +72,7 @@\n     private static final String OPENID_IDP_ENTITY_ID = \"IdPEntityId\";\n     private static final String ERROR_GET_RESIDENT_IDP =\n             \"Error while getting Resident Identity Provider of '%s' tenant.\";\n+    public static final String BACKCHANNEL_LOGOUT_EVENT = \"http://schemas.openidnet/event/backchannel-logout\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09e790c015d97acdf73780ab3a4af4e027c70a78"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87", "author": {"user": {"login": "ThaminduR", "name": "Thamindu Aluthwala"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/02726ff43ec62d4704b470154ede78b62864df87", "committedDate": "2020-12-15T12:39:49Z", "message": "Change JSONObject type, Rename \"event\" claim to \"events\""}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6da79b366f0c5b9bf8a4f69ebfa1fbe2b2c756e", "author": {"user": {"login": "ThaminduR", "name": "Thamindu Aluthwala"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/d6da79b366f0c5b9bf8a4f69ebfa1fbe2b2c756e", "committedDate": "2020-12-15T12:18:30Z", "message": "Merge remote-tracking branch 'origin/fixLogoutToken' into fixLogoutToken"}, "afterCommit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87", "author": {"user": {"login": "ThaminduR", "name": "Thamindu Aluthwala"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/02726ff43ec62d4704b470154ede78b62864df87", "committedDate": "2020-12-15T12:39:49Z", "message": "Change JSONObject type, Rename \"event\" claim to \"events\""}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNjA3MzQy", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#pullrequestreview-552607342", "createdAt": "2020-12-15T15:56:22Z", "commit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNzkxMDIw", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#pullrequestreview-552791020", "createdAt": "2020-12-15T19:19:59Z", "commit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOToyMDowMFrOIGb-7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxOToyMDowMFrOIGb-7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYyMDg0NA==", "bodyText": "Won't we need this same constant during logout token validation?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#discussion_r543620844", "createdAt": "2020-12-15T19:20:00Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oidc.session/src/main/java/org/wso2/carbon/identity/oidc/session/backchannellogout/DefaultLogoutTokenBuilder.java", "diffHunk": "@@ -72,6 +72,7 @@\n     private static final String OPENID_IDP_ENTITY_ID = \"IdPEntityId\";\n     private static final String ERROR_GET_RESIDENT_IDP =\n             \"Error while getting Resident Identity Provider of '%s' tenant.\";\n+    private static final String BACKCHANNEL_LOGOUT_EVENT = \"http://schemas.openidnet/event/backchannel-logout\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzMzgxNDM3", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1515#pullrequestreview-553381437", "createdAt": "2020-12-16T06:08:49Z", "commit": {"oid": "02726ff43ec62d4704b470154ede78b62864df87"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3108, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}