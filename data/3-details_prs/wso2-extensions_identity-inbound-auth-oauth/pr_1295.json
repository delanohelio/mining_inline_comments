{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNDgyNjg2", "number": 1295, "title": "Fix inconstancy in the login and logout consent flows", "bodyText": "Proposed changes in this pull request\nThis will introduce the following two new properties in the identity.xml inside OpenIDConnect tag,\n\nSkipLoginConsent - Skip the OIDC login consent\nSkipLogoutConsent - Skip the OIDC logout consent\n\nIf these properties are not defined, then it will be retrieved from SkipUserConsent\nFix wso2/product-is#7256", "createdAt": "2020-01-16T06:43:36Z", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295", "merged": true, "mergeCommit": {"oid": "58213c67e7da0d14c9e7363947b6b5164ce7956e"}, "closed": true, "closedAt": "2020-01-19T05:34:53Z", "author": {"login": "senthalan"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb60Ti-gH2gAyMzYzNDgyNjg2OjYzOTE2N2Q4ZDk1YjRhNGM2ZjFmM2ZhYzA1Nzg4NTU2ZjdlNWFiOGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7bFklgFqTM0NDkyMzIwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "639167d8d95b4a4c6f1f3fac05788556f7e5ab8e", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/639167d8d95b4a4c6f1f3fac05788556f7e5ab8e", "committedDate": "2020-01-16T06:38:57Z", "message": "Add separate properties to manage login and logout consent flow."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f013bae2ecd16e0b64c9743fffc4139fce2218b", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/5f013bae2ecd16e0b64c9743fffc4139fce2218b", "committedDate": "2020-01-16T06:39:50Z", "message": "Give priority to server level logout consent skip property."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzM2MjU1", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-343736255", "createdAt": "2020-01-16T08:20:36Z", "commit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMDozN1rOFeRJbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMDozN1rOFeRJbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI4MjU0MA==", "bodyText": "shall we add a full stop at the end", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367282540", "createdAt": "2020-01-16T08:20:37Z", "author": {"login": "Buddhimah"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/config/OAuthServerConfiguration.java", "diffHunk": "@@ -1167,12 +1169,33 @@ public String getOpenIDConnectIDTokenSubjectClaim() {\n     }\n \n     /**\n-     * Returns if skip user consent enabled or not\n+     * Returns if login consent enabled or not", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzM2ODE1", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-343736815", "createdAt": "2020-01-16T08:21:51Z", "commit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMTo1MVrOFeRLGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMTo1MVrOFeRLGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI4Mjk3MQ==", "bodyText": "shall we add a full stop at the end", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367282971", "createdAt": "2020-01-16T08:21:51Z", "author": {"login": "Buddhimah"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/config/OAuthServerConfiguration.java", "diffHunk": "@@ -1167,12 +1169,33 @@ public String getOpenIDConnectIDTokenSubjectClaim() {\n     }\n \n     /**\n-     * Returns if skip user consent enabled or not\n+     * Returns if login consent enabled or not\n      *\n-     * @return\n      */\n     public boolean getOpenIDConnectSkipeUserConsentConfig() {\n-        return \"true\".equalsIgnoreCase(openIDConnectSkipUserConsent);\n+\n+        if (openIDConnectSkipLoginConsent == null) {\n+            if (log.isDebugEnabled()) {\n+                log.debug(\"The SkipLoginConsent property is not configured. So retrieving the SkipUserConsent value\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzM2ODY4", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-343736868", "createdAt": "2020-01-16T08:21:59Z", "commit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMTo1OVrOFeRLSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMTo1OVrOFeRLSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI4MzAxOA==", "bodyText": "shall we add a full stop at the end", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367283018", "createdAt": "2020-01-16T08:21:59Z", "author": {"login": "Buddhimah"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/config/OAuthServerConfiguration.java", "diffHunk": "@@ -1167,12 +1169,33 @@ public String getOpenIDConnectIDTokenSubjectClaim() {\n     }\n \n     /**\n-     * Returns if skip user consent enabled or not\n+     * Returns if login consent enabled or not\n      *\n-     * @return\n      */\n     public boolean getOpenIDConnectSkipeUserConsentConfig() {\n-        return \"true\".equalsIgnoreCase(openIDConnectSkipUserConsent);\n+\n+        if (openIDConnectSkipLoginConsent == null) {\n+            if (log.isDebugEnabled()) {\n+                log.debug(\"The SkipLoginConsent property is not configured. So retrieving the SkipUserConsent value\");\n+            }\n+            Boolean.parseBoolean(openIDConnectSkipUserConsent);\n+        }\n+        return Boolean.parseBoolean(openIDConnectSkipLoginConsent);\n+    }\n+\n+    /**\n+     * Returns if skip logout consent enabled or not.\n+     *\n+     */\n+    public boolean getOpenIDConnectSkipLogoutConsentConfig() {\n+\n+        if (openIDConnectSkipLogoutConsent == null) {\n+            if (log.isDebugEnabled()) {\n+                log.debug(\"The SkipLogoutConsent property is not configured. So retrieving the SkipUserConsent value\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzM3Nzg0", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-343737784", "createdAt": "2020-01-16T08:23:48Z", "commit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMzo0OFrOFeRN6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMzo0OFrOFeRN6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI4MzY5MQ==", "bodyText": "why we are using openIDConnectSkipUserConsent variable as a string ?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367283691", "createdAt": "2020-01-16T08:23:48Z", "author": {"login": "Buddhimah"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/config/OAuthServerConfiguration.java", "diffHunk": "@@ -1167,12 +1169,33 @@ public String getOpenIDConnectIDTokenSubjectClaim() {\n     }\n \n     /**\n-     * Returns if skip user consent enabled or not\n+     * Returns if login consent enabled or not\n      *\n-     * @return\n      */\n     public boolean getOpenIDConnectSkipeUserConsentConfig() {\n-        return \"true\".equalsIgnoreCase(openIDConnectSkipUserConsent);\n+\n+        if (openIDConnectSkipLoginConsent == null) {\n+            if (log.isDebugEnabled()) {\n+                log.debug(\"The SkipLoginConsent property is not configured. So retrieving the SkipUserConsent value\");\n+            }\n+            Boolean.parseBoolean(openIDConnectSkipUserConsent);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60e6b560353109be5c9e292d7487d4c0c0f3208c"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDU5MjEz", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-344459213", "createdAt": "2020-01-17T09:38:20Z", "commit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDgzMTQz", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-344483143", "createdAt": "2020-01-17T10:19:48Z", "commit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDoxOTo0OFrOFe0ljg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDoxOTo0OFrOFe0ljg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg2MzE4Mg==", "bodyText": "Shouldn't this be backward compatible? That means if\n(ConfigElements.OPENID_CONNECT_SKIP_LOGOUT_CONSENT)) is null, shouldn't we read ConfigElements.OPENID_CONNECT_SKIP_USER_CONSENT from config file and set its value to 'openIDConnectSkipLogoutConsent'?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367863182", "createdAt": "2020-01-17T10:19:48Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth/config/OAuthServerConfiguration.java", "diffHunk": "@@ -2510,12 +2520,19 @@ private void parseOpenIDConnectConfig(OMElement oauthConfigElem) {\n                                 .getText().trim();\n             }\n             if (openIDConnectConfigElem\n-                    .getFirstChildWithName(getQNameWithIdentityNS(ConfigElements.OPENID_CONNECT_SKIP_USER_CONSENT)) !=\n+                    .getFirstChildWithName(getQNameWithIdentityNS(ConfigElements.OPENID_CONNECT_SKIP_LOGIN_CONSENT)) !=\n                     null) {\n-                openIDConnectSkipUserConsent =\n+                openIDConnectSkipLoginConsent = Boolean.parseBoolean(\n                         openIDConnectConfigElem.getFirstChildWithName(\n-                                getQNameWithIdentityNS(ConfigElements.OPENID_CONNECT_SKIP_USER_CONSENT))\n-                                .getText().trim();\n+                                getQNameWithIdentityNS(ConfigElements.OPENID_CONNECT_SKIP_LOGIN_CONSENT))\n+                                .getText().trim());\n+            }\n+            if (openIDConnectConfigElem.getFirstChildWithName(\n+                    getQNameWithIdentityNS(ConfigElements.OPENID_CONNECT_SKIP_LOGOUT_CONSENT)) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDg2MTc0", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-344486174", "createdAt": "2020-01-17T10:25:20Z", "commit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDoyNToyMVrOFe0uOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDoyNToyMVrOFe0uOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg2NTQwMQ==", "bodyText": "shall we rename the variable name to skipLogoutConsent?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#discussion_r367865401", "createdAt": "2020-01-17T10:25:21Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.oidc.session/src/main/java/org/wso2/carbon/identity/oidc/session/servlet/OIDCLogoutServlet.java", "diffHunk": "@@ -752,14 +752,23 @@ private void removeSessionDataFromCache(String sessionDataKey) {\n      */\n     private boolean getOpenIDConnectSkipUserConsent(String idTokenHint) throws ParseException, IdentityOAuth2Exception {\n \n+        boolean skipLogoutConsentConfig =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e34c4da3a0e0e384b83b67ae6b976fc852b5476f", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/e34c4da3a0e0e384b83b67ae6b976fc852b5476f", "committedDate": "2020-01-17T13:25:26Z", "message": "Fix format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86c06e49a69b0dfd17a6d29df9834e1bcb2ff47b", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/86c06e49a69b0dfd17a6d29df9834e1bcb2ff47b", "committedDate": "2020-01-17T13:25:34Z", "message": "Change to Boolean"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a69d1ad93f7332d61118d55462fc1fdc75cb638c", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/a69d1ad93f7332d61118d55462fc1fdc75cb638c", "committedDate": "2020-01-17T06:47:40Z", "message": "Remove SkipUserConsent as it is redundant."}, "afterCommit": {"oid": "86c06e49a69b0dfd17a6d29df9834e1bcb2ff47b", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/86c06e49a69b0dfd17a6d29df9834e1bcb2ff47b", "committedDate": "2020-01-17T13:25:34Z", "message": "Change to Boolean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7a929a168d21e851a70f517df56de5acceee420", "author": {"user": {"login": "senthalan", "name": "Kanagalingam Senthalan"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/a7a929a168d21e851a70f517df56de5acceee420", "committedDate": "2020-01-17T13:50:49Z", "message": "Change the variable name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTIzMjA0", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1295#pullrequestreview-344923204", "createdAt": "2020-01-18T03:49:59Z", "commit": {"oid": "a7a929a168d21e851a70f517df56de5acceee420"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3186, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}