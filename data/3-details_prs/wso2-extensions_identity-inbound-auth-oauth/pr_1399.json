{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MzE2NzUx", "number": 1399, "title": "Fix introspection endpoint url in tenant legacy URL mode in OIDC config response", "bodyText": "Proposed changes in this pull request\n\nResolves: wso2/product-is#8521\nThis will add tenant as a path param to introspection endpoint in OIDC discovery response in legacy tenant URL mode.\n\nWhen should this PR be merged\nThis PR should be merged before wso2/product-is#8527", "createdAt": "2020-06-18T08:34:26Z", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399", "merged": true, "mergeCommit": {"oid": "593038ec61e23d5af8f7aec1b88c59297edeb6be"}, "closed": true, "closedAt": "2020-06-18T11:49:28Z", "author": {"login": "GANGANI"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsZ7RXgH2gAyNDM2MzE2NzUxOmQ4YTEzNGI4ODEyOWNmOGEyMTBiZDMwYzBkNjNiMjFkMGQzNGI2MGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHFIKogFqTQ4NDY2NTczMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d8a134b88129cf8a210bd30c0d63b21d0d34b60d", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/d8a134b88129cf8a210bd30c0d63b21d0d34b60d", "committedDate": "2020-06-18T08:11:07Z", "message": "Fix introspection endpoint url in tenant legacy URL mode in OIDC config response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMDcxNDI2", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#pullrequestreview-433071426", "createdAt": "2020-06-18T08:48:16Z", "commit": {"oid": "d8a134b88129cf8a210bd30c0d63b21d0d34b60d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMTgxMDkx", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#pullrequestreview-433181091", "createdAt": "2020-06-18T11:15:09Z", "commit": {"oid": "d8a134b88129cf8a210bd30c0d63b21d0d34b60d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMToxNTowOVrOGlqwTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMToxNTowOVrOGlqwTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE1MDk4OA==", "bodyText": "add space after //", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#discussion_r442150988", "createdAt": "2020-06-18T11:15:09Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/util/OAuth2Util.java", "diffHunk": "@@ -1264,6 +1264,26 @@ public static String getOAuth2IntrospectionEPUrl() {\n                     OAuthServerConfiguration.getInstance()::getOauth2IntrospectionEPUrl);\n         }\n \n+        /**\n+         * This method is used to get the resolved URL for the OAuth2 introspection endpoint.\n+         *\n+         * @param tenantDomain Tenant Domain.\n+         * @return String of the resolved URL for the introspection endpoint.\n+         * @throws URISyntaxException URI Syntax Exception.\n+         */\n+        public static String getOAuth2IntrospectionEPUrl(String tenantDomain) throws URISyntaxException {\n+\n+            String getOAuth2IntrospectionEPUrl = buildUrl(OAUTH2_INTROSPECT_EP_URL,\n+                    OAuthServerConfiguration.getInstance()::getOauth2IntrospectionEPUrl);\n+\n+            if (!IdentityTenantUtil.isTenantQualifiedUrlsEnabled() && isNotSuperTenant(tenantDomain)) {\n+                //Append tenant domain to path when the tenant-qualified url mode is disabled.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8a134b88129cf8a210bd30c0d63b21d0d34b60d"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b67eb489e485f9f7fc6f19c1526ceaf8fea2fa45", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/commit/b67eb489e485f9f7fc6f19c1526ceaf8fea2fa45", "committedDate": "2020-06-18T11:31:00Z", "message": "Address comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMjAzMzIx", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#pullrequestreview-433203321", "createdAt": "2020-06-18T11:49:19Z", "commit": {"oid": "b67eb489e485f9f7fc6f19c1526ceaf8fea2fa45"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NjY1NzMz", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#pullrequestreview-484665733", "createdAt": "2020-09-09T05:13:08Z", "commit": {"oid": "b67eb489e485f9f7fc6f19c1526ceaf8fea2fa45"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNToxMzowOVrOHO28og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNToxMzowOVrOHO28og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM0MjM3MA==", "bodyText": "Why do we need the tenantDomain as a query param in the introspection endpoint in legacy mode?", "url": "https://github.com/wso2-extensions/identity-inbound-auth-oauth/pull/1399#discussion_r485342370", "createdAt": "2020-09-09T05:13:09Z", "author": {"login": "mefarazath"}, "path": "components/org.wso2.carbon.identity.oauth/src/main/java/org/wso2/carbon/identity/oauth2/util/OAuth2Util.java", "diffHunk": "@@ -1264,6 +1264,26 @@ public static String getOAuth2IntrospectionEPUrl() {\n                     OAuthServerConfiguration.getInstance()::getOauth2IntrospectionEPUrl);\n         }\n \n+        /**\n+         * This method is used to get the resolved URL for the OAuth2 introspection endpoint.\n+         *\n+         * @param tenantDomain Tenant Domain.\n+         * @return String of the resolved URL for the introspection endpoint.\n+         * @throws URISyntaxException URI Syntax Exception.\n+         */\n+        public static String getOAuth2IntrospectionEPUrl(String tenantDomain) throws URISyntaxException {\n+\n+            String getOAuth2IntrospectionEPUrl = buildUrl(OAUTH2_INTROSPECT_EP_URL,\n+                    OAuthServerConfiguration.getInstance()::getOauth2IntrospectionEPUrl);\n+\n+            if (!IdentityTenantUtil.isTenantQualifiedUrlsEnabled() && isNotSuperTenant(tenantDomain)) {\n+                // Append tenant domain to path when the tenant-qualified url mode is disabled.\n+                getOAuth2IntrospectionEPUrl =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b67eb489e485f9f7fc6f19c1526ceaf8fea2fa45"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3300, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}