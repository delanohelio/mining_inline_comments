{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3NDA1Mzkz", "number": 7123, "reviewThreads": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMDoxMDo1OVrOEwLJlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozOFrOEzW0uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTQ5NzgzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMDoxMDo1OVrOHlkdpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMDoxMDo1OVrOHlkdpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE1Njc3Mw==", "bodyText": "the string-keys should be converted to constants GetShareesRemoteOperation.*", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509156773", "createdAt": "2020-10-21T10:10:59Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -229,21 +243,35 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                 Iterator<JSONObject> namesIt = names.iterator();\n                 JSONObject item;\n                 String displayName;\n-                int icon = 0;\n+                String subline = null;\n+                Object icon = 0;\n                 Uri dataUri;\n                 int count = 0;\n                 while (namesIt.hasNext()) {\n                     item = namesIt.next();\n                     dataUri = null;\n                     displayName = null;\n                     String userName = item.getString(GetShareesRemoteOperation.PROPERTY_LABEL);\n+                    String name = item.isNull(\"name\") ? \"\" : item.getString(\"name\");\n                     JSONObject value = item.getJSONObject(GetShareesRemoteOperation.NODE_VALUE);\n                     ShareType type = ShareType.fromValue(value.getInt(GetShareesRemoteOperation.PROPERTY_SHARE_TYPE));\n                     String shareWith = value.getString(GetShareesRemoteOperation.PROPERTY_SHARE_WITH);\n \n+                    Status status;\n+                    JSONObject statusObject = item.optJSONObject(\"status\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTcyMTkzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToxNDowN1rOHlmomg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTowNjoxM1rOHmFaWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5MjM0Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Paint mTextPaint;\n          \n          \n            \n                private Paint textPaint;", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509192346", "createdAt": "2020-10-21T11:14:07Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;\n+    private @DrawableRes int icon = -1;\n+    private Paint mTextPaint;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY5NjYwMQ==", "bodyText": "Fixed", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509696601", "createdAt": "2020-10-21T21:06:13Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;\n+    private @DrawableRes int icon = -1;\n+    private Paint mTextPaint;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5MjM0Ng=="}, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTcyMzY2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToxNDozNlrOHlmprg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTowNjowN1rOHmFaAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5MjYyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private String mText = null;\n          \n          \n            \n                private String text = null;", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509192622", "createdAt": "2020-10-21T11:14:36Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY5NjUxNA==", "bodyText": "Fixed", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509696514", "createdAt": "2020-10-21T21:06:07Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5MjYyMg=="}, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTcyNDQwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToxNDo1MVrOHlmqKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTowNjowMlrOHmFZ1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5Mjc0Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final Paint mBackground;\n          \n          \n            \n                private final Paint background;", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509192746", "createdAt": "2020-10-21T11:14:51Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;\n+    private @DrawableRes int icon = -1;\n+    private Paint mTextPaint;\n+    private final Paint mBackground;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY5NjQ3MQ==", "bodyText": "Fixed", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509696471", "createdAt": "2020-10-21T21:06:02Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/StatusDrawable.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.owncloud.android.ui;\n+\n+import android.content.Context;\n+import android.graphics.Canvas;\n+import android.graphics.Color;\n+import android.graphics.ColorFilter;\n+import android.graphics.Paint;\n+import android.graphics.PixelFormat;\n+import android.graphics.drawable.Drawable;\n+\n+import com.owncloud.android.utils.BitmapUtils;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.NonNull;\n+import androidx.core.content.res.ResourcesCompat;\n+\n+/**\n+ * A Drawable object that draws a status\n+ */\n+public class StatusDrawable extends Drawable {\n+    private String mText = null;\n+    private @DrawableRes int icon = -1;\n+    private Paint mTextPaint;\n+    private final Paint mBackground;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5Mjc0Ng=="}, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTc0ODI4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/utils/BitmapUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToyMToyM1rOHlm4nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToyMToyM1rOHlm4nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5NjQ0NQ==", "bodyText": "primary_dark or primary?", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509196445", "createdAt": "2020-10-21T11:21:23Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/utils/BitmapUtils.java", "diffHunk": "@@ -194,12 +202,19 @@ else if (orientation == ExifInterface.ORIENTATION_ROTATE_270) {\n         return resultBitmap;\n     }\n \n-    public static Color usernameToColor(String name) throws NoSuchAlgorithmException {\n+    public static Color usernameToColor(String name) {\n         String hash = name.toLowerCase(Locale.ROOT);\n \n         // already a md5 hash?\n         if (!hash.matches(\"([0-9a-f]{4}-?){8}$\")) {\n-            hash = md5(hash);\n+            try {\n+                hash = md5(hash);\n+            } catch (NoSuchAlgorithmException e) {\n+                int color = getResources().getColor(R.color.primary_dark);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4OTc2MDEwOnYy", "diffSide": "RIGHT", "path": "src/main/res/drawable/ic_user_status_away.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMToyNDo0MlrOHlm_yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMTowNTo1M1rOHmFZgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5ODI4Mg==", "bodyText": "I think we (still) don't prefix with ~", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509198282", "createdAt": "2020-10-21T11:24:42Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/res/drawable/ic_user_status_away.xml", "diffHunk": "@@ -0,0 +1,32 @@\n+<!--\n+  ~\n+  ~ Nextcloud Android client application", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY5NjM4Nw==", "bodyText": "Fixed", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r509696387", "createdAt": "2020-10-21T21:05:53Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/res/drawable/ic_user_status_away.xml", "diffHunk": "@@ -0,0 +1,32 @@\n+<!--\n+  ~\n+  ~ Nextcloud Android client application", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTE5ODI4Mg=="}, "originalCommit": {"oid": "0748f498f99b6d463110c1462f07d954cbae2b8f"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2NzQwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozMlrOHqh2fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozMlrOHqh2fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1Njg2Mw==", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356863", "createdAt": "2020-10-29T15:36:32Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -324,6 +374,59 @@ public int update(@NonNull Uri uri, ContentValues values, String selection, Stri\n         return 0;\n     }\n \n+    @Nullable\n+    @Override\n+    @SuppressFBWarnings(\"IOI_USE_OF_FILE_STREAM_CONSTRUCTORS\") // TODO remove with API26\n+    public ParcelFileDescriptor openFile(@NonNull Uri uri, @NonNull String mode) throws FileNotFoundException {\n+        ArbitraryDataProvider arbitraryDataProvider = new ArbitraryDataProvider(getContext().getContentResolver());\n+\n+        String userId = uri.getQueryParameter(\"shareWith\");\n+        String displayName = uri.getQueryParameter(\"displayName\");\n+        String accountName = accountManager.getUser().getAccountName();\n+        String serverName = accountName.substring(accountName.lastIndexOf('@') + 1);\n+\n+        String eTag = arbitraryDataProvider.getValue(userId + \"@\" + serverName, ThumbnailsCacheManager.AVATAR);\n+        String avatarKey = \"a_\" + userId + \"_\" + serverName + \"_\" + eTag;\n+\n+        StatusType status = StatusType.valueOf(uri.getQueryParameter(\"status\"));\n+        String icon = uri.getQueryParameter(\"icon\");\n+\n+        Bitmap avatarBitmap = ThumbnailsCacheManager.getBitmapFromDiskCache(avatarKey);\n+\n+        if (avatarBitmap == null) {\n+            float avatarRadius = getContext().getResources().getDimension(R.dimen.list_item_avatar_icon_radius);\n+            avatarBitmap = BitmapUtils.drawableToBitmap(TextDrawable.createNamedAvatar(displayName, avatarRadius));\n+        }\n+\n+        Bitmap avatar = BitmapUtils.createAvatarWithStatus(avatarBitmap, status, icon, getContext());\n+\n+        // create a file to write bitmap data\n+        File f = new File(getContext().getCacheDir(), \"test\");\n+        try {\n+            if (!f.createNewFile()) {\n+                throw new IllegalStateException(\"File could not be created!\");\n+            }\n+\n+            //Convert bitmap to byte array\n+            ByteArrayOutputStream bos = new ByteArrayOutputStream();\n+\n+            avatar.compress(Bitmap.CompressFormat.PNG, 90, bos);\n+            byte[] bitmapData = bos.toByteArray();\n+\n+            //write the bytes in file\n+            try (FileOutputStream fos = new FileOutputStream(f)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 238}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2NzUwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozM1rOHqh2iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozM1rOHqh2iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1Njg3NQ==", "bodyText": "Codacy found an issue: Avoid instantiating new objects inside loops", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356875", "createdAt": "2020-10-29T15:36:33Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -229,21 +244,37 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                 Iterator<JSONObject> namesIt = names.iterator();\n                 JSONObject item;\n                 String displayName;\n-                int icon = 0;\n+                String subline = null;\n+                Object icon = 0;\n                 Uri dataUri;\n                 int count = 0;\n                 while (namesIt.hasNext()) {\n                     item = namesIt.next();\n                     dataUri = null;\n                     displayName = null;\n                     String userName = item.getString(GetShareesRemoteOperation.PROPERTY_LABEL);\n+                    String name = item.isNull(\"name\") ? \"\" : item.getString(\"name\");\n                     JSONObject value = item.getJSONObject(GetShareesRemoteOperation.NODE_VALUE);\n                     ShareType type = ShareType.fromValue(value.getInt(GetShareesRemoteOperation.PROPERTY_SHARE_TYPE));\n                     String shareWith = value.getString(GetShareesRemoteOperation.PROPERTY_SHARE_WITH);\n \n+                    Status status;\n+                    JSONObject statusObject = item.optJSONObject(PROPERTY_STATUS);\n+\n+                    if (statusObject != null) {\n+                        status = new Status(\n+                            StatusType.valueOf(statusObject.getString(PROPERTY_STATUS)),\n+                            statusObject.isNull(PROPERTY_MESSAGE) ? \"\" : statusObject.getString(PROPERTY_MESSAGE),\n+                            statusObject.isNull(PROPERTY_ICON) ? \"\" : statusObject.getString(PROPERTY_ICON),\n+                            statusObject.isNull(PROPERTY_CLEAR_AT) ? -1 : statusObject.getInt(PROPERTY_CLEAR_AT)\n+                        );\n+                    } else {\n+                        status = new Status(StatusType.OFFLINE, \"\", \"\", -1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2NzU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/TextDrawable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNFrOHqh2lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNFrOHqh2lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1Njg4Ng==", "bodyText": "Codacy found an issue: Avoid using redundant field initializer for 'bigText'", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356886", "createdAt": "2020-10-29T15:36:34Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/ui/TextDrawable.java", "diffHunk": "@@ -65,6 +64,8 @@\n      */\n     private float mRadius;\n \n+    private boolean bigText = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2NzY1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/utils/BitmapUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNVrOHqh2og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNVrOHqh2og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1Njg5OA==", "bodyText": "Codacy found an issue: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356898", "createdAt": "2020-10-29T15:36:35Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/utils/BitmapUtils.java", "diffHunk": "@@ -384,6 +414,90 @@ public static void setRoundedBitmapForGridMode(Bitmap thumbnail, ImageView image\n                                      imageView);\n     }\n \n+    public static Bitmap createAvatarWithStatus(Bitmap avatar, StatusType status, String icon, Context context) {\n+        float avatarRadius = getResources().getDimension(R.dimen.list_item_avatar_icon_radius);\n+        int width = DisplayUtils.convertDpToPixel(2 * avatarRadius, context);\n+\n+        Bitmap output = Bitmap.createBitmap(width, width, Bitmap.Config.ARGB_8888);\n+        Canvas canvas = new Canvas(output);\n+\n+        // avatar\n+        Bitmap croppedBitmap = getCroppedBitmap(avatar, width);\n+\n+        canvas.drawBitmap(croppedBitmap, 0f, 0f, null);\n+\n+        // status\n+        int statusSize = width / 4;\n+\n+        StatusDrawable statusDrawable;\n+        if (TextUtils.isEmpty(icon)) {\n+            switch (status) {\n+                case DND:\n+                    statusDrawable = new StatusDrawable(R.drawable.ic_user_status_dnd, statusSize, context);\n+                    statusDrawable.setBounds(width / 2,\n+                                             width / 2,\n+                                             width,\n+                                             width);\n+                    break;\n+\n+                case ONLINE:\n+                    statusDrawable = new StatusDrawable(new Color(255, 73, 179, 130), statusSize);\n+                    statusDrawable.setBounds(width,\n+                                             width,\n+                                             width,\n+                                             width);\n+                    break;\n+\n+                case AWAY:\n+                    statusDrawable = new StatusDrawable(R.drawable.ic_user_status_away, statusSize, context);\n+                    statusDrawable.setBounds(width / 2,\n+                                             width / 2,\n+                                             width,\n+                                             width);\n+                    break;\n+\n+                default:\n+                    // do not show\n+                    statusDrawable = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2NzcwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNlrOHqh2qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozNlrOHqh2qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1NjkwNw==", "bodyText": "Codacy found an issue: Avoid instantiating new objects inside loops", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356907", "createdAt": "2020-10-29T15:36:36Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -229,21 +244,37 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                 Iterator<JSONObject> namesIt = names.iterator();\n                 JSONObject item;\n                 String displayName;\n-                int icon = 0;\n+                String subline = null;\n+                Object icon = 0;\n                 Uri dataUri;\n                 int count = 0;\n                 while (namesIt.hasNext()) {\n                     item = namesIt.next();\n                     dataUri = null;\n                     displayName = null;\n                     String userName = item.getString(GetShareesRemoteOperation.PROPERTY_LABEL);\n+                    String name = item.isNull(\"name\") ? \"\" : item.getString(\"name\");\n                     JSONObject value = item.getJSONObject(GetShareesRemoteOperation.NODE_VALUE);\n                     ShareType type = ShareType.fromValue(value.getInt(GetShareesRemoteOperation.PROPERTY_SHARE_TYPE));\n                     String shareWith = value.getString(GetShareesRemoteOperation.PROPERTY_SHARE_WITH);\n \n+                    Status status;\n+                    JSONObject statusObject = item.optJSONObject(PROPERTY_STATUS);\n+\n+                    if (statusObject != null) {\n+                        status = new Status(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2Nzc1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozN1rOHqh2tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozN1rOHqh2tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1NjkxNw==", "bodyText": "Codacy found an issue: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356917", "createdAt": "2020-10-29T15:36:37Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -254,30 +285,48 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                                 dataUri = Uri.withAppendedPath(remoteBaseUri, shareWith);\n \n                                 if (userName.equals(shareWith)) {\n-                                    displayName = getContext().getString(R.string.share_remote_clarification, userName);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.remote);\n                                 } else {\n                                     String[] uriSplitted = shareWith.split(\"@\");\n-                                    displayName = getContext().getString(R.string.share_known_remote_clarification,\n-                                                                         userName, uriSplitted[uriSplitted.length - 1]);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.share_known_remote_on_clarification,\n+                                                                     uriSplitted[uriSplitted.length - 1]);\n                                 }\n                             }\n                             break;\n \n                         case USER:\n                             displayName = userName;\n-                            icon = R.drawable.ic_user;\n+                            subline = (status.getMessage() == null || status.getMessage().isEmpty()) ? null :", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 151}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMjg2Nzc3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozOFrOHqh2uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNTozNjozOFrOHqh2uA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM1NjkyMA==", "bodyText": "Codacy found an issue: Useless parentheses.", "url": "https://github.com/nextcloud/android/pull/7123#discussion_r514356920", "createdAt": "2020-10-29T15:36:38Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/providers/UsersAndGroupsSearchProvider.java", "diffHunk": "@@ -254,30 +285,48 @@ private Cursor searchForUsersOrGroups(Uri uri) {\n                                 dataUri = Uri.withAppendedPath(remoteBaseUri, shareWith);\n \n                                 if (userName.equals(shareWith)) {\n-                                    displayName = getContext().getString(R.string.share_remote_clarification, userName);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.remote);\n                                 } else {\n                                     String[] uriSplitted = shareWith.split(\"@\");\n-                                    displayName = getContext().getString(R.string.share_known_remote_clarification,\n-                                                                         userName, uriSplitted[uriSplitted.length - 1]);\n+                                    displayName = name;\n+                                    subline = getContext().getString(R.string.share_known_remote_on_clarification,\n+                                                                     uriSplitted[uriSplitted.length - 1]);\n                                 }\n                             }\n                             break;\n \n                         case USER:\n                             displayName = userName;\n-                            icon = R.drawable.ic_user;\n+                            subline = (status.getMessage() == null || status.getMessage().isEmpty()) ? null :", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df3da6ab8236e23a1c97e1a29469f652db4f7f57"}, "originalPosition": 151}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3255, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}