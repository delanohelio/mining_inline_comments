{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNzgzNjY3", "number": 5434, "title": "Migrate account list to new user model", "bodyText": "Signed-off-by: Chris Narkiewicz hello@ezaquarii.com", "createdAt": "2020-02-09T03:01:35Z", "url": "https://github.com/nextcloud/android/pull/5434", "merged": true, "mergeCommit": {"oid": "a063f32d25c751254f8caf1ea4a0f88535368e32"}, "closed": true, "closedAt": "2020-02-12T11:18:01Z", "author": {"login": "ezaquarii"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcCf_B7ABqjMwMjAzMTc0NTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDiMeNgFqTM1NzI2NzE5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46dc43ad5b6cd869421733b11c9550af03463f89", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/46dc43ad5b6cd869421733b11c9550af03463f89", "committedDate": "2020-02-09T03:01:07Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "d63b9e95d5521b7b392cacb9247a525022c34388", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/d63b9e95d5521b7b392cacb9247a525022c34388", "committedDate": "2020-02-09T03:29:25Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d63b9e95d5521b7b392cacb9247a525022c34388", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/d63b9e95d5521b7b392cacb9247a525022c34388", "committedDate": "2020-02-09T03:29:25Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "c3df42239a555cf664266cbbfadfa81b8acd9bce", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/c3df42239a555cf664266cbbfadfa81b8acd9bce", "committedDate": "2020-02-09T10:22:58Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3df42239a555cf664266cbbfadfa81b8acd9bce", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/c3df42239a555cf664266cbbfadfa81b8acd9bce", "committedDate": "2020-02-09T10:22:58Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "4cf6c3d858ae34f19393428bce74b59749ae00ab", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/4cf6c3d858ae34f19393428bce74b59749ae00ab", "committedDate": "2020-02-09T10:26:17Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTk3MDg0", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-355597084", "createdAt": "2020-02-09T10:26:33Z", "commit": {"oid": "c3df42239a555cf664266cbbfadfa81b8acd9bce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQxMDoyNjozM1rOFnUVCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQxMDoyNjozM1rOFnUVCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc3MTg0OA==", "bodyText": "Issue found: Avoid instantiating new objects inside loops", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r376771848", "createdAt": "2020-02-09T10:26:33Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/ui/activity/ManageAccountsActivity.java", "diffHunk": "@@ -223,25 +233,20 @@ private void initializeComponentGetters() {\n         }\n     }\n \n-    /**\n-     * creates the account list items list including the add-account action in case multiaccount_support is enabled.\n-     *\n-     * @return list of account list items\n-     */\n-    private List<AccountListItem> getAccountListItems() {\n-        Account[] accountList = AccountManager.get(this).getAccountsByType(MainApp.getAccountType(this));\n-        List<AccountListItem> adapterAccountList = new ArrayList<>(accountList.length);\n-        for (Account account : accountList) {\n-            boolean pendingForRemoval = arbitraryDataProvider.getBooleanValue(account, PENDING_FOR_REMOVAL);\n-            adapterAccountList.add(new AccountListItem(account, !pendingForRemoval));\n+    private List<UserListItem> getUserListItems() {\n+        List<User> users = accountManager.getAllUsers();\n+        List<UserListItem> userListItems = new ArrayList<>(users.size());\n+        for (User user : users) {\n+            boolean pendingForRemoval = arbitraryDataProvider.getBooleanValue(user.toPlatformAccount(),\n+                                                                              PENDING_FOR_REMOVAL);\n+            userListItems.add(new UserListItem(user, !pendingForRemoval));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3df42239a555cf664266cbbfadfa81b8acd9bce"}, "originalPosition": 197}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4cf6c3d858ae34f19393428bce74b59749ae00ab", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/4cf6c3d858ae34f19393428bce74b59749ae00ab", "committedDate": "2020-02-09T10:26:17Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "committedDate": "2020-02-09T10:54:10Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "committedDate": "2020-02-09T10:54:10Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "5965fe90ebeb83c68ba7681a298367ba8901f190", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/5965fe90ebeb83c68ba7681a298367ba8901f190", "committedDate": "2020-02-10T15:52:14Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5965fe90ebeb83c68ba7681a298367ba8901f190", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/5965fe90ebeb83c68ba7681a298367ba8901f190", "committedDate": "2020-02-10T15:52:14Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "d4b688e71758455818efed2855b1c7f248ea9fbc", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/d4b688e71758455818efed2855b1c7f248ea9fbc", "committedDate": "2020-02-10T15:56:36Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MDU3MjY0", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-356057264", "createdAt": "2020-02-10T16:02:13Z", "commit": {"oid": "d4b688e71758455818efed2855b1c7f248ea9fbc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNjowMjoxNFrOFnruag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNjowMjoxNFrOFnruag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzE1NTE3OA==", "bodyText": "DOH! Gihub is diffing wrong files!\nThis should be diffed against old AccountListAdapter, that has become UserListAdapter, becuase it shows users.\nOld UserListAdapter has become ShareeListAdapter, bacuse it shows users sharing a file.", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r377155178", "createdAt": "2020-02-10T16:02:14Z", "author": {"login": "ezaquarii"}, "path": "src/main/java/com/owncloud/android/ui/adapter/UserListAdapter.java", "diffHunk": "@@ -1,449 +1,339 @@\n /*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4b688e71758455818efed2855b1c7f248ea9fbc"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4b688e71758455818efed2855b1c7f248ea9fbc", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/d4b688e71758455818efed2855b1c7f248ea9fbc", "committedDate": "2020-02-10T15:56:36Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "committedDate": "2020-02-09T10:54:10Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/f49c6c3cf4813ff65dd14b8297ce10cddc3521b0", "committedDate": "2020-02-09T10:54:10Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "4a548acf4255369e8ef53149df4862ab78ce2a4d", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/4a548acf4255369e8ef53149df4862ab78ce2a4d", "committedDate": "2020-02-10T17:25:11Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a548acf4255369e8ef53149df4862ab78ce2a4d", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/4a548acf4255369e8ef53149df4862ab78ce2a4d", "committedDate": "2020-02-10T17:25:11Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "48d9b58306dc652627fda31074c3d0d6f57a196c", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/48d9b58306dc652627fda31074c3d0d6f57a196c", "committedDate": "2020-02-10T17:29:12Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MTI2NTA4", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-356126508", "createdAt": "2020-02-10T17:31:01Z", "commit": {"oid": "48d9b58306dc652627fda31074c3d0d6f57a196c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzozMTowMVrOFnvAYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzozMTowMVrOFnvAYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIwODkyOA==", "bodyText": "This was UserListAdapter, renamed into Sharee*. Github is confused.", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r377208928", "createdAt": "2020-02-10T17:31:01Z", "author": {"login": "ezaquarii"}, "path": "src/main/java/com/owncloud/android/ui/adapter/ShareeListAdapter.java", "diffHunk": "@@ -0,0 +1,453 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48d9b58306dc652627fda31074c3d0d6f57a196c"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4587241f7dd748dbb1d742c6595d9b129438704", "author": {"user": null}, "url": "https://github.com/nextcloud/android/commit/a4587241f7dd748dbb1d742c6595d9b129438704", "committedDate": "2020-02-10T19:08:29Z", "message": "Drone: update FindBugs results to reflect reduced error/warning count [skip ci]\n\nSigned-off-by: nextcloud-android-bot <android@nextcloud.com>"}, "afterCommit": {"oid": "9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e", "committedDate": "2020-02-10T20:49:30Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDc2NzAx", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-356476701", "createdAt": "2020-02-11T08:31:16Z", "commit": {"oid": "9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODozMToxNlrOFoAcFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODozMToxNlrOFoAcFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQ5NDU1MA==", "bodyText": "This would lead to a direct return after clicking on the user/account.\nAs far as I know, we had an empty for this previously.\nCan we have this?\nI can write a test case for this.", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r377494550", "createdAt": "2020-02-11T08:31:16Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/UserInfoActivity.java", "diffHunk": "@@ -116,15 +118,22 @@\n     private Unbinder unbinder;\n \n     private UserInfo userInfo;\n-    private Account account;\n+    private User user;\n \n     @Override\n     public void onCreate(Bundle savedInstanceState) {\n         Log_OC.v(TAG, \"onCreate() start\");\n         super.onCreate(savedInstanceState);\n         Bundle bundle = getIntent().getExtras();\n \n-        account = Parcels.unwrap(bundle.getParcelable(KEY_ACCOUNT));\n+        final Account account = Parcels.unwrap(bundle.getParcelable(KEY_ACCOUNT));\n+        Optional<User> optionalUser = accountManager.getUser(account != null ? account.name : \"\");\n+        if(!optionalUser.isPresent()) {\n+            finish();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e"}, "originalPosition": 42}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/9fbaf2c9fd1f7f3f71e64599dcf79c980180ad8e", "committedDate": "2020-02-10T20:49:30Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "0469cf15d2c54fa112e800048974660323405eec", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/0469cf15d2c54fa112e800048974660323405eec", "committedDate": "2020-02-11T23:39:59Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53024d1cd1bb6b2e829f64d68ce29a2fcf795262", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/53024d1cd1bb6b2e829f64d68ce29a2fcf795262", "committedDate": "2020-02-12T07:31:38Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0469cf15d2c54fa112e800048974660323405eec", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/0469cf15d2c54fa112e800048974660323405eec", "committedDate": "2020-02-11T23:39:59Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}, "afterCommit": {"oid": "53024d1cd1bb6b2e829f64d68ce29a2fcf795262", "author": {"user": {"login": "ezaquarii", "name": "Chris Narkiewicz"}}, "url": "https://github.com/nextcloud/android/commit/53024d1cd1bb6b2e829f64d68ce29a2fcf795262", "committedDate": "2020-02-12T07:31:38Z", "message": "Migrate account list to new user model\n\nSigned-off-by: Chris Narkiewicz <hello@ezaquarii.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/0569b0de6543bfaf78d689c8b4296ca24fc2bdd3", "committedDate": "2020-02-12T08:34:59Z", "message": "Screenshot tests ManageAccountsActivity\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjY2NTc3", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-357266577", "createdAt": "2020-02-12T08:37:08Z", "commit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjY3MTY0", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-357267164", "createdAt": "2020-02-12T08:38:12Z", "commit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxM1rOFolqIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxM1rOFolqIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODEwNDM1NA==", "bodyText": "Issue found: Avoid instantiating new objects inside loops", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r378104354", "createdAt": "2020-02-12T08:38:13Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/ui/dialog/MultipleAccountsDialog.java", "diffHunk": "@@ -117,21 +120,21 @@ public Dialog onCreateDialog(Bundle savedInstanceState) {\n      *\n      * @return list of account list items\n      */\n-    private List<AccountListItem> getAccountListItems() {\n-        Account[] accountList = accountManager.getAccounts();\n-        List<AccountListItem> adapterAccountList = new ArrayList<>(accountList.length);\n-        for (Account account : accountList) {\n-            adapterAccountList.add(new AccountListItem(account));\n+    private List<UserListItem> getAccountListItems() {\n+        List<User> users = accountManager.getAllUsers();\n+        List<UserListItem> adapterUserList = new ArrayList<>(users.size());\n+        for (User user : users) {\n+            adapterUserList.add(new UserListItem(user));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjY3MTgz", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-357267183", "createdAt": "2020-02-12T08:38:14Z", "commit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxNFrOFolqLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxNFrOFolqLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODEwNDM2Ng==", "bodyText": "Issue found: Avoid instantiating new objects inside loops", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r378104366", "createdAt": "2020-02-12T08:38:14Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/ui/activity/ManageAccountsActivity.java", "diffHunk": "@@ -223,25 +232,20 @@ private void initializeComponentGetters() {\n         }\n     }\n \n-    /**\n-     * creates the account list items list including the add-account action in case multiaccount_support is enabled.\n-     *\n-     * @return list of account list items\n-     */\n-    private List<AccountListItem> getAccountListItems() {\n-        Account[] accountList = AccountManager.get(this).getAccountsByType(MainApp.getAccountType(this));\n-        List<AccountListItem> adapterAccountList = new ArrayList<>(accountList.length);\n-        for (Account account : accountList) {\n-            boolean pendingForRemoval = arbitraryDataProvider.getBooleanValue(account, PENDING_FOR_REMOVAL);\n-            adapterAccountList.add(new AccountListItem(account, !pendingForRemoval));\n+    private List<UserListItem> getUserListItems() {\n+        List<User> users = accountManager.getAllUsers();\n+        List<UserListItem> userListItems = new ArrayList<>(users.size());\n+        for (User user : users) {\n+            boolean pendingForRemoval = arbitraryDataProvider.getBooleanValue(user.toPlatformAccount(),\n+                                                                              PENDING_FOR_REMOVAL);\n+            userListItems.add(new UserListItem(user, !pendingForRemoval));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "originalPosition": 206}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjY3MTk0", "url": "https://github.com/nextcloud/android/pull/5434#pullrequestreview-357267194", "createdAt": "2020-02-12T08:38:15Z", "commit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxNVrOFolqOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwODozODoxNVrOFolqOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODEwNDM3Nw==", "bodyText": "Issue found: Deeply nested if..then statements are hard to read", "url": "https://github.com/nextcloud/android/pull/5434#discussion_r378104377", "createdAt": "2020-02-12T08:38:15Z", "author": {"login": "nextcloud-android-bot"}, "path": "src/main/java/com/owncloud/android/ui/activity/ManageAccountsActivity.java", "diffHunk": "@@ -155,9 +155,12 @@ protected void onActivityResult(int requestCode, int resultCode, Intent data) {\n         if (resultCode == KEY_DELETE_CODE && data != null) {\n             Bundle bundle = data.getExtras();\n             if (bundle != null && bundle.containsKey(UserInfoActivity.KEY_ACCOUNT)) {\n-                Account account = Parcels.unwrap(bundle.getParcelable(UserInfoActivity.KEY_ACCOUNT));\n-                accountName = account.name;\n-                performAccountRemoval(account);\n+                final Account account = Parcels.unwrap(bundle.getParcelable(UserInfoActivity.KEY_ACCOUNT));\n+                if (account != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0569b0de6543bfaf78d689c8b4296ca24fc2bdd3"}, "originalPosition": 128}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4784, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}