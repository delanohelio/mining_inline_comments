{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyODE5MTI1", "number": 5436, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowMToyM1rODebWoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowODo0MVrODebeJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMjMyMDMyOnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowMToyM1rOFnjjcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzo0OToxN1rOFnvmHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMTI5OA==", "bodyText": "That is not a valid accountName, it should be test@nextloud.localhost.localdomain.", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377021298", "createdAt": "2020-02-10T12:01:23Z", "author": {"login": "tobiasKaminsky"}, "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account\n+\n+import android.accounts.Account\n+import android.net.Uri\n+import android.os.Parcel\n+import com.owncloud.android.lib.common.OwnCloudAccount\n+import com.owncloud.android.lib.common.OwnCloudBasicCredentials\n+import com.owncloud.android.lib.resources.status.OwnCloudVersion\n+import org.junit.Assert.assertEquals\n+import org.junit.Assert.assertFalse\n+import org.junit.Assert.assertNotSame\n+import org.junit.Assert.assertTrue\n+import org.junit.Before\n+import org.junit.Test\n+import java.net.URI\n+\n+class RegisteredUserTest {\n+\n+    private companion object {\n+        fun buildTestUser(accountName: String): RegisteredUser {\n+            val uri = Uri.parse(\"https://nextcloud.localhost.localdomain\")\n+            val credentials = OwnCloudBasicCredentials(\"user\", \"pass\")\n+            val account = Account(accountName, \"test-type\")\n+            val ownCloudAccount = OwnCloudAccount(uri, credentials)\n+            val server = Server(\n+                uri = URI(uri.toString()),\n+                version = OwnCloudVersion.nextcloud_17\n+            )\n+            return RegisteredUser(\n+                account = account,\n+                ownCloudAccount = ownCloudAccount,\n+                server = server\n+            )\n+        }\n+    }\n+\n+    private lateinit var user: RegisteredUser\n+\n+    @Before\n+    fun setUp() {\n+        user = buildTestUser(\"test.nextcloud.localhost.localdomain\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODU5MA==", "bodyText": "account name is fixed", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218590", "createdAt": "2020-02-10T17:49:17Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account\n+\n+import android.accounts.Account\n+import android.net.Uri\n+import android.os.Parcel\n+import com.owncloud.android.lib.common.OwnCloudAccount\n+import com.owncloud.android.lib.common.OwnCloudBasicCredentials\n+import com.owncloud.android.lib.resources.status.OwnCloudVersion\n+import org.junit.Assert.assertEquals\n+import org.junit.Assert.assertFalse\n+import org.junit.Assert.assertNotSame\n+import org.junit.Assert.assertTrue\n+import org.junit.Before\n+import org.junit.Test\n+import java.net.URI\n+\n+class RegisteredUserTest {\n+\n+    private companion object {\n+        fun buildTestUser(accountName: String): RegisteredUser {\n+            val uri = Uri.parse(\"https://nextcloud.localhost.localdomain\")\n+            val credentials = OwnCloudBasicCredentials(\"user\", \"pass\")\n+            val account = Account(accountName, \"test-type\")\n+            val ownCloudAccount = OwnCloudAccount(uri, credentials)\n+            val server = Server(\n+                uri = URI(uri.toString()),\n+                version = OwnCloudVersion.nextcloud_17\n+            )\n+            return RegisteredUser(\n+                account = account,\n+                ownCloudAccount = ownCloudAccount,\n+                server = server\n+            )\n+        }\n+    }\n+\n+    private lateinit var user: RegisteredUser\n+\n+    @Before\n+    fun setUp() {\n+        user = buildTestUser(\"test.nextcloud.localhost.localdomain\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMTI5OA=="}, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMjMyNTU2OnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/nextcloud/client/account/AnonymousUserTest.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowMzoxNVrOFnjmfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzo0OToyOFrOFnvmcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjA3OQ==", "bodyText": "License", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377022079", "createdAt": "2020-02-10T12:03:15Z", "author": {"login": "tobiasKaminsky"}, "path": "src/androidTest/java/com/nextcloud/client/account/AnonymousUserTest.kt", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.nextcloud.client.account", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODY3NA==", "bodyText": "added licence", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218674", "createdAt": "2020-02-10T17:49:28Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/nextcloud/client/account/AnonymousUserTest.kt", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.nextcloud.client.account", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjA3OQ=="}, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMjMyNTgzOnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowMzoyMlrOFnjmtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzo0OTozNVrOFnvmuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjEzMg==", "bodyText": "License", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377022132", "createdAt": "2020-02-10T12:03:22Z", "author": {"login": "tobiasKaminsky"}, "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODc0NQ==", "bodyText": "added licence", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377218745", "createdAt": "2020-02-10T17:49:35Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/nextcloud/client/account/RegisteredUserTest.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+package com.nextcloud.client.account", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyMjEzMg=="}, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMjMzOTU2OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/nextcloud/client/etm/TestEtmViewModel.kt", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxMjowODo0MVrOFnju-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODoyNTo1NFrOFoAUSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA==", "bodyText": "Can we there then have also a screenshot test?\nIf you do not have time for this, just ping me, and I'll do it.", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377024248", "createdAt": "2020-02-10T12:08:41Z", "author": {"login": "tobiasKaminsky"}, "path": "src/test/java/com/nextcloud/client/etm/TestEtmViewModel.kt", "diffHunk": "@@ -54,13 +55,15 @@ class TestEtmViewModel {\n         @get:Rule\n         val rule = InstantTaskExecutorRule()\n \n+        protected lateinit var platformAccountManager: AccountManager\n         protected lateinit var sharedPreferences: SharedPreferences\n         protected lateinit var vm: EtmViewModel\n \n         @Before\n         fun setUpBase() {\n             sharedPreferences = mock()\n-            vm = EtmViewModel(sharedPreferences)\n+            platformAccountManager = mock()\n+            vm = EtmViewModel(sharedPreferences, platformAccountManager)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMDM5MQ==", "bodyText": "@tobiasKaminsky View model does not contain any UI code - which makes unit testing very easy.\nIf we'd like to have a UI test for this part of the app, we'd need to test EtmAccountsFragment (and hosting activity).", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377220391", "createdAt": "2020-02-10T17:52:43Z", "author": {"login": "ezaquarii"}, "path": "src/test/java/com/nextcloud/client/etm/TestEtmViewModel.kt", "diffHunk": "@@ -54,13 +55,15 @@ class TestEtmViewModel {\n         @get:Rule\n         val rule = InstantTaskExecutorRule()\n \n+        protected lateinit var platformAccountManager: AccountManager\n         protected lateinit var sharedPreferences: SharedPreferences\n         protected lateinit var vm: EtmViewModel\n \n         @Before\n         fun setUpBase() {\n             sharedPreferences = mock()\n-            vm = EtmViewModel(sharedPreferences)\n+            platformAccountManager = mock()\n+            vm = EtmViewModel(sharedPreferences, platformAccountManager)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA=="}, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQ5MjU1Mg==", "bodyText": "Ah, I misread.", "url": "https://github.com/nextcloud/android/pull/5436#discussion_r377492552", "createdAt": "2020-02-11T08:25:54Z", "author": {"login": "tobiasKaminsky"}, "path": "src/test/java/com/nextcloud/client/etm/TestEtmViewModel.kt", "diffHunk": "@@ -54,13 +55,15 @@ class TestEtmViewModel {\n         @get:Rule\n         val rule = InstantTaskExecutorRule()\n \n+        protected lateinit var platformAccountManager: AccountManager\n         protected lateinit var sharedPreferences: SharedPreferences\n         protected lateinit var vm: EtmViewModel\n \n         @Before\n         fun setUpBase() {\n             sharedPreferences = mock()\n-            vm = EtmViewModel(sharedPreferences)\n+            platformAccountManager = mock()\n+            vm = EtmViewModel(sharedPreferences, platformAccountManager)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzAyNDI0OA=="}, "originalCommit": {"oid": "ef35c38d09cdec29481034704b555a7a6be12e83"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3164, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}