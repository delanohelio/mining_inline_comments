{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0ODI3NDQ3", "number": 5465, "title": "Fixed crash during folder creation (autosync)", "bodyText": "Hi,\nI fixed bug relative to folder picker, because mFile was always returning null.\nFixes #4792", "createdAt": "2020-02-13T11:55:49Z", "url": "https://github.com/nextcloud/android/pull/5465", "merged": true, "mergeCommit": {"oid": "c243453168f9187954ae82963916e1b9d69325f7"}, "closed": true, "closedAt": "2020-02-18T06:28:13Z", "author": {"login": "Kilian-Perisset"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcD67U8gFqTM1ODIxMjcwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFN4iAgFqTM1OTc1ODA1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MjEyNzA1", "url": "https://github.com/nextcloud/android/pull/5465#pullrequestreview-358212705", "createdAt": "2020-02-13T13:27:09Z", "commit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyNzowOVrOFpToyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyNzowOVrOFpToyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1NzY3Mg==", "bodyText": "@Shagequi can you add the license header please :)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378857672", "createdAt": "2020-02-13T13:27:09Z", "author": {"login": "AndyScherzinger"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MjEzMzY5", "url": "https://github.com/nextcloud/android/pull/5465#pullrequestreview-358213369", "createdAt": "2020-02-13T13:28:11Z", "commit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyODoxMVrOFpTqzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyODoxMVrOFpTqzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1ODE5MQ==", "bodyText": "no need to split this into two statements, could be reverted (or did I miss a detail here?)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378858191", "createdAt": "2020-02-13T13:28:11Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -302,7 +299,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         boolean retval = true;\n         switch (item.getItemId()) {\n             case R.id.action_create_dir: {\n-                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(getCurrentFolder());\n+                OCFile currentFolder = getCurrentFolder();\n+                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(currentFolder);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MjU2MzU5", "url": "https://github.com/nextcloud/android/pull/5465#pullrequestreview-358256359", "createdAt": "2020-02-13T14:25:26Z", "commit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNDoyNToyN1rOFpVt0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNDoyNToyN1rOFpVt0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA==", "bodyText": "I would use new File(currentFile.getRemotePath()).getParent() for this.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378891728", "createdAt": "2020-02-13T14:25:27Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NzI4MjUw", "url": "https://github.com/nextcloud/android/pull/5465#pullrequestreview-358728250", "createdAt": "2020-02-14T06:06:34Z", "commit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowNjozNVrOFpsbNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowOTo0NVrOFpsd2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2Mzc5OA==", "bodyText": "I appreciate that we try to document he test. If we're writing a geherkin-style test scenarios, can we please use recognized way for this?\nhttps://support.smartbear.com/cucumberstudio/docs/bdd/write-gherkin-scenarios.html", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379263798", "createdAt": "2020-02-14T06:06:35Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;\n+\n+import com.owncloud.android.datamodel.OCFile;\n+\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+import androidx.test.filters.LargeTest;\n+import androidx.test.rule.ActivityTestRule;\n+\n+@RunWith(AndroidJUnit4.class)\n+@LargeTest\n+public class FolderPickerActivityTest {\n+    @Rule\n+    public ActivityTestRule<FolderPickerActivity> activityRule =\n+        new ActivityTestRule<>(FolderPickerActivity.class);\n+\n+    @Test\n+    public void getFile_NoDifferenceTest() {\n+        // Arrange", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2Mzk3Nw==", "bodyText": "test suffix is not needed;\nit was needed in Junit3, bacause it was looking for a particularly named methods, but since JUnit4 uses annotations, we don't need it.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379263977", "createdAt": "2020-02-14T06:07:24Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;\n+\n+import com.owncloud.android.datamodel.OCFile;\n+\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+import androidx.test.filters.LargeTest;\n+import androidx.test.rule.ActivityTestRule;\n+\n+@RunWith(AndroidJUnit4.class)\n+@LargeTest\n+public class FolderPickerActivityTest {\n+    @Rule\n+    public ActivityTestRule<FolderPickerActivity> activityRule =\n+        new ActivityTestRule<>(FolderPickerActivity.class);\n+\n+    @Test\n+    public void getFile_NoDifferenceTest() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2NDQ3Mg==", "bodyText": "Can we break those multiple statements? Readers generally expect 1 statement per line of code. Here we have 4.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379264472", "createdAt": "2020-02-14T06:09:45Z", "author": {"login": "ezaquarii"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile\n+                        .getRemotePath()\n+                        .substring(0, currentFile.getRemotePath()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "511a16612d11b94152a2fd2be549be33c0864f42", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/511a16612d11b94152a2fd2be549be33c0864f42", "committedDate": "2020-02-17T13:45:07Z", "message": "Fixed bug relative to null folder in FolderPicker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "389090d3e89d2a080abc813d3d52f22254c9bf5c", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/389090d3e89d2a080abc813d3d52f22254c9bf5c", "committedDate": "2020-02-17T13:45:07Z", "message": "Implemented tests for FolderPickerActivity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c821f192d66628d33fe5f95fcba30c8f3f495b36", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/c821f192d66628d33fe5f95fcba30c8f3f495b36", "committedDate": "2020-02-17T13:45:07Z", "message": "Formated the code (removed useless spaces)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c59f9c0b913b5da2a5b5c1a9960c3542b63a13fa", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/c59f9c0b913b5da2a5b5c1a9960c3542b63a13fa", "committedDate": "2020-02-17T13:45:07Z", "message": "Formated the code + added header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "467104c4551caab9c768f9dcfcf47dc1dfa6671b", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/467104c4551caab9c768f9dcfcf47dc1dfa6671b", "committedDate": "2020-02-17T13:45:14Z", "message": "Replaced OCFile by File in getFolder() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a93313ca19ca97ef03bd3cee4a97314e95192e9a", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/a93313ca19ca97ef03bd3cee4a97314e95192e9a", "committedDate": "2020-02-17T14:05:14Z", "message": "added tests\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "49842a9b4460c6aa5d4858e72c58748b96814505", "author": {"user": {"login": "Kilian-Perisset", "name": "Kilian P\u00e9risset"}}, "url": "https://github.com/nextcloud/android/commit/49842a9b4460c6aa5d4858e72c58748b96814505", "committedDate": "2020-02-17T09:55:07Z", "message": "Removing findbug results"}, "afterCommit": {"oid": "a93313ca19ca97ef03bd3cee4a97314e95192e9a", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/a93313ca19ca97ef03bd3cee4a97314e95192e9a", "committedDate": "2020-02-17T14:05:14Z", "message": "added tests\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NzU4MDUz", "url": "https://github.com/nextcloud/android/pull/5465#pullrequestreview-359758053", "createdAt": "2020-02-17T14:06:13Z", "commit": {"oid": "a93313ca19ca97ef03bd3cee4a97314e95192e9a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4797, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}