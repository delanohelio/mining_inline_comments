{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4Mjc2NTMy", "number": 5927, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyNVrOEC1Dqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyN1rOEC1DsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDAxODk5OnYy", "diffSide": "RIGHT", "path": "scripts/updateScreenshots.sh", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyNVrOGfhjaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyNVrOGfhjaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwODc3Ng==", "bodyText": "Issue found: This word is outside of quotes. Did you intend to 'nest '\"'single quotes'\"' instead'?", "url": "https://github.com/nextcloud/android/pull/5927#discussion_r435708776", "createdAt": "2020-06-05T06:10:25Z", "author": {"login": "nextcloud-android-bot"}, "path": "scripts/updateScreenshots.sh", "diffHunk": "@@ -29,55 +29,84 @@ if [[ $IP = \"\" ]]; then\n fi\n \n ## wait for server to finish\n-scripts/wait_for_server.sh $IP\n-\n-## run on server\n-cp gradle.properties gradle.properties_\n-sed -i s\"/server/$IP/\" gradle.properties\n-scripts/wait_for_emulator.sh\n+scripts/wait_for_server.sh \"$IP\"\n \n # setup test server\n+docker exec uiComparison /bin/sh -c \"echo $IP server >> /etc/hosts\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user1 php /var/www/html/occ user:add --password-from-env --display-name='User One' user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user2 php /var/www/html/occ user:add --password-from-env --display-name='User Two' user2\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user3 php /var/www/html/occ user:add --password-from-env --display-name='User Three' user3\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ user:setting user2 files quota 1G\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:add users\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user2\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/activity.git /var/www/html/apps/activity/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable activity\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/text.git /var/www/html/apps/text/\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable text\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n-docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/end_to_end_encryption/  /var/www/html/apps/end_to_end_encryption/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable end_to_end_encryption\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n+#docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n docker exec uiComparison /bin/sh -c \"/usr/local/bin/run.sh\"\n \n+## wait for server to finish\n+scripts/wait_for_server.sh \"$IP\"\n+\n+scripts/wait_for_emulator.sh\n+\n+# change server to ip on emulator\n+adb root\n+sleep 2\n+adb remount\n+sleep 2\n+adb shell \"mount -o remount,rw /system\"\n+sleep 2\n+adb shell \"echo $IP server >> /system/etc/hosts\"\n+\n+sed -i s'#<bool name=\"is_beta\">false</bool>#<bool name=\"is_beta\">true</bool>#'g src/main/res/values/setup.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80d83e47214f99c4704345761db4e0d0e372f0d8"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDAxOTA1OnYy", "diffSide": "RIGHT", "path": "scripts/updateScreenshots.sh", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyN1rOGfhjbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNjoxMDoyN1rOGfhjbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTcwODc4Mg==", "bodyText": "Issue found: This word is outside of quotes. Did you intend to 'nest '\"'single quotes'\"' instead'?", "url": "https://github.com/nextcloud/android/pull/5927#discussion_r435708782", "createdAt": "2020-06-05T06:10:27Z", "author": {"login": "nextcloud-android-bot"}, "path": "scripts/updateScreenshots.sh", "diffHunk": "@@ -29,55 +29,84 @@ if [[ $IP = \"\" ]]; then\n fi\n \n ## wait for server to finish\n-scripts/wait_for_server.sh $IP\n-\n-## run on server\n-cp gradle.properties gradle.properties_\n-sed -i s\"/server/$IP/\" gradle.properties\n-scripts/wait_for_emulator.sh\n+scripts/wait_for_server.sh \"$IP\"\n \n # setup test server\n+docker exec uiComparison /bin/sh -c \"echo $IP server >> /etc/hosts\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user1 php /var/www/html/occ user:add --password-from-env --display-name='User One' user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user2 php /var/www/html/occ user:add --password-from-env --display-name='User Two' user2\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"OC_PASS=user3 php /var/www/html/occ user:add --password-from-env --display-name='User Three' user3\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ user:setting user2 files quota 1G\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:add users\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user1\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ group:adduser users user2\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/activity.git /var/www/html/apps/activity/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable activity\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/text.git /var/www/html/apps/text/\\\"\"\n docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable text\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n-docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n-docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/end_to_end_encryption/  /var/www/html/apps/end_to_end_encryption/\\\"\"\n+docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable end_to_end_encryption\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"git clone -b master https://github.com/nextcloud/circles.git /var/www/html/apps/circles/\\\"\"\n+#docker exec uiComparison /bin/sh -c \"apt-get update; apt-get -y install composer\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"cd /var/www/html/apps/circles; composer install\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ app:enable -f circles\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 allow_non_ssl_links\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:app:set circles --value 1 local_is_non_ssl\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ config:system:set allow_local_remote_servers --value true --type bool\\\"\"\n+#docker exec uiComparison /bin/sh -c \"su www-data -c \\\"php /var/www/html/occ circles:manage:create test public publicCircle\\\"\"\n docker exec uiComparison /bin/sh -c \"/usr/local/bin/run.sh\"\n \n+## wait for server to finish\n+scripts/wait_for_server.sh \"$IP\"\n+\n+scripts/wait_for_emulator.sh\n+\n+# change server to ip on emulator\n+adb root\n+sleep 2\n+adb remount\n+sleep 2\n+adb shell \"mount -o remount,rw /system\"\n+sleep 2\n+adb shell \"echo $IP server >> /system/etc/hosts\"\n+\n+sed -i s'#<bool name=\"is_beta\">false</bool>#<bool name=\"is_beta\">true</bool>#'g src/main/res/values/setup.xml\n+\n ## update/create all screenshots\n-./gradlew executeScreenshotTests -Precord\n+#./gradlew gplayDebugExecuteScreenshotTests -Precord \\\n+#-Pandroid.testInstrumentationRunnerArguments.annotation=com.owncloud.android.utils.ScreenshotTest\n \n ## update screenshots in a class\n-#./gradlew executeScreenshotTests \\\n+#./gradlew gplayDebugExecuteScreenshotTests \\\n #-Precord \\\n #-Pandroid.testInstrumentationRunnerArguments.class=\\\n #com.owncloud.android.ui.dialog.SyncFileNotEnoughSpaceDialogFragmentTest\n \n ## update single screenshot within a class\n-#./gradlew executeScreenshotTests \\\n+#./gradlew gplayDebugExecuteScreenshotTests \\\n #-Precord \\\n #-Pandroid.testInstrumentationRunnerArguments.class=\\\n-#com.owncloud.android.ui.dialog.SyncFileNotEnoughSpaceDialogFragmentTest#showNotEnoughSpaceDialogForFile\n+#com.nextcloud.client.FileDisplayActivityIT#showShares\n+\n+resultCode=-1\n+retryCount=0\n+until [ $resultCode -eq 0 ] || [ $retryCount -gt 2 ]\n+do\n+  # test all screenshots\n+  ./gradlew gplayDebugExecuteScreenshotTests \\\n+  -Pandroid.testInstrumentationRunnerArguments.annotation=com.owncloud.android.utils.ScreenshotTest\n+\n+resultCode=$?\n+((retryCount++))\n+done\n \n-mv gradle.properties_ gradle.properties\n+sed -i s'#<bool name=\"is_beta\">true</bool>#<bool name=\"is_beta\">false</bool>#'g src/main/res/values/setup.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80d83e47214f99c4704345761db4e0d0e372f0d8"}, "originalPosition": 123}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3103, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}