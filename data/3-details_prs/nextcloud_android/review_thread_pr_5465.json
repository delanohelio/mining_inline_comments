{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0ODI3NDQ3", "number": 5465, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyNzowOVrODfizKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowOTo0NVrODfyZ-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NDAyNjAyOnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyNzowOVrOFpToyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNDoyNzo0M1rOFpVzZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1NzY3Mg==", "bodyText": "@Shagequi can you add the license header please :)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378857672", "createdAt": "2020-02-13T13:27:09Z", "author": {"login": "AndyScherzinger"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MzE1OQ==", "bodyText": "Sure, will be done", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378893159", "createdAt": "2020-02-13T14:27:43Z", "author": {"login": "Kilian-Perisset"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1NzY3Mg=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NDAyOTM2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxMzoyODoxMVrOFpTqzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjo1MjozMlrOFpblKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1ODE5MQ==", "bodyText": "no need to split this into two statements, could be reverted (or did I miss a detail here?)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378858191", "createdAt": "2020-02-13T13:28:11Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -302,7 +299,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         boolean retval = true;\n         switch (item.getItemId()) {\n             case R.id.action_create_dir: {\n-                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(getCurrentFolder());\n+                OCFile currentFolder = getCurrentFolder();\n+                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(currentFolder);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MDU2MQ==", "bodyText": "I guess this was just for debugging, but true, this can be reverted.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378890561", "createdAt": "2020-02-13T14:23:33Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -302,7 +299,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         boolean retval = true;\n         switch (item.getItemId()) {\n             case R.id.action_create_dir: {\n-                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(getCurrentFolder());\n+                OCFile currentFolder = getCurrentFolder();\n+                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(currentFolder);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1ODE5MQ=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MjczMQ==", "bodyText": "Yup it was for debugging.\nI'm glad it's this name, I sometimes have an excess of imagination in my development (for naming variables or logs \ud83d\ude05)...\nI'll fix it ASAP, am working on another project", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378892731", "createdAt": "2020-02-13T14:27:01Z", "author": {"login": "Kilian-Perisset"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -302,7 +299,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         boolean retval = true;\n         switch (item.getItemId()) {\n             case R.id.action_create_dir: {\n-                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(getCurrentFolder());\n+                OCFile currentFolder = getCurrentFolder();\n+                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(currentFolder);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1ODE5MQ=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4NzgxNg==", "bodyText": "Wo worries, no hurries :)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378987816", "createdAt": "2020-02-13T16:52:32Z", "author": {"login": "AndyScherzinger"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -302,7 +299,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         boolean retval = true;\n         switch (item.getItemId()) {\n             case R.id.action_create_dir: {\n-                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(getCurrentFolder());\n+                OCFile currentFolder = getCurrentFolder();\n+                CreateFolderDialogFragment dialog = CreateFolderDialogFragment.newInstance(currentFolder);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg1ODE5MQ=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NDI0NjUxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNDoyNToyN1rOFpVt0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwODo0OToyM1rOFqcTBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA==", "bodyText": "I would use new File(currentFile.getRemotePath()).getParent() for this.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378891728", "createdAt": "2020-02-13T14:25:27Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MzAzNA==", "bodyText": "Yeah, I forgot this point too,\nwill be fixed asap too", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378893034", "createdAt": "2020-02-13T14:27:29Z", "author": {"login": "Kilian-Perisset"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkwNjUwNA==", "bodyText": "\"asap\" -> do not hurry too much :-)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r378906504", "createdAt": "2020-02-13T14:48:26Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM2NDE1MQ==", "bodyText": "This method doesn't work, we need to use the FileStorageManager in all cases, I stay with this solution for now", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379364151", "createdAt": "2020-02-14T10:44:03Z", "author": {"login": "Kilian-Perisset"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NjIyMA==", "bodyText": "String parentPath = new File(currentFile.getRemotePath()).getParent();\n\n                String parentPath1 = currentFile\n                        .getRemotePath()\n                        .substring(0, currentFile.getRemotePath()\n                        .lastIndexOf(currentFile.getFileName()));\n\nShould be exactly the same, and is not error prone :-)", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379396220", "createdAt": "2020-02-14T12:04:09Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NjYwMw==", "bodyText": "But, why create a File object, if we're expecting an OCFile object ?", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379396603", "createdAt": "2020-02-14T12:05:09Z", "author": {"login": "Kilian-Perisset"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA0ODEzMg==", "bodyText": "This is just for handling the path part.\nI think, using File, is more error prone than trying to to it by our selves.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r380048132", "createdAt": "2020-02-17T08:49:23Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg5MTcyOA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjU3ODk2OnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowNjozNVrOFpsbNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDowNDo1OFrOFqlkcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2Mzc5OA==", "bodyText": "I appreciate that we try to document he test. If we're writing a geherkin-style test scenarios, can we please use recognized way for this?\nhttps://support.smartbear.com/cucumberstudio/docs/bdd/write-gherkin-scenarios.html", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379263798", "createdAt": "2020-02-14T06:06:35Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;\n+\n+import com.owncloud.android.datamodel.OCFile;\n+\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+import androidx.test.filters.LargeTest;\n+import androidx.test.rule.ActivityTestRule;\n+\n+@RunWith(AndroidJUnit4.class)\n+@LargeTest\n+public class FolderPickerActivityTest {\n+    @Rule\n+    public ActivityTestRule<FolderPickerActivity> activityRule =\n+        new ActivityTestRule<>(FolderPickerActivity.class);\n+\n+    @Test\n+    public void getFile_NoDifferenceTest() {\n+        // Arrange", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIwMDA0OQ==", "bodyText": "To be honest, I also do not follow this, and we did not agreed on a common pattern.\nAs I also now those three steps, we can keep it this way and discuss in separate issue, which way(s) we do want to follow", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r380200049", "createdAt": "2020-02-17T14:04:58Z", "author": {"login": "tobiasKaminsky"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;\n+\n+import com.owncloud.android.datamodel.OCFile;\n+\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+import androidx.test.filters.LargeTest;\n+import androidx.test.rule.ActivityTestRule;\n+\n+@RunWith(AndroidJUnit4.class)\n+@LargeTest\n+public class FolderPickerActivityTest {\n+    @Rule\n+    public ActivityTestRule<FolderPickerActivity> activityRule =\n+        new ActivityTestRule<>(FolderPickerActivity.class);\n+\n+    @Test\n+    public void getFile_NoDifferenceTest() {\n+        // Arrange", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2Mzc5OA=="}, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjU4MDA1OnYy", "diffSide": "RIGHT", "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowNzoyNFrOFpsb6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowNzoyNFrOFpsb6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2Mzk3Nw==", "bodyText": "test suffix is not needed;\nit was needed in Junit3, bacause it was looking for a particularly named methods, but since JUnit4 uses annotations, we don't need it.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379263977", "createdAt": "2020-02-14T06:07:24Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/owncloud/android/ui/activity/FolderPickerActivityTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.owncloud.android.ui.activity;\n+\n+import com.owncloud.android.datamodel.OCFile;\n+\n+import org.junit.Assert;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+import androidx.test.filters.LargeTest;\n+import androidx.test.rule.ActivityTestRule;\n+\n+@RunWith(AndroidJUnit4.class)\n+@LargeTest\n+public class FolderPickerActivityTest {\n+    @Rule\n+    public ActivityTestRule<FolderPickerActivity> activityRule =\n+        new ActivityTestRule<>(FolderPickerActivity.class);\n+\n+    @Test\n+    public void getFile_NoDifferenceTest() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NjU4Mjk5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowOTo0NVrOFpsd2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwNjowOTo0NVrOFpsd2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI2NDQ3Mg==", "bodyText": "Can we break those multiple statements? Readers generally expect 1 statement per line of code. Here we have 4.", "url": "https://github.com/nextcloud/android/pull/5465#discussion_r379264472", "createdAt": "2020-02-14T06:09:45Z", "author": {"login": "ezaquarii"}, "path": "src/main/java/com/owncloud/android/ui/activity/FolderPickerActivity.java", "diffHunk": "@@ -333,16 +331,24 @@ public boolean onOptionsItemSelected(MenuItem item) {\n     }\n \n     protected OCFile getCurrentFolder() {\n-        OCFile file = getFile();\n-        if (file != null) {\n-            if (file.isFolder()) {\n-                return file;\n-            } else if (getStorageManager() != null) {\n-                String parentPath = file.getRemotePath().substring(0, file.getRemotePath().lastIndexOf(file.getFileName()));\n-                return getStorageManager().getFileByPath(parentPath);\n+        OCFile currentFile = getFile();\n+        OCFile finalFolder = null;\n+\n+        // If the file is null, take the root folder to avoid any error in functions depending on this one\n+        if (currentFile != null) {\n+            if (currentFile.isFolder()) {\n+                finalFolder = currentFile;\n+            } else if(currentFile.getRemotePath() != null) {\n+                String parentPath = currentFile\n+                        .getRemotePath()\n+                        .substring(0, currentFile.getRemotePath()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d8b84525cb01b5b8a4e05ec7c7fa552f46b965c"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3176, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}