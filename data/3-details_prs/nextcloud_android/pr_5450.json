{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNTMyMDIw", "number": 5450, "title": "Screenshot tests for ETM", "bodyText": "Signed-off-by: tobiasKaminsky tobias@kaminsky.me\nTesting\nWriting tests is very important. Please try to write some tests for your PR.\nIf you need help, please do not hesitate to ask in this PR for help.\n\n unit tests\n instrumented tests\n UI tests", "createdAt": "2020-02-11T08:40:16Z", "url": "https://github.com/nextcloud/android/pull/5450", "merged": true, "mergeCommit": {"oid": "67880e275842edfb0bdac702ab644b3e58630bcc"}, "closed": true, "closedAt": "2020-02-12T20:35:08Z", "author": {"login": "tobiasKaminsky"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDPR3sgFqTM1NjU1MjE3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDqLpDgFqTM1NzY2NDg4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NTUyMTc2", "url": "https://github.com/nextcloud/android/pull/5450#pullrequestreview-356552176", "createdAt": "2020-02-11T10:35:56Z", "commit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxMDozNTo1N1rOFoEDAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxMDozNTo1N1rOFoEDAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzU1MzY2NQ==", "bodyText": "@ezaquarii I had to set this function to public in Kotlin.\nIn Java I thought it would have been enough to set it to protected.\nDo you have an idea?", "url": "https://github.com/nextcloud/android/pull/5450#discussion_r377553665", "createdAt": "2020-02-11T10:35:57Z", "author": {"login": "tobiasKaminsky"}, "path": "src/main/java/com/nextcloud/client/etm/EtmActivity.kt", "diffHunk": "@@ -74,7 +74,7 @@ class EtmActivity : ToolbarActivity(), Injectable {\n         }\n     }\n \n-    private fun onPageChanged(page: EtmMenuEntry?) {\n+    fun onPageChanged(page: EtmMenuEntry?) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjMwNDA2", "url": "https://github.com/nextcloud/android/pull/5450#pullrequestreview-357230406", "createdAt": "2020-02-12T07:18:26Z", "commit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzoxODoyNlrOFoj1Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzoxODoyNlrOFoj1Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA3NDQ0Nw==", "bodyText": "Try converting it to something like\nUIThreadStatement.runOnUiThread(Runnable {\n    sut.vm.onPageSelected(0)`\n})\n\nvm is internal so it's accessible.", "url": "https://github.com/nextcloud/android/pull/5450#discussion_r378074447", "createdAt": "2020-02-12T07:18:26Z", "author": {"login": "ezaquarii"}, "path": "src/androidTest/java/com/nextcloud/client/etm/EtmActivityTest.kt", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ *\n+ * Nextcloud Android client application\n+ *\n+ * @author Tobias Kaminsky\n+ * Copyright (C) 2020 Tobias Kaminsky\n+ * Copyright (C) 2020 Nextcloud GmbH\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program. If not, see <https://www.gnu.org/licenses/>.\n+ */\n+\n+package com.nextcloud.client.etm\n+\n+import android.app.Activity\n+import androidx.test.espresso.intent.rule.IntentsTestRule\n+import androidx.test.internal.runner.junit4.statement.UiThreadStatement\n+import com.facebook.testing.screenshot.Screenshot\n+import com.owncloud.android.AbstractIT\n+import org.junit.Rule\n+import org.junit.Test\n+\n+class EtmActivityTest : AbstractIT() {\n+    @get:Rule\n+    var activityRule = IntentsTestRule(EtmActivity::class.java, true, false)\n+\n+    @Test\n+    fun overview() {\n+        val sut: Activity = activityRule.launchActivity(null)\n+\n+        waitForIdleSync()\n+\n+        Screenshot.snapActivity(sut).record()\n+    }\n+\n+    @Test\n+    fun preferences() {\n+        val sut: EtmActivity = activityRule.launchActivity(null)\n+\n+        UiThreadStatement.runOnUiThread(Runnable { sut.onPageChanged(sut.vm.pages[0]) })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjMwNzAx", "url": "https://github.com/nextcloud/android/pull/5450#pullrequestreview-357230701", "createdAt": "2020-02-12T07:19:11Z", "commit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d841f642541bedb19ea91972b494d283ae254406", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/d841f642541bedb19ea91972b494d283ae254406", "committedDate": "2020-02-12T10:47:55Z", "message": "Screenshot tests for ETM\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "014bdf67c95eb22bef4b8038ce2710dcff15570e", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/014bdf67c95eb22bef4b8038ce2710dcff15570e", "committedDate": "2020-02-11T08:39:49Z", "message": "Screenshot tests for ETM\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}, "afterCommit": {"oid": "d841f642541bedb19ea91972b494d283ae254406", "author": {"user": {"login": "tobiasKaminsky", "name": "Tobias Kaminsky"}}, "url": "https://github.com/nextcloud/android/commit/d841f642541bedb19ea91972b494d283ae254406", "committedDate": "2020-02-12T10:47:55Z", "message": "Screenshot tests for ETM\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NjY0ODg0", "url": "https://github.com/nextcloud/android/pull/5450#pullrequestreview-357664884", "createdAt": "2020-02-12T17:56:35Z", "commit": {"oid": "d841f642541bedb19ea91972b494d283ae254406"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4795, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}