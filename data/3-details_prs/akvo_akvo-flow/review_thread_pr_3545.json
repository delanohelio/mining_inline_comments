{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NDczODE4", "number": 3545, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MTo0NlrOD2qTVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MjoyN1rOD2qUfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjQyNzc1OnYy", "diffSide": "RIGHT", "path": "Dashboard/app/js/lib/analytics.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MTo0NlrOGMhFnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MTo0NlrOGMhFnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3ODIwNw==", "bodyText": "Let's always use https, so const u = 'https://akvo.piwikpro.com'.\nProtocol relative URL are an anti-pattern now - https://www.paulirish.com/2010/the-protocol-relative-url/", "url": "https://github.com/akvo/akvo-flow/pull/3545#discussion_r415778207", "createdAt": "2020-04-27T12:41:46Z", "author": {"login": "iperdomo"}, "path": "Dashboard/app/js/lib/analytics.js", "diffHunk": "@@ -1,20 +1,41 @@\n-const _paq = window._paq || [];\n-_paq.push(['setDocumentTitle', `${document.domain}/${document.title}`]);\n-_paq.push(['setCookieDomain', '*.akvoflow.org']);\n-_paq.push(['setDomains', ['*.akvoflow.org']]);\n-_paq.push(['trackPageView']);\n-_paq.push(['enableLinkTracking']);\n+export function init() {\n+  window._paq = window._paq || [];\n \n-(function () {\n-  const u = `${(document.location.protocol == 'https:') ? 'https' : 'http'}://analytics.akvo.org/`;\n-  _paq.push(['setTrackerUrl', `${u}piwik.php`]);\n-  _paq.push(['setSiteId', '10']);\n-  const d = document;\n-  const g = d.createElement('script');\n-  const s = d.getElementsByTagName('script')[0];\n-  g.type = 'text/javascript';\n-  g.defer = true;\n-  g.async = true;\n-  g.src = `${u}piwik.js`;\n-  s.parentNode.insertBefore(g, s);\n-}());\n+  window._paq.push(['setDocumentTitle', `${document.domain}/${document.title}`]);\n+  window._paq.push(['setCookieDomain', '*.akvoflow.org']);\n+  window._paq.push(['setDomains', ['*.akvoflow.org']]);\n+  window._paq.push(['enableLinkTracking']);\n+\n+  (function() {\n+    const u =\n+      document.location.protocol === 'https:'\n+        ? 'https://akvo.piwikpro.com/'\n+        : 'http://analytics.akvo.org/';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6178f5b40aadec448da85e74e8f9ce9cdf5f0b7"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjQzMDY4OnYy", "diffSide": "RIGHT", "path": "Dashboard/app/js/lib/analytics.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MjoyN1rOGMhHXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MjoyN1rOGMhHXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3ODY1Mw==", "bodyText": "Let's use {} in our if statements.", "url": "https://github.com/akvo/akvo-flow/pull/3545#discussion_r415778653", "createdAt": "2020-04-27T12:42:27Z", "author": {"login": "iperdomo"}, "path": "Dashboard/app/js/lib/analytics.js", "diffHunk": "@@ -1,20 +1,41 @@\n-const _paq = window._paq || [];\n-_paq.push(['setDocumentTitle', `${document.domain}/${document.title}`]);\n-_paq.push(['setCookieDomain', '*.akvoflow.org']);\n-_paq.push(['setDomains', ['*.akvoflow.org']]);\n-_paq.push(['trackPageView']);\n-_paq.push(['enableLinkTracking']);\n+export function init() {\n+  window._paq = window._paq || [];\n \n-(function () {\n-  const u = `${(document.location.protocol == 'https:') ? 'https' : 'http'}://analytics.akvo.org/`;\n-  _paq.push(['setTrackerUrl', `${u}piwik.php`]);\n-  _paq.push(['setSiteId', '10']);\n-  const d = document;\n-  const g = d.createElement('script');\n-  const s = d.getElementsByTagName('script')[0];\n-  g.type = 'text/javascript';\n-  g.defer = true;\n-  g.async = true;\n-  g.src = `${u}piwik.js`;\n-  s.parentNode.insertBefore(g, s);\n-}());\n+  window._paq.push(['setDocumentTitle', `${document.domain}/${document.title}`]);\n+  window._paq.push(['setCookieDomain', '*.akvoflow.org']);\n+  window._paq.push(['setDomains', ['*.akvoflow.org']]);\n+  window._paq.push(['enableLinkTracking']);\n+\n+  (function() {\n+    const u =\n+      document.location.protocol === 'https:'\n+        ? 'https://akvo.piwikpro.com/'\n+        : 'http://analytics.akvo.org/';\n+\n+    window._paq.push(['setTrackerUrl', `${u}ppms.php`]);\n+    window._paq.push(['setSiteId', '2eb02fff-08a4-4973-ae92-fb4ae6157da4']);\n+\n+    const d = document;\n+    const g = d.createElement('script');\n+    const s = d.getElementsByTagName('script')[0];\n+    g.type = 'text/javascript';\n+    g.async = true;\n+    g.defer = true;\n+    g.src = `${u}ppms.js`;\n+    s.parentNode.insertBefore(g, s);\n+  })();\n+}\n+\n+export const trackEvent = (eventType, ...values) => {\n+  if (typeof window._paq !== 'undefined') window._paq.push(['trackEvent', eventType, ...values]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6178f5b40aadec448da85e74e8f9ce9cdf5f0b7"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4537, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}