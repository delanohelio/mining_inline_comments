{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyNjA2NDg3", "number": 3653, "title": "[#3652] attempt to fix NPE", "bodyText": "Before the PR (what is the issue or what needed to be done)\nNA\nThe solution\nFixed NPE when missing registration form submission for a given datapoint\nScreenshots (if appropriate)\nNA\nReviewer Checklist\n\n Added an explanation about the work done\n Connected the PR and the issue on Zenhub\n Added a test plan to the issue\n Updated the copyright header (when relevant)\n Formatted the code\n Added a documentation (if relevant)\n Added some unit tests (if relevant)", "createdAt": "2020-10-13T17:27:44Z", "url": "https://github.com/akvo/akvo-flow/pull/3653", "merged": true, "mergeCommit": {"oid": "22503700900479c69d6681be7e77c273bb644068"}, "closed": true, "closedAt": "2020-10-14T05:29:09Z", "author": {"login": "valllllll2000"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSL__DgH2gAyNTAyNjA2NDg3Ojc1NzE1NWE5MThhNDRkYjg1ZWM1ZjY0YTg0NGNjNjUyN2RlY2ZlYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSWJrIgH2gAyNTAyNjA2NDg3OjUyYTI3NGZmYTQ5ZjY1MzZlMTBlNzY3NzQ1MmM5MjgxY2JiOGZkYWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "757155a918a44db85ec5f64a844cc6527decfec5", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/757155a918a44db85ec5f64a844cc6527decfec5", "committedDate": "2020-10-13T17:26:43Z", "message": "[#3652] attempt to fix NPE\n\nCo-authored-by: Iv\u00e1n Perdomo <ivan@akvo.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NzE3NDA4", "url": "https://github.com/akvo/akvo-flow/pull/3653#pullrequestreview-507717408", "createdAt": "2020-10-13T18:25:22Z", "commit": {"oid": "757155a918a44db85ec5f64a844cc6527decfec5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxODoyNToyMlrOHg0Cjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxODoyODowN1rOHg0IZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTEwMg==", "bodyText": "There are lots of changes to import style and order that are not directly to the change business logic change we want.", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504169102", "createdAt": "2020-10-13T18:25:22Z", "author": {"login": "iperdomo"}, "path": "GAE/src/org/akvo/flow/api/app/DataPointUtil.java", "diffHunk": "@@ -35,10 +33,18 @@\n import org.waterforpeople.mapping.domain.SurveyInstance;\n import org.waterforpeople.mapping.serialization.response.MediaResponse;\n \n-import com.gallatinsystems.survey.dao.QuestionDao;\n-import com.gallatinsystems.survey.domain.Question;\n-import com.gallatinsystems.surveyal.domain.SurveyedLocale;\n import javax.annotation.Nullable;\n+import java.util.ArrayList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "757155a918a44db85ec5f64a844cc6527decfec5"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2OTQ0Mg==", "bodyText": "IDEM. Import re-ordering, not directly related to business logic changes.", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504169442", "createdAt": "2020-10-13T18:25:57Z", "author": {"login": "iperdomo"}, "path": "GAE/src/org/waterforpeople/mapping/dao/SurveyInstanceDAO.java", "diffHunk": "@@ -67,6 +44,26 @@\n import com.google.appengine.api.taskqueue.Queue;\n import com.google.appengine.api.taskqueue.QueueFactory;\n import com.google.appengine.api.taskqueue.TaskOptions;\n+import org.akvo.flow.domain.DataUtils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "757155a918a44db85ec5f64a844cc6527decfec5"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE3MDU5OA==", "bodyText": "We're changing the logic and introduce a corner case. We should add a test in SurveyInstanceDAOTest", "url": "https://github.com/akvo/akvo-flow/pull/3653#discussion_r504170598", "createdAt": "2020-10-13T18:28:07Z", "author": {"login": "iperdomo"}, "path": "GAE/src/org/waterforpeople/mapping/dao/SurveyInstanceDAO.java", "diffHunk": "@@ -774,13 +771,14 @@ public SurveyInstance getRegistrationSurveyInstance(SurveyedLocale locale,\n     public List<SurveyInstance> getMonitoringData(@Nonnull List<SurveyedLocale> surveyedLocales, int numberOfInstances) {\n         List<SurveyInstance> result = new ArrayList<>();\n \n-        surveyedLocales.forEach(surveyedLocale ->\n-                result.add(getRegistrationSurveyInstance(surveyedLocale, surveyedLocale.getCreationSurveyId())));\n-\n-        surveyedLocales.forEach(surveyedLocale ->\n+        for (SurveyedLocale s: surveyedLocales) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "757155a918a44db85ec5f64a844cc6527decfec5"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52a274ffa49f6536e10e7677452c9281cbb8fdac", "author": {"user": {"login": "iperdomo", "name": "Iv\u00e1n Perdomo"}}, "url": "https://github.com/akvo/akvo-flow/commit/52a274ffa49f6536e10e7677452c9281cbb8fdac", "committedDate": "2020-10-14T05:16:21Z", "message": "[#3652] Adds test for data points with no registration form instance"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4548, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}