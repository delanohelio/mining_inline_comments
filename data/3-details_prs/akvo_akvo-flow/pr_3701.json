{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNjc5Njc1", "number": 3701, "title": "[#3689] Fix different group dependencies are broken", "bodyText": "Before the PR (what is the issue or what needed to be done)\nThe solution\nWe were using a map to store copied groups so the group order was lost,\nusing a list now\nAdded a test\nCo-authored-by: Juan A. Ruz juanantonioruz@gmail.com\nScreenshots (if appropriate)\nReviewer Checklist\n\n Added an explanation about the work done\n Connected the PR and the issue on Zenhub\n Added a test plan to the issue\n Updated the copyright header (when relevant)\n Formatted the code\n Added a documentation (if relevant)\n Added some unit tests (if relevant)", "createdAt": "2020-12-03T10:39:29Z", "url": "https://github.com/akvo/akvo-flow/pull/3701", "merged": true, "mergeCommit": {"oid": "1ac2d8d2fb6dbe803c5f07d4d0f644f238262580"}, "closed": true, "closedAt": "2020-12-03T14:21:40Z", "author": {"login": "valllllll2000"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdigtvZgH2gAyNTMxNjc5Njc1OmM3NzNlOGZmZmEwZTFiNDRkZGQyZmU1N2U3MTUwZDc2NDg3ODM2MTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdihpHNAH2gAyNTMxNjc5Njc1Ojk3NDBlNzc1YzU1MmRiNWZlMzgyZDRjNzk5ZDZlMzhjODM5Nzg5N2E=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c773e8fffa0e1b44ddd2fe57e7150d7648783616", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/c773e8fffa0e1b44ddd2fe57e7150d7648783616", "committedDate": "2020-12-03T10:37:35Z", "message": "[#3689] Fix different group dependencies are broken\n\nWe were using a map to store copied groups so the group order was lost,\nusing a list now\nAdded a test\n\nCo-authored-by: Juan A. Ruz <juanantonioruz@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4987d94d2faefce7dfabdc86e7bb785b8a542ae", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/f4987d94d2faefce7dfabdc86e7bb785b8a542ae", "committedDate": "2020-12-03T10:53:52Z", "message": "[#3689] using another Pair object as the other one class is not found"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODY0MjQ5", "url": "https://github.com/akvo/akvo-flow/pull/3701#pullrequestreview-543864249", "createdAt": "2020-12-03T11:34:59Z", "commit": {"oid": "f4987d94d2faefce7dfabdc86e7bb785b8a542ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTozNDo1OVrOH-WVqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTozNDo1OVrOH-WVqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEzOTc1Mw==", "bodyText": "Why there is a need to use a Pair from gwt?", "url": "https://github.com/akvo/akvo-flow/pull/3701#discussion_r535139753", "createdAt": "2020-12-03T11:34:59Z", "author": {"login": "iperdomo"}, "path": "GAE/src/com/gallatinsystems/survey/dao/SurveyUtils.java", "diffHunk": "@@ -16,11 +16,13 @@\n \n package com.gallatinsystems.survey.dao;\n \n+import com.google.gwt.dev.util.Pair;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4987d94d2faefce7dfabdc86e7bb785b8a542ae"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODY1NDM5", "url": "https://github.com/akvo/akvo-flow/pull/3701#pullrequestreview-543865439", "createdAt": "2020-12-03T11:36:33Z", "commit": {"oid": "f4987d94d2faefce7dfabdc86e7bb785b8a542ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTozNjozM1rOH-Wbbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMTozNjozM1rOH-Wbbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE0MTIzMQ==", "bodyText": "this complex one can be done with new ArrayList(sourceToCopiedGroupMap.values()) ? not sure the value of stream to just get the values", "url": "https://github.com/akvo/akvo-flow/pull/3701#discussion_r535141231", "createdAt": "2020-12-03T11:36:33Z", "author": {"login": "iperdomo"}, "path": "GAE/src/com/gallatinsystems/survey/dao/SurveyUtils.java", "diffHunk": "@@ -111,14 +113,14 @@ public static void copySurvey(Long copiedSurveyId, Long originalSurveyId) {\n \n         log.log(Level.INFO, \"Copying \" + qgList.size() + \" `QuestionGroup`\");\n \n-        Map<Long, QuestionGroup> sourceToCopiedGroupMap = shallowCopyQuestionGroups(copiedSurveyId, qgList);\n+        List<Pair<Long, QuestionGroup>> sourceToCopiedGroupMap = shallowCopyQuestionGroups(copiedSurveyId, qgList);\n \n         // batch save question groups\n-        new QuestionGroupDao().save(sourceToCopiedGroupMap.values());\n+        new QuestionGroupDao().save(sourceToCopiedGroupMap.stream().map(pair -> pair.right).collect(Collectors.toList()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4987d94d2faefce7dfabdc86e7bb785b8a542ae"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9740e775c552db5fe382d4c799d6e38c8397897a", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/9740e775c552db5fe382d4c799d6e38c8397897a", "committedDate": "2020-12-03T11:42:26Z", "message": "[#3689] rename var which is no longer a map but a list of pairs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4574, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}