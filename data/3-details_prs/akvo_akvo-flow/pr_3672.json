{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMzI5ODQz", "number": 3672, "title": "Issue/3669 survey copy error fix", "bodyText": "Before the PR (what is the issue or what needed to be done)\nSurveyCopy is not efficient\nThe solution\nOptimize the way translations are copied to save time during the task\nScreenshots (if appropriate)\nNA\nReviewer Checklist\n\n Added an explanation about the work done\n Connected the PR and the issue on Zenhub\n Added a test plan to the issue\n Updated the copyright header (when relevant)\n Formatted the code\n Added a documentation (if relevant)\n Added some unit tests (if relevant)", "createdAt": "2020-11-18T17:00:12Z", "url": "https://github.com/akvo/akvo-flow/pull/3672", "merged": true, "mergeCommit": {"oid": "b1490866b97a696f0ade402f2f200eca2928c482"}, "closed": true, "closedAt": "2020-11-20T11:01:19Z", "author": {"login": "valllllll2000"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdduPFggH2gAyNTIzMzI5ODQzOjI1NTk4OTk1MzA0Yzg2YmZmNmVmMmYzNTI0NTczODlkNjYwNDJlM2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeVOAUAFqTUzNTMyNzM1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "25598995304c86bff6ef2f352457389d66042e3e", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/25598995304c86bff6ef2f352457389d66042e3e", "committedDate": "2020-11-18T13:33:09Z", "message": "[#3669] Optimise survey copy (WIP)\n\nadd tests to copy translations\noptimise translations copy\n\nCo-authored-by: Emmanuel Mulo <emmanuel@akvo.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c6a0c28e38aaeb4760363feeceb52587e2b4c20", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/5c6a0c28e38aaeb4760363feeceb52587e2b4c20", "committedDate": "2020-11-18T14:34:39Z", "message": "[#3669] reverted imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea94118b4ba646bebc45da27c46ac7bcae302319", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/ea94118b4ba646bebc45da27c46ac7bcae302319", "committedDate": "2020-11-18T16:58:33Z", "message": "[#3669] finish optimising how translations are copied for a survey"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "972fca41ff1cc5b9cf8a2b30f886f01abd3d446b", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/972fca41ff1cc5b9cf8a2b30f886f01abd3d446b", "committedDate": "2020-11-18T17:07:22Z", "message": "[#3663] reverted unnecessary import changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9dca88ccc2ae071dbc9af5906a766ac958322f0", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/b9dca88ccc2ae071dbc9af5906a766ac958322f0", "committedDate": "2020-11-18T17:24:45Z", "message": "[#3669] fixed NPE when missing translations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df847ae2e95eb2da5f52a35198bceeb5c3ab2ed0", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/df847ae2e95eb2da5f52a35198bceeb5c3ab2ed0", "committedDate": "2020-11-18T17:50:49Z", "message": "[#3669] fixed broken tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9b88fe625b306c1c78600f5dc1fc6305382f2f4", "author": {"user": {"login": "muloem", "name": "Emmanuel Mulo"}}, "url": "https://github.com/akvo/akvo-flow/commit/a9b88fe625b306c1c78600f5dc1fc6305382f2f4", "committedDate": "2020-11-18T21:07:31Z", "message": "[#3669] Correct expected vs actual parameters in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODQ4NDkx", "url": "https://github.com/akvo/akvo-flow/pull/3672#pullrequestreview-533848491", "createdAt": "2020-11-18T20:27:58Z", "commit": {"oid": "df847ae2e95eb2da5f52a35198bceeb5c3ab2ed0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoyNzo1OFrOH2A3pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoyNzo1OFrOH2A3pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5OTM5OQ==", "bodyText": "Its a little confusing for me the method copyQuestionGroupWithoutTranslations has the copiedTranslations parameter...", "url": "https://github.com/akvo/akvo-flow/pull/3672#discussion_r526399399", "createdAt": "2020-11-18T20:27:58Z", "author": {"login": "muloem"}, "path": "GAE/src/com/gallatinsystems/survey/dao/SurveyUtils.java", "diffHunk": "@@ -177,19 +179,61 @@ public static QuestionGroup copyQuestionGroup(QuestionGroup sourceGroup,\n         log.log(Level.INFO, \"Copying \" + qList.size() + \" `Question`\");\n \n         int qCount = 1;\n-        List<Question> qCopyList = new ArrayList<Question>();\n+        List<Question> qCopyList = new ArrayList<>();\n         for (Question question : qList) {\n-            final Question questionCopy = SurveyUtils.copyQuestion(question, copyGroupId, qCount++,\n-                    newSurveyId, idsInUse, immutable);\n+            final Question questionCopy = copyQuestionWithoutTranslations(idsInUse, immutable, copiedTranslations,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df847ae2e95eb2da5f52a35198bceeb5c3ab2ed0"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "438b5e71ba7a840ae29332a32b5774f080a85259", "author": {"user": {"login": "muloem", "name": "Emmanuel Mulo"}}, "url": "https://github.com/akvo/akvo-flow/commit/438b5e71ba7a840ae29332a32b5774f080a85259", "committedDate": "2020-11-19T14:19:10Z", "message": "[#3669] No need to save the translation copies when creating them\n\n* The translation entities are saved later on in a batch after then have been updated with the correct parentIds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45a202c23b0dce145cc0dd6fac66e16bba36c189", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/45a202c23b0dce145cc0dd6fac66e16bba36c189", "committedDate": "2020-11-19T16:55:00Z", "message": "[#3669] renamed methods + added documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "685dfb2583a39836a7c5ba4ed12e0077060c8f3c", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/685dfb2583a39836a7c5ba4ed12e0077060c8f3c", "committedDate": "2020-11-19T16:59:06Z", "message": "Merge branch 'issue/3669-survey-copy-error-fix' of github.com:akvo/akvo-flow into issue/3669-survey-copy-error-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d31c8058ab840bbda2bc2c9c3125787476a20bab", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/d31c8058ab840bbda2bc2c9c3125787476a20bab", "committedDate": "2020-11-19T17:13:39Z", "message": "[#3669] added more tests for the case where non immatable surveys are copied"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cedfffa740f9b915d32b454785d9db0dbce9552", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/9cedfffa740f9b915d32b454785d9db0dbce9552", "committedDate": "2020-11-19T17:52:48Z", "message": "[#3669] make sure translations are correctly copied with survey group"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e499ea8d3aefcb5253721b839658d62a4dd0c8e9", "author": {"user": {"login": "valllllll2000", "name": "Valeria Rogatchevskikh"}}, "url": "https://github.com/akvo/akvo-flow/commit/e499ea8d3aefcb5253721b839658d62a4dd0c8e9", "committedDate": "2020-11-19T17:55:09Z", "message": "[#3669] extracted tests methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d557ef5604900605ba4b5be1fa43ff4ecea92d8b", "author": {"user": {"login": "muloem", "name": "Emmanuel Mulo"}}, "url": "https://github.com/akvo/akvo-flow/commit/d557ef5604900605ba4b5be1fa43ff4ecea92d8b", "committedDate": "2020-11-20T10:53:24Z", "message": "[#3669] Merge branch 'issue/3669-survey-copy-error-fix' of https://github.com/akvo/akvo-flow into issue/3669-survey-copy-error-fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MzI3MzUy", "url": "https://github.com/akvo/akvo-flow/pull/3672#pullrequestreview-535327352", "createdAt": "2020-11-20T10:58:16Z", "commit": {"oid": "d557ef5604900605ba4b5be1fa43ff4ecea92d8b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4557, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}