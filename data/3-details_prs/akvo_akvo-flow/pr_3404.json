{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3OTc5MjA0", "number": 3404, "title": "[#3168] - clean up and handle edge cases with creating new assignment", "bodyText": "The solution\nFix bugs that occur while creating new assignments, and clean up (basically add more comments) in assignment-edit page\nReviewer Checklist\n\n Added an explanation about the work done\n Connected the PR and the issue on Zenhub\n Added a test plan to the issue\n Updated the copyright header (when relevant)\n Formatted the code\n Added a documentation (if relevant)\n Added some unit tests (if relevant)", "createdAt": "2020-01-28T12:11:39Z", "url": "https://github.com/akvo/akvo-flow/pull/3404", "merged": true, "mergeCommit": {"oid": "2304f9beb1604a5cdf25b4c823954dafd2718a90"}, "closed": true, "closedAt": "2020-02-07T15:18:37Z", "author": {"login": "marvinkome"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb81WLtgH2gAyMzY3OTc5MjA0OmM5NmM2YWE2NTdkNTBhOGZhMzVmMWNmZjdkYmE0YWJjMDFmMzc0NTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCAmi9AFqTM1NTIxMTgwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c96c6aa657d50a8fa35f1cff7dba4abc01f37458", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/c96c6aa657d50a8fa35f1cff7dba4abc01f37458", "committedDate": "2020-01-22T12:59:35Z", "message": "[#3168] - change selected survey group when form component is mounted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e4899ff1e4d57e893bd0f9b44e78eb9c4191a30", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/4e4899ff1e4d57e893bd0f9b44e78eb9c4191a30", "committedDate": "2020-01-22T13:14:31Z", "message": "[#3168] - fix bug with removing forms from assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "988b084b40b6f86bc753391c9926bbc256338d78", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/988b084b40b6f86bc753391c9926bbc256338d78", "committedDate": "2020-01-23T08:47:50Z", "message": "[#3168] - rearrange methods in assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa64f368a55f9e9d5012ee5eeca4be5b23f51c83", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/aa64f368a55f9e9d5012ee5eeca4be5b23f51c83", "committedDate": "2020-01-27T11:39:40Z", "message": "Merge branch 'issue-3168/add-survey-edge-cases-on-datapoints' into issue-3168/refactor-assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c22793971eab692125419b6dfdd9b3662fe977b2", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/c22793971eab692125419b6dfdd9b3662fe977b2", "committedDate": "2020-01-27T13:42:46Z", "message": "[#3169] - fix string ids in device selector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d1ad506fb868ca629a3bcdffb07b72c10c4b6b5", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/2d1ad506fb868ca629a3bcdffb07b72c10c4b6b5", "committedDate": "2020-01-27T13:57:40Z", "message": "[#3168] - update styling for sidebar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62cdba3ea0acec7b7d1407719a8b2bbe997d64c5", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/62cdba3ea0acec7b7d1407719a8b2bbe997d64c5", "committedDate": "2020-01-27T14:22:38Z", "message": "[#3168] - update propType from strings to number"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b021df9a8281ae7d63883b8f5a13aaca4a9b3d1b", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/b021df9a8281ae7d63883b8f5a13aaca4a9b3d1b", "committedDate": "2020-01-27T15:22:18Z", "message": "Merge branch 'issue-3168/edit-datapoints' into issue-3168/refactor-assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a73f5907ed592e9a6c9f3efb297970588789b9ff", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/a73f5907ed592e9a6c9f3efb297970588789b9ff", "committedDate": "2020-01-27T15:41:15Z", "message": "[#3168] - fix bug with saving assignments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63d1fd1edd9231f76e6e6a391a715b1cb9350873", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/63d1fd1edd9231f76e6e6a391a715b1cb9350873", "committedDate": "2020-01-28T12:06:49Z", "message": "[#3168] - fix all bugs and edge cases with creating assignments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0713bd97c2e16b78c63e393b0d7e1e1871f780b", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/a0713bd97c2e16b78c63e393b0d7e1e1871f780b", "committedDate": "2020-02-05T11:41:34Z", "message": "Merge branch 'develop' into issue-3168/refactor-assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "431adb4d7b1ea2cf9c12e8b538a1e172f23968bf", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/431adb4d7b1ea2cf9c12e8b538a1e172f23968bf", "committedDate": "2020-02-05T13:24:25Z", "message": "[#3168] - load all forms on initial render"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b26c2b5df5af2d9d65731fa82b9a2fd3d6389e4c", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/b26c2b5df5af2d9d65731fa82b9a2fd3d6389e4c", "committedDate": "2020-02-05T13:29:23Z", "message": "[#3168] - fix save datapoint method when navigating back on assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "committedDate": "2020-02-05T13:42:53Z", "message": "[#3168] - revert package-lock.json"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NDM4NDM2", "url": "https://github.com/akvo/akvo-flow/pull/3404#pullrequestreview-354438436", "createdAt": "2020-02-06T13:14:24Z", "commit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMzoxNDoyNFrOFmakwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMzozNjowM1rOFmbNKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNTYwMg==", "bodyText": "Do you still need this comment if you have changed the PropType definitions?", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375825602", "createdAt": "2020-02-06T13:14:24Z", "author": {"login": "muloem"}, "path": "Dashboard/app/js/lib/components/devices/AssignmentsEditView/screens/EditDevices.jsx", "diffHunk": "@@ -22,6 +22,9 @@ export default class EditDevices extends React.Component {\n   }\n \n   onSelectDevice = (id, checked) => {\n+    // convert id to number", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNTcwMg==", "bodyText": "Still needed?", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375825702", "createdAt": "2020-02-06T13:14:36Z", "author": {"login": "muloem"}, "path": "Dashboard/app/js/lib/components/devices/AssignmentsEditView/screens/AddDevices.jsx", "diffHunk": "@@ -22,6 +22,9 @@ export default class AddDevice extends React.Component {\n   }\n \n   onSelectDevice = (id, checked) => {\n+    // convert id to number", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNzQzMw==", "bodyText": "Do we need to parse?", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375827433", "createdAt": "2020-02-06T13:18:30Z", "author": {"login": "muloem"}, "path": "Dashboard/app/js/lib/components/selectors/DeviceSelector/DeviceAccordion.jsx", "diffHunk": "@@ -57,21 +55,15 @@ export default class DeviceAccordion extends React.Component {\n   };\n \n   render() {\n-    const {\n-      name,\n-      devices,\n-      handleSelectDevice,\n-      selectedDevices,\n-      id,\n-    } = this.props;\n+    const { name, devices, handleSelectDevice, selectedDevices, id } = this.props;\n     const { accordionClass, fontClass, panelStyle } = this.getStyleProps();\n \n     return (\n       <div className=\"accordion-container\">\n         <div className={accordionClass}>\n           <Checkbox\n-            id={id}\n-            name={id}\n+            id={parseInt(id, 10)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgzNTk0NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  const formIds = this.selectedSurveys;\n          \n          \n            \n                  const formIds = this.selectedFormIds;", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375835944", "createdAt": "2020-02-06T13:36:03Z", "author": {"login": "muloem"}, "path": "Dashboard/app/js/lib/views/devices/assignment-edit-views.jsx", "diffHunk": "@@ -159,14 +173,21 @@ FLOW.AssignmentEditView = FLOW.ReactComponentView.extend(\n       FLOW.router.transitionTo('navDevices.assignSurveysOverview');\n     },\n \n+    detectChangeTab() {\n+      if (Ember.none(FLOW.selectedControl.selectedSurveyAssignment.get('keyId'))) {\n+        FLOW.selectedControl.get('selectedSurveyAssignment').deleteRecord();\n+      }\n+      FLOW.selectedControl.set('selectedSurveyAssignment', null);\n+    },\n+\n     // saving functionality\n     saveSurveyAssignment(data) {\n       let endDateParse;\n       let startDateParse;\n \n       // set devices and surveys\n       const deviceIds = this.selectedDevices;\n-      const formIds = this.selectedSurveys.map(item => item.get('keyId'));\n+      const formIds = this.selectedSurveys;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0"}, "originalPosition": 117}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32b4478b9981d5084cadaf190de4d63c1fadd525", "author": {"user": null}, "url": "https://github.com/akvo/akvo-flow/commit/32b4478b9981d5084cadaf190de4d63c1fadd525", "committedDate": "2020-02-07T08:00:38Z", "message": "[#3168] - remove useless comments, converts strings to number and make variable names more contextual"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MjExODAy", "url": "https://github.com/akvo/akvo-flow/pull/3404#pullrequestreview-355211802", "createdAt": "2020-02-07T14:56:02Z", "commit": {"oid": "32b4478b9981d5084cadaf190de4d63c1fadd525"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4589, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}