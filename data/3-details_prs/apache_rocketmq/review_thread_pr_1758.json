{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMzE4ODUx", "number": 1758, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMzo0MToyMVrODfCgBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMzo0MToyMVrODfCgBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzODczNDEyOnYy", "diffSide": "LEFT", "path": "common/src/main/java/org/apache/rocketmq/common/message/MessageClientIDSetter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwMzo0MToyMVrOFog47w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo0ODoyOVrOFoiaHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODAyNjIyMw==", "bodyText": "pid is short\uff0cso maybe putShort can resolve this issue\uff0cand this indeed a bug, ip.length + 2 will remove the lower 2 bytes.", "url": "https://github.com/apache/rocketmq/pull/1758#discussion_r378026223", "createdAt": "2020-02-12T03:41:21Z", "author": {"login": "duhenglucky"}, "path": "common/src/main/java/org/apache/rocketmq/common/message/MessageClientIDSetter.java", "diffHunk": "@@ -37,13 +37,10 @@\n         } catch (Exception e) {\n             ip = createFakeIP();\n         }\n-        LEN = ip.length + 2 + 4 + 4 + 2;\n-        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 2 + 4);\n-        tempBuffer.position(0);\n+        LEN = ip.length + 4 + 4 + 4 + 2;\n+        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 4 + 4);\n         tempBuffer.put(ip);\n-        tempBuffer.position(ip.length);\n         tempBuffer.putInt(UtilAll.getPid());\n-        tempBuffer.position(ip.length + 2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fb7710f7773fdd184b2a3be96f71be5a4a5fb7b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA0NzM3Ng==", "bodyText": "https://unix.stackexchange.com/questions/16883/what-is-the-maximum-value-of-the-process-id", "url": "https://github.com/apache/rocketmq/pull/1758#discussion_r378047376", "createdAt": "2020-02-12T05:31:28Z", "author": {"login": "rushsky518"}, "path": "common/src/main/java/org/apache/rocketmq/common/message/MessageClientIDSetter.java", "diffHunk": "@@ -37,13 +37,10 @@\n         } catch (Exception e) {\n             ip = createFakeIP();\n         }\n-        LEN = ip.length + 2 + 4 + 4 + 2;\n-        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 2 + 4);\n-        tempBuffer.position(0);\n+        LEN = ip.length + 4 + 4 + 4 + 2;\n+        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 4 + 4);\n         tempBuffer.put(ip);\n-        tempBuffer.position(ip.length);\n         tempBuffer.putInt(UtilAll.getPid());\n-        tempBuffer.position(ip.length + 2);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODAyNjIyMw=="}, "originalCommit": {"oid": "4fb7710f7773fdd184b2a3be96f71be5a4a5fb7b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA0ODYxMA==", "bodyText": "issue is here\uff1a#1751", "url": "https://github.com/apache/rocketmq/pull/1758#discussion_r378048610", "createdAt": "2020-02-12T05:37:35Z", "author": {"login": "rushsky518"}, "path": "common/src/main/java/org/apache/rocketmq/common/message/MessageClientIDSetter.java", "diffHunk": "@@ -37,13 +37,10 @@\n         } catch (Exception e) {\n             ip = createFakeIP();\n         }\n-        LEN = ip.length + 2 + 4 + 4 + 2;\n-        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 2 + 4);\n-        tempBuffer.position(0);\n+        LEN = ip.length + 4 + 4 + 4 + 2;\n+        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 4 + 4);\n         tempBuffer.put(ip);\n-        tempBuffer.position(ip.length);\n         tempBuffer.putInt(UtilAll.getPid());\n-        tempBuffer.position(ip.length + 2);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODAyNjIyMw=="}, "originalCommit": {"oid": "4fb7710f7773fdd184b2a3be96f71be5a4a5fb7b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA1MTEwMQ==", "bodyText": "and there are 2 methods\n\"org.apache.rocketmq.common.MixAll#getPID\"\n\"org.apache.rocketmq.common.UtilAll#getPid\"", "url": "https://github.com/apache/rocketmq/pull/1758#discussion_r378051101", "createdAt": "2020-02-12T05:48:29Z", "author": {"login": "rushsky518"}, "path": "common/src/main/java/org/apache/rocketmq/common/message/MessageClientIDSetter.java", "diffHunk": "@@ -37,13 +37,10 @@\n         } catch (Exception e) {\n             ip = createFakeIP();\n         }\n-        LEN = ip.length + 2 + 4 + 4 + 2;\n-        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 2 + 4);\n-        tempBuffer.position(0);\n+        LEN = ip.length + 4 + 4 + 4 + 2;\n+        ByteBuffer tempBuffer = ByteBuffer.allocate(ip.length + 4 + 4);\n         tempBuffer.put(ip);\n-        tempBuffer.position(ip.length);\n         tempBuffer.putInt(UtilAll.getPid());\n-        tempBuffer.position(ip.length + 2);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODAyNjIyMw=="}, "originalCommit": {"oid": "4fb7710f7773fdd184b2a3be96f71be5a4a5fb7b"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1682, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}