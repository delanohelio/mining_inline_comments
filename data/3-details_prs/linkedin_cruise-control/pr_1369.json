{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MjUxNTA2", "number": 1369, "title": "Enable Cruise Control to collect metrics from low traffic clusters by default", "bodyText": "Cruise Control (CC) can fail to collect sufficient metrics from low traffic Kafka clusters for an extended period of time, which would make CC unable to handle model-based (e.g. get cluster load) or goal-based (rebalance the cluster using the default goals) operations \u2013 e.g.\nError processing GET request '/partition_load' due to: 'com.linkedin.kafka.cruisecontrol.exception.KafkaCruiseControlException: com.linkedin.cruisecontrol.exception.NotEnoughValidWindowsException: There are only 0 valid windows when aggregating in range [-1, 1603951915056] for aggregation options (minValidEntityRatio=0.98, minValidEntityGroupRatio=0.00, minValidWindows=1, numEntitiesToInclude=55498, granularity=ENTITY)'.\n\nWe have already exposed the relevant config to fix similar observed issues in #730. However, the default config value has not been updated, which requires users to manually change the config. This patch updates the default value of the relevant config to a value that enable collection of metrics from low traffic clusters by default.", "createdAt": "2020-11-02T18:47:42Z", "url": "https://github.com/linkedin/cruise-control/pull/1369", "merged": true, "mergeCommit": {"oid": "aaabca52e9baa2f4f391693013374203c5e89889"}, "closed": true, "closedAt": "2020-11-03T22:01:00Z", "author": {"login": "efeg"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYpEIJAH2gAyNTE0MjUxNTA2OjJhYmJiMTIxZWNjZTVmOGNmMDliMzI0NjQ3NjhkNjdiMzRkM2M0M2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY_Rh3gFqTUyMjg1NDUxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2abbb121ecce5f8cf09b32464768d67b34d3c43d", "author": {"user": null}, "url": "https://github.com/linkedin/cruise-control/commit/2abbb121ecce5f8cf09b32464768d67b34d3c43d", "committedDate": "2020-11-02T18:42:02Z", "message": "Enable Cruise Control to collect metrics from low traffic clusters by default"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxOTk1NTU1", "url": "https://github.com/linkedin/cruise-control/pull/1369#pullrequestreview-521995555", "createdAt": "2020-11-02T21:12:15Z", "commit": {"oid": "2abbb121ecce5f8cf09b32464768d67b34d3c43d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMToxMjoxNVrOHsVzNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMToxMjoxNVrOHsVzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI1NjU2NA==", "bodyText": "We might want to go with the convention and write it as 5 * 1000.", "url": "https://github.com/linkedin/cruise-control/pull/1369#discussion_r516256564", "createdAt": "2020-11-02T21:12:15Z", "author": {"login": "wyuka"}, "path": "cruise-control-metrics-reporter/src/main/java/com/linkedin/kafka/cruisecontrol/metricsreporter/CruiseControlMetricsReporterConfig.java", "diffHunk": "@@ -67,7 +67,7 @@\n   public static final Short DEFAULT_CRUISE_CONTROL_MIN_INSYNC_REPLICAS = -1;\n   public static final long DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_INTERVAL_MS = 60000;\n   public static final String PRODUCER_ID = \"CruiseControlMetricsReporter\";\n-  public static final int DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_LINGER_MS = 30 * 1000;\n+  public static final int DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_LINGER_MS = 5000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2abbb121ecce5f8cf09b32464768d67b34d3c43d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "153a312bf32ceee52ff957d7934eb37015e7e3a1", "author": {"user": null}, "url": "https://github.com/linkedin/cruise-control/commit/153a312bf32ceee52ff957d7934eb37015e7e3a1", "committedDate": "2020-11-02T21:33:26Z", "message": "Address the feedback."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a94ce947c275ac7cea125fc50f32a53eb2c922e8", "author": {"user": null}, "url": "https://github.com/linkedin/cruise-control/commit/a94ce947c275ac7cea125fc50f32a53eb2c922e8", "committedDate": "2020-11-02T21:34:16Z", "message": "Drop the unused LOG from CruiseControlMetricsReporterConfig."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODUyMDky", "url": "https://github.com/linkedin/cruise-control/pull/1369#pullrequestreview-522852092", "createdAt": "2020-11-03T20:30:33Z", "commit": {"oid": "a94ce947c275ac7cea125fc50f32a53eb2c922e8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozMDozNFrOHs_Y8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozMDozNFrOHs_Y8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzNzk2OA==", "bodyText": "I highly recommend using TimeUnit to set default values for all time-related parameters. For example DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_LINGER_MS  = TimeUnit.SECONDS.toMillis(5);", "url": "https://github.com/linkedin/cruise-control/pull/1369#discussion_r516937968", "createdAt": "2020-11-03T20:30:34Z", "author": {"login": "Lincong"}, "path": "cruise-control-metrics-reporter/src/main/java/com/linkedin/kafka/cruisecontrol/metricsreporter/CruiseControlMetricsReporterConfig.java", "diffHunk": "@@ -67,7 +64,7 @@\n   public static final Short DEFAULT_CRUISE_CONTROL_MIN_INSYNC_REPLICAS = -1;\n   public static final long DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_INTERVAL_MS = 60000;\n   public static final String PRODUCER_ID = \"CruiseControlMetricsReporter\";\n-  public static final int DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_LINGER_MS = 30 * 1000;\n+  public static final int DEFAULT_CRUISE_CONTROL_METRICS_REPORTER_LINGER_MS = 5 * 1000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a94ce947c275ac7cea125fc50f32a53eb2c922e8"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODU0NTEy", "url": "https://github.com/linkedin/cruise-control/pull/1369#pullrequestreview-522854512", "createdAt": "2020-11-03T20:34:35Z", "commit": {"oid": "a94ce947c275ac7cea125fc50f32a53eb2c922e8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 97, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}