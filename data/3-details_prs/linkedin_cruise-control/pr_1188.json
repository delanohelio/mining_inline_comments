{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNTY1ODE0", "number": 1188, "title": "Fix #1187: User tasks endpoint returns error for CompletedWithError tasks when fetch_complete_task=true", "bodyText": "Addresses issue #1187, where the user tasks endpoint returns an error if a task CompletedWithError and fetch_complete_task=true is in the request. This prevents the user from learning the state of these tasks.\nThis changes the getJSonStructure method to not throw an error for CompletedWithError tasks when fetch_complete_task=true and instead just return \"CompletedWithError\" in the originalResponse field.", "createdAt": "2020-05-05T14:50:29Z", "url": "https://github.com/linkedin/cruise-control/pull/1188", "merged": true, "mergeCommit": {"oid": "9806b25ca57f18fb995a29863f3f8e571f4cb8a7"}, "closed": true, "closedAt": "2020-05-11T17:04:40Z", "author": {"login": "tomncooper"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcevEA8AFqTQwNjk2OTA5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgSx2cAFqTQwOTM2MTMxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2OTY5MDkw", "url": "https://github.com/linkedin/cruise-control/pull/1188#pullrequestreview-406969090", "createdAt": "2020-05-06T20:39:25Z", "commit": {"oid": "4122d4106c610c1bb413033762174bd8558eff43"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQyMDozOToyNVrOGRkiXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQyMDo0Mzo1M1rOGRkrdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA3NzU5OA==", "bodyText": "So checkstyle failed, but the line it is complaining about doesn't exit? How do I run the checkstyle task locally?\n\n@tomncooper This is due to a missing space before { in this line:\n> Task :cruise-control:checkstyleMain\n[ant:checkstyle] [ERROR] /home/circleci/workspace/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/servlet/UserTaskManager.java:769:56: '{' is not preceded with whitespace. [WhitespaceAround]", "url": "https://github.com/linkedin/cruise-control/pull/1188#discussion_r421077598", "createdAt": "2020-05-06T20:39:25Z", "author": {"login": "efeg"}, "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/servlet/UserTaskManager.java", "diffHunk": "@@ -763,9 +763,16 @@ private void logOperation() {\n       // Populate original response of completed task if requested so.\n       if (fetchCompletedTask) {\n         try {\n+          // TODO: For CompletedWithError tasks the cached response should contain the original server side error information\n           jsonObjectMap.put(ORIGINAL_RESPONSE, lastFuture().get().cachedResponse());\n         } catch (InterruptedException | ExecutionException e) {\n-          throw new IllegalStateException(\"Error happened in fetching response for task \" + _userTaskId.toString(), e);\n+          if (_state == TaskState.COMPLETED_WITH_ERROR){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4122d4106c610c1bb413033762174bd8558eff43"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA3OTkyNA==", "bodyText": "Nit: Double quotes (i.e. \") seems redundant since CompletedWithError  is already inside backticks.", "url": "https://github.com/linkedin/cruise-control/pull/1188#discussion_r421079924", "createdAt": "2020-05-06T20:43:53Z", "author": {"login": "efeg"}, "path": "docs/wiki/User Guide/REST-APIs.md", "diffHunk": "@@ -231,7 +231,7 @@ Supported parameters are:\n \n User can use `user_task_ids`/`client_ids`/`endpoints`/`types` make Cruise Control only return requests they are interested. By default all the requests get returned.\n \n-If `fetch_completed_task` is set to `true`, the original response of each requests will be returned.\n+If `fetch_completed_task` is set to `true`, the original response of each requests will be returned. In the case where a task completed with errors the response will be `\"CompletedWithError\"`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4122d4106c610c1bb413033762174bd8558eff43"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c48f309a0df58c07f42d487efb238218b4c3f36", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/linkedin/cruise-control/commit/0c48f309a0df58c07f42d487efb238218b4c3f36", "committedDate": "2020-05-11T09:58:44Z", "message": "Change user task getJson method to prevent errors for CompletedWithError tasks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4122d4106c610c1bb413033762174bd8558eff43", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/linkedin/cruise-control/commit/4122d4106c610c1bb413033762174bd8558eff43", "committedDate": "2020-05-05T14:38:44Z", "message": "Change user task getJson method to prevent errors for CompletedWithError tasks"}, "afterCommit": {"oid": "0c48f309a0df58c07f42d487efb238218b4c3f36", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/linkedin/cruise-control/commit/0c48f309a0df58c07f42d487efb238218b4c3f36", "committedDate": "2020-05-11T09:58:44Z", "message": "Change user task getJson method to prevent errors for CompletedWithError tasks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzYxMzE0", "url": "https://github.com/linkedin/cruise-control/pull/1188#pullrequestreview-409361314", "createdAt": "2020-05-11T17:04:24Z", "commit": {"oid": "0c48f309a0df58c07f42d487efb238218b4c3f36"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 219, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}