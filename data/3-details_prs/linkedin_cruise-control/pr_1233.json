{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNjU0ODkw", "number": 1233, "title": "Upgrade to kafka 2.5.0", "bodyText": "Addresses the issue #1229", "createdAt": "2020-06-09T09:17:22Z", "url": "https://github.com/linkedin/cruise-control/pull/1233", "merged": true, "mergeCommit": {"oid": "563bf9f5f3aa3f1991512437def39346558d9784"}, "closed": true, "closedAt": "2020-06-22T21:52:16Z", "author": {"login": "amuraru"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcra_l4gFqTQzMDM1OTQyNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABct4DytAFqTQzNTI5OTMwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMzU5NDI3", "url": "https://github.com/linkedin/cruise-control/pull/1233#pullrequestreview-430359427", "createdAt": "2020-06-15T06:43:16Z", "commit": {"oid": "76d0fe8279bbdfacbd1b690454566b425508e23e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNjo0MzoxNlrOGjlBqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNjo0Nzo1MFrOGjlIYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk1OTk3Ng==", "bodyText": "Here, not TP but tp1, because of the topic parameter is TOPIC0+\"1\"", "url": "https://github.com/linkedin/cruise-control/pull/1233#discussion_r439959976", "createdAt": "2020-06-15T06:43:16Z", "author": {"login": "akatona84"}, "path": "cruise-control/src/test/java/com/linkedin/kafka/cruisecontrol/monitor/sampling/aggregator/KafkaPartitionMetricSampleAggregatorTest.java", "diffHunk": "@@ -129,24 +129,24 @@ public void testAggregateWithUpdatedCluster() throws NotEnoughValidWindowsExcept\n                                                          TOPIC0,\n                                                          false,\n                                                          Collections.singletonList(new MetadataResponse.PartitionMetadata(\n-                                                             Errors.NONE, PARTITION, NODE_0,\n+                                                             Errors.NONE, TP, Optional.of(NODE_0.id()),\n                                                              Optional.of(RecordBatch.NO_PARTITION_LEADER_EPOCH),\n-                                                             Arrays.asList(nodes()), Arrays.asList(nodes()),\n+                                                             nodeIds(), nodeIds(),\n                                                              Collections.emptyList()))));\n     topicMetadata.add(new MetadataResponse.TopicMetadata(Errors.NONE,\n                                                          TOPIC0 + \"1\",\n                                                          false,\n                                                          Collections.singletonList(new MetadataResponse.PartitionMetadata(\n-                                                             Errors.NONE, 0, NODE_0,\n+                                                             Errors.NONE, TP, Optional.of(NODE_0.id()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76d0fe8279bbdfacbd1b690454566b425508e23e"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk2MTY5Nw==", "bodyText": "how about\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                return Arrays.asList(NODES.clone()).stream().map(n -> n.id()).collect(Collectors.toList());\n          \n          \n            \n                return Arrays.stream(NODES).map(Node::id).collect(Collectors.toList());\n          \n      \n    \n    \n  \n\nimho array cloning is unnecessary also more concise", "url": "https://github.com/linkedin/cruise-control/pull/1233#discussion_r439961697", "createdAt": "2020-06-15T06:47:50Z", "author": {"login": "akatona84"}, "path": "cruise-control/src/test/java/com/linkedin/kafka/cruisecontrol/monitor/MonitorUnitTestUtils.java", "diffHunk": "@@ -44,6 +46,13 @@ private MonitorUnitTestUtils() {\n     return NODES.clone();\n   }\n \n+  /**\n+   * @return The clone of the nodes in the {@link #getCluster(Collection)} and {@link #getMetadata(Collection)}.\n+   */\n+  public static List<Integer> nodeIds() {\n+    return Arrays.asList(NODES.clone()).stream().map(n -> n.id()).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76d0fe8279bbdfacbd1b690454566b425508e23e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMzY2MzM5", "url": "https://github.com/linkedin/cruise-control/pull/1233#pullrequestreview-430366339", "createdAt": "2020-06-15T06:56:56Z", "commit": {"oid": "76d0fe8279bbdfacbd1b690454566b425508e23e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNjo1Njo1NlrOGjlWvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNjo1Njo1NlrOGjlWvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk2NTM3Mw==", "bodyText": "-1 could be MetadataResponse.NO_LEADER_ID", "url": "https://github.com/linkedin/cruise-control/pull/1233#discussion_r439965373", "createdAt": "2020-06-15T06:56:56Z", "author": {"login": "akatona84"}, "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/KafkaCruiseControlUtils.java", "diffHunk": "@@ -430,13 +430,13 @@ public static MetadataResponse prepareMetadataResponse(List<Node> brokers,\n     for (MetadataResponse.PartitionMetadata partitionMetadata : topicMetadata.partitionMetadata()) {\n       metadataResponseTopic.partitions().add(\n           new MetadataResponseData.MetadataResponsePartition()\n-              .setErrorCode(partitionMetadata.error().code())\n+              .setErrorCode(partitionMetadata.error.code())\n               .setPartitionIndex(partitionMetadata.partition())\n-              .setLeaderId(partitionMetadata.leader() == null ? -1 : partitionMetadata.leader().id())\n-              .setLeaderEpoch(partitionMetadata.leaderEpoch().orElse(RecordBatch.NO_PARTITION_LEADER_EPOCH))\n-              .setReplicaNodes(partitionMetadata.replicas().stream().map(Node::id).collect(Collectors.toList()))\n-              .setIsrNodes(partitionMetadata.isr().stream().map(Node::id).collect(Collectors.toList()))\n-              .setOfflineReplicas(partitionMetadata.offlineReplicas().stream().map(Node::id).collect(Collectors.toList())));\n+              .setLeaderId(partitionMetadata.leaderId.orElse(-1))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76d0fe8279bbdfacbd1b690454566b425508e23e"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2982cb144f4467a3ff474a3b8bf35ff603da5d47", "author": {"user": {"login": "amuraru", "name": "Adrian Muraru"}}, "url": "https://github.com/linkedin/cruise-control/commit/2982cb144f4467a3ff474a3b8bf35ff603da5d47", "committedDate": "2020-06-16T08:28:44Z", "message": "Upgrade to kafka 2.5.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085", "author": {"user": {"login": "amuraru", "name": "Adrian Muraru"}}, "url": "https://github.com/linkedin/cruise-control/commit/e49a127d66a13a463a8ddeeca495493575ea7085", "committedDate": "2020-06-16T08:34:53Z", "message": "addressed review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc5dd0bd637869e41f16066ef8c589c69d6d964c", "author": {"user": {"login": "amuraru", "name": "Adrian Muraru"}}, "url": "https://github.com/linkedin/cruise-control/commit/bc5dd0bd637869e41f16066ef8c589c69d6d964c", "committedDate": "2020-06-16T08:33:44Z", "message": "Update cruise-control/src/test/java/com/linkedin/kafka/cruisecontrol/monitor/MonitorUnitTestUtils.java\n\nCo-authored-by: Andras Katona <41361962+akatona84@users.noreply.github.com>"}, "afterCommit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085", "author": {"user": {"login": "amuraru", "name": "Adrian Muraru"}}, "url": "https://github.com/linkedin/cruise-control/commit/e49a127d66a13a463a8ddeeca495493575ea7085", "committedDate": "2020-06-16T08:34:53Z", "message": "addressed review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MTU5NTE4", "url": "https://github.com/linkedin/cruise-control/pull/1233#pullrequestreview-434159518", "createdAt": "2020-06-19T15:19:37Z", "commit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNToxOTozN1rOGmYhjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNToyMjo1NFrOGmYoYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkwMDg3OA==", "bodyText": "Can we avoid version bump to 3.6.1? -- please see #1236 (comment)", "url": "https://github.com/linkedin/cruise-control/pull/1233#discussion_r442900878", "createdAt": "2020-06-19T15:19:37Z", "author": {"login": "efeg"}, "path": "gradle.properties", "diffHunk": "@@ -1,5 +1,5 @@\n org.gradle.daemon=false\n org.gradle.parallel=false\n org.gradle.jvmargs=-Xms512m -Xmx512m\n-kafkaVersion=2.4.1\n-zookeeperVersion=3.6.0\n\\ No newline at end of file\n+kafkaVersion=2.5.0\n+zookeeperVersion=3.6.1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkwMjYyNw==", "bodyText": "I am curious why we add MS_PKGPROTECT?", "url": "https://github.com/linkedin/cruise-control/pull/1233#discussion_r442902627", "createdAt": "2020-06-19T15:22:54Z", "author": {"login": "efeg"}, "path": "gradle/findbugs-exclude.xml", "diffHunk": "@@ -50,6 +50,7 @@\n       <Bug pattern=\"EC_NULL_ARG\"/>\n       <Bug pattern=\"NP_ALWAYS_NULL\"/>\n       <Bug pattern=\"MS_CANNOT_BE_FINAL\"/>\n+      <Bug pattern=\"MS_PKGPROTECT\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Mjk5MzA1", "url": "https://github.com/linkedin/cruise-control/pull/1233#pullrequestreview-435299305", "createdAt": "2020-06-22T21:51:31Z", "commit": {"oid": "e49a127d66a13a463a8ddeeca495493575ea7085"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 250, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}