{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NDA5MjA5", "number": 4004, "title": "fix: gracefully catch and report errors that happen during game load", "bodyText": "This catches errors that occur during game load.\nIt opens the crash reporter while sending the user back to the Terasology main menu.\nHow to test\nHave a crashy save file or something?\nIf not, you can edit the source someplace like AwaitCharacterSpawn#step to deliberately throw an exception.\nOutstanding before merging\n\n Is this the right place to catch the error? I don't think it's the worst place, as StateLoading could know that switching back to StateMainMenu is a reasonable fallback. But maybe it should be higher. wrap all of StateLoading.update? or all of GameEngine.tick?\n Will need translation work \u2190 this is one of the template checklist items but is totally true.\n\n Use a translatable resource for the error message here. needs compound messages; will address in #4045.\n Make sure the thing that shows the message uses the translation resources.", "createdAt": "2020-05-30T03:52:06Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4004", "merged": true, "mergeCommit": {"oid": "9a3d78398e2d83158e76ae7bafb86e6ab5021386"}, "closed": true, "closedAt": "2020-07-19T17:48:03Z", "author": {"login": "keturn"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmOoZcAH2gAyNDI1NDA5MjA5OjliNzM0OGMwMjc2NGUxY2Q0ZDk1NmE2OGZhOGQ0MDhkYzI0N2EyMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2goejAFqTQ1MTE0OTk0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b7348c02764e1cd4d956a68fa8d408dc247a228", "author": {"user": {"login": "keturn", "name": "Kevin Turner"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/9b7348c02764e1cd4d956a68fa8d408dc247a228", "committedDate": "2020-05-30T03:38:00Z", "message": "fix: gracefully catch and report errors that happen during game load"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MTc0MDk3", "url": "https://github.com/MovingBlocks/Terasology/pull/4004#pullrequestreview-425174097", "createdAt": "2020-06-05T10:15:44Z", "commit": {"oid": "9b7348c02764e1cd4d956a68fa8d408dc247a228"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDoxNTo0NFrOGfoyVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMDoxNTo0NFrOGfoyVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgyNzI4Ng==", "bodyText": "If current.getMessage() is a key for a translateable string, you probably \"just\" need to push that through TranslationSystem::translate.\nIn screen layers and widget you'll get it by using @In annotation:\n    @In\n    private TranslationSystem translationSystem;", "url": "https://github.com/MovingBlocks/Terasology/pull/4004#discussion_r435827286", "createdAt": "2020-06-05T10:15:44Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/engine/modes/StateLoading.java", "diffHunk": "@@ -243,8 +245,17 @@ public void update(float delta) {\n         EngineTime time = (EngineTime) context.get(Time.class);\n         long startTime = time.getRealTimeInMs();\n         while (current != null && time.getRealTimeInMs() - startTime < 20 && !gameEngine.hasPendingState()) {\n-            if (current.step()) {\n-                popStep();\n+            try {\n+                if (current.step()) {\n+                    popStep();\n+                }\n+            } catch (Exception e) {\n+                logger.error(\"Error while loading {}\", current, e);\n+                String errorMessage = String.format(\"Failed to load game. There was an error during %s.\",\n+                        current == null ? \"the last part\" : current.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b7348c02764e1cd4d956a68fa8d408dc247a228"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17db214b6927b29f7c116aeb20653ab915a69454", "author": {"user": {"login": "keturn", "name": "Kevin Turner"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/17db214b6927b29f7c116aeb20653ab915a69454", "committedDate": "2020-06-08T16:15:35Z", "message": "Merge remote-tracking branch 'origin/develop' into fix/reportLoadingCrashes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08a952baaff93cefa4e7e773b6cdbf0c80173d25", "author": {"user": {"login": "keturn", "name": "Kevin Turner"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/08a952baaff93cefa4e7e773b6cdbf0c80173d25", "committedDate": "2020-06-08T19:56:19Z", "message": "fix(StateLoading): show localized messageOnLoad"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMTQ5OTQ1", "url": "https://github.com/MovingBlocks/Terasology/pull/4004#pullrequestreview-451149945", "createdAt": "2020-07-19T17:39:10Z", "commit": {"oid": "08a952baaff93cefa4e7e773b6cdbf0c80173d25"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1616, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}