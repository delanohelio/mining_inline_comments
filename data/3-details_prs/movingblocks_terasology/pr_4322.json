{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MDIxOTI3", "number": 4322, "title": "feat(JOML): migrate world gen", "bodyText": "Module PRs\n\n AlchemyPlantGenerator\n AnotherWorld\n Caves\n Cities\n ClimateConditions\n CoreWorlds\n CustomOreGen\n DynamicCities\n EdibleFlora\n Exoplanet\n FlexiblePathfinding\n FlowingLiquids\n GooeyDefence\n GrowingFlora\n Inferno\n JoshariasSurvival\n Lakes\n LightAndShadow\n Lost\n MasterOfOreon\n MetalRenegades\n Minerals\n Minesweeper\n OreGeneration\n ParadIce\n PolyWorld\n ShatteredPlanes\n StaticCities\n SurfaceFacets\n WeatherManager\n\nCheck out via:\nfor m in AlchemyPlantGenerator AnotherWorld Caves Cities ClimateConditions CoreWorlds CustomOreGen DynamicCities EdibleFlora Exoplanet FlexiblePathfinding FlowingLiquids GooeyDefence GrowingFlora Inferno JoshariasSurvival Lakes LightAndShadow Lost MasterOfOreon MetalRenegades Minerals Minesweeper OreGeneration ParadIce PolyWorld ShatteredPlanes StaticCities SurfaceFacets WeatherManager; do pushd modules/$m; git checkout feat/joml-world-gen; popd; done", "createdAt": "2020-12-13T21:15:22Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4322", "merged": true, "mergeCommit": {"oid": "ea2f56c37677902fbcfb7d48e95ee0007b2f6bdc"}, "closed": true, "closedAt": "2020-12-26T19:13:04Z", "author": {"login": "jdrueckert"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdl3khNAH2gAyNTM5MDIxOTI3OjZiZGYxZjE5NDI4ZTVmMDhhMzM3MmU2ZDA1YTc3NWY2NjI5NDY3MTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdp5_NxAH2gAyNTM5MDIxOTI3OjAzODdlM2I1YzM1OThlMjA5NGNlMzNjNGY3MTdlYjMzN2VmZGEwMzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6bdf1f19428e5f08a3372e6d05a775f662946712", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/6bdf1f19428e5f08a3372e6d05a775f662946712", "committedDate": "2020-12-13T20:57:06Z", "message": "feat(JOML): migrate world gen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5b50e30761721c8d471623a49592edfaee3bf57", "author": {"user": {"login": "DarkWeird", "name": "Nail Khanipov"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/a5b50e30761721c8d471623a49592edfaee3bf57", "committedDate": "2020-12-17T08:34:43Z", "message": "Merge branch 'develop' into feat/joml-world-gen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6198a4cc0a30d19dbdf81aa9bb91e892bcc82c1", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/a6198a4cc0a30d19dbdf81aa9bb91e892bcc82c1", "committedDate": "2020-12-25T11:56:43Z", "message": "Merge branch 'develop' into feat/joml-world-gen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d1b93d88367c84e11b460ec776699fec050d41a", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/0d1b93d88367c84e11b460ec776699fec050d41a", "committedDate": "2020-12-25T12:10:03Z", "message": "feat(BlockRegion): align with recent BlockRegion changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ace6c5425207325f7158320dc5e66bedda2ad19", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/8ace6c5425207325f7158320dc5e66bedda2ad19", "committedDate": "2020-12-25T14:39:37Z", "message": "feat(tests): align with recent BlockRegion changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5869cb809580b1c808764fe45482a9676f14434b", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/5869cb809580b1c808764fe45482a9676f14434b", "committedDate": "2020-12-25T20:43:41Z", "message": "test: use JOML vectors in sparse facet tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/53d33adf323df621215df73fa3d324e56e89bc10", "committedDate": "2020-12-25T20:51:56Z", "message": "feat: accept Vector3ic in SparseFieldFacet3D"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM2NDk4", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558836498", "createdAt": "2020-12-25T20:53:28Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMDo1MzoyOFrOILe3FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMDo1MzoyOFrOILe3FQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMDg2OQ==", "bodyText": "Unused import?", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548910869", "createdAt": "2020-12-25T20:53:28Z", "author": {"login": "skaldarnar"}, "path": "engine-tests/src/test/java/org/terasology/world/generation/facets/BaseBooleanFacetTest.java", "diffHunk": "@@ -17,6 +17,7 @@\n package org.terasology.world.generation.facets;\n \n import org.terasology.math.Region3i;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM2NzA5", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558836709", "createdAt": "2020-12-25T21:02:59Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowMzowMFrOILe5pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowMzowMFrOILe5pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMTUyNA==", "bodyText": "We can avoid the vector allocation here:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Vector3i extent = region.getRegion().getSize(new Vector3i());\n          \n          \n            \n                    int width = extent.x;\n          \n          \n            \n                    int height = extent.z;\n          \n          \n            \n                    int width =  region.getRegion().getSizeX();\n          \n          \n            \n                    int height =  region.getRegion().getSizeZ();", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548911524", "createdAt": "2020-12-25T21:03:00Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/rendering/nui/layers/mainMenu/preview/FacetLayerPreview.java", "diffHunk": "@@ -201,7 +201,7 @@ private static Rect2i worldToTileArea(Rect2i area) {\n      */\n     private BufferedImage rasterize(Region region) {\n \n-        Vector3i extent = region.getRegion().size();\n+        Vector3i extent = region.getRegion().getSize(new Vector3i());\n         int width = extent.x;\n         int height = extent.z;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f774c4d7cf8001ad3b6b89e74ceb36ddab6e67a5", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/f774c4d7cf8001ad3b6b89e74ceb36ddab6e67a5", "committedDate": "2020-12-25T21:03:26Z", "message": "perf: avoid vector allocation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM2NzQ2", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558836746", "createdAt": "2020-12-25T21:04:32Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowNDozMlrOILe6FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowNDozMlrOILe6FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMTYzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    float[] fullData = new float[fullRegion.getSizeX() * fullRegion.getSizeY() * fullRegion.getSizeZ()];\n          \n          \n            \n                    float[] fullData = new float[fullRegion.volume()];", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548911636", "createdAt": "2020-12-25T21:04:32Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/SubSampledNoise.java", "diffHunk": "@@ -178,11 +177,11 @@ public float noise(float x, float y, float z) {\n         }\n     }\n \n-    private float[] mapExpand(float[] keyData, Region3i fullRegion) {\n-        float[] fullData = new float[fullRegion.sizeX() * fullRegion.sizeY() * fullRegion.sizeZ()];\n-        int samplesX = fullRegion.sizeX() / sampleRate + 1;\n-        int samplesY = fullRegion.sizeY() / sampleRate + 1;\n-        int samplesZ = fullRegion.sizeZ() / sampleRate + 1;\n+    private float[] mapExpand(float[] keyData, BlockRegion fullRegion) {\n+        float[] fullData = new float[fullRegion.getSizeX() * fullRegion.getSizeY() * fullRegion.getSizeZ()];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65edbf804b0072b7fc589f3db3dd8ca334405e8e", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/65edbf804b0072b7fc589f3db3dd8ca334405e8e", "committedDate": "2020-12-25T21:05:32Z", "message": "refactor: use `.volume` instead of manual computation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM2ODgx", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558836881", "createdAt": "2020-12-25T21:08:56Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowODo1NlrOILe7ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMTowODo1NlrOILe7ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMjAzMA==", "bodyText": "avoid vector creation here and use the individual chunk extents directly.", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548912030", "createdAt": "2020-12-25T21:08:56Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/chunks/internal/ChunkImpl.java", "diffHunk": "@@ -102,8 +102,8 @@ public ChunkImpl(Vector3i chunkPos, TeraArray blocks, TeraArray[] extra, BlockMa\n         lightData = new TeraDenseArray8Bit(getChunkSizeX(), getChunkSizeY(), getChunkSizeZ());\n         dirty = true;\n         this.blockManager = blockManager;\n-        region = Region3i.createFromMinAndSize(new Vector3i(chunkPos.x * ChunkConstants.SIZE_X, chunkPos.y * ChunkConstants.SIZE_Y, chunkPos.z * ChunkConstants.SIZE_Z),\n-                ChunkConstants.CHUNK_SIZE);\n+        region = new BlockRegion(chunkPos.x * ChunkConstants.SIZE_X, chunkPos.y * ChunkConstants.SIZE_Y,\n+                chunkPos.z * ChunkConstants.SIZE_Z).setSize(JomlUtil.from(ChunkConstants.CHUNK_SIZE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "310330fee4db7661cb7f2ca4fe02b91fdac58c9e", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/310330fee4db7661cb7f2ca4fe02b91fdac58c9e", "committedDate": "2020-12-25T21:09:00Z", "message": "perf: avoid vector allocation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5567eddc6124548f19c53e98fe67cefff5c464f", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/c5567eddc6124548f19c53e98fe67cefff5c464f", "committedDate": "2020-12-25T21:12:12Z", "message": "chore: remove unnecessary qualified name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM3MDI0", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558837024", "createdAt": "2020-12-25T21:15:21Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMToxNToyMlrOILe9Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMToxNToyMlrOILe9Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMjQxMQ==", "bodyText": "Use .volume directly.", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548912411", "createdAt": "2020-12-25T21:15:22Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/generation/facets/base/BaseFieldFacet3D.java", "diffHunk": "@@ -26,9 +27,9 @@\n \n     private float[] data;\n \n-    public BaseFieldFacet3D(Region3i targetRegion, Border3D border) {\n+    public BaseFieldFacet3D(BlockRegion targetRegion, Border3D border) {\n         super(targetRegion, border);\n-        Vector3i size = getRelativeRegion().size();\n+        Vector3i size = getRelativeRegion().getSize(new Vector3i());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM3MDcz", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558837073", "createdAt": "2020-12-25T21:17:06Z", "commit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMToxNzowN1rOILe9zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNVQyMToxNzowN1rOILe9zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODkxMjU5MA==", "bodyText": "same here, avoid allocation and use volume directly", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#discussion_r548912590", "createdAt": "2020-12-25T21:17:07Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/generation/facets/base/BaseObjectFacet3D.java", "diffHunk": "@@ -32,9 +31,9 @@\n public abstract class BaseObjectFacet3D<T> extends BaseFacet3D implements ObjectFacet3D<T> {\n     private T[] data;\n \n-    public BaseObjectFacet3D(Region3i targetRegion, Border3D border, Class<T> objectType) {\n+    public BaseObjectFacet3D(BlockRegion targetRegion, Border3D border, Class<T> objectType) {\n         super(targetRegion, border);\n-        Vector3i size = getRelativeRegion().size();\n+        Vector3i size = getRelativeRegion().getSize(new Vector3i());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53d33adf323df621215df73fa3d324e56e89bc10"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "681db9a67781b87c25b56fcae30238a56e6e552d", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/681db9a67781b87c25b56fcae30238a56e6e552d", "committedDate": "2020-12-25T21:17:15Z", "message": "perf: avoid vector allocation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8543cbb825d4ccde924a026c3b763e98003164dd", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/8543cbb825d4ccde924a026c3b763e98003164dd", "committedDate": "2020-12-25T21:18:53Z", "message": "chore: remove unnecessary qualified name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODM3MjM2", "url": "https://github.com/MovingBlocks/Terasology/pull/4322#pullrequestreview-558837236", "createdAt": "2020-12-25T21:23:15Z", "commit": {"oid": "8543cbb825d4ccde924a026c3b763e98003164dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0387e3b5c3598e2094ce33c4f717eb337efda033", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/0387e3b5c3598e2094ce33c4f717eb337efda033", "committedDate": "2020-12-26T10:01:46Z", "message": "Merge branch 'develop' into feat/joml-world-gen"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1208, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}