{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0MTEwOTY3", "number": 4051, "title": "feat(JOML): partial migrate of LocationComponent", "bodyText": "I migrate over LocationComponent along with some changes in Direction. The old methods are mapped onto the replacement methods and marked as deprecated. I was able to verify this with an omega workspace and nothing significant was impacted with these changes.\nIt should be easy to verify if this works correctly and at some point the internal implementation can be swapped over. The test that verify LocationComponent have been migrated over.  LocationComponent is used throughout the engine so testing this with a couple different modules should be sufficient.\nMigrated methods in LocationComponent:\n\nsetWorldPosition(Vector3f)\nsetWorldRotation(Quat4f)\ngetWorldRotation(Quat4f)\ngetWorldRotation()\ngetWorldDirection()\ngetWorldPosition(Vector3f)\ngetWorldPosition()\ngetLocalDirection()\nsetLocalPosition(Vector3f)\n\nI would like to set getLocalRotation and getLocalPosition as readonly. The set methods store the previous local rotation and position.  These methods are used for the LocationChangedSystem but a boolean flag seems more appropriate.", "createdAt": "2020-06-14T08:10:20Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4051", "merged": true, "mergeCommit": {"oid": "38fba56fe0a2502897e17249b22f6df17cff6827"}, "closed": true, "closedAt": "2020-09-15T01:46:24Z", "author": {"login": "pollend"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrHgWpAH2gAyNDM0MTEwOTY3OmQ1NWViY2Q2MmU4MTk0YmVmODlhNGNiNDBmYTQ3Mjg0M2VjNTVjMzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEhorjAFqTQ3OTQ0MjIwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d55ebcd62e8194bef89a4cb40fa472843ec55c35", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/d55ebcd62e8194bef89a4cb40fa472843ec55c35", "committedDate": "2020-06-14T08:09:30Z", "message": "feat(JOML) partial migration of LocationComponent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09d17b05883538f6184cab0ac76e825ae79cab04", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/09d17b05883538f6184cab0ac76e825ae79cab04", "committedDate": "2020-06-14T20:47:06Z", "message": "add replacement locationComponent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee94a16a8daeb7ac5d2b26e4843825e4adcfb0f6", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/ee94a16a8daeb7ac5d2b26e4843825e4adcfb0f6", "committedDate": "2020-06-14T23:19:59Z", "message": "updated test cases to LocationComponent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e130a57df0206ab7b15010c8158b6bd377723ce", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/0e130a57df0206ab7b15010c8158b6bd377723ce", "committedDate": "2020-08-06T23:36:02Z", "message": "Merge remote-tracking branch 'upstream/develop' into feature/JOML_partial_migrate_LocationComponent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef3635d4a976fd64f34094633ba940c3c1a1c397", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/ef3635d4a976fd64f34094633ba940c3c1a1c397", "committedDate": "2020-08-06T23:41:08Z", "message": "update location component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f6caccc89dddba6660d5b63c222f560dd5a654a", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/8f6caccc89dddba6660d5b63c222f560dd5a654a", "committedDate": "2020-08-07T01:55:36Z", "message": "mapped older methods to replacment methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae6f308b125559224f6730cffc09b47548fc6b8c", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/ae6f308b125559224f6730cffc09b47548fc6b8c", "committedDate": "2020-08-07T02:06:25Z", "message": "update docs for LocationComponent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e", "committedDate": "2020-08-07T02:19:36Z", "message": "add missing @Deprecated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MzQyNDUy", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#pullrequestreview-478342452", "createdAt": "2020-08-31T06:19:31Z", "commit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwNjoxOTozMVrOHJry0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQwNjozMDo0OVrOHJsCZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxNjc1Mw==", "bodyText": "Unused.", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#discussion_r479916753", "createdAt": "2020-08-31T06:19:31Z", "author": {"login": "DarkWeird"}, "path": "engine-tests/src/test/java/org/terasology/logic/location/LocationComponentTest.java", "diffHunk": "@@ -15,11 +15,13 @@\n  */\n package org.terasology.logic.location;\n \n+import org.joml.Quaternionf;\n import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.Test;\n import org.terasology.TerasologyTestingEnvironment;\n import org.terasology.entitySystem.entity.EntityRef;\n import org.terasology.entitySystem.entity.lifecycleEvents.BeforeRemoveComponent;\n+import org.terasology.math.JomlUtil;\n import org.terasology.math.TeraMath;\n import org.terasology.math.geom.Quat4f;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxNzMwNA==", "bodyText": "Better change it to joml's Vector3f. Make less FQN usages.\ntera's Vector3f usages: 3\njoml's Vector3f usages: 38", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#discussion_r479917304", "createdAt": "2020-08-31T06:21:07Z", "author": {"login": "DarkWeird"}, "path": "engine-tests/src/test/java/org/terasology/logic/location/LocationComponentTest.java", "diffHunk": "@@ -15,11 +15,13 @@\n  */\n package org.terasology.logic.location;\n \n+import org.joml.Quaternionf;\n import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.Test;\n import org.terasology.TerasologyTestingEnvironment;\n import org.terasology.entitySystem.entity.EntityRef;\n import org.terasology.entitySystem.entity.lifecycleEvents.BeforeRemoveComponent;\n+import org.terasology.math.JomlUtil;\n import org.terasology.math.TeraMath;\n import org.terasology.math.geom.Quat4f;\n import org.terasology.math.geom.Vector3f;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkyMDIwNw==", "bodyText": "You can remove method assertEquals(Quat4f, Quat4f, float) - it is not used now (omega)", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#discussion_r479920207", "createdAt": "2020-08-31T06:29:28Z", "author": {"login": "DarkWeird"}, "path": "engine-tests/src/main/java/org/terasology/testUtil/TeraAssert.java", "diffHunk": "@@ -138,4 +139,18 @@ public static void assertEquals(Quat4f expected, Quat4f actual, float error) {\n             org.junit.jupiter.api.Assertions.assertEquals(expected.w, actual.w, error, errorMessageSupplier);\n         }\n     }\n+\n+\n+    public static void assertEquals(Quaternionfc expected, Quaternionfc actual, float error) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkyMDc0MA==", "bodyText": "Oh, I don't noticed this migration junit4-junit5 T_T\nCan you fix it? (change to import usage) Assertions.assertEquals", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#discussion_r479920740", "createdAt": "2020-08-31T06:30:49Z", "author": {"login": "DarkWeird"}, "path": "engine-tests/src/main/java/org/terasology/testUtil/TeraAssert.java", "diffHunk": "@@ -138,4 +139,18 @@ public static void assertEquals(Quat4f expected, Quat4f actual, float error) {\n             org.junit.jupiter.api.Assertions.assertEquals(expected.w, actual.w, error, errorMessageSupplier);\n         }\n     }\n+\n+\n+    public static void assertEquals(Quaternionfc expected, Quaternionfc actual, float error) {\n+        if (expected == null) {\n+            assertNull(actual);\n+        } else {\n+            assertNotNull(actual);\n+            Supplier<String> errorMessageSupplier = () -> \"Expected \" + expected + \", actual\" + actual;\n+            org.junit.jupiter.api.Assertions.assertEquals(expected.x(), actual.x(), error, errorMessageSupplier);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2dfb4dfddd8a9442d358b5dc382b91ee825a2e"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9ce35eca4302ed9c2332386d0a374380bd988cd", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/b9ce35eca4302ed9c2332386d0a374380bd988cd", "committedDate": "2020-08-31T16:34:18Z", "message": "clean up code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "530f03e16b857ef72a08eb71526b833b5bdaaa0f", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/530f03e16b857ef72a08eb71526b833b5bdaaa0f", "committedDate": "2020-08-31T16:37:01Z", "message": "clean up terassert"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NDQyMjA3", "url": "https://github.com/MovingBlocks/Terasology/pull/4051#pullrequestreview-479442207", "createdAt": "2020-09-01T06:44:14Z", "commit": {"oid": "530f03e16b857ef72a08eb71526b833b5bdaaa0f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1354, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}