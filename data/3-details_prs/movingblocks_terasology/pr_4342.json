{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1OTEyNjIz", "number": 4342, "title": "build: save build time by not checking jcenter for terasology dependencies", "bodyText": "This removes unnecessary repositories from common.gradle\nand changes the configuration so gradle does not look in jcenter for any org.terasology dependency.\nHow to test\nI was using gradlew :modules:JoshariasSurvival:clean game --refresh-dependencies --scan (with JoshariasSurvival as the only module source checked out in modules/, so gradle has to get all the dependencies from remote instead of local subprojects).\nIt's not quite sufficient as a test of how long things take with an empty cache, because gradle has cached some stuff somewhere that is not reset by --refresh-dependencies.\nOne place where the difference is clear is on the build scan under the Performance / Network Activity tab. Before this change, there were a lot more requests to jcenter for all the modules that aren't there, which it then had to repeat and fail on maven central before getting to our artifactory.\nThis is a performance optimization for something I'm not sure anyone asked to be optimized, so treat it with some skepticism while reviewing it!", "createdAt": "2020-12-28T04:24:30Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4342", "merged": true, "mergeCommit": {"oid": "211bea31765ba8994ce4e02677b7edb37443b806"}, "closed": true, "closedAt": "2020-12-28T14:07:14Z", "author": {"login": "keturn"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqeIgjAH2gAyNTQ1OTEyNjIzOjJlNDJjMDlhNmE3MWNmNzg1NzczOTAxZGUxMmI5ZmM4MGZlYTY0NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdqmWzKgH2gAyNTQ1OTEyNjIzOjM0ODhkMGY0MDQ5NzRmYzMzMjkwODNlYzU5OTVhOTJiMjA4OTJmNGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e42c09a6a71cf785773901de12b9fc80fea6451", "author": {"user": {"login": "keturn", "name": "Kevin Turner"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/2e42c09a6a71cf785773901de12b9fc80fea6451", "committedDate": "2020-12-28T04:08:30Z", "message": "chore (build): remove old snowplow repo\n\nall our branches have had version >= 0.9 for a while now so this should be okay."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3bfef0121ad57d951dd8840bf3e6be4dd5d3e6e", "author": {"user": {"login": "keturn", "name": "Kevin Turner"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/c3bfef0121ad57d951dd8840bf3e6be4dd5d3e6e", "committedDate": "2020-12-28T04:12:20Z", "message": "perf (build): don't ask jcenter for org.terasology dependencies\n\nthis is an optimization to save a bunch of failed lookups while resolving the module dependency tree."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MTQ4NjU2", "url": "https://github.com/MovingBlocks/Terasology/pull/4342#pullrequestreview-559148656", "createdAt": "2020-12-28T13:39:26Z", "commit": {"oid": "c3bfef0121ad57d951dd8840bf3e6be4dd5d3e6e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMzozOToyN1rOIL5wBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxMzozOToyN1rOIL5wBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM1MTQyOQ==", "bodyText": "This change looks reasonable to me, and the comment explains well what is happening here.", "url": "https://github.com/MovingBlocks/Terasology/pull/4342#discussion_r549351429", "createdAt": "2020-12-28T13:39:27Z", "author": {"login": "skaldarnar"}, "path": "config/gradle/common.gradle", "diffHunk": "@@ -27,9 +27,16 @@ tasks.withType(JavaCompile) {\n \n // We use both Maven Central and our own Artifactory instance, which contains module builds, extra libs, and so on\n repositories {\n-    // External libs - jcenter is Bintray and is supposed to be a superset of Maven Central, but do both just in case\n-    jcenter()\n-    mavenCentral()\n+    // External libs - jcenter is Bintray and a superset of Maven Central\n+    jcenter {\n+        content {\n+            // This is first choice for most java dependencies, but assume we'll need to check our\n+            // own repository for things from our own organization.\n+            // (This is an optimization so gradle doesn't try to find our hundreds of modules\n+            // in jcenter.)\n+            excludeGroupByRegex(/org\\.terasology(\\..+)?/)\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3bfef0121ad57d951dd8840bf3e6be4dd5d3e6e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3488d0f404974fc3329083ec5995a92b20892f4f", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/3488d0f404974fc3329083ec5995a92b20892f4f", "committedDate": "2020-12-28T13:43:21Z", "message": "Merge branch 'develop' into perf/our-repository"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1235, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}