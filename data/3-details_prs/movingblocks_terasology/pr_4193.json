{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTY4Mjc4", "number": 4193, "title": "feat(JOML): migrate BlockItemSystem and Physics#scanArea", "bodyText": "here is some work on migrating aabb for physics along with some effort to migrate BlockItemSystem.", "createdAt": "2020-10-11T16:44:34Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4193", "merged": true, "mergeCommit": {"oid": "8f3bd76ed39eb5125b6de3958bca461b4c2e201d"}, "closed": true, "closedAt": "2020-10-31T10:30:30Z", "author": {"login": "pollend"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRxkwxgFqTUwNjUwMDE1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdX1uvfgFqTUyMTExODQyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTAwMTU5", "url": "https://github.com/MovingBlocks/Terasology/pull/4193#pullrequestreview-506500159", "createdAt": "2020-10-12T10:36:08Z", "commit": {"oid": "541b46e3cff8bd92623245183a2f82b48503e206"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMDozNjowOFrOHf5B1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMDozODoyN1rOHf5GUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIwMjI2Mw==", "bodyText": "Seems there must be -=", "url": "https://github.com/MovingBlocks/Terasology/pull/4193#discussion_r503202263", "createdAt": "2020-10-12T10:36:08Z", "author": {"login": "DarkWeird"}, "path": "engine/src/main/java/org/terasology/world/block/items/BlockItemSystem.java", "diffHunk": "@@ -189,30 +190,33 @@ private boolean canPlaceBlock(Block block, Vector3i targetBlock, Vector3i blockP\n         // Prevent players from placing blocks inside their bounding boxes\n         if (!block.isPenetrable()) {\n             Physics physics = CoreRegistry.get(Physics.class);\n-            AABB blockBounds = block.getBounds(blockPos);\n-            Vector3f min = new Vector3f(blockBounds.getMin());\n-            Vector3f max = new Vector3f(blockBounds.getMax());\n+            AABBf blockBounds = JomlUtil.from(block.getBounds(JomlUtil.from(blockPos)));\n \n             /**\n              * Characters can enter other solid objects/blocks for certain amount. This is does to detect collsion\n              * start and end without noise. So if the user walked as close to a block as possible it is only natural\n              * to let it place a block exactly above it even if that technically would mean a collision start.\n              */\n-            min.x += KinematicCharacterMover.HORIZONTAL_PENETRATION;\n-            max.x -= KinematicCharacterMover.HORIZONTAL_PENETRATION;\n-            min.y += KinematicCharacterMover.VERTICAL_PENETRATION;\n-            max.y -= KinematicCharacterMover.VERTICAL_PENETRATION;\n-            min.z += KinematicCharacterMover.HORIZONTAL_PENETRATION;\n-            max.z -= KinematicCharacterMover.HORIZONTAL_PENETRATION;\n+            blockBounds.minX += KinematicCharacterMover.HORIZONTAL_PENETRATION;\n+            blockBounds.maxX -= KinematicCharacterMover.HORIZONTAL_PENETRATION;\n+            blockBounds.minY += KinematicCharacterMover.VERTICAL_PENETRATION;\n+            blockBounds.maxY -= KinematicCharacterMover.VERTICAL_PENETRATION;\n+            blockBounds.minZ += KinematicCharacterMover.HORIZONTAL_PENETRATION;\n+            blockBounds.maxZ -= KinematicCharacterMover.HORIZONTAL_PENETRATION;\n \n             /*\n              * Calculations aren't exact and in the corner cases it is better to let the user place the block.\n              */\n-            min.add(ADDITIONAL_ALLOWED_PENETRATION, ADDITIONAL_ALLOWED_PENETRATION, ADDITIONAL_ALLOWED_PENETRATION);\n-            max.sub(ADDITIONAL_ALLOWED_PENETRATION, ADDITIONAL_ALLOWED_PENETRATION, ADDITIONAL_ALLOWED_PENETRATION);\n+            blockBounds.minX += ADDITIONAL_ALLOWED_PENETRATION;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "541b46e3cff8bd92623245183a2f82b48503e206"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIwMzQxMA==", "bodyText": "Duplication with old method.", "url": "https://github.com/MovingBlocks/Terasology/pull/4193#discussion_r503203410", "createdAt": "2020-10-12T10:38:27Z", "author": {"login": "DarkWeird"}, "path": "engine/src/main/java/org/terasology/physics/bullet/BulletPhysics.java", "diffHunk": "@@ -200,6 +206,30 @@ public short combineGroups(Iterable<CollisionGroup> groups) {\n         return result;\n     }\n \n+    @Override\n+    public List<EntityRef> scanArea(AABBf area, Iterable<CollisionGroup> collisionFilter) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "541b46e3cff8bd92623245183a2f82b48503e206"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0Nzg4NzU0", "url": "https://github.com/MovingBlocks/Terasology/pull/4193#pullrequestreview-514788754", "createdAt": "2020-10-22T14:27:13Z", "commit": {"oid": "bfdcd24db412de1592ff251159d6c44991387237"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9c293ba1f7da13a73c396ab77f235270aff310d", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/d9c293ba1f7da13a73c396ab77f235270aff310d", "committedDate": "2020-10-26T02:33:37Z", "message": "feat(JOML): migrate BlockItemSystem and Physics#scanArea"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63074684537db005f40d93d797ffa2542c3f1e11", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/63074684537db005f40d93d797ffa2542c3f1e11", "committedDate": "2020-10-26T02:33:37Z", "message": "cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bfdcd24db412de1592ff251159d6c44991387237", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/bfdcd24db412de1592ff251159d6c44991387237", "committedDate": "2020-10-16T04:50:20Z", "message": "cleanup"}, "afterCommit": {"oid": "63074684537db005f40d93d797ffa2542c3f1e11", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/63074684537db005f40d93d797ffa2542c3f1e11", "committedDate": "2020-10-26T02:33:37Z", "message": "cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a1f53c3c735c1e6d91e776b906ea1ce253af8ce", "author": {"user": {"login": "DarkWeird", "name": "Nail Khanipov"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/9a1f53c3c735c1e6d91e776b906ea1ce253af8ce", "committedDate": "2020-10-31T06:52:14Z", "message": "Merge branch 'develop' into feat/joml-migrate-blockitem-system"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMTE4NDIx", "url": "https://github.com/MovingBlocks/Terasology/pull/4193#pullrequestreview-521118421", "createdAt": "2020-10-31T06:53:31Z", "commit": {"oid": "9a1f53c3c735c1e6d91e776b906ea1ce253af8ce"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1256, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}