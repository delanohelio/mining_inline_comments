{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NDQzMTA4", "number": 4269, "title": "Drop creation of unnecessary array on new chunk event", "bodyText": "Contains\nOptimization - There seems to be unnecessary creation of array for each call of new chunk methods.\nWhile it's just 130kB of data per call and GC should be able to clean it simply with next call, coping there seems be not necessary. This could lead to spikes of memory use and slight delay when lot of new chunks is processed.\nMy experience with project is limited. There might be some reason to use array if getBlock must be called by Z-axis first, but I didn't recognize it.\nHow to test\nCheck if chunks are loaded properly and at the same speed (or faster).", "createdAt": "2020-11-24T12:25:34Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4269", "merged": true, "mergeCommit": {"oid": "ff21e61b1c7a94379078c11b12945a2890219983"}, "closed": true, "closedAt": "2020-11-25T07:22:20Z", "author": {"login": "hajdam"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfoZwCgH2gAyNTI2NDQzMTA4OmIyNDM4NzU1YTg5Zjk1ZjcxNjM2ODM5NGEyMmU0ZjBiNWZkNjViYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdf2durAFqTUzODE0NTEwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b2438755a89f95f716368394a22e4f0b5fd65bbc", "author": {"user": {"login": "hajdam", "name": "Miroslav Hajda"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/b2438755a89f95f716368394a22e4f0b5fd65bbc", "committedDate": "2020-11-24T11:53:13Z", "message": "Drop creation of unnecessary array on new chunk event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325", "author": {"user": {"login": "hajdam", "name": "Miroslav Hajda"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/1f0c96e6828828718abab53af5a34ee1dbfb7325", "committedDate": "2020-11-24T12:26:08Z", "message": "Merge branch 'develop' into develop-hajdam"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NTUxMDAx", "url": "https://github.com/MovingBlocks/Terasology/pull/4269#pullrequestreview-537551001", "createdAt": "2020-11-24T14:33:34Z", "commit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzE3NzI5", "url": "https://github.com/MovingBlocks/Terasology/pull/4269#pullrequestreview-537717729", "createdAt": "2020-11-24T16:55:06Z", "commit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzcxNjYx", "url": "https://github.com/MovingBlocks/Terasology/pull/4269#pullrequestreview-537771661", "createdAt": "2020-11-24T17:59:00Z", "commit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNzo1OTowMVrOH5Ouzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNzo1OTowMVrOH5Ouzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc3MjIzOQ==", "bodyText": "What is the reason the order here changed from x, y, z to z, x, y?", "url": "https://github.com/MovingBlocks/Terasology/pull/4269#discussion_r529772239", "createdAt": "2020-11-24T17:59:01Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/physics/engine/VoxelLiquidWorldSystem.java", "diffHunk": "@@ -146,20 +146,15 @@ public void onNewChunk(OnChunkLoaded chunkAvailable, EntityRef worldEntity) {\n         ByteBuffer buffer =\n             ByteBuffer.allocateDirect(2 * (ChunkConstants.SIZE_X * ChunkConstants.SIZE_Y * ChunkConstants.SIZE_Z));\n         buffer.order(ByteOrder.nativeOrder());\n-        short[] entries = new short[ChunkConstants.SIZE_X * ChunkConstants.SIZE_Y * ChunkConstants.SIZE_Z];\n-        for (int x = 0; x < ChunkConstants.SIZE_X; x++) {\n-            for (int y = 0; y < ChunkConstants.SIZE_Y; y++) {\n-                for (int z = 0; z < ChunkConstants.SIZE_Z; z++) {\n-                    int index = (z * ChunkConstants.SIZE_X * ChunkConstants.SIZE_Y) + (x * ChunkConstants.SIZE_Y) + y;\n+        for (int z = 0; z < ChunkConstants.SIZE_Z; z++) {\n+            for (int x = 0; x < ChunkConstants.SIZE_X; x++) {\n+                for (int y = 0; y < ChunkConstants.SIZE_Y; y++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MTQ1MTA4", "url": "https://github.com/MovingBlocks/Terasology/pull/4269#pullrequestreview-538145108", "createdAt": "2020-11-25T04:16:14Z", "commit": {"oid": "1f0c96e6828828718abab53af5a34ee1dbfb7325"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1318, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}