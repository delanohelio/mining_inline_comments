{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MDQ4MzI4", "number": 3962, "title": "remove ConcurrentMapChunkCache", "bodyText": "I removed the ConcurrentMapChunkCache since it just seems to just wrap a map unless we have some plans to support different types of cache. the other thing we can do is Also use the same implementation for the RemoteChunkProvider since that implementation also uses a chunkCache and that just uses a Maps.newHashMap(). At the moment there doesn't really seem to be a need to implement more then one type of cache.\nFor chunkFinalizer I removed the instance that gets passed in at startup and just grab an instance out of the Supplier. when purgeWorld is called; this will trigger another instance from the Supplier. this would make sense since the only other instance just declares new LightMergingChunkFinalizer and LightMergingChunkFinalizer::new.", "createdAt": "2020-05-17T01:55:55Z", "url": "https://github.com/MovingBlocks/Terasology/pull/3962", "merged": true, "mergeCommit": {"oid": "a829df4c8802441c66078b00cb1f3f9f9ef4b6ad"}, "closed": true, "closedAt": "2020-10-15T05:14:21Z", "author": {"login": "pollend"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSjFMEgFqTUwODY5MTMxNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSqqbvAFqTUwODk0MDUzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NjkxMzE0", "url": "https://github.com/MovingBlocks/Terasology/pull/3962#pullrequestreview-508691314", "createdAt": "2020-10-14T20:10:32Z", "commit": {"oid": "a7d77d3c56dfd36cdc901ce0ed481635a53e8feb"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMDoxMDozMlrOHhjTYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMDoxOToyNlrOHhjlfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk0MzQ1OQ==", "bodyText": "I guess this needs to be JOML-ified now?", "url": "https://github.com/MovingBlocks/Terasology/pull/3962#discussion_r504943459", "createdAt": "2020-10-14T20:10:32Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/chunks/localChunkProvider/LocalChunkProvider.java", "diffHunk": "@@ -112,38 +111,23 @@\n \n     private BlockManager blockManager;\n     private ExtraBlockDataManager extraDataManager;\n-    private final ChunkCache chunkCache;\n-    private final Supplier<ChunkFinalizer> chunkFinalizerSupplier;\n+    private final Map<Vector3i, Chunk> chunkCache = Maps.newConcurrentMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7d77d3c56dfd36cdc901ce0ed481635a53e8feb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk0NzE0Nw==", "bodyText": "when is the \"end of the chunk overhaul\"? \ud83e\udd14", "url": "https://github.com/MovingBlocks/Terasology/pull/3962#discussion_r504947147", "createdAt": "2020-10-14T20:17:43Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/chunks/localChunkProvider/LocalChunkProvider.java", "diffHunk": "@@ -112,38 +111,23 @@\n \n     private BlockManager blockManager;\n     private ExtraBlockDataManager extraDataManager;\n-    private final ChunkCache chunkCache;\n-    private final Supplier<ChunkFinalizer> chunkFinalizerSupplier;\n+    private final Map<Vector3i, Chunk> chunkCache = Maps.newConcurrentMap();\n     private BlockEntityRegistry registry;\n \n+    //TODO: Michael Pollind -- if we have more then one finalizer use  Supplier<ChunkFinalizer[]> and ChunkFinalizer[]\n+    private final Supplier<ChunkFinalizer> chunkFinalizerSupplier;\n     private ChunkFinalizer chunkFinalizer;\n \n-    //TODO Remove this old constructor at the end of the chunk overhaul", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7d77d3c56dfd36cdc901ce0ed481635a53e8feb"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk0ODA5Mg==", "bodyText": "What do we need to store the supplier as member here? When is it used?", "url": "https://github.com/MovingBlocks/Terasology/pull/3962#discussion_r504948092", "createdAt": "2020-10-14T20:19:26Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/chunks/localChunkProvider/LocalChunkProvider.java", "diffHunk": "@@ -112,38 +111,23 @@\n \n     private BlockManager blockManager;\n     private ExtraBlockDataManager extraDataManager;\n-    private final ChunkCache chunkCache;\n-    private final Supplier<ChunkFinalizer> chunkFinalizerSupplier;\n+    private final Map<Vector3i, Chunk> chunkCache = Maps.newConcurrentMap();\n     private BlockEntityRegistry registry;\n \n+    //TODO: Michael Pollind -- if we have more then one finalizer use  Supplier<ChunkFinalizer[]> and ChunkFinalizer[]\n+    private final Supplier<ChunkFinalizer> chunkFinalizerSupplier;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7d77d3c56dfd36cdc901ce0ed481635a53e8feb"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "193d44f5670535b0245c90814dc7b56ed655c05f", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/193d44f5670535b0245c90814dc7b56ed655c05f", "committedDate": "2020-10-15T04:35:41Z", "message": "remove ConcurrentMapChunkCache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a7d77d3c56dfd36cdc901ce0ed481635a53e8feb", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/a7d77d3c56dfd36cdc901ce0ed481635a53e8feb", "committedDate": "2020-05-17T02:04:30Z", "message": "removed extra spaces"}, "afterCommit": {"oid": "193d44f5670535b0245c90814dc7b56ed655c05f", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/193d44f5670535b0245c90814dc7b56ed655c05f", "committedDate": "2020-10-15T04:35:41Z", "message": "remove ConcurrentMapChunkCache"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4OTQwNTM4", "url": "https://github.com/MovingBlocks/Terasology/pull/3962#pullrequestreview-508940538", "createdAt": "2020-10-15T05:10:14Z", "commit": {"oid": "193d44f5670535b0245c90814dc7b56ed655c05f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1539, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}