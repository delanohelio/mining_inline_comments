{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NTQ2ODkw", "number": 4059, "title": "Improve Simplex and Perlin noise generators", "bodyText": "Contains\nMore control on Simplex and Perlin noise generators, Adds Docs to use them as Tileable noise generators\nHow to test\nRun these two branches of the module I made for testing, use the world generator by the name of \"oki\" in game\nhttps://github.com/sin3point14/WorldGenTesting/tree/simplex-test\nhttps://github.com/sin3point14/WorldGenTesting/tree/perlin-test\nYou should see flanked mountains like this\n\nthe \"flankiness\" will be controllable by changing SurfaceProvider.gridSize in the module", "createdAt": "2020-06-21T13:40:12Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4059", "merged": true, "mergeCommit": {"oid": "b9001dabdc2ced69a18db6cb33e0ae2d9d22bedd"}, "closed": true, "closedAt": "2020-06-27T02:05:26Z", "author": {"login": "sin3point14"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnwIndgH2gAyNDM3NTQ2ODkwOmQwMGMyZTczNGYwNjdmNzUxNDE3MWQ2MzJmNDgwMzRiMWNjYzI0ZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuSw9bAFqTQzNjMyNDA0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d00c2e734f067f7514171d632f48034b1ccc24ee", "author": {"user": null}, "url": "https://github.com/MovingBlocks/Terasology/commit/d00c2e734f067f7514171d632f48034b1ccc24ee", "committedDate": "2020-06-03T21:13:59Z", "message": "modified simplex, perlin to allow variable perms"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "367d3102d45756ef5192309db47e732ae6c4df76", "author": {"user": null}, "url": "https://github.com/MovingBlocks/Terasology/commit/367d3102d45756ef5192309db47e732ae6c4df76", "committedDate": "2020-06-04T18:29:37Z", "message": "Merge branch 'develop' of github.com:MovingBlocks/Terasology into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07cc660c43ff75b34caf122d146c318b8765e1fe", "author": {"user": null}, "url": "https://github.com/MovingBlocks/Terasology/commit/07cc660c43ff75b34caf122d146c318b8765e1fe", "committedDate": "2020-06-04T21:04:53Z", "message": "Merge branch 'develop' of github.com:MovingBlocks/Terasology into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00c1881f661e80fba4f36252e65aab337fd17eb1", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/00c1881f661e80fba4f36252e65aab337fd17eb1", "committedDate": "2020-06-17T17:16:07Z", "message": "perlin noise tileable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/38aced9bdffe71da3f83e3a6a50ec712436a40dd", "committedDate": "2020-06-21T12:51:10Z", "message": "add tileable noise support, docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTE0NzE3", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#pullrequestreview-434514717", "createdAt": "2020-06-21T16:22:40Z", "commit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxNjoyMjo0MFrOGms6wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxNjozMDo0OFrOGms9QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTAwOA==", "bodyText": "@keturn we'll see more and more of these unrelated changes, right? Ultimate vs Community edition, as well as plugins installed in addition to the recommended ones will add to these files if I get it right... \ud83d\ude44", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235008", "createdAt": "2020-06-21T16:22:40Z", "author": {"login": "skaldarnar"}, "path": ".idea/misc.xml", "diffHunk": "@@ -12,5 +12,11 @@\n     </writeAnnotations>\n   </component>\n   <component name=\"ExternalStorageConfigurationManager\" enabled=\"true\" />\n+  <component name=\"FrameworkDetectionExcludesConfiguration\">\n+    <file type=\"web\" url=\"file://$PROJECT_DIR$\" />\n+  </component>\n+  <component name=\"JavaScriptSettings\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTI0Mw==", "bodyText": "Is there a specific reason for writing 1 << 8 instead of 256? Is the grid dimension required to be a power of 2?", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235243", "createdAt": "2020-06-21T16:25:30Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/PerlinNoise.java", "diffHunk": "@@ -27,38 +27,50 @@\n public class PerlinNoise extends AbstractNoise implements Noise2D, Noise3D {\n \n     private final int[] noisePermutations;\n+    private final int permCount;\n \n     /**\n      * Init. a new generator with a given seed value.\n      *\n      * @param seed The seed value\n      */\n     public PerlinNoise(long seed) {\n+        this(seed, 1 << 8);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTQzMw==", "bodyText": "Why do we floor two times here, or what exactly does floorMod do?", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235433", "createdAt": "2020-06-21T16:28:11Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/PerlinNoise.java", "diffHunk": "@@ -71,9 +83,9 @@ public PerlinNoise(long seed) {\n      */\n     @Override\n     public float noise(float posX, float posY, float posZ) {\n-        int xInt = (int) TeraMath.fastFloor(posX) & 255;\n-        int yInt = (int) TeraMath.fastFloor(posY) & 255;\n-        int zInt = (int) TeraMath.fastFloor(posZ) & 255;\n+        int xInt = Math.floorMod((int) TeraMath.fastFloor(posX), permCount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTQ5Mw==", "bodyText": "Typo\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public SimplexNoise(long seed, int girdDim) {\n          \n          \n            \n                public SimplexNoise(long seed, int gridDim) {", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235493", "createdAt": "2020-06-21T16:29:07Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/SimplexNoise.java", "diffHunk": "@@ -62,42 +62,57 @@\n     private static final float F4 = ((float) Math.sqrt(5.0f) - 1.0f) / 4.0f;\n     private static final float G4 = (5.0f - (float) Math.sqrt(5.0f)) / 20.0f;\n \n-    private final short[] perm = new short[512];\n-    private final short[] permMod12 = new short[512];\n+    private final short[] perm;\n+    private final short[] permMod12;\n+    private final int permCount;\n \n     /**\n-     * Initialize permutations with a given seed\n+     * Multiply this with the gridDim provided and noise(x,x) will give tileable 1D noise which will tile\n+     * when x crosses a multiple of (this * gridDim)\n+     */\n+    public final float tileable1DMagicNumber = 0.5773502691896258f;\n+\n+    /**\n+     * Initialize permutations with a given seed and grid dimension.\n+     * Supports 1D tileable noise\n+     * @see SimplexNoise#tileable1DMagicNumber\n      *\n      * @param seed a seed value used for permutation shuffling\n+     * @param gridDim gridDim x gridDim will be the number of squares in the square grid formed after skewing the simplices belonging to once \"tile\"\n      */\n     public SimplexNoise(long seed) {\n+        this(seed, 8);\n+    }\n+\n+    public SimplexNoise(long seed, int girdDim) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTUyNw==", "bodyText": "Why does Perlin noise have a grid dimension of 1 << 8 and Simplex noise a grid dimension of 8?", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235527", "createdAt": "2020-06-21T16:29:38Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/SimplexNoise.java", "diffHunk": "@@ -62,42 +62,57 @@\n     private static final float F4 = ((float) Math.sqrt(5.0f) - 1.0f) / 4.0f;\n     private static final float G4 = (5.0f - (float) Math.sqrt(5.0f)) / 20.0f;\n \n-    private final short[] perm = new short[512];\n-    private final short[] permMod12 = new short[512];\n+    private final short[] perm;\n+    private final short[] permMod12;\n+    private final int permCount;\n \n     /**\n-     * Initialize permutations with a given seed\n+     * Multiply this with the gridDim provided and noise(x,x) will give tileable 1D noise which will tile\n+     * when x crosses a multiple of (this * gridDim)\n+     */\n+    public final float tileable1DMagicNumber = 0.5773502691896258f;\n+\n+    /**\n+     * Initialize permutations with a given seed and grid dimension.\n+     * Supports 1D tileable noise\n+     * @see SimplexNoise#tileable1DMagicNumber\n      *\n      * @param seed a seed value used for permutation shuffling\n+     * @param gridDim gridDim x gridDim will be the number of squares in the square grid formed after skewing the simplices belonging to once \"tile\"\n      */\n     public SimplexNoise(long seed) {\n+        this(seed, 8);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTY0OQ==", "bodyText": "In the Perlin implementation you did some combination of floorMod and floor  - why is a simple modulo operation sufficient here, and why is it not sufficient in Perlin implementation?", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443235649", "createdAt": "2020-06-21T16:30:48Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/utilities/procedural/SimplexNoise.java", "diffHunk": "@@ -154,8 +169,8 @@ public float noise(float xin, float yin) {\n         float y2 = y0 - 1.0f + 2.0f * G2;\n \n         // Work out the hashed gradient indices of the three simplex corners\n-        int ii = i & 255;\n-        int jj = j & 255;\n+        int ii = i % permCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38aced9bdffe71da3f83e3a6a50ec712436a40dd"}, "originalPosition": 77}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e0ffa140e15051004a1f74c31d160c962121517", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/1e0ffa140e15051004a1f74c31d160c962121517", "committedDate": "2020-06-21T19:37:57Z", "message": "typo fixes, incorrect modulo operator usage fixed"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "377b1bf652180a79ce8b686fd260c3488608c36b", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/377b1bf652180a79ce8b686fd260c3488608c36b", "committedDate": "2020-06-21T19:30:56Z", "message": "typo fixes, incorrect modulo operator usage fixed"}, "afterCommit": {"oid": "1e0ffa140e15051004a1f74c31d160c962121517", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/1e0ffa140e15051004a1f74c31d160c962121517", "committedDate": "2020-06-21T19:37:57Z", "message": "typo fixes, incorrect modulo operator usage fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTQxOTg4", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#pullrequestreview-434541988", "createdAt": "2020-06-21T23:30:17Z", "commit": {"oid": "1e0ffa140e15051004a1f74c31d160c962121517"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQyMzozMDoxN1rOGmu4sQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQyMzozMDoxN1rOGmu4sQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI2NzI0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              <component name=\"FrameworkDetectionExcludesConfiguration\">\n          \n          \n            \n                <file type=\"web\" url=\"file://$PROJECT_DIR$\" />\n          \n          \n            \n              </component>\n          \n          \n            \n              <component name=\"JavaScriptSettings\">\n          \n          \n            \n                <option name=\"languageLevel\" value=\"ES6\" />\n          \n          \n            \n              </component>", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#discussion_r443267249", "createdAt": "2020-06-21T23:30:17Z", "author": {"login": "pollend"}, "path": ".idea/misc.xml", "diffHunk": "@@ -12,5 +12,11 @@\n     </writeAnnotations>\n   </component>\n   <component name=\"ExternalStorageConfigurationManager\" enabled=\"true\" />\n+  <component name=\"FrameworkDetectionExcludesConfiguration\">\n+    <file type=\"web\" url=\"file://$PROJECT_DIR$\" />\n+  </component>\n+  <component name=\"JavaScriptSettings\">\n+    <option name=\"languageLevel\" value=\"ES6\" />\n+  </component>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e0ffa140e15051004a1f74c31d160c962121517"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f20386cde63a68d841e877d41e4ce595ce8260d6", "author": {"user": {"login": "sin3point14", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/f20386cde63a68d841e877d41e4ce595ce8260d6", "committedDate": "2020-06-24T04:35:06Z", "message": "Update .idea/misc.xml\n\nCo-authored-by: Michael Pollind <mpollind@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MzI0MDQ2", "url": "https://github.com/MovingBlocks/Terasology/pull/4059#pullrequestreview-436324046", "createdAt": "2020-06-24T04:58:22Z", "commit": {"oid": "f20386cde63a68d841e877d41e4ce595ce8260d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1357, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}