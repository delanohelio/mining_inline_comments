{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NzgzOTQ4", "number": 4272, "title": "feat(BlockRegion): add BlockRegion helpers", "bodyText": "Changes\n\nadd createFromMinAndMax and createFromCenterAndExtents helpers\ndeprecate BlockRegion constructors from min and max in favor of new helpers\nadd tests for BlockRegion and BlockRegionIterable\nadd helper methods to create iterables for BlockRegions\n\nModule PRs\n\nTerasology/DynamicCities#73\nTerasology/ClimateConditions#38\nTerasology/StructureTemplates#47\nTerasology/CombatSystem#61\nTerasology/MetalRenegades#117\n\n\nCo-authored-by: Tobias Nett skaldarnar@googlemail.com\nCo-authored-by: Michael Pollind mpollind@gmail.com", "createdAt": "2020-11-24T21:01:26Z", "url": "https://github.com/MovingBlocks/Terasology/pull/4272", "merged": true, "mergeCommit": {"oid": "5f2d0bd0b61d824f468ee82f78ba448ec3fed52d"}, "closed": true, "closedAt": "2020-11-29T00:23:30Z", "author": {"login": "jdrueckert"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfwNVrAH2gAyNTI2NzgzOTQ4OmQzZjM5ZDdjYzA0MDhiYjFjNzVmM2Q3YTMzODE0N2Y4MTBjMTViNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhFUDhAH2gAyNTI2NzgzOTQ4OmNiMGY5NTczZWRkY2I1M2Y5OTU0NTY3MmQwYjc5NGFmYjc2ZWM1NDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/d3f39d7cc0408bb1c75f3d7a338147f810c15b54", "committedDate": "2020-11-24T20:58:54Z", "message": "feat(BlockRegion): add BlockRegion helpers\n\n- adds `createFromMinAndMax` and `createFromCenterAndExtents` helpers\n- deprecate BlockRegion constructors from min and max in favor of new helpers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3OTM3NDI3", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#pullrequestreview-537937427", "createdAt": "2020-11-24T21:15:00Z", "commit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMToxNTowMFrOH5VbtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMToxNjo1MlrOH5Vf2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTg4MjAzNw==", "bodyText": "This changes the semantics of new BlockRegion() from being some invalid infinite something (the empty region, so to say) to the non-empty BlockRegion containing exactly (0,0,0).\nThis allows to express createFromCenterAndExtents conveniently via\nnew BlockRegion().translate(center).addExtents(extents)\nNot sure whether the previous semantics was used somewhere, or whether we need the empty region to be a thing. We could add that to BlockRegions:\npublic static BlockRegion empty() {\n  return new BlockRegion(new AABBi());\n}", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#discussion_r529882037", "createdAt": "2020-11-24T21:15:00Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/block/BlockRegion.java", "diffHunk": "@@ -44,6 +44,7 @@\n     public final AABBi aabb = new AABBi();\n \n     public BlockRegion() {\n+        this.setMin(0, 0, 0).setMax(0, 0, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTg4MzA5OA==", "bodyText": "(copying from Discord for the record)\nI think it is somewhat confusing to have some variants as constructor new BlockRegion(min, max) and some as constructor method BlockRegions.createFromCenterAndExtents(center, extents). Especially if another variant like BlockRegions.createFromMinAndSize(min, size) has the same argument types...\nMost of the implementations are pretty neat one-liners which may be inlined instead. For consistency I'd also inline the two constructor variants that were deprecated.\nOnly culprit we found is create a BlockRegion from center and extents when given floating point coordinates. One needs to be careful with rounding in that case...\n    public static BlockRegion createFromCenterAndExtents(Vector3fc center, Vector3fc extents) {\n        Vector3f min = center.sub(extents, new Vector3f());\n        Vector3f max = center.add(extents, new Vector3f());\n\n        return new BlockRegion().setMin(new Vector3i(min, RoundingMode.CEILING)).setMax(new Vector3i(max,\n                RoundingMode.FLOOR));\n    }", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#discussion_r529883098", "createdAt": "2020-11-24T21:16:52Z", "author": {"login": "skaldarnar"}, "path": "engine/src/main/java/org/terasology/world/block/BlockRegion.java", "diffHunk": "@@ -54,10 +55,18 @@ public BlockRegion(AABBi source) {\n         aabb.set(source);\n     }\n \n+    /**\n+     * Deprecated in favor of {@link org.terasology.world.block.BlockRegions#createFromMinAndMax(Vector3ic, Vector3ic)}\n+     */\n+    @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MTM4NTY1", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#pullrequestreview-538138565", "createdAt": "2020-11-25T03:54:59Z", "commit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMzo1NTowMFrOH5iO2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMzo1NTowMFrOH5iO2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA5MTczOA==", "bodyText": "for the min you also want to floor the value.\nif your min is (.001,.001,.001) ceiling would be (1,1,1) which would be one block extra. .001 would be within (0,0,0)", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#discussion_r530091738", "createdAt": "2020-11-25T03:55:00Z", "author": {"login": "pollend"}, "path": "engine/src/main/java/org/terasology/world/block/BlockRegions.java", "diffHunk": "@@ -0,0 +1,59 @@\n+// Copyright 2020 The Terasology Foundation\n+// SPDX-License-Identifier: Apache-2.0\n+\n+package org.terasology.world.block;\n+\n+import org.joml.RoundingMode;\n+import org.joml.Vector3f;\n+import org.joml.Vector3fc;\n+import org.joml.Vector3i;\n+import org.joml.Vector3ic;\n+\n+public class BlockRegions {\n+    private BlockRegions() {\n+    }\n+\n+    /**\n+     * Creates a new region spanning the smallest axis-aligned bounding box (AABB) containing both, min and max\n+     *\n+     * @return new block region\n+     */\n+    public static BlockRegion createFromMinAndMax(Vector3ic min, Vector3ic max) {\n+        return new BlockRegion().setMin(min).setMax(max);\n+    }\n+\n+    /**\n+     * Creates a new region spanning the smallest axis-aligned bounding box (AABB) containing both, min and max\n+     *\n+     * @return new block region\n+     */\n+    public static BlockRegion createFromMinAndMax(int minX, int minY, int minZ, int maxX, int maxY, int maxZ) {\n+        return new BlockRegion().setMin(minX, minY, minZ).setMax(maxX, maxY, maxZ);\n+    }\n+\n+    /**\n+     * Creates a new region centered around {@code center} extending each side by {@code extents}. The resulting\n+     * axis-aligned bounding box (AABB) will have a size of {@code 2 * extents}\n+     *\n+     * @return new block region\n+     */\n+    public static BlockRegion createFromCenterAndExtents(Vector3ic center, Vector3ic extents) {\n+        return new BlockRegion().translate(center).addExtents(extents);\n+    }\n+\n+    /**\n+     * Creates a new region centered around {@code center} extending each side by {@code extents}. The computed min is\n+     * rounded up (ceil), the computed max is rounded down (floor). Thus, the resulting axis-aligned bounding box (AABB)\n+     * will only include integer points that are within the floating point area and have a size of {@code <= 2 *\n+     * extents}\n+     *\n+     * @return new block region\n+     */\n+    public static BlockRegion createFromCenterAndExtents(Vector3fc center, Vector3fc extents) {\n+        Vector3f min = center.sub(extents, new Vector3f());\n+        Vector3f max = center.add(extents, new Vector3f());\n+\n+        return new BlockRegion().setMin(new Vector3i(min, RoundingMode.CEILING)).setMax(new Vector3i(max,\n+                RoundingMode.FLOOR));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3f39d7cc0408bb1c75f3d7a338147f810c15b54"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0dac074cc6810b22d54f0b0c916e40650a3856d", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/f0dac074cc6810b22d54f0b0c916e40650a3856d", "committedDate": "2020-11-25T18:13:20Z", "message": "Merge branch 'develop' into feat/blockregion-helpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a98ecb944452ac9300870177e994dd1c2e362c7", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/4a98ecb944452ac9300870177e994dd1c2e362c7", "committedDate": "2020-11-28T16:42:53Z", "message": "test: Add tests for BlockRegionIterable (+ update copyright)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df3613860c86fdaea2f05eea0c22b933ceb5e5d5", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/df3613860c86fdaea2f05eea0c22b933ceb5e5d5", "committedDate": "2020-11-28T17:06:56Z", "message": "Merge remote-tracking branch 'origin/develop' into feat/blockregion-helpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "533ca85e1a781192577a634ad3ecedeb5ff9627a", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/533ca85e1a781192577a634ad3ecedeb5ff9627a", "committedDate": "2020-11-28T17:13:27Z", "message": "fix: fix condition in BlockRegionIterable#hasNext()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab7676aed9ebe8f14cb798215cb10901d06c406c", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/ab7676aed9ebe8f14cb798215cb10901d06c406c", "committedDate": "2020-11-28T17:31:31Z", "message": "test: more tests for actual content of positions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b930dd6fd61a99e3dd000d7688d75050b7c822d", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/7b930dd6fd61a99e3dd000d7688d75050b7c822d", "committedDate": "2020-11-28T17:37:34Z", "message": "test: adjust for \"correct\" usage of iterator..."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b8cce3195c20d73d766a13ce4dedfcbbcfdf660", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/6b8cce3195c20d73d766a13ce4dedfcbbcfdf660", "committedDate": "2020-11-28T18:09:08Z", "message": "update type handler and iterator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c3b0b375ea87d3a254f141cf8ff75f05c257ec9", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/9c3b0b375ea87d3a254f141cf8ff75f05c257ec9", "committedDate": "2020-11-28T18:41:56Z", "message": "tweak iterable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "718590cc666c9af447c60dcd6cac492c1ef43ebf", "author": {"user": {"login": "pollend", "name": "Michael Pollind"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/718590cc666c9af447c60dcd6cac492c1ef43ebf", "committedDate": "2020-11-28T18:49:12Z", "message": "delete discord.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4fca2cf82520f0fb9f5524ed59bf28cadb90e9c", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/c4fca2cf82520f0fb9f5524ed59bf28cadb90e9c", "committedDate": "2020-11-28T22:01:27Z", "message": "refactor: move iterable and iterableInPlace construction to BlockRegions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNDIwNDk0", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#pullrequestreview-540420494", "createdAt": "2020-11-28T22:10:47Z", "commit": {"oid": "c4fca2cf82520f0fb9f5524ed59bf28cadb90e9c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a850395f6f0d444d7c222b44e29d664e62f18d1", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/1a850395f6f0d444d7c222b44e29d664e62f18d1", "committedDate": "2020-11-28T22:31:01Z", "message": "test: add tests for BlockRegion#correctBounds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c507eaff5d8502f9c4f6322aef5337e803b75c56", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/c507eaff5d8502f9c4f6322aef5337e803b75c56", "committedDate": "2020-11-28T22:31:19Z", "message": "fix: compute BlockRegion#correctBounds correctly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a0b88e511c53079d5b089227d478851e21c8332", "author": {"user": {"login": "skaldarnar", "name": "Tobias Nett"}}, "url": "https://github.com/MovingBlocks/Terasology/commit/0a0b88e511c53079d5b089227d478851e21c8332", "committedDate": "2020-11-28T23:27:11Z", "message": "chore: small improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNDIzNzYy", "url": "https://github.com/MovingBlocks/Terasology/pull/4272#pullrequestreview-540423762", "createdAt": "2020-11-28T23:31:10Z", "commit": {"oid": "c507eaff5d8502f9c4f6322aef5337e803b75c56"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb0f9573eddcb53f99545672d0b794afb76ec547", "author": {"user": {"login": "jdrueckert", "name": null}}, "url": "https://github.com/MovingBlocks/Terasology/commit/cb0f9573eddcb53f99545672d0b794afb76ec547", "committedDate": "2020-11-29T00:08:10Z", "message": "Merge branch 'develop' into feat/blockregion-helpers"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1323, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}