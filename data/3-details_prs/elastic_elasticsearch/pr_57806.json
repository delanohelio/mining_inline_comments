{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMDY0MDM2", "number": 57806, "title": "[DOCS] Extends geo_shape query docs to explain behavior when data is indexed as array of shapes", "bodyText": "Overview\nThis PR extends the geo_shape query docs to explain what happens when data is indexed as an array of shapes.\nRelated issue: #47845\nPreview\nGeo_shape query docs", "createdAt": "2020-06-08T11:24:57Z", "url": "https://github.com/elastic/elasticsearch/pull/57806", "merged": true, "mergeCommit": {"oid": "d1e480e5bd292f703f72b560db89c550b00a84d2"}, "closed": true, "closedAt": "2020-06-08T13:04:00Z", "author": {"login": "szabosteve"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpOrRpgH2gAyNDMxMDY0MDM2OmI5OGVjOTdlOTM4NDU1NjBmYWJkOTU3NzI1MGYxYjJiZDM2N2JkNWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpP6eAgH2gAyNDMxMDY0MDM2OmE5OTA1ZTExZmI5Yzg2YzNiMGU0N2JmMTBiYzVlYzhiYWQ2ZWVhNzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b98ec97e93845560fabd9577250f1b2bd367bd5b", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/b98ec97e93845560fabd9577250f1b2bd367bd5b", "committedDate": "2020-06-08T11:22:55Z", "message": "[DOCS] Extends geo_shape query docs to explain behavior when data is indexed as array of shapes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02dcc64e9b5ed9b6b691fb19e42e77ee998dde7c", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/02dcc64e9b5ed9b6b691fb19e42e77ee998dde7c", "committedDate": "2020-06-08T11:59:12Z", "message": "[DOCS] Fixes JSON syntax."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f4612b279d055e11341395092746828f2bdacf5", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/7f4612b279d055e11341395092746828f2bdacf5", "committedDate": "2020-06-08T12:24:03Z", "message": "[DOC] Changes method."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTgyMDE1", "url": "https://github.com/elastic/elasticsearch/pull/57806#pullrequestreview-426182015", "createdAt": "2020-06-08T12:37:51Z", "commit": {"oid": "7f4612b279d055e11341395092746828f2bdacf5"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMjozNzo1MVrOGgbotQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMjozODo0MlrOGgbqig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDQwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The following query will find the point using the {es}'s `envelope` GeoJSON \n          \n          \n            \n            The following query will find the point using {es}'s `envelope` GeoJSON", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660405", "createdAt": "2020-06-08T12:37:51Z", "author": {"login": "jrodewig"}, "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -49,8 +51,9 @@ POST /example/_doc?refresh\n --------------------------------------------------\n // TESTSETUP\n \n-The following query will find the point using the Elasticsearch's\n-`envelope` GeoJSON extension:\n+\n+The following query will find the point using the {es}'s `envelope` GeoJSON ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f4612b279d055e11341395092746828f2bdacf5"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDgwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            shapes which are useful to your application and you want to reference this using \n          \n          \n            \n            shapes and you want to reference the list using", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660803", "createdAt": "2020-06-08T12:38:33Z", "author": {"login": "jrodewig"}, "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -161,19 +167,19 @@ GET /example_points/_search\n --------------------------------------------------\n // TESTRESPONSE[s/\"took\" : 17/\"took\" : $body.took/]\n \n+\n ==== Pre-Indexed Shape\n \n-The Query also supports using a shape which has already been indexed in\n-another index. This is particularly useful for when\n-you have a pre-defined list of shapes which are useful to your\n-application and you want to reference this using a logical name (for\n-example 'New Zealand') rather than having to provide their coordinates\n-each time. In this situation it is only necessary to provide:\n+The query also supports using a shape which has already been indexed in another \n+index. This is particularly useful for when you have a pre-defined list of \n+shapes which are useful to your application and you want to reference this using ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f4612b279d055e11341395092746828f2bdacf5"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDg3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            a logical name (for example 'New Zealand') rather than having to provide their \n          \n          \n            \n            a logical name (for example 'New Zealand') rather than having to provide", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660874", "createdAt": "2020-06-08T12:38:42Z", "author": {"login": "jrodewig"}, "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -161,19 +167,19 @@ GET /example_points/_search\n --------------------------------------------------\n // TESTRESPONSE[s/\"took\" : 17/\"took\" : $body.took/]\n \n+\n ==== Pre-Indexed Shape\n \n-The Query also supports using a shape which has already been indexed in\n-another index. This is particularly useful for when\n-you have a pre-defined list of shapes which are useful to your\n-application and you want to reference this using a logical name (for\n-example 'New Zealand') rather than having to provide their coordinates\n-each time. In this situation it is only necessary to provide:\n+The query also supports using a shape which has already been indexed in another \n+index. This is particularly useful for when you have a pre-defined list of \n+shapes which are useful to your application and you want to reference this using \n+a logical name (for example 'New Zealand') rather than having to provide their ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f4612b279d055e11341395092746828f2bdacf5"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f18a543f41299e45023dd1482aa041bb3ac3d7a0", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/f18a543f41299e45023dd1482aa041bb3ac3d7a0", "committedDate": "2020-06-08T12:41:49Z", "message": "Apply suggestions from code review\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTg5ODAw", "url": "https://github.com/elastic/elasticsearch/pull/57806#pullrequestreview-426189800", "createdAt": "2020-06-08T12:46:52Z", "commit": {"oid": "f18a543f41299e45023dd1482aa041bb3ac3d7a0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMjo0Njo1MlrOGgb83w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMjo0Njo1NlrOGgb8-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2NTU2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            PUT /test/doc1\n          \n          \n            \n            PUT /test/_doc/1", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436665567", "createdAt": "2020-06-08T12:46:52Z", "author": {"login": "jrodewig"}, "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -251,15 +261,55 @@ querying multiple indexes which might have different mappings. When set to\n `false` (the default value) the query will throw an exception if the field\n is not mapped.\n \n+\n ==== Shape Types supported for Geo-Point\n \n-When searching a field of type `geo_point` the following shape types are not supported:\n+When searching a field of type `geo_point` the following shape types are not \n+supported:\n \n * `POINT`\n * `LINE`\n * `MULTIPOINT`\n * `MULTILINE`\n \n ==== Notes\n-Geo-shape queries on geo-shapes implemented with <<prefix-trees, `PrefixTrees`>> will not be executed if\n-<<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set to false.\n+\n+* Geo-shape queries on geo-shapes implemented with \n+  <<prefix-trees, `PrefixTrees`>> will not be executed if \n+  <<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set \n+  to false.\n+\n+\n+* When data is indexed in a `geo_shape` field as an array of shapes, the arrays \n+  are treated as one shape. For this reason, the following requests are \n+  equivalent.\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1\n+{\n+  \"location\": [\n+    {\n+      \"coordinates\": [46.25,20.14],\n+      \"type\": \"point\"\n+    },\n+    {\n+      \"coordinates\": [47.49,19.04],\n+      \"type\": \"point\"\n+    }\n+  ]\n+}\n+--------------------------------------------------\n+\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f18a543f41299e45023dd1482aa041bb3ac3d7a0"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2NTU5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            PUT /test/doc1\n          \n          \n            \n            PUT /test/_doc/1", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436665593", "createdAt": "2020-06-08T12:46:56Z", "author": {"login": "jrodewig"}, "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -251,15 +261,55 @@ querying multiple indexes which might have different mappings. When set to\n `false` (the default value) the query will throw an exception if the field\n is not mapped.\n \n+\n ==== Shape Types supported for Geo-Point\n \n-When searching a field of type `geo_point` the following shape types are not supported:\n+When searching a field of type `geo_point` the following shape types are not \n+supported:\n \n * `POINT`\n * `LINE`\n * `MULTIPOINT`\n * `MULTILINE`\n \n ==== Notes\n-Geo-shape queries on geo-shapes implemented with <<prefix-trees, `PrefixTrees`>> will not be executed if\n-<<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set to false.\n+\n+* Geo-shape queries on geo-shapes implemented with \n+  <<prefix-trees, `PrefixTrees`>> will not be executed if \n+  <<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set \n+  to false.\n+\n+\n+* When data is indexed in a `geo_shape` field as an array of shapes, the arrays \n+  are treated as one shape. For this reason, the following requests are \n+  equivalent.\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f18a543f41299e45023dd1482aa041bb3ac3d7a0"}, "originalPosition": 153}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "251b6c0bbbde8aad7e134e2436126928d5f222a8", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/251b6c0bbbde8aad7e134e2436126928d5f222a8", "committedDate": "2020-06-08T12:49:17Z", "message": "Update docs/reference/query-dsl/geo-shape-query.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9905e11fb9c86c3b0e47bf10bc5ec8bad6eea76", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/a9905e11fb9c86c3b0e47bf10bc5ec8bad6eea76", "committedDate": "2020-06-08T12:49:25Z", "message": "Update docs/reference/query-dsl/geo-shape-query.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3820, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}