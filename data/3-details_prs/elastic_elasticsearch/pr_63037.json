{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MDY0MDYz", "number": 63037, "title": "Add Clone Snapshot Request Handling Scaffolding", "bodyText": "Adds all the scaffolding for snapshot clone request handling\nand index-to-clone resolution to reduce the diff in #61839 to\nthe bare essentials of the state machine changes for snapshot\ncloning and relevant tests and give us the opportunity to\nreview the API in isolation.", "createdAt": "2020-09-29T19:50:46Z", "url": "https://github.com/elastic/elasticsearch/pull/63037", "merged": true, "mergeCommit": {"oid": "45ba935113f0a3b2c9b7fecce1d9eba68ea4764e"}, "closed": true, "closedAt": "2020-09-30T11:32:55Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNtnKIgH2gAyNDk1MDY0MDYzOjdmYmUyZTNmNzhlYzYzZTc4NGYyZjkzOWRmMTY0NTE1MTQ5MDI2YmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN6XnEAFqTQ5OTI5ODkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7fbe2e3f78ec63e784f2f939df164515149026bd", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/7fbe2e3f78ec63e784f2f939df164515149026bd", "committedDate": "2020-09-29T19:46:45Z", "message": "Add Clone Snapshot Request Handling Scaffolding\n\nAdds all the scaffolding for snapshot clone request handling\nand index-to-clone resolution to reduce the diff in #61839 to\nthe bare essentials of the state machine changes for snapshot\ncloning and relevant tests and give us the opportunity to\nreview the API in isolation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebb9dcc44880763cdaaeee802cb215cf0474a859", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/ebb9dcc44880763cdaaeee802cb215cf0474a859", "committedDate": "2020-09-30T05:10:32Z", "message": "Merge remote-tracking branch 'elastic/master' into clone-snapshot-api-2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/756c0515ff25b31e6f1d2aa26da77c052fbf0f89", "committedDate": "2020-09-30T05:15:29Z", "message": "fix var name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MTk4MzY4", "url": "https://github.com/elastic/elasticsearch/pull/63037#pullrequestreview-499198368", "createdAt": "2020-09-30T08:28:57Z", "commit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODoyODo1N1rOHaS0Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODo0NDoyMFrOHaTaAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMzMzI3NQ==", "bodyText": "Since hidden indices are included in snapshot by default (#57325) I think we should also allow them to be cloned and support IndicesOptions.", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497333275", "createdAt": "2020-09-30T08:28:57Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionRequestValidationException;\n+import org.elasticsearch.action.support.master.MasterNodeRequest;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.action.ValidateActions.addValidationError;\n+\n+public class CloneSnapshotRequest extends MasterNodeRequest<CloneSnapshotRequest> {\n+\n+    private final String repository;\n+\n+    private final String source;\n+\n+    private final String target;\n+\n+    // TODO: the current logic does not allow for specifying index resolution parameters like hidden and such. Do we care about cloning\n+    //        system or hidden indices?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMzOTAzNw==", "bodyText": "Can we add some Javadoc please? It's not obvious that source/target are concerning snapshots and indices may be in fact the names of indices to retain when cloning the source snapshot.", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497339037", "createdAt": "2020-09-30T08:38:01Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionRequestValidationException;\n+import org.elasticsearch.action.support.master.MasterNodeRequest;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.action.ValidateActions.addValidationError;\n+\n+public class CloneSnapshotRequest extends MasterNodeRequest<CloneSnapshotRequest> {\n+\n+    private final String repository;\n+\n+    private final String source;\n+\n+    private final String target;\n+\n+    // TODO: the current logic does not allow for specifying index resolution parameters like hidden and such. Do we care about cloning\n+    //        system or hidden indices?\n+    private String[] indices;\n+\n+    public CloneSnapshotRequest(StreamInput in) throws IOException {\n+        super(in);\n+        repository = in.readString();\n+        source = in.readString();\n+        target = in.readString();\n+        indices = in.readStringArray();\n+    }\n+\n+    public CloneSnapshotRequest(String repository, String source, String target, String[] indices) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMzOTIwOQ==", "bodyText": "Can we document this method?", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497339209", "createdAt": "2020-09-30T08:38:18Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionRequestValidationException;\n+import org.elasticsearch.action.support.master.MasterNodeRequest;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.action.ValidateActions.addValidationError;\n+\n+public class CloneSnapshotRequest extends MasterNodeRequest<CloneSnapshotRequest> {\n+\n+    private final String repository;\n+\n+    private final String source;\n+\n+    private final String target;\n+\n+    // TODO: the current logic does not allow for specifying index resolution parameters like hidden and such. Do we care about cloning\n+    //        system or hidden indices?\n+    private String[] indices;\n+\n+    public CloneSnapshotRequest(StreamInput in) throws IOException {\n+        super(in);\n+        repository = in.readString();\n+        source = in.readString();\n+        target = in.readString();\n+        indices = in.readStringArray();\n+    }\n+\n+    public CloneSnapshotRequest(String repository, String source, String target, String[] indices) {\n+        this.repository = repository;\n+        this.source = source;\n+        this.target = target;\n+        this.indices = indices;\n+    }\n+\n+    @Override\n+    public void writeTo(StreamOutput out) throws IOException {\n+        super.writeTo(out);\n+        out.writeString(repository);\n+        out.writeString(source);\n+        out.writeString(target);\n+        out.writeStringArray(indices);\n+    }\n+\n+    @Override\n+    public ActionRequestValidationException validate() {\n+        ActionRequestValidationException validationException = null;\n+        if (source == null) {\n+            validationException = addValidationError(\"source snapshot name is missing\", null);\n+        }\n+        if (target == null) {\n+            validationException = addValidationError(\"target snapshot name is missing\", null);\n+        }\n+        if (repository == null) {\n+            validationException = addValidationError(\"repository is missing\", validationException);\n+        }\n+        if (indices == null) {\n+            validationException = addValidationError(\"indices is null\", validationException);\n+        } else if (indices.length == 0) {\n+            validationException = addValidationError(\"indices patterns are empty\", validationException);\n+        } else {\n+            for (String index : indices) {\n+                if (index == null) {\n+                    validationException = addValidationError(\"index is null\", validationException);\n+                    break;\n+                }\n+            }\n+        }\n+        return validationException;\n+    }\n+\n+    public String[] indices() {\n+        return this.indices;\n+    }\n+\n+    public CloneSnapshotRequest indices(String... indices) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMzOTM3OA==", "bodyText": "Can we document this method?", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497339378", "createdAt": "2020-09-30T08:38:35Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequestBuilder.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionType;\n+import org.elasticsearch.action.support.master.AcknowledgedResponse;\n+import org.elasticsearch.action.support.master.MasterNodeOperationRequestBuilder;\n+import org.elasticsearch.client.ElasticsearchClient;\n+import org.elasticsearch.common.Strings;\n+\n+public class CloneSnapshotRequestBuilder extends MasterNodeOperationRequestBuilder<CloneSnapshotRequest, AcknowledgedResponse,\n+                                                                                   CloneSnapshotRequestBuilder> {\n+\n+    protected CloneSnapshotRequestBuilder(ElasticsearchClient client, ActionType<AcknowledgedResponse> action,\n+                                          CloneSnapshotRequest request) {\n+        super(client, action, request);\n+    }\n+\n+    public CloneSnapshotRequestBuilder(ElasticsearchClient client, ActionType<AcknowledgedResponse> action,\n+                                       String repository, String source, String target) {\n+        this(client, action, new CloneSnapshotRequest(repository, source, target, Strings.EMPTY_ARRAY));\n+    }\n+\n+    public CloneSnapshotRequestBuilder setIndices(String... indices) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM0Mjk3Nw==", "bodyText": "Can't we just reuse or adapt filterIndices() so that restore and clone indices parameter work the same?", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497342977", "createdAt": "2020-09-30T08:44:20Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/snapshots/SnapshotUtils.java", "diffHunk": "@@ -118,4 +125,44 @@\n         }\n         return List.copyOf(result);\n     }\n+\n+    /**\n+     * Finds the {@link IndexId}s in the given source snapshot that match the given index patterns for a snapshot clone operation.\n+     *\n+     * @param sourceSnapshotId source snapshot id\n+     * @param targetSnapshot   target snapshot that the clone operation would create\n+     * @param repositoryData   repository data of the repository that the clone\n+     * @param indexPatterns    index patterns to clone from source- to target snapshot\n+     * @return list of index ids to clone\n+     * @throws SnapshotException on failure to find concrete request index ids or any index ids\n+     */\n+    static List<IndexId> findIndexIdsToClone(SnapshotId sourceSnapshotId, Snapshot targetSnapshot, RepositoryData repositoryData,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "756c0515ff25b31e6f1d2aa26da77c052fbf0f89"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3026cb663360ed6f602bcc40726960b56f2bce64", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/3026cb663360ed6f602bcc40726960b56f2bce64", "committedDate": "2020-09-30T09:09:48Z", "message": "Merge remote-tracking branch 'elastic/master' into clone-snapshot-api-2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77aca29c31c3d8b031ee4f19d9230811a4eadf91", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/77aca29c31c3d8b031ee4f19d9230811a4eadf91", "committedDate": "2020-09-30T09:37:56Z", "message": "CR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59de423dfcb725fd30abc360f62d097fa33169f9", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/59de423dfcb725fd30abc360f62d097fa33169f9", "committedDate": "2020-09-30T09:46:11Z", "message": "fix up rest request"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MjcwNTI0", "url": "https://github.com/elastic/elasticsearch/pull/63037#pullrequestreview-499270524", "createdAt": "2020-09-30T09:58:48Z", "commit": {"oid": "59de423dfcb725fd30abc360f62d097fa33169f9"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwOTo1ODo0OFrOHaWOHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMDowMTowNFrOHaWTPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM4OTA4NQ==", "bodyText": "Can we comment this for now and only uncomment it once REST integration tests and the whole feature are done?", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497389085", "createdAt": "2020-09-30T09:58:48Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/ActionModule.java", "diffHunk": "@@ -659,6 +663,7 @@ public void initRestHandlers(Supplier<DiscoveryNodes> nodesInCluster) {\n         registerHandler.accept(new RestCleanupRepositoryAction());\n         registerHandler.accept(new RestGetSnapshotsAction());\n         registerHandler.accept(new RestCreateSnapshotAction());\n+        registerHandler.accept(new RestCloneSnapshotAction());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59de423dfcb725fd30abc360f62d097fa33169f9"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM4OTczMw==", "bodyText": "Hidden indices are snapshotted by default so I think they should be cloned by default too? WDYT?", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497389733", "createdAt": "2020-09-30T09:59:53Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequest.java", "diffHunk": "@@ -0,0 +1,140 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionRequestValidationException;\n+import org.elasticsearch.action.IndicesRequest;\n+import org.elasticsearch.action.support.IndicesOptions;\n+import org.elasticsearch.action.support.master.MasterNodeRequest;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.action.ValidateActions.addValidationError;\n+\n+public class CloneSnapshotRequest extends MasterNodeRequest<CloneSnapshotRequest> implements IndicesRequest.Replaceable{\n+\n+    private final String repository;\n+\n+    private final String source;\n+\n+    private final String target;\n+\n+    private String[] indices;\n+\n+    private IndicesOptions indicesOptions = IndicesOptions.strictExpandOpen();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59de423dfcb725fd30abc360f62d097fa33169f9"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5MDM5Nw==", "bodyText": "Also serialize indices options", "url": "https://github.com/elastic/elasticsearch/pull/63037#discussion_r497390397", "createdAt": "2020-09-30T10:01:04Z", "author": {"login": "tlrx"}, "path": "server/src/main/java/org/elasticsearch/action/admin/cluster/snapshots/clone/CloneSnapshotRequest.java", "diffHunk": "@@ -0,0 +1,140 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.action.admin.cluster.snapshots.clone;\n+\n+import org.elasticsearch.action.ActionRequestValidationException;\n+import org.elasticsearch.action.IndicesRequest;\n+import org.elasticsearch.action.support.IndicesOptions;\n+import org.elasticsearch.action.support.master.MasterNodeRequest;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+\n+import java.io.IOException;\n+\n+import static org.elasticsearch.action.ValidateActions.addValidationError;\n+\n+public class CloneSnapshotRequest extends MasterNodeRequest<CloneSnapshotRequest> implements IndicesRequest.Replaceable{\n+\n+    private final String repository;\n+\n+    private final String source;\n+\n+    private final String target;\n+\n+    private String[] indices;\n+\n+    private IndicesOptions indicesOptions = IndicesOptions.strictExpandOpen();\n+\n+    public CloneSnapshotRequest(StreamInput in) throws IOException {\n+        super(in);\n+        repository = in.readString();\n+        source = in.readString();\n+        target = in.readString();\n+        indices = in.readStringArray();\n+    }\n+\n+    /**\n+     * Creates a clone snapshot request for cloning the given source snapshot's indices into the given target snapshot on the given\n+     * repository.\n+     *\n+     * @param repository repository that source snapshot belongs to and that the target snapshot will be created in\n+     * @param source     source snapshot name\n+     * @param target     target snapshot name\n+     * @param indices    indices to clone from source to target\n+     */\n+    public CloneSnapshotRequest(String repository, String source, String target, String[] indices) {\n+        this.repository = repository;\n+        this.source = source;\n+        this.target = target;\n+        this.indices = indices;\n+    }\n+\n+    @Override\n+    public void writeTo(StreamOutput out) throws IOException {\n+        super.writeTo(out);\n+        out.writeString(repository);\n+        out.writeString(source);\n+        out.writeString(target);\n+        out.writeStringArray(indices);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59de423dfcb725fd30abc360f62d097fa33169f9"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e910482495bcb9f6e70773137b3fc0d8dc3912c", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e910482495bcb9f6e70773137b3fc0d8dc3912c", "committedDate": "2020-09-30T10:12:27Z", "message": "indices options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "771463496bc71ef1b5c994808b0e4ac8f59123c1", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/771463496bc71ef1b5c994808b0e4ac8f59123c1", "committedDate": "2020-09-30T10:24:09Z", "message": "fix default indices resolve"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5Mjk4OTM4", "url": "https://github.com/elastic/elasticsearch/pull/63037#pullrequestreview-499298938", "createdAt": "2020-09-30T10:38:32Z", "commit": {"oid": "771463496bc71ef1b5c994808b0e4ac8f59123c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4542, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}