{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNjEzOTQz", "number": 63566, "title": "[ML] use node.roles as node.ml is deprecated in test external cluster", "bodyText": "Adjusts the external test cluster settings to use the new node.roles settings instead of the\nnode.<role_name>: <boolean> settings.\ncloses #63553", "createdAt": "2020-10-12T14:25:58Z", "url": "https://github.com/elastic/elasticsearch/pull/63566", "merged": true, "mergeCommit": {"oid": "8992f9145d77514a0966372f426508a807dc0f4a"}, "closed": true, "closedAt": "2020-10-13T14:52:15Z", "author": {"login": "benwtrent"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR0yAhAH2gAyNTAxNjEzOTQzOjkyYzQ3MGNhNTAzNjc4ZmUzMTg2Mzc0OTZjYWZkYmZkMDBmZGViNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSJv2cgFqTUwNzUyMDg2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "92c470ca503678fe318637496cafdbfd00fdeb54", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/92c470ca503678fe318637496cafdbfd00fdeb54", "committedDate": "2020-10-12T14:23:38Z", "message": "[ML] use node.roles as node.ml is deprecated in test external cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95845efefb6b90232c620e13d65dcab5dde19020", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/95845efefb6b90232c620e13d65dcab5dde19020", "committedDate": "2020-10-12T16:48:47Z", "message": "Merge branch 'master' into test/ml-adjust-external-cluster-settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzgwOTA1", "url": "https://github.com/elastic/elasticsearch/pull/63566#pullrequestreview-506780905", "createdAt": "2020-10-12T16:57:07Z", "commit": {"oid": "95845efefb6b90232c620e13d65dcab5dde19020"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjo1NzowN1rOHgGaSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNjo1NzowN1rOHgGaSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyMTUxMw==", "bodyText": "node.data, node.master and node.ingest defaulted to true.  So previously we were saying that the node had these roles but not node.ml.  Does an explicitly empty list mean \"use the defaults\" or \"no roles\"?  Either way this appears to be changing the logic:\n\nIf an explicitly empty list means \"use the defaults\" then we're now defaulting the roles to master, data, ingest, ml, and remote_cluster_client, i.e. including ml when we weren't before\nIf an explicitly empty list means \"no roles\" then that's different to before because master, data, ingest, and remote_cluster_client used to default to true", "url": "https://github.com/elastic/elasticsearch/pull/63566#discussion_r503421513", "createdAt": "2020-10-12T16:57:07Z", "author": {"login": "droberts195"}, "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/ml/integration/MlNativeIntegTestCase.java", "diffHunk": "@@ -156,7 +156,7 @@ protected Settings externalClusterClientSettings() {\n         }\n \n         Settings.Builder builder = Settings.builder();\n-        builder.put(\"node.ml\", false);\n+        builder.putList(\"node.roles\", Collections.emptyList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95845efefb6b90232c620e13d65dcab5dde19020"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NTIwODY1", "url": "https://github.com/elastic/elasticsearch/pull/63566#pullrequestreview-507520865", "createdAt": "2020-10-13T14:49:17Z", "commit": {"oid": "95845efefb6b90232c620e13d65dcab5dde19020"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4057, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}