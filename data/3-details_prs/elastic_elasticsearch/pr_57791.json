{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwODY5NDQx", "number": 57791, "title": "Small improvements to resilience design docs", "bodyText": "A follow-up to #47233 to clarify a few points.", "createdAt": "2020-06-08T07:37:30Z", "url": "https://github.com/elastic/elasticsearch/pull/57791", "merged": true, "mergeCommit": {"oid": "6c92fac0067f4f4395355743024f9731ebdd47e9"}, "closed": true, "closedAt": "2020-06-08T12:50:11Z", "author": {"login": "DaveCTurner"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpLatBAH2gAyNDMwODY5NDQxOjQ4YjRhNzJkYThkNDhlZTMyMGNkZTNiMGNjNWM4NGFlM2E0Mjc3YTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpPmKNAFqTQyNjE3NDgxNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8", "author": {"user": {"login": "DaveCTurner", "name": "David Turner"}}, "url": "https://github.com/elastic/elasticsearch/commit/48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8", "committedDate": "2020-06-08T07:35:06Z", "message": "Small improvements to resilience design docs\n\nA follow-up to #47233 to clarify a few points."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1OTc5ODE0", "url": "https://github.com/elastic/elasticsearch/pull/57791#pullrequestreview-425979814", "createdAt": "2020-06-08T07:38:26Z", "commit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwNzozODoyNlrOGgSUZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwNzo0Mjo0MlrOGgScQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUwNzc1MA==", "bodyText": "More a requirement than a recommendation; added to the bullet-pointed list so it parallels the next one.", "url": "https://github.com/elastic/elasticsearch/pull/57791#discussion_r436507750", "createdAt": "2020-06-08T07:38:26Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/high-availability/cluster-design.asciidoc", "diffHunk": "@@ -10,15 +10,12 @@ There is a limit to how small a resilient cluster can be. All {es} clusters\n require:\n \n * One <<modules-discovery-quorums,elected master node>> node\n+* At least one node for each <<modules-node,role>>.\n * At least one copy of every <<scalability,shard>>.\n \n-We also recommend adding a new node to the cluster for each", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUwODE0NQ==", "bodyText": "This is true, but it's not something the user needs to worry about. As long as you have at least three master-eligible nodes Elasticsearch will look after this point automatically.", "url": "https://github.com/elastic/elasticsearch/pull/57791#discussion_r436508145", "createdAt": "2020-06-08T07:39:16Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/high-availability/cluster-design.asciidoc", "diffHunk": "@@ -10,15 +10,12 @@ There is a limit to how small a resilient cluster can be. All {es} clusters\n require:\n \n * One <<modules-discovery-quorums,elected master node>> node\n+* At least one node for each <<modules-node,role>>.\n * At least one copy of every <<scalability,shard>>.\n \n-We also recommend adding a new node to the cluster for each\n-<<modules-node,role>>.\n+A resilient cluster requires redundancy for every required cluster component.\n+This means a resilient cluster must have:\n \n-A resilient cluster requires redundancy for every required cluster component,\n-except the elected master node. For resilient clusters, we recommend:\n-\n-* One elected master node", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUwOTAwOA==", "bodyText": "We mention this in the \"larger clusters\" section but it applies to all clusters so I thought it'd help to note it here too.", "url": "https://github.com/elastic/elasticsearch/pull/57791#discussion_r436509008", "createdAt": "2020-06-08T07:41:01Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/high-availability/cluster-design.asciidoc", "diffHunk": "@@ -27,13 +24,18 @@ A resilient cluster needs three master-eligible nodes so that if one of\n them fails then the remaining two still form a majority and can hold a\n successful election.\n \n-Similarly, node redundancy makes it likely that if a node for a particular role\n-fails, another node can take on its responsibilities.\n+Similarly, redundancy of nodes of each role means that if a node for a\n+particular role fails, another node can take on its responsibilities.\n \n Finally, a resilient cluster should have at least two copies of each shard. If\n-one copy fails then there is another good copy to take over. {es} automatically\n-rebuilds any failed shard copies on the remaining nodes in order to restore the\n-cluster to full health after a failure.\n+one copy fails then there should be another good copy to take over. {es}\n+automatically rebuilds any failed shard copies on the remaining nodes in order\n+to restore the cluster to full health after a failure.\n+\n+Failures temporarily reduce the total capacity of your cluster. In addition,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjUwOTc2MA==", "bodyText": "Added \"by default\" otherwise it's not true since you can have a green cluster with no replicas. My bad, I think this must have been an incomplete edit.", "url": "https://github.com/elastic/elasticsearch/pull/57791#discussion_r436509760", "createdAt": "2020-06-08T07:42:42Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/high-availability/cluster-design.asciidoc", "diffHunk": "@@ -60,13 +62,16 @@ To accommodate this, {es} assigns nodes every role by default.\n \n A single node cluster is not resilient. If the the node fails, the cluster will\n stop working. Because there are no replicas in a one-node cluster, you cannot\n-store your data redundantly. However, at least one replica is required for a\n-<<cluster-health,`green` cluster health status>>. To ensure your cluster can\n-report a `green` status, set\n-<<dynamic-index-settings,`index.number_of_replicas`>> to `0` on every index. If\n-the node fails, you may need to restore an older copy of any lost indices from a\n-<<modules-snapshots,snapshot>>. Because they are not resilient to any failures,\n-we do not recommend using one-node clusters in production.\n+store your data redundantly. However, by default at least one replica is", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTc0ODE1", "url": "https://github.com/elastic/elasticsearch/pull/57791#pullrequestreview-426174815", "createdAt": "2020-06-08T12:27:14Z", "commit": {"oid": "48b4a72da8d48ee320cde3b0cc5c84ae3a4277a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3808, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}