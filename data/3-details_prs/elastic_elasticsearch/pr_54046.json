{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNzIyMzEz", "number": 54046, "title": "Add SAML IdP plugin for internal use", "bodyText": "This change merges the \"feature-internal-idp\" branch into Elasticsearch.\nThis introduces a small identity-provider plugin as a child of the x-pack module.\nThis allows ES to act as a SAML IdP, for users who are authenticated against the\nElasticsearch cluster.\nThis feature is intended for internal use within Elastic Cloud environments\nand is not supported for any other use case. It falls under an enterprise license tier.\nThe IdP is disabled by default.", "createdAt": "2020-03-24T01:21:26Z", "url": "https://github.com/elastic/elasticsearch/pull/54046", "merged": true, "mergeCommit": {"oid": "c1d8341e6e045ca8f7f39856c3a17b49056df873"}, "closed": true, "closedAt": "2020-03-24T13:35:40Z", "author": {"login": "tvernum"}, "timelineItems": {"totalCount": 63, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_YbpwgH2gAyMzkyNzIyMzEzOjNmMzJmNWQ3OTE5NzAxM2YzN2JkNzNiM2IxNjYxNzgzNGE2NGExYmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQyMCGAH2gAyMzkyNzIyMzEzOmFiNTM4NjhmNmRjYzZmZWY0NjMxZDZlMjVkMTY1M2M2YTQxOWViY2M=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3f32f5d79197013f37bd73b3b16617834a64a1be", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/3f32f5d79197013f37bd73b3b16617834a64a1be", "committedDate": "2020-01-30T11:00:05Z", "message": "X-Pack SAML IdP Plugin (#51514)\n\nThis introduces a new sub-plugin to X-Pack that implements the backend\r\nfor a basic IdP built on top of the X-Pack security primitives.\r\n\r\nIn this commit there is a mostly empty plugin implementation and a\r\nclass the implements the minimum necessary to generate a SAML 2.0\r\nauthentication \"Response\"."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa9e541ed24f0a8da9d23f00f68e06e4156a3b2f", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/aa9e541ed24f0a8da9d23f00f68e06e4156a3b2f", "committedDate": "2020-02-03T09:54:28Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "207dce8092a107c26c61a2426e1cc8d1d10bda4f", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/207dce8092a107c26c61a2426e1cc8d1d10bda4f", "committedDate": "2020-02-03T11:12:24Z", "message": "Add IDP Configuration settings and related tests (#51682)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "789b4e49e385ad6ac8acd4e88261720e5e10dcc2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/789b4e49e385ad6ac8acd4e88261720e5e10dcc2", "committedDate": "2020-02-07T06:03:15Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aac2e432a38f3e23103457cf55fababf5c5e28e5", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/aac2e432a38f3e23103457cf55fababf5c5e28e5", "committedDate": "2020-02-11T13:23:53Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf2dee1ca9d78ffa1419d29952776b598a8ec051", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/bf2dee1ca9d78ffa1419d29952776b598a8ec051", "committedDate": "2020-02-12T00:58:15Z", "message": "Add signing support to SAML IdP (#51517)\n\nAdds a new \"SamlObjectSigner\" class that can sign messages such as\r\nauthn Response objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb88cdd6cc6169b5a90e5fcc36ed9af693702e4e", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/eb88cdd6cc6169b5a90e5fcc36ed9af693702e4e", "committedDate": "2020-02-12T05:12:34Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "726b58771db4a77c1c3c193803e12f809af79867", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/726b58771db4a77c1c3c193803e12f809af79867", "committedDate": "2020-02-17T12:12:07Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b4393de6b11421866c13cef01edf6dcbd9f9898", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/4b4393de6b11421866c13cef01edf6dcbd9f9898", "committedDate": "2020-02-18T06:23:34Z", "message": "IDP-initiated sso REST handler (#51830)\n\nNecessary rest handler and transport action for consuming an SP\r\nEntityID and producing a SAML response for the authenticating user.\r\nTransportSamlInitiateSingleSignOnAction needs to be adjusted to\r\ntake advantage of the secondary authentication handling logic once\r\nthis is available."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "749c3c47122a40ef860c7343864be99fec32680d", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/749c3c47122a40ef860c7343864be99fec32680d", "committedDate": "2020-02-18T22:55:48Z", "message": "Resolve application privileges to SP access (#52250)\n\nAdds a new UserPrivilegeResolver class that determines whether a user\r\nhas access to a service, and with what groups, based on an application\r\nresource model that represents the service."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97eed1586fca1a7c2574444b48eb68b2956edaa9", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/97eed1586fca1a7c2574444b48eb68b2956edaa9", "committedDate": "2020-02-23T10:39:21Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c84a9c049388d8106b64dd161bd6435bb62c2a3c", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/c84a9c049388d8106b64dd161bd6435bb62c2a3c", "committedDate": "2020-02-23T12:22:40Z", "message": "Fix compile / merge issue (#52643)\n\nCompilation of the feature-internal-idp branch was broken due to\r\nconflicting merges."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "760b39a64b4d3e8a115ad2272fe11aaa5c69d64f", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/760b39a64b4d3e8a115ad2272fe11aaa5c69d64f", "committedDate": "2020-02-24T10:21:49Z", "message": "Write SAML SP data to a dedicated index (#52401)\n\nThis adds low level classes for reading & writing documents that\r\nmodel a SAML Service Provider in the IdP.\r\n(These classes are not currently used)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6151bb830c00a3d3bc7f4efabc196655861be3a3", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/6151bb830c00a3d3bc7f4efabc196655861be3a3", "committedDate": "2020-02-26T06:42:53Z", "message": "Automatically install SAML SP index template (#52706)\n\nTriggers the installation of the index template automatically due to\r\ncluster state changes, or before writing a SP doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81886168c1121cc9a6358a9b541504506d5edd70", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/81886168c1121cc9a6358a9b541504506d5edd70", "committedDate": "2020-02-26T06:48:30Z", "message": "Update IdP plugin security policy (#52740)\n\nApacheXMLSecurityInitializer (a dependency of OpenSAML) attempts to\r\nset the \"org.apache.xml.security.ignoreLineBreaks\" system property if\r\nit doesn't exist"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eaa2e4f8b7c5a7ea3474463cf3ae5a95c9e21643", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/eaa2e4f8b7c5a7ea3474463cf3ae5a95c9e21643", "committedDate": "2020-02-26T13:58:43Z", "message": "Handle incoming AuthnRequests (#52018)\n\n- Expose an API that consumes (possibly signed) AuthnRequests as\r\ndefined by the HTTP-Redirect binding.\r\n- Process AuthnRequests, validate and parse them into a minimum\r\nset of information to be used for subsequent API calls to get a\r\nSAML Response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b22e1e96d2464d087bdb45c3001829d54511251", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3b22e1e96d2464d087bdb45c3001829d54511251", "committedDate": "2020-02-26T13:59:05Z", "message": "Create SAML Responses for secondary authN (#52805)\n\nCreate the SAML responses for the principal that we should. The\r\ncredentials of this user need to have been passed in the\r\nes-secondary-authorization header."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfe6d437233a25600782bfc819d95db0a78e2583", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/bfe6d437233a25600782bfc819d95db0a78e2583", "committedDate": "2020-02-28T06:08:56Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bc83702c6a6a5a0c37962bc524e86cf843a369b", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/4bc83702c6a6a5a0c37962bc524e86cf843a369b", "committedDate": "2020-02-28T07:29:20Z", "message": "Generate SAML metadata for the Identity Provider (#52415)\n\nThis change adds an API for generating SAML metadata for the\r\nconfigured Identity Provider. All parameters that can contribute\r\nto the metadata, from signing keys to Organization and contact\r\ndetails are all configured in node settings.\r\nThe caller of the API needs to define the SP that will consume this\r\nmetadata as the values included can potentially be different,\r\ndepending on the registered SP configuration and the IDP policy."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "443b8056078924084973337e1be952d57fd66f4c", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/443b8056078924084973337e1be952d57fd66f4c", "committedDate": "2020-03-05T00:17:30Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cd3ba919ae24b87f171bb643c5e6e41cc5f6f11", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/0cd3ba919ae24b87f171bb643c5e6e41cc5f6f11", "committedDate": "2020-03-05T03:46:33Z", "message": "Add REST endpoint to register a new SAML SP (#52936)\n\nThis change adds a new PUT /_idp/saml/sp/{entity_id} endpoint that\r\nregisters (or updates) a Service Provider in the IDP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34c14190a1f51ef6e044df8669022e9585b994e5", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/34c14190a1f51ef6e044df8669022e9585b994e5", "committedDate": "2020-03-05T04:48:24Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b7150a0bbd9ca03d5e93bcf3e53d62445587a1", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/a4b7150a0bbd9ca03d5e93bcf3e53d62445587a1", "committedDate": "2020-03-05T05:14:48Z", "message": "Make ServiceProvider lookup asynchronous (#52986)\n\nThis prepares for reading the real Service Provider data from the saml\r\nindex.\r\n\r\nWe intend to support a large number of ServiceProviders within a\r\nsingle cluster, so it is not reasible to keep them all cached in\r\nmemory. Since the read from the underyling index will be asynchronous,\r\nall methods that make use of a service provider also need to be\r\nasychronous."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f2853740a65c3ba0ddfe65acd9cb3c671c3c7aa", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/2f2853740a65c3ba0ddfe65acd9cb3c671c3c7aa", "committedDate": "2020-03-05T12:40:27Z", "message": "Resolve runtime SP model from index doc (#52985)\n\nThis change adds a `SamlServiceProviderResolver` that can build a\r\n`SamlServiceProvider` object for a given entity-id, based on the\r\ndocument model stored in `SamlServiceProviderDocument`.\r\n\r\nThis resolver includes a cache that is aware of document versioning\r\n(seqNo, primaryTerm) and avoids JSON parsing and object construction\r\nif the document has not changed since last use."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0af00f889350805b62c92ab09172483f4e7ac3a5", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/0af00f889350805b62c92ab09172483f4e7ac3a5", "committedDate": "2020-03-05T23:26:28Z", "message": "Refactor SamlIdentityProvider setup (#52990)\n\nThe SamlIdentityProvider / CloudIdp classes had evolved gradually from\r\ntheir initial commit to the point where they no longer were quite the\r\nright fit for the project.\r\n\r\nThis change merges the class and interface, and migrates some of the\r\ninstantiation logic that had been split between the Plugin and the\r\nclass into a separate Builder object.\r\n\r\nWe also move the Contact and Organisation information from the\r\nmetadata builder into the IdentityProvider class so that the class is\r\nself-contained."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "498bb7f8833733136d25191ad5b1e4ab55abdcdb", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/498bb7f8833733136d25191ad5b1e4ab55abdcdb", "committedDate": "2020-03-09T06:03:56Z", "message": "Use optionalVLong (#53149)\n\nUpdates SamlServiceProviderDocument to use the new\r\nread/writeOptionalVLong methods from #53145"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed3770f8f3b3a4ddc62807bda7a472b843ac8cbd", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/ed3770f8f3b3a4ddc62807bda7a472b843ac8cbd", "committedDate": "2020-03-09T06:04:25Z", "message": "Rename \"groups\" to \"roles\" (#53208)\n\nThe Identity Provider has a feature to release a standard set of\r\nattributes to a Service Provider. One of those attributes is intended\r\nto represent the groups or roles to which the user belongs.\r\n\r\nFrom an Identity Provider point of view, there is no concrete\r\ndefinition of what these attributes represent or should be used for -\r\nthe Service Provider may treat them as \"groups\" (a named collection of\r\nusers) or \"roles\" (a named representation of the user's access\r\nrights).\r\n\r\nTerminology across IdPs varies, but we have decided that within the ES\r\nIdP, we will refer to them as \"roles\". This change replaces any use of\r\nthe term \"groups\" with \"roles\"."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e38c4ea19f2d5f20ec2f7031e47f3d0aedee2c7", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/4e38c4ea19f2d5f20ec2f7031e47f3d0aedee2c7", "committedDate": "2020-03-09T09:25:08Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1874fc6fd3d9a78d976553464d4867e1daa7cd93", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/1874fc6fd3d9a78d976553464d4867e1daa7cd93", "committedDate": "2020-03-09T13:06:48Z", "message": "Resolve real (indexed) SPs from IdentityProvider (#53211)\n\nThis change hooks the SamlIdentityProvider class up to the\r\nSamlServiceProviderResolver so that we return real registered\r\nservice providers during SSO handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82b9e0715f9e69c7d3acd74d2e77f80777b0f5a6", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/82b9e0715f9e69c7d3acd74d2e77f80777b0f5a6", "committedDate": "2020-03-10T00:29:26Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdf3abf8e9fd58910535ac2a384dbaad091ab855", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/fdf3abf8e9fd58910535ac2a384dbaad091ab855", "committedDate": "2020-03-10T02:14:33Z", "message": "Resolve correct service privileges for user (#53213)\n\nWhen a user SSOs to a service provider, the IdP will provide\r\nattributes to indicate the user's access (roles) in that service.\r\n\r\nThis change connect the component that determines the user's access\r\n(UserPrivilegeResolver) to the action that generates the SAML response\r\n(TransportSamlInitiateSingleSignOnAction)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b0afdd070e4464118e8c0ddd02b0f060133f1c6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/6b0afdd070e4464118e8c0ddd02b0f060133f1c6", "committedDate": "2020-03-10T20:39:21Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00dd338f78b48f4792f5fc14e422a9a0e5b05ea8", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/00dd338f78b48f4792f5fc14e422a9a0e5b05ea8", "committedDate": "2020-03-11T10:46:26Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a757b414d24494e4765cf0a1c7d3ee064215314", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/6a757b414d24494e4765cf0a1c7d3ee064215314", "committedDate": "2020-03-11T12:23:41Z", "message": "Remove explicit login action and application (#53320)\n\nThis removes the concept of a login action, and instead relies\r\nexclusively on the existence of roles to determine whether a user has\r\naccess to a service resource.\r\n\r\nIt also removes the ability for a service provider to be configured to have a\r\nresource under a custom application name."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23a01634640a842f443dada1738838bd2ce4ad12", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/23a01634640a842f443dada1738838bd2ce4ad12", "committedDate": "2020-03-11T14:02:05Z", "message": "Add missing parameters to HasPrivileges requests (#53396)\n\nThe request must contain cluster and indices privileges"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9628bc5596ad023d8330820961c3e1cd1ab6fd14", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/9628bc5596ad023d8330820961c3e1cd1ab6fd14", "committedDate": "2020-03-11T15:26:33Z", "message": "Sign SAML responses by default (#53382)\n\nSign all SAML Responses ( the Response Element without signing\r\nthe included Assertion ) that the Idp sends to any SP. To that\r\neffect, make it an error to not set a signing credential when\r\nbuilding a SamlIdentityProvider."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b19e6c8e298fb9793ac19fdb364a569d69f9ab7", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7b19e6c8e298fb9793ac19fdb364a569d69f9ab7", "committedDate": "2020-03-11T15:32:37Z", "message": "Return appropriate error codes (#53371)\n\nWhen we fail to validate an Authentication request because the\r\nrequest is invalid, respond with 400 instead of 500."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "614ffa235711d56c0bc5c90aca5a5aa802c9228a", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/614ffa235711d56c0bc5c90aca5a5aa802c9228a", "committedDate": "2020-03-12T04:53:06Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72b1921431403d6afc7c602184df97f427da3a8c", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/72b1921431403d6afc7c602184df97f427da3a8c", "committedDate": "2020-03-12T05:58:50Z", "message": "Configure SP defaults from YAML settings (#53279)\n\nThis change adds support for reading the SP defaults from the\r\nelasticsearch Settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76954183fbcc28ce8433dc8cc11280717e8be0d9", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/76954183fbcc28ce8433dc8cc11280717e8be0d9", "committedDate": "2020-03-12T14:29:30Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c280a9023375929d3315fc151937460c3c28b516", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/c280a9023375929d3315fc151937460c3c28b516", "committedDate": "2020-03-13T02:05:09Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ab89953785258e85628f0c0da5c7b37eea1f1b7", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/2ab89953785258e85628f0c0da5c7b37eea1f1b7", "committedDate": "2020-03-13T03:27:56Z", "message": "Add endpoint to delete a service provider by ID (#53322)\n\nThis API is a sibling to the existing Put SAML Service Provider API\r\nthat registers a new SP.\r\n\r\nThe implementation is a hard delete."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbab4504d7420e7a32c846e725b65fcdf319d10d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/bbab4504d7420e7a32c846e725b65fcdf319d10d", "committedDate": "2020-03-13T06:58:28Z", "message": "Handle refresh policy for the request to write the SP to the index (#53364)\n\nSet default refresh policy to NONE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33ce27b795157fc9a90aaa88bd4fbf4be51f27cf", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/33ce27b795157fc9a90aaa88bd4fbf4be51f27cf", "committedDate": "2020-03-13T07:30:16Z", "message": "Handle SamlAuthenticationState between APIs (#53254)\n\nAfter successful validation of an AuthnRequest the caller of the\r\n/validate API needs to call /init to generate the SAML response\r\nthat it can then send to the SP. There is some context that needs\r\nto be carried from the response of the /validate API to the\r\nrequest to the /init API. This context is encapsulated in the\r\nSamlAuthenticationState object that is serialized to a json\r\nobject in the SamlValidateAuthnRequestResponse. This can be\r\ntreated as an opaque blob for the caller of the API that just\r\nneeds to pass it to the subsequent request to the /init API. At\r\nthe same time we enable SAML responses that indicate failure\r\n(as opposed to returning a 4xx) for both the /init API as\r\ndictated by the SAML 2.0 Web Browser SSO profile.\r\n\r\nAdditionally these small adjustments were made:\r\n\r\n- Saml Service Providers must indicate a single NameID format that\r\n  they want to use upon registration, instead of multiple. This is\r\n  used to validate the NameID Policy of the AuthnRequest if it\r\n  exists or to determine the NameID format for the response\r\n  otherwise.\r\n- If no NameID Policy is set in the AuthnRequest and the SP has\r\n  not registered a desired one, an IDP wide default NameID format\r\n  is returned.\r\n- JSON response fomat for the RestSamlInitiateSingleSignOnAction\r\n  has been reviewed as discussed.\r\n- All Rest actions have been moved under the same package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f8fb1fe3f0daab82011e8d7ee09e8d519a359fa", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/2f8fb1fe3f0daab82011e8d7ee09e8d519a359fa", "committedDate": "2020-03-15T10:19:26Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b7bf83aecdaa13f90bca26e4df1f0584e22b512", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/1b7bf83aecdaa13f90bca26e4df1f0584e22b512", "committedDate": "2020-03-17T02:32:04Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bdf4c7c6e2cbcbfa2f593be5ef21c99cff7ce7d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3bdf4c7c6e2cbcbfa2f593be5ef21c99cff7ce7d", "committedDate": "2020-03-17T10:22:58Z", "message": "Add supported NameID Format configuration and generate transient values (#53593)\n\nOnly transient format is supported for now."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22d11bc86b3d9a3790152d95f8f0fe3d5c8cc141", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/22d11bc86b3d9a3790152d95f8f0fe3d5c8cc141", "committedDate": "2020-03-17T16:08:42Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d17336332f274440ca7f12e1558cf88805b2b94", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/8d17336332f274440ca7f12e1558cf88805b2b94", "committedDate": "2020-03-17T23:54:42Z", "message": "Add a QA project for identity provider module (#53585)\n\nThis adds a small QA project that starts up a cluster with the IdP\r\nenabled and performs a basic test of registering a service provider.\r\n\r\nIt also fixes a few bugs that were found along the way."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00affa3f3dcb74b020f4f96a8139780ec1fd324a", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/00affa3f3dcb74b020f4f96a8139780ec1fd324a", "committedDate": "2020-03-18T06:39:30Z", "message": "Populate SAML Response Attribute Values (#53665)\n\nAdd name, email and principal as attributes in the successful\r\nSAML response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98b3de6d610bb5f8b1b9f2affa878d0ef0c69643", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/98b3de6d610bb5f8b1b9f2affa878d0ef0c69643", "committedDate": "2020-03-18T06:49:23Z", "message": "Merge branch 'feature-internal-idp' of github.com:elastic/elasticsearch into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f5a24b53a7f7f09f9432b0f8737a681e1736e9e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/5f5a24b53a7f7f09f9432b0f8737a681e1736e9e", "committedDate": "2020-03-18T08:40:39Z", "message": "License Checks for IDP (#53651)\n\nIdp related functionality should only be available for enterprise\r\nlicenses."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "031bd2e5a4d517e78a385f7259d78c66cabb6dab", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/031bd2e5a4d517e78a385f7259d78c66cabb6dab", "committedDate": "2020-03-18T08:41:39Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a128009d2bd074d9e7670356e2c5893ad94d88e2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/a128009d2bd074d9e7670356e2c5893ad94d88e2", "committedDate": "2020-03-20T12:01:22Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bbc23105cfd7e7e59cd09a9aee180881c83c62e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/6bbc23105cfd7e7e59cd09a9aee180881c83c62e", "committedDate": "2020-03-23T20:51:37Z", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e9744ae4e54e5c2e9a50d76bb0c4cc25309d0ba", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3e9744ae4e54e5c2e9a50d76bb0c4cc25309d0ba", "committedDate": "2020-03-23T23:02:16Z", "message": "Add Integration tests for the new IDP handlers (#53130)\n\nAdds a base class for IDP related EsIntegTests (IdpIntegTestCase)\r\nand tests for the existing APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a9887896de455844f0782687239b5ee346916f6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/2a9887896de455844f0782687239b5ee346916f6", "committedDate": "2020-03-24T01:10:03Z", "message": "Fix IdP signing (#53971)\n\nFixes signing to run with the correct context classloader.\r\nThis in turn requires doPrivileged."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0af19688bf4e91f6ec70fca687e80d11aee98dba", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/0af19688bf4e91f6ec70fca687e80d11aee98dba", "committedDate": "2020-03-24T01:16:09Z", "message": "Merge branch 'master' into feature-internal-idp"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5OTcyMTM0", "url": "https://github.com/elastic/elasticsearch/pull/54046#pullrequestreview-379972134", "createdAt": "2020-03-24T03:10:03Z", "commit": {"oid": "0af19688bf4e91f6ec70fca687e80d11aee98dba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwMzoxMDowNFrOF6fkow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwMzoxMDowNFrOF6fkow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3OTAxMQ==", "bodyText": "This is a drive-by comment. I can't find any uses of this? And also, I think that AbstractWireSerializingTestCase provides roughly the same functionality?", "url": "https://github.com/elastic/elasticsearch/pull/54046#discussion_r396879011", "createdAt": "2020-03-24T03:10:04Z", "author": {"login": "jasontedor"}, "path": "test/framework/src/main/java/org/elasticsearch/test/SerializationTestUtils.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.test;\n+\n+import org.elasticsearch.Version;\n+import org.elasticsearch.common.io.stream.InputStreamStreamInput;\n+import org.elasticsearch.common.io.stream.OutputStreamStreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+/**\n+ * Utility methods for assisting with testing {@link Writeable} object.\n+ */\n+public class SerializationTestUtils {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0af19688bf4e91f6ec70fca687e80d11aee98dba"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "070698b9d03e5b452543ed46c237dc2f27838c02", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/070698b9d03e5b452543ed46c237dc2f27838c02", "committedDate": "2020-03-24T07:48:50Z", "message": "Fix test to always have roles (#54048)\n\nThis change fixes a radomised failure in\r\nTransportSamlInitiateSingleSignOnRequestTests\r\n\r\nUnder some seeds (e.g. 856F19C80D0A73B6) the roles array would be\r\nempty, which would mean that the generated SAML response would not\r\ncontain a roles attribute."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a403ae208102eaabde36e648d57f8312435f734d", "author": {"user": {"login": "tvernum", "name": "Tim Vernum"}}, "url": "https://github.com/elastic/elasticsearch/commit/a403ae208102eaabde36e648d57f8312435f734d", "committedDate": "2020-03-24T08:11:46Z", "message": "Remove SerializationTestUtils (#54052)\n\nThis change replaces the SerializationTestUtils class with methods\r\nfrom ESTestCase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMTg2MDUy", "url": "https://github.com/elastic/elasticsearch/pull/54046#pullrequestreview-380186052", "createdAt": "2020-03-24T10:40:16Z", "commit": {"oid": "a403ae208102eaabde36e648d57f8312435f734d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab53868f6dcc6fef4631d6e25d1653c6a419ebcc", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/ab53868f6dcc6fef4631d6e25d1653c6a419ebcc", "committedDate": "2020-03-24T12:37:16Z", "message": "Wrap RestorableContextClassLoader with doPrivileged (#54053)\n\nNeeded since RestorableContextClassLoader was moved to core (from\r\nsecurity)"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1657, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}