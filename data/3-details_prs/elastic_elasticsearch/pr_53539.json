{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NzM3NDcz", "number": 53539, "title": "[ML] Extend classification to support multiple classes", "bodyText": "Prepares classification analysis to support more than just\ntwo classes. It introduces a new parameter to the process config\nwhich dictates the num_classes to the process. It also\nchanges the max classes limit to 30 provisionally.", "createdAt": "2020-03-13T11:52:51Z", "url": "https://github.com/elastic/elasticsearch/pull/53539", "merged": true, "mergeCommit": {"oid": "7e0a3c4007376fec594436c703b35ef56e728da7"}, "closed": true, "closedAt": "2020-03-16T11:13:32Z", "author": {"login": "dimitris-athanasiou"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNP8CXgBqjMxMjY2MzczNDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOKzhggFqTM3NTA0MTU5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10c4d7e21879ee0f7b399735c501963051d48fc6", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/10c4d7e21879ee0f7b399735c501963051d48fc6", "committedDate": "2020-03-13T11:35:39Z", "message": "[ML] Extend classification to support multiple classes\n\nPrepares classification analysis to support more than just\ntwo classes. It introduces a new parameter to the process config\nwhich dictates the `num_classes` to the process. It also\nchanges the max classes limit to `30` provisionally."}, "afterCommit": {"oid": "367cfd654f5c32105c818b9a782a5ee8c3ad6619", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/367cfd654f5c32105c818b9a782a5ee8c3ad6619", "committedDate": "2020-03-13T13:01:23Z", "message": "[ML] Extend classification to support multiple classes\n\nPrepares classification analysis to support more than just\ntwo classes. It introduces a new parameter to the process config\nwhich dictates the `num_classes` to the process. It also\nchanges the max classes limit to `30` provisionally."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "367cfd654f5c32105c818b9a782a5ee8c3ad6619", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/367cfd654f5c32105c818b9a782a5ee8c3ad6619", "committedDate": "2020-03-13T13:01:23Z", "message": "[ML] Extend classification to support multiple classes\n\nPrepares classification analysis to support more than just\ntwo classes. It introduces a new parameter to the process config\nwhich dictates the `num_classes` to the process. It also\nchanges the max classes limit to `30` provisionally."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef", "committedDate": "2020-03-13T15:11:59Z", "message": "We can't test cardinality is too high in the YML tests anymore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0OTkzNTQ1", "url": "https://github.com/elastic/elasticsearch/pull/53539#pullrequestreview-374993545", "createdAt": "2020-03-16T08:22:16Z", "commit": {"oid": "b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwODoyMjoxN1rOF2pjvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwODozMDozMlrOF2pzdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg0ODMxNg==", "bodyText": "Should 30 become a constant in this class?", "url": "https://github.com/elastic/elasticsearch/pull/53539#discussion_r392848316", "createdAt": "2020-03-16T08:22:17Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/Classification.java", "diffHunk": "@@ -272,7 +275,7 @@ public boolean supportsCategoricalFields() {\n     @Override\n     public List<FieldCardinalityConstraint> getFieldCardinalityConstraints() {\n         // This restriction is due to the fact that currently the C++ backend only supports binomial classification.\n-        return Collections.singletonList(FieldCardinalityConstraint.between(dependentVariable, 2, 2));\n+        return Collections.singletonList(FieldCardinalityConstraint.between(dependentVariable, 2, 30));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg0OTg2Ng==", "bodyText": "Could this test be made to work without muting if you indexed more than 30 distinct values for dep var?", "url": "https://github.com/elastic/elasticsearch/pull/53539#discussion_r392849866", "createdAt": "2020-03-16T08:25:23Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/ClassificationIT.java", "diffHunk": "@@ -322,9 +322,11 @@ public void testStopAndRestart() throws Exception {\n         assertEvaluation(KEYWORD_FIELD, KEYWORD_FIELD_VALUES, \"ml.\" + predictedClassField);\n     }\n \n+    @AwaitsFix(bugUrl = \"Muted until ml-cpp supports multiple classes\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1MjM0MA==", "bodyText": "Should there be at least one unit test with non-empty map provided to this constructor?", "url": "https://github.com/elastic/elasticsearch/pull/53539#discussion_r392852340", "createdAt": "2020-03-16T08:30:32Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/ml/src/test/java/org/elasticsearch/xpack/ml/extractor/ExtractedFieldsTests.java", "diffHunk": "@@ -32,7 +32,7 @@ public void testAllTypesOfFields() {\n         ExtractedField sourceField1 = new SourceField(\"src1\", Collections.singleton(\"text\"));\n         ExtractedField sourceField2 = new SourceField(\"src2\", Collections.singleton(\"text\"));\n         ExtractedFields extractedFields = new ExtractedFields(Arrays.asList(\n-                docValue1, docValue2, scriptField1, scriptField2, sourceField1, sourceField2));\n+                docValue1, docValue2, scriptField1, scriptField2, sourceField1, sourceField2), Collections.emptyMap());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4d0c5cc7ccb2c017cdaad6565250415d1e0f9ef"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "150dd0e6eda3cd7f04e60c9dc1e11199be41cfaf", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/150dd0e6eda3cd7f04e60c9dc1e11199be41cfaf", "committedDate": "2020-03-16T09:20:43Z", "message": "Extract max number of classes in a constant"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDQxNTk5", "url": "https://github.com/elastic/elasticsearch/pull/53539#pullrequestreview-375041599", "createdAt": "2020-03-16T09:36:21Z", "commit": {"oid": "150dd0e6eda3cd7f04e60c9dc1e11199be41cfaf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1392, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}