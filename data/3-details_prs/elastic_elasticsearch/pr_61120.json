{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3NjI0MzUz", "number": 61120, "title": "Doc: Max field expansions is not a hard limit", "bodyText": "Limiting the number of auto-expanded fieldsedit\nExecuting queries that use automatic expansion of fields (e.g. query_string, simple_query_string or multi_match) can have performance issues for indices with a large numbers of fields. To safeguard against this, a hard limit of 1024 fields has been introduced for queries using the \"all fields\" mode (\"default_field\": \"\") or other fieldname expansions (e.g. \"foo\").\n\nPer #35284, we changed this from a hard limit to a soft limit by leveraging indices.query.bool.max_clause_count in 7.0 beta1.   It looks like we might have missed the doc change in the breaking changes guide.  We will want to backport this to all 7.x versions.", "createdAt": "2020-08-13T20:45:01Z", "url": "https://github.com/elastic/elasticsearch/pull/61120", "merged": true, "mergeCommit": {"oid": "d6ad247e0786c2a8377a7a6f9eecbaa4d3343092"}, "closed": true, "closedAt": "2020-08-18T15:39:09Z", "author": {"login": "ppf2"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-mQRQgH2gAyNDY3NjI0MzUzOmMxOTdjMDEwYmQ1NjI5OTc3ODhiNDNlMjUxNGU1NTA1ZWM4ZWIzMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAINnigH2gAyNDY3NjI0MzUzOjFlZWMxYzJjNGI1ZjM3M2I3YWMwNzVkNzMwNmQyMTQzNDBiYTdjOTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c197c010bd562997788b43e2514e5505ec8eb30e", "author": {"user": {"login": "ppf2", "name": "Pius"}}, "url": "https://github.com/elastic/elasticsearch/commit/c197c010bd562997788b43e2514e5505ec8eb30e", "committedDate": "2020-08-13T20:43:33Z", "message": "Max field expansions is not a hard limit\n\n>Limiting the number of auto-expanded fieldsedit\r\nExecuting queries that use automatic expansion of fields (e.g. query_string, simple_query_string or multi_match) can have performance issues for indices with a large numbers of fields. To safeguard against this, a hard limit of 1024 fields has been introduced for queries using the \"all fields\" mode (\"default_field\": \"\") or other fieldname expansions (e.g. \"foo\").\r\n\r\nPer https://github.com/elastic/elasticsearch/pull/35284, it looks like we changed this from a hard limit to a soft limit by leveraging `indices.query.bool.max_clause_count` in 7.0 beta1.  We will want to backport this to all 7.x versions."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTIzMDk0", "url": "https://github.com/elastic/elasticsearch/pull/61120#pullrequestreview-469523094", "createdAt": "2020-08-18T14:39:34Z", "commit": {"oid": "c197c010bd562997788b43e2514e5505ec8eb30e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDozOTozNFrOHCXwPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDozOTozNFrOHCXwPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI0ODM4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To safeguard against this, a soft limit of 1024 fields has been introduced for queries\n          \n          \n            \n            using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n          \n          \n            \n            This default maximum can be changed with the dynamic cluster setting `indices.query.bool.max_clause_count`.\n          \n          \n            \n            To safeguard against this, a default limit of 1024 fields has been introduced for\n          \n          \n            \n            queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n          \n          \n            \n            expansions (e.g. \"foo*\"). If needed, you can change this limit using the\n          \n          \n            \n            <<indices-query-bool-max-clause-count,`indices.query.bool.max_clause_count`>>\n          \n          \n            \n            dynamic cluster setting.", "url": "https://github.com/elastic/elasticsearch/pull/61120#discussion_r472248380", "createdAt": "2020-08-18T14:39:34Z", "author": {"login": "jrodewig"}, "path": "docs/reference/migration/migrate_7_0/search.asciidoc", "diffHunk": "@@ -149,8 +149,9 @@ for a particular index with the index setting `index.max_regex_length`.\n \n Executing queries that use automatic expansion of fields (e.g. `query_string`, `simple_query_string`\n or `multi_match`) can have performance issues for indices with a large numbers of fields.\n-To safeguard against this, a hard limit of 1024 fields has been introduced for queries\n+To safeguard against this, a soft limit of 1024 fields has been introduced for queries\n using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n+This default maximum can be changed with the dynamic cluster setting `indices.query.bool.max_clause_count`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c197c010bd562997788b43e2514e5505ec8eb30e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f697ce27a55169415a2b8a30db918fadadacb478", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/f697ce27a55169415a2b8a30db918fadadacb478", "committedDate": "2020-08-18T14:40:45Z", "message": "Update docs/reference/migration/migrate_7_0/search.asciidoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTM0NzQ0", "url": "https://github.com/elastic/elasticsearch/pull/61120#pullrequestreview-469534744", "createdAt": "2020-08-18T14:51:12Z", "commit": {"oid": "f697ce27a55169415a2b8a30db918fadadacb478"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDo1MToxMlrOHCYTlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDo1MToxMlrOHCYTlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI1NzQyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n          \n          \n            \n            expansions (e.g. \"foo*\"). If needed, you can change this limit using the\n          \n          \n            \n            queries using the \"all fields\" mode (`\"default_field\": \"*\"`) or other fieldname\n          \n          \n            \n            expansions (e.g. `\"foo*\"`). If needed, you can change this limit using the", "url": "https://github.com/elastic/elasticsearch/pull/61120#discussion_r472257428", "createdAt": "2020-08-18T14:51:12Z", "author": {"login": "jrodewig"}, "path": "docs/reference/migration/migrate_7_0/search.asciidoc", "diffHunk": "@@ -149,8 +149,11 @@ for a particular index with the index setting `index.max_regex_length`.\n \n Executing queries that use automatic expansion of fields (e.g. `query_string`, `simple_query_string`\n or `multi_match`) can have performance issues for indices with a large numbers of fields.\n-To safeguard against this, a hard limit of 1024 fields has been introduced for queries\n-using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n+To safeguard against this, a default limit of 1024 fields has been introduced for\n+queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n+expansions (e.g. \"foo*\"). If needed, you can change this limit using the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f697ce27a55169415a2b8a30db918fadadacb478"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1eec1c2c4b5f373b7ac075d7306d214340ba7c94", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/1eec1c2c4b5f373b7ac075d7306d214340ba7c94", "committedDate": "2020-08-18T14:51:21Z", "message": "Fix formatting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3300, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}