{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5Mzg1Njkz", "number": 56888, "title": "Ensure template exists when creating data stream", "bodyText": "Limit the creation of data streams only for namespaces that have a composable template with a data stream definition.\nThis way we ensure that mappings/settings have been specified and will be used at data stream creation and data stream rollover.\nRelates to #53100", "createdAt": "2020-05-18T09:46:53Z", "url": "https://github.com/elastic/elasticsearch/pull/56888", "merged": true, "mergeCommit": {"oid": "f8b090b6418c8babaa402d0c210eb7f3c248a59f"}, "closed": true, "closedAt": "2020-05-28T11:11:16Z", "author": {"login": "martijnvg"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcicrZZgH2gAyNDE5Mzg1NjkzOmRlZWQ4Yzc0YjEwOWJkMmFhMzQ4YzM4YTk3MzlmZjRkMWExNjg1Y2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclqbE2AH2gAyNDE5Mzg1NjkzOjExNWM5Y2QwOGQ5M2VjNTgxMGVkZWNhMmE3ZDQxZmE5YzgzYjE5ZjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "deed8c74b109bd2aa348c38a9739ff4d1a1685cb", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/deed8c74b109bd2aa348c38a9739ff4d1a1685cb", "committedDate": "2020-05-18T09:44:15Z", "message": "Ensure template exists when creating data stream\n\nLimit the creation of data streams only for namespaces that have a composable template with a data stream definition.\nThis way we ensure that mappings/settings have been specified and will be used at data stream creation and data stream rollover.\n\nRelates to #53100"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6bb38f16a240525fb809079b5ce6d3c0f91a600", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/b6bb38f16a240525fb809079b5ce6d3c0f91a600", "committedDate": "2020-05-18T10:56:16Z", "message": "fixed yaml issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6d675cb6c13396443944a97a76abfc8b1b96d7f", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/e6d675cb6c13396443944a97a76abfc8b1b96d7f", "committedDate": "2020-05-18T11:16:37Z", "message": "fixed checkstyle violation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04341ac5e4afe4f0da0acbddf66575ad24cf7b4e", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/04341ac5e4afe4f0da0acbddf66575ad24cf7b4e", "committedDate": "2020-05-18T11:47:41Z", "message": "fixed test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTE1MzA1", "url": "https://github.com/elastic/elasticsearch/pull/56888#pullrequestreview-415115305", "createdAt": "2020-05-20T08:41:00Z", "commit": {"oid": "04341ac5e4afe4f0da0acbddf66575ad24cf7b4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwODo0MTowMFrOGYBP2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwODo0MTowMFrOGYBP2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzgzOTQ0OA==", "bodyText": "Should we enforce that the timestamp field on the create data stream request is the same as the timestamp field in the data stream template? This can be different if a user provided a different timestamp field via the create data stream api.\nIf we do enforce this then I think that we should remove the timestamp field from the create data stream request and always use the timestamp field provided in the data stream template inside a itv2.", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r427839448", "createdAt": "2020-05-20T08:41:00Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataCreateDataStreamService.java", "diffHunk": "@@ -145,4 +147,16 @@ static ClusterState createDataStream(MetadataCreateIndexService metadataCreateIn\n         return ClusterState.builder(currentState).metadata(builder).build();\n     }\n \n+    public static void validateTemplateForDataStream(String dataStreamName, Metadata metadata) {\n+        final String v2Template = MetadataIndexTemplateService.findV2Template(metadata, dataStreamName, false);\n+        if (v2Template == null) {\n+            throw new IllegalArgumentException(\"no matching index template found for data stream [\" + dataStreamName + \"]\");\n+        }\n+        IndexTemplateV2 indexTemplateV2 = metadata.templatesV2().get(v2Template);\n+        if (indexTemplateV2.getDataStreamTemplate() == null) {\n+            throw new IllegalArgumentException(\"matching index template [\" + v2Template + \"] for data stream [\" + dataStreamName  +\n+                \"] has no data stream template\");\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "04341ac5e4afe4f0da0acbddf66575ad24cf7b4e"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8a91d2305a605b9c6b97ef99392be60765fbfbc", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/f8a91d2305a605b9c6b97ef99392be60765fbfbc", "committedDate": "2020-05-20T12:29:30Z", "message": "Merge remote-tracking branch 'es/master' into ensure_itv2_exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb2294dd6f54d3f25dbc7f8042b5fe3337004e9d", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/fb2294dd6f54d3f25dbc7f8042b5fe3337004e9d", "committedDate": "2020-05-20T14:54:04Z", "message": "Remove timestamp_field from create data stream request and\nlet the create data stream api resolve the timestamp field\nfrom the data stream template snippet inside an itv2."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d716508235ad2f08b787f6d63c9e18f7c63c35c", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/6d716508235ad2f08b787f6d63c9e18f7c63c35c", "committedDate": "2020-05-20T17:04:35Z", "message": "adjusted docs tests and skip data stream bwc tests until backported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/825c787af936f1399dd7180c326f6fd2e31b2d70", "committedDate": "2020-05-20T20:37:47Z", "message": "fixed docs test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDc5NTEz", "url": "https://github.com/elastic/elasticsearch/pull/56888#pullrequestreview-418079513", "createdAt": "2020-05-26T08:30:02Z", "commit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "state": "COMMENTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODozMDowM1rOGaT9FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxMjowNlrOGaVgww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0MzA5Mg==", "bodyText": "I would prefer to just delete the specific template?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430243092", "createdAt": "2020-05-26T08:30:03Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/create-data-stream.asciidoc", "diffHunk": "@@ -23,18 +23,31 @@ addressed directly, data streams are integrated with the\n <<index-lifecycle-management, index lifecycle management (ILM)>> to facilitate\n the management of the time series data contained in their backing indices.\n \n+////\n [source,console]\n---------------------------------------------------\n-PUT _data_stream/my-data-stream\n+-----------------------------------\n+PUT _index_template/template\n {\n-  \"timestamp_field\": \"@timestamp\"\n+  \"index_patterns\": [\"my-data-stream*\"],\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"\n+  }\n }\n+-----------------------------------\n+// TEST\n+////\n+\n+[source,console]\n --------------------------------------------------\n+PUT _data_stream/my-data-stream\n+--------------------------------------------------\n+// TEST[continued]\n \n ////\n [source,console]\n -----------------------------------\n DELETE /_data_stream/my-data-stream\n+DELETE /_index_template/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0NDcxNA==", "bodyText": "The text further down explains that there is a timestamp field in the body, I think that should be removed now?\nMaybe we also need a short description stating that you can only create data-streams into namespaces where a template exists with a data_stream declaration on it? Maybe this is special enough that we should include creating the template into the text too, in order to ensure that the first thing users try out with data-streams works?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430244714", "createdAt": "2020-05-26T08:32:47Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/create-data-stream.asciidoc", "diffHunk": "@@ -23,18 +23,31 @@ addressed directly, data streams are integrated with the\n <<index-lifecycle-management, index lifecycle management (ILM)>> to facilitate\n the management of the time series data contained in their backing indices.\n \n+////\n [source,console]\n---------------------------------------------------\n-PUT _data_stream/my-data-stream\n+-----------------------------------\n+PUT _index_template/template\n {\n-  \"timestamp_field\": \"@timestamp\"\n+  \"index_patterns\": [\"my-data-stream*\"],\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"\n+  }\n }\n+-----------------------------------\n+// TEST\n+////\n+\n+[source,console]\n --------------------------------------------------\n+PUT _data_stream/my-data-stream", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0NTE2NA==", "bodyText": "I would prefer to just delete the specific template.", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430245164", "createdAt": "2020-05-26T08:33:35Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/delete-data-stream.asciidoc", "diffHunk": "@@ -22,6 +27,13 @@ PUT /_data_stream/my-data-stream\n DELETE _data_stream/my-data-stream\n --------------------------------------------------\n \n+////\n+[source,console]\n+-----------------------------------\n+DELETE /_index_template/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0NjE1Mw==", "bodyText": "One more...", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430246153", "createdAt": "2020-05-26T08:35:15Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/get-data-stream.asciidoc", "diffHunk": "@@ -21,6 +26,7 @@ PUT /_data_stream/my-data-stream\n [source,console]\n -----------------------------------\n DELETE /_data_stream/my-data-stream\n+DELETE /_index_template/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0OTA0NA==", "bodyText": "I wonder if we should include creating the template into the text in order to make the example more complete?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430249044", "createdAt": "2020-05-26T08:39:58Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/rollover-index.asciidoc", "diffHunk": "@@ -225,12 +225,23 @@ The API returns the following response:\n [[rollover-data-stream-ex]]\n ===== Roll over a data stream\n \n+////", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI0OTI3MA==", "bodyText": "Prefer specific name here too.", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430249270", "createdAt": "2020-05-26T08:40:19Z", "author": {"login": "henningandersen"}, "path": "docs/reference/indices/rollover-index.asciidoc", "diffHunk": "@@ -286,6 +298,7 @@ The API returns the following response:\n [source,console]\n -----------------------------------\n DELETE /_data_stream/my-data-stream\n+DELETE /_index_template/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1MTk2Mg==", "bodyText": "I think we need a test verifying the behavior when attempting to create a data-stream into a name where there is no template and also into a name where the template is not a data-stream?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430251962", "createdAt": "2020-05-26T08:44:46Z", "author": {"login": "henningandersen"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/test/indices.data_stream/10_basic.yml", "diffHunk": "@@ -1,21 +1,39 @@\n+setup:\n+  - skip:\n+      features: allowed_warnings\n+  - do:\n+      allowed_warnings:\n+        - \"index template [my-template1] has index patterns [simple-data-stream1*] matching patterns from existing older templates [global] with patterns (global => [*]); this template [my-template1] will take precedence during new index creation\"\n+      indices.put_index_template:\n+        name: my-template1\n+        body:\n+          index_patterns: [simple-data-stream1]\n+          data_stream:\n+            timestamp_field: '@timestamp'\n+  - do:\n+      allowed_warnings:\n+        - \"index template [my-template2] has index patterns [simple-data-stream2*] matching patterns from existing older templates [global] with patterns (global => [*]); this template [my-template2] will take precedence during new index creation\"\n+      indices.put_index_template:\n+        name: my-template2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1MjgyNA==", "bodyText": "I wonder if this should use a name that matches one of the templates (but is still illegal) to ensure that the error is really due to the name check and not the template/data-stream check?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430252824", "createdAt": "2020-05-26T08:46:10Z", "author": {"login": "henningandersen"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/test/indices.data_stream/10_basic.yml", "diffHunk": "@@ -62,62 +80,56 @@\n ---\n \"Create data stream with invalid name\":\n   - skip:\n-      version: \" - 7.8.99\"\n-      reason: \"data streams only supported in 7.9+\"\n+      version: \" - 7.99.99\"\n+      reason:  \"mute bwc until backported\"\n \n   - do:\n       catch: bad_request\n       indices.create_data_stream:\n         name: invalid-data-stream#-name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2MzI2MA==", "bodyText": "I think this makes settings unused? But I am also uncertain of why this change was made? Just cleanup or a necessity. If the latter, I would like to understand why.", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430263260", "createdAt": "2020-05-26T09:03:08Z", "author": {"login": "henningandersen"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/action/bulk/BulkIntegrationIT.java", "diffHunk": "@@ -218,14 +217,14 @@ public void testDeleteIndexWhileIndexing() throws Exception {\n         }\n     }\n \n-    public void testMixedAutoCreate() {\n+    public void testMixedAutoCreate() throws Exception {\n         Settings settings = Settings.builder().put(IndexMetadata.SETTING_NUMBER_OF_REPLICAS, 0).build();\n \n         PutIndexTemplateV2Action.Request createTemplateRequest = new PutIndexTemplateV2Action.Request(\"logs-foo\");\n         createTemplateRequest.indexTemplate(\n             new IndexTemplateV2(\n                 List.of(\"logs-foo*\"),\n-                new Template(settings, null, null),\n+                null,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2NDkyNA==", "bodyText": "This is fine, but I wonder if we should follow-up with generically removing all v2 templates like we do for regular templates?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430264924", "createdAt": "2020-05-26T09:05:54Z", "author": {"login": "henningandersen"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/indices/DataStreamIT.java", "diffHunk": "@@ -72,13 +77,19 @@\n \n public class DataStreamIT extends ESIntegTestCase {\n \n+    @After", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2ODYxMQ==", "bodyText": "nit: seems like a strange secret choice of _id, maybe just use template?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430268611", "createdAt": "2020-05-26T09:12:06Z", "author": {"login": "henningandersen"}, "path": "server/src/test/java/org/elasticsearch/action/admin/indices/rollover/MetadataRolloverServiceTests.java", "diffHunk": "@@ -515,7 +515,10 @@ public void testRolloverClusterState() throws Exception {\n \n     public void testRolloverClusterStateForDataStream() throws Exception {\n         final DataStream dataStream = DataStreamTests.randomInstance();\n+        IndexTemplateV2 template = new IndexTemplateV2(List.of(dataStream.getName() + \"*\"), null, null, null, null, null,\n+            new IndexTemplateV2.DataStreamTemplate(\"@timestamp\"));\n         Metadata.Builder builder = Metadata.builder();\n+        builder.put(\"_id\", template);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "825c787af936f1399dd7180c326f6fd2e31b2d70"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08739e91bd0c8ec6f31fef02728a1a71baa0af9e", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/08739e91bd0c8ec6f31fef02728a1a71baa0af9e", "committedDate": "2020-05-26T11:18:15Z", "message": "Merge remote-tracking branch 'es/master' into ensure_itv2_exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "491a9c545bd19739a7cde2fce32a6ff7fca0fcd9", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/491a9c545bd19739a7cde2fce32a6ff7fca0fcd9", "committedDate": "2020-05-26T12:35:49Z", "message": "applied feedback comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NTg0NzEx", "url": "https://github.com/elastic/elasticsearch/pull/56888#pullrequestreview-418584711", "createdAt": "2020-05-26T18:53:48Z", "commit": {"oid": "491a9c545bd19739a7cde2fce32a6ff7fca0fcd9"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxODo1Mzo0OFrOGar4Bw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOTowNjo0OFrOGasU_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNTAxNQ==", "bodyText": "Nit: ...has a component template that exists... or ...has an existing component template...", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430635015", "createdAt": "2020-05-26T18:53:48Z", "author": {"login": "danhermann"}, "path": "docs/reference/indices/create-data-stream.asciidoc", "diffHunk": "@@ -23,18 +23,32 @@ addressed directly, data streams are integrated with the\n <<index-lifecycle-management, index lifecycle management (ILM)>> to facilitate\n the management of the time series data contained in their backing indices.\n \n+A data stream can only be created if the namespace it targets has a component\n+template exists with a `data_stream` definition.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "491a9c545bd19739a7cde2fce32a6ff7fca0fcd9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzOTkwOA==", "bodyText": "Also, are we calling these composable templates now?", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430639908", "createdAt": "2020-05-26T19:02:08Z", "author": {"login": "danhermann"}, "path": "docs/reference/indices/create-data-stream.asciidoc", "diffHunk": "@@ -23,18 +23,32 @@ addressed directly, data streams are integrated with the\n <<index-lifecycle-management, index lifecycle management (ILM)>> to facilitate\n the management of the time series data contained in their backing indices.\n \n+A data stream can only be created if the namespace it targets has a component\n+template exists with a `data_stream` definition.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNTAxNQ=="}, "originalCommit": {"oid": "491a9c545bd19739a7cde2fce32a6ff7fca0fcd9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MjQyOQ==", "bodyText": "I think that this documentation on timestamp_field should be preserved somewhere else, perhaps in the documentation on creating composable templates.", "url": "https://github.com/elastic/elasticsearch/pull/56888#discussion_r430642429", "createdAt": "2020-05-26T19:06:48Z", "author": {"login": "danhermann"}, "path": "docs/reference/indices/create-data-stream.asciidoc", "diffHunk": "@@ -71,11 +85,3 @@ Data stream names must meet the following criteria:\n will count towards the 255 limit faster)\n --\n \n-[[indices-create-data-stream-api-request-body]]\n-==== {api-request-body-title}\n-\n-`timestamp_field`::\n-(Required, string) The name of the timestamp field. This field must be present\n-in all documents indexed into the data stream and must be of type\n-<<date, `date`>> or <<date_nanos, `date_nanos`>>.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "491a9c545bd19739a7cde2fce32a6ff7fca0fcd9"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4897f4bb5c2e6c44a7040454fad6954eb2cca9c", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/f4897f4bb5c2e6c44a7040454fad6954eb2cca9c", "committedDate": "2020-05-27T08:06:15Z", "message": "Merge remote-tracking branch 'es/master' into ensure_itv2_exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d30aeed7441802ca82aa19f1d8d77295e9afe9a", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/7d30aeed7441802ca82aa19f1d8d77295e9afe9a", "committedDate": "2020-05-27T08:12:58Z", "message": "added docs about data_stream definition in a composable template."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78cf3882539da82a939d384237f62c88bcb9e2c5", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/78cf3882539da82a939d384237f62c88bcb9e2c5", "committedDate": "2020-05-27T08:18:26Z", "message": "altered snippet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8abd45ce9a0159c645309ae5aac372661e0ec32", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/d8abd45ce9a0159c645309ae5aac372661e0ec32", "committedDate": "2020-05-28T09:00:43Z", "message": "Merge remote-tracking branch 'es/master' into ensure_itv2_exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "115c9cd08d93ec5810edeca2a7d41fa9c83b19f6", "author": {"user": {"login": "martijnvg", "name": "Martijn van Groningen"}}, "url": "https://github.com/elastic/elasticsearch/commit/115c9cd08d93ec5810edeca2a7d41fa9c83b19f6", "committedDate": "2020-05-28T09:26:52Z", "message": "fixed compile errors after merging in master"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4844, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}