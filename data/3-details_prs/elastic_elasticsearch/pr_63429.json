{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5Mzg4ODc4", "number": 63429, "title": "Add explanation to runtime field query", "bodyText": "This adds a detail to the output of explain for runtime fields\nqueries that makes it clear that their score is entirely based on their\nboost. We don't have any tf/idf/norms/whatever to do any scoring - we\njust score boost.", "createdAt": "2020-10-07T16:55:51Z", "url": "https://github.com/elastic/elasticsearch/pull/63429", "merged": true, "mergeCommit": {"oid": "6dfb37655dd5fe37223e82503d9f47727a1d564c"}, "closed": true, "closedAt": "2020-10-08T16:46:47Z", "author": {"login": "nik9000"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQP8jCAH2gAyNDk5Mzg4ODc4OmRmODBmZGJiMjBjZTUzZDJkNWZiNGM3NGYyNDBkZTAwZTRhNjJhNDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQjPOkAH2gAyNDk5Mzg4ODc4OjZlZDBkNWE3MTI1OGY1MWFhNmMzMDEwM2U5Y2VlNmFjYjBkNWM0ZDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/df80fdbb20ce53d2d5fb4c74f240de00e4a62a48", "committedDate": "2020-10-07T16:54:44Z", "message": "Add explanation to runtime field query\n\nThis adds a `detail` to the output of `explain` for runtime fields\nqueries that makes it clear that their score is entirely based on their\nboost. We don't have any tf/idf/norms/whatever to do any scoring - we\njust score `boost`."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDg0MDcx", "url": "https://github.com/elastic/elasticsearch/pull/63429#pullrequestreview-504084071", "createdAt": "2020-10-07T16:56:36Z", "commit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNjo1NjozNlrOHd808w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNjo1NjozNlrOHd808w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE2NzM0Nw==", "bodyText": "I went with fairly simple integration tests for this instead of unit tests because it felt easier. I could go either way, but I think this gets the job done.", "url": "https://github.com/elastic/elasticsearch/pull/63429#discussion_r501167347", "createdAt": "2020-10-07T16:56:36Z", "author": {"login": "nik9000"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/runtime_fields/10_keyword.yml", "diffHunk": "@@ -155,6 +155,21 @@ setup:\n   - match: {hits.total.value: 1}\n   - match: {hits.hits.0._source.voltage: 5.8}\n \n+---\n+\"explain term query\":\n+  - do:\n+      search:\n+        index: sensor\n+        explain: true\n+        body:\n+          query:\n+            term:\n+              day_of_week: Monday\n+  - match: {hits.hits.0._explanation.description: day_of_week:Monday}\n+  - match: {hits.hits.0._explanation.details.0.value: 1.0}\n+  - match: {hits.hits.0._explanation.details.0.description: 'runtime field query scoring boost'}\n+  - match: {hits.hits.0._explanation.details.0.details: []}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NTA1NjA4", "url": "https://github.com/elastic/elasticsearch/pull/63429#pullrequestreview-504505608", "createdAt": "2020-10-08T07:40:43Z", "commit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzo0MDo0NFrOHeRwxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzo0MToxNFrOHeRx6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUxMDM0Mg==", "bodyText": "I am being picky about the description: the boost is provided with a query right? I am wondering if the boost itself has anything special, specifically related to runtime fields. It feels to me that the boost is just a boost, what is special is that with runtime fields it's the only factor in scoring calculation. What I am getting to is that we could make the detail even clearer, probably. Thinking out loud: should we have two items in details, one that is a constant, that explains that the field is a runtime fields, and the other one that is the actual query boost?\nMaybe we should have a couple more tests around providing a boost with the query, and customizing the score with a script?", "url": "https://github.com/elastic/elasticsearch/pull/63429#discussion_r501510342", "createdAt": "2020-10-08T07:40:44Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/runtime_fields/10_keyword.yml", "diffHunk": "@@ -155,6 +155,21 @@ setup:\n   - match: {hits.total.value: 1}\n   - match: {hits.hits.0._source.voltage: 5.8}\n \n+---\n+\"explain term query\":\n+  - do:\n+      search:\n+        index: sensor\n+        explain: true\n+        body:\n+          query:\n+            term:\n+              day_of_week: Monday\n+  - match: {hits.hits.0._explanation.description: day_of_week:Monday}\n+  - match: {hits.hits.0._explanation.details.0.value: 1.0}\n+  - match: {hits.hits.0._explanation.details.0.description: 'runtime field query scoring boost'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUxMDYzNQ==", "bodyText": "thats fine with me, maybe a small unit test for the lucene query would be also useful?", "url": "https://github.com/elastic/elasticsearch/pull/63429#discussion_r501510635", "createdAt": "2020-10-08T07:41:14Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/runtime_fields/10_keyword.yml", "diffHunk": "@@ -155,6 +155,21 @@ setup:\n   - match: {hits.total.value: 1}\n   - match: {hits.hits.0._source.voltage: 5.8}\n \n+---\n+\"explain term query\":\n+  - do:\n+      search:\n+        index: sensor\n+        explain: true\n+        body:\n+          query:\n+            term:\n+              day_of_week: Monday\n+  - match: {hits.hits.0._explanation.description: day_of_week:Monday}\n+  - match: {hits.hits.0._explanation.details.0.value: 1.0}\n+  - match: {hits.hits.0._explanation.details.0.description: 'runtime field query scoring boost'}\n+  - match: {hits.hits.0._explanation.details.0.details: []}\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE2NzM0Nw=="}, "originalCommit": {"oid": "df80fdbb20ce53d2d5fb4c74f240de00e4a62a48"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35a7d647690cb62eed04a4cc6346e2a052f835a0", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/35a7d647690cb62eed04a4cc6346e2a052f835a0", "committedDate": "2020-10-08T14:24:53Z", "message": "call out boost"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0ODk4MjQy", "url": "https://github.com/elastic/elasticsearch/pull/63429#pullrequestreview-504898242", "createdAt": "2020-10-08T15:20:32Z", "commit": {"oid": "35a7d647690cb62eed04a4cc6346e2a052f835a0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ed0d5a71258f51aa6c30103e9cee6acb0d5c4d1", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/6ed0d5a71258f51aa6c30103e9cee6acb0d5c4d1", "committedDate": "2020-10-08T15:23:20Z", "message": "Add test for script score"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4182, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}