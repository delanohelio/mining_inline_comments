{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNDI3OTUx", "number": 50737, "title": "Refactor GeoShape tests to GeoShape and GeoPoint", "bodyText": "Refactor of GeoShape tests to separate GeoShape and GeoPoint as preliminary step prior to implementing #48928\nAdded new methods to avoid duplicate code for mapping creation\nAll existing tests passed post refactor in org.elasticsearch.search.geo.*\nNew placeholder test in GeoPointShapeQueryTests is non-failing pending 48928\nNote commit 24b9535 has been reset by d7f2218 this will be reincorporated as part of 48928", "createdAt": "2020-01-08T12:12:22Z", "url": "https://github.com/elastic/elasticsearch/pull/50737", "merged": true, "mergeCommit": {"oid": "dd409e17cb1bc50d89fd8f6dba98be73282993d0"}, "closed": true, "closedAt": "2020-01-27T10:39:12Z", "author": {"login": "djptek"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbnA9trgH2gAyMzYwNDI3OTUxOmE1ZjA5ZmJmYmUyMWZlZTE5NjA0NjdkYTRjZTZkMTI0YTFiYzUwMWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-Zo2ogFqTM0ODUzODQ3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a5f09fbfbe21fee1960467da4ce6d124a1bc501f", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/a5f09fbfbe21fee1960467da4ce6d124a1bc501f", "committedDate": "2019-11-15T18:05:23Z", "message": "WIP subclassing GeoShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "478cee77cd823009bf0f7ac7a622e09ca3efc35f", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/478cee77cd823009bf0f7ac7a622e09ca3efc35f", "committedDate": "2019-11-18T17:17:59Z", "message": "WIP subclassing GeoShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd06e44089a94b605d6a2d3f77fbb9a4828d14c", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/ebd06e44089a94b605d6a2d3f77fbb9a4828d14c", "committedDate": "2019-11-19T12:34:44Z", "message": "WIP subclassing GeoShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d3c189b8cdaf9d644af94399d15e6207a19594d", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/5d3c189b8cdaf9d644af94399d15e6207a19594d", "committedDate": "2019-11-19T19:58:13Z", "message": "WIP writing GeoPointShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab60f0679b0837885dde114f8870e6484ba4077d", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/ab60f0679b0837885dde114f8870e6484ba4077d", "committedDate": "2019-11-20T19:07:45Z", "message": "Added Failing Test testIndexPointsFilterRectangle\n in Class org.elasticsearch.search.geo.GeoPointShapeQueryTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c22308fa23135907331c969f1f16459789b0eccd", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/c22308fa23135907331c969f1f16459789b0eccd", "committedDate": "2019-11-20T19:20:10Z", "message": "Merge branch 'master' into geo-shape-query-vs-geo-point"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "443441c728982862c9cf5112afc231ea6f9683e8", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/443441c728982862c9cf5112afc231ea6f9683e8", "committedDate": "2019-11-21T20:16:16Z", "message": "Merge branch 'master' into geo-shape-query-vs-geo-point"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24b95358fca9a5b1f266651ac507fe17115a5e35", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/24b95358fca9a5b1f266651ac507fe17115a5e35", "committedDate": "2019-11-23T19:40:19Z", "message": "permit GeoShapeQueryBuilder to accept a geo_point -> class_cast_exception raised, see org.elasticsearch.index.query.QueryShardContext.toQuery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59c1bfcd37b42af01746e17c7a55a1557142aac1", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/59c1bfcd37b42af01746e17c7a55a1557142aac1", "committedDate": "2019-12-02T18:03:56Z", "message": "added @Override protected XContentBuilder createMapping\nin GeoPointShapeQueryTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "192ad15e5e73a57e8b909360130fb14c8ca458c4", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/192ad15e5e73a57e8b909360130fb14c8ca458c4", "committedDate": "2020-01-07T08:59:26Z", "message": "merged upstream including 418edc6 types fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddc9e8cc08d288cbc0b03bd49880a16b7fba27f1", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/ddc9e8cc08d288cbc0b03bd49880a16b7fba27f1", "committedDate": "2020-01-07T15:26:12Z", "message": "repeat refactor post type removal and remove remaining types from GeoShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f3bd915b56e3c5ca26fc19d0a63a66003e3f0cc", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/0f3bd915b56e3c5ca26fc19d0a63a66003e3f0cc", "committedDate": "2020-01-07T15:27:59Z", "message": "tidy GeoPointShapeQueryTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d68e7febd1033882c125def51cc604e8ecaeac1", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/6d68e7febd1033882c125def51cc604e8ecaeac1", "committedDate": "2020-01-08T10:06:11Z", "message": "interim checkin, still failing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d880c260540139a356be59d161d99436ac9070a", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/2d880c260540139a356be59d161d99436ac9070a", "committedDate": "2020-01-08T11:11:41Z", "message": "GeoShapeQueryTests.java passing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e275f3eb0a771fd11aa967b4d7653f7f64276a87", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/e275f3eb0a771fd11aa967b4d7653f7f64276a87", "committedDate": "2020-01-08T11:21:19Z", "message": "GeoShapeQueryTests.java extends GeoQueryTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "316c7b18e843fef85c668aaf3aefdb69d9909b17", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/316c7b18e843fef85c668aaf3aefdb69d9909b17", "committedDate": "2020-01-08T11:35:58Z", "message": "refactored + tests passing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7e5e7b86c853314445938090fc4782fbd58b45e", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/e7e5e7b86c853314445938090fc4782fbd58b45e", "committedDate": "2020-01-08T11:43:10Z", "message": "refactored + tests passing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7f2218a3ca3fa0d87e888d68bd6ec5ed1db6afb", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/d7f2218a3ca3fa0d87e888d68bd6ec5ed1db6afb", "committedDate": "2020-01-08T11:58:43Z", "message": "reset GeoShapeQueryBuilder.java for future PR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNDQzNDA4", "url": "https://github.com/elastic/elasticsearch/pull/50737#pullrequestreview-340443408", "createdAt": "2020-01-09T11:05:06Z", "commit": {"oid": "d7f2218a3ca3fa0d87e888d68bd6ec5ed1db6afb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMTowNTowNlrOFbyUuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMTowNTowNlrOFbyUuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY4MDM3OQ==", "bodyText": "I think this test should be in GeoQueryTests? I guess the idea of the subclass is that all test with points should be in that class so they are called with geo_point fields and geo_shape field?", "url": "https://github.com/elastic/elasticsearch/pull/50737#discussion_r364680379", "createdAt": "2020-01-09T11:05:06Z", "author": {"login": "iverase"}, "path": "server/src/test/java/org/elasticsearch/search/geo/GeoPointShapeQueryTests.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.search.geo;\n+\n+import org.elasticsearch.common.Strings;\n+import org.elasticsearch.common.geo.builders.*;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentFactory;\n+import org.locationtech.jts.geom.Coordinate;\n+\n+import static org.elasticsearch.action.support.WriteRequest.RefreshPolicy.IMMEDIATE;\n+import static org.elasticsearch.common.xcontent.XContentFactory.jsonBuilder;\n+\n+public class GeoPointShapeQueryTests extends GeoQueryTests {\n+\n+    @Override\n+    protected XContentBuilder createMapping() throws Exception {\n+        XContentBuilder xcb = XContentFactory.jsonBuilder().startObject()\n+            .startObject(\"properties\").startObject(\"location\")\n+            .field(\"type\", \"geo_point\")\n+            .endObject().endObject().endObject();\n+\n+        return xcb;\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7f2218a3ca3fa0d87e888d68bd6ec5ed1db6afb"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e54c867b82cebac4bf144ccdf2a1c45961f509e9", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/e54c867b82cebac4bf144ccdf2a1c45961f509e9", "committedDate": "2020-01-09T18:29:03Z", "message": "improved refactoring see: https://github.com/elastic/elasticsearch/pull/50737#pullrequestreview-340443408"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9025578d4fb3b94aefb2b37671e699abff1df3f8", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/9025578d4fb3b94aefb2b37671e699abff1df3f8", "committedDate": "2020-01-14T14:03:34Z", "message": "refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13e8b00752d45d9290cb8f2d715cf8702a582f94", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/13e8b00752d45d9290cb8f2d715cf8702a582f94", "committedDate": "2020-01-24T13:31:26Z", "message": "Merge branch 'djptek-geo-shape-query-vs-geo-point'\n\nGeoShapeQueryTests refactored adding superclass and sibling to accomodate new test coverage as part of adaptation of geo_shape query to work on geo_point fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83504d1866b1ab048cfd8ac1967e63586f964ec5", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/83504d1866b1ab048cfd8ac1967e63586f964ec5", "committedDate": "2020-01-24T15:16:45Z", "message": "merged refactor changes to upstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d3676bc6a3e0e319d8fb44e3c9da196ef764207", "author": {"user": {"login": "djptek", "name": "Dominic Page"}}, "url": "https://github.com/elastic/elasticsearch/commit/4d3676bc6a3e0e319d8fb44e3c9da196ef764207", "committedDate": "2020-01-24T15:58:12Z", "message": "rectified Checkstyle rule violations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NTM4NDc4", "url": "https://github.com/elastic/elasticsearch/pull/50737#pullrequestreview-348538478", "createdAt": "2020-01-27T09:50:29Z", "commit": {"oid": "4d3676bc6a3e0e319d8fb44e3c9da196ef764207"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3917, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}