{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MTY1MTE0", "number": 54268, "title": "[DOCS] Reformat `flatten_graph` token filter", "bodyText": "Makes the following changes to the flatten_graph token filter docs:\n\nRewrites description and adds Lucene link\nAdds detailed analyze example\nAdds analyzer example", "createdAt": "2020-03-26T13:19:07Z", "url": "https://github.com/elastic/elasticsearch/pull/54268", "merged": true, "mergeCommit": {"oid": "24160366b868848dc8f26a3f6c970829c353e317"}, "closed": true, "closedAt": "2020-04-16T12:34:16Z", "author": {"login": "jrodewig"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRb7W8AH2gAyMzk0MTY1MTE0OjEzMGY2MDkxNzM1MjA2MWNlMmE1NTRiY2FlYTQ2ZTdkNmE3N2E1ZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYKmk1gFqTM5NDUyNDAxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "130f60917352061ce2a554bcaea46e7d6a77a5f4", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/130f60917352061ce2a554bcaea46e7d6a77a5f4", "committedDate": "2020-03-26T13:15:04Z", "message": "[DOCS] Reformat `flatten_graph` token filter\n\nMakes the following changes to the `flatten_graph` token filter docs:\n\n* Rewrites description and adds Lucene link\n* Adds detailed analyze example\n* Adds analyzer example"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65f5922b211aaf78202e4410591a38a0e0456df1", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/65f5922b211aaf78202e4410591a38a0e0456df1", "committedDate": "2020-03-26T13:38:41Z", "message": "reword"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NTY0NDQy", "url": "https://github.com/elastic/elasticsearch/pull/54268#pullrequestreview-385564442", "createdAt": "2020-04-01T13:06:20Z", "commit": {"oid": "65f5922b211aaf78202e4410591a38a0e0456df1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzowNjoyMFrOF-_rsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzowNjoyMFrOF-_rsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU5OTQwOQ==", "bodyText": "I think it would be good to reword this to strongly advise against using these at index time at all - generally speaking, filters that could produce graphs should be used at query time instead.  flatten_graph is a kind of shonky workaround for a problem that really should be fixed elsewhere.", "url": "https://github.com/elastic/elasticsearch/pull/54268#discussion_r401599409", "createdAt": "2020-04-01T13:06:20Z", "author": {"login": "romseygeek"}, "path": "docs/reference/analysis/tokenfilters/flatten-graph-tokenfilter.asciidoc", "diffHunk": "@@ -4,18 +4,232 @@\n <titleabbrev>Flatten graph</titleabbrev>\n ++++\n \n-The `flatten_graph` token filter accepts an arbitrary graph token\n-stream, such as that produced by\n-<<analysis-synonym-graph-tokenfilter>>, and flattens it into a single\n-linear chain of tokens suitable for indexing.\n-\n-This is a lossy process, as separate side paths are squashed on top of\n-one another, but it is necessary if you use a graph token stream\n-during indexing because a Lucene index cannot currently represent a\n-graph.  For this reason, it's best to apply graph analyzers only at\n-search time because that preserves the full graph structure and gives\n-correct matches for proximity queries.\n-\n-For more information on this topic and its various complexities,\n-please read the http://blog.mikemccandless.com/2012/04/lucenes-tokenstreams-are-actually.html[Lucene's\n-TokenStreams are actually graphs] blog post.\n+Flattens a <<token-graphs,token graph>> produced by a graph token filter, such\n+as <<analysis-synonym-graph-tokenfilter,`synonym_graph`>> or\n+<<analysis-word-delimiter-graph-tokenfilter,`word_delimiter_graph`>>.\n+\n+Flattening a token graph containing\n+<<token-graphs-multi-position-tokens,multi-position tokens>> makes the graph\n+suitable for <<analysis-index-search-time,indexing>>. Otherwise, indexing does\n+not support token graphs containing multi-position tokens.\n+\n+[WARNING]\n+====\n+Flattening graphs containing multi-position tokens is a lossy process.\n+Flattening collapses the side paths of a token graph into a linear path.\n+\n+If possible, avoid using graph token filters in\n+<<analysis-index-search-time,index analyzers>>. Use the respective\n+<<analysis-synonym-tokenfilter,`synonym`>> or\n+<<analysis-word-delimiter-tokenfilter,`word_delimiter`>> filters instead.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65f5922b211aaf78202e4410591a38a0e0456df1"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afcbebfb5ea49d3fe008d371fedd3ffb3e85cc0e", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/afcbebfb5ea49d3fe008d371fedd3ffb3e85cc0e", "committedDate": "2020-04-01T17:46:27Z", "message": "address feedback"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecb6b42236129eac9cc357c8d6a80c78db7cdd8d", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/ecb6b42236129eac9cc357c8d6a80c78db7cdd8d", "committedDate": "2020-04-01T17:44:12Z", "message": "address feedback"}, "afterCommit": {"oid": "afcbebfb5ea49d3fe008d371fedd3ffb3e85cc0e", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/afcbebfb5ea49d3fe008d371fedd3ffb3e85cc0e", "committedDate": "2020-04-01T17:46:27Z", "message": "address feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NTI0MDE5", "url": "https://github.com/elastic/elasticsearch/pull/54268#pullrequestreview-394524019", "createdAt": "2020-04-16T11:01:27Z", "commit": {"oid": "afcbebfb5ea49d3fe008d371fedd3ffb3e85cc0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1617, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}