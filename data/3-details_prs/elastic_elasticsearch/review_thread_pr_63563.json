{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNjA2NDU5", "number": 63563, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNzo0NDo1N1rOEs6IMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODo0MjoxN1rOEs7kWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NTI1MTY4OnYy", "diffSide": "RIGHT", "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNzo0NDo1N1rOHgZlKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODozODoyNlrOHgbtAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczNTU5Mw==", "bodyText": "With #63302, doc_count is no longer reported.\nPlease remove.", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503735593", "createdAt": "2020-10-13T07:44:57Z", "author": {"login": "przemekwitek"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,55 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>\n+         \"metrics\": {\n+            \"auc_roc\" : { <4>\n+              \"class_name\": \"dog\" <5>\n+            }\n+         }\n+      }\n+   }\n+}\n+--------------------------------------------------\n+// TEST[skip:TBD]\n+\n+<1> The evaluation type.\n+<2> The field that contains the ground truth value for the actual animal \n+classification. This is required in order to evaluate results.\n+<3> The field that contains the predicted value for animal classification by \n+the {classanalysis}.\n+<4> Specifies the metric for the evaluation.\n+<5> Specifies the class name that is treated as positive during the evaluation, \n+all the other classes are treated as negative.\n+\n+\n+The API returns the following result:\n+\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"classification\" : {\n+    \"auc_roc\" : {\n+      \"score\" : 0.8941788639536681, <1>\n+      \"doc_count\" : 4169 <2>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50933371d24a2303c989874f2d1cb187aed4831b"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MDM3MQ==", "bodyText": "@przemekwitek Done.", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503770371", "createdAt": "2020-10-13T08:38:26Z", "author": {"login": "szabosteve"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,55 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>\n+         \"metrics\": {\n+            \"auc_roc\" : { <4>\n+              \"class_name\": \"dog\" <5>\n+            }\n+         }\n+      }\n+   }\n+}\n+--------------------------------------------------\n+// TEST[skip:TBD]\n+\n+<1> The evaluation type.\n+<2> The field that contains the ground truth value for the actual animal \n+classification. This is required in order to evaluate results.\n+<3> The field that contains the predicted value for animal classification by \n+the {classanalysis}.\n+<4> Specifies the metric for the evaluation.\n+<5> Specifies the class name that is treated as positive during the evaluation, \n+all the other classes are treated as negative.\n+\n+\n+The API returns the following result:\n+\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"classification\" : {\n+    \"auc_roc\" : {\n+      \"score\" : 0.8941788639536681, <1>\n+      \"doc_count\" : 4169 <2>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczNTU5Mw=="}, "originalCommit": {"oid": "50933371d24a2303c989874f2d1cb187aed4831b"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NTQ4NzYwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODo0MjoxN1rOHgb2QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODo0NzoyNFrOHgcEOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MjczNw==", "bodyText": "This field is not used by auc_roc so you can remove it (but please double-check that the example is still working, there may be bugs...).", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503772737", "createdAt": "2020-10-13T08:42:17Z", "author": {"login": "przemekwitek"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,49 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3NjMxMw==", "bodyText": "I double-checked, it works fine without predicted_field. I removed this line from the call.", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503776313", "createdAt": "2020-10-13T08:47:24Z", "author": {"login": "szabosteve"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,49 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MjczNw=="}, "originalCommit": {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2939, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}