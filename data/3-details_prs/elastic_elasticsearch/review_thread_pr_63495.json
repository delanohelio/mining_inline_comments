{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5OTk0Mzc0", "number": 63495, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzowNToxOFrOEteV1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzowNToxOFrOEteV1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2MTE4NDg1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/search/collapse/CollapseBuilder.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxMzowNToxOVrOHhR_gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxOTo1Njo0MFrOHiXwKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY1OTg0MQ==", "bodyText": "Should we keep adding the field name to the error message to make it more actionable? Maybe we also have the actual field type available here to add to the error?", "url": "https://github.com/elastic/elasticsearch/pull/63495#discussion_r504659841", "createdAt": "2020-10-14T13:05:19Z", "author": {"login": "cbuescher"}, "path": "server/src/main/java/org/elasticsearch/search/collapse/CollapseBuilder.java", "diffHunk": "@@ -203,12 +202,9 @@ public CollapseContext build(QueryShardContext queryShardContext) {\n         if (fieldType == null) {\n             throw new IllegalArgumentException(\"no mapping found for `\" + field + \"` in order to collapse on\");\n         }\n-        if (fieldType instanceof KeywordFieldMapper.KeywordFieldType == false &&\n-            fieldType instanceof NumberFieldMapper.NumberFieldType == false) {\n-            throw new IllegalArgumentException(\"unknown type for collapse field `\" + field +\n-                \"`, only keywords and numbers are accepted\");\n+        if (fieldType.collapseType() == CollapseType.NONE) {\n+            throw new IllegalArgumentException(\"collapse is not supported on this field type\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2b4c423a489d70bdb6ccd40c7eec3966e396ec"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTgwMjc5Mg==", "bodyText": "@cbuescher Thanks for the feedback, addressed in 621992c", "url": "https://github.com/elastic/elasticsearch/pull/63495#discussion_r505802792", "createdAt": "2020-10-15T19:56:40Z", "author": {"login": "mayya-sharipova"}, "path": "server/src/main/java/org/elasticsearch/search/collapse/CollapseBuilder.java", "diffHunk": "@@ -203,12 +202,9 @@ public CollapseContext build(QueryShardContext queryShardContext) {\n         if (fieldType == null) {\n             throw new IllegalArgumentException(\"no mapping found for `\" + field + \"` in order to collapse on\");\n         }\n-        if (fieldType instanceof KeywordFieldMapper.KeywordFieldType == false &&\n-            fieldType instanceof NumberFieldMapper.NumberFieldType == false) {\n-            throw new IllegalArgumentException(\"unknown type for collapse field `\" + field +\n-                \"`, only keywords and numbers are accepted\");\n+        if (fieldType.collapseType() == CollapseType.NONE) {\n+            throw new IllegalArgumentException(\"collapse is not supported on this field type\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY1OTg0MQ=="}, "originalCommit": {"oid": "0e2b4c423a489d70bdb6ccd40c7eec3966e396ec"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3066, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}