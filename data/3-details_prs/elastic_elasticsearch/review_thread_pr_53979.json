{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMzk5Njcz", "number": 53979, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMjo1ODowNFrODytFaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoyMDoyOVrODytY8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk0MDU5OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/bulk.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMjo1ODowNFrOGG6FCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwODoxMTozMFrOGP2bpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5NjIwMQ==", "bodyText": "Since this technically supports sending application/json too, should we add it after the preferred application/x-ndjson? I can see an argument against not including it as even though the content-type header is application/json, the request body format must be newline delimited JSON", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409896201", "createdAt": "2020-04-16T22:58:04Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/bulk.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Allows to perform multiple index/update/delete operations in a single request.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI3MzYzOA==", "bodyText": "Aye that's why I opted not to include it. This documents the preferred mimetypes, to be extended with API versioning headers later on as well. The fact the server is lenient here is not a feature for clients IMO.", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r419273638", "createdAt": "2020-05-04T08:11:30Z", "author": {"login": "Mpdreamz"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/bulk.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Allows to perform multiple index/update/delete operations in a single request.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\"]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5NjIwMQ=="}, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk0Njg2OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/cat.help.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowMTowN1rOGG6I2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowMTowN1rOGG6I2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5NzE3OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"accept\": [ \"text/plain\", \"application/json\"]\n          \n          \n            \n                  \"accept\": [ \"text/plain\" ]\n          \n      \n    \n    \n  \n\nCat help looks like it only supports text/plain", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409897179", "createdAt": "2020-04-16T23:01:07Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/cat.help.json", "diffHunk": "@@ -5,6 +5,9 @@\n       \"description\":\"Returns help for the Cat APIs.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"text/plain\", \"application/json\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk1MzE4OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/msearch_template.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowMzo1M1rOGG6Mmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowMzo1M1rOGG6Mmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5ODEzOA==", "bodyText": "Since this technically supports sending application/json too, should we add it after the preferred application/x-ndjson? I can see an argument against not including it as even though the content-type header is application/json, the request body format must be newline delimited JSON", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409898138", "createdAt": "2020-04-16T23:03:53Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/msearch_template.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Allows to execute several search template operations in one request.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk2MTQyOnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/nodes.reload_secure_settings.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowNzoyMVrOGG6RYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowNzoyMVrOGG6RYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5OTM2Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"accept\": [ \"application/json\"]\n          \n          \n            \n                  \"accept\": [ \"application/json\"],\n          \n          \n            \n                  \"content_type\": [ \"application/json\" ]\n          \n      \n    \n    \n  \n\nTakes a body: https://www.elastic.co/guide/en/elasticsearch/reference/7.x/cluster-nodes-reload-secure-settings.html", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409899363", "createdAt": "2020-04-16T23:07:21Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/nodes.reload_secure_settings.json", "diffHunk": "@@ -5,6 +5,9 @@\n       \"description\":\"Reloads secure settings.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk2NTA1OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/search_template.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzowODo1MFrOGG6TeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwODoyMDo1NFrOGP2tiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5OTg5Ng==", "bodyText": "intentional to remove required: true?", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409899896", "createdAt": "2020-04-16T23:08:50Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/search_template.json", "diffHunk": "@@ -100,8 +104,7 @@\n       }\n     },\n     \"body\":{\n-      \"description\":\"The search definition template and its params\",\n-      \"required\":true\n+      \"description\":\"The search definition template and its params\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI3ODIxNw==", "bodyText": "Thank you for catching this one \ud83d\udc4d", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r419278217", "createdAt": "2020-05-04T08:20:54Z", "author": {"login": "Mpdreamz"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/search_template.json", "diffHunk": "@@ -100,8 +104,7 @@\n       }\n     },\n     \"body\":{\n-      \"description\":\"The search definition template and its params\",\n-      \"required\":true\n+      \"description\":\"The search definition template and its params\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTg5OTg5Ng=="}, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk3MTI3OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/schema.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoxMToyN1rOGG6XFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoxMToyN1rOGG6XFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMDgyMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"description\": \"Documents the headers the API supports, at a minimum this should document the Accept header and Content-Type header if the API supports a body\"\n          \n          \n            \n                        \"description\": \"Documents the headers the API supports, at a minimum this must document the Accept header. The Content-Type header should be documented if the API supports a body\"", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409900821", "createdAt": "2020-04-16T23:11:27Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/schema.json", "diffHunk": "@@ -142,7 +145,30 @@\n                 \"description\"\n             ],\n             \"title\": \"Documentation\",\n-            \"description\": \"API documentation including a link to the public reference and a short descritpion\"\n+            \"description\": \"API documentation including a link to the public reference and a short description\"\n+        },\n+        \"Headers\": {\n+            \"type\": \"object\",\n+            \"additionalProperties\": false,\n+            \"properties\": {\n+                \"accept\": {\n+                    \"type\": \"array\",\n+                    \"items\": {\n+                        \"type\": \"string\",\n+                        \"minItems\": 1\n+                    }\n+                },\n+                \"content_type\": {\n+                    \"type\": \"array\",\n+                    \"items\": {\n+                        \"type\": \"string\",\n+                        \"minItems\": 1\n+                    }\n+                }\n+            },\n+            \"required\": [\"accept\"],\n+            \"title\": \"Headers the API understands\",\n+            \"description\": \"Documents the headers the API supports, at a minimum this should document the Accept header and Content-Type header if the API supports a body\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk4MzEzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/src/test/resources/rest-api-spec/api/ml.post_data.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoxNjo1OFrOGG6d9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoxNjo1OFrOGG6d9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMjU4Mw==", "bodyText": "Similar to other APIs that expect newline delimited JSON request body - I think we should be consistent on whether we document application/json as accepted Content-Type across these APIs", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409902583", "createdAt": "2020-04-16T23:16:58Z", "author": {"login": "russcam"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/api/ml.post_data.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Sends data to an anomaly detection job for analysis.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\", \"application/json\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk4NjE2OnYy", "diffSide": "RIGHT", "path": "x-pack/qa/full-cluster-restart/src/test/resources/org/elasticsearch/xpack/restart/funny-timeout-watch.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoxODoyNlrOGG6fyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwODoyODo0MlrOGP29FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMzA1MQ==", "bodyText": "guess this change can be discarded?", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409903051", "createdAt": "2020-04-16T23:18:26Z", "author": {"login": "russcam"}, "path": "x-pack/qa/full-cluster-restart/src/test/resources/org/elasticsearch/xpack/restart/funny-timeout-watch.json", "diffHunk": "@@ -35,4 +35,4 @@\n       }\n     }\n   }\n-}\n\\ No newline at end of file\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI4MjE5Ng==", "bodyText": "reverting it back is hard inside the IDE, because the old invalidates editorconfig. I have to close the editor and edit it in vim to stop it automatically reverting back to the state in the PR. Leaving as is but good catch again!", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r419282196", "createdAt": "2020-05-04T08:28:42Z", "author": {"login": "Mpdreamz"}, "path": "x-pack/qa/full-cluster-restart/src/test/resources/org/elasticsearch/xpack/restart/funny-timeout-watch.json", "diffHunk": "@@ -35,4 +35,4 @@\n       }\n     }\n   }\n-}\n\\ No newline at end of file\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMzA1MQ=="}, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk5MDA5OnYy", "diffSide": "RIGHT", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/msearch.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoyMDoxMlrOGG6iHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoyMDoxMlrOGG6iHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMzY0NQ==", "bodyText": "Since this technically supports sending application/json too, should we add it after the preferred application/x-ndjson? I can see an argument against not including it as even though the content-type header is application/json, the request body format must be newline delimited JSON", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409903645", "createdAt": "2020-04-16T23:20:12Z", "author": {"login": "russcam"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/msearch.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Allows to execute several search operations in one request.\"\n     },\n     \"stability\":\"stable\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDk5MDU5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/src/test/resources/rest-api-spec/api/ml.find_file_structure.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoyMDoyOVrOGG6iYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMzoyMDoyOVrOGG6iYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkwMzcxNQ==", "bodyText": "Since this technically supports sending application/json too, should we add it after the preferred application/x-ndjson? I can see an argument against not including it as even though the content-type header is application/json, the request body format must be newline delimited JSON", "url": "https://github.com/elastic/elasticsearch/pull/53979#discussion_r409903715", "createdAt": "2020-04-16T23:20:29Z", "author": {"login": "russcam"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/api/ml.find_file_structure.json", "diffHunk": "@@ -5,6 +5,10 @@\n       \"description\":\"Finds the structure of a text file. The text file must contain data that is suitable to be ingested into Elasticsearch.\"\n     },\n     \"stability\":\"experimental\",\n+    \"headers\":{\n+      \"accept\": [ \"application/json\"],\n+      \"content_type\": [\"application/x-ndjson\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9ad7ed86c850dc9718e532e3a6689f334eebed"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4213, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}