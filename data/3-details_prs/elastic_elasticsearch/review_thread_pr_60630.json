{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNDE5MDAz", "number": 60630, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyMjo1OFrOEVmQvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyOToxOFrOEVmW1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDgyNDMwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/eql/qa/common/build.gradle", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyMjo1OFrOG8cpug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzoyNjoyNlrOG-YRVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzE3OA==", "bodyText": "I moved some test only dependencies out of the main source set and into the test source set and added expose it as a test artifact.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466037178", "createdAt": "2020-08-05T22:22:58Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/eql/qa/common/build.gradle", "diffHunk": "@@ -9,3 +9,17 @@ dependencies {\n   // TOML parser for EqlActionIT tests\n   api 'io.ous:jtoml:2.0.0'\n }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY3ODUwMw==", "bodyText": "What's the reasoning behind that? If we share code with other projects doing so w/o sharing the entire tests jar is definitely preferable. While \"main\" is not the best descriport (we should be using the gradle testfixture plugin) it's still better then slamming everything in \"test\" and then sharing that.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466678503", "createdAt": "2020-08-06T20:50:09Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/eql/qa/common/build.gradle", "diffHunk": "@@ -9,3 +9,17 @@ dependencies {\n   // TOML parser for EqlActionIT tests\n   api 'io.ous:jtoml:2.0.0'\n }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzE3OA=="}, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcwMDQzNg==", "bodyText": "I can move it back... it just seemed odd to have test only code in the main source set, even for a qa project.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466700436", "createdAt": "2020-08-06T21:38:33Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/eql/qa/common/build.gradle", "diffHunk": "@@ -9,3 +9,17 @@ dependencies {\n   // TOML parser for EqlActionIT tests\n   api 'io.ous:jtoml:2.0.0'\n }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzE3OA=="}, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA2MjU1MA==", "bodyText": "Yeah, it's not really \"main\" code, but its the most convenient place to put it.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r468062550", "createdAt": "2020-08-10T17:26:26Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/eql/qa/common/build.gradle", "diffHunk": "@@ -9,3 +9,17 @@ dependencies {\n   // TOML parser for EqlActionIT tests\n   api 'io.ous:jtoml:2.0.0'\n }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzE3OA=="}, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDgyNzczOnYy", "diffSide": "LEFT", "path": "x-pack/plugin/identity-provider/src/internalClusterTest/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndexTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyNDoxOVrOG8crpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyNDoxOVrOG8crpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzY2OA==", "bodyText": "moved this to utility class (in the the test sourceset) so it can be shared easier.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466037668", "createdAt": "2020-08-05T22:24:19Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/identity-provider/src/internalClusterTest/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndexTests.java", "diffHunk": "@@ -242,59 +240,6 @@ private void refresh() {\n         future.actionGet();\n     }\n \n-    public static SamlServiceProviderDocument randomDocument() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDgyOTQ4OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/identity-provider/src/test/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderTestUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyNDo1OFrOG8csjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyNDo1OFrOG8csjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNzkwMg==", "bodyText": "no functional changes here ... just copy pasta to allow re-use across source sets.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466037902", "createdAt": "2020-08-05T22:24:58Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/identity-provider/src/test/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderTestUtils.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.idp.saml.sp;\n+\n+import org.elasticsearch.common.unit.TimeValue;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import static org.elasticsearch.test.ESTestCase.randomAlphaOfLengthBetween;\n+import static org.elasticsearch.test.ESTestCase.randomBoolean;\n+import static org.elasticsearch.test.ESTestCase.randomFrom;\n+import static org.elasticsearch.test.ESTestCase.randomIntBetween;\n+import static org.elasticsearch.test.ESTestCase.randomLong;\n+import static org.hamcrest.Matchers.nullValue;\n+import static org.junit.Assert.assertThat;\n+import static org.opensaml.saml.saml2.core.NameIDType.TRANSIENT;\n+\n+public class SamlServiceProviderTestUtils {\n+\n+    private SamlServiceProviderTestUtils(){} //utility class\n+\n+    public static SamlServiceProviderDocument randomDocument() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDgzNTIwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/qa/basic-multi-node/src/javaRestTest/java/org/elasticsearch/xpack/ml/integration/MlBasicMultiNodeIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyNzoyMlrOG8cv0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDo1MToyMVrOG9D1RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzODczOA==", "bodyText": "Quite a few of the ML REST tests had a dependency on the ML main code for ONLY this base path reference in the tests.  Adding to each test like here is a bit redundant, but allows us to break that class path dependency and the REST path for ml is unlikely to change.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466038738", "createdAt": "2020-08-05T22:27:22Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/ml/qa/basic-multi-node/src/javaRestTest/java/org/elasticsearch/xpack/ml/integration/MlBasicMultiNodeIT.java", "diffHunk": "@@ -29,6 +28,8 @@\n \n public class MlBasicMultiNodeIT extends ESRestTestCase {\n \n+    private static final String BASE_PATH = \"/_ml/\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY3OTEwOQ==", "bodyText": "Good call. And if it does, that's a breaking change anyhow.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466679109", "createdAt": "2020-08-06T20:51:21Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/ml/qa/basic-multi-node/src/javaRestTest/java/org/elasticsearch/xpack/ml/integration/MlBasicMultiNodeIT.java", "diffHunk": "@@ -29,6 +28,8 @@\n \n public class MlBasicMultiNodeIT extends ESRestTestCase {\n \n+    private static final String BASE_PATH = \"/_ml/\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzODczOA=="}, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMDgzOTg5OnYy", "diffSide": "LEFT", "path": "x-pack/plugin/ml/qa/single-node-tests/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyOToxOFrOG8cypA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMjoyOToxOFrOG8cypA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzOTQ2MA==", "bodyText": "here is an example where duplicating the BASE_PATH allows us to remove the dependency.", "url": "https://github.com/elastic/elasticsearch/pull/60630#discussion_r466039460", "createdAt": "2020-08-05T22:29:18Z", "author": {"login": "jakelandis"}, "path": "x-pack/plugin/ml/qa/single-node-tests/build.gradle", "diffHunk": "@@ -1,13 +1,6 @@\n-apply plugin: 'elasticsearch.testclusters'\n-apply plugin: 'elasticsearch.standalone-rest-test'\n-apply plugin: 'elasticsearch.rest-test'\n+apply plugin: 'elasticsearch.java-rest-test'\n \n-dependencies {\n-  testImplementation project(\":x-pack:plugin:core\")\n-  testImplementation project(path: xpackModule('ml'))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19c8122cb1c06b27f1506d9985fae1d721741cb"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2618, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}