{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1MTk1OTU5", "number": 60054, "title": "Relax ShardFollowTasksExecutor validation", "bodyText": "If a primary shard of a follower index is being relocated, then we will fail to create a follow-task. This validation is too restricted. We should ensure that all primaries of the follower index are active instead.\nCloses #59625", "createdAt": "2020-07-22T15:34:36Z", "url": "https://github.com/elastic/elasticsearch/pull/60054", "merged": true, "mergeCommit": {"oid": "5d8a6bb255af1da3273a3741c1f61e7fbfeb46f6"}, "closed": true, "closedAt": "2020-07-27T13:26:52Z", "author": {"login": "dnhatn"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3ceJLgH2gAyNDU1MTk1OTU5OjVmZjZmZjBjN2ExZjg2NDA3ZDgwNGU3ODhkNWUxNzQ2ZjA3NWEzMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc48pN_AFqTQ1NTUzMDYxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5ff6ff0c7a1f86407d804e788d5e1746f075a31d", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/5ff6ff0c7a1f86407d804e788d5e1746f075a31d", "committedDate": "2020-07-22T15:22:11Z", "message": "Relax ShardFollowTasksExecutor validation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNDM4MjQw", "url": "https://github.com/elastic/elasticsearch/pull/60054#pullrequestreview-453438240", "createdAt": "2020-07-22T15:34:52Z", "commit": {"oid": "5ff6ff0c7a1f86407d804e788d5e1746f075a31d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNTozNDo1MlrOG1oGnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNTozNDo1MlrOG1oGnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg4NDc2NQ==", "bodyText": "I am not sure if we should remove this validation. Should we be able to create a follow task while some follower shards are temporarily unavailable?", "url": "https://github.com/elastic/elasticsearch/pull/60054#discussion_r458884765", "createdAt": "2020-07-22T15:34:52Z", "author": {"login": "dnhatn"}, "path": "x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowTasksExecutor.java", "diffHunk": "@@ -111,9 +112,10 @@ public ShardFollowTasksExecutor(Client client,\n \n     @Override\n     public void validate(ShardFollowTask params, ClusterState clusterState) {\n-        IndexRoutingTable routingTable = clusterState.getRoutingTable().index(params.getFollowShardId().getIndex());\n-        if (routingTable.shard(params.getFollowShardId().id()).primaryShard().started() == false) {\n-            throw new IllegalArgumentException(\"Not all copies of follow shard are started\");\n+        final IndexRoutingTable routingTable = clusterState.getRoutingTable().index(params.getFollowShardId().getIndex());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ff6ff0c7a1f86407d804e788d5e1746f075a31d"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NTMwNjE0", "url": "https://github.com/elastic/elasticsearch/pull/60054#pullrequestreview-455530614", "createdAt": "2020-07-27T07:25:10Z", "commit": {"oid": "5ff6ff0c7a1f86407d804e788d5e1746f075a31d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4054, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}