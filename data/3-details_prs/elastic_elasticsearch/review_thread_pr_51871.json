{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwOTEyOTQx", "number": 51871, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNTowMlrODdwrZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNjoxMlrODdwtFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTMyODM3OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/search/aggregations/metrics/HDRPercentilesIT.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNTowMlrOFmjAUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNTowMlrOFmjAUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk2MzcyOA==", "bodyText": "while uniquePercentails.size() < length?", "url": "https://github.com/elastic/elasticsearch/pull/51871#discussion_r375963728", "createdAt": "2020-02-06T17:05:02Z", "author": {"login": "nik9000"}, "path": "server/src/test/java/org/elasticsearch/search/aggregations/metrics/HDRPercentilesIT.java", "diffHunk": "@@ -67,21 +69,21 @@\n \n     private static double[] randomPercentiles() {\n         final int length = randomIntBetween(1, 20);\n-        final double[] percentiles = new double[length];\n-        for (int i = 0; i < percentiles.length; ++i) {\n+        final Set<Double> uniquedPercentiles = new HashSet<>();\n+        for (int i = 0; i < length; ++i) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f0cc8fc513e43b3b8401532033097f52dd290e9"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTMzMjcwOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/search/aggregations/metrics/PercentilesAggregationBuilder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNjoxMlrOFmjDCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxNzowNjoxMlrOFmjDCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk2NDQyNg==", "bodyText": "I think this should have an extra space after if and before (.", "url": "https://github.com/elastic/elasticsearch/pull/51871#discussion_r375964426", "createdAt": "2020-02-06T17:06:12Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/search/aggregations/metrics/PercentilesAggregationBuilder.java", "diffHunk": "@@ -181,6 +181,18 @@ public PercentilesAggregationBuilder percentiles(double... percents) {\n         }\n         double[] sortedPercents = Arrays.copyOf(percents, percents.length);\n         Arrays.sort(sortedPercents);\n+        double previousPercent = -1.0;\n+        for (double percent : sortedPercents) {\n+            if (percent < 0.0 || percent > 100.0) {\n+                throw new IllegalArgumentException(\"percent must be in [0,100], got [\" + percent + \"]: [\" + name + \"]\");\n+            }\n+\n+            if(percent == previousPercent) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f0cc8fc513e43b3b8401532033097f52dd290e9"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 78, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}