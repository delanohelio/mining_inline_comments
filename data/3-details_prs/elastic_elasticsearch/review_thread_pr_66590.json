{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNTI2MDk3", "number": 66590, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxOTozOTo0MlrOFHUpzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxOTozOTo0MlrOFHUpzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMjIyNzMzOnYy", "diffSide": "RIGHT", "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionBwcSetupPlugin.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxOTozOTo0MlrOIIwcug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQyMToyODoxMVrOIIzQ3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1MzMwNg==", "bodyText": "We need to include the distribution type in the path as well (i.e. -oss for the OSS distro). That's what's causing these errors:\nCaused by: java.nio.file.NoSuchFileException: /dev/shm/elastic+elasticsearch+pull-request-bwc/distribution/bwc/minor/build/bwc/checkout-7.x/distribution/archives/oss-linux-tar/build/install/elasticsearch-7.12.0-SNAPSHOT/plugins/config", "url": "https://github.com/elastic/elasticsearch/pull/66590#discussion_r546053306", "createdAt": "2020-12-18T19:39:42Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionBwcSetupPlugin.java", "diffHunk": "@@ -279,7 +279,9 @@ static void createBuildBwcTask(\n                         + \".\"\n                         + extension\n                 ),\n-                expandedDistDirSupport ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/\") : null\n+                expandedDistDirSupport\n+                    ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/elasticsearch-\" + version + \"-SNAPSHOT\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dee3e0ac3e6b376b25f8c239c83ddaa96a2581e6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1MzYyOA==", "bodyText": "And posibly architecture too? Essentially, we need to use the same logic for building that dir name as we do for the file name as I \"think\" we add all those qualifiers there as well.", "url": "https://github.com/elastic/elasticsearch/pull/66590#discussion_r546053628", "createdAt": "2020-12-18T19:40:21Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionBwcSetupPlugin.java", "diffHunk": "@@ -279,7 +279,9 @@ static void createBuildBwcTask(\n                         + \".\"\n                         + extension\n                 ),\n-                expandedDistDirSupport ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/\") : null\n+                expandedDistDirSupport\n+                    ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/elasticsearch-\" + version + \"-SNAPSHOT\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1MzMwNg=="}, "originalCommit": {"oid": "dee3e0ac3e6b376b25f8c239c83ddaa96a2581e6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA5OTQyMw==", "bodyText": "I fixed the issue with the file not found above. The problem was not with the folder name but with the right declaration of the target install root which is still \"build/install\". The distro base folder name doesn't contain oss or anything arch specific as far as I see.", "url": "https://github.com/elastic/elasticsearch/pull/66590#discussion_r546099423", "createdAt": "2020-12-18T21:28:11Z", "author": {"login": "breskeby"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionBwcSetupPlugin.java", "diffHunk": "@@ -279,7 +279,9 @@ static void createBuildBwcTask(\n                         + \".\"\n                         + extension\n                 ),\n-                expandedDistDirSupport ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/\") : null\n+                expandedDistDirSupport\n+                    ? new File(checkoutDir, baseDir + \"/\" + name + \"/build/install/elasticsearch-\" + version + \"-SNAPSHOT\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1MzMwNg=="}, "originalCommit": {"oid": "dee3e0ac3e6b376b25f8c239c83ddaa96a2581e6"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4468, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}