{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1NjEzNTg2", "number": 58215, "title": "Fix DanglingIndicesIT Failures from MasterNotDiscoveredException", "bodyText": "The dangling indices action is not a proper master node action (I guess part of it could be made one to avoid this kind of issue but for now I just fixed the test instead) so it does not retry when executed while the cluster hasn't fully formed yet.\nSince we use node restarts when setting up the dangling indices state we need\nto manually ensure a fully formed cluster before moving on with the tests to avoid\nfailures.\nexample failure:\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+pull-request-1/1570/testReport/junit/org.elasticsearch.indices.recovery/DanglingIndicesIT/testDanglingIndicesCanBeImported/", "createdAt": "2020-06-17T05:34:06Z", "url": "https://github.com/elastic/elasticsearch/pull/58215", "merged": true, "mergeCommit": {"oid": "af208ce7adcad92ed5947b824e9fd21dc76a3e58"}, "closed": true, "closedAt": "2020-06-17T07:00:15Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsDCJygH2gAyNDM1NjEzNTg2OmI3NzE3NDQyNzA5ZTAyMWEwZGQ1MDljMDI0MTM2NzEwMDM2NjU3YWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsDcw6gFqTQzMjA4MDUzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b7717442709e021a0dd509c024136710036657ab", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/b7717442709e021a0dd509c024136710036657ab", "committedDate": "2020-06-17T05:30:49Z", "message": "Fix DanglingIndicesIT Failures from MasterNotDiscoveredException\n\nThe dangling indices action is not a proper master node action so it does not\nretry when executed while the cluster hasn't fully formed yet.\nSince we use node restarts when setting up the dangling indices state we need\nto manually ensure a fully formed cluster before moving on with the tests to avoid\nfailures."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDcwNDQ4", "url": "https://github.com/elastic/elasticsearch/pull/58215#pullrequestreview-432070448", "createdAt": "2020-06-17T05:34:37Z", "commit": {"oid": "b7717442709e021a0dd509c024136710036657ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTozNDozN1rOGk2OJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTozNDozN1rOGk2OJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI5MDI3OQ==", "bodyText": "Getting us a proper stack trace :)", "url": "https://github.com/elastic/elasticsearch/pull/58215#discussion_r441290279", "createdAt": "2020-06-17T05:34:37Z", "author": {"login": "original-brownbear"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/indices/recovery/DanglingIndicesIT.java", "diffHunk": "@@ -240,8 +240,7 @@ public void testDanglingIndicesCanBeImported() throws Exception {\n         final String danglingIndexUUID = findDanglingIndexForNode(stoppedNodeName, INDEX_NAME);\n \n         final ImportDanglingIndexRequest request = new ImportDanglingIndexRequest(danglingIndexUUID, true);\n-\n-        client().admin().cluster().importDanglingIndex(request).actionGet();\n+        client().admin().cluster().importDanglingIndex(request).get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7717442709e021a0dd509c024136710036657ab"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDgwNTM3", "url": "https://github.com/elastic/elasticsearch/pull/58215#pullrequestreview-432080537", "createdAt": "2020-06-17T05:59:53Z", "commit": {"oid": "b7717442709e021a0dd509c024136710036657ab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 564, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}