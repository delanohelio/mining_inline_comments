{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMDc2NDMw", "number": 62682, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwODo0NzozNFrOEljrWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMzoyMDoyNVrOElp5PQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3ODE3MzA2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwODo0NzozNFrOHVF_Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMTo0NTo0NVrOHVL5Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4MDIxNQ==", "bodyText": "Isn't the wildcard character a %? To my understanding the replacement of % -> * happens later here: https://github.com/elastic/elasticsearch/pull/62682/files#diff-cb6f05d0222f3291ea3df5d33525d6f6R80", "url": "https://github.com/elastic/elasticsearch/pull/62682#discussion_r491880215", "createdAt": "2020-09-21T08:47:34Z", "author": {"login": "matriv"}, "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "diffHunk": "@@ -48,6 +48,16 @@ public String asJavaRegex() {\n         return regex;\n     }\n \n+    @Override\n+    public boolean matchesAll() {\n+        for (int i = 0 ; i < pattern.length(); i++) {\n+            if (pattern.charAt(i) != '*') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1febf98e7e7b3814eff87a0b4ca5750eab5d9bfd"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk3NzA1NQ==", "bodyText": "You are correct. Fixed this.", "url": "https://github.com/elastic/elasticsearch/pull/62682#discussion_r491977055", "createdAt": "2020-09-21T11:45:45Z", "author": {"login": "costin"}, "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "diffHunk": "@@ -48,6 +48,16 @@ public String asJavaRegex() {\n         return regex;\n     }\n \n+    @Override\n+    public boolean matchesAll() {\n+        for (int i = 0 ; i < pattern.length(); i++) {\n+            if (pattern.charAt(i) != '*') {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4MDIxNQ=="}, "originalCommit": {"oid": "1febf98e7e7b3814eff87a0b4ca5750eab5d9bfd"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3OTE5MTY1OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMzoyMDoyNVrOHVPo3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwNzoxMzowMlrOHVs53Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAzODM2NQ==", "bodyText": "I think that now the \"problem\" is reversed since the ReplaceWildcards takes place before this rule, but the test seems to work: https://github.com/elastic/elasticsearch/pull/62682/files#diff-6dd3fd1d0809ee5978cdccbc6bb7d7e1R17 ? In any case I think we should have a comment mentioning the order of the rules are applied and the choice of % or * in this rule.", "url": "https://github.com/elastic/elasticsearch/pull/62682#discussion_r492038365", "createdAt": "2020-09-21T13:20:25Z", "author": {"login": "matriv"}, "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "diffHunk": "@@ -48,6 +48,16 @@ public String asJavaRegex() {\n         return regex;\n     }\n \n+    @Override\n+    public boolean matchesAll() {\n+        for (int i = 0 ; i < pattern.length(); i++) {\n+            if (pattern.charAt(i) != '%') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5f5a2fa5ba6c3eddc1e455a6d4f19992b6d103a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjUxNzg1Mw==", "bodyText": "LikePattern has several styles. In its constructor it accepts the % and _ characters instead of * and ?. The conversion is done internally and accessible.\nThe check above works on the raw pattern - I'll follow-up with a comment.", "url": "https://github.com/elastic/elasticsearch/pull/62682#discussion_r492517853", "createdAt": "2020-09-22T07:13:02Z", "author": {"login": "costin"}, "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/expression/predicate/regex/LikePattern.java", "diffHunk": "@@ -48,6 +48,16 @@ public String asJavaRegex() {\n         return regex;\n     }\n \n+    @Override\n+    public boolean matchesAll() {\n+        for (int i = 0 ; i < pattern.length(); i++) {\n+            if (pattern.charAt(i) != '%') {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAzODM2NQ=="}, "originalCommit": {"oid": "a5f5a2fa5ba6c3eddc1e455a6d4f19992b6d103a"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3505, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}