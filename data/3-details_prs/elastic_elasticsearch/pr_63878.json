{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1OTM2MjY4", "number": 63878, "title": "Convert parent-join mappers to parametrized form", "bodyText": "This converts the three parent-join mapper implementations to parametrized\nform; MetaJoinFieldMapper and ParentIdFieldMapper have no builders or\nmerging logic as they are always created directly by the ParentJoinFieldMapper.\nRelates to #62988", "createdAt": "2020-10-19T12:39:50Z", "url": "https://github.com/elastic/elasticsearch/pull/63878", "merged": true, "mergeCommit": {"oid": "b79e6ae8f7b69745dfd355aaddd9e94193e09912"}, "closed": true, "closedAt": "2020-10-19T14:37:48Z", "author": {"login": "romseygeek"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR3ZoDgH2gAyNTA1OTM2MjY4OjVlOGQ5YTJiMTQzNmQ4OGU0ODM5NjBjZWE0ZGExNmFmNDNkZGRkNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUD7HEAH2gAyNTA1OTM2MjY4OjA5ZGVhYzA0Zjk4MmIyZjIwZTQ4NTM3NWEwYmQwNTFiNjRmOGJhZDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5e8d9a2b1436d88e483960cea4da16af43dddd6f", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/5e8d9a2b1436d88e483960cea4da16af43dddd6f", "committedDate": "2020-10-12T17:26:43Z", "message": "WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94677abf81f56bff6958fead064325eaf709c161", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/94677abf81f56bff6958fead064325eaf709c161", "committedDate": "2020-10-15T07:47:27Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69e26177a1336738501ab3e711328136ca53f0e4", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/69e26177a1336738501ab3e711328136ca53f0e4", "committedDate": "2020-10-15T09:19:24Z", "message": "compiles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d63079df3e8a3db09fa84dfb2fa8207750b303cd", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/d63079df3e8a3db09fa84dfb2fa8207750b303cd", "committedDate": "2020-10-15T09:19:27Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6dc26dc8b1d091511e6640d2140a7b3e2d85a4", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/4c6dc26dc8b1d091511e6640d2140a7b3e2d85a4", "committedDate": "2020-10-15T10:47:44Z", "message": "Convert all to parametrized mappers; data shared via Joiner object on metadata field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bff02ef95c26b1c26d7bf8046903fc4939a2fce", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/2bff02ef95c26b1c26d7bf8046903fc4939a2fce", "committedDate": "2020-10-15T12:39:37Z", "message": "inner hits tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60fe6984334c75e3fd537c9444a8b5397d18a938", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/60fe6984334c75e3fd537c9444a8b5397d18a938", "committedDate": "2020-10-15T13:23:40Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94881383264490f3fba12b851218a15b6d525e64", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/94881383264490f3fba12b851218a15b6d525e64", "committedDate": "2020-10-15T14:54:39Z", "message": "Undo parametrization; move LateParsingQuery back into HasChildQueryBuilder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc374f4c4dec20dd81059ccbe20806e432ee1741", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/dc374f4c4dec20dd81059ccbe20806e432ee1741", "committedDate": "2020-10-15T14:59:32Z", "message": "unwind a couple more changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a36a52c616904daa39f307afd42f4bea7329af82", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/a36a52c616904daa39f307afd42f4bea7329af82", "committedDate": "2020-10-15T15:01:49Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba97d3518d4f09bc8145a7cc6e0754eb6c6e90c5", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/ba97d3518d4f09bc8145a7cc6e0754eb6c6e90c5", "committedDate": "2020-10-15T15:20:03Z", "message": "imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c593a31662f7ce8e22e8a0cdb0ccf321a7e352ca", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/c593a31662f7ce8e22e8a0cdb0ccf321a7e352ca", "committedDate": "2020-10-15T15:26:49Z", "message": "javadocs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d9afe0c36a6fc0bf925be3ad2dbc5b765c4f1d1", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/3d9afe0c36a6fc0bf925be3ad2dbc5b765c4f1d1", "committedDate": "2020-10-16T13:38:05Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9febddd2353ab3a6a7b4d47be30d99fea72b19e6", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/9febddd2353ab3a6a7b4d47be30d99fea72b19e6", "committedDate": "2020-10-16T13:52:22Z", "message": "deef"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc2bbc2f08403a3e6e74f20be21ac28c02dcb09f", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/cc2bbc2f08403a3e6e74f20be21ac28c02dcb09f", "committedDate": "2020-10-19T11:38:37Z", "message": "Merge remote-tracking branch 'origin/master' into mapper/join"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a9367c31f018b9397f698e6057c924e667ed6ef", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/5a9367c31f018b9397f698e6057c924e667ed6ef", "committedDate": "2020-10-19T11:54:08Z", "message": "Revert \"unwind a couple more changes\"\n\nThis reverts commit dc374f4c4dec20dd81059ccbe20806e432ee1741."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27d5ee135f2bd06591b926f194c6fd90f5c6826f", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/27d5ee135f2bd06591b926f194c6fd90f5c6826f", "committedDate": "2020-10-19T12:00:49Z", "message": "Convert parent-join mappers to parametrized form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2", "committedDate": "2020-10-19T12:38:39Z", "message": "derp"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExNzMzOTA3", "url": "https://github.com/elastic/elasticsearch/pull/63878#pullrequestreview-511733907", "createdAt": "2020-10-19T13:01:34Z", "commit": {"oid": "1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMzowMTozNFrOHkNL6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMzowNDoxNVrOHkNSRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcyNjgyNQ==", "bodyText": "can you remind me why this goes away?", "url": "https://github.com/elastic/elasticsearch/pull/63878#discussion_r507726825", "createdAt": "2020-10-19T13:01:34Z", "author": {"login": "javanna"}, "path": "modules/parent-join/src/main/java/org/elasticsearch/join/mapper/ParentJoinFieldMapper.java", "diffHunk": "@@ -189,7 +160,6 @@ public String typeName() {\n \n         @Override\n         public IndexFieldData.Builder fielddataBuilder(String fullyQualifiedIndexName, Supplier<SearchLookup> searchLookup) {\n-            failIfNoDocValues();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2"}, "originalPosition": 149}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcyNzUzMw==", "bodyText": "does this need to be public?", "url": "https://github.com/elastic/elasticsearch/pull/63878#discussion_r507727533", "createdAt": "2020-10-19T13:02:47Z", "author": {"login": "javanna"}, "path": "modules/parent-join/src/main/java/org/elasticsearch/join/mapper/Relations.java", "diffHunk": "@@ -53,4 +61,20 @@ public int hashCode() {\n     public String toString() {\n         return parent + \"->\" + children;\n     }\n+\n+    public static List<Relations> parse(Object fieldNode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzcyODQ1Mg==", "bodyText": "I am missing why this needs to change", "url": "https://github.com/elastic/elasticsearch/pull/63878#discussion_r507728452", "createdAt": "2020-10-19T13:04:15Z", "author": {"login": "javanna"}, "path": "modules/parent-join/src/main/java/org/elasticsearch/join/mapper/MetaJoinFieldMapper.java", "diffHunk": "@@ -92,22 +62,17 @@ public String typeName() {\n \n         @Override\n         public IndexFieldData.Builder fielddataBuilder(String fullyQualifiedIndexName, Supplier<SearchLookup> searchLookup) {\n-            failIfNoDocValues();\n-            return new SortedSetOrdinalsIndexFieldData.Builder(name(), CoreValuesSourceType.BYTES);\n+            throw new UnsupportedOperationException(\"Cannot load field data for metadata field [\" + NAME + \"]\");\n         }\n \n         @Override\n         public ValueFetcher valueFetcher(MapperService mapperService, SearchLookup searchLookup, String format) {\n-            throw new UnsupportedOperationException(\"Cannot fetch values for metadata field [\" + typeName() + \"].\");\n+            throw new UnsupportedOperationException(\"Cannot fetch values for metadata field [\" + NAME + \"].\");\n         }\n \n         @Override\n         public Object valueForDisplay(Object value) {\n-            if (value == null) {\n-                return null;\n-            }\n-            BytesRef binaryValue = (BytesRef) value;\n-            return binaryValue.utf8ToString();\n+            throw new UnsupportedOperationException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e9e6787b567c0abdf328ce25d0e9e97e04aa2a2"}, "originalPosition": 87}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09deac04f982b2f20e485375a0bd051b64f8bad4", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/09deac04f982b2f20e485375a0bd051b64f8bad4", "committedDate": "2020-10-19T13:10:00Z", "message": "deef"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3918, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}