{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNjczMDUz", "number": 55034, "title": "Use task avoidance with forbidden apis", "bodyText": "Currently forbidden apis accounts for 800+ tasks in the build. These\ntasks are aggressively created by the plugin. In forbidden apis 3.0, we\nwill get task avoidance\n(policeman-tools/forbidden-apis#162), but we\nneed to ourselves use the same task avoidance mechanisms to not trigger\nthese task creations. This commit does that for our foribdden apis\nusages, in preparation for upgrading to 3.0 when it is released.", "createdAt": "2020-04-09T22:21:12Z", "url": "https://github.com/elastic/elasticsearch/pull/55034", "merged": true, "mergeCommit": {"oid": "842ce3287014d96b59314ee0772d0345954551fe"}, "closed": true, "closedAt": "2020-04-15T20:23:55Z", "author": {"login": "rjernst"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWEFqIgH2gAyNDAxNjczMDUzOjJlOGQzMjJjMGYyZjI1MjA5MGViMzc5MTE4ODA4ODM2NDY3ZTRhMjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX9KEkgH2gAyNDAxNjczMDUzOjY3NjJlMTNlZGI4NjI0NGQ3YThlZjY3NjNmNzYwMzA0MTljOWMzYTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e8d322c0f2f252090eb379118808836467e4a26", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e8d322c0f2f252090eb379118808836467e4a26", "committedDate": "2020-04-09T22:18:13Z", "message": "Use task avoidance with forbidden apis\n\nCurrently forbidden apis accounts for 800+ tasks in the build. These\ntasks are aggressively created by the plugin. In forbidden apis 3.0, we\nwill get task avoidance\n(https://github.com/policeman-tools/forbidden-apis/pull/162), but we\nneed to ourselves use the same task avoidance mechanisms to not trigger\nthese task creations. This commit does that for our foribdden apis\nusages, in preparation for upgrading to 3.0 when it is released."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMTcwOTIy", "url": "https://github.com/elastic/elasticsearch/pull/55034#pullrequestreview-391170922", "createdAt": "2020-04-09T22:23:25Z", "commit": {"oid": "2e8d322c0f2f252090eb379118808836467e4a26"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjoyMzoyNlrOGDrbMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjoyNToyMFrOGDrd6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMDM4Ng==", "bodyText": "Why the intermediary variable here? This can be simplified to ext.disableTasks = { String... taskNames ->...", "url": "https://github.com/elastic/elasticsearch/pull/55034#discussion_r406510386", "createdAt": "2020-04-09T22:23:26Z", "author": {"login": "mark-vieira"}, "path": "build.gradle", "diffHunk": "@@ -518,3 +518,12 @@ subprojects {\n     }\n   }\n }\n+\n+subprojects {\n+  Closure disableMethod = { String... tasknames ->\n+    for (String taskname : tasknames) {\n+      project.tasks.named(taskname).configure { onlyIf { false } }\n+    }\n+  }\n+  project.ext.disableTasks = disableMethod", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e8d322c0f2f252090eb379118808836467e4a26"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMTA4Mg==", "bodyText": "Do we need to keep this?", "url": "https://github.com/elastic/elasticsearch/pull/55034#discussion_r406511082", "createdAt": "2020-04-09T22:25:20Z", "author": {"login": "mark-vieira"}, "path": "test/logger-usage/build.gradle", "diffHunk": "@@ -27,8 +27,7 @@ dependencies {\n \n loggerUsageCheck.enabled = false\n \n-forbiddenApisMain.enabled = true // disabled by parent project", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e8d322c0f2f252090eb379118808836467e4a26"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efeffaf24fde4f73990c16f3ea5ccc4ce04066f1", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/efeffaf24fde4f73990c16f3ea5ccc4ce04066f1", "committedDate": "2020-04-13T20:04:24Z", "message": "feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4af78c18fca21f423d5dc17fa7e66d565434e778", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/4af78c18fca21f423d5dc17fa7e66d565434e778", "committedDate": "2020-04-13T20:07:03Z", "message": "fix bad testkit conversion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6762e13edb86244d7a8ef6763f76030419c9c3a4", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/6762e13edb86244d7a8ef6763f76030419c9c3a4", "committedDate": "2020-04-15T19:21:33Z", "message": "Merge branch 'master' into taskavoidance1"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3432, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}