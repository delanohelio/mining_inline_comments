{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExNTI4MjEw", "number": 56034, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNzo0Nzo1MFrOD4JQtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNzoyNTo0OFrOD5FpZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMTk4NTgwOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNzo0Nzo1MFrOGOz6dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNjo1MDoyNVrOGQJCZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4Mzc5Ng==", "bodyText": "Note that this PR also adjusts the indices stats api in order to support resolving data streams. This is needed because rollover uses that api and we made that api already data stream ready. The reason why before we didn't have the change the indices stats api, is because rollover api overrides the default indices option when calling the indices stats api.", "url": "https://github.com/elastic/elasticsearch/pull/56034#discussion_r418183796", "createdAt": "2020-04-30T17:47:50Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java", "diffHunk": "@@ -57,6 +57,11 @@ public TransportIndicesStatsAction(ClusterService clusterService, TransportServi\n         this.indicesService = indicesService;\n     }\n \n+    @Override\n+    protected boolean shouldIncludeDataStreams() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d84e8e6f80c220d6320fd6bcd1a32bb503f2fc3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTU3ODQ3MQ==", "bodyText": "This is fine.\nBut it made me wonder why we collect indices stats for all indices when we only use the stats for the write index?", "url": "https://github.com/elastic/elasticsearch/pull/56034#discussion_r419578471", "createdAt": "2020-05-04T16:50:25Z", "author": {"login": "henningandersen"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/stats/TransportIndicesStatsAction.java", "diffHunk": "@@ -57,6 +57,11 @@ public TransportIndicesStatsAction(ClusterService clusterService, TransportServi\n         this.indicesService = indicesService;\n     }\n \n+    @Override\n+    protected boolean shouldIncludeDataStreams() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4Mzc5Ng=="}, "originalCommit": {"oid": "1d84e8e6f80c220d6320fd6bcd1a32bb503f2fc3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMTg3OTQyOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authz/IndicesAndAliasesResolverTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNzoyNTo0OFrOGQKaEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQxNzoyNTo0OFrOGQKaEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYwMDkxNA==", "bodyText": "I am not sure this ignores data streams anymore? Maybe change the comment to \"test with allow no indexes\"?", "url": "https://github.com/elastic/elasticsearch/pull/56034#discussion_r419600914", "createdAt": "2020-05-04T17:25:48Z", "author": {"login": "henningandersen"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authz/IndicesAndAliasesResolverTests.java", "diffHunk": "@@ -1533,15 +1533,15 @@ public void testDataStreamResolution() {\n             // Resolve data streams:\n             SearchRequest searchRequest = new SearchRequest();\n             searchRequest.indices(\"logs-*\");\n-            searchRequest.indicesOptions(IndicesOptions.fromOptions(false, false, true, false, false, true, true, true, true, true));\n+            searchRequest.indicesOptions(IndicesOptions.fromOptions(false, false, true, false, false, true, true, true, true));\n             ResolvedIndices resolvedIndices = defaultIndicesResolver.resolveIndicesAndAliases(searchRequest, metadata, authorizedIndices);\n             assertThat(resolvedIndices.getLocal(), contains(\"logs-foobar\"));\n             assertThat(resolvedIndices.getRemote(), emptyIterable());\n \n             // Ignore data streams:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d84e8e6f80c220d6320fd6bcd1a32bb503f2fc3"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2430, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}