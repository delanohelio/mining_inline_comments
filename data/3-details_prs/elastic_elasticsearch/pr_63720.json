{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzOTYxODY4", "number": 63720, "title": "[DOCS] Avoid trailing newline in apikey base64 encoding", "bodyText": "Hi there, I just ran into forgetting not to add the newline in generating the base64 encoded value for the ApiKey. Thought it might be nice to include this in the official docs. Feel free to reformat the content if it does not fit the guidelines exactly.", "createdAt": "2020-10-15T09:32:12Z", "url": "https://github.com/elastic/elasticsearch/pull/63720", "merged": true, "mergeCommit": {"oid": "e56673015cb775670163d71c1396372f1a869df8"}, "closed": true, "closedAt": "2020-10-21T12:59:00Z", "author": {"login": "jubr"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSuO07AH2gAyNTAzOTYxODY4OmIwOTc3MjI2MjVlZDQ0MmFiNmEyNDViMGNhZTcxODRiNWM4MTFiMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUsYHWgH2gAyNTAzOTYxODY4OjM4NjIxZTdkMzI4Y2JmNjJiOGEyMzZhY2Y3MmE2NmM0M2Q2YTg3NTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b097722625ed442ab6a245b0cae7184b5c811b0f", "author": {"user": {"login": "jubr", "name": "Jurgen Braam"}}, "url": "https://github.com/elastic/elasticsearch/commit/b097722625ed442ab6a245b0cae7184b5c811b0f", "committedDate": "2020-10-15T09:19:42Z", "message": "[DOCS] Avoid trailing newline in apikey base64 encoding"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/f92dfe98137486c6c3143ce3710ed58ef5743cd8", "committedDate": "2020-10-20T14:01:18Z", "message": "Edits"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyNzUyMTgy", "url": "https://github.com/elastic/elasticsearch/pull/63720#pullrequestreview-512752182", "createdAt": "2020-10-20T14:03:02Z", "commit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMjgxNDY2", "url": "https://github.com/elastic/elasticsearch/pull/63720#pullrequestreview-513281466", "createdAt": "2020-10-21T03:29:55Z", "commit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMzoyOTo1NlrOHlY6wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMzo0NToxM1rOHlZK0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk2NzYxNw==", "bodyText": "Even though this is true, there is no where we use http or https explicitly in this page to create API keys. So this note feels out of place. I think we could revert it back to its original place and change it to something like:\nIf your node has `xpack.security.http.ssl.enabled` set to `true`, then you must specify `https` in the following command.", "url": "https://github.com/elastic/elasticsearch/pull/63720#discussion_r508967617", "createdAt": "2020-10-21T03:29:56Z", "author": {"login": "ywangd"}, "path": "x-pack/docs/en/rest-api/security/create-api-keys.asciidoc", "diffHunk": "@@ -78,7 +78,9 @@ expire.\n [[security-api-create-api-key-example]]\n ==== {api-examples-title}\n \n-The following example creates an API key:\n+The following example creates an API key.\n+\n+NOTE: If your node has `xpack.security.http.ssl.enabled` set to `true`, then you must specify `https` when creating your API key.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk2Nzk0OA==", "bodyText": "Tests failed and suggested to remove this line\n\nen/rest-api/security/create-api-keys.asciidoc141:144// NOTCONSOLE: No need for NOTCONSOLE if snippet doesn't contain curl.", "url": "https://github.com/elastic/elasticsearch/pull/63720#discussion_r508967948", "createdAt": "2020-10-21T03:31:07Z", "author": {"login": "ywangd"}, "path": "x-pack/docs/en/rest-api/security/create-api-keys.asciidoc", "diffHunk": "@@ -132,14 +134,20 @@ API key information.\n <2> optional expiration in milliseconds for this API key\n <3> generated API key\n \n-The API key returned by this API can then be used by sending a request with an\n-`Authorization` header with a value having the prefix `ApiKey` followed\n-by the _credentials_, where _credentials_ are the base64 encoding of `id` and `api_key` joined by a colon.\n+To create your credentials, encode the returned `id:api_key` in base64. Ensure\n+the value does not include a trailing newline.\n \n-NOTE: If your node has `xpack.security.http.ssl.enabled` set to `true`, then you must specify `https` when creating your API key.\n+[source,shell]\n+--------------------------------------------------\n+echo -n \"VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw\" | base64\n+# returns VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw==\n+--------------------------------------------------\n+// NOTCONSOLE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk3MTcyOQ==", "bodyText": "I think where id:api_key comes from is not clear. Also the term \"credentails\" is introduced with no context. Overall I prefer the original version.\nI think what we really want to say here is just the fact: when creating the credentials using echo, we must be careful to not include a trailing newline (echo's default behaviour). This is just one way of creating the credentials and we should be explicit about it. So I'd suggest we keep the original text and add a new sentence like:\nOne way to create the _credentails_ from CLI on an Unix-like system is as the follows:\n[source,shell]\n--------------------------------------------------\n# Please note the use of \"-n\" to instruct echo to not print the trailing newline character.\n# It should return VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw==\necho -n \"VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw\" | base64\n--------------------------------------------------", "url": "https://github.com/elastic/elasticsearch/pull/63720#discussion_r508971729", "createdAt": "2020-10-21T03:45:13Z", "author": {"login": "ywangd"}, "path": "x-pack/docs/en/rest-api/security/create-api-keys.asciidoc", "diffHunk": "@@ -132,14 +134,20 @@ API key information.\n <2> optional expiration in milliseconds for this API key\n <3> generated API key\n \n-The API key returned by this API can then be used by sending a request with an\n-`Authorization` header with a value having the prefix `ApiKey` followed\n-by the _credentials_, where _credentials_ are the base64 encoding of `id` and `api_key` joined by a colon.\n+To create your credentials, encode the returned `id:api_key` in base64. Ensure\n+the value does not include a trailing newline.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92dfe98137486c6c3143ce3710ed58ef5743cd8"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2deb3bb1598f60d25d3a69d244214e5af8352ac2", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/2deb3bb1598f60d25d3a69d244214e5af8352ac2", "committedDate": "2020-10-21T12:04:21Z", "message": "Revert \"Edits\"\n\nThis reverts commit f92dfe98137486c6c3143ce3710ed58ef5743cd8."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a694b6d4b6492c196c15ee97cfc718658b10660", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a694b6d4b6492c196c15ee97cfc718658b10660", "committedDate": "2020-10-21T12:06:04Z", "message": "Update snippet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b0fa838ca9a05612d6448e7b19a342540c131e1", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/9b0fa838ca9a05612d6448e7b19a342540c131e1", "committedDate": "2020-10-21T12:06:45Z", "message": "Readd comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38621e7d328cbf62b8a236acf72a66c43d6a8759", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/38621e7d328cbf62b8a236acf72a66c43d6a8759", "committedDate": "2020-10-21T12:17:53Z", "message": "Merge branch 'master' into jubr-docs-apikey-base64-trailing-newline-note"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3982, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}