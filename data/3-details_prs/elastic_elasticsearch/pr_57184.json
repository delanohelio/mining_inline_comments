{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzNDk3ODUz", "number": 57184, "title": "[DOCS] Explain flood stage watermark.", "bodyText": "This PR introduces changes for #36114, which include:\n\nExplaining the difference between deleting documents from an index and deleting the index itself.\nClarifications to the index.blocks.read_only_allow_delete parameter.\nAdding a note that ES adds and removes the read-only index block on its own.\n\nSee the Dynamic index settings page on the docs preview server for changes.\nCloses #36114\nBackports:\n\n[7.8] #57301\n[7.7] #57318\n[7.6] #57320\n[7.x] #57321\n[6.8] #57322", "createdAt": "2020-05-26T22:29:42Z", "url": "https://github.com/elastic/elasticsearch/pull/57184", "merged": true, "mergeCommit": {"oid": "7dd731b9a21a310ba0e7b8377609c04f2feccafb"}, "closed": true, "closedAt": "2020-05-28T14:57:41Z", "author": {"login": "lockewritesdocs"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclMYlyAH2gAyNDIzNDk3ODUzOjBhY2FhYTc0ZWYzYWMzYjViNDZlZjEwY2EzMzM0MDk0OWIwZjRmMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcls8YFgH2gAyNDIzNDk3ODUzOjAzZmJkNDY2ZWVmY2Y4NWY2ZGY0OGI5MTM5ODZiNGEzNjFiYzdhYTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0acaaa74ef3ac3b5b46ef10ca33340949b0f4f01", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/0acaaa74ef3ac3b5b46ef10ca33340949b0f4f01", "committedDate": "2020-05-26T22:27:00Z", "message": "Changes for issue #36114."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8643f7529f3f7f64747757d35754467b28733779", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/8643f7529f3f7f64747757d35754467b28733779", "committedDate": "2020-05-26T22:31:12Z", "message": "Adding stronger wording to the new note."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MTQ5NjQ1", "url": "https://github.com/elastic/elasticsearch/pull/57184#pullrequestreview-419149645", "createdAt": "2020-05-27T12:39:12Z", "commit": {"oid": "8643f7529f3f7f64747757d35754467b28733779"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMjozOToxMlrOGbHUpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMjozOToxMlrOGbHUpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA4NDcwOQ==", "bodyText": "I don't think the last sentence follows from the description. I think it'd be lovely to have a paragraph on when it is useful to modify these settings, but that it'd belong more at the top of the page than here. I think if you modify the settings you typically modify all of them. I think you mostly are interested in modifying them if you have a very big disk and 85%/90%/95% would be quite wasteful. Of if you write lots of data very quickly compared to the amount of disk so the defaults aren't conservative enough.", "url": "https://github.com/elastic/elasticsearch/pull/57184#discussion_r431084709", "createdAt": "2020-05-27T12:39:12Z", "author": {"login": "nik9000"}, "path": "docs/reference/modules/cluster/disk_allocator.asciidoc", "diffHunk": "@@ -37,23 +37,23 @@ file or updated dynamically on a live cluster with the\n     changed in 8.0. This setting can be set to `true` to enable the\n     disk watermarks for a single data node cluster (will become default in 8.0).\n \n+[[cluster-routing-flood_stage]]\n `cluster.routing.allocation.disk.watermark.flood_stage`::\n +\n --\n-Controls the flood stage watermark. It defaults to 95%, meaning that\n-Elasticsearch enforces a read-only index block\n+Controls the flood stage watermark, which defaults to 95%. Elasticsearch enforces a read-only index block\n (`index.blocks.read_only_allow_delete`) on every index that has one or more\n-shards allocated on the node that has at least one disk exceeding the flood\n-stage. This is a last resort to prevent nodes from running out of disk space.\n-The index block is automatically released once the disk utilization falls below\n+shards allocated on the node, and that has at least one disk exceeding the flood\n+stage. This setting is a last resort to prevent nodes from running out of disk space.\n+The index block is automatically released when the disk utilization falls below\n the high watermark.\n \n-NOTE: You can not mix the usage of percentage values and byte values within\n-these settings. Either all are set to percentage values, or all are set to byte\n-values. This is so that we can we validate that the settings are internally\n-consistent (that is, the low disk threshold is not more than the high disk\n-threshold, and the high disk threshold is not more than the flood stage\n-threshold).\n+NOTE: You cannot mix the usage of percentage values and byte values within\n+these settings. Either all values are set to percentage values, or all are set to byte\n+values. This enforcement is so that Elasticsearch can validate that the settings are internally\n+consistent, ensuring that the low disk threshold is less than the high disk\n+threshold, and the high disk threshold is less than the flood stage\n+threshold. Therefore, you typically do not need to modify this setting.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8643f7529f3f7f64747757d35754467b28733779"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f82d51a552c8988ad4f4053ca3ed0914845bf126", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/f82d51a552c8988ad4f4053ca3ed0914845bf126", "committedDate": "2020-05-27T19:08:38Z", "message": "Removing statement about typically not needting to set the read-only allow delete block."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NTk0MTY1", "url": "https://github.com/elastic/elasticsearch/pull/57184#pullrequestreview-419594165", "createdAt": "2020-05-27T20:45:16Z", "commit": {"oid": "f82d51a552c8988ad4f4053ca3ed0914845bf126"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03fbd466eefcf85f6df48b913986b4a361bc7aa7", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/03fbd466eefcf85f6df48b913986b4a361bc7aa7", "committedDate": "2020-05-28T12:23:03Z", "message": "Replacing Elasticsearch with {es} variable."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4210, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}