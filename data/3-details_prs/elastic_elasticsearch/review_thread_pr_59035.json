{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MjkzNzkx", "number": 59035, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NDozNFrOELk1pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0ODowMlrOELk6DA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTczMzQ5OnYy", "diffSide": "RIGHT", "path": "server/src/internalClusterTest/java/org/elasticsearch/discovery/SnapshotDisruptionIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NDozNFrOGtMTiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwODoxNTo1MlrOGtNSFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MDcxNQ==", "bodyText": "Maybe we could lower this down?", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450040715", "createdAt": "2020-07-06T07:44:34Z", "author": {"login": "tlrx"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/discovery/SnapshotDisruptionIT.java", "diffHunk": "@@ -298,8 +294,7 @@ private void assertSnapshotExists(String repository, String snapshot) {\n     }\n \n     private void createRandomIndex(String idxName) throws InterruptedException {\n-        assertAcked(prepareCreate(idxName, 0, Settings.builder().put(\"number_of_shards\", between(1, 20))\n-            .put(\"number_of_replicas\", 0)));\n+        assertAcked(prepareCreate(idxName, 0, indexSettingsZeroReplicas(between(1, 20))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA1NjcyNg==", "bodyText": "Yea definitely, moved it to 5 :)", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450056726", "createdAt": "2020-07-06T08:15:52Z", "author": {"login": "original-brownbear"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/discovery/SnapshotDisruptionIT.java", "diffHunk": "@@ -298,8 +294,7 @@ private void assertSnapshotExists(String repository, String snapshot) {\n     }\n \n     private void createRandomIndex(String idxName) throws InterruptedException {\n-        assertAcked(prepareCreate(idxName, 0, Settings.builder().put(\"number_of_shards\", between(1, 20))\n-            .put(\"number_of_replicas\", 0)));\n+        assertAcked(prepareCreate(idxName, 0, indexSettingsZeroReplicas(between(1, 20))));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MDcxNQ=="}, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTc0MTYwOnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NzowMVrOGtMYbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NzowMVrOGtMYbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MTk2Nw==", "bodyText": "nit: I'd call this indexRandomDocs()", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450041967", "createdAt": "2020-07-06T07:47:01Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -322,4 +340,30 @@ protected SnapshotInfo createFullSnapshot(String repoName, String snapshotName)\n         assertThat(snapshotInfo.state(), is(SnapshotState.SUCCESS));\n         return snapshotInfo;\n     }\n+\n+    protected void createIndexWithSomeData(String indexName, int docCount) throws InterruptedException {\n+        createIndex(indexName);\n+        ensureGreen();\n+        indexSomeData(indexName, docCount);\n+    }\n+\n+    protected void indexSomeData(String index, int numdocs) throws InterruptedException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTc0MjkzOnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NzoyNVrOGtMZNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0NzoyNVrOGtMZNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MjE2Nw==", "bodyText": "nit: I'd call this createIndexWithRandomDocs()", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450042167", "createdAt": "2020-07-06T07:47:25Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -322,4 +340,30 @@ protected SnapshotInfo createFullSnapshot(String repoName, String snapshotName)\n         assertThat(snapshotInfo.state(), is(SnapshotState.SUCCESS));\n         return snapshotInfo;\n     }\n+\n+    protected void createIndexWithSomeData(String indexName, int docCount) throws InterruptedException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTc0NDM0OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0Nzo1NFrOGtMaEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0Nzo1NFrOGtMaEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MjM4Ng==", "bodyText": "I'd call this indexSettingsNoReplicas()", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450042386", "createdAt": "2020-07-06T07:47:54Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -274,6 +279,19 @@ protected void createRepository(String repoName, String type, Path location) {\n         createRepository(repoName, type, Settings.builder().put(\"location\", location));\n     }\n \n+    protected void createRepository(String repoName, String type) {\n+        Settings.Builder settings = Settings.builder().put(\"location\", randomRepoPath()).put(\"compress\", randomBoolean());\n+        if (rarely()) {\n+            settings = settings.put(\"chunk_size\", randomIntBetween(100, 1000), ByteSizeUnit.BYTES);\n+        }\n+        createRepository(repoName, type, settings);\n+    }\n+\n+    protected static Settings.Builder indexSettingsZeroReplicas(int shards) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTc0NDc2OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0ODowMlrOGtMaVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzo0ODowMlrOGtMaVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0MjQ1NA==", "bodyText": "+1", "url": "https://github.com/elastic/elasticsearch/pull/59035#discussion_r450042454", "createdAt": "2020-07-06T07:48:02Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -274,6 +279,19 @@ protected void createRepository(String repoName, String type, Path location) {\n         createRepository(repoName, type, Settings.builder().put(\"location\", location));\n     }\n \n+    protected void createRepository(String repoName, String type) {\n+        Settings.Builder settings = Settings.builder().put(\"location\", randomRepoPath()).put(\"compress\", randomBoolean());\n+        if (rarely()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c73955506b66b95d9ecf570d3c8a018f2c70c66"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2039, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}