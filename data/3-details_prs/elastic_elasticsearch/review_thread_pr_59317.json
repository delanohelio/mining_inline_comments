{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2OTYzOTE0", "number": 59317, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNjozMjo1MFrOEM-G8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwODo1ODoyNlrOENuWzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyMDM1OTU1OnYy", "diffSide": "RIGHT", "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNjozMjo1MVrOGvY9HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNjozMjo1MVrOGvY9HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM0NTExNg==", "bodyText": "I'm not sure if there is any advantage to including the timestamp_field param in the data_stream object anymore. I think it's easier to just tell users to supply an empty body.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * A `data_stream` definition, optionally containing `@timestamp` in the `timestamp_field`\n          \n          \n            \n            property. If the `@timestamp` field definition is omitted {es} will default to it.\n          \n          \n            \n            The `@timestamp` field must be included in every document indexed to\n          \n          \n            \n            * A `data_stream` object with an empty body (`{ }`). \n          \n      \n    \n    \n  \n\nThe timestamp requirements are already included in the prerequisites:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/master/set-up-a-data-stream.html#data-stream-prereqs\nWe may just want to re-emphasize the @timestamp field is required in the doc index example shown later on this page.\nWe'll also need to update the index template examples. I can do both of those in a follow-up PR.", "url": "https://github.com/elastic/elasticsearch/pull/59317#discussion_r452345116", "createdAt": "2020-07-09T16:32:51Z", "author": {"login": "jrodewig"}, "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "diffHunk": "@@ -131,8 +131,9 @@ this pattern.\n ----\n ====\n \n-* A `data_stream` definition containing `@timestamp` in the `timestamp_field`\n-property. The `@timestamp` field must be included in every document indexed to\n+* A `data_stream` definition, optionally containing `@timestamp` in the `timestamp_field`\n+property. If the `@timestamp` field definition is omitted {es} will default to it.\n+The `@timestamp` field must be included in every document indexed to", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f6c5da6ca763b9b2e6801a1bc0e32102044a171"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyMDM2ODkxOnYy", "diffSide": "RIGHT", "path": "docs/reference/indices/index-templates.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNjozNToyNlrOGvZC9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxNjozNToyNlrOGvZC9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM0NjYxNA==", "bodyText": "I'd change the last sentence to:\n\nMust be @timestamp, which is the default.", "url": "https://github.com/elastic/elasticsearch/pull/59317#discussion_r452346614", "createdAt": "2020-07-09T16:35:26Z", "author": {"login": "jrodewig"}, "path": "docs/reference/indices/index-templates.asciidoc", "diffHunk": "@@ -505,9 +505,9 @@ PUT /_index_template/template_1\n Required properties of a data stream definition:\n \n `timestamp_field`::\n-(Required, string) The name of the timestamp field. This field must be present\n+(Optional, string) The name of the timestamp field. This field must be present\n in all documents indexed into the data stream and must be of type\n-<<date, `date`>> or <<date_nanos, `date_nanos`>>.\n+<<date, `date`>> or <<date_nanos, `date_nanos`>>. Defaults to `@timestamp`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f6c5da6ca763b9b2e6801a1bc0e32102044a171"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyODI2NDQ2OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/ComposableIndexTemplate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwODo1ODoyNlrOGwfXIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwOTo1Mzo0OFrOGwhc8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQ5ODY1OQ==", "bodyText": "maybe remove this field from the xcontent format? So that the only valid format is an empty json object?", "url": "https://github.com/elastic/elasticsearch/pull/59317#discussion_r453498659", "createdAt": "2020-07-13T08:58:26Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/ComposableIndexTemplate.java", "diffHunk": "@@ -250,11 +250,11 @@ public String toString() {\n \n         private static final ConstructingObjectParser<DataStreamTemplate, Void> PARSER = new ConstructingObjectParser<>(\n             \"data_stream_template\",\n-            args -> new DataStreamTemplate((String) args[0])\n+            args -> new DataStreamTemplate(args[0] != null ? (String) args[0] : FIXED_TIMESTAMP_FIELD)\n         );\n \n         static {\n-            PARSER.declareString(ConstructingObjectParser.constructorArg(), DataStream.TIMESTAMP_FIELD_FIELD);\n+            PARSER.declareString(ConstructingObjectParser.optionalConstructorArg(), DataStream.TIMESTAMP_FIELD_FIELD);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69a34f72d7c31a90b9fd346b8884cbbd779642ed"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzUzMjkxNQ==", "bodyText": "Yes, good point. i'll drop the field completely in the POJO but keep the data_stream empty JSON object", "url": "https://github.com/elastic/elasticsearch/pull/59317#discussion_r453532915", "createdAt": "2020-07-13T09:53:48Z", "author": {"login": "andreidan"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/ComposableIndexTemplate.java", "diffHunk": "@@ -250,11 +250,11 @@ public String toString() {\n \n         private static final ConstructingObjectParser<DataStreamTemplate, Void> PARSER = new ConstructingObjectParser<>(\n             \"data_stream_template\",\n-            args -> new DataStreamTemplate((String) args[0])\n+            args -> new DataStreamTemplate(args[0] != null ? (String) args[0] : FIXED_TIMESTAMP_FIELD)\n         );\n \n         static {\n-            PARSER.declareString(ConstructingObjectParser.constructorArg(), DataStream.TIMESTAMP_FIELD_FIELD);\n+            PARSER.declareString(ConstructingObjectParser.optionalConstructorArg(), DataStream.TIMESTAMP_FIELD_FIELD);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQ5ODY1OQ=="}, "originalCommit": {"oid": "69a34f72d7c31a90b9fd346b8884cbbd779642ed"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1948, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}