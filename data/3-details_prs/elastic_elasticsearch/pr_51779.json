{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5Nzk1Nzc3", "number": 51779, "title": "Fix LoggingOutputStream to work on windows", "bodyText": "LoggingOutputStream reads a stream and breaks on newlines. This commit\nfixes the behavior to account for windows newlines also containing \\r.\ncloses #51532", "createdAt": "2020-01-31T22:22:03Z", "url": "https://github.com/elastic/elasticsearch/pull/51779", "merged": true, "mergeCommit": {"oid": "7f0608db179f7bbcb4e3e6ff4fca50b4804afa51"}, "closed": true, "closedAt": "2020-02-01T00:28:44Z", "author": {"login": "rjernst"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_2wmdgH2gAyMzY5Nzk1Nzc3OjFmN2YwMTY5NmNmOTM1NDBjZDcwNzlkYjhjOWNlMDJkOWY3Y2MxMzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_4dmDAFqTM1MTg0NDQ1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1f7f01696cf93540cd7079db8c9ce02d9f7cc134", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/1f7f01696cf93540cd7079db8c9ce02d9f7cc134", "committedDate": "2020-01-31T22:20:07Z", "message": "Fix LoggingOutputStream to work on windows\n\nLoggingOutputStream reads a stream and breaks on newlines. This commit\nfixes the behavior to account for windows newlines also containing `\\r`.\n\ncloses #51532"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxODE1NzIz", "url": "https://github.com/elastic/elasticsearch/pull/51779#pullrequestreview-351815723", "createdAt": "2020-01-31T22:32:18Z", "commit": {"oid": "1f7f01696cf93540cd7079db8c9ce02d9f7cc134"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMjozMjoxOFrOFkZuzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMjozMjoxOFrOFkZuzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxNDYzOA==", "bodyText": "Wouldn't this throw a ArrayIndexOutOfBounds exception for instances where we attempt to write a line which is simply a single \\n character? I think we need to add a bounds check here.", "url": "https://github.com/elastic/elasticsearch/pull/51779#discussion_r373714638", "createdAt": "2020-01-31T22:32:18Z", "author": {"login": "mark-vieira"}, "path": "server/src/main/java/org/elasticsearch/common/logging/LoggingOutputStream.java", "diffHunk": "@@ -91,7 +91,12 @@ public void write(int b) throws IOException {\n     public void flush() {\n         Buffer buffer = threadLocal.get();\n         if (buffer.used == 0) return;\n-        log(new String(buffer.bytes, 0, buffer.used, StandardCharsets.UTF_8));\n+        int used = buffer.used;\n+        if (buffer.bytes[used - 1] == '\\r') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f7f01696cf93540cd7079db8c9ce02d9f7cc134"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxODQ0NDUz", "url": "https://github.com/elastic/elasticsearch/pull/51779#pullrequestreview-351844453", "createdAt": "2020-02-01T00:19:10Z", "commit": {"oid": "1f7f01696cf93540cd7079db8c9ce02d9f7cc134"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2944, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}