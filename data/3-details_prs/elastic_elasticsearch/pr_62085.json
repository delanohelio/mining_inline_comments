{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxOTQyNjM1", "number": 62085, "title": "Wildcard field bug fix for term queries. Wildcard syntax should not be supported in plain term queries.", "bodyText": "Replaced the simple logic that delegated to wildcardQuery() method with dedicated exact-match query logic for term queries.\nAdded test.\nCloses #62081", "createdAt": "2020-09-08T10:23:04Z", "url": "https://github.com/elastic/elasticsearch/pull/62085", "merged": true, "mergeCommit": {"oid": "cd3b511e30a77a03f7d902e3421d32ab7615733d"}, "closed": true, "closedAt": "2020-09-09T09:01:22Z", "author": {"login": "markharwood"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdG1h-2AFqTQ4NDAyMzQwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHHuo7gBqjM3NDQ1NDI5MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MDIzNDA0", "url": "https://github.com/elastic/elasticsearch/pull/62085#pullrequestreview-484023404", "createdAt": "2020-09-08T11:00:49Z", "commit": {"oid": "8895eddbec6e113f6d3e36f25ee62325524c32c5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMTowMDo0OVrOHOXxxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMTowMjozNlrOHOX1Fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDgzMTY4NA==", "bodyText": "I don't think we need the link on the issue. The test name is descriptive enough imo.", "url": "https://github.com/elastic/elasticsearch/pull/62085#discussion_r484831684", "createdAt": "2020-09-08T11:00:49Z", "author": {"login": "jimczi"}, "path": "x-pack/plugin/wildcard/src/test/java/org/elasticsearch/xpack/wildcard/mapper/WildcardFieldMapperTests.java", "diffHunk": "@@ -179,6 +179,41 @@ public void testTooBigQueryField() throws IOException {\n         reader.close();\n         dir.close();\n     }\n+    \n+    \n+    public void testTermQueryIgnoresWildcardSyntax() throws IOException {\n+        // Test for bug https://github.com/elastic/elasticsearch/issues/62081\n+        // where term queries honoured wildcard quwery syntax", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8895eddbec6e113f6d3e36f25ee62325524c32c5"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDgzMjUzNA==", "bodyText": "Isn't it the same problem with prefix query ? Maybe we can just escape ? and * in the value and continue to use the wildcardQuery ?", "url": "https://github.com/elastic/elasticsearch/pull/62085#discussion_r484832534", "createdAt": "2020-09-08T11:02:36Z", "author": {"login": "jimczi"}, "path": "x-pack/plugin/wildcard/src/main/java/org/elasticsearch/xpack/wildcard/mapper/WildcardFieldMapper.java", "diffHunk": "@@ -844,7 +845,36 @@ public Query existsQuery(QueryShardContext context) {\n \n         @Override\n         public Query termQuery(Object value, QueryShardContext context) {\n-            return wildcardQuery(BytesRefs.toString(value), MultiTermQuery.CONSTANT_SCORE_REWRITE, context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8895eddbec6e113f6d3e36f25ee62325524c32c5"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NDM4MTM5", "url": "https://github.com/elastic/elasticsearch/pull/62085#pullrequestreview-484438139", "createdAt": "2020-09-08T19:38:27Z", "commit": {"oid": "71f521c3dd398aaf89f7b3593bde1fa703373fb5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03225727b47e4c89539d4f831a4c108e26063fb2", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/03225727b47e4c89539d4f831a4c108e26063fb2", "committedDate": "2020-09-09T08:14:37Z", "message": "Wildcard field bug fix for term queries. Wildcard syntax should not have special treatment in plain term queries.\nReplaced the simple logic that delegated to wildcardQuery() method with dedicated exact-match query logic for term queries.\n\nCloses #62081"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d66f4c8d65ec182358da5d59d31eec2ed9bb132b", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/d66f4c8d65ec182358da5d59d31eec2ed9bb132b", "committedDate": "2020-09-09T08:14:37Z", "message": "Opted to escape any wildcard syntax in term and prefix queries to keep the one search implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c67667ffe1639ce03f6bb3c03f51734c67a610f", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/8c67667ffe1639ce03f6bb3c03f51734c67a610f", "committedDate": "2020-09-09T08:14:37Z", "message": "Removed comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ddbaacbcc4357e5718dca5e79cec3f4bc5888f4", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/0ddbaacbcc4357e5718dca5e79cec3f4bc5888f4", "committedDate": "2020-09-09T08:14:37Z", "message": "Unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56304a8433696990066e5db286b54fb52751c3e8", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/56304a8433696990066e5db286b54fb52751c3e8", "committedDate": "2020-09-09T08:14:37Z", "message": "Fix test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "71f521c3dd398aaf89f7b3593bde1fa703373fb5", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/71f521c3dd398aaf89f7b3593bde1fa703373fb5", "committedDate": "2020-09-08T13:47:08Z", "message": "Fix test"}, "afterCommit": {"oid": "56304a8433696990066e5db286b54fb52751c3e8", "author": {"user": {"login": "markharwood", "name": null}}, "url": "https://github.com/elastic/elasticsearch/commit/56304a8433696990066e5db286b54fb52751c3e8", "committedDate": "2020-09-09T08:14:37Z", "message": "Fix test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4743, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}