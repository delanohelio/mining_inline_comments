{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0Mzg4MzQy", "number": 59959, "title": "Cleanup and optimize More Serialization Spots", "bodyText": "Same as #59626 for a few more spots.", "createdAt": "2020-07-21T11:00:24Z", "url": "https://github.com/elastic/elasticsearch/pull/59959", "merged": true, "mergeCommit": {"oid": "5d0f8e35656d1031008fdf96048cdf82f40dffac"}, "closed": true, "closedAt": "2020-07-28T18:39:28Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3EGqigH2gAyNDU0Mzg4MzQyOjhiN2VjNmQ1OWNlNGIwYzM2MTIwZmM4MzIxODA1ZGNjNGNiNGQ1ZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5aJsSgH2gAyNDU0Mzg4MzQyOjI1NGNjYThhN2MzNjAwYjM5MWU0NThlYjE0MGYxMThhYjNhZTM0MDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3", "committedDate": "2020-07-21T10:58:49Z", "message": "Cleanup and optimize More Serialization Spots\n\nSame as #59626 for a few more spots."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyODM2ODY3", "url": "https://github.com/elastic/elasticsearch/pull/59959#pullrequestreview-452836867", "createdAt": "2020-07-21T21:18:54Z", "commit": {"oid": "8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMToxODo1NVrOG1KKCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMToyMjozNVrOG1KRIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM5NDEyMg==", "bodyText": "Since i is typically an integer, maybe use mapIn or something like that?", "url": "https://github.com/elastic/elasticsearch/pull/59959#discussion_r458394122", "createdAt": "2020-07-21T21:18:55Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetFieldMappingsResponse.java", "diffHunk": "@@ -61,23 +60,18 @@\n \n     GetFieldMappingsResponse(StreamInput in) throws IOException {\n         super(in);\n-        int size = in.readVInt();\n-        Map<String, Map<String, FieldMappingMetadata>> indexMapBuilder = new HashMap<>(size);\n-        for (int i = 0; i < size; i++) {\n-            String index = in.readString();\n-            if (in.getVersion().before(Version.V_8_0_0)) {\n-                int typesSize = in.readVInt();\n+        mappings = unmodifiableMap(in.readMap(StreamInput::readString, i -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM5NTE4MA==", "bodyText": "Since this PR is labeled to be backported to 7.10, shouldn't we keep this as is so the backport is easy, and cleanup in a separate change just for master?", "url": "https://github.com/elastic/elasticsearch/pull/59959#discussion_r458395180", "createdAt": "2020-07-21T21:21:02Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/shards/IndicesShardStoresResponse.java", "diffHunk": "@@ -213,21 +211,16 @@ public int compareTo(StoreStatus other) {\n      * Single node failure while retrieving shard store information\n      */\n     public static class Failure extends DefaultShardOperationFailedException {\n-        private String nodeId;\n+        private final String nodeId;\n \n         public Failure(String nodeId, String index, int shardId, Throwable reason) {\n             super(index, shardId, reason);\n             this.nodeId = nodeId;\n         }\n \n         private Failure(StreamInput in) throws IOException {\n-            if (in.getVersion().before(Version.V_7_4_0)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM5NTkzOA==", "bodyText": "ditto on making this change in a dedicated PR for master only", "url": "https://github.com/elastic/elasticsearch/pull/59959#discussion_r458395938", "createdAt": "2020-07-21T21:22:35Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/Metadata.java", "diffHunk": "@@ -950,9 +950,7 @@ public void writeTo(StreamOutput out) throws IOException {\n         coordinationMetadata.writeTo(out);\n         writeSettingsToStream(transientSettings, out);\n         writeSettingsToStream(persistentSettings, out);\n-        if (out.getVersion().onOrAfter(Version.V_7_3_0)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b7ec6d59ce4b0c36120fc8321805dcc4cb4d5e3"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30a9b158d32c9b14939ab8b3ab985b025a82c604", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/30a9b158d32c9b14939ab8b3ab985b025a82c604", "committedDate": "2020-07-22T07:37:46Z", "message": "Merge remote-tracking branch 'elastic/master' into cleanup-some-serialization-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf77da242db2784b3d592796c250b41bb458489e", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/bf77da242db2784b3d592796c250b41bb458489e", "committedDate": "2020-07-22T07:58:05Z", "message": "CR: comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2ODMzNzg3", "url": "https://github.com/elastic/elasticsearch/pull/59959#pullrequestreview-456833787", "createdAt": "2020-07-28T17:02:28Z", "commit": {"oid": "bf77da242db2784b3d592796c250b41bb458489e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNzowMjoyOFrOG4WD7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNzowMjoyOFrOG4WD7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTczNDg5Mg==", "bodyText": "Maybe this should exist in MappingMetadata, rather than a random response class?", "url": "https://github.com/elastic/elasticsearch/pull/59959#discussion_r461734892", "createdAt": "2020-07-28T17:02:28Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/mapping/get/GetMappingsResponse.java", "diffHunk": "@@ -69,6 +69,10 @@ public GetMappingsResponse(ImmutableOpenMap<String, MappingMetadata> mappings) {\n \n     @Override\n     public void writeTo(StreamOutput out) throws IOException {\n+        writeMappingMetadata(out, mappings);\n+    }\n+\n+    public static void writeMappingMetadata(StreamOutput out, ImmutableOpenMap<String, MappingMetadata> mappings) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf77da242db2784b3d592796c250b41bb458489e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "355223c0dced77b4b170beb9d797ae85fd35aa7b", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/355223c0dced77b4b170beb9d797ae85fd35aa7b", "committedDate": "2020-07-28T17:43:13Z", "message": "Merge remote-tracking branch 'elastic/master' into cleanup-some-serialization-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "254cca8a7c3600b391e458eb140f118ab3ae3402", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/254cca8a7c3600b391e458eb140f118ab3ae3402", "committedDate": "2020-07-28T17:47:53Z", "message": "move things around"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4152, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}