{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNzkxMDAy", "number": 52880, "title": "BoolQueryBuilder uses ObjectParser", "bodyText": "This commit removes the hand-rolled x-content parsing logic from BoolQueryBuilder\nand instead uses an ObjectParser to handle parsing.  It also removes the long-deprecated\n(since version 6) disable_coord parameter.", "createdAt": "2020-02-27T11:25:44Z", "url": "https://github.com/elastic/elasticsearch/pull/52880", "merged": true, "mergeCommit": {"oid": "0edb1d303d08828a7986aca87da7f52d0780d65e"}, "closed": true, "closedAt": "2020-03-04T15:37:08Z", "author": {"login": "romseygeek"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIZjBCgH2gAyMzgwNzkxMDAyOjI3OGRhYWE3ZjA5NTBhNWU0YTY4NjA3N2UyMmM0NTA4NTI4MmE5OTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKYunnAFqTM2ODg4MDQ1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "278daaa7f0950a5e4a686077e22c45085282a996", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/278daaa7f0950a5e4a686077e22c45085282a996", "committedDate": "2020-02-27T11:23:21Z", "message": "BoolQueryBuilder uses ObjectParser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec59f9784978926435fcf746808f57ff4436a56d", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/ec59f9784978926435fcf746808f57ff4436a56d", "committedDate": "2020-02-27T11:53:42Z", "message": "msm can be string or number"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2Mzk0NDky", "url": "https://github.com/elastic/elasticsearch/pull/52880#pullrequestreview-366394492", "createdAt": "2020-02-28T13:26:48Z", "commit": {"oid": "ec59f9784978926435fcf746808f57ff4436a56d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzoyNjo0OFrOFv04hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzoyNzoyOVrOFv05rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY5MzgyOA==", "bodyText": "I think so!", "url": "https://github.com/elastic/elasticsearch/pull/52880#discussion_r385693828", "createdAt": "2020-02-28T13:26:48Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/query/BoolQueryBuilder.java", "diffHunk": "@@ -51,13 +52,11 @@\n \n     public static final boolean ADJUST_PURE_NEGATIVE_DEFAULT = true;\n \n-    private static final String MUSTNOT = \"mustNot\";\n-    private static final String MUST_NOT = \"must_not\";\n-    private static final String FILTER = \"filter\";\n-    private static final String SHOULD = \"should\";\n-    private static final String MUST = \"must\";\n-    private static final ParseField DISABLE_COORD_FIELD = new ParseField(\"disable_coord\")\n-            .withAllDeprecated(\"disable_coord has been removed\");\n+    private static final ParseField MUSTNOT = new ParseField(\"mustNot\");    // TODO deprecate?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec59f9784978926435fcf746808f57ff4436a56d"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY5NDEyNg==", "bodyText": "Might be worth asserting on the \"inner\" exception too. Or something. Because this message isn't nearly a nice as the other one.", "url": "https://github.com/elastic/elasticsearch/pull/52880#discussion_r385694126", "createdAt": "2020-02-28T13:27:29Z", "author": {"login": "nik9000"}, "path": "server/src/test/java/org/elasticsearch/index/query/BoolQueryBuilderTests.java", "diffHunk": "@@ -277,14 +277,20 @@ public void testFromJson() throws IOException {\n         assertEquals(query, \"kimchy\", ((TermQueryBuilder)queryBuilder.must().get(0)).value());\n     }\n \n+    public void testMinimumShouldMatchNumber() throws IOException {\n+        String query = \"{\\\"bool\\\" : {\\\"must\\\" : { \\\"term\\\" : { \\\"field\\\" : \\\"value\\\" } }, \\\"minimum_should_match\\\" : 1 } }\";\n+        BoolQueryBuilder builder = (BoolQueryBuilder) parseQuery(query);\n+        assertEquals(\"1\", builder.minimumShouldMatch());\n+    }\n+\n     /**\n      * test that unknown query names in the clauses throw an error\n      */\n     public void testUnknownQueryName() throws IOException {\n         String query = \"{\\\"bool\\\" : {\\\"must\\\" : { \\\"unknown_query\\\" : { } } } }\";\n \n-        ParsingException ex = expectThrows(ParsingException.class, () -> parseQuery(query));\n-        assertEquals(\"unknown query [unknown_query]\", ex.getMessage());\n+        XContentParseException ex = expectThrows(XContentParseException.class, () -> parseQuery(query));\n+        assertEquals(\"[1:41] [bool] failed to parse field [must]\", ex.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec59f9784978926435fcf746808f57ff4436a56d"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0f9b1542bd57f969d8c5149328b8ed368bebf05", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/f0f9b1542bd57f969d8c5149328b8ed368bebf05", "committedDate": "2020-03-02T09:30:45Z", "message": "assert on wrapped exception as well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02dbd643b79b7bdfaeb11f8bd8204bf758f06d87", "author": {"user": {"login": "romseygeek", "name": "Alan Woodward"}}, "url": "https://github.com/elastic/elasticsearch/commit/02dbd643b79b7bdfaeb11f8bd8204bf758f06d87", "committedDate": "2020-03-02T09:50:01Z", "message": "Merge remote-tracking branch 'origin/master' into refactor/boolqueryparser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba4f0652f6e00da925774c1b19a4c2b4ed08596e", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/ba4f0652f6e00da925774c1b19a4c2b4ed08596e", "committedDate": "2020-03-02T14:17:47Z", "message": "Merge branch 'master' into refactor/boolqueryparser"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODgwNDUw", "url": "https://github.com/elastic/elasticsearch/pull/52880#pullrequestreview-368880450", "createdAt": "2020-03-04T15:33:58Z", "commit": {"oid": "ba4f0652f6e00da925774c1b19a4c2b4ed08596e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2023, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}