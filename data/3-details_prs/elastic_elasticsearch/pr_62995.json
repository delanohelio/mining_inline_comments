{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NzE4ODQ4", "number": 62995, "title": "InternalClusterInfoService should not ignore hidden indices", "bodyText": "Today InternalClusterInfoService ignores hidden indices when retrieving shard stats of the cluster. This can lead to suboptimal shard allocation decisions as the size of shards are taken into account when allocating new shards or rebalancing existing shards.", "createdAt": "2020-09-29T10:14:11Z", "url": "https://github.com/elastic/elasticsearch/pull/62995", "merged": true, "mergeCommit": {"oid": "77c4713d49e59e5c444739ba306b525f39bb0142"}, "closed": true, "closedAt": "2020-09-30T08:07:22Z", "author": {"login": "tlrx"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNlRQNgH2gAyNDk0NzE4ODQ4Ojk0NjQxOGY5MTdiNDMzOTE3Yjk3OTBiMmU3NjY4OGRkZmY3YzU2NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN3jSDAFqTQ5OTE0ODAwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "946418f917b433917b9790b2e76688ddff7c5644", "author": {"user": {"login": "tlrx", "name": "Tanguy Leroux"}}, "url": "https://github.com/elastic/elasticsearch/commit/946418f917b433917b9790b2e76688ddff7c5644", "committedDate": "2020-09-29T10:03:35Z", "message": "InternalClusterInfoService should not ignore hidden indices"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MzIxMTQz", "url": "https://github.com/elastic/elasticsearch/pull/62995#pullrequestreview-498321143", "createdAt": "2020-09-29T10:18:51Z", "commit": {"oid": "946418f917b433917b9790b2e76688ddff7c5644"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NDA1MzA5", "url": "https://github.com/elastic/elasticsearch/pull/62995#pullrequestreview-498405309", "createdAt": "2020-09-29T12:18:00Z", "commit": {"oid": "946418f917b433917b9790b2e76688ddff7c5644"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMjoxODowMFrOHZqRmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMjoxODowMFrOHZqRmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjY2OTA4Mg==", "bodyText": "nit: just use randomBoolean()?", "url": "https://github.com/elastic/elasticsearch/pull/62995#discussion_r496669082", "createdAt": "2020-09-29T12:18:00Z", "author": {"login": "henningandersen"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/cluster/ClusterInfoServiceIT.java", "diffHunk": "@@ -117,13 +118,18 @@ private void setClusterInfoTimeout(String timeValue) {\n \n     public void testClusterInfoServiceCollectsInformation() {\n         internalCluster().startNodes(2);\n-        assertAcked(prepareCreate(\"test\").setSettings(Settings.builder()\n-            .put(Store.INDEX_STORE_STATS_REFRESH_INTERVAL_SETTING.getKey(), 0)\n-            .put(EnableAllocationDecider.INDEX_ROUTING_REBALANCE_ENABLE_SETTING.getKey(), EnableAllocationDecider.Rebalance.NONE).build()));\n+\n+        final String indexName = (rarely() ? \".\" : \"\") + randomAlphaOfLength(5).toLowerCase(Locale.ROOT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "946418f917b433917b9790b2e76688ddff7c5644"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b29ed729ee87059a3133d7019c0407a12249e44", "author": {"user": {"login": "tlrx", "name": "Tanguy Leroux"}}, "url": "https://github.com/elastic/elasticsearch/commit/9b29ed729ee87059a3133d7019c0407a12249e44", "committedDate": "2020-09-29T13:49:00Z", "message": "Use randomBoolean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "839512ea7d4dd27ac719b4b485b59194c088269f", "author": {"user": {"login": "tlrx", "name": "Tanguy Leroux"}}, "url": "https://github.com/elastic/elasticsearch/commit/839512ea7d4dd27ac719b4b485b59194c088269f", "committedDate": "2020-09-29T13:49:16Z", "message": "Merge branch 'master' into fix-hidden-indices-in-internal-cluster-info"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99b262fb03ca6bb93aff05d7493445693a413b4d", "author": {"user": {"login": "tlrx", "name": "Tanguy Leroux"}}, "url": "https://github.com/elastic/elasticsearch/commit/99b262fb03ca6bb93aff05d7493445693a413b4d", "committedDate": "2020-09-29T13:59:14Z", "message": "Also test system indices"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55ce2b06b5f8af0c42ddc0389d6b60c20aa59acc", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/55ce2b06b5f8af0c42ddc0389d6b60c20aa59acc", "committedDate": "2020-09-29T15:05:45Z", "message": "Merge branch 'master' into fix-hidden-indices-in-internal-cluster-info"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MTQ4MDA2", "url": "https://github.com/elastic/elasticsearch/pull/62995#pullrequestreview-499148006", "createdAt": "2020-09-30T07:21:34Z", "commit": {"oid": "55ce2b06b5f8af0c42ddc0389d6b60c20aa59acc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4513, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}