{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNzE1NzIz", "number": 54043, "title": "Invert license security disabled helper method", "bodyText": "Xpack license state contains a helper method to determine whether\nsecurity is disabled due to license level defaults. Most code needs to\nknow whether security is enabled, not disabled, but this method exists\nso that the security being explicitly disabled can be distinguished from\nlicence level defaulting to disabled. However, in the case that security\nis explicitly disabled, the handlers in question are never registered,\nso security is implicitly not disabled explicitly, and thus we can share\na single method to know whether licensing is enabled.", "createdAt": "2020-03-24T00:58:16Z", "url": "https://github.com/elastic/elasticsearch/pull/54043", "merged": true, "mergeCommit": {"oid": "0bee3f7410107210f712195836dc7d7442ad3cba"}, "closed": true, "closedAt": "2020-03-25T23:42:29Z", "author": {"login": "rjernst"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQoF6iAH2gAyMzkyNzE1NzIzOmJlMTc1MGU1OWRhNDQ5ZDlmYmUwZmRiYTEyNzk2ZTM0NmU0ZDBmYzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcROwdoAH2gAyMzkyNzE1NzIzOjViMjcyMjZmYjI0YjRhYTkyN2EyMjNkNTU5ZTExNzQ5ZjQzYTk2MDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be1750e59da449d9fbe0fdba12796e346e4d0fc7", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/be1750e59da449d9fbe0fdba12796e346e4d0fc7", "committedDate": "2020-03-24T00:51:32Z", "message": "Invert license security disabled helper method\n\nXpack license state contains a helper method to determine whether\nsecurity is disabled due to license level defaults. Most code needs to\nknow whether security is enabled, not disabled, but this method exists\nso that the security being explicitly disabled can be distinguished from\nlicence level defaulting to disabled. However, in the case that security\nis explicitly disabled, the handlers in question are never registered,\nso security is implicitly not disabled explicitly, and thus we can share\na single method to know whether licensing is enabled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d09ef1f02331a8e1e1b2c534c1afb45634a2d1c2", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/d09ef1f02331a8e1e1b2c534c1afb45634a2d1c2", "committedDate": "2020-03-24T03:35:25Z", "message": "fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMDA0NjIw", "url": "https://github.com/elastic/elasticsearch/pull/54043#pullrequestreview-381004620", "createdAt": "2020-03-25T10:04:15Z", "commit": {"oid": "d09ef1f02331a8e1e1b2c534c1afb45634a2d1c2"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMDowNDoxNlrOF7T0hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMDowODo0NlrOF7T-8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzczNTA0Ng==", "bodyText": "This one looks to be backwards.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (licenseState.isSecurityEnabled()) {\n          \n          \n            \n                        if (licenseState.isSecurityEnabled() == false) {", "url": "https://github.com/elastic/elasticsearch/pull/54043#discussion_r397735046", "createdAt": "2020-03-25T10:04:16Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java", "diffHunk": "@@ -111,7 +111,7 @@ public SecurityActionFilter(AuthenticationService authcService, AuthorizationSer\n                 listener.onFailure(e);\n             }\n         } else if (SECURITY_ACTION_MATCHER.test(action)) {\n-            if (licenseState.isSecurityDisabledByLicenseDefaults()) {\n+            if (licenseState.isSecurityEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d09ef1f02331a8e1e1b2c534c1afb45634a2d1c2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzczNzcxMg==", "bodyText": "I don't follow how this works. We don't seem to configure the value security.enabled based on explicitlyDisabled.", "url": "https://github.com/elastic/elasticsearch/pull/54043#discussion_r397737712", "createdAt": "2020-03-25T10:08:46Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityInfoTransportActionTests.java", "diffHunk": "@@ -226,8 +227,13 @@ public void testUsage() throws Exception {\n                 // FIPS 140\n                 assertThat(source.getValue(\"fips_140.enabled\"), is(fips140Enabled));\n             } else {\n+                if (explicitlyDisabled) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d09ef1f02331a8e1e1b2c534c1afb45634a2d1c2"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e9b447780f18fb1cc3ff269efae5d904f3470c7", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/0e9b447780f18fb1cc3ff269efae5d904f3470c7", "committedDate": "2020-03-25T21:41:48Z", "message": "Merge branch 'master' into refactor_license5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b27226fb24b4aa927a223d559e11749f43a9607", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/5b27226fb24b4aa927a223d559e11749f43a9607", "committedDate": "2020-03-25T21:54:24Z", "message": "address feedback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1649, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}