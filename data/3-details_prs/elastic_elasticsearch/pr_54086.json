{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyOTk2Mjgx", "number": 54086, "title": "[DOCS] EQL: Document `wildcard` function", "bodyText": "Adds documentation for the EQL wildcard function.\nDepends on #54020", "createdAt": "2020-03-24T13:38:19Z", "url": "https://github.com/elastic/elasticsearch/pull/54086", "merged": true, "mergeCommit": {"oid": "33dc417bd024f86473f3506fd306bd2c01f63757"}, "closed": true, "closedAt": "2020-04-10T13:17:42Z", "author": {"login": "jrodewig"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRKg3ygBqjMxNjQ4ODQyMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWQuQIgH2gAyMzkyOTk2MjgxOjc3YTA3MTBmY2QzZWY4NDhmZjUxZmVjZGFlMzkxZDU5MDRhMTRiNmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fdf2b8fa121429fc90fcc5c8656515c7778fa9e4", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/fdf2b8fa121429fc90fcc5c8656515c7778fa9e4", "committedDate": "2020-03-25T14:50:24Z", "message": "Add multi-arg footnote"}, "afterCommit": {"oid": "b00b0c7bc455bd68e813d27ec56001b72bdc5444", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/b00b0c7bc455bd68e813d27ec56001b72bdc5444", "committedDate": "2020-03-25T16:55:27Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b00b0c7bc455bd68e813d27ec56001b72bdc5444", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/b00b0c7bc455bd68e813d27ec56001b72bdc5444", "committedDate": "2020-03-25T16:55:27Z", "message": "[DOCS] EQL: Document `wildcard` function"}, "afterCommit": {"oid": "64c5028046f7c1d3ac4989b1d05d9c9c08f475cf", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/64c5028046f7c1d3ac4989b1d05d9c9c08f475cf", "committedDate": "2020-03-25T17:09:50Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93a17b567bd3dfa1f6e5c99c0905f08606044bc0", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/93a17b567bd3dfa1f6e5c99c0905f08606044bc0", "committedDate": "2020-03-25T17:35:45Z", "message": "reword"}, "afterCommit": {"oid": "2380d7f751bfdcfdd8a90be105904b1f3d15ce18", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/2380d7f751bfdcfdd8a90be105904b1f3d15ce18", "committedDate": "2020-04-06T14:50:40Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2380d7f751bfdcfdd8a90be105904b1f3d15ce18", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/2380d7f751bfdcfdd8a90be105904b1f3d15ce18", "committedDate": "2020-04-06T14:50:40Z", "message": "[DOCS] EQL: Document `wildcard` function"}, "afterCommit": {"oid": "a3ac5cf1d35339c05ddbaaa8e950e832691a5a2d", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/a3ac5cf1d35339c05ddbaaa8e950e832691a5a2d", "committedDate": "2020-04-06T14:58:10Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3ac5cf1d35339c05ddbaaa8e950e832691a5a2d", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/a3ac5cf1d35339c05ddbaaa8e950e832691a5a2d", "committedDate": "2020-04-06T14:58:10Z", "message": "[DOCS] EQL: Document `wildcard` function"}, "afterCommit": {"oid": "6e2662b56182485f72d69813a828e94168710057", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/6e2662b56182485f72d69813a828e94168710057", "committedDate": "2020-04-06T15:01:07Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce7a01e03145d55c358ee857041e68e87afc5b8e", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/ce7a01e03145d55c358ee857041e68e87afc5b8e", "committedDate": "2020-04-06T15:10:02Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e2662b56182485f72d69813a828e94168710057", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/6e2662b56182485f72d69813a828e94168710057", "committedDate": "2020-04-06T15:01:07Z", "message": "[DOCS] EQL: Document `wildcard` function"}, "afterCommit": {"oid": "ce7a01e03145d55c358ee857041e68e87afc5b8e", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/ce7a01e03145d55c358ee857041e68e87afc5b8e", "committedDate": "2020-04-06T15:10:02Z", "message": "[DOCS] EQL: Document `wildcard` function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/d9116060341f8c736ca03ce5ed6eee96837e85a1", "committedDate": "2020-04-06T15:35:07Z", "message": "clarifications"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTc1NDk5", "url": "https://github.com/elastic/elasticsearch/pull/54086#pullrequestreview-388575499", "createdAt": "2020-04-06T20:03:32Z", "commit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowMzozM1rOGBn0QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowMzozM1rOGBn0QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NDExMw==", "bodyText": "This behavior isn't consistent with other string functions, like startsWith: https://www.elastic.co/guide/en/elasticsearch/reference/master/eql-function-ref.html#eql-fn-startswith\nI wonder if it would be more consistent to just pass a null value?", "url": "https://github.com/elastic/elasticsearch/pull/54086#discussion_r404354113", "createdAt": "2020-04-06T20:03:33Z", "author": {"login": "jrodewig"}, "path": "docs/reference/eql/functions.asciidoc", "diffHunk": "@@ -276,4 +277,82 @@ function returns the remaining string.\n Positions are zero-indexed. Negative offsets are supported.\n \n *Returns:* string\n+====\n+\n+[discrete]\n+[[eql-fn-wildcard]]\n+=== `wildcard`\n+Returns `true` if a source string matches one or more provided wildcard\n+expressions. Matching is case sensitive.\n+\n+[%collapsible]\n+====\n+*Example*\n+[source,eql]\n+----\n+// The two following expressions are equivalent.\n+process.command_line == \"*start*\" or process.command_line == \"*config*\"\n+wildcard(process.command_line, \"*start*\", \"*config*\")\n+\n+// process.command_line = \"start explorer.exe\"\n+wildcard(process.command_line, \"*start*\")                // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")    // returns true\n+wildcard(process.command_line, \"*config*\")               // returns false\n+wildcard(process.command_line, \"*config*\", \"*create*\")   // returns false\n+\n+// process.command_line = [ \"start explorer.exe\", \"create regsvr32.exe\" ]\n+wildcard(process.command_line, \"*create*\")              // returns true\n+wildcard(process.command_line, \"*create*\", \"*config*\")  // returns true\n+wildcard(process.command_line, \"*start*\")               // returns false\n+wildcard(process.command_line, \"*start*\", \"*create*\")   // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")   // returns false\n+\n+// case sensitive matching\n+wildcard(\"start explorer.exe\", \"*start*\")                // returns true\n+wildcard(\"start explorer.exe\", \"*Start*\")                // returns false\n+\n+// null handling\n+wildcard(null, \"*start*\")                                // returns false\n+wildcard(null, null)                                     // returns 500 error\n+wildcard(\"start explorer.exe\", null)                     // returns 500 error\n+wildcard(\"start explorer.exe\", null, \"*start*\")          // returns 500 error\n+wildcard(\"\", null)                                       // returns 500 error", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTc1NzEx", "url": "https://github.com/elastic/elasticsearch/pull/54086#pullrequestreview-388575711", "createdAt": "2020-04-06T20:03:54Z", "commit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowMzo1NFrOGBn0-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowMzo1NFrOGBn0-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NDI5Nw==", "bodyText": "If null, the function returns a 500 error.\n\nSee https://github.com/elastic/elasticsearch/pull/54086/files#r404354113", "url": "https://github.com/elastic/elasticsearch/pull/54086#discussion_r404354297", "createdAt": "2020-04-06T20:03:54Z", "author": {"login": "jrodewig"}, "path": "docs/reference/eql/functions.asciidoc", "diffHunk": "@@ -276,4 +277,82 @@ function returns the remaining string.\n Positions are zero-indexed. Negative offsets are supported.\n \n *Returns:* string\n+====\n+\n+[discrete]\n+[[eql-fn-wildcard]]\n+=== `wildcard`\n+Returns `true` if a source string matches one or more provided wildcard\n+expressions. Matching is case sensitive.\n+\n+[%collapsible]\n+====\n+*Example*\n+[source,eql]\n+----\n+// The two following expressions are equivalent.\n+process.command_line == \"*start*\" or process.command_line == \"*config*\"\n+wildcard(process.command_line, \"*start*\", \"*config*\")\n+\n+// process.command_line = \"start explorer.exe\"\n+wildcard(process.command_line, \"*start*\")                // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")    // returns true\n+wildcard(process.command_line, \"*config*\")               // returns false\n+wildcard(process.command_line, \"*config*\", \"*create*\")   // returns false\n+\n+// process.command_line = [ \"start explorer.exe\", \"create regsvr32.exe\" ]\n+wildcard(process.command_line, \"*create*\")              // returns true\n+wildcard(process.command_line, \"*create*\", \"*config*\")  // returns true\n+wildcard(process.command_line, \"*start*\")               // returns false\n+wildcard(process.command_line, \"*start*\", \"*create*\")   // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")   // returns false\n+\n+// case sensitive matching\n+wildcard(\"start explorer.exe\", \"*start*\")                // returns true\n+wildcard(\"start explorer.exe\", \"*Start*\")                // returns false\n+\n+// null handling\n+wildcard(null, \"*start*\")                                // returns false\n+wildcard(null, null)                                     // returns 500 error\n+wildcard(\"start explorer.exe\", null)                     // returns 500 error\n+wildcard(\"start explorer.exe\", null, \"*start*\")          // returns 500 error\n+wildcard(\"\", null)                                       // returns 500 error\n+wildcard(\"\", \"\")                                         // returns true\n+----\n+\n+*Syntax*\n+\n+[source,txt]\n+----\n+wildcard(<source>, <wildcard_exp>[, ...])\n+----\n+\n+*Parameters*\n+\n+`<source>`::\n++\n+--\n+(Required, string)\n+Source string.\n+\n+If using a field as the argument, this parameter only supports the following\n+field datatypes:\n+\n+* <<keyword,`keyword`>>\n+* <<constant-keyword,`constant_keyword`>>\n+* <<text,`text`>> field with a <<keyword,`keyword`>> or\n+  <<constant-keyword,`constant_keyword`>> sub-field\n+\n+Fields containing <<array,array values>> use the last array item only.\n+--\n+\n+`<wildcard_exp>`::\n++\n+--\n+(Required{multi-arg}, string)\n+Wildcard expression used to match the source string. Fields are not supported as\n+arguments. If `null`, the function returns a 500 error.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTc2ODM3", "url": "https://github.com/elastic/elasticsearch/pull/54086#pullrequestreview-388576837", "createdAt": "2020-04-06T20:05:37Z", "commit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowNTozN1rOGBn4eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDowNTozN1rOGBn4eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM1NTE5Mw==", "bodyText": "Fields containing <<array,array values>> use the last array item only.\n\nThis behavior seemed a little odd to me, but it's not consistent across functions. endsWith and startsWith only use the first array item. length doesn't support arrays at all.", "url": "https://github.com/elastic/elasticsearch/pull/54086#discussion_r404355193", "createdAt": "2020-04-06T20:05:37Z", "author": {"login": "jrodewig"}, "path": "docs/reference/eql/functions.asciidoc", "diffHunk": "@@ -276,4 +277,82 @@ function returns the remaining string.\n Positions are zero-indexed. Negative offsets are supported.\n \n *Returns:* string\n+====\n+\n+[discrete]\n+[[eql-fn-wildcard]]\n+=== `wildcard`\n+Returns `true` if a source string matches one or more provided wildcard\n+expressions. Matching is case sensitive.\n+\n+[%collapsible]\n+====\n+*Example*\n+[source,eql]\n+----\n+// The two following expressions are equivalent.\n+process.command_line == \"*start*\" or process.command_line == \"*config*\"\n+wildcard(process.command_line, \"*start*\", \"*config*\")\n+\n+// process.command_line = \"start explorer.exe\"\n+wildcard(process.command_line, \"*start*\")                // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")    // returns true\n+wildcard(process.command_line, \"*config*\")               // returns false\n+wildcard(process.command_line, \"*config*\", \"*create*\")   // returns false\n+\n+// process.command_line = [ \"start explorer.exe\", \"create regsvr32.exe\" ]\n+wildcard(process.command_line, \"*create*\")              // returns true\n+wildcard(process.command_line, \"*create*\", \"*config*\")  // returns true\n+wildcard(process.command_line, \"*start*\")               // returns false\n+wildcard(process.command_line, \"*start*\", \"*create*\")   // returns true\n+wildcard(process.command_line, \"*start*\", \"*config*\")   // returns false\n+\n+// case sensitive matching\n+wildcard(\"start explorer.exe\", \"*start*\")                // returns true\n+wildcard(\"start explorer.exe\", \"*Start*\")                // returns false\n+\n+// null handling\n+wildcard(null, \"*start*\")                                // returns false\n+wildcard(null, null)                                     // returns 500 error\n+wildcard(\"start explorer.exe\", null)                     // returns 500 error\n+wildcard(\"start explorer.exe\", null, \"*start*\")          // returns 500 error\n+wildcard(\"\", null)                                       // returns 500 error\n+wildcard(\"\", \"\")                                         // returns true\n+----\n+\n+*Syntax*\n+\n+[source,txt]\n+----\n+wildcard(<source>, <wildcard_exp>[, ...])\n+----\n+\n+*Parameters*\n+\n+`<source>`::\n++\n+--\n+(Required, string)\n+Source string.\n+\n+If using a field as the argument, this parameter only supports the following\n+field datatypes:\n+\n+* <<keyword,`keyword`>>\n+* <<constant-keyword,`constant_keyword`>>\n+* <<text,`text`>> field with a <<keyword,`keyword`>> or\n+  <<constant-keyword,`constant_keyword`>> sub-field\n+\n+Fields containing <<array,array values>> use the last array item only.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9116060341f8c736ca03ce5ed6eee96837e85a1"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b1e6e077d7e20e180d2b3de988eae9d7d789dbb", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/9b1e6e077d7e20e180d2b3de988eae9d7d789dbb", "committedDate": "2020-04-08T14:06:02Z", "message": "update null and empty string examples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "184bd532f3775d8a480c8094eb72c985c202c4d7", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/184bd532f3775d8a480c8094eb72c985c202c4d7", "committedDate": "2020-04-08T17:12:55Z", "message": "Remove case sensitive references matching per ##54411."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "628906f0dd5f15d76a515d9f7a893e29acf48e08", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/628906f0dd5f15d76a515d9f7a893e29acf48e08", "committedDate": "2020-04-08T17:19:26Z", "message": "Simplify examples"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMTkyOTU4", "url": "https://github.com/elastic/elasticsearch/pull/54086#pullrequestreview-391192958", "createdAt": "2020-04-09T23:28:02Z", "commit": {"oid": "628906f0dd5f15d76a515d9f7a893e29acf48e08"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c2ae7a0394a966ea43376c1ff9ba9b5bf6fa78a", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/1c2ae7a0394a966ea43376c1ff9ba9b5bf6fa78a", "committedDate": "2020-04-10T12:41:13Z", "message": "updates for array and null values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77a0710fcd3ef848ff51fecdae391d5904a14b6f", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/77a0710fcd3ef848ff51fecdae391d5904a14b6f", "committedDate": "2020-04-10T13:01:25Z", "message": "fix double space"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1693, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}