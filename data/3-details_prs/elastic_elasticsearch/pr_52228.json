{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczODIzNDk0", "number": 52228, "title": "Use absolute path for temporary directory in tests", "bodyText": "We explicitly set the path for the temporary directory to use in test tasks, but today this path is a relative path, relative to the current working directory of the test task. The fact that we are using a relative path here appears to be legacy, simply leftover from the days of the Maven build. An absolute path is preferred here, since it's explicit and we do not have to rely on everyone resolving the path properly relative to the working directory.\nRelates #52176", "createdAt": "2020-02-11T18:53:57Z", "url": "https://github.com/elastic/elasticsearch/pull/52228", "merged": true, "mergeCommit": {"oid": "5dbf44941c6b4d86124f3226f993feee9e7ae92a"}, "closed": true, "closedAt": "2020-02-11T20:08:00Z", "author": {"login": "jasontedor"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDWWxDAH2gAyMzczODIzNDk0OmI4NmMwOWM0NWM5ZjhkOGVkMmFiMGU0ODY1MmFiODg1M2JhNzY4YzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDWoudgFqTM1NjkxOTY1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b86c09c45c9f8d8ed2ab0e48652ab8853ba768c6", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/b86c09c45c9f8d8ed2ab0e48652ab8853ba768c6", "committedDate": "2020-02-11T18:50:38Z", "message": "Use absolute path for temporary directory in tests\n\nWe explicitly set the path for the temporary directory to use in test\ntasks, but today this path is a relative path, relative to the current\nworking directory of the test task. The fact that we are using a\nrelative path here appears to be legacy, simply leftover from the days\nof the Maven build. An absolute path is preferred here, since it's\nexplicit and we do not have to rely on everyone resolving the path\nproperly relative to the working directory."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTE2NTU2", "url": "https://github.com/elastic/elasticsearch/pull/52228#pullrequestreview-356916556", "createdAt": "2020-02-11T19:05:40Z", "commit": {"oid": "b86c09c45c9f8d8ed2ab0e48652ab8853ba768c6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTowNTo0MFrOFoVYVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTowNTo0MFrOFoVYVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNzY1NQ==", "bodyText": "Since we are changing this to an absolute path we need to ignore this system property for the purposes of task input snapshotting or it'll break cache reuse. We'll need to move this down below where we set other properties with absolute paths via nonInputProperties.", "url": "https://github.com/elastic/elasticsearch/pull/52228#discussion_r377837655", "createdAt": "2020-02-11T19:05:40Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy", "diffHunk": "@@ -686,8 +686,8 @@ class BuildPlugin implements Plugin<Project> {\n                     test.jvmArgs '-ea', '-esa'\n                 }\n \n-                // we use './temp' since this is per JVM and tests are forbidden from writing to CWD\n-                test.systemProperties 'java.io.tmpdir': './temp',\n+                // we use 'temp' relative to CWD since this is per JVM and tests are forbidden from writing to CWD\n+                test.systemProperties 'java.io.tmpdir': test.workingDir.toPath().resolve('temp'),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b86c09c45c9f8d8ed2ab0e48652ab8853ba768c6"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dba342999386573fe98decb39e224e824f8ac1e", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/0dba342999386573fe98decb39e224e824f8ac1e", "committedDate": "2020-02-11T19:08:42Z", "message": "Do not break caching"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTE5NjU5", "url": "https://github.com/elastic/elasticsearch/pull/52228#pullrequestreview-356919659", "createdAt": "2020-02-11T19:10:15Z", "commit": {"oid": "0dba342999386573fe98decb39e224e824f8ac1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2580, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}