{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzAzODA1", "number": 51501, "title": "Disable diagnostic trust manager in tests", "bodyText": "This commit sets xpack.security.ssl.diagnose.trust to false in all\nof our tests when running in FIPS 140 mode and when settings objects\nare used to create an instance of the SSLService. This is needed\nin 7.x because setting xpack.security.ssl.diagnose.trust to true\nwraps SunJSSE TrustManager with our own DiagnosticTrustManager and\nthis is not allowed when SunJSSE is in FIPS mode.\nAn alternative would be to set xpack.security.fips.enabled to\ntrue which would also implicitly disable\nxpack.security.ssl.diagnose.trust but would have additional effects\n(would require that we set PBKDF2 for password hashing algorithm in\nall test clusters, would prohibit using JKS keystores in nodes even\nif relevant tests have been muted in FIPS mode etc.)\nRelates: #49900\nResoles: #51268", "createdAt": "2020-01-27T21:07:16Z", "url": "https://github.com/elastic/elasticsearch/pull/51501", "merged": true, "mergeCommit": {"oid": "4f3548fbd7ed763221d8bb8c34115e67d51e48ad"}, "closed": true, "closedAt": "2020-01-28T08:17:36Z", "author": {"login": "jkakavas"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-jInHgH2gAyMzY3NzAzODA1OjFlODU1MmNjODg0YjE2Mzg1OTZjMWNkYTk0YjhkOGYzMTFlZmRiYjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-rEObAH2gAyMzY3NzAzODA1OmI0OGQ1N2UyNWZhNzE2YjQyMWQxY2Y0M2NmNzY4Nzg5NjY1OGUyODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/1e8552cc884b1638596c1cda94b8d8f311efdbb4", "committedDate": "2020-01-27T20:54:19Z", "message": "Disable diagnostic trust manager in tests\n\nThis commit sets `xpack.security.ssl.diagnose.trust` to false in all\nof our tests when running in FIPS 140 mode and when settings objects\nare used to create an instance of the SSLService. This is needed\nin 7.x because setting xpack.security.ssl.diagnose.trust to true\nwraps SunJSSE TrustManager with our own DiagnosticTrustManager and\nthis is not allowed when SunJSSE is in FIPS mode.\nAn alternative would be to set xpack.security.fips.enabled to\ntrue which would also implicitly disable\nxpack.security.ssl.diagnose.trust but would have additional effects\n(would require that we set PBKDF2 for password hashing algorithm in\nall test clusters, would prohibit using JKS keystores in nodes even\nif relevant tests have been muted in FIPS mode etc.)\n\nRelates: #49900\nResoles: #51268"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MTQxMzA1", "url": "https://github.com/elastic/elasticsearch/pull/51501#pullrequestreview-349141305", "createdAt": "2020-01-28T05:47:47Z", "commit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "state": "APPROVED", "comments": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNTo0Nzo0N1rOFiZ1kA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwNTo1Mjo1NFrOFiZ5XA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTIxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619216", "createdAt": "2020-01-28T05:47:47Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/PkiRealmBootstrapCheckTests.java", "diffHunk": "@@ -144,4 +145,12 @@ public void testBootstrapCheckWithClosedSecuredSetting() throws Exception {\n         secureSettings.close();\n         assertThat(check.check(createTestContext(settings, null)).isFailure(), Matchers.equalTo(expectFail));\n     }\n+\n+    private Settings.Builder getSettingsBuilder(){\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTI1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619256", "createdAt": "2020-01-28T05:48:01Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityTests.java", "diffHunk": "@@ -98,10 +98,14 @@\n         if (security != null) {\n             throw new IllegalStateException(\"Security object already exists (\" + security + \")\");\n         }\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder()\n             .put(\"xpack.security.enabled\", true)\n             .put(testSettings)\n-            .put(\"path.home\", createTempDir()).build();\n+            .put(\"path.home\", createTempDir());\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTMyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (inFipsJvm()){\n          \n          \n            \n                        if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619324", "createdAt": "2020-01-28T05:48:19Z", "author": {"login": "tvernum"}, "path": "test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java", "diffHunk": "@@ -1112,6 +1113,9 @@ public Client client(Node node, String clusterName) {\n                 .put(\"logger.prefix\", nodeSettings.get(\"logger.prefix\", \"\"))\n                 .put(\"logger.level\", nodeSettings.get(\"logger.level\", \"INFO\"))\n                 .put(settings);\n+            if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTM3Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private static Settings possiblyDisableTlsDiagnostic(Settings settings){\n          \n          \n            \n                private static Settings possiblyDisableTlsDiagnostic(Settings settings) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619373", "createdAt": "2020-01-28T05:48:31Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/TestXPackTransportClient.java", "diffHunk": "@@ -51,4 +52,12 @@ public void close() {\n             }\n         }\n     }\n+\n+    private static Settings possiblyDisableTlsDiagnostic(Settings settings){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTM5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619395", "createdAt": "2020-01-28T05:48:40Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/TestXPackTransportClient.java", "diffHunk": "@@ -51,4 +52,12 @@ public void close() {\n             }\n         }\n     }\n+\n+    private static Settings possiblyDisableTlsDiagnostic(Settings settings){\n+        Settings.Builder builder = Settings.builder().put(settings);\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTQzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619432", "createdAt": "2020-01-28T05:48:53Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/test/SecurityIntegTestCase.java", "diffHunk": "@@ -246,6 +246,9 @@ protected Settings nodeSettings(int nodeOrdinal) {\n         builder.put(LicenseService.SELF_GENERATED_LICENSE_TYPE.getKey(), \"trial\");\n         builder.put(NetworkModule.TRANSPORT_TYPE_KEY, randomBoolean() ? SecurityField.NAME4 : SecurityField.NIO);\n         builder.put(NetworkModule.HTTP_TYPE_KEY, randomBoolean() ? SecurityField.NAME4 : SecurityField.NIO);\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTQ1MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619450", "createdAt": "2020-01-28T05:49:04Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/test/SecuritySettingsSource.java", "diffHunk": "@@ -147,6 +147,9 @@ public Settings nodeSettings(int nodeOrdinal) {\n                 .put(\"xpack.security.authc.realms.\" + FileRealmSettings.TYPE + \".file.order\", 0)\n                 .put(\"xpack.security.authc.realms.\" + NativeRealmSettings.TYPE + \".index.order\", \"1\")\n                 .put(\"xpack.license.self_generated.type\", \"trial\");\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTUxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619517", "createdAt": "2020-01-28T05:49:25Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/test/SecuritySingleNodeTestCase.java", "diffHunk": "@@ -167,6 +168,9 @@ protected Settings nodeSettings() {\n         builder.put(LicenseService.SELF_GENERATED_LICENSE_TYPE.getKey(), \"trial\");\n         builder.put(\"transport.type\", \"security4\");\n         builder.put(\"path.home\", customSecuritySettingsSource.nodePath(0));\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTU0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Settings.Builder getSettingsBuilder(){\n          \n          \n            \n                private Settings.Builder getSettingsBuilder() {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619549", "createdAt": "2020-01-28T05:49:35Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/PkiRealmBootstrapCheckTests.java", "diffHunk": "@@ -144,4 +145,12 @@ public void testBootstrapCheckWithClosedSecuredSetting() throws Exception {\n         secureSettings.close();\n         assertThat(check.check(createTestContext(settings, null)).isFailure(), Matchers.equalTo(expectFail));\n     }\n+\n+    private Settings.Builder getSettingsBuilder(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTU4Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619583", "createdAt": "2020-01-28T05:49:46Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/action/oidc/TransportOpenIdConnectLogoutActionTests.java", "diffHunk": "@@ -92,7 +92,11 @@ public void setup() throws Exception {\n             .put(XPackSettings.TOKEN_SERVICE_ENABLED_SETTING.getKey(), true)\n             .put(\"path.home\", createTempDir())\n             .build();\n-        final Settings sslSettings = Settings.builder()\n+        Settings.Builder sslSettingsBuilder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTYwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619604", "createdAt": "2020-01-28T05:49:53Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/esnative/tool/CommandLineHttpClientTests.java", "diffHunk": "@@ -70,7 +71,11 @@ public void testCommandLineHttpClientCanExecuteAndReturnCorrectResultUsingSSLSet\n     }\n \n     public void testGetDefaultURLFailsWithHelpfulMessage() {\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTYzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619630", "createdAt": "2020-01-28T05:50:02Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/esnative/tool/CommandLineHttpClientTests.java", "diffHunk": "@@ -87,7 +92,11 @@ private MockWebServer createMockWebServer() {\n     private Settings.Builder getHttpSslSettings() {\n         MockSecureSettings secureSettings = new MockSecureSettings();\n         secureSettings.setString(\"xpack.security.http.ssl.secure_key_passphrase\", \"testnode\");\n-        return Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTY0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619648", "createdAt": "2020-01-28T05:50:12Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/ActiveDirectoryRealmTests.java", "diffHunk": "@@ -142,7 +143,11 @@ public void start() throws Exception {\n         }\n         threadPool = new TestThreadPool(\"active directory realm tests\");\n         resourceWatcherService = new ResourceWatcherService(Settings.EMPTY, threadPool);\n-        globalSettings = Settings.builder().put(\"path.home\", createTempDir()).build();\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTY4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619680", "createdAt": "2020-01-28T05:50:22Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/LdapRealmTests.java", "diffHunk": "@@ -98,7 +99,11 @@\n     public void init() throws Exception {\n         threadPool = new TestThreadPool(\"ldap realm tests\");\n         resourceWatcherService = new ResourceWatcherService(Settings.EMPTY, threadPool);\n-        defaultGlobalSettings = Settings.builder().put(\"path.home\", createTempDir()).build();\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTcyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619720", "createdAt": "2020-01-28T05:50:32Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/LdapSessionFactoryTests.java", "diffHunk": "@@ -59,7 +60,11 @@ public void setup() throws Exception {\n         final Path origCa = getDataPath(\"/org/elasticsearch/xpack/security/authc/ldap/support/ldap-ca.crt\");\n         ldapCaPath = createTempFile();\n         Files.copy(origCa, ldapCaPath, StandardCopyOption.REPLACE_EXISTING);\n-        globalSettings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTc1MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619750", "createdAt": "2020-01-28T05:50:41Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/LdapUserSearchSessionFactoryTests.java", "diffHunk": "@@ -62,8 +63,11 @@ public void init() throws Exception {\n          * If we re-use an SSLContext, previously connected sessions can get re-established which breaks hostname\n          * verification tests since a re-established connection does not perform hostname verification.\n          */\n-\n-        globalSettings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTc4OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619788", "createdAt": "2020-01-28T05:50:52Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/support/LdapTestCase.java", "diffHunk": "@@ -172,6 +172,9 @@ public static Settings buildLdapSettings(RealmConfig.RealmIdentifier realmId, St\n         if (serverSetType != null) {\n             builder.put(getFullSettingKey(realmId, LdapLoadBalancingSettings.LOAD_BALANCE_TYPE_SETTING), serverSetType.toString());\n         }\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTgyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619827", "createdAt": "2020-01-28T05:51:02Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ldap/support/SessionFactoryLoadBalancingTests.java", "diffHunk": "@@ -292,7 +293,11 @@ private TestSessionFactory createSessionFactory(LdapLoadBalancing loadBalancing)\n         Settings globalSettings = Settings.builder().put(\"path.home\", createTempDir()).put(settings).build();\n         RealmConfig config = new RealmConfig(REALM_IDENTIFIER, globalSettings,\n                 TestEnvironment.newEnvironment(globalSettings), new ThreadContext(Settings.EMPTY));\n-        return new TestSessionFactory(config, new SSLService(Settings.EMPTY, TestEnvironment.newEnvironment(config.settings())),\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTg1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619856", "createdAt": "2020-01-28T05:51:12Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/oidc/OpenIdConnectAuthenticatorTests.java", "diffHunk": "@@ -93,7 +94,11 @@\n \n     @Before\n     public void setup() {\n-        globalSettings = Settings.builder().put(\"path.home\", createTempDir())\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTg4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619887", "createdAt": "2020-01-28T05:51:21Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/AbstractSimpleSecurityTransportTestCase.java", "diffHunk": "@@ -81,7 +81,11 @@ protected SSLService createSSLService(Settings settings) {\n         secureSettings.setString(\"xpack.security.transport.ssl.secure_key_passphrase\", \"testnode\");\n         // Some tests use a client profile. Put the passphrase in the secure settings for the profile (secure settings cannot be set twice)\n         secureSettings.setString(\"transport.profiles.client.xpack.security.ssl.secure_key_passphrase\", \"testnode\");\n-        Settings settings1 = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTkyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Settings.Builder getSettingsBuilder(){\n          \n          \n            \n                private Settings.Builder getSettingsBuilder() {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619925", "createdAt": "2020-01-28T05:51:30Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/ServerTransportFilterIntegrationTests.java", "diffHunk": "@@ -205,4 +205,12 @@ public String executor() {\n         }\n     }\n \n+    private Settings.Builder getSettingsBuilder(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTk1MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619950", "createdAt": "2020-01-28T05:51:38Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/ServerTransportFilterIntegrationTests.java", "diffHunk": "@@ -205,4 +205,12 @@ public String executor() {\n         }\n     }\n \n+    private Settings.Builder getSettingsBuilder(){\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYxOTk3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371619971", "createdAt": "2020-01-28T05:51:45Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/filter/IPFilterTests.java", "diffHunk": "@@ -265,7 +266,11 @@ public void testThatAllAddressesAreAllowedWhenLicenseDisablesSecurity() {\n     }\n \n     public void testThatNodeStartsWithIPFilterDisabled() throws Exception {\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDAwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620004", "createdAt": "2020-01-28T05:51:53Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4HttpServerTransportTests.java", "diffHunk": "@@ -47,7 +47,11 @@ public void createSSLService() {\n \n         MockSecureSettings secureSettings = new MockSecureSettings();\n         secureSettings.setString(\"xpack.security.http.ssl.secure_key_passphrase\", \"testnode\");\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDAyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620024", "createdAt": "2020-01-28T05:52:00Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/netty4/SecurityNetty4HttpServerTransportTests.java", "diffHunk": "@@ -150,7 +154,11 @@ public void testCustomSSLConfiguration() throws Exception {\n     public void testNoExceptionWhenConfiguredWithoutSslKeySSLDisabled() throws Exception {\n         MockSecureSettings secureSettings = new MockSecureSettings();\n         secureSettings.setString(\"xpack.security.http.ssl.secure_key_passphrase\", \"testnode\");\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDA1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620053", "createdAt": "2020-01-28T05:52:09Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/nio/SecurityNioHttpServerTransportTests.java", "diffHunk": "@@ -55,7 +55,11 @@ public void createSSLService() {\n         Path testNodeCert = getDataPath(\"/org/elasticsearch/xpack/security/transport/ssl/certs/simple/testnode.crt\");\n         MockSecureSettings secureSettings = new MockSecureSettings();\n         secureSettings.setString(\"xpack.security.http.ssl.secure_key_passphrase\", \"testnode\");\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDA3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620074", "createdAt": "2020-01-28T05:52:17Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/nio/SecurityNioHttpServerTransportTests.java", "diffHunk": "@@ -183,7 +187,11 @@ public void testCustomSSLConfiguration() throws IOException {\n     public void testNoExceptionWhenConfiguredWithoutSslKeySSLDisabled() {\n         MockSecureSettings secureSettings = new MockSecureSettings();\n         secureSettings.setString(\"xpack.security.http.ssl.truststore.secure_password\", \"testnode\");\n-        Settings settings = Settings.builder()\n+        Settings.Builder builder = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDEwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620106", "createdAt": "2020-01-28T05:52:26Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/ssl/SslIntegrationTests.java", "diffHunk": "@@ -118,6 +118,9 @@ public void testThatTransportClientUsingSSLv3ProtocolIsRejected() {\n \n     public void testThatConnectionToHTTPWorks() throws Exception {\n         Settings.Builder builder = Settings.builder().put(\"xpack.security.http.ssl.enabled\", true);\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDEyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620124", "createdAt": "2020-01-28T05:52:35Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/ssl/SSLErrorMessageCertificateVerificationTests.java", "diffHunk": "@@ -184,6 +186,9 @@ private void enableHttpsHostnameChecking(SSLSocket clientSocket) {\n             .put(prefix + \".key\", getPath(keyPath))\n             .put(prefix + \".client_authentication\", clientAuth.name())\n             .put(prefix + \".verification_mode\", verificationMode.name());\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDE0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Settings.Builder getSettingsBuilder(){\n          \n          \n            \n                private Settings.Builder getSettingsBuilder() {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620149", "createdAt": "2020-01-28T05:52:46Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/ssl/SSLErrorMessageFileTests.java", "diffHunk": "@@ -378,4 +379,12 @@ private String randomSslPrefix() {\n             \"xpack.monitoring.exporters.http.ssl\"\n         );\n     }\n+\n+    private Settings.Builder getSettingsBuilder(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTYyMDE4OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/51501#discussion_r371620188", "createdAt": "2020-01-28T05:52:54Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/ssl/SSLErrorMessageFileTests.java", "diffHunk": "@@ -378,4 +379,12 @@ private String randomSslPrefix() {\n             \"xpack.monitoring.exporters.http.ssl\"\n         );\n     }\n+\n+    private Settings.Builder getSettingsBuilder(){\n+        final Settings.Builder settings = Settings.builder();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8552cc884b1638596c1cda94b8d8f311efdbb4"}, "originalPosition": 93}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd24d4fb1e95f6b4f34eacb8cd52e7937eeaa973", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/cd24d4fb1e95f6b4f34eacb8cd52e7937eeaa973", "committedDate": "2020-01-28T06:06:34Z", "message": "Fix format spacing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b48d57e25fa716b421d1cf43cf7687896658e288", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b48d57e25fa716b421d1cf43cf7687896658e288", "committedDate": "2020-01-28T06:08:46Z", "message": "Missed 3"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2753, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}