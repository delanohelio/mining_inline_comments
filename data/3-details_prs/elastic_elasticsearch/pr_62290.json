{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NDE2Njg5", "number": 62290, "title": "Round up parsers should be based on a list of parsers", "bodyText": "a dateformatter can be created with a list of parsers which are iterated\nduring parsing and the first one that passes will return a parsed date.\nDateMathParser should do the same, when created based on a list of\nnon-rounding parsers it should also iterate over all of them - it is at\nthe moment only taking first element\nclosing #62207\n\n\nHave you signed the contributor license agreement?\nHave you followed the contributor guidelines?\nIf submitting code, have you built your formula locally prior to submission with gradle check?\nIf submitting code, is your pull request against master? Unless there is a good reason otherwise, we prefer pull requests against master and will backport as needed.\nIf submitting code, have you checked that your submission is for an OS and architecture that we support?\nIf you are submitting this code for a class then read our policy for that.", "createdAt": "2020-09-14T07:46:16Z", "url": "https://github.com/elastic/elasticsearch/pull/62290", "merged": true, "mergeCommit": {"oid": "2b90a3cb07f5fccd97b9afd460e1fece3265015b"}, "closed": true, "closedAt": "2020-09-18T08:42:40Z", "author": {"login": "pgomulka"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIuQcAgH2gAyNDg2NDE2Njg5OjRiYjY5NDE2MjRkNzk3NWY4NThkZjQxMWE2ZDI1MTZhZTkzYmZlNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKAdfCgH2gAyNDg2NDE2Njg5OmRjMTM0ZWM4NmNhYTk3NGQ1ZDE1MjQ3YzNiMDU2Y2RkY2VjY2QwNmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4bb6941624d7975f858df411a6d2516ae93bfe74", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/4bb6941624d7975f858df411a6d2516ae93bfe74", "committedDate": "2020-09-14T07:42:13Z", "message": "Round up parsers should be based on a list of parsers\n\na dateformatter can be created with a list of parsers which are iterated\nduring parsing and the first one that passes will return a parsed date.\nDateMathParser should do the same, when created based on a list of\nnon-rounding parsers it should also iterate over all of them - it is at\nthe moment only taking first element\n\nclosing https://github.com/elastic/elasticsearch/issues/62207"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "409c960a27407957295d45cf1f52d41c53172f09", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/409c960a27407957295d45cf1f52d41c53172f09", "committedDate": "2020-09-15T06:53:14Z", "message": "Merge branch 'master' into java_time/round_up_parsers_list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93bfd72f471b32f7bc415206eb3c972a21d357ee", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/93bfd72f471b32f7bc415206eb3c972a21d357ee", "committedDate": "2020-09-16T08:37:33Z", "message": "Merge branch 'master' into java_time/round_up_parsers_list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20ba8f3e040efcff9d8091b3a3055c490a219371", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/20ba8f3e040efcff9d8091b3a3055c490a219371", "committedDate": "2020-09-16T15:54:43Z", "message": "revert scope and fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDI2ODI5", "url": "https://github.com/elastic/elasticsearch/pull/62290#pullrequestreview-490026829", "createdAt": "2020-09-16T21:16:19Z", "commit": {"oid": "20ba8f3e040efcff9d8091b3a3055c490a219371"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMToxNjoxOVrOHTEhgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMToxNjoxOVrOHTEhgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc1OTEwNQ==", "bodyText": "How does this differ from the note above mentioning merges with || appending to the list of roundup formatters?", "url": "https://github.com/elastic/elasticsearch/pull/62290#discussion_r489759105", "createdAt": "2020-09-16T21:16:19Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/common/time/JavaDateFormatter.java", "diffHunk": "@@ -113,10 +113,14 @@ JavaDateFormatter getRoundupParser() {\n     private List<DateTimeFormatter> createRoundUpParser(String format,\n                                                         Consumer<DateTimeFormatterBuilder> roundupParserConsumer) {\n         if (format.contains(\"||\") == false) {\n-            DateTimeFormatterBuilder builder = new DateTimeFormatterBuilder();\n-            builder.append(this.parsers.get(0));\n-            roundupParserConsumer.accept(builder);\n-            return Arrays.asList(builder.toFormatter(locale()));\n+            List<DateTimeFormatter> roundUpParsers = new ArrayList<>();\n+            for (DateTimeFormatter parser : this.parsers) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20ba8f3e040efcff9d8091b3a3055c490a219371"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a30b8414c7f6fd0e1f8ddbf2c1c3ba26a22d7084", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/a30b8414c7f6fd0e1f8ddbf2c1c3ba26a22d7084", "committedDate": "2020-09-17T08:04:40Z", "message": "length line"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a40040b45452fe2732f9c92f576d454566dc47cc", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/a40040b45452fe2732f9c92f576d454566dc47cc", "committedDate": "2020-09-17T09:24:06Z", "message": "add a testcase for combining parsers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2220cd6ef3f458da9198bb8e437067c8834e5347", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/2220cd6ef3f458da9198bb8e437067c8834e5347", "committedDate": "2020-09-17T14:39:47Z", "message": "Merge branch 'master' into java_time/round_up_parsers_list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzczMjE1", "url": "https://github.com/elastic/elasticsearch/pull/62290#pullrequestreview-490773215", "createdAt": "2020-09-17T16:17:04Z", "commit": {"oid": "2220cd6ef3f458da9198bb8e437067c8834e5347"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc134ec86caa974d5d15247c3b056cddceccd06f", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/dc134ec86caa974d5d15247c3b056cddceccd06f", "committedDate": "2020-09-18T07:28:41Z", "message": "javadoc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4566, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}