{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NDI5NjA3", "number": 55314, "title": "Retry follow task when remote connection queue full", "bodyText": "If more than 100 shard-follow tasks are trying to connect to the remote cluster, then some of them will abort with \"connect listener queue is full\". This is because we retry on ESRejectedExecutionException, but not on RejectedExecutionException.", "createdAt": "2020-04-16T14:48:05Z", "url": "https://github.com/elastic/elasticsearch/pull/55314", "merged": true, "mergeCommit": {"oid": "5216bd273a70dd8d801d4c925b85c60d5ceadf7a"}, "closed": true, "closedAt": "2020-04-17T04:10:57Z", "author": {"login": "dnhatn"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYNw2JgH2gAyNDA0NDI5NjA3OjhkZWY5MjI1YjMzMTA2ZDIzOWYxMWQ0NDg4ZjdjNDA1ZTkyOWFiYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYTgkVAFqTM5NTAwOTcxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8def9225b33106d239f11d4488f7c405e929aba9", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/8def9225b33106d239f11d4488f7c405e929aba9", "committedDate": "2020-04-16T14:42:23Z", "message": "Retry follow task when remote connection queue full"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e911a4aff093dcd95eaa45c62ec615f7f532f66", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/8e911a4aff093dcd95eaa45c62ec615f7f532f66", "committedDate": "2020-04-16T16:06:47Z", "message": "Merge branch 'master' into remote-connect-queue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0ODI3NDI4", "url": "https://github.com/elastic/elasticsearch/pull/55314#pullrequestreview-394827428", "createdAt": "2020-04-16T16:59:31Z", "commit": {"oid": "8e911a4aff093dcd95eaa45c62ec615f7f532f66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNjo1OTozMVrOGGutiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNjo1OTozMVrOGGutiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwOTk2MQ==", "bodyText": "I don't think there was a lot of thought to the connection listener limit. If there is a strong reason to increase it past 100 we could probably do that. Also does does this name make sense? We only allow a single connection round at a time. Should the name be cluster.remote.max_pending_connection_listeners?", "url": "https://github.com/elastic/elasticsearch/pull/55314#discussion_r409709961", "createdAt": "2020-04-16T16:59:31Z", "author": {"login": "tbrooks8"}, "path": "server/src/main/java/org/elasticsearch/transport/RemoteConnectionStrategy.java", "diffHunk": "@@ -105,10 +105,14 @@ public int getNumberOfChannels() {\n             Setting.Property.NodeScope,\n             Setting.Property.Dynamic));\n \n+    // this setting is intentionally not registered, it is only used in tests\n+    public static final Setting<Integer> REMOTE_MAX_CONNECTION_QUEUE_SIZE =\n+        Setting.intSetting(\"cluster.remote.max_connection_queue_size\", 100, Setting.Property.NodeScope);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e911a4aff093dcd95eaa45c62ec615f7f532f66"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9c807f7a1b1acd387b8f3901941a8bc5ad5842e", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/f9c807f7a1b1acd387b8f3901941a8bc5ad5842e", "committedDate": "2020-04-16T17:23:59Z", "message": "rename to max_pending_connection_listeners"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c3e803e3f9f3ec33a47965b85e3d2c3b4ead31d", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/6c3e803e3f9f3ec33a47965b85e3d2c3b4ead31d", "committedDate": "2020-04-16T17:24:31Z", "message": "increase to 1k"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MDA5NzEz", "url": "https://github.com/elastic/elasticsearch/pull/55314#pullrequestreview-395009713", "createdAt": "2020-04-16T21:24:02Z", "commit": {"oid": "6c3e803e3f9f3ec33a47965b85e3d2c3b4ead31d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3225, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}