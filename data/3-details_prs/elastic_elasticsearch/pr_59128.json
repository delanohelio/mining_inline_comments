{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1Mjk4MTg2", "number": 59128, "title": "GET data stream API returns additional information", "bodyText": "This adds the data stream's index template, the configured ILM policy\n(if any) and the health status of the data stream to the GET _data_stream\nresponse.\nRelates to #58316\nRelates to #53100\nThe proposed response looks like this:\n{\n  \"data_streams\" : [\n    {\n      \"name\" : \"timeseries\",\n      \"timestamp_field\" : {\n        \"name\" : \"@timestamp\",\n        \"mapping\" : {\n          \"type\" : \"date\"\n        }\n      },\n      \"indices\" : [\n        {\n          \"index_name\" : \".ds-timeseries-000001\",\n          \"index_uuid\" : \"m3Id6-T7TuOBuC3qoltdqQ\"\n        }\n      ],\n      \"generation\" : 1,\n      \"status\" : \"YELLOW\",\n      \"template\" : \"timeseries_template\",\n      \"ilm_policy\" : \"timeseries_policy\"\n    },\n    {\n      \"name\" : \"timeseries_3\",\n      \"timestamp_field\" : {\n        \"name\" : \"@timestamp\",\n        \"mapping\" : {\n          \"type\" : \"date\"\n        }\n      },\n      \"indices\" : [\n        {\n          \"index_name\" : \".ds-timeseries_3-000001\",\n          \"index_uuid\" : \"YJKrb9_yR2iukhi0vCy1zQ\"\n        }\n      ],\n      \"generation\" : 1,\n      \"status\" : \"GREEN\",\n      \"template\" : \"timeseries_template\",\n      \"ilm_policy\" : \"timeseries_policy\"\n    }\n  ]\n}", "createdAt": "2020-07-07T09:51:42Z", "url": "https://github.com/elastic/elasticsearch/pull/59128", "merged": true, "mergeCommit": {"oid": "0d9c98a82353b088c782b6a04c44844e66137054"}, "closed": true, "closedAt": "2020-07-07T16:52:41Z", "author": {"login": "andreidan"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyg3RpAH2gAyNDQ1Mjk4MTg2OmU5MmFkZmZmYmZiZjUxZWY5OGQ0NTgyNTc3NzA4ZDZhM2I2NGExZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyppIoAFqTQ0NDEyMjA4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e92adfffbfbf51ef98d4582577708d6a3b64a1f3", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/e92adfffbfbf51ef98d4582577708d6a3b64a1f3", "committedDate": "2020-07-07T07:39:38Z", "message": "GET data stream API returns additional information\n\nThis adds the data stream's index template, the configured ILM policy\n(if any) and the health status of the data stream to the GET _data_stream\nresponse."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a4a356d9d028e32a066b291690ee2df55d1c10a", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a4a356d9d028e32a066b291690ee2df55d1c10a", "committedDate": "2020-07-07T10:11:22Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c553b3ae1ee15810bd5f8589074c2fae752e22d", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/6c553b3ae1ee15810bd5f8589074c2fae752e22d", "committedDate": "2020-07-07T10:22:15Z", "message": "Fix yaml tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57a8298281d65d509609224983f296cc1494ab47", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/57a8298281d65d509609224983f296cc1494ab47", "committedDate": "2020-07-07T10:32:50Z", "message": "Merge branch 'master' into get_data_stream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dabe6e1a1eec53dce61a7549c42944c78bb6fd9", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/7dabe6e1a1eec53dce61a7549c42944c78bb6fd9", "committedDate": "2020-07-07T10:57:09Z", "message": "Fix yaml test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODMyMzc3", "url": "https://github.com/elastic/elasticsearch/pull/59128#pullrequestreview-443832377", "createdAt": "2020-07-07T12:16:41Z", "commit": {"oid": "7dabe6e1a1eec53dce61a7549c42944c78bb6fd9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxNjo0MVrOGt72uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxNjo0MVrOGt72uQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxOTc2OQ==", "bodyText": "I think that at least one of these REST tests should be updated with the full list of fields that are returned from the get data stream API.", "url": "https://github.com/elastic/elasticsearch/pull/59128#discussion_r450819769", "createdAt": "2020-07-07T12:16:41Z", "author": {"login": "danhermann"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/test/indices.data_stream/10_basic.yml", "diffHunk": "@@ -49,16 +49,16 @@ setup:\n   - do:\n       indices.get_data_stream:\n         name: \"*\"\n-  - match: { 0.name: simple-data-stream1 }\n-  - match: { 0.timestamp_field.name: '@timestamp' }\n-  - match: { 0.generation: 1 }\n-  - length: { 0.indices: 1 }\n-  - match: { 0.indices.0.index_name: '.ds-simple-data-stream1-000001' }\n-  - match: { 1.name: simple-data-stream2 }\n-  - match: { 1.timestamp_field.name: '@timestamp2' }\n-  - match: { 0.generation: 1 }\n-  - length: { 1.indices: 1 }\n-  - match: { 1.indices.0.index_name: '.ds-simple-data-stream2-000001' }\n+  - match: { data_streams.0.name: simple-data-stream1 }\n+  - match: { data_streams.0.timestamp_field.name: '@timestamp' }\n+  - match: { data_streams.0.generation: 1 }\n+  - length: { data_streams.0.indices: 1 }\n+  - match: { data_streams.0.indices.0.index_name: '.ds-simple-data-stream1-000001' }\n+  - match: { data_streams.1.name: simple-data-stream2 }\n+  - match: { data_streams.1.timestamp_field.name: '@timestamp2' }\n+  - match: { data_streams.0.generation: 1 }\n+  - length: { data_streams.1.indices: 1 }\n+  - match: { data_streams.1.indices.0.index_name: '.ds-simple-data-stream2-000001' }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dabe6e1a1eec53dce61a7549c42944c78bb6fd9"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a2d43db1edec946ee3028a5cd3e8e157e905a74", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/1a2d43db1edec946ee3028a5cd3e8e157e905a74", "committedDate": "2020-07-07T12:45:20Z", "message": "Adjust HLRC to new API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8340a545a1ec7d2cd84aff6808a29837bb5689a8", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/8340a545a1ec7d2cd84aff6808a29837bb5689a8", "committedDate": "2020-07-07T13:17:42Z", "message": "Parse ilm_policy as optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fb57b1f1c76b4ca8654dc9033ec2fac217c605a", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/3fb57b1f1c76b4ca8654dc9033ec2fac217c605a", "committedDate": "2020-07-07T13:29:07Z", "message": "Yaml test: match corresponding DS status and template"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzOTIzMzM0", "url": "https://github.com/elastic/elasticsearch/pull/59128#pullrequestreview-443923334", "createdAt": "2020-07-07T14:04:09Z", "commit": {"oid": "3fb57b1f1c76b4ca8654dc9033ec2fac217c605a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af0feb6e653cd3c49fa9587f78280f5e7dee91b4", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/af0feb6e653cd3c49fa9587f78280f5e7dee91b4", "committedDate": "2020-07-07T14:15:07Z", "message": "Fix stack yaml tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e66c0eb567658bcf89ea96b109b02b2621a3272", "author": {"user": {"login": "andreidan", "name": "Andrei Dan"}}, "url": "https://github.com/elastic/elasticsearch/commit/4e66c0eb567658bcf89ea96b109b02b2621a3272", "committedDate": "2020-07-07T15:17:01Z", "message": "Make the index template optional for the GET _data_stream response\n\nRestoring a data stream from a snapshot could install a data stream that\ndoesn't match any composable templates. This makes the index template field\nin the `GET _data_stream` response optional."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MTIyMDgx", "url": "https://github.com/elastic/elasticsearch/pull/59128#pullrequestreview-444122081", "createdAt": "2020-07-07T17:53:19Z", "commit": {"oid": "4e66c0eb567658bcf89ea96b109b02b2621a3272"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNzo1MzoyMFrOGuJdKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNzo1MzoyMFrOGuJdKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0MjYwMg==", "bodyText": "why was this top level data_streams field introduced? I don't think that this is needed?", "url": "https://github.com/elastic/elasticsearch/pull/59128#discussion_r451042602", "createdAt": "2020-07-07T17:53:20Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/datastream/GetDataStreamAction.java", "diffHunk": "@@ -119,11 +214,13 @@ public void writeTo(StreamOutput out) throws IOException {\n \n         @Override\n         public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {\n-            builder.startArray();\n-            for (DataStream dataStream : dataStreams) {\n+            builder.startObject();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e66c0eb567658bcf89ea96b109b02b2621a3272"}, "originalPosition": 150}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2176, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}