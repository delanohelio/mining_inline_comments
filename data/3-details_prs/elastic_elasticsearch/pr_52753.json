{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NTE0MjM1", "number": 52753, "title": "Emphasize keyword over fielddata as the preferred way to use String\u2026", "bodyText": "\u2026 fields for aggregations or sorting\n\n\nHave you signed the contributor license agreement?\nHave you followed the contributor guidelines?\nIf submitting code, have you built your formula locally prior to submission with gradle check?\nIf submitting code, is your pull request against master? Unless there is a good reason otherwise, we prefer pull requests against master and will backport as needed.\nIf submitting code, have you checked that your submission is for an OS and architecture that we support?\nIf you are submitting this code for a class then read our policy for that.", "createdAt": "2020-02-25T11:06:47Z", "url": "https://github.com/elastic/elasticsearch/pull/52753", "merged": true, "mergeCommit": {"oid": "7684ae882c8aa9f8eb693c728ec43876f2a2a36f"}, "closed": true, "closedAt": "2020-02-25T23:28:51Z", "author": {"login": "sachin-frayne"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHwEXlAH2gAyMzc5NTE0MjM1OjBlYzc2NjRlNTU1N2YzNzlmNmQyMDVmMzVkN2U1ODMxYWZiZjNkNGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcH6u1UAFqTM2NDUyNTU2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0ec7664e5557f379f6d205f35d7e5831afbf3d4c", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/0ec7664e5557f379f6d205f35d7e5831afbf3d4c", "committedDate": "2020-02-25T11:03:46Z", "message": "Emphasize keyword over fielddata as the preferred way to use String fields for aggregations or sorting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MzQ0NTU1", "url": "https://github.com/elastic/elasticsearch/pull/52753#pullrequestreview-364344555", "createdAt": "2020-02-25T18:25:26Z", "commit": {"oid": "0ec7664e5557f379f6d205f35d7e5831afbf3d4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODoyNToyNlrOFuQGpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxODoyNToyNlrOFuQGpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA0MjY2MA==", "bodyText": "This looks good, I had some minor suggestions to try to keep the error message as precise/ short as possible:\n\nText fields are not optimised for operations that require per-document field data like aggregations and sorting, so these operations are disabled by default. Please use a keyword field instead. Alternatively, set fielddata=true on [field] in order to load field data by uninverting the inverted index. Note that this can use significant memory.", "url": "https://github.com/elastic/elasticsearch/pull/52753#discussion_r384042660", "createdAt": "2020-02-25T18:25:26Z", "author": {"login": "jtibshirani"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/TextFieldMapper.java", "diffHunk": "@@ -749,9 +749,10 @@ public static boolean hasGaps(TokenStream stream) throws IOException {\n         @Override\n         public IndexFieldData.Builder fielddataBuilder(String fullyQualifiedIndexName) {\n             if (fielddata == false) {\n-                throw new IllegalArgumentException(\"Fielddata is disabled on text fields by default. Set fielddata=true on [\" + name()\n-                        + \"] in order to load fielddata in memory by uninverting the inverted index. Note that this can however \"\n-                                + \"use significant memory. Alternatively use a keyword field instead.\");\n+                throw new IllegalArgumentException(\"Text fields are not optimised for aggregations and/or sorting and therefore these \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ec7664e5557f379f6d205f35d7e5831afbf3d4c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebe5b63294317616ffc411515095f9a06a2e6efb", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/ebe5b63294317616ffc411515095f9a06a2e6efb", "committedDate": "2020-02-25T18:44:22Z", "message": "minor changes to try to keep the error message as precise/short as possible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a163c9d164817ce604743ee56d330ad5964c8a8", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/5a163c9d164817ce604743ee56d330ad5964c8a8", "committedDate": "2020-02-25T19:15:33Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cf4728cc5653059f29de1f3e057ae9b4b0f09cf", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/5cf4728cc5653059f29de1f3e057ae9b4b0f09cf", "committedDate": "2020-02-25T19:32:04Z", "message": "typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbb88331e1d79bdde398b98ecf9c0ab9fcf49f54", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/cbb88331e1d79bdde398b98ecf9c0ab9fcf49f54", "committedDate": "2020-02-25T22:16:59Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0696e1b268076cfe1c04384614af76777795e56a", "author": {"user": {"login": "sachin-frayne", "name": "Sachin Frayne"}}, "url": "https://github.com/elastic/elasticsearch/commit/0696e1b268076cfe1c04384614af76777795e56a", "committedDate": "2020-02-25T22:27:54Z", "message": "change the expected error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTI1NTY0", "url": "https://github.com/elastic/elasticsearch/pull/52753#pullrequestreview-364525564", "createdAt": "2020-02-25T23:29:12Z", "commit": {"oid": "0696e1b268076cfe1c04384614af76777795e56a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2143, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}