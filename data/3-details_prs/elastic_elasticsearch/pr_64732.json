{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2ODYyODE1", "number": 64732, "title": "Remove deprecated _upgrade API", "bodyText": "The _upgrade API has been superseded by the _reindex API and was deprecated in 7.11.0. This commit removes it completely for the 8.0.0 release.\nResolves #21337", "createdAt": "2020-11-06T16:47:40Z", "url": "https://github.com/elastic/elasticsearch/pull/64732", "merged": true, "mergeCommit": {"oid": "c829f8edd1cacd3a9e633e6e5d08b418655362e7"}, "closed": true, "closedAt": "2020-11-12T17:09:57Z", "author": {"login": "danhermann"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZ5vB7AH2gAyNTE2ODYyODE1OjkxYjQ4MGNmYjY3OTg5ZDE1YTMwZWI2YWNmMjE2NTk2NWRlMGNmZjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdb1iCMAFqTUyOTI5MDM4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/91b480cfb67989d15a30eb6acf2165965de0cff0", "committedDate": "2020-11-06T16:41:18Z", "message": "remote deprecated _upgrade API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzI0ODA4", "url": "https://github.com/elastic/elasticsearch/pull/64732#pullrequestreview-525324808", "createdAt": "2020-11-06T16:49:40Z", "commit": {"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNjo0OTo0MFrOHu1q5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNjo1MDo1NVrOHu1t4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NTg3OQ==", "bodyText": "Replaced with a different index action so tasks are still tested", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518875879", "createdAt": "2020-11-06T16:49:40Z", "author": {"login": "danhermann"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/action/admin/cluster/node/tasks/TasksIT.java", "diffHunk": "@@ -181,19 +181,19 @@ public void testTransportReplicationAllShardsTasks() {\n     }\n \n     public void testTransportBroadcastByNodeTasks() {\n-        registerTaskManagerListeners(UpgradeAction.NAME);  // main task\n-        registerTaskManagerListeners(UpgradeAction.NAME + \"[n]\"); // node level tasks\n+        registerTaskManagerListeners(ForceMergeAction.NAME);  // main task\n+        registerTaskManagerListeners(ForceMergeAction.NAME + \"[n]\"); // node level tasks", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NjQ0OA==", "bodyText": "Did not appear to be called outside of the _upgrade API.", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518876448", "createdAt": "2020-11-06T16:50:34Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataUpdateSettingsService.java", "diffHunk": "@@ -316,36 +312,4 @@ private static boolean maybeUpdateClusterBlock(String[] actualIndices, ClusterBl\n         }\n         return changed;\n     }\n-\n-\n-    public void upgradeIndexSettings(final UpgradeSettingsClusterStateUpdateRequest request,\n-                                     final ActionListener<AcknowledgedResponse> listener) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NjY0MA==", "bodyText": "Did not appear to be called outside of the _upgrade API.", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518876640", "createdAt": "2020-11-06T16:50:55Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/index/shard/IndexShard.java", "diffHunk": "@@ -1099,28 +1098,6 @@ public void forceMerge(ForceMergeRequest forceMerge) throws IOException {\n             forceMerge.onlyExpungeDeletes(), false, false, forceMerge.forceMergeUUID());\n     }\n \n-    /**\n-     * Upgrades the shard to the current version of Lucene and returns the minimum segment version\n-     */\n-    public org.apache.lucene.util.Version upgrade(UpgradeRequest upgrade) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95196e5360bd8451d9cde5c72f78579ed7bc92dc", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/95196e5360bd8451d9cde5c72f78579ed7bc92dc", "committedDate": "2020-11-06T17:14:19Z", "message": "add to breaking changes doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb3ce4bb2ff44ace8567ed248d1e72679aa337ad", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/cb3ce4bb2ff44ace8567ed248d1e72679aa337ad", "committedDate": "2020-11-06T17:15:35Z", "message": "remove references from REST client tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e658bcdf183f7787d200c74b798c7bc5d248b757", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/e658bcdf183f7787d200c74b798c7bc5d248b757", "committedDate": "2020-11-06T17:55:39Z", "message": "remove ref from index privilege tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MjkwMzg3", "url": "https://github.com/elastic/elasticsearch/pull/64732#pullrequestreview-529290387", "createdAt": "2020-11-12T16:55:20Z", "commit": {"oid": "e658bcdf183f7787d200c74b798c7bc5d248b757"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1241, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}