{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNTUzMDU1", "number": 53747, "title": "Improve IntelliJ IDE integration", "bodyText": "This commit makes a number of improvements when importing the\nElasticsearch project into IntelliJ IDEA. Specifically:\n\nContributing documentation has been updated to reflect that the\n'idea' task should no long be used and Gradle project import is\ninstead the officially supported way of setting up the project.\nAttempts to run the 'idea' task will result in a failure with a\nmessage directing folks to our CONTRIBUTING.md document.\nThe project JDK is explicit set rather that using whatever JAVA_HOME is.\nGradle build operation delegation is disabled, and test execution is\nconfigured to 'choose per test'.\nGradle is configured to inherit the project JDK.\nSome code style conventions are automatically configured.\nFile encoding is explicitly set to UTF-8.\nParallel module compilation is enabled and deprecated feature\nwarnings are disabled.\nA remote debug run configuration using listen mode is created.\nJUnit runner is configured with required system properties.\nLicense headers are configured such that Apache 2 is the default\nnotice added to all source files with exception of source in /x-pack\nwhich will use the Elastic license.\n\nCloses #46118", "createdAt": "2020-03-18T16:54:54Z", "url": "https://github.com/elastic/elasticsearch/pull/53747", "merged": true, "mergeCommit": {"oid": "2e617c3b1026bb3fc4063feeb314c1925e83300d"}, "closed": true, "closedAt": "2020-03-19T18:23:16Z", "author": {"login": "mark-vieira"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcO6RC4AH2gAyMzkwNTUzMDU1OmU0NTA5ODgzYmNmN2EzYzkyNjEzMThlNzc4ZjMwZGIyNWE4YjJjMzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPORcMAH2gAyMzkwNTUzMDU1OjdlYWNlZTVmNDhmZjVkZmM5ZDJiODVjYmQ3MjRjZmZkMzQzMzBlZDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e4509883bcf7a3c9261318e778f30db25a8b2c31", "author": {"user": {"login": "mark-vieira", "name": "Mark Vieira"}}, "url": "https://github.com/elastic/elasticsearch/commit/e4509883bcf7a3c9261318e778f30db25a8b2c31", "committedDate": "2020-03-18T16:54:08Z", "message": "Improve IntelliJ IDE integration\n\nThis commit makes a number of improvements when importing the\nElasticsearch project into IntelliJ IDEA. Specifically:\n\n - Contributing documentation has been updated to reflect that the\n   'idea' task should no long be used and Gradle project import is\n   instead the officially supported way of setting up the project.\n - Attempts to run the 'idea' task will result in a failure with a\n   message directing folks to our CONTRIBUTING.md document.\n - The project JDK is explicit set rather that using whatever JAVA_HOME\n   is.\n - Gradle build operation delegation is disabled, and test execution is\n   configured to 'choose per test'.\n - Gradle is configured to inherit the project JDK.\n - Some code style conventions are automatically configured.\n - File encoding is explicitly set to UTF-8.\n - Parallel module compilation is enabled and deprecated feature\n   warnings are disabled.\n - A remote debug run configuration using listen mode is created.\n - JUnit runner is configured with required system properties.\n - License headers are configured such that Apache 2 is the default\n   notice added to all source files with exception of source in /x-pack\n   which will use the Elastic license."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MDYyNTE0", "url": "https://github.com/elastic/elasticsearch/pull/53747#pullrequestreview-377062514", "createdAt": "2020-03-18T17:01:29Z", "commit": {"oid": "e4509883bcf7a3c9261318e778f30db25a8b2c31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzowMToyOVrOF4Og6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzowMToyOVrOF4Og6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUwMjM3OQ==", "bodyText": "Why create these files programatically, but not the two that are committed/shared (excluded in gitignore)?", "url": "https://github.com/elastic/elasticsearch/pull/53747#discussion_r394502379", "createdAt": "2020-03-18T17:01:29Z", "author": {"login": "rjernst"}, "path": "gradle/ide.gradle", "diffHunk": "@@ -0,0 +1,141 @@\n+import org.jetbrains.gradle.ext.Remote\n+import org.jetbrains.gradle.ext.JUnit\n+\n+buildscript {\n+  repositories {\n+    maven {\n+      url \"https://plugins.gradle.org/m2/\"\n+    }\n+  }\n+  dependencies {\n+    classpath \"gradle.plugin.org.jetbrains.gradle.plugin.idea-ext:gradle-idea-ext:0.7\"\n+  }\n+}\n+\n+apply plugin: org.jetbrains.gradle.ext.IdeaExtPlugin\n+\n+allprojects {\n+  apply plugin: 'idea'\n+\n+  tasks.named('idea') {\n+    doFirst { throw new GradleException(\"Use of the 'idea' task has been deprecated. For details on importing into IntelliJ see CONTRIBUTING.md.\") }\n+  }\n+}\n+\n+tasks.register('configureIdeaGradleJvm') {\n+  group = 'ide'\n+  description = 'Configures the appropriate JVM for Gradle'\n+\n+  doLast {\n+    modifyXml('.idea/gradle.xml') { xml ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4509883bcf7a3c9261318e778f30db25a8b2c31"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2234375cbf459829befcdfb51e8ccf3a59907ac", "author": {"user": {"login": "mark-vieira", "name": "Mark Vieira"}}, "url": "https://github.com/elastic/elasticsearch/commit/c2234375cbf459829befcdfb51e8ccf3a59907ac", "committedDate": "2020-03-18T17:04:04Z", "message": "Add some more details on project SDK setup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTcwMDM3", "url": "https://github.com/elastic/elasticsearch/pull/53747#pullrequestreview-377170037", "createdAt": "2020-03-18T19:26:05Z", "commit": {"oid": "c2234375cbf459829befcdfb51e8ccf3a59907ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MzM2NjQz", "url": "https://github.com/elastic/elasticsearch/pull/53747#pullrequestreview-377336643", "createdAt": "2020-03-19T00:29:17Z", "commit": {"oid": "c2234375cbf459829befcdfb51e8ccf3a59907ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NTUzNDky", "url": "https://github.com/elastic/elasticsearch/pull/53747#pullrequestreview-377553492", "createdAt": "2020-03-19T09:34:16Z", "commit": {"oid": "c2234375cbf459829befcdfb51e8ccf3a59907ac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOTozNDoxNlrOF4mexA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOTozNDoxNlrOF4mexA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg5NTA0NA==", "bodyText": "Is this number sufficiently absurdly high?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      classCountToUseImportOnDemand = 99\n          \n          \n            \n                      classCountToUseImportOnDemand = 9999", "url": "https://github.com/elastic/elasticsearch/pull/53747#discussion_r394895044", "createdAt": "2020-03-19T09:34:16Z", "author": {"login": "pugnascotia"}, "path": "gradle/ide.gradle", "diffHunk": "@@ -0,0 +1,141 @@\n+import org.jetbrains.gradle.ext.Remote\n+import org.jetbrains.gradle.ext.JUnit\n+\n+buildscript {\n+  repositories {\n+    maven {\n+      url \"https://plugins.gradle.org/m2/\"\n+    }\n+  }\n+  dependencies {\n+    classpath \"gradle.plugin.org.jetbrains.gradle.plugin.idea-ext:gradle-idea-ext:0.7\"\n+  }\n+}\n+\n+apply plugin: org.jetbrains.gradle.ext.IdeaExtPlugin\n+\n+allprojects {\n+  apply plugin: 'idea'\n+\n+  tasks.named('idea') {\n+    doFirst { throw new GradleException(\"Use of the 'idea' task has been deprecated. For details on importing into IntelliJ see CONTRIBUTING.md.\") }\n+  }\n+}\n+\n+tasks.register('configureIdeaGradleJvm') {\n+  group = 'ide'\n+  description = 'Configures the appropriate JVM for Gradle'\n+\n+  doLast {\n+    modifyXml('.idea/gradle.xml') { xml ->\n+      def gradleSettings = xml.component.find { it.'@name' == 'GradleSettings' }.option[0].GradleProjectSettings\n+      // Remove configured JVM option to force IntelliJ to use the project JDK for Gradle\n+      gradleSettings.option.findAll { it.'@name' == 'gradleJvm' }.each { it.parent().remove(it) }\n+    }\n+  }\n+}\n+\n+tasks.register('configureIdeaRunConfigs') {\n+  group = 'ide'\n+  description = 'Configures default run configuration settings'\n+\n+  doLast {\n+    modifyXml('.idea/workspace.xml') { xml ->\n+      def runManager = xml.component.find { it.'@name' == 'RunManager' }\n+      if (runManager == null) {\n+        throw new GradleException(\"IntelliJ 'RunManager' configuration is missing from workspace.xml. You may need to refresh your Gradle project.\")\n+      }\n+\n+      def debugConfig = runManager.configuration.find { it.'@name' == 'Debug Elasticsearch' }\n+      // Enable \"auto restart\" on remote debug run configuration\n+      if (debugConfig.option.any { it.'@name' == 'AUTO_RESTART' && it.'@value' == 'true'} == false) {\n+        def restart = new NodeBuilder().option(name: 'AUTO_RESTART', value: 'true')\n+        debugConfig.append(restart)\n+      }\n+    }\n+  }\n+}\n+\n+idea {\n+  project {\n+    vcs = 'Git'\n+    jdkName = '13'\n+\n+    settings {\n+      delegateActions {\n+        delegateBuildRunToGradle = false\n+        testRunner = 'choose_per_test'\n+      }\n+      taskTriggers {\n+        afterSync tasks.named('configureIdeaGradleJvm'), tasks.named('configureIdeaRunConfigs')\n+      }\n+      codeStyle {\n+        java {\n+          classCountToUseImportOnDemand = 99", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2234375cbf459829befcdfb51e8ccf3a59907ac"}, "originalPosition": 74}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ba753fe4e8e96725e4088d0f662be77647057d7", "author": {"user": {"login": "mark-vieira", "name": "Mark Vieira"}}, "url": "https://github.com/elastic/elasticsearch/commit/6ba753fe4e8e96725e4088d0f662be77647057d7", "committedDate": "2020-03-19T15:25:20Z", "message": "Address review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7eacee5f48ff5dfc9d2b85cbd724cffd34330ed2", "author": {"user": {"login": "mark-vieira", "name": "Mark Vieira"}}, "url": "https://github.com/elastic/elasticsearch/commit/7eacee5f48ff5dfc9d2b85cbd724cffd34330ed2", "committedDate": "2020-03-19T16:12:40Z", "message": "Update scope definition to match any workspace directory name"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2018, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}