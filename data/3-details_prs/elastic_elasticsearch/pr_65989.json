{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0MDI0MDU5", "number": 65989, "title": "Correctly determine defaults of settings which depend on other settings", "bodyText": "This commit adjusts the behavior when calculating the diff between two\nAbstractScopedSettings objects, so that the default values of settings\nwhose default values depend on the values of other settings are\ncorrectly calculated. Previously, when calculating the diff, the default\nvalue of a depended setting would be calculated based on the default\nvalue of the setting(s) it depends on, rather than the current value of\nthose settings.\nFixes #47890", "createdAt": "2020-12-07T23:56:27Z", "url": "https://github.com/elastic/elasticsearch/pull/65989", "merged": true, "mergeCommit": {"oid": "d566f8718bdcc416a7bc90cdb3d2b359c9f3cfa4"}, "closed": true, "closedAt": "2020-12-08T19:08:11Z", "author": {"login": "gwbrown"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdj-WvKAH2gAyNTM0MDI0MDU5OmJlYWZjNTY2YTg1NTcxYmE2ZDFlYTE5OWQ3Y2JjNWY4ODNkZjA5Yzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkN_ZJgH2gAyNTM0MDI0MDU5OmEwM2FhNTNhYzk5ZDg3MzI2ZTlhMTA4ODVhZTk1YjYxMjhiYTAyMGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "beafc566a85571ba6d1ea199d7cbc5f883df09c8", "author": {"user": {"login": "gwbrown", "name": "Gordon Brown"}}, "url": "https://github.com/elastic/elasticsearch/commit/beafc566a85571ba6d1ea199d7cbc5f883df09c8", "committedDate": "2020-12-07T23:43:32Z", "message": "Correctly determine defaults of settings which depend on other settings\n\nThis commit adjusts the behavior when calculating the diff between two\n`AbstractScopedSettings` objects, so that the default values of settings\nwhose default values depend on the values of other settings are\ncorrectly calculated. Previously, when calculating the diff, the default\nvalue of a depended setting would be calculated based on the default\nvalue of the setting(s) it depends on, rather than the current value of\nthose settings."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NjQ3NzM1", "url": "https://github.com/elastic/elasticsearch/pull/65989#pullrequestreview-546647735", "createdAt": "2020-12-08T00:17:21Z", "commit": {"oid": "beafc566a85571ba6d1ea199d7cbc5f883df09c8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwMDoxNzoyMlrOIBA5Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwMDoxNzoyMlrOIBA5Iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkzNDExNQ==", "bodyText": "I think this might read better if the outer \"doesn't exist in source\" stays the same and then have two inner conditions for \"if (exists in defaults) X else Y\"", "url": "https://github.com/elastic/elasticsearch/pull/65989#discussion_r537934115", "createdAt": "2020-12-08T00:17:22Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/common/settings/Setting.java", "diffHunk": "@@ -486,7 +486,11 @@ private T get(Settings settings, boolean validate) {\n      * @param defaultSettings the default settings object to diff against\n      */\n     public void diff(Settings.Builder builder, Settings source, Settings defaultSettings) {\n-        if (exists(source) == false) {\n+        if (exists(source) == false && exists(defaultSettings) == false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "beafc566a85571ba6d1ea199d7cbc5f883df09c8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0c6578d898a357ca2f4f6969f100359389bdb8c", "author": {"user": {"login": "gwbrown", "name": "Gordon Brown"}}, "url": "https://github.com/elastic/elasticsearch/commit/d0c6578d898a357ca2f4f6969f100359389bdb8c", "committedDate": "2020-12-08T17:50:37Z", "message": "Rearrage `if` per review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30145f453e11a1077054d758c9834e02b18b90bb", "author": {"user": {"login": "gwbrown", "name": "Gordon Brown"}}, "url": "https://github.com/elastic/elasticsearch/commit/30145f453e11a1077054d758c9834e02b18b90bb", "committedDate": "2020-12-08T17:50:49Z", "message": "Merge branch 'master' into fix-diff-of-dependent-default-settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a03aa53ac99d87326e9a10885ae95b6128ba020a", "author": {"user": {"login": "gwbrown", "name": "Gordon Brown"}}, "url": "https://github.com/elastic/elasticsearch/commit/a03aa53ac99d87326e9a10885ae95b6128ba020a", "committedDate": "2020-12-08T17:56:31Z", "message": "Rearrage `if` per review feedback, actually this time"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4096, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}