{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMDI3NTk3", "number": 65742, "title": "[Transform] fix intermittent test_usage failure", "bodyText": "relax test for trigger count, it might have been incremented but not persisted\nfixes #52931\nExplanation: #52931 (comment)", "createdAt": "2020-12-02T13:45:56Z", "url": "https://github.com/elastic/elasticsearch/pull/65742", "merged": true, "mergeCommit": {"oid": "894dbc783d01c182f69fbeaca9e225f76188e31d"}, "closed": true, "closedAt": "2020-12-02T16:00:20Z", "author": {"login": "hendrikmuhs"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiO37OgFqTU0Mjg1MjA4Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiPgxfAH2gAyNTMxMDI3NTk3OjZkOTAwYmM0Y2YxYjc0N2E1OWE4MjVmNDNhZWFlMjZmMzExOWUxN2I=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyODUyMDg2", "url": "https://github.com/elastic/elasticsearch/pull/65742#pullrequestreview-542852086", "createdAt": "2020-12-02T13:50:08Z", "commit": {"oid": "88cfcee47324f292db35647fa3a9a1104805a087"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzo1MDowOFrOH9bx5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxMzo1MDoxOFrOH9byWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4MDMyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,\n          \n          \n            \n                            // the trigger count can be off: e.g. if the scheduler kicked in before usage has been called,", "url": "https://github.com/elastic/elasticsearch/pull/65742#discussion_r534180326", "createdAt": "2020-12-02T13:50:08Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java", "diffHunk": "@@ -107,12 +103,14 @@ public void testUsage() throws Exception {\n             assertEquals(2, XContentMapValues.extractValue(\"transform.transforms.stopped\", statsMap));\n             assertEquals(1, XContentMapValues.extractValue(\"transform.transforms.started\", statsMap));\n             for (String statName : PROVIDED_STATS) {\n-                // the trigger count can be higher if the scheduler kicked before usage has been called, therefore check for gte\n+                // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88cfcee47324f292db35647fa3a9a1104805a087"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4MDQ0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // or if the the scheduler triggered later, but state hasn't been persisted (by design)\n          \n          \n            \n                            // or if the scheduler triggered later, but state hasn't been persisted (by design)", "url": "https://github.com/elastic/elasticsearch/pull/65742#discussion_r534180441", "createdAt": "2020-12-02T13:50:18Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java", "diffHunk": "@@ -107,12 +103,14 @@ public void testUsage() throws Exception {\n             assertEquals(2, XContentMapValues.extractValue(\"transform.transforms.stopped\", statsMap));\n             assertEquals(1, XContentMapValues.extractValue(\"transform.transforms.started\", statsMap));\n             for (String statName : PROVIDED_STATS) {\n-                // the trigger count can be higher if the scheduler kicked before usage has been called, therefore check for gte\n+                // the trigger count can be off: e.g. if the scheduler kicked before usage has been called,\n+                // or if the the scheduler triggered later, but state hasn't been persisted (by design)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88cfcee47324f292db35647fa3a9a1104805a087"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a52a7242fac4f2fbddb577e26587bed246b1f23a", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/a52a7242fac4f2fbddb577e26587bed246b1f23a", "committedDate": "2020-12-02T14:06:09Z", "message": "relax test for trigger count, it might have been incremented but not persisted\n\nfixes #52931"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88cfcee47324f292db35647fa3a9a1104805a087", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/88cfcee47324f292db35647fa3a9a1104805a087", "committedDate": "2020-12-02T10:53:58Z", "message": "relax test for trigger count, it might have been incremented but not persisted\n\nfixes #52931"}, "afterCommit": {"oid": "a52a7242fac4f2fbddb577e26587bed246b1f23a", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/a52a7242fac4f2fbddb577e26587bed246b1f23a", "committedDate": "2020-12-02T14:06:09Z", "message": "relax test for trigger count, it might have been incremented but not persisted\n\nfixes #52931"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cf5cb60a347428d5417eac8b0b3cebc63c9f89a", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/4cf5cb60a347428d5417eac8b0b3cebc63c9f89a", "committedDate": "2020-12-02T14:34:52Z", "message": "Update x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java\n\nCo-authored-by: Przemys\u0142aw Witek <przemyslaw.witek@elastic.co>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d900bc4cf1b747a59a825f43aeae26f3119e17b", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/6d900bc4cf1b747a59a825f43aeae26f3119e17b", "committedDate": "2020-12-02T14:35:02Z", "message": "Update x-pack/plugin/transform/qa/single-node-tests/src/javaRestTest/java/org/elasticsearch/xpack/transform/integration/TransformUsageIT.java\n\nCo-authored-by: Przemys\u0142aw Witek <przemyslaw.witek@elastic.co>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4101, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}