{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2ODIzMTI4", "number": 63169, "title": "EQL: Fix syntax for event type", "bodyText": "Event type is actually a string value for event.category which can\ncontain any kind of characters, or start with a digit, which currently\nis not supported, so we introduce the possibility to be able to use the\nusual syntax of \" and \"\"\" for strings and raw strings.\nMake the grammar a bit cleaner by using the identifier only where it's\nactually an identifier in terms of query scemantics.\nFixes: #62933", "createdAt": "2020-10-02T10:30:58Z", "url": "https://github.com/elastic/elasticsearch/pull/63169", "merged": true, "mergeCommit": {"oid": "306e1d76da3db652db57f11f847705b3995609ff"}, "closed": true, "closedAt": "2020-10-02T14:41:14Z", "author": {"login": "matriv"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOjaSfAH2gAyNDk2ODIzMTI4OjVkNGUxNWQxYmYwNGI3ZGVlMGU3ZTRiNmY0NTU5MDYwNjIxNTVkMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOmdxOgH2gAyNDk2ODIzMTI4OmViYWVjMTRhNTI2YWVkYjE4YThhZTFjM2RiMWQ3NTU2N2RiZDdjYzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "committedDate": "2020-10-02T10:27:34Z", "message": "EQL: Fix syntax for event type\n\nEvent type is actually a string value for `event.category` which can\ncontain any kind of characters, or start with a digit, which currently\nis not supported, so we introduce the possibility to be able to use the\nusual syntax of `\"` and `?\"` for strings and raw strings.\n\nFixes: #62933"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMDI4OTgz", "url": "https://github.com/elastic/elasticsearch/pull/63169#pullrequestreview-501028983", "createdAt": "2020-10-02T10:36:45Z", "commit": {"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMDozNjo0NVrOHbo_Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMDo0MzozMlrOHbpKZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NTE3OA==", "bodyText": "Should be QUOTED_IDENTIFIER.", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498745178", "createdAt": "2020-10-02T10:36:45Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -218,6 +213,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+ESCAPED_IDENTIFIER", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NTczOA==", "bodyText": "?", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498745738", "createdAt": "2020-10-02T10:38:08Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -76,7 +76,7 @@ expression\n \n booleanExpression\n     : NOT booleanExpression                                               #logicalNot\n-    | relationship=IDENTIFIER OF subquery                                 #processCheck\n+    | relationship= OF subquery                                 #processCheck", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0ODAwNg==", "bodyText": "I don't see definition for STRINGIDENTIFIER (should be STRING_IDENTIFIER).", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498748006", "createdAt": "2020-10-02T10:43:32Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -218,6 +213,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+ESCAPED_IDENTIFIER\n+    : '`' (~'`')* '`'\n+    ;\n+\n+eventValue\n+    : STRINGIDENTIFIER", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7090a88dc0bdb7e67ad4861950fa8a426894dba8", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7090a88dc0bdb7e67ad4861950fa8a426894dba8", "committedDate": "2020-10-02T12:12:43Z", "message": "Merge remote-tracking branch 'upstream/master' into fix-62933"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "358bfa4aa65361dd373af4440234e379a8eca217", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/358bfa4aa65361dd373af4440234e379a8eca217", "committedDate": "2020-10-02T12:56:21Z", "message": "add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMTE0NzI5", "url": "https://github.com/elastic/elasticsearch/pull/63169#pullrequestreview-501114729", "createdAt": "2020-10-02T13:02:46Z", "commit": {"oid": "358bfa4aa65361dd373af4440234e379a8eca217"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzowMjo0NlrOHbswVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzowMjo0NlrOHbswVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNjg2OQ==", "bodyText": "does it make sense to use quoted identifier instead or in addition to this?", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498806869", "createdAt": "2020-10-02T13:02:46Z", "author": {"login": "rw-access"}, "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -221,6 +220,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+QUOTED_IDENTIFIER\n+    : '`' ( ~'`' | '``' )* '`'\n+    ;\n+\n+eventValue\n+    : STRING", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "358bfa4aa65361dd373af4440234e379a8eca217"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMTU2MTky", "url": "https://github.com/elastic/elasticsearch/pull/63169#pullrequestreview-501156192", "createdAt": "2020-10-02T13:54:35Z", "commit": {"oid": "358bfa4aa65361dd373af4440234e379a8eca217"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzo1NDozNVrOHbukOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMzo1NDozNVrOHbukOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzNjUzNg==", "bodyText": "Could you please add one with space with dots as well just to consistent?\nOtherwise LGTM", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498836536", "createdAt": "2020-10-02T13:54:35Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/src/test/resources/queries-supported.eql", "diffHunk": "@@ -687,3 +687,17 @@ process where fake_field != \"*\"\n \n process where not (fake_field : \"*\")\n | head 4;\n+\n+\n+// eventType values\n+\"123\" where process_name == \"svchost.exe\";\n+\n+\"!#$%^&!#$\\\"123*&^%$()\" where process_name == \"svchost.exe\";\n+\n+\"\"\"\"\"!#$%^&!\"\"#$\\\"123*\"\"&^%$()\"\"\"\"\" where process_name == \"svchost.exe\";\n+\n+sequence\n+  [\"!#$134\" where serial_event_id<3] by unique_pid1\n+  [\"\"\"!#@$%12345)(*&%^%#$@\"\"\" where true] by unique_ppid2\n+| tail 1\n+;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "358bfa4aa65361dd373af4440234e379a8eca217"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebaec14a526aedb18a8ae1c3db1d75567dbd7cc0", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/ebaec14a526aedb18a8ae1c3db1d75567dbd7cc0", "committedDate": "2020-10-02T14:01:05Z", "message": "add more tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4476, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}