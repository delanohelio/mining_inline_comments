{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NjUwODUx", "number": 53397, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNTo1NDo1MVrODnIyqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNTo1NDo1MVrODnIyqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMzY1MDk2OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/action/search/CanMatchPreFilterSearchPhase.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNTo1NDo1MVrOF09aXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQyMDoyMDoxOFrOF1uBUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA3NjQ0NA==", "bodyText": "It's slightly confusing that we use getMin for the initial getClass and then getMax. Use getMin all the time maybe?", "url": "https://github.com/elastic/elasticsearch/pull/53397#discussion_r391076444", "createdAt": "2020-03-11T15:54:51Z", "author": {"login": "jpountz"}, "path": "server/src/main/java/org/elasticsearch/action/search/CanMatchPreFilterSearchPhase.java", "diffHunk": "@@ -128,7 +126,18 @@ protected SearchPhase getNextPhase(SearchPhaseResults<CanMatchResponse> results,\n     }\n \n     private static boolean shouldSortShards(MinAndMax<?>[] minAndMaxes) {\n-        return Arrays.stream(minAndMaxes).anyMatch(Objects::nonNull);\n+        Class<?> clazz = null;\n+        for (MinAndMax<?> minAndMax : minAndMaxes) {\n+            if (clazz == null) {\n+                clazz = minAndMax == null ? null : minAndMax.getMin().getClass();\n+            } else if (minAndMax != null && clazz != minAndMax.getMax().getClass()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9eea0ee20e8bdc057983e68f6bfc7eb63914466"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg3Mjg0OQ==", "bodyText": "++, I pushed ef3df35", "url": "https://github.com/elastic/elasticsearch/pull/53397#discussion_r391872849", "createdAt": "2020-03-12T20:20:18Z", "author": {"login": "jimczi"}, "path": "server/src/main/java/org/elasticsearch/action/search/CanMatchPreFilterSearchPhase.java", "diffHunk": "@@ -128,7 +126,18 @@ protected SearchPhase getNextPhase(SearchPhaseResults<CanMatchResponse> results,\n     }\n \n     private static boolean shouldSortShards(MinAndMax<?>[] minAndMaxes) {\n-        return Arrays.stream(minAndMaxes).anyMatch(Objects::nonNull);\n+        Class<?> clazz = null;\n+        for (MinAndMax<?> minAndMax : minAndMaxes) {\n+            if (clazz == null) {\n+                clazz = minAndMax == null ? null : minAndMax.getMin().getClass();\n+            } else if (minAndMax != null && clazz != minAndMax.getMax().getClass()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA3NjQ0NA=="}, "originalCommit": {"oid": "f9eea0ee20e8bdc057983e68f6bfc7eb63914466"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3283, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}