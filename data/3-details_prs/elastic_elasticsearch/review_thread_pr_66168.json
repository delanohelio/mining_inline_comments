{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1OTQ4NjQ4", "number": 66168, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDowMToxMlrOFDfgZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDoyNzozNVrOFDgTlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5MjA2MjQ1OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDowMToxMlrOIDKq4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNTowNDoyM1rOIDNtjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE5MTQ1OA==", "bodyText": "I think that you need to handle multi-fields as well? Is that it?", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540191458", "createdAt": "2020-12-10T14:01:12Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -89,6 +98,21 @@ public static RuntimeFieldsFeatureSetUsage fromMetadata(Iterable<IndexMetadata>\n         return new RuntimeFieldsFeatureSetUsage(Collections.unmodifiableList(runtimeFieldStats));\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    private static void findFieldNames(Map<String, Object> mappings, String path, Consumer<String> fieldNameConsumer) {\n+        Object o = mappings.get(\"properties\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE5MjEzNQ==", "bodyText": "It would be really great to reuse MappingVisitor here, as it does the right thing, only a shame that it does a fundamentally different thing, as in it does not allow you to consume the name, but rather the content of the field mappings.", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540192135", "createdAt": "2020-12-10T14:02:06Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -89,6 +98,21 @@ public static RuntimeFieldsFeatureSetUsage fromMetadata(Iterable<IndexMetadata>\n         return new RuntimeFieldsFeatureSetUsage(Collections.unmodifiableList(runtimeFieldStats));\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    private static void findFieldNames(Map<String, Object> mappings, String path, Consumer<String> fieldNameConsumer) {\n+        Object o = mappings.get(\"properties\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE5MTQ1OA=="}, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI0MTI5Mw==", "bodyText": "I've rewritten to use MappingVisitor, which handles objects and multifields.", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540241293", "createdAt": "2020-12-10T15:04:23Z", "author": {"login": "romseygeek"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -89,6 +98,21 @@ public static RuntimeFieldsFeatureSetUsage fromMetadata(Iterable<IndexMetadata>\n         return new RuntimeFieldsFeatureSetUsage(Collections.unmodifiableList(runtimeFieldStats));\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    private static void findFieldNames(Map<String, Object> mappings, String path, Consumer<String> fieldNameConsumer) {\n+        Object o = mappings.get(\"properties\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE5MTQ1OA=="}, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5MjE5MzUwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDoyNzozNVrOIDL5GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNTowNzo1OFrOIDN5KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDIxMTQ4MQ==", "bodyText": "is it shadowed, or is it shadowing, or? :)", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540211481", "createdAt": "2020-12-10T14:27:35Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -217,6 +244,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n             builder.field(\"count\", count);\n             builder.field(\"index_count\", indexCount);\n             builder.field(\"scriptless_count\", scriptLessCount);\n+            builder.field(\"shadowed_count\", shadowedCount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI0MjIyMA==", "bodyText": "Well the runtime fields is doing the shadowing, but we're also counting the number of fields shadowed by the runtime section, so \ud83e\udd37 - I can change to shadowing_count if you think that's clearer.  Or maybe have another name altogether...", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540242220", "createdAt": "2020-12-10T15:05:29Z", "author": {"login": "romseygeek"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -217,6 +244,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n             builder.field(\"count\", count);\n             builder.field(\"index_count\", indexCount);\n             builder.field(\"scriptless_count\", scriptLessCount);\n+            builder.field(\"shadowed_count\", shadowedCount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDIxMTQ4MQ=="}, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI0NDI2NA==", "bodyText": "it's fine as-is thanks", "url": "https://github.com/elastic/elasticsearch/pull/66168#discussion_r540244264", "createdAt": "2020-12-10T15:07:58Z", "author": {"login": "javanna"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/runtimefields/RuntimeFieldsFeatureSetUsage.java", "diffHunk": "@@ -217,6 +244,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n             builder.field(\"count\", count);\n             builder.field(\"index_count\", indexCount);\n             builder.field(\"scriptless_count\", scriptLessCount);\n+            builder.field(\"shadowed_count\", shadowedCount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDIxMTQ4MQ=="}, "originalCommit": {"oid": "ab440f5a91b517e81b2aea9a1492d02939e8958c"}, "originalPosition": 91}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4734, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}