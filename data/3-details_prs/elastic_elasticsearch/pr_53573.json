{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4Mjc2NDIz", "number": 53573, "title": "SQL: Fix NPE for parameterized LIKE/RLIKE", "bodyText": "Fix NPE when null is passed as a parameter for a parameterized\npattern of LIKE/RLIKE. e.g.: field LIKE ? params=[null]`\nCheck for null pattern in LIKE/RLIKE as for RLIKE (RegexpQuery) we\nget an IllegalArgumentExpression from Lucence but for LIKE\n(WildcardQuery) we get an NPE.\nFixes: #53557", "createdAt": "2020-03-14T11:58:49Z", "url": "https://github.com/elastic/elasticsearch/pull/53573", "merged": true, "mergeCommit": {"oid": "ec3481ed13254ecdec32acf7a0fafd536ec77aff"}, "closed": true, "closedAt": "2020-03-16T12:49:49Z", "author": {"login": "matriv"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNjlJcgH2gAyMzg4Mjc2NDIzOjA5ZDI0Yzc3OTgzY2QzMTkxOTcwNjg0OGMwZjkzZWEzMWNhMGEzMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOMSzKgH2gAyMzg4Mjc2NDIzOmE5NDZkYzA5ZDJiNTA1NGY1ZGUxOWY5ODY1NmM5ZWFmNmQ3MTE2YTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/09d24c77983cd31919706848c0f93ea31ca0a30e", "committedDate": "2020-03-14T11:54:21Z", "message": "SQL: Fix NPE for parameterized LIKE/RLIKE\n\nFix NPE when `null` is passed as a parameter for a parameterized\npattern of LIKE/RLIKE. e.g.: `field LIKE ?` params=[null]`\nCheck for null pattern in LIKE/RLIKE as for RLIKE (RegexpQuery) we\nget an IllegalArgumentExpression from Lucence but for LIKE\n(WildcardQuery) we get an NPE.\n\nFixes: #53557"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0OTYzMDUw", "url": "https://github.com/elastic/elasticsearch/pull/53573#pullrequestreview-374963050", "createdAt": "2020-03-16T07:18:30Z", "commit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDAxNzM5", "url": "https://github.com/elastic/elasticsearch/pull/53573#pullrequestreview-375001739", "createdAt": "2020-03-16T08:36:08Z", "commit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDAzNzEx", "url": "https://github.com/elastic/elasticsearch/pull/53573#pullrequestreview-375003711", "createdAt": "2020-03-16T08:39:07Z", "commit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwODozOTowOFrOF2qERQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwODozOTowOFrOF2qERQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg1NjY0NQ==", "bodyText": "Since the pattern always has to be non-null, I think it would be better to report the error at the parser level instead of letting it propagate all the way to the tree which would be invalid anyway...\nJust like w do with pos below by throwing a ParsingException", "url": "https://github.com/elastic/elasticsearch/pull/53573#discussion_r392856645", "createdAt": "2020-03-16T08:39:08Z", "author": {"login": "costin"}, "path": "x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/parser/ExpressionBuilder.java", "diffHunk": "@@ -263,6 +263,9 @@ public LikePattern visitPattern(PatternContext ctx) {\n         }\n \n         String pattern = string(ctx.value);\n+        if (pattern == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDIxMDEz", "url": "https://github.com/elastic/elasticsearch/pull/53573#pullrequestreview-375021013", "createdAt": "2020-03-16T09:06:39Z", "commit": {"oid": "09d24c77983cd31919706848c0f93ea31ca0a30e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "676a3a597dc2cd3aac631123d8a7e5b147577d55", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/676a3a597dc2cd3aac631123d8a7e5b147577d55", "committedDate": "2020-03-16T11:09:23Z", "message": "move null check to Parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a946dc09d2b5054f5de19f98656c9eaf6d7116a4", "author": {"user": {"login": "matriv", "name": "Marios Trivyzas"}}, "url": "https://github.com/elastic/elasticsearch/commit/a946dc09d2b5054f5de19f98656c9eaf6d7116a4", "committedDate": "2020-03-16T11:20:25Z", "message": "remove unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1418, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}