{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NDUwNDQ3", "number": 63438, "title": "Add factory methods for common value fetchers.", "bodyText": "This PR adds factory methods for the most common implementations:\n\nSourceValueFetcher.identity to pass through the source value untouched.\nSourceValueFetcher.toString to simply convert the source value to a string.", "createdAt": "2020-10-07T18:51:34Z", "url": "https://github.com/elastic/elasticsearch/pull/63438", "merged": true, "mergeCommit": {"oid": "8c56bbc3e6edcf9db2ee82559cbcd2c155271391"}, "closed": true, "closedAt": "2020-10-08T18:58:37Z", "author": {"login": "jtibshirani"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQRmgSAH2gAyNDk5NDUwNDQ3OmY3YjY0MjJkYjA4ZDNhMTZiNmQxNGI1NDUxY2I3MTliYjNhMTVmZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQkyIpAH2gAyNDk5NDUwNDQ3OjJiYmY3ZjY0YzJmYTc1MzY2YmZkNTllMThlNTU3Njk1Nzc3Y2QwNDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f7b6422db08d3a16b6d14b5451cb719bb3a15fd2", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/f7b6422db08d3a16b6d14b5451cb719bb3a15fd2", "committedDate": "2020-10-07T18:50:28Z", "message": "Add a method SourceValueFetcher.identity."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3f2a839c5c6c068dd36539f63d7fb22d98cef00", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/b3f2a839c5c6c068dd36539f63d7fb22d98cef00", "committedDate": "2020-10-07T18:50:36Z", "message": "Add a method SourceValueFetcher.toString."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fa85c405eb31a4ba19c6a21b79557b898df438e", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/5fa85c405eb31a4ba19c6a21b79557b898df438e", "committedDate": "2020-10-07T19:29:07Z", "message": "Fix test failures."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MjAxNTc4", "url": "https://github.com/elastic/elasticsearch/pull/63438#pullrequestreview-504201578", "createdAt": "2020-10-07T19:30:39Z", "commit": {"oid": "5fa85c405eb31a4ba19c6a21b79557b898df438e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxOTozMDozOVrOHeCa0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxOTozMDozOVrOHeCa0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI1ODk2Mg==", "bodyText": "Through this refactor I discovered that we were incorrectly applying nullValue to the root flattened field. I'll open another PR to clean up value fetching for flattened fields, which should be reviewed/ merged first.\nAn update: I opened #63443 to fix this.", "url": "https://github.com/elastic/elasticsearch/pull/63438#discussion_r501258962", "createdAt": "2020-10-07T19:30:39Z", "author": {"login": "jtibshirani"}, "path": "x-pack/plugin/mapper-flattened/src/main/java/org/elasticsearch/xpack/flattened/mapper/FlatObjectFieldMapper.java", "diffHunk": "@@ -471,15 +471,7 @@ public Object valueForDisplay(Object value) {\n \n         @Override\n         public ValueFetcher valueFetcher(MapperService mapperService, SearchLookup searchLookup, String format) {\n-            if (format != null) {\n-                throw new IllegalArgumentException(\"Field [\" + name() + \"] of type [\" + typeName() + \"] doesn't support formats.\");\n-            }\n-            return new SourceValueFetcher(name(), mapperService, nullValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa85c405eb31a4ba19c6a21b79557b898df438e"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NTExNzk2", "url": "https://github.com/elastic/elasticsearch/pull/63438#pullrequestreview-504511796", "createdAt": "2020-10-08T07:49:15Z", "commit": {"oid": "5fa85c405eb31a4ba19c6a21b79557b898df438e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NTExOTI1", "url": "https://github.com/elastic/elasticsearch/pull/63438#pullrequestreview-504511925", "createdAt": "2020-10-08T07:49:26Z", "commit": {"oid": "5fa85c405eb31a4ba19c6a21b79557b898df438e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bbf7f64c2fa75366bfd59e18e557695777cd043", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/2bbf7f64c2fa75366bfd59e18e557695777cd043", "committedDate": "2020-10-08T17:11:22Z", "message": "Merge remote-tracking branch 'upstream/master' into fetcher-factories"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4185, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}