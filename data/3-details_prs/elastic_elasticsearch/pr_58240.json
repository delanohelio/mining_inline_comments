{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1Nzc2NTc3", "number": 58240, "title": "Delete auto-generated annotations when model snapshot is reverted", "bodyText": "This PR makes a portion of auto-generated (i.e. created by the _xpack user) annotations associated with the job deleted when the snapshot is reverted.\nOnly annotations that both:\n\nrelate to periods after the reversion time\n\nand\n\nhave delayed_data or model_change event type\n\nare deleted.\nCloses #57982", "createdAt": "2020-06-17T11:04:41Z", "url": "https://github.com/elastic/elasticsearch/pull/58240", "merged": true, "mergeCommit": {"oid": "6d31e685a902d65c5f6faec8bcc4e4d73f754093"}, "closed": true, "closedAt": "2020-06-18T14:30:39Z", "author": {"login": "przemekwitek"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsIpb7gBqjM0NTMyNTYwMTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsetg-gBqjM0NTgyMDY1MTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "feb19e6480239cbc23a9cf043e4ea17060b4a8e7", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/feb19e6480239cbc23a9cf043e4ea17060b4a8e7", "committedDate": "2020-06-17T10:50:56Z", "message": "Remove auto-generated annotations after reverting snapshot"}, "afterCommit": {"oid": "1c2d1fc9122ec9e7a50dd84197db0af8e6c9ed76", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/1c2d1fc9122ec9e7a50dd84197db0af8e6c9ed76", "committedDate": "2020-06-17T12:03:05Z", "message": "Remove auto-generated annotations after reverting snapshot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c2d1fc9122ec9e7a50dd84197db0af8e6c9ed76", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/1c2d1fc9122ec9e7a50dd84197db0af8e6c9ed76", "committedDate": "2020-06-17T12:03:05Z", "message": "Remove auto-generated annotations after reverting snapshot"}, "afterCommit": {"oid": "24a6a52dc1dea9a0bbcab25c33333037e749682c", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/24a6a52dc1dea9a0bbcab25c33333037e749682c", "committedDate": "2020-06-17T12:03:37Z", "message": "Remove auto-generated annotations after reverting snapshot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24a6a52dc1dea9a0bbcab25c33333037e749682c", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/24a6a52dc1dea9a0bbcab25c33333037e749682c", "committedDate": "2020-06-17T12:03:37Z", "message": "Remove auto-generated annotations after reverting snapshot"}, "afterCommit": {"oid": "7e12825d2677e300bf4c65c5ac9b01df9f532e54", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/7e12825d2677e300bf4c65c5ac9b01df9f532e54", "committedDate": "2020-06-17T13:18:22Z", "message": "Remove auto-generated annotations after reverting snapshot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e12825d2677e300bf4c65c5ac9b01df9f532e54", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/7e12825d2677e300bf4c65c5ac9b01df9f532e54", "committedDate": "2020-06-17T13:18:22Z", "message": "Remove auto-generated annotations after reverting snapshot"}, "afterCommit": {"oid": "19922f568cffd99d6c49c5d202b6a7ef5762c0d8", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/19922f568cffd99d6c49c5d202b6a7ef5762c0d8", "committedDate": "2020-06-18T07:10:23Z", "message": "Remove auto-generated annotations after reverting snapshot"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMTMyOTI2", "url": "https://github.com/elastic/elasticsearch/pull/58240#pullrequestreview-433132926", "createdAt": "2020-06-18T10:05:09Z", "commit": {"oid": "19922f568cffd99d6c49c5d202b6a7ef5762c0d8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMDowNToxMFrOGloj2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMDowNToxMFrOGloj2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExNTAzNA==", "bodyText": "It would be best if the job ID was passed as an argument and the two test cases set it to different values.  This will be helpful if a completely different test fails because of a side effect of one of these two tests.  (A long time ago almost all our integration tests used the same names, like job and foo, but this was a nightmare when a test failed because a job called job or foo was left over from an earlier test not completing as expected, so we tried to change all the integration test job names to be unique to a particular test.)", "url": "https://github.com/elastic/elasticsearch/pull/58240#discussion_r442115034", "createdAt": "2020-06-18T10:05:10Z", "author": {"login": "droberts195"}, "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/RevertModelSnapshotIT.java", "diffHunk": "@@ -50,7 +62,15 @@ public void tearDownData() throws Exception {\n         cleanUp();\n     }\n \n-    public void test() throws Exception {\n+    public void testRevertModelSnapshot() throws Exception {\n+        test(false);\n+    }\n+\n+    public void testRevertModelSnapshot_DeleteInterveningResults() throws Exception {\n+        test(true);\n+    }\n+\n+    private void test(boolean deleteInterveningResults) throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19922f568cffd99d6c49c5d202b6a7ef5762c0d8"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5d3d0592740b0f56c7723794d89814c3de97f57", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/d5d3d0592740b0f56c7723794d89814c3de97f57", "committedDate": "2020-06-18T13:45:23Z", "message": "Remove auto-generated annotations after reverting snapshot"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8918fc5a60a6bdc5296d4830c45c1e276cbb5c0", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/e8918fc5a60a6bdc5296d4830c45c1e276cbb5c0", "committedDate": "2020-06-18T13:45:23Z", "message": "Apply review comment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2994b87b3367b6adca3aa2a7dcf7ee786bfd0bfb", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/2994b87b3367b6adca3aa2a7dcf7ee786bfd0bfb", "committedDate": "2020-06-18T11:46:44Z", "message": "Apply review comment"}, "afterCommit": {"oid": "e8918fc5a60a6bdc5296d4830c45c1e276cbb5c0", "author": {"user": {"login": "przemekwitek", "name": "Przemys\u0142aw Witek"}}, "url": "https://github.com/elastic/elasticsearch/commit/e8918fc5a60a6bdc5296d4830c45c1e276cbb5c0", "committedDate": "2020-06-18T13:45:23Z", "message": "Apply review comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 604, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}