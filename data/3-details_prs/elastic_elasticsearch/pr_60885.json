{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NDEzNzM3", "number": 60885, "title": "Avoid a race condition while waiting for pre warm to finish on SearchableSnapshotDirectoryTests", "bodyText": "assertExecutorIsIdle was prone to races and it was possible that the conditions were true before the pre-warm phase finished. This PR waits until the pre-warm flag is set on SearchableSnapshotRecoveryState.\nCloses #60813", "createdAt": "2020-08-10T10:26:38Z", "url": "https://github.com/elastic/elasticsearch/pull/60885", "merged": true, "mergeCommit": {"oid": "f09ff11cba6c807117cb2122e38d60cde4ecb5a2"}, "closed": true, "closedAt": "2020-08-10T14:31:01Z", "author": {"login": "fcofdez"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9fkgwAH2gAyNDY1NDEzNzM3OjljMzBkNGQ2NGRlODBjZWU4ODZkOGMwYzk0ZTEzNmRjNjQ0NTZhZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9ia_dgH2gAyNDY1NDEzNzM3OmVlY2FlZDQ0MDk5NzJkYmY4OTU5NzhjNjQxZmEwZDllYTE1ZGNlZjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9c30d4d64de80cee886d8c0c94e136dc64456ad0", "author": {"user": {"login": "fcofdez", "name": "Francisco Fern\u00e1ndez Casta\u00f1o"}}, "url": "https://github.com/elastic/elasticsearch/commit/9c30d4d64de80cee886d8c0c94e136dc64456ad0", "committedDate": "2020-08-10T10:22:24Z", "message": "Avoid a race condition while waiting for pre warm to finish on SearchableSnapshotDirectoryTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4d94bd130435a6c416afb9c97178d7f4b756bb2", "author": {"user": {"login": "fcofdez", "name": "Francisco Fern\u00e1ndez Casta\u00f1o"}}, "url": "https://github.com/elastic/elasticsearch/commit/a4d94bd130435a6c416afb9c97178d7f4b756bb2", "committedDate": "2020-08-10T10:45:40Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MTUyNzUw", "url": "https://github.com/elastic/elasticsearch/pull/60885#pullrequestreview-464152750", "createdAt": "2020-08-10T11:35:00Z", "commit": {"oid": "a4d94bd130435a6c416afb9c97178d7f4b756bb2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMTozNTowMFrOG-K8aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMTozNTowMFrOG-K8aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg0NDIwMA==", "bodyText": "Naming nit, I think we should call this preWarmComplete (here and related names) rather than preWarmFinished since if there are any failures the prewarming process still finishes, although the shard was not completely prewarmed.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public synchronized void setPreWarmFinished() {\n          \n          \n            \n                public synchronized void setPreWarmComplete() {", "url": "https://github.com/elastic/elasticsearch/pull/60885#discussion_r467844200", "createdAt": "2020-08-10T11:35:00Z", "author": {"login": "DaveCTurner"}, "path": "x-pack/plugin/searchable-snapshots/src/main/java/org/elasticsearch/indices/recovery/SearchableSnapshotRecoveryState.java", "diffHunk": "@@ -37,7 +37,7 @@ public synchronized RecoveryState setStage(Stage stage) {\n         return super.setStage(stage);\n     }\n \n-    public synchronized void preWarmFinished() {\n+    public synchronized void setPreWarmFinished() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4d94bd130435a6c416afb9c97178d7f4b756bb2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd8675bb0fcc4a1dc89b5c5f4d04f9ef6d169330", "author": {"user": {"login": "fcofdez", "name": "Francisco Fern\u00e1ndez Casta\u00f1o"}}, "url": "https://github.com/elastic/elasticsearch/commit/bd8675bb0fcc4a1dc89b5c5f4d04f9ef6d169330", "committedDate": "2020-08-10T12:08:17Z", "message": "Rename preWarmFinished to preWarmComplete"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MTc1MDAw", "url": "https://github.com/elastic/elasticsearch/pull/60885#pullrequestreview-464175000", "createdAt": "2020-08-10T12:15:05Z", "commit": {"oid": "bd8675bb0fcc4a1dc89b5c5f4d04f9ef6d169330"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eecaed4409972dbf895978c641fa0d9ea15dcef5", "author": {"user": {"login": "fcofdez", "name": "Francisco Fern\u00e1ndez Casta\u00f1o"}}, "url": "https://github.com/elastic/elasticsearch/commit/eecaed4409972dbf895978c641fa0d9ea15dcef5", "committedDate": "2020-08-10T13:41:43Z", "message": "Merge remote-tracking branch 'origin/master' into fix-searchable-snapshot-directory-tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3335, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}