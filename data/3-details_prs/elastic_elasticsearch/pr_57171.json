{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzMzkzODI5", "number": 57171, "title": "Fix NormalizerAgg test searcher wrapping", "bodyText": "The searcher was randomly wrapping its reader as slow, parallel, or filtered.\nThis was causing casting issues in the normalizer tests. By removing the\nwrapping, the problem goes away.\nCloses #57164", "createdAt": "2020-05-26T18:58:46Z", "url": "https://github.com/elastic/elasticsearch/pull/57171", "merged": true, "mergeCommit": {"oid": "7eb52735a4a50f2387a39a13a79fa626e8375347"}, "closed": true, "closedAt": "2020-05-26T20:10:33Z", "author": {"login": "talevy"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclJXnMgH2gAyNDIzMzkzODI5OjlmNjM4NDEzNjgxMmUxYjVjMzRhNWE5NjMxN2IzNmQ2Yjk2ZWE3MGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclJ9ZKgFqTQxODYyMDc0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f6384136812e1b5c34a5a96317b36d6b96ea70e", "author": {"user": {"login": "talevy", "name": "Tal Levy"}}, "url": "https://github.com/elastic/elasticsearch/commit/9f6384136812e1b5c34a5a96317b36d6b96ea70e", "committedDate": "2020-05-26T18:56:13Z", "message": "Fix NormalizerAgg test searcher wrapping\n\nThe searcher was randomly wrapping its reader as slow, parallel, or filtered.\nThis was causing casting issues in the normalizer tests. By removing the\nwrapping, the problem goes away.\n\nCloses #57164"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NTk0MjYz", "url": "https://github.com/elastic/elasticsearch/pull/57171#pullrequestreview-418594263", "createdAt": "2020-05-26T19:07:18Z", "commit": {"oid": "9f6384136812e1b5c34a5a96317b36d6b96ea70e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOTowNzoxOFrOGasV_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOTowNzoxOFrOGasV_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0MjY4Ng==", "bodyText": "@polyfractal just pointed me to AggregatorTestCase#newIndexSearcher which seems to do that job. It has even less randomization, but it looks to be what we're moving the tests to.", "url": "https://github.com/elastic/elasticsearch/pull/57171#discussion_r430642686", "createdAt": "2020-05-26T19:07:18Z", "author": {"login": "nik9000"}, "path": "x-pack/plugin/analytics/src/test/java/org/elasticsearch/xpack/analytics/normalize/NormalizeAggregatorTests.java", "diffHunk": "@@ -160,7 +160,7 @@ private void testCase(ValuesSourceAggregationBuilder<?> aggBuilder, Consumer<Int\n             termFieldType.setHasDocValues(true);\n \n             try (IndexReader indexReader = DirectoryReader.open(directory)) {\n-                IndexSearcher indexSearcher = newSearcher(indexReader, true, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f6384136812e1b5c34a5a96317b36d6b96ea70e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "545f15b670571d45df7e7d8f8630af810234ceb4", "author": {"user": {"login": "talevy", "name": "Tal Levy"}}, "url": "https://github.com/elastic/elasticsearch/commit/545f15b670571d45df7e7d8f8630af810234ceb4", "committedDate": "2020-05-26T19:20:13Z", "message": "change method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NjIwNzQ1", "url": "https://github.com/elastic/elasticsearch/pull/57171#pullrequestreview-418620745", "createdAt": "2020-05-26T19:37:29Z", "commit": {"oid": "545f15b670571d45df7e7d8f8630af810234ceb4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4201, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}