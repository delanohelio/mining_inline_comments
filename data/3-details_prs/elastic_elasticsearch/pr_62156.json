{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyNzM1NjQ1", "number": 62156, "title": "Populate data stream fields when xOpaqueId not provided", "bodyText": "datastream related fields should be always be provided.\nmessage field is already set with a lazy value (Object.toString) within\nESLogMessage\nAlso removing test cases to directly access deprecation logger with LogManger.getLogger(\"deprecation\"). This is disallowed. DeprecationLogger.getLogger should be used.", "createdAt": "2020-09-09T10:16:54Z", "url": "https://github.com/elastic/elasticsearch/pull/62156", "merged": true, "mergeCommit": {"oid": "95c1488d933b98ee83ab7ff2fe08a9b6868fac52"}, "closed": true, "closedAt": "2020-09-18T07:40:22Z", "author": {"login": "pgomulka"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHJcn_gH2gAyNDgyNzM1NjQ1OjdlYTE2YjEyNzY4NzRiMmM1YTQ4NmMwYzRmYTBiOWRmNzYyNWUwNGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJCEPqAH2gAyNDgyNzM1NjQ1OjU3NjA1M2UzYjVhZWZmZjM1NzI2MWZjYTcxNGY1MTg2MzQ3NGFjNjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ea16b1276874b2c5a486c0c4fa0b9df7625e04c", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/7ea16b1276874b2c5a486c0c4fa0b9df7625e04c", "committedDate": "2020-09-09T10:15:07Z", "message": "Populate data stream fields when xOpaqueId not provided\n\ndatastream related fields should be always be provided.\nmessage field is already set with a lazy value (Object.toString) within\nESLogMessage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0OTAzMDM5", "url": "https://github.com/elastic/elasticsearch/pull/62156#pullrequestreview-484903039", "createdAt": "2020-09-09T11:14:58Z", "commit": {"oid": "7ea16b1276874b2c5a486c0c4fa0b9df7625e04c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c69c67c92ccca98460f1b8922532c58a7596602", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/7c69c67c92ccca98460f1b8922532c58a7596602", "committedDate": "2020-09-09T11:42:53Z", "message": "tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0OTI1MTI1", "url": "https://github.com/elastic/elasticsearch/pull/62156#pullrequestreview-484925125", "createdAt": "2020-09-09T11:48:05Z", "commit": {"oid": "7c69c67c92ccca98460f1b8922532c58a7596602"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMTo0ODowNVrOHPDf-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMTo0ODowNVrOHPDf-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU0ODAyNA==", "bodyText": "Should we check for the presence of key here?", "url": "https://github.com/elastic/elasticsearch/pull/62156#discussion_r485548024", "createdAt": "2020-09-09T11:48:05Z", "author": {"login": "pugnascotia"}, "path": "qa/logging-config/src/test/java/org/elasticsearch/common/logging/JsonLoggerTests.java", "diffHunk": "@@ -203,22 +202,17 @@ public void testDeprecatedMessageWithoutXOpaqueId() throws IOException {\n                     hasEntry(\"cluster.name\", \"elasticsearch\"),\n                     hasEntry(\"node.name\", \"sample-name\"),\n                     hasEntry(\"message\", \"deprecated message1\"),\n-                    not(hasKey(\"x-opaque-id\"))\n-                ),\n-                allOf(\n-                    hasEntry(\"type\", \"deprecation\"),\n-                    hasEntry(\"log.level\", \"DEPRECATION\"),\n-                    hasEntry(\"log.logger\", \"deprecation.test\"),\n-                    hasEntry(\"cluster.name\", \"elasticsearch\"),\n-                    hasEntry(\"node.name\", \"sample-name\"),\n-                    hasEntry(\"message\", \"deprecated message2\"),\n+                    hasEntry(\"data_stream.type\", \"logs\"),\n+                    hasEntry(\"data_stream.datatype\", \"deprecation\"),\n+                    hasEntry(\"data_stream.namespace\", \"elasticsearch\"),\n+                    hasEntry(\"ecs.version\", DeprecatedMessage.ECS_VERSION),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c69c67c92ccca98460f1b8922532c58a7596602"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0efc7a62583a0865c202e1b565e5df970b30a74e", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/0efc7a62583a0865c202e1b565e5df970b30a74e", "committedDate": "2020-09-09T11:59:44Z", "message": "missing key assertion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d392b3a3a0022c6ea1d373ff0241a05dd041b7e", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/3d392b3a3a0022c6ea1d373ff0241a05dd041b7e", "committedDate": "2020-09-14T15:02:34Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "576053e3b5aefff357261fca714f51863474ac66", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/576053e3b5aefff357261fca714f51863474ac66", "committedDate": "2020-09-15T06:47:00Z", "message": "Merge branch 'master' into logs/deprecation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4638, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}