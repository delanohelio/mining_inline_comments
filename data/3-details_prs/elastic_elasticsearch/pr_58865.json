{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyODE5NDg3", "number": 58865, "title": "[DOCS] Adding delete snapshot API docs.", "bodyText": "Adds a new page for the Delete index snapshot API.\nRelates to #56069\n\n7.x backport #58871\n7.8 backport #58876", "createdAt": "2020-07-01T16:49:06Z", "url": "https://github.com/elastic/elasticsearch/pull/58865", "merged": true, "mergeCommit": {"oid": "39c1244b7bd3d0140c89b6aecfc1c93f433e6da6"}, "closed": true, "closedAt": "2020-07-01T18:34:03Z", "author": {"login": "lockewritesdocs"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwtFp0gH2gAyNDQyODE5NDg3OjM3OTJkYTVhZDcyMjI2ZTM5MDU2MDhjN2Y2YTZkNDU5ODFhNjQ0YmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwuLYtgH2gAyNDQyODE5NDg3OjczMTE2NjNiZjZlNWRmYjA1ZjZkOGYzMzk1NWZhM2M0ZTQyODk2MzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3792da5ad72226e3905608c7f6a6d45981a644be", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/3792da5ad72226e3905608c7f6a6d45981a644be", "committedDate": "2020-07-01T16:46:21Z", "message": "[DOCS] Adding delete snapshot API docs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "290d22acb63a9dffed9a78b855cd09ca7b590319", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/290d22acb63a9dffed9a78b855cd09ca7b590319", "committedDate": "2020-07-01T17:18:56Z", "message": "Adding TESTSETUP snippets and fixing original TEST."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/8e72065110091a6c4a0c8e23a3b092ac0631f501", "committedDate": "2020-07-01T17:31:06Z", "message": "Removing extraneous TESTSETUP."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMDY3MzU0", "url": "https://github.com/elastic/elasticsearch/pull/58865#pullrequestreview-441067354", "createdAt": "2020-07-01T17:30:56Z", "commit": {"oid": "290d22acb63a9dffed9a78b855cd09ca7b590319"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzozMDo1NlrOGrvIOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzozMDo1NlrOGrvIOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxNDEwNw==", "bodyText": "This is a little confusing with the explicit mentioning of the unique name requirement. Maybe just say something along the lines of \"comma separated list of snapshot names to delete, accepts wild cards\"?", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448514107", "createdAt": "2020-07-01T17:30:56Z", "author": {"login": "original-brownbear"}, "path": "docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,92 @@\n+[[delete-snapshot-api]]\n+=== Delete snapshot API\n+++++\n+<titleabbrev>Delete snapshot</titleabbrev>\n+++++\n+\n+Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n+indices.\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository\n+{\n+  \"type\": \"fs\",\n+  \"settings\": {\n+    \"location\": \"my_backup_location\"\n+  }\n+}\n+----\n+// TESTSETUP\n+////\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository/snapshot_2?wait_for_completion=true\n+{\n+  \"indices\": [],\n+  \"ignore_unavailable\": true,\n+  \"include_global_state\": false,\n+  \"metadata\": {\n+    \"taken_by\": \"user123\",\n+    \"taken_because\": \"backup\"\n+  }\n+}\n+// TESTSETUP\n+////\n+\n+[source,console]\n+-----------------------------------\n+DELETE /_snapshot/my_repository/my_snapshot\n+-----------------------------------\n+// TEST[s/my_snapshot/my_snapshot]\n+\n+[[delete-snapshot-api-request]]\n+==== {api-request-title}\n+\n+`DELETE /_snapshot/<repository>/<snapshot>`\n+\n+[[delete-snapshot-api-desc]]\n+==== {api-description-title}\n+\n+Use the delete snapshot API to delete a <<snapshot-restore,snapshot>>, which is a backup taken from a running {es} cluster.\n+\n+When deleting a snapshot from a repository, {es} deletes all files that are associated with the snapshot and not used by any other snapshots. All files that are shared with at least one other existing snapshot are left intact.\n+\n+If you attempt to delete a snapshot while it is being created, the snapshot process aborts and all associated will be deleted.\n+\n+To delete multiple snapshots in a single request, separate the snapshot names with a comma or use a wildcard (`*`).\n+\n+TIP: Use the delete snapshot API to cancel long-running snapshot operations that were started by mistake.\n+\n+[[delete-snapshot-api-path-params]]\n+==== {api-path-parms-title}\n+\n+`<repository>`::\n+(Required, string)\n+Name of the repository to delete a snapshot from.\n+\n+`<snapshot>`::\n+(Required, string)\n+Name of the snapshot to delete. This name must be unique in the snapshot repository.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "290d22acb63a9dffed9a78b855cd09ca7b590319"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0585c4e50a2964cc5df940836091d0ee7cc58e3", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/e0585c4e50a2964cc5df940836091d0ee7cc58e3", "committedDate": "2020-07-01T17:35:52Z", "message": "Revising <snapshot> description."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMDY5Mjg2", "url": "https://github.com/elastic/elasticsearch/pull/58865#pullrequestreview-441069286", "createdAt": "2020-07-01T17:33:57Z", "commit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzozMzo1N1rOGrvObg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNzo0Mjo1N1rOGrvgtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxNTY5NA==", "bodyText": "I don't think the snapshot contents are particularly relevant here.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n          \n          \n            \n            indices.\n          \n          \n            \n            Deletes a <<snapshot-restore,snapshot>>.", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448515694", "createdAt": "2020-07-01T17:33:57Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,76 @@\n+[[delete-snapshot-api]]\n+=== Delete snapshot API\n+++++\n+<titleabbrev>Delete snapshot</titleabbrev>\n+++++\n+\n+Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n+indices.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxNjU2MA==", "bodyText": "You need to create the my_snapshot, snapshot_2, and snapshot_3 snapshots so you can delete them later.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ----\n          \n          \n            \n            // TESTSETUP\n          \n          \n            \n            ////\n          \n          \n            \n            \n          \n          \n            \n            PUT /_snapshot/my_repository/my_snapshot?wait_for_completion=true\n          \n          \n            \n            \n          \n          \n            \n            PUT /_snapshot/my_repository/snapshot_2?wait_for_completion=true\n          \n          \n            \n            \n          \n          \n            \n            PUT /_snapshot/my_repository/snapshot_3?wait_for_completion=true\n          \n          \n            \n            ----\n          \n          \n            \n            // TESTSETUP\n          \n          \n            \n            ////", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448516560", "createdAt": "2020-07-01T17:35:37Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,76 @@\n+[[delete-snapshot-api]]\n+=== Delete snapshot API\n+++++\n+<titleabbrev>Delete snapshot</titleabbrev>\n+++++\n+\n+Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n+indices.\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository\n+{\n+  \"type\": \"fs\",\n+  \"settings\": {\n+    \"location\": \"my_backup_location\"\n+  }\n+}\n+----\n+// TESTSETUP\n+////", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxNjgxMg==", "bodyText": "I don't think this // TEST comment does anything. You can probably remove it.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            // TEST[s/my_snapshot/my_snapshot]", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448516812", "createdAt": "2020-07-01T17:36:05Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,76 @@\n+[[delete-snapshot-api]]\n+=== Delete snapshot API\n+++++\n+<titleabbrev>Delete snapshot</titleabbrev>\n+++++\n+\n+Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n+indices.\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository\n+{\n+  \"type\": \"fs\",\n+  \"settings\": {\n+    \"location\": \"my_backup_location\"\n+  }\n+}\n+----\n+// TESTSETUP\n+////\n+\n+[source,console]\n+-----------------------------------\n+DELETE /_snapshot/my_repository/my_snapshot\n+-----------------------------------\n+// TEST[s/my_snapshot/my_snapshot]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUxNzYxMw==", "bodyText": "Technically, you can do both. DELETE /_snapshot/my_repository/test1*,*test2* should be valid.", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448517613", "createdAt": "2020-07-01T17:37:39Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,76 @@\n+[[delete-snapshot-api]]\n+=== Delete snapshot API\n+++++\n+<titleabbrev>Delete snapshot</titleabbrev>\n+++++\n+\n+Deletes a <<snapshot-restore,snapshot>> of a cluster or specified data streams and\n+indices.\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository\n+{\n+  \"type\": \"fs\",\n+  \"settings\": {\n+    \"location\": \"my_backup_location\"\n+  }\n+}\n+----\n+// TESTSETUP\n+////\n+\n+[source,console]\n+-----------------------------------\n+DELETE /_snapshot/my_repository/my_snapshot\n+-----------------------------------\n+// TEST[s/my_snapshot/my_snapshot]\n+\n+[[delete-snapshot-api-request]]\n+==== {api-request-title}\n+\n+`DELETE /_snapshot/<repository>/<snapshot>`\n+\n+[[delete-snapshot-api-desc]]\n+==== {api-description-title}\n+\n+Use the delete snapshot API to delete a <<snapshot-restore,snapshot>>, which is a backup taken from a running {es} cluster.\n+\n+When deleting a snapshot from a repository, {es} deletes all files that are associated with the snapshot and not used by any other snapshots. All files that are shared with at least one other existing snapshot are left intact.\n+\n+If you attempt to delete a snapshot while it is being created, the snapshot process aborts and all associated will be deleted.\n+\n+To delete multiple snapshots in a single request, separate the snapshot names with a comma or use a wildcard (`*`).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e72065110091a6c4a0c8e23a3b092ac0631f501"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODUyMDM3Mg==", "bodyText": "Not a blocker for this PR, but we should probably discuss whether we want APIs to be sorted alphabetically or not in the docs.\nThe order you have here makes sense to me, but it doesn't work for every API suite. You mind raising this in the next ES writers meeting?", "url": "https://github.com/elastic/elasticsearch/pull/58865#discussion_r448520372", "createdAt": "2020-07-01T17:42:57Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc", "diffHunk": "@@ -15,21 +15,22 @@ content may not be included yet.\n [discrete]\n [[snapshot-restore-repo-apis]]\n === Snapshot repository management APIs\n-\n-* <<clean-up-snapshot-repo-api,Clean up snapshot repository>>\n-* <<delete-snapshot-repo-api,Delete snapshot repository>>\n-* <<get-snapshot-repo-api,Get snapshot repository>>\n * <<put-snapshot-repo-api,Put snapshot repository>>\n * <<verify-snapshot-repo-api,Verify snapshot repository>>\n+* <<get-snapshot-repo-api,Get snapshot repository>>\n+* <<delete-snapshot-repo-api,Delete snapshot repository>>\n+* <<clean-up-snapshot-repo-api,Clean up snapshot repository>>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0585c4e50a2964cc5df940836091d0ee7cc58e3"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d5795cb6152f1db107b7bdf9adb448d62f1d99d", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/0d5795cb6152f1db107b7bdf9adb448d62f1d99d", "committedDate": "2020-07-01T17:44:29Z", "message": "Removing TEST."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c589fdfd446acc1c7b174b0f4b01b0730563a111", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/c589fdfd446acc1c7b174b0f4b01b0730563a111", "committedDate": "2020-07-01T17:54:32Z", "message": "Streamline delete API description.\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7311663bf6e5dfb05f6d8f33955fa3c4e4289633", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/7311663bf6e5dfb05f6d8f33955fa3c4e4289633", "committedDate": "2020-07-01T18:02:31Z", "message": "Improve TESTSETUP for snippets\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2492, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}