{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4Mzg0NTkx", "number": 59444, "title": "Convert most OSS plugins from integTest to [yaml | java]RestTest or internalClusterTest", "bodyText": "For all OSS plugins (except repository-* and discovery-*) integTest\ntask is now a no-op and all of the tests are now executed via a test,\nyamlRestTest, javaRestTest, or internalClusterTest.\nThis commit does NOT convert the discovery-* and repository-* since they\nare bit more complex then the rest of tests and this PR is large enough.\nThose plugins will be addressed in a future PR(s).\nThis commit also fixes a minor issue that did not copy the rest api\nfor projects that only had YAML TEST tests.\nrelated: #56841", "createdAt": "2020-07-13T17:13:57Z", "url": "https://github.com/elastic/elasticsearch/pull/59444", "merged": true, "mergeCommit": {"oid": "10be5d4c79eeaf0243401e2b21350fbd6d68160a"}, "closed": true, "closedAt": "2020-07-28T21:43:17Z", "author": {"login": "jakelandis"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcz-7nZgH2gAyNDQ4Mzg0NTkxOjM3NmRiNDIyMTkwOGJmYjI5ZDVkODdkMmE2ZTE1YTdhMGY4ODljYTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5csmEgH2gAyNDQ4Mzg0NTkxOjE4MzJlNzk3YTJmMGYxM2YyZGI2NTJkMGNhOWNjOWEzNjgxYTExMzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "376db4221908bfb29d5d87d2a6e15a7a0f889ca5", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/376db4221908bfb29d5d87d2a6e15a7a0f889ca5", "committedDate": "2020-07-11T21:15:27Z", "message": "start of migration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e56bb3f943612b86956095adbc0370cbd8335a9", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/1e56bb3f943612b86956095adbc0370cbd8335a9", "committedDate": "2020-07-11T22:02:58Z", "message": "fix annoyning bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "424fd5efd1420c1f88659f047b8999ebed6122c6", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/424fd5efd1420c1f88659f047b8999ebed6122c6", "committedDate": "2020-07-13T17:01:15Z", "message": "more conversion, ignore repository and store for now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fd84d2cadc6ebcb4487b2960c5152fe9cd021ed", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/5fd84d2cadc6ebcb4487b2960c5152fe9cd021ed", "committedDate": "2020-07-13T17:01:40Z", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa96ed806df8d4eb6341580da8b700d8923d2838", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/aa96ed806df8d4eb6341580da8b700d8923d2838", "committedDate": "2020-07-13T17:08:30Z", "message": "remove temporary code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/dfebc85902546bcc643cffb3979ac4541e14c2ed", "committedDate": "2020-07-13T17:11:18Z", "message": "remove unecessary todo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NDQ0NDcw", "url": "https://github.com/elastic/elasticsearch/pull/59444#pullrequestreview-447444470", "createdAt": "2020-07-13T17:14:39Z", "commit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxNzoxNDozOVrOGwx-VA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxNzoxNDozOVrOGwx-VA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwMzYwNA==", "bodyText": "this is needed since the yamlRestRest does not have access to that class", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r453803604", "createdAt": "2020-07-13T17:14:39Z", "author": {"login": "jakelandis"}, "path": "plugins/analysis-icu/build.gradle", "diffHunk": "@@ -18,17 +18,19 @@ import de.thetaphi.forbiddenapis.gradle.CheckForbiddenApis\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n \n esplugin {\n   description 'The ICU Analysis plugin integrates the Lucene ICU module into Elasticsearch, adding ICU-related analysis components.'\n   classname 'org.elasticsearch.plugin.analysis.icu.AnalysisICUPlugin'\n }\n \n-tasks.withType(CheckForbiddenApis).configureEach {\n-  signatures += [\n-    \"com.ibm.icu.text.Collator#getInstance() @ Don't use default locale, use getInstance(ULocale) instead\"\n-  ]\n+tasks.withType(CheckForbiddenApis).configureEach { task ->\n+  if(task.name.contains(\"YamlRestTest\") == false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2be2c71a68c4ceacdd2be5c90c95da5700f05963", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/2be2c71a68c4ceacdd2be5c90c95da5700f05963", "committedDate": "2020-07-13T17:15:38Z", "message": "remove unecessary todo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c603b8024dd8a41bdb393adf730ed534030a546d", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/c603b8024dd8a41bdb393adf730ed534030a546d", "committedDate": "2020-07-13T17:57:50Z", "message": "remove rouge plugin defintion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MjU4MDE0", "url": "https://github.com/elastic/elasticsearch/pull/59444#pullrequestreview-448258014", "createdAt": "2020-07-14T16:14:21Z", "commit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNjoxNDoyMlrOGxa9XA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNjoxNToyOFrOGxbARQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTEwMA==", "bodyText": "Maybe this should be explicit, applying the signature to forbiddanApisMain and forbiddenApisTest, rather than all CheckForbiddenApis tasks? We are likely to continue adding more source sets in the future, so having configuration apply to all source sets would be problematic.", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475100", "createdAt": "2020-07-14T16:14:22Z", "author": {"login": "rjernst"}, "path": "plugins/analysis-icu/build.gradle", "diffHunk": "@@ -18,17 +18,19 @@ import de.thetaphi.forbiddenapis.gradle.CheckForbiddenApis\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n \n esplugin {\n   description 'The ICU Analysis plugin integrates the Lucene ICU module into Elasticsearch, adding ICU-related analysis components.'\n   classname 'org.elasticsearch.plugin.analysis.icu.AnalysisICUPlugin'\n }\n \n-tasks.withType(CheckForbiddenApis).configureEach {\n-  signatures += [\n-    \"com.ibm.icu.text.Collator#getInstance() @ Don't use default locale, use getInstance(ULocale) instead\"\n-  ]\n+tasks.withType(CheckForbiddenApis).configureEach { task ->\n+  if(task.name.contains(\"YamlRestTest\") == false) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwMzYwNA=="}, "originalCommit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTM2MA==", "bodyText": "Why is this being disabled?", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475360", "createdAt": "2020-07-14T16:14:46Z", "author": {"login": "rjernst"}, "path": "plugins/analysis-kuromoji/build.gradle", "diffHunk": "@@ -33,6 +33,8 @@ restResources {\n   }\n }\n \n+integTest.enabled = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTg0NQ==", "bodyText": "Ditto. If we need to disable a test, can we have a comment explaining why it is disabled? Someone coming along in the future will have no reason whether this can/should be re-enabled.", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475845", "createdAt": "2020-07-14T16:15:28Z", "author": {"login": "rjernst"}, "path": "plugins/analysis-nori/build.gradle", "diffHunk": "@@ -32,6 +32,9 @@ restResources {\n     includeCore '_common', 'indices', 'index', 'search'\n   }\n }\n+\n+integTest.enabled = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbc08f93a46cb1a288969190c1becd0bcc0fea24", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/bbc08f93a46cb1a288969190c1becd0bcc0fea24", "committedDate": "2020-07-21T22:38:36Z", "message": "Merge branch 'master' into yamlRestTest_plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9a34d9fc3b175fef59909e9d7ac4d4da7c1acbf", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/a9a34d9fc3b175fef59909e9d7ac4d4da7c1acbf", "committedDate": "2020-07-21T22:50:25Z", "message": "remove (now) unneccessary integTest.enabled=false"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c75412f830b1ea938bbfee39b2a20c4bc6f90d8", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/5c75412f830b1ea938bbfee39b2a20c4bc6f90d8", "committedDate": "2020-07-21T23:10:13Z", "message": "fix forbiden API and move test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fab21b807cb74ea2a88ded8b61d9fe927400a38", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/2fab21b807cb74ea2a88ded8b61d9fe927400a38", "committedDate": "2020-07-22T15:30:03Z", "message": "more migration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc095507ad6171aa18f626939ad1c1002eacd214", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/cc095507ad6171aa18f626939ad1c1002eacd214", "committedDate": "2020-07-22T16:15:47Z", "message": "finish examples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd76cf49743da978d4576ef858e164cd14779c01", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/cd76cf49743da978d4576ef858e164cd14779c01", "committedDate": "2020-07-22T16:28:18Z", "message": "more"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a2d639bec119eafec0a8fe83d72191d372e1f99", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a2d639bec119eafec0a8fe83d72191d372e1f99", "committedDate": "2020-07-22T16:44:13Z", "message": "repository-azure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8682017cb5b923327864e53fe781bd7024b4e870", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/8682017cb5b923327864e53fe781bd7024b4e870", "committedDate": "2020-07-22T17:09:39Z", "message": "repository-gcs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a1d8c865159caafb08e44721f3a9682d2fda477", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a1d8c865159caafb08e44721f3a9682d2fda477", "committedDate": "2020-07-22T18:37:09Z", "message": "repository-s3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9414e3dfe7933c4c34716f8cb55f3de68382fd88", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/9414e3dfe7933c4c34716f8cb55f3de68382fd88", "committedDate": "2020-07-22T18:41:44Z", "message": "store-smb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2cf390cbe195d078bcd42cfdfa528e2c81f6c50", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/f2cf390cbe195d078bcd42cfdfa528e2c81f6c50", "committedDate": "2020-07-22T18:48:53Z", "message": "transport-nio"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21cc84a4ecb827d78b8979fbf3bf0bc6a7359222", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/21cc84a4ecb827d78b8979fbf3bf0bc6a7359222", "committedDate": "2020-07-22T18:59:50Z", "message": "Revert \"repository-s3\"\n\nThis reverts commit 4a1d8c865159caafb08e44721f3a9682d2fda477."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebb6703ccd642ab7505bb86a822b4995fa705a11", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/ebb6703ccd642ab7505bb86a822b4995fa705a11", "committedDate": "2020-07-22T19:00:02Z", "message": "Revert \"repository-gcs\"\n\nThis reverts commit 8682017cb5b923327864e53fe781bd7024b4e870."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6147473b2d1993acc4a8b13f2b78f9f307b949e4", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/6147473b2d1993acc4a8b13f2b78f9f307b949e4", "committedDate": "2020-07-22T19:00:11Z", "message": "Revert \"repository-azure\"\n\nThis reverts commit 4a2d639bec119eafec0a8fe83d72191d372e1f99."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05e9421bb846e44c7ff229e329f3946fe8b04615", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/05e9421bb846e44c7ff229e329f3946fe8b04615", "committedDate": "2020-07-22T19:00:29Z", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "885c84adb08116efbcbff1b3fc4b619f7887583b", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/885c84adb08116efbcbff1b3fc4b619f7887583b", "committedDate": "2020-07-22T19:14:59Z", "message": "minor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ea875a6179de15305825d38e53a20218b6158eb", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/4ea875a6179de15305825d38e53a20218b6158eb", "committedDate": "2020-07-22T19:24:49Z", "message": "manually rollback discovery-* changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea705a55a10d685ec52f7d2675ff2e4a070d45f4", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/ea705a55a10d685ec52f7d2675ff2e4a070d45f4", "committedDate": "2020-07-22T19:28:20Z", "message": "white space change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/c89b5de16f777a00a7be76280565debd6014728f", "committedDate": "2020-07-22T19:30:25Z", "message": "more nits"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNzA4Nzc2", "url": "https://github.com/elastic/elasticsearch/pull/59444#pullrequestreview-453708776", "createdAt": "2020-07-22T21:46:28Z", "commit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMTo0NjoyOFrOG11ZTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMTo1MToxMlrOG11h1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjU0Mg==", "bodyText": "What's the purpose of this of this intermediary variable?", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459102542", "createdAt": "2020-07-22T21:46:28Z", "author": {"login": "mark-vieira"}, "path": "plugins/analysis-icu/build.gradle", "diffHunk": "@@ -18,17 +18,20 @@ import de.thetaphi.forbiddenapis.gradle.CheckForbiddenApis\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n+apply plugin: 'elasticsearch.internal-cluster-test'\n \n esplugin {\n   description 'The ICU Analysis plugin integrates the Lucene ICU module into Elasticsearch, adding ICU-related analysis components.'\n   classname 'org.elasticsearch.plugin.analysis.icu.AnalysisICUPlugin'\n }\n \n-tasks.withType(CheckForbiddenApis).configureEach {\n-  signatures += [\n-    \"com.ibm.icu.text.Collator#getInstance() @ Don't use default locale, use getInstance(ULocale) instead\"\n-  ]\n+List<String> forbidden_signatures = new ArrayList<>([", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjk1Ng==", "bodyText": "Is there a reason this needs to be all and not just yamlRestTest? Isn't there just one test cluster in play here?", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459102956", "createdAt": "2020-07-22T21:47:23Z", "author": {"login": "mark-vieira"}, "path": "plugins/examples/custom-settings/build.gradle", "diffHunk": "@@ -28,7 +27,8 @@ esplugin {\n   noticeFile rootProject.file('NOTICE.txt')\n }\n \n-testClusters.integTest {\n+testClusters.all {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMzI2MQ==", "bodyText": "Should be dependsOn sourceSets.javaRestTest.runtimeClasspath.", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459103261", "createdAt": "2020-07-22T21:48:02Z", "author": {"login": "mark-vieira"}, "path": "plugins/examples/rest-handler/build.gradle", "diffHunk": "@@ -34,21 +34,16 @@ esplugin {\n test.enabled = false\n \n tasks.register(\"exampleFixture\", org.elasticsearch.gradle.test.AntFixture) {\n-  dependsOn testClasses\n-  env 'CLASSPATH', \"${-> project.sourceSets.test.runtimeClasspath.asPath}\"\n+  dependsOn javaRestTestClasses", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDM2Ng==", "bodyText": "Why is this necessary here but not done by default in the java rest test plugin?\nSince this is an example project we should use idiomatic patterns as much as possible. If this is required because of some kind of nasty test implementation we should refactor this.\n@rjernst thoughts? As I understand it a Java REST test should be no different than a YAML one in that the only interactions should be via the REST API, therefore there should be no need for plugin code itself to be on the test classpath.", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459104366", "createdAt": "2020-07-22T21:50:27Z", "author": {"login": "mark-vieira"}, "path": "plugins/examples/security-authorization-engine/build.gradle", "diffHunk": "@@ -11,19 +12,24 @@ esplugin {\n   noticeFile rootProject.file('NOTICE.txt')\n }\n \n+// let the javaRestTest see the classpath of main\n+GradleUtils.extendSourceSet(project, \"main\", \"javaRestTest\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDcyNg==", "bodyText": "I thought we ditched the need for this?", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459104726", "createdAt": "2020-07-22T21:51:12Z", "author": {"login": "mark-vieira"}, "path": "plugins/transport-nio/build.gradle", "diffHunk": "@@ -19,12 +19,15 @@ import org.elasticsearch.gradle.info.BuildParams\n  * under the License.\n  */\n apply plugin: \"elasticsearch.publish\"\n+apply plugin: 'elasticsearch.internal-cluster-test'\n \n esplugin {\n   description 'The nio transport.'\n   classname 'org.elasticsearch.transport.nio.NioTransportPlugin'\n }\n \n+// integTest have been converted to internalClusterTest \n+integTest.enabled = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c89b5de16f777a00a7be76280565debd6014728f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "849d19db73f47c21baaa3cb591d28521bd9e6294", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/849d19db73f47c21baaa3cb591d28521bd9e6294", "committedDate": "2020-07-23T19:02:29Z", "message": "runtimeClasspath and unecessary variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef3466837535242c2d0c4be28241bde6ff2af951", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/ef3466837535242c2d0c4be28241bde6ff2af951", "committedDate": "2020-07-23T19:21:27Z", "message": "remove GradleUtils from build script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b07432091ce83d196016d0c21a30b60cc67e925", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/7b07432091ce83d196016d0c21a30b60cc67e925", "committedDate": "2020-07-27T18:07:54Z", "message": "Merge branch 'master' into yamlRestTest_plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8058400bbf69503f53d9c7292ac740dd6c54e55f", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/8058400bbf69503f53d9c7292ac740dd6c54e55f", "committedDate": "2020-07-27T21:52:24Z", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1832e797a2f0f13f2db652d0ca9cc9a3681a1135", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/1832e797a2f0f13f2db652d0ca9cc9a3681a1135", "committedDate": "2020-07-28T20:45:49Z", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4429, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}