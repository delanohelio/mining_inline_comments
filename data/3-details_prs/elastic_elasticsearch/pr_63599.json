{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMTc5NTEx", "number": 63599, "title": "Provide an extract only distribution configuration for bwc configurations", "bodyText": "This PR provides a configuration that can be used for bwc setups that allows\nbwc setups to create an extracted bwc version es distribution without creating a tar\nconfiguration as done by the default assemble configuration\nA later PR will change the bwc setup configuration to rely on this extractedAssemble\nconfiguration when building distributions for bwc testing.\nOne step closer to finish off #62115", "createdAt": "2020-10-13T10:31:47Z", "url": "https://github.com/elastic/elasticsearch/pull/63599", "merged": true, "mergeCommit": {"oid": "11d7ad2733a4ee05586dd21cefc44e1de4c35fdd"}, "closed": true, "closedAt": "2020-12-04T11:34:18Z", "author": {"login": "breskeby"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSg3jngFqTUwODU4NjU1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdie8aeABqjQwNjYxNzYxOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NTg2NTU5", "url": "https://github.com/elastic/elasticsearch/pull/63599#pullrequestreview-508586559", "createdAt": "2020-10-14T17:45:25Z", "commit": {"oid": "7973156e4bc274470e49bf2de2f50fbf6d57ee4e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo0NToyNVrOHheOcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo0NToyNVrOHheOcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2MDI3NA==", "bodyText": "Doesn't just depending on the configuration itself work? Why the need to explicitly reference the build dependencies?", "url": "https://github.com/elastic/elasticsearch/pull/63599#discussion_r504860274", "createdAt": "2020-10-14T17:45:25Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionArchiveSetupPlugin.java", "diffHunk": "@@ -85,11 +87,16 @@ private void registerAndConfigureDistributionArchivesExtension(Project project)\n             project.project(subProjectName, sub -> {\n                 sub.getPlugins().apply(BasePlugin.class);\n                 sub.getArtifacts().add(DEFAULT_CONFIGURATION_NAME, distributionArchive.getArchiveTask());\n-                var extractedConfiguration = sub.getConfigurations().create(\"extracted\");\n+                var extractedConfiguration = sub.getConfigurations().create(EXTRACTED_CONFIGURATION_NAME);\n                 extractedConfiguration.setCanBeResolved(false);\n                 extractedConfiguration.getAttributes().attribute(ARTIFACT_FORMAT, ArtifactTypeDefinition.DIRECTORY_TYPE);\n                 sub.getArtifacts().add(EXTRACTED_CONFIGURATION_NAME, distributionArchive.getExpandedDistTask());\n-\n+                sub.getTasks().register(\"extractedAssemble\", new Action<Task>() {\n+                    @Override\n+                    public void execute(Task task) {\n+                        task.dependsOn(extractedConfiguration.getAllArtifacts().getBuildDependencies());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7973156e4bc274470e49bf2de2f50fbf6d57ee4e"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7973156e4bc274470e49bf2de2f50fbf6d57ee4e", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/7973156e4bc274470e49bf2de2f50fbf6d57ee4e", "committedDate": "2020-10-13T10:31:13Z", "message": "An extracted dist only configuration for bwc test setup is available\n\nThis PR provides a configuration that can be used for bwc setups that allows\nbwc setups to create an extracted bwc version es distribution without creating a tar\nconfiguration as done by the default _assemble_ configuration\n\nA later PR will change the bwc setup configuration to rely on this extractedAssemble\nconfiguration when building distributions for bwc testing"}, "afterCommit": {"oid": "f195ef9ee0c84bd1e51dd479242b77fe0cf22885", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/f195ef9ee0c84bd1e51dd479242b77fe0cf22885", "committedDate": "2020-12-02T10:19:16Z", "message": "Some minor polishing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62d89fab83c69ea73b75a2346dba5f2abdb656fd", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/62d89fab83c69ea73b75a2346dba5f2abdb656fd", "committedDate": "2020-12-02T13:28:41Z", "message": "An extracted dist only configuration for bwc test setup is available\n\nThis PR provides a configuration that can be used for bwc setups that allows\nbwc setups to create an extracted bwc version es distribution without creating a tar\nconfiguration as done by the default _assemble_ configuration\n\nA later PR will change the bwc setup configuration to rely on this extractedAssemble\nconfiguration when building distributions for bwc testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc09dcbae198d22a4b1fcfe6d6bfe4a47c5fac8e", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/fc09dcbae198d22a4b1fcfe6d6bfe4a47c5fac8e", "committedDate": "2020-12-02T13:28:42Z", "message": "Some minor polishing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6a4f2b7a3edec0bcf4625bc9c2ddd3c44abad7e", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/b6a4f2b7a3edec0bcf4625bc9c2ddd3c44abad7e", "committedDate": "2020-12-02T13:28:42Z", "message": "Make spotless happy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6996337cc7f3cdb4a202f678821f4a2437607a2d", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/6996337cc7f3cdb4a202f678821f4a2437607a2d", "committedDate": "2020-12-02T10:26:32Z", "message": "Make spotless happy"}, "afterCommit": {"oid": "b6a4f2b7a3edec0bcf4625bc9c2ddd3c44abad7e", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/b6a4f2b7a3edec0bcf4625bc9c2ddd3c44abad7e", "committedDate": "2020-12-02T13:28:42Z", "message": "Make spotless happy"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4087, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}