{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MzYwNzEy", "number": 54751, "title": "[DOCS] Edits create data frame analytics job API", "bodyText": "This PR updates the create data frame analytics job API (https://www.elastic.co/guide/en/elasticsearch/reference/master/put-dfanalytics.html) related to the addition of multiclass classification. For example, it updates the dependent_variable and num_top_classes definitions.\nIt also edits some existing unrelated content. For example, it comments out hyperparameter optimization details that are moving in elastic/stack-docs#990 and it moves details about mappings from the create DFA job API to the start DFA job API.\nPreview:\n\nhttp://elasticsearch_54751.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/put-dfanalytics.html\nhttp://elasticsearch_54751.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/start-dfanalytics.html", "createdAt": "2020-04-03T20:02:34Z", "url": "https://github.com/elastic/elasticsearch/pull/54751", "merged": true, "mergeCommit": {"oid": "998a085c148d496e1d5d010c1db22edf003d2e3c"}, "closed": true, "closedAt": "2020-04-13T16:58:04Z", "author": {"login": "lcawl"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcU5nl0AFqTM4Nzk5NDg1MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXQp7UgH2gAyMzk4MzYwNzEyOjYxZTVmZDNmMjM5MzhlZTE1OTk1MmI5ZjBjMDA4NDNkZjJjNzgyMDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3OTk0ODUw", "url": "https://github.com/elastic/elasticsearch/pull/54751#pullrequestreview-387994850", "createdAt": "2020-04-06T07:31:00Z", "commit": {"oid": "d840c811a97b6cac3b97b81b7ef14648bb88e0c2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNzozMTowMFrOGBLBEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNzozMTowMFrOGBLBEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjI1Nw==", "bodyText": "We copy the mappings to the dest index when the _start API is called. Indeed, if the mappings are conflicted, the start API fails with an error. But during job creation we don't check.", "url": "https://github.com/elastic/elasticsearch/pull/54751#discussion_r403882257", "createdAt": "2020-04-06T07:31:00Z", "author": {"login": "dimitris-athanasiou"}, "path": "docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc", "diffHunk": "@@ -46,19 +46,17 @@ instead of the primary headers.\n This API creates a {dfanalytics-job} that performs an analysis on the source \n index and stores the outcome in a destination index.\n \n-The destination index will be automatically created if it does not exist. The \n+If it does not exist, the destination index is created automatically. The \n `index.number_of_shards` and `index.number_of_replicas` settings of the source \n-index will be copied over the destination index. When the source index matches \n-multiple indices, these settings will be set to the maximum values found in the \n-source indices.\n+index are copied over the destination index. When the source index matches \n+multiple indices, these settings are set to the maximum values found in the \n+source indices. The mappings of the source indices are also copied over to the\n+destination index. If the mappings of any of the fields don't match the source\n+indices, however, the attempt fails with an error message.\n+//TBD Does this cause the job creation to fail? What are the implications?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d840c811a97b6cac3b97b81b7ef14648bb88e0c2"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "686267b479726df0595a6e36d231a6acf1be7036", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/686267b479726df0595a6e36d231a6acf1be7036", "committedDate": "2020-04-07T23:23:54Z", "message": "[DOCS] Edits create data frame analytics jobs API"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1f1e317aeb71c69220fa86db903daa8d0af8686", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/c1f1e317aeb71c69220fa86db903daa8d0af8686", "committedDate": "2020-04-07T23:04:19Z", "message": "[DOCS] Edits create DF analytics API"}, "afterCommit": {"oid": "686267b479726df0595a6e36d231a6acf1be7036", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/686267b479726df0595a6e36d231a6acf1be7036", "committedDate": "2020-04-07T23:23:54Z", "message": "[DOCS] Edits create data frame analytics jobs API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NzMyMDgz", "url": "https://github.com/elastic/elasticsearch/pull/54751#pullrequestreview-389732083", "createdAt": "2020-04-08T07:52:22Z", "commit": {"oid": "686267b479726df0595a6e36d231a6acf1be7036"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNzo1MjoyM1rOGCjKLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNzo1MjoyM1rOGCjKLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMyNjM4MQ==", "bodyText": "@tveasey Could you help us clarify this please?", "url": "https://github.com/elastic/elasticsearch/pull/54751#discussion_r405326381", "createdAt": "2020-04-08T07:52:23Z", "author": {"login": "dimitris-athanasiou"}, "path": "docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc", "diffHunk": "@@ -27,57 +27,46 @@ built-in roles and privileges:\n * `kibana_admin` (UI only)\n \n \n-* source index: `read`, `view_index_metadata`\n+* source indices: `read`, `view_index_metadata`\n * destination index: `read`, `create_index`, `manage` and `index`\n * cluster: `monitor` (UI only)\n   \n For more information, see <<security-privileges>> and <<built-in-roles>>.\n \n-+\n---\n NOTE: It is possible that secondary authorization headers are supplied in the\n request. If this is the case, the secondary authorization headers are used\n instead of the primary headers.\n---\n \n [[ml-put-dfanalytics-desc]]\n ==== {api-description-title}\n \n This API creates a {dfanalytics-job} that performs an analysis on the source \n-index and stores the outcome in a destination index.\n-\n-The destination index will be automatically created if it does not exist. The \n-`index.number_of_shards` and `index.number_of_replicas` settings of the source \n-index will be copied over the destination index. When the source index matches \n-multiple indices, these settings will be set to the maximum values found in the \n-source indices.\n-\n-The mappings of the source indices are also attempted to be copied over\n-to the destination index, however, if the mappings of any of the fields don't \n-match among the source indices, the attempt will fail with an error message.\n-\n-If the destination index already exists, then it will be use as is. This makes \n-it possible to set up the destination index in advance with custom settings \n-and mappings.\n-\n-[discrete]\n-[[ml-hyperparam-optimization]]\n-===== Hyperparameter optimization\n-\n-If you don't supply {regression} or {classification} parameters, _hyperparameter \n-optimization_ occurs, which sets a value for the undefined parameters. The\n-starting point is calculated for data dependent parameters by examining the loss\n+indices and stores the outcome in a destination index.\n+\n+If the destination index does not exist, it is created automatically when you\n+start the job. See <<start-dfanalytics>>.\n+\n+If you supply only a subset of the {regression} or {classification} parameters,\n+_hyperparameter optimization_ occurs. It determines a value for each of the\n+undefined parameters. A fixed number of rounds is used for optimization which\n+depends on the number of parameters being optimized.\n+// TBD: Does this \"fixed number of rounds\" sentence mean that the more undefined", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "686267b479726df0595a6e36d231a6acf1be7036"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NzMzNTE5", "url": "https://github.com/elastic/elasticsearch/pull/54751#pullrequestreview-389733519", "createdAt": "2020-04-08T07:54:31Z", "commit": {"oid": "686267b479726df0595a6e36d231a6acf1be7036"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0583bfd6c0efaf7254f6d7905df47c3b53095af", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/d0583bfd6c0efaf7254f6d7905df47c3b53095af", "committedDate": "2020-04-10T00:50:41Z", "message": "[DOCS] Adds classification limit to dependent variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfae344bf9683917394c163457d11753cb7448f3", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/bfae344bf9683917394c163457d11753cb7448f3", "committedDate": "2020-04-10T01:09:15Z", "message": "[DOCS] Fixes link error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjA4NjQw", "url": "https://github.com/elastic/elasticsearch/pull/54751#pullrequestreview-392208640", "createdAt": "2020-04-13T15:13:29Z", "commit": {"oid": "bfae344bf9683917394c163457d11753cb7448f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNToxMzoyOVrOGEprxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNToxMzoyOVrOGEprxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUzMDQzOA==", "bodyText": "typo: double be", "url": "https://github.com/elastic/elasticsearch/pull/54751#discussion_r407530438", "createdAt": "2020-04-13T15:13:29Z", "author": {"login": "dimitris-athanasiou"}, "path": "docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc", "diffHunk": "@@ -111,24 +105,29 @@ The configuration information necessary to perform\n {ml-docs}/dfa-classification.html[{classification}].\n +\n TIP: Advanced parameters are for fine-tuning {classanalysis}. They are set \n-automatically by <<ml-hyperparam-optimization,hyperparameter optimization>> \n-to give minimum validation error. It is highly recommended to use the default \n-values unless you fully understand the function of these parameters.\n+automatically by hyperparameter optimization to give the minimum validation\n+error. It is highly recommended to use the default values unless you fully\n+understand the function of these parameters.\n +\n .Properties of `classification`\n [%collapsible%open]\n =====\n `class_assignment_objective`::::\n (Optional, string)\n-include::{docdir}/ml/ml-shared.asciidoc[tag=class-assignment-objective]\n+Defines the objective to optimize when assigning class labels:\n+`maximize_accuracy` or `maximize_minimum_recall`. When maximizing accuracy,\n+class labels are chosen to maximize the number of correct predictions. When\n+maximizing minimum recall, labels are chosen to maximize the minimum recall for\n+any class. Defaults to `maximize_minimum_recall`.\n \n `dependent_variable`::::\n (Required, string)\n +\n include::{docdir}/ml/ml-shared.asciidoc[tag=dependent-variable]\n +\n The data type of the field must be numeric (`integer`, `short`, `long`, `byte`), \n-categorical (`ip` or `keyword`), or boolean.\n+categorical (`ip` or `keyword`), or boolean. There must be be no more than 30", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfae344bf9683917394c163457d11753cb7448f3"}, "originalPosition": 117}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61e5fd3f23938ee159952b9f0c00843df2c78208", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/elasticsearch/commit/61e5fd3f23938ee159952b9f0c00843df2c78208", "committedDate": "2020-04-13T15:30:37Z", "message": "[DOCS] Fixes typo"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3815, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}