{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTQ3NTM4", "number": 53339, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo1MjozOVrODpRmTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo1MjozOVrODpRmTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjA2NTQxOnYy", "diffSide": "RIGHT", "path": "docs/reference/analysis/token-graphs.asciidoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDo1MjozOVrOF4Wdbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMToyNTo0N1rOF4qSWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYzMjU1OQ==", "bodyText": "match queries are also affected. The input ny city with a ny, new york expansion creates an incorrect (ny OR new) AND york AND city query with the synonym filter.", "url": "https://github.com/elastic/elasticsearch/pull/53339#discussion_r394632559", "createdAt": "2020-03-18T20:52:39Z", "author": {"login": "jimczi"}, "path": "docs/reference/analysis/token-graphs.asciidoc", "diffHunk": "@@ -0,0 +1,104 @@\n+[[token-graphs]]\n+=== Token graphs\n+\n+When a <<analyzer-anatomy-tokenizer,tokenizer>> converts a text into a stream of\n+tokens, it also records the following:\n+\n+* The `position` of each token in the stream\n+* The `positionLength`, the number of positions that a token spans\n+\n+Using these, you can create a\n+https://en.wikipedia.org/wiki/Directed_acyclic_graph[directed acyclic graph],\n+called a _token graph_, for a stream. In a token graph, each position represents\n+a node. Each token represents an edge or arc, pointing to the next position.\n+\n+image::images/analysis/token-graph-qbf-ex.svg[align=\"center\"]\n+\n+[[token-graphs-synonyms]]\n+==== Synonyms\n+\n+Some <<analyzer-anatomy-token-filters,token filters>> can add new tokens, like\n+synonyms, to an existing token stream. These synonyms often span the same\n+positions as existing tokens.\n+\n+In the following graph, `quick` and its synonym `fast` both have a position of\n+`0`. They span the same positions.\n+\n+image::images/analysis/token-graph-qbf-synonym-ex.svg[align=\"center\"]\n+\n+[[token-graphs-multi-position-tokens]]\n+==== Multi-position tokens\n+\n+Some token filters can add tokens that span multiple positions. These can\n+include tokens for multi-word synonyms, such as using \"atm\" as a synonym for\n+\"automatic teller machine.\"\n+\n+However, only some token filters, known as _graph token filters_, accurately\n+record the `positionLength` for multi-position tokens. This filters include:\n+\n+* <<analysis-synonym-graph-tokenfilter,`synonym_graph`>>\n+* <<analysis-word-delimiter-graph-tokenfilter,`word_delimiter_graph`>>\n+\n+In the following graph, `domain name system` and its synonym, `dns`, both have a\n+position of `0`. However, `dns` has a `positionLength` of `3`. Other tokens in\n+the graph have a default `positionLength` of `1`.\n+\n+image::images/analysis/token-graph-dns-synonym-ex.svg[align=\"center\"]\n+\n+[[token-graphs-token-graphs-search]]\n+===== Using token graphs for search \n+\n+<<analysis-index-search-time,Indexing>> ignores the `positionLength` attribute\n+and does not support token graphs containing multi-position tokens.\n+\n+However, queries, such as the <<query-dsl-match-query-phrase,`match_phrase`>>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c88b9e818552b0124597ca89869b9d4bcdad0ced"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk1NzQwMg==", "bodyText": "I updated this with d4a711d to mention the match query.", "url": "https://github.com/elastic/elasticsearch/pull/53339#discussion_r394957402", "createdAt": "2020-03-19T11:25:47Z", "author": {"login": "jrodewig"}, "path": "docs/reference/analysis/token-graphs.asciidoc", "diffHunk": "@@ -0,0 +1,104 @@\n+[[token-graphs]]\n+=== Token graphs\n+\n+When a <<analyzer-anatomy-tokenizer,tokenizer>> converts a text into a stream of\n+tokens, it also records the following:\n+\n+* The `position` of each token in the stream\n+* The `positionLength`, the number of positions that a token spans\n+\n+Using these, you can create a\n+https://en.wikipedia.org/wiki/Directed_acyclic_graph[directed acyclic graph],\n+called a _token graph_, for a stream. In a token graph, each position represents\n+a node. Each token represents an edge or arc, pointing to the next position.\n+\n+image::images/analysis/token-graph-qbf-ex.svg[align=\"center\"]\n+\n+[[token-graphs-synonyms]]\n+==== Synonyms\n+\n+Some <<analyzer-anatomy-token-filters,token filters>> can add new tokens, like\n+synonyms, to an existing token stream. These synonyms often span the same\n+positions as existing tokens.\n+\n+In the following graph, `quick` and its synonym `fast` both have a position of\n+`0`. They span the same positions.\n+\n+image::images/analysis/token-graph-qbf-synonym-ex.svg[align=\"center\"]\n+\n+[[token-graphs-multi-position-tokens]]\n+==== Multi-position tokens\n+\n+Some token filters can add tokens that span multiple positions. These can\n+include tokens for multi-word synonyms, such as using \"atm\" as a synonym for\n+\"automatic teller machine.\"\n+\n+However, only some token filters, known as _graph token filters_, accurately\n+record the `positionLength` for multi-position tokens. This filters include:\n+\n+* <<analysis-synonym-graph-tokenfilter,`synonym_graph`>>\n+* <<analysis-word-delimiter-graph-tokenfilter,`word_delimiter_graph`>>\n+\n+In the following graph, `domain name system` and its synonym, `dns`, both have a\n+position of `0`. However, `dns` has a `positionLength` of `3`. Other tokens in\n+the graph have a default `positionLength` of `1`.\n+\n+image::images/analysis/token-graph-dns-synonym-ex.svg[align=\"center\"]\n+\n+[[token-graphs-token-graphs-search]]\n+===== Using token graphs for search \n+\n+<<analysis-index-search-time,Indexing>> ignores the `positionLength` attribute\n+and does not support token graphs containing multi-position tokens.\n+\n+However, queries, such as the <<query-dsl-match-query-phrase,`match_phrase`>>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYzMjU1OQ=="}, "originalCommit": {"oid": "c88b9e818552b0124597ca89869b9d4bcdad0ced"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3385, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}