{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNjQ2NzE3", "number": 57867, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzoyNjo0N1rOED4JMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzoyNjo0N1rOED4JMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyNTAxMDQyOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/composite/CompositeAggregator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzoyNjo0N1rOGhJtXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNTozMTo1NFrOGhQWFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQxNTI2Mw==", "bodyText": "It's probably worth explaining why. I think it is because the rounding \"squashes\" many values together so we can't get the order of the sub-values by looking at any one key. We'd have to merge all the values that round to that key and get the sub-values from that. And that isn't the kind of this this index sorting optimization does.", "url": "https://github.com/elastic/elasticsearch/pull/57867#discussion_r437415263", "createdAt": "2020-06-09T13:26:47Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/composite/CompositeAggregator.java", "diffHunk": "@@ -231,6 +235,10 @@ private Sort buildIndexSortPrefix(LeafReaderContext context) throws IOException\n                 break;\n             }\n             sortFields.add(indexSortField);\n+            if (sourceConfig.valuesSource() instanceof RoundingValuesSource) {\n+                // rounded values break the index sort", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05013ffc95b6ccedde9998f5ea8f45868ef6b5bc"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUyMzk5MA==", "bodyText": "++, I pushed e486057", "url": "https://github.com/elastic/elasticsearch/pull/57867#discussion_r437523990", "createdAt": "2020-06-09T15:31:54Z", "author": {"login": "jimczi"}, "path": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/composite/CompositeAggregator.java", "diffHunk": "@@ -231,6 +235,10 @@ private Sort buildIndexSortPrefix(LeafReaderContext context) throws IOException\n                 break;\n             }\n             sortFields.add(indexSortField);\n+            if (sourceConfig.valuesSource() instanceof RoundingValuesSource) {\n+                // rounded values break the index sort", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQxNTI2Mw=="}, "originalCommit": {"oid": "05013ffc95b6ccedde9998f5ea8f45868ef6b5bc"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1724, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}