{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1ODUyOTcw", "number": 51307, "title": "[Transform] Handle permanent bulk indexing errors", "bodyText": "check bulk indexing error for permanent problems and ensure the state goes into failed instead of retry. Corrects the stats API to show the real error and avoids excessive audit logging.\nfixes #50122", "createdAt": "2020-01-22T13:26:27Z", "url": "https://github.com/elastic/elasticsearch/pull/51307", "merged": true, "mergeCommit": {"oid": "589e0331d2978c620cce19ee1cbfd6c67673197d"}, "closed": true, "closedAt": "2020-01-23T15:16:28Z", "author": {"login": "hendrikmuhs"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb82CpagH2gAyMzY1ODUyOTcwOmQyYjE3YmY0N2IyY2VjNmJiZTIxYzgyYjk5OGVkMWQyZDVlZGFmMTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9FpPkgH2gAyMzY1ODUyOTcwOjZiOGQyZDZmZjQ0Y2E5ZGViYjE5ZWEwZjk5OGQ1ZTEyOWM1MmI1OTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d2b17bf47b2cec6bbe21c82b998ed1d2d5edaf15", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/d2b17bf47b2cec6bbe21c82b998ed1d2d5edaf15", "committedDate": "2020-01-22T13:48:09Z", "message": "check bulk indexing error for permanent problems\n\nfixes #50122"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfdaea80dfd0a69ffd3bcb66b85846f3d493599d", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/bfdaea80dfd0a69ffd3bcb66b85846f3d493599d", "committedDate": "2020-01-22T13:48:09Z", "message": "only add other failures if anything left"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cefa7b30bcbf5fb7878ea8c74b966c9ecf50f4cb", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/cefa7b30bcbf5fb7878ea8c74b966c9ecf50f4cb", "committedDate": "2020-01-22T13:48:09Z", "message": "fix typo"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a887d8fb9da52594d44052f5e4fa8a941aee8270", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/a887d8fb9da52594d44052f5e4fa8a941aee8270", "committedDate": "2020-01-22T13:38:30Z", "message": "fix typo"}, "afterCommit": {"oid": "cefa7b30bcbf5fb7878ea8c74b966c9ecf50f4cb", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/cefa7b30bcbf5fb7878ea8c74b966c9ecf50f4cb", "committedDate": "2020-01-22T13:48:09Z", "message": "fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea266e34a8b2e993df24f45f56b02669f7a1d3f9", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/ea266e34a8b2e993df24f45f56b02669f7a1d3f9", "committedDate": "2020-01-22T14:38:35Z", "message": "fix log statement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c08e8d70f19f853d47d96e61c22a6180281c9ec9", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/c08e8d70f19f853d47d96e61c22a6180281c9ec9", "committedDate": "2020-01-22T15:55:11Z", "message": "fix integration tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NzAwMDI4", "url": "https://github.com/elastic/elasticsearch/pull/51307#pullrequestreview-346700028", "createdAt": "2020-01-22T15:56:57Z", "commit": {"oid": "c08e8d70f19f853d47d96e61c22a6180281c9ec9"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxNTo1Njo1OFrOFgha0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxNTo1NzoxMFrOFghbXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NjI4OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Handle script exception case. This is error is irrecoverable.\n          \n          \n            \n                 * Handle permanent bulk indexing exception case. This is error is irrecoverable.", "url": "https://github.com/elastic/elasticsearch/pull/51307#discussion_r369646289", "createdAt": "2020-01-22T15:56:58Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/transforms/TransformIndexer.java", "diffHunk": "@@ -834,9 +836,21 @@ private void handleScriptException(ScriptException scriptException) {\n         failIndexer(message);\n     }\n \n+    /**\n+     * Handle script exception case. This is error is irrecoverable.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c08e8d70f19f853d47d96e61c22a6180281c9ec9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0NjQyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param bulkIndexingException ScriptException thrown\n          \n          \n            \n                 * @param bulkIndexingException BulkIndexingException thrown", "url": "https://github.com/elastic/elasticsearch/pull/51307#discussion_r369646428", "createdAt": "2020-01-22T15:57:10Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/transforms/TransformIndexer.java", "diffHunk": "@@ -834,9 +836,21 @@ private void handleScriptException(ScriptException scriptException) {\n         failIndexer(message);\n     }\n \n+    /**\n+     * Handle script exception case. This is error is irrecoverable.\n+     *\n+     * @param bulkIndexingException ScriptException thrown", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c08e8d70f19f853d47d96e61c22a6180281c9ec9"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a245b17a8f3c7a4f4cd2906e6e55b4c18934ae2", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/6a245b17a8f3c7a4f4cd2906e6e55b4c18934ae2", "committedDate": "2020-01-22T16:13:51Z", "message": "apply review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b8d2d6ff44ca9debb19ea0f998d5e129c52b596", "author": {"user": {"login": "hendrikmuhs", "name": "Hendrik Muhs"}}, "url": "https://github.com/elastic/elasticsearch/commit/6b8d2d6ff44ca9debb19ea0f998d5e129c52b596", "committedDate": "2020-01-23T07:58:53Z", "message": "checkstyle fixes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2855, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}