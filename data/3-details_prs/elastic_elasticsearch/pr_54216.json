{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNzQxNDE4", "number": 54216, "title": "[DOCS] EQL: Document `cidrMatch` function", "bodyText": "Adds documentation for the EQL cidrMatch function.\nDepends on #54186", "createdAt": "2020-03-25T18:01:52Z", "url": "https://github.com/elastic/elasticsearch/pull/54216", "merged": true, "mergeCommit": {"oid": "d22240443c78466fa4c69a0868fec6a297528014"}, "closed": true, "closedAt": "2020-04-24T17:34:15Z", "author": {"login": "jrodewig"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVqS6rAH2gAyMzkzNzQxNDE4OjU2Mjk4ODgxMzRiYWE4MDBjOTlkYmRjNzU4NWI1ZDZmNjM2MjI3NjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcatGN_AFqTM5OTczNzQ1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5629888134baa800c99dbdc7585b5d6f63622765", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/5629888134baa800c99dbdc7585b5d6f63622765", "committedDate": "2020-04-08T16:15:10Z", "message": "[DOCS] EQL: Document `cidrMatch` function"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1a7c0c7f4e0d4483ba0d6fe117b9d80261122c58", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/1a7c0c7f4e0d4483ba0d6fe117b9d80261122c58", "committedDate": "2020-03-25T17:55:11Z", "message": "[DOCS] EQL: Document `cidrMatch` function"}, "afterCommit": {"oid": "5629888134baa800c99dbdc7585b5d6f63622765", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/5629888134baa800c99dbdc7585b5d6f63622765", "committedDate": "2020-04-08T16:15:10Z", "message": "[DOCS] EQL: Document `cidrMatch` function"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTQyMzIy", "url": "https://github.com/elastic/elasticsearch/pull/54216#pullrequestreview-390142322", "createdAt": "2020-04-08T16:34:33Z", "commit": {"oid": "5629888134baa800c99dbdc7585b5d6f63622765"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjozNDozM1rOGC3cOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjozNDozM1rOGC3cOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1ODY4Mw==", "bodyText": "@aleksmaus When I tested this using the EQL search API, it didn't return results as expected. I included duplication steps below in case I made an error somewhere.\nCreate an index mapping to ensure source.address is an IP field.\nPUT /my_index\n{\n  \"mappings\": {\n    \"properties\": {\n      \"source\": {\n        \"properties\": {\n          \"address\": {\n            \"type\": \"ip\"\n          }\n        }\n      }\n    }\n  }\n}\n\nIndex \"192.168.152.12\" as a source.address value.\nPUT /my_index/_doc/1\n{\n  \"@timestamp\": \"2020-12-06T11:04:05.000Z\",\n  \"event\": {\n    \"category\": \"process\"\n  },\n  \"source\": {\n    \"address\": \"192.168.152.12\"\n  }\n}\n\nUse cidrMatch to search for \"192.168.152.12\" in the \"192.168.0.0/16\" CIDR block. This should be true and return _doc 1 as a result.\n{\nGET /my_index/_eql/search\n  \"query\": \"process where cidrMatch(source.address, \\\"192.168.0.0/16\\\") == true \"\n}\n\nInstead, I get no results.\n{\n  \"took\" : 2,\n  \"timed_out\" : false,\n  \"hits\" : {\n    \"total\" : {\n      \"value\" : 0,\n      \"relation\" : \"eq\"\n    },\n    \"events\" : [ ]\n  }\n}\n\nIf I change true to false, the _doc is returned.\n{\nGET /my_index/_eql/search\n  \"query\": \"process where cidrMatch(source.address, \\\"192.168.0.0/16\\\") == false \"\n}\n\nResults:\n{\n  \"took\" : 2,\n  \"timed_out\" : false,\n  \"hits\" : {\n    \"total\" : {\n      \"value\" : 1,\n      \"relation\" : \"eq\"\n    },\n    \"events\" : [\n      {\n        \"_index\" : \"my_index\",\n        \"_id\" : \"1\",\n        \"_score\" : null,\n        \"_source\" : {\n          \"@timestamp\" : \"2020-12-06T11:04:05.000Z\",\n          \"event\" : {\n            \"category\" : \"process\"\n          },\n          \"source\" : {\n            \"address\" : \"192.168.152.12\"\n          }\n        },\n        \"sort\" : [\n          1607252645000\n        ]\n      }\n    ]\n  }\n}", "url": "https://github.com/elastic/elasticsearch/pull/54216#discussion_r405658683", "createdAt": "2020-04-08T16:34:33Z", "author": {"login": "jrodewig"}, "path": "docs/reference/eql/functions.asciidoc", "diffHunk": "@@ -8,11 +8,60 @@ experimental::[]\n \n {es} supports the following EQL functions:\n \n+* <<eql-fn-cidrmatch>>\n * <<eql-fn-endswith>>\n * <<eql-fn-length>>\n * <<eql-fn-startswith>>\n * <<eql-fn-substring>>\n \n+[discrete]\n+[[eql-fn-cidrmatch]]\n+==== `cidrMatch`\n+\n+Returns `true` if an IP address is contained in one or more provided\n+https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing[CIDR] blocks.\n+\n+[%collapsible]\n+====\n+*Example*\n+\n+[source,eql]\n+----\n+// source.address = \"192.168.152.12\"\n+cidrMatch(source.address, \"192.168.0.0/16\")               // returns true\n+cidrMatch(source.address, \"192.168.0.0/16\", \"10.0.0.0/8\") // returns true\n+cidrMatch(source.address, \"10.0.0.0/8\")                   // returns false\n+cidrMatch(source.address, \"10.0.0.0/8\", \"10.128.0.0/9\")   // returns false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5629888134baa800c99dbdc7585b5d6f63622765"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b43818baf0a9233249a3601e27c75b1f012c3421", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/b43818baf0a9233249a3601e27c75b1f012c3421", "committedDate": "2020-04-08T17:47:54Z", "message": "Merge remote-tracking branch 'upstream/master' into docs__eql-cidrmatch-fn"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44fcd0f7088464c6d3699f2f9f594a50e7eedeba", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/44fcd0f7088464c6d3699f2f9f594a50e7eedeba", "committedDate": "2020-04-10T13:28:50Z", "message": "update null handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61fcf4eeef83abe3694b000b627cb5fab61f5205", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/61fcf4eeef83abe3694b000b627cb5fab61f5205", "committedDate": "2020-04-10T15:37:20Z", "message": "reword"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NzM3NDU3", "url": "https://github.com/elastic/elasticsearch/pull/54216#pullrequestreview-399737457", "createdAt": "2020-04-24T08:20:38Z", "commit": {"oid": "61fcf4eeef83abe3694b000b627cb5fab61f5205"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1579, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}