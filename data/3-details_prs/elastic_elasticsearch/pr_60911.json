{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTgwODMy", "number": 60911, "title": "[ML] Monitor reindex response in DF analytics", "bodyText": "Examines the reindex response in order to report potential\nproblems that occurred during the reindexing phase of\ndata frame analytics jobs.", "createdAt": "2020-08-10T15:42:05Z", "url": "https://github.com/elastic/elasticsearch/pull/60911", "merged": true, "mergeCommit": {"oid": "2ed1359c726937e9f751f8f3845a09c8d415d3b1"}, "closed": true, "closedAt": "2020-08-11T12:33:39Z", "author": {"login": "dimitris-athanasiou"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9kAENgH2gAyNDY1NTgwODMyOjU1YjM4NmVhYTQ2ZjVkNzcxY2YzNWIwNzNmNjZkMmYyYjEzYjZlNGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc91KzjAFqTQ2NDk3ODc1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "55b386eaa46f5d771cf35b073f66d2f2b13b6e4f", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/55b386eaa46f5d771cf35b073f66d2f2b13b6e4f", "committedDate": "2020-08-10T15:32:07Z", "message": "[ML] Monitor reindex response in DF analytics\n\nExamines the reindex response in order to report potential\nproblems that occurred during the reindexing phase of\ndata frame analytics jobs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MzU5Mzc0", "url": "https://github.com/elastic/elasticsearch/pull/60911#pullrequestreview-464359374", "createdAt": "2020-08-10T15:52:07Z", "commit": {"oid": "55b386eaa46f5d771cf35b073f66d2f2b13b6e4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNTo1MjowN1rOG-U4yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNTo1MjowN1rOG-U4yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAwNzExNQ==", "bodyText": "I think since the reindex task is done, wouldn't we want to mark it as null even when it failed?", "url": "https://github.com/elastic/elasticsearch/pull/60911#discussion_r468007115", "createdAt": "2020-08-10T15:52:07Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/DataFrameAnalyticsManager.java", "diffHunk": "@@ -222,6 +223,13 @@ private void reindexDataframeAndStartAnalysis(DataFrameAnalyticsTask task, DataF\n                     task.markAsCompleted();\n                     return;\n                 }\n+\n+                Exception reindexError = getReindexError(task.getParams().getId(), reindexResponse);\n+                if (reindexError != null) {\n+                    task.markAsFailed(reindexError);\n+                    return;\n+                }\n+\n                 task.setReindexingTaskId(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55b386eaa46f5d771cf35b073f66d2f2b13b6e4f"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "404bb889a657d4a5fd844944a3c14325568c692c", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/404bb889a657d4a5fd844944a3c14325568c692c", "committedDate": "2020-08-11T07:04:28Z", "message": "Clear reindex task id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e45029087ba771de747ae6b40b8a8603406e4f95", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/e45029087ba771de747ae6b40b8a8603406e4f95", "committedDate": "2020-08-11T11:22:03Z", "message": "Also not allow partial search results on reindex"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0OTc4NzU0", "url": "https://github.com/elastic/elasticsearch/pull/60911#pullrequestreview-464978754", "createdAt": "2020-08-11T11:32:14Z", "commit": {"oid": "e45029087ba771de747ae6b40b8a8603406e4f95"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3356, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}