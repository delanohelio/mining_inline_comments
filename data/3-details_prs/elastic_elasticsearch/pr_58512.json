{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5NDA4MDAw", "number": 58512, "title": "Introduce node.roles setting", "bodyText": "Today we have individual settings for configuring node roles such as node.data and node.master. Additionally, roles are pluggable and we have used this to introduce roles such as node.ml and node.voting_only. As the number of roles is growing, managing these becomes harder for the user. For example, to create a master-only node, today a user has to= configure:\n\nnode.data: false\nnode.ingest: false\nnode.remote_cluster_client: false\nnode.ml: false\n\nat a minimum if they are relying on defaults, but also add:\n\nnode.master: true\nnode.transform: false\nnode.voting_only: false\n\nIf they want to be explicit. This is also challenging in cases where a user wants to have configure a coordinating-only node which requires disabling all roles, a list which we are adding to, requiring the user to keep checking whether a node has acquired any of these roles.\nThis commit addresses this by adding a list setting node.roles for which a user has explicit control over the list of roles that a node has. If the setting is configured, the node has exactly the roles in the list, and not any additional roles. This means to configure a master-only node, the setting is merely 'node.roles: [master]', and to configure a coordinating-only node, the setting is merely: 'node.roles: []'.\nWith this change we deprecate the existing 'node.*' settings such as 'node.data'.\nRelates #54998", "createdAt": "2020-06-24T19:11:35Z", "url": "https://github.com/elastic/elasticsearch/pull/58512", "merged": true, "mergeCommit": {"oid": "52ad5842a950332201efe852472c4f1b4d40a6ff"}, "closed": true, "closedAt": "2020-06-25T18:14:52Z", "author": {"login": "jasontedor"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcue8vrAH2gAyNDM5NDA4MDAwOmE4M2ZlYTgyM2FjOGI0ZjM5ZTQ2YmViZDIyMzk5YWIyOTljMTg5NjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuyI6NgH2gAyNDM5NDA4MDAwOjNiMmIxZWQ2Nzg2YzA3NjkyZTUwZTg0ZDhiZGMxZTNlODIzNzY4M2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a83fea823ac8b4f39e46bebd22399ab299c18964", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/a83fea823ac8b4f39e46bebd22399ab299c18964", "committedDate": "2020-06-24T19:10:06Z", "message": "Introduce node.roles setting (#54998)\n\nToday we have individual settings for configuring node roles such as\nnode.data and node.master. Additionally, roles are pluggable and we have\nused this to introduce roles such as node.ml and node.voting_only. As\nthe number of roles is growing, managing these becomes harder for the\nuser. For example, to create a master-only node, today a user has to\nconfigure:\n - node.data: false\n - node.ingest: false\n - node.remote_cluster_client: false\n - node.ml: false\n\nat a minimum if they are relying on defaults, but also add:\n - node.master: true\n - node.transform: false\n - node.voting_only: false\n\nIf they want to be explicit. This is also challenging in cases where a\nuser wants to have configure a coordinating-only node which requires\ndisabling all roles, a list which we are adding to, requiring the user\nto keep checking whether a node has acquired any of these roles.\n\nThis commit addresses this by adding a list setting node.roles for which\na user has explicit control over the list of roles that a node has. If\nthe setting is configured, the node has exactly the roles in the list,\nand not any additional roles. This means to configure a master-only\nnode, the setting is merely 'node.roles: [master]', and to configure a\ncoordinating-only node, the setting is merely: 'node.roles: []'.\n\nWith this change we deprecate the existing 'node.*' settings such as\n'node.data'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16a4e7d4309f1d37d165a573e9eaefa9d9a1846f", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/16a4e7d4309f1d37d165a573e9eaefa9d9a1846f", "committedDate": "2020-06-24T19:29:17Z", "message": "Fix compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c59d9bc30ec40be5eb7f970ee9e216bd556b4cc7", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/c59d9bc30ec40be5eb7f970ee9e216bd556b4cc7", "committedDate": "2020-06-24T22:11:57Z", "message": "Fix test compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5e7a2364fafd69a424c17469dfdd77ccb1693a", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/fe5e7a2364fafd69a424c17469dfdd77ccb1693a", "committedDate": "2020-06-24T22:18:33Z", "message": "Fix compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2cb99b85eee85dacee77697493c0794024d5a0b", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/d2cb99b85eee85dacee77697493c0794024d5a0b", "committedDate": "2020-06-24T22:25:36Z", "message": "Fix more compilation issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "879fd558ba96539f2a0df290d03e35b9cb218d54", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/879fd558ba96539f2a0df290d03e35b9cb218d54", "committedDate": "2020-06-25T02:41:44Z", "message": "More compilation fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d042399624d21c579b4c1610cff86a84568c49d0", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/d042399624d21c579b4c1610cff86a84568c49d0", "committedDate": "2020-06-25T02:43:48Z", "message": "More fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MjY0Nzkw", "url": "https://github.com/elastic/elasticsearch/pull/58512#pullrequestreview-437264790", "createdAt": "2020-06-25T08:12:01Z", "commit": {"oid": "d042399624d21c579b4c1610cff86a84568c49d0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODoxMjowMVrOGowEHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODoxMjowMVrOGowEHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM4MzcxMQ==", "bodyText": "I suggest to incorporate the test fix from #58525, which is just this one line change:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (transformPluginEnabled && useExplicitSetting && useLegacySetting) {\n          \n          \n            \n                    if (useExplicitSetting && useLegacySetting) {", "url": "https://github.com/elastic/elasticsearch/pull/58512#discussion_r445383711", "createdAt": "2020-06-25T08:12:01Z", "author": {"login": "henningandersen"}, "path": "x-pack/plugin/transform/src/test/java/org/elasticsearch/xpack/transform/TransformTests.java", "diffHunk": "@@ -36,6 +50,9 @@ public void testNodeAttributes() {\n             transformEnabled,\n             Boolean.parseBoolean(transform.additionalSettings().get(\"node.attr.transform.node\"))\n         );\n+        if (transformPluginEnabled && useExplicitSetting && useLegacySetting) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d042399624d21c579b4c1610cff86a84568c49d0"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e893d5972142f134e3c485521429c8c4867d99a", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/4e893d5972142f134e3c485521429c8c4867d99a", "committedDate": "2020-06-25T11:40:23Z", "message": "Fix even more compilatio"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6d8807d0ba9e362f73c35c93987c35bed1b05f", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/4c6d8807d0ba9e362f73c35c93987c35bed1b05f", "committedDate": "2020-06-25T11:42:23Z", "message": "Fix still more compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be762a1494800df06ac25b7f82cebe801289c2ce", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/be762a1494800df06ac25b7f82cebe801289c2ce", "committedDate": "2020-06-25T11:43:26Z", "message": "Update x-pack/plugin/transform/src/test/java/org/elasticsearch/xpack/transform/TransformTests.java\n\nCo-authored-by: Henning Andersen <33268011+henningandersen@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26fa359df8b8d8a79b7aefce9ecae2eeb5a7e727", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/26fa359df8b8d8a79b7aefce9ecae2eeb5a7e727", "committedDate": "2020-06-25T11:52:00Z", "message": "Still more compilation fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69c0bbe0f9c9b9e0dc401d1de84f9c624396b371", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/69c0bbe0f9c9b9e0dc401d1de84f9c624396b371", "committedDate": "2020-06-25T12:27:37Z", "message": "More fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54403ff23439359cc1ecfb9220449ec4fe29a452", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/54403ff23439359cc1ecfb9220449ec4fe29a452", "committedDate": "2020-06-25T13:09:28Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae5e47c92f39dd0dfbc23c2416b782b660952af1", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/ae5e47c92f39dd0dfbc23c2416b782b660952af1", "committedDate": "2020-06-25T13:11:12Z", "message": "Fix compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b2b1ed6786c07692e50e84d8bdc1e3e8237683e", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/3b2b1ed6786c07692e50e84d8bdc1e3e8237683e", "committedDate": "2020-06-25T17:31:35Z", "message": "More fixes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 411, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}