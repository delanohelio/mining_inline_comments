{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NDYwMDIy", "number": 50643, "title": "Add the new 'maintenance' privilege containing 4 actions (#29998)", "bodyText": "Have you signed the contributor license agreement?\nHave you followed the contributor guidelines?\nIf submitting code, have you built your formula locally prior to submission with gradle check?\nIf submitting code, is your pull request against master? Unless there is a good reason otherwise, we prefer pull requests against master and will backport as needed.\nIf submitting code, have you checked that your submission is for an OS and architecture that we support?\nIf you are submitting this code for a class then read our policy for that.", "createdAt": "2020-01-06T09:23:28Z", "url": "https://github.com/elastic/elasticsearch/pull/50643", "merged": true, "mergeCommit": {"oid": "5712246eee7728e33ab1857fd885bc5cccd04f34"}, "closed": true, "closedAt": "2020-01-30T08:33:27Z", "author": {"login": "amirhmd"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3ooFcgH2gAyMzU5NDYwMDIyOjM2M2YxZmY4OWI3MDM1ZTQyMmZlNGE0NzE5MjVmMjEyZmEzZDRiYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-6RoRgFqTM0OTc4NTM4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "363f1ff89b7035e422fe4a471925f212fa3d4ba1", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/363f1ff89b7035e422fe4a471925f212fa3d4ba1", "committedDate": "2020-01-06T09:20:45Z", "message": "Add the new 'maintenance' privilege containing 4 actions (#29998)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3421673d4db8a19df88e1ff1790c6c162bd92533", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/3421673d4db8a19df88e1ff1790c6c162bd92533", "committedDate": "2020-01-07T00:24:11Z", "message": "Fix merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/22f758896edc9e9176ce65f8fe0f05c6ce30340d", "committedDate": "2020-01-07T06:45:10Z", "message": "Fix merge conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5NTU4MTY2", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-339558166", "createdAt": "2020-01-07T22:51:15Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QyMjo1MToxNVrOFbIOFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QyMjo1MToxNVrOFbIOFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzk5MDU0OQ==", "bodyText": "The test that it's failing {\"type\":\"security_exception\",\"reason\":\"action [indices:admin/refresh[s]] is unauthorized for user [u15]\"}}]}} hints that indices:admin/refresh[s] is unauthorized.\nThe refresh action translates into shard wise sub-actions, which are also authorized by themselves.\nYou need to add replace indices:admin/refresh with indices:admin/refresh*.", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r363990549", "createdAt": "2020-01-07T22:51:15Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/privilege/IndexPrivilege.java", "diffHunk": "@@ -66,6 +66,8 @@\n         CloseIndexAction.NAME + \"*\");\n     private static final Automaton MANAGE_LEADER_INDEX_AUTOMATON = patterns(ForgetFollowerAction.NAME + \"*\");\n     private static final Automaton MANAGE_ILM_AUTOMATON = patterns(\"indices:admin/ilm/*\");\n+    private static final Automaton MAINTENANCE_AUTOMATON = patterns(\"indices:admin/refresh\", \"indices:admin/flush\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzgxMDI4", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-340381028", "createdAt": "2020-01-09T09:21:02Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOToyMTowMlrOFbvTJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOToyMTowMlrOFbvTJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzMDgyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Privilege to refresh, flush, synced_flush, force merge\n          \n          \n            \n            Permits refresh, flush, synced flush and force merge operations. No privilege to read or write index data or otherwise manage the index.", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r364630820", "createdAt": "2020-01-09T09:21:02Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/docs/en/security/authorization/privileges.asciidoc", "diffHunk": "@@ -201,15 +201,18 @@ Privilege to delete an index.\n Privilege to index and update documents. Also grants access to the update\n mapping action.\n \n+`maintenance`::\n+Privilege to refresh, flush, synced_flush, force merge", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzg0NzQw", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-340384740", "createdAt": "2020-01-09T09:27:05Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOToyNzowNVrOFbveMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwOToyNzowNVrOFbveMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDYzMzY0OQ==", "bodyText": "You're adding a new index privilege not a cluster one, so I believe this should instead be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              - length: { \"cluster\" : 33 }\n          \n          \n            \n              - length: { \"cluster\" : 34 }\n          \n          \n            \n              - length: { \"index\" : 17 }\n          \n          \n            \n               - length: { \"index\" : 18 }", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r364633649", "createdAt": "2020-01-09T09:27:05Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/privileges/11_builtin.yml", "diffHunk": "@@ -15,5 +15,5 @@ setup:\n   # This is fragile - it needs to be updated every time we add a new cluster/index privilege\n   # I would much prefer we could just check that specific entries are in the array, but we don't have\n   # an assertion for that\n-  - length: { \"cluster\" : 33 }\n+  - length: { \"cluster\" : 34 }\n   - length: { \"index\" : 17 }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNDE5NTU1", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-340419555", "createdAt": "2020-01-09T10:23:38Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyMzozOFrOFbxJ8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyMzozOFrOFbxJ8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2MTIzMw==", "bodyText": "I don't think we need this fluff. This is testing the authorization of composite requests but refresh and flush are not part of those composite type of requests.\nIn addition to assertUserIsAllowed(\"u15\", \"maintenance\", \"a\"); I would also check that crud is not allowed, and we should also test that other users in this class don't have the maintenance priv (right now it only checks the positive case).", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r364661233", "createdAt": "2020-01-09T10:23:38Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/integration/IndexPrivilegeTests.java", "diffHunk": "@@ -385,6 +391,18 @@ public void testUserU14() throws Exception {\n                 \"GET\", \"/\" + randomIndex() + \"/_mtermvectors\", \"{ \\\"docs\\\" : [ { \\\"_id\\\": \\\"1\\\" }, { \\\"_id\\\": \\\"2\\\" } ] }\");\n     }\n \n+    public void testUser15() throws Exception {\n+        assertUserIsAllowed(\"u15\", \"maintenance\", \"a\");\n+\n+        assertAccessIsAllowed(\"u15\",\n+            \"GET\", \"/\" + randomIndex() + \"/_msearch\", \"{}\\n{ \\\"query\\\" : { \\\"match_all\\\" : {} } }\\n\");\n+        assertAccessIsAllowed(\"u15\", \"POST\", \"/\" + randomIndex() + \"/_mget\", \"{ \\\"ids\\\" : [ \\\"1\\\", \\\"2\\\" ] } \");\n+        assertAccessIsDenied(\"u15\", \"PUT\",\n+            \"/\" + randomIndex() + \"/_bulk\", \"{ \\\"index\\\" : { \\\"_id\\\" : \\\"123\\\" } }\\n{ \\\"foo\\\" : \\\"bar\\\" }\\n\");\n+        assertAccessIsAllowed(\"u15\",\n+            \"GET\", \"/\" + randomIndex() + \"/_mtermvectors\", \"{ \\\"docs\\\" : [ { \\\"_id\\\": \\\"1\\\" }, { \\\"_id\\\": \\\"2\\\" } ] }\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNDE5ODQ2", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-340419846", "createdAt": "2020-01-09T10:24:07Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyNDowOFrOFbxKxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDoyNDowOFrOFbxKxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY2MTQ0Nw==", "bodyText": "Should be assertAccessIsDenied, right?", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r364661447", "createdAt": "2020-01-09T10:24:08Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/integration/IndexPrivilegeTests.java", "diffHunk": "@@ -419,6 +437,23 @@ private void assertUserExecutes(String user, String action, String index, boolea\n                 }\n                 break;\n \n+            case \"maintenance\" :\n+                if (userIsAllowed) {\n+                    assertUserIsDenied(user, \"crud\", index);\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_refresh\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_flush\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_flush/synced\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_forcemerge\");\n+                } else {\n+                    assertUserIsDenied(user, \"crud\", index);\n+                    assertAccessIsDenied(user, \"PUT\", \"/\" + index);\n+                    assertAccessIsDenied(user, \"POST\", \"/\" + index + \"/_refresh\");\n+                    assertAccessIsDenied(user, \"POST\", \"/\" + index + \"/_flush\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_flush/synced\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "originalPosition": 64}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNDIxMTU4", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-340421158", "createdAt": "2020-01-09T10:26:21Z", "commit": {"oid": "22f758896edc9e9176ce65f8fe0f05c6ce30340d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73f5763bda10813d7c8a461d279ea6027f6623b3", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/73f5763bda10813d7c8a461d279ea6027f6623b3", "committedDate": "2020-01-09T21:23:50Z", "message": "Apply code review - fixed failed test (#29998)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ddc277ad8ca755c8bbeaccc69046fe260c3efff", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/0ddc277ad8ca755c8bbeaccc69046fe260c3efff", "committedDate": "2020-01-09T21:31:54Z", "message": "Fix merge conflict - increase cluster (#29998)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "844c4b13ecb2d9fd58914e7587f03e64d569940e", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/844c4b13ecb2d9fd58914e7587f03e64d569940e", "committedDate": "2020-01-09T21:32:58Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMzExNDMw", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-341311430", "createdAt": "2020-01-10T17:26:29Z", "commit": {"oid": "844c4b13ecb2d9fd58914e7587f03e64d569940e"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNzoyNjoyOVrOFca6Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNzozMTozMFrOFcbCcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM0NTMxNA==", "bodyText": "Please move this to the testUser11 function and do it for the b and c indices, i.e.\nassertUserIsDenied(\"u11\", \"maintenance\", \"b\");, assertUserIsDenied(\"u11\", \"maintenance\", \"c\"); .", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r365345314", "createdAt": "2020-01-10T17:26:29Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/integration/IndexPrivilegeTests.java", "diffHunk": "@@ -385,6 +391,13 @@ public void testUserU14() throws Exception {\n                 \"GET\", \"/\" + randomIndex() + \"/_mtermvectors\", \"{ \\\"docs\\\" : [ { \\\"_id\\\": \\\"1\\\" }, { \\\"_id\\\": \\\"2\\\" } ] }\");\n     }\n \n+    public void testUserU15() throws Exception {\n+        assertUserIsAllowed(\"u15\", \"maintenance\", \"a\");\n+        assertUserIsDenied(\"u15\", \"crud\", \"a\");\n+\n+        assertUserIsDenied(\"u11\", \"maintenance\", \"a\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "844c4b13ecb2d9fd58914e7587f03e64d569940e"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM0NzQ0Mg==", "bodyText": "You missed an and. We try to be sharp wrt the docs.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Permits refresh, flush, synced flush, force merge operations. No privilege\n          \n          \n            \n            Permits refresh, flush, synced flush and force merge index administration operations.", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r365347442", "createdAt": "2020-01-10T17:31:30Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/docs/en/security/authorization/privileges.asciidoc", "diffHunk": "@@ -204,15 +204,19 @@ Privilege to delete an index.\n Privilege to index and update documents. Also grants access to the update\n mapping action.\n \n+`maintenance`::\n+Permits refresh, flush, synced flush, force merge operations. No privilege", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "844c4b13ecb2d9fd58914e7587f03e64d569940e"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1a6208a5d12b957024cdde9b2f4b3296e44d03e", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/e1a6208a5d12b957024cdde9b2f4b3296e44d03e", "committedDate": "2020-01-10T21:40:16Z", "message": "Polish message and test (#29998)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cecd284494df3d3241feeb08fb03263b8da131c4", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/cecd284494df3d3241feeb08fb03263b8da131c4", "committedDate": "2020-01-16T21:31:06Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a9779ac29b42f1ff1342a413b2b96bd769bbc9e", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/8a9779ac29b42f1ff1342a413b2b96bd769bbc9e", "committedDate": "2020-01-27T11:30:59Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MDcwODEx", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-349070811", "createdAt": "2020-01-28T00:39:56Z", "commit": {"oid": "8a9779ac29b42f1ff1342a413b2b96bd769bbc9e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwMDozOTo1NlrOFiWNtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQwMDo0NjozMlrOFiWUOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU1OTg2Mg==", "bodyText": "Minor:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        entry(\"maintenance\",MAINTENANCE));\n          \n          \n            \n                        entry(\"maintenance\", MAINTENANCE));", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r371559862", "createdAt": "2020-01-28T00:39:56Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/privilege/IndexPrivilege.java", "diffHunk": "@@ -102,7 +105,8 @@\n             entry(\"read_cross_cluster\", READ_CROSS_CLUSTER),\n             entry(\"manage_follow_index\", MANAGE_FOLLOW_INDEX),\n             entry(\"manage_leader_index\", MANAGE_LEADER_INDEX),\n-            entry(\"manage_ilm\", MANAGE_ILM));\n+            entry(\"manage_ilm\", MANAGE_ILM),\n+            entry(\"maintenance\",MAINTENANCE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a9779ac29b42f1ff1342a413b2b96bd769bbc9e"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU2MTUxNg==", "bodyText": "I think this this is what we want.\nA user being allowed maintenance should not imply anything about whether they are/aren't allowed crud.", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r371561516", "createdAt": "2020-01-28T00:46:29Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/integration/IndexPrivilegeTests.java", "diffHunk": "@@ -419,6 +432,22 @@ private void assertUserExecutes(String user, String action, String index, boolea\n                 }\n                 break;\n \n+            case \"maintenance\" :\n+                if (userIsAllowed) {\n+                    assertUserIsDenied(user, \"crud\", index);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a9779ac29b42f1ff1342a413b2b96bd769bbc9e"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU2MTUzMQ==", "bodyText": "Per above.", "url": "https://github.com/elastic/elasticsearch/pull/50643#discussion_r371561531", "createdAt": "2020-01-28T00:46:32Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/integration/IndexPrivilegeTests.java", "diffHunk": "@@ -419,6 +432,22 @@ private void assertUserExecutes(String user, String action, String index, boolea\n                 }\n                 break;\n \n+            case \"maintenance\" :\n+                if (userIsAllowed) {\n+                    assertUserIsDenied(user, \"crud\", index);\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_refresh\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_flush\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_flush/synced\");\n+                    assertAccessIsAllowed(user, \"POST\", \"/\" + index + \"/_forcemerge\");\n+                } else {\n+                    assertUserIsDenied(user, \"crud\", index);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a9779ac29b42f1ff1342a413b2b96bd769bbc9e"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "746d4d7e6d43ef9a4b5241ed4e806357869fd519", "author": {"user": null}, "url": "https://github.com/elastic/elasticsearch/commit/746d4d7e6d43ef9a4b5241ed4e806357869fd519", "committedDate": "2020-01-28T09:55:58Z", "message": "Polish and remove unnecessary crud check in test (#29998)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5Nzg1Mzgy", "url": "https://github.com/elastic/elasticsearch/pull/50643#pullrequestreview-349785382", "createdAt": "2020-01-28T23:51:59Z", "commit": {"oid": "746d4d7e6d43ef9a4b5241ed4e806357869fd519"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3835, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}