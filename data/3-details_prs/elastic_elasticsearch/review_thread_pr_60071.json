{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1MjUyNDA4", "number": 60071, "reviewThreads": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTozOTowMFrOETvB5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1NDozMlrOETvcrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTI4OTM0OnYy", "diffSide": "RIGHT", "path": "plugins/discovery-azure-classic/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTozOTowMFrOG5or6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTozOTowMFrOG5or6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4ODYxOA==", "bodyText": "TaskProvider", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463088618", "createdAt": "2020-07-30T15:39:00Z", "author": {"login": "mark-vieira"}, "path": "plugins/discovery-azure-classic/build.gradle", "diffHunk": "@@ -72,7 +72,7 @@ String host = InetAddress.getLoopbackAddress().getHostAddress()\n File keystore = new File(project.buildDir, 'keystore/test-node.jks')\n \n // generate the keystore\n-task createKey(type: LoggedExec) {\n+def createKey = tasks.register(\"createKey\", LoggedExec) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTI5MTU3OnYy", "diffSide": "RIGHT", "path": "plugins/discovery-ec2/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTozOTozMlrOG5otRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxOTo0ODo0NVrOG5xc8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4ODk2Ng==", "bodyText": "Should this also be tasks.named(\"test\").configure {?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463088966", "createdAt": "2020-07-30T15:39:32Z", "author": {"login": "mark-vieira"}, "path": "plugins/discovery-ec2/build.gradle", "diffHunk": "@@ -98,7 +98,7 @@ task writeTestJavaPolicy {\n }\n \n test {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzIzMjI0MA==", "bodyText": "after rebasing today I ran into some issues and have just not touched those yet after they've been changed. will revisit after I got the PR builds green again :(", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463232240", "createdAt": "2020-07-30T19:48:45Z", "author": {"login": "breskeby"}, "path": "plugins/discovery-ec2/build.gradle", "diffHunk": "@@ -98,7 +98,7 @@ task writeTestJavaPolicy {\n }\n \n test {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4ODk2Ng=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTI5Njc3OnYy", "diffSide": "RIGHT", "path": "plugins/discovery-gce/qa/gce/build.gradle", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MDozNVrOG5owZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwODowMjo0MVrOG5_nuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4OTc2Ng==", "bodyText": "Why was this dependency changed?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463089766", "createdAt": "2020-07-30T15:40:35Z", "author": {"login": "mark-vieira"}, "path": "plugins/discovery-gce/qa/gce/build.gradle", "diffHunk": "@@ -39,8 +39,8 @@ restResources {\n }\n \n /** A task to start the GCEFixture which emulates a GCE service **/\n-task gceFixture(type: AntFixture) {\n-  dependsOn project.sourceSets.yamlRestTest.runtimeClasspath\n+tasks.register(\"gceFixture\", AntFixture) {\n+  dependsOn \"compileTestJava\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzIzMTc4NA==", "bodyText": "shouldn't be there, probably a merge issue I ran into today", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463231784", "createdAt": "2020-07-30T19:47:48Z", "author": {"login": "breskeby"}, "path": "plugins/discovery-gce/qa/gce/build.gradle", "diffHunk": "@@ -39,8 +39,8 @@ restResources {\n }\n \n /** A task to start the GCEFixture which emulates a GCE service **/\n-task gceFixture(type: AntFixture) {\n-  dependsOn project.sourceSets.yamlRestTest.runtimeClasspath\n+tasks.register(\"gceFixture\", AntFixture) {\n+  dependsOn \"compileTestJava\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4OTc2Ng=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ2NDM3Nw==", "bodyText": "fixed", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463464377", "createdAt": "2020-07-31T08:02:41Z", "author": {"login": "breskeby"}, "path": "plugins/discovery-gce/qa/gce/build.gradle", "diffHunk": "@@ -39,8 +39,8 @@ restResources {\n }\n \n /** A task to start the GCEFixture which emulates a GCE service **/\n-task gceFixture(type: AntFixture) {\n-  dependsOn project.sourceSets.yamlRestTest.runtimeClasspath\n+tasks.register(\"gceFixture\", AntFixture) {\n+  dependsOn \"compileTestJava\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA4OTc2Ng=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTMwMTE2OnYy", "diffSide": "RIGHT", "path": "qa/full-cluster-restart/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MTozN1rOG5ozTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MTozN1rOG5ozTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5MDUwOA==", "bodyText": "TaskProvider", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463090508", "createdAt": "2020-07-30T15:41:37Z", "author": {"login": "mark-vieira"}, "path": "qa/full-cluster-restart/build.gradle", "diffHunk": "@@ -77,7 +77,7 @@ configurations {\n   testArtifacts.extendsFrom testImplementation\n }\n \n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTMwMjk0OnYy", "diffSide": "RIGHT", "path": "qa/repository-multi-version/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MjowNFrOG5o0fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxOTo0Njo1NlrOG5xZAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5MDgxMg==", "bodyText": "TaskProvider", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463090812", "createdAt": "2020-07-30T15:42:04Z", "author": {"login": "mark-vieira"}, "path": "qa/repository-multi-version/build.gradle", "diffHunk": "@@ -92,7 +92,7 @@ configurations {\n   testArtifacts.extendsFrom testImplementation\n }\n \n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzIzMTIzMw==", "bodyText": "you mean we should used typed variables here? testJar is of type TaskProvider", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463231233", "createdAt": "2020-07-30T19:46:56Z", "author": {"login": "breskeby"}, "path": "qa/repository-multi-version/build.gradle", "diffHunk": "@@ -92,7 +92,7 @@ configurations {\n   testArtifacts.extendsFrom testImplementation\n }\n \n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5MDgxMg=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTMwNzg1OnYy", "diffSide": "RIGHT", "path": "x-pack/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MzoxMlrOG5o3nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0MzoxMlrOG5o3nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5MTYxMw==", "bodyText": "Can we ditch the .class here?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463091613", "createdAt": "2020-07-30T15:43:12Z", "author": {"login": "mark-vieira"}, "path": "x-pack/build.gradle", "diffHunk": "@@ -31,7 +31,7 @@ subprojects {\n     project.esplugin.noticeFile = xpackRootProject.file('NOTICE.txt')\n   }\n \n-  tasks.withType(LicenseHeadersTask.class) {\n+  tasks.withType(LicenseHeadersTask.class).configureEach {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTMxMTIzOnYy", "diffSide": "RIGHT", "path": "x-pack/license-tools/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0NDowMlrOG5o5rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo0NDowMlrOG5o5rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5MjE0MQ==", "bodyText": "Is this necessary? Shouldn't this be inferred from the copyspec below?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463092141", "createdAt": "2020-07-30T15:44:02Z", "author": {"login": "mark-vieira"}, "path": "x-pack/license-tools/build.gradle", "diffHunk": "@@ -12,7 +12,8 @@ project.forbiddenPatterns {\n \n tasks.named(\"dependencyLicenses\").configure { it.enabled = false }\n \n-task buildZip(type: Zip, dependsOn: jar) {\n+tasks.register(\"buildZip\", Zip) {\n+  dependsOn \"jar\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTMzOTY3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MDoyNVrOG5pLAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MDoyNVrOG5pLAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NjU3Nw==", "bodyText": "should we also do tasks.named(\"testJar\")?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463096577", "createdAt": "2020-07-30T15:50:25Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/ml/build.gradle", "diffHunk": "@@ -69,17 +69,18 @@ configurations {\n   testArtifacts.extendsFrom testRuntime\n   testArtifacts.extendsFrom testImplementation\n }\n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n+\n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTM0NTE5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MTo0MFrOG5pOVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwODowMjozMFrOG5_naA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NzQzMQ==", "bodyText": "Since lazy task configuration technically defers this until task graph calculation time, could we safely remove the afterEvaluate here?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463097431", "createdAt": "2020-07-30T15:51:40Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/ml/build.gradle", "diffHunk": "@@ -89,23 +90,28 @@ task extractNativeLicenses(type: Copy) {\n }\n project.afterEvaluate {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ2NDI5Ng==", "bodyText": "the taskProvider also doesn't exist yet. its creation must is deferred.", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463464296", "createdAt": "2020-07-31T08:02:30Z", "author": {"login": "breskeby"}, "path": "x-pack/plugin/ml/build.gradle", "diffHunk": "@@ -89,23 +90,28 @@ task extractNativeLicenses(type: Copy) {\n }\n project.afterEvaluate {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NzQzMQ=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTM1MTQ5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/monitoring/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MzowMFrOG5pSLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwNzo1MDozMlrOG5_SIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODQxMg==", "bodyText": "Same as above, shouldn't we use a task provider for testJar as well?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463098412", "createdAt": "2020-07-30T15:53:00Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/monitoring/build.gradle", "diffHunk": "@@ -28,13 +28,13 @@ configurations {\n   testArtifacts.extendsFrom testRuntime\n   testArtifacts.extendsFrom testImplementation\n }\n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1ODg0OQ==", "bodyText": "it is the task provider. I made the variable typed so its more clear", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463458849", "createdAt": "2020-07-31T07:50:32Z", "author": {"login": "breskeby"}, "path": "x-pack/plugin/monitoring/build.gradle", "diffHunk": "@@ -28,13 +28,13 @@ configurations {\n   testArtifacts.extendsFrom testRuntime\n   testArtifacts.extendsFrom testImplementation\n }\n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODQxMg=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTM1MTk5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ql/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MzowOVrOG5pSgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwODowMTo0NlrOG5_mGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODQ5Nw==", "bodyText": "Taskprovider for testJar?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463098497", "createdAt": "2020-07-30T15:53:09Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/ql/build.gradle", "diffHunk": "@@ -21,17 +21,18 @@ configurations {\n   testArtifacts.extendsFrom testImplementation\n }\n \n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n \n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ2Mzk2MA==", "bodyText": "see above", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463463960", "createdAt": "2020-07-31T08:01:46Z", "author": {"login": "breskeby"}, "path": "x-pack/plugin/ql/build.gradle", "diffHunk": "@@ -21,17 +21,18 @@ configurations {\n   testArtifacts.extendsFrom testImplementation\n }\n \n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n \n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODQ5Nw=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTM1MzQyOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/security/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1MzoyN1rOG5pTVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwODowMTo0MVrOG5_l5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODcxMQ==", "bodyText": "Taskprovider for testJar?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463098711", "createdAt": "2020-07-30T15:53:27Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/security/build.gradle", "diffHunk": "@@ -143,13 +143,13 @@ configurations {\n   testArtifacts.extendsFrom testRuntime\n   testArtifacts.extendsFrom testImplementation\n }\n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ2MzkxMA==", "bodyText": "we do as explained above", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463463910", "createdAt": "2020-07-31T08:01:41Z", "author": {"login": "breskeby"}, "path": "x-pack/plugin/security/build.gradle", "diffHunk": "@@ -143,13 +143,13 @@ configurations {\n   testArtifacts.extendsFrom testRuntime\n   testArtifacts.extendsFrom testImplementation\n }\n-task testJar(type: Jar) {\n+def testJar = tasks.register(\"testJar\", Jar) {\n   appendix 'test'\n   from sourceSets.test.output\n }\n artifacts {\n   // normal es plugins do not publish the jar but we need to since users need it for extensions\n-  archives jar\n+  archives tasks.named(\"jar\")\n   testArtifacts testJar", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODcxMQ=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTM1NzkwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/transform/qa/multi-node-tests/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNTo1NDozMlrOG5pWIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQwODowMToyOVrOG5_liA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5OTQyNg==", "bodyText": "Should we defer the creation of processTestResources here?", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463099426", "createdAt": "2020-07-30T15:54:32Z", "author": {"login": "mark-vieira"}, "path": "x-pack/plugin/transform/qa/multi-node-tests/build.gradle", "diffHunk": "@@ -13,17 +13,17 @@ File keystoreDir = new File(project.buildDir, 'keystore')\n File nodeKey = file(\"$keystoreDir/testnode.pem\")\n File nodeCert = file(\"$keystoreDir/testnode.crt\")\n // Add key and certs to test classpath: it expects it there\n-task copyKeyCerts(type: Copy) {\n+tasks.register(\"copyKeyCerts\", Copy) {\n   from(project(':x-pack:plugin:core').file('src/test/resources/org/elasticsearch/xpack/security/transport/ssl/certs/simple/')) {\n     include 'testnode.crt', 'testnode.pem'\n   }\n   into keystoreDir\n }\n // Add keys and cets to test classpath: it expects it there\n sourceSets.test.resources.srcDir(keystoreDir)\n-processTestResources.dependsOn(copyKeyCerts)\n+processTestResources.dependsOn(\"copyKeyCerts\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ2MzgxNg==", "bodyText": "done", "url": "https://github.com/elastic/elasticsearch/pull/60071#discussion_r463463816", "createdAt": "2020-07-31T08:01:29Z", "author": {"login": "breskeby"}, "path": "x-pack/plugin/transform/qa/multi-node-tests/build.gradle", "diffHunk": "@@ -13,17 +13,17 @@ File keystoreDir = new File(project.buildDir, 'keystore')\n File nodeKey = file(\"$keystoreDir/testnode.pem\")\n File nodeCert = file(\"$keystoreDir/testnode.crt\")\n // Add key and certs to test classpath: it expects it there\n-task copyKeyCerts(type: Copy) {\n+tasks.register(\"copyKeyCerts\", Copy) {\n   from(project(':x-pack:plugin:core').file('src/test/resources/org/elasticsearch/xpack/security/transport/ssl/certs/simple/')) {\n     include 'testnode.crt', 'testnode.pem'\n   }\n   into keystoreDir\n }\n // Add keys and cets to test classpath: it expects it there\n sourceSets.test.resources.srcDir(keystoreDir)\n-processTestResources.dependsOn(copyKeyCerts)\n+processTestResources.dependsOn(\"copyKeyCerts\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5OTQyNg=="}, "originalCommit": {"oid": "8517df7ca62489657abe4aea4059a5b5dfb8b972"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2112, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}