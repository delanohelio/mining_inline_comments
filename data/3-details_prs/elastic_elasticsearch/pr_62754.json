{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwODM4NzE1", "number": 62754, "title": "Add case insensitive prefix and wildcard to 'version' field", "bodyText": "This change adds support for the recently introduced case insensitivity flag for\nwildcard and prefix queries. Since version field values are encoded differently we\nneed to adapt our own AutomatonQuery variation to add both cases if case insensitivity\nis turned on.", "createdAt": "2020-09-22T10:23:49Z", "url": "https://github.com/elastic/elasticsearch/pull/62754", "merged": true, "mergeCommit": {"oid": "3ee74a46df6d664f01c3d6ced10252830d0ea8af"}, "closed": true, "closedAt": "2020-09-22T18:03:47Z", "author": {"login": "cbuescher"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLVGWugH2gAyNDkwODM4NzE1OmQyZDZjODhkMjBhN2E5NGY0OTRmZjVkZDk2ZWZjMDljYmZlMjBkMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLbK2_AH2gAyNDkwODM4NzE1OjVhMzE5ZjRhN2RiYzQ5YTlkOWZkNDQ5MTQxNDc5YzNiMjQ4NzRmYzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25", "author": {"user": {"login": "cbuescher", "name": "Christoph B\u00fcscher"}}, "url": "https://github.com/elastic/elasticsearch/commit/d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25", "committedDate": "2020-09-22T10:05:21Z", "message": "Add caseInsensitive option for prefix and wildcard query"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzE5Njky", "url": "https://github.com/elastic/elasticsearch/pull/62754#pullrequestreview-493319692", "createdAt": "2020-09-22T10:25:09Z", "commit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDoyNToxMFrOHVzowA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMDoyNToxMFrOHVzowA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYyODE2MA==", "bodyText": "Wanted to use this, let me know if this shouldn't be that open. Another option is simpyl copying the logic over I think.", "url": "https://github.com/elastic/elasticsearch/pull/62754#discussion_r492628160", "createdAt": "2020-09-22T10:25:10Z", "author": {"login": "cbuescher"}, "path": "server/src/main/java/org/elasticsearch/common/lucene/search/AutomatonQueries.java", "diffHunk": "@@ -129,11 +129,11 @@ public static Automaton toCaseInsensitiveString(String s, int maxDeterminizedSta\n         Automaton a = Operations.concatenate(list);\n         a = MinimizationOperations.minimize(a, maxDeterminizedStates);\n         return a;\n- \n-    \n+\n+\n     }\n \n-    protected static Automaton toCaseInsensitiveChar(int codepoint, int maxDeterminizedStates) {\n+    public static Automaton toCaseInsensitiveChar(int codepoint, int maxDeterminizedStates) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "originalPosition": 102}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzY2MzQ3", "url": "https://github.com/elastic/elasticsearch/pull/62754#pullrequestreview-493366347", "createdAt": "2020-09-22T11:34:03Z", "commit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMTozNDowM1rOHV1wLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMTozNDowM1rOHV1wLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjY2MjgyOQ==", "bodyText": "Typo - missing i in Insensitive.", "url": "https://github.com/elastic/elasticsearch/pull/62754#discussion_r492662829", "createdAt": "2020-09-22T11:34:03Z", "author": {"login": "markharwood"}, "path": "x-pack/plugin/versionfield/src/main/java/org/elasticsearch/xpack/versionfield/VersionStringFieldMapper.java", "diffHunk": "@@ -139,7 +139,7 @@ public Query existsQuery(QueryShardContext context) {\n \n         @Override\n         public Query prefixQuery(String value, MultiTermQuery.RewriteMethod method, boolean caseInsensitve, QueryShardContext context) {\n-            return wildcardQuery(value + \"*\", method, context);\n+            return wildcardQuery(value + \"*\", method, caseInsensitve, context);\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzY2NjE1", "url": "https://github.com/elastic/elasticsearch/pull/62754#pullrequestreview-493366615", "createdAt": "2020-09-22T11:34:30Z", "commit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMTozNDozMFrOHV1w6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMTozNDozMFrOHV1w6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjY2MzAxOQ==", "bodyText": "Typo", "url": "https://github.com/elastic/elasticsearch/pull/62754#discussion_r492663019", "createdAt": "2020-09-22T11:34:30Z", "author": {"login": "markharwood"}, "path": "x-pack/plugin/versionfield/src/main/java/org/elasticsearch/xpack/versionfield/VersionStringFieldMapper.java", "diffHunk": "@@ -244,7 +244,7 @@ public Query wildcardQuery(String value, MultiTermQuery.RewriteMethod method, bo\n                 );\n             }\n \n-            VersionFieldWildcardQuery query = new VersionFieldWildcardQuery(new Term(name(), value));\n+            VersionFieldWildcardQuery query = new VersionFieldWildcardQuery(new Term(name(), value), caseInsensitve);\n             QueryParsers.setRewriteMethod(query, method);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMzY3Njcy", "url": "https://github.com/elastic/elasticsearch/pull/62754#pullrequestreview-493367672", "createdAt": "2020-09-22T11:36:03Z", "commit": {"oid": "d2d6c88d20a7a94f494ff5dd96efc09cbfe20d25"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6de210e4bbd0e87f9f72c45153a3bc3ddc698423", "author": {"user": {"login": "cbuescher", "name": "Christoph B\u00fcscher"}}, "url": "https://github.com/elastic/elasticsearch/commit/6de210e4bbd0e87f9f72c45153a3bc3ddc698423", "committedDate": "2020-09-22T13:09:29Z", "message": "typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04cda01386f7aa2b7e286f8a1d71fd78be3c7f68", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/04cda01386f7aa2b7e286f8a1d71fd78be3c7f68", "committedDate": "2020-09-22T16:05:13Z", "message": "Merge branch 'master' into versionfield-caseinsensitive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a319f4a7dbc49a9d9fd449141479c3b24874fc5", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/5a319f4a7dbc49a9d9fd449141479c3b24874fc5", "committedDate": "2020-09-22T17:09:42Z", "message": "Merge branch 'master' into versionfield-caseinsensitive"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4710, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}