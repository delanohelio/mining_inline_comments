{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3ODU0OTc4", "number": 54694, "title": "Only allow retrieving a single index or component template", "bodyText": "This changes the Index Template v2 APIs to only allow retrieving a single \"named\" entity, where the\nnamed entity can be nothing (return everything), a wildcard (return the ones that match), or the\nname of a template.\nRelates to #53101", "createdAt": "2020-04-02T23:17:58Z", "url": "https://github.com/elastic/elasticsearch/pull/54694", "merged": true, "mergeCommit": {"oid": "6ae2d5e6b9a493b6960925c7c87f7714843a1d74"}, "closed": true, "closedAt": "2020-04-07T14:04:32Z", "author": {"login": "dakrone"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcT0cQNAH2gAyMzk3ODU0OTc4Ojk4NmRlZjBmMjFjOTE2Y2QyNTM3MmY1ZTVmMWQ5YjRiMjE5NWIxMWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVLPqGgH2gAyMzk3ODU0OTc4OjBmNzE3ZDkzYjJhMTU1OTQ4YjVmN2M1NjRmMGFmOWY4N2FiMmE2MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "986def0f21c916cd25372f5e5f1d9b4b2195b11c", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/986def0f21c916cd25372f5e5f1d9b4b2195b11c", "committedDate": "2020-04-02T22:56:34Z", "message": "Only allow retrieving a single index or component template\n\nThis changes the Index Template v2 APIs to only allow retrieving a single \"named\" entity, where the\nnamed entity can be nothing (return everything), a wildcard (return the ones that match), or the\nname of a template.\n\nRelates to #53101"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MDc3OTYy", "url": "https://github.com/elastic/elasticsearch/pull/54694#pullrequestreview-387077962", "createdAt": "2020-04-03T09:00:11Z", "commit": {"oid": "986def0f21c916cd25372f5e5f1d9b4b2195b11c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwOTowMDoxMVrOGAMg6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwOTowMDozOFrOGAMidA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg1ODIxNg==", "bodyText": "I think in case when the template is missing here (when asking for a specific template by name) we want to throw a resource not found exception. Like was done here: https://github.com/elastic/elasticsearch/pull/54530/files#diff-e753c14c84c5edb785bc197306e5a24fR180", "url": "https://github.com/elastic/elasticsearch/pull/54694#discussion_r402858216", "createdAt": "2020-04-03T09:00:11Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/template/get/TransportGetComponentTemplateAction.java", "diffHunk": "@@ -71,22 +71,21 @@ protected void masterOperation(Task task, GetComponentTemplateAction.Request req\n         Map<String, ComponentTemplate> allTemplates = state.metadata().componentTemplates();\n \n         // If we did not ask for a specific name, then we return all templates\n-        if (request.names().length == 0) {\n+        if (request.name() == null) {\n             listener.onResponse(new GetComponentTemplateAction.Response(allTemplates));\n             return;\n         }\n \n         final Map<String, ComponentTemplate> results = new HashMap<>();\n-        for (String name : request.names()) {\n-            if (Regex.isSimpleMatchPattern(name)) {\n-                for (Map.Entry<String, ComponentTemplate> entry : allTemplates.entrySet()) {\n-                    if (Regex.simpleMatch(name, entry.getKey())) {\n-                        results.put(entry.getKey(), entry.getValue());\n-                    }\n+        String name = request.name();\n+        if (Regex.isSimpleMatchPattern(name)) {\n+            for (Map.Entry<String, ComponentTemplate> entry : allTemplates.entrySet()) {\n+                if (Regex.simpleMatch(name, entry.getKey())) {\n+                    results.put(entry.getKey(), entry.getValue());\n                 }\n-            } else if (allTemplates.containsKey(name)) {\n-                results.put(name, allTemplates.get(name));\n             }\n+        } else if (allTemplates.containsKey(name)) {\n+            results.put(name, allTemplates.get(name));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "986def0f21c916cd25372f5e5f1d9b4b2195b11c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg1ODYxMg==", "bodyText": "Throw a resource not found exception if template does not exist?", "url": "https://github.com/elastic/elasticsearch/pull/54694#discussion_r402858612", "createdAt": "2020-04-03T09:00:38Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/action/admin/indices/template/get/TransportGetIndexTemplateV2Action.java", "diffHunk": "@@ -71,22 +71,21 @@ protected void masterOperation(Task task, GetIndexTemplateV2Action.Request reque\n         Map<String, IndexTemplateV2> allTemplates = state.metadata().templatesV2();\n \n         // If we did not ask for a specific name, then we return all templates\n-        if (request.names().length == 0) {\n+        if (request.name() == null) {\n             listener.onResponse(new GetIndexTemplateV2Action.Response(allTemplates));\n             return;\n         }\n \n         final Map<String, IndexTemplateV2> results = new HashMap<>();\n-        for (String name : request.names()) {\n-            if (Regex.isSimpleMatchPattern(name)) {\n-                for (Map.Entry<String, IndexTemplateV2> entry : allTemplates.entrySet()) {\n-                    if (Regex.simpleMatch(name, entry.getKey())) {\n-                        results.put(entry.getKey(), entry.getValue());\n-                    }\n+        String name = request.name();\n+        if (Regex.isSimpleMatchPattern(name)) {\n+            for (Map.Entry<String, IndexTemplateV2> entry : allTemplates.entrySet()) {\n+                if (Regex.simpleMatch(name, entry.getKey())) {\n+                    results.put(entry.getKey(), entry.getValue());\n                 }\n-            } else if (allTemplates.containsKey(name)) {\n-                results.put(name, allTemplates.get(name));\n             }\n+        } else if (allTemplates.containsKey(name)) {\n+            results.put(name, allTemplates.get(name));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "986def0f21c916cd25372f5e5f1d9b4b2195b11c"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDQ5OTIx", "url": "https://github.com/elastic/elasticsearch/pull/54694#pullrequestreview-387449921", "createdAt": "2020-04-03T17:31:57Z", "commit": {"oid": "986def0f21c916cd25372f5e5f1d9b4b2195b11c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f86999d8424602cf088ba9544026410f7e5561f9", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/f86999d8424602cf088ba9544026410f7e5561f9", "committedDate": "2020-04-03T20:39:05Z", "message": "Throw exception when resource is not found"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f03b2eef0589aca50a36d5b6743a49a7ec9219e", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/8f03b2eef0589aca50a36d5b6743a49a7ec9219e", "committedDate": "2020-04-03T20:59:50Z", "message": "Merge branch 'master' into itv2-only-get-single-item"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f717d93b2a155948b5f7c564f0af9f87ab2a606", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/0f717d93b2a155948b5f7c564f0af9f87ab2a606", "committedDate": "2020-04-07T04:04:33Z", "message": "Merge branch 'master' into itv2-only-get-single-item"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1333, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}