{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxODY3NTEw", "number": 62834, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwNzoxNjozNVrOEm6BCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo1Mjo0OFrOEnDmKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MjMxODgyOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/ml/inference_crud.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwNzoxNjozNVrOHXM2uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzoyMjozMVrOHXaaKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA4OTkxNQ==", "bodyText": "I'm wondering if the wording here could be more direct and say sth like: \"Use [include=definition] instead\".", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494089915", "createdAt": "2020-09-24T07:16:35Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/ml/inference_crud.yml", "diffHunk": "@@ -871,3 +871,14 @@ setup:\n   - is_false: trained_model_configs.0.estimated_heap_memory_usage\n   - is_false: trained_model_configs.0.estimated_operations\n   - is_false: trained_model_configs.0.license_level\n+---\n+\"Test deprecation of include model definition param\":\n+  - skip:\n+      features: \"warnings\"\n+  - do:\n+      warnings:\n+        - \"[include_model_definition] parameter is deprecated! Use parameter [include] and supply the flag 'definition' instead.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMxMTk3OQ==", "bodyText": "I can update the message, for sure.", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494311979", "createdAt": "2020-09-24T13:22:31Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/ml/inference_crud.yml", "diffHunk": "@@ -871,3 +871,14 @@ setup:\n   - is_false: trained_model_configs.0.estimated_heap_memory_usage\n   - is_false: trained_model_configs.0.estimated_operations\n   - is_false: trained_model_configs.0.license_level\n+---\n+\"Test deprecation of include model definition param\":\n+  - skip:\n+      features: \"warnings\"\n+  - do:\n+      warnings:\n+        - \"[include_model_definition] parameter is deprecated! Use parameter [include] and supply the flag 'definition' instead.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA4OTkxNQ=="}, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MjMyMzcwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/inference/RestGetTrainedModelsAction.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwNzoxODowNVrOHXM5qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzoyMjoxOVrOHXaZrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA5MDY2Nw==", "bodyText": "Should this constructor now go away?\n        public Request(String id, boolean includeModelDefinition, List<String> tags) {", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494090667", "createdAt": "2020-09-24T07:18:05Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/inference/RestGetTrainedModelsAction.java", "diffHunk": "@@ -62,11 +65,19 @@ protected RestChannelConsumer prepareRequest(RestRequest restRequest, NodeClient\n                 restRequest.paramAsStringArray(\n                     GetTrainedModelsAction.Request.INCLUDE.getPreferredName(),\n                     Strings.EMPTY_ARRAY)));\n-        final GetTrainedModelsAction.Request request = restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION) ?\n-            new GetTrainedModelsAction.Request(modelId,\n+        final GetTrainedModelsAction.Request request;\n+        if (restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION)) {\n+            deprecationLogger.deprecate(\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                \"[{}] parameter is deprecated! Use parameter [{}] and supply the flag 'definition' instead.\",\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                GetTrainedModelsAction.Request.INCLUDE.getPreferredName());\n+            request = new GetTrainedModelsAction.Request(modelId,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMxMTg1Mw==", "bodyText": "No, it's a convenience method for when the user calls with a deprecated flag. Consequently, itself is also deprecated.", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494311853", "createdAt": "2020-09-24T13:22:19Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/inference/RestGetTrainedModelsAction.java", "diffHunk": "@@ -62,11 +65,19 @@ protected RestChannelConsumer prepareRequest(RestRequest restRequest, NodeClient\n                 restRequest.paramAsStringArray(\n                     GetTrainedModelsAction.Request.INCLUDE.getPreferredName(),\n                     Strings.EMPTY_ARRAY)));\n-        final GetTrainedModelsAction.Request request = restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION) ?\n-            new GetTrainedModelsAction.Request(modelId,\n+        final GetTrainedModelsAction.Request request;\n+        if (restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION)) {\n+            deprecationLogger.deprecate(\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                \"[{}] parameter is deprecated! Use parameter [{}] and supply the flag 'definition' instead.\",\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                GetTrainedModelsAction.Request.INCLUDE.getPreferredName());\n+            request = new GetTrainedModelsAction.Request(modelId,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA5MDY2Nw=="}, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5Mzg4NTEwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/inference/RestGetTrainedModelsAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo1MjowOFrOHXb8IA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo1MjowOFrOHXb8IA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMzNzA1Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"[{}] parameter is deprecated! Use parameter [{}] and supply the flag 'definition' instead.\",\n          \n          \n            \n                            GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n          \n          \n            \n                            GetTrainedModelsAction.Request.INCLUDE.getPreferredName());\n          \n          \n            \n                            \"[{}] parameter is deprecated! Use [include=definition] instead.\",\n          \n          \n            \n                            GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION);", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494337056", "createdAt": "2020-09-24T13:52:08Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/inference/RestGetTrainedModelsAction.java", "diffHunk": "@@ -62,11 +65,19 @@ protected RestChannelConsumer prepareRequest(RestRequest restRequest, NodeClient\n                 restRequest.paramAsStringArray(\n                     GetTrainedModelsAction.Request.INCLUDE.getPreferredName(),\n                     Strings.EMPTY_ARRAY)));\n-        final GetTrainedModelsAction.Request request = restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION) ?\n-            new GetTrainedModelsAction.Request(modelId,\n+        final GetTrainedModelsAction.Request request;\n+        if (restRequest.hasParam(GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION)) {\n+            deprecationLogger.deprecate(\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                \"[{}] parameter is deprecated! Use parameter [{}] and supply the flag 'definition' instead.\",\n+                GetTrainedModelsAction.Request.INCLUDE_MODEL_DEFINITION,\n+                GetTrainedModelsAction.Request.INCLUDE.getPreferredName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5Mzg4ODQzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/ml/inference_crud.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo1Mjo0OFrOHXb-Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxMzo1Mjo0OFrOHXb-Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMzNzYxOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    - \"[include_model_definition] parameter is deprecated! Use parameter [include] and supply the flag 'definition' instead.\"\n          \n          \n            \n                    - \"[include_model_definition] parameter is deprecated! Use [include=definition] instead.\"", "url": "https://github.com/elastic/elasticsearch/pull/62834#discussion_r494337618", "createdAt": "2020-09-24T13:52:48Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/ml/inference_crud.yml", "diffHunk": "@@ -871,3 +871,14 @@ setup:\n   - is_false: trained_model_configs.0.estimated_heap_memory_usage\n   - is_false: trained_model_configs.0.estimated_operations\n   - is_false: trained_model_configs.0.license_level\n+---\n+\"Test deprecation of include model definition param\":\n+  - skip:\n+      features: \"warnings\"\n+  - do:\n+      warnings:\n+        - \"[include_model_definition] parameter is deprecated! Use parameter [include] and supply the flag 'definition' instead.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d81be312474a095f10fdc78a5faefb7560a71a2d"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3337, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}