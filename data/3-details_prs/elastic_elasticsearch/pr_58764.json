{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMTg0Mzg5", "number": 58764, "title": "Fix types deprecation warning for put mapping.", "bodyText": "In #38825, we switched from issuing a types warning if include_type_name is\nmissing or true, to only issuing a warning when include_type_name is\nmissing. However we missed the 'put mapping' API in that PR.\nAddresses #58675.", "createdAt": "2020-06-30T17:23:11Z", "url": "https://github.com/elastic/elasticsearch/pull/58764", "merged": true, "mergeCommit": {"oid": "f57743e7976c24acdce41d366ef2aeeedc947174"}, "closed": true, "closedAt": "2020-06-30T19:59:22Z", "author": {"login": "jtibshirani"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwY2iIAH2gAyNDQyMTg0Mzg5OmNjMzNhMjA0Mjc3ZmFjOTkzY2YyOTYwNDFjYTYzN2QxNjQ0ZTgxNmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwbFP6gFqTQ0MDMzMzgzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cc33a204277fac993cf296041ca637d1644e816d", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/cc33a204277fac993cf296041ca637d1644e816d", "committedDate": "2020-06-30T17:11:44Z", "message": "Fix types deprecation warning for put mapping."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjcyODE3", "url": "https://github.com/elastic/elasticsearch/pull/58764#pullrequestreview-440272817", "createdAt": "2020-06-30T18:17:38Z", "commit": {"oid": "cc33a204277fac993cf296041ca637d1644e816d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODoxNzozOFrOGrI5lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODoxNzozOFrOGrI5lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg4Nzc2Ng==", "bodyText": "If I  set up include_type_name=true, do we still want to allow typed \"put mapping request\" ?\nFrom what it looks like now, my typed request will fail even if I set include_type_name=true.", "url": "https://github.com/elastic/elasticsearch/pull/58764#discussion_r447887766", "createdAt": "2020-06-30T18:17:38Z", "author": {"login": "mayya-sharipova"}, "path": "server/src/main/java/org/elasticsearch/rest/action/admin/indices/RestPutMappingAction.java", "diffHunk": "@@ -81,19 +81,19 @@ public String getName() {\n     public RestChannelConsumer prepareRequest(final RestRequest request, final NodeClient client) throws IOException {\n         PutMappingRequest putMappingRequest = putMappingRequest(Strings.splitStringByCommaToArray(request.param(\"index\")));\n \n-        boolean includeTypeName = request.paramAsBoolean(INCLUDE_TYPE_NAME_PARAMETER,\n-            DEFAULT_INCLUDE_TYPE_NAME_POLICY);\n         String type = request.param(\"type\");\n         Map<String, Object> sourceAsMap = XContentHelper.convertToMap(request.requiredContent(), false,\n             request.getXContentType()).v2();\n \n-        if (includeTypeName) {\n+        if (request.hasParam(INCLUDE_TYPE_NAME_PARAMETER) == false) {\n             deprecationLogger.deprecatedAndMaybeLog(\"put_mapping_with_types\", TYPES_DEPRECATION_MESSAGE);\n         } else if (type != null || isMappingSourceTyped(MapperService.SINGLE_MAPPING_NAME, sourceAsMap)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc33a204277fac993cf296041ca637d1644e816d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "478ceb9ae66381d807c9aac93032caabbae5aff6", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/478ceb9ae66381d807c9aac93032caabbae5aff6", "committedDate": "2020-06-30T18:20:01Z", "message": "Correct logic for checking include_type_name."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMzMzODM2", "url": "https://github.com/elastic/elasticsearch/pull/58764#pullrequestreview-440333836", "createdAt": "2020-06-30T19:47:37Z", "commit": {"oid": "478ceb9ae66381d807c9aac93032caabbae5aff6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2428, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}