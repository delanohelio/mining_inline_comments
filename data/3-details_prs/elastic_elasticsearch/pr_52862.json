{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNTk0MTIy", "number": 52862, "title": "Updates to TESTING.asciidoc for REST testing", "bodyText": "Update documentation for:\n\nrestResources config (related #52114)\ncall out YAML vs. Java based Rest tests\nupdate example to use newer syntax\nupdate example to target a test that is not skipped\nprovide example for bwcRest test (related #52383)", "createdAt": "2020-02-27T01:45:36Z", "url": "https://github.com/elastic/elasticsearch/pull/52862", "merged": true, "mergeCommit": {"oid": "2d85e4167accf84d5471d4c921919ed0b78725d1"}, "closed": true, "closedAt": "2020-02-27T17:08:39Z", "author": {"login": "jakelandis"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIRM2hAH2gAyMzgwNTk0MTIyOjc5OWEwOTc1M2I4YjAyNWJiYWFkMjAwODM2ZTg0ODdjYTZhMWY0ZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcId95iAFqTM2NTgwODA5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "799a09753b8b025bbaad200836e8487ca6a1f4f4", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/799a09753b8b025bbaad200836e8487ca6a1f4f4", "committedDate": "2020-02-27T01:39:54Z", "message": "updates to TESTING.asciidoc for rest testing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDA5MTc5", "url": "https://github.com/elastic/elasticsearch/pull/52862#pullrequestreview-365409179", "createdAt": "2020-02-27T04:32:52Z", "commit": {"oid": "799a09753b8b025bbaad200836e8487ca6a1f4f4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODA4MDk4", "url": "https://github.com/elastic/elasticsearch/pull/52862#pullrequestreview-365808098", "createdAt": "2020-02-27T16:31:06Z", "commit": {"oid": "799a09753b8b025bbaad200836e8487ca6a1f4f4"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjozMTowNlrOFvYL5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjozMTowNlrOFvYL5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIyMzY1NQ==", "bodyText": "Is the underscore prefix to \"common\" required?", "url": "https://github.com/elastic/elasticsearch/pull/52862#discussion_r385223655", "createdAt": "2020-02-27T16:31:06Z", "author": {"login": "mark-vieira"}, "path": "TESTING.asciidoc", "diffHunk": "@@ -270,34 +270,49 @@ code 137 (128 + 9, where 9 means SIGKILL).\n \n == Testing the REST layer\n \n-The available integration tests make use of the java API to communicate with\n-the elasticsearch nodes, using the internal binary transport (port 9300 by\n-default).\n-The REST layer is tested through specific tests that are shared between all\n-the elasticsearch official clients and consist of YAML files that describe the\n+The REST layer is tested through specific tests that are executed against\n+a cluster that is configured and initialized via Gradle. The tests\n+themselves can be written in either Java or with a YAML based DSL.\n+\n+YAML based REST tests should be preferred since these are shared between all\n+the elasticsearch official clients. The YAML based tests describe the\n operations to be executed and the obtained results that need to be tested.\n \n-The YAML files support various operators defined in the link:/rest-api-spec/src/main/resources/rest-api-spec/test/README.asciidoc[rest-api-spec] and adhere to the link:/rest-api-spec/README.markdown[Elasticsearch REST API JSON specification]\n+The YAML tests support various operators defined in the link:/rest-api-spec/src/main/resources/rest-api-spec/test/README.asciidoc[rest-api-spec] and adhere to the link:/rest-api-spec/README.markdown[Elasticsearch REST API JSON specification]\n+In order to run the the YAML tests, the relevant API specification needs\n+to be on the test classpath. Any gradle project that has support for REST\n+tests will get the primary API on it's class path. However, to better support\n+Gradle incremental builds, it is recommended to explicitly declare which\n+parts of the API the tests depend upon.\n+\n+For example:\n+---------------------------------------------------------------------------\n+restResources {\n+  restApi {\n+    includeCore '_common', 'indices', 'index', 'cluster', 'nodes', 'get', 'ingest'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "799a09753b8b025bbaad200836e8487ca6a1f4f4"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1997, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}