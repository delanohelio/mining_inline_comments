{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MjYyNDg3", "number": 54728, "title": "Wipe data streams in each REST test", "bodyText": "Addresses #54693 (comment)\nRelates to #53100", "createdAt": "2020-04-03T16:12:49Z", "url": "https://github.com/elastic/elasticsearch/pull/54728", "merged": true, "mergeCommit": {"oid": "87ce139b46c0297c1daebae408f7b8e5e037ab5f"}, "closed": true, "closedAt": "2020-04-06T14:54:59Z", "author": {"login": "danhermann"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUDPbWAH2gAyMzk4MjYyNDg3OjQ5NDlhMDFkYTUyMzIzYjFmNmUzZWRhMjUyZmRlYmY4NDBmNTk5YzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcU_RukgH2gAyMzk4MjYyNDg3OjM5Zjg0ZGJmMWUwOTIxZDg2NTRhOGFhNGU2MDc0ZTU3NGM4MDBmNGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4949a01da52323b1f6e3eda252fdebf840f599c6", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/4949a01da52323b1f6e3eda252fdebf840f599c6", "committedDate": "2020-04-03T16:11:08Z", "message": "wipe data streams in each REST test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDU2Mzc3", "url": "https://github.com/elastic/elasticsearch/pull/54728#pullrequestreview-387456377", "createdAt": "2020-04-03T17:41:32Z", "commit": {"oid": "4949a01da52323b1f6e3eda252fdebf840f599c6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzo0MTozM1rOGAgZAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzo0MTozM1rOGAgZAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE4Mzg3Mg==", "bodyText": "This will likely have to catch the exception when datastreams aren't available (think BWC tests with 7.7 or earlier)", "url": "https://github.com/elastic/elasticsearch/pull/54728#discussion_r403183872", "createdAt": "2020-04-03T17:41:33Z", "author": {"login": "dakrone"}, "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "diffHunk": "@@ -600,6 +614,10 @@ protected static void wipeAllIndices() throws IOException {\n         }\n     }\n \n+    protected static void wipeDataStreams() throws IOException {\n+        adminClient().performRequest(new Request(\"DELETE\", \"_data_stream/*\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4949a01da52323b1f6e3eda252fdebf840f599c6"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "335da059c5dfac0d2dc0a18b7bc81e203b962100", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/335da059c5dfac0d2dc0a18b7bc81e203b962100", "committedDate": "2020-04-03T21:05:09Z", "message": "accommodate situations where data streams are enabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "345caf5729cb25eb77322bb1aa596c58ccd5ca7f", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/345caf5729cb25eb77322bb1aa596c58ccd5ca7f", "committedDate": "2020-04-03T21:16:05Z", "message": "Merge branch 'master' into wipe_data_streams_in_rest_tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46632b21fc1ad8865b94874e99fbde4670d726c9", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/46632b21fc1ad8865b94874e99fbde4670d726c9", "committedDate": "2020-04-03T21:35:54Z", "message": "broaden failure exclusion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3OTUwNjQ4", "url": "https://github.com/elastic/elasticsearch/pull/54728#pullrequestreview-387950648", "createdAt": "2020-04-06T05:57:36Z", "commit": {"oid": "46632b21fc1ad8865b94874e99fbde4670d726c9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNTo1NzozNlrOGBIwYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNTo1NzozNlrOGBIwYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg0NTIxNw==", "bodyText": "Maybe also check that the response code is 405? This is what we return in the case a rest action hasn't been implemented.", "url": "https://github.com/elastic/elasticsearch/pull/54728#discussion_r403845217", "createdAt": "2020-04-06T05:57:36Z", "author": {"login": "martijnvg"}, "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "diffHunk": "@@ -600,6 +614,14 @@ protected static void wipeAllIndices() throws IOException {\n         }\n     }\n \n+    protected static void wipeDataStreams() throws IOException {\n+        try {\n+            adminClient().performRequest(new Request(\"DELETE\", \"_data_stream/*\"));\n+        } catch (ResponseException e) {\n+            // We hit a version of ES that doesn't have data streams enabled so it's safe to ignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46632b21fc1ad8865b94874e99fbde4670d726c9"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39f84dbf1e0921d8654a8aa4e6074e574c800f4b", "author": {"user": {"login": "danhermann", "name": "Dan Hermann"}}, "url": "https://github.com/elastic/elasticsearch/commit/39f84dbf1e0921d8654a8aa4e6074e574c800f4b", "committedDate": "2020-04-06T14:07:57Z", "message": "check for response code"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3794, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}