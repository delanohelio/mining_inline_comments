{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MDQwMDcy", "number": 56654, "title": "Prevent connection races in testEnsureWeReconnect", "bodyText": "Currently it is possible that a sniff connection round is occurring as\nwe enter another test loop in testEnsureWeReconnect. The problem is that\nonce we enter another loop, closing the connection manually can cause\nthis pre-existing connection round to fail. This round failing can fail\nthe test. This commit fixes the issue by ensuring that there are no\nin-progress connections before entering another loop.", "createdAt": "2020-05-13T00:13:41Z", "url": "https://github.com/elastic/elasticsearch/pull/56654", "merged": true, "mergeCommit": {"oid": "9c7e0d4ddb2aefb694ed0935029a4206a0b036e0"}, "closed": true, "closedAt": "2020-05-13T22:57:46Z", "author": {"login": "tbrooks8"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgsH1FAH2gAyNDE3MDQwMDcyOmU2OWE1Y2EzNTBlNmJjY2MxZWVkMzRlMWY4MjgxYTgxMmFkNTVmNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchAWBNAH2gAyNDE3MDQwMDcyOjk5ODdlOTQ1NjdhNDZkMTllY2YwMGQ4NTNmMGY1OTc5MmViZTkzYmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e69a5ca350e6bccc1eed34e1f8281a812ad55f5a", "author": {"user": {"login": "tbrooks8", "name": "Tim Brooks"}}, "url": "https://github.com/elastic/elasticsearch/commit/e69a5ca350e6bccc1eed34e1f8281a812ad55f5a", "committedDate": "2020-05-12T22:36:02Z", "message": "Prevent connection races in testEnsureWeReconnect\n\nCurrently it is possible that a sniff connection round is occurring as\nwe enter another test loop in testEnsureWeReconnect. The problem is that\nonce we enter another loop, closing the connection manually can cause\nthis pre-existing connection round to fail. This round failing can fail\nthe test. This commit fixes the issue by ensuring that there are no\nin-progress connections before entering another loop."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f96a7f29600083e79d437654531f31e2b530ddf6", "author": {"user": {"login": "tbrooks8", "name": "Tim Brooks"}}, "url": "https://github.com/elastic/elasticsearch/commit/f96a7f29600083e79d437654531f31e2b530ddf6", "committedDate": "2020-05-12T22:38:57Z", "message": "Change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ae61c50c4053de4259164601cffebddb2b92a87", "author": {"user": {"login": "tbrooks8", "name": "Tim Brooks"}}, "url": "https://github.com/elastic/elasticsearch/commit/5ae61c50c4053de4259164601cffebddb2b92a87", "committedDate": "2020-05-13T00:12:17Z", "message": "Merge remote-tracking branch 'upstream/master' into fix_ensure_connected_test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTk2MTA4", "url": "https://github.com/elastic/elasticsearch/pull/56654#pullrequestreview-410596108", "createdAt": "2020-05-13T05:25:26Z", "commit": {"oid": "5ae61c50c4053de4259164601cffebddb2b92a87"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNToyNToyN1rOGUh36w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNToyNToyN1rOGUh36w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE3OTY5MQ==", "bodyText": "Maybe if we care about the actual class in the logger here, just make this instead of manually passing the logger through the constructors?:\n    protected Logger logger = LogManager.getLogger(getClass());", "url": "https://github.com/elastic/elasticsearch/pull/56654#discussion_r424179691", "createdAt": "2020-05-13T05:25:27Z", "author": {"login": "original-brownbear"}, "path": "server/src/main/java/org/elasticsearch/transport/RemoteConnectionStrategy.java", "diffHunk": "@@ -111,7 +110,7 @@ public int getNumberOfChannels() {\n \n     private final int maxPendingConnectionListeners;\n \n-    private static final Logger logger = LogManager.getLogger(RemoteConnectionStrategy.class);\n+    private final Logger logger;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ae61c50c4053de4259164601cffebddb2b92a87"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8327dd14656d406e87e0576920e0e02635b98f95", "author": {"user": {"login": "tbrooks8", "name": "Tim Brooks"}}, "url": "https://github.com/elastic/elasticsearch/commit/8327dd14656d406e87e0576920e0e02635b98f95", "committedDate": "2020-05-13T21:57:12Z", "message": "Changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9987e94567a46d19ecf00d853f0f59792ebe93be", "author": {"user": {"login": "tbrooks8", "name": "Tim Brooks"}}, "url": "https://github.com/elastic/elasticsearch/commit/9987e94567a46d19ecf00d853f0f59792ebe93be", "committedDate": "2020-05-13T22:09:38Z", "message": "Merge remote-tracking branch 'upstream/master' into fix_ensure_connected_test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 62, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}