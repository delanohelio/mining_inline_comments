{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNTM3MDk5", "number": 51832, "title": "Test modifications for FIPS 140 mode", "bodyText": "Enable SunJGSS provider for Kerberos tests\nHandle the fact that in the decrypt method in KeyStoreWrapper might\nnot throw immediately when the GCM cipher is from BouncyCastle FIPS\nand we end up with a DataInputStream that has reached it's end.\nDisable tests, jarHell, testingConventions for ingest attachment\nplugin. We don't support this plugin (and document this) in FIPS\nmode.\nDon't attempt to install ingest-attachment in smoke-test-plugins", "createdAt": "2020-02-03T21:43:16Z", "url": "https://github.com/elastic/elasticsearch/pull/51832", "merged": true, "mergeCommit": {"oid": "12b24bfa57ae3b282427298cffc735ab9fe5868f"}, "closed": true, "closedAt": "2020-02-04T17:37:38Z", "author": {"login": "jkakavas"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAz6MMAH2gAyMzcwNTM3MDk5OmE5M2FiOTE4Mzg0YmUyMTM2ZjFiNTI4OWNjMGIzY2YxMmU2ODMxMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBE-iWAFqTM1MzE2MzQyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a93ab918384be2136f1b5289cc0b3cf12e683103", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/a93ab918384be2136f1b5289cc0b3cf12e683103", "committedDate": "2020-02-03T21:34:48Z", "message": "Test modifications for FIPS 140 mode\n\n- Enable SunJGSS provider for Kerberos tests\n- Handle the fact that in the decrypt method in KeyStoreWrapper might\nnot throw immediately when the GCM cipher is from BouncyCastle FIPS\nand we end up with a DataInputStream that has reached it's end.\n- Disable tests, jarHell, testingConventions for ingest attachment\nplugin. We don't support this plugin (and document this) in FIPS\nmode.\n- Don't attempt to install ingest-attachment in smoke-test-plugins"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNjQ0OTQ5", "url": "https://github.com/elastic/elasticsearch/pull/51832#pullrequestreview-352644949", "createdAt": "2020-02-03T23:55:04Z", "commit": {"oid": "a93ab918384be2136f1b5289cc0b3cf12e683103"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32766a59a437d1710163e247d63c3d1a833fd742", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/32766a59a437d1710163e247d63c3d1a833fd742", "committedDate": "2020-02-04T05:37:36Z", "message": "fix casting in stream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyODIzNjA2", "url": "https://github.com/elastic/elasticsearch/pull/51832#pullrequestreview-352823606", "createdAt": "2020-02-04T09:21:06Z", "commit": {"oid": "32766a59a437d1710163e247d63c3d1a833fd742"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOToyMTowNlrOFlM-BA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwOToyMTowNlrOFlM-BA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU1NDExNg==", "bodyText": "Should be the following instead? The other uses of stringMatchers in this method aren't wrapped in Arrays.asList.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        assertThat(logfile, anyOf(Arrays.asList(stringMatchers)));\n          \n          \n            \n                        assertThat(logfile, anyOf(stringMatchers));", "url": "https://github.com/elastic/elasticsearch/pull/51832#discussion_r374554116", "createdAt": "2020-02-04T09:21:06Z", "author": {"login": "pugnascotia"}, "path": "qa/os/src/test/java/org/elasticsearch/packaging/test/PackagingTestCase.java", "diffHunk": "@@ -310,23 +316,28 @@ public void startElasticsearch() throws Exception {\n         return Archives.startElasticsearchWithTty(installation, sh, password);\n     }\n \n-\n     public void assertElasticsearchFailure(Shell.Result result, String expectedMessage, Packages.JournaldWrapper journaldWrapper) {\n+        assertElasticsearchFailure(result, Collections.singletonList(expectedMessage), journaldWrapper);\n+    }\n \n+    public void assertElasticsearchFailure(Shell.Result result, List<String> expectedMessages, Packages.JournaldWrapper journaldWrapper) {\n+        @SuppressWarnings(\"unchecked\")\n+        Matcher<String>[] stringMatchers = expectedMessages.stream().map(CoreMatchers::containsString).toArray(Matcher[]::new);\n         if (Files.exists(installation.logs.resolve(\"elasticsearch.log\"))) {\n \n             // If log file exists, then we have bootstrapped our logging and the\n             // error should be in the logs\n             assertTrue(\"log file exists\", Files.exists(installation.logs.resolve(\"elasticsearch.log\")));\n             String logfile = FileUtils.slurp(installation.logs.resolve(\"elasticsearch.log\"));\n-            assertThat(logfile, containsString(expectedMessage));\n+\n+            assertThat(logfile, anyOf(Arrays.asList(stringMatchers)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32766a59a437d1710163e247d63c3d1a833fd742"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyODI0NDcy", "url": "https://github.com/elastic/elasticsearch/pull/51832#pullrequestreview-352824472", "createdAt": "2020-02-04T09:22:26Z", "commit": {"oid": "32766a59a437d1710163e247d63c3d1a833fd742"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dc96e63ab119212eefbff8979fbab86bdcd3027", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/6dc96e63ab119212eefbff8979fbab86bdcd3027", "committedDate": "2020-02-04T09:58:33Z", "message": "remove unnecessary wrapping to List"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a841a6a290632d3be09faf55e9c68996495a1730", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/a841a6a290632d3be09faf55e9c68996495a1730", "committedDate": "2020-02-04T10:18:39Z", "message": "checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMTYzNDI1", "url": "https://github.com/elastic/elasticsearch/pull/51832#pullrequestreview-353163425", "createdAt": "2020-02-04T17:27:56Z", "commit": {"oid": "a841a6a290632d3be09faf55e9c68996495a1730"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2987, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}