{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3MzA0NTg5", "number": 64753, "title": "Fix the earliest last modified age of translog issue.", "bodyText": "Currently translog's earliest_last_modified_age field is always 0 in _nodes/stats response.\nGET _nodes/stats?pretty\nResponse:\n....\n \"translog\" : {\n      \"operations\" : 87590,\n      \"size_in_bytes\" : 181674457,\n      \"uncommitted_operations\" : 87590,\n      \"uncommitted_size_in_bytes\" : 181674457,\n      \"earliest_last_modified_age\" : 0\n    },\n....", "createdAt": "2020-11-08T13:22:17Z", "url": "https://github.com/elastic/elasticsearch/pull/64753", "merged": true, "mergeCommit": {"oid": "7f4ead91f3a7ef93fd564166f46f6ea2b3305379"}, "closed": true, "closedAt": "2020-11-26T20:43:48Z", "author": {"login": "howardhuanghua"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdafv89AH2gAyNTE3MzA0NTg5OjA3YzI2MzQ2ZjU5NzIwYmMzZDk2ZWRmY2NlY2RjNmFiMWQwZGFhMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgZLFqgFqTUzOTU0MzM2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "07c26346f59720bc3d96edfccecdc6ab1d0daa21", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/07c26346f59720bc3d96edfccecdc6ab1d0daa21", "committedDate": "2020-11-08T12:58:42Z", "message": "Fix the earliest last modified age of translog issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53a728f4cf21b7eb26c91bf24e62e11a4a57eeb1", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/53a728f4cf21b7eb26c91bf24e62e11a4a57eeb1", "committedDate": "2020-11-08T13:21:45Z", "message": "init it in definition"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NjgyODYz", "url": "https://github.com/elastic/elasticsearch/pull/64753#pullrequestreview-538682863", "createdAt": "2020-11-25T16:45:16Z", "commit": {"oid": "53a728f4cf21b7eb26c91bf24e62e11a4a57eeb1"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dde60de4250148f1e9ce34c60afacc9fa0f85ec", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/1dde60de4250148f1e9ce34c60afacc9fa0f85ec", "committedDate": "2020-11-26T01:36:51Z", "message": "Merge branch 'master' into modify_time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22c19d5eee66faca2eabfc6664e78aa3bbedd6e0", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/22c19d5eee66faca2eabfc6664e78aa3bbedd6e0", "committedDate": "2020-11-26T01:41:47Z", "message": "keep last modify time as 0L"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MzYzOTY3", "url": "https://github.com/elastic/elasticsearch/pull/64753#pullrequestreview-539363967", "createdAt": "2020-11-26T14:32:17Z", "commit": {"oid": "22c19d5eee66faca2eabfc6664e78aa3bbedd6e0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNDozMjoxN1rOH6dzsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNDozMjoxN1rOH6dzsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2NzgyNA==", "bodyText": "Let's use this.earliestLastModifiedAge == 0.", "url": "https://github.com/elastic/elasticsearch/pull/64753#discussion_r531067824", "createdAt": "2020-11-26T14:32:17Z", "author": {"login": "dnhatn"}, "path": "server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java", "diffHunk": "@@ -80,8 +80,12 @@ public void add(TranslogStats translogStats) {\n         this.translogSizeInBytes += translogStats.translogSizeInBytes;\n         this.uncommittedOperations += translogStats.uncommittedOperations;\n         this.uncommittedSizeInBytes += translogStats.uncommittedSizeInBytes;\n-        this.earliestLastModifiedAge =\n-            Math.min(this.earliestLastModifiedAge, translogStats.earliestLastModifiedAge);\n+        if (this.earliestLastModifiedAge < 1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22c19d5eee66faca2eabfc6664e78aa3bbedd6e0"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e292b2594dbbb57287c4c088d303f763d2dae02", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/0e292b2594dbbb57287c4c088d303f763d2dae02", "committedDate": "2020-11-26T15:28:07Z", "message": "update condition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "413ddb50bbfb798400dbb3d65defa3d4db19e265", "author": {"user": {"login": "howardhuanghua", "name": "Howard"}}, "url": "https://github.com/elastic/elasticsearch/commit/413ddb50bbfb798400dbb3d65defa3d4db19e265", "committedDate": "2020-11-26T15:28:53Z", "message": "Merge branch 'master' into modify_time"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NTQzMzYz", "url": "https://github.com/elastic/elasticsearch/pull/64753#pullrequestreview-539543363", "createdAt": "2020-11-26T20:42:33Z", "commit": {"oid": "413ddb50bbfb798400dbb3d65defa3d4db19e265"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1255, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}