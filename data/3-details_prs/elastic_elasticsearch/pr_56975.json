{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNDMyMjYz", "number": 56975, "title": "Move license checks back to BuildPlugin", "bodyText": "Some standalone projects such as :distribution:archives:integ-test-zip have Java code\nvia tests, but are not need license and notice files. Applying the new ElasticsearchJavaPlugin\nin favor over the elder Standalone*Plugin can result in these non-jar\nprojects test projects throwing an error due to the lack of the license or notice file.\nThis commit moves the license check out of the new ElasticsearchJavaPlugin and applies\nonly via the elder BuildPlugin\nrelated: #56841\n======\nI'm not 100% this is the right direction, but seems pretty harmless to allow projects to opt out of the default jar creation. This PR is related to #56841 (comment) ...trying to move away from the conditional checks to that ensure specific plugins are applied.", "createdAt": "2020-05-20T00:11:20Z", "url": "https://github.com/elastic/elasticsearch/pull/56975", "merged": true, "mergeCommit": {"oid": "2e1e33d91099c4e8fb324c448875a1a015829fd5"}, "closed": true, "closedAt": "2020-05-26T17:42:12Z", "author": {"login": "jakelandis"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABci9iHngH2gAyNDIwNDMyMjYzOjIzNWUzZTgxOGQ2ZGRiMWRkZjNlNDZmYWQ4ZGI3MWFiYjdiNTMzMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjlKc0AFqTQxNjUyODIyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "235e3e818d6ddb1ddf3e46fad8db71abb7b53307", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/235e3e818d6ddb1ddf3e46fad8db71abb7b53307", "committedDate": "2020-05-20T00:00:59Z", "message": "Allow ElasticsearchJavaPlugin for non-jar based projects\n\nSome standalone projects such as :distribution:archives:integ-test-zip have tests\nbut are not intended to ever create a jar. Applying the new ElasticsearchJavaPlugin\nin favor over the elder \"Standalone*Plugin\" or BuildPlugin can result in these non-jar\nprojects erroring due to the lack of the license or notice file.\n\nTo avoid creating more permutations of ElasticsearchJavaPlugin\n(i.e. ElasticsearchJavaPluginWithoutJar), the conuming project should be able disable\nthe jar task (e.g. `jar.enabled = false`) and the license checks should be skipped as\nwell as the javadoc and sources jars.\n\nrelated: #56841"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1f5a23608b481e78290afed93dcafd04d77d8f0", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/b1f5a23608b481e78290afed93dcafd04d77d8f0", "committedDate": "2020-05-20T00:13:52Z", "message": "remove unecessary enabled check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa86e2437a88465c759b51596a7f887ebd14f69f", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/fa86e2437a88465c759b51596a7f887ebd14f69f", "committedDate": "2020-05-21T14:00:55Z", "message": "Revert \"remove unecessary enabled check\"\n\nThis reverts commit b1f5a23608b481e78290afed93dcafd04d77d8f0."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e38b55350e69141d8c659572a59c30c099cd32a", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e38b55350e69141d8c659572a59c30c099cd32a", "committedDate": "2020-05-21T14:01:06Z", "message": "Revert \"Allow ElasticsearchJavaPlugin for non-jar based projects\"\n\nThis reverts commit 235e3e818d6ddb1ddf3e46fad8db71abb7b53307."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cff148487f19d191a64902f824457be274d95c2", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/8cff148487f19d191a64902f824457be274d95c2", "committedDate": "2020-05-21T14:02:11Z", "message": "Merge remote-tracking branch 'upstream/master' into allow_disable_jar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "845a2a8b7c4eee1f6c4ae6b0ae0e081242c7d9ae", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/845a2a8b7c4eee1f6c4ae6b0ae0e081242c7d9ae", "committedDate": "2020-05-21T14:03:47Z", "message": "remove license check from ElasticsearchJavaPlugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzI3MDI1", "url": "https://github.com/elastic/elasticsearch/pull/56975#pullrequestreview-416327025", "createdAt": "2020-05-21T17:01:19Z", "commit": {"oid": "845a2a8b7c4eee1f6c4ae6b0ae0e081242c7d9ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzowMToxOVrOGY7EAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzowMToxOVrOGY7EAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc4NjY4OQ==", "bodyText": "We shouldn't be calling these methods statically; that is what we are trying to move away from. Can you please move the notice/license configuration to a new method in BuildPlugin, and leave the other stuff intact?", "url": "https://github.com/elastic/elasticsearch/pull/56975#discussion_r428786689", "createdAt": "2020-05-21T17:01:19Z", "author": {"login": "rjernst"}, "path": "buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy", "diffHunk": "@@ -82,6 +82,7 @@ class BuildPlugin implements Plugin<Project> {\n             )\n         }\n         project.pluginManager.apply('elasticsearch.java')\n+        ElasticsearchJavaPlugin.configureJars(project)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "845a2a8b7c4eee1f6c4ae6b0ae0e081242c7d9ae"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "908ee17737f1a283cf0535d0bfe102fa65144fb4", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/908ee17737f1a283cf0535d0bfe102fa65144fb4", "committedDate": "2020-05-21T17:55:46Z", "message": "resurect Groovy configureJars and remove from Java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5812825ca03da18918f8b817a8650840d6b97165", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/5812825ca03da18918f8b817a8650840d6b97165", "committedDate": "2020-05-21T18:19:38Z", "message": "only move license stuff back to groovy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e504625e549ef9e7715772b8bea948e5bfd486d5", "author": {"user": {"login": "jakelandis", "name": "Jake Landis"}}, "url": "https://github.com/elastic/elasticsearch/commit/e504625e549ef9e7715772b8bea948e5bfd486d5", "committedDate": "2020-05-21T18:34:02Z", "message": "call java configureJars"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTI4MjIx", "url": "https://github.com/elastic/elasticsearch/pull/56975#pullrequestreview-416528221", "createdAt": "2020-05-21T22:11:20Z", "commit": {"oid": "e504625e549ef9e7715772b8bea948e5bfd486d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4721, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}