{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MDM4MDM0", "number": 56506, "title": "Deduplicate Strings in REST Bulk Request Parsing", "bodyText": "We can save a little memory here since these strings might live for quite a while on the coordinating node.", "createdAt": "2020-05-11T11:16:15Z", "url": "https://github.com/elastic/elasticsearch/pull/56506", "merged": true, "mergeCommit": {"oid": "e742e1bebe42016d5b86f75aa89ea5e0c19754cd"}, "closed": true, "closedAt": "2020-05-12T06:50:14Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgNRU6gH2gAyNDE2MDM4MDM0OjAwNTZiYTQxMDdlZWNjZDQ0MWYwYzFiYmM5MTU2ZGRjZjUyYWUyNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgd3UsAH2gAyNDE2MDM4MDM0OjdhNmU5YWZiYjZhMmVmYzVlZGM3YzgxMjZlNzU2YjllODQ0OWRkZjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0056ba4107eeccd441f0c1bbc9156ddcf52ae253", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/0056ba4107eeccd441f0c1bbc9156ddcf52ae253", "committedDate": "2020-05-11T10:39:21Z", "message": "Deduplicate Strings in REST Bulk Request Parsing\n\nWe can save a little memory here since these strings might live for quite\na while on the coordinating node."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NDkxNzY4", "url": "https://github.com/elastic/elasticsearch/pull/56506#pullrequestreview-409491768", "createdAt": "2020-05-11T20:07:58Z", "commit": {"oid": "0056ba4107eeccd441f0c1bbc9156ddcf52ae253"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMDowNzo1OVrOGTrftQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMDowNzo1OVrOGTrftQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzI4ODc1Nw==", "bodyText": "If we are going to do this, can we at least add a comment here explaining the intent? Specifically noting that this doesn't save on the actual instantiation of the duplicate strings, only on the lifetime of those duplicates (can be GC'd after parsing is complete).", "url": "https://github.com/elastic/elasticsearch/pull/56506#discussion_r423288757", "createdAt": "2020-05-11T20:07:59Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/action/bulk/BulkRequestParser.java", "diffHunk": "@@ -115,6 +118,7 @@ public void parse(\n         int line = 0;\n         int from = 0;\n         byte marker = xContent.streamSeparator();\n+        final Map<String, String> stringDeduplicator = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0056ba4107eeccd441f0c1bbc9156ddcf52ae253"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "792447351fe341955ba494d6508a255d73f56f52", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/792447351fe341955ba494d6508a255d73f56f52", "committedDate": "2020-05-11T20:08:58Z", "message": "Merge remote-tracking branch 'elastic/master' into dedup-index-name-in-parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02e3fc42f7b0d29424ee08b634413c6ea64eb09c", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/02e3fc42f7b0d29424ee08b634413c6ea64eb09c", "committedDate": "2020-05-11T20:13:30Z", "message": "comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NTA1OTcy", "url": "https://github.com/elastic/elasticsearch/pull/56506#pullrequestreview-409505972", "createdAt": "2020-05-11T20:29:16Z", "commit": {"oid": "02e3fc42f7b0d29424ee08b634413c6ea64eb09c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5764f6b66e0a5c7bb0f15605f6b730cf2d54f4c7", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/5764f6b66e0a5c7bb0f15605f6b730cf2d54f4c7", "committedDate": "2020-05-12T05:40:15Z", "message": "Merge remote-tracking branch 'elastic/master' into dedup-index-name-in-parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a6e9afbb6a2efc5edc7c8126e756b9e8449ddf8", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/7a6e9afbb6a2efc5edc7c8126e756b9e8449ddf8", "committedDate": "2020-05-12T05:59:20Z", "message": "CR: add test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 136, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}