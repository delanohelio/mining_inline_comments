{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0NzIyODc2", "number": 59063, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNToxNzoxOFrOELuzbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNjoxNzo1MFrOELwU0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzM2NjIxOnYy", "diffSide": "RIGHT", "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNToxNzoxOFrOGtbySQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNTo0ODoxNlrOGtdDjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI5NDM0NQ==", "bodyText": "I would rename the arg to fetchSize", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450294345", "createdAt": "2020-07-06T15:17:18Z", "author": {"login": "matriv"}, "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "diffHunk": "@@ -172,14 +175,26 @@ public EqlSearchRequest implicitJoinKeyField(String implicitJoinKeyField) {\n         return this;\n     }\n \n+    public int size() {\n+        return this.size;\n+    }\n+\n+    public EqlSearchRequest size(int size) {\n+        this.size = size;\n+        if (fetchSize <= 0) {\n+            throw new IllegalArgumentException(\"size must be greater than 0\");\n+        }\n+        return this;\n+    }\n+\n     public int fetchSize() {\n         return this.fetchSize;\n     }\n \n     public EqlSearchRequest fetchSize(int size) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDMxNTE0OQ==", "bodyText": "Will rename it in a follow-up PR. I'd like to merge this in considering it took 3 times due to transient issues and backport it to 7.x", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450315149", "createdAt": "2020-07-06T15:48:16Z", "author": {"login": "costin"}, "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "diffHunk": "@@ -172,14 +175,26 @@ public EqlSearchRequest implicitJoinKeyField(String implicitJoinKeyField) {\n         return this;\n     }\n \n+    public int size() {\n+        return this.size;\n+    }\n+\n+    public EqlSearchRequest size(int size) {\n+        this.size = size;\n+        if (fetchSize <= 0) {\n+            throw new IllegalArgumentException(\"size must be greater than 0\");\n+        }\n+        return this;\n+    }\n+\n     public int fetchSize() {\n         return this.fetchSize;\n     }\n \n     public EqlSearchRequest fetchSize(int size) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI5NDM0NQ=="}, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzM3MDgxOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/eql/qa/common/src/main/java/org/elasticsearch/test/eql/CommonEqlActionTestCase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNToxODoyMVrOGtb1HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNTo0Nzo0MlrOGtdCGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI5NTA2OA==", "bodyText": "Does it make sense to make it a random between let's say 1 and 10?", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450295068", "createdAt": "2020-07-06T15:18:21Z", "author": {"login": "matriv"}, "path": "x-pack/plugin/eql/qa/common/src/main/java/org/elasticsearch/test/eql/CommonEqlActionTestCase.java", "diffHunk": "@@ -144,6 +144,9 @@ protected EqlSearchResponse runQuery(String index, String query, boolean isCaseS\n         EqlSearchRequest request = new EqlSearchRequest(testIndexName, query);\n         request.isCaseSensitive(isCaseSensitive);\n         request.tiebreakerField(\"event.sequence\");\n+        // some queries return more than 10 results\n+        request.size(50);\n+        request.fetchSize(2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDMxNDc3OQ==", "bodyText": "It does - it has to be 2 since we're talking about a window (1 would work but the algo would have to change - that requires an extra call that I'd rather avoid).\nI've pushed it with 2 just to get the build running enough times with this minimum size - I'll follow-up in the until PR with random.", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450314779", "createdAt": "2020-07-06T15:47:42Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/qa/common/src/main/java/org/elasticsearch/test/eql/CommonEqlActionTestCase.java", "diffHunk": "@@ -144,6 +144,9 @@ protected EqlSearchResponse runQuery(String index, String query, boolean isCaseS\n         EqlSearchRequest request = new EqlSearchRequest(testIndexName, query);\n         request.isCaseSensitive(isCaseSensitive);\n         request.tiebreakerField(\"event.sequence\");\n+        // some queries return more than 10 results\n+        request.size(50);\n+        request.fetchSize(2);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI5NTA2OA=="}, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzYxMDExOnYy", "diffSide": "RIGHT", "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNjoxNjoyN1rOGteILg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNjo1NDo0OVrOGtfj6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDMzMjcxOA==", "bodyText": "@jrodewig A heads-up on these two parameters.\nThe default size of the response changed to 10 from 50 (aligned with that of the search api).\nAdditionally the fetch_size parameters has been introduced to indicate how large the page for sequence matching is. A large page means faster results and less search calls but it does so at the expense of memory (more data needs to be returned).", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450332718", "createdAt": "2020-07-06T16:16:27Z", "author": {"login": "costin"}, "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "diffHunk": "@@ -60,6 +61,7 @@\n     static final String KEY_IMPLICIT_JOIN_KEY_FIELD = \"implicit_join_key_field\";\n     static final String KEY_CASE_SENSITIVE = \"case_sensitive\";\n     static final String KEY_SIZE = \"size\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM1NjIwMQ==", "bodyText": "Thanks for the heads up. #59085 should already cover the changes to size. I'll work on documenting the fetch_size param.", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450356201", "createdAt": "2020-07-06T16:54:49Z", "author": {"login": "jrodewig"}, "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/eql/EqlSearchRequest.java", "diffHunk": "@@ -60,6 +61,7 @@\n     static final String KEY_IMPLICIT_JOIN_KEY_FIELD = \"implicit_join_key_field\";\n     static final String KEY_CASE_SENSITIVE = \"case_sensitive\";\n     static final String KEY_SIZE = \"size\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDMzMjcxOA=="}, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNzYxNTUzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/eql/src/test/resources/queryfolder_tests.txt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNjoxNzo1MFrOGteLhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQxNjoxNzo1MFrOGteLhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDMzMzU3Mg==", "bodyText": "@jrodewig tail and pipe should now work for all type of queries; if you encountered problems when trying to use them in the docs let me know since that would be a bug.", "url": "https://github.com/elastic/elasticsearch/pull/59063#discussion_r450333572", "createdAt": "2020-07-06T16:17:50Z", "author": {"login": "costin"}, "path": "x-pack/plugin/eql/src/test/resources/queryfolder_tests.txt", "diffHunk": "@@ -534,3 +534,27 @@ process where subtract(43, serial_event_id) == 41\n InternalQlScriptUtils.sub(params.v0,InternalQlScriptUtils.docValue(doc,params.v1)),params.v2))\",\n \"params\":{\"v0\":43,\"v1\":\"serial_event_id\",\"v2\":41}\n ;\n+\n+eventQueryDefaultLimit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a108555d478a526c208cb4e25bc6ce85b14c8fe8"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2052, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}