{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NjQ5MzAz", "number": 61983, "title": "Ensure domain_name setting for AD realm is present", "bodyText": "We would only check for a null value and not for an empty string so\nthat meant that we were not actually enforcing this mandatory\nsetting.\nThis is another take at #61859 . Moved the validation to the setting\nitself as we would use its value in SessionFactory.ldapServers to\nbuild the LDAP URL before the existing valdation actually happened\nin ActiveDirectorySessionFactory. This would throw an LDAPSDK\nexception.", "createdAt": "2020-09-04T12:42:23Z", "url": "https://github.com/elastic/elasticsearch/pull/61983", "merged": true, "mergeCommit": {"oid": "b8abce28e5038c3891e359023b8650c4f477f30a"}, "closed": true, "closedAt": "2020-10-02T08:28:25Z", "author": {"login": "jkakavas"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFkiT9gH2gAyNDc5NjQ5MzAzOjIwOGNkNWI3MmI4NmM2MzVjMzVjOTA0MGFhMjgzZWVlNjdmYWFjYjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNTpI_gBqjM4MTQ1NTcyMTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "208cd5b72b86c635c35c9040aa283eee67faacb2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/208cd5b72b86c635c35c9040aa283eee67faacb2", "committedDate": "2020-09-04T12:40:55Z", "message": "Ensure domain_name setting for AD realm is present\n\nWe would only check for a null value and not for an empty string so\nthat meant that we were not actually enforcing this mandatory\nsetting.\nThis is another take at #61859 . Moved the validation to the setting\nitself as we would use it's value in SessionFactory.ldapServers to\nbuild the LDAP URL before the existing valdation actually happened\nin ActiveDirectorySessionFactory. This would throw an LDAPSDK\nexception before we can validate and throw an IAE."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e483f3270aa75dc0b35ce228fa1f14a7e34c1c53", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/e483f3270aa75dc0b35ce228fa1f14a7e34c1c53", "committedDate": "2020-09-04T13:30:55Z", "message": "Cause one has to forget the same test every time they raise the same PR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNzg3MDA4", "url": "https://github.com/elastic/elasticsearch/pull/61983#pullrequestreview-483787008", "createdAt": "2020-09-08T04:28:11Z", "commit": {"oid": "e483f3270aa75dc0b35ce228fa1f14a7e34c1c53"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDoyODoxMVrOHOMRZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDoyODoxMVrOHOMRZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY0MzE3NA==", "bodyText": "You should be able to use RealmSettings.affixSetting instead here, which will make it a tiny bit shorter.", "url": "https://github.com/elastic/elasticsearch/pull/61983#discussion_r484643174", "createdAt": "2020-09-08T04:28:11Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/ldap/ActiveDirectorySessionFactorySettings.java", "diffHunk": "@@ -17,7 +18,12 @@\n public final class ActiveDirectorySessionFactorySettings {\n     private static final String AD_DOMAIN_NAME_SETTING_KEY = \"domain_name\";\n     public static final Setting.AffixSetting<String> AD_DOMAIN_NAME_SETTING\n-            = RealmSettings.simpleString(AD_TYPE, AD_DOMAIN_NAME_SETTING_KEY, Setting.Property.NodeScope);\n+        = Setting.affixKeySetting(RealmSettings.realmSettingPrefix(AD_TYPE), AD_DOMAIN_NAME_SETTING_KEY,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e483f3270aa75dc0b35ce228fa1f14a7e34c1c53"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2c819563e57995cbafb95531e2bca5df041ed5a", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b2c819563e57995cbafb95531e2bca5df041ed5a", "committedDate": "2020-09-28T13:29:59Z", "message": "Merge commit '208cd5b72b86c635c35c9040aa283eee67faacb2' into domain_name_mandatory_take2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75af83d1d0e902aca366c52ee2fc0b032263fa93", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/75af83d1d0e902aca366c52ee2fc0b032263fa93", "committedDate": "2020-09-28T13:30:27Z", "message": "Merge commit 'e483f3270aa75dc0b35ce228fa1f14a7e34c1c53' into domain_name_mandatory_take2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e0cd4c2c9ef51b26eff9bc627f00c65a92d1bb5", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7e0cd4c2c9ef51b26eff9bc627f00c65a92d1bb5", "committedDate": "2020-09-28T13:31:03Z", "message": "Use RealmSettings.AffixSetting"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "79e474b347152375ca5971c4656f5fbfeb9a8879", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/79e474b347152375ca5971c4656f5fbfeb9a8879", "committedDate": "2020-09-28T13:23:25Z", "message": "Merge remote-tracking branch 'origin/master' into domain_name_mandatory_take2"}, "afterCommit": {"oid": "7e0cd4c2c9ef51b26eff9bc627f00c65a92d1bb5", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7e0cd4c2c9ef51b26eff9bc627f00c65a92d1bb5", "committedDate": "2020-09-28T13:31:03Z", "message": "Use RealmSettings.AffixSetting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4873, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}