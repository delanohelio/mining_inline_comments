{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0NzI2Nzcz", "number": 65314, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxMDozOVrOFMK8Kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxMzowNlrOFMK_nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ4MzA2NDc0OnYy", "diffSide": "RIGHT", "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/SetProcessor.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxMDozOVrOIPwF-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxODozMTo0OFrOIP3b7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NzUxMw==", "bodyText": "are we sure we want mime_type as a name here? I thought mime was replace with media_type\nbut wouldn't content_type  be more consistent with what we have in mustache templating engine?", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553387513", "createdAt": "2021-01-07T15:10:39Z", "author": {"login": "pgomulka"}, "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/SetProcessor.java", "diffHunk": "@@ -110,10 +111,11 @@ public SetProcessor create(Map<String, Processor.Factory> registry, String proce\n                                    String description, Map<String, Object> config) throws Exception {\n             String field = ConfigurationUtils.readStringProperty(TYPE, processorTag, config, \"field\");\n             String copyFrom = ConfigurationUtils.readOptionalStringProperty(TYPE, processorTag, config, \"copy_from\");\n+            String mimeType = ConfigurationUtils.readMimeTypeProperty(TYPE, processorTag, config, \"mime_type\", \"application/json\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MDYxOQ==", "bodyText": "or we could consider to rename the content_type to media_type (in mustache template engine)?", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553390619", "createdAt": "2021-01-07T15:15:49Z", "author": {"login": "pgomulka"}, "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/SetProcessor.java", "diffHunk": "@@ -110,10 +111,11 @@ public SetProcessor create(Map<String, Processor.Factory> registry, String proce\n                                    String description, Map<String, Object> config) throws Exception {\n             String field = ConfigurationUtils.readStringProperty(TYPE, processorTag, config, \"field\");\n             String copyFrom = ConfigurationUtils.readOptionalStringProperty(TYPE, processorTag, config, \"copy_from\");\n+            String mimeType = ConfigurationUtils.readMimeTypeProperty(TYPE, processorTag, config, \"mime_type\", \"application/json\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NzUxMw=="}, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5NDg3Mw==", "bodyText": "I'm happy to rename to whatever is most appropriate. I went with mime_type because that is what was used in CustomMustacheFactory but I would agree that media_type or possibly content_type would be better.", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553394873", "createdAt": "2021-01-07T15:22:32Z", "author": {"login": "danhermann"}, "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/SetProcessor.java", "diffHunk": "@@ -110,10 +111,11 @@ public SetProcessor create(Map<String, Processor.Factory> registry, String proce\n                                    String description, Map<String, Object> config) throws Exception {\n             String field = ConfigurationUtils.readStringProperty(TYPE, processorTag, config, \"field\");\n             String copyFrom = ConfigurationUtils.readOptionalStringProperty(TYPE, processorTag, config, \"copy_from\");\n+            String mimeType = ConfigurationUtils.readMimeTypeProperty(TYPE, processorTag, config, \"mime_type\", \"application/json\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NzUxMw=="}, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUwNzgyMg==", "bodyText": "+1 to follow up with a change to media_type to be more correct.", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553507822", "createdAt": "2021-01-07T18:31:48Z", "author": {"login": "jakelandis"}, "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/SetProcessor.java", "diffHunk": "@@ -110,10 +111,11 @@ public SetProcessor create(Map<String, Processor.Factory> registry, String proce\n                                    String description, Map<String, Object> config) throws Exception {\n             String field = ConfigurationUtils.readStringProperty(TYPE, processorTag, config, \"field\");\n             String copyFrom = ConfigurationUtils.readOptionalStringProperty(TYPE, processorTag, config, \"copy_from\");\n+            String mimeType = ConfigurationUtils.readMimeTypeProperty(TYPE, processorTag, config, \"mime_type\", \"application/json\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NzUxMw=="}, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ4MzA3MzU3OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxNToxMzowNlrOIPwLcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQxNzoxNjowNFrOIXJFeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4ODkxNA==", "bodyText": "do we want the se hardcoded? What if someone specifies application/json; charset=utf-8 ?\nWould it be of any help if this bit was unified with what CustomMustacheFactory defines? I made an attempt here https://github.com/elastic/elasticsearch/pull/66857/files#diff-207cacc1e4a5b24109a693c0b63dd762156452bb5984b5ce04499b28e6c191e8R28", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553388914", "createdAt": "2021-01-07T15:13:06Z", "author": {"login": "pgomulka"}, "path": "server/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java", "diffHunk": "@@ -49,6 +49,7 @@\n \n     public static final String TAG_KEY = \"tag\";\n     public static final String DESCRIPTION_KEY = \"description\";\n+    public static final String[] VALID_MIME_TYPES = {\"application/json\", \"text/plain\", \"application/x-www-form-urlencoded\"};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5OTAyMA==", "bodyText": "I agree that unifying this set of options would be good. I can do that after you merge that PR. I don't believe that we want to allow the specification of a particular character set for the use case of the ingest processor, though.", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r553399020", "createdAt": "2021-01-07T15:28:43Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java", "diffHunk": "@@ -49,6 +49,7 @@\n \n     public static final String TAG_KEY = \"tag\";\n     public static final String DESCRIPTION_KEY = \"description\";\n+    public static final String[] VALID_MIME_TYPES = {\"application/json\", \"text/plain\", \"application/x-www-form-urlencoded\"};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4ODkxNA=="}, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTEzNzAxNw==", "bodyText": "Now that #66857 has been closed in favor of #67677, I believe the only improvement that can be made here is changing content_type to media_type. I'll go ahead and open a PR for that.", "url": "https://github.com/elastic/elasticsearch/pull/65314#discussion_r561137017", "createdAt": "2021-01-20T17:16:04Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java", "diffHunk": "@@ -49,6 +49,7 @@\n \n     public static final String TAG_KEY = \"tag\";\n     public static final String DESCRIPTION_KEY = \"description\";\n+    public static final String[] VALID_MIME_TYPES = {\"application/json\", \"text/plain\", \"application/x-www-form-urlencoded\"};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4ODkxNA=="}, "originalCommit": {"oid": "aefd9dce21e124c88016bc6bd884495df0803d2c"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2897, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}