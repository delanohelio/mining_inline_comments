{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzQ3NzQx", "number": 61734, "title": "Update authc failure headers on license change", "bodyText": "DefaultAuthenticationFailureHandler determines the set of response headers based on the active realms at startup.\nHowever, the Realms list may be empty if the node thinks it has a TRIAL or BASIC license at startup (because we default security off in those cases).\nThe handler is never updated if the license state changes.\n\nThe fix is to add a call-back for license change to update the AuthenticationFailureHandler's Headers to reflect the new license property.\nResolves: #56318", "createdAt": "2020-08-31T14:49:24Z", "url": "https://github.com/elastic/elasticsearch/pull/61734", "merged": true, "mergeCommit": {"oid": "183533734b7390b9c94bb29ec764f705ae1e476b"}, "closed": true, "closedAt": "2020-09-16T09:21:13Z", "author": {"login": "BigPandaToo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE0hxYgFqTQ4MDQ3OTExNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJW7T_gH2gAyNDc2MzQ3NzQxOmY2ZTAwMmFmOTEwNjA3N2I2Y2Q4ZTQ2NmY2NjRkMDRkMTFkMzA4MTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNDc5MTE3", "url": "https://github.com/elastic/elasticsearch/pull/61734#pullrequestreview-480479117", "createdAt": "2020-09-02T04:42:52Z", "commit": {"oid": "1fdec7000c67a07a7dfd607b546bd766c480047e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNDo0Mjo1M1rOHLXTig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNDo0MzoxNlrOHLXU2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY3ODIxOA==", "bodyText": "Is there a reason you opted to update the failure handler in the authentication service rather than update the headers inside the failure handler?\nI was expecting something more like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        getLicenseState().addListener(() -> {\n          \n          \n            \n                            authcService.get().setFailureHeandler(new DefaultAuthenticationFailureHandler(headersSupplier.get()));\n          \n          \n            \n                        });\n          \n          \n            \n                        getLicenseState().addListener(() -> {\n          \n          \n            \n                            failureHeandler.setHeaders(headersSupplier.get());\n          \n          \n            \n                        });", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r481678218", "createdAt": "2020-09-02T04:42:53Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java", "diffHunk": "@@ -542,32 +542,39 @@ private AuthenticationFailureHandler createAuthenticationFailureHandler(final Re\n         }\n         if (failureHandler == null) {\n             logger.debug(\"Using default authentication failure handler\");\n-            final Map<String, List<String>> defaultFailureResponseHeaders = new HashMap<>();\n-            realms.asList().stream().forEach((realm) -> {\n-                Map<String, List<String>> realmFailureHeaders = realm.getAuthenticationFailureHeaders();\n-                realmFailureHeaders.entrySet().stream().forEach((e) -> {\n-                    String key = e.getKey();\n-                    e.getValue().stream()\n-                            .filter(v -> defaultFailureResponseHeaders.computeIfAbsent(key, x -> new ArrayList<>()).contains(v) == false)\n-                            .forEach(v -> defaultFailureResponseHeaders.get(key).add(v));\n+            Supplier<Map<String, List<String>>> headersSupplier = () -> {\n+                final Map<String, List<String>> defaultFailureResponseHeaders = new HashMap<>();\n+                realms.asList().stream().forEach((realm) -> {\n+                    Map<String, List<String>> realmFailureHeaders = realm.getAuthenticationFailureHeaders();\n+                    realmFailureHeaders.entrySet().stream().forEach((e) -> {\n+                        String key = e.getKey();\n+                        e.getValue().stream()\n+                                .filter(v -> defaultFailureResponseHeaders.computeIfAbsent(key, x -> new ArrayList<>()).contains(v)\n+                                    == false)\n+                                .forEach(v -> defaultFailureResponseHeaders.get(key).add(v));\n+                    });\n                 });\n-            });\n \n-            if (TokenService.isTokenServiceEnabled(settings)) {\n-                String bearerScheme = \"Bearer realm=\\\"\" + XPackField.SECURITY + \"\\\"\";\n-                if (defaultFailureResponseHeaders.computeIfAbsent(\"WWW-Authenticate\", x -> new ArrayList<>())\n-                        .contains(bearerScheme) == false) {\n-                    defaultFailureResponseHeaders.get(\"WWW-Authenticate\").add(bearerScheme);\n+                if (TokenService.isTokenServiceEnabled(settings)) {\n+                    String bearerScheme = \"Bearer realm=\\\"\" + XPackField.SECURITY + \"\\\"\";\n+                    if (defaultFailureResponseHeaders.computeIfAbsent(\"WWW-Authenticate\", x -> new ArrayList<>())\n+                            .contains(bearerScheme) == false) {\n+                        defaultFailureResponseHeaders.get(\"WWW-Authenticate\").add(bearerScheme);\n+                    }\n                 }\n-            }\n-            if (API_KEY_SERVICE_ENABLED_SETTING.get(settings)) {\n-                final String apiKeyScheme = \"ApiKey\";\n-                if (defaultFailureResponseHeaders.computeIfAbsent(\"WWW-Authenticate\", x -> new ArrayList<>())\n-                    .contains(apiKeyScheme) == false) {\n-                    defaultFailureResponseHeaders.get(\"WWW-Authenticate\").add(apiKeyScheme);\n+                if (API_KEY_SERVICE_ENABLED_SETTING.get(settings)) {\n+                    final String apiKeyScheme = \"ApiKey\";\n+                    if (defaultFailureResponseHeaders.computeIfAbsent(\"WWW-Authenticate\", x -> new ArrayList<>())\n+                        .contains(apiKeyScheme) == false) {\n+                        defaultFailureResponseHeaders.get(\"WWW-Authenticate\").add(apiKeyScheme);\n+                    }\n                 }\n-            }\n-            failureHandler = new DefaultAuthenticationFailureHandler(defaultFailureResponseHeaders);\n+                return defaultFailureResponseHeaders;\n+            };\n+            failureHandler = new DefaultAuthenticationFailureHandler(headersSupplier.get());\n+            getLicenseState().addListener(() -> {\n+                authcService.get().setFailureHeandler(new DefaultAuthenticationFailureHandler(headersSupplier.get()));\n+            });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fdec7000c67a07a7dfd607b546bd766c480047e"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY3ODU1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void setFailureHeandler(AuthenticationFailureHandler failureHandler){\n          \n          \n            \n                public void setFailureHandler(AuthenticationFailureHandler failureHandler) {", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r481678553", "createdAt": "2020-09-02T04:43:16Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/AuthenticationService.java", "diffHunk": "@@ -207,6 +208,10 @@ public void onSecurityIndexStateChange(SecurityIndexManager.State previousState,\n         }\n     }\n \n+    public void setFailureHeandler(AuthenticationFailureHandler failureHandler){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fdec7000c67a07a7dfd607b546bd766c480047e"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1fdec7000c67a07a7dfd607b546bd766c480047e", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/1fdec7000c67a07a7dfd607b546bd766c480047e", "committedDate": "2020-09-01T07:50:38Z", "message": "Merge branch 'master' into DefaultAuthenticationFailureHandler"}, "afterCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/f0d76164b1d9e4d0beb46156f37ef27dfe143ad1", "committedDate": "2020-09-04T14:31:11Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into DefaultAuthenticationFailureHandler\nKeep in sync"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNzkzNDA3", "url": "https://github.com/elastic/elasticsearch/pull/61734#pullrequestreview-483793407", "createdAt": "2020-09-08T04:53:06Z", "commit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDo1MzowNlrOHOMnig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDo1ODoyNFrOHOMshQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY0ODg0Mg==", "bodyText": "I don't think we want to add this to the interface, because we actually only call it on the DefaultAuthenticationFailureHandler.\nInstead we need to rework the code Security.java so that the final handler is the correct type.", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r484648842", "createdAt": "2020-09-08T04:53:06Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/AuthenticationFailureHandler.java", "diffHunk": "@@ -106,4 +109,11 @@ ElasticsearchSecurityException failedAuthentication(TransportMessage message, Au\n      * @return ElasticsearchSecurityException with the appropriate headers and message\n      */\n     ElasticsearchSecurityException authenticationRequired(String action, ThreadContext context);\n+\n+    /**\n+     * This method is called when failureResponseHeaders need to be set (at startup) or updated (if license state changes)\n+     *\n+     * @param failureResponseHeaders the Map of failure response heaers to be set\n+     */\n+    void setHeaders(Map<String, List<String>> failureResponseHeaders);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY0OTc2Mw==", "bodyText": "We need to verify the correct headers are set here. That is, that it includes a WWW-Authenticate: Basic realm=\"security\" charset=\"UTF-8\" header.", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r484649763", "createdAt": "2020-09-08T04:56:51Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityTests.java", "diffHunk": "@@ -462,4 +482,36 @@ public void testValidateForFipsNoErrorsForDefaultSettings() {\n         Security.validateForFips(settings);\n         // no exception thrown\n     }\n+\n+    public void testLicenseUpdateFailureHandlerUpdate() throws Exception {\n+        Settings settings = Settings.builder().\n+            put(\"xpack.security.authc.api_key.enabled\", \"true\").\n+            build();\n+        Collection<Object> components = createComponentsWithSecurityNotExplicitlyEnabled(settings);\n+        AuthenticationService service = findComponent(AuthenticationService.class, components);\n+        assertNotNull(service);\n+        RestRequest request = new FakeRestRequest();\n+        final AtomicBoolean completed = new AtomicBoolean(false);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::logAndFail));\n+        assertTrue(completed.compareAndSet(true, false));\n+        threadContext.stashContext();\n+        licenseState.update(\n+            randomFrom(License.OperationMode.GOLD, License.OperationMode.ENTERPRISE, License.OperationMode.PLATINUM),\n+            true, null);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::VerifyMissingAuthenticationException));\n+        if(completed.get()){\n+            fail(\"authentication succeeded but it shouldn't\");\n+        }\n+    }\n+\n+    private void logAndFail(Exception e) {\n+        logger.error(\"unexpected exception\", e);\n+        fail(\"unexpected exception \" + e.getMessage());\n+    }\n+\n+    private void VerifyMissingAuthenticationException(Exception e) {\n+        assertThat(e.getMessage(), containsString(\"missing authentication credentials for REST request\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY1MDAyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private void VerifyMissingAuthenticationException(Exception e) {\n          \n          \n            \n                private void verifyMissingAuthenticationException(Exception e) {", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r484650029", "createdAt": "2020-09-08T04:57:57Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityTests.java", "diffHunk": "@@ -462,4 +482,36 @@ public void testValidateForFipsNoErrorsForDefaultSettings() {\n         Security.validateForFips(settings);\n         // no exception thrown\n     }\n+\n+    public void testLicenseUpdateFailureHandlerUpdate() throws Exception {\n+        Settings settings = Settings.builder().\n+            put(\"xpack.security.authc.api_key.enabled\", \"true\").\n+            build();\n+        Collection<Object> components = createComponentsWithSecurityNotExplicitlyEnabled(settings);\n+        AuthenticationService service = findComponent(AuthenticationService.class, components);\n+        assertNotNull(service);\n+        RestRequest request = new FakeRestRequest();\n+        final AtomicBoolean completed = new AtomicBoolean(false);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::logAndFail));\n+        assertTrue(completed.compareAndSet(true, false));\n+        threadContext.stashContext();\n+        licenseState.update(\n+            randomFrom(License.OperationMode.GOLD, License.OperationMode.ENTERPRISE, License.OperationMode.PLATINUM),\n+            true, null);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::VerifyMissingAuthenticationException));\n+        if(completed.get()){\n+            fail(\"authentication succeeded but it shouldn't\");\n+        }\n+    }\n+\n+    private void logAndFail(Exception e) {\n+        logger.error(\"unexpected exception\", e);\n+        fail(\"unexpected exception \" + e.getMessage());\n+    }\n+\n+    private void VerifyMissingAuthenticationException(Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY1MDA0OA==", "bodyText": "Our typical style is:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n          \n          \n            \n                                                                                }, this::logAndFail));\n          \n          \n            \n                    service.authenticate(request, ActionListener.wrap(result -> {\n          \n          \n            \n                        assertTrue(completed.compareAndSet(false, true));\n          \n          \n            \n                    }, this::logAndFail));", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r484650048", "createdAt": "2020-09-08T04:58:03Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityTests.java", "diffHunk": "@@ -462,4 +482,36 @@ public void testValidateForFipsNoErrorsForDefaultSettings() {\n         Security.validateForFips(settings);\n         // no exception thrown\n     }\n+\n+    public void testLicenseUpdateFailureHandlerUpdate() throws Exception {\n+        Settings settings = Settings.builder().\n+            put(\"xpack.security.authc.api_key.enabled\", \"true\").\n+            build();\n+        Collection<Object> components = createComponentsWithSecurityNotExplicitlyEnabled(settings);\n+        AuthenticationService service = findComponent(AuthenticationService.class, components);\n+        assertNotNull(service);\n+        RestRequest request = new FakeRestRequest();\n+        final AtomicBoolean completed = new AtomicBoolean(false);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::logAndFail));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY1MDExNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n          \n          \n            \n                                                                                }, this::VerifyMissingAuthenticationException));\n          \n          \n            \n                    service.authenticate(request, ActionListener.wrap(result -> {\n          \n          \n            \n                        assertTrue(completed.compareAndSet(false, true));\n          \n          \n            \n                    }, this::VerifyMissingAuthenticationException));", "url": "https://github.com/elastic/elasticsearch/pull/61734#discussion_r484650117", "createdAt": "2020-09-08T04:58:24Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/SecurityTests.java", "diffHunk": "@@ -462,4 +482,36 @@ public void testValidateForFipsNoErrorsForDefaultSettings() {\n         Security.validateForFips(settings);\n         // no exception thrown\n     }\n+\n+    public void testLicenseUpdateFailureHandlerUpdate() throws Exception {\n+        Settings settings = Settings.builder().\n+            put(\"xpack.security.authc.api_key.enabled\", \"true\").\n+            build();\n+        Collection<Object> components = createComponentsWithSecurityNotExplicitlyEnabled(settings);\n+        AuthenticationService service = findComponent(AuthenticationService.class, components);\n+        assertNotNull(service);\n+        RestRequest request = new FakeRestRequest();\n+        final AtomicBoolean completed = new AtomicBoolean(false);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::logAndFail));\n+        assertTrue(completed.compareAndSet(true, false));\n+        threadContext.stashContext();\n+        licenseState.update(\n+            randomFrom(License.OperationMode.GOLD, License.OperationMode.ENTERPRISE, License.OperationMode.PLATINUM),\n+            true, null);\n+        service.authenticate(request, ActionListener.wrap(result -> {assertTrue(completed.compareAndSet(false, true));\n+                                                                    }, this::VerifyMissingAuthenticationException));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1"}, "originalPosition": 103}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af9d371852fee23e49c90a3fe8caefb1fcd5b222", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/af9d371852fee23e49c90a3fe8caefb1fcd5b222", "committedDate": "2020-09-08T15:18:31Z", "message": "DefaultAuthenticationFailureHandler does not update with license changes #56318\n-DefaultAuthenticationFailureHandler determines the set of response headers based on the active realms at startup.\n However, the Realms list may be empty if the node thinks it has a TRIAL or BASIC license at startup (because we default security off in those cases).\n The handler is never updated if the license state changes.\n- The fix is to add a call-back for license change to build new DefaultAuthenticationFailureHandler and update authcService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81ca8c4dc5f0b4189759eb5453db69876d806631", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/81ca8c4dc5f0b4189759eb5453db69876d806631", "committedDate": "2020-09-08T15:18:31Z", "message": "DefaultAuthenticationFailureHandler does not update with license changes #56318\n-Changing according to the PR feedback + adding test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d90ea531a6439fd00850c083eb2f58d001c600a7", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/d90ea531a6439fd00850c083eb2f58d001c600a7", "committedDate": "2020-09-08T17:14:18Z", "message": "DefaultAuthenticationFailureHandler does not update with license changes #56318\n-Changing according to the PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed41614f59263f9e829a00dff03786b07be89818", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/ed41614f59263f9e829a00dff03786b07be89818", "committedDate": "2020-09-08T17:14:55Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into DefaultAuthenticationFailureHandler"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f0d76164b1d9e4d0beb46156f37ef27dfe143ad1", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/f0d76164b1d9e4d0beb46156f37ef27dfe143ad1", "committedDate": "2020-09-04T14:31:11Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into DefaultAuthenticationFailureHandler\nKeep in sync"}, "afterCommit": {"oid": "ed41614f59263f9e829a00dff03786b07be89818", "author": {"user": {"login": "BigPandaToo", "name": "Lyudmila Fokina"}}, "url": "https://github.com/elastic/elasticsearch/commit/ed41614f59263f9e829a00dff03786b07be89818", "committedDate": "2020-09-08T17:14:55Z", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into DefaultAuthenticationFailureHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NDg3OTA5", "url": "https://github.com/elastic/elasticsearch/pull/61734#pullrequestreview-488487909", "createdAt": "2020-09-15T09:18:15Z", "commit": {"oid": "ed41614f59263f9e829a00dff03786b07be89818"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6e002af9106077b6cd8e466f664d04d11d30816", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/f6e002af9106077b6cd8e466f664d04d11d30816", "committedDate": "2020-09-16T07:05:15Z", "message": "Merge branch 'master' into DefaultAuthenticationFailureHandler"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 48, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}