{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5MzYxOTQw", "number": 64955, "title": "Minor Cleanup in org.elasticsearch.common.collect", "bodyText": "Return empty map singleton from builder\nRemove dead methods\nCleanup duplicate iterator", "createdAt": "2020-11-11T18:00:05Z", "url": "https://github.com/elastic/elasticsearch/pull/64955", "merged": true, "mergeCommit": {"oid": "ba5f454139051c8b088c7d0ba097294ea3a6bf40"}, "closed": true, "closedAt": "2020-11-18T10:17:01Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbh1H8gH2gAyNTE5MzYxOTQwOjI5YzQyZDdmNmMxNGQ4Y2FmZmJhMzM0ZDExODI4ZGVmN2FiNTk5YjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddqve9gH2gAyNTE5MzYxOTQwOmRhNzM0OWJhYTY1ZWIxODM5MzU1OTRlNDMwNjM4MTZjNjRhMzkxZWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "29c42d7f6c14d8caffba334d11828def7ab599b0", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/29c42d7f6c14d8caffba334d11828def7ab599b0", "committedDate": "2020-11-11T17:58:05Z", "message": "Minor Cleanup in org.elasticsearch.common.collect\n\n* Return empty map singleton from builder\n* Remove dead methods\n* Cleanup duplicate iterator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf0f5dcf8033cee3a756c801bbc3578e8c088a5f", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/cf0f5dcf8033cee3a756c801bbc3578e8c088a5f", "committedDate": "2020-11-11T19:33:19Z", "message": "Merge remote-tracking branch 'elastic/master' into cleanup-collects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06005f2790cec74052b9f2558453111faee1496a", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/06005f2790cec74052b9f2558453111faee1496a", "committedDate": "2020-11-11T20:33:09Z", "message": "fix broken test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1307fbdd4bc4bf5898ce6a0b5ca438821c36ffc5", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/1307fbdd4bc4bf5898ce6a0b5ca438821c36ffc5", "committedDate": "2020-11-11T20:57:09Z", "message": "fix broken test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NTMxMzEw", "url": "https://github.com/elastic/elasticsearch/pull/64955#pullrequestreview-528531310", "createdAt": "2020-11-11T21:01:34Z", "commit": {"oid": "1307fbdd4bc4bf5898ce6a0b5ca438821c36ffc5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQyMTowMTozNFrOHxeI4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQyMTowMTozNFrOHxeI4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTYzNjA2Nw==", "bodyText": "A neat side effect of this cleanup is that it made it easier to catch this bug. We were calling the builder twice, but the second invocation would actually produce a broken result because it created an immutable open map with a null map inside that would NPE on every operation if used.", "url": "https://github.com/elastic/elasticsearch/pull/64955#discussion_r521636067", "createdAt": "2020-11-11T21:01:34Z", "author": {"login": "original-brownbear"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ilm/ReplaceDataStreamBackingIndexStepTests.java", "diffHunk": "@@ -61,12 +61,13 @@ public void testPerformActionThrowsExceptionIfIndexIsNotPartOfDataStream() {\n             IndexMetadata.builder(indexName).settings(settings(Version.CURRENT).put(LifecycleSettings.LIFECYCLE_NAME, policyName))\n                 .numberOfShards(randomIntBetween(1, 5)).numberOfReplicas(randomIntBetween(0, 5));\n \n+        final IndexMetadata sourceIndexMetadata = sourceIndexMetadataBuilder.build();\n         ClusterState clusterState = ClusterState.builder(emptyClusterState()).metadata(\n-            Metadata.builder().put(sourceIndexMetadataBuilder).build()\n+            Metadata.builder().put(sourceIndexMetadata, false).build()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1307fbdd4bc4bf5898ce6a0b5ca438821c36ffc5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8270341ce865de7d436f38a74bd353c88a9720ee", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/8270341ce865de7d436f38a74bd353c88a9720ee", "committedDate": "2020-11-12T08:17:33Z", "message": "fix broken test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8139c20a2a80feb97e830b5a71a4fb4fd993ec3", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/e8139c20a2a80feb97e830b5a71a4fb4fd993ec3", "committedDate": "2020-11-12T09:03:13Z", "message": "fix broken test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyOTMwNTAz", "url": "https://github.com/elastic/elasticsearch/pull/64955#pullrequestreview-532930503", "createdAt": "2020-11-18T00:49:17Z", "commit": {"oid": "e8139c20a2a80feb97e830b5a71a4fb4fd993ec3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da7349baa65eb183935594e43063816c64a391eb", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/da7349baa65eb183935594e43063816c64a391eb", "committedDate": "2020-11-18T09:28:55Z", "message": "Merge remote-tracking branch 'elastic/master' into cleanup-collects"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1030, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}