{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0OTI5Mzg2", "number": 51232, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxNjowMlrODZR1aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNTozMDo1MlrODZiKxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3ODMzMTkyOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/DataFrameAnalysis.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxNjowMlrOFflCxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxNjowMlrOFflCxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY1NzA5Mw==", "bodyText": "s/limits/constraints\n?", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r368657093", "createdAt": "2020-01-20T17:16:02Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/DataFrameAnalysis.java", "diffHunk": "@@ -37,9 +37,9 @@\n     List<RequiredField> getRequiredFields();\n \n     /**\n-     * @return {@link Map} containing cardinality limits for the selected (analysis-specific) fields\n+     * @return {@link List} containing cardinality limits for the selected (analysis-specific) fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "017be7852fb418eae981d8f3556df7e587277eab"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3ODMzMjY2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/DataFrameAnalysis.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxNjoxOVrOFflDMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxNjoxOVrOFflDMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY1NzIwMg==", "bodyText": "s/Limits/Constraints\n?", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r368657202", "createdAt": "2020-01-20T17:16:19Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/DataFrameAnalysis.java", "diffHunk": "@@ -37,9 +37,9 @@\n     List<RequiredField> getRequiredFields();\n \n     /**\n-     * @return {@link Map} containing cardinality limits for the selected (analysis-specific) fields\n+     * @return {@link List} containing cardinality limits for the selected (analysis-specific) fields\n      */\n-    Map<String, Long> getFieldCardinalityLimits();\n+    List<FieldCardinalityConstraint> getFieldCardinalityLimits();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "017be7852fb418eae981d8f3556df7e587277eab"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3ODMzOTI5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/OutlierDetectionTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxOTowM1rOFflHIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxOTowM1rOFflHIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY1ODIxMQ==", "bodyText": "There is a \"Matchers.empty()\" matcher that could be used here.", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r368658211", "createdAt": "2020-01-20T17:19:03Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/OutlierDetectionTests.java", "diffHunk": "@@ -89,7 +89,7 @@ public void testRequiredFieldsIsEmpty() {\n     }\n \n     public void testFieldCardinalityLimitsIsEmpty() {\n-        assertThat(createTestInstance().getFieldCardinalityLimits(), is(anEmptyMap()));\n+        assertThat(createTestInstance().getFieldCardinalityLimits().isEmpty(), is(true));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "017be7852fb418eae981d8f3556df7e587277eab"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3ODMzOTUzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/RegressionTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxOTowOVrOFflHRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzoxOTowOVrOFflHRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY1ODI0Nw==", "bodyText": "There is a \"Matchers.empty()\" matcher that could be used here.", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r368658247", "createdAt": "2020-01-20T17:19:09Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/dataframe/analyses/RegressionTests.java", "diffHunk": "@@ -106,7 +106,7 @@ public void testRequiredFieldsIsNonEmpty() {\n     }\n \n     public void testFieldCardinalityLimitsIsEmpty() {\n-        assertThat(createTestInstance().getFieldCardinalityLimits(), is(anEmptyMap()));\n+        assertThat(createTestInstance().getFieldCardinalityLimits().isEmpty(), is(true));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "017be7852fb418eae981d8f3556df7e587277eab"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MDk1MjkxOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/DataFrameAnalyticsManager.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNToxNjozM1rOFf9tsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNToxNjozM1rOFf9tsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA2MTI5Ng==", "bodyText": "Note that this is now necessary as we are checking the field cardinality before we call startAnalytics which refreshes the dest index.", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r369061296", "createdAt": "2020-01-21T15:16:33Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/DataFrameAnalyticsManager.java", "diffHunk": "@@ -177,6 +177,7 @@ private void reindexDataframeAndStartAnalysis(DataFrameAnalyticsTask task, DataF\n         ActionListener<CreateIndexResponse> copyIndexCreatedListener = ActionListener.wrap(\n             createIndexResponse -> {\n                 ReindexRequest reindexRequest = new ReindexRequest();\n+                reindexRequest.setRefresh(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f96b35073794e10e5a36718c3367ff48fc330392"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTAwODA3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/ClassificationIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNTozMDo1MlrOFf-Q_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNjowMjowOFrOFf_eaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA3MDMzNQ==", "bodyText": "Should this be reverted?", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r369070335", "createdAt": "2020-01-21T15:30:52Z", "author": {"login": "przemekwitek"}, "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/ClassificationIT.java", "diffHunk": "@@ -492,7 +492,7 @@ private void initialize(String jobId) {\n         this.jobId = jobId;\n         this.sourceIndex = jobId + \"_source_index\";\n         this.destIndex = sourceIndex + \"_results\";\n-        this.analysisUsesExistingDestIndex = randomBoolean();\n+        this.analysisUsesExistingDestIndex = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f96b35073794e10e5a36718c3367ff48fc330392"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5MDE1NQ==", "bodyText": "Ah, yes of course.", "url": "https://github.com/elastic/elasticsearch/pull/51232#discussion_r369090155", "createdAt": "2020-01-21T16:02:08Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/ClassificationIT.java", "diffHunk": "@@ -492,7 +492,7 @@ private void initialize(String jobId) {\n         this.jobId = jobId;\n         this.sourceIndex = jobId + \"_source_index\";\n         this.destIndex = sourceIndex + \"_results\";\n-        this.analysisUsesExistingDestIndex = randomBoolean();\n+        this.analysisUsesExistingDestIndex = false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA3MDMzNQ=="}, "originalCommit": {"oid": "f96b35073794e10e5a36718c3367ff48fc330392"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4575, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}