{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNjQyOTY1", "number": 54190, "title": "[DOCS] Adds feature importance mapping subsection to inference processor docs", "bodyText": "This PR adds preferred field mapping and field path to feature importance in the inference processor documentation.\nPreview: http://elasticsearch_54190.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/inference-processor.html\nDepends on elastic/docs#1784", "createdAt": "2020-03-25T15:05:31Z", "url": "https://github.com/elastic/elasticsearch/pull/54190", "merged": true, "mergeCommit": {"oid": "a65e95e093af8acf2f288ff8c85a990501ee5820"}, "closed": true, "closedAt": "2020-03-26T08:22:13Z", "author": {"login": "szabosteve"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRItZKgH2gAyMzkzNjQyOTY1OmMxNmM4MjdhYTJiYWZjNGQxYmFiZmNjODU0OWVjMDlkNzY2MWQyNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRK74TgFqTM4MTM3NDgzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c16c827aa2bafc4d1babfcc8549ec09d7661d265", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/c16c827aa2bafc4d1babfcc8549ec09d7661d265", "committedDate": "2020-03-25T14:51:37Z", "message": "[DOCS] Adds feature importance mapping subsection to inference processor docs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06e148db62dbd5b705163ffd7e320e751da22873", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/06e148db62dbd5b705163ffd7e320e751da22873", "committedDate": "2020-03-25T15:04:37Z", "message": "[DOCS] Fixes mapping path."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92bf8e9fe38c025111b0c1d2954ef71530b57f79", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/92bf8e9fe38c025111b0c1d2954ef71530b57f79", "committedDate": "2020-03-25T15:07:46Z", "message": "[DOCS] Adjusts indentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/4f6c0d614cb59a332d123750e113f2f1765d7292", "committedDate": "2020-03-25T15:19:20Z", "message": "[DOCS] Fixes link."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMjY1OTg3", "url": "https://github.com/elastic/elasticsearch/pull/54190#pullrequestreview-381265987", "createdAt": "2020-03-25T15:31:54Z", "commit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozMTo1NVrOF7g3XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozNTo0MlrOF7hDbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0ODc2NQ==", "bodyText": "This should indicate that this is the mapping for the feature importance result field.", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397948765", "createdAt": "2020-03-25T15:31:55Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -116,3 +117,36 @@ categories for which the predicted probabilities are reported is 2\n (`num_top_classes`). The result is written to the `prediction` field and the top \n classes to the `probabilities` field. Both fields are contained in the \n `target_field` results object.\n+\n+\n+[discrete]\n+[[inference-processor-feature-importance]]\n+==== {feat-imp-cap} object mapping\n+\n+Update your index mapping as you can see below to get the full benefit of \n+aggregating and searching for \n+{ml-docs}/dfa-classification.html#dfa-classification-feature-importance[{feat-imp}].\n+\n+[source,js]\n+--------------------------------------------------\n+{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk1MTg1Mw==", "bodyText": "probably some inference configs + field name examples?\n{\n    \"tag\": \"foo\",\n    ...\n}\n\nWrites feature importance to field ml.inference.foo.feature_importance.\n{\n    \"tag\": \"foo\",\n    \"target_field\": \"my_field\"\n}\n\nWrites feature importance to field my_field.foo.feature_importance.", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397951853", "createdAt": "2020-03-25T15:35:42Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -116,3 +117,36 @@ categories for which the predicted probabilities are reported is 2\n (`num_top_classes`). The result is written to the `prediction` field and the top \n classes to the `probabilities` field. Both fields are contained in the \n `target_field` results object.\n+\n+\n+[discrete]\n+[[inference-processor-feature-importance]]\n+==== {feat-imp-cap} object mapping\n+\n+Update your index mapping as you can see below to get the full benefit of \n+aggregating and searching for \n+{ml-docs}/dfa-classification.html#dfa-classification-feature-importance[{feat-imp}].\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"type\": \"nested\",\n+  \"dynamic\": true,\n+  \"properties\": {\n+    \"feature_name\": {\n+      \"type\": \"keyword\"\n+    },\n+    \"importance\": {\n+      \"type\": \"double\"\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+The mapping field name for {feat-imp} is compounded as follows:\n+\n+`ml.<inference.target_field>`.`<inference.tag>`.`feature_importance`\n+\n+If `inference.tag` is not provided in the processor definition, it is not part \n+of the field path. The `<inference.target_field>` defaults to `inference`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51990ab7cfd26241e1f9e4a702dd2ab622ed38ec", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/51990ab7cfd26241e1f9e4a702dd2ab622ed38ec", "committedDate": "2020-03-25T16:19:22Z", "message": "[DOCS] Addresses feedback."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7d907c5ec9259d65fd3208afc4233eb73fbf978", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/f7d907c5ec9259d65fd3208afc4233eb73fbf978", "committedDate": "2020-03-25T16:26:22Z", "message": "[DOCS] Adds field name to the snippet."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzI4OTUz", "url": "https://github.com/elastic/elasticsearch/pull/54190#pullrequestreview-381328953", "createdAt": "2020-03-25T16:36:28Z", "commit": {"oid": "51990ab7cfd26241e1f9e4a702dd2ab622ed38ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjozNjoyOFrOF7j-QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjozNjoyOFrOF7j-QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5OTY4MA==", "bodyText": "it is not ml.my_field. Its just my_field.foo.feature_importance", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397999680", "createdAt": "2020-03-25T16:36:28Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -149,4 +149,33 @@ The mapping field name for {feat-imp} is compounded as follows:\n `ml.<inference.target_field>`.`<inference.tag>`.`feature_importance`\n \n If `inference.tag` is not provided in the processor definition, it is not part \n-of the field path. The `<inference.target_field>` defaults to `inference`.\n\\ No newline at end of file\n+of the field path. The `<inference.target_field>` defaults to `inference`.\n+\n+For example, you provide a tag `foo` in the definition as you can see below:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  ...\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+\n+The `{feat-imp}` value is written to the `ml.inference.foo.feature_importance` \n+field.\n+\n+You can also specify a target field as follows:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  \"target_field\": \"my_field\"\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+In this case, `{feat-imp}` is exposed in the \n+`ml.my_field.foo.feature_importance` field.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51990ab7cfd26241e1f9e4a702dd2ab622ed38ec"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de64cf5d6973640abf0252a69829fdaacc8df562", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/de64cf5d6973640abf0252a69829fdaacc8df562", "committedDate": "2020-03-25T16:52:28Z", "message": "[DOCS] Addresses feedback."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzc0ODM2", "url": "https://github.com/elastic/elasticsearch/pull/54190#pullrequestreview-381374836", "createdAt": "2020-03-25T17:27:15Z", "commit": {"oid": "de64cf5d6973640abf0252a69829fdaacc8df562"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1529, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}