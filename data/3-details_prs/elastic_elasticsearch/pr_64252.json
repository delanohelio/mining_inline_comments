{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExMTIyNjcy", "number": 64252, "title": "Move watcher history to data stream ", "bodyText": "This change moves watcher history to data stream.", "createdAt": "2020-10-27T22:11:18Z", "url": "https://github.com/elastic/elasticsearch/pull/64252", "merged": true, "mergeCommit": {"oid": "3e426c13cc67aa8c13badbc0b9671b3ccf6d253d"}, "closed": true, "closedAt": "2020-11-12T21:41:08Z", "author": {"login": "probakowski"}, "timelineItems": {"totalCount": 55, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUrL_SAH2gAyNTExMTIyNjcyOmQ3ZjA1YTFjOWU4YjIzODgwNTNjY2MxOWFmNDgzN2E3NzU1MjgyZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbwuuOAH2gAyNTExMTIyNjcyOjJjNWM5MWM5MDFlYWRlZDViOWQyYjM0MDk3ZGJmNjAxNzdlOTFmNTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d7f05a1c9e8b2388053ccc19af4837a7755282e2", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/d7f05a1c9e8b2388053ccc19af4837a7755282e2", "committedDate": "2020-10-21T10:54:44Z", "message": "Hidden data streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b182d368e25d0b4122f311e39ffb74407f7c3045", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/b182d368e25d0b4122f311e39ffb74407f7c3045", "committedDate": "2020-10-21T11:00:48Z", "message": "whitespace reverted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "100dba5f3c9561a2e8bc5c52bffa5881c114b6c7", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/100dba5f3c9561a2e8bc5c52bffa5881c114b6c7", "committedDate": "2020-10-21T11:27:29Z", "message": "stricter ds name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d778f54aa069ed0763122630dcf6d41da48ccd2", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/0d778f54aa069ed0763122630dcf6d41da48ccd2", "committedDate": "2020-10-21T11:30:04Z", "message": "Revert \"stricter ds name\"\n\nThis reverts commit 100dba5f3c9561a2e8bc5c52bffa5881c114b6c7."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98e45c5229ed6dc52a4ad04f430c3256d8ef2c39", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/98e45c5229ed6dc52a4ad04f430c3256d8ef2c39", "committedDate": "2020-10-21T11:55:28Z", "message": "String.format removed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf74871a0b506ee4264a5ff3e33c27cfb2bbf113", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/cf74871a0b506ee4264a5ff3e33c27cfb2bbf113", "committedDate": "2020-10-21T15:00:03Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a856a8f464f82f397319fbece6c95154fca51c87", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/a856a8f464f82f397319fbece6c95154fca51c87", "committedDate": "2020-10-21T21:44:47Z", "message": "fix GetDataStream action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a0e20d82c30988faacead6b4eb9b7d018655a11", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a0e20d82c30988faacead6b4eb9b7d018655a11", "committedDate": "2020-10-22T10:25:43Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19af04d6bdfa19eb5fd802f44ecdb9596adaa45d", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/19af04d6bdfa19eb5fd802f44ecdb9596adaa45d", "committedDate": "2020-10-22T10:47:02Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b940396e55367fa7013b2f758c2240d68b14d10", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/5b940396e55367fa7013b2f758c2240d68b14d10", "committedDate": "2020-10-22T11:52:09Z", "message": "rest test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44415330000762b72aa94ccab65141524f75be54", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/44415330000762b72aa94ccab65141524f75be54", "committedDate": "2020-10-22T12:09:32Z", "message": "rest test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "404d3417b3a38fb52cce82a31540c4eb6a3fc4c0", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/404d3417b3a38fb52cce82a31540c4eb6a3fc4c0", "committedDate": "2020-10-22T14:51:34Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0059e16b4cc949c13c040a3ef2581862fdd5bfd2", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/0059e16b4cc949c13c040a3ef2581862fdd5bfd2", "committedDate": "2020-10-22T20:23:46Z", "message": "tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c540befc03fd767a3efb74a56865a6e7467f211", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/2c540befc03fd767a3efb74a56865a6e7467f211", "committedDate": "2020-10-22T20:26:10Z", "message": "Merge remote-tracking branch 'origin/master' into hidden-data-streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54dddc4c27590407e731c7cfade5427e33d9fdcb", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/54dddc4c27590407e731c7cfade5427e33d9fdcb", "committedDate": "2020-10-22T21:49:14Z", "message": "Delete a.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63c0702224915b8186632c57a11976c9776626dc", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/63c0702224915b8186632c57a11976c9776626dc", "committedDate": "2020-10-26T10:42:26Z", "message": "added expand_wildcards for GetDataStream and DeleteDataStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd9afafe7a4771d76059bf306423cd843464f1fe", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/dd9afafe7a4771d76059bf306423cd843464f1fe", "committedDate": "2020-10-26T10:56:46Z", "message": "unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6152f02629d28c659b6ddb6d0faa1c0863d4a481", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/6152f02629d28c659b6ddb6d0faa1c0863d4a481", "committedDate": "2020-10-26T12:50:47Z", "message": "Merge remote-tracking branch 'origin/master' into hidden-data-streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e71b539b8fe85a442af9d4f0119b97a5b92e707", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/4e71b539b8fe85a442af9d4f0119b97a5b92e707", "committedDate": "2020-10-26T22:28:27Z", "message": "add hidden setting to data stream template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f00df2d4b67b524bf6a299b04cdc6654652d42ea", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/f00df2d4b67b524bf6a299b04cdc6654652d42ea", "committedDate": "2020-10-26T22:55:31Z", "message": "fix expand_wildcards"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b92f159f2131a48f4a07dc356231bc8f90ac48ba", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/b92f159f2131a48f4a07dc356231bc8f90ac48ba", "committedDate": "2020-10-26T23:04:19Z", "message": "Merge remote-tracking branch 'origin/master' into hidden-data-streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "194b49291705a88efb26de18b333efff377af756", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/194b49291705a88efb26de18b333efff377af756", "committedDate": "2020-10-26T23:05:35Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66c8d585874dcb8197e664cae0e5d86cb5f7c86a", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/66c8d585874dcb8197e664cae0e5d86cb5f7c86a", "committedDate": "2020-10-26T23:15:38Z", "message": "fix compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0ee5e7134272be2abc1fa127376b335d603614b", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/d0ee5e7134272be2abc1fa127376b335d603614b", "committedDate": "2020-10-26T23:23:53Z", "message": "unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72add9202709c615f6780c9c52c24548317bbcbf", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/72add9202709c615f6780c9c52c24548317bbcbf", "committedDate": "2020-10-26T23:49:51Z", "message": "yaml test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfe3b643712d0fa0f2cd3735f49292d0776a9e5b", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/cfe3b643712d0fa0f2cd3735f49292d0776a9e5b", "committedDate": "2020-10-26T23:56:00Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "247524445b67923d0f4ce629a10b09fc73a5e7bb", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/247524445b67923d0f4ce629a10b09fc73a5e7bb", "committedDate": "2020-10-27T09:53:48Z", "message": "fix cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "136011dfddd25d5fdf3c098182c98f82cb20b67e", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/136011dfddd25d5fdf3c098182c98f82cb20b67e", "committedDate": "2020-10-27T22:05:12Z", "message": "Move watcher history to data stream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df8eba6969bfa832ade48af130fbf4c6496ee5e1", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/df8eba6969bfa832ade48af130fbf4c6496ee5e1", "committedDate": "2020-10-27T22:23:17Z", "message": "unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9de8640aa760ec510cb34aa64df219097ce7078", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/c9de8640aa760ec510cb34aa64df219097ce7078", "committedDate": "2020-10-28T00:17:12Z", "message": "fixed wipeDataStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9ee0f3545ea2e716f8cd7e4c2f3c8cb682b7bfa", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/e9ee0f3545ea2e716f8cd7e4c2f3c8cb682b7bfa", "committedDate": "2020-10-28T00:26:23Z", "message": "fix doc test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3654fe66c23fd88caa6486a45161430a41a5cbdf", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/3654fe66c23fd88caa6486a45161430a41a5cbdf", "committedDate": "2020-10-28T00:28:12Z", "message": "fix doc test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffa01638e4e94e89cbb9d8754b49d7f9333ff95e", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/ffa01638e4e94e89cbb9d8754b49d7f9333ff95e", "committedDate": "2020-10-28T00:48:31Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2078e956b5d3ad0e12ce9368ca89253a83c5da57", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/2078e956b5d3ad0e12ce9368ca89253a83c5da57", "committedDate": "2020-10-28T08:08:52Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c89f592dd03730565f29a60af22c32cb5f7c26e4", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/c89f592dd03730565f29a60af22c32cb5f7c26e4", "committedDate": "2020-10-28T09:58:16Z", "message": "fix cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c97a41de94a4e7e09d6c5246815da846ba7795ac", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/c97a41de94a4e7e09d6c5246815da846ba7795ac", "committedDate": "2020-10-28T12:23:24Z", "message": "Merge remote-tracking branch 'origin/master' into watcher-history-data-stream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "070cbf3e27d8d504c23d24fd06112e8065cb1ade", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/070cbf3e27d8d504c23d24fd06112e8065cb1ade", "committedDate": "2020-10-28T12:25:15Z", "message": "Merge remote-tracking branch 'origin/master' into hidden-data-streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6b533bc9af30884e1887e43ca2e8fa72c759d23", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/a6b533bc9af30884e1887e43ca2e8fa72c759d23", "committedDate": "2020-10-29T11:42:45Z", "message": "flush history during pause"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da08544a515fa5e6791caf076e5e62776461006e", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/da08544a515fa5e6791caf076e5e62776461006e", "committedDate": "2020-10-29T12:50:29Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff845eb1f51de26af4aa0bb187f90fda74ff58fd", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/ff845eb1f51de26af4aa0bb187f90fda74ff58fd", "committedDate": "2020-10-30T00:53:37Z", "message": "review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9fc82d71e4db7ac2498c011b9af3af1e1cda503", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/b9fc82d71e4db7ac2498c011b9af3af1e1cda503", "committedDate": "2020-10-30T07:39:57Z", "message": "Merge branch 'master' into hidden-data-streams"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ffd4445f069e9d9a89c7dae00f4c7c7634aaab7", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/8ffd4445f069e9d9a89c7dae00f4c7c7634aaab7", "committedDate": "2020-10-30T07:48:11Z", "message": "compilation fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3d5a6a4096b8564bf21524fd2f8e9f232601107", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/d3d5a6a4096b8564bf21524fd2f8e9f232601107", "committedDate": "2020-10-30T07:53:29Z", "message": "fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a9700ad6eba31868ca8467393e268778fbd1ce5", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/9a9700ad6eba31868ca8467393e268778fbd1ce5", "committedDate": "2020-10-30T07:57:28Z", "message": "fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9c8694430d4b2f344b712639b4b382098e5f8cf", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/b9c8694430d4b2f344b712639b4b382098e5f8cf", "committedDate": "2020-10-30T09:57:22Z", "message": "Merge branch 'hidden-data-streams' into watcher-history-data-stream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59830f104716c5a176e645b319b145b3bf6a6f36", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/59830f104716c5a176e645b319b145b3bf6a6f36", "committedDate": "2020-10-30T11:09:31Z", "message": "Merge remote-tracking branch 'origin/master' into watcher-history-data-stream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8e7d1fcc6687bb941468e47e83e64b88d830a27", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/f8e7d1fcc6687bb941468e47e83e64b88d830a27", "committedDate": "2020-11-05T23:21:28Z", "message": "fix cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a440a5f245831c87b817dba4dc9318d8aa27ed3", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/8a440a5f245831c87b817dba4dc9318d8aa27ed3", "committedDate": "2020-11-06T08:18:24Z", "message": "fix opType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dc5f17722d3e92c381e2988fc944d2715a1bc41", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/9dc5f17722d3e92c381e2988fc944d2715a1bc41", "committedDate": "2020-11-06T08:41:00Z", "message": "Merge branch 'master' into watcher-history-data-stream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35084e8b013266df1de5f4580a2bfdc79196f75a", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/35084e8b013266df1de5f4580a2bfdc79196f75a", "committedDate": "2020-11-06T09:29:59Z", "message": "cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MDg4NDc2", "url": "https://github.com/elastic/elasticsearch/pull/64252#pullrequestreview-525088476", "createdAt": "2020-11-06T11:57:30Z", "commit": {"oid": "35084e8b013266df1de5f4580a2bfdc79196f75a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMTo1NzozMVrOHurTJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMjowMTowMFrOHurZSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcwNTk1OQ==", "bodyText": "auto_create_index does not affect the creation of data streams, so it shouldn't be necessary to check for that here.", "url": "https://github.com/elastic/elasticsearch/pull/64252#discussion_r518705959", "createdAt": "2020-11-06T11:57:31Z", "author": {"login": "danhermann"}, "path": "x-pack/plugin/watcher/src/main/java/org/elasticsearch/xpack/watcher/Watcher.java", "diffHunk": "@@ -615,14 +615,7 @@ static void validAutoCreateIndex(Settings settings, Logger logger) {\n         indices.add(\".watches\");\n         indices.add(\".triggered_watches\");\n         ZonedDateTime now = ZonedDateTime.now(ZoneOffset.UTC);\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusDays(1)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(1)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(2)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(3)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(4)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(5)));\n-        indices.add(HistoryStoreField.getHistoryIndexNameForTime(now.plusMonths(6)));\n+        indices.add(HistoryStoreField.DATA_STREAM);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35084e8b013266df1de5f4580a2bfdc79196f75a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODcwNzUyOQ==", "bodyText": "Out of curiosity, is this addressing a scenario that's specific to data streams or just a general case where history entries weren't being written?", "url": "https://github.com/elastic/elasticsearch/pull/64252#discussion_r518707529", "createdAt": "2020-11-06T12:01:00Z", "author": {"login": "danhermann"}, "path": "x-pack/plugin/watcher/src/main/java/org/elasticsearch/xpack/watcher/history/HistoryStore.java", "diffHunk": "@@ -78,9 +76,12 @@ public void forcePut(WatchRecord watchRecord) {\n      * @return true, if history store is ready to be started\n      */\n     public static boolean validate(ClusterState state) {\n-        String currentIndex = HistoryStoreField.getHistoryIndexNameForTime(ZonedDateTime.now(ZoneOffset.UTC));\n-        IndexMetadata indexMetadata = WatchStoreUtils.getConcreteIndex(currentIndex, state.metadata());\n+        IndexMetadata indexMetadata = WatchStoreUtils.getConcreteIndex(HistoryStoreField.DATA_STREAM, state.metadata());\n         return indexMetadata == null || (indexMetadata.getState() == IndexMetadata.State.OPEN &&\n             state.routingTable().index(indexMetadata.getIndex()).allPrimaryShardsActive());\n     }\n+\n+    public void flush() {\n+        bulkProcessor.flush();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35084e8b013266df1de5f4580a2bfdc79196f75a"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d0899ae1aea3bdb2d777a45df979f9cfe71c20b", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/6d0899ae1aea3bdb2d777a45df979f9cfe71c20b", "committedDate": "2020-11-12T10:05:38Z", "message": "Merge branch 'master' into watcher-history-data-stream2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ad3fe8d2c3e21bcd2136dec677be3dc7820ec0", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/83ad3fe8d2c3e21bcd2136dec677be3dc7820ec0", "committedDate": "2020-11-12T10:12:27Z", "message": "Remove unneeded check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "664ff6432d4c4acbba6f1418681668bd184cac66", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/664ff6432d4c4acbba6f1418681668bd184cac66", "committedDate": "2020-11-12T10:49:07Z", "message": "test fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c5c91c901eaded5b9d2b34097dbf60177e91f58", "author": {"user": {"login": "probakowski", "name": "Przemko Robakowski"}}, "url": "https://github.com/elastic/elasticsearch/commit/2c5c91c901eaded5b9d2b34097dbf60177e91f58", "committedDate": "2020-11-12T11:19:40Z", "message": "unused imports"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1035, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}