{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxOTcyNjkz", "number": 59827, "title": "EQL: Fix matching of tail/desc queries", "bodyText": "When dealing with tail queries, data is returned descending for the base\ncriterion yet the rest of the queries are ascending. This caused a\nproblem during insertion since while in a page, the data is ASC, between\npages the blocks of data is DESC.\nThis caused incorrectly sorting inside a SequenceGroup which led to\nincorrect results.\nFurther more in case of limit, since the data in a page is ASC, early\nreturn is not possible neither is desc matching. Thus the page needs to\nbe consumed first before finding the final results.\nA future improvement could be to keep only the top N results dropping\nthe rest during insertion time.", "createdAt": "2020-07-18T14:55:26Z", "url": "https://github.com/elastic/elasticsearch/pull/59827", "merged": true, "mergeCommit": {"oid": "77c88da054a1ce662a264f72cde5986d4ce37e3a"}, "closed": true, "closedAt": "2020-07-18T21:48:27Z", "author": {"login": "costin"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc2JYWUAH2gAyNDUxOTcyNjkzOmZkODgzNDExZDhhNjQ4OWY2MDI2NTg5NDk5YmQ0OTk3ZGNhNDJkMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2OyDUAH2gAyNDUxOTcyNjkzOjY3Njk0N2JiNDhiYTZiMzNhNTEwMjMzYTEzNzkzYzY1MDQ1OTk3NjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fd883411d8a6489f6026589499bd4997dca42d11", "author": {"user": {"login": "costin", "name": "Costin Leau"}}, "url": "https://github.com/elastic/elasticsearch/commit/fd883411d8a6489f6026589499bd4997dca42d11", "committedDate": "2020-07-18T14:33:44Z", "message": "EQL: Fix matching of tail/desc queries\n\nWhen dealing with tail queries, data is returned descending for the base\ncriterion yet the rest of the queries are ascending. This caused a\nproblem during insertion since while in a page, the data is ASC, between\npages the blocks of data is DESC.\nThis caused incorrectly sorting inside a SequenceGroup which led to\nincorrect results.\n\nFurther more in case of limit, since the data in a page is ASC, early\nreturn is not possible neither is desc matching. Thus the page needs to\nbe consumed first before finding the final results.\nA future improvement could be to keep only the top N results dropping\nthe rest during insertion time."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4dff1ec919cd40285fa929d9e85e532f49dce494", "author": {"user": {"login": "costin", "name": "Costin Leau"}}, "url": "https://github.com/elastic/elasticsearch/commit/4dff1ec919cd40285fa929d9e85e532f49dce494", "committedDate": "2020-07-18T16:09:20Z", "message": "Reset position also for completed sequences"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDY5Njg0", "url": "https://github.com/elastic/elasticsearch/pull/59827#pullrequestreview-451069684", "createdAt": "2020-07-18T17:04:08Z", "commit": {"oid": "fd883411d8a6489f6026589499bd4997dca42d11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDY5NTk2", "url": "https://github.com/elastic/elasticsearch/pull/59827#pullrequestreview-451069596", "createdAt": "2020-07-18T17:02:47Z", "commit": {"oid": "fd883411d8a6489f6026589499bd4997dca42d11"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNzowMjo0N1rOGzpX6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQxNzowMjo0N1rOGzpX6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgwODQyNw==", "bodyText": "Unnecessary /*.", "url": "https://github.com/elastic/elasticsearch/pull/59827#discussion_r456808427", "createdAt": "2020-07-18T17:02:47Z", "author": {"login": "astefan"}, "path": "x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/execution/sequence/OrdinalGroup.java", "diffHunk": "@@ -28,6 +28,13 @@\n     // timestamp compression (whose range is known for the current frame).\n     private final List<E> elements = new LinkedList<>();\n \n+    /**\n+    /* index in the list used for resetting the insertion point", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd883411d8a6489f6026589499bd4997dca42d11"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "676947bb48ba6b33a510233a13793c6504599764", "author": {"user": {"login": "costin", "name": "Costin Leau"}}, "url": "https://github.com/elastic/elasticsearch/commit/676947bb48ba6b33a510233a13793c6504599764", "committedDate": "2020-07-18T20:51:20Z", "message": "Avoid duplicated matches"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4227, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}