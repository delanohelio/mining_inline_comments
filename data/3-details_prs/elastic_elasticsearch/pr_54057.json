{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyODM1MTY3", "number": 54057, "title": "Reindex negative TimeValue fix", "bodyText": "Reindex would use timeValueNanos(System.nanoTime()). The intended use\nfor TimeValue is as a duration, not as absolute time. In particular,\nthis could result in negative TimeValue's, being unsupported in #53913.\nModified to use the bare long nano-second value.\nThe 6.8 backport is likely a redo (but this was a simple change), since the structure changed in 7.x", "createdAt": "2020-03-24T07:59:52Z", "url": "https://github.com/elastic/elasticsearch/pull/54057", "merged": true, "mergeCommit": {"oid": "2a67bee874f2469fae477f3b7471fbdf3a548b71"}, "closed": true, "closedAt": "2020-03-24T21:28:11Z", "author": {"login": "henningandersen"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQuM-2gH2gAyMzkyODM1MTY3OmQzYWQ1NWNiNDk3N2FmOGM4YmExYjExN2E0NzZiYzRiNzZmMjdiYzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQ51QpAFqTM4MDcxMjE2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d3ad55cb4977af8c8ba1b117a476bc4b76f27bc3", "author": {"user": {"login": "henningandersen", "name": "Henning Andersen"}}, "url": "https://github.com/elastic/elasticsearch/commit/d3ad55cb4977af8c8ba1b117a476bc4b76f27bc3", "committedDate": "2020-03-24T07:58:41Z", "message": "Reindex negative TimeValue fix\n\nReindex would use timeValueNanos(System.nanoTime()). The intended use\nfor TimeValue is as a duration, not as absolute time. In particular,\nthis could result in negative TimeValue's, being unsupported in #53913."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4991a5c8b5b466cb8ac73e5386f3d265c059e6d", "author": {"user": {"login": "henningandersen", "name": "Henning Andersen"}}, "url": "https://github.com/elastic/elasticsearch/commit/c4991a5c8b5b466cb8ac73e5386f3d265c059e6d", "committedDate": "2020-03-24T10:26:18Z", "message": "Fix compilation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzA2OTA4", "url": "https://github.com/elastic/elasticsearch/pull/54057#pullrequestreview-380706908", "createdAt": "2020-03-24T21:22:59Z", "commit": {"oid": "c4991a5c8b5b466cb8ac73e5386f3d265c059e6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzEyMTYz", "url": "https://github.com/elastic/elasticsearch/pull/54057#pullrequestreview-380712163", "createdAt": "2020-03-24T21:31:37Z", "commit": {"oid": "c4991a5c8b5b466cb8ac73e5386f3d265c059e6d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMTozMTozN1rOF7D4Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMTozMTozN1rOF7D4Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQ3MzgzOA==", "bodyText": "This was interesting anyway since this constructor TimeValue(long) is intended to be passed a value that represents milliseconds, which System#nanoTime does not.", "url": "https://github.com/elastic/elasticsearch/pull/54057#discussion_r397473838", "createdAt": "2020-03-24T21:31:37Z", "author": {"login": "jasontedor"}, "path": "modules/reindex/src/main/java/org/elasticsearch/index/reindex/AbstractAsyncBulkByScrollAction.java", "diffHunk": "@@ -247,16 +247,16 @@ public void start() {\n     void onScrollResponse(ScrollableHitSource.AsyncResponse asyncResponse) {\n         // lastBatchStartTime is essentially unused (see WorkerBulkByScrollTaskState.throttleWaitTime. Leaving it for now, since it seems\n         // like a bug?\n-        onScrollResponse(new TimeValue(System.nanoTime()), this.lastBatchSize, asyncResponse);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4991a5c8b5b466cb8ac73e5386f3d265c059e6d"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1668, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}