{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5ODgwNjIz", "number": 60499, "title": "[doc] Improve joda-time migration guide", "bodyText": "Previously migration guide incorrectly stated that joda-time patterns have to be fixed before upgrading to 7.x\nsince (7.7) #52555 and our bwc policy 6.x created indices even with joda-time are supported\nrelates #60374", "createdAt": "2020-07-31T07:44:41Z", "url": "https://github.com/elastic/elasticsearch/pull/60499", "merged": true, "mergeCommit": {"oid": "62baca74edae0b27dc168a3978c443b01cb9d705"}, "closed": true, "closedAt": "2020-08-20T14:03:59Z", "author": {"login": "pgomulka"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5rOpggH2gAyNDU5ODgwNjIzOjBiNWZmNTk4ZjEzMmY2Y2JhMDMwZjdlMmUyOThlNzJlNzdiMmE5YWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAvO8pAH2gAyNDU5ODgwNjIzOmIzOGUxNjM0NDgwMzJlMjlkZTc3ZGRkNmZjMzg4ODViMmJiYzA1ZjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0b5ff598f132f6cba030f7e2e298e72e77b2a9ae", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/0b5ff598f132f6cba030f7e2e298e72e77b2a9ae", "committedDate": "2020-07-29T13:41:41Z", "message": "draft"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "328a862a16826fe178e749d344de163442e2e857", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/328a862a16826fe178e749d344de163442e2e857", "committedDate": "2020-07-31T07:31:19Z", "message": "[doc] indicate that migration from joda to java is not necessary in 6.8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e65fd24f7c9aee2ce3f6e50c6cde0d835982d84", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e65fd24f7c9aee2ce3f6e50c6cde0d835982d84", "committedDate": "2020-07-31T07:53:47Z", "message": "Merge branch '7.x' into doc/joda_migration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe79f47f3d3b38c2ca37ca291c7cb0be8f470419", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/fe79f47f3d3b38c2ca37ca291c7cb0be8f470419", "committedDate": "2020-07-31T08:31:56Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "committedDate": "2020-07-31T11:32:16Z", "message": "links"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNDI5NDc0", "url": "https://github.com/elastic/elasticsearch/pull/60499#pullrequestreview-470429474", "createdAt": "2020-08-19T12:58:18Z", "commit": {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjo1ODoxOVrOHDGJjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMzowMDoxNlrOHDGO8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwODUyNg==", "bodyText": "I don't think the bolding or admon is necessary.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            *You do not need to convert joda-time date formats on indices created in {es} 6.8\n          \n          \n            \n            before upgrading to {es} 7.7 or newer*\n          \n          \n            \n            \n          \n          \n            \n            However you will have to make sure mappings for newly created indices are using\n          \n          \n            \n            java-time patterns.\n          \n          \n            \n            Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n          \n          \n            \n            see: {es-pull}52555[#52555]\n          \n          \n            \n            \n          \n          \n            \n            You need to update your pipelines or templates, because creating new indices with\n          \n          \n            \n            joda-time patterns in mappings is not allowed.\n          \n          \n            \n            <<java-time-migration-update-ingest-pipelines>>\n          \n          \n            \n            <<java-time-migration-update-index-templates>>\n          \n          \n            \n            You do not need to convert joda-time date formats to java time for indices\n          \n          \n            \n            created in {es} 6.8 before upgrading to 7.7 or later versions. However, mappings\n          \n          \n            \n            for indices created in 7.7 and later versions must use java-time formats.\n          \n          \n            \n            \n          \n          \n            \n            To ensure new indices use java-time formats, we recommend you update any ingest\n          \n          \n            \n            pipelines and index templates created in 6.8 to java time before upgrading. See:\n          \n          \n            \n            \n          \n          \n            \n            * <<java-time-migration-update-ingest-pipelines>>\n          \n          \n            \n            * <<java-time-migration-update-index-templates>>\n          \n          \n            \n            \n          \n          \n            \n            Indices created in versions 7.0-7.6 cannot use joda time. This was fixed\n          \n          \n            \n            was in 7.7 with {es-pull}52555[#52555].", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473008526", "createdAt": "2020-08-19T12:58:19Z", "author": {"login": "jrodewig"}, "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -5,16 +5,25 @@ With 7.0, {es} switched from joda time to java time for date-related parsing,\n formatting, and calculations. This guide is designed to help you determine\n if your cluster is impacted and, if so, prepare for the upgrade.\n \n+*You do not need to convert joda-time date formats on indices created in {es} 6.8\n+before upgrading to {es} 7.7 or newer*\n+\n+However you will have to make sure mappings for newly created indices are using\n+java-time patterns.\n+Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n+see: {es-pull}52555[#52555]\n+\n+You need to update your pipelines or templates, because creating new indices with\n+joda-time patterns in mappings is not allowed.\n+<<java-time-migration-update-ingest-pipelines>>\n+<<java-time-migration-update-index-templates>>\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwOTg5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            migrated.\n          \n          \n            \n            converted to their java-time equivalents.", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473009899", "createdAt": "2020-08-19T13:00:16Z", "author": {"login": "jrodewig"}, "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -51,7 +60,7 @@ or the {kibana-ref}/upgrade-assistant.html[Kibana upgrade assistant].\n [[java-time-migration-incompatible-date-formats]]\n ==== Incompatible date formats\n Custom date formats containing the following joda-time literals should be\n-changed before upgrading.\n+migrated.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwOTkwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can start using java-time patterns in {es} 6.8 by prefixing java-time\n          \n          \n            \n            date formats with an `8`.\n          \n          \n            \n            To use java time in 6.8, prefix the date format with an `8`.", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473009905", "createdAt": "2020-08-19T13:00:16Z", "author": {"login": "jrodewig"}, "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -5,16 +5,25 @@ With 7.0, {es} switched from joda time to java time for date-related parsing,\n formatting, and calculations. This guide is designed to help you determine\n if your cluster is impacted and, if so, prepare for the upgrade.\n \n+*You do not need to convert joda-time date formats on indices created in {es} 6.8\n+before upgrading to {es} 7.7 or newer*\n+\n+However you will have to make sure mappings for newly created indices are using\n+java-time patterns.\n+Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n+see: {es-pull}52555[#52555]\n+\n+You need to update your pipelines or templates, because creating new indices with\n+joda-time patterns in mappings is not allowed.\n+<<java-time-migration-update-ingest-pipelines>>\n+<<java-time-migration-update-index-templates>>\n+\n [discrete]\n [[java-time-convert-date-formats]]\n === Convert date formats\n \n-To upgrade to 7.0, you'll need to convert any joda-time date formats\n-to their java-time equivalents.\n-\n-To help track this effort, you can prefix java-time date formats with an `8`\n- in {es} 6.8 and later versions.\n-\n+You can start using java-time patterns in {es} 6.8 by prefixing java-time\n+date formats with an `8`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b38e163448032e29de77ddd6fc38885b2bbc05f2", "author": {"user": {"login": "pgomulka", "name": "Przemyslaw Gomulka"}}, "url": "https://github.com/elastic/elasticsearch/commit/b38e163448032e29de77ddd6fc38885b2bbc05f2", "committedDate": "2020-08-20T12:19:06Z", "message": "Apply suggestions from code review\n\nCo-authored-by: James Rodewig <40268737+jrodewig@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3540, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}