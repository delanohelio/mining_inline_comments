{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3ODc4MzE4", "number": 64024, "title": "Ensure CI is run in FIPS 140 approved only mode", "bodyText": "We were depending on the BouncyCastle FIPS own mechanics to set\nitself in approved only mode since we run with the Security\nManager enabled. The check during startup seems to happen before we\nset our restrictive SecurityManager though in\norg.elasticsearch.bootstrap.Elasticsearch , and this means that\nBCFIPS would not be in approved only mode, unless explicitly\nconfigured so.\nThis commit sets the appropriate JVM property to explicitly set\nBCFIPS in approved only mode in CI and adds tests to ensure that we\nwill be running with BCFIPS in approved only mode when we expect to.\nIt also sets xpack.security.fips_mode.enabled to true for all test clusters\nused in fips mode and sets the distribution to the default one. It adds a\npassword to the elasticsearch keystore for all test clusters that run in fips\nmode.\nMoreover, it changes a few unit tests where we would use bcrypt even in\nFIPS 140 mode. These would still pass since we are bundling our own\nbcrypt implementation, but are now changed to use FIPS 140 approved\nalgorithms instead for better coverage.\nIt also addresses a number of tests that would fail in approved only mode\nMainly:\n\n\nTests that use PBKDF2 with a password less than 112 bits (14char). We\nelected to change the passwords used everywhere to be at least 14\ncharacters long instead of mandating\nthe use of pbkdf2_stretch because both pbkdf2 and\npbkdf2_stretch are supported and allowed in fips mode and it makes sense\nto test with both. We could possibly figure out the password algorithm used\nfor each test and adjust password length accordingly only for pbkdf2 but\nthere is little value in that. It's good practice to use strong passwords so if\nour docs and tests use longer passwords, then it's for the best. The approach\nis brittle as there is no guarantee that the next test that will be added won't\nuse a short password, so we add some testing documentation too.\nThis leaves us with a possible coverage gap since we do support passwords\nas short as 6 characters but we only test with > 14 chars but the\nvalidation itself was not tested even before. Tests can be added in a followup,\noutside of fips related context.\n\n\nTests that use a PKCS12 keystore and were not already muted.\n\n\nTests that depend on running test clusters with a basic license or\nusing the OSS distribution as FIPS 140 support is not available in\nneither of these.\n\n\nFinally, it adds some information around FIPS 140 testing in our testing\ndocumentation reference so that developers can hopefully keep in\nmind fips 140 related intricacies when writing/changing docs.", "createdAt": "2020-10-21T21:36:58Z", "url": "https://github.com/elastic/elasticsearch/pull/64024", "merged": true, "mergeCommit": {"oid": "bd873698bceec01e3860c9544bce80f645a1f704"}, "closed": true, "closedAt": "2020-12-23T19:00:49Z", "author": {"login": "jkakavas"}, "timelineItems": {"totalCount": 88, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdU0GIigH2gAyNTA3ODc4MzE4OmY0MmY3YTYwYmI5NTcyMTA5YjMyMGZlZGNiMWIzOTZhZGFiNWYzNmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpA9EZAH2gAyNTA3ODc4MzE4OmY4MTJjYTJmOGVhNjdjMjBhMjY5MmJjNjIzNzJmYTc4MDRhM2U3YTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/f42f7a60bb9572109b320fedcb1b396adab5f36c", "committedDate": "2020-10-21T21:17:29Z", "message": "Ensure CI is run in FIPS 140 approved only mode\n\nWe were depending on the BouncyCastle FIPS own mechanics to set\nitself in approved only mode since we run with the Security\nManager enabled. The check during startup seems to happen before we\nset our restrictive SecurityManager though in\norg.elasticsearch.bootstrap.Elasticsearch , and this means that\nBCFIPS would not be in approved onlu mode, unless explicitly\nconfigured so.\n\nThis commit sets the appropriate JVM property to explicitly set\nBCFIPS in approved only mode and addresses a number of tests that\nwould fail in approved mode. Mainly:\n- Tests that use PBKDF2 with a password less than 112 bits (14char)\n- Tests that use a PKCS12 keystore and were not already muted.\n\nIt also changes a few unit tests where we would use bcrypt even in\nFIPS 140 mode. These would still pass since we are bundling our own\nbcrypt implementation, but are now changed to use FIPS 140 approved\nalgorithms instead for better coverage."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MjcxOTU2", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-514271956", "createdAt": "2020-10-22T00:04:24Z", "commit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMDowNDoyNVrOHmL7UA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMDoyMjo1M1rOHmMRcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMzM0NA==", "bodyText": "I think these tests can have better coverage if we move them into ESTestCase#inFipsJvm so that they are always checked if fips is enabled.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509803344", "createdAt": "2020-10-22T00:04:25Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/Fips140ProviderVerificationTests.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core;\n+\n+import org.bouncycastle.crypto.CryptoServicesRegistrar;\n+import org.elasticsearch.test.ESTestCase;\n+\n+import java.security.Security;\n+\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+public class Fips140ProviderVerificationTests extends ESTestCase {\n+\n+    public void testBcFipsProviderInUse(){\n+        if (inFipsJvm()){\n+            assertThat(Security.getProviders().length > 0, equalTo(true));\n+            assertThat(Security.getProviders()[0].getName(), containsString(\"BCFIPS\"));\n+        }\n+    }\n+\n+    public void testInApprovedOnlyMode(){\n+        if (inFipsJvm()){\n+            assertThat(CryptoServicesRegistrar.isInApprovedOnlyMode(), equalTo(true));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwNjc2Mg==", "bodyText": "The password was passwd which is different from SecuritySettingsSourceField.TEST_PASSWORD_SECURE_STRING. This and a few similar changes in other places are causing CI failure for this PR. I think the fix should be updating AbstractPrivilegeTestCase#setUser to use the new password as well.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509806762", "createdAt": "2020-10-22T00:14:53Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/ClusterPrivilegeIntegrationTests.java", "diffHunk": "@@ -79,8 +79,9 @@ protected String configRoles() {\n \n     @Override\n     protected String configUsers() {\n-        final String usersPasswdHashed = new String(Hasher.resolve(\n-            randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")).hash(new SecureString(\"passwd\".toCharArray())));\n+        final Hasher passwdHasher = inFipsJvm() ? Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\")) :\n+            Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")) ;\n+        final String usersPasswdHashed = new String(passwdHasher.hash(SecuritySettingsSourceField.TEST_PASSWORD_SECURE_STRING));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwNzUxMQ==", "bodyText": "Nit: The indentation is now inconsistent with all_indices_role. I do think the change here looks better. But I'd suggest we make the same change to all_indices_role as well.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509807511", "createdAt": "2020-10-22T00:17:28Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/CreateDocsIndexPrivilegeTests.java", "diffHunk": "@@ -22,14 +22,14 @@\n             \"  indices:\\n\" +\n             \"    - names: '*'\\n\" +\n             \"      privileges: [ all ]\\n\" +\n-        \"create_doc_role:\\n\" +\n+            \"create_doc_role:\\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwNzYwMA==", "bodyText": "Nit: indentation inconsistency.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509807600", "createdAt": "2020-10-22T00:17:48Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/CreateDocsIndexPrivilegeTests.java", "diffHunk": "@@ -22,14 +22,14 @@\n             \"  indices:\\n\" +\n             \"    - names: '*'\\n\" +\n             \"      privileges: [ all ]\\n\" +\n-        \"create_doc_role:\\n\" +\n+            \"create_doc_role:\\n\" +\n             \"  indices:\\n\" +\n             \"    - names: '*'\\n\" +\n             \"      privileges: [ create_doc ]\\n\";\n \n     private static final String USERS_ROLES =\n         \"all_indices_role:admin\\n\" +\n-        \"create_doc_role:\" + CREATE_DOC_USER + \"\\n\";\n+            \"create_doc_role:\" + CREATE_DOC_USER + \"\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwOTAxMA==", "bodyText": "The same password change needs to be made below (L263) when constructing the Client.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509809010", "createdAt": "2020-10-22T00:22:53Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/xpack/security/authz/store/NativePrivilegeStoreCacheTests.java", "diffHunk": "@@ -249,12 +249,12 @@ public void testRolesCacheIsClearedWhenPrivilegesIsChanged() {\n             .addIndices(new String[] { \"*\" }, new String[] { \"read\" }, null, null, null, false)\n             .get();\n         assertTrue(putRoleResponse.isCreated());\n-\n+        final Hasher hasher = inFipsJvm() ? Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\")) :\n+            Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\"));\n         final PutUserResponse putUserResponse = new PutUserRequestBuilder(client)\n             .username(testRoleCacheUser)\n             .roles(testRole)\n-            .password(new SecureString(\"password\".toCharArray()),\n-                Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt9\", \"bcrypt8\", \"bcrypt\")))\n+            .password(new SecureString(\"longerpassword\".toCharArray()), hasher)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MzE1MzA5", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-514315309", "createdAt": "2020-10-22T02:25:24Z", "commit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMjoyNToyNFrOHmOP-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMjozNzo1N1rOHmOdPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0MTQwMA==", "bodyText": "Nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509841400", "createdAt": "2020-10-22T02:25:24Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/Fips140ProviderVerificationTests.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core;\n+\n+import org.bouncycastle.crypto.CryptoServicesRegistrar;\n+import org.elasticsearch.test.ESTestCase;\n+\n+import java.security.Security;\n+\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+public class Fips140ProviderVerificationTests extends ESTestCase {\n+\n+    public void testBcFipsProviderInUse(){\n+        if (inFipsJvm()){\n+            assertThat(Security.getProviders().length > 0, equalTo(true));\n+            assertThat(Security.getProviders()[0].getName(), containsString(\"BCFIPS\"));\n+        }\n+    }\n+\n+    public void testInApprovedOnlyMode(){\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0MTQ1Mw==", "bodyText": "Nit\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void testBcFipsProviderInUse(){\n          \n          \n            \n                public void testBcFipsProviderInUse() {", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509841453", "createdAt": "2020-10-22T02:25:33Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/Fips140ProviderVerificationTests.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core;\n+\n+import org.bouncycastle.crypto.CryptoServicesRegistrar;\n+import org.elasticsearch.test.ESTestCase;\n+\n+import java.security.Security;\n+\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+public class Fips140ProviderVerificationTests extends ESTestCase {\n+\n+    public void testBcFipsProviderInUse(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0MTQ4Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509841486", "createdAt": "2020-10-22T02:25:40Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/Fips140ProviderVerificationTests.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core;\n+\n+import org.bouncycastle.crypto.CryptoServicesRegistrar;\n+import org.elasticsearch.test.ESTestCase;\n+\n+import java.security.Security;\n+\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+public class Fips140ProviderVerificationTests extends ESTestCase {\n+\n+    public void testBcFipsProviderInUse(){\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0MjM3NQ==", "bodyText": "I think it's better here. I feel like this is more explicit in its own test that has its own distinct purpose rather than burying it in another test (case).\nWe might get more coverage by moving them, but I don't understand the value of that - we only need to run them once to get the value we need.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509842375", "createdAt": "2020-10-22T02:28:56Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/Fips140ProviderVerificationTests.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core;\n+\n+import org.bouncycastle.crypto.CryptoServicesRegistrar;\n+import org.elasticsearch.test.ESTestCase;\n+\n+import java.security.Security;\n+\n+import static org.hamcrest.Matchers.containsString;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+public class Fips140ProviderVerificationTests extends ESTestCase {\n+\n+    public void testBcFipsProviderInUse(){\n+        if (inFipsJvm()){\n+            assertThat(Security.getProviders().length > 0, equalTo(true));\n+            assertThat(Security.getProviders()[0].getName(), containsString(\"BCFIPS\"));\n+        }\n+    }\n+\n+    public void testInApprovedOnlyMode(){\n+        if (inFipsJvm()){\n+            assertThat(CryptoServicesRegistrar.isInApprovedOnlyMode(), equalTo(true));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgwMzM0NA=="}, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0Mzk4MA==", "bodyText": "I don't think we should disable this whole test in FIPS. It seems like an unnecessary reduction in test coverage.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509843980", "createdAt": "2020-10-22T02:35:01Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/file/FileUserPasswdStoreTests.java", "diffHunk": "@@ -51,6 +52,11 @@\n     private Environment env;\n     private ThreadPool threadPool;\n \n+    @BeforeClass\n+    public static void disableInFips(){\n+        assumeFalse(\"We are using hashing algorithms that won't be available in FIPS-140 mode\", inFipsJvm());\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0NDYxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (inFipsJvm()){\n          \n          \n            \n                            if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509844610", "createdAt": "2020-10-22T02:37:23Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/saml/SamlTestCase.java", "diffHunk": "@@ -85,13 +85,21 @@ public static void restoreLocale() {\n                 keySize = randomFrom(256, 384);\n                 break;\n             case \"RSA\":\n-                keySize = randomFrom(1024, 2048, 4096);\n+                if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0NDcxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            keySize = randomFrom(2048);\n          \n          \n            \n                            keySize = 2048;", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509844717", "createdAt": "2020-10-22T02:37:45Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/saml/SamlTestCase.java", "diffHunk": "@@ -85,13 +85,21 @@ public static void restoreLocale() {\n                 keySize = randomFrom(256, 384);\n                 break;\n             case \"RSA\":\n-                keySize = randomFrom(1024, 2048, 4096);\n+                if (inFipsJvm()){\n+                    keySize = randomFrom(2048, 4096);\n+                } else {\n+                    keySize = randomFrom(1024, 2048, 4096);\n+                }\n                 break;\n             case \"DSA\":\n-                keySize = randomFrom(1024, 2048, 3072);\n+                if (inFipsJvm()){\n+                    keySize = randomFrom(2048, 3072);\n+                } else {\n+                    keySize = randomFrom(1024, 2048, 3072);\n+                }\n                 break;\n             default:\n-                keySize = randomFrom(1024, 2048);\n+                keySize = randomFrom(2048);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0NDc5Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (inFipsJvm()){\n          \n          \n            \n                    if (inFipsJvm()) {", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r509844796", "createdAt": "2020-10-22T02:37:57Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/support/CachingUsernamePasswordRealmTests.java", "diffHunk": "@@ -65,7 +66,11 @@ public void stop() {\n     }\n \n     public void testCacheSettings() {\n-        String cachingHashAlgo = randomFrom(Hasher.getAvailableAlgoCacheHash());\n+        List<String> availableCacheAlgos = Hasher.getAvailableAlgoCacheHash();\n+        if (inFipsJvm()){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f42f7a60bb9572109b320fedcb1b396adab5f36c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a2ff00db2899186b4b3849d80d4601ea4e3dec4", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/0a2ff00db2899186b4b3849d80d4601ea4e3dec4", "committedDate": "2020-10-22T09:41:04Z", "message": "fix passwords for tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c7fd102f45795871e9163ea5b047dc08518a82d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/1c7fd102f45795871e9163ea5b047dc08518a82d", "committedDate": "2020-10-22T10:26:51Z", "message": "Re-enable FileUserPasswdStoreTests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fabb2373ad334be4379ca8fda9e618b06b1a3e58", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/fabb2373ad334be4379ca8fda9e618b06b1a3e58", "committedDate": "2020-10-22T10:35:34Z", "message": "unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6cbb686866bb8cf3d9efc340920235ad81da8b4", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b6cbb686866bb8cf3d9efc340920235ad81da8b4", "committedDate": "2020-10-22T11:26:35Z", "message": "Adjust a couple of more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f8c0307cc4881403831edde1a83b6c965dc0503", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/9f8c0307cc4881403831edde1a83b6c965dc0503", "committedDate": "2020-10-26T10:31:36Z", "message": "Fix integration tests to use long passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "547028bf6cd1f3413624435dd9bcc9b173d48e2d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/547028bf6cd1f3413624435dd9bcc9b173d48e2d", "committedDate": "2020-10-26T11:34:33Z", "message": "Set fips_mode.enabled to true and set a defaut compliant password hashing algo for testclusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4179e186dd4e08d6394ad7d50ae285675a310dd9", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/4179e186dd4e08d6394ad7d50ae285675a310dd9", "committedDate": "2020-10-26T11:54:48Z", "message": "revert test debugging change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c5ee115f47847abe7e3434e942059dc2f751c43", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/2c5ee115f47847abe7e3434e942059dc2f751c43", "committedDate": "2020-10-27T20:12:06Z", "message": "Add password to keystores and make sure passwords are longer than 14 chars"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3531517bf80b549e7eb4953e5bede48c1ec1c9b2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3531517bf80b549e7eb4953e5bede48c1ec1c9b2", "committedDate": "2020-10-29T16:02:23Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "312d394d3715a6b99037a45881748d128285ccc9", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/312d394d3715a6b99037a45881748d128285ccc9", "committedDate": "2020-12-01T17:47:36Z", "message": "Use long passwords in rest tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e83ecd892aabd49c8ec101d5730dc3b828aacaff", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/e83ecd892aabd49c8ec101d5730dc3b828aacaff", "committedDate": "2020-12-01T19:43:52Z", "message": "Add keystore password when in fips mode, and fix some passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7537c2ccd9be30c56fded81a5def76bc867445a6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7537c2ccd9be30c56fded81a5def76bc867445a6", "committedDate": "2020-12-01T19:54:55Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91c37fd36ce1293f52a9c82c449825a2281b245b", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/91c37fd36ce1293f52a9c82c449825a2281b245b", "committedDate": "2020-12-02T13:59:57Z", "message": "Skip REST YAML tests in FIPS 140 mode\n\nCurrently we don't have a way to selectively mute REST YAML tests\nin FIPS 140 mode.\n\nThis commit introduces a new feature (fips_140) that can be used\nin skip blocks to allow that."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3f11884ee2ddd80891349ca1ee3bd1fdb490f9a", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/f3f11884ee2ddd80891349ca1ee3bd1fdb490f9a", "committedDate": "2020-12-02T18:03:45Z", "message": "Disable java rest tests for IDP in FIPS 140 mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52dd0ebea386002c95a54384c7c0f81c5ce01396", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/52dd0ebea386002c95a54384c7c0f81c5ce01396", "committedDate": "2020-12-02T18:43:24Z", "message": "Mute tests using PKCS#12"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/82c86a43ec588fff4da2162216d570db8201889e", "committedDate": "2020-12-02T18:44:04Z", "message": "Use BuildParams instead of parsing the sysprop again"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTU1MTM4", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-543155138", "createdAt": "2020-12-02T19:10:57Z", "commit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMDo1OFrOH9qJ2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMDo1OFrOH9qJ2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxNTgzMg==", "bodyText": "Should we add \"pbkdf2_stretch\"for completeness?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r534415832", "createdAt": "2020-12-02T19:10:58Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/ClusterPrivilegeIntegrationTests.java", "diffHunk": "@@ -79,8 +79,9 @@ protected String configRoles() {\n \n     @Override\n     protected String configUsers() {\n-        final String usersPasswdHashed = new String(Hasher.resolve(\n-            randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")).hash(new SecureString(\"passwd\".toCharArray())));\n+        final Hasher passwdHasher = inFipsJvm() ? Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\")) :\n+            Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")) ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTU1NjA5", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-543155609", "createdAt": "2020-12-02T19:11:34Z", "commit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMTozNFrOH9qLJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMTozNFrOH9qLJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxNjE2NQ==", "bodyText": "Same as above. \"pbkdf2_stretch\"?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r534416165", "createdAt": "2020-12-02T19:11:34Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/CreateDocsIndexPrivilegeTests.java", "diffHunk": "@@ -43,8 +43,9 @@ protected String configRoles() {\n \n     @Override\n     protected String configUsers() {\n-        final String usersPasswdHashed = new String(Hasher.resolve(\n-            randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")).hash(new SecureString(\"passwd\".toCharArray())));\n+        final Hasher passwdHasher = inFipsJvm() ? Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\")) :\n+            Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTU2MjM1", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-543156235", "createdAt": "2020-12-02T19:12:22Z", "commit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMjoyMlrOH9qNDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToxMjoyMlrOH9qNDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxNjY1Mw==", "bodyText": "Same as above. \"pbkdf2_stretch\"? There are few more cases below as well.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r534416653", "createdAt": "2020-12-02T19:12:22Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/internalClusterTest/java/org/elasticsearch/integration/IndexPrivilegeIntegTests.java", "diffHunk": "@@ -120,8 +121,9 @@ protected String configRoles() {\n \n     @Override\n     protected String configUsers() {\n-        final String usersPasswdHashed = new String(Hasher.resolve(\n-            randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\")).hash(new SecureString(\"passwd\".toCharArray())));\n+        final Hasher passwdHasher = inFipsJvm() ? Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\")) :\n+            Hasher.resolve(randomFrom(\"pbkdf2\", \"pbkdf2_1000\", \"bcrypt\", \"bcrypt9\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTc2NDQw", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-543176440", "createdAt": "2020-12-02T19:39:36Z", "commit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOTozOTozNlrOH9rL7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOTozOTozNlrOH9rL7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQzMjc0OQ==", "bodyText": "It may be outside of the scope of this PR, but do we plan to test Fips compatible PKCS12 keystores?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r534432749", "createdAt": "2020-12-02T19:39:36Z", "author": {"login": "BigPandaToo"}, "path": "libs/ssl-config/src/test/java/org/elasticsearch/common/ssl/SslConfigurationLoaderTests.java", "diffHunk": "@@ -103,6 +103,7 @@ public void testLoadTrustFromPemCAs() {\n     }\n \n     public void testLoadTrustFromPkcs12() {\n+        assumeFalse(\"Can't use JKS/PKCS12 keystores in a FIPS JVM\", inFipsJvm());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82c86a43ec588fff4da2162216d570db8201889e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30703327db7b97333f51f3de08748c93a68e2732", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/30703327db7b97333f51f3de08748c93a68e2732", "committedDate": "2020-12-03T10:38:55Z", "message": "Fix password in rest tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17a5ca478ca0df3f2496d45f7dca66507529d405", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/17a5ca478ca0df3f2496d45f7dca66507529d405", "committedDate": "2020-12-03T10:39:42Z", "message": "adjust fips.gradle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d3c8f2a49653dc4a4ae63bec2014b9265bf4f90", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/6d3c8f2a49653dc4a4ae63bec2014b9265bf4f90", "committedDate": "2020-12-03T20:43:35Z", "message": "disable test that assumes an OSS distribution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e903d7fe65c3e0c6c7b677630a7c5422b85fbd4", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e903d7fe65c3e0c6c7b677630a7c5422b85fbd4", "committedDate": "2020-12-03T20:57:26Z", "message": "Mute tests that explicitly set the license to basic in FIPS 140, as fips mode is not supported in basic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48164eb642a65781ab89e6238df6fb2a6f012b92", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/48164eb642a65781ab89e6238df6fb2a6f012b92", "committedDate": "2020-12-03T20:58:32Z", "message": "Fix SecurityDocumentationIT passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56c33fc474dc48c371970f4fe26feb72df8fe3a6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/56c33fc474dc48c371970f4fe26feb72df8fe3a6", "committedDate": "2020-12-03T21:00:38Z", "message": "Don't run ReloadSecureSettingsIT in fips mode. We could move this to xpack and enable TLS as a followup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce093a1f228dfa7cf4dfc47dc6a5e99ea6ec872f", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/ce093a1f228dfa7cf4dfc47dc6a5e99ea6ec872f", "committedDate": "2020-12-04T07:09:56Z", "message": "Don't run geo tests with default distribution testclusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d9edb1079e5a1a7cf91714249057ec1a3ba0468", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/1d9edb1079e5a1a7cf91714249057ec1a3ba0468", "committedDate": "2020-12-04T07:10:35Z", "message": "Add password to the keystore of the docs testcluster, even when not in FIPS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "581a954d764f08488416d44cde396bc114f96b7c", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/581a954d764f08488416d44cde396bc114f96b7c", "committedDate": "2020-12-04T07:11:42Z", "message": "fix yaml syntax"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d557343ad818d5cd60aabad4b6ae063d5a5ce05e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/d557343ad818d5cd60aabad4b6ae063d5a5ce05e", "committedDate": "2020-12-04T07:20:08Z", "message": "yet more unfixed passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7991e077636909eba3ab54e272e212833651d487", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7991e077636909eba3ab54e272e212833651d487", "committedDate": "2020-12-04T07:32:15Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3528016f13afdf05af04103545317e858df0d357", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3528016f13afdf05af04103545317e858df0d357", "committedDate": "2020-12-04T08:04:39Z", "message": "Fix SecurityIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b0b1e07afdddb4fe2b135c7c3018906edf8ae71", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/5b0b1e07afdddb4fe2b135c7c3018906edf8ae71", "committedDate": "2020-12-04T08:43:33Z", "message": "correctly(this time) fix yaml syntax"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b475af5c0779b9e695c3081b9402d61b4768999d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b475af5c0779b9e695c3081b9402d61b4768999d", "committedDate": "2020-12-04T08:57:55Z", "message": "mute mapper-extras tests until issue with trial is resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67ef1f988955e62f10c576d5d8cb763acee90cdf", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/67ef1f988955e62f10c576d5d8cb763acee90cdf", "committedDate": "2020-12-04T08:59:16Z", "message": "missing import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "950bc4c88609c9a1c1f884023bc7389bad62d8ef", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/950bc4c88609c9a1c1f884023bc7389bad62d8ef", "committedDate": "2020-12-04T11:30:13Z", "message": "Adjust passwords in docs integration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2493529fe5c8052136d9b17d7929b911bb7445ea", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/2493529fe5c8052136d9b17d7929b911bb7445ea", "committedDate": "2020-12-04T13:46:58Z", "message": "Another round of password adjustments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/3a0b6d01ab2676fdb297818c0b98ca00720fb4e2", "committedDate": "2020-12-04T14:46:26Z", "message": "factor out selecting a random hashing algo to a method of its own"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "637d3560c35c7f4424f2f8f27743980159f4ebc2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/637d3560c35c7f4424f2f8f27743980159f4ebc2", "committedDate": "2020-12-06T06:43:21Z", "message": "revert unintended formatting changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "418fb16302901330ec713f9c7fd8606e2a87ab4e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/418fb16302901330ec713f9c7fd8606e2a87ab4e", "committedDate": "2020-12-06T06:43:49Z", "message": "Mute test that needs OSS cluster in FIPS 140 mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NDcxMzY3", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-546471367", "createdAt": "2020-12-07T19:34:23Z", "commit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxOTozNDoyM1rOIA3NQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMDo1OToxN1rOIA6cGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzc3NTQyNg==", "bodyText": "Doesn't look like we ever validate this password, so may be leaving the rang in {6, 19} would make sense just for completenes (since normally do allow shorter passwords)", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r537775426", "createdAt": "2020-12-07T19:34:23Z", "author": {"login": "BigPandaToo"}, "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/SecurityIT.java", "diffHunk": "@@ -222,7 +222,7 @@ private PutUserRequest randomPutUserRequest(boolean enabled) {\n     }\n \n     private static PutUserRequest randomPutUserRequest(User user, boolean enabled) {\n-        final char[] password = randomAlphaOfLengthBetween(6, 10).toCharArray();\n+        final char[] password = randomAlphaOfLengthBetween(14, 19).toCharArray();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzc5NzA2Mg==", "bodyText": "Do all these tests fail in FIPS AO? It just doen't look like we are really get to any hashing here.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r537797062", "createdAt": "2020-12-07T20:07:54Z", "author": {"login": "BigPandaToo"}, "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java", "diffHunk": "@@ -158,9 +158,9 @@ protected Settings restAdminSettings() {\n     public void testGetUsers() throws Exception {\n         final RestHighLevelClient client = highLevelClient();\n         String[] usernames = new String[] {\"user1\", \"user2\", \"user3\"};\n-        addUser(client, usernames[0], randomAlphaOfLengthBetween(6, 10));\n-        addUser(client, usernames[1], randomAlphaOfLengthBetween(6, 10));\n-        addUser(client, usernames[2], randomAlphaOfLengthBetween(6, 10));\n+        addUser(client, usernames[0], randomAlphaOfLengthBetween(14, 18));\n+        addUser(client, usernames[1], randomAlphaOfLengthBetween(14, 18));\n+        addUser(client, usernames[2], randomAlphaOfLengthBetween(14, 18));\n         {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgyMjgyOQ==", "bodyText": "Should we add some randomization here and below?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r537822829", "createdAt": "2020-12-07T20:50:08Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/action/user/PutUserRequestBuilderTests.java", "diffHunk": "@@ -144,8 +145,8 @@ public void testWithEnabled() throws IOException {\n     }\n \n     public void testWithValidPasswordHash() throws IOException {\n-        final Hasher hasher = Hasher.BCRYPT4; // this is the fastest hasher we officially support\n-        final char[] hash = hasher.hash(new SecureString(\"secret\".toCharArray()));\n+        final Hasher hasher = inFipsJvm() ? Hasher.PBKDF2_1000 : Hasher.BCRYPT4; // this is the fastest hasher we officially support", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgyNzUzMQ==", "bodyText": "Also, why no getFastStoredHashAlgoForTests()?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r537827531", "createdAt": "2020-12-07T20:57:49Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/action/user/PutUserRequestBuilderTests.java", "diffHunk": "@@ -144,8 +145,8 @@ public void testWithEnabled() throws IOException {\n     }\n \n     public void testWithValidPasswordHash() throws IOException {\n-        final Hasher hasher = Hasher.BCRYPT4; // this is the fastest hasher we officially support\n-        final char[] hash = hasher.hash(new SecureString(\"secret\".toCharArray()));\n+        final Hasher hasher = inFipsJvm() ? Hasher.PBKDF2_1000 : Hasher.BCRYPT4; // this is the fastest hasher we officially support", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgyMjgyOQ=="}, "originalCommit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgyODM3Nw==", "bodyText": "getFastStoredHashAlgoForTests()?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r537828377", "createdAt": "2020-12-07T20:59:17Z", "author": {"login": "BigPandaToo"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/file/FileRealmTests.java", "diffHunk": "@@ -61,21 +61,21 @@ public void init() throws Exception {\n         userPasswdStore = mock(FileUserPasswdStore.class);\n         userRolesStore = mock(FileUserRolesStore.class);\n         globalSettings = Settings.builder().put(\"path.home\", createTempDir()).put(\"xpack.security.authc.password_hashing.algorithm\",\n-            randomFrom(\"bcrypt9\", \"pbkdf2\")).\n+            inFipsJvm() ? \"pbkdf2\" : \"bcrypt9\").", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a0b6d01ab2676fdb297818c0b98ca00720fb4e2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8edfb24910bcd3cf2b1c582ddaf3246df1fdae3d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/8edfb24910bcd3cf2b1c582ddaf3246df1fdae3d", "committedDate": "2020-12-08T06:26:50Z", "message": "Add some information about testing in fips mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b52dc6d899b2d3ad81bb385a394b2a0e913b1e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/91b52dc6d899b2d3ad81bb385a394b2a0e913b1e", "committedDate": "2020-12-08T06:39:30Z", "message": "address feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3f6cc7ac6341e8c38a9ec993966515139f49e75", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/c3f6cc7ac6341e8c38a9ec993966515139f49e75", "committedDate": "2020-12-08T07:36:36Z", "message": "Fix file user test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b1ae435fd96b691386c9c7d6b51818979d7805b7", "committedDate": "2020-12-08T07:54:54Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDM4MTY5", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-547438169", "createdAt": "2020-12-08T17:01:34Z", "commit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4ODQwNzk4", "url": "https://github.com/elastic/elasticsearch/pull/64024#pullrequestreview-548840798", "createdAt": "2020-12-10T05:35:58Z", "commit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "state": "APPROVED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozNTo1OVrOIC2UkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNjowMTo0MVrOIC28lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1ODA2NQ==", "bodyText": "Not really related to this PR, but I am intrigued to see that these passwords can be less than 14 chars and I was curious about how it is possible. By briefly click through the code, it seems BCFKS internally adds padding to the password with a purpose, e.g. PRIVATE_KEY_ENCRYPTION, so that the length is always ok.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539858065", "createdAt": "2020-12-10T05:35:59Z", "author": {"login": "ywangd"}, "path": "gradle/fips.gradle", "diffHunk": "@@ -53,6 +53,9 @@ if (BuildParams.inFipsJvm) {\n           systemProperty 'javax.net.ssl.trustStorePassword', 'password'\n           systemProperty 'javax.net.ssl.keyStorePassword', 'password'\n           systemProperty 'javax.net.ssl.keyStoreType', 'BCFKS'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2MDU3Nw==", "bodyText": "It must be my lack of knowledge. But could you please explain a bit more about why it cannot run with FIPS when it is expected to run with OSS? Does it not run with default distribution? Or is it because the test cluster always uses OSS license?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539860577", "createdAt": "2020-12-10T05:42:47Z", "author": {"login": "ywangd"}, "path": "modules/lang-painless/src/yamlRestTest/resources/rest-api-spec/test/painless/71_context_api.yml", "diffHunk": "@@ -1,11 +1,17 @@\n \"Action to list contexts\":\n+    - skip:\n+        features: fips_140\n+        reason: \"The tests expect to be run with OSS distribution\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2MTA4Mw==", "bodyText": "That's interesting. It's off-topic, but I wonder why it would fail with trial license.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539861083", "createdAt": "2020-12-10T05:44:17Z", "author": {"login": "ywangd"}, "path": "modules/mapper-extras/build.gradle", "diffHunk": "@@ -29,3 +31,8 @@ restResources {\n     includeCore '_common', 'cluster', 'nodes', 'indices', 'index', 'search', 'get'\n   }\n }\n+if (BuildParams.inFipsJvm){\n+  // The cluster fails to form with a trial license and we can't test FIPS 140 mode with a basic license", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2MjQ0MA==", "bodyText": "Is it not necessary since everything is disabled in the parent project's gradle file (plugins/examples/build.gradle)?", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539862440", "createdAt": "2020-12-10T05:47:59Z", "author": {"login": "ywangd"}, "path": "plugins/examples/painless-whitelist/build.gradle", "diffHunk": "@@ -31,7 +33,10 @@ esplugin {\n dependencies {\n   compileOnly \"org.elasticsearch.plugin:elasticsearch-scripting-painless-spi:${versions.elasticsearch}\"\n }\n-\n+if (BuildParams.inFipsJvm){\n+  // This test cluster is using OSS distribution and FIPS 140 mode is not supported in OSS\n+  tasks.named(\"yamlRestTest\").configure{enabled = false }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2Mzg0MA==", "bodyText": "It might be helpful to add a comment that keystore reloading with FIPS is tested with ReloadSecureSettingsWithPasswordProtectedKeystoreRestIT, so no test coverage gap here.", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539863840", "createdAt": "2020-12-10T05:51:58Z", "author": {"login": "ywangd"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/action/admin/ReloadSecureSettingsIT.java", "diffHunk": "@@ -54,6 +55,12 @@\n @ESIntegTestCase.ClusterScope(minNumDataNodes = 2)\n public class ReloadSecureSettingsIT extends ESIntegTestCase {\n \n+    @BeforeClass\n+    public static void disableInFips() {\n+        assumeFalse(\"Cannot run in FIPS mode since the keystore will be password protected and sending a password in the reload\" +\n+            \"settings api call, require TLS to be configured for the transport layer\", inFipsJvm());\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2ODMxMQ==", "bodyText": "Not sure whether this could be a problem? Does our FIPS mode cover the plugins as well? These plugins (enrich, eql etc.) are available out of the box. Ideally they should also be tested with FIPS? If license is an issue, maybe we can change it to trial or even random between them?\nWith that being said, I am happy to have this as a follow-up item (if it is an issue).", "url": "https://github.com/elastic/elasticsearch/pull/64024#discussion_r539868311", "createdAt": "2020-12-10T06:01:41Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/enrich/qa/rest-with-security/build.gradle", "diffHunk": "@@ -1,9 +1,15 @@\n apply plugin: 'elasticsearch.java-rest-test'\n \n+import org.elasticsearch.gradle.info.BuildParams\n+\n dependencies {\n   javaRestTestImplementation project(path: xpackModule('core'))\n   javaRestTestImplementation project(path: xpackModule('enrich:qa:common'))\n }\n+if (BuildParams.inFipsJvm){\n+  // This test cluster is using a BASIC license and FIPS 140 mode is not supported in BASIC\n+  tasks.named(\"javaRestTest\").configure{enabled = false }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ae435fd96b691386c9c7d6b51818979d7805b7"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d01e2738f3ad2800f4b0480ee062eb145fa6ada2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/d01e2738f3ad2800f4b0480ee062eb145fa6ada2", "committedDate": "2020-12-10T09:23:15Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97b67852ff21b34b001851f0848bd8cb0e055d94", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/97b67852ff21b34b001851f0848bd8cb0e055d94", "committedDate": "2020-12-10T10:03:54Z", "message": "address feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7af03f178fa815956c1d60da75a6f9c1b4c670ae", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7af03f178fa815956c1d60da75a6f9c1b4c670ae", "committedDate": "2020-12-10T18:23:16Z", "message": "Expect warnings when running with default distribution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c858e53f8667aa63bef6e3facc249fce0b2634f7", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/c858e53f8667aa63bef6e3facc249fce0b2634f7", "committedDate": "2020-12-10T18:23:50Z", "message": "Use strong passwords in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "407a84f50f408df40c502b2eb20b4f4210a8b425", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/407a84f50f408df40c502b2eb20b4f4210a8b425", "committedDate": "2020-12-10T18:24:18Z", "message": "Use appropriate length private keys"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0b2d249db9b5e84a386bfdf5bf6cb03e1ae6865", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/c0b2d249db9b5e84a386bfdf5bf6cb03e1ae6865", "committedDate": "2020-12-10T18:25:24Z", "message": "Use appropriate length SecretKey for EC2, as it is used for key generation and should be > 112 bits in fips mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3fc3659d7413d1e63131a18a6b65829de3567e5", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/e3fc3659d7413d1e63131a18a6b65829de3567e5", "committedDate": "2020-12-10T20:04:46Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a60a820632eddfb8fd92ffeee3a2bda28948cef5", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/a60a820632eddfb8fd92ffeee3a2bda28948cef5", "committedDate": "2020-12-11T07:14:01Z", "message": "Change GCS RSA keys to 2048bits so that tests don't fail in FIPS mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6571baf864acb370faedba0d63588fc368422f8", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/e6571baf864acb370faedba0d63588fc368422f8", "committedDate": "2020-12-11T07:33:41Z", "message": "Mute CCR test downgrading to basic in FIPS mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c59f54b926595f53f1415ce785ab2e04d31bae12", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/c59f54b926595f53f1415ce785ab2e04d31bae12", "committedDate": "2020-12-17T13:13:46Z", "message": "fix more"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0e4fd62978b5e56a48f035253aeb5c22768177b", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b0e4fd62978b5e56a48f035253aeb5c22768177b", "committedDate": "2020-12-17T15:01:06Z", "message": "Mute tests in fips when security is disabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e2cbcc928f08b4371379428b571da52c55a2d0b", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/8e2cbcc928f08b4371379428b571da52c55a2d0b", "committedDate": "2020-12-17T15:01:19Z", "message": "Mute test using PKCS12"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80d67d17f81fb431767c0e6fd59b40c9a05a1a62", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/80d67d17f81fb431767c0e6fd59b40c9a05a1a62", "committedDate": "2020-12-17T15:24:35Z", "message": "remove unnecessary policy application"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "126797fa1c6a873a5dbf1b92206b43186b9c9e2d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/126797fa1c6a873a5dbf1b92206b43186b9c9e2d", "committedDate": "2020-12-17T15:27:11Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f95d92d442756d685bb429561576a06cc49b211", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/8f95d92d442756d685bb429561576a06cc49b211", "committedDate": "2020-12-17T17:26:49Z", "message": "Ensure Kerberos fixture runs with fips 140-2 approved enctypes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d03db0ba893f8bb95bc6ff3521f1549388b4ccc6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/d03db0ba893f8bb95bc6ff3521f1549388b4ccc6", "committedDate": "2020-12-17T20:55:22Z", "message": "use long passwords in kerberos tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d42b51302abfe54dd61f37b24a24c418c69d855", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/9d42b51302abfe54dd61f37b24a24c418c69d855", "committedDate": "2020-12-17T21:45:16Z", "message": "adjust password length"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8457d17905969880a8c47d22c7495ae106b7570e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/8457d17905969880a8c47d22c7495ae106b7570e", "committedDate": "2020-12-18T06:45:05Z", "message": "mute tests instead of all the tasks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "082b6125a915f206296dc0c4438e2fe7415631ce", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/082b6125a915f206296dc0c4438e2fe7415631ce", "committedDate": "2020-12-18T09:19:09Z", "message": "Change moar passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c2c182b0bd3c0371024554530864db53ed5508c", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/1c2c182b0bd3c0371024554530864db53ed5508c", "committedDate": "2020-12-18T11:40:44Z", "message": "Mutes qa tests that fail in CI until we can investigate more"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9b752e2e43871e1edb236837de143cdea3aaaac", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/e9b752e2e43871e1edb236837de143cdea3aaaac", "committedDate": "2020-12-18T13:42:10Z", "message": "yet another password"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae3b8cac5f1239df058dc266036b7c6d79700b66", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/ae3b8cac5f1239df058dc266036b7c6d79700b66", "committedDate": "2020-12-18T13:42:23Z", "message": "no tests run"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0223ef089eec3eac73a9a900862a2de20b997fc3", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/0223ef089eec3eac73a9a900862a2de20b997fc3", "committedDate": "2020-12-19T07:38:36Z", "message": "Allow ESRestTestClient to trust certificates\n\nESRestTestCase rest clients could only be configured to trust\nthe certificate authorities that were contained in a truststore. In\ncertain cases (like in fips mode where JKS/PKCS12 keystores) cannot\nbe used, it's beneficial to be able to trust specific certificate\nauthorities (indicated by the CA PEM endoded certificate)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe015ba96c9359f1a674720c31012504923b0905", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/fe015ba96c9359f1a674720c31012504923b0905", "committedDate": "2020-12-19T08:18:47Z", "message": "Adjust reindex from remote QA test to use PEM CA cert instead of a PKCS12 store"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23c52db860bd5957b989db9e73543de9f67a56f5", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/23c52db860bd5957b989db9e73543de9f67a56f5", "committedDate": "2020-12-19T09:42:03Z", "message": "more passwords"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ef71b728cb495cac5e17373629ffa6cf4f99920", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7ef71b728cb495cac5e17373629ffa6cf4f99920", "committedDate": "2020-12-19T09:42:26Z", "message": "reference issue in muted CCR tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22fd8eaf01a43294081bb3cee8dead7a97c8219e", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/22fd8eaf01a43294081bb3cee8dead7a97c8219e", "committedDate": "2020-12-21T06:41:13Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9f18f14836435ea45aa08fbcc0c332ba8a62700", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/f9f18f14836435ea45aa08fbcc0c332ba8a62700", "committedDate": "2020-12-21T07:35:50Z", "message": "handle encrypted keystores in SetupPasswordToolIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fa921b9755b332134ccad4e1f1302682f259384", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/5fa921b9755b332134ccad4e1f1302682f259384", "committedDate": "2020-12-23T07:49:17Z", "message": "set license to trial for testclusters as we can't use fips mode in basic. All the tests that require basic license are already muted in fips mode so they won't be affected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "419900196d24e5aea68ccc3bb42e4685681e54a2", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/419900196d24e5aea68ccc3bb42e4685681e54a2", "committedDate": "2020-12-23T07:55:02Z", "message": "Disable bwc tests in fips mode as there arent' many ( only 7.11 ) versions that can be run in a correctly configured FIPS 140-2 JVM and we are lacking granural control of which bwc versions can be used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6028fc08e5393577ce3722a35d9b52b6114ae8c7", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/6028fc08e5393577ce3722a35d9b52b6114ae8c7", "committedDate": "2020-12-23T10:47:14Z", "message": "use long enough azure.client.key in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "658e8291d6ecff00689ba73e3d8e4c11a15a9246", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/658e8291d6ecff00689ba73e3d8e4c11a15a9246", "committedDate": "2020-12-23T10:47:32Z", "message": "use long enough ec2 access keys in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7eb72044ddf28cb182af225a0e8de541e0d34f8b", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/7eb72044ddf28cb182af225a0e8de541e0d34f8b", "committedDate": "2020-12-23T11:06:55Z", "message": "another short access key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15e930a65d307372a6a535f1da843e2d5105f71c", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/15e930a65d307372a6a535f1da843e2d5105f71c", "committedDate": "2020-12-23T11:07:10Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d54d3d2695f74e0c9332d3d282edf5c7dc6a596", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/0d54d3d2695f74e0c9332d3d282edf5c7dc6a596", "committedDate": "2020-12-23T14:01:14Z", "message": "Change docker integ tests to use PEM key/certificates instead of keystores so that these can be run in fips mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7bdcdedec369cb8bcb70e3ce9364f409a134e5d", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/b7bdcdedec369cb8bcb70e3ce9364f409a134e5d", "committedDate": "2020-12-23T14:01:32Z", "message": "Change remote-clusters integ tests to use PEM key/certificates instead of keystores so that these can be run in fips mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "801da6f7c5c02266c20ed2bc80c0d67d7de15fae", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/801da6f7c5c02266c20ed2bc80c0d67d7de15fae", "committedDate": "2020-12-23T15:34:34Z", "message": "Fix all s3 fixture related tests by using the correct access key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f812ca2f8ea67c20a2692bc62372fa7804a3e7a6", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/f812ca2f8ea67c20a2692bc62372fa7804a3e7a6", "committedDate": "2020-12-23T15:34:50Z", "message": "Merge remote-tracking branch 'origin/master' into fips-approved-mode-tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1099, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}