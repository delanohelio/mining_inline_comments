{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzMjkyOTAz", "number": 62198, "title": "Deprecate the 'local' parameter of `/_cat/indices`", "bodyText": "The cat indices APIs perform a ClusterStateAction then an IndicesStatsAction. They accept the ?local parameter and pass this to the ClusterStateAction but this parameter has no effect on the IndicesStatsAction.\nThis commit deprecates the ?local parameter on this API so that it can be removed in 8.0.\nRelated #60718", "createdAt": "2020-09-10T02:32:38Z", "url": "https://github.com/elastic/elasticsearch/pull/62198", "merged": true, "mergeCommit": {"oid": "41fbc52743f998203c9548d608bf6ea22e0f67a6"}, "closed": true, "closedAt": "2020-10-29T11:59:06Z", "author": {"login": "boicehuang"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHXTNNAH2gAyNDgzMjkyOTAzOjQ2ODc0MjFjN2Q3YzViZDdmNzc3ZjBkYTdlYmEwYWQ3YTYxNjY1YjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXPQXsgH2gAyNDgzMjkyOTAzOjkwMjE2MDllNTRhZWI1NGJlMDQzMmNjODE3ZGFjMGMxZmI4ZTk2YjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/4687421c7d7c5bd7f777f0da7eba0ad7a61665b6", "committedDate": "2020-09-10T02:23:30Z", "message": "Deprecate the 'local' parameter of /_cat/indices"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNTYwMTg1", "url": "https://github.com/elastic/elasticsearch/pull/62198#pullrequestreview-493560185", "createdAt": "2020-09-22T15:03:34Z", "commit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNTowMzozNFrOHV-r4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNTowODoyNFrOHV-7Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjgwOTE4Nw==", "bodyText": "This creates two entries for the local parameter, one pulled from the common-parms file and this one. I'll solicit some input from our documentation writers on how best to handle this.", "url": "https://github.com/elastic/elasticsearch/pull/62198#discussion_r492809187", "createdAt": "2020-09-22T15:03:34Z", "author": {"login": "danhermann"}, "path": "docs/reference/cat/indices.asciidoc", "diffHunk": "@@ -75,6 +75,14 @@ include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=help]\n include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=include-unloaded-segments]\n \n include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=local]\n++\n+--\n+`local`::\n+(Optional, boolean) If true, the request retrieves information from the local node\n+only. Defaults to false, which means information is retrieved from the master node.\n+deprecated::[8.0,This parameter does not cause this API to act locally. It will be\n+removed in version 8.0.]\n+--", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjgxMzE0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                static final String LOCAL_DEPRECATED_MESSAGE = \"Deprecated parameter [local] used. This parameter does not cause this API to act \" +\n          \n          \n            \n                    \"locally, and should not be used. It will be unsupported in version 8.0.\";\n          \n          \n            \n                static final String LOCAL_DEPRECATED_MESSAGE = \"The parameter [local] is deprecated and will be removed in a future release.\";", "url": "https://github.com/elastic/elasticsearch/pull/62198#discussion_r492813147", "createdAt": "2020-09-22T15:08:24Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestIndicesAction.java", "diffHunk": "@@ -66,6 +67,9 @@\n import static org.elasticsearch.rest.RestRequest.Method.GET;\n \n public class RestIndicesAction extends AbstractCatAction {\n+    private static final DeprecationLogger DEPRECATION_LOGGER = DeprecationLogger.getLogger(RestIndicesAction.class);\n+    static final String LOCAL_DEPRECATED_MESSAGE = \"Deprecated parameter [local] used. This parameter does not cause this API to act \" +\n+        \"locally, and should not be used. It will be unsupported in version 8.0.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNjIyOTgx", "url": "https://github.com/elastic/elasticsearch/pull/62198#pullrequestreview-493622981", "createdAt": "2020-09-22T16:05:01Z", "commit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNjowNTowMlrOHWBqcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNjowNTowM1rOHWBqgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1Nzk2OA==", "bodyText": "Shouldn't this be the release in which we deprecate the parameter? That should be before 8.0.0.", "url": "https://github.com/elastic/elasticsearch/pull/62198#discussion_r492857968", "createdAt": "2020-09-22T16:05:02Z", "author": {"login": "jrodewig"}, "path": "rest-api-spec/src/main/resources/rest-api-spec/api/cat.indices.json", "diffHunk": "@@ -51,7 +51,11 @@\n       },\n       \"local\":{\n         \"type\":\"boolean\",\n-        \"description\":\"Return local information, do not retrieve the state from master node (default: false)\"\n+        \"description\":\"Return local information, do not retrieve the state from master node (default: false)\",\n+        \"deprecated\":{\n+          \"version\":\"8.0.0\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjg1Nzk4NQ==", "bodyText": "@boicehuang @danhermann You can simply remove the include statement. Since this parameter is currently no-op, we can just expand the deprecation message. Note you'll need to update the deprecation release based on where we backport this.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=local]\n          \n          \n            \n            +\n          \n          \n            \n            --\n          \n          \n            \n            `local`::\n          \n          \n            \n            (Optional, boolean) If true, the request retrieves information from the local node\n          \n          \n            \n            only. Defaults to false, which means information is retrieved from the master node.\n          \n          \n            \n            deprecated::[8.0,This parameter does not cause this API to act locally. It will be\n          \n          \n            \n            removed in version 8.0.]\n          \n          \n            \n            --\n          \n          \n            \n            `local`::\n          \n          \n            \n            (Optional, boolean)\n          \n          \n            \n            +\n          \n          \n            \n            deprecated::[7.10.0,\"This parameter does not affect the request. It will be removed in version 8.0.0.\"]", "url": "https://github.com/elastic/elasticsearch/pull/62198#discussion_r492857985", "createdAt": "2020-09-22T16:05:03Z", "author": {"login": "jrodewig"}, "path": "docs/reference/cat/indices.asciidoc", "diffHunk": "@@ -75,6 +75,14 @@ include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=help]\n include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=include-unloaded-segments]\n \n include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=local]\n++\n+--\n+`local`::\n+(Optional, boolean) If true, the request retrieves information from the local node\n+only. Defaults to false, which means information is retrieved from the master node.\n+deprecated::[8.0,This parameter does not cause this API to act locally. It will be\n+removed in version 8.0.]\n+--", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4687421c7d7c5bd7f777f0da7eba0ad7a61665b6"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00e4e36879c40c7e40ec2ac82482ee6b365a9a6c", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/00e4e36879c40c7e40ec2ac82482ee6b365a9a6c", "committedDate": "2020-10-16T10:09:48Z", "message": "fix indices.asciidoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a4604b670f973851b8e5d50c23ca2d3e4bb34ed", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/4a4604b670f973851b8e5d50c23ca2d3e4bb34ed", "committedDate": "2020-10-16T10:11:34Z", "message": "fix deprecated log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f01c026c27577eafe6328a2696cb93d8221fac9", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/8f01c026c27577eafe6328a2696cb93d8221fac9", "committedDate": "2020-10-19T00:12:08Z", "message": "Merge remote-tracking branch 'upstream/master' into cat_indices_local"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1376c765ba5313d67e94a263eae248858c73d6f", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/a1376c765ba5313d67e94a263eae248858c73d6f", "committedDate": "2020-10-28T07:37:05Z", "message": "fix description"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "742df9f997c1c3f50e8facb172b30728aa326d4e", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/742df9f997c1c3f50e8facb172b30728aa326d4e", "committedDate": "2020-10-29T10:02:05Z", "message": "fix doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9021609e54aeb54be0432cc817dac0c1fb8e96b6", "author": {"user": {"login": "boicehuang", "name": "Boice Huang"}}, "url": "https://github.com/elastic/elasticsearch/commit/9021609e54aeb54be0432cc817dac0c1fb8e96b6", "committedDate": "2020-10-29T10:03:57Z", "message": "Merge remote-tracking branch 'upstream/master' into cat_indices_local"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4670, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}