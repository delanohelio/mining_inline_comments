{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2Njg2MTgw", "number": 54547, "title": "Replace license check isAuthAllowed with isSecurityEnabled", "bodyText": "The isAuthAllowed() method for license checking is used by code that\nwants to ensure security is both enabled and available. The enabled\nstate is dynamic and provided by isSecurityEnabled(). But since security\nis available with all license types, an check on the license level is\nnot necessary. Thus, this change replaces isAuthAllowed() with calling\nisSecurityEnabled().", "createdAt": "2020-04-01T00:06:01Z", "url": "https://github.com/elastic/elasticsearch/pull/54547", "merged": true, "mergeCommit": {"oid": "6efa5c5d6b0e2bbed50ed59176d06c91926bbf21"}, "closed": true, "closedAt": "2020-04-10T17:41:54Z", "author": {"login": "rjernst"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTMOKBAH2gAyMzk2Njg2MTgwOjNhOWJlODQ5YTg4ZjkzMmE1MTM2ZDhmYjc0NWRmNzQwYTU3OTM2NTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVrDSYAH2gAyMzk2Njg2MTgwOjgxYjk3MDQ0YWU4YjE4ZmYwZGQxMWY4NWY5Yjc5OTA4MDk1YTBhYmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3a9be849a88f932a5136d8fb745df740a5793653", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/3a9be849a88f932a5136d8fb745df740a5793653", "committedDate": "2020-04-01T00:04:58Z", "message": "Replace license check isAuthAllowed with isSecurityEnabled\n\nThe isAuthAllowed() method for license checking is used by code that\nwants to ensure security is both enabled and available. The enabled\nstate is dynamic and provided by isSecurityEnabled(). But since security\nis available with all license types, an check on the license level is\nnot necessary. Thus, this change replaces isAuthAllowed() with calling\nisSecurityEnabled()."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5555866fc88a235096472f8a791a0ae4a8ed9f45", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/5555866fc88a235096472f8a791a0ae4a8ed9f45", "committedDate": "2020-04-01T19:47:53Z", "message": "actually remove the old method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f1f13d55785df4e2b51c385575c55c94399deca", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/5f1f13d55785df4e2b51c385575c55c94399deca", "committedDate": "2020-04-01T19:59:04Z", "message": "Merge branch 'master' into refactor_license7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b451ef97f28a066811e5b365c69e5235cd67f83b", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/b451ef97f28a066811e5b365c69e5235cd67f83b", "committedDate": "2020-04-02T19:11:03Z", "message": "Merge branch 'master' into refactor_license7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40da1fbdcc7733d28eaf27e2c1eb5471df479865", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/40da1fbdcc7733d28eaf27e2c1eb5471df479865", "committedDate": "2020-04-06T22:26:20Z", "message": "Merge branch 'master' into refactor_license7"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MjA5MzE5", "url": "https://github.com/elastic/elasticsearch/pull/54547#pullrequestreview-389209319", "createdAt": "2020-04-07T15:04:25Z", "commit": {"oid": "40da1fbdcc7733d28eaf27e2c1eb5471df479865"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NjM0ODQ3", "url": "https://github.com/elastic/elasticsearch/pull/54547#pullrequestreview-389634847", "createdAt": "2020-04-08T03:50:06Z", "commit": {"oid": "40da1fbdcc7733d28eaf27e2c1eb5471df479865"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMzo1MDowN1rOGCeCvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMzo1MDowN1rOGCeCvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI0MjU1OQ==", "bodyText": "We briefly chatted about this elsewhere but in this test class security should always be enabled so I think that this should no longer be in a loop over internal state but just go ahead and call enableLicensing(OperationMode.BASIC)", "url": "https://github.com/elastic/elasticsearch/pull/54547#discussion_r405242559", "createdAt": "2020-04-08T03:50:07Z", "author": {"login": "jaymode"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/license/LicensingTests.java", "diffHunk": "@@ -245,7 +245,7 @@ private void disableLicensing() throws Exception {\n         // wait for things to stabilize!\n         assertBusy(() -> {\n             for (XPackLicenseState licenseState : internalCluster().getInstances(XPackLicenseState.class)) {\n-                if (licenseState.isAuthAllowed() == false) {\n+                if (licenseState.isSecurityEnabled() == false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40da1fbdcc7733d28eaf27e2c1eb5471df479865"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a9af8e6f72eaebbbbdaf6a45ee072b63a3909f4", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/1a9af8e6f72eaebbbbdaf6a45ee072b63a3909f4", "committedDate": "2020-04-08T06:15:42Z", "message": "remove no longer relevant test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "145ffb85c91dabe99a10251df7fad6ff797fb19d", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/145ffb85c91dabe99a10251df7fad6ff797fb19d", "committedDate": "2020-04-08T17:07:10Z", "message": "Merge branch 'master' into refactor_license7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81b97044ae8b18ff0dd11f85f9b79908095a0abd", "author": {"user": {"login": "rjernst", "name": "Ryan Ernst"}}, "url": "https://github.com/elastic/elasticsearch/commit/81b97044ae8b18ff0dd11f85f9b79908095a0abd", "committedDate": "2020-04-08T17:08:00Z", "message": "remove unused imports"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1424, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}