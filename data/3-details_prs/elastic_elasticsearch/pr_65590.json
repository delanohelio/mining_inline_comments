{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NDczODI3", "number": 65590, "title": "Remove support of creating CA on the fly when generating certificates", "bodyText": "Generating certificates with the cert sub-command now requires either: 1) a CA to be provided with --ca or --ca-cert/--ca-key; or 2) make them self-signed with the --self-signed option. Generating a CA on the fly is no longer supported. The --keep-ca-key option is removed and the tool throws an error if it is specified.\nThis is a follow-up PR for #61884, which deprecated the \"ca-on-the-fly\" usage.\nResolves: #61884", "createdAt": "2020-11-30T11:11:26Z", "url": "https://github.com/elastic/elasticsearch/pull/65590", "merged": true, "mergeCommit": {"oid": "b018c761e9e64b4e2f5e52bafd654998dc504dfd"}, "closed": true, "closedAt": "2020-12-16T02:54:33Z", "author": {"login": "ywangd"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhjOlygH2gAyNTI5NDczODI3OmM1NTRkNGViM2YwNGMyNWM0MDViYThmMGI0NDAwZGNlMDU0NzlhMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmkAb8gH2gAyNTI5NDczODI3OjM2YjlhY2JjMmE4NGJjN2YxMDhkZDU3MTZlMTY3NDE5MGRlMzUxNDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c554d4eb3f04c25c405ba8f0b4400dce05479a0e", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/c554d4eb3f04c25c405ba8f0b4400dce05479a0e", "committedDate": "2020-11-30T10:59:21Z", "message": "Remove keep-ca-key option for certutil.\n\nGenerating certs now always require a CA to be provided or to be\nself-signed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDk0NTg2", "url": "https://github.com/elastic/elasticsearch/pull/65590#pullrequestreview-552094586", "createdAt": "2020-12-15T04:20:40Z", "commit": {"oid": "c554d4eb3f04c25c405ba8f0b4400dce05479a0e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNDoyMDo0MFrOIF4NRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNDoyMDo0MFrOIF4NRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzAzNDY5NQ==", "bodyText": "I would drop the sentence about --self-signed.", "url": "https://github.com/elastic/elasticsearch/pull/65590#discussion_r543034695", "createdAt": "2020-12-15T04:20:40Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/cli/src/main/java/org/elasticsearch/xpack/security/cli/CertificateTool.java", "diffHunk": "@@ -145,6 +146,22 @@ public static void main(String[] args) throws Exception {\n         subcommands.put(\"http\", new HttpCertificateCommand());\n     }\n \n+    @Override\n+    protected void execute(Terminal terminal, OptionSet options) throws Exception {\n+        try {\n+            super.execute(terminal, options);\n+        } catch (OptionException e) {\n+            if (e.options().size() == 1 && e.options().contains(\"keep-ca-key\")) {\n+                throw new UserException(ExitCodes.USAGE,\n+                    \"Generating certificates without providing a CA is no longer supported.\\n\" +\n+                        \"Please first generate a CA with the 'ca' sub-command and provide the ca file \\n\" +\n+                        \"with either --ca or --ca-cert/--ca-key to generate certificates.\\n\" +\n+                        \"Alternatively, you can also generate self-signed certificates with --self-signed.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c554d4eb3f04c25c405ba8f0b4400dce05479a0e"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16d51d3c0b292c33aee76531c4a21a0698204f71", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/16d51d3c0b292c33aee76531c4a21a0698204f71", "committedDate": "2020-12-16T00:43:21Z", "message": "address feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36b9acbc2a84bc7f108dd5716e1674190de35140", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/36b9acbc2a84bc7f108dd5716e1674190de35140", "committedDate": "2020-12-16T00:43:25Z", "message": "Merge remote-tracking branch 'origin/master' into es-61884-certutil-remove-no-ca"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4351, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}