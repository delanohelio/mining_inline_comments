{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxOTIyNTAx", "number": 53924, "title": "Introduce formal role for remote cluster client", "bodyText": "This commit introduce a formal role for identifying nodes that are capable of making connections to remote clusters.", "createdAt": "2020-03-21T22:02:43Z", "url": "https://github.com/elastic/elasticsearch/pull/53924", "merged": true, "mergeCommit": {"oid": "1fc0432b244624ef800b616324f1d4d5911fcba8"}, "closed": true, "closedAt": "2020-03-24T23:21:57Z", "author": {"login": "jasontedor"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcP8c5mgH2gAyMzkxOTIyNTAxOmNhNjA1NzRlYTRjZmFlZTc0MjMzOGMzYmJhODZkYmZmY2Y5NmE1Mzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQ61YKAFqTM4MDc0Nzk1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ca60574ea4cfaee742338c3bba86dbffcf96a539", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/ca60574ea4cfaee742338c3bba86dbffcf96a539", "committedDate": "2020-03-21T22:00:49Z", "message": "Introduce formal role for remote cluster client\n\nThis commit introduce a formal role for identifying nodes that are\ncapable of making connections to remote clusters."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0fd36ad818b1c3343f9b44f70cd57fa0b46866d", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/c0fd36ad818b1c3343f9b44f70cd57fa0b46866d", "committedDate": "2020-03-21T23:19:58Z", "message": "Fix logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c8dab749b76a25da2daa0f21420f8aa8f6ac738", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/4c8dab749b76a25da2daa0f21420f8aa8f6ac738", "committedDate": "2020-03-21T23:31:23Z", "message": "Fix logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fceee1b56b55ffd5b4f732cb0c8efa92399a575c", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/fceee1b56b55ffd5b4f732cb0c8efa92399a575c", "committedDate": "2020-03-21T23:47:15Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ef398395cea56b8a3af390c5df77d0e90779643", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/7ef398395cea56b8a3af390c5df77d0e90779643", "committedDate": "2020-03-22T01:27:54Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9938e5e077b20878f348f52e3ff053ad3ccc29c", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/d9938e5e077b20878f348f52e3ff053ad3ccc29c", "committedDate": "2020-03-22T01:35:55Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "407c7b16ff1194f166cf368f50db40ceba700c1e", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/407c7b16ff1194f166cf368f50db40ceba700c1e", "committedDate": "2020-03-22T01:52:34Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dd2df54b9ae87e503971abb680980eb5fd7d3c6", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/8dd2df54b9ae87e503971abb680980eb5fd7d3c6", "committedDate": "2020-03-22T12:09:07Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91cb86a1d8123dcb739262e94461836eecb47c07", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/91cb86a1d8123dcb739262e94461836eecb47c07", "committedDate": "2020-03-22T13:50:31Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee52c2fcb0bd6f26d5262838938b995ab2661252", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/ee52c2fcb0bd6f26d5262838938b995ab2661252", "committedDate": "2020-03-22T15:25:58Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c0216aa8774e6b7314f542b8a3bce009538561a", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/8c0216aa8774e6b7314f542b8a3bce009538561a", "committedDate": "2020-03-22T15:50:02Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da81d3fb8a7c011b4459c3d4f87d2c8952bd4002", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/da81d3fb8a7c011b4459c3d4f87d2c8952bd4002", "committedDate": "2020-03-23T21:09:46Z", "message": "Merge branch 'master' into remote-cluster-client-role"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "389f5e238d3ce169a5f7e159c33b1f3d869af30a", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/389f5e238d3ce169a5f7e159c33b1f3d869af30a", "committedDate": "2020-03-23T22:34:47Z", "message": "Merge remote-tracking branch 'elastic/master' into remote-cluster-client-role"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0647f12b10abafe1e2836ca0499b461d1768a1c5", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/0647f12b10abafe1e2836ca0499b461d1768a1c5", "committedDate": "2020-03-23T22:36:48Z", "message": "Update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acba939510cfb91e907669925cd77945f8be20d3", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/acba939510cfb91e907669925cd77945f8be20d3", "committedDate": "2020-03-24T01:30:21Z", "message": "Fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNjM3ODE3", "url": "https://github.com/elastic/elasticsearch/pull/53924#pullrequestreview-380637817", "createdAt": "2020-03-24T19:38:30Z", "commit": {"oid": "acba939510cfb91e907669925cd77945f8be20d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxOTozODozMVrOF7AKpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxOTozODozMVrOF7AKpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQxMzAyOQ==", "bodyText": "Shouldn't this be based on version? At what point would this get updated? Perhaps we could use a map of role to min version (or a predicate) and iterate over them checking each role when serializing against the version of the output stream?", "url": "https://github.com/elastic/elasticsearch/pull/53924#discussion_r397413029", "createdAt": "2020-03-24T19:38:31Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeRole.java", "diffHunk": "@@ -134,10 +134,21 @@ public final String toString() {\n \n     };\n \n+    public static final DiscoveryNodeRole REMOTE_CLUSTER_CLIENT_ROLE = new DiscoveryNodeRole(\"remote_cluster_client\", \"r\") {\n+\n+        @Override\n+        protected Setting<Boolean> roleSetting() {\n+            return Node.NODE_REMOTE_CLUSTER_CLIENT;\n+        }\n+\n+    };\n+\n     /**\n      * The built-in node roles.\n      */\n-    public static Set<DiscoveryNodeRole> BUILT_IN_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE);\n+    public static Set<DiscoveryNodeRole> BUILT_IN_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE, REMOTE_CLUSTER_CLIENT_ROLE);\n+\n+    static Set<DiscoveryNodeRole> LEGACY_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acba939510cfb91e907669925cd77945f8be20d3"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzQ3OTUx", "url": "https://github.com/elastic/elasticsearch/pull/53924#pullrequestreview-380747951", "createdAt": "2020-03-24T22:41:33Z", "commit": {"oid": "acba939510cfb91e907669925cd77945f8be20d3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjo0MTozM1rOF7Fy0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMjo0MTozM1rOF7Fy0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzUwNTIzNA==", "bodyText": "Thanks for the explanation", "url": "https://github.com/elastic/elasticsearch/pull/53924#discussion_r397505234", "createdAt": "2020-03-24T22:41:33Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeRole.java", "diffHunk": "@@ -134,10 +134,21 @@ public final String toString() {\n \n     };\n \n+    public static final DiscoveryNodeRole REMOTE_CLUSTER_CLIENT_ROLE = new DiscoveryNodeRole(\"remote_cluster_client\", \"r\") {\n+\n+        @Override\n+        protected Setting<Boolean> roleSetting() {\n+            return Node.NODE_REMOTE_CLUSTER_CLIENT;\n+        }\n+\n+    };\n+\n     /**\n      * The built-in node roles.\n      */\n-    public static Set<DiscoveryNodeRole> BUILT_IN_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE);\n+    public static Set<DiscoveryNodeRole> BUILT_IN_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE, REMOTE_CLUSTER_CLIENT_ROLE);\n+\n+    static Set<DiscoveryNodeRole> LEGACY_ROLES = Set.of(DATA_ROLE, INGEST_ROLE, MASTER_ROLE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQxMzAyOQ=="}, "originalCommit": {"oid": "acba939510cfb91e907669925cd77945f8be20d3"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1748, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}