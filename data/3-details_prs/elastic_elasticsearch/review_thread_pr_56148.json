{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMTI3MTEx", "number": 56148, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMDoxMjoyNlrOD5JawQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzoxMDozM1rOD5R4Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMjQ5NzI5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/sql/jdbc/src/test/java/org/elasticsearch/xpack/sql/jdbc/VersionParityTests.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMDoxMjoyNlrOGQQZTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwODoxNDo0MVrOGQe5Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY5OTAyMA==", "bodyText": "Those can be outside of the loop no?\nand probably the whole try - catch can \"wrap\" the loop?", "url": "https://github.com/elastic/elasticsearch/pull/56148#discussion_r419699020", "createdAt": "2020-05-04T20:12:26Z", "author": {"login": "matriv"}, "path": "x-pack/plugin/sql/jdbc/src/test/java/org/elasticsearch/xpack/sql/jdbc/VersionParityTests.java", "diffHunk": "@@ -38,14 +38,19 @@ public void testExceptionThrownOnIncompatibleVersions() throws IOException, SQLE\n     }\n     \n     public void testNoExceptionThrownForCompatibleVersions() throws IOException {\n-        prepareResponse(null);\n-        \n-        String url = JdbcConfiguration.URL_PREFIX + webServerAddress();\n-        try {\n-            new JdbcHttpClient(JdbcConfiguration.create(url, null, 0));\n-        } catch (SQLException sqle) {\n-            fail(\"JDBC driver version and Elasticsearch server version should be compatible. Error: \" + sqle);\n-        }\n+        Version version = Version.CURRENT;\n+        do {\n+            prepareResponse(version);\n+\n+            String url = JdbcConfiguration.URL_PREFIX + webServerAddress();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e69337b193c185a1422c61cea5be63cbe2b8a03"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkzNjU5OA==", "bodyText": "Yes, you're right, thanks!", "url": "https://github.com/elastic/elasticsearch/pull/56148#discussion_r419936598", "createdAt": "2020-05-05T08:14:41Z", "author": {"login": "bpintea"}, "path": "x-pack/plugin/sql/jdbc/src/test/java/org/elasticsearch/xpack/sql/jdbc/VersionParityTests.java", "diffHunk": "@@ -38,14 +38,19 @@ public void testExceptionThrownOnIncompatibleVersions() throws IOException, SQLE\n     }\n     \n     public void testNoExceptionThrownForCompatibleVersions() throws IOException {\n-        prepareResponse(null);\n-        \n-        String url = JdbcConfiguration.URL_PREFIX + webServerAddress();\n-        try {\n-            new JdbcHttpClient(JdbcConfiguration.create(url, null, 0));\n-        } catch (SQLException sqle) {\n-            fail(\"JDBC driver version and Elasticsearch server version should be compatible. Error: \" + sqle);\n-        }\n+        Version version = Version.CURRENT;\n+        do {\n+            prepareResponse(version);\n+\n+            String url = JdbcConfiguration.URL_PREFIX + webServerAddress();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY5OTAyMA=="}, "originalCommit": {"oid": "6e69337b193c185a1422c61cea5be63cbe2b8a03"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMzg4MzQ2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/sql/sql-action/src/main/java/org/elasticsearch/xpack/sql/action/AbstractSqlQueryRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzoxMDozM1rOGQc--Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwODoxNTo0NlrOGQe7oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkwNTI3Mw==", "bodyText": "Do you think this method better belongs to SqlVersion class where hasVersionCompatibility() is also defined?", "url": "https://github.com/elastic/elasticsearch/pull/56148#discussion_r419905273", "createdAt": "2020-05-05T07:10:33Z", "author": {"login": "astefan"}, "path": "x-pack/plugin/sql/sql-action/src/main/java/org/elasticsearch/xpack/sql/action/AbstractSqlQueryRequest.java", "diffHunk": "@@ -233,6 +234,11 @@ public ActionRequestValidationException validate() {\n         return validationException;\n     }\n \n+    protected boolean isClientCompatible() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e69337b193c185a1422c61cea5be63cbe2b8a03"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkzNzE4NA==", "bodyText": "Yeh, I had a hesitation initially, but it does belong there more naturally. Thanks for raising it.", "url": "https://github.com/elastic/elasticsearch/pull/56148#discussion_r419937184", "createdAt": "2020-05-05T08:15:46Z", "author": {"login": "bpintea"}, "path": "x-pack/plugin/sql/sql-action/src/main/java/org/elasticsearch/xpack/sql/action/AbstractSqlQueryRequest.java", "diffHunk": "@@ -233,6 +234,11 @@ public ActionRequestValidationException validate() {\n         return validationException;\n     }\n \n+    protected boolean isClientCompatible() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkwNTI3Mw=="}, "originalCommit": {"oid": "6e69337b193c185a1422c61cea5be63cbe2b8a03"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2359, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}