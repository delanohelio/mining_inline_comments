{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNjcxMTY1", "number": 54036, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzoyMzo0NlrODqqzEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwODo0MDoxNFrODqsMzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MDY3OTg3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/persistence/TransformInternalIndex.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzoyMzo0NlrOF6jkZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMDo0MDo1OVrOF7CPgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk0NDQ4Nw==", "bodyText": "spelling nit: compatabilityVersion -> compatibilityVersion", "url": "https://github.com/elastic/elasticsearch/pull/54036#discussion_r396944487", "createdAt": "2020-03-24T07:23:46Z", "author": {"login": "hendrikmuhs"}, "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/persistence/TransformInternalIndex.java", "diffHunk": "@@ -96,19 +99,22 @@ public static IndexTemplateMetaData getIndexTemplateMetaData() throws IOExceptio\n         return transformTemplate;\n     }\n \n-    public static IndexTemplateMetaData getAuditIndexTemplateMetaData() throws IOException {\n+    public static IndexTemplateMetaData getAuditIndexTemplateMetaData(Version compatabilityVersion) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8507327c8f6c57337dc9ddfe2d073884868ce02f"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQ0NzA0MQ==", "bodyText": "Thanks, good catch.", "url": "https://github.com/elastic/elasticsearch/pull/54036#discussion_r397447041", "createdAt": "2020-03-24T20:40:59Z", "author": {"login": "gwbrown"}, "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/persistence/TransformInternalIndex.java", "diffHunk": "@@ -96,19 +99,22 @@ public static IndexTemplateMetaData getIndexTemplateMetaData() throws IOExceptio\n         return transformTemplate;\n     }\n \n-    public static IndexTemplateMetaData getAuditIndexTemplateMetaData() throws IOException {\n+    public static IndexTemplateMetaData getAuditIndexTemplateMetaData(Version compatabilityVersion) throws IOException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk0NDQ4Nw=="}, "originalCommit": {"oid": "8507327c8f6c57337dc9ddfe2d073884868ce02f"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MDkwOTU3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/persistence/TransformInternalIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwODo0MDoxNFrOF6l0HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwODo0MDoxNFrOF6l0HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4MTI3Ng==", "bodyText": "FWIW, for later readers: I think this is the important change of this PR as this is the place where a (potentially new) non-master calls the (potentially old) master.", "url": "https://github.com/elastic/elasticsearch/pull/54036#discussion_r396981276", "createdAt": "2020-03-24T08:40:14Z", "author": {"login": "hendrikmuhs"}, "path": "x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/persistence/TransformInternalIndex.java", "diffHunk": "@@ -399,7 +405,7 @@ protected static void installLatestAuditIndexTemplateIfRequired(\n \n         // Installing the template involves communication with the master node, so it's more expensive but much rarer\n         try {\n-            IndexTemplateMetaData indexTemplateMetaData = getAuditIndexTemplateMetaData();\n+            IndexTemplateMetaData indexTemplateMetaData = getAuditIndexTemplateMetaData(clusterService.state().nodes().getMinNodeVersion());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8507327c8f6c57337dc9ddfe2d073884868ce02f"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4234, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}