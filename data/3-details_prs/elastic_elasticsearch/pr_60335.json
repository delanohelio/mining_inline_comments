{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MDEwMTU1", "number": 60335, "title": "[ML] always write prediction_[score|probability] for classification inference", "bodyText": "In order to unify model inference and analytics results we\nneed to write the same fields.\nprediction_probability and prediction_score are now written\nfor inference calls against classification models.", "createdAt": "2020-07-28T19:35:53Z", "url": "https://github.com/elastic/elasticsearch/pull/60335", "merged": true, "mergeCommit": {"oid": "4b221959bcd7404d4ab16b26cca27c246a35c1f4"}, "closed": true, "closedAt": "2020-07-29T14:09:55Z", "author": {"login": "benwtrent"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5bqS6AH2gAyNDU4MDEwMTU1OmNiNjhhMzc4YTEzYmViYWYxM2Q0M2NjZGY5ZjEyMjMwODUzZWZmZmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5q4tNgH2gAyNDU4MDEwMTU1OmQwYTk0YjkxNTdiZTQ3ODU0MDJlNmZjNWZhYjFjNTE4NjlhZGQ1Y2E=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cb68a378a13bebaf13d43ccdf9f12230853efffb", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/cb68a378a13bebaf13d43ccdf9f12230853efffb", "committedDate": "2020-07-28T19:33:24Z", "message": "[ML] always write prediction_[score|probability] for classification inference\n\nIn order to unify model inference and analytics results we\nneed to write the same fields.\n\nprediction_probability and prediction_score are now written\nfor inference calls against classification models."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5b15e23969b34a1a1c39e0522576ab5eac2d64e", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/d5b15e23969b34a1a1c39e0522576ab5eac2d64e", "committedDate": "2020-07-28T19:59:42Z", "message": "Merge branch 'master' into feature/ml-inference-add-probability-score-classification"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2OTY2Mzk2", "url": "https://github.com/elastic/elasticsearch/pull/60335#pullrequestreview-456966396", "createdAt": "2020-07-28T20:01:00Z", "commit": {"oid": "d5b15e23969b34a1a1c39e0522576ab5eac2d64e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDowMTowMVrOG4cnIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDowOTozNlrOG4c4Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg0MjIwOQ==", "bodyText": "V_7_10_0 surely?", "url": "https://github.com/elastic/elasticsearch/pull/60335#discussion_r461842209", "createdAt": "2020-07-28T20:01:01Z", "author": {"login": "davidkyle"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/results/ClassificationInferenceResults.java", "diffHunk": "@@ -74,6 +75,11 @@ public ClassificationInferenceResults(StreamInput in) throws IOException {\n         } else {\n             this.predictionFieldType = PredictionFieldType.STRING;\n         }\n+        if (in.getVersion().onOrAfter(Version.V_7_9_0)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5b15e23969b34a1a1c39e0522576ab5eac2d64e"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg0NjU2Nw==", "bodyText": "Should LangIdentNeuralNetwork have the same logic?", "url": "https://github.com/elastic/elasticsearch/pull/60335#discussion_r461846567", "createdAt": "2020-07-28T20:09:36Z", "author": {"login": "davidkyle"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/inference/TreeInferenceModel.java", "diffHunk": "@@ -178,7 +178,7 @@ private InferenceResults buildResult(double[] value,\n                     classificationProbability(value),\n                     classificationLabels,\n                     null,\n-                    classificationConfig.getNumTopClasses(),\n+                    classificationConfig.getNumTopClasses() == 0 ? 1 : classificationConfig.getNumTopClasses(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5b15e23969b34a1a1c39e0522576ab5eac2d64e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1271fab417d76c12d115036f4e86176ca2f7c489", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/1271fab417d76c12d115036f4e86176ca2f7c489", "committedDate": "2020-07-28T20:24:52Z", "message": "fixing langident"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "621acb6823ed6b1148ad669a8131806c0938b333", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/621acb6823ed6b1148ad669a8131806c0938b333", "committedDate": "2020-07-28T20:34:42Z", "message": "Merge branch 'feature/ml-inference-add-probability-score-classification' of github.com:benwtrent/elasticsearch into feature/ml-inference-add-probability-score-classification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6a9f8e3f9669c13ff0c65b7be9771a194878a3d", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/b6a9f8e3f9669c13ff0c65b7be9771a194878a3d", "committedDate": "2020-07-29T11:28:41Z", "message": "fixing serialization code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDMyODQ0", "url": "https://github.com/elastic/elasticsearch/pull/60335#pullrequestreview-457432844", "createdAt": "2020-07-29T11:31:11Z", "commit": {"oid": "b6a9f8e3f9669c13ff0c65b7be9771a194878a3d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0a94b9157be4785402e6fc5fab1c51869add5ca", "author": {"user": {"login": "benwtrent", "name": "Benjamin Trent"}}, "url": "https://github.com/elastic/elasticsearch/commit/d0a94b9157be4785402e6fc5fab1c51869add5ca", "committedDate": "2020-07-29T13:17:43Z", "message": "fixing serialization and object build"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3726, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}