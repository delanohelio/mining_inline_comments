{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4ODE1NTM0", "number": 52690, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzowODo1MVrODjEa4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoxMTo0NlrODjEeQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MDk5MTY5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzowODo1MVrOFuq0ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNTozMTowOVrOFvFskw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4MDQ1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    clusterService.submitStateUpdateTask(\"put-mapping \" + getRequestIndex(request),\n          \n          \n            \n                    clusterService.submitStateUpdateTask(\"put-mapping \" + Strings.arrayToCommaDelimitedString(request.indices())),\n          \n      \n    \n    \n  \n\nThis removes the need for the method below too.", "url": "https://github.com/elastic/elasticsearch/pull/52690#discussion_r384480451", "createdAt": "2020-02-26T13:08:51Z", "author": {"login": "henningandersen"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java", "diffHunk": "@@ -326,7 +326,7 @@ private ClusterState applyRequest(ClusterState currentState, PutMappingClusterSt\n     }\n \n     public void putMapping(final PutMappingClusterStateUpdateRequest request, final ActionListener<ClusterStateUpdateResponse> listener) {\n-        clusterService.submitStateUpdateTask(\"put-mapping\",\n+        clusterService.submitStateUpdateTask(\"put-mapping \" + getRequestIndex(request),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be9c40aa09a1342ff78147002a941c8b0bac5013"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyMDcyMw==", "bodyText": "that's great", "url": "https://github.com/elastic/elasticsearch/pull/52690#discussion_r384920723", "createdAt": "2020-02-27T05:31:09Z", "author": {"login": "zhanghezhen"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetaDataMappingService.java", "diffHunk": "@@ -326,7 +326,7 @@ private ClusterState applyRequest(ClusterState currentState, PutMappingClusterSt\n     }\n \n     public void putMapping(final PutMappingClusterStateUpdateRequest request, final ActionListener<ClusterStateUpdateResponse> listener) {\n-        clusterService.submitStateUpdateTask(\"put-mapping\",\n+        clusterService.submitStateUpdateTask(\"put-mapping \" + getRequestIndex(request),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4MDQ1MQ=="}, "originalCommit": {"oid": "be9c40aa09a1342ff78147002a941c8b0bac5013"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MTAwMDM1OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/cluster/metadata/MetaDataMappingServiceTests.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoxMTo0NlrOFuq6Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNTozMTo0NVrOFvFtLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4MTgzMQ==", "bodyText": "Given that we have the comma concatenating logic, I think we can omit the test here.", "url": "https://github.com/elastic/elasticsearch/pull/52690#discussion_r384481831", "createdAt": "2020-02-26T13:11:46Z", "author": {"login": "henningandersen"}, "path": "server/src/test/java/org/elasticsearch/cluster/metadata/MetaDataMappingServiceTests.java", "diffHunk": "@@ -113,4 +113,17 @@ public void testMappingVersionUnchanged() throws Exception {\n         assertThat(result.resultingState.metaData().index(\"test\").getMappingVersion(), equalTo(previousVersion));\n     }\n \n+    public void testGetRequestIndex() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be9c40aa09a1342ff78147002a941c8b0bac5013"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkyMDg3Ng==", "bodyText": "Of course", "url": "https://github.com/elastic/elasticsearch/pull/52690#discussion_r384920876", "createdAt": "2020-02-27T05:31:45Z", "author": {"login": "zhanghezhen"}, "path": "server/src/test/java/org/elasticsearch/cluster/metadata/MetaDataMappingServiceTests.java", "diffHunk": "@@ -113,4 +113,17 @@ public void testMappingVersionUnchanged() throws Exception {\n         assertThat(result.resultingState.metaData().index(\"test\").getMappingVersion(), equalTo(previousVersion));\n     }\n \n+    public void testGetRequestIndex() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4MTgzMQ=="}, "originalCommit": {"oid": "be9c40aa09a1342ff78147002a941c8b0bac5013"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3747, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}