{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTcxNjI4", "number": 64433, "title": "Enhance logging for timed out transport requests", "bodyText": "Apropos of nothing\u2014\nThe current logging:\nReceived response for a request that has timed out, sent [2148898ms] ago, timed out [348859ms] ago\n\nThis just saves having to do the mental math for milliseconds and produces:\nReceived response for a request that has timed out, sent [35.8m/2148898ms] ago, timed out [5.8m/348859ms] ago", "createdAt": "2020-10-30T17:35:39Z", "url": "https://github.com/elastic/elasticsearch/pull/64433", "merged": true, "mergeCommit": {"oid": "c6b4b953f72c13217de763d27c263124ff189302"}, "closed": true, "closedAt": "2020-11-02T18:19:31Z", "author": {"login": "dakrone"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXqRwXAH2gAyNTEzMTcxNjI4OmRjNTc5ZDIxNDg5ZTQ2YThkYjg4MjZlYzE0NzQzN2FmMmJhMGRjZGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYnaAJgH2gAyNTEzMTcxNjI4OjRkNDE2ZjY5NTlhOTAwMWY1YTlmYjBlN2I3YjA5YmUxYjQ4NTBiMDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc579d21489e46a8db8826ec147437af2ba0dcdd", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/dc579d21489e46a8db8826ec147437af2ba0dcdd", "committedDate": "2020-10-30T17:32:54Z", "message": "Enhance logging for timed out transport requests\n\nThe current logging:\n\n```\nReceived response for a request that has timed out, sent [2148898ms] ago, timed out [348859ms] ago\n```\n\nThis just saves having to do the mental math for milliseconds and produces:\n\n```\nReceived response for a request that has timed out, sent [35.8m/2148898ms] ago, timed out [5.8m/348859ms] ago\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwOTY3MDg4", "url": "https://github.com/elastic/elasticsearch/pull/64433#pullrequestreview-520967088", "createdAt": "2020-10-30T19:22:11Z", "commit": {"oid": "dc579d21489e46a8db8826ec147437af2ba0dcdd"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxOToyMjoxMlrOHrc9Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxOToyMjoxMlrOHrc9Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTMyNTIyNw==", "bodyText": "nit: maybe calculate these in a local, rather then doing each twice", "url": "https://github.com/elastic/elasticsearch/pull/64433#discussion_r515325227", "createdAt": "2020-10-30T19:22:12Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/transport/TransportService.java", "diffHunk": "@@ -947,8 +947,10 @@ private void checkForTimeout(long requestId) {\n         TimeoutInfoHolder timeoutInfoHolder = timeoutInfoHandlers.remove(requestId);\n         if (timeoutInfoHolder != null) {\n             long time = threadPool.relativeTimeInMillis();\n-            logger.warn(\"Received response for a request that has timed out, sent [{}ms] ago, timed out [{}ms] ago, \" +\n-                    \"action [{}], node [{}], id [{}]\", time - timeoutInfoHolder.sentTime(), time - timeoutInfoHolder.timeoutTime(),\n+            logger.warn(\"Received response for a request that has timed out, sent [{}/{}ms] ago, timed out [{}/{}ms] ago, \" +\n+                    \"action [{}], node [{}], id [{}]\",\n+                TimeValue.timeValueMillis(time - timeoutInfoHolder.sentTime()), time - timeoutInfoHolder.sentTime(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc579d21489e46a8db8826ec147437af2ba0dcdd"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9f446868af080483f221d0243d188f49a516486", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/b9f446868af080483f221d0243d188f49a516486", "committedDate": "2020-11-02T16:45:31Z", "message": "Pull into local var and only subtract one time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d416f6959a9001f5a9fb0e7b7b09be1b4850b06", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/4d416f6959a9001f5a9fb0e7b7b09be1b4850b06", "committedDate": "2020-11-02T16:46:07Z", "message": "Merge branch 'master' into enhance-logging"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 891, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}