{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzNjE4MTQ5", "number": 58035, "reviewThreads": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo0NDozMlrOEFGuWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxOToxNDozOFrOEFKiEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzg4NTA3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo0NDozMlrOGjIyaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0Mjo0NlrOGjoquw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ5NzMyMQ==", "bodyText": "This is breaking the docs CI test. I'll go ahead and merge this change in.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [[ilm-gs-create-policy]]\n          \n          \n            \n            [[manage-time-series-data-without-data-streams]]", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439497321", "createdAt": "2020-06-12T15:44:32Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>\n+      \"step_time_millis\": 1538475653317,\n+      \"phase_execution\": {\n+        \"policy\": \"timeseries_policy\",\n+        \"phase_definition\": {                    <4>\n+          \"min_age\": \"0ms\",\n+          \"actions\": {\n+            \"rollover\": {\n+              \"max_size\": \"50gb\",\n+              \"max_age\": \"30d\"\n+            }\n+          }\n+        },\n+        \"version\": 1,\n+        \"modified_date_in_millis\": 1539609701576\n+      }\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// TESTRESPONSE[skip:no way to know if we will get this response immediately]\n+\n+<1> The policy used to manage the index\n+<2> The age of the index\n+<3> The step {ilm-init} is performing on the index\n+<4> The definition of the current phase (the `hot` phase)\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_data_stream/timeseries\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_index_template/timeseries_template\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+[discrete]\n+[[ilm-gs-create-policy]]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab1e2a70a8c579f2d982fb90ab28eac55f1d10df"}, "originalPosition": 213}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxOTY0Mw==", "bodyText": "Thanks for fixing this James. It wasn't obvious what the offending piece was from the test failure log output", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440019643", "createdAt": "2020-06-15T08:42:46Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>\n+      \"step_time_millis\": 1538475653317,\n+      \"phase_execution\": {\n+        \"policy\": \"timeseries_policy\",\n+        \"phase_definition\": {                    <4>\n+          \"min_age\": \"0ms\",\n+          \"actions\": {\n+            \"rollover\": {\n+              \"max_size\": \"50gb\",\n+              \"max_age\": \"30d\"\n+            }\n+          }\n+        },\n+        \"version\": 1,\n+        \"modified_date_in_millis\": 1539609701576\n+      }\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// TESTRESPONSE[skip:no way to know if we will get this response immediately]\n+\n+<1> The policy used to manage the index\n+<2> The age of the index\n+<3> The step {ilm-init} is performing on the index\n+<4> The definition of the current phase (the `hot` phase)\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_data_stream/timeseries\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_index_template/timeseries_template\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+[discrete]\n+[[ilm-gs-create-policy]]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ5NzMyMQ=="}, "originalCommit": {"oid": "ab1e2a70a8c579f2d982fb90ab28eac55f1d10df"}, "originalPosition": 213}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzkyMjM0OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo1NTo0MVrOGjJKAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo1NTo0MVrOGjJKAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUwMzM2MA==", "bodyText": "Nit: Removes either.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n          \n          \n            \n            A rollover target can be a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439503360", "createdAt": "2020-06-12T15:55:41Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzkyNzg2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo1NzoyMFrOGjJNgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNTo1NzoyMFrOGjJNgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUwNDI1OQ==", "bodyText": "I don't think we need a link after the first mention. However, I would link to write index\nas this is its first mention on this page.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index\n          \n          \n            \n            When targeting a data stream, the new index becomes the data stream's\n          \n          \n            \n            <<data-stream-write-index,write index>>", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439504259", "createdAt": "2020-06-12T15:57:20Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n+When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzk3NDEwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxMToxM1rOGjJrCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxMzowMlrOGjpxRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxMTgxNg==", "bodyText": "I got a little confused with this sentence:\n\nThe data stream out of the box makes sure the backing index has the correct name pattern, and the write index (ie. latest generation backing index) will be the target index to be rolled over.\n\nAre we trying to say one of the following?\nA. The new write index uses the data stream's naming convention?\nB. Rollover assumes the write index is the backing index with the latest generation?\nC. The rollover validates that the data stream's write index follows the naming convention and is\nthe backing index with the latest generation?\nIf it's any of those cases, I'd consider removing as it feels like an implementation detail. If you decide to keep it, I'd reword and remove the data stream xref.\nIf C, I'd maybe add some context on why this validation is needed (i.e. how a data stream could get into a state that fails the validation).", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439511816", "createdAt": "2020-06-12T16:11:13Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n+When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index\n+and its generation is incremented. The <<data-streams, data stream>> out of the box makes sure\n+the backing index has the correct name pattern, and the write index (ie. latest generation\n+backing index) will be the target index to be rolled over.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU5NDM2Ng==", "bodyText": "If we do keep it, I think removing the \"out of the box\" phrase might make it a little clearer.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439594366", "createdAt": "2020-06-12T19:02:15Z", "author": {"login": "dakrone"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n+When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index\n+and its generation is incremented. The <<data-streams, data stream>> out of the box makes sure\n+the backing index has the correct name pattern, and the write index (ie. latest generation\n+backing index) will be the target index to be rolled over.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxMTgxNg=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzNzcwMg==", "bodyText": "Ah I see how confusing it is now. It ties into the previous sentence that states that a new index becomes the data stream's write index. The reason I added this was C @jrodewig (which is one of the data stream's value proposition). I'll drop it all together as it doesn't add much value.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440037702", "createdAt": "2020-06-15T09:13:02Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n+When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index\n+and its generation is incremented. The <<data-streams, data stream>> out of the box makes sure\n+the backing index has the correct name pattern, and the write index (ie. latest generation\n+backing index) will be the target index to be rolled over.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxMTgxNg=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzk3ODczOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxMjoxMFrOGjJt6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxMjoxMFrOGjJt6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxMjU1Mw==", "bodyText": "Nit: reword for clarity.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In order for an <<indices-aliases, index alias>> target to be rolled over:\n          \n          \n            \n            To roll over an <<indices-aliases, index alias>>, the alias and its write index\n          \n          \n            \n            must meet the following conditions:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439512553", "createdAt": "2020-06-12T16:12:10Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-rollover.asciidoc", "diffHunk": "@@ -4,15 +4,21 @@\n \n Phases allowed: hot.\n \n-Rolls an alias over to a new index when the existing index meets one of the rollover conditions.\n+Rolls over a target to a new index when the existing index meets one of the rollover conditions.\n \n-IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>, \n+IMPORTANT: If the rollover action is used on a <<ccr-put-follow,follower index>>,\n policy execution waits until the leader index rolls over (or is\n-<<skipping-rollover, otherwise marked complete>>), \n-then converts the follower index into a regular index with the \n+<<skipping-rollover, otherwise marked complete>>),\n+then converts the follower index into a regular index with the\n <<ilm-unfollow-action, Unfollow action>>.\n \n-For a managed index to be rolled over: \n+A rollover target can be either a <<data-streams, data stream>> or an <<indices-aliases, index alias>>.\n+When targeting a <<data-streams, data stream>>, the new index becomes the data stream's write index\n+and its generation is incremented. The <<data-streams, data stream>> out of the box makes sure\n+the backing index has the correct name pattern, and the write index (ie. latest generation\n+backing index) will be the target index to be rolled over.\n+\n+In order for an <<indices-aliases, index alias>> target to be rolled over:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczNzk4NTc2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxMzoyOFrOGjJyHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxMzoyOFrOGjJyHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxMzYzMA==", "bodyText": "Nit: Avoid future tense when able.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            the mounted index will replace the original index in the data stream.\n          \n          \n            \n            the mounted index replaces the original index in the data stream.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439513630", "createdAt": "2020-06-12T16:13:28Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc", "diffHunk": "@@ -6,6 +6,14 @@ Phases allowed: cold.\n \n Takes a snapshot of the managed index in the configured repository\n and mounts it as a searchable snapshot.\n+If the managed index is part of a <<data-streams, data stream>>,\n+the mounted index will replace the original index in the data stream.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODAwNjc1OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjoxNzoyOVrOGjJ-Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxNjo1NVrOGjp6OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxNjc3NA==", "bodyText": "Nits: I reworded to make this a bit more direct.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [NOTE]\n          \n          \n            \n            This action will fail if the managed index is a <<data-streams, data stream's>>\n          \n          \n            \n            write index. Manually rolling over the data stream will change the <<data-streams, data stream's>>\n          \n          \n            \n            write index and the action will be able to continue converting the managed\n          \n          \n            \n            index to a searchable snapshot.\n          \n          \n            \n            [NOTE]\n          \n          \n            \n            This action cannot be performed on a data stream's write index. Attempts to do\n          \n          \n            \n            so will fail. To convert the index to a searchable snapshot, first\n          \n          \n            \n            <<manually-roll-over-a-data-stream,manually roll over>> the data stream. This\n          \n          \n            \n            creates a new write index. Because the index is no longer the stream's write\n          \n          \n            \n            index, the action can then convert it to a searchable snapshot.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439516774", "createdAt": "2020-06-12T16:17:29Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc", "diffHunk": "@@ -6,6 +6,14 @@ Phases allowed: cold.\n \n Takes a snapshot of the managed index in the configured repository\n and mounts it as a searchable snapshot.\n+If the managed index is part of a <<data-streams, data stream>>,\n+the mounted index will replace the original index in the data stream.\n+\n+[NOTE]\n+This action will fail if the managed index is a <<data-streams, data stream's>>\n+write index. Manually rolling over the data stream will change the <<data-streams, data stream's>>\n+write index and the action will be able to continue converting the managed\n+index to a searchable snapshot.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzOTk5Mg==", "bodyText": "Thanks, this sounds much better", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440039992", "createdAt": "2020-06-15T09:16:55Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc", "diffHunk": "@@ -6,6 +6,14 @@ Phases allowed: cold.\n \n Takes a snapshot of the managed index in the configured repository\n and mounts it as a searchable snapshot.\n+If the managed index is part of a <<data-streams, data stream>>,\n+the mounted index will replace the original index in the data stream.\n+\n+[NOTE]\n+This action will fail if the managed index is a <<data-streams, data stream's>>\n+write index. Manually rolling over the data stream will change the <<data-streams, data stream's>>\n+write index and the action will be able to continue converting the managed\n+index to a searchable snapshot.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUxNjc3NA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODA1ODc0OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjozNDoxOVrOGjKgCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToyNDoyNFrOGjqL5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyNTM4NA==", "bodyText": "Nit: Reword to match the snapshot action note.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This action will fail if the source index is a <<data-streams, data stream's>>\n          \n          \n            \n            write index. Manually rolling over the data stream will change the\n          \n          \n            \n            <<data-streams, data stream's>> write index and the action will be able to resume\n          \n          \n            \n            shrinking the source index.\n          \n          \n            \n            This action cannot be performed on a data stream's write index. Attempts to do\n          \n          \n            \n            so will fail. To shrink the index, first\n          \n          \n            \n            <<manually-roll-over-a-data-stream,manually roll over>> the data stream. This\n          \n          \n            \n            creates a new write index. Because the index is no longer the stream's write\n          \n          \n            \n            index, the action can resume shrinking it.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439525384", "createdAt": "2020-06-12T16:34:19Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "diffHunk": "@@ -21,6 +21,15 @@ policy execution waits until the leader index rolls over (or is\n then converts the follower index into a regular index with the \n <<ilm-unfollow-action,the Unfollow action>> before performing the shrink operation.\n \n+If the managed index is part of a <<data-streams, data stream>>,\n+the shrunken index will replace the original index in the data stream.\n+\n+[NOTE]\n+This action will fail if the source index is a <<data-streams, data stream's>>\n+write index. Manually rolling over the data stream will change the\n+<<data-streams, data stream's>> write index and the action will be able to resume\n+shrinking the source index.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU5NTcwOQ==", "bodyText": "I think both of these (both the original and James' suggestion) need to mention that the user could also specify a rollover in their ILM policy, I'm concerned that users will think that in order to use shrink at all (even with an existing rollover in their policy) they will have to manually roll over their index.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439595709", "createdAt": "2020-06-12T19:05:28Z", "author": {"login": "dakrone"}, "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "diffHunk": "@@ -21,6 +21,15 @@ policy execution waits until the leader index rolls over (or is\n then converts the follower index into a regular index with the \n <<ilm-unfollow-action,the Unfollow action>> before performing the shrink operation.\n \n+If the managed index is part of a <<data-streams, data stream>>,\n+the shrunken index will replace the original index in the data stream.\n+\n+[NOTE]\n+This action will fail if the source index is a <<data-streams, data stream's>>\n+write index. Manually rolling over the data stream will change the\n+<<data-streams, data stream's>> write index and the action will be able to resume\n+shrinking the source index.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyNTM4NA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA0NDUxNg==", "bodyText": "Added a line on this. Good shout Lee", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440044516", "createdAt": "2020-06-15T09:24:24Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "diffHunk": "@@ -21,6 +21,15 @@ policy execution waits until the leader index rolls over (or is\n then converts the follower index into a regular index with the \n <<ilm-unfollow-action,the Unfollow action>> before performing the shrink operation.\n \n+If the managed index is part of a <<data-streams, data stream>>,\n+the shrunken index will replace the original index in the data stream.\n+\n+[NOTE]\n+This action will fail if the source index is a <<data-streams, data stream's>>\n+write index. Manually rolling over the data stream will change the\n+<<data-streams, data stream's>> write index and the action will be able to resume\n+shrinking the source index.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyNTM4NA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODA1OTk2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjozNDo0N1rOGjKg5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjozNDo0N1rOGjKg5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyNTYwNA==", "bodyText": "Nit: avoids future tense.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            the shrunken index will replace the original index in the data stream.\n          \n          \n            \n            the shrunken index replaces the original index in the data stream.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439525604", "createdAt": "2020-06-12T16:34:47Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/actions/ilm-shrink.asciidoc", "diffHunk": "@@ -21,6 +21,15 @@ policy execution waits until the leader index rolls over (or is\n then converts the follower index into a regular index with the \n <<ilm-unfollow-action,the Unfollow action>> before performing the shrink operation.\n \n+If the managed index is part of a <<data-streams, data stream>>,\n+the shrunken index will replace the original index in the data stream.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODA4MjUxOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjo0MzowNVrOGjKwGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjo0MzowNVrOGjKwGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyOTQ5OQ==", "bodyText": "I would add an admon here so index alias users can skip to the appropriate section.\nI choose to focus on non-append-only use cases, but feel free to add others.\nI also tweaked the sentence to say data stream in place of time-series indices.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            To automate rollover and management of time-series indices with {ilm-init}, you:\n          \n          \n            \n            \n          \n          \n            \n            TIP: Data streams are best suited for\n          \n          \n            \n            <<data-streams-append-only,append-only>> use cases. If you need to frequently\n          \n          \n            \n            update or delete existing documents across multiple indices, we recommend\n          \n          \n            \n            using an index alias and index template instead. You can still use ILM to\n          \n          \n            \n            manage and rollover the alias's indices. Skip to\n          \n          \n            \n            <<manage-time-series-data-without-data-streams>>.\n          \n          \n            \n            \n          \n          \n            \n            To automate rollover and management of a data stream with {ilm-init}, you:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439529499", "createdAt": "2020-06-12T16:43:05Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -11,26 +11,28 @@ This tutorial demonstrates how to use {ilm}\n ({ilm-init}) to manage indices that contain time-series data.\n \n When you continuously index timestamped documents into {es},\n-you typically use an index alias so you can periodically roll over to a new index.\n+you typically use a <<data-streams, data stream>> so you can periodically roll over to a\n+new index.\n This enables you to implement a hot-warm-cold architecture to meet your performance\n requirements for your newest data, control costs over time, enforce retention policies,\n and still get the most out of your data.\n \n To automate rollover and management of time-series indices with {ilm-init}, you:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODEwMTY1OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjo0OToxMlrOGjK78w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNjo0OToxMlrOGjK78w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzMjUzMQ==", "bodyText": "Fixes a typo.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For example, you might create a `timeseries_template` that is will bootstrap a data stream\n          \n          \n            \n            For example, you might create a `timeseries_template` to use for a future data stream", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439532531", "createdAt": "2020-06-12T16:49:12Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODEzNjMzOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMDoyN1rOGjLSNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTozNDoxN1rOGjqiNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODIzMQ==", "bodyText": "Nit: Avoid \"we\" and future tense where possible.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To create a data stream we'll create a composable template with a `data_stream` definition\n          \n          \n            \n            that will specify the lifecycle policy.\n          \n          \n            \n            To set up a data stream, first create a composable template to specify the lifecycle policy. Because\n          \n          \n            \n            the template is for a data stream, it must also include a `data_stream` definition.\n          \n      \n    \n    \n  \n\nI wonder if we should mention other requirements here, specifically a timestamp mapping.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439538231", "createdAt": "2020-06-12T17:00:27Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU5NjgzNw==", "bodyText": "Starting the sentence with \"Because\" sounds awkward to me :D my suggestion:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To create a data stream we'll create a composable template with a `data_stream` definition\n          \n          \n            \n            that will specify the lifecycle policy.\n          \n          \n            \n            To set up a data stream, first create a composable template to specify the lifecycle policy. A composable template for used a data stream must include a `data_stream` definition.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439596837", "createdAt": "2020-06-12T19:08:11Z", "author": {"login": "dakrone"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODIzMQ=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcwMDIzOQ==", "bodyText": "I'm good with Lee's suggestion. Will leave mine up for context.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439700239", "createdAt": "2020-06-13T02:15:36Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODIzMQ=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA1MDIyOQ==", "bodyText": "A composable template for used a data stream must include a `data_stream` definition.\nThis doesn't make sense to me. Is it meant to be ?\nFor a composable template to be used with a data stream it must include a `data_stream` definition", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440050229", "createdAt": "2020-06-15T09:34:17Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODIzMQ=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODEzNzk4OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMTowMVrOGjLTNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMTowMVrOGjLTNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODQ4Nw==", "bodyText": "Replaces ILM with attribute.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n          \n          \n            \n            To enable the {ilm-init} to manage the data stream, the template configures one {ilm-init} setting:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439538487", "createdAt": "2020-06-12T17:01:01Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE0MDE3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMTo1MFrOGjLUqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMTo1MFrOGjLUqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzODg1OA==", "bodyText": "Nit: I'd align the callout numbers.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439538858", "createdAt": "2020-06-12T17:01:50Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE0MTQ2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMjoxOFrOGjLVhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMjoxOFrOGjLVhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzOTA3Nw==", "bodyText": "Nit: Breaks this into two sentences for readability.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <2> Identifies the timestamp field for the data source, a field that must be present\n          \n          \n            \n            <2> Identifies the timestamp field for the data source. This field must be present", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439539077", "createdAt": "2020-06-12T17:02:18Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE0MzM5OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMjo1NlrOGjLWww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMjo1NlrOGjLWww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzOTM5NQ==", "bodyText": "I think a date or date_nanos mapping for the timestamp field is now required. I'd included that here.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439539395", "createdAt": "2020-06-12T17:02:56Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE0NDQ5OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMzoxOVrOGjLXcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowMzoxOVrOGjLXcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUzOTU3MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <3> The name of the ILM policy used to manage the data stream.\n          \n          \n            \n            <3> The name of the {ilm-init} policy used to manage the data stream.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439539571", "createdAt": "2020-06-12T17:03:19Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE0ODgwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNDo0NlrOGjLaQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNDo0NlrOGjLaQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MDI5MQ==", "bodyText": "I'd say \"create\" rather than \"bootstrap\" here. Data streams kinda solve the original bootstrap problem so it'd be good to not use the same terminology.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [[ilm-gs-bootstrap]]\n          \n          \n            \n            === Bootstrap the data stream\n          \n          \n            \n            [[ilm-gs-create-the-data-stream]]\n          \n          \n            \n            === Create the data stream", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439540291", "createdAt": "2020-06-12T17:04:46Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 89}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE1MDk0OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNToyNlrOGjLbjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNToyNlrOGjLbjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MDYyMQ==", "bodyText": "Nit: Use direct imperative.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To get things started, you simply index a document into the name or wildcard pattern defined\n          \n          \n            \n            To get things started, index a document into the name or wildcard pattern defined", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439540621", "createdAt": "2020-06-12T17:05:26Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE1NTQwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNjo1NFrOGjLeYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowNjo1NFrOGjLeYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MTM0Nw==", "bodyText": "Adds some text to note that the target cannot already exist (e.g., I can't create the logs data stream if a logs index already exists).\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            in the `index_patterns` of the <<indices-templates,composable index template>> that will\n          \n          \n            \n            create the data stream.\n          \n          \n            \n            in the `index_patterns` of the <<indices-templates,composable index template>>. As long\n          \n          \n            \n            as an existing data stream, index, or index alias does not already use the name, the index\n          \n          \n            \n            request automatically creates a corresponding data stream with a single backing index.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439541347", "createdAt": "2020-06-12T17:06:54Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE2MDIyOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowODo0M1rOGjLhkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowODo0M1rOGjLhkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MjE2Mg==", "bodyText": "Nit: Avoid future tense.\nAlso notes that this new index is also the write index.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            {es} will automatically create the corresponding data stream and will index the document into\n          \n          \n            \n            the first backing index.\n          \n          \n            \n            {es} automatically indexes the request's documents into this backing index, which also\n          \n          \n            \n            acts as the stream's <<data-stream-write-index,write index>>.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439542162", "createdAt": "2020-06-12T17:08:43Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE2MjAzOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzowOTozMFrOGjLi4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTozODo0M1rOGjqsCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MjQ5OA==", "bodyText": "I think the conditions use an \"OR\" logic. This could be read as \"rollover happens when condition A and B is met\" not \"when A or B is met\"\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When the rollover conditions are met, the `rollover` action:\n          \n          \n            \n            When a rollover condition in the data stream's lifecycle policy is met, the `rollover` action:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439542498", "createdAt": "2020-06-12T17:09:30Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU5ODQ5Mw==", "bodyText": "I don't like @jrodewig's suggestion, the lifecycle policy does not belong to a data stream (that is a confusing notion). I prefer:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When the rollover conditions are met, the `rollover` action:\n          \n          \n            \n            When a rollover condition in the lifecycle policy is met, the `rollover` action:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439598493", "createdAt": "2020-06-12T19:12:07Z", "author": {"login": "dakrone"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MjQ5OA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcwMDMxNg==", "bodyText": "Good point. I'll leave mine up for context, but I recommend using Lee's suggestion.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439700316", "createdAt": "2020-06-13T02:16:31Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MjQ5OA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA1Mjc0Nw==", "bodyText": "Good point, thanks", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r440052747", "createdAt": "2020-06-15T09:38:43Z", "author": {"login": "andreidan"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0MjQ5OA=="}, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 111}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE3NDE5OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxMzo0NFrOGjLqyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxMzo0NFrOGjLqyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NDUyMw==", "bodyText": "Breaks this into two sentences for readability.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Write operations are routed to the current write index, whilst read operations will be handled by all\n          \n          \n            \n            backing indices.\n          \n          \n            \n            Write operations are routed to the current write index. Read operations will be handled by all\n          \n          \n            \n            backing indices.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439544523", "createdAt": "2020-06-12T17:13:44Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE3Njg5OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNDo0N1rOGjLstQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNDo0N1rOGjLstQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NTAxMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For example, the following request gets information about the `timeseries` indices:\n          \n          \n            \n            For example, the following request gets information about the `timeseries` data stream's\n          \n          \n            \n            backing indices:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439545013", "createdAt": "2020-06-12T17:14:47Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 136}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE3ODQ1OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNToxNlrOGjLtpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNToxNlrOGjLtpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NTI1Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The response below shows that the data stream's first generation backing index is waiting in the `hot`\n          \n          \n            \n            The following response shows the data stream's first generation backing index is waiting for the `hot`", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439545252", "createdAt": "2020-06-12T17:15:16Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE4Mjk3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNjo0OFrOGjLwgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNjo0OFrOGjLwgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NTk4NQ==", "bodyText": "Fix for OR logic\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This process repeats each time rollover conditions are met.\n          \n          \n            \n            This process repeats each time a rollover condition is met.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439545985", "createdAt": "2020-06-12T17:16:48Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 119}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE4NjMzOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNzo1MlrOGjLynw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoxNzo1MlrOGjLynw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NjUyNw==", "bodyText": "OR logic.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n          \n          \n            \n            are met.\n          \n          \n            \n            It remains in this state and {ilm-init} continues to call `attempt-rollover` until a rollover condition\n          \n          \n            \n            is met.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439546527", "createdAt": "2020-06-12T17:17:52Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 147}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE5MjMxOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMDowNFrOGjL2hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMDowNFrOGjL2hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0NzUyNA==", "bodyText": "This could be misread to state that you can't delete a data stream. Reword for clarity.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <<data-streams, data streams>> APIs don't support the delete and update APIs directly,\n          \n          \n            \n            data streams don't support delete and update requests directly,", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439547524", "createdAt": "2020-06-12T17:20:04Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>\n+      \"step_time_millis\": 1538475653317,\n+      \"phase_execution\": {\n+        \"policy\": \"timeseries_policy\",\n+        \"phase_definition\": {                    <4>\n+          \"min_age\": \"0ms\",\n+          \"actions\": {\n+            \"rollover\": {\n+              \"max_size\": \"50gb\",\n+              \"max_age\": \"30d\"\n+            }\n+          }\n+        },\n+        \"version\": 1,\n+        \"modified_date_in_millis\": 1539609701576\n+      }\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// TESTRESPONSE[skip:no way to know if we will get this response immediately]\n+\n+<1> The policy used to manage the index\n+<2> The age of the index\n+<3> The step {ilm-init} is performing on the index\n+<4> The definition of the current phase (the `hot` phase)\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_data_stream/timeseries\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_index_template/timeseries_template\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+[discrete]\n+[[manage-time-series-data-without-data-streams]]\n+=== Manage time-series data without data streams\n+\n+Even though <<data-streams, data streams>> are a convenient way to scale\n+and manage time-series data, they are designed to be append-only. We recognise there\n+might be use-cases where data needs to be updated or deleted in place and the\n+<<data-streams, data streams>> APIs don't support the delete and update APIs directly,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 219}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE5NTIxOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMTowNFrOGjL4Vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMTowNFrOGjL4Vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0Nzk5MQ==", "bodyText": "Nit: Reword for clarity.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Another option to manage the time-series data in these cases is to use an index alias\n          \n          \n            \n            so you can periodically roll over to a new index.\n          \n          \n            \n            In these cases, you can use an index alias to manage indices containing the time-series data\n          \n          \n            \n            and periodically roll over to a new index.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439547991", "createdAt": "2020-06-12T17:21:04Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>\n+      \"step_time_millis\": 1538475653317,\n+      \"phase_execution\": {\n+        \"policy\": \"timeseries_policy\",\n+        \"phase_definition\": {                    <4>\n+          \"min_age\": \"0ms\",\n+          \"actions\": {\n+            \"rollover\": {\n+              \"max_size\": \"50gb\",\n+              \"max_age\": \"30d\"\n+            }\n+          }\n+        },\n+        \"version\": 1,\n+        \"modified_date_in_millis\": 1539609701576\n+      }\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// TESTRESPONSE[skip:no way to know if we will get this response immediately]\n+\n+<1> The policy used to manage the index\n+<2> The age of the index\n+<3> The step {ilm-init} is performing on the index\n+<4> The definition of the current phase (the `hot` phase)\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_data_stream/timeseries\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_index_template/timeseries_template\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+[discrete]\n+[[manage-time-series-data-without-data-streams]]\n+=== Manage time-series data without data streams\n+\n+Even though <<data-streams, data streams>> are a convenient way to scale\n+and manage time-series data, they are designed to be append-only. We recognise there\n+might be use-cases where data needs to be updated or deleted in place and the\n+<<data-streams, data streams>> APIs don't support the delete and update APIs directly,\n+so the index APIs would need to be used directly on the data stream's backing indices.\n+\n+Another option to manage the time-series data in these cases is to use an index alias\n+so you can periodically roll over to a new index.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 223}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODE5NTYwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMToxN1rOGjL4pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMToxN1rOGjL4pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0ODA2OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To automate rollover and management of time-series indices with {ilm-init} over an index\n          \n          \n            \n            To automate rollover and management of time-series indices with {ilm-init} using an index", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439548068", "createdAt": "2020-06-12T17:21:17Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>\n+      \"step_time_millis\": 1538475653317,\n+      \"phase_execution\": {\n+        \"policy\": \"timeseries_policy\",\n+        \"phase_definition\": {                    <4>\n+          \"min_age\": \"0ms\",\n+          \"actions\": {\n+            \"rollover\": {\n+              \"max_size\": \"50gb\",\n+              \"max_age\": \"30d\"\n+            }\n+          }\n+        },\n+        \"version\": 1,\n+        \"modified_date_in_millis\": 1539609701576\n+      }\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// TESTRESPONSE[skip:no way to know if we will get this response immediately]\n+\n+<1> The policy used to manage the index\n+<2> The age of the index\n+<3> The step {ilm-init} is performing on the index\n+<4> The definition of the current phase (the `hot` phase)\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_data_stream/timeseries\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+\n+//////////////////////////\n+\n+[source,console]\n+--------------------------------------------------\n+DELETE /_index_template/timeseries_template\n+--------------------------------------------------\n+// TEST[continued]\n+\n+//////////////////////////\n+\n+[discrete]\n+[[manage-time-series-data-without-data-streams]]\n+=== Manage time-series data without data streams\n+\n+Even though <<data-streams, data streams>> are a convenient way to scale\n+and manage time-series data, they are designed to be append-only. We recognise there\n+might be use-cases where data needs to be updated or deleted in place and the\n+<<data-streams, data streams>> APIs don't support the delete and update APIs directly,\n+so the index APIs would need to be used directly on the data stream's backing indices.\n+\n+Another option to manage the time-series data in these cases is to use an index alias\n+so you can periodically roll over to a new index.\n+\n+To automate rollover and management of time-series indices with {ilm-init} over an index", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 225}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODIwMTAxOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/index-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMzoxMFrOGjL8HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyMzoxMFrOGjL8HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU0ODk1Ng==", "bodyText": "Nit: Breaks this into two sentences for readability.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <<indices-create-data-stream, Data streams>> are the recommended abstraction for managing time-series\n          \n          \n            \n            data as they automatically track the write index whilst also keeping the amount of configuration to a\n          \n          \n            \n            minimum.\n          \n          \n            \n            We recommend using <<indices-create-data-stream, data streams>> to manage time-series\n          \n          \n            \n            data. Data streams automatically track the write index while keeping configuration to a minimum.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439548956", "createdAt": "2020-06-12T17:23:10Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/index-rollover.asciidoc", "diffHunk": "@@ -12,7 +12,20 @@ Using rolling indices enables you to:\n * Shift older, less frequently accessed data to less expensive _cold_ nodes,\n * Delete data according to your retention policies by removing entire indices.\n \n-Rollover relies on three things:\n+<<indices-create-data-stream, Data streams>> are the recommended abstraction for managing time-series\n+data as they automatically track the write index whilst also keeping the amount of configuration to a\n+minimum.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODIxMTY0OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/index-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyNjoxNFrOGjMCXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyNjoxNFrOGjMCXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU1MDU1OA==", "bodyText": "I think these requirements are incomplete as a mapping is now required for the timestamp field.\nEither way, I think a bulleted list makes it more readable.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Rolling over using <<indices-create-data-stream, data streams>> only requires creating a\n          \n          \n            \n            <<indices-templates,composable index template>> containing a name or a wildcard pattern for the data stream\n          \n          \n            \n            in the `index_patterns` and a `data_stream` definiton that contains the `timestamp_field` property which\n          \n          \n            \n            will be present in the time-series documents that will be ingested.\n          \n          \n            \n            Each data stream requires a <<indices-templates,composable index template>> that contains:\n          \n          \n            \n            \n          \n          \n            \n            * A name or wildcard (`*`) pattern for the data stream.\n          \n          \n            \n            \n          \n          \n            \n            * The data stream's timestamp field. This field must be mapped as a\n          \n          \n            \n              <<date,`date`>> or <<date_nanos,`date_nanos`>> field datatype and must be\n          \n          \n            \n              included in every document indexed to the data stream.\n          \n          \n            \n              \n          \n          \n            \n              * The mappings and settings applied to each backing index when it's created.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439550558", "createdAt": "2020-06-12T17:26:14Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/index-rollover.asciidoc", "diffHunk": "@@ -12,7 +12,20 @@ Using rolling indices enables you to:\n * Shift older, less frequently accessed data to less expensive _cold_ nodes,\n * Delete data according to your retention policies by removing entire indices.\n \n-Rollover relies on three things:\n+<<indices-create-data-stream, Data streams>> are the recommended abstraction for managing time-series\n+data as they automatically track the write index whilst also keeping the amount of configuration to a\n+minimum.\n+\n+Rolling over using <<indices-create-data-stream, data streams>> only requires creating a\n+<<indices-templates,composable index template>> containing a name or a wildcard pattern for the data stream\n+in the `index_patterns` and a `data_stream` definiton that contains the `timestamp_field` property which\n+will be present in the time-series documents that will be ingested.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODIxODM2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/index-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyODoxNlrOGjMGeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzoyODoxNlrOGjMGeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU1MTYxMA==", "bodyText": "Nit: Breaks this into two sentences.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For other use cases, where data needs to be updated in place, the management of time-series data can be\n          \n          \n            \n            done using <<indices-aliases, indices aliases>>, however there are a few more configuration steps and\n          \n          \n            \n            concepts:\n          \n          \n            \n            If your use case requires data to be updated in place, you can instead manage your time-series data using <<indices-aliases, indices aliases>>. However, there are a few more configuration steps and\n          \n          \n            \n            concepts:", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439551610", "createdAt": "2020-06-12T17:28:16Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/index-rollover.asciidoc", "diffHunk": "@@ -12,7 +12,20 @@ Using rolling indices enables you to:\n * Shift older, less frequently accessed data to less expensive _cold_ nodes,\n * Delete data according to your retention policies by removing entire indices.\n \n-Rollover relies on three things:\n+<<indices-create-data-stream, Data streams>> are the recommended abstraction for managing time-series\n+data as they automatically track the write index whilst also keeping the amount of configuration to a\n+minimum.\n+\n+Rolling over using <<indices-create-data-stream, data streams>> only requires creating a\n+<<indices-templates,composable index template>> containing a name or a wildcard pattern for the data stream\n+in the `index_patterns` and a `data_stream` definiton that contains the `timestamp_field` property which\n+will be present in the time-series documents that will be ingested.\n+\n+<<indices-create-data-stream, Data streams>> are designed for append-only data, where the data stream name\n+can be used as the operations (read, write, rollover, shrink etc.) target.\n+For other use cases, where data needs to be updated in place, the management of time-series data can be\n+done using <<indices-aliases, indices aliases>>, however there are a few more configuration steps and\n+concepts:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODI0NTUwOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzozNzozMVrOGjMX5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzozNzozMVrOGjMX5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU1NjA3MQ==", "bodyText": "Typo\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Creates the second generation backing index, name `.ds-timeseries-000002`.\n          \n          \n            \n            * Creates the second generation backing index, named `.ds-timeseries-000002`.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439556071", "createdAt": "2020-06-12T17:37:31Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODI1MDAzOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzozOToxMFrOGjMa0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzozOToxMFrOGjMa0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU1NjgxNw==", "bodyText": "Nit: Reword for clarity\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n          \n          \n            \n            the template configuration will be applied to the new index.\n          \n          \n            \n            Because it is a backing index of the `timeseries` data stream, the configuration from the `timeseries_template` composable template is applied to the new index.", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439556817", "createdAt": "2020-06-12T17:39:10Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 115}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODI1OTUzOnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/index-rollover.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzo0MjozNFrOGjMg1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNzo0MjozNFrOGjMg1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU1ODM1Nw==", "bodyText": "Remove redundant link.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <<indices-create-data-stream, Data streams>> are designed for append-only data, where the data stream name\n          \n          \n            \n            Data streams are designed for append-only data, where the data stream name", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439558357", "createdAt": "2020-06-12T17:42:34Z", "author": {"login": "jrodewig"}, "path": "docs/reference/ilm/index-rollover.asciidoc", "diffHunk": "@@ -12,7 +12,20 @@ Using rolling indices enables you to:\n * Shift older, less frequently accessed data to less expensive _cold_ nodes,\n * Delete data according to your retention policies by removing entire indices.\n \n-Rollover relies on three things:\n+<<indices-create-data-stream, Data streams>> are the recommended abstraction for managing time-series\n+data as they automatically track the write index whilst also keeping the amount of configuration to a\n+minimum.\n+\n+Rolling over using <<indices-create-data-stream, data streams>> only requires creating a\n+<<indices-templates,composable index template>> containing a name or a wildcard pattern for the data stream\n+in the `index_patterns` and a `data_stream` definiton that contains the `timestamp_field` property which\n+will be present in the time-series documents that will be ingested.\n+\n+<<indices-create-data-stream, Data streams>> are designed for append-only data, where the data stream name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODUwODk3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxOToxNDozOFrOGjPBsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxOToxNDozOFrOGjPBsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU5OTUzNg==", "bodyText": "Super minor, but more likely to be:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"step\": \"attempt-rollover\",                <3>\n          \n          \n            \n                  \"step\": \"check-rollover-ready\",                <3>", "url": "https://github.com/elastic/elasticsearch/pull/58035#discussion_r439599536", "createdAt": "2020-06-12T19:14:38Z", "author": {"login": "dakrone"}, "path": "docs/reference/ilm/ilm-tutorial.asciidoc", "diffHunk": "@@ -89,13 +91,207 @@ For the complete list of actions that {ilm} can perform, see <<ilm-actions>>.\n \n [discrete]\n [[ilm-gs-apply-policy]]\n-=== Create an index template to apply the lifecycle policy\n+=== Create a composable template to create the data stream and apply the lifecycle policy\n+\n+To create a data stream we'll create a composable template with a `data_stream` definition\n+that will specify the lifecycle policy.\n+\n+For example, you might create a `timeseries_template` that is will bootstrap a data stream\n+named `timeseries`.\n+\n+To enable the ILM to manage the data stream, the template configures one {ilm-init} setting:\n+\n+* `index.lifecycle.name` specifies the name of the lifecycle policy to apply to the data stream.\n+\n+You can use the {kib} Create template wizard to add the template.\n+This wizard invokes the put _index_template API to create the <<indices-templates,composable index template>>\n+with the options you specify.\n+\n+The underlying request looks like this:\n+\n+[source,console]\n+-----------------------\n+PUT _index_template/timeseries_template\n+{\n+  \"index_patterns\": [\"timeseries\"],                 <1>\n+  \"data_stream\": {\n+    \"timestamp_field\": \"@timestamp\"                  <2>\n+  },\n+  \"template\": {\n+    \"settings\": {\n+      \"number_of_shards\": 1,\n+      \"number_of_replicas\": 1,\n+      \"index.lifecycle.name\": \"timeseries_policy\"     <3>\n+    }\n+  }\n+}\n+-----------------------\n+// TEST[continued]\n+\n+<1> Apply the template when a document is indexed into the `timeseries` target.\n+<2> Identifies the timestamp field for the data source, a field that must be present\n+in all documents indexed into the `timeseries` data stream.\n+<3> The name of the ILM policy used to manage the data stream.\n+\n+You can also invoke this API directly to add templates.\n+\n+[discrete]\n+[[ilm-gs-bootstrap]]\n+=== Bootstrap the data stream\n+\n+To get things started, you simply index a document into the name or wildcard pattern defined\n+in the `index_patterns` of the <<indices-templates,composable index template>> that will\n+create the data stream.\n+{es} will automatically create the corresponding data stream and will index the document into\n+the first backing index.\n+\n+For example, the following request creates the `timeseries` data stream and the first generation\n+backing index called `.ds-timeseries-000001`.\n+\n+[source,console]\n+-----------------------\n+POST timeseries/_doc\n+{\n+  \"message\": \"logged the request\",\n+  \"@timestamp\": \"1591890611\"\n+}\n+\n+-----------------------\n+// TEST[continued]\n+\n+When the rollover conditions are met, the `rollover` action:\n+\n+* Creates the second generation backing index, name `.ds-timeseries-000002`.\n+As it is the backing index of the `timeseries` data stream which was created using the `timeseries_template`\n+the template configuration will be applied to the new index.\n+* As it is the latest generation index of the `timeseries` data stream, the newly created\n+backing index `.ds-timeseries-000002` becomes the data stream's write index.\n+\n+This process repeats each time rollover conditions are met.\n+You can search across all of the data stream's backing indices, managed by the `timeseries_policy`,\n+with the `timeseries` data stream name.\n+Write operations are routed to the current write index, whilst read operations will be handled by all\n+backing indices.\n+\n+[discrete]\n+[[ilm-gs-check-progress]]\n+=== Check lifecycle progress\n+\n+To get status information for managed indices, you use the {ilm-init} explain API.\n+This lets you find out things like:\n+\n+* What phase an index is in and when it entered that phase.\n+* The current action and what step is being performed.\n+* If any errors have occurred or progress is blocked.\n+\n+For example, the following request gets information about the `timeseries` indices:\n+\n+[source,console]\n+--------------------------------------------------\n+GET .ds-timeseries-*/_ilm/explain\n+--------------------------------------------------\n+// TEST[continued]\n+\n+The response below shows that the data stream's first generation backing index is waiting in the `hot`\n+phase's `rollover` action.\n+It remains in this state and {ilm-init} continues to call `attempt-rollover` until the rollover conditions\n+are met.\n+\n+// [[36818c6d9f434d387819c30bd9addb14]]\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"indices\": {\n+    \".ds-timeseries-000001\": {\n+      \"index\": \".ds-timeseries-000001\",\n+      \"managed\": true,\n+      \"policy\": \"timeseries_policy\",             <1>\n+      \"lifecycle_date_millis\": 1538475653281,\n+      \"age\": \"30s\",                              <2>\n+      \"phase\": \"hot\",\n+      \"phase_time_millis\": 1538475653317,\n+      \"action\": \"rollover\",\n+      \"action_time_millis\": 1538475653317,\n+      \"step\": \"attempt-rollover\",                <3>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28b84909eacd98f8be2738dc0058068143dbc47b"}, "originalPosition": 164}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1589, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}