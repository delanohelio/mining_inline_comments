{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MjYyNDg3", "number": 54728, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzo0MTozM1rODufQLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNTo1NzozNlrODu-leA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDczMTM0OnYy", "diffSide": "RIGHT", "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzo0MTozM1rOGAgZAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzo1OTowNlrOGAhWMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE4Mzg3Mg==", "bodyText": "This will likely have to catch the exception when datastreams aren't available (think BWC tests with 7.7 or earlier)", "url": "https://github.com/elastic/elasticsearch/pull/54728#discussion_r403183872", "createdAt": "2020-04-03T17:41:33Z", "author": {"login": "dakrone"}, "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "diffHunk": "@@ -600,6 +614,10 @@ protected static void wipeAllIndices() throws IOException {\n         }\n     }\n \n+    protected static void wipeDataStreams() throws IOException {\n+        adminClient().performRequest(new Request(\"DELETE\", \"_data_stream/*\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4949a01da52323b1f6e3eda252fdebf840f599c6"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE5OTUzOA==", "bodyText": "Thanks, I'll add that", "url": "https://github.com/elastic/elasticsearch/pull/54728#discussion_r403199538", "createdAt": "2020-04-03T17:59:06Z", "author": {"login": "danhermann"}, "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "diffHunk": "@@ -600,6 +614,10 @@ protected static void wipeAllIndices() throws IOException {\n         }\n     }\n \n+    protected static void wipeDataStreams() throws IOException {\n+        adminClient().performRequest(new Request(\"DELETE\", \"_data_stream/*\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE4Mzg3Mg=="}, "originalCommit": {"oid": "4949a01da52323b1f6e3eda252fdebf840f599c6"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNTg2NDg4OnYy", "diffSide": "RIGHT", "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNTo1NzozNlrOGBIwYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNTo1NzozNlrOGBIwYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg0NTIxNw==", "bodyText": "Maybe also check that the response code is 405? This is what we return in the case a rest action hasn't been implemented.", "url": "https://github.com/elastic/elasticsearch/pull/54728#discussion_r403845217", "createdAt": "2020-04-06T05:57:36Z", "author": {"login": "martijnvg"}, "path": "test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java", "diffHunk": "@@ -600,6 +614,14 @@ protected static void wipeAllIndices() throws IOException {\n         }\n     }\n \n+    protected static void wipeDataStreams() throws IOException {\n+        try {\n+            adminClient().performRequest(new Request(\"DELETE\", \"_data_stream/*\"));\n+        } catch (ResponseException e) {\n+            // We hit a version of ES that doesn't have data streams enabled so it's safe to ignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46632b21fc1ad8865b94874e99fbde4670d726c9"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1318, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}