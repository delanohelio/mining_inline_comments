{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMzQyMDI0", "number": 63609, "title": "Add the missing apikey.* fields to the logfile audit layout for docker builds", "bodyText": "Atm there are two log4j2.properties files that we have to modify whenever the pattern layout changes when adding new fields to the security audit trail. There are tests (LoggingAuditTrailTests) that check the pattern form the log4j2.properties file from the x-pack:plugin:core module, but no mechanism to ensure that the patterns stay equal across the two. The last bit is to be handled separately in  #63516 .", "createdAt": "2020-10-13T13:51:22Z", "url": "https://github.com/elastic/elasticsearch/pull/63609", "merged": true, "mergeCommit": {"oid": "77661af2c5905b16884d1b0d5c7b7c9e86b7bee7"}, "closed": true, "closedAt": "2020-10-14T10:46:02Z", "author": {"login": "albertzaharovits"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSIxJwAH2gAyNTAyMzQyMDI0OjBiMTZhN2Q5YTk3YmUzOWQ2MmEzMWU3MjdiOWVhZGMxZGU0MGM4N2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSadXqgFqTUwODIwMDEzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0b16a7d9a97be39d62a31e727b9eadc1de40c87c", "author": {"user": {"login": "albertzaharovits", "name": "Albert Zaharovits"}}, "url": "https://github.com/elastic/elasticsearch/commit/0b16a7d9a97be39d62a31e727b9eadc1de40c87c", "committedDate": "2020-10-13T13:40:48Z", "message": "log4j2 fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3NDU5Mzgw", "url": "https://github.com/elastic/elasticsearch/pull/63609#pullrequestreview-507459380", "createdAt": "2020-10-13T13:52:27Z", "commit": {"oid": "0b16a7d9a97be39d62a31e727b9eadc1de40c87c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo1MjoyN1rOHgn4xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMzo1MjoyN1rOHgn4xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2OTk4OA==", "bodyText": "This is only a reordering to keep the field names that share a prefix together.", "url": "https://github.com/elastic/elasticsearch/pull/63609#discussion_r503969988", "createdAt": "2020-10-13T13:52:27Z", "author": {"login": "albertzaharovits"}, "path": "x-pack/plugin/core/src/main/config/log4j2.properties", "diffHunk": "@@ -11,17 +11,17 @@ appender.audit_rolling.layout.pattern = {\\\n                 %varsNotEmpty{, \"host.ip\":\"%enc{%map{host.ip}}{JSON}\"}\\\n                 %varsNotEmpty{, \"event.type\":\"%enc{%map{event.type}}{JSON}\"}\\\n                 %varsNotEmpty{, \"event.action\":\"%enc{%map{event.action}}{JSON}\"}\\\n+                %varsNotEmpty{, \"authentication.type\":\"%enc{%map{authentication.type}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.name\":\"%enc{%map{user.name}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.run_by.name\":\"%enc{%map{user.run_by.name}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.run_as.name\":\"%enc{%map{user.run_as.name}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.realm\":\"%enc{%map{user.realm}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.run_by.realm\":\"%enc{%map{user.run_by.realm}}{JSON}\"}\\\n                 %varsNotEmpty{, \"user.run_as.realm\":\"%enc{%map{user.run_as.realm}}{JSON}\"}\\\n+                %varsNotEmpty{, \"user.roles\":%map{user.roles}}\\\n                 %varsNotEmpty{, \"apikey.id\":\"%enc{%map{apikey.id}}{JSON}\"}\\\n                 %varsNotEmpty{, \"apikey.name\":\"%enc{%map{apikey.name}}{JSON}\"}\\\n-                %varsNotEmpty{, \"user.roles\":%map{user.roles}}\\\n                 %varsNotEmpty{, \"origin.type\":\"%enc{%map{origin.type}}{JSON}\"}\\\n-                %varsNotEmpty{, \"authentication.type\":\"%enc{%map{authentication.type}}{JSON}\"}\\\n                 %varsNotEmpty{, \"origin.address\":\"%enc{%map{origin.address}}{JSON}\"}\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b16a7d9a97be39d62a31e727b9eadc1de40c87c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MjAwMTMw", "url": "https://github.com/elastic/elasticsearch/pull/63609#pullrequestreview-508200130", "createdAt": "2020-10-14T10:17:29Z", "commit": {"oid": "0b16a7d9a97be39d62a31e727b9eadc1de40c87c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4094, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}