{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MDEyNTYy", "number": 57692, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzo1ODo0OFrOEC2w5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzo1ODo0OFrOEC2w5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDI5ODYyOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataIndexStateService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzo1ODo0OFrOGfkRSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwNzo1ODo0OFrOGfkRSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc1MzI5MQ==", "bodyText": "I think we should change this to:\nia.getParentDataStream().getWriteIndex().getIndex().equals(index))\n\nThe index uuid should be the same.", "url": "https://github.com/elastic/elasticsearch/pull/57692#discussion_r435753291", "createdAt": "2020-06-05T07:58:48Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataIndexStateService.java", "diffHunk": "@@ -137,6 +138,19 @@ public void closeIndices(final CloseIndexClusterStateUpdateRequest request, fina\n         if (concreteIndices == null || concreteIndices.length == 0) {\n             throw new IllegalArgumentException(\"Index name is required\");\n         }\n+        List<String> writeIndices = new ArrayList<>();\n+        SortedMap<String, IndexAbstraction> lookup = clusterService.state().metadata().getIndicesLookup();\n+        for (Index index : concreteIndices) {\n+            IndexAbstraction ia = lookup.get(index.getName());\n+            if (ia != null && ia.getParentDataStream() != null &&\n+                ia.getParentDataStream().getWriteIndex().getIndex().getName().equals(index.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a17fea1bd515545ad857cfef48ce4877d0bf4fa"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3693, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}