{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NTcxOTEz", "number": 64875, "title": "[DOCS] Clarify diff between shards per node settings", "bodyText": "Clarifies differences between the cluster.routing.allocation.total_shards_per_node and cluster.max_shards_per_node cluster settings.\nCloses #51839\nPreview\n\ncluster.routing.allocation.total_shards_per_node: https://elasticsearch_64875.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/allocation-total-shards.html#cluster-total-shards-per-node\ncluster.max_shards_per_node: https://elasticsearch_64875.docs-preview.app.elstc.co/guide/en/elasticsearch/reference/master/modules-cluster.html#cluster-max-shards-per-node", "createdAt": "2020-11-10T15:30:41Z", "url": "https://github.com/elastic/elasticsearch/pull/64875", "merged": true, "mergeCommit": {"oid": "f95a52f28094f0f65030c7cc87b69a16a8594cae"}, "closed": true, "closedAt": "2020-11-16T13:33:05Z", "author": {"login": "jrodewig"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbLFd1gH2gAyNTE4NTcxOTEzOjQ5OWIwYTVlZDA0MmUxNjRkZGVmY2RjNjYzOTkzYzQ0MDY1YzA3YWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdb4fbSAFqTUyOTQ2NzQ0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "499b0a5ed042e164ddefcdc663993c44065c07ac", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/499b0a5ed042e164ddefcdc663993c44065c07ac", "committedDate": "2020-11-10T15:28:07Z", "message": "[DOCS] Clarify diff between shard per node settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "406ee7123f5f9359adf512cb964fe7b4202b2ce9", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/406ee7123f5f9359adf512cb964fe7b4202b2ce9", "committedDate": "2020-11-10T16:39:12Z", "message": "Add anchor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c73a91dd0e1e0254ed1775888e074b095f30fcb", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/7c73a91dd0e1e0254ed1775888e074b095f30fcb", "committedDate": "2020-11-10T17:23:48Z", "message": "Reword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b6f2ac42bd0f25d53e5211310590db56194b321", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/0b6f2ac42bd0f25d53e5211310590db56194b321", "committedDate": "2020-11-10T17:31:14Z", "message": "Remove dupe sentence"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11f906565c9873912421841b3eff6126e420ac64", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/11f906565c9873912421841b3eff6126e420ac64", "committedDate": "2020-11-10T17:43:51Z", "message": "Re-add sentence"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad3e6e8b84523608196dcf9a261b37960d40c1f9", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/ad3e6e8b84523608196dcf9a261b37960d40c1f9", "committedDate": "2020-11-10T20:31:46Z", "message": "Note that closed indices don't count toward"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75626f38f9ebc469811fe8d2de5a1385930ba451", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/75626f38f9ebc469811fe8d2de5a1385930ba451", "committedDate": "2020-11-10T20:41:07Z", "message": "Reword"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTM0NzEx", "url": "https://github.com/elastic/elasticsearch/pull/64875#pullrequestreview-528934711", "createdAt": "2020-11-12T10:11:12Z", "commit": {"oid": "75626f38f9ebc469811fe8d2de5a1385930ba451"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5Mzk2ODM5", "url": "https://github.com/elastic/elasticsearch/pull/64875#pullrequestreview-529396839", "createdAt": "2020-11-12T18:59:15Z", "commit": {"oid": "75626f38f9ebc469811fe8d2de5a1385930ba451"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODo1OToxNlrOHyJRrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxODo1OToxNlrOHyJRrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM0MjgyOQ==", "bodyText": "This isn't quite correct, the default is 1000.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Shards for closed indices do not count toward this limit. Defaults to `-1`\n          \n          \n            \n            (unlimited). A cluster with no data nodes is also unlimited.\n          \n          \n            \n            Shards for closed indices do not count toward this limit. Defaults to `1000`.\n          \n          \n            \n            A cluster with no data nodes is unlimited.", "url": "https://github.com/elastic/elasticsearch/pull/64875#discussion_r522342829", "createdAt": "2020-11-12T18:59:16Z", "author": {"login": "gwbrown"}, "path": "docs/reference/modules/cluster/misc.asciidoc", "diffHunk": "@@ -53,16 +53,29 @@ Closed indices do not contribute to the shard count.\n \n You can dynamically adjust the cluster shard limit with the following setting:\n \n+[[cluster-max-shards-per-node]]\n `cluster.max_shards_per_node`::\n-     (<<dynamic-cluster-setting,Dynamic>>)\n-     Controls the number of shards allowed in the cluster per data node.\n++\n+--\n+(<<dynamic-cluster-setting,Dynamic>>)\n+Limits the total number of primary and replica shards for the cluster. {es}\n+calculates the limit as follows:\n \n-With the default setting, a 3-node cluster allows 3,000 shards total, across all open indexes. \n-If you reduce the limit to 500, the cluster would allow 1,500 shards total.\n+`cluster.max_shards_per_node * number of data nodes`\n \n-NOTE: If there are no data nodes in the cluster, the limit will not be enforced.\n-This allows the creation of indices during cluster creation if dedicated master\n-nodes are set up before data nodes.\n+Shards for closed indices do not count toward this limit. Defaults to `-1`\n+(unlimited). A cluster with no data nodes is also unlimited.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75626f38f9ebc469811fe8d2de5a1385930ba451"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a631d12d612e75c18457315988290aea5e49591a", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/a631d12d612e75c18457315988290aea5e49591a", "committedDate": "2020-11-12T19:01:52Z", "message": "Update docs/reference/modules/cluster/misc.asciidoc\n\nCo-authored-by: Gordon Brown <arcsech@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NDY3NDQw", "url": "https://github.com/elastic/elasticsearch/pull/64875#pullrequestreview-529467440", "createdAt": "2020-11-12T20:22:12Z", "commit": {"oid": "a631d12d612e75c18457315988290aea5e49591a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1154, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}