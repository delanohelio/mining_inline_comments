{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NTkwMDY0", "number": 57300, "title": "[ML] Anomaly detection jobs should allow missing values for geo fields", "bodyText": "Allows geo fields (geo_point, geo_shape) to have missing values.\nFixes a bug where such missing values would result in an error.\nCloses #57299", "createdAt": "2020-05-28T16:11:14Z", "url": "https://github.com/elastic/elasticsearch/pull/57300", "merged": true, "mergeCommit": {"oid": "d26f63d0625bc35c417db7c21f3c51e44d266eb9"}, "closed": true, "closedAt": "2020-05-29T08:28:41Z", "author": {"login": "dimitris-athanasiou"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclwPXBAFqTQyMDI3NTE0MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclxiE9gBqjMzODM5MzUwOTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjc1MTQw", "url": "https://github.com/elastic/elasticsearch/pull/57300#pullrequestreview-420275140", "createdAt": "2020-05-28T16:13:30Z", "commit": {"oid": "31296ca0b15c7af666ae2302bcde64150253c97c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjg0NTY4", "url": "https://github.com/elastic/elasticsearch/pull/57300#pullrequestreview-420284568", "createdAt": "2020-05-28T16:24:24Z", "commit": {"oid": "31296ca0b15c7af666ae2302bcde64150253c97c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjoyNDoyNFrOGb9E5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjoyNDoyNFrOGb9E5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2NTQxNQ==", "bodyText": "Theoretically it would save a memory allocation and garbage collection to just return value;.  Maybe Hotspot will optimise this in practice.\nSame in the other file.", "url": "https://github.com/elastic/elasticsearch/pull/57300#discussion_r431965415", "createdAt": "2020-05-28T16:24:24Z", "author": {"login": "droberts195"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/extractor/GeoPointField.java", "diffHunk": "@@ -24,9 +24,13 @@ public GeoPointField(String name) {\n     @Override\n     public Object[] value(SearchHit hit) {\n         Object[] value = super.value(hit);\n-        if (value.length != 1) {\n+        if (value.length == 0) {\n+            return new Object[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31296ca0b15c7af666ae2302bcde64150253c97c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39225052b5d2713147502372b8a6648a16d40d8c", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/39225052b5d2713147502372b8a6648a16d40d8c", "committedDate": "2020-05-28T17:43:06Z", "message": "[ML] Anomaly detection jobs should allow missing values for geo fields\n\nAllows geo fields (`geo_point`, `geo_shape`) to have missing values.\nFixes a bug where such missing values would result in an error.\n\nCloses #57299"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50ff241f963323c1ef2e357defc59572484701b8", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/50ff241f963323c1ef2e357defc59572484701b8", "committedDate": "2020-05-28T17:43:32Z", "message": "Return value at hand instead of creating new empty array"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31296ca0b15c7af666ae2302bcde64150253c97c", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/31296ca0b15c7af666ae2302bcde64150253c97c", "committedDate": "2020-05-28T16:01:11Z", "message": "[ML] Anomaly detection jobs should allow missing values for geo fields\n\nAllows geo fields (`geo_point`, `geo_shape`) to have missing values.\nFixes a bug where such missing values would result in an error.\n\nCloses #57299"}, "afterCommit": {"oid": "50ff241f963323c1ef2e357defc59572484701b8", "author": {"user": {"login": "dimitris-athanasiou", "name": "Dimitris Athanasiou"}}, "url": "https://github.com/elastic/elasticsearch/commit/50ff241f963323c1ef2e357defc59572484701b8", "committedDate": "2020-05-28T17:43:32Z", "message": "Return value at hand instead of creating new empty array"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4128, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}