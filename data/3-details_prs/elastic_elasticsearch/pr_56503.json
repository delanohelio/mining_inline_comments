{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MDI5Mzg3", "number": 56503, "title": "Push arch-specific logic from Gradle into Docker", "bodyText": "Docker informed us that for official multi-arch Docker builds, there\nneeds to be a single Dockerfile and build context that can be used for\neach supported architecture. Therefore, rework the build to move the\nrelevant architecture logic into the Dockerfile, and merge the aarch64\n/ x64 docker context builds.", "createdAt": "2020-05-11T10:58:39Z", "url": "https://github.com/elastic/elasticsearch/pull/56503", "merged": true, "mergeCommit": {"oid": "c9e811c4fe9df43ecfa6b670d11777655b2239cb"}, "closed": true, "closedAt": "2020-05-12T10:10:06Z", "author": {"login": "pugnascotia"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgNd5mgH2gAyNDE2MDI5Mzg3Ojc1OGRmMWQ0ZWVmZjExM2EzZTgzNTU4YWQ2ZGViNWUzY2FmNDJlYTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgbyOIgFqTQwOTY3NTAzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "758df1d4eeff113a3e83558ad6deb5e3caf42ea6", "author": {"user": {"login": "pugnascotia", "name": "Rory Hunter"}}, "url": "https://github.com/elastic/elasticsearch/commit/758df1d4eeff113a3e83558ad6deb5e3caf42ea6", "committedDate": "2020-05-11T10:53:05Z", "message": "Push arch-specific logic from Gradle into Docker\n\nDocker informed us that for official multi-arch Docker builds, there\nneeds to be a single Dockerfile and build context that can be used for\neach supported architecture. Therefore, rework the build to move the\nrelevant architecture logic into the Dockerfile, and merge the aarch64\n/ x64 docker context builds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NDczMzc0", "url": "https://github.com/elastic/elasticsearch/pull/56503#pullrequestreview-409473374", "createdAt": "2020-05-11T19:40:32Z", "commit": {"oid": "758df1d4eeff113a3e83558ad6deb5e3caf42ea6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxOTo0MDozMlrOGTqnuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxOTo0MDozMlrOGTqnuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzI3NDQyNw==", "bodyText": "Because this is in a code block, this is not included in the final published file, right?", "url": "https://github.com/elastic/elasticsearch/pull/56503#discussion_r423274427", "createdAt": "2020-05-11T19:40:32Z", "author": {"login": "mark-vieira"}, "path": "distribution/docker/src/docker/Dockerfile", "diffHunk": "@@ -3,45 +3,53 @@\n #\n # Beginning of multi stage Dockerfile\n ################################################################################\n+<% /*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "758df1d4eeff113a3e83558ad6deb5e3caf42ea6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87df12069067b6dcd59fcba3262ddaaff8ff20ad", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/87df12069067b6dcd59fcba3262ddaaff8ff20ad", "committedDate": "2020-05-11T20:14:45Z", "message": "Merge branch 'master' into consolidate-docker-contexts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5Njc1MDM1", "url": "https://github.com/elastic/elasticsearch/pull/56503#pullrequestreview-409675035", "createdAt": "2020-05-12T03:33:50Z", "commit": {"oid": "87df12069067b6dcd59fcba3262ddaaff8ff20ad"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMzozMzo1MFrOGT01Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMzozMzo1MFrOGT01Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ0MTY4Mw==", "bodyText": "Nice touch. \ud83d\ude42", "url": "https://github.com/elastic/elasticsearch/pull/56503#discussion_r423441683", "createdAt": "2020-05-12T03:33:50Z", "author": {"login": "jasontedor"}, "path": "distribution/docker/src/docker/Dockerfile", "diffHunk": "@@ -81,32 +89,32 @@ ENV PATH /usr/share/elasticsearch/bin:\\$PATH\n \n COPY bin/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n \n-RUN chmod g=u /etc/passwd && \\\n+RUN chmod g=u /etc/passwd && \\\\\n     chmod 0775 /usr/local/bin/docker-entrypoint.sh\n \n # Ensure that there are no files with setuid or setgid, in order to mitigate \"stackclash\" attacks.\n RUN find / -xdev -perm -4000 -exec chmod ug-s {} +\n \n EXPOSE 9200 9300\n \n-LABEL org.label-schema.build-date=\"${build_date}\" \\\n-  org.label-schema.license=\"${license}\" \\\n-  org.label-schema.name=\"Elasticsearch\" \\\n-  org.label-schema.schema-version=\"1.0\" \\\n-  org.label-schema.url=\"https://www.elastic.co/products/elasticsearch\" \\\n-  org.label-schema.usage=\"https://www.elastic.co/guide/en/elasticsearch/reference/index.html\" \\\n-  org.label-schema.vcs-ref=\"${git_revision}\" \\\n-  org.label-schema.vcs-url=\"https://github.com/elastic/elasticsearch\" \\\n-  org.label-schema.vendor=\"Elastic\" \\\n-  org.label-schema.version=\"${version}\" \\\n-  org.opencontainers.image.created=\"${build_date}\" \\\n-  org.opencontainers.image.documentation=\"https://www.elastic.co/guide/en/elasticsearch/reference/index.html\" \\\n-  org.opencontainers.image.licenses=\"${license}\" \\\n-  org.opencontainers.image.revision=\"${git_revision}\" \\\n-  org.opencontainers.image.source=\"https://github.com/elastic/elasticsearch\" \\\n-  org.opencontainers.image.title=\"Elasticsearch\" \\\n-  org.opencontainers.image.url=\"https://www.elastic.co/products/elasticsearch\" \\\n-  org.opencontainers.image.vendor=\"Elastic\" \\\n+LABEL org.label-schema.build-date=\"${build_date}\" \\\\\n+  org.label-schema.license=\"${license}\" \\\\\n+  org.label-schema.name=\"Elasticsearch\" \\\\\n+  org.label-schema.schema-version=\"1.0\" \\\\\n+  org.label-schema.url=\"https://www.elastic.co/products/elasticsearch\" \\\\\n+  org.label-schema.usage=\"https://www.elastic.co/guide/en/elasticsearch/reference/index.html\" \\\\\n+  org.label-schema.vcs-ref=\"${git_revision}\" \\\\\n+  org.label-schema.vcs-url=\"https://github.com/elastic/elasticsearch\" \\\\\n+  org.label-schema.vendor=\"Elastic\" \\\\\n+  org.label-schema.version=\"${version}\" \\\\\n+  org.opencontainers.image.created=\"${build_date}\" \\\\\n+  org.opencontainers.image.documentation=\"https://www.elastic.co/guide/en/elasticsearch/reference/index.html\" \\\\\n+  org.opencontainers.image.licenses=\"${license}\" \\\\\n+  org.opencontainers.image.revision=\"${git_revision}\" \\\\\n+  org.opencontainers.image.source=\"https://github.com/elastic/elasticsearch\" \\\\\n+  org.opencontainers.image.title=\"Elasticsearch\" \\\\\n+  org.opencontainers.image.url=\"https://www.elastic.co/products/elasticsearch\" \\\\\n+  org.opencontainers.image.vendor=\"Elastic\" \\\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87df12069067b6dcd59fcba3262ddaaff8ff20ad"}, "originalPosition": 147}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 132, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}