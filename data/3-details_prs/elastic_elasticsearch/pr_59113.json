{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1MTM4MTY2", "number": 59113, "title": "Support prefix search for API key names", "bodyText": "This PR adds minimum support for prefix search of API Key name. It only touches API key name and leave all other query parameters, e.g. realm name, username unchanged. It's easy to add them, but they may not be of much value since for the scenario of large number of API keys, we do not expect as many realm names or usernames compared to API key names.\nI also think we haven't discussed about the possibilities thoroughly enough. So I am adding minimum support since it is easy to give out but hard to take back.\nResolves: #57638", "createdAt": "2020-07-07T04:16:31Z", "url": "https://github.com/elastic/elasticsearch/pull/59113", "merged": true, "mergeCommit": {"oid": "62d029bc2f5051749b139da8c8a7e2f9ece6d8ff"}, "closed": true, "closedAt": "2020-07-14T10:38:36Z", "author": {"login": "ywangd"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcycZ2EAH2gAyNDQ1MTM4MTY2OjhiY2Q1MWY3YzI2Y2ExMzY2YWNkZjFjZjYxNjJkNjc3NGFlM2IzZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc0zAZQAFqTQ0Nzk2MTU3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8bcd51f7c26ca1366acdf1cf6162d6774ae3b3e7", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/8bcd51f7c26ca1366acdf1cf6162d6774ae3b3e7", "committedDate": "2020-07-07T02:27:52Z", "message": "Minimal support for prefix search with API key names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5f6b061515c249a83074e6650a41cd95c8fb20e", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/f5f6b061515c249a83074e6650a41cd95c8fb20e", "committedDate": "2020-07-07T04:04:29Z", "message": "Minor update to docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3766814086130c1889cb843616d9918b68f9a85", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/c3766814086130c1889cb843616d9918b68f9a85", "committedDate": "2020-07-07T09:02:12Z", "message": "Checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MzI0MzUx", "url": "https://github.com/elastic/elasticsearch/pull/59113#pullrequestreview-445324351", "createdAt": "2020-07-09T06:34:27Z", "commit": {"oid": "c3766814086130c1889cb843616d9918b68f9a85"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNjozNDoyOFrOGvDfgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNjozNDoyOFrOGvDfgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk5MzQ3Mg==", "bodyText": "Can we have a non-match wildcard as well?\n        PlainActionFuture<GetApiKeyResponse> listener4 = new PlainActionFuture<>();\n        client.execute(GetApiKeyAction.INSTANCE, GetApiKeyRequest.usingApiKeyName(\"not-test-key*\", false), listener4);\n        assertThat(listener4.get().getApiKeyInfos(), arrayWithSize(0));\n\nIdeally a subset match (find 2 out of the 3 keys) would be nice, but the test infrastructure in this class doesn't make that easy.", "url": "https://github.com/elastic/elasticsearch/pull/59113#discussion_r451993472", "createdAt": "2020-07-09T06:34:28Z", "author": {"login": "tvernum"}, "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/ApiKeyIntegTests.java", "diffHunk": "@@ -532,13 +532,21 @@ public void testGetApiKeysForApiKeyId() throws InterruptedException, ExecutionEx\n     }\n \n     public void testGetApiKeysForApiKeyName() throws InterruptedException, ExecutionException {\n-        List<CreateApiKeyResponse> responses = createApiKeys(1, null);\n+        List<CreateApiKeyResponse> responses = createApiKeys(3, null);\n         Client client = client().filterWithHeader(Collections.singletonMap(\"Authorization\", UsernamePasswordToken\n                 .basicAuthHeaderValue(SecuritySettingsSource.TEST_SUPERUSER, SecuritySettingsSourceField.TEST_PASSWORD_SECURE_STRING)));\n         PlainActionFuture<GetApiKeyResponse> listener = new PlainActionFuture<>();\n         client.execute(GetApiKeyAction.INSTANCE, GetApiKeyRequest.usingApiKeyName(responses.get(0).getName(), false), listener);\n         GetApiKeyResponse response = listener.get();\n         verifyGetResponse(1, responses, response, Collections.singleton(responses.get(0).getId()), null);\n+\n+        PlainActionFuture<GetApiKeyResponse> listener2 = new PlainActionFuture<>();\n+        client.execute(GetApiKeyAction.INSTANCE, GetApiKeyRequest.usingApiKeyName(\"test-key*\", false), listener2);\n+        verifyGetResponse(3, responses, listener2.get(), responses.stream().map(o -> o.getId()).collect(Collectors.toSet()), null);\n+\n+        PlainActionFuture<GetApiKeyResponse> listener3 = new PlainActionFuture<>();\n+        client.execute(GetApiKeyAction.INSTANCE, GetApiKeyRequest.usingApiKeyName(\"*\", false), listener2);\n+        verifyGetResponse(3, responses, listener2.get(), responses.stream().map(o -> o.getId()).collect(Collectors.toSet()), null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3766814086130c1889cb843616d9918b68f9a85"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "254afe173e4c38b1fe2f3057664cd78af6ce4c22", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/254afe173e4c38b1fe2f3057664cd78af6ce4c22", "committedDate": "2020-07-09T10:09:21Z", "message": "Address feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a7cdad561d07c13fb7524ca78027e5ead8f3fce", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/3a7cdad561d07c13fb7524ca78027e5ead8f3fce", "committedDate": "2020-07-09T10:09:27Z", "message": "Merge remote-tracking branch 'origin/master' into es-57638-apikey-name-prefix-search"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODQzNjYz", "url": "https://github.com/elastic/elasticsearch/pull/59113#pullrequestreview-447843663", "createdAt": "2020-07-14T07:09:38Z", "commit": {"oid": "3a7cdad561d07c13fb7524ca78027e5ead8f3fce"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c6c510455c29a92acd27ef98905d75795c1557b", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/7c6c510455c29a92acd27ef98905d75795c1557b", "committedDate": "2020-07-14T09:49:44Z", "message": "Merge remote-tracking branch 'origin/master' into es-57638-apikey-name-prefix-search"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTYxNTc3", "url": "https://github.com/elastic/elasticsearch/pull/59113#pullrequestreview-447961577", "createdAt": "2020-07-14T09:55:44Z", "commit": {"oid": "7c6c510455c29a92acd27ef98905d75795c1557b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2171, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}