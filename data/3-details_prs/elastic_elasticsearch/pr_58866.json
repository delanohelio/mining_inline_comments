{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyODM2MDAx", "number": 58866, "title": "Avoid flipping translog header version", "bodyText": "An old translog header does not have a checksum. If we flip the header version of an empty translog to the older version, then we won't detect that corruption, and translog will be considered clean as before.\nCloses #58671", "createdAt": "2020-07-01T17:22:51Z", "url": "https://github.com/elastic/elasticsearch/pull/58866", "merged": true, "mergeCommit": {"oid": "be804b765d8e8d2cc6e42517d93bf9bf0c4e1b6e"}, "closed": true, "closedAt": "2020-07-02T18:34:20Z", "author": {"login": "dnhatn"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcw6MDDAFqTQ0MTQ0MDY1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxBsiBgFqTQ0MTg2MzQxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNDQwNjU2", "url": "https://github.com/elastic/elasticsearch/pull/58866#pullrequestreview-441440656", "createdAt": "2020-07-02T08:02:06Z", "commit": {"oid": "08d8d24934fd965ea8a90cc29a41efac211facf3"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eee9cbe57c09f23f755e262b7c6e55f80141d7a0", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/eee9cbe57c09f23f755e262b7c6e55f80141d7a0", "committedDate": "2020-07-02T15:02:19Z", "message": "Avoid flipping translog header version"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "08d8d24934fd965ea8a90cc29a41efac211facf3", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/08d8d24934fd965ea8a90cc29a41efac211facf3", "committedDate": "2020-07-02T03:25:12Z", "message": "simplify"}, "afterCommit": {"oid": "eee9cbe57c09f23f755e262b7c6e55f80141d7a0", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/eee9cbe57c09f23f755e262b7c6e55f80141d7a0", "committedDate": "2020-07-02T15:02:19Z", "message": "Avoid flipping translog header version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f7ce0b9ccabe9956b4186204cbbc6daec487517", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/5f7ce0b9ccabe9956b4186204cbbc6daec487517", "committedDate": "2020-07-02T15:04:34Z", "message": "relax error checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d33d66c0c549c480f34cd9b732344929543bc1", "author": {"user": {"login": "dnhatn", "name": "Nhat Nguyen"}}, "url": "https://github.com/elastic/elasticsearch/commit/84d33d66c0c549c480f34cd9b732344929543bc1", "committedDate": "2020-07-02T15:47:36Z", "message": "stylecheck"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxODYzNDEx", "url": "https://github.com/elastic/elasticsearch/pull/58866#pullrequestreview-441863411", "createdAt": "2020-07-02T16:45:39Z", "commit": {"oid": "84d33d66c0c549c480f34cd9b732344929543bc1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNjo0NTozOVrOGsVo0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNjo0NTozOVrOGsVo0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE0NTA0Mw==", "bodyText": "can you forward-port this method extraction so that we have code more aligned on master/7.x?", "url": "https://github.com/elastic/elasticsearch/pull/58866#discussion_r449145043", "createdAt": "2020-07-02T16:45:39Z", "author": {"login": "ywelsch"}, "path": "server/src/main/java/org/elasticsearch/index/translog/TranslogHeader.java", "diffHunk": "@@ -105,6 +106,21 @@ private static int headerSizeInBytes(int version, int uuidLength) {\n         return size;\n     }\n \n+\n+    static int readHeaderVersion(final Path path, final FileChannel channel, final StreamInput in) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d33d66c0c549c480f34cd9b732344929543bc1"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2495, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}