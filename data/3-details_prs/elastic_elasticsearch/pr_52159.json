{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMjY3MTk4", "number": 52159, "title": "Ignore timeouts with single-node discovery", "bodyText": "Today we use cluster.join.timeout to prevent nodes from waiting indefinitely\nif joining a faulty master that is too slow to respond, and\ncluster.publish.timeout to allow a faulty master to detect that it is unable\nto publish its cluster state updates in a timely fashion. If these timeouts\noccur then the node restarts the discovery process in an attempt to find a\nhealthier master.\nIn the special case of discovery.type: single-node there is no point in\nlooking for another healthier master since the single node in the cluster is\nall we've got. This commit suppresses these timeouts and instead lets the node\nwait for joins and publications to succeed no matter how long this might take.", "createdAt": "2020-02-10T17:44:57Z", "url": "https://github.com/elastic/elasticsearch/pull/52159", "merged": true, "mergeCommit": {"oid": "a304d9a65648199f81e6fdf72f1bee3fdde12a5c"}, "closed": true, "closedAt": "2020-02-11T14:00:07Z", "author": {"login": "DaveCTurner"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC_yiYgH2gAyMzczMjY3MTk4Ojk0ZDcwMWQwMjA4ZDc4ZjJkNjIyYjRkNjk1YTMyOTM0MzRjYmZkMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDBBkAAH2gAyMzczMjY3MTk4OmI3ZTFkOGFmNGY5YzYxMzhkNmIzMmIwZTQzMmI3MmM3NGViMDViNDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "94d701d0208d78f2d622b4d695a3293434cbfd01", "author": {"user": {"login": "DaveCTurner", "name": "David Turner"}}, "url": "https://github.com/elastic/elasticsearch/commit/94d701d0208d78f2d622b4d695a3293434cbfd01", "committedDate": "2020-02-10T16:33:09Z", "message": "Ignore timeouts with single-node discovery\n\nToday we use `cluster.join.timeout` to prevent nodes from waiting indefinitely\nif joining a faulty master that is too slow to respond, and\n`cluster.publish.timeout` to allow a faulty master to detect that it is unable\nto publish its cluster state updates in a timely fashion. If these timeouts\noccur then the node restarts the discovery process in an attempt to find a\nhealthier master.\n\nIn the special case of `discovery.type: single-node` there is no point in\nlooking for another healthier master since the single node in the cluster is\nall we've got. This commit suppresses these timeouts and instead lets the node\nwait for joins and publications to succeed no matter how long this might take."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MTQxMzE1", "url": "https://github.com/elastic/elasticsearch/pull/52159#pullrequestreview-356141315", "createdAt": "2020-02-10T17:54:01Z", "commit": {"oid": "94d701d0208d78f2d622b4d695a3293434cbfd01"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzo1NDowMVrOFnvwOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNzo1NDowMVrOFnvwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMTE3Nw==", "bodyText": "NIT: can be private?", "url": "https://github.com/elastic/elasticsearch/pull/52159#discussion_r377221177", "createdAt": "2020-02-10T17:54:01Z", "author": {"login": "original-brownbear"}, "path": "server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java", "diffHunk": "@@ -1398,6 +1397,13 @@ public void onFailure(Exception e) {\n             }, EsExecutors.newDirectExecutorService(), transportService.getThreadPool().getThreadContext());\n         }\n \n+        void cancelTimeoutHandlers() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94d701d0208d78f2d622b4d695a3293434cbfd01"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7e1d8af4f9c6138d6b32b0e432b72c74eb05b41", "author": {"user": {"login": "DaveCTurner", "name": "David Turner"}}, "url": "https://github.com/elastic/elasticsearch/commit/b7e1d8af4f9c6138d6b32b0e432b72c74eb05b41", "committedDate": "2020-02-10T17:59:28Z", "message": "Private"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2759, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}