{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxOTQwMTI0", "number": 66533, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNjowNTozMVrOFGyFmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNjowNTozMVrOFGyFmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjU2NDA5OnYy", "diffSide": "RIGHT", "path": "distribution/tools/launchers/src/main/java/org/elasticsearch/tools/launchers/MachineDependentHeap.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNjowNTozMVrOIH815g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNjoyMzo0NFrOIH9riA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIwNzc4Mg==", "bodyText": "This can be simplified to else if (containsOnly(roles, \"ml\", \"remote_cluster_client\"). That simply asserts that only the listed roles area llowd to be in the given collection, but a subset is fine as well.", "url": "https://github.com/elastic/elasticsearch/pull/66533#discussion_r545207782", "createdAt": "2020-12-17T16:05:31Z", "author": {"login": "mark-vieira"}, "path": "distribution/tools/launchers/src/main/java/org/elasticsearch/tools/launchers/MachineDependentHeap.java", "diffHunk": "@@ -142,7 +142,7 @@ public static MachineNodeRole parse(InputStream config) {\n                         return MachineNodeRole.DATA;\n                     } else if (containsOnly(roles, \"master\")) {\n                         return MachineNodeRole.MASTER_ONLY;\n-                    } else if (containsOnly(roles, \"ml\")) {\n+                    } else if (containsOnly(roles, \"ml\") || containsOnly(roles, \"ml\", \"remote_cluster_client\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e0d970866a75a3b9dc21531a3c79172c274a95c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIwOTM4Mw==", "bodyText": "Thinking now, this would also be true in a case where a node had only the remote_cluster_client role, so maybe we might want to assert roles.contains(\"ml\") && containsOnly(roles, \"ml\", \"remote_cluster_client\")", "url": "https://github.com/elastic/elasticsearch/pull/66533#discussion_r545209383", "createdAt": "2020-12-17T16:07:32Z", "author": {"login": "mark-vieira"}, "path": "distribution/tools/launchers/src/main/java/org/elasticsearch/tools/launchers/MachineDependentHeap.java", "diffHunk": "@@ -142,7 +142,7 @@ public static MachineNodeRole parse(InputStream config) {\n                         return MachineNodeRole.DATA;\n                     } else if (containsOnly(roles, \"master\")) {\n                         return MachineNodeRole.MASTER_ONLY;\n-                    } else if (containsOnly(roles, \"ml\")) {\n+                    } else if (containsOnly(roles, \"ml\") || containsOnly(roles, \"ml\", \"remote_cluster_client\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIwNzc4Mg=="}, "originalCommit": {"oid": "0e0d970866a75a3b9dc21531a3c79172c274a95c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIyMTUxMg==", "bodyText": "Thanks.  I did that and also added a test to prove remote_cluster_client on its own isn't an ML node.", "url": "https://github.com/elastic/elasticsearch/pull/66533#discussion_r545221512", "createdAt": "2020-12-17T16:23:44Z", "author": {"login": "droberts195"}, "path": "distribution/tools/launchers/src/main/java/org/elasticsearch/tools/launchers/MachineDependentHeap.java", "diffHunk": "@@ -142,7 +142,7 @@ public static MachineNodeRole parse(InputStream config) {\n                         return MachineNodeRole.DATA;\n                     } else if (containsOnly(roles, \"master\")) {\n                         return MachineNodeRole.MASTER_ONLY;\n-                    } else if (containsOnly(roles, \"ml\")) {\n+                    } else if (containsOnly(roles, \"ml\") || containsOnly(roles, \"ml\", \"remote_cluster_client\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTIwNzc4Mg=="}, "originalCommit": {"oid": "0e0d970866a75a3b9dc21531a3c79172c274a95c"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4572, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}