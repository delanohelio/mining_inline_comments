{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0ODc5NDg1", "number": 59088, "title": "Fix deprecated unsave project outputs resolution", "bodyText": "Fixes how libs in distribution are resolved\nRelated to #57920\nRequired minor rework on common repository setup to allow distribution projects\nto resolve thirdparty artifacts", "createdAt": "2020-07-06T16:27:26Z", "url": "https://github.com/elastic/elasticsearch/pull/59088", "merged": true, "mergeCommit": {"oid": "c0c8bb576419f9d3b5736fee4717afda0c48467e"}, "closed": true, "closedAt": "2020-07-10T13:34:32Z", "author": {"login": "breskeby"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyn4wPgBqjM1MjExMTY4MTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczixjXgBqjM1MzM2ODA0NDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a0156818f814c02b55146a0c802cb077a1dea89", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/6a0156818f814c02b55146a0c802cb077a1dea89", "committedDate": "2020-07-06T16:02:21Z", "message": "Fix deprecated unsave project outputs resolution\n\n- Fixes how libs in distribution are resolved\n- Related to #57920\n- Required minor rework on common repository setup to allow distribution projects\nto resolve thirdparty artifacts"}, "afterCommit": {"oid": "e1f0a70a4959b995672c68f759c54611b3b19f01", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/e1f0a70a4959b995672c68f759c54611b3b19f01", "committedDate": "2020-07-07T15:50:14Z", "message": "Fix deprecated unsave project outputs resolution\n\n- Fixes how libs in distribution are resolved\n- Related to #57920\n- Required minor rework on common repository setup to allow distribution projects\nto resolve thirdparty artifacts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MDQxODI1", "url": "https://github.com/elastic/elasticsearch/pull/59088#pullrequestreview-444041825", "createdAt": "2020-07-07T16:09:19Z", "commit": {"oid": "6a0156818f814c02b55146a0c802cb077a1dea89"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d71341d5f04a2dd5bf0006b68926720fc83e4b53", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/d71341d5f04a2dd5bf0006b68926720fc83e4b53", "committedDate": "2020-07-08T08:27:45Z", "message": "Cleanup formatting"}, "afterCommit": {"oid": "b960f739ebcafe559f6452c4118173c3f39108ba", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/b960f739ebcafe559f6452c4118173c3f39108ba", "committedDate": "2020-07-08T08:28:58Z", "message": "Cleanup formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1OTE0NzE0", "url": "https://github.com/elastic/elasticsearch/pull/59088#pullrequestreview-445914714", "createdAt": "2020-07-09T19:40:55Z", "commit": {"oid": "b960f739ebcafe559f6452c4118173c3f39108ba"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0MDo1NVrOGvfOGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxOTo0MDo1NVrOGvfOGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ0Nzc2OA==", "bodyText": "So the first two of these don't actually declare any dependencies, so it would be functionally equivalent to just use the default configuration, no?\nAs for the launcher project, it does declare dependencies, but it's expected to be packaged here in a common libs dir. @rjernst should the launcher deps be considered \"provided\"? In which case I think it might make sense to flag them compileOnly and again bring in the default configuration.", "url": "https://github.com/elastic/elasticsearch/pull/59088#discussion_r452447768", "createdAt": "2020-07-09T19:40:55Z", "author": {"login": "mark-vieira"}, "path": "distribution/build.gradle", "diffHunk": "@@ -278,6 +279,31 @@ configure(subprojects.findAll { ['archives', 'packages'].contains(it.name) }) {\n   /*****************************************************************************\n    *             Properties to expand when copying packaging files             *\n    *****************************************************************************/\n+  configurations {\n+    ['libs', 'libsPluginCli', 'libsKeystoreCli', 'libsSecurityCli'].each {\n+      create(it) {\n+        canBeConsumed = false\n+        canBeResolved = true\n+        attributes {\n+          attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))\n+          attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME))\n+          attribute(Bundling.BUNDLING_ATTRIBUTE, objects.named(Bundling, Bundling.EXTERNAL))\n+        }\n+      }\n+    }\n+  }\n+\n+  dependencies {\n+    libs project(':server')\n+    libs project(path: ':libs:elasticsearch-plugin-classloader', configuration: 'archives')\n+    libs project(path: ':distribution:tools:java-version-checker', configuration: 'archives')\n+    libs project(path: ':distribution:tools:launchers', configuration: 'archives')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b960f739ebcafe559f6452c4118173c3f39108ba"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1686e05248f2956701b6c82395fd30bc12080e24", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/1686e05248f2956701b6c82395fd30bc12080e24", "committedDate": "2020-07-10T11:46:15Z", "message": "Fix deprecated unsave project outputs resolution\n\n- Fixes how libs in distribution are resolved\n- Related to #57920\n- Required minor rework on common repository setup to allow distribution projects\nto resolve thirdparty artifacts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af8715d40c478e8ad9ad9ed389c7337d63d2b09d", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/af8715d40c478e8ad9ad9ed389c7337d63d2b09d", "committedDate": "2020-07-10T11:46:16Z", "message": "Cleanup formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85821ce5e132cf39211c5863073b4942132fa3b8", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/85821ce5e132cf39211c5863073b4942132fa3b8", "committedDate": "2020-07-10T11:46:16Z", "message": "Use efault configurations when resolving tools"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2e46593e31a66a6b8454e5d48bebeb27442b392", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/e2e46593e31a66a6b8454e5d48bebeb27442b392", "committedDate": "2020-07-10T11:21:22Z", "message": "Revert \"Use efault configurations when resolving tools\"\n\nThis reverts commit acf1021d79229dec2f3ae7e4f0c28a547e8f0574."}, "afterCommit": {"oid": "71bf7fc94e16da239f2ab0c0016d177e7d311ba1", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/71bf7fc94e16da239f2ab0c0016d177e7d311ba1", "committedDate": "2020-07-10T11:46:16Z", "message": "Revert \"Use efault configurations when resolving tools\"\n\nThis reverts commit acf1021d79229dec2f3ae7e4f0c28a547e8f0574."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "71bf7fc94e16da239f2ab0c0016d177e7d311ba1", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/71bf7fc94e16da239f2ab0c0016d177e7d311ba1", "committedDate": "2020-07-10T11:46:16Z", "message": "Revert \"Use efault configurations when resolving tools\"\n\nThis reverts commit acf1021d79229dec2f3ae7e4f0c28a547e8f0574."}, "afterCommit": {"oid": "85821ce5e132cf39211c5863073b4942132fa3b8", "author": {"user": {"login": "breskeby", "name": "Rene Groeschke"}}, "url": "https://github.com/elastic/elasticsearch/commit/85821ce5e132cf39211c5863073b4942132fa3b8", "committedDate": "2020-07-10T11:46:16Z", "message": "Use efault configurations when resolving tools"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2310, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}