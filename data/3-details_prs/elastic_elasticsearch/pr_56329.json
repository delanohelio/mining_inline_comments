{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0NTkyMjI1", "number": 56329, "title": "Fix Noisy Logging during Snapshot Delete (#56264)", "bodyText": "We were logging the cleanup of the snap- and meta- blobs for every snapshot delete\nwhich is needlessly noisy and confusing to users. We should only log actual stale/unexpected\nblobs here.", "createdAt": "2020-05-07T10:19:02Z", "url": "https://github.com/elastic/elasticsearch/pull/56329", "merged": true, "mergeCommit": {"oid": "3bad5b3c01a615af72f8a5b6f95721cf35dd5852"}, "closed": true, "closedAt": "2020-05-07T11:48:54Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABce6hx4AH2gAyNDE0NTkyMjI1OmNlMTgwM2Y1MGNkOTUxYmE4YTNkOTUwMWNiOWJlNmYzOGMwZDljY2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABce6q53AFqTQwNzM0MDM1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ce1803f50cd951ba8a3d9501cb9be6f38c0d9ccf", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/ce1803f50cd951ba8a3d9501cb9be6f38c0d9ccf", "committedDate": "2020-05-07T10:15:12Z", "message": "Fix Noisy Logging during Snapshot Delete (#56264)\n\nWe were logging the cleanup of the snap- and meta- blobs for every snapshot delete\r\nwhich is needlessly noisy and confusing to users. We should only log actual stale/unexpected\r\nblobs here."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzQwMzUw", "url": "https://github.com/elastic/elasticsearch/pull/56329#pullrequestreview-407340350", "createdAt": "2020-05-07T10:22:07Z", "commit": {"oid": "ce1803f50cd951ba8a3d9501cb9be6f38c0d9ccf"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyMjowN1rOGR4KUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoyMjowN1rOGR4KUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM5OTEyMw==", "bodyText": "I think it would be helpful to continue to log all the blobs at TRACE level; I'd do both if there are unexpected ones as it's interesting to know that they were unexpected.", "url": "https://github.com/elastic/elasticsearch/pull/56329#discussion_r421399123", "createdAt": "2020-05-07T10:22:07Z", "author": {"login": "DaveCTurner"}, "path": "server/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java", "diffHunk": "@@ -912,12 +916,24 @@ public void cleanup(long repositoryStateId, Version repositoryMetaVersion, Actio\n         ).collect(Collectors.toList());\n     }\n \n-    private List<String> cleanupStaleRootFiles(List<String> blobsToDelete) {\n+    private List<String> cleanupStaleRootFiles(Collection<SnapshotId> deletedSnapshots, List<String> blobsToDelete) {\n         if (blobsToDelete.isEmpty()) {\n             return blobsToDelete;\n         }\n         try {\n-            logger.info(\"[{}] Found stale root level blobs {}. Cleaning them up\", metadata.name(), blobsToDelete);\n+            if (logger.isInfoEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce1803f50cd951ba8a3d9501cb9be6f38c0d9ccf"}, "originalPosition": 88}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 196, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}