{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1MjkyODYz", "number": 52353, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozMzoyOVrODf0_rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozNDozNFrODf1BEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzAwNzE5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/MlConfigIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozMzoyOVrOFpwduw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozMzoyOVrOFpwduw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMyOTk3OQ==", "bodyText": "In 7.x we need to still handle 6.x indices that have doc instead of _doc as the mapping type for the config and results index.", "url": "https://github.com/elastic/elasticsearch/pull/52353#discussion_r379329979", "createdAt": "2020-02-14T09:33:29Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/MlConfigIndex.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+package org.elasticsearch.xpack.core.ml;\n+\n+import org.elasticsearch.Version;\n+import org.elasticsearch.index.mapper.MapperService;\n+import org.elasticsearch.xpack.core.template.TemplateUtils;\n+\n+import java.util.Collections;\n+\n+public class MlConfigIndex {\n+\n+    private static final String MAPPINGS_VERSION_VARIABLE = \"xpack.ml.version\";\n+\n+    private MlConfigIndex() {}\n+\n+    public static String mapping() {\n+        return mapping(MapperService.SINGLE_MAPPING_NAME);\n+    }\n+\n+    public static String mapping(String mappingType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "697fcf0b8176916a0736f55f5022a94846f49615"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzAwOTI2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/persistence/ElasticsearchMappings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozNDowOVrOFpwe8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozNDowOVrOFpwe8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMzMDI4OQ==", "bodyText": "This is where we pass the mapping type to the mapping supplier method.", "url": "https://github.com/elastic/elasticsearch/pull/52353#discussion_r379330289", "createdAt": "2020-02-14T09:34:09Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/persistence/ElasticsearchMappings.java", "diffHunk": "@@ -1290,10 +170,11 @@ public static void addDocMappingIfMissing(String alias,\n             IndexMetaData indexMetaData = state.metaData().index(indicesThatRequireAnUpdate[0]);\n             String mappingType = indexMetaData.mapping().type();\n \n-            try (XContentBuilder mapping = mappingSupplier.apply(mappingType)) {\n+            try {\n+                String mapping = mappingSupplier.apply(mappingType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "697fcf0b8176916a0736f55f5022a94846f49615"}, "originalPosition": 1177}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzAxMDcyOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/persistence/AnomalyDetectorsIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozNDozNFrOFpwfxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwOTozNDozNFrOFpwfxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMzMDUwMw==", "bodyText": "In 7.x we need to still handle 6.x indices that have doc instead of _doc as the mapping type for the config and results index.", "url": "https://github.com/elastic/elasticsearch/pull/52353#discussion_r379330503", "createdAt": "2020-02-14T09:34:34Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/persistence/AnomalyDetectorsIndex.java", "diffHunk": "@@ -144,4 +150,12 @@ public static void createStateIndexAndAliasIfNecessary(Client client, ClusterSta\n         }\n     }\n \n+    public static String resultsMapping() {\n+        return resultsMapping(MapperService.SINGLE_MAPPING_NAME);\n+    }\n+\n+    public static String resultsMapping(String mappingType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "697fcf0b8176916a0736f55f5022a94846f49615"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4007, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}