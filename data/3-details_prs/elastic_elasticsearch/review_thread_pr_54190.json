{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNjQyOTY1", "number": 54190, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozMTo1NVrODrRMcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjozNjoyOFrODrTGDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2Njk3MDczOnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/inference.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozMTo1NVrOF7g3XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozMTo1NVrOF7g3XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0ODc2NQ==", "bodyText": "This should indicate that this is the mapping for the feature importance result field.", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397948765", "createdAt": "2020-03-25T15:31:55Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -116,3 +117,36 @@ categories for which the predicted probabilities are reported is 2\n (`num_top_classes`). The result is written to the `prediction` field and the top \n classes to the `probabilities` field. Both fields are contained in the \n `target_field` results object.\n+\n+\n+[discrete]\n+[[inference-processor-feature-importance]]\n+==== {feat-imp-cap} object mapping\n+\n+Update your index mapping as you can see below to get the full benefit of \n+aggregating and searching for \n+{ml-docs}/dfa-classification.html#dfa-classification-feature-importance[{feat-imp}].\n+\n+[source,js]\n+--------------------------------------------------\n+{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2Njk4OTEyOnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/inference.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozNTo0MlrOF7hDbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTozNTo0MlrOF7hDbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk1MTg1Mw==", "bodyText": "probably some inference configs + field name examples?\n{\n    \"tag\": \"foo\",\n    ...\n}\n\nWrites feature importance to field ml.inference.foo.feature_importance.\n{\n    \"tag\": \"foo\",\n    \"target_field\": \"my_field\"\n}\n\nWrites feature importance to field my_field.foo.feature_importance.", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397951853", "createdAt": "2020-03-25T15:35:42Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -116,3 +117,36 @@ categories for which the predicted probabilities are reported is 2\n (`num_top_classes`). The result is written to the `prediction` field and the top \n classes to the `probabilities` field. Both fields are contained in the \n `target_field` results object.\n+\n+\n+[discrete]\n+[[inference-processor-feature-importance]]\n+==== {feat-imp-cap} object mapping\n+\n+Update your index mapping as you can see below to get the full benefit of \n+aggregating and searching for \n+{ml-docs}/dfa-classification.html#dfa-classification-feature-importance[{feat-imp}].\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"type\": \"nested\",\n+  \"dynamic\": true,\n+  \"properties\": {\n+    \"feature_name\": {\n+      \"type\": \"keyword\"\n+    },\n+    \"importance\": {\n+      \"type\": \"double\"\n+    }\n+  }\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+The mapping field name for {feat-imp} is compounded as follows:\n+\n+`ml.<inference.target_field>`.`<inference.tag>`.`feature_importance`\n+\n+If `inference.tag` is not provided in the processor definition, it is not part \n+of the field path. The `<inference.target_field>` defaults to `inference`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f6c0d614cb59a332d123750e113f2f1765d7292"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NzI4MjA3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/inference.asciidoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjozNjoyOFrOF7j-QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjo1NDoxOFrOF7kyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5OTY4MA==", "bodyText": "it is not ml.my_field. Its just my_field.foo.feature_importance", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r397999680", "createdAt": "2020-03-25T16:36:28Z", "author": {"login": "benwtrent"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -149,4 +149,33 @@ The mapping field name for {feat-imp} is compounded as follows:\n `ml.<inference.target_field>`.`<inference.tag>`.`feature_importance`\n \n If `inference.tag` is not provided in the processor definition, it is not part \n-of the field path. The `<inference.target_field>` defaults to `inference`.\n\\ No newline at end of file\n+of the field path. The `<inference.target_field>` defaults to `inference`.\n+\n+For example, you provide a tag `foo` in the definition as you can see below:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  ...\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+\n+The `{feat-imp}` value is written to the `ml.inference.foo.feature_importance` \n+field.\n+\n+You can also specify a target field as follows:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  \"target_field\": \"my_field\"\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+In this case, `{feat-imp}` is exposed in the \n+`ml.my_field.foo.feature_importance` field.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51990ab7cfd26241e1f9e4a702dd2ab622ed38ec"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjk4Mg==", "bodyText": "@benwtrent Thanks. I also updated the schema accordingly. I.e.: <ml.inference.target_field>.<inference.tag>.feature_importance instead of\nml.<inference.target_field>.<inference.tag>.feature_importance", "url": "https://github.com/elastic/elasticsearch/pull/54190#discussion_r398012982", "createdAt": "2020-03-25T16:54:18Z", "author": {"login": "szabosteve"}, "path": "docs/reference/ingest/processors/inference.asciidoc", "diffHunk": "@@ -149,4 +149,33 @@ The mapping field name for {feat-imp} is compounded as follows:\n `ml.<inference.target_field>`.`<inference.tag>`.`feature_importance`\n \n If `inference.tag` is not provided in the processor definition, it is not part \n-of the field path. The `<inference.target_field>` defaults to `inference`.\n\\ No newline at end of file\n+of the field path. The `<inference.target_field>` defaults to `inference`.\n+\n+For example, you provide a tag `foo` in the definition as you can see below:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  ...\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+\n+The `{feat-imp}` value is written to the `ml.inference.foo.feature_importance` \n+field.\n+\n+You can also specify a target field as follows:\n+\n+[source,js]\n+--------------------------------------------------\n+{\n+  \"tag\": \"foo\",\n+  \"target_field\": \"my_field\"\n+}\n+--------------------------------------------------\n+// NOTCONSOLE\n+\n+In this case, `{feat-imp}` is exposed in the \n+`ml.my_field.foo.feature_importance` field.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5OTY4MA=="}, "originalCommit": {"oid": "51990ab7cfd26241e1f9e4a702dd2ab622ed38ec"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4081, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}