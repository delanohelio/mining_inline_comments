{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMTQzNzI4", "number": 65194, "title": "Add retries to Docker build apk commands", "bodyText": "Most of the Elasticsearch Docker build process implements retries in order to make the process more robust in the face of transient errors e.g. network failures. However, we missed out the apk command in master's Dockerfile. This PR adds the same retry loop around apk as features elsewhere in the Dockerfile.", "createdAt": "2020-11-18T12:17:04Z", "url": "https://github.com/elastic/elasticsearch/pull/65194", "merged": true, "mergeCommit": {"oid": "30abc09a68730f66f7dd0eed2dac7c386ef74805"}, "closed": true, "closedAt": "2020-11-20T08:03:07Z", "author": {"login": "pugnascotia"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddtB99gH2gAyNTIzMTQzNzI4OjhlOTU1NjA2NDJkYWNjMDY3NGYwODAwODlhNDAxNzcxY2ExZGI3ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeBuxEgH2gAyNTIzMTQzNzI4OjliOTJmNzg5YjhjYzJkYjQzYzU1ZDE0NzBmYjAwOGRjODg3MGEyOGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e95560642dacc0674f080089a401771ca1db782", "author": {"user": {"login": "pugnascotia", "name": "Rory Hunter"}}, "url": "https://github.com/elastic/elasticsearch/commit/8e95560642dacc0674f080089a401771ca1db782", "committedDate": "2020-11-18T12:08:55Z", "message": "Add retries to Docker apk cmd"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODU0Mjk1", "url": "https://github.com/elastic/elasticsearch/pull/65194#pullrequestreview-533854295", "createdAt": "2020-11-18T20:36:10Z", "commit": {"oid": "8e95560642dacc0674f080089a401771ca1db782"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozNjoxMFrOH2BJHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozNjoxMFrOH2BJHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwMzg3MQ==", "bodyText": "I wonder since we already treat this file as a groovy template, if we could define some kind of macro to wrap some arbitrary lines in this loop with some sugar.", "url": "https://github.com/elastic/elasticsearch/pull/65194#discussion_r526403871", "createdAt": "2020-11-18T20:36:10Z", "author": {"login": "mark-vieira"}, "path": "distribution/docker/src/docker/Dockerfile", "diffHunk": "@@ -74,7 +74,12 @@ ENV TARBALL_URL https://curl.haxx.se/download/curl-\\${VERSION}.tar.xz\n ENV TARBALL_PATH curl-\\${VERSION}.tar.xz\n \n # Install dependencies\n-RUN apk add gnupg gcc make musl-dev openssl-dev openssl-libs-static file\n+RUN for iter in {1..10}; do \\\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e95560642dacc0674f080089a401771ca1db782"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b93a81785fb49b3d9c6111a6a0b332c6f420849f", "author": {"user": {"login": "pugnascotia", "name": "Rory Hunter"}}, "url": "https://github.com/elastic/elasticsearch/commit/b93a81785fb49b3d9c6111a6a0b332c6f420849f", "committedDate": "2020-11-19T11:55:27Z", "message": "Define a helper to generate retry bash constructs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b92f789b8cc2db43c55d1470fb008dc8870a28e", "author": {"user": {"login": "pugnascotia", "name": "Rory Hunter"}}, "url": "https://github.com/elastic/elasticsearch/commit/9b92f789b8cc2db43c55d1470fb008dc8870a28e", "committedDate": "2020-11-19T12:15:57Z", "message": "Tweaks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1010, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}