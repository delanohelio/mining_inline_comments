{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNjA2NDU5", "number": 63563, "title": "[DOCS] Adds AUC ROC classification metric to the API examples", "bodyText": "Overview\nThis PR adds a classification evaluation example API call that specifies auc_roc as an evaluation metric. It also adds an example response and footnotes to the snippets.\nPreview\nClassification examples", "createdAt": "2020-10-12T14:14:19Z", "url": "https://github.com/elastic/elasticsearch/pull/63563", "merged": true, "mergeCommit": {"oid": "e8930a44a4a3663490a03d7e604d5bcb000669ac"}, "closed": true, "closedAt": "2020-10-13T09:03:21Z", "author": {"login": "szabosteve"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR0lsbgH2gAyNTAxNjA2NDU5OjgzZGZlZjdjNzkwZmMxYzAxMmZjYzU2ODM0M2EwMmZmNzNlNDJlNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSEnucgFqTUwNzIwOTc4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "83dfef7c790fc1c012fcc568343a02ff73e42e74", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/83dfef7c790fc1c012fcc568343a02ff73e42e74", "committedDate": "2020-10-12T14:10:11Z", "message": "[DOCS] Adds AUC ROC classification metric to the API examples."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9027452e7f246fb50707a3180a4c380546063bbb", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/9027452e7f246fb50707a3180a4c380546063bbb", "committedDate": "2020-10-12T14:13:39Z", "message": "[DOCS] Minor edits."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbc38085d6cb436b6343fabfea024ab6f035f9b6", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/dbc38085d6cb436b6343fabfea024ab6f035f9b6", "committedDate": "2020-10-12T14:18:47Z", "message": "[DOCS] Adds console-result flag to result snippet."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50933371d24a2303c989874f2d1cb187aed4831b", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/50933371d24a2303c989874f2d1cb187aed4831b", "committedDate": "2020-10-12T15:04:55Z", "message": "[DOCS] Changes index name."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MTU0MTMz", "url": "https://github.com/elastic/elasticsearch/pull/63563#pullrequestreview-507154133", "createdAt": "2020-10-13T07:44:57Z", "commit": {"oid": "50933371d24a2303c989874f2d1cb187aed4831b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNzo0NDo1N1rOHgZlKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNzo0NDo1N1rOHgZlKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczNTU5Mw==", "bodyText": "With #63302, doc_count is no longer reported.\nPlease remove.", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503735593", "createdAt": "2020-10-13T07:44:57Z", "author": {"login": "przemekwitek"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,55 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>\n+         \"metrics\": {\n+            \"auc_roc\" : { <4>\n+              \"class_name\": \"dog\" <5>\n+            }\n+         }\n+      }\n+   }\n+}\n+--------------------------------------------------\n+// TEST[skip:TBD]\n+\n+<1> The evaluation type.\n+<2> The field that contains the ground truth value for the actual animal \n+classification. This is required in order to evaluate results.\n+<3> The field that contains the predicted value for animal classification by \n+the {classanalysis}.\n+<4> Specifies the metric for the evaluation.\n+<5> Specifies the class name that is treated as positive during the evaluation, \n+all the other classes are treated as negative.\n+\n+\n+The API returns the following result:\n+\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"classification\" : {\n+    \"auc_roc\" : {\n+      \"score\" : 0.8941788639536681, <1>\n+      \"doc_count\" : 4169 <2>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50933371d24a2303c989874f2d1cb187aed4831b"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/0052c27f2a354e885a24aed1a7173cee645f578f", "committedDate": "2020-10-13T08:36:23Z", "message": "[DOCS] Removes doc_count from example response."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjAyNDQw", "url": "https://github.com/elastic/elasticsearch/pull/63563#pullrequestreview-507202440", "createdAt": "2020-10-13T08:42:17Z", "commit": {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODo0MjoxN1rOHgb2QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwODo0MjoxN1rOHgb2QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MjczNw==", "bodyText": "This field is not used by auc_roc so you can remove it (but please double-check that the example is still working, there may be bugs...).", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503772737", "createdAt": "2020-10-13T08:42:17Z", "author": {"login": "przemekwitek"}, "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,49 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee1b6bd4e645e6ebe47b3ebbc19ec9a37697b743", "author": {"user": {"login": "szabosteve", "name": "Istv\u00e1n Zolt\u00e1n Szab\u00f3"}}, "url": "https://github.com/elastic/elasticsearch/commit/ee1b6bd4e645e6ebe47b3ebbc19ec9a37697b743", "committedDate": "2020-10-13T08:46:22Z", "message": "[DOCS] Removes predicted_field from example API call."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MjA5Nzgx", "url": "https://github.com/elastic/elasticsearch/pull/63563#pullrequestreview-507209781", "createdAt": "2020-10-13T08:50:53Z", "commit": {"oid": "ee1b6bd4e645e6ebe47b3ebbc19ec9a37697b743"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4055, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}