{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNTk0ODg4", "number": 56222, "title": "[7.x] Wire up DiversifiedAggregation (#56145)", "bodyText": "Backports the following commits to 7.x:\n\nWire up DiversifiedAggregation (#56145)", "createdAt": "2020-05-05T15:38:59Z", "url": "https://github.com/elastic/elasticsearch/pull/56222", "merged": true, "mergeCommit": {"oid": "33da086d7bbac1797a6fb20503877ca3bf841981"}, "closed": true, "closedAt": "2020-05-05T17:11:50Z", "author": {"login": "not-napoleon"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceV9ZsgH2gAyNDEzNTk0ODg4OjdjOTMwNjI5NTI1MDNmZjQ3NTgzNjc0M2JlNjU0YjNjN2YxZWE2OWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceWnurgH2gAyNDEzNTk0ODg4OjI2MDhmNThlZmU2ZWNlNGY5YzA4YjVhMzVlZDNiYjUxNTY5MjNiZDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c93062952503ff475836743be654b3c7f1ea69d", "author": {"user": {"login": "not-napoleon", "name": "Mark Tozzi"}}, "url": "https://github.com/elastic/elasticsearch/commit/7c93062952503ff475836743be654b3c7f1ea69d", "committedDate": "2020-05-05T15:38:53Z", "message": "Wire up DiversifiedAggregation (#56145)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1OTE1NDY1", "url": "https://github.com/elastic/elasticsearch/pull/56222#pullrequestreview-405915465", "createdAt": "2020-05-05T15:43:15Z", "commit": {"oid": "7c93062952503ff475836743be654b3c7f1ea69d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNTo0MzoxNlrOGQvk7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNTo0MzoxNlrOGQvk7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIwOTkwMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),\n          \n          \n            \n                        org.elasticsearch.common.collect.List.of(\n          \n          \n            \n                            CoreValuesSourceType.NUMERIC,\n          \n          \n            \n                            CoreValuesSourceType.DATE,\n          \n          \n            \n                            CoreValuesSourceType.BOOLEAN),", "url": "https://github.com/elastic/elasticsearch/pull/56222#discussion_r420209902", "createdAt": "2020-05-05T15:43:16Z", "author": {"login": "not-napoleon"}, "path": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/sampler/DiversifiedAggregatorFactory.java", "diffHunk": "@@ -27,19 +27,51 @@\n import org.elasticsearch.search.aggregations.InternalAggregation;\n import org.elasticsearch.search.aggregations.NonCollectingAggregator;\n import org.elasticsearch.search.aggregations.bucket.sampler.SamplerAggregator.ExecutionMode;\n+import org.elasticsearch.search.aggregations.support.AggregatorSupplier;\n+import org.elasticsearch.search.aggregations.support.CoreValuesSourceType;\n import org.elasticsearch.search.aggregations.support.ValuesSource;\n-import org.elasticsearch.search.aggregations.support.ValuesSource.Numeric;\n import org.elasticsearch.search.aggregations.support.ValuesSourceAggregatorFactory;\n import org.elasticsearch.search.aggregations.support.ValuesSourceConfig;\n+import org.elasticsearch.search.aggregations.support.ValuesSourceRegistry;\n import org.elasticsearch.search.internal.SearchContext;\n \n import java.io.IOException;\n+import java.util.List;\n import java.util.Map;\n \n-import static org.elasticsearch.search.aggregations.support.AggregationUsageService.OTHER_SUBTYPE;\n-\n public class DiversifiedAggregatorFactory extends ValuesSourceAggregatorFactory {\n \n+    public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n+        builder.register(DiversifiedAggregationBuilder.NAME,\n+            List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c93062952503ff475836743be654b3c7f1ea69d"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4579163ef50a6b82c99a029974331816a7a5fc98", "author": {"user": {"login": "not-napoleon", "name": "Mark Tozzi"}}, "url": "https://github.com/elastic/elasticsearch/commit/4579163ef50a6b82c99a029974331816a7a5fc98", "committedDate": "2020-05-05T15:43:30Z", "message": "Update server/src/main/java/org/elasticsearch/search/aggregations/bucket/sampler/DiversifiedAggregatorFactory.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da86067fe30a783abf9142a7492dbb4d5c9782de", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/da86067fe30a783abf9142a7492dbb4d5c9782de", "committedDate": "2020-05-05T15:51:48Z", "message": "Merge branch '7.x' into backport/7.x/pr-56145"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2608f58efe6ece4f9c08b5a35ed3bb5156923bd4", "author": {"user": {"login": "not-napoleon", "name": "Mark Tozzi"}}, "url": "https://github.com/elastic/elasticsearch/commit/2608f58efe6ece4f9c08b5a35ed3bb5156923bd4", "committedDate": "2020-05-05T16:25:07Z", "message": "remove unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 119, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}