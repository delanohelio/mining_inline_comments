{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5ODQ2NzM2", "number": 60498, "title": "Fix get-license test failure by ensure cluster is ready", "bodyText": "When a new cluster starts, the HTTP layer become ready to accept incoming requests while the basic license is still being generated in the background. When a get license request comes in before the license is ready, it can get 404 error. This PR fixes it by either: ensure the cluster is ready before issue the license request or wrap the license request in assertBusy.\nResolves: #59157\nResolves: #60468\nResolves: #60519", "createdAt": "2020-07-31T06:58:39Z", "url": "https://github.com/elastic/elasticsearch/pull/60498", "merged": true, "mergeCommit": {"oid": "ec1f4f1da195b8ee2e07034b344d17aa2889bf8a"}, "closed": true, "closedAt": "2020-08-03T05:19:35Z", "author": {"login": "ywangd"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6OmpBAH2gAyNDU5ODQ2NzM2OmQyYmYzYjUwYWQwMWU4MzUyZTA3YmNlY2JkYTdmNTJkYjNmNDQ5NGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7KOmsgFqTQ1OTc0MDA5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d2bf3b50ad01e8352e07bcecbda7f52db3f4494c", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/d2bf3b50ad01e8352e07bcecbda7f52db3f4494c", "committedDate": "2020-07-31T06:54:34Z", "message": "Fix get-license test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46d7917ecd334c406927e6016d2579af3eb05086", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/46d7917ecd334c406927e6016d2579af3eb05086", "committedDate": "2020-08-03T01:10:06Z", "message": "Use existing helper method to ensure license for doc tests\n\nAdd assertBusy to more places where license checking can fail."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ba9deda10e72bc207c343f1b156f16f13797ad1", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/5ba9deda10e72bc207c343f1b156f16f13797ad1", "committedDate": "2020-08-03T01:11:55Z", "message": "Merge remote-tracking branch 'origin/master' into es-59157-get-license-test-failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5c303ae20a7679fbe44c808f370112c46940c25", "author": {"user": {"login": "ywangd", "name": "Yang Wang"}}, "url": "https://github.com/elastic/elasticsearch/commit/e5c303ae20a7679fbe44c808f370112c46940c25", "committedDate": "2020-08-03T01:13:14Z", "message": "Revert unnecessary change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NzQwMDk4", "url": "https://github.com/elastic/elasticsearch/pull/60498#pullrequestreview-459740098", "createdAt": "2020-08-03T04:21:46Z", "commit": {"oid": "e5c303ae20a7679fbe44c808f370112c46940c25"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNDoyMTo0NlrOG6ruSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNDoyMTo0NlrOG6ruSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE4Njk1Mw==", "bodyText": "Why does this need to support \\\\ but ccr doesn't?", "url": "https://github.com/elastic/elasticsearch/pull/60498#discussion_r464186953", "createdAt": "2020-08-03T04:21:46Z", "author": {"login": "tvernum"}, "path": "docs/src/test/java/org/elasticsearch/smoketest/DocsClientYamlTestSuiteIT.java", "diffHunk": "@@ -175,6 +175,11 @@ protected boolean isCcrTest() {\n         return testName != null && testName.contains(\"/ccr/\");\n     }\n \n+    protected boolean isGetLicenseTest() {\n+        String testName = getTestName();\n+        return testName != null && (testName.contains(\"/get-license/\") || testName.contains(\"\\\\get-license\\\\\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5c303ae20a7679fbe44c808f370112c46940c25"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3536, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}