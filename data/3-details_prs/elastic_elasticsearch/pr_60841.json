{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MTYwMzkw", "number": 60841, "title": "Add flip index ir nodes", "bodyText": "This change adds three nodes that support negative brace accesses into collections, arrays, and for def types. This helps separate that logic out from brace accesses in general. This also has some renaming for nodes adding an ir prefix to help differentiate ir node variables from user node variables.", "createdAt": "2020-08-06T17:12:37Z", "url": "https://github.com/elastic/elasticsearch/pull/60841", "merged": true, "mergeCommit": {"oid": "a8a34ec40a66d6893be3407e489a2042e824c0ef"}, "closed": true, "closedAt": "2020-08-10T20:43:22Z", "author": {"login": "jdconrad"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5F4hvAH2gAyNDY0MTYwMzkwOmZlNGY3YmZiNDM4ZjM4ZTg4ZjU5NmIxOWNlMzhhZTRjZDQ5ZWM1YzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9m-U-AH2gAyNDY0MTYwMzkwOjQxNjgwMTA4NGM2ZGQ1YzJmYzgxNzlhNGVlNWY2N2I1YTBlMmRkZGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fe4f7bfb438f38e88f596b19ce38ae4cd49ec5c6", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/fe4f7bfb438f38e88f596b19ce38ae4cd49ec5c6", "committedDate": "2020-07-27T18:11:02Z", "message": "Move bootstrap injection into the the ir tree builder phase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02b70959c0a4be12ee85565aaf25ee1cae4ebea5", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/02b70959c0a4be12ee85565aaf25ee1cae4ebea5", "committedDate": "2020-07-27T18:42:59Z", "message": "move ScriptClassInfo out of walker and remove unncessary injection\nphases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be17b14018e28414e10b9e7e02e3f7c299fc2589", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/be17b14018e28414e10b9e7e02e3f7c299fc2589", "committedDate": "2020-07-27T20:46:00Z", "message": "add AccessNode in place of ECall, EBrace, and EDot"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1725972243f755a6e7b51583ca490140517b70be", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/1725972243f755a6e7b51583ca490140517b70be", "committedDate": "2020-07-27T21:24:32Z", "message": "rename some nodes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d979077dc6248a0ec0dbdf7101fdcf4e11307e9f", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/d979077dc6248a0ec0dbdf7101fdcf4e11307e9f", "committedDate": "2020-07-27T21:38:42Z", "message": "add flip nodes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4d61ba2e61783c5e884a3af0c161dcff2e42cf4", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/a4d61ba2e61783c5e884a3af0c161dcff2e42cf4", "committedDate": "2020-07-29T17:45:57Z", "message": "Merge branch 'master' into semantic010"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd130aeb8b8eda556cc45047887ab537d590f61d", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/fd130aeb8b8eda556cc45047887ab537d590f61d", "committedDate": "2020-07-29T17:46:17Z", "message": "Merge branch 'semantic010' into semantic011"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2f27b89f8a20646232083535d05d3bd81817d3b", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/d2f27b89f8a20646232083535d05d3bd81817d3b", "committedDate": "2020-07-29T17:46:37Z", "message": "Merge branch 'semantic011' into semantic013"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fbd0bcdf699ca71db447a21ea00ce18e8aacbd5", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/3fbd0bcdf699ca71db447a21ea00ce18e8aacbd5", "committedDate": "2020-08-05T16:59:29Z", "message": "Merge branch 'master' into semantic010"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3fd76361e7e1d00df0f0d4070949130845f6271", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/b3fd76361e7e1d00df0f0d4070949130845f6271", "committedDate": "2020-08-05T17:24:53Z", "message": "response to pr comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e1e958536707210b141a4a495da5ee315e88b06", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/2e1e958536707210b141a4a495da5ee315e88b06", "committedDate": "2020-08-05T19:35:03Z", "message": "Merge branch 'master' into semantic010"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "397c7b1f728cf0f7a7fda6552090ab4d2ccf23b8", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/397c7b1f728cf0f7a7fda6552090ab4d2ccf23b8", "committedDate": "2020-08-05T19:36:47Z", "message": "Merge branch 'semantic010' into semantic011"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8bc699f649519c4d1d7b8b28d31e7add3406966", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/a8bc699f649519c4d1d7b8b28d31e7add3406966", "committedDate": "2020-08-05T20:42:28Z", "message": "fix spacing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aab90f387c3bb5600f90f45d9e27ca0b1b041cb9", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/aab90f387c3bb5600f90f45d9e27ca0b1b041cb9", "committedDate": "2020-08-06T16:05:28Z", "message": "Merge branch 'master' into semantic011"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ee21c7cba9d202259bac2e25edda5994341fe66", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/9ee21c7cba9d202259bac2e25edda5994341fe66", "committedDate": "2020-08-06T16:10:02Z", "message": "Merge branch 'semantic011' into semantic013"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDg4ODQw", "url": "https://github.com/elastic/elasticsearch/pull/60841#pullrequestreview-464488840", "createdAt": "2020-08-10T18:53:01Z", "commit": {"oid": "9ee21c7cba9d202259bac2e25edda5994341fe66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODo1MzowMVrOG-bKQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODo1MzowMVrOG-bKQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEwOTg5MQ==", "bodyText": "This semi is lonely.", "url": "https://github.com/elastic/elasticsearch/pull/60841#discussion_r468109891", "createdAt": "2020-08-10T18:53:01Z", "author": {"login": "stu-elastic"}, "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/phase/DefaultUserTreeToIRTreePhase.java", "diffHunk": "@@ -1368,20 +1372,31 @@ public void visitBrace(EBrace userBraceNode, ScriptScope scriptScope) {\n         Class<?> prefixValueType = scriptScope.getDecoration(userBraceNode.getPrefixNode(), ValueType.class).getValueType();\n \n         if (prefixValueType.isArray()) {\n+            FlipArrayIndex irFlipArrayIndex = new FlipArrayIndex();\n+            irFlipArrayIndex.setLocation(userBraceNode.getIndexNode().getLocation());\n+            irFlipArrayIndex.setExpressionType(int.class);\n+            irFlipArrayIndex.setIndexNode(injectCast(userBraceNode.getIndexNode(), scriptScope));\n+\n             BraceSubNode irBraceSubNode = new BraceSubNode();\n-            irBraceSubNode.setChildNode(injectCast(userBraceNode.getIndexNode(), scriptScope));\n+            irBraceSubNode.setIndexNode(irFlipArrayIndex);\n             irBraceSubNode.setLocation(userBraceNode.getLocation());\n             irBraceSubNode.setExpressionType(scriptScope.getDecoration(userBraceNode, ValueType.class).getValueType());\n             irExpressionNode = irBraceSubNode;\n         } else if (prefixValueType == def.class) {\n+            ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ee21c7cba9d202259bac2e25edda5994341fe66"}, "originalPosition": 382}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDg5MzA2", "url": "https://github.com/elastic/elasticsearch/pull/60841#pullrequestreview-464489306", "createdAt": "2020-08-10T18:53:39Z", "commit": {"oid": "9ee21c7cba9d202259bac2e25edda5994341fe66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9e3de4df0b053f324a0a8600399718f67f11d11", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/f9e3de4df0b053f324a0a8600399718f67f11d11", "committedDate": "2020-08-10T18:58:06Z", "message": "Merge branch 'master' into semantic013"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "416801084c6dd5c2fc8179a4ee5f67b5a0e2dddb", "author": {"user": {"login": "jdconrad", "name": "Jack Conradson"}}, "url": "https://github.com/elastic/elasticsearch/commit/416801084c6dd5c2fc8179a4ee5f67b5a0e2dddb", "committedDate": "2020-08-10T18:59:56Z", "message": "remove extraneous semicolon"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3451, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}