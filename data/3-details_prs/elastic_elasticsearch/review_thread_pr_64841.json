{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MTI3MTYy", "number": 64841, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNzo1MDoyMFrOE5mybQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNzo1MDoyMFrOE5mybQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4ODM5Nzg5OnYy", "diffSide": "RIGHT", "path": "test/framework/src/main/java/org/elasticsearch/bootstrap/BootstrapForTesting.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNzo1MDoyMFrOH0KgEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNzo1MDoyMFrOH0KgEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ2MDA1MQ==", "bodyText": "I wonder for safety/strictness if we should change .jar to .jar!? Could also even include the path separator.", "url": "https://github.com/elastic/elasticsearch/pull/64841#discussion_r524460051", "createdAt": "2020-11-16T17:50:20Z", "author": {"login": "jaymode"}, "path": "test/framework/src/main/java/org/elasticsearch/bootstrap/BootstrapForTesting.java", "diffHunk": "@@ -234,11 +239,30 @@ private static void addClassCodebase(Map<String, URL> codebases, String name, St\n                 Assert.class.getProtectionDomain().getCodeSource().getLocation()\n         ));\n         codebases.removeAll(excluded);\n+        final Map<String, URL> codebasesMap = PolicyUtil.getCodebaseJarMap(codebases);\n \n         // parse each policy file, with codebase substitution from the classpath\n         final List<Policy> policies = new ArrayList<>(pluginPolicies.size());\n         for (URL policyFile : pluginPolicies) {\n-            policies.add(PolicyUtil.readPolicy(policyFile, PolicyUtil.getCodebaseJarMap(codebases)));\n+            Map<String, URL> policyCodebases = codebasesMap;\n+\n+            // if the codebases file is inside a jar, then we don't need to load it since the jar will\n+            // have already been read from the classpath\n+            if (policyFile.toString().contains(\".jar\") == false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5226a4ac623a1c8cfc87dc93265597412d11d1"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3045, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}