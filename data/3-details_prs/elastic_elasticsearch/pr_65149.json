{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyNTM5MjM2", "number": 65149, "title": "Add note about NFS UID and GUID requirements", "bodyText": "This seems to be a common problem with NFS snapshot repositories, a google search immediately brings up 3 discuss forums posts about snapshot repository problems and they all have to do with mismatched UID and GUID for elasticsearch user.", "createdAt": "2020-11-17T16:27:41Z", "url": "https://github.com/elastic/elasticsearch/pull/65149", "merged": true, "mergeCommit": {"oid": "5e4db2291fb71a2b69ee547ae37c7ac158d29b3e"}, "closed": true, "closedAt": "2020-11-17T19:21:19Z", "author": {"login": "TheRiffRafi"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddcF0OAH2gAyNTIyNTM5MjM2OmIzMTE2ZWM1MWUyMzczNjVjY2YzNWMwYmI4ZjdmZjViMGU5YTZiZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddeMeYgFqTUzMjY4NzE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b3116ec51e237365ccf35c0bb8f7ff5b0e9a6bf3", "author": {"user": {"login": "TheRiffRafi", "name": "Rafi Estrada"}}, "url": "https://github.com/elastic/elasticsearch/commit/b3116ec51e237365ccf35c0bb8f7ff5b0e9a6bf3", "committedDate": "2020-11-17T16:24:44Z", "message": "Add note about NFS UID and GUID requirements\n\nWhen adding a NFS repository it is necessary that the elasticsearch user UID and GUID numbers match between cluster nodes, otherwise repository verification or snapshot creation fails. A google search on this issues brings up 3 elastic discuss posts about it and all of them about the same UID GUID mismatch, so it would be a good idea to include this note in the docs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNTcyNjU4", "url": "https://github.com/elastic/elasticsearch/pull/65149#pullrequestreview-532572658", "createdAt": "2020-11-17T16:46:34Z", "commit": {"oid": "b3116ec51e237365ccf35c0bb8f7ff5b0e9a6bf3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjo0NjozNVrOH0-txw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjo0NjozNVrOH0-txw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMxNTUyNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [NOTE]\n          \n          \n            \n            ====\n          \n          \n            \n            When using NFS mounts make sure that all of the cluster nodes use the same UID and GUID numbers for the elasticsearch user, otherwise the repository verification will fail because of file permission mismatch when writing to the shared filesystem.\n          \n          \n            \n            ====\n          \n          \n            \n            \n          \n          \n            \n            IMPORTANT: If using a network file system (NFS) mount, use the same `elasticsearch`\n          \n          \n            \n            user ID (UID) and group ID (GUID) across all nodes. Otherwise, mismatched file\n          \n          \n            \n            permissions may cause write failures.", "url": "https://github.com/elastic/elasticsearch/pull/65149#discussion_r525315527", "createdAt": "2020-11-17T16:46:35Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/register-repository.asciidoc", "diffHunk": "@@ -108,7 +108,10 @@ same location on all master and data nodes. Then add the file system's\n path or parent directory to the `path.repo` setting in `elasticsearch.yml` for\n each master and data node. For running clusters, this requires a\n <<restart-cluster-rolling,rolling restart>> of each node.\n-\n+[NOTE]\n+====\n+When using NFS mounts make sure that all of the cluster nodes use the same UID and GUID numbers for the elasticsearch user, otherwise the repository verification will fail because of file permission mismatch when writing to the shared filesystem.\n+====", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3116ec51e237365ccf35c0bb8f7ff5b0e9a6bf3"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "473ce0824f7c823e2d0398de130b23c1c067802c", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/473ce0824f7c823e2d0398de130b23c1c067802c", "committedDate": "2020-11-17T16:48:12Z", "message": "Update docs/reference/snapshot-restore/register-repository.asciidoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNTc0Mzk4", "url": "https://github.com/elastic/elasticsearch/pull/65149#pullrequestreview-532574398", "createdAt": "2020-11-17T16:48:21Z", "commit": {"oid": "b3116ec51e237365ccf35c0bb8f7ff5b0e9a6bf3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjE0NzQx", "url": "https://github.com/elastic/elasticsearch/pull/65149#pullrequestreview-532614741", "createdAt": "2020-11-17T17:27:06Z", "commit": {"oid": "473ce0824f7c823e2d0398de130b23c1c067802c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNzoyNzowNlrOH1Arog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNzoyNzowNlrOH1Arog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM0Nzc0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            IMPORTANT: If using a network file system (NFS) mount, use the same `elasticsearch`\n          \n          \n            \n            user ID (UID) and group ID (GUID) across all nodes. Otherwise, mismatched file\n          \n          \n            \n            permissions may cause write failures.\n          \n          \n            \n            IMPORTANT: By default, a network file system (NFS) uses user IDs (UIDs) and\n          \n          \n            \n            group IDs (GIDs) to match accounts across nodes. If your shared file system is\n          \n          \n            \n            an NFS and your nodes don't use the same UIDs and GIDs, update your NFS\n          \n          \n            \n            configuration to account for this.", "url": "https://github.com/elastic/elasticsearch/pull/65149#discussion_r525347746", "createdAt": "2020-11-17T17:27:06Z", "author": {"login": "jrodewig"}, "path": "docs/reference/snapshot-restore/register-repository.asciidoc", "diffHunk": "@@ -109,6 +109,10 @@ path or parent directory to the `path.repo` setting in `elasticsearch.yml` for\n each master and data node. For running clusters, this requires a\n <<restart-cluster-rolling,rolling restart>> of each node.\n \n+IMPORTANT: If using a network file system (NFS) mount, use the same `elasticsearch`\n+user ID (UID) and group ID (GUID) across all nodes. Otherwise, mismatched file\n+permissions may cause write failures.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "473ce0824f7c823e2d0398de130b23c1c067802c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c3bbacd8b8fa482fd8cf416fb79b35c51a880f5", "author": {"user": {"login": "jrodewig", "name": "James Rodewig"}}, "url": "https://github.com/elastic/elasticsearch/commit/9c3bbacd8b8fa482fd8cf416fb79b35c51a880f5", "committedDate": "2020-11-17T17:27:16Z", "message": "Reword suggestion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNjg3MTky", "url": "https://github.com/elastic/elasticsearch/pull/65149#pullrequestreview-532687192", "createdAt": "2020-11-17T18:51:49Z", "commit": {"oid": "9c3bbacd8b8fa482fd8cf416fb79b35c51a880f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 980, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}