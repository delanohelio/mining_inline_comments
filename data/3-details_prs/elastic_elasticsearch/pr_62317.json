{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NjU5MDQ2", "number": 62317, "title": "Add more debugging information for cardinality agg", "bodyText": "This adds two extra bits of info to the profiler:\n\nCount of the number of different types of collectors. This lets us figure\nout if we're using the optimization for segment ordinals. It adds a few\nmore similar counters just for good measure.\nProfiles the getLeafCollector and postCollection methods. These are\nnon-trivial for some aggregations, like cardinality.", "createdAt": "2020-09-14T14:25:45Z", "url": "https://github.com/elastic/elasticsearch/pull/62317", "merged": true, "mergeCommit": {"oid": "049bca0959047a532a145b61e28175aac56bf883"}, "closed": true, "closedAt": "2020-09-15T12:49:14Z", "author": {"login": "nik9000"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHTXJXgH2gAyNDg2NjU5MDQ2OjUzMTJkZjg5YzI0ZmY5ZTgwOWE1YzdlMjliMzM3N2I0NzM0ODE3ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI3E3DgH2gAyNDg2NjU5MDQ2OmEzOGIwMjRkMmE0ODljYmQ2ZGY5YjM4Y2MxODE2ODNkNDU4OTRmZTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5312df89c24ff9e809a5c7e29b3377b473481782", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/5312df89c24ff9e809a5c7e29b3377b473481782", "committedDate": "2020-09-09T21:48:11Z", "message": "WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c80ec1444a7dcd36265c91be75c72a10fb2686b", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/9c80ec1444a7dcd36265c91be75c72a10fb2686b", "committedDate": "2020-09-09T22:06:11Z", "message": "no algo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40f4d84f373afd093f41eb65db895936f61ff516", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/40f4d84f373afd093f41eb65db895936f61ff516", "committedDate": "2020-09-09T22:08:04Z", "message": "Revert \"no algo\"\n\nThis reverts commit 9c80ec1444a7dcd36265c91be75c72a10fb2686b."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f45a29619afb3f05fc2037795f9edca8bb981a6", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/0f45a29619afb3f05fc2037795f9edca8bb981a6", "committedDate": "2020-09-10T17:30:09Z", "message": "Track collector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5abbaa946510ff06b07efbc1a50c0e8a471e562", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/d5abbaa946510ff06b07efbc1a50c0e8a471e562", "committedDate": "2020-09-14T13:51:07Z", "message": "Merge branch 'master' into hll_check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88753e14f44438c839432a5ff6896ff9484fff2e", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/88753e14f44438c839432a5ff6896ff9484fff2e", "committedDate": "2020-09-14T13:52:32Z", "message": "Drop tmp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f9a4668ee349f9f4eb4b636873ec4780380c7f0", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/3f9a4668ee349f9f4eb4b636873ec4780380c7f0", "committedDate": "2020-09-14T13:53:07Z", "message": "=0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b109f3d03c5e4f31799cffab959d3159bad07fff", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/b109f3d03c5e4f31799cffab959d3159bad07fff", "committedDate": "2020-09-14T13:53:37Z", "message": "revert * 10"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4a70614d3f571b7a868fc2b715ca1a8914ffa0f", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/a4a70614d3f571b7a868fc2b715ca1a8914ffa0f", "committedDate": "2020-09-14T13:54:53Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ce2be4e447639cb8040a6a36dd7db5f188dcf6b", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/3ce2be4e447639cb8040a6a36dd7db5f188dcf6b", "committedDate": "2020-09-14T14:24:43Z", "message": "Test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODUxMzk3", "url": "https://github.com/elastic/elasticsearch/pull/62317#pullrequestreview-487851397", "createdAt": "2020-09-14T14:51:06Z", "commit": {"oid": "3ce2be4e447639cb8040a6a36dd7db5f188dcf6b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo1MTowNlrOHRYxYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo1MTowNlrOHRYxYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5MzY5Nw==", "bodyText": "++", "url": "https://github.com/elastic/elasticsearch/pull/62317#discussion_r487993697", "createdAt": "2020-09-14T14:51:06Z", "author": {"login": "polyfractal"}, "path": "server/src/main/java/org/elasticsearch/search/aggregations/metrics/CardinalityAggregator.java", "diffHunk": "@@ -234,7 +258,7 @@ public static long memoryOverhead(long maxOrd) {\n         private final SortedSetDocValues values;\n         private final int maxOrd;\n         private final HyperLogLogPlusPlus counts;\n-        private ObjectArray<FixedBitSet> visitedOrds;\n+        private ObjectArray<FixedBitSet> visitedOrds;  // Danger! This is not tracked by BigArrays!", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ce2be4e447639cb8040a6a36dd7db5f188dcf6b"}, "originalPosition": 89}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODU2NDc3", "url": "https://github.com/elastic/elasticsearch/pull/62317#pullrequestreview-487856477", "createdAt": "2020-09-14T14:56:03Z", "commit": {"oid": "3ce2be4e447639cb8040a6a36dd7db5f188dcf6b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43051213188a6288fbea9287ebf187b889ca5e78", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/43051213188a6288fbea9287ebf187b889ca5e78", "committedDate": "2020-09-14T16:47:50Z", "message": "bwc, how I love you"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a38b024d2a489cbd6df9b38cc181683d45894fe6", "author": {"user": {"login": "nik9000", "name": "Nik Everett"}}, "url": "https://github.com/elastic/elasticsearch/commit/a38b024d2a489cbd6df9b38cc181683d45894fe6", "committedDate": "2020-09-14T17:58:43Z", "message": "runtime fields don't have ords"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4592, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}