{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1ODkzMjU0", "number": 53322, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMDozOVrODnGH6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMzoyN1rODnGMww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMzIxMzg3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/identity-provider/src/main/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMDozOVrOF05C6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMDozOVrOF05C6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAwNDkwNA==", "bodyText": "Should we also handle refresh policy here ( pass the one from the request ) ?", "url": "https://github.com/elastic/elasticsearch/pull/53322#discussion_r391004904", "createdAt": "2020-03-11T14:20:39Z", "author": {"login": "jkakavas"}, "path": "x-pack/plugin/identity-provider/src/main/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndex.java", "diffHunk": "@@ -214,6 +216,17 @@ private boolean isTemplateUpToDate(ClusterState state) {\n         return TemplateUtils.checkTemplateExistsAndIsUpToDate(TEMPLATE_NAME, TEMPLATE_META_VERSION_KEY, state, logger);\n     }\n \n+    public void deleteDocument(DocumentVersion version, ActionListener<DeleteResponse> listener) {\n+        final DeleteRequest request = new DeleteRequest(aliasExists ? ALIAS_NAME : INDEX_NAME)\n+            .id(version.id)\n+            .setIfSeqNo(version.seqNo)\n+            .setIfPrimaryTerm(version.primaryTerm);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6d1f31413ac98f5bc406d8b1d7c6f864abd75b"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMzIyNjI3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/identity-provider/src/main/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndex.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMzoyN1rOF05LDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDoyMzoyN1rOF05LDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAwNjk4OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        logger.debug(\"Deleteed service provider document [{}] ({})\", version.id, response.getResult());\n          \n          \n            \n                        logger.debug(\"Deleted service provider document [{}] ({})\", version.id, response.getResult());", "url": "https://github.com/elastic/elasticsearch/pull/53322#discussion_r391006988", "createdAt": "2020-03-11T14:23:27Z", "author": {"login": "jkakavas"}, "path": "x-pack/plugin/identity-provider/src/main/java/org/elasticsearch/xpack/idp/saml/sp/SamlServiceProviderIndex.java", "diffHunk": "@@ -214,6 +216,17 @@ private boolean isTemplateUpToDate(ClusterState state) {\n         return TemplateUtils.checkTemplateExistsAndIsUpToDate(TEMPLATE_NAME, TEMPLATE_META_VERSION_KEY, state, logger);\n     }\n \n+    public void deleteDocument(DocumentVersion version, ActionListener<DeleteResponse> listener) {\n+        final DeleteRequest request = new DeleteRequest(aliasExists ? ALIAS_NAME : INDEX_NAME)\n+            .id(version.id)\n+            .setIfSeqNo(version.seqNo)\n+            .setIfPrimaryTerm(version.primaryTerm);\n+        client.delete(request, ActionListener.wrap(response -> {\n+            logger.debug(\"Deleteed service provider document [{}] ({})\", version.id, response.getResult());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6d1f31413ac98f5bc406d8b1d7c6f864abd75b"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3383, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}