{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MzQ1ODk3", "number": 60870, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDoxNjo1NVrOEgJCvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDoyMDoxOFrOEgJIPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTM4MDQ1OnYy", "diffSide": "RIGHT", "path": "docs/reference/mapping/dynamic/templates.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDoxNjo1NVrOHM1_nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDoxNjo1NVrOHM1_nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIyOTU5Ng==", "bodyText": "I think we generally capitalize JSON in the docs.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              error is returned at index time. It is recommended to configure the `match_mapping_type` to the expected json type or\n          \n          \n            \n              error is returned at index time. It is recommended to configure the `match_mapping_type` to the expected JSON type or", "url": "https://github.com/elastic/elasticsearch/pull/60870#discussion_r483229596", "createdAt": "2020-09-03T20:16:55Z", "author": {"login": "danhermann"}, "path": "docs/reference/mapping/dynamic/templates.asciidoc", "diffHunk": "@@ -38,15 +38,16 @@ Dynamic templates are specified as an array of named objects:\n <3> The mapping that the matched field should use.\n \n If a provided mapping contains an invalid mapping snippet, a validation error\n-is returned. Validation occurs when applying the dynamic template at index time, \n-and, in most cases, when the dynamic template is updated. Providing an invalid mapping \n+is returned. Validation occurs when applying the dynamic template at index time,\n+and, in most cases, when the dynamic template is updated. Providing an invalid mapping\n snippet may cause the update or validation of a dynamic template to fail under certain conditions:\n \n-* If no `match_mapping_type` has been specified but the template is valid for at least one predefined mapping type, \n-  the mapping snippet is considered valid. However, a validation error is returned at index time if a field matching \n-  the template is indexed as a different type. For example, configuring a dynamic template with no `match_mapping_type` \n-  is considered valid as string type, but if a field matching the dynamic template is indexed as a long, a validation \n-  error is returned at index time.\n+* If no `match_mapping_type` has been specified but the template is valid for at least one predefined mapping type,\n+  the mapping snippet is considered valid. However, a validation error is returned at index time if a field matching\n+  the template is indexed as a different type. For example, configuring a dynamic template with no `match_mapping_type`\n+  is considered valid as string type, but if a field matching the dynamic template is indexed as a long, a validation\n+  error is returned at index time. It is recommended to configure the `match_mapping_type` to the expected json type or", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97fa14f359e400fcdce3f70c8ac3f7bfdfd56608"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTM5NDU1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/RootObjectMapper.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDoyMDoxOFrOHM2Ihw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMjo0MTo0OVrOHx5Cdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIzMTg3OQ==", "bodyText": "Don't error messages usually use square brackets around values rather than names? In other words, should there be square brackets around match_mapping_type?", "url": "https://github.com/elastic/elasticsearch/pull/60870#discussion_r483231879", "createdAt": "2020-09-03T20:20:18Z", "author": {"login": "danhermann"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/RootObjectMapper.java", "diffHunk": "@@ -408,14 +409,16 @@ private static void validateDynamicTemplate(Mapper.TypeParser.ParserContext pars\n \n         final boolean failInvalidDynamicTemplates = parserContext.indexVersionCreated().onOrAfter(Version.V_8_0_0);\n         if (dynamicTemplateInvalid) {\n-            String message = String.format(Locale.ROOT, \"dynamic template [%s] has invalid content [%s]\",\n-                dynamicTemplate.getName(), Strings.toString(dynamicTemplate));\n+            String format = \"dynamic template [%s] has invalid content [%s], \" +\n+                \"attempted to validate it with the following [match_mapping_type]: [%s]\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97fa14f359e400fcdce3f70c8ac3f7bfdfd56608"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA3Njc5MQ==", "bodyText": "You're right, I don't think so.", "url": "https://github.com/elastic/elasticsearch/pull/60870#discussion_r522076791", "createdAt": "2020-11-12T12:41:49Z", "author": {"login": "martijnvg"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/RootObjectMapper.java", "diffHunk": "@@ -408,14 +409,16 @@ private static void validateDynamicTemplate(Mapper.TypeParser.ParserContext pars\n \n         final boolean failInvalidDynamicTemplates = parserContext.indexVersionCreated().onOrAfter(Version.V_8_0_0);\n         if (dynamicTemplateInvalid) {\n-            String message = String.format(Locale.ROOT, \"dynamic template [%s] has invalid content [%s]\",\n-                dynamicTemplate.getName(), Strings.toString(dynamicTemplate));\n+            String format = \"dynamic template [%s] has invalid content [%s], \" +\n+                \"attempted to validate it with the following [match_mapping_type]: [%s]\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIzMTg3OQ=="}, "originalCommit": {"oid": "97fa14f359e400fcdce3f70c8ac3f7bfdfd56608"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2508, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}