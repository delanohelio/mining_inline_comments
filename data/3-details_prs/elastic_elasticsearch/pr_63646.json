{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzMTA5Mjky", "number": 63646, "title": "Remove Redundant Cluster State Update Response Classes", "bodyText": "These intermediary response types don't contain any information\noutside of what the shard acknowledged and acknowledged responses\ncontain so this PR removes them.\nAlso, it adds three constants for the three possible states of\nShardsAcknowledgedResponse.\nFollow up to #63335", "createdAt": "2020-10-14T05:06:32Z", "url": "https://github.com/elastic/elasticsearch/pull/63646", "merged": true, "mergeCommit": {"oid": "d904d48e8ddbea1f9f8e251fa539da5f4a34476b"}, "closed": true, "closedAt": "2020-11-03T20:48:19Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSV7ydgH2gAyNTAzMTA5MjkyOjg5ZTYyMWFiMmI5NzI3NDU4MTMyMmFiMGJlNmM0YTgxNTYwODAwYTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY-aAKAFqTUyMjgxNDI5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "89e621ab2b97274581322ab0be6c4a81560800a7", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/89e621ab2b97274581322ab0be6c4a81560800a7", "committedDate": "2020-10-14T05:01:11Z", "message": "Remove Redundant Cluster State Update Response Classes\n\nThese intermediary response types don't contain any information\noutside of what the shard acknowledged and acknowledged responses\ncontain so this PR removes them.\nAlso, it adds three constants for the three possible states of\n`ShardsAcknowledgedResponse`.\n\nFollow up to #63335"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNjY5MTE3", "url": "https://github.com/elastic/elasticsearch/pull/63646#pullrequestreview-510669117", "createdAt": "2020-10-16T17:30:40Z", "commit": {"oid": "89e621ab2b97274581322ab0be6c4a81560800a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxNzozMDo0MFrOHjJs3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxNzozMDo0MFrOHjJs3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYyMTE0OA==", "bodyText": "Please let's not use the term \"simple\". Why isn't this just part of AckedClusterStateUpdateTask?", "url": "https://github.com/elastic/elasticsearch/pull/63646#discussion_r506621148", "createdAt": "2020-10-16T17:30:40Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/SimpleAckedStateUpdateTask.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.cluster;\n+\n+import org.elasticsearch.action.ActionListener;\n+import org.elasticsearch.action.support.master.AcknowledgedResponse;\n+import org.elasticsearch.cluster.ack.AckedRequest;\n+import org.elasticsearch.common.Priority;\n+\n+/**\n+ * {@link AckedClusterStateUpdateTask} that responds with a plain {@link AcknowledgedResponse}.\n+ */\n+public abstract class SimpleAckedStateUpdateTask extends AckedClusterStateUpdateTask<AcknowledgedResponse> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89e621ab2b97274581322ab0be6c4a81560800a7"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c208148018eb671b4f1ddc79b5daf5dd0579feb", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/6c208148018eb671b4f1ddc79b5daf5dd0579feb", "committedDate": "2020-10-16T19:18:48Z", "message": "Merge remote-tracking branch 'elastic/master' into singleton-ack-cs-resp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "996b5825e685f4faa471a8cb4018f37cd433cd77", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/996b5825e685f4faa471a8cb4018f37cd433cd77", "committedDate": "2020-10-16T19:49:45Z", "message": "CR: simpler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDU1NzI4", "url": "https://github.com/elastic/elasticsearch/pull/63646#pullrequestreview-515055728", "createdAt": "2020-10-22T19:34:38Z", "commit": {"oid": "996b5825e685f4faa471a8cb4018f37cd433cd77"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTozNDozOFrOHmw1nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTozNDozOFrOHmw1nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQwODA5Mw==", "bodyText": "I don't think this cast should be necessary. If we are saying all response classes for AckedClusterStateUpdateTask should be an AcknowledgedResponse, then why is it a generic? Should the generic be extending AcknowledgedResponse?", "url": "https://github.com/elastic/elasticsearch/pull/63646#discussion_r510408093", "createdAt": "2020-10-22T19:34:38Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/AckedClusterStateUpdateTask.java", "diffHunk": "@@ -64,8 +65,10 @@ public void onAllNodesAcked(@Nullable Exception e) {\n         listener.onResponse(newResponse(e == null));\n     }\n \n-    protected abstract Response newResponse(boolean acknowledged);\n-\n+    @SuppressWarnings(\"unchecked\")\n+    protected Response newResponse(boolean acknowledged) {\n+        return (Response) AcknowledgedResponse.of(acknowledged);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "996b5825e685f4faa471a8cb4018f37cd433cd77"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73740c2152d07afc3835377daa7b89d7983e5d0c", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/73740c2152d07afc3835377daa7b89d7983e5d0c", "committedDate": "2020-10-23T15:44:10Z", "message": "Merge remote-tracking branch 'elastic/master' into singleton-ack-cs-resp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea76fae421f7f65310cf29c449b7a5918e87247c", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/ea76fae421f7f65310cf29c449b7a5918e87247c", "committedDate": "2020-10-29T07:49:43Z", "message": "Merge remote-tracking branch 'elastic/master' into singleton-ack-cs-resp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "926442ce81b97820b57fbe5712e645a3ab64275e", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/926442ce81b97820b57fbe5712e645a3ab64275e", "committedDate": "2020-10-29T08:44:17Z", "message": "constrain type more"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb2210c364301257be4fb7ce627546c704dcb151", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/eb2210c364301257be4fb7ce627546c704dcb151", "committedDate": "2020-11-03T15:22:28Z", "message": "Merge remote-tracking branch 'elastic/master' into singleton-ack-cs-resp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ca8862564b95e2facc354970913bec2e4e75027", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/8ca8862564b95e2facc354970913bec2e4e75027", "committedDate": "2020-11-03T16:58:58Z", "message": "drop generic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODE0Mjk3", "url": "https://github.com/elastic/elasticsearch/pull/63646#pullrequestreview-522814297", "createdAt": "2020-11-03T19:31:46Z", "commit": {"oid": "8ca8862564b95e2facc354970913bec2e4e75027"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxOTozMTo0N1rOHs9hhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxOTozMTo0N1rOHs9hhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkwNzM5Ng==", "bodyText": "We could use ? extends here as well so a cast is not necessary?", "url": "https://github.com/elastic/elasticsearch/pull/63646#discussion_r516907396", "createdAt": "2020-11-03T19:31:47Z", "author": {"login": "rjernst"}, "path": "server/src/main/java/org/elasticsearch/cluster/AckedClusterStateUpdateTask.java", "diffHunk": "@@ -29,18 +30,20 @@\n  * An extension interface to {@link ClusterStateUpdateTask} that allows to be notified when\n  * all the nodes have acknowledged a cluster state update request\n  */\n-public abstract class AckedClusterStateUpdateTask<Response> extends ClusterStateUpdateTask implements AckedClusterStateTaskListener {\n+public abstract class AckedClusterStateUpdateTask extends ClusterStateUpdateTask implements AckedClusterStateTaskListener {\n \n-    private final ActionListener<Response> listener;\n+    private final ActionListener<AcknowledgedResponse> listener;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ca8862564b95e2facc354970913bec2e4e75027"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4154, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}