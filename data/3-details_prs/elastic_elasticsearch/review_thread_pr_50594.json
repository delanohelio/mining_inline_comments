{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTUyMjc3", "number": 50594, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDowMzozOVrODV-v3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDowNDozNlrODV-wpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0Mzc0NzQ5OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDowMzozOVrOFaeaLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDowOToyNVrOFaej2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwNTUxOQ==", "bodyText": "Why not Version.V_8_0_0.major? :)", "url": "https://github.com/elastic/elasticsearch/pull/50594#discussion_r363305519", "createdAt": "2020-01-06T14:03:39Z", "author": {"login": "original-brownbear"}, "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java", "diffHunk": "@@ -92,10 +87,9 @@ protected void documentation(StringBuilder sb) {\n     public RestChannelConsumer doCatRequest(final RestRequest request, final NodeClient client) {\n         final ClusterStateRequest clusterStateRequest = new ClusterStateRequest();\n         clusterStateRequest.clear().nodes(true);\n-        if (request.hasParam(\"local\")) {\n-            deprecationLogger.deprecated(LOCAL_DEPRECATED_MESSAGE);\n+        if (request.hasParam(\"local\") && Version.CURRENT.major == Version.V_7_0_0.major + 1) { // only needed in v8 to catch breaking usages", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80f0241d8d7f706b08014f78c058c051306bc316"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwNzk5Mw==", "bodyText": "So we get a compile error when we move to v9 and drop the v7 version constants.", "url": "https://github.com/elastic/elasticsearch/pull/50594#discussion_r363307993", "createdAt": "2020-01-06T14:09:25Z", "author": {"login": "DaveCTurner"}, "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestNodesAction.java", "diffHunk": "@@ -92,10 +87,9 @@ protected void documentation(StringBuilder sb) {\n     public RestChannelConsumer doCatRequest(final RestRequest request, final NodeClient client) {\n         final ClusterStateRequest clusterStateRequest = new ClusterStateRequest();\n         clusterStateRequest.clear().nodes(true);\n-        if (request.hasParam(\"local\")) {\n-            deprecationLogger.deprecated(LOCAL_DEPRECATED_MESSAGE);\n+        if (request.hasParam(\"local\") && Version.CURRENT.major == Version.V_7_0_0.major + 1) { // only needed in v8 to catch breaking usages", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwNTUxOQ=="}, "originalCommit": {"oid": "80f0241d8d7f706b08014f78c058c051306bc316"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0Mzc0OTQ5OnYy", "diffSide": "RIGHT", "path": "server/src/test/java/org/elasticsearch/rest/action/cat/RestNodesActionTests.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDowNDozNlrOFaebZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxNDoxMToyMVrOFaemzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwNTgyOQ==", "bodyText": "Wouldn't we want to assertTrue here so that this starts failing on the version bump and we can remove it instaed of having it live on as dead code in a skipped test?", "url": "https://github.com/elastic/elasticsearch/pull/50594#discussion_r363305829", "createdAt": "2020-01-06T14:04:36Z", "author": {"login": "original-brownbear"}, "path": "server/src/test/java/org/elasticsearch/rest/action/cat/RestNodesActionTests.java", "diffHunk": "@@ -69,15 +70,14 @@ public void testBuildTableDoesNotThrowGivenNullNodeInfoAndStats() {\n         action.buildTable(false, new FakeRestRequest(), clusterStateResponse, nodesInfoResponse, nodesStatsResponse);\n     }\n \n-    public void testCatNodesWithLocalDeprecationWarning() {\n+    public void testCatNodesRejectsLocalParameter() {\n+        assumeTrue(\"test is only needed in v8, can be removed in v9\", Version.CURRENT.major == Version.V_7_0_0.major + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80f0241d8d7f706b08014f78c058c051306bc316"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwODc0OQ==", "bodyText": "I figured we could defer this until we drop the v7 version constants, which normally happens some time after moving to v9. The compile error from Version.V_7_0_0.major  will limit how long this lives.", "url": "https://github.com/elastic/elasticsearch/pull/50594#discussion_r363308749", "createdAt": "2020-01-06T14:11:21Z", "author": {"login": "DaveCTurner"}, "path": "server/src/test/java/org/elasticsearch/rest/action/cat/RestNodesActionTests.java", "diffHunk": "@@ -69,15 +70,14 @@ public void testBuildTableDoesNotThrowGivenNullNodeInfoAndStats() {\n         action.buildTable(false, new FakeRestRequest(), clusterStateResponse, nodesInfoResponse, nodesStatsResponse);\n     }\n \n-    public void testCatNodesWithLocalDeprecationWarning() {\n+    public void testCatNodesRejectsLocalParameter() {\n+        assumeTrue(\"test is only needed in v8, can be removed in v9\", Version.CURRENT.major == Version.V_7_0_0.major + 1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzMwNTgyOQ=="}, "originalCommit": {"oid": "80f0241d8d7f706b08014f78c058c051306bc316"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4962, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}