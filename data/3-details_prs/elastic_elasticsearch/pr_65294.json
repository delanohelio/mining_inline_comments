{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MzkwNDYy", "number": 65294, "title": "Remove unnecessary method AbstractFieldScript#getSource.", "bodyText": "Previously it looked like _source was exposed as a top-level parameter in\nruntime field scripts. The method is only used in tests and can be removed\naltogether.", "createdAt": "2020-11-20T03:56:04Z", "url": "https://github.com/elastic/elasticsearch/pull/65294", "merged": true, "mergeCommit": {"oid": "509f1d117dc4ac749c11420f2dbe19debdf6867f"}, "closed": true, "closedAt": "2020-11-23T03:51:46Z", "author": {"login": "jtibshirani"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeO_23gH2gAyNTI0MzkwNDYyOjk4OTBjNGFlNGYzYjNiNWUzNTdkMGU4NjdhMTlmYTUxYjI1ZTY4ZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfB7NgAFqTUzNjA3MDQyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9890c4ae4f3b3b5e357d0e867a19fa51b25e68e9", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/9890c4ae4f3b3b5e357d0e867a19fa51b25e68e9", "committedDate": "2020-11-20T03:43:23Z", "message": "Correct some javadoc on AbstractFieldScript."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1Mjc0MDA1", "url": "https://github.com/elastic/elasticsearch/pull/65294#pullrequestreview-535274005", "createdAt": "2020-11-20T09:46:14Z", "commit": {"oid": "9890c4ae4f3b3b5e357d0e867a19fa51b25e68e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOTo0NjoxNFrOH3IaSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOTo0NjoxNFrOH3IaSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU3MTUzMQ==", "bodyText": "Do we actually need this method at all?  All the tests that call it also have access to the leafSearchLookup object so they could just use that?", "url": "https://github.com/elastic/elasticsearch/pull/65294#discussion_r527571531", "createdAt": "2020-11-20T09:46:14Z", "author": {"login": "romseygeek"}, "path": "x-pack/plugin/runtime-fields/src/main/java/org/elasticsearch/xpack/runtimefields/mapper/AbstractFieldScript.java", "diffHunk": "@@ -88,17 +88,17 @@ public final void setDocument(int docId) {\n     }\n \n     /**\n-     * Expose the {@code _source} to the script.\n+     * Expose field data to the script as {@code doc}.\n      */\n-    protected final Map<String, Object> getSource() {\n-        return leafSearchLookup.source();\n+    public final Map<String, ScriptDocValues<?>> getDoc() {\n+        return leafSearchLookup.doc();\n     }\n \n     /**\n-     * Expose field data to the script as {@code doc}.\n+     * A non-public convenience method that's used in testing.\n      */\n-    public final Map<String, ScriptDocValues<?>> getDoc() {\n-        return leafSearchLookup.doc();\n+    protected final Map<String, Object> getSource() {\n+        return leafSearchLookup.source();\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9890c4ae4f3b3b5e357d0e867a19fa51b25e68e9"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "770d1bf8ab0a714d2697f022a4298922dce7d1cc", "author": {"user": {"login": "jtibshirani", "name": "Julie Tibshirani"}}, "url": "https://github.com/elastic/elasticsearch/commit/770d1bf8ab0a714d2697f022a4298922dce7d1cc", "committedDate": "2020-11-20T18:06:33Z", "message": "Remove AbstractFieldScript#getSource altogether."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDcwNDIw", "url": "https://github.com/elastic/elasticsearch/pull/65294#pullrequestreview-536070420", "createdAt": "2020-11-22T15:03:28Z", "commit": {"oid": "770d1bf8ab0a714d2697f022a4298922dce7d1cc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 896, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}