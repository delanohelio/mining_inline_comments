{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwMjkxMDQw", "number": 66349, "reviewThreads": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyMTo0MlrOFGR1HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMToxN1rOFHQNug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI3OTAwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyMTo0MlrOIHNrsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowMjozOVrOIIgRdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNTEyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    parser.declareObjectArray(ConstructingObjectParser.constructorArg(),\n          \n          \n            \n                    parser.declareObjectArray(ConstructingObjectParser.optionalConstructorArg(),\n          \n      \n    \n    \n  \n\nThis should always be optional as older models could exist in the index that don't have this field.", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544435120", "createdAt": "2020-12-16T16:21:42Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -38,14 +39,18 @@\n     private static ConstructingObjectParser<TrainedModelMetadata, Void> createParser(boolean ignoreUnknownFields) {\n         ConstructingObjectParser<TrainedModelMetadata, Void> parser = new ConstructingObjectParser<>(NAME,\n             ignoreUnknownFields,\n-            a -> new TrainedModelMetadata((String)a[0], (List<TotalFeatureImportance>)a[1], (FeatureImportanceBaseline)a[2]));\n+            a -> new TrainedModelMetadata((String)a[0], (List<TotalFeatureImportance>)a[1], (FeatureImportanceBaseline)a[2], \n+                                          (List<Hyperparameters>)a[3]));\n         parser.declareString(ConstructingObjectParser.constructorArg(), MODEL_ID);\n         parser.declareObjectArray(ConstructingObjectParser.constructorArg(),\n             ignoreUnknownFields ? TotalFeatureImportance.LENIENT_PARSER : TotalFeatureImportance.STRICT_PARSER,\n             TOTAL_FEATURE_IMPORTANCE);\n         parser.declareObject(ConstructingObjectParser.optionalConstructorArg(),\n             ignoreUnknownFields ? FeatureImportanceBaseline.LENIENT_PARSER : FeatureImportanceBaseline.STRICT_PARSER,\n             FEATURE_IMPORTANCE_BASELINE);\n+        parser.declareObjectArray(ConstructingObjectParser.constructorArg(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4ODI3OA==", "bodyText": "Fixed", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545788278", "createdAt": "2020-12-18T12:02:39Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -38,14 +39,18 @@\n     private static ConstructingObjectParser<TrainedModelMetadata, Void> createParser(boolean ignoreUnknownFields) {\n         ConstructingObjectParser<TrainedModelMetadata, Void> parser = new ConstructingObjectParser<>(NAME,\n             ignoreUnknownFields,\n-            a -> new TrainedModelMetadata((String)a[0], (List<TotalFeatureImportance>)a[1], (FeatureImportanceBaseline)a[2]));\n+            a -> new TrainedModelMetadata((String)a[0], (List<TotalFeatureImportance>)a[1], (FeatureImportanceBaseline)a[2], \n+                                          (List<Hyperparameters>)a[3]));\n         parser.declareString(ConstructingObjectParser.constructorArg(), MODEL_ID);\n         parser.declareObjectArray(ConstructingObjectParser.constructorArg(),\n             ignoreUnknownFields ? TotalFeatureImportance.LENIENT_PARSER : TotalFeatureImportance.STRICT_PARSER,\n             TOTAL_FEATURE_IMPORTANCE);\n         parser.declareObject(ConstructingObjectParser.optionalConstructorArg(),\n             ignoreUnknownFields ? FeatureImportanceBaseline.LENIENT_PARSER : FeatureImportanceBaseline.STRICT_PARSER,\n             FEATURE_IMPORTANCE_BASELINE);\n+        parser.declareObjectArray(ConstructingObjectParser.constructorArg(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNTEyMA=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI4MjM3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyMjoxNlrOIHNtjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowODoxMVrOIIgbGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNTU5Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.hyperparameters = Collections.unmodifiableList(hyperparameters);\n          \n          \n            \n                    this.hyperparameters = hyperparameters == null ? Collections.emptyList() : Collections.unmodifiableList(hyperparameters);", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544435596", "createdAt": "2020-12-16T16:22:16Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -63,20 +68,25 @@ public static String modelId(String docId) {\n \n     private final List<TotalFeatureImportance> totalFeatureImportances;\n     private final FeatureImportanceBaseline featureImportanceBaselines;\n+    private final List<Hyperparameters> hyperparameters;\n     private final String modelId;\n \n     public TrainedModelMetadata(StreamInput in) throws IOException {\n         this.modelId = in.readString();\n         this.totalFeatureImportances = in.readList(TotalFeatureImportance::new);\n         this.featureImportanceBaselines = in.readOptionalWriteable(FeatureImportanceBaseline::new);\n+        this.hyperparameters = in.readList(Hyperparameters::new);\n     }\n \n     public TrainedModelMetadata(String modelId,\n                                 List<TotalFeatureImportance> totalFeatureImportances,\n-                                FeatureImportanceBaseline featureImportanceBaselines) {\n+                                FeatureImportanceBaseline featureImportanceBaselines,\n+                                List<Hyperparameters> hyperparameters) {\n         this.modelId = ExceptionsHelper.requireNonNull(modelId, MODEL_ID);\n         this.totalFeatureImportances = Collections.unmodifiableList(totalFeatureImportances);\n         this.featureImportanceBaselines = featureImportanceBaselines;\n+        this.hyperparameters = Collections.unmodifiableList(hyperparameters);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc5MDc0NA==", "bodyText": "fixed", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545790744", "createdAt": "2020-12-18T12:08:11Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -63,20 +68,25 @@ public static String modelId(String docId) {\n \n     private final List<TotalFeatureImportance> totalFeatureImportances;\n     private final FeatureImportanceBaseline featureImportanceBaselines;\n+    private final List<Hyperparameters> hyperparameters;\n     private final String modelId;\n \n     public TrainedModelMetadata(StreamInput in) throws IOException {\n         this.modelId = in.readString();\n         this.totalFeatureImportances = in.readList(TotalFeatureImportance::new);\n         this.featureImportanceBaselines = in.readOptionalWriteable(FeatureImportanceBaseline::new);\n+        this.hyperparameters = in.readList(Hyperparameters::new);\n     }\n \n     public TrainedModelMetadata(String modelId,\n                                 List<TotalFeatureImportance> totalFeatureImportances,\n-                                FeatureImportanceBaseline featureImportanceBaselines) {\n+                                FeatureImportanceBaseline featureImportanceBaselines,\n+                                List<Hyperparameters> hyperparameters) {\n         this.modelId = ExceptionsHelper.requireNonNull(modelId, MODEL_ID);\n         this.totalFeatureImportances = Collections.unmodifiableList(totalFeatureImportances);\n         this.featureImportanceBaselines = featureImportanceBaselines;\n+        this.hyperparameters = Collections.unmodifiableList(hyperparameters);\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNTU5Ng=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI4OTU0OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadataTests.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyMzo0MlrOIHNxxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowMzozN1rOIIgTDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNjY3OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        Stream.generate(HyperparametersTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()));\n          \n          \n            \n                        randomBoolean() ? null :  Stream.generate(HyperparametersTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()));", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544436678", "createdAt": "2020-12-16T16:23:42Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadataTests.java", "diffHunk": "@@ -24,7 +24,8 @@ public static TrainedModelMetadata randomInstance() {\n         return new TrainedModelMetadata(\n             randomAlphaOfLength(10),\n             Stream.generate(TotalFeatureImportanceTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()),\n-            randomBoolean() ? null : FeatureImportanceBaselineTests.randomInstance());\n+            randomBoolean() ? null : FeatureImportanceBaselineTests.randomInstance(), \n+            Stream.generate(HyperparametersTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4ODY4NA==", "bodyText": "fixed", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545788684", "createdAt": "2020-12-18T12:03:37Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadataTests.java", "diffHunk": "@@ -24,7 +24,8 @@ public static TrainedModelMetadata randomInstance() {\n         return new TrainedModelMetadata(\n             randomAlphaOfLength(10),\n             Stream.generate(TotalFeatureImportanceTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()),\n-            randomBoolean() ? null : FeatureImportanceBaselineTests.randomInstance());\n+            randomBoolean() ? null : FeatureImportanceBaselineTests.randomInstance(), \n+            Stream.generate(HyperparametersTests::randomInstance).limit(randomIntBetween(1, 10)).collect(Collectors.toList()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNjY3OA=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI5MjIzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyNDowOVrOIHNzTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyNDowOVrOIHNzTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNzA3MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544437070", "createdAt": "2020-12-16T16:24:09Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -24,23 +25,29 @@\n \n     public static final ParseField TOTAL_FEATURE_IMPORTANCE = new ParseField(\"total_feature_importance\");\n     public static final ParseField FEATURE_IMPORTANCE_BASELINE = new ParseField(\"feature_importance_baseline\");\n+    public static final ParseField HYPERPARAMETERS = new ParseField(\"hyperparameters\");\n \n     @SuppressWarnings(\"unchecked\")\n     public static final ConstructingObjectParser<ModelMetadata, Void> PARSER = new ConstructingObjectParser<>(\n         \"trained_model_metadata\",\n-        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1]));\n+        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1], (List<Hyperparameters>) a[2]));\n \n     static {\n         PARSER.declareObjectArray(constructorArg(), TotalFeatureImportance.STRICT_PARSER, TOTAL_FEATURE_IMPORTANCE);\n         PARSER.declareObject(optionalConstructorArg(), FeatureImportanceBaseline.STRICT_PARSER, FEATURE_IMPORTANCE_BASELINE);\n+        PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI5NTkzOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyNDo0NVrOIHN1fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowNjo0OVrOIIgYqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNzYzMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public ModelMetadata(List<TotalFeatureImportance> featureImportances, FeatureImportanceBaseline featureImportanceBaseline, \n          \n          \n            \n                List<Hyperparameters> hyperparameters) {\n          \n          \n            \n                public ModelMetadata(List<TotalFeatureImportance> featureImportances, \n          \n          \n            \n                    FeatureImportanceBaseline featureImportanceBaseline, \n          \n          \n            \n                    List<Hyperparameters> hyperparameters) {", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544437630", "createdAt": "2020-12-16T16:24:45Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -24,23 +25,29 @@\n \n     public static final ParseField TOTAL_FEATURE_IMPORTANCE = new ParseField(\"total_feature_importance\");\n     public static final ParseField FEATURE_IMPORTANCE_BASELINE = new ParseField(\"feature_importance_baseline\");\n+    public static final ParseField HYPERPARAMETERS = new ParseField(\"hyperparameters\");\n \n     @SuppressWarnings(\"unchecked\")\n     public static final ConstructingObjectParser<ModelMetadata, Void> PARSER = new ConstructingObjectParser<>(\n         \"trained_model_metadata\",\n-        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1]));\n+        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1], (List<Hyperparameters>) a[2]));\n \n     static {\n         PARSER.declareObjectArray(constructorArg(), TotalFeatureImportance.STRICT_PARSER, TOTAL_FEATURE_IMPORTANCE);\n         PARSER.declareObject(optionalConstructorArg(), FeatureImportanceBaseline.STRICT_PARSER, FEATURE_IMPORTANCE_BASELINE);\n+        PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);\n+\n     }\n \n     private final List<TotalFeatureImportance> featureImportances;\n     private final FeatureImportanceBaseline featureImportanceBaseline;\n+    private final List<Hyperparameters> hyperparameters;\n \n-    public ModelMetadata(List<TotalFeatureImportance> featureImportances, FeatureImportanceBaseline featureImportanceBaseline) {\n+    public ModelMetadata(List<TotalFeatureImportance> featureImportances, FeatureImportanceBaseline featureImportanceBaseline, \n+    List<Hyperparameters> hyperparameters) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc5MDEyMQ==", "bodyText": "I don't see the change here. Is this a formatting issue?", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545790121", "createdAt": "2020-12-18T12:06:49Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -24,23 +25,29 @@\n \n     public static final ParseField TOTAL_FEATURE_IMPORTANCE = new ParseField(\"total_feature_importance\");\n     public static final ParseField FEATURE_IMPORTANCE_BASELINE = new ParseField(\"feature_importance_baseline\");\n+    public static final ParseField HYPERPARAMETERS = new ParseField(\"hyperparameters\");\n \n     @SuppressWarnings(\"unchecked\")\n     public static final ConstructingObjectParser<ModelMetadata, Void> PARSER = new ConstructingObjectParser<>(\n         \"trained_model_metadata\",\n-        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1]));\n+        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1], (List<Hyperparameters>) a[2]));\n \n     static {\n         PARSER.declareObjectArray(constructorArg(), TotalFeatureImportance.STRICT_PARSER, TOTAL_FEATURE_IMPORTANCE);\n         PARSER.declareObject(optionalConstructorArg(), FeatureImportanceBaseline.STRICT_PARSER, FEATURE_IMPORTANCE_BASELINE);\n+        PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);\n+\n     }\n \n     private final List<TotalFeatureImportance> featureImportances;\n     private final FeatureImportanceBaseline featureImportanceBaseline;\n+    private final List<Hyperparameters> hyperparameters;\n \n-    public ModelMetadata(List<TotalFeatureImportance> featureImportances, FeatureImportanceBaseline featureImportanceBaseline) {\n+    public ModelMetadata(List<TotalFeatureImportance> featureImportances, FeatureImportanceBaseline featureImportanceBaseline, \n+    List<Hyperparameters> hyperparameters) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzNzYzMA=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTI5OTYxOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyNTozMFrOIHN3sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowNToyNVrOIIgWIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzODE5Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);\n          \n          \n            \n                    PARSER.declareObjectArray(optionalConstructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);\n          \n      \n    \n    \n  \n\nThis can be non-optional once the c++ side is done.", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544438192", "createdAt": "2020-12-16T16:25:30Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -24,23 +25,29 @@\n \n     public static final ParseField TOTAL_FEATURE_IMPORTANCE = new ParseField(\"total_feature_importance\");\n     public static final ParseField FEATURE_IMPORTANCE_BASELINE = new ParseField(\"feature_importance_baseline\");\n+    public static final ParseField HYPERPARAMETERS = new ParseField(\"hyperparameters\");\n \n     @SuppressWarnings(\"unchecked\")\n     public static final ConstructingObjectParser<ModelMetadata, Void> PARSER = new ConstructingObjectParser<>(\n         \"trained_model_metadata\",\n-        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1]));\n+        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1], (List<Hyperparameters>) a[2]));\n \n     static {\n         PARSER.declareObjectArray(constructorArg(), TotalFeatureImportance.STRICT_PARSER, TOTAL_FEATURE_IMPORTANCE);\n         PARSER.declareObject(optionalConstructorArg(), FeatureImportanceBaseline.STRICT_PARSER, FEATURE_IMPORTANCE_BASELINE);\n+        PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4OTQ3Mg==", "bodyText": "Fixed", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545789472", "createdAt": "2020-12-18T12:05:25Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -24,23 +25,29 @@\n \n     public static final ParseField TOTAL_FEATURE_IMPORTANCE = new ParseField(\"total_feature_importance\");\n     public static final ParseField FEATURE_IMPORTANCE_BASELINE = new ParseField(\"feature_importance_baseline\");\n+    public static final ParseField HYPERPARAMETERS = new ParseField(\"hyperparameters\");\n \n     @SuppressWarnings(\"unchecked\")\n     public static final ConstructingObjectParser<ModelMetadata, Void> PARSER = new ConstructingObjectParser<>(\n         \"trained_model_metadata\",\n-        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1]));\n+        a -> new ModelMetadata((List<TotalFeatureImportance>) a[0], (FeatureImportanceBaseline) a[1], (List<Hyperparameters>) a[2]));\n \n     static {\n         PARSER.declareObjectArray(constructorArg(), TotalFeatureImportance.STRICT_PARSER, TOTAL_FEATURE_IMPORTANCE);\n         PARSER.declareObject(optionalConstructorArg(), FeatureImportanceBaseline.STRICT_PARSER, FEATURE_IMPORTANCE_BASELINE);\n+        PARSER.declareObjectArray(constructorArg(), Hyperparameters.STRICT_PARSER, HYPERPARAMETERS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzODE5Mg=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMTMwNjA1OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQxNjoyNjozOVrOIHN7aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjowNjoxNVrOIIgXsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzOTE0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    builder.field(HYPERPARAMETERS.getPreferredName(), hyperparameters);\n          \n          \n            \n                    if (hyperparameters != null) {\n          \n          \n            \n                        builder.field(HYPERPARAMETERS.getPreferredName(), hyperparameters);\n          \n          \n            \n                    }", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r544439147", "createdAt": "2020-12-16T16:26:39Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -72,6 +84,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n         if (featureImportanceBaseline != null) {\n             builder.field(FEATURE_IMPORTANCE_BASELINE.getPreferredName(), featureImportanceBaseline);\n         }\n+        builder.field(HYPERPARAMETERS.getPreferredName(), hyperparameters);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4OTg3NQ==", "bodyText": "fixed", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545789875", "createdAt": "2020-12-18T12:06:15Z", "author": {"login": "valeriy42"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/dataframe/process/results/ModelMetadata.java", "diffHunk": "@@ -72,6 +84,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n         if (featureImportanceBaseline != null) {\n             builder.field(FEATURE_IMPORTANCE_BASELINE.getPreferredName(), featureImportanceBaseline);\n         }\n+        builder.field(HYPERPARAMETERS.getPreferredName(), hyperparameters);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQzOTE0Nw=="}, "originalCommit": {"oid": "d28b824181aa4c13f8081021f7964c643e30f480"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDU4MDg1OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDoxMlrOIIhJ7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDoxMlrOIIhJ7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgwMjczMw==", "bodyText": "If the Doubles and the Boolean  are truly not nullable, they should be double and boolean (unboxed, not nullable).\nIf they are nullable, the parser needs to treat them as optional and the serialization needs to as well", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545802733", "createdAt": "2020-12-18T12:34:12Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.common.ParseField;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.ConstructingObjectParser;\n+import org.elasticsearch.common.xcontent.ToXContentObject;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+\n+import java.io.IOException;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+public class Hyperparameters implements ToXContentObject, Writeable {\n+\n+    private static final String NAME = \"hyperparameters\";\n+    public static final ParseField HYPERPARAMETER_NAME = new ParseField(\"name\");\n+    public static final ParseField VALUE = new ParseField(\"value\");\n+    public static final ParseField ABSOLUTE_IMPORTANCE = new ParseField(\"absolute_importance\");\n+    public static final ParseField RELATIVE_IMPORTANCE = new ParseField(\"relative_importance\");\n+    public static final ParseField SUPPLIED = new ParseField(\"supplied\");\n+\n+\n+    // These parsers follow the pattern that metadata is parsed leniently (to allow for enhancements), whilst config is parsed strictly\n+    public static final ConstructingObjectParser<Hyperparameters, Void> LENIENT_PARSER = createParser(true);\n+    public static final ConstructingObjectParser<Hyperparameters, Void> STRICT_PARSER = createParser(false);\n+\n+    @SuppressWarnings(\"unchecked\")\n+    private static ConstructingObjectParser<Hyperparameters, Void> createParser(boolean ignoreUnknownFields) {\n+        ConstructingObjectParser<Hyperparameters, Void> parser = new ConstructingObjectParser<>(NAME,\n+            ignoreUnknownFields,\n+            a -> new Hyperparameters((String)a[0], (Double)a[1], (Double)a[2], (Double)a[3], (Boolean)a[4]));\n+        parser.declareString(ConstructingObjectParser.constructorArg(), HYPERPARAMETER_NAME);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), VALUE);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), ABSOLUTE_IMPORTANCE);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), RELATIVE_IMPORTANCE);\n+        parser.declareBoolean(ConstructingObjectParser.constructorArg(), SUPPLIED);\n+        return parser;\n+    }\n+\n+    public static Hyperparameters fromXContent(XContentParser parser, boolean lenient) throws IOException {\n+        return lenient ? LENIENT_PARSER.parse(parser, null) : STRICT_PARSER.parse(parser, null);\n+    }\n+\n+    public final String hyperparameterName;\n+    public final Double value;\n+    public final Double absoluteImportance;\n+    public final Double relativeImportance;\n+    public final Boolean supplied;\n+\n+    public Hyperparameters(StreamInput in) throws IOException {\n+        this.hyperparameterName = in.readString();\n+        this.value = in.readDouble();\n+        this.absoluteImportance = in.readDouble();\n+        this.relativeImportance = in.readDouble();\n+        this.supplied = in.readBoolean();\n+    }\n+\n+    Hyperparameters(String hyperparameterName, Double value, Double absoluteImportance, Double relativeImportance, Boolean supplied) {\n+        this.hyperparameterName = hyperparameterName;\n+        this.value = value;\n+        this.absoluteImportance = absoluteImportance;\n+        this.relativeImportance = relativeImportance;\n+        this.supplied = supplied;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c8e00bb164043e54a8fe0e68e9af1e8faaa10d9"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDU4MzEwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDozOVrOIIhLDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDozOVrOIIhLDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgwMzAyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545803022", "createdAt": "2020-12-18T12:34:39Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -95,26 +105,33 @@ public FeatureImportanceBaseline getFeatureImportanceBaselines() {\n         return featureImportanceBaselines;\n     }\n \n+    public List<Hyperparameters> getHyperparameters() {\n+        return hyperparameters;\n+    }\n+\n     @Override\n     public boolean equals(Object o) {\n         if (this == o) return true;\n         if (o == null || getClass() != o.getClass()) return false;\n         TrainedModelMetadata that = (TrainedModelMetadata) o;\n         return Objects.equals(totalFeatureImportances, that.totalFeatureImportances) &&\n             Objects.equals(featureImportanceBaselines, that.featureImportanceBaselines) &&\n+            Objects.equals(hyperparameters, that.hyperparameters) &&\n             Objects.equals(modelId, that.modelId);\n     }\n \n     @Override\n     public int hashCode() {\n-        return Objects.hash(totalFeatureImportances, featureImportanceBaselines, modelId);\n+        return Objects.hash(totalFeatureImportances, featureImportanceBaselines, hyperparameters, modelId);\n     }\n \n     @Override\n     public void writeTo(StreamOutput out) throws IOException {\n         out.writeString(modelId);\n         out.writeList(totalFeatureImportances);\n         out.writeOptionalWriteable(featureImportanceBaselines);\n+        out.writeList(hyperparameters);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c8e00bb164043e54a8fe0e68e9af1e8faaa10d9"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDU4Mzk1OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDo1MVrOIIhLhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMjozNDo1MVrOIIhLhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgwMzE0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545803141", "createdAt": "2020-12-18T12:34:51Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/TrainedModelMetadata.java", "diffHunk": "@@ -63,20 +68,25 @@ public static String modelId(String docId) {\n \n     private final List<TotalFeatureImportance> totalFeatureImportances;\n     private final FeatureImportanceBaseline featureImportanceBaselines;\n+    private final List<Hyperparameters> hyperparameters;\n     private final String modelId;\n \n     public TrainedModelMetadata(StreamInput in) throws IOException {\n         this.modelId = in.readString();\n         this.totalFeatureImportances = in.readList(TotalFeatureImportance::new);\n         this.featureImportanceBaselines = in.readOptionalWriteable(FeatureImportanceBaseline::new);\n+        this.hyperparameters = in.readList(Hyperparameters::new);\n     }\n \n     public TrainedModelMetadata(String modelId,\n                                 List<TotalFeatureImportance> totalFeatureImportances,\n-                                FeatureImportanceBaseline featureImportanceBaselines) {\n+                                FeatureImportanceBaseline featureImportanceBaselines,\n+                                List<Hyperparameters> hyperparameters) {\n         this.modelId = ExceptionsHelper.requireNonNull(modelId, MODEL_ID);\n         this.totalFeatureImportances = Collections.unmodifiableList(totalFeatureImportances);\n         this.featureImportanceBaselines = featureImportanceBaselines;\n+        this.hyperparameters =  hyperparameters == null ? Collections.emptyList() : Collections.unmodifiableList(hyperparameters);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c8e00bb164043e54a8fe0e68e9af1e8faaa10d9"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDczMTM0OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxNzo0OVrOIIigjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxNzo0OVrOIIigjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyNDkxMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (this.supplied == false) {\n          \n          \n            \n                        this.absoluteImportance = in.readDouble();\n          \n          \n            \n                        this.relativeImportance = in.readDouble();\n          \n          \n            \n                    }\n          \n          \n            \n                    else {\n          \n          \n            \n                        this.absoluteImportance = null;\n          \n          \n            \n                        this.relativeImportance = null;\n          \n          \n            \n                    }\n          \n          \n            \n                    this.absoluteImportance = in.readOptionalDouble();\n          \n          \n            \n                    this.relativeImportance = in.readOptionalDouble();", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545824910", "createdAt": "2020-12-18T13:17:49Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.common.ParseField;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.ConstructingObjectParser;\n+import org.elasticsearch.common.xcontent.ToXContentObject;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper;\n+\n+import java.io.IOException;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+public class Hyperparameters implements ToXContentObject, Writeable {\n+\n+    private static final String NAME = \"hyperparameters\";\n+    public static final ParseField HYPERPARAMETER_NAME = new ParseField(\"name\");\n+    public static final ParseField VALUE = new ParseField(\"value\");\n+    public static final ParseField ABSOLUTE_IMPORTANCE = new ParseField(\"absolute_importance\");\n+    public static final ParseField RELATIVE_IMPORTANCE = new ParseField(\"relative_importance\");\n+    public static final ParseField SUPPLIED = new ParseField(\"supplied\");\n+\n+\n+    // These parsers follow the pattern that metadata is parsed leniently (to allow for enhancements), whilst config is parsed strictly\n+    public static final ConstructingObjectParser<Hyperparameters, Void> LENIENT_PARSER = createParser(true);\n+    public static final ConstructingObjectParser<Hyperparameters, Void> STRICT_PARSER = createParser(false);\n+\n+    @SuppressWarnings(\"unchecked\")\n+    private static ConstructingObjectParser<Hyperparameters, Void> createParser(boolean ignoreUnknownFields) {\n+        ConstructingObjectParser<Hyperparameters, Void> parser = new ConstructingObjectParser<>(NAME,\n+            ignoreUnknownFields,\n+            a -> new Hyperparameters((String)a[0], (Double)a[1], (Double)a[2], (Double)a[3], (Boolean)a[4]));\n+        parser.declareString(ConstructingObjectParser.constructorArg(), HYPERPARAMETER_NAME);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), VALUE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), ABSOLUTE_IMPORTANCE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), RELATIVE_IMPORTANCE);\n+        parser.declareBoolean(ConstructingObjectParser.constructorArg(), SUPPLIED);\n+        return parser;\n+    }\n+\n+    public static Hyperparameters fromXContent(XContentParser parser, boolean lenient) throws IOException {\n+        return lenient ? LENIENT_PARSER.parse(parser, null) : STRICT_PARSER.parse(parser, null);\n+    }\n+\n+    public final String hyperparameterName;\n+    public final double value;\n+    public final Double absoluteImportance;\n+    public final Double relativeImportance;\n+    public final boolean supplied;\n+\n+    public Hyperparameters(StreamInput in) throws IOException {\n+        this.hyperparameterName = in.readString();\n+        this.value = in.readDouble();\n+        this.supplied = in.readBoolean();\n+        if (this.supplied == false) {\n+            this.absoluteImportance = in.readDouble();\n+            this.relativeImportance = in.readDouble();\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDczNTM3OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxODo1NVrOIIiixA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxODo1NVrOIIiixA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyNTQ3Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (this.supplied == false) {\n          \n          \n            \n                        this.absoluteImportance = ExceptionsHelper.requireNonNull(absoluteImportance, ABSOLUTE_IMPORTANCE.getPreferredName());\n          \n          \n            \n                        this.relativeImportance = ExceptionsHelper.requireNonNull(relativeImportance, RELATIVE_IMPORTANCE.getPreferredName());\n          \n          \n            \n                    }\n          \n          \n            \n                    else {\n          \n          \n            \n                        this.absoluteImportance = null;\n          \n          \n            \n                        this.relativeImportance = null;\n          \n          \n            \n                    }\n          \n          \n            \n                    this.absoluteImportance = absoluteImportance;\n          \n          \n            \n                    this.relativeImportance = relativeImportance;\n          \n          \n            \n                    if (this.supplied == false) {\n          \n          \n            \n                        ExceptionsHelper.requireNonNull(absoluteImportance, ABSOLUTE_IMPORTANCE.getPreferredName());\n          \n          \n            \n                        ExceptionsHelper.requireNonNull(relativeImportance, RELATIVE_IMPORTANCE.getPreferredName());\n          \n          \n            \n                    }", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545825476", "createdAt": "2020-12-18T13:18:55Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.common.ParseField;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.ConstructingObjectParser;\n+import org.elasticsearch.common.xcontent.ToXContentObject;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper;\n+\n+import java.io.IOException;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+public class Hyperparameters implements ToXContentObject, Writeable {\n+\n+    private static final String NAME = \"hyperparameters\";\n+    public static final ParseField HYPERPARAMETER_NAME = new ParseField(\"name\");\n+    public static final ParseField VALUE = new ParseField(\"value\");\n+    public static final ParseField ABSOLUTE_IMPORTANCE = new ParseField(\"absolute_importance\");\n+    public static final ParseField RELATIVE_IMPORTANCE = new ParseField(\"relative_importance\");\n+    public static final ParseField SUPPLIED = new ParseField(\"supplied\");\n+\n+\n+    // These parsers follow the pattern that metadata is parsed leniently (to allow for enhancements), whilst config is parsed strictly\n+    public static final ConstructingObjectParser<Hyperparameters, Void> LENIENT_PARSER = createParser(true);\n+    public static final ConstructingObjectParser<Hyperparameters, Void> STRICT_PARSER = createParser(false);\n+\n+    @SuppressWarnings(\"unchecked\")\n+    private static ConstructingObjectParser<Hyperparameters, Void> createParser(boolean ignoreUnknownFields) {\n+        ConstructingObjectParser<Hyperparameters, Void> parser = new ConstructingObjectParser<>(NAME,\n+            ignoreUnknownFields,\n+            a -> new Hyperparameters((String)a[0], (Double)a[1], (Double)a[2], (Double)a[3], (Boolean)a[4]));\n+        parser.declareString(ConstructingObjectParser.constructorArg(), HYPERPARAMETER_NAME);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), VALUE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), ABSOLUTE_IMPORTANCE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), RELATIVE_IMPORTANCE);\n+        parser.declareBoolean(ConstructingObjectParser.constructorArg(), SUPPLIED);\n+        return parser;\n+    }\n+\n+    public static Hyperparameters fromXContent(XContentParser parser, boolean lenient) throws IOException {\n+        return lenient ? LENIENT_PARSER.parse(parser, null) : STRICT_PARSER.parse(parser, null);\n+    }\n+\n+    public final String hyperparameterName;\n+    public final double value;\n+    public final Double absoluteImportance;\n+    public final Double relativeImportance;\n+    public final boolean supplied;\n+\n+    public Hyperparameters(StreamInput in) throws IOException {\n+        this.hyperparameterName = in.readString();\n+        this.value = in.readDouble();\n+        this.supplied = in.readBoolean();\n+        if (this.supplied == false) {\n+            this.absoluteImportance = in.readDouble();\n+            this.relativeImportance = in.readDouble();\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }\n+    }\n+\n+    Hyperparameters(String hyperparameterName, double value, Double absoluteImportance, Double relativeImportance, boolean supplied) {\n+        this.hyperparameterName = hyperparameterName;\n+        this.value = value;\n+        this.supplied = supplied;\n+        if (this.supplied == false) {\n+            this.absoluteImportance = ExceptionsHelper.requireNonNull(absoluteImportance, ABSOLUTE_IMPORTANCE.getPreferredName());\n+            this.relativeImportance = ExceptionsHelper.requireNonNull(relativeImportance, RELATIVE_IMPORTANCE.getPreferredName());\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDczNzA5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxOToyMlrOIIijwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoxOToyMlrOIIijwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyNTcyOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (supplied == false) {\n          \n          \n            \n                        out.writeOptionalDouble(absoluteImportance);\n          \n          \n            \n                        out.writeOptionalDouble(relativeImportance);\n          \n          \n            \n                    }\n          \n          \n            \n                    out.writeOptionalDouble(absoluteImportance);\n          \n          \n            \n                    out.writeOptionalDouble(relativeImportance);", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545825728", "createdAt": "2020-12-18T13:19:22Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.common.ParseField;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.ConstructingObjectParser;\n+import org.elasticsearch.common.xcontent.ToXContentObject;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper;\n+\n+import java.io.IOException;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+public class Hyperparameters implements ToXContentObject, Writeable {\n+\n+    private static final String NAME = \"hyperparameters\";\n+    public static final ParseField HYPERPARAMETER_NAME = new ParseField(\"name\");\n+    public static final ParseField VALUE = new ParseField(\"value\");\n+    public static final ParseField ABSOLUTE_IMPORTANCE = new ParseField(\"absolute_importance\");\n+    public static final ParseField RELATIVE_IMPORTANCE = new ParseField(\"relative_importance\");\n+    public static final ParseField SUPPLIED = new ParseField(\"supplied\");\n+\n+\n+    // These parsers follow the pattern that metadata is parsed leniently (to allow for enhancements), whilst config is parsed strictly\n+    public static final ConstructingObjectParser<Hyperparameters, Void> LENIENT_PARSER = createParser(true);\n+    public static final ConstructingObjectParser<Hyperparameters, Void> STRICT_PARSER = createParser(false);\n+\n+    @SuppressWarnings(\"unchecked\")\n+    private static ConstructingObjectParser<Hyperparameters, Void> createParser(boolean ignoreUnknownFields) {\n+        ConstructingObjectParser<Hyperparameters, Void> parser = new ConstructingObjectParser<>(NAME,\n+            ignoreUnknownFields,\n+            a -> new Hyperparameters((String)a[0], (Double)a[1], (Double)a[2], (Double)a[3], (Boolean)a[4]));\n+        parser.declareString(ConstructingObjectParser.constructorArg(), HYPERPARAMETER_NAME);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), VALUE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), ABSOLUTE_IMPORTANCE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), RELATIVE_IMPORTANCE);\n+        parser.declareBoolean(ConstructingObjectParser.constructorArg(), SUPPLIED);\n+        return parser;\n+    }\n+\n+    public static Hyperparameters fromXContent(XContentParser parser, boolean lenient) throws IOException {\n+        return lenient ? LENIENT_PARSER.parse(parser, null) : STRICT_PARSER.parse(parser, null);\n+    }\n+\n+    public final String hyperparameterName;\n+    public final double value;\n+    public final Double absoluteImportance;\n+    public final Double relativeImportance;\n+    public final boolean supplied;\n+\n+    public Hyperparameters(StreamInput in) throws IOException {\n+        this.hyperparameterName = in.readString();\n+        this.value = in.readDouble();\n+        this.supplied = in.readBoolean();\n+        if (this.supplied == false) {\n+            this.absoluteImportance = in.readDouble();\n+            this.relativeImportance = in.readDouble();\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }\n+    }\n+\n+    Hyperparameters(String hyperparameterName, double value, Double absoluteImportance, Double relativeImportance, boolean supplied) {\n+        this.hyperparameterName = hyperparameterName;\n+        this.value = value;\n+        this.supplied = supplied;\n+        if (this.supplied == false) {\n+            this.absoluteImportance = ExceptionsHelper.requireNonNull(absoluteImportance, ABSOLUTE_IMPORTANCE.getPreferredName());\n+            this.relativeImportance = ExceptionsHelper.requireNonNull(relativeImportance, RELATIVE_IMPORTANCE.getPreferredName());\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }\n+    }\n+\n+    @Override\n+    public void writeTo(StreamOutput out) throws IOException {\n+        out.writeString(hyperparameterName);\n+        out.writeDouble(value);\n+        out.writeBoolean(supplied);\n+        if (supplied == false) {\n+            out.writeOptionalDouble(absoluteImportance);\n+            out.writeOptionalDouble(relativeImportance);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDczOTEwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyMDowMVrOIIik7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyMDowMVrOIIik7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyNjAzMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (supplied == false) {\n          \n          \n            \n                        if (absoluteImportance != null) {\n          \n          \n            \n                            map.put(ABSOLUTE_IMPORTANCE.getPreferredName(), absoluteImportance);\n          \n          \n            \n                        }\n          \n          \n            \n                        if (relativeImportance != null) {\n          \n          \n            \n                            map.put(RELATIVE_IMPORTANCE.getPreferredName(), relativeImportance);\n          \n          \n            \n                        }\n          \n          \n            \n                    }\n          \n          \n            \n                    if (absoluteImportance != null) {\n          \n          \n            \n                        map.put(ABSOLUTE_IMPORTANCE.getPreferredName(), absoluteImportance);\n          \n          \n            \n                    }\n          \n          \n            \n                    if (relativeImportance != null) {\n          \n          \n            \n                        map.put(RELATIVE_IMPORTANCE.getPreferredName(), relativeImportance);\n          \n          \n            \n                    }", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545826030", "createdAt": "2020-12-18T13:20:01Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/Hyperparameters.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.common.ParseField;\n+import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.io.stream.StreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.ConstructingObjectParser;\n+import org.elasticsearch.common.xcontent.ToXContentObject;\n+import org.elasticsearch.common.xcontent.XContentBuilder;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper;\n+\n+import java.io.IOException;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+public class Hyperparameters implements ToXContentObject, Writeable {\n+\n+    private static final String NAME = \"hyperparameters\";\n+    public static final ParseField HYPERPARAMETER_NAME = new ParseField(\"name\");\n+    public static final ParseField VALUE = new ParseField(\"value\");\n+    public static final ParseField ABSOLUTE_IMPORTANCE = new ParseField(\"absolute_importance\");\n+    public static final ParseField RELATIVE_IMPORTANCE = new ParseField(\"relative_importance\");\n+    public static final ParseField SUPPLIED = new ParseField(\"supplied\");\n+\n+\n+    // These parsers follow the pattern that metadata is parsed leniently (to allow for enhancements), whilst config is parsed strictly\n+    public static final ConstructingObjectParser<Hyperparameters, Void> LENIENT_PARSER = createParser(true);\n+    public static final ConstructingObjectParser<Hyperparameters, Void> STRICT_PARSER = createParser(false);\n+\n+    @SuppressWarnings(\"unchecked\")\n+    private static ConstructingObjectParser<Hyperparameters, Void> createParser(boolean ignoreUnknownFields) {\n+        ConstructingObjectParser<Hyperparameters, Void> parser = new ConstructingObjectParser<>(NAME,\n+            ignoreUnknownFields,\n+            a -> new Hyperparameters((String)a[0], (Double)a[1], (Double)a[2], (Double)a[3], (Boolean)a[4]));\n+        parser.declareString(ConstructingObjectParser.constructorArg(), HYPERPARAMETER_NAME);\n+        parser.declareDouble(ConstructingObjectParser.constructorArg(), VALUE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), ABSOLUTE_IMPORTANCE);\n+        parser.declareDouble(ConstructingObjectParser.optionalConstructorArg(), RELATIVE_IMPORTANCE);\n+        parser.declareBoolean(ConstructingObjectParser.constructorArg(), SUPPLIED);\n+        return parser;\n+    }\n+\n+    public static Hyperparameters fromXContent(XContentParser parser, boolean lenient) throws IOException {\n+        return lenient ? LENIENT_PARSER.parse(parser, null) : STRICT_PARSER.parse(parser, null);\n+    }\n+\n+    public final String hyperparameterName;\n+    public final double value;\n+    public final Double absoluteImportance;\n+    public final Double relativeImportance;\n+    public final boolean supplied;\n+\n+    public Hyperparameters(StreamInput in) throws IOException {\n+        this.hyperparameterName = in.readString();\n+        this.value = in.readDouble();\n+        this.supplied = in.readBoolean();\n+        if (this.supplied == false) {\n+            this.absoluteImportance = in.readDouble();\n+            this.relativeImportance = in.readDouble();\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }\n+    }\n+\n+    Hyperparameters(String hyperparameterName, double value, Double absoluteImportance, Double relativeImportance, boolean supplied) {\n+        this.hyperparameterName = hyperparameterName;\n+        this.value = value;\n+        this.supplied = supplied;\n+        if (this.supplied == false) {\n+            this.absoluteImportance = ExceptionsHelper.requireNonNull(absoluteImportance, ABSOLUTE_IMPORTANCE.getPreferredName());\n+            this.relativeImportance = ExceptionsHelper.requireNonNull(relativeImportance, RELATIVE_IMPORTANCE.getPreferredName());\n+        }\n+        else {\n+            this.absoluteImportance = null;\n+            this.relativeImportance = null;\n+        }\n+    }\n+\n+    @Override\n+    public void writeTo(StreamOutput out) throws IOException {\n+        out.writeString(hyperparameterName);\n+        out.writeDouble(value);\n+        out.writeBoolean(supplied);\n+        if (supplied == false) {\n+            out.writeOptionalDouble(absoluteImportance);\n+            out.writeOptionalDouble(relativeImportance);\n+        }\n+    }\n+\n+    @Override\n+    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {\n+        return builder.map(asMap());\n+    }\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        if (this == o) return true;\n+        if (o == null || getClass() != o.getClass()) return false;\n+        Hyperparameters that = (Hyperparameters) o;\n+        return Objects.equals(that.hyperparameterName, hyperparameterName)\n+            && Objects.equals(value, that.value)\n+            && Objects.equals(absoluteImportance, that.absoluteImportance)\n+            && Objects.equals(relativeImportance, that.relativeImportance)\n+            && Objects.equals(supplied, that.supplied)\n+        ;\n+    }\n+\n+    public Map<String, Object> asMap() {\n+        Map<String, Object> map = new LinkedHashMap<>();\n+        map.put(HYPERPARAMETER_NAME.getPreferredName(), hyperparameterName);\n+        map.put(VALUE.getPreferredName(), value);\n+        if (supplied == false) {\n+            if (absoluteImportance != null) {\n+                map.put(ABSOLUTE_IMPORTANCE.getPreferredName(), absoluteImportance);\n+            }\n+            if (relativeImportance != null) {\n+                map.put(RELATIVE_IMPORTANCE.getPreferredName(), relativeImportance);\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 129}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDc0MzE4OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/HyperparametersTests.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyMToxNlrOIIinUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyMToxNlrOIIinUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyNjY0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return new Hyperparameters(\n          \n          \n            \n                    boolean supplied = randomBoolean();\n          \n          \n            \n                    return new Hyperparameters(", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545826641", "createdAt": "2020-12-18T13:21:16Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/HyperparametersTests.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.Version;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.AbstractBWCSerializationTestCase;\n+import org.junit.Before;\n+\n+import java.io.IOException;\n+\n+\n+public class HyperparametersTests extends AbstractBWCSerializationTestCase<Hyperparameters> {\n+\n+    private boolean lenient;\n+\n+    @SuppressWarnings(\"unchecked\")\n+    public static Hyperparameters randomInstance() {\n+        return new Hyperparameters(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDc1MzI2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/HyperparametersTests.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyNDoxM1rOIIitHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMzoyNDoxM1rOIIitHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTgyODEyNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        randomDoubleBetween(0.0, 100.0, true),\n          \n          \n            \n                        randomDoubleBetween(0.0, 1.0, true),\n          \n          \n            \n                        randomBoolean());\n          \n          \n            \n                        // If supplied, the importance values are possibly nullable\n          \n          \n            \n                        supplied && randomBoolean() ? null : randomDoubleBetween(0.0, 100.0, true),\n          \n          \n            \n                        supplied && randomBoolean() ? null : randomDoubleBetween(0.0, 1.0, true),\n          \n          \n            \n                        supplied);", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545828125", "createdAt": "2020-12-18T13:24:13Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/inference/trainedmodel/metadata/HyperparametersTests.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n+ * or more contributor license agreements. Licensed under the Elastic License;\n+ * you may not use this file except in compliance with the Elastic License.\n+ */\n+package org.elasticsearch.xpack.core.ml.inference.trainedmodel.metadata;\n+\n+import org.elasticsearch.Version;\n+import org.elasticsearch.common.io.stream.Writeable;\n+import org.elasticsearch.common.xcontent.XContentParser;\n+import org.elasticsearch.xpack.core.ml.AbstractBWCSerializationTestCase;\n+import org.junit.Before;\n+\n+import java.io.IOException;\n+\n+\n+public class HyperparametersTests extends AbstractBWCSerializationTestCase<Hyperparameters> {\n+\n+    private boolean lenient;\n+\n+    @SuppressWarnings(\"unchecked\")\n+    public static Hyperparameters randomInstance() {\n+        return new Hyperparameters(\n+            randomAlphaOfLength(10),\n+            randomDoubleBetween(0.0, 1.0, true),\n+            randomDoubleBetween(0.0, 100.0, true),\n+            randomDoubleBetween(0.0, 1.0, true),\n+            randomBoolean());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33b8af76e6a3ff1801071c8be9672acbef082639"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMTUwMDEwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/resources/org/elasticsearch/xpack/core/ml/inference_index_template.json", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMToxN1rOIIpmvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNjoyMToxN1rOIIpmvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTk0MTE4MQ==", "bodyText": "^ dangling comma", "url": "https://github.com/elastic/elasticsearch/pull/66349#discussion_r545941181", "createdAt": "2020-12-18T16:21:17Z", "author": {"login": "hendrikmuhs"}, "path": "x-pack/plugin/core/src/main/resources/org/elasticsearch/xpack/core/ml/inference_index_template.json", "diffHunk": "@@ -127,6 +127,27 @@\n               }\n             }\n           }\n+        },\n+        \"hyperparameters\": {\n+          \"type\": \"nested\",\n+          \"dynamic\": \"false\",\n+          \"properties\": {\n+            \"name\": {\n+              \"type\": \"keyword\"\n+            },\n+            \"value\": {\n+              \"type\": \"double\"\n+            },\n+            \"absolute_importance\": {\n+              \"type\": \"double\"\n+            },\n+            \"relative_importance\": {\n+              \"type\": \"double\"\n+            },\n+            \"supplied\": {\n+              \"type\": \"boolean\"\n+            },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a5182d17e2599f2fdfdb7cfc187236b69823913"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4619, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}