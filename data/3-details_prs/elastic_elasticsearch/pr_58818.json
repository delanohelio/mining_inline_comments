{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNTk0MDkz", "number": 58818, "title": "Cleanup Duplication in Snapshot ITs", "bodyText": "Just a few obvious static cleanups of duplication to push back against the ever increasing complexity of these tests.", "createdAt": "2020-07-01T10:09:29Z", "url": "https://github.com/elastic/elasticsearch/pull/58818", "merged": true, "mergeCommit": {"oid": "465998f418896734430cffe85192c89fd65f28e8"}, "closed": true, "closedAt": "2020-07-02T12:51:46Z", "author": {"login": "original-brownbear"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwnY9AAH2gAyNDQyNTk0MDkzOmUwNTdiZGZkMDQzYzg2NDljM2NmNTljOTI1OTY1Yzg4OWZjNWJlMTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcw7iTjgFqTQ0MTUxMDYzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e057bdfd043c8649c3cf59c925965c889fc5be17", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/e057bdfd043c8649c3cf59c925965c889fc5be17", "committedDate": "2020-07-01T10:08:00Z", "message": "Cleanup Duplication in Snapshot ITs\n\nJust a few obvious static cleanups of duplication to push back against the ever increasing complexity of these tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57a340c4a1822d29797cdaa49660101790a99110", "author": {"user": {"login": "original-brownbear", "name": "Armin Braun"}}, "url": "https://github.com/elastic/elasticsearch/commit/57a340c4a1822d29797cdaa49660101790a99110", "committedDate": "2020-07-01T10:59:19Z", "message": "Merge remote-tracking branch 'elastic/master' into dry-up-snapshot-tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNTEwNjM4", "url": "https://github.com/elastic/elasticsearch/pull/58818#pullrequestreview-441510638", "createdAt": "2020-07-02T09:32:21Z", "commit": {"oid": "57a340c4a1822d29797cdaa49660101790a99110"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwOTozMjoyMVrOGsFHMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwOTozNjowNlrOGsFPWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg3NDI5MQ==", "bodyText": "I think it deserves a createFsRepository(); I'd also rarely set a random chunk size", "url": "https://github.com/elastic/elasticsearch/pull/58818#discussion_r448874291", "createdAt": "2020-07-02T09:32:21Z", "author": {"login": "tlrx"}, "path": "server/src/internalClusterTest/java/org/elasticsearch/repositories/blobstore/BlobStoreRepositoryCleanupIT.java", "diffHunk": "@@ -116,11 +112,8 @@ public void testCleanupOldIndexN() throws ExecutionException, InterruptedExcepti\n         internalCluster().startNodes(Settings.EMPTY);\n \n         final String repoName = \"test-repo\";\n-        logger.info(\"-->  creating repository\");\n-        assertAcked(client().admin().cluster().preparePutRepository(repoName).setType(\"fs\").setSettings(Settings.builder()\n-            .put(\"location\", randomRepoPath())\n-            .put(\"compress\", randomBoolean())\n-            .put(\"chunk_size\", randomIntBetween(100, 1000), ByteSizeUnit.BYTES)));\n+        createRepository(repoName, \"fs\", Settings.builder().put(\"location\", randomRepoPath()).put(\"compress\", randomBoolean())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a340c4a1822d29797cdaa49660101790a99110"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg3NjI1MQ==", "bodyText": "Is it overriden somewhere? If not it can be static.", "url": "https://github.com/elastic/elasticsearch/pull/58818#discussion_r448876251", "createdAt": "2020-07-02T09:35:50Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -264,11 +264,14 @@ public static void unblockNode(final String repository, final String node) {\n         ((MockRepository)internalCluster().getInstance(RepositoriesService.class, node).repository(repository)).unblock();\n     }\n \n-    protected void createRepository(String repoName, String type, Path location) {\n-        logger.info(\"-->  creating repository\");\n+    protected void createRepository(String repoName, String type, Settings.Builder settings) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a340c4a1822d29797cdaa49660101790a99110"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg3NjM3OA==", "bodyText": "Maybe static?", "url": "https://github.com/elastic/elasticsearch/pull/58818#discussion_r448876378", "createdAt": "2020-07-02T09:36:06Z", "author": {"login": "tlrx"}, "path": "server/src/test/java/org/elasticsearch/snapshots/AbstractSnapshotIntegTestCase.java", "diffHunk": "@@ -307,4 +310,16 @@ protected String initWithSnapshotVersion(String repoName, Path repoPath, Version\n                 StandardOpenOption.TRUNCATE_EXISTING);\n         return oldVersionSnapshot;\n     }\n+\n+    protected SnapshotInfo createFullSnapshot(String repoName, String snapshotName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57a340c4a1822d29797cdaa49660101790a99110"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2465, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}