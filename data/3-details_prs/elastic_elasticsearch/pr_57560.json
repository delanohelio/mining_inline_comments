{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2ODM3NTE4", "number": 57560, "title": "[DOCS] Add documentation for near real-time search", "bodyText": "This PR adds documentation explaining near real-time search to the ES Reference.\nCloses #40644\nBackports:\n\n[7.8] #58131\n[7.7] #58133\n[7.x] #58138", "createdAt": "2020-06-02T21:24:09Z", "url": "https://github.com/elastic/elasticsearch/pull/57560", "merged": true, "mergeCommit": {"oid": "961a85e1e66649f4c5ca820b2e61bd9a35a829bd"}, "closed": true, "closedAt": "2020-06-15T18:49:34Z", "author": {"login": "lockewritesdocs"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnboxdAH2gAyNDI2ODM3NTE4OmU0OTFjZDYyOTA2YTlkMTk3YzRiYmNjZmQyOWZmNGZlZjVmNTZlMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrieiOgFqTQzMDc2MTEwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e491cd62906a9d197c4bbccfd29ff4fef5f56e2c", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/e491cd62906a9d197c4bbccfd29ff4fef5f56e2c", "committedDate": "2020-06-02T21:21:06Z", "message": "Adding documentation for near real-time search."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/d0afddd1c32c086be2cffebdd65c9787d7338a45", "committedDate": "2020-06-03T13:32:50Z", "message": "Adding link to NRT topic and clarifying some text."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MTE5ODcy", "url": "https://github.com/elastic/elasticsearch/pull/57560#pullrequestreview-425119872", "createdAt": "2020-06-05T08:58:13Z", "commit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwODo1ODoxM1rOGfmNrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwOToxMDo1MlrOGfmpyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NTEzNQ==", "bodyText": "Suggest moving this down to the second item in the TOC, since this is probably not the first thing a beginner needs to read.", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435785135", "createdAt": "2020-06-05T08:58:13Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/index.asciidoc", "diffHunk": "@@ -28,12 +28,14 @@ a specific number of results.\n [[search-toc]]\n === In this section\n \n+* <<near-real-time>>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NjMwMQ==", "bodyText": "Can we lift some of the content/diagrams from the definitive guide to this page? I think these are difficult concepts for beginners to handle, so we should try and start from the basics and make this page as self-contained as possible. The target audience includes first-time users that just started Elasticsearch, indexed some docs, tried to search for them, and didn't find them.", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435786301", "createdAt": "2020-06-05T09:00:03Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/near-real-time.asciidoc", "diffHunk": "@@ -0,0 +1,21 @@\n+[[near-real-time]]\n+== Near real-time search", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NjM5Nw==", "bodyText": "Could you wrap to 80 columns?", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435786397", "createdAt": "2020-06-05T09:00:11Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/near-real-time.asciidoc", "diffHunk": "@@ -0,0 +1,21 @@\n+[[near-real-time]]\n+== Near real-time search\n+The overview of <<documents-indices,documents and indices>> indicates that when a document is stored in {es}, it is indexed and fully searchable in _near real-time_--within 1 second. What defines near real-time search?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4NzYyNw==", "bodyText": "Could we expand this to spell out all the different ways that a refresh might happen?\n\nwait for the refresh interval\nuse the ?refresh option\nperform an explicit POST _refresh\n\nAlso let's not call it \"lightweight\" as an absolute term. It's certainly lighter than a full commit, but it's not free and you can cause performance issues by doing it too much.", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435787627", "createdAt": "2020-06-05T09:02:17Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/near-real-time.asciidoc", "diffHunk": "@@ -0,0 +1,21 @@\n+[[near-real-time]]\n+== Near real-time search\n+The overview of <<documents-indices,documents and indices>> indicates that when a document is stored in {es}, it is indexed and fully searchable in _near real-time_--within 1 second. What defines near real-time search?\n+\n+Lucene, the Java libraries on which {es} is based, introduced the concept of per-segment search. A _segment_ is similar to an inverted index, but the word _index_ in Lucene means \"a collection of segments plus a commit point\". After a commit, a new segment is added to the commit point and the buffer is cleared.\n+\n+Lucene allows new segments to be written and opened, making the documents they contain visible to search \u200bwithout performing a full commit. This is a much lighter process than a commit to disk, and can be done frequently without degrading performance.\n+\n+In {es}, this lightweight process of writing and opening a new segment is called a _refresh_. A refresh makes all operations performed on an index since the last refresh available for search. By default, every shard is refreshed automatically once per second. This is why we say that {es} has _near_ real-time search: document changes are not visible to search immediately, but will become visible within 1 second.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc4OTgyNQ==", "bodyText": "Also, the default isn't quite to refresh every second, it's more complicated than that. If you're searching frequently enough then we do indeed refresh every second but if there's a gap in searches of over 30s then we stop refreshing periodically and instead refresh just before the first search after the \u226530s gap, which can cause a surprising pause in how long that search takes.", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435789825", "createdAt": "2020-06-05T09:06:24Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/near-real-time.asciidoc", "diffHunk": "@@ -0,0 +1,21 @@\n+[[near-real-time]]\n+== Near real-time search\n+The overview of <<documents-indices,documents and indices>> indicates that when a document is stored in {es}, it is indexed and fully searchable in _near real-time_--within 1 second. What defines near real-time search?\n+\n+Lucene, the Java libraries on which {es} is based, introduced the concept of per-segment search. A _segment_ is similar to an inverted index, but the word _index_ in Lucene means \"a collection of segments plus a commit point\". After a commit, a new segment is added to the commit point and the buffer is cleared.\n+\n+Lucene allows new segments to be written and opened, making the documents they contain visible to search \u200bwithout performing a full commit. This is a much lighter process than a commit to disk, and can be done frequently without degrading performance.\n+\n+In {es}, this lightweight process of writing and opening a new segment is called a _refresh_. A refresh makes all operations performed on an index since the last refresh available for search. By default, every shard is refreshed automatically once per second. This is why we say that {es} has _near_ real-time search: document changes are not visible to search immediately, but will become visible within 1 second.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5MjMyOQ==", "bodyText": "I think we don't need this section, if we link to the ?refresh docs above.", "url": "https://github.com/elastic/elasticsearch/pull/57560#discussion_r435792329", "createdAt": "2020-06-05T09:10:52Z", "author": {"login": "DaveCTurner"}, "path": "docs/reference/search/near-real-time.asciidoc", "diffHunk": "@@ -0,0 +1,21 @@\n+[[near-real-time]]\n+== Near real-time search\n+The overview of <<documents-indices,documents and indices>> indicates that when a document is stored in {es}, it is indexed and fully searchable in _near real-time_--within 1 second. What defines near real-time search?\n+\n+Lucene, the Java libraries on which {es} is based, introduced the concept of per-segment search. A _segment_ is similar to an inverted index, but the word _index_ in Lucene means \"a collection of segments plus a commit point\". After a commit, a new segment is added to the commit point and the buffer is cleared.\n+\n+Lucene allows new segments to be written and opened, making the documents they contain visible to search \u200bwithout performing a full commit. This is a much lighter process than a commit to disk, and can be done frequently without degrading performance.\n+\n+In {es}, this lightweight process of writing and opening a new segment is called a _refresh_. A refresh makes all operations performed on an index since the last refresh available for search. By default, every shard is refreshed automatically once per second. This is why we say that {es} has _near_ real-time search: document changes are not visible to search immediately, but will become visible within 1 second.\n+\n+[[near-real-time-configure-refresh]]\n+[discrete]\n+=== Configuring the refresh interval", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0afddd1c32c086be2cffebdd65c9787d7338a45"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b9297d6b08e39e9de0f35415f8208714425818b", "author": {"user": {"login": "lockewritesdocs", "name": "Adam Locke"}}, "url": "https://github.com/elastic/elasticsearch/commit/1b9297d6b08e39e9de0f35415f8208714425818b", "committedDate": "2020-06-05T19:10:12Z", "message": "Adding diagrams and incorporating changes from David T."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNzYxMTA1", "url": "https://github.com/elastic/elasticsearch/pull/57560#pullrequestreview-430761105", "createdAt": "2020-06-15T15:34:57Z", "commit": {"oid": "1b9297d6b08e39e9de0f35415f8208714425818b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3962, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}