{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTcxNDQx", "number": 53343, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMDowMFrODobujA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNToyOVrODob2rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzIzOTE2OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/bytes.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMDowMFrOF2-raQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMDowMFrOF2-raQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NDM0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024). If the field value is an array, all members will be converted.\n          \n          \n            \n            Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024). If the field is an array of strings, all members of the array will be converted.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393194345", "createdAt": "2020-03-16T17:30:00Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/bytes.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[bytes-processor]]\n === Bytes Processor\n-Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024).\n+Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024). If the field value is an array, all members will be converted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI0NDU3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/gsub.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMToyM1rOF2-urQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMToyM1rOF2-urQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NTE4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If the field is not a string, the processor will throw an exception. If the field value is an array, all members will be converted.\n          \n          \n            \n            If the field is an array of string, all members of the array will be converted. If any non-string values are encountered, the processor will throw an exception.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393195181", "createdAt": "2020-03-16T17:31:23Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/gsub.asciidoc", "diffHunk": "@@ -1,7 +1,7 @@\n [[gsub-processor]]\n === Gsub Processor\n Converts a string field by applying a regular expression and a replacement.\n-If the field is not a string, the processor will throw an exception.\n+If the field is not a string, the processor will throw an exception. If the field value is an array, all members will be converted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1MDg0OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/html_strip.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMzoxMFrOF2-ynQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMzoxMFrOF2-ynQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NjE4OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Removes HTML from field. If the field value is an array, all members will be converted.\n          \n          \n            \n            Removes HTML tags from the field. If the field is an array of strings, HTML tags will be removed from all members of the array.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393196189", "createdAt": "2020-03-16T17:33:10Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/html_strip.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[htmlstrip-processor]]\n === HTML Strip Processor\n-Removes HTML from field.\n+Removes HTML from field. If the field value is an array, all members will be converted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1MjkyOnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/lowercase.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMzo0NFrOF2-z8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozMzo0NFrOF2-z8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NjUyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Converts a string to its lowercase equivalent. If the field value is an array, all members will be converted.\n          \n          \n            \n            Converts a string to its lowercase equivalent. If the field is an array of strings, all members of the array will be converted.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393196529", "createdAt": "2020-03-16T17:33:44Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/lowercase.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[lowercase-processor]]\n === Lowercase Processor\n-Converts a string to its lowercase equivalent.\n+Converts a string to its lowercase equivalent. If the field value is an array, all members will be converted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1NDM3OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/trim.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDowOFrOF2-03A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDowOFrOF2-03A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5Njc2NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Trims whitespace from field. If the field value is an array, all members will be trimmed.\n          \n          \n            \n            Trims whitespace from field. If the field is an array of strings, all members of the array will be trimmed.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393196764", "createdAt": "2020-03-16T17:34:08Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/trim.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[trim-processor]]\n === Trim Processor\n-Trims whitespace from field.\n+Trims whitespace from field. If the field value is an array, all members will be trimmed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1NTk5OnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/uppercase.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDoyOFrOF2-1tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDoyOFrOF2-1tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5Njk4Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Converts a string to its uppercase equivalent. If the field value is an array, all members will be converted.\n          \n          \n            \n            Converts a string to its uppercase equivalent. If the field is an array of strings, all members of the array will be converted.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393196983", "createdAt": "2020-03-16T17:34:28Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/uppercase.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[uppercase-processor]]\n === Uppercase Processor\n-Converts a string to its uppercase equivalent.\n+Converts a string to its uppercase equivalent. If the field value is an array, all members will be converted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1NzYxOnYy", "diffSide": "RIGHT", "path": "docs/reference/ingest/processors/url-decode.asciidoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDo1MVrOF2-2ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNDo1MVrOF2-2ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NzI1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            URL-decodes a string. If the field value is an array, all members will be decoded.\n          \n          \n            \n            URL-decodes a string. If the field is an array of strings, all members of the array will be decoded.", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393197251", "createdAt": "2020-03-16T17:34:51Z", "author": {"login": "danhermann"}, "path": "docs/reference/ingest/processors/url-decode.asciidoc", "diffHunk": "@@ -1,6 +1,6 @@\n [[urldecode-processor]]\n === URL Decode Processor\n-URL-decodes a string\n+URL-decodes a string. If the field value is an array, all members will be decoded.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzI1OTk2OnYy", "diffSide": "RIGHT", "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/AbstractStringProcessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNToyOVrOF2-4QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNToyOVrOF2-4QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5NzYzMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                throw new IllegalArgumentException(\"field [\" + field + \"] of type [\" + value.getClass().getName() +\n          \n          \n            \n                                    \"] cannot be cast to [\" + String.class.getName() + \"]\");\n          \n          \n            \n                                throw new IllegalArgumentException(\"value [\" + value + \"] of type [\" + value.getClass().getName() +\n          \n          \n            \n                                    \"] in list field [\" + field + \"] cannot be cast to [\" + String.class.getName() + \"]\");", "url": "https://github.com/elastic/elasticsearch/pull/53343#discussion_r393197633", "createdAt": "2020-03-16T17:35:29Z", "author": {"login": "danhermann"}, "path": "modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/AbstractStringProcessor.java", "diffHunk": "@@ -58,15 +60,38 @@ String getTargetField() {\n \n     @Override\n     public final IngestDocument execute(IngestDocument document) {\n-        String val = document.getFieldValue(field, String.class, ignoreMissing);\n+        Object val = document.getFieldValue(field, Object.class, ignoreMissing);\n+        Object newValue;\n \n         if (val == null && ignoreMissing) {\n             return document;\n         } else if (val == null) {\n             throw new IllegalArgumentException(\"field [\" + field + \"] is null, cannot process it.\");\n         }\n \n-        document.setFieldValue(targetField, process(val));\n+        if (val instanceof List) {\n+            List<?> list = (List<?>) val;\n+            List<Object> newList = new ArrayList<>(list.size());\n+            for (Object value : list) {\n+                if (value instanceof String) {\n+                    newList.add(process((String) value));\n+                } else {\n+                    throw new IllegalArgumentException(\"field [\" + field + \"] of type [\" + value.getClass().getName() +\n+                        \"] cannot be cast to [\" + String.class.getName() + \"]\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3080ca8ae877a586dbd9ec283c1faa67a21547ae"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3387, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}