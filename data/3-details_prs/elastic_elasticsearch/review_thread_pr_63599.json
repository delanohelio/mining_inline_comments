{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMTc5NTEx", "number": 63599, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo0NToyNVrOEtmAHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo0NToyNVrOEtmAHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2MjQzOTk5OnYy", "diffSide": "RIGHT", "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionArchiveSetupPlugin.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo0NToyNVrOHheOcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNzo1MDo1N1rOHhebsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2MDI3NA==", "bodyText": "Doesn't just depending on the configuration itself work? Why the need to explicitly reference the build dependencies?", "url": "https://github.com/elastic/elasticsearch/pull/63599#discussion_r504860274", "createdAt": "2020-10-14T17:45:25Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionArchiveSetupPlugin.java", "diffHunk": "@@ -85,11 +87,16 @@ private void registerAndConfigureDistributionArchivesExtension(Project project)\n             project.project(subProjectName, sub -> {\n                 sub.getPlugins().apply(BasePlugin.class);\n                 sub.getArtifacts().add(DEFAULT_CONFIGURATION_NAME, distributionArchive.getArchiveTask());\n-                var extractedConfiguration = sub.getConfigurations().create(\"extracted\");\n+                var extractedConfiguration = sub.getConfigurations().create(EXTRACTED_CONFIGURATION_NAME);\n                 extractedConfiguration.setCanBeResolved(false);\n                 extractedConfiguration.getAttributes().attribute(ARTIFACT_FORMAT, ArtifactTypeDefinition.DIRECTORY_TYPE);\n                 sub.getArtifacts().add(EXTRACTED_CONFIGURATION_NAME, distributionArchive.getExpandedDistTask());\n-\n+                sub.getTasks().register(\"extractedAssemble\", new Action<Task>() {\n+                    @Override\n+                    public void execute(Task task) {\n+                        task.dependsOn(extractedConfiguration.getAllArtifacts().getBuildDependencies());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7973156e4bc274470e49bf2de2f50fbf6d57ee4e"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2MzY2NQ==", "bodyText": "I think you're right \ud83e\udd26", "url": "https://github.com/elastic/elasticsearch/pull/63599#discussion_r504863665", "createdAt": "2020-10-14T17:50:57Z", "author": {"login": "breskeby"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/internal/InternalDistributionArchiveSetupPlugin.java", "diffHunk": "@@ -85,11 +87,16 @@ private void registerAndConfigureDistributionArchivesExtension(Project project)\n             project.project(subProjectName, sub -> {\n                 sub.getPlugins().apply(BasePlugin.class);\n                 sub.getArtifacts().add(DEFAULT_CONFIGURATION_NAME, distributionArchive.getArchiveTask());\n-                var extractedConfiguration = sub.getConfigurations().create(\"extracted\");\n+                var extractedConfiguration = sub.getConfigurations().create(EXTRACTED_CONFIGURATION_NAME);\n                 extractedConfiguration.setCanBeResolved(false);\n                 extractedConfiguration.getAttributes().attribute(ARTIFACT_FORMAT, ArtifactTypeDefinition.DIRECTORY_TYPE);\n                 sub.getArtifacts().add(EXTRACTED_CONFIGURATION_NAME, distributionArchive.getExpandedDistTask());\n-\n+                sub.getTasks().register(\"extractedAssemble\", new Action<Task>() {\n+                    @Override\n+                    public void execute(Task task) {\n+                        task.dependsOn(extractedConfiguration.getAllArtifacts().getBuildDependencies());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg2MDI3NA=="}, "originalCommit": {"oid": "7973156e4bc274470e49bf2de2f50fbf6d57ee4e"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2961, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}