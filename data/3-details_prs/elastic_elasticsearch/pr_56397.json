{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTQ2ODk5", "number": 56397, "title": "Don't allow invalid template combinations", "bodyText": "This commit removes the ability to put V2 index templates that reference missing component templates.\nIt also prevents removing component templates that are being referenced by an existing V2 index\ntemplate.\nRelates to #53101\nResolves #56314", "createdAt": "2020-05-07T22:14:36Z", "url": "https://github.com/elastic/elasticsearch/pull/56397", "merged": true, "mergeCommit": {"oid": "cad030d8d716cbcbd9444f9bdd60f0ff2e5c2855"}, "closed": true, "closedAt": "2020-05-14T21:33:35Z", "author": {"login": "dakrone"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfEx4HAH2gAyNDE0OTQ2ODk5OjIyMGVmZTk1NzQ5ZjA5ZTc2OGZlODU0ZDRlNWZkNjljMjdmOTU4OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchTxF2AH2gAyNDE0OTQ2ODk5Ojk2MTczNWRiNGRmOGNhN2I4MGNkYzQ4NTlhOWViNmM0NTRmYTBhODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "220efe95749f09e768fe854d4e5fd69c27f95890", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/220efe95749f09e768fe854d4e5fd69c27f95890", "committedDate": "2020-05-07T22:11:50Z", "message": "Don't allow invalid template combinations\n\nThis commit removes the ability to put V2 index templates that refence missing component templates.\nIt also prevents removing component templates that are being referenced by an existing V2 index\ntemplate.\n\nRelates to #53101\nResolves #56314"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08153db27170b8da4b8901590908a6cbb4701ebc", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/08153db27170b8da4b8901590908a6cbb4701ebc", "committedDate": "2020-05-08T16:28:37Z", "message": "Merge branch 'master' into itv2-dont-break-things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88cc81aecea36a775f3c7fd403cd003012c655b0", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/88cc81aecea36a775f3c7fd403cd003012c655b0", "committedDate": "2020-05-08T17:37:45Z", "message": "Fix docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b223d68cc9c3a193ac1c979d74d0df47570812db", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/b223d68cc9c3a193ac1c979d74d0df47570812db", "committedDate": "2020-05-08T18:01:35Z", "message": "Merge branch 'master' into itv2-dont-break-things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "562d085d7230772fa932ff7d7048b916755f1f79", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/562d085d7230772fa932ff7d7048b916755f1f79", "committedDate": "2020-05-08T20:13:32Z", "message": "Log error stacktrace during test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b3fdceb62dced8df39dd1e1852000627a14517f", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/6b3fdceb62dced8df39dd1e1852000627a14517f", "committedDate": "2020-05-08T20:41:58Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f38f675a1b6d56b011fa292456dda48967f1e2a7", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/f38f675a1b6d56b011fa292456dda48967f1e2a7", "committedDate": "2020-05-11T21:46:41Z", "message": "Merge branch 'master' into itv2-dont-break-things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a07b9fd998fd07e1c736d607d2007e096c18693", "author": {"user": {"login": "elasticmachine", "name": "Elastic Machine"}}, "url": "https://github.com/elastic/elasticsearch/commit/2a07b9fd998fd07e1c736d607d2007e096c18693", "committedDate": "2020-05-13T21:43:20Z", "message": "Merge branch 'master' into itv2-dont-break-things"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNjkwMTQw", "url": "https://github.com/elastic/elasticsearch/pull/56397#pullrequestreview-411690140", "createdAt": "2020-05-14T10:55:41Z", "commit": {"oid": "2a07b9fd998fd07e1c736d607d2007e096c18693"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMDcxNzg2", "url": "https://github.com/elastic/elasticsearch/pull/56397#pullrequestreview-412071786", "createdAt": "2020-05-14T18:21:49Z", "commit": {"oid": "2a07b9fd998fd07e1c736d607d2007e096c18693"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyMTo0OVrOGVo29g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxODoyMTo0OVrOGVo29g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MjcxMA==", "bodyText": "what do you think about renaming templateWildcard to nameOrWilldcard (or templateNameOrWildcard)", "url": "https://github.com/elastic/elasticsearch/pull/56397#discussion_r425342710", "createdAt": "2020-05-14T18:21:49Z", "author": {"login": "andreidan"}, "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataIndexTemplateService.java", "diffHunk": "@@ -291,6 +293,33 @@ public void clusterStateProcessed(String source, ClusterState oldState, ClusterS\n             });\n     }\n \n+    /**\n+     * Validates that the given component template is not used by any index\n+     * templates, throwing an error if it is still in use\n+     */\n+    static void validateNotInUse(Metadata metadata, String templateWildcard) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a07b9fd998fd07e1c736d607d2007e096c18693"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "284715a5607a0dc9d60de0b1ef991690b2f036d6", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/284715a5607a0dc9d60de0b1ef991690b2f036d6", "committedDate": "2020-05-14T20:47:20Z", "message": "Merge remote-tracking branch 'origin/master' into itv2-dont-break-things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "961735db4df8ca7b80cdc4859a9eb6c454fa0a88", "author": {"user": {"login": "dakrone", "name": "Lee Hinman"}}, "url": "https://github.com/elastic/elasticsearch/commit/961735db4df8ca7b80cdc4859a9eb6c454fa0a88", "committedDate": "2020-05-14T20:47:24Z", "message": "Rename parameter templateWildcard -> templateNameOrWildcard"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 247, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}