{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMDQzNzYz", "number": 58639, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNDo1MTowOFrOEJsi6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxOTo1NFrOEJtWwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjAyNDcyOnYy", "diffSide": "LEFT", "path": "modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/SearchAsYouTypeFieldMapperTests.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNDo1MTowOVrOGqUoOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMDowNDowMlrOGq1TMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzAzMTM1Mg==", "bodyText": "Could you comment on why you zapped these?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447031352", "createdAt": "2020-06-29T14:51:09Z", "author": {"login": "nik9000"}, "path": "modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/SearchAsYouTypeFieldMapperTests.java", "diffHunk": "@@ -669,21 +669,6 @@ public void testMatchPhrase() throws IOException {\n             assertThat(actual, equalTo(expected));\n         }\n \n-        // todo are these queries generated for the prefix field right?\n-        {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyMzMxNw==", "bodyText": "The answer to the TODO is 'no' - previously it was working 'accidentally' because if you set a search analyzer but not a search quote analyzer, then asking for the quote analyzer would fall back to the search analyzer.  However, queries against the prefix subfield should always be term queries (that's what the prefix subfield is for, converting prefixes to terms), and so the correct thing to do here is throw an exception.  Possibly it should be an assertion rather than an exception though?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447523317", "createdAt": "2020-06-30T08:54:36Z", "author": {"login": "romseygeek"}, "path": "modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/SearchAsYouTypeFieldMapperTests.java", "diffHunk": "@@ -669,21 +669,6 @@ public void testMatchPhrase() throws IOException {\n             assertThat(actual, equalTo(expected));\n         }\n \n-        // todo are these queries generated for the prefix field right?\n-        {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzAzMTM1Mg=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU2NjY0Mg==", "bodyText": "Turns out adding an assertion just means we assert false and then throw an IllegalArgumentException which seems a bit pointless.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447566642", "createdAt": "2020-06-30T10:04:02Z", "author": {"login": "romseygeek"}, "path": "modules/mapper-extras/src/test/java/org/elasticsearch/index/mapper/SearchAsYouTypeFieldMapperTests.java", "diffHunk": "@@ -669,21 +669,6 @@ public void testMatchPhrase() throws IOException {\n             assertThat(actual, equalTo(expected));\n         }\n \n-        // todo are these queries generated for the prefix field right?\n-        {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzAzMTM1Mg=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjA1Mjk4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/CompletionFieldMapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNDo1Njo1N1rOGqU5gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNDo1Njo1N1rOGqU5gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzAzNTc3Ng==", "bodyText": "If you are adding parameters like this you may as well run them through the formatter to save some diff when we apply it to everything one day.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447035776", "createdAt": "2020-06-29T14:56:57Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/CompletionFieldMapper.java", "diffHunk": "@@ -193,12 +194,17 @@ private NamedAnalyzer getNamedAnalyzer(ParserContext parserContext, String name)\n         private boolean preservePositionIncrements = Defaults.DEFAULT_POSITION_INCREMENTS;\n         private ContextMappings contextMappings = null;\n \n-        public CompletionFieldType(String name, FieldType luceneFieldType, Map<String, String> meta) {\n-            super(name, true, false, new TextSearchInfo(luceneFieldType, null), meta);\n+        public CompletionFieldType(String name, FieldType luceneFieldType,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjA4NzI3OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNTowNDozMlrOGqVO4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMDo1NjoyNlrOGq3DTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0MTI1MQ==", "bodyText": "Will this change the behavior when includeDefaults is true and there isn't a search_analyzer? I'm not familiar enough with the default values of everything to know. I think it is a least worth a comment about it here.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447041251", "createdAt": "2020-06-29T15:04:32Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java", "diffHunk": "@@ -420,7 +420,7 @@ protected void doXContentBody(XContentBuilder builder, boolean includeDefaults,\n     }\n \n     protected final void doXContentAnalyzers(XContentBuilder builder, boolean includeDefaults) throws IOException {\n-        if (fieldType.tokenized() == false) {\n+        if (fieldType.tokenized() == false || fieldType().getTextSearchInfo().getSearchAnalyzer() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyNTAwMA==", "bodyText": "It shouldn't do, because doXContentAnalyzers is only called from text-based field mappers, which ought to always have analyzers configured (if nothing is specified in config, then we'll end up with the default).  This should probably be an assertion again though.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447525000", "createdAt": "2020-06-30T08:57:12Z", "author": {"login": "romseygeek"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java", "diffHunk": "@@ -420,7 +420,7 @@ protected void doXContentBody(XContentBuilder builder, boolean includeDefaults,\n     }\n \n     protected final void doXContentAnalyzers(XContentBuilder builder, boolean includeDefaults) throws IOException {\n-        if (fieldType.tokenized() == false) {\n+        if (fieldType.tokenized() == false || fieldType().getTextSearchInfo().getSearchAnalyzer() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0MTI1MQ=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU5NTM0Mg==", "bodyText": "Turns out this is incorrect - it can return null here, in which case we need to use the default.  Which is all a bit of a pain, but will be cleaned up when we move mapper definitions to the Parametrized system.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447595342", "createdAt": "2020-06-30T10:56:26Z", "author": {"login": "romseygeek"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java", "diffHunk": "@@ -420,7 +420,7 @@ protected void doXContentBody(XContentBuilder builder, boolean includeDefaults,\n     }\n \n     protected final void doXContentAnalyzers(XContentBuilder builder, boolean includeDefaults) throws IOException {\n-        if (fieldType.tokenized() == false) {\n+        if (fieldType.tokenized() == false || fieldType().getTextSearchInfo().getSearchAnalyzer() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0MTI1MQ=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjEwMTg2OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/MappedFieldType.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNTowNzozOFrOGqVX5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwODo1ODo1MlrOGqy07w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0MzU1Nw==", "bodyText": "Should TestSearchInfo be in equals and hashCode?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447043557", "createdAt": "2020-06-29T15:07:38Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/MappedFieldType.java", "diffHunk": "@@ -119,15 +115,13 @@ public boolean equals(Object o) {\n             docValues == fieldType.docValues &&\n             Objects.equals(name, fieldType.name) &&\n             Objects.equals(indexAnalyzer, fieldType.indexAnalyzer) &&\n-            Objects.equals(searchAnalyzer, fieldType.searchAnalyzer) &&\n-            Objects.equals(searchQuoteAnalyzer(), fieldType.searchQuoteAnalyzer()) &&\n             Objects.equals(eagerGlobalOrdinals, fieldType.eagerGlobalOrdinals) &&\n             Objects.equals(meta, fieldType.meta);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyNjEyNw==", "bodyText": "equals and hashCode on MappedFieldType are basically useless now.  Previously we used them to check that fields with the same name defined on different types within a single index were identical, but we only have one type per index and this check doesn't exist any more since #58162 .  I'll open a separate issue to remove them.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447526127", "createdAt": "2020-06-30T08:58:52Z", "author": {"login": "romseygeek"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/MappedFieldType.java", "diffHunk": "@@ -119,15 +115,13 @@ public boolean equals(Object o) {\n             docValues == fieldType.docValues &&\n             Objects.equals(name, fieldType.name) &&\n             Objects.equals(indexAnalyzer, fieldType.indexAnalyzer) &&\n-            Objects.equals(searchAnalyzer, fieldType.searchAnalyzer) &&\n-            Objects.equals(searchQuoteAnalyzer(), fieldType.searchQuoteAnalyzer()) &&\n             Objects.equals(eagerGlobalOrdinals, fieldType.eagerGlobalOrdinals) &&\n             Objects.equals(meta, fieldType.meta);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0MzU1Nw=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjExNjE3OnYy", "diffSide": "LEFT", "path": "server/src/main/java/org/elasticsearch/index/mapper/KeywordFieldMapper.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxMDo0OVrOGqVgxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwOTowNTo1M1rOGqzFeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NTgzMA==", "bodyText": "Should we be able to change the search_analyzer like this?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447045830", "createdAt": "2020-06-29T15:10:49Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/KeywordFieldMapper.java", "diffHunk": "@@ -439,7 +426,6 @@ protected void mergeOptions(FieldMapper other, List<String> conflicts) {\n         }\n         this.ignoreAbove = k.ignoreAbove;\n         this.splitQueriesOnWhitespace = k.splitQueriesOnWhitespace;\n-        this.fieldType().setSearchAnalyzer(k.fieldType().searchAnalyzer());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzMDM2Mg==", "bodyText": "You can still update the search_analyzer - the MappedFieldType of the merged mapper is taken directly from the update, which includes TextSearchInfo and hence the new search analyzer.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447530362", "createdAt": "2020-06-30T09:05:53Z", "author": {"login": "romseygeek"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/KeywordFieldMapper.java", "diffHunk": "@@ -439,7 +426,6 @@ protected void mergeOptions(FieldMapper other, List<String> conflicts) {\n         }\n         this.ignoreAbove = k.ignoreAbove;\n         this.splitQueriesOnWhitespace = k.splitQueriesOnWhitespace;\n-        this.fieldType().setSearchAnalyzer(k.fieldType().searchAnalyzer());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NTgzMA=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjEyNjM3OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/TextFieldMapper.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxMzowMlrOGqVm6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwOTowNzo0N1rOGqzKLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NzQwMw==", "bodyText": "I generally feat protected mutable variables. What's up with this?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447047403", "createdAt": "2020-06-29T15:13:02Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/TextFieldMapper.java", "diffHunk": "@@ -129,7 +130,7 @@\n         private double fielddataMinFreq = Defaults.FIELDDATA_MIN_FREQUENCY;\n         private double fielddataMaxFreq = Defaults.FIELDDATA_MAX_FREQUENCY;\n         private int fielddataMinSegSize = Defaults.FIELDDATA_MIN_SEGMENT_SIZE;\n-        private SimilarityProvider similarity;\n+        protected SimilarityProvider similarity;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0ODExOA==", "bodyText": "I get that this is the builder, but do we plan to extend it or something? Everything else manages to be private which makes me less nervous.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447048118", "createdAt": "2020-06-29T15:14:04Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/TextFieldMapper.java", "diffHunk": "@@ -129,7 +130,7 @@\n         private double fielddataMinFreq = Defaults.FIELDDATA_MIN_FREQUENCY;\n         private double fielddataMaxFreq = Defaults.FIELDDATA_MAX_FREQUENCY;\n         private int fielddataMinSegSize = Defaults.FIELDDATA_MIN_SEGMENT_SIZE;\n-        private SimilarityProvider similarity;\n+        protected SimilarityProvider similarity;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NzQwMw=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzMTU2NA==", "bodyText": "It's extended by the AnnotatedTextFieldMapper and used there.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447531564", "createdAt": "2020-06-30T09:07:47Z", "author": {"login": "romseygeek"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/TextFieldMapper.java", "diffHunk": "@@ -129,7 +130,7 @@\n         private double fielddataMinFreq = Defaults.FIELDDATA_MIN_FREQUENCY;\n         private double fielddataMaxFreq = Defaults.FIELDDATA_MAX_FREQUENCY;\n         private int fielddataMinSegSize = Defaults.FIELDDATA_MIN_SEGMENT_SIZE;\n-        private SimilarityProvider similarity;\n+        protected SimilarityProvider similarity;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NzQwMw=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjEzMzY4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/elasticsearch/index/mapper/TextSearchInfo.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxNDo0M1rOGqVrhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxNDo0M1rOGqVrhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0ODU4Mg==", "bodyText": "Probably worth javadoc on this one too.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447048582", "createdAt": "2020-06-29T15:14:43Z", "author": {"login": "nik9000"}, "path": "server/src/main/java/org/elasticsearch/index/mapper/TextSearchInfo.java", "diffHunk": "@@ -40,15 +42,22 @@\n      *\n      * Note that the results of {@link #isStored()} for this may not be accurate\n      */\n-    public static final TextSearchInfo SIMPLE_MATCH_ONLY = new TextSearchInfo(SIMPLE_MATCH_ONLY_FIELD_TYPE, null);\n+    public static final TextSearchInfo SIMPLE_MATCH_ONLY\n+        = new TextSearchInfo(SIMPLE_MATCH_ONLY_FIELD_TYPE, null, Lucene.KEYWORD_ANALYZER, Lucene.KEYWORD_ANALYZER);\n+\n+    public static final TextSearchInfo WHITESPACE_MATCH_ONLY", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjE0MjQwOnYy", "diffSide": "LEFT", "path": "server/src/test/java/org/elasticsearch/index/mapper/KeywordFieldTypeTests.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxNjozOVrOGqVxEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwOTowODo1OVrOGqzNVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MDAwMQ==", "bodyText": "I think we used to be able to change these.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447050001", "createdAt": "2020-06-29T15:16:39Z", "author": {"login": "nik9000"}, "path": "server/src/test/java/org/elasticsearch/index/mapper/KeywordFieldTypeTests.java", "diffHunk": "@@ -55,28 +52,6 @@\n \n public class KeywordFieldTypeTests extends FieldTypeTestCase<KeywordFieldType> {\n \n-    @Before\n-    public void addModifiers() {\n-        addModifier(t -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzMjM3Mg==", "bodyText": "yeah, these Modifier tests are basically useless now", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447532372", "createdAt": "2020-06-30T09:08:59Z", "author": {"login": "romseygeek"}, "path": "server/src/test/java/org/elasticsearch/index/mapper/KeywordFieldTypeTests.java", "diffHunk": "@@ -55,28 +52,6 @@\n \n public class KeywordFieldTypeTests extends FieldTypeTestCase<KeywordFieldType> {\n \n-    @Before\n-    public void addModifiers() {\n-        addModifier(t -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MDAwMQ=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjE1MjA0OnYy", "diffSide": "LEFT", "path": "server/src/test/java/org/elasticsearch/search/suggest/AbstractSuggestionBuilderTestCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxODozOVrOGqV26g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxODozOVrOGqV26g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MTQ5OA==", "bodyText": "Nice to see that gone!", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447051498", "createdAt": "2020-06-29T15:18:39Z", "author": {"login": "nik9000"}, "path": "server/src/test/java/org/elasticsearch/search/suggest/AbstractSuggestionBuilderTestCase.java", "diffHunk": "@@ -161,19 +162,10 @@ public void testBuild() throws IOException {\n                     indexSettings);\n             MapperService mapperService = mock(MapperService.class);\n             ScriptService scriptService = mock(ScriptService.class);\n-            MappedFieldType fieldType = mockFieldType(suggestionBuilder.field());\n             boolean fieldTypeSearchAnalyzerSet = randomBoolean();\n-            if (fieldTypeSearchAnalyzerSet) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NjE1NzQ0OnYy", "diffSide": "LEFT", "path": "test/framework/src/main/java/org/elasticsearch/index/mapper/FieldTypeTestCase.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNToxOTo1NFrOGqV6TQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwOTo1NjoxOFrOGq1BIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MjM2NQ==", "bodyText": "Should we still test these on string fields?", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447052365", "createdAt": "2020-06-29T15:19:54Z", "author": {"login": "nik9000"}, "path": "test/framework/src/main/java/org/elasticsearch/index/mapper/FieldTypeTestCase.java", "diffHunk": "@@ -51,26 +48,6 @@\n             copy.setBoost(t.boost() + 1);\n             return (T) copy;\n         },\n-        t -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUzMjkyMA==", "bodyText": "actually yes, these should be moved to the relevent FieldMapper tests", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447532920", "createdAt": "2020-06-30T09:09:54Z", "author": {"login": "romseygeek"}, "path": "test/framework/src/main/java/org/elasticsearch/index/mapper/FieldTypeTestCase.java", "diffHunk": "@@ -51,26 +48,6 @@\n             copy.setBoost(t.boost() + 1);\n             return (T) copy;\n         },\n-        t -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MjM2NQ=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU2MjAxOQ==", "bodyText": "ah, they're already tested in FieldMapperTestCase.", "url": "https://github.com/elastic/elasticsearch/pull/58639#discussion_r447562019", "createdAt": "2020-06-30T09:56:18Z", "author": {"login": "romseygeek"}, "path": "test/framework/src/main/java/org/elasticsearch/index/mapper/FieldTypeTestCase.java", "diffHunk": "@@ -51,26 +48,6 @@\n             copy.setBoost(t.boost() + 1);\n             return (T) copy;\n         },\n-        t -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA1MjM2NQ=="}, "originalCommit": {"oid": "ddfaeec9afdff0554db9158423d5d5336faca001"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2227, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}