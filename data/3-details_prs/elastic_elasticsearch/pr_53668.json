{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5ODc1MjUx", "number": 53668, "title": "Fix potential bug in concurrent token refresh support", "bodyText": "Ensure that we do not proceed with execution after calling the\nlistener's onFailure", "createdAt": "2020-03-17T14:35:46Z", "url": "https://github.com/elastic/elasticsearch/pull/53668", "merged": true, "mergeCommit": {"oid": "bb89c62f3cdb6d3797b4f9715bf2b87bff172ca8"}, "closed": true, "closedAt": "2020-03-18T06:40:13Z", "author": {"login": "jkakavas"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOjfRBgH2gAyMzg5ODc1MjUxOjU3ZTkxYWYxNmM0MTFjMTQ2ZTE3NDI5NGQwODY2NGYyMWExZWRiYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOtGvpgFqTM3NjUwOTM3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "57e91af16c411c146e174294d08664f21a1edbbc", "author": {"user": {"login": "jkakavas", "name": "Ioannis Kakavas"}}, "url": "https://github.com/elastic/elasticsearch/commit/57e91af16c411c146e174294d08664f21a1edbbc", "committedDate": "2020-03-17T14:21:51Z", "message": "Fix potential bug in concurrent token refresh support\n\nEnsure that we do not proceed execution after calling the\nlisterer's onFailure"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTA5Mzc2", "url": "https://github.com/elastic/elasticsearch/pull/53668#pullrequestreview-376509376", "createdAt": "2020-03-18T01:33:55Z", "commit": {"oid": "57e91af16c411c146e174294d08664f21a1edbbc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMTozMzo1NVrOF3zhFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMTozMzo1NVrOF3zhFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA2MDA1Mw==", "bodyText": "This sure works. An alternative is to \"return\" immediately after \"onFailure\", which could be safer for future changes, e.g. a new statement is accidentally added below to this if-else block.", "url": "https://github.com/elastic/elasticsearch/pull/53668#discussion_r394060053", "createdAt": "2020-03-18T01:33:55Z", "author": {"login": "ywangd"}, "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java", "diffHunk": "@@ -1101,9 +1101,10 @@ void decryptAndReturnSupersedingTokens(String refreshToken, RefreshTokenStatus r\n             if (decryptedTokens.length != 2) {\n                 logger.warn(\"Decrypted tokens string is not correctly formatted\");\n                 listener.onFailure(invalidGrantException(\"could not refresh the requested token\"));\n+            } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e91af16c411c146e174294d08664f21a1edbbc"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1960, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}