{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2OTMzOTE5", "number": 51433, "title": "Install plugins in a single transaction in tests", "bodyText": "When building clusters for integration tests, today we install plugins sequentially. We recently introduced the ability to install plugins in a single invocation of the install plugin command. Using this can save substantial time starting up JVMs. This commit changes the build infrastructure to install multiple plugins at once when building clusters for integration tests.\nFor the docs integration tests in particular, where we install many plugins, this change makes a substantial difference. On my laptop, prior to this change, installing the plugins sequentially took 115 seconds. After this change, it takes 14 seconds.\nRelates #50924", "createdAt": "2020-01-24T17:11:14Z", "url": "https://github.com/elastic/elasticsearch/pull/51433", "merged": true, "mergeCommit": {"oid": "1f6960ffa8e8e731e42e3e64abad92d7c85301d6"}, "closed": true, "closedAt": "2020-01-24T18:11:00Z", "author": {"login": "jasontedor"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9iDvXAH2gAyMzY2OTMzOTE5OjdkMmIzMTA4MmMzYzhlNjU4MDRmNTc1OTBkYzQ1OWY5YTM2MTNkMGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9i1OWgFqTM0ODEyNTMxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7d2b31082c3c8e65804f57590dc459f9a3613d0f", "author": {"user": {"login": "jasontedor", "name": "Jason Tedor"}}, "url": "https://github.com/elastic/elasticsearch/commit/7d2b31082c3c8e65804f57590dc459f9a3613d0f", "committedDate": "2020-01-24T17:05:10Z", "message": "Install plugins in a single transaction in tests\n\nWhen building clusters for integration tests, today we install plugins\nsequentially. We recently introduced the ability to install plugins in a\nsingle invocation of the install plugin command. Using this can save\nsubstantial time starting up JVMs. This commit changes the build\ninfrastructure to install multiple plugins at once when building\nclusters for integration tests.\n\nFor the docs integration tests in particular, where we install many\nplugins, this change makes a substantial difference. On my laptop, prior\nto this change, installing the plugins sequentially took 115\nseconds. After this change, it takes 14 seconds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTAxNDE5", "url": "https://github.com/elastic/elasticsearch/pull/51433#pullrequestreview-348101419", "createdAt": "2020-01-24T17:15:24Z", "commit": {"oid": "7d2b31082c3c8e65804f57590dc459f9a3613d0f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoxNToyNVrOFhkj-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoxNToyNVrOFhkj-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0NjM2Mw==", "bodyText": "Is this intermediary collection really necessary? All it's doing is saving us a single toString() call later on.\nI mainly say that as it's a bit confusing. Having a separate \"plugins to install\" to me implies that this.plugins is some kind of superset of that, which isn't the case. We always install all configured plugins for the cluster.", "url": "https://github.com/elastic/elasticsearch/pull/51433#discussion_r370746363", "createdAt": "2020-01-24T17:15:25Z", "author": {"login": "mark-vieira"}, "path": "buildSrc/src/main/java/org/elasticsearch/gradle/testclusters/ElasticsearchNode.java", "diffHunk": "@@ -428,14 +428,27 @@ public synchronized void start() {\n \n         createConfiguration();\n \n+        final List<String> pluginsToInstall = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d2b31082c3c8e65804f57590dc459f9a3613d0f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTI1MzE2", "url": "https://github.com/elastic/elasticsearch/pull/51433#pullrequestreview-348125316", "createdAt": "2020-01-24T17:59:13Z", "commit": {"oid": "7d2b31082c3c8e65804f57590dc459f9a3613d0f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2725, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}