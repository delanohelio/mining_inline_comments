{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNzQ5NDI1", "number": 61505, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0ODo0N1rOEb_ijg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMTozMTozOFrOEcBmhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3Nzg4MDQ2OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportStartDataFrameAnalyticsAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0ODo0N1rOHGQeZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0ODo0N1rOHGQeZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMyMzQzMQ==", "bodyText": "Let's also update the comment here to say we're just warning when limit is lower than estimate", "url": "https://github.com/elastic/elasticsearch/pull/61505#discussion_r476323431", "createdAt": "2020-08-25T09:48:47Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportStartDataFrameAnalyticsAction.java", "diffHunk": "@@ -218,12 +219,13 @@ private void estimateMemoryUsageAndUpdateMemoryTracker(StartContext startContext\n                 // Validate that model memory limit is sufficient to run the analysis", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0494a2fb632691aa4a9c8f25c920e13779e28181"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3Nzg4MjQwOnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/messages/Messages.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwOTo0OToyMFrOHGQfnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMToyNzoxMFrOHGTlbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMyMzc0MA==", "bodyText": "Should we change \"may not run\" to \"may fail\" ?", "url": "https://github.com/elastic/elasticsearch/pull/61505#discussion_r476323740", "createdAt": "2020-08-25T09:49:20Z", "author": {"login": "dimitris-athanasiou"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/messages/Messages.java", "diffHunk": "@@ -66,6 +66,9 @@\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_UPDATED_STATE_WITH_REASON =\n             \"Updated analytics task state to [{0}] with reason [{1}]\";\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE = \"Estimated memory usage for this analytics to be [{0}]\";\n+    public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE_HIGHER_THAN_CONFIGURED =\n+        \"Configured model memory limit [{0}] is lower than the expected memory usage [{1}]. \" +\n+            \"The analytics job may not run due to configured memory constraints.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0494a2fb632691aa4a9c8f25c920e13779e28181"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM3NDM4Mw==", "bodyText": "Definitely!", "url": "https://github.com/elastic/elasticsearch/pull/61505#discussion_r476374383", "createdAt": "2020-08-25T11:27:10Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/messages/Messages.java", "diffHunk": "@@ -66,6 +66,9 @@\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_UPDATED_STATE_WITH_REASON =\n             \"Updated analytics task state to [{0}] with reason [{1}]\";\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE = \"Estimated memory usage for this analytics to be [{0}]\";\n+    public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE_HIGHER_THAN_CONFIGURED =\n+        \"Configured model memory limit [{0}] is lower than the expected memory usage [{1}]. \" +\n+            \"The analytics job may not run due to configured memory constraints.\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMyMzc0MA=="}, "originalCommit": {"oid": "0494a2fb632691aa4a9c8f25c920e13779e28181"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3ODIxNjI5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/messages/Messages.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMTozMDo1N1rOHGTsxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMTozMDo1N1rOHGTsxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM3NjI2Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"The analytics job may not run due to configured memory constraints.\";\n          \n          \n            \n                        \"The analytics job may fail due to configured memory constraints.\";", "url": "https://github.com/elastic/elasticsearch/pull/61505#discussion_r476376262", "createdAt": "2020-08-25T11:30:57Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/messages/Messages.java", "diffHunk": "@@ -66,6 +66,9 @@\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_UPDATED_STATE_WITH_REASON =\n             \"Updated analytics task state to [{0}] with reason [{1}]\";\n     public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE = \"Estimated memory usage for this analytics to be [{0}]\";\n+    public static final String DATA_FRAME_ANALYTICS_AUDIT_ESTIMATED_MEMORY_USAGE_HIGHER_THAN_CONFIGURED =\n+        \"Configured model memory limit [{0}] is lower than the expected memory usage [{1}]. \" +\n+            \"The analytics job may not run due to configured memory constraints.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0494a2fb632691aa4a9c8f25c920e13779e28181"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3ODIxODI5OnYy", "diffSide": "RIGHT", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportStartDataFrameAnalyticsAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMTozMTozOFrOHGTt-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMTozMTozOFrOHGTt-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM3NjU3MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // Validate that model memory limit is sufficient to run the analysis\n          \n          \n            \n                            // Validate that model memory limit is sufficient to run the analysis\n          \n          \n            \n                            // We will only warn the caller if the configured limit is too low.", "url": "https://github.com/elastic/elasticsearch/pull/61505#discussion_r476376571", "createdAt": "2020-08-25T11:31:38Z", "author": {"login": "benwtrent"}, "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportStartDataFrameAnalyticsAction.java", "diffHunk": "@@ -218,12 +219,13 @@ private void estimateMemoryUsageAndUpdateMemoryTracker(StartContext startContext\n                 // Validate that model memory limit is sufficient to run the analysis", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0494a2fb632691aa4a9c8f25c920e13779e28181"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 816, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}