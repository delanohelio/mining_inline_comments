{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNDI1ODY0", "number": 5147, "title": "Anomaly #26572: Convert lead into partner", "bodyText": "", "createdAt": "2020-03-18T13:09:19Z", "url": "https://github.com/axelor/axelor-open-suite/pull/5147", "merged": true, "mergeCommit": {"oid": "0e5d35745ffd2fbc70b0eea10e6b584ebf442f3c"}, "closed": true, "closedAt": "2020-03-24T14:01:11Z", "author": {"login": "msh-axelor"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPgUzjABqjMxNDkyNzA1Mzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQwk5ggBqjMxNTkwNzU2ODQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0d3aba87b49317e04ec08744559d310d0e30656", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/c0d3aba87b49317e04ec08744559d310d0e30656", "committedDate": "2020-03-18T13:07:18Z", "message": "Anomaly #26572: Convert lead into partner"}, "afterCommit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/0943e22f13a253d372b54f76a6d48d82b7b670aa", "committedDate": "2020-03-20T13:14:20Z", "message": "Anomaly #26572: Convert lead into partner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MzI2OTg0", "url": "https://github.com/axelor/axelor-open-suite/pull/5147#pullrequestreview-379326984", "createdAt": "2020-03-23T11:05:35Z", "commit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMTowNTozNVrOF6Agwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMTowNTo0N1rOF6AhMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3MDExNA==", "bodyText": "if using reference dummy field no need of setting name. directly set the object.", "url": "https://github.com/axelor/axelor-open-suite/pull/5147#discussion_r396370114", "createdAt": "2020-03-23T11:05:35Z", "author": {"login": "rch-axelor"}, "path": "axelor-crm/src/main/java/com/axelor/apps/crm/web/ConvertLeadWizardController.java", "diffHunk": "@@ -177,14 +177,14 @@ public void setDefaults(ActionRequest request, ActionResponse response) throws A\n \n     Lead lead = findLead(request);\n \n-    response.setAttr(\"$primaryAddress\", \"value\", lead.getPrimaryAddress());\n-    response.setAttr(\"$primaryCity\", \"value\", lead.getPrimaryCity());\n-    response.setAttr(\"$primaryState\", \"value\", lead.getPrimaryState());\n-    response.setAttr(\"$primaryPostalCode\", \"value\", lead.getPrimaryPostalCode());\n-    response.setAttr(\"$primaryCountry\", \"value\", lead.getPrimaryCountry());\n+    response.setAttr(\"$partner.$primaryAddress\", \"value\", lead.getPrimaryAddress());\n+    response.setAttr(\"$partner.$primaryCity\", \"value\", lead.getPrimaryCity().getName());\n+    response.setAttr(\"$partner.$primaryState\", \"value\", lead.getPrimaryState().getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3MDE3OA==", "bodyText": "City and state are not required field in lead so NPE will be there if empty.", "url": "https://github.com/axelor/axelor-open-suite/pull/5147#discussion_r396370178", "createdAt": "2020-03-23T11:05:41Z", "author": {"login": "rch-axelor"}, "path": "axelor-crm/src/main/java/com/axelor/apps/crm/web/ConvertLeadWizardController.java", "diffHunk": "@@ -177,14 +177,14 @@ public void setDefaults(ActionRequest request, ActionResponse response) throws A\n \n     Lead lead = findLead(request);\n \n-    response.setAttr(\"$primaryAddress\", \"value\", lead.getPrimaryAddress());\n-    response.setAttr(\"$primaryCity\", \"value\", lead.getPrimaryCity());\n-    response.setAttr(\"$primaryState\", \"value\", lead.getPrimaryState());\n-    response.setAttr(\"$primaryPostalCode\", \"value\", lead.getPrimaryPostalCode());\n-    response.setAttr(\"$primaryCountry\", \"value\", lead.getPrimaryCountry());\n+    response.setAttr(\"$partner.$primaryAddress\", \"value\", lead.getPrimaryAddress());\n+    response.setAttr(\"$partner.$primaryCity\", \"value\", lead.getPrimaryCity().getName());\n+    response.setAttr(\"$partner.$primaryState\", \"value\", lead.getPrimaryState().getName());\n+    response.setAttr(\"$partner.$primaryPostalCode\", \"value\", lead.getPrimaryPostalCode());\n+    response.setAttr(\"$partner.$primaryCountry\", \"value\", lead.getPrimaryCountry());\n     response.setAttr(\"$contactAddress\", \"value\", lead.getPrimaryAddress());\n-    response.setAttr(\"$contactCity\", \"value\", lead.getPrimaryCity());\n-    response.setAttr(\"$contactState\", \"value\", lead.getPrimaryState());\n+    response.setAttr(\"$contactCity\", \"value\", lead.getPrimaryCity().getName());\n+    response.setAttr(\"$contactState\", \"value\", lead.getPrimaryState().getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM3MDIyNQ==", "bodyText": "type=\"ManyToOne\" & target=\"\"", "url": "https://github.com/axelor/axelor-open-suite/pull/5147#discussion_r396370225", "createdAt": "2020-03-23T11:05:47Z", "author": {"login": "rch-axelor"}, "path": "axelor-crm/src/main/resources/views/ConvertLeadWizard.xml", "diffHunk": "@@ -34,21 +40,31 @@\n \t\t      \t\t</panel>\n \t      \t\t\t\n \t      \t\t\t<panel name=\"generalContactDetailsPanel\" title=\"General contact details\" colSpan=\"12\">\n-\t\t\t\t\t\t<field name=\"fixedPhone\" colSpan=\"3\" placeholder=\"+33100000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-fixedPhone\"/>\n-\t\t\t\t\t\t<field name=\"fax\" colSpan=\"3\" placeholder=\"+33000000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-fax\"/>\n-\t\t\t\t\t\t<field name=\"mobilePhone\" colSpan=\"3\" hideIf=\"partnerTypeSelect == 1\" placeholder=\"+33100000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-mobilePhone\"/>\n-\t\t\t\t\t\t<field name=\"emailAddress\" canSelect=\"false\" form-view=\"email-address-simple-form\"/>\n-\t\t\t\t\t\t<field name=\"webSite\" placeholder=\"www.url.com\" pattern=\"([^\\s]+\\.[^\\s]+\\.[^\\s]{2,})\"/>\n+\t      \t\t\t    <field name=\"mobilePhone\" colSpan=\"4\" hideIf=\"partnerTypeSelect == 1\" placeholder=\"+33100000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-mobilePhone\"/>\n+\t\t\t\t\t\t<field name=\"fixedPhone\" colSpan=\"4\" placeholder=\"+33100000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-fixedPhone\"/>\n+\t\t\t\t\t\t<field name=\"fax\" colSpan=\"4\" placeholder=\"+33000000000\" pattern=\"^\\+?([\\s()-.]*\\d){7,}$\" onChange=\"action-partner-method-normalize-fax\"/>\n+\t\t\t\t\t\t<field name=\"emailAddress\" canSelect=\"false\" form-view=\"email-address-simple-form\" colSpan=\"4\"/>\n+\t\t\t\t\t\t<field name=\"webSite\" placeholder=\"www.url.com\" pattern=\"([^\\s]+\\.[^\\s]+\\.[^\\s]{2,})\" colSpan=\"4\"/>\n \t\t\t\t\t</panel>\n \t      \t\t\t\n+\t      \t\t\t<panel name=\"addressPanel\" title=\"Primary address\" colSpan=\"12\">\n+\t\t\t          <field name=\"$primaryAddress\" placeholder=\"Address\" showTitle=\"false\" type=\"string\" colSpan=\"8\"/>\n+\t\t\t          <field name=\"$primaryPostalCode\" placeholder=\"Postal code\" showTitle=\"false\" type=\"string\" colSpan=\"4\"/>\n+\t\t\t          <field name=\"$primaryCity\" placeholder=\"City\" showTitle=\"false\" type=\"com.axelor.apps.base.db.City\" colSpan=\"4\"/>\n+\t\t\t          <field name=\"$primaryState\" placeholder=\"State\" showTitle=\"false\" type=\"com.axelor.apps.base.db.Region\" colSpan=\"4\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa"}, "originalPosition": 45}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0943e22f13a253d372b54f76a6d48d82b7b670aa", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/0943e22f13a253d372b54f76a6d48d82b7b670aa", "committedDate": "2020-03-20T13:14:20Z", "message": "Anomaly #26572: Convert lead into partner"}, "afterCommit": {"oid": "88b9d59fad500a3eaecb3df58c1f220535e0151a", "author": {"user": {"login": "mga-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/88b9d59fad500a3eaecb3df58c1f220535e0151a", "committedDate": "2020-03-02T16:56:36Z", "message": "RM#26145\n\nIn supplychain-stock-details-by-product-form, company now autofill with user's active company when this view entry is from menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6799a6973fc4af46366bdddd6dae0aeb00eb7425", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/6799a6973fc4af46366bdddd6dae0aeb00eb7425", "committedDate": "2020-03-24T10:43:58Z", "message": "Anomaly #26572: Convert lead into partner"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce9a21172118cf7fa7f469ad458ffd5b288766b8", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/ce9a21172118cf7fa7f469ad458ffd5b288766b8", "committedDate": "2020-03-24T09:24:51Z", "message": "Anomaly #26572: Convert lead into partner"}, "afterCommit": {"oid": "6799a6973fc4af46366bdddd6dae0aeb00eb7425", "author": {"user": {"login": "msh-axelor", "name": null}}, "url": "https://github.com/axelor/axelor-open-suite/commit/6799a6973fc4af46366bdddd6dae0aeb00eb7425", "committedDate": "2020-03-24T10:43:58Z", "message": "Anomaly #26572: Convert lead into partner"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1993, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}