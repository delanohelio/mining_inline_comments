{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4Mzc5MDky", "number": 3872, "title": "[GSoC] Added Unit Tests and Fixed Landscape Mode Bug", "bodyText": "Description\nFixes #3870\nFixed the bug where the incomplete list was shown on landscape mode in the leaderboard.\nAdded Unit Tests for API calls.\nTests performed\nTested betaDebug on Google Pixel 2 with API level 29", "createdAt": "2020-07-13T17:02:38Z", "url": "https://github.com/commons-app/apps-android-commons/pull/3872", "merged": true, "mergeCommit": {"oid": "5877d7a14aa2e2621e5bcf62cd90f1514a96404c"}, "closed": true, "closedAt": "2020-07-15T17:53:49Z", "author": {"login": "madhurgupta10"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxpyjnAH2gAyNDQ4Mzc5MDkyOjhiMTU4NjNkN2E1Nzk0YmUwOTMwOGYwYzNlNTkyNDMxYjdjM2E3MGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1K1GTgFqTQ0ODk2NDExNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8b15863d7a5794be09308f0c3e592431b7c3a70b", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/8b15863d7a5794be09308f0c3e592431b7c3a70b", "committedDate": "2020-07-04T15:29:42Z", "message": "Fixes #3861 Use the APIs to fetch leaderboard\u2019s based on uploads via mobile app (all time) and display it in the Leaderboard screen."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0104a76c52330c2f0343379ef48ddd06493941e6", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/0104a76c52330c2f0343379ef48ddd06493941e6", "committedDate": "2020-07-12T14:54:12Z", "message": "Merge remote-tracking branch 'upstream/leaderboard' into leaderboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "089c1537f91fe7dfedb81a5340f140f11e30b3d1", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/089c1537f91fe7dfedb81a5340f140f11e30b3d1", "committedDate": "2020-07-12T15:22:16Z", "message": "Fixed Bug - missing data in landscape mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/ce30c8f1f3c94cd304de05ec578b4e64332d6995", "committedDate": "2020-07-13T16:58:16Z", "message": "Added Unit Tests for Leaderboard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NDM1ODQ3", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#pullrequestreview-447435847", "createdAt": "2020-07-13T17:02:41Z", "commit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3Njg3OTEy", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#pullrequestreview-447687912", "createdAt": "2020-07-13T23:43:20Z", "commit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMzo0MzoyMFrOGw-rQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMzo0MzoyMFrOGw-rQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxMTcxMg==", "bodyText": "As a javadoc here, please say what class (or what method of what class) is being tested. Thanks!", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#discussion_r454011712", "createdAt": "2020-07-13T23:43:20Z", "author": {"login": "nicolas-raoul"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/leaderboard/LeaderboardApiTest.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package fr.free.nrw.commons.leaderboard;\n+\n+import com.google.gson.Gson;\n+import fr.free.nrw.commons.profile.leaderboard.LeaderboardResponse;\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import okhttp3.HttpUrl;\n+import okhttp3.OkHttpClient;\n+import okhttp3.Request;\n+import okhttp3.Request.Builder;\n+import okhttp3.Response;\n+import okhttp3.mockwebserver.MockResponse;\n+import okhttp3.mockwebserver.MockWebServer;\n+import org.junit.After;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+public class LeaderboardApiTest {\n+\n+    MockWebServer server;\n+    private static final String TEST_USERNAME = \"user\";\n+    private static final String TEST_AVATAR = \"avatar\";\n+    private static final int TEST_USER_RANK = 1;\n+    private static final int TEST_USER_COUNT = 0;\n+\n+    private static final String FILE_NAME = \"leaderboard_sample_response.json\";\n+    private static final String ENDPOINT = \"/leaderboard.py\";\n+\n+    @Before\n+    public void initTest() {\n+        server = new MockWebServer();\n+    }\n+\n+    @Before\n+    public void setUp() throws Exception {\n+\n+        String testResponseBody = convertStreamToString(getClass().getClassLoader().getResourceAsStream(FILE_NAME));\n+\n+        server.enqueue(new MockResponse().setBody(testResponseBody));\n+        server.start();\n+    }\n+\n+    private static String convertStreamToString(InputStream is) throws Exception {\n+        BufferedReader reader = new BufferedReader(new InputStreamReader(is));\n+        StringBuilder sb = new StringBuilder();\n+        String line;\n+        while ((line = reader.readLine()) != null) {\n+            sb.append(line).append(\"\\n\");\n+        }\n+        reader.close();\n+        return sb.toString();\n+    }\n+\n+    @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NzEwNTg0", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#pullrequestreview-447710584", "createdAt": "2020-07-14T00:51:51Z", "commit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTQxOTI0", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#pullrequestreview-447941924", "createdAt": "2020-07-14T09:28:34Z", "commit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyODozNFrOGxLwnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyODozNFrOGxLwnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNjA3OQ==", "bodyText": "Please add Javadocs for all new classes that you create :) This applies for methods as well, although we tend to allow exceptions for simple methods like getters and setters.", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#discussion_r454226079", "createdAt": "2020-07-14T09:28:34Z", "author": {"login": "misaochan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/leaderboard/LeaderboardApiTest.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package fr.free.nrw.commons.leaderboard;\n+\n+import com.google.gson.Gson;\n+import fr.free.nrw.commons.profile.leaderboard.LeaderboardResponse;\n+import java.io.BufferedReader;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import okhttp3.HttpUrl;\n+import okhttp3.OkHttpClient;\n+import okhttp3.Request;\n+import okhttp3.Request.Builder;\n+import okhttp3.Response;\n+import okhttp3.mockwebserver.MockResponse;\n+import okhttp3.mockwebserver.MockWebServer;\n+import org.junit.After;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce30c8f1f3c94cd304de05ec578b4e64332d6995"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fca9e940f1e9219ccd4df5fb645896164747439", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/3fca9e940f1e9219ccd4df5fb645896164747439", "committedDate": "2020-07-14T13:06:42Z", "message": "Added JavaDocs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b2b7ade203e043066766bf3dc35db26b471c1d3", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/4b2b7ade203e043066766bf3dc35db26b471c1d3", "committedDate": "2020-07-14T13:16:35Z", "message": "Updated JavaDocs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4OTY0MTE2", "url": "https://github.com/commons-app/apps-android-commons/pull/3872#pullrequestreview-448964116", "createdAt": "2020-07-15T13:41:07Z", "commit": {"oid": "4b2b7ade203e043066766bf3dc35db26b471c1d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 513, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}