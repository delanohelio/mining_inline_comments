{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MjgzMDI0", "number": 3528, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNTowMFrODopCNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyODo1NlrODopIIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQxOTQzOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNTowMFrOF3T7zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNTowMFrOF3T7zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjYwNA==", "bodyText": "Unnecessary whitespace?", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393542604", "createdAt": "2020-03-17T09:25:00Z", "author": {"login": "misaochan"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+\n+class SpinnerLanguagesAdapter constructor(\n+    context: Context,\n+    private val selectedLanguages: BiMap<*, String>\n+) : ArrayAdapter<Any?>(context, -1) {\n+\n+    private val languageNamesList: List<String>\n+    private val languageCodesList: List<String>\n+\n+    init {\n+        val sortedLanguages =\n+            Locale.getAvailableLocales().map(::Language).sortedBy { it.locale.displayName }\n+        languageNamesList = sortedLanguages.map { it.locale.displayName }\n+        languageCodesList = sortedLanguages.map { it.locale.language }\n+    }\n+\n+    var selectedLangCode = \"\"\n+\n+    override fun isEnabled(position: Int) = languageCodesList[position].let {\n+        it.isNotEmpty() && !(selectedLanguages.containsKey(it) || it == selectedLangCode)\n+    }\n+\n+    override fun getCount() = languageNamesList.size\n+\n+    override fun getDropDownView(position: Int, convertView: View?, parent: ViewGroup) =\n+        (convertView ?: parent.inflate(R.layout.row_item_languages_spinner).also {\n+            it.tag = DropDownViewHolder(it)\n+        }).apply {\n+            (tag as DropDownViewHolder).init(\n+                languageCodesList[position],\n+                languageNamesList[position],\n+                selectedLanguages,\n+                selectedLangCode\n+            )\n+        }\n+\n+    override fun getView(position: Int, convertView: View?, parent: ViewGroup) =\n+        (convertView ?: parent.inflate(R.layout.row_item_languages_spinner).also {\n+            it.tag = SpinnerViewHolder(it)\n+        }).apply { (tag as SpinnerViewHolder).init(languageCodesList[position]) }\n+\n+    class SpinnerViewHolder(override val containerView: View) : LayoutContainer {\n+        fun init(languageCode: String) {\n+            LangCodeUtils.fixLanguageCode(languageCode).let {\n+                tv_language.text = if (it.length > 2) it.take(2) else it\n+            }\n+        }\n+    }\n+\n+    class DropDownViewHolder(override val containerView: View) : LayoutContainer {\n+        fun init(\n+            languageCode: String,\n+            languageName: String,\n+            selectedLanguages: BiMap<*, String>,\n+            selectedLangCode: String\n+        ) {\n+            tv_language.isEnabled =\n+                !(selectedLanguages.containsKey(languageCode) && languageCode != selectedLangCode)\n+            if (languageCode.isEmpty()) {\n+                tv_language.text = StringUtils.capitalize(languageName)\n+                tv_language.textAlignment = View.TEXT_ALIGNMENT_CENTER\n+            } else {\n+                tv_language.text =\n+                    \"${StringUtils.capitalize(languageName)}\" +\n+                            \" [${LangCodeUtils.fixLanguageCode(languageCode)}]\"\n+            }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQyNzE1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNjo1N1rOF3UAmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMTowNjoxNVrOF3Xa0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MzgzMw==", "bodyText": "Could we get Javadocs for new classes please? They should definitely have been in the original to begin with, but we have to start somewhere - if we are rewriting an entire class I think it is a good time to start including Javadocs as well.", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393543833", "createdAt": "2020-03-17T09:26:57Z", "author": {"login": "misaochan"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU3NzEzNQ==", "bodyText": "Is this satisfactory? I would never have written javadocs for any sustained length of time as every company I have worked in loathed them", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393577135", "createdAt": "2020-03-17T10:24:52Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MzgzMw=="}, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU5OTY5Ng==", "bodyText": "Yes, thank you! :)", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393599696", "createdAt": "2020-03-17T11:06:15Z", "author": {"login": "misaochan"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MzgzMw=="}, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQyNzkyOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNzoxMlrOF3UBIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNzoxMlrOF3UBIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0Mzk3MA==", "bodyText": "Unnecessary whitespace?", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393543970", "createdAt": "2020-03-17T09:27:12Z", "author": {"login": "misaochan"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+\n+class SpinnerLanguagesAdapter constructor(\n+    context: Context,\n+    private val selectedLanguages: BiMap<*, String>\n+) : ArrayAdapter<Any?>(context, -1) {\n+\n+    private val languageNamesList: List<String>\n+    private val languageCodesList: List<String>\n+\n+    init {\n+        val sortedLanguages =\n+            Locale.getAvailableLocales().map(::Language).sortedBy { it.locale.displayName }\n+        languageNamesList = sortedLanguages.map { it.locale.displayName }\n+        languageCodesList = sortedLanguages.map { it.locale.language }\n+    }\n+\n+    var selectedLangCode = \"\"\n+\n+    override fun isEnabled(position: Int) = languageCodesList[position].let {\n+        it.isNotEmpty() && !(selectedLanguages.containsKey(it) || it == selectedLangCode)\n+    }\n+\n+    override fun getCount() = languageNamesList.size\n+\n+    override fun getDropDownView(position: Int, convertView: View?, parent: ViewGroup) =\n+        (convertView ?: parent.inflate(R.layout.row_item_languages_spinner).also {\n+            it.tag = DropDownViewHolder(it)\n+        }).apply {\n+            (tag as DropDownViewHolder).init(\n+                languageCodesList[position],\n+                languageNamesList[position],\n+                selectedLanguages,\n+                selectedLangCode\n+            )\n+        }\n+\n+    override fun getView(position: Int, convertView: View?, parent: ViewGroup) =\n+        (convertView ?: parent.inflate(R.layout.row_item_languages_spinner).also {\n+            it.tag = SpinnerViewHolder(it)\n+        }).apply { (tag as SpinnerViewHolder).init(languageCodesList[position]) }\n+\n+    class SpinnerViewHolder(override val containerView: View) : LayoutContainer {\n+        fun init(languageCode: String) {\n+            LangCodeUtils.fixLanguageCode(languageCode).let {\n+                tv_language.text = if (it.length > 2) it.take(2) else it\n+            }\n+        }\n+    }\n+\n+    class DropDownViewHolder(override val containerView: View) : LayoutContainer {\n+        fun init(\n+            languageCode: String,\n+            languageName: String,\n+            selectedLanguages: BiMap<*, String>,\n+            selectedLangCode: String\n+        ) {\n+            tv_language.isEnabled =\n+                !(selectedLanguages.containsKey(languageCode) && languageCode != selectedLangCode)\n+            if (languageCode.isEmpty()) {\n+                tv_language.text = StringUtils.capitalize(languageName)\n+                tv_language.textAlignment = View.TEXT_ALIGNMENT_CENTER\n+            } else {\n+                tv_language.text =\n+                    \"${StringUtils.capitalize(languageName)}\" +\n+                            \" [${LangCodeUtils.fixLanguageCode(languageCode)}]\"\n+            }\n+\n+        }\n+    }\n+\n+    fun getLanguageCode(position: Int): String {\n+        return languageCodesList[position]\n+    }\n+\n+    fun getIndexOfUserDefaultLocale(context: Context): Int {\n+        return languageCodesList.indexOf(context.locale.language)\n+    }\n+\n+    fun getIndexOfLanguageCode(languageCode: String): Int {\n+        return languageCodesList.indexOf(languageCode)\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 98}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQzNDU5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyODo1NlrOF3UFWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTo0Mzo1NFrOF3Umwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0NTA0OA==", "bodyText": "Does our codestyle mandate a specific line length? I find that this sort of formatting tends to hinder readability instead of helping it, but if the codestyle itself specifies this then I could be wrong.", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393545048", "createdAt": "2020-03-17T09:28:56Z", "author": {"login": "misaochan"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+\n+class SpinnerLanguagesAdapter constructor(\n+    context: Context,\n+    private val selectedLanguages: BiMap<*, String>\n+) : ArrayAdapter<Any?>(context, -1) {\n+\n+    private val languageNamesList: List<String>\n+    private val languageCodesList: List<String>\n+\n+    init {\n+        val sortedLanguages =\n+            Locale.getAvailableLocales().map(::Language).sortedBy { it.locale.displayName }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU1MzYwMg==", "bodyText": "Codestyle specifies it, link", "url": "https://github.com/commons-app/apps-android-commons/pull/3528#discussion_r393553602", "createdAt": "2020-03-17T09:43:54Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/upload/SpinnerLanguagesAdapter.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package fr.free.nrw.commons.upload\n+\n+import android.content.Context\n+import android.view.LayoutInflater\n+import android.view.View\n+import android.view.ViewGroup\n+import android.widget.ArrayAdapter\n+import androidx.annotation.LayoutRes\n+import androidx.core.os.ConfigurationCompat\n+import fr.free.nrw.commons.R\n+import fr.free.nrw.commons.utils.BiMap\n+import fr.free.nrw.commons.utils.LangCodeUtils\n+import kotlinx.android.extensions.LayoutContainer\n+import kotlinx.android.synthetic.main.row_item_languages_spinner.*\n+import org.apache.commons.lang3.StringUtils\n+import java.util.*\n+\n+class SpinnerLanguagesAdapter constructor(\n+    context: Context,\n+    private val selectedLanguages: BiMap<*, String>\n+) : ArrayAdapter<Any?>(context, -1) {\n+\n+    private val languageNamesList: List<String>\n+    private val languageCodesList: List<String>\n+\n+    init {\n+        val sortedLanguages =\n+            Locale.getAvailableLocales().map(::Language).sortedBy { it.locale.displayName }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0NTA0OA=="}, "originalCommit": {"oid": "0a0140ecfb403ca009db9cb23ee6b3aa0db4c5ff"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4215, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}