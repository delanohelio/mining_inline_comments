{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4ODY5ODUy", "number": 3521, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMTowM1rODoP9QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNDo0NFrODopB0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNTMxMDczOnYy", "diffSide": "LEFT", "path": "app/src/main/res/xml/preferences.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMTowM1rOF2ruRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzozNjo1M1rOF2-7hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4Mzc4Mw==", "bodyText": "Delete these classes now that they are no longer used and in their place use app:singleLineTitle=\"false\"", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r392883783", "createdAt": "2020-03-16T09:31:03Z", "author": {"login": "macgills"}, "path": "app/src/main/res/xml/preferences.xml", "diffHunk": "@@ -1,99 +1,97 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n-<PreferenceScreen\n-    xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+  xmlns:android=\"http://schemas.android.com/apk/res/android\">\n \n-    <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitlePreferenceCategory\n-        android:title=\"@string/preference_category_appearance\">\n+    <PreferenceCategory\n+      android:title=\"@string/preference_category_appearance\">\n \n-        <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitleListPreference", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5ODQ2OA==", "bodyText": "Done!", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393198468", "createdAt": "2020-03-16T17:36:53Z", "author": {"login": "madhurgupta10"}, "path": "app/src/main/res/xml/preferences.xml", "diffHunk": "@@ -1,99 +1,97 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n-<PreferenceScreen\n-    xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+  xmlns:android=\"http://schemas.android.com/apk/res/android\">\n \n-    <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitlePreferenceCategory\n-        android:title=\"@string/preference_category_appearance\">\n+    <PreferenceCategory\n+      android:title=\"@string/preference_category_appearance\">\n \n-        <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitleListPreference", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4Mzc4Mw=="}, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNTMxNDIzOnYy", "diffSide": "RIGHT", "path": "app/build.gradle", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMjowMlrOF2rwew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo0NTozM1rOF2_QGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4NDM0Nw==", "bodyText": "move this into gradle.properties and follow their style", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r392884347", "createdAt": "2020-03-16T09:32:02Z", "author": {"login": "macgills"}, "path": "app/build.gradle", "diffHunk": "@@ -110,6 +110,13 @@ dependencies {\n     implementation 'com.squareup.retrofit2:retrofit:2.7.1'\n     implementation \"androidx.room:room-rxjava2:$room_version\"\n     testImplementation \"androidx.arch.core:core-testing:2.1.0\"\n+\n+    // Pref\n+    def preference_version = \"1.1.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIwMzczNw==", "bodyText": "Done!", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393203737", "createdAt": "2020-03-16T17:45:33Z", "author": {"login": "madhurgupta10"}, "path": "app/build.gradle", "diffHunk": "@@ -110,6 +110,13 @@ dependencies {\n     implementation 'com.squareup.retrofit2:retrofit:2.7.1'\n     implementation \"androidx.room:room-rxjava2:$room_version\"\n     testImplementation \"androidx.arch.core:core-testing:2.1.0\"\n+\n+    // Pref\n+    def preference_version = \"1.1.0\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4NDM0Nw=="}, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTMzMzU1OnYy", "diffSide": "LEFT", "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTowMDoxOFrOF3TFPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToxNjo0M1rOF3TpAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ==", "bodyText": "I suspect this is a behaviour change", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393528639", "createdAt": "2020-03-17T09:00:18Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -195,19 +167,14 @@ private void prepareLanguages() {\n         String languageCode = getCurrentLanguageCode();\n         if (languageCode.equals(\"\")){\n             // If current language code is empty, means none selected by user yet so use phone local\n-            langListPreference.setSummary(Locale.getDefault().getDisplayLanguage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 212}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMDU5MQ==", "bodyText": "I tested it for me it seems fine. I will revert this change if needed.", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393530591", "createdAt": "2020-03-17T09:03:50Z", "author": {"login": "madhurgupta10"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -195,19 +167,14 @@ private void prepareLanguages() {\n         String languageCode = getCurrentLanguageCode();\n         if (languageCode.equals(\"\")){\n             // If current language code is empty, means none selected by user yet so use phone local\n-            langListPreference.setSummary(Locale.getDefault().getDisplayLanguage());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ=="}, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 212}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNzc5NA==", "bodyText": "Nope, I was wrong. Works great", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393537794", "createdAt": "2020-03-17T09:16:43Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -195,19 +167,14 @@ private void prepareLanguages() {\n         String languageCode = getCurrentLanguageCode();\n         if (languageCode.equals(\"\")){\n             // If current language code is empty, means none selected by user yet so use phone local\n-            langListPreference.setSummary(Locale.getDefault().getDisplayLanguage());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ=="}, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 212}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTQxODQwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNDo0NFrOF3T7LQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMjoyOToyMVrOF3aDdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjQ0NQ==", "bodyText": "This variables has an overly broad scope, I would even say you could inline (cursor on the variable name, ctrl+alt+n or right click>refactor>inline) it and the other variables you just disable when not logged in because their variable names are just repeating their Pref keys, the varaible name doesn't help describe them better so I think findPreference(\"useAuthorName\").setEnabled(false) reads just as well", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393542445", "createdAt": "2020-03-17T09:24:44Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -49,29 +44,21 @@\n     private ListPreference langListPreference;\n \n     @Override\n-    public void onCreate(Bundle savedInstanceState) {\n-        super.onCreate(savedInstanceState);\n+    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n         ApplicationlessInjection\n-                .getInstance(getActivity().getApplicationContext())\n-                .getCommonsApplicationComponent()\n-                .inject(this);\n+            .getInstance(getActivity().getApplicationContext())\n+            .getCommonsApplicationComponent()\n+            .inject(this);\n \n-        // Load the preferences from an XML resource\n-        addPreferencesFromResource(R.xml.preferences);\n+        // Set the preferences from an XML resource\n+        setPreferencesFromResource(R.xml.preferences, rootKey);\n \n-        themeListPreference = (ListPreference) findPreference(Prefs.KEY_THEME_VALUE);\n+        themeListPreference = findPreference(Prefs.KEY_THEME_VALUE);\n         prepareTheme();\n \n-        //Check if the Author Name switch is enabled and appropriately handle the author name usage\n-        SwitchPreference useAuthorName = (SwitchPreference) findPreference(\"useAuthorName\");\n-        EditTextPreference authorName = (EditTextPreference) findPreference(\"authorName\");\n-        authorName.setEnabled(defaultKvStore.getBoolean(\"useAuthorName\", false));\n-        useAuthorName.setOnPreferenceChangeListener((preference, newValue) -> {\n-            authorName.setEnabled((Boolean)newValue);\n-            return true;\n-        });\n+        SwitchPreference useAuthorName = findPreference(\"useAuthorName\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY0Mjg3MQ==", "bodyText": "Done!", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393642871", "createdAt": "2020-03-17T12:29:21Z", "author": {"login": "madhurgupta10"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -49,29 +44,21 @@\n     private ListPreference langListPreference;\n \n     @Override\n-    public void onCreate(Bundle savedInstanceState) {\n-        super.onCreate(savedInstanceState);\n+    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n         ApplicationlessInjection\n-                .getInstance(getActivity().getApplicationContext())\n-                .getCommonsApplicationComponent()\n-                .inject(this);\n+            .getInstance(getActivity().getApplicationContext())\n+            .getCommonsApplicationComponent()\n+            .inject(this);\n \n-        // Load the preferences from an XML resource\n-        addPreferencesFromResource(R.xml.preferences);\n+        // Set the preferences from an XML resource\n+        setPreferencesFromResource(R.xml.preferences, rootKey);\n \n-        themeListPreference = (ListPreference) findPreference(Prefs.KEY_THEME_VALUE);\n+        themeListPreference = findPreference(Prefs.KEY_THEME_VALUE);\n         prepareTheme();\n \n-        //Check if the Author Name switch is enabled and appropriately handle the author name usage\n-        SwitchPreference useAuthorName = (SwitchPreference) findPreference(\"useAuthorName\");\n-        EditTextPreference authorName = (EditTextPreference) findPreference(\"authorName\");\n-        authorName.setEnabled(defaultKvStore.getBoolean(\"useAuthorName\", false));\n-        useAuthorName.setOnPreferenceChangeListener((preference, newValue) -> {\n-            authorName.setEnabled((Boolean)newValue);\n-            return true;\n-        });\n+        SwitchPreference useAuthorName = findPreference(\"useAuthorName\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjQ0NQ=="}, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 89}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4206, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}