{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNzA0OTc1", "number": 3853, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMToyOFrOELBidg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowODo0M1rOELZ6AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk0OTk4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMToyOFrOGsaFDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMToyOFrOGsaFDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxNzgwNA==", "bodyText": "For the API to actually return the categoryinfo in the requests made by the app you should do this\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        + \"&generator=allcategories\")\n          \n          \n            \n                        + \"&generator=allcategories&prop=categoryinfo\")", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449217804", "createdAt": "2020-07-02T19:11:28Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "diffHunk": "@@ -33,9 +33,11 @@\n      */\n     @GET(\"w/api.php?action=query&format=json&formatversion=2\"\n             + \"&generator=allcategories\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk1MTM4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMTo1NlrOGsaF4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMTo1NlrOGsaF4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxODAxNw==", "bodyText": "Revert these whitespace changes.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449218017", "createdAt": "2020-07-02T19:11:56Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "diffHunk": "@@ -33,9 +33,11 @@\n      */\n     @GET(\"w/api.php?action=query&format=json&formatversion=2\"\n             + \"&generator=allcategories\")\n+\n     Single<MwQueryResponse> searchCategoriesForPrefix(@Query(\"gacprefix\") String prefix,\n                                                           @Query(\"gaclimit\") int itemLimit, @Query(\"gacoffset\") int offset);\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk1MjgxOnYy", "diffSide": "RIGHT", "path": "data-client/src/main/java/org/wikipedia/dataclient/mwapi/MwQueryPage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMjoyMVrOGsaGxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMjoyMVrOGsaGxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxODI0Nw==", "bodyText": "Revert this whitespace change too.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449218247", "createdAt": "2020-07-02T19:12:21Z", "author": {"login": "sivaraam"}, "path": "data-client/src/main/java/org/wikipedia/dataclient/mwapi/MwQueryPage.java", "diffHunk": "@@ -194,6 +210,9 @@ String source() {\n         }\n     }\n \n+\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk1NDc1OnYy", "diffSide": "RIGHT", "path": "data-client/src/main/java/org/wikipedia/dataclient/mwapi/MwQueryPage.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzowMVrOGsaH8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzowMVrOGsaH8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxODU0Nw==", "bodyText": "Revert this removal of the newline too.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449218547", "createdAt": "2020-07-02T19:13:01Z", "author": {"login": "sivaraam"}, "path": "data-client/src/main/java/org/wikipedia/dataclient/mwapi/MwQueryPage.java", "diffHunk": "@@ -234,4 +253,4 @@ public boolean hidden() {\n         @SuppressWarnings(\"unused\") private List<String> alias;\n         @SuppressWarnings(\"unused\") private List<String> label;\n     }\n-}\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk1NTc5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryClient.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzoyNFrOGsaImg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzoyNFrOGsaImg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxODcxNA==", "bodyText": "Revert this removal of the newline.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449218714", "createdAt": "2020-07-02T19:13:24Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryClient.kt", "diffHunk": "@@ -92,8 +92,9 @@ class CategoryClient @Inject constructor(private val categoryInterface: Category\n                 it.query()?.pages() ?: emptyList()\n             }\n             .map {\n-                it.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }\n+                it.filter { page -> !page.categoryInfo().isHidden\n+                }.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }\n             }\n     }\n \n-}\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTk1NjUwOnYy", "diffSide": "RIGHT", "path": "data-client/src/main/java/org/wikipedia/search/SearchResults.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzozOVrOGsaJAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxOToxMzozOVrOGsaJAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIxODgxOQ==", "bodyText": "Revert changes to this file.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449218819", "createdAt": "2020-07-02T19:13:39Z", "author": {"login": "sivaraam"}, "path": "data-client/src/main/java/org/wikipedia/search/SearchResults.java", "diffHunk": "@@ -60,5 +60,4 @@ public SearchResults(@NonNull List<MwQueryPage> pages, @NonNull WikiSite wiki,\n     @Nullable public Map<String, String> getContinuation() {\n         return continuation;\n     }\n-}\n-\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b316aaf0cd1eb2af2310de0925e73585d327ebcd"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzkzOTcwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryClient.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNDoyM1rOGs9tfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNDoyM1rOGs9tfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTU5Nw==", "bodyText": "I think we need to be careful here as the categoryInfo object wouldn't be present in all the responses that are handled by responseMapper. So, we should do this:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            it.filter { page -> !page.categoryInfo().isHidden\n          \n          \n            \n                            }.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }\n          \n          \n            \n                            it.filter {\n          \n          \n            \n                                page -> page.categoryInfo() == null || !page.categoryInfo().isHidden\n          \n          \n            \n                            }.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }\n          \n      \n    \n    \n  \n\nNot handling this is likely a reason for the tests failing in Travis CI.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449801597", "createdAt": "2020-07-04T20:04:23Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryClient.kt", "diffHunk": "@@ -92,8 +92,8 @@ class CategoryClient @Inject constructor(private val categoryInterface: Category\n                 it.query()?.pages() ?: emptyList()\n             }\n             .map {\n-                it.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }\n+                it.filter { page -> !page.categoryInfo().isHidden\n+                }.map { page -> page.title().replace(CATEGORY_PREFIX, \"\") }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83aad510dde4105cf3be293da75886f7e1accce5"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzk0MDIzOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNTowN1rOGs9tuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNTowN1rOGs9tuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTY1Nw==", "bodyText": "Remove this additional new line.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449801657", "createdAt": "2020-07-04T20:05:07Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "diffHunk": "@@ -32,10 +32,11 @@\n      * @return\n      */\n     @GET(\"w/api.php?action=query&format=json&formatversion=2\"\n-            + \"&generator=allcategories\")\n+            + \"&generator=allcategories&prop=categoryinfo\")\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83aad510dde4105cf3be293da75886f7e1accce5"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzk0MDUyOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNToyNlrOGs9t2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowNToyNlrOGs9t2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTY5MA==", "bodyText": "Remove this needless whitespace.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449801690", "createdAt": "2020-07-04T20:05:26Z", "author": {"login": "sivaraam"}, "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryInterface.java", "diffHunk": "@@ -32,10 +32,11 @@\n      * @return\n      */\n     @GET(\"w/api.php?action=query&format=json&formatversion=2\"\n-            + \"&generator=allcategories\")\n+            + \"&generator=allcategories&prop=categoryinfo\")\n+\n     Single<MwQueryResponse> searchCategoriesForPrefix(@Query(\"gacprefix\") String prefix,\n                                                           @Query(\"gaclimit\") int itemLimit, @Query(\"gacoffset\") int offset);\n-\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83aad510dde4105cf3be293da75886f7e1accce5"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzk0MjQwOnYy", "diffSide": "RIGHT", "path": "data-client/src/main/java/org/wikipedia/search/SearchResults.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowODo0M1rOGs9uvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDowODo0M1rOGs9uvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTkxNw==", "bodyText": "I don't see any need for this file to be changed. So, revert the changes to this file. You could use the following commands to revert the changes in this file:\ngit fetch origin\ngit checkout origin/master -- data-client/src/main/java/org/wikipedia/search/SearchResults.java\nAssuming origin points to this repo.", "url": "https://github.com/commons-app/apps-android-commons/pull/3853#discussion_r449801917", "createdAt": "2020-07-04T20:08:43Z", "author": {"login": "sivaraam"}, "path": "data-client/src/main/java/org/wikipedia/search/SearchResults.java", "diffHunk": "@@ -35,7 +35,7 @@ public SearchResults() {\n      * @param suggestion a search suggestion to show to the user: \"Did you mean ...?\"\n      */\n     public SearchResults(@NonNull List<MwQueryPage> pages, @NonNull WikiSite wiki,\n-                         @Nullable Map<String, String> continuation, @Nullable String suggestion) {\n+        @Nullable Map<String, String> continuation, @Nullable String suggestion) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83aad510dde4105cf3be293da75886f7e1accce5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4377, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}