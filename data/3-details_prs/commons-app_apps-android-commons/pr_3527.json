{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MjY1NzI5", "number": 3527, "title": "Fix p18 issue For an item with P18 item, do not add another one", "bodyText": "Description (required)\nFixes #3333 For an item with P18 item, do not add another one.\nIt checks if an item has image or not. If it has an image (green dots on the map) then even if we upload from the map, our upload is a regular commons upload (does not edit wikidata image property). If the wikidata item doesnt have the image, then our upload form map will fill the image property.\n**Tests\nTested on a real device, wit android 9. Both cases are tested with upload flows, they worked as expected.", "createdAt": "2020-03-16T14:11:56Z", "url": "https://github.com/commons-app/apps-android-commons/pull/3527", "merged": true, "mergeCommit": {"oid": "e5d5a7af92f75318b3355333f571cb43a1a9ea2d"}, "closed": true, "closedAt": "2020-03-17T10:35:22Z", "author": {"login": "neslihanturan"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM9SzLgH2gAyMzg5MjY1NzI5OjAxZDQ3Y2ZlM2NlYjUwNWM4ZGExODkwMmU5MjczZDk5NTQwNDhlMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOgOBbAFqTM3NTkxMTUzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "01d47cfe3ceb505c8da18902e9273d9954048e22", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/01d47cfe3ceb505c8da18902e9273d9954048e22", "committedDate": "2020-03-12T15:17:55Z", "message": "Add p18value variable to contrib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a59e063fd26d0c7999d0184ce3b2ffbd1066955", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/3a59e063fd26d0c7999d0184ce3b2ffbd1066955", "committedDate": "2020-03-12T15:19:42Z", "message": "set place.pic to candidate contribution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "196cb9d7959e13df55b9da3381d4ebc7b0054653", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/196cb9d7959e13df55b9da3381d4ebc7b0054653", "committedDate": "2020-03-16T14:05:23Z", "message": "Add p18 value to contrib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "048e519d93b21e5b45d1c8faa32ac179d154f862", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/048e519d93b21e5b45d1c8faa32ac179d154f862", "committedDate": "2020-03-16T14:06:57Z", "message": "Passes p18 value to wikidata upload service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ca94073711f10b79427934739d25988f2088645", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/9ca94073711f10b79427934739d25988f2088645", "committedDate": "2020-03-16T14:07:47Z", "message": "Checks if pic parameter of the wikidata item is empty or not. If not, it does not overrides the existing image, it is just a regular commons upload."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MjUzNTQ4", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#pullrequestreview-375253548", "createdAt": "2020-03-16T14:12:00Z", "commit": {"oid": "9ca94073711f10b79427934739d25988f2088645"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MjcwMDM2", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#pullrequestreview-375270036", "createdAt": "2020-03-16T14:27:59Z", "commit": {"oid": "9ca94073711f10b79427934739d25988f2088645"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDoyNzo1OVrOF224bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNDoyNzo1OVrOF224bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA2NjYwNg==", "bodyText": "Why is it public when it has a getter and a setter?", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393066606", "createdAt": "2020-03-16T14:27:59Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/contributions/Contribution.java", "diffHunk": "@@ -68,6 +68,7 @@ public Contribution createFromParcel(Parcel parcel) {\n     public String decimalCoords;\n     public boolean isMultiple;\n     public String wikiDataEntityId;\n+    public String p18Value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ca94073711f10b79427934739d25988f2088645"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDE2NTQ3", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#pullrequestreview-375416547", "createdAt": "2020-03-16T17:05:39Z", "commit": {"oid": "9ca94073711f10b79427934739d25988f2088645"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "662db929beb6238bb12d6b80cc13d5ee5eaeaa6b", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/662db929beb6238bb12d6b80cc13d5ee5eaeaa6b", "committedDate": "2020-03-16T17:55:55Z", "message": "Make public var private"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60e6224c58a5ec9347567062851bd42009607cc8", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/60e6224c58a5ec9347567062851bd42009607cc8", "committedDate": "2020-03-16T17:59:18Z", "message": "Make current tests pass"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "286823566b49b3240ce5cc36c0bb3fa574af7fdf", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/286823566b49b3240ce5cc36c0bb3fa574af7fdf", "committedDate": "2020-03-16T18:03:39Z", "message": "Add test case for p18 value is not empty"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1ODM0OTcw", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#pullrequestreview-375834970", "createdAt": "2020-03-17T08:46:03Z", "commit": {"oid": "286823566b49b3240ce5cc36c0bb3fa574af7fdf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0NjowM1rOF3SmgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0NjowM1rOF3SmgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDc2OQ==", "bodyText": "This log is lying, this isn't \"not null\" it is \"not blank\"(to borrow the expression from the kotlin standard library), if this method accepts null values for the p18 then this is a guaranteed NPE", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#discussion_r393520769", "createdAt": "2020-03-17T08:46:03Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/wikidata/WikidataEditService.java", "diffHunk": "@@ -64,6 +64,11 @@ public void createClaimWithLogging(String wikidataEntityId, String fileName) {\n             return;\n         }\n \n+        if (!p18Value.trim().isEmpty()) {\n+            Timber.d(\"Skipping creation of claim as p18Value is not null, we won't override existing image\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "286823566b49b3240ce5cc36c0bb3fa574af7fdf"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82950aa74ae182f95ea7e1328b27476515606483", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/82950aa74ae182f95ea7e1328b27476515606483", "committedDate": "2020-03-17T09:06:53Z", "message": "Fix wrong log message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "325919a0695e96c134ab0ee97cd17fe326aff3c4", "author": {"user": {"login": "neslihanturan", "name": "neslihanturan"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/325919a0695e96c134ab0ee97cd17fe326aff3c4", "committedDate": "2020-03-17T09:59:59Z", "message": "Add nonnul annotation and fix method javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1OTExNTM1", "url": "https://github.com/commons-app/apps-android-commons/pull/3527#pullrequestreview-375911535", "createdAt": "2020-03-17T10:33:18Z", "commit": {"oid": "325919a0695e96c134ab0ee97cd17fe326aff3c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 435, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}