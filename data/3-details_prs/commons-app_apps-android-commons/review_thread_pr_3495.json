{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2ODU1MjEy", "number": 3495, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NjoyNlrODnYSGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzozOTo1OFrODneBuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNjE4OTA3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NjoyNlrOF1V32Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NjoyNlrOF1V32Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzIwOQ==", "bodyText": "If the creator name is null, I think it is better to raise an exception as\nthrow new RuntimeException(\"Failed to nominate for deletion\"); instead of appending edits to the page of \"https://commons.wikimedia.org/wiki/User_talk:page does not exist\". So please raise the exception instead of filling the null string with \"page not exist\"", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477209", "createdAt": "2020-03-12T08:56:26Z", "author": {"login": "neslihanturan"}, "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "diffHunk": "@@ -111,7 +114,7 @@ public DeleteHelper(NotificationHelper notificationHelper,\n                     throw new RuntimeException(\"Failed to nominate for deletion\");\n                 }).flatMap(result -> {\n                     if (result) {\n-                        return pageEditClient.appendEdit(\"User_Talk:\" + username, userPageString + \"\\n\", summary);\n+                        return pageEditClient.appendEdit(\"User_Talk:\" + creatorName, userPageString + \"\\n\", summary);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNjE5MDYyOnYy", "diffSide": "RIGHT", "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1Njo1NFrOF1V40Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1Njo1NFrOF1V40Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzQ1Nw==", "bodyText": "Please remove this instead of comment out:)", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477457", "createdAt": "2020-03-12T08:56:54Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -14,7 +16,7 @@ import org.mockito.InjectMocks\n import org.mockito.Mock\n import org.mockito.Mockito.`when`\n import org.mockito.MockitoAnnotations\n-import org.wikipedia.AppAdapter\n+//import org.wikipedia.AppAdapter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNjE5MTUyOnYy", "diffSide": "RIGHT", "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NzoxNVrOF1V5aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NzoxNVrOF1V5aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzYxMQ==", "bodyText": "This tests should be updated after the acual code changed", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477611", "createdAt": "2020-03-12T08:57:15Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +67,13 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\";\n+        `when`(media?.getCreator()).thenReturn(\"$creatorName (page does not exist)\")\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNzEyMDM3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzozNzoxOFrOF1e45Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzozNzoxOFrOF1e45Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNDkzMw==", "bodyText": "We use braces even if it is single line statement:)", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391624933", "createdAt": "2020-03-12T13:37:18Z", "author": {"login": "neslihanturan"}, "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "diffHunk": "@@ -98,6 +98,11 @@ public DeleteHelper(NotificationHelper notificationHelper,\n         String userPageString = \"\\n{{subst:idw|\" + media.getFilename() +\n                 \"}} ~~~~\";\n \n+        String creator = media.getCreator();\n+        if (creator == null || creator.isEmpty())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNzEzMDE3OnYy", "diffSide": "RIGHT", "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzozOTo1OFrOF1e_Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNzo0MDoyNFrOF1ouNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA==", "bodyText": "I assume this variable can be deleted now", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391626558", "createdAt": "2020-03-12T13:39:58Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyODAwMQ==", "bodyText": "And related parts of test should be updated", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391628001", "createdAt": "2020-03-12T13:42:16Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA=="}, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY2MDI2NA==", "bodyText": "Thanks for your help @neslihanturan :)\nI'm new to tests, sorry. Why those variables should be deleted? I added them to make it clear  that creator name can consist of two parts: name itself and suffix \"page does not exist\" if user hasn't created page yet. And the suffix should be stripped from the string in order to post correct notification to creator, which I check with verify(pageEditClient)?.appendEdit(eq(\"User_Talk:$creatorName\"), ArgumentMatchers.anyString(), ArgumentMatchers.anyString())", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391660264", "createdAt": "2020-03-12T14:29:47Z", "author": {"login": "VitalyVPinchuk"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA=="}, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY3NjQyMA==", "bodyText": "noPageSuffix is only used in one place, we use variables to give a clearer meaning to some data or to reuse some data.\nYou can keep creatorName", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391676420", "createdAt": "2020-03-12T14:52:55Z", "author": {"login": "macgills"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA=="}, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc4NjAzOA==", "bodyText": "Okay, thanks", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391786038", "createdAt": "2020-03-12T17:40:24Z", "author": {"login": "VitalyVPinchuk"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA=="}, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4182, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}