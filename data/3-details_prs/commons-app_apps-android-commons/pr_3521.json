{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4ODY5ODUy", "number": 3521, "title": "Fixes #3465 Use AndroidX Pref", "bodyText": "Description\nFixes #3465 Use AndroidX Pref\nTests performed\nTested betaDebug on Google Pixel 2 with API level 29", "createdAt": "2020-03-15T23:23:34Z", "url": "https://github.com/commons-app/apps-android-commons/pull/3521", "merged": true, "mergeCommit": {"oid": "15bccdf650f76b9367865f15a7054824537b8200"}, "closed": true, "closedAt": "2020-03-17T13:10:27Z", "author": {"login": "madhurgupta10"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOCAt-gH2gAyMzg4ODY5ODUyOjRmMDRkMzFkYTMxNGRhYTBlMjM5YTM3YTdlNGVjNTMxYzY4MTEwOGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOiXBAAFqTM3NjAxMTI5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/4f04d31da314daa0e239a37a7e4ec531c681108f", "committedDate": "2020-03-15T23:21:37Z", "message": "[WIP] Fixes #3465 Use AndroidX Pref"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDM3Nzkx", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-375037791", "createdAt": "2020-03-16T09:31:02Z", "commit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMTowM1rOF2ruRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMTowM1rOF2ruRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4Mzc4Mw==", "bodyText": "Delete these classes now that they are no longer used and in their place use app:singleLineTitle=\"false\"", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r392883783", "createdAt": "2020-03-16T09:31:03Z", "author": {"login": "macgills"}, "path": "app/src/main/res/xml/preferences.xml", "diffHunk": "@@ -1,99 +1,97 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n-<PreferenceScreen\n-    xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+<PreferenceScreen xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+  xmlns:android=\"http://schemas.android.com/apk/res/android\">\n \n-    <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitlePreferenceCategory\n-        android:title=\"@string/preference_category_appearance\">\n+    <PreferenceCategory\n+      android:title=\"@string/preference_category_appearance\">\n \n-        <fr.free.nrw.commons.ui.LongTitlePreferences.LongTitleListPreference", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MDM4NTMy", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-375038532", "createdAt": "2020-03-16T09:32:02Z", "commit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMjowMlrOF2rwew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQwOTozMjowMlrOF2rwew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg4NDM0Nw==", "bodyText": "move this into gradle.properties and follow their style", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r392884347", "createdAt": "2020-03-16T09:32:02Z", "author": {"login": "macgills"}, "path": "app/build.gradle", "diffHunk": "@@ -110,6 +110,13 @@ dependencies {\n     implementation 'com.squareup.retrofit2:retrofit:2.7.1'\n     implementation \"androidx.room:room-rxjava2:$room_version\"\n     testImplementation \"androidx.arch.core:core-testing:2.1.0\"\n+\n+    // Pref\n+    def preference_version = \"1.1.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f04d31da314daa0e239a37a7e4ec531c681108f"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9f454372ff70dcbb149e5a714f0b01ad0190166", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/c9f454372ff70dcbb149e5a714f0b01ad0190166", "committedDate": "2020-03-16T16:59:39Z", "message": "Deleted Unused Files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07618c8ad3dddf144381f6e052277f8b42e70a2e", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/07618c8ad3dddf144381f6e052277f8b42e70a2e", "committedDate": "2020-03-16T17:16:39Z", "message": "Added singleLineTitle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "812de25842c0b89ecaff36186fbd1b2beed52009", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/812de25842c0b89ecaff36186fbd1b2beed52009", "committedDate": "2020-03-16T17:44:58Z", "message": "Updated Gradle Properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/6438e537752a963e3bddfdcb0ec73d3ec86a46e7", "committedDate": "2020-03-16T21:11:06Z", "message": "Migrated to Androidx"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1ODQ0NzE5", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-375844719", "createdAt": "2020-03-17T09:00:17Z", "commit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTowMDoxOFrOF3TFPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOTowMDoxOFrOF3TFPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyODYzOQ==", "bodyText": "I suspect this is a behaviour change", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393528639", "createdAt": "2020-03-17T09:00:18Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -195,19 +167,14 @@ private void prepareLanguages() {\n         String languageCode = getCurrentLanguageCode();\n         if (languageCode.equals(\"\")){\n             // If current language code is empty, means none selected by user yet so use phone local\n-            langListPreference.setSummary(Locale.getDefault().getDisplayLanguage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 212}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1ODYyMDY5", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-375862069", "createdAt": "2020-03-17T09:24:44Z", "commit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNDo0NFrOF3T7LQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwOToyNDo0NFrOF3T7LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjQ0NQ==", "bodyText": "This variables has an overly broad scope, I would even say you could inline (cursor on the variable name, ctrl+alt+n or right click>refactor>inline) it and the other variables you just disable when not logged in because their variable names are just repeating their Pref keys, the varaible name doesn't help describe them better so I think findPreference(\"useAuthorName\").setEnabled(false) reads just as well", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#discussion_r393542445", "createdAt": "2020-03-17T09:24:44Z", "author": {"login": "macgills"}, "path": "app/src/main/java/fr/free/nrw/commons/settings/SettingsFragment.java", "diffHunk": "@@ -49,29 +44,21 @@\n     private ListPreference langListPreference;\n \n     @Override\n-    public void onCreate(Bundle savedInstanceState) {\n-        super.onCreate(savedInstanceState);\n+    public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n         ApplicationlessInjection\n-                .getInstance(getActivity().getApplicationContext())\n-                .getCommonsApplicationComponent()\n-                .inject(this);\n+            .getInstance(getActivity().getApplicationContext())\n+            .getCommonsApplicationComponent()\n+            .inject(this);\n \n-        // Load the preferences from an XML resource\n-        addPreferencesFromResource(R.xml.preferences);\n+        // Set the preferences from an XML resource\n+        setPreferencesFromResource(R.xml.preferences, rootKey);\n \n-        themeListPreference = (ListPreference) findPreference(Prefs.KEY_THEME_VALUE);\n+        themeListPreference = findPreference(Prefs.KEY_THEME_VALUE);\n         prepareTheme();\n \n-        //Check if the Author Name switch is enabled and appropriately handle the author name usage\n-        SwitchPreference useAuthorName = (SwitchPreference) findPreference(\"useAuthorName\");\n-        EditTextPreference authorName = (EditTextPreference) findPreference(\"authorName\");\n-        authorName.setEnabled(defaultKvStore.getBoolean(\"useAuthorName\", false));\n-        useAuthorName.setOnPreferenceChangeListener((preference, newValue) -> {\n-            authorName.setEnabled((Boolean)newValue);\n-            return true;\n-        });\n+        SwitchPreference useAuthorName = findPreference(\"useAuthorName\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6438e537752a963e3bddfdcb0ec73d3ec86a46e7"}, "originalPosition": 89}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e96fc10f8aa4f94e6d0cc4f66c96df1b07597487", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/e96fc10f8aa4f94e6d0cc4f66c96df1b07597487", "committedDate": "2020-03-17T12:29:10Z", "message": "Inline Variable change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f629c09154fd1c6c75153304d8b0ea8643299f46", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/f629c09154fd1c6c75153304d8b0ea8643299f46", "committedDate": "2020-03-17T12:30:28Z", "message": "optimise imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1OTkyMTcz", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-375992173", "createdAt": "2020-03-17T12:36:01Z", "commit": {"oid": "f629c09154fd1c6c75153304d8b0ea8643299f46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3069f3deba74b97ccda2b7e7fd0fdcaccfe44d3", "author": {"user": {"login": "madhurgupta10", "name": "Madhur Gupta"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/f3069f3deba74b97ccda2b7e7fd0fdcaccfe44d3", "committedDate": "2020-03-17T12:47:27Z", "message": "Fixed Crash on empty input"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MDExMjk2", "url": "https://github.com/commons-app/apps-android-commons/pull/3521#pullrequestreview-376011296", "createdAt": "2020-03-17T13:02:56Z", "commit": {"oid": "f3069f3deba74b97ccda2b7e7fd0fdcaccfe44d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 429, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}