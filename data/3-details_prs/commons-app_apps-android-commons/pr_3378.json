{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNjQ2OTAx", "number": 3378, "title": "Fixes #3295: Ultimate achievement: Too many contributions", "bodyText": "Fixes: Ultimate achievement: Too many contributions\nFixes #3295 Ultimate achievement: Too many contributions (making our script time out)\nWhat changes did you make and why?\nMade changes to Achievements activity as follows:\n\nDo nothing If The request for achievement calculation succeeds\nIf the response for number of achievements is null and edit count>150,000 then display Ultimate achievement message ( since the high number edits would have created problem with achievement calculation)\nIf request for achievements times out and edit count > 150,000 then too display the ultimate achievement message (since the high number of edits might have caused request to time out )\n\nTests performed\nTested ProdDebug on pixel 3a with API level 28.", "createdAt": "2020-02-06T00:09:33Z", "url": "https://github.com/commons-app/apps-android-commons/pull/3378", "merged": true, "mergeCommit": {"oid": "7450b44ab771f9ff8fdf88b78340076259aa9043"}, "closed": true, "closedAt": "2020-03-08T17:09:39Z", "author": {"login": "kbhardwaj123"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBfUpegFqTM1NDEyNzkxOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLsfhRAFqTM3MDg0NDY2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MTI3OTE5", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#pullrequestreview-354127919", "createdAt": "2020-02-06T00:09:37Z", "commit": {"oid": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODY0MDQ3", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#pullrequestreview-366864047", "createdAt": "2020-03-01T14:45:05Z", "commit": {"oid": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxNDo0NTowNlrOFwOg1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxNDo0ODo0OVrOFwOh8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjExMzc1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                numberOfEdits += edits;\n          \n          \n            \n                                numberOfEdits = edits;", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#discussion_r386113751", "createdAt": "2020-03-01T14:45:06Z", "author": {"login": "domdomegg"}, "path": "app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java", "diffHunk": "@@ -259,7 +274,10 @@ private void setWikidataEditCount() {\n                 .getWikidataEdits(userName)\n                 .subscribeOn(Schedulers.io())\n                 .observeOn(AndroidSchedulers.mainThread())\n-                .subscribe(edits -> wikidataEditsText.setText(String.valueOf(edits)), e -> {\n+                .subscribe(edits -> {\n+                    numberOfEdits += edits;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjExMzkwOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              <string name=\"achievements_fetch_failed_ultimate_achievement\">Congratulations!, Your achievements are so high that they break out achievements calculator. This is the Ultimate Achievement.</string>\n          \n          \n            \n              <string name=\"achievements_fetch_failed_ultimate_achievement\">Congratulations! You've made so many contributions our achievements calculation system can't cope. This is the ultimate achievement.</string>\n          \n      \n    \n    \n  \n\n(or other wording - main thing is just not having the !,)", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#discussion_r386113909", "createdAt": "2020-03-01T14:46:56Z", "author": {"login": "domdomegg"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -459,6 +459,7 @@ Upload your first media by tapping on the add button.</string>\n   <string name=\"display_location_permission_title\">Display location permission</string>\n   <string name=\"display_location_permission_explanation\">Ask for location permission when needed for nearby notification card view feature.</string>\n   <string name=\"achievements_fetch_failed\">Something went wrong, We could not fetch your achievements</string>\n+  <string name=\"achievements_fetch_failed_ultimate_achievement\">Congratulations!, Your achievements are so high that they break out achievements calculator. This is the Ultimate Achievement.</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjExNDAzMw==", "bodyText": "nit: Making this just showSnackBarWithRetry(int numberOfEdits), which would remove a lot of duplicate logic.", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#discussion_r386114033", "createdAt": "2020-03-01T14:48:49Z", "author": {"login": "domdomegg"}, "path": "app/src/main/java/fr/free/nrw/commons/achievements/AchievementsActivity.java", "diffHunk": "@@ -274,6 +292,17 @@ private void showSnackBarWithRetry() {\n                 R.string.achievements_fetch_failed, R.string.retry, view -> setAchievements());\n     }\n \n+    /**\n+     * Shows a snack bar which tells the users that their wiki edit count is so high that it (in some cases)\n+     * wreks havoc with the Achievements calculator due to which request may time out\n+     * Well this is the Ultimate Achievement \n+     */\n+    private void showSnackBarUltimateAchievementWithRetry() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c626bab5ac9356572366b1ad4aeae33a3ac1ebbb"}, "originalPosition": 68}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNzk5NzMx", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#pullrequestreview-370799731", "createdAt": "2020-03-08T02:09:56Z", "commit": {"oid": "bc1aa8d2cdba418f0ed6457c823a7846a3259785"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccfe44ae7aa604bff5f0e44449c7e474d3c5f6fd", "author": {"user": {"login": "kbhardwaj123", "name": "Kshitij Bhardwaj"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/ccfe44ae7aa604bff5f0e44449c7e474d3c5f6fd", "committedDate": "2020-03-08T14:49:30Z", "message": "fixing travis ci failed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c60f777ef75203dc42d173039a46be1df7db6f6", "author": {"user": {"login": "kbhardwaj123", "name": "Kshitij Bhardwaj"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/5c60f777ef75203dc42d173039a46be1df7db6f6", "committedDate": "2020-03-08T14:54:42Z", "message": "AchievementsActivity: make requested changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc1aa8d2cdba418f0ed6457c823a7846a3259785", "author": {"user": {"login": "kbhardwaj123", "name": "Kshitij Bhardwaj"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/bc1aa8d2cdba418f0ed6457c823a7846a3259785", "committedDate": "2020-03-07T10:37:32Z", "message": "made essential changes"}, "afterCommit": {"oid": "5c60f777ef75203dc42d173039a46be1df7db6f6", "author": {"user": {"login": "kbhardwaj123", "name": "Kshitij Bhardwaj"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/5c60f777ef75203dc42d173039a46be1df7db6f6", "committedDate": "2020-03-08T14:54:42Z", "message": "AchievementsActivity: make requested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwODQ0NjY5", "url": "https://github.com/commons-app/apps-android-commons/pull/3378#pullrequestreview-370844669", "createdAt": "2020-03-08T17:09:30Z", "commit": {"oid": "5c60f777ef75203dc42d173039a46be1df7db6f6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 360, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}