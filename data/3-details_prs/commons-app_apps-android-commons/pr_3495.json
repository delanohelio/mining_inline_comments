{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2ODU1MjEy", "number": 3495, "title": "Fixes #3464, App posts deletion request notifications ({{subst:idw}}) on the wrong user's talk page", "bodyText": "Description (required)\nFixes #3464 App posts deletion request notifications ({{subst:idw}}) on the wrong user's talk page\nWhat changes did you make and why?\nReplaced username of the app with media creator's name and truncated string \" (page does not exist)\" in DeleteHelper class.\nTests performed (required)\nTested betaDebug on emulator with API level 28.", "createdAt": "2020-03-11T18:35:32Z", "url": "https://github.com/commons-app/apps-android-commons/pull/3495", "merged": true, "mergeCommit": {"oid": "e55b5495a18f9cbdce1e26e13304ea0a633c1423"}, "closed": true, "closedAt": "2020-03-17T11:39:30Z", "author": {"login": "VitalyVPinchuk"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMn2eFAH2gAyMzg2ODU1MjEyOjFjNTEwMWQzMzA4OWFlMWRmZjFlNGUxYTIwZjU4MjQ4YTgxMGJlMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOhKfigFqTM3NTk1NTYyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1c5101d33089ae1dff1e4e1a20f58248a810be0e", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/1c5101d33089ae1dff1e4e1a20f58248a810be0e", "committedDate": "2020-03-11T14:18:58Z", "message": "Fixed #3464: App posts deletion request notifications ({{subst:idw}}) on the wrong user's talk page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f648851ee143b1255efc636d67a0e43ebf7b5106", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/f648851ee143b1255efc636d67a0e43ebf7b5106", "committedDate": "2020-03-11T18:06:43Z", "message": "Merge remote-tracking branch 'remotes/upstream/master' into fix-3464"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMDI1MjUz", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#pullrequestreview-373025253", "createdAt": "2020-03-11T18:35:36Z", "commit": {"oid": "f648851ee143b1255efc636d67a0e43ebf7b5106"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28792d2820d7b93deb4cc45173c4c903b919d2b1", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/28792d2820d7b93deb4cc45173c4c903b919d2b1", "committedDate": "2020-03-11T19:08:06Z", "message": "Fixed DeleteHelperTest.kt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23245a8f34b1575c3a8f5a2d2491f7d27c38a1a7", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/23245a8f34b1575c3a8f5a2d2491f7d27c38a1a7", "committedDate": "2020-03-11T20:04:24Z", "message": "Fixed DeleteHelper tests and null-pointer exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d3263102d7cea23781391c6da626b7eabdd7bf5", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/3d3263102d7cea23781391c6da626b7eabdd7bf5", "committedDate": "2020-03-11T20:40:06Z", "message": "Modified DeleteHelper makeDeletion() test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/dfd3bbaf910e76a12a5af94e06a416020ec7509a", "committedDate": "2020-03-12T08:22:26Z", "message": "Reverted unintentionally modified Project.xml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzcyMjI2", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#pullrequestreview-373372226", "createdAt": "2020-03-12T08:56:26Z", "commit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NjoyNlrOF1V32Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwODo1NzoxNVrOF1V5aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzIwOQ==", "bodyText": "If the creator name is null, I think it is better to raise an exception as\nthrow new RuntimeException(\"Failed to nominate for deletion\"); instead of appending edits to the page of \"https://commons.wikimedia.org/wiki/User_talk:page does not exist\". So please raise the exception instead of filling the null string with \"page not exist\"", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477209", "createdAt": "2020-03-12T08:56:26Z", "author": {"login": "neslihanturan"}, "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "diffHunk": "@@ -111,7 +114,7 @@ public DeleteHelper(NotificationHelper notificationHelper,\n                     throw new RuntimeException(\"Failed to nominate for deletion\");\n                 }).flatMap(result -> {\n                     if (result) {\n-                        return pageEditClient.appendEdit(\"User_Talk:\" + username, userPageString + \"\\n\", summary);\n+                        return pageEditClient.appendEdit(\"User_Talk:\" + creatorName, userPageString + \"\\n\", summary);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzQ1Nw==", "bodyText": "Please remove this instead of comment out:)", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477457", "createdAt": "2020-03-12T08:56:54Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -14,7 +16,7 @@ import org.mockito.InjectMocks\n import org.mockito.Mock\n import org.mockito.Mockito.`when`\n import org.mockito.MockitoAnnotations\n-import org.wikipedia.AppAdapter\n+//import org.wikipedia.AppAdapter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NzYxMQ==", "bodyText": "This tests should be updated after the acual code changed", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391477611", "createdAt": "2020-03-12T08:57:15Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +67,13 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\";\n+        `when`(media?.getCreator()).thenReturn(\"$creatorName (page does not exist)\")\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfd3bbaf910e76a12a5af94e06a416020ec7509a"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/59059b53dc86102bfbb8d3fa628deb28fd5ab57e", "committedDate": "2020-03-12T11:07:19Z", "message": "Raising exception when nominating for deletion with empty creator name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNTYwNDc0", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#pullrequestreview-373560474", "createdAt": "2020-03-12T13:37:18Z", "commit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzozNzoxOFrOF1e45Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMzo0MjoxNlrOF1fE4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNDkzMw==", "bodyText": "We use braces even if it is single line statement:)", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391624933", "createdAt": "2020-03-12T13:37:18Z", "author": {"login": "neslihanturan"}, "path": "app/src/main/java/fr/free/nrw/commons/delete/DeleteHelper.java", "diffHunk": "@@ -98,6 +98,11 @@ public DeleteHelper(NotificationHelper notificationHelper,\n         String userPageString = \"\\n{{subst:idw|\" + media.getFilename() +\n                 \"}} ~~~~\";\n \n+        String creator = media.getCreator();\n+        if (creator == null || creator.isEmpty())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA==", "bodyText": "I assume this variable can be deleted now", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391626558", "createdAt": "2020-03-12T13:39:58Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyODAwMQ==", "bodyText": "And related parts of test should be updated", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#discussion_r391628001", "createdAt": "2020-03-12T13:42:16Z", "author": {"login": "neslihanturan"}, "path": "app/src/test/kotlin/fr/free/nrw/commons/delete/DeleteHelperTest.kt", "diffHunk": "@@ -65,9 +66,14 @@ class DeleteHelperTest {\n         `when`(media?.displayTitle).thenReturn(\"Test file\")\n         media?.filename=\"Test file.jpg\"\n \n+        val creatorName = \"Creator\"\n+        val noPageSuffix = \" (page does not exist)\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTYyNjU1OA=="}, "originalCommit": {"oid": "59059b53dc86102bfbb8d3fa628deb28fd5ab57e"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd5313eab14ca063b59303c09db8549484fe07c5", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/fd5313eab14ca063b59303c09db8549484fe07c5", "committedDate": "2020-03-12T14:34:09Z", "message": "Fixed code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e2698474fda854140db82dc75f538ba050cfa80", "author": {"user": {"login": "VitalyVPinchuk", "name": "Vitaly V. Pinchuk"}}, "url": "https://github.com/commons-app/apps-android-commons/commit/9e2698474fda854140db82dc75f538ba050cfa80", "committedDate": "2020-03-12T17:42:56Z", "message": "Fixed code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTI4MDA3", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#pullrequestreview-374128007", "createdAt": "2020-03-13T08:44:57Z", "commit": {"oid": "9e2698474fda854140db82dc75f538ba050cfa80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1OTU1NjI4", "url": "https://github.com/commons-app/apps-android-commons/pull/3495#pullrequestreview-375955628", "createdAt": "2020-03-17T11:39:21Z", "commit": {"oid": "9e2698474fda854140db82dc75f538ba050cfa80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 400, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}