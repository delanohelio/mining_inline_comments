{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMjA1NTM5", "number": 11851, "title": "[CDAP-16130] Adds the ability to multiselect nodes + context menu to nodes & canvas in pipeline studio", "bodyText": "This PR has all the changes from individual PRs (#11772, #11773, #11774, #11827)\nOverview\n\nAdds the ability to multiselect nodes & connections from pipeline studio\nProvide the ability to copy/paste nodes/connections to other pipeline studio canvas\nAdds context menu to canvas & individual nodes.\n\nJIRA:\nhttps://issues.cask.co/browse/CDAP-16130\nBuild:\nhttps://builds.cask.co/browse/CDAP-UDUT502-1\nE2E tests:\nhttps://builds.cask.co/browse/IT-UPD2113-1", "createdAt": "2020-02-05T06:29:38Z", "url": "https://github.com/cdapio/cdap/pull/11851", "merged": true, "mergeCommit": {"oid": "4294eab7d41a8304d4cf51f0a178c662fb10a8cf"}, "closed": true, "closedAt": "2020-02-07T05:30:27Z", "author": {"login": "ajainarayanan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBv_KUAFqTM1NDcxNjA3Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcB38bFgBqjMwMTYzNzA1MzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NzE2MDcy", "url": "https://github.com/cdapio/cdap/pull/11851#pullrequestreview-354716072", "createdAt": "2020-02-06T19:33:48Z", "commit": {"oid": "1e5f82a7f9a8b334212c2c48112d69b4edb66db7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxOTozMzo0OFrOFmnlzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxOTozMzo0OFrOFmnlzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjAzODg2Mw==", "bodyText": "nit: clear the timeout on $destroy", "url": "https://github.com/cdapio/cdap/pull/11851#discussion_r376038863", "createdAt": "2020-02-06T19:33:48Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/directives/dag-plus/my-dag-ctrl.js", "diffHunk": "@@ -222,6 +227,7 @@ angular.module(PKG.name + '.commons')\n       vm.instance.unbind('click');\n       vm.instance.detachEveryConnection();\n       init();\n+      $timeout(() => vm.highlightSelectedNodeConnections());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e5f82a7f9a8b334212c2c48112d69b4edb66db7"}, "originalPosition": 76}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1e5f82a7f9a8b334212c2c48112d69b4edb66db7", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/1e5f82a7f9a8b334212c2c48112d69b4edb66db7", "committedDate": "2020-02-05T06:23:43Z", "message": "Highlights newly copied nodes"}, "afterCommit": {"oid": "47e5bb63c936c4b44ee4126f05970ea22235f4d9", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/47e5bb63c936c4b44ee4126f05970ea22235f4d9", "committedDate": "2020-02-06T20:17:38Z", "message": "Highlights newly copied nodes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c9979ce1b0ecb101b986a0c826681296bbeecdf", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/3c9979ce1b0ecb101b986a0c826681296bbeecdf", "committedDate": "2020-02-07T04:48:05Z", "message": "[CDAP-16130] Adds the ability to multiselect nodes + context menu to nodes & canvas in pipeline studio\n\n  - [CDAP-15081] Fix dragging comments in canvas + actually shows comments from pipeline drafts\n\n  Add multiselect copy paste pipeline studio\n\n - Adds an onUnmount flag to dataprep onSubmit handler. This is to differentiate between close button vs apply button.\n - Removes user-select css to avoid user accidentally selecting text when multi-selecting nodes in canvas\n - Fix imported pipeline json to strip off invalid characters from name which is used for id in html\n - Modifies dag directive to handle multi-select + right click to add context menu for pipeline and plugins\n - Updates node selection based on the usage of 'selected' from selection-js\n\n  Add selection box component for multi-select nodes\n\n  - Adds generic SelectionBox component to drag-n-select things\n  - Adds a generic Clipboard api to copy-paste things from and to clipboard\n  - Adds selection-js npm module + playground to play\n  - Fixes selection box to use selected nodes instead of added and removed nodes\n  - Adds generic ContextMenu component to be reused for multiple elements in pipelines\n  - Adds PipelineContextMenu component with WranglerConnection to be used in pipeline studio canvas\n  - Adds PluginContextMenu to be used for plugins in pipeline studio\n  - Fixes the way select connections on clicking endpoint + replace space in node name to avoid html ids with spaces\n\n  Adds e2e tests for multi-select + context menus in pipelines\n\n  - Adds css class for selected connections\n  - Highlights newly copied nodes\n  - Applies dumb logic to make sure start & move events happen in sequence while selecting things in canvas\n  - Adds command to select everything between two nodes\n  - Adds e2e tests for multiselect feature in pipeline canvas\n  - Adds e2e test for pipeline context menu\n  - Fixes functional errors\n     - Fixes the case of copy-pasting nodes in the same studio to not result in js error\n     - Fixes copy/paste of nodes/connections to be in history to be able to do undo/redo\n     - Adds icons to context menus in pipeline\n     - Fixes the options in hamburger menu for nodes.\n     - Removes the usage of copytoclipboard from angular & replaces it with new utility function\n  - Adds e2e test for hamburger menu options"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47e5bb63c936c4b44ee4126f05970ea22235f4d9", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/47e5bb63c936c4b44ee4126f05970ea22235f4d9", "committedDate": "2020-02-06T20:17:38Z", "message": "Highlights newly copied nodes"}, "afterCommit": {"oid": "3c9979ce1b0ecb101b986a0c826681296bbeecdf", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/3c9979ce1b0ecb101b986a0c826681296bbeecdf", "committedDate": "2020-02-07T04:48:05Z", "message": "[CDAP-16130] Adds the ability to multiselect nodes + context menu to nodes & canvas in pipeline studio\n\n  - [CDAP-15081] Fix dragging comments in canvas + actually shows comments from pipeline drafts\n\n  Add multiselect copy paste pipeline studio\n\n - Adds an onUnmount flag to dataprep onSubmit handler. This is to differentiate between close button vs apply button.\n - Removes user-select css to avoid user accidentally selecting text when multi-selecting nodes in canvas\n - Fix imported pipeline json to strip off invalid characters from name which is used for id in html\n - Modifies dag directive to handle multi-select + right click to add context menu for pipeline and plugins\n - Updates node selection based on the usage of 'selected' from selection-js\n\n  Add selection box component for multi-select nodes\n\n  - Adds generic SelectionBox component to drag-n-select things\n  - Adds a generic Clipboard api to copy-paste things from and to clipboard\n  - Adds selection-js npm module + playground to play\n  - Fixes selection box to use selected nodes instead of added and removed nodes\n  - Adds generic ContextMenu component to be reused for multiple elements in pipelines\n  - Adds PipelineContextMenu component with WranglerConnection to be used in pipeline studio canvas\n  - Adds PluginContextMenu to be used for plugins in pipeline studio\n  - Fixes the way select connections on clicking endpoint + replace space in node name to avoid html ids with spaces\n\n  Adds e2e tests for multi-select + context menus in pipelines\n\n  - Adds css class for selected connections\n  - Highlights newly copied nodes\n  - Applies dumb logic to make sure start & move events happen in sequence while selecting things in canvas\n  - Adds command to select everything between two nodes\n  - Adds e2e tests for multiselect feature in pipeline canvas\n  - Adds e2e test for pipeline context menu\n  - Fixes functional errors\n     - Fixes the case of copy-pasting nodes in the same studio to not result in js error\n     - Fixes copy/paste of nodes/connections to be in history to be able to do undo/redo\n     - Adds icons to context menus in pipeline\n     - Fixes the options in hamburger menu for nodes.\n     - Removes the usage of copytoclipboard from angular & replaces it with new utility function\n  - Adds e2e test for hamburger menu options"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1232, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}