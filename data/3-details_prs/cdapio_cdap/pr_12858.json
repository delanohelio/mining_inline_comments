{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwODAzNjUx", "number": 12858, "title": "Fix NPE in adding accelerator tag", "bodyText": "(CDAP-17406) Quick null check fix for NPE in app fabric", "createdAt": "2020-11-13T19:24:02Z", "url": "https://github.com/cdapio/cdap/pull/12858", "merged": true, "mergeCommit": {"oid": "7e42ee1801d1a95267431edde6f5cb88a91a40c7"}, "closed": true, "closedAt": "2020-11-18T16:23:29Z", "author": {"login": "greeshmaswaminathan"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcMTfiAFqTUzMDM0NTc1NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddnf7wgFqTUzMzExODgzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMzQ1NzU1", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-530345755", "createdAt": "2020-11-13T19:26:47Z", "commit": {"oid": "73bb713631ab978aef3fc4485ed732b96ebbfe6f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxOToyNjo0N1rOHy8JzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxOToyNzoxMVrOHy8KzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzE3NjM5Nw==", "bodyText": "use Collections.emptySet() instead.", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523176397", "createdAt": "2020-11-13T19:26:47Z", "author": {"login": "chtyim"}, "path": "cdap-data-fabric/src/main/java/io/cdap/cdap/data2/metadata/system/AppSystemMetadataWriter.java", "diffHunk": "@@ -95,13 +95,21 @@ private void addAccelerators(ApplicationSpecification appSpec,\n       .flatMap(Set::stream)\n       .collect(Collectors.toSet());\n     //add from application\n-    acceleratorSet.addAll(applicationClass.getRequirements().getAccelerators());\n+    acceleratorSet.addAll(getApplicationAccelerators(applicationClass));\n     if (acceleratorSet.isEmpty()) {\n       return;\n     }\n     properties.put(ACCELERATOR_TAG, String.join(ACCELERATOR_DELIMITER, acceleratorSet));\n   }\n \n+  private Set<String> getApplicationAccelerators(ApplicationClass applicationClass) {\n+    if (applicationClass == null || applicationClass.getRequirements() == null || applicationClass.getRequirements()\n+      .getAccelerators() == null) {\n+      return Collections.EMPTY_SET;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73bb713631ab978aef3fc4485ed732b96ebbfe6f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzE3NjY1Mg==", "bodyText": "Is applicationClass nullable?", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523176652", "createdAt": "2020-11-13T19:27:11Z", "author": {"login": "chtyim"}, "path": "cdap-data-fabric/src/main/java/io/cdap/cdap/data2/metadata/system/AppSystemMetadataWriter.java", "diffHunk": "@@ -95,13 +95,21 @@ private void addAccelerators(ApplicationSpecification appSpec,\n       .flatMap(Set::stream)\n       .collect(Collectors.toSet());\n     //add from application\n-    acceleratorSet.addAll(applicationClass.getRequirements().getAccelerators());\n+    acceleratorSet.addAll(getApplicationAccelerators(applicationClass));\n     if (acceleratorSet.isEmpty()) {\n       return;\n     }\n     properties.put(ACCELERATOR_TAG, String.join(ACCELERATOR_DELIMITER, acceleratorSet));\n   }\n \n+  private Set<String> getApplicationAccelerators(ApplicationClass applicationClass) {\n+    if (applicationClass == null || applicationClass.getRequirements() == null || applicationClass.getRequirements()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73bb713631ab978aef3fc4485ed732b96ebbfe6f"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73bb713631ab978aef3fc4485ed732b96ebbfe6f", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/73bb713631ab978aef3fc4485ed732b96ebbfe6f", "committedDate": "2020-11-13T19:22:01Z", "message": "Fix NPE in adding accelerator tag"}, "afterCommit": {"oid": "a74a6d6b234c25a84c46d1329c5249d71808ba97", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/a74a6d6b234c25a84c46d1329c5249d71808ba97", "committedDate": "2020-11-13T19:31:52Z", "message": "Fix NPE in adding accelerator tag"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a74a6d6b234c25a84c46d1329c5249d71808ba97", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/a74a6d6b234c25a84c46d1329c5249d71808ba97", "committedDate": "2020-11-13T19:31:52Z", "message": "Fix NPE in adding accelerator tag"}, "afterCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e", "committedDate": "2020-11-15T07:13:23Z", "message": "CDAP-17406 Use custom deserialization for ApplicationClass to consider new field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwOTM3OTYw", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-530937960", "createdAt": "2020-11-16T06:12:23Z", "commit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxMjoyM1rOHzpVyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxMjoyM1rOHzpVyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkxNjc0NQ==", "bodyText": "You should have a codec class that implements both json serializer and deserializer", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523916745", "createdAt": "2020-11-16T06:12:23Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassDeserializer.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON deserializer for {@link ApplicationClass}\n+ */\n+public class ApplicationClassDeserializer implements JsonDeserializer<ApplicationClass> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwOTM4MzE3", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-530938317", "createdAt": "2020-11-16T06:13:42Z", "commit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxMzo0M1rOHzpXBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxMzo0M1rOHzpXBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkxNzA2MA==", "bodyText": "Annotate parameter with @Nullable if null is expected", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523917060", "createdAt": "2020-11-16T06:13:43Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassDeserializer.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON deserializer for {@link ApplicationClass}\n+ */\n+public class ApplicationClassDeserializer implements JsonDeserializer<ApplicationClass> {\n+\n+  private static final String REQUIREMENTS = \"requirements\";\n+  private static final String CLASS_NAME = \"className\";\n+  private static final String DESCRIPTION = \"description\";\n+  private static final String CONFIG_SCHEMA = \"configSchema\";\n+\n+  @Override\n+  public ApplicationClass deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)\n+    throws JsonParseException {\n+    JsonObject jsonObject = json.getAsJsonObject();\n+    Schema configSchema = getConfigSchema(context, jsonObject);\n+    Requirements requirements = getRequirements(jsonObject.get(REQUIREMENTS), context);\n+    return new ApplicationClass(getStringValue(jsonObject.get(CLASS_NAME)), getStringValue(jsonObject.get(DESCRIPTION)),\n+                                configSchema, requirements);\n+  }\n+\n+  private String getStringValue(JsonElement jsonElement) {\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return jsonElement.getAsString();\n+  }\n+\n+  private Schema getConfigSchema(JsonDeserializationContext context, JsonObject jsonObject) {\n+    JsonElement jsonElement = jsonObject.get(CONFIG_SCHEMA);\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return context.deserialize(jsonElement, Schema.class);\n+  }\n+\n+  private Requirements getRequirements(JsonElement requirementJSON, JsonDeserializationContext context) {\n+    if (requirementJSON == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwOTM4NDcx", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-530938471", "createdAt": "2020-11-16T06:14:15Z", "commit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxNDoxNVrOHzpXlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwNjoxNTowMVrOHzpYcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkxNzIwNg==", "bodyText": "Please be consistent with the ordering of parameters between methods.", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523917206", "createdAt": "2020-11-16T06:14:15Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassDeserializer.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON deserializer for {@link ApplicationClass}\n+ */\n+public class ApplicationClassDeserializer implements JsonDeserializer<ApplicationClass> {\n+\n+  private static final String REQUIREMENTS = \"requirements\";\n+  private static final String CLASS_NAME = \"className\";\n+  private static final String DESCRIPTION = \"description\";\n+  private static final String CONFIG_SCHEMA = \"configSchema\";\n+\n+  @Override\n+  public ApplicationClass deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)\n+    throws JsonParseException {\n+    JsonObject jsonObject = json.getAsJsonObject();\n+    Schema configSchema = getConfigSchema(context, jsonObject);\n+    Requirements requirements = getRequirements(jsonObject.get(REQUIREMENTS), context);\n+    return new ApplicationClass(getStringValue(jsonObject.get(CLASS_NAME)), getStringValue(jsonObject.get(DESCRIPTION)),\n+                                configSchema, requirements);\n+  }\n+\n+  private String getStringValue(JsonElement jsonElement) {\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return jsonElement.getAsString();\n+  }\n+\n+  private Schema getConfigSchema(JsonDeserializationContext context, JsonObject jsonObject) {\n+    JsonElement jsonElement = jsonObject.get(CONFIG_SCHEMA);\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return context.deserialize(jsonElement, Schema.class);\n+  }\n+\n+  private Requirements getRequirements(JsonElement requirementJSON, JsonDeserializationContext context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkxNzQyNg==", "bodyText": "Also, try to be consistent for the method (e.g. it takes JsonObject and get the field in the getConfigSchema method, while in here, it is expected the caller to get the field and pass it in).", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r523917426", "createdAt": "2020-11-16T06:15:01Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassDeserializer.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON deserializer for {@link ApplicationClass}\n+ */\n+public class ApplicationClassDeserializer implements JsonDeserializer<ApplicationClass> {\n+\n+  private static final String REQUIREMENTS = \"requirements\";\n+  private static final String CLASS_NAME = \"className\";\n+  private static final String DESCRIPTION = \"description\";\n+  private static final String CONFIG_SCHEMA = \"configSchema\";\n+\n+  @Override\n+  public ApplicationClass deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)\n+    throws JsonParseException {\n+    JsonObject jsonObject = json.getAsJsonObject();\n+    Schema configSchema = getConfigSchema(context, jsonObject);\n+    Requirements requirements = getRequirements(jsonObject.get(REQUIREMENTS), context);\n+    return new ApplicationClass(getStringValue(jsonObject.get(CLASS_NAME)), getStringValue(jsonObject.get(DESCRIPTION)),\n+                                configSchema, requirements);\n+  }\n+\n+  private String getStringValue(JsonElement jsonElement) {\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return jsonElement.getAsString();\n+  }\n+\n+  private Schema getConfigSchema(JsonDeserializationContext context, JsonObject jsonObject) {\n+    JsonElement jsonElement = jsonObject.get(CONFIG_SCHEMA);\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return context.deserialize(jsonElement, Schema.class);\n+  }\n+\n+  private Requirements getRequirements(JsonElement requirementJSON, JsonDeserializationContext context) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkxNzIwNg=="}, "originalCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e"}, "originalPosition": 65}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/d9c12fc81f5ba9aeb5ed1d077ce230a7576b369e", "committedDate": "2020-11-15T07:13:23Z", "message": "CDAP-17406 Use custom deserialization for ApplicationClass to consider new field"}, "afterCommit": {"oid": "7abe2271b422c12f0bbe4e2e297731d198d9dd94", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/7abe2271b422c12f0bbe4e2e297731d198d9dd94", "committedDate": "2020-11-17T05:47:42Z", "message": "CDAP-17406 Use custom codec for ApplicationClass to consider new field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDYzNjg1", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-532063685", "createdAt": "2020-11-17T06:54:07Z", "commit": {"oid": "7abe2271b422c12f0bbe4e2e297731d198d9dd94"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNjo1NDowN1rOH0mkdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNjo1NTo1M1rOH0mnPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDkxOTkyNQ==", "bodyText": "annotate return as @Nullable", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r524919925", "createdAt": "2020-11-17T06:54:07Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassCodec.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import com.google.gson.JsonSerializationContext;\n+import com.google.gson.JsonSerializer;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON codec for {@link ApplicationClass}\n+ */\n+public class ApplicationClassCodec implements JsonDeserializer<ApplicationClass>, JsonSerializer<ApplicationClass> {\n+\n+  private static final String REQUIREMENTS = \"requirements\";\n+  private static final String CLASS_NAME = \"className\";\n+  private static final String DESCRIPTION = \"description\";\n+  private static final String CONFIG_SCHEMA = \"configSchema\";\n+\n+  @Override\n+  public ApplicationClass deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)\n+    throws JsonParseException {\n+    JsonObject jsonObject = json.getAsJsonObject();\n+    Schema configSchema = getConfigSchema(jsonObject, context);\n+    Requirements requirements = getRequirements(jsonObject, context);\n+    return new ApplicationClass(getStringValue(jsonObject, CLASS_NAME), getStringValue(jsonObject, DESCRIPTION),\n+                                configSchema, requirements);\n+  }\n+\n+  @Override\n+  public JsonElement serialize(ApplicationClass src, Type typeOfSrc, JsonSerializationContext context) {\n+    JsonObject jsonObject = new JsonObject();\n+    jsonObject.addProperty(CLASS_NAME, src.getClassName());\n+    jsonObject.addProperty(DESCRIPTION, src.getDescription());\n+    jsonObject.add(CONFIG_SCHEMA, context.serialize(src.getConfigSchema()));\n+    jsonObject.add(REQUIREMENTS, context.serialize(src.getRequirements()));\n+    return jsonObject;\n+  }\n+\n+  private String getStringValue(JsonObject jsonObject, String name) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7abe2271b422c12f0bbe4e2e297731d198d9dd94"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDkyMDYzOQ==", "bodyText": "Annotate result with @Nullable.", "url": "https://github.com/cdapio/cdap/pull/12858#discussion_r524920639", "createdAt": "2020-11-17T06:55:53Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/artifact/ApplicationClassCodec.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package io.cdap.cdap.internal.app.runtime.artifact;\n+\n+import com.google.gson.JsonDeserializationContext;\n+import com.google.gson.JsonDeserializer;\n+import com.google.gson.JsonElement;\n+import com.google.gson.JsonObject;\n+import com.google.gson.JsonParseException;\n+import com.google.gson.JsonSerializationContext;\n+import com.google.gson.JsonSerializer;\n+import io.cdap.cdap.api.artifact.ApplicationClass;\n+import io.cdap.cdap.api.data.schema.Schema;\n+import io.cdap.cdap.api.plugin.Requirements;\n+\n+import java.lang.reflect.Type;\n+\n+/**\n+ * JSON codec for {@link ApplicationClass}\n+ */\n+public class ApplicationClassCodec implements JsonDeserializer<ApplicationClass>, JsonSerializer<ApplicationClass> {\n+\n+  private static final String REQUIREMENTS = \"requirements\";\n+  private static final String CLASS_NAME = \"className\";\n+  private static final String DESCRIPTION = \"description\";\n+  private static final String CONFIG_SCHEMA = \"configSchema\";\n+\n+  @Override\n+  public ApplicationClass deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)\n+    throws JsonParseException {\n+    JsonObject jsonObject = json.getAsJsonObject();\n+    Schema configSchema = getConfigSchema(jsonObject, context);\n+    Requirements requirements = getRequirements(jsonObject, context);\n+    return new ApplicationClass(getStringValue(jsonObject, CLASS_NAME), getStringValue(jsonObject, DESCRIPTION),\n+                                configSchema, requirements);\n+  }\n+\n+  @Override\n+  public JsonElement serialize(ApplicationClass src, Type typeOfSrc, JsonSerializationContext context) {\n+    JsonObject jsonObject = new JsonObject();\n+    jsonObject.addProperty(CLASS_NAME, src.getClassName());\n+    jsonObject.addProperty(DESCRIPTION, src.getDescription());\n+    jsonObject.add(CONFIG_SCHEMA, context.serialize(src.getConfigSchema()));\n+    jsonObject.add(REQUIREMENTS, context.serialize(src.getRequirements()));\n+    return jsonObject;\n+  }\n+\n+  private String getStringValue(JsonObject jsonObject, String name) {\n+    JsonElement jsonElement = jsonObject.get(name);\n+    if (jsonElement == null) {\n+      return null;\n+    }\n+    return jsonElement.getAsString();\n+  }\n+\n+  private Schema getConfigSchema(JsonObject jsonObject, JsonDeserializationContext context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7abe2271b422c12f0bbe4e2e297731d198d9dd94"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9f6167addee4a7795d7a4172b24ba546f555111", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/f9f6167addee4a7795d7a4172b24ba546f555111", "committedDate": "2020-11-17T20:00:22Z", "message": "CDAP-17406 Use custom codec for ApplicationClass to consider new field"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7abe2271b422c12f0bbe4e2e297731d198d9dd94", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/7abe2271b422c12f0bbe4e2e297731d198d9dd94", "committedDate": "2020-11-17T05:47:42Z", "message": "CDAP-17406 Use custom codec for ApplicationClass to consider new field"}, "afterCommit": {"oid": "f9f6167addee4a7795d7a4172b24ba546f555111", "author": {"user": {"login": "greeshmaswaminathan", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/f9f6167addee4a7795d7a4172b24ba546f555111", "committedDate": "2020-11-17T20:00:22Z", "message": "CDAP-17406 Use custom codec for ApplicationClass to consider new field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMTE4ODMw", "url": "https://github.com/cdapio/cdap/pull/12858#pullrequestreview-533118830", "createdAt": "2020-11-18T05:42:13Z", "commit": {"oid": "f9f6167addee4a7795d7a4172b24ba546f555111"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1472, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}