{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0ODIxODg5", "number": 12594, "title": "CDAP-17078 consolidate multiple outputs from same sink", "bodyText": "Some sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs\nwhen stage consolidation is enabled.", "createdAt": "2020-08-07T20:52:57Z", "url": "https://github.com/cdapio/cdap/pull/12594", "merged": true, "mergeCommit": {"oid": "d5ca68ac1a20b25040fa250a60647a553bcbb0da"}, "closed": true, "closedAt": "2020-08-08T23:18:51Z", "author": {"login": "albertshau"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8q0iQABqjM2MzQ3MzUwMTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc87yq8gBqjM2MzU4MjkyNTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46098163ff70311544287174f8ab95f20a9d4846", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/46098163ff70311544287174f8ab95f20a9d4846", "committedDate": "2020-08-07T20:51:18Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs\nwhen stage consolidation is enabled."}, "afterCommit": {"oid": "25331ef1a1225504fbad780a801e92f7dbfcf022", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/25331ef1a1225504fbad780a801e92f7dbfcf022", "committedDate": "2020-08-07T20:54:43Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs\nwhen stage consolidation is enabled."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25331ef1a1225504fbad780a801e92f7dbfcf022", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/25331ef1a1225504fbad780a801e92f7dbfcf022", "committedDate": "2020-08-07T20:54:43Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs\nwhen stage consolidation is enabled."}, "afterCommit": {"oid": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "committedDate": "2020-08-07T22:34:50Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNjc1MzQy", "url": "https://github.com/cdapio/cdap/pull/12594#pullrequestreview-463675342", "createdAt": "2020-08-07T22:42:53Z", "commit": {"oid": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QyMjo0Mjo1M1rOG9qtaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QyMjo0Mjo1M1rOG9qtaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMxNjA3Mg==", "bodyText": "Shouldn't we return after calling saveUsingOutputFormat?", "url": "https://github.com/cdapio/cdap/pull/12594#discussion_r467316072", "createdAt": "2020-08-07T22:42:53Z", "author": {"login": "MEseifan"}, "path": "cdap-app-templates/cdap-etl/hydrator-spark-core-base/src/main/java/io/cdap/cdap/etl/spark/batch/SparkBatchSinkFactory.java", "diffHunk": "@@ -173,9 +165,34 @@ private void addOutput(String stageName, String datasetName, String alias, Map<S\n         sec.saveAsDataset(rdd, datasetInfo.getDatasetName(), datasetInfo.getDatasetArgs());\n       }\n     }\n+\n+    if (outputFormats.size() == 1) {\n+      saveUsingOutputFormat(outputFormats.values().iterator().next(), rdd);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a"}, "originalPosition": 58}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/d966e1fc44eb47cf80be102bb429e2a9c2a6199a", "committedDate": "2020-08-07T22:34:50Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}, "afterCommit": {"oid": "5fed793a72a0843ed2737edbe3f253f33d46e17a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/5fed793a72a0843ed2737edbe3f253f33d46e17a", "committedDate": "2020-08-07T22:46:26Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fed793a72a0843ed2737edbe3f253f33d46e17a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/5fed793a72a0843ed2737edbe3f253f33d46e17a", "committedDate": "2020-08-07T22:46:26Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}, "afterCommit": {"oid": "6626ba06890f49257a583f229a3789e619fc7f5a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/6626ba06890f49257a583f229a3789e619fc7f5a", "committedDate": "2020-08-08T02:53:42Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "committedDate": "2020-08-08T16:41:03Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6626ba06890f49257a583f229a3789e619fc7f5a", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/6626ba06890f49257a583f229a3789e619fc7f5a", "committedDate": "2020-08-08T02:53:42Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}, "afterCommit": {"oid": "f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "author": {"user": {"login": "albertshau", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/f709249a94795fe7b9e5bfcf4e0f74e8ba1bb55d", "committedDate": "2020-08-08T16:41:03Z", "message": "CDAP-17078 consolidate multiple outputs from same sink\n\nSome sinks have multiple outputs, which can cause a lot of\ndata recomputation. Added logic to consolidate these outputs."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1788, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}