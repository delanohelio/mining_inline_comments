{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0OTIyNjE1", "number": 12609, "title": "[CDAP-17174] Modify stop preview behavior when pipeline run has already completed", "bodyText": "JIRA: https://issues.cask.co/browse/CDAP-17174\nBuild: https://builds.cask.co/browse/CDAP-URUT316\nModified stop logic so when the pipeline has already completed (i.e. 400 error is returned), the UI treats it as a successful stopping of the pipeline. This is an exception to normal behavior where the stop button stays interactive if the user tries to top the preview run and the backend returns an error, so user can retry stopping the pipeline. In this case it doesn't make sense for the user to retry stopping the pipeline since it is already completed.", "createdAt": "2020-08-08T01:36:28Z", "url": "https://github.com/cdapio/cdap/pull/12609", "merged": true, "mergeCommit": {"oid": "b55e68742999ff8bf4f126cad2c18ec63c018821"}, "closed": true, "closedAt": "2020-08-10T22:35:16Z", "author": {"login": "yukiej"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9lH9xgBqjM2Mzk2MzU1MjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9piAjgBqjM2NDA2MzQ2Mjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8429d0e52ae55cdb3149d3c14f5e444120810028", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/8429d0e52ae55cdb3149d3c14f5e444120810028", "committedDate": "2020-08-08T01:24:37Z", "message": "Check for 400 error on stop preview"}, "afterCommit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/c781ef3f81e9380aaa05af21722b880edb4fcba1", "committedDate": "2020-08-10T16:48:26Z", "message": "Check for 400 error on stop preview"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDg4Nzk0", "url": "https://github.com/cdapio/cdap/pull/12609#pullrequestreview-464488794", "createdAt": "2020-08-10T18:52:57Z", "commit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODo1Mjo1N1rOG-bKIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODo1Mzo1MFrOG-bL_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEwOTg1OQ==", "bodyText": "we could also do something like\nconst pipelinePreviewPlaceholder = The preview of the pipeline${pipelineName.length > 0 ? ' pipelineName' : ''}", "url": "https://github.com/cdapio/cdap/pull/12609#discussion_r468109859", "createdAt": "2020-08-10T18:52:57Z", "author": {"login": "jennac3"}, "path": "cdap-ui/app/hydrator/controllers/create/toppanel-ctrl.js", "diffHunk": "@@ -678,29 +687,33 @@ class HydratorPlusPlusTopPanelCtrl {\n     };\n     this.previewLoading = true;\n     this.loadingLabel = 'Stopping';\n+    let pipelinePreviewPlaceholder = 'The preview of the pipeline';\n+    const pipelineName = this.HydratorPlusPlusConfigStore.getName();\n+    if (pipelineName.length > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODExMDEzOQ==", "bodyText": "could you please put some comments that explain this function resetBtnsAndstopPoll?", "url": "https://github.com/cdapio/cdap/pull/12609#discussion_r468110139", "createdAt": "2020-08-10T18:53:27Z", "author": {"login": "jennac3"}, "path": "cdap-ui/app/hydrator/controllers/create/toppanel-ctrl.js", "diffHunk": "@@ -667,6 +667,15 @@ class HydratorPlusPlusTopPanelCtrl {\n       });\n   }\n \n+  resetBtnsAndStopPoll() {\n+    this.stopTimer();\n+    this.updateTimerLabelAndTitle();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODExMDMzNQ==", "bodyText": "nit: I think we can rename it into resetButtonsAndStopPoll also!", "url": "https://github.com/cdapio/cdap/pull/12609#discussion_r468110335", "createdAt": "2020-08-10T18:53:50Z", "author": {"login": "jennac3"}, "path": "cdap-ui/app/hydrator/controllers/create/toppanel-ctrl.js", "diffHunk": "@@ -667,6 +667,15 @@ class HydratorPlusPlusTopPanelCtrl {\n       });\n   }\n \n+  resetBtnsAndStopPoll() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c781ef3f81e9380aaa05af21722b880edb4fcba1", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/c781ef3f81e9380aaa05af21722b880edb4fcba1", "committedDate": "2020-08-10T16:48:26Z", "message": "Check for 400 error on stop preview"}, "afterCommit": {"oid": "4d1584c8fed489dc891bba62b1ab5be558b1c94c", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/4d1584c8fed489dc891bba62b1ab5be558b1c94c", "committedDate": "2020-08-10T19:49:52Z", "message": "Address feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTM5NDg4", "url": "https://github.com/cdapio/cdap/pull/12609#pullrequestreview-464539488", "createdAt": "2020-08-10T20:03:29Z", "commit": {"oid": "4d1584c8fed489dc891bba62b1ab5be558b1c94c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b6bd33d74cb5b8307d1647c677368346ff88d5a", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/3b6bd33d74cb5b8307d1647c677368346ff88d5a", "committedDate": "2020-08-10T21:58:04Z", "message": "Check for 400 error on stop preview"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d1584c8fed489dc891bba62b1ab5be558b1c94c", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/4d1584c8fed489dc891bba62b1ab5be558b1c94c", "committedDate": "2020-08-10T19:49:52Z", "message": "Address feedback"}, "afterCommit": {"oid": "3b6bd33d74cb5b8307d1647c677368346ff88d5a", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/3b6bd33d74cb5b8307d1647c677368346ff88d5a", "committedDate": "2020-08-10T21:58:04Z", "message": "Check for 400 error on stop preview"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1795, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}