{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2MjY3MTgx", "number": 12625, "title": "[CDAP-17142] Fixes deleting all the rows in a schema", "bodyText": "cherry-pick #12547", "createdAt": "2020-08-11T18:06:31Z", "url": "https://github.com/cdapio/cdap/pull/12625", "merged": true, "mergeCommit": {"oid": "6c450cb59b4acf36e487755bdef2d23a06f0e2b2"}, "closed": true, "closedAt": "2020-08-26T17:47:49Z", "author": {"login": "ajainarayanan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc98CLqgFqTQ2NTM2MjIxOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCvORwgBqjM2OTU4Njc2OTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MzYyMjE4", "url": "https://github.com/cdapio/cdap/pull/12625#pullrequestreview-465362218", "createdAt": "2020-08-11T19:24:08Z", "commit": {"oid": "ab80d5807c9874e11f452210baf1db6599b9cfe0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOToyNDowOFrOG_GC-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOToyNDozM1rOG_GD3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjUzNg==", "bodyText": "I believe if (!Array.isArray(fields) || !fields) could also work.", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r468812536", "createdAt": "2020-08-11T19:24:08Z", "author": {"login": "jennac3"}, "path": "cdap-ui/app/cdap/components/PluginSchemaEditor/index.tsx", "diffHunk": "@@ -441,7 +441,12 @@ class PluginSchemaEditorBase extends React.PureComponent<\n           disabled={this.props.disabled}\n           onChange={({ avroSchema }) => {\n             const newSchemas = [...this.props.schemas];\n-            newSchemas[i] = avroSchema;\n+            const fields = objectQuery(avroSchema, 'schema', 'fields');\n+            if (!Array.isArray(fields) || !fields.length) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab80d5807c9874e11f452210baf1db6599b9cfe0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjc2Ng==", "bodyText": "maybe we can try something like const fields = (avroSchema || getDefaultEmptyAvroSchema()).schema.fields;, if this does not work we can also try ternary.", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r468812766", "createdAt": "2020-08-11T19:24:33Z", "author": {"login": "jennac3"}, "path": "cdap-ui/app/cdap/components/AbstractWidget/SchemaEditor/Context/SchemaParser.ts", "diffHunk": "@@ -412,7 +412,10 @@ function parseSubTree(field: IFieldType | IFieldTypeNullable): INode {\n  */\n function parseSchema(avroSchema: ISchemaType): INode {\n   const name = avroSchema.name || 'etlSchemaBody';\n-  const fields = avroSchema.schema.fields;\n+  let fields = avroSchema.schema.fields;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab80d5807c9874e11f452210baf1db6599b9cfe0"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDQzNTcx", "url": "https://github.com/cdapio/cdap/pull/12625#pullrequestreview-465443571", "createdAt": "2020-08-11T21:31:32Z", "commit": {"oid": "ab80d5807c9874e11f452210baf1db6599b9cfe0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0776f5dae7a43d9f39dfac013aaa946c27a34099", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/0776f5dae7a43d9f39dfac013aaa946c27a34099", "committedDate": "2020-08-26T17:26:00Z", "message": "[CDAP-17142] Fixes deleting all the rows in a schema"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab80d5807c9874e11f452210baf1db6599b9cfe0", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/ab80d5807c9874e11f452210baf1db6599b9cfe0", "committedDate": "2020-08-11T18:05:24Z", "message": "[CDAP-17142] Fixes deleting all the rows in a schema"}, "afterCommit": {"oid": "0776f5dae7a43d9f39dfac013aaa946c27a34099", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/0776f5dae7a43d9f39dfac013aaa946c27a34099", "committedDate": "2020-08-26T17:26:00Z", "message": "[CDAP-17142] Fixes deleting all the rows in a schema"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1800, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}