{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwODE3MDUy", "number": 11983, "title": "[CDAP-16384] Improve handling of 404 when last completed preview is missing", "bodyText": "JIRA: https://issues.cask.co/browse/CDAP-16384\nBuild: https://builds.cask.co/browse/CDAP-URUT221\nImproving error message for 404 received when user checks logs for preview run when preview data is missing.\nTo replicate: Update preview.exec.threads to be 1 in cdap-site.xml, run (and complete) a preview run for a pipeline. Switch to another tab and start another preview run, which will purge the latest completed preview. This causes the backend to send a 404 when user checks logs for the original (first and already completed) preview run.\nAlso fixed JS errors that appeared when polling was resumed after switching tabs.", "createdAt": "2020-03-19T06:12:08Z", "url": "https://github.com/cdapio/cdap/pull/11983", "merged": true, "mergeCommit": {"oid": "b229e35b63da73d42c25343601427bbb6e1c7111"}, "closed": true, "closedAt": "2020-03-19T23:12:11Z", "author": {"login": "yukiej"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPRKcCAFqTM3ODAzMTkxMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPUFa1ABqjMxNDc1NjAyNTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDMxOTEz", "url": "https://github.com/cdapio/cdap/pull/11983#pullrequestreview-378031913", "createdAt": "2020-03-19T19:32:42Z", "commit": {"oid": "6b5d9ff149ed69b9ecef2c0d274d01a53e475032"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxOTozMjo0M1rOF49b5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxOTozMjo0M1rOF49b5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI3MTE0MQ==", "bodyText": "why do we have to pass in this.bindings? i think just passing this.bindings[hash] is good enough, or even just the hash", "url": "https://github.com/cdapio/cdap/pull/11983#discussion_r395271141", "createdAt": "2020-03-19T19:32:43Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/services/datasource/index.js", "diffHunk": "@@ -89,7 +89,7 @@ export default class Datasource {\n         delete this.bindings[hash];\n       } else {\n         if (this.bindings[hash] && this.bindings[hash].type === 'POLL') {\n-          this.bindings[hash].resource.interval = this.startClientPoll(hash, this.bindings[hash].resource.intervalTime);\n+          this.bindings[hash].resource.interval = this.startClientPoll(hash, this.bindings, this.bindings[hash].resource.intervalTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b5d9ff149ed69b9ecef2c0d274d01a53e475032"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTA1MTk1", "url": "https://github.com/cdapio/cdap/pull/11983#pullrequestreview-378105195", "createdAt": "2020-03-19T21:25:40Z", "commit": {"oid": "6866f9e844950b3ee132c64dc80e80d1e1df40c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMToyNTo0MFrOF5A81w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMToyNTo0MFrOF5A81w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMyODcyNw==", "bodyText": "Need to make the same change as the one in React", "url": "https://github.com/cdapio/cdap/pull/11983#discussion_r395328727", "createdAt": "2020-03-19T21:25:40Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/services/cask-angular-socket-datasource/datasource.js", "diffHunk": "@@ -211,7 +211,7 @@ var socketDataSource = angular.module(PKG.name+'.services');\n         Object.keys(bindings)\n           .filter(resourceId => bindings[resourceId].type === 'POLL')\n           .forEach(resourceId => {\n-            bindings[resourceId].resource.interval = startClientPoll(resourceId, bindings[resourceId].resource);\n+            bindings[resourceId].resource.interval = startClientPoll(resourceId, bindings, bindings[resourceId].resource);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6866f9e844950b3ee132c64dc80e80d1e1df40c3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTE0NjA2", "url": "https://github.com/cdapio/cdap/pull/11983#pullrequestreview-378114606", "createdAt": "2020-03-19T21:42:28Z", "commit": {"oid": "6866f9e844950b3ee132c64dc80e80d1e1df40c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "286635c905cb57977fcb99092f01f7328b5c3dbd", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/286635c905cb57977fcb99092f01f7328b5c3dbd", "committedDate": "2020-03-19T22:58:33Z", "message": "Add missing argument to startClientPoll and improve error msg on 404"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6866f9e844950b3ee132c64dc80e80d1e1df40c3", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/6866f9e844950b3ee132c64dc80e80d1e1df40c3", "committedDate": "2020-03-19T21:00:18Z", "message": "Make changes to startClientPoll based on feedback"}, "afterCommit": {"oid": "286635c905cb57977fcb99092f01f7328b5c3dbd", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/286635c905cb57977fcb99092f01f7328b5c3dbd", "committedDate": "2020-03-19T22:58:33Z", "message": "Add missing argument to startClientPoll and improve error msg on 404"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2273, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}