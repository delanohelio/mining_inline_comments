{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4ODYwMjYz", "number": 12797, "title": "(CDAP-17323) Skip network checking logic for Existing Dataproc", "bodyText": "", "createdAt": "2020-10-06T22:03:46Z", "url": "https://github.com/cdapio/cdap/pull/12797", "merged": true, "mergeCommit": {"oid": "970815913b538a69103cf69c1a41cde857e2b4fd"}, "closed": true, "closedAt": "2020-10-07T00:41:26Z", "author": {"login": "chtyim"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP_WSqAH2gAyNDk4ODYwMjYzOmE0NGQ4OTQ4NzA5NjBmMmMyNTFlY2UxMjBjOTdhY2NlNDYyNjNkY2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQA7OngFqTUwMzQyMzIyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a44d894870960f2c251ece120c97acce46263dca", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/a44d894870960f2c251ece120c97acce46263dca", "committedDate": "2020-10-06T21:34:28Z", "message": "(CDAP-17323) Skip network checking logic for Existing Dataproc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDAzMjEy", "url": "https://github.com/cdapio/cdap/pull/12797#pullrequestreview-503403212", "createdAt": "2020-10-06T22:27:13Z", "commit": {"oid": "a44d894870960f2c251ece120c97acce46263dca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMjoyNzoxNFrOHdcGcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMjoyNzoxNFrOHdcGcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDYzMTE1NA==", "bodyText": "Should we add it to @throws? Also I'd reformulate \"This shouldn't happen\" as it may happen, it's just a client that can't create clusters.", "url": "https://github.com/cdapio/cdap/pull/12797#discussion_r500631154", "createdAt": "2020-10-06T22:27:14Z", "author": null, "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "diffHunk": "@@ -314,6 +336,13 @@ ClusterOperationMetadata createCluster(String name, String imageVersion, Map<Str\n                                          boolean privateInstance)\n     throws RetryableProvisionException, InterruptedException, IOException {\n \n+    if (network == null) {\n+      // This shouldn't happen as the fromConf method should already check.\n+      // This is to guard against programmatic bug that this client was created without network information and\n+      // yet being used to create cluster.\n+      throw new IllegalArgumentException(\"Missing network information\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a44d894870960f2c251ece120c97acce46263dca"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDIzMjIw", "url": "https://github.com/cdapio/cdap/pull/12797#pullrequestreview-503423220", "createdAt": "2020-10-06T23:15:57Z", "commit": {"oid": "a44d894870960f2c251ece120c97acce46263dca"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMzoxNTo1OFrOHddH-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQyMzoxNzozMFrOHddJyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0NzkyOA==", "bodyText": "Do we need to pass network explicitly? since it's a member variable and should already be available in isInternalIpOnly right?", "url": "https://github.com/cdapio/cdap/pull/12797#discussion_r500647928", "createdAt": "2020-10-06T23:15:58Z", "author": {"login": "sagarkapare"}, "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "diffHunk": "@@ -648,7 +677,7 @@ void updateClusterLabels(String clusterName,\n    * @param sshRuntimeMonitor {@code true} if SSH is used for runtime monitoring\n    * @return {@code true} for pribvate IP only Dataproc cluster\n    */\n-  private boolean isInternalIPOnly(boolean privateInstance, boolean sshRuntimeMonitor) {\n+  private boolean isInternalIPOnly(Network network, boolean privateInstance, boolean sshRuntimeMonitor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a44d894870960f2c251ece120c97acce46263dca"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0ODM5NQ==", "bodyText": "Similarly here no need to pass network explicitly to the method.", "url": "https://github.com/cdapio/cdap/pull/12797#discussion_r500648395", "createdAt": "2020-10-06T23:17:30Z", "author": {"login": "sagarkapare"}, "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "diffHunk": "@@ -701,7 +730,7 @@ private boolean isInternalIPOnly(boolean privateInstance, boolean sshRuntimeMoni\n    * @return a {@link Collection} of tags that need to be added to the VM to have those firewall rules applies\n    * @throws IOException If failed to discover those firewall rules\n    */\n-  private List<String> getFirewallTargetTags(boolean useInternalIP) throws IOException {\n+  private List<String> getFirewallTargetTags(Network network, boolean useInternalIP) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a44d894870960f2c251ece120c97acce46263dca"}, "originalPosition": 84}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1678, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}