{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNjU2ODA0", "number": 11991, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMzo0ODo1NFrODux2gA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNTozMDo1OVrODwQpFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMzc3ODU2OnYy", "diffSide": "RIGHT", "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMzo0ODo1NFrOGA4kgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMzo0ODo1NFrOGA4kgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzU4MDAzNA==", "bodyText": "It's better to include the plugin name as well.", "url": "https://github.com/cdapio/cdap/pull/11991#discussion_r403580034", "createdAt": "2020-04-04T23:48:54Z", "author": {"login": "chtyim"}, "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "diffHunk": "@@ -57,4 +57,26 @@ public InvalidPluginConfigException(String message, Set<String> missingPropertie\n   public Set<InvalidPluginProperty> getInvalidProperties() {\n     return invalidProperties;\n   }\n+\n+  private static String generateErrorMessage(String baseMessage, Set<String> missingProperties,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e37ff16c17a3cba44bbe19a11de7270c1ab0d4"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMzc5MjIwOnYy", "diffSide": "RIGHT", "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMzo1MjozMVrOGA4qyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQyMzo1MjozMVrOGA4qyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzU4MTY0MA==", "bodyText": "Also, invalid property is caused by an exception when trying to set the field. So it'll be good if this exception can carry those as suppressed causes.", "url": "https://github.com/cdapio/cdap/pull/11991#discussion_r403581640", "createdAt": "2020-04-04T23:52:31Z", "author": {"login": "chtyim"}, "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "diffHunk": "@@ -57,4 +57,26 @@ public InvalidPluginConfigException(String message, Set<String> missingPropertie\n   public Set<InvalidPluginProperty> getInvalidProperties() {\n     return invalidProperties;\n   }\n+\n+  private static String generateErrorMessage(String baseMessage, Set<String> missingProperties,\n+                                             Set<InvalidPluginProperty> invalidProperties) {\n+    if (missingProperties.isEmpty() && invalidProperties.isEmpty()) {\n+      return baseMessage;\n+    }\n+\n+    StringBuilder errorMessage = new StringBuilder(baseMessage);\n+    if (missingProperties.size() == 1) {\n+      errorMessage.append(String.format(\" Required property '%s' is missing.\", missingProperties.iterator().next()));\n+    } else if (missingProperties.size() > 1) {\n+      errorMessage.append(String.format(\" Required properties '%s' are missing.\",\n+                                        String.join(\", \", missingProperties)));\n+    }\n+\n+    for (InvalidPluginProperty invalidProperty : invalidProperties) {\n+      errorMessage.append(String.format(\" '%s' is invalid: %s.\",\n+                                        invalidProperty.getName(), invalidProperty.getErrorMessage()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e37ff16c17a3cba44bbe19a11de7270c1ab0d4"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxOTMwOTAzOnYy", "diffSide": "RIGHT", "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNTozMDo1OVrOGDKH4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwNTozMDo1OVrOGDKH4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk2NDc2OA==", "bodyText": "A better wait is to use map:\ninvalidProperties.stream()\n  .map(InvalidPluginProperty::getCause)\n  .filter(Objects::nonNull)\n  .forEach(this::addSuppressed)", "url": "https://github.com/cdapio/cdap/pull/11991#discussion_r405964768", "createdAt": "2020-04-09T05:30:59Z", "author": {"login": "chtyim"}, "path": "cdap-api/src/main/java/io/cdap/cdap/api/plugin/InvalidPluginConfigException.java", "diffHunk": "@@ -27,20 +27,23 @@\n  * the property type specified by the PluginConfig is incompatible with the value provided in the PluginProperties.\n  */\n public class InvalidPluginConfigException extends RuntimeException {\n-  private Set<String> missingProperties;\n-  private Set<InvalidPluginProperty> invalidProperties;\n+  private final Set<String> missingProperties;\n+  private final Set<InvalidPluginProperty> invalidProperties;\n \n   public InvalidPluginConfigException(String message, Throwable cause) {\n     super(message, cause);\n     this.missingProperties = Collections.emptySet();\n     this.invalidProperties = Collections.emptySet();\n   }\n \n-  public InvalidPluginConfigException(String message, Set<String> missingProperties,\n+  public InvalidPluginConfigException(PluginClass pluginClass, Set<String> missingProperties,\n                                       Set<InvalidPluginProperty> invalidProperties) {\n-    super(message);\n+    super(generateErrorMessage(pluginClass, missingProperties, invalidProperties));\n     this.missingProperties = Collections.unmodifiableSet(new HashSet<>(missingProperties));\n     this.invalidProperties = Collections.unmodifiableSet(new HashSet<>(invalidProperties));\n+    invalidProperties.stream()\n+      .filter(p -> p.getCause() != null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b86a1305aab5de3195d496080ec38baa7aa53e7b"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2870, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}