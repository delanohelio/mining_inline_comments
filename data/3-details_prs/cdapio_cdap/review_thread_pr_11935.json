{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MzgzNzk2", "number": 11935, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0MTo0NlrODmKp2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0Mzo0MVrODmKqsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMzQ3MDMzOnYy", "diffSide": "RIGHT", "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/metadata/LineageHTTPHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0MTo0NlrOFzbcIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0MzoyOFrOFzbdLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3MTI2NQ==", "bodyText": "Is that mean directionStr can be null? Please annotate with @Nullable if that's the case.", "url": "https://github.com/cdapio/cdap/pull/11935#discussion_r389471265", "createdAt": "2020-03-09T05:41:46Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/metadata/LineageHTTPHandler.java", "diffHunk": "@@ -301,7 +301,7 @@ public long getEnd() {\n   private Constants.FieldLineage.Direction parseDirection(String directionStr) throws BadRequestException {\n     try {\n       return Constants.FieldLineage.Direction.valueOf(directionStr.toUpperCase());\n-    } catch (IllegalArgumentException e) {\n+    } catch (NullPointerException | IllegalArgumentException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b4cfe41e94f991fdc92c83d47ebb72ae4bb411"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3MTUzMw==", "bodyText": "Fixed", "url": "https://github.com/cdapio/cdap/pull/11935#discussion_r389471533", "createdAt": "2020-03-09T05:43:28Z", "author": {"login": "yaojiefeng"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/metadata/LineageHTTPHandler.java", "diffHunk": "@@ -301,7 +301,7 @@ public long getEnd() {\n   private Constants.FieldLineage.Direction parseDirection(String directionStr) throws BadRequestException {\n     try {\n       return Constants.FieldLineage.Direction.valueOf(directionStr.toUpperCase());\n-    } catch (IllegalArgumentException e) {\n+    } catch (NullPointerException | IllegalArgumentException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3MTI2NQ=="}, "originalCommit": {"oid": "c0b4cfe41e94f991fdc92c83d47ebb72ae4bb411"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMzQ3MjQ5OnYy", "diffSide": "RIGHT", "path": "cdap-client/src/main/java/io/cdap/cdap/client/LineageClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0Mzo0MVrOFzbdWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNTo0Mzo0MVrOFzbdWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3MTU3OQ==", "bodyText": "Strictly speaking, should have URLEncoder.encode(direction).", "url": "https://github.com/cdapio/cdap/pull/11935#discussion_r389471579", "createdAt": "2020-03-09T05:43:41Z", "author": {"login": "chtyim"}, "path": "cdap-client/src/main/java/io/cdap/cdap/client/LineageClient.java", "diffHunk": "@@ -131,10 +132,31 @@ public LineageRecord getLineage(DatasetId datasetInstance, String startTime, Str\n     if (levels != null) {\n       path = String.format(\"%s&levels=%d\", path, levels);\n     }\n-    return getLineage(datasetInstance, path);\n+    return getLineage(datasetInstance, path, LineageRecord.class);\n   }\n \n-  private LineageRecord getLineage(NamespacedEntityId namespacedId, String path)\n+  /**\n+   * Retrieves field lineage about a dataset\n+   *\n+   * @param datasetId the dataset for which to retrieve lineage\n+   * @param startTime start time for the query, in milliseconds, or in 'now - xs' format\n+   * @param endTime end time for the query, in milliseconds, or in 'now - xs' format\n+   * @param direction direction of the field lineage, can be incoming, outgoing or both\n+   * @return {@link FieldLineageSummary} for the specified dataset.\n+   */\n+  public FieldLineageSummary getFieldLineage(DatasetId datasetId, long startTime, long endTime,\n+                                             String direction)\n+    throws IOException, BadRequestException, NotFoundException, UnauthenticatedException {\n+    String path = String.format(\"datasets/%s/lineage/allfieldlineage?start=%s&end=%s\", datasetId.getDataset(),\n+                                URLEncoder.encode(Long.toString(startTime), \"UTF-8\"),\n+                                URLEncoder.encode(Long.toString(endTime), \"UTF-8\"));\n+    if (direction != null) {\n+      path = String.format(\"%s&direction=%s\", path, direction);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b4cfe41e94f991fdc92c83d47ebb72ae4bb411"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2801, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}