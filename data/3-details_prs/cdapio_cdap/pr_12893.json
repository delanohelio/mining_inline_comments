{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NjM2NDQ0", "number": 12893, "title": "[CDAP-17453][CDAP-17445][CDAP-17443] Replication graph tooltip, table selection, and time selections", "bodyText": "JIRAs:\n\nhttps://cdap.atlassian.net/browse/CDAP-17453\nhttps://cdap.atlassian.net/browse/CDAP-17445\nhttps://cdap.atlassian.net/browse/CDAP-17443\n\nBuild: https://builds.cask.co/browse/CDAP-UDUT893", "createdAt": "2020-12-10T04:50:05Z", "url": "https://github.com/cdapio/cdap/pull/12893", "merged": true, "mergeCommit": {"oid": "e201b94ab53054fe38be967934d81a10887cc573"}, "closed": true, "closedAt": "2020-12-15T18:06:24Z", "author": {"login": "elfenheart"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdk3kklABqjQwOTY1Njg2Mjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmSQphABqjQxMTI1NzkwMDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae41af75357db973d02366e56db7b11b36d096e3", "author": {"user": {"login": "elfenheart", "name": "Edwin Elia"}}, "url": "https://github.com/cdapio/cdap/commit/ae41af75357db973d02366e56db7b11b36d096e3", "committedDate": "2020-12-10T04:44:31Z", "message": "add time period selection"}, "afterCommit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072", "author": {"user": {"login": "elfenheart", "name": "Edwin Elia"}}, "url": "https://github.com/cdapio/cdap/commit/5e61ef6a7a111bfbf4c02b5244200c37c6bc1072", "committedDate": "2020-12-10T18:23:02Z", "message": "add time period selection"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5Njk3ODc2", "url": "https://github.com/cdapio/cdap/pull/12893#pullrequestreview-549697876", "createdAt": "2020-12-10T23:38:57Z", "commit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzozODo1N1rOIDidLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzozODo1N1rOIDidLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4MTE2NA==", "bodyText": "Nit: Why not just const heading = activeTable || 'All tables replicated';", "url": "https://github.com/cdapio/cdap/pull/12893#discussion_r540581164", "createdAt": "2020-12-10T23:38:57Z", "author": {"login": "njbriggs"}, "path": "cdap-ui/app/cdap/components/Replicator/Detail/SelectedTable/index.tsx", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import React, { useContext } from 'react';\n+import withStyles, { WithStyles, StyleRules } from '@material-ui/core/styles/withStyles';\n+import { DetailContext } from 'components/Replicator/Detail';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    root: {\n+      padding: '0 15px',\n+      marginBottom: '25px',\n+      display: 'flex',\n+      alignItems: 'center',\n+    },\n+    reset: {\n+      color: theme.palette.blue[100],\n+      cursor: 'pointer',\n+      marginLeft: '5px',\n+\n+      '&:hover': {\n+        textDecoration: 'underline',\n+      },\n+    },\n+    activeTableText: {\n+      marginLeft: '10px',\n+    },\n+    heading: {\n+      marginBottom: 0,\n+    },\n+  };\n+};\n+\n+const SelectedTableView: React.FC<WithStyles<typeof styles>> = ({ classes }) => {\n+  const { activeTable, setActiveTable } = useContext(DetailContext);\n+\n+  function handleReset() {\n+    setActiveTable(null);\n+  }\n+\n+  const heading = activeTable ? `\"${activeTable}\"` : 'All tables replicated';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NzAzMzc2", "url": "https://github.com/cdapio/cdap/pull/12893#pullrequestreview-549703376", "createdAt": "2020-12-10T23:52:20Z", "commit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo1MjoyMFrOIDiy2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo1MjoyMFrOIDiy2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4NjcxMw==", "bodyText": "Can you consider a material-ui component for consistency? Popper might work, but I don't know if anchorEl will accept an SVG element.", "url": "https://github.com/cdapio/cdap/pull/12893#discussion_r540586713", "createdAt": "2020-12-10T23:52:20Z", "author": {"login": "njbriggs"}, "path": "cdap-ui/app/cdap/components/Replicator/Detail/TableScatterPlotGraph/ScatterPlotTooltip.tsx", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import React from 'react';\n+import withStyles, { WithStyles, StyleRules } from '@material-ui/core/styles/withStyles';\n+import { ITableMetricsData } from 'components/Replicator/Detail/TableScatterPlotGraph/parser';\n+import { numberFormat } from 'components/Replicator/Detail/TableScatterPlotGraph/ScatterPlotTable';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    tooltip: {\n+      position: 'absolute',\n+      backgroundColor: theme.palette.white[50],\n+      boxShadow: theme.shadows[3],\n+      padding: '15px 0',\n+      width: '350px',\n+    },\n+    tooltipHeading: {\n+      marginBottom: '25px',\n+      padding: '0 15px',\n+    },\n+    tooltipMetrics: {\n+      display: 'grid',\n+      gridTemplateColumns: '50% 50%',\n+    },\n+    metricContent: {\n+      padding: '0 15px',\n+\n+      '&:first-child': {\n+        borderRight: `1px solid ${theme.palette.grey[300]}`,\n+      },\n+\n+      '& > div': {\n+        display: 'grid',\n+        gridTemplateColumns: '50% 50%',\n+      },\n+    },\n+    metric: {\n+      textAlign: 'right',\n+    },\n+  };\n+};\n+\n+interface IScatterPlotTooltipProps extends WithStyles<typeof styles> {\n+  tooltip: {\n+    top: number;\n+    left: number;\n+    isOpen: boolean;\n+    activeData?: Partial<ITableMetricsData>;\n+  };\n+}\n+\n+const ScatterPlotTooltipView: React.FC<IScatterPlotTooltipProps> = ({ classes, tooltip }) => {\n+  const activeTooltip: Partial<ITableMetricsData> =\n+    tooltip && tooltip.activeData ? tooltip.activeData : {};\n+  return (\n+    <div", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NzA0MzU5", "url": "https://github.com/cdapio/cdap/pull/12893#pullrequestreview-549704359", "createdAt": "2020-12-10T23:54:47Z", "commit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo1NDo0N1rOIDi2pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo1NDo0N1rOIDi2pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4NzY4Ng==", "bodyText": "Can you take advantage of margin and other constants rather than putting raw numbers here?", "url": "https://github.com/cdapio/cdap/pull/12893#discussion_r540587686", "createdAt": "2020-12-10T23:54:47Z", "author": {"login": "njbriggs"}, "path": "cdap-ui/app/cdap/components/Replicator/Detail/TableScatterPlotGraph/scatterPlot.ts", "diffHunk": "@@ -158,8 +170,35 @@ export function renderScatterPlot(id: string, data: ITableMetricsData[], contain\n         return COLOR_MAP.inactiveOutline;\n       }\n       return COLOR_MAP.activeOutline;\n+    })\n+    .on('mouseover', (d) => {\n+      const { top, left } = getTooltipPosition(d);\n+      onHover(top, left, true, d);\n+    })\n+    .on('mouseout', (d) => {\n+      if (isClicked) {\n+        return;\n+      }\n+      onHover(0, 0, false, d);\n+    })\n+    .on('click', (d) => {\n+      addOverlay(d);\n     });\n \n+  function getTooltipPosition(d) {\n+    const top = y(d.latency) - 70 + 'px';\n+    let left = x(d.eventsPerMin) + 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "originalPosition": 64}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NzA3OTg2", "url": "https://github.com/cdapio/cdap/pull/12893#pullrequestreview-549707986", "createdAt": "2020-12-11T00:03:43Z", "commit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwMDowMzo0M1rOIDjErw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwMDowMzo0M1rOIDjErw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU5MTI3OQ==", "bodyText": "Is there a \"standard\" dropdown here? Could there be a shared component that takes a couple fields and some list items?", "url": "https://github.com/cdapio/cdap/pull/12893#discussion_r540591279", "createdAt": "2020-12-11T00:03:43Z", "author": {"login": "njbriggs"}, "path": "cdap-ui/app/cdap/components/Replicator/Detail/ThroughputLatencyGraphs/LatencyGraph/LatencyTooltip.tsx", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import React from 'react';\n+import withStyles, { WithStyles, StyleRules } from '@material-ui/core/styles/withStyles';\n+import { IThroughputLatencyData } from 'components/Replicator/Detail/ThroughputLatencyGraphs/parser';\n+import { formatLatency } from 'components/Replicator/Detail/ThroughputLatencyGraphs/LatencyGraph/LatencyTable';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    tooltip: {\n+      position: 'absolute',\n+      backgroundColor: theme.palette.white[50],\n+      boxShadow: theme.shadows[3],\n+      padding: '15px',\n+      width: '250px',\n+    },\n+    heading: {\n+      marginBottom: '10px',\n+    },\n+  };\n+};\n+\n+interface ILatencyTooltipProps extends WithStyles<typeof styles> {\n+  tooltip: {\n+    top: number;\n+    left: number;\n+    isOpen: boolean;\n+    activeData?: Partial<IThroughputLatencyData>;\n+  };\n+}\n+\n+const LatencyTooltipView: React.FC<ILatencyTooltipProps> = ({ classes, tooltip }) => {\n+  const tooltipData: Partial<IThroughputLatencyData> =\n+    tooltip && tooltip.activeData ? tooltip.activeData : {};\n+  return (\n+    <div\n+      className={classes.tooltip}\n+      style={{\n+        top: tooltip.top,\n+        left: tooltip.left,\n+        opacity: tooltip.isOpen ? 1 : 0,\n+      }}\n+    >\n+      <div className={classes.heading}>\n+        <strong>{tooltipData.formattedTimeRange}</strong>\n+      </div>\n+      <div>\n+        <div>Average latency</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e61ef6a7a111bfbf4c02b5244200c37c6bc1072"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDI2OTIz", "url": "https://github.com/cdapio/cdap/pull/12893#pullrequestreview-552026923", "createdAt": "2020-12-15T01:03:31Z", "commit": {"oid": "e2dfa9c72b8b48f83f5186af582d4a8393931e57"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6a50910786eefd5caaebeac077494794c2dd192", "author": {"user": {"login": "elfenheart", "name": "Edwin Elia"}}, "url": "https://github.com/cdapio/cdap/commit/a6a50910786eefd5caaebeac077494794c2dd192", "committedDate": "2020-12-15T04:02:22Z", "message": "[CDAP-17453][CDAP-17445][CDAP-17443] Replication graph tooltip, table selection, and time selections"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2dfa9c72b8b48f83f5186af582d4a8393931e57", "author": {"user": {"login": "elfenheart", "name": "Edwin Elia"}}, "url": "https://github.com/cdapio/cdap/commit/e2dfa9c72b8b48f83f5186af582d4a8393931e57", "committedDate": "2020-12-14T18:48:10Z", "message": "remove magic numbers"}, "afterCommit": {"oid": "a6a50910786eefd5caaebeac077494794c2dd192", "author": {"user": {"login": "elfenheart", "name": "Edwin Elia"}}, "url": "https://github.com/cdapio/cdap/commit/a6a50910786eefd5caaebeac077494794c2dd192", "committedDate": "2020-12-15T04:02:22Z", "message": "[CDAP-17453][CDAP-17445][CDAP-17443] Replication graph tooltip, table selection, and time selections"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1412, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}