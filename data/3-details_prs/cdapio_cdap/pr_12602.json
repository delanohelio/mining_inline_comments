{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0ODkyODc3", "number": 12602, "title": "[CDAP-16714] Implement TTL for the preview data.", "bodyText": "This PR contains following changes:\n\nUpdated row key prefix for the row containing preview metadata such as status, pollerinfo. Such row is now stored with rowkey prefix: META_ROW_KEY_PREFIX\nActual user data is stored with row key prefix: DATA_ROW_KEY_PREFIX\nAdded the PreviewDataCleanupService which scans over metadata rows in PreviewStore (i.e. rows with key prefix META_ROW_KEY_PREFIX). While scanning we find preview id, and if TTL has happened for the current preview id, delete metadata row as well as data rows for that preview id.\nDefault cleanup interval is set to 1 hr.\nDefault preview data TTL is set to 24 hrs.", "createdAt": "2020-08-07T23:58:44Z", "url": "https://github.com/cdapio/cdap/pull/12602", "merged": true, "mergeCommit": {"oid": "b409da5b407dc817d8facad606c3928b6ca9f4a0"}, "closed": true, "closedAt": "2020-08-11T04:47:01Z", "author": {"login": "sagarkapare"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9sfFJAFqTQ2NDY4NzY2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9u5cDABqjM2NDEzNTQzNzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0Njg3NjY3", "url": "https://github.com/cdapio/cdap/pull/12602#pullrequestreview-464687667", "createdAt": "2020-08-11T01:21:40Z", "commit": {"oid": "4b675b06cbd91f19ff843f45111f5440f387db5a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMToyMTo0MVrOG-lF8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMToyMTo0MVrOG-lF8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI3MjYyNw==", "bodyText": "Call it 'deleteExpiredData`", "url": "https://github.com/cdapio/cdap/pull/12602#discussion_r468272627", "createdAt": "2020-08-11T01:21:41Z", "author": {"login": "chtyim"}, "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/app/store/preview/PreviewStore.java", "diffHunk": "@@ -121,4 +121,10 @@\n    */\n   @Nullable\n   byte[] getPreviewRequestPollerInfo(ApplicationId applicationId);\n+\n+  /**\n+   * Deletes the preview data older than ttl.\n+   * @param ttlInSeconds ttl in seconds\n+   */\n+  void deleteDataOlderThan(long ttlInSeconds);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b675b06cbd91f19ff843f45111f5440f387db5a"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b57fd42e09a1e9f8c43eebf14b1baccc487d366", "author": {"user": {"login": "sagarkapare", "name": "sagarkapare"}}, "url": "https://github.com/cdapio/cdap/commit/7b57fd42e09a1e9f8c43eebf14b1baccc487d366", "committedDate": "2020-08-11T04:13:17Z", "message": "[CDAP-16714] Implement TTL for the preview data."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b675b06cbd91f19ff843f45111f5440f387db5a", "author": {"user": {"login": "sagarkapare", "name": "sagarkapare"}}, "url": "https://github.com/cdapio/cdap/commit/4b675b06cbd91f19ff843f45111f5440f387db5a", "committedDate": "2020-08-07T23:49:00Z", "message": "[CDAP-16714] Implement TTL for the preview data."}, "afterCommit": {"oid": "7b57fd42e09a1e9f8c43eebf14b1baccc487d366", "author": {"user": {"login": "sagarkapare", "name": "sagarkapare"}}, "url": "https://github.com/cdapio/cdap/commit/7b57fd42e09a1e9f8c43eebf14b1baccc487d366", "committedDate": "2020-08-11T04:13:17Z", "message": "[CDAP-16714] Implement TTL for the preview data."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1789, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}