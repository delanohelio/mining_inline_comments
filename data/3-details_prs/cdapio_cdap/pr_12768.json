{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NzE2NDA5", "number": 12768, "title": "[CDAP-17246] Fix js error while editing draft or importing pipeline from wrangler", "bodyText": "JIRA - https://issues.cask.co/browse/CDAP-17246\nCause\n\nThis PR #12762 fixes importing pipeline from 6.1.x version of CDAP to 6.2.\nHowever this change introduced issues with importing pipeline from wrangler or editing drafts\nWe introduced 'id' as part of every node in the pipeline being imported. We didn't however fix the path where users could import pipeline from wrangler or edit drafts.\n\nTesting\n\nThis PR fixes all possible places where an individual node name/label would be used or modified.\n\nImport via UI\nImport/Edit via wrangler\nEdit drafts\nCopy/Paste nodes (editing pipeline)\nAdd/Delete nodes\nGroup delete nodes\nUndo/Redo actions (deleting and undoing delete)\nDuplicate from pipeline details\nPreview (run and fetch data for nodes with spaces in their labels)\n\n\n\nSide-Effect\n\n#12749 This PR fixes fetching preview for individual stages by changing label to name. Since we need to use labels (user identifiable names for nodes) I have restored the original behavior of sending in labels for preview. We need to make sure the node labels are properly used in constructing the pipeline.", "createdAt": "2020-09-14T15:49:04Z", "url": "https://github.com/cdapio/cdap/pull/12768", "merged": true, "mergeCommit": {"oid": "abc0501513a663e94f2977b31350bbd18a064d23"}, "closed": true, "closedAt": "2020-09-16T00:24:53Z", "author": {"login": "ajainarayanan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJL8vJgFqTQ4ODk0NDk3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJQ1OLABqjM3NzA3NDk5NDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4OTQ0OTc2", "url": "https://github.com/cdapio/cdap/pull/12768#pullrequestreview-488944976", "createdAt": "2020-09-15T18:17:09Z", "commit": {"oid": "c675284e1064ba5a5fab05c2bcfc7b84382eee39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODoxNzowOVrOHSOTUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODoxNzowOVrOHSOTUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3MDczOA==", "bodyText": "why not use uuid instead of doing random?", "url": "https://github.com/cdapio/cdap/pull/12768#discussion_r488870738", "createdAt": "2020-09-15T18:17:09Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/hydrator/services/hydrator-service.js", "diffHunk": "@@ -41,7 +41,8 @@ class HydratorPlusPlusHydratorService {\n       let nodeInfo = angular.extend(stage, {\n         type: stage.plugin.type,\n         label: stage.plugin.label,\n-        icon: this.DAGPlusPlusFactory.getIcon(stage.plugin.name)\n+        icon: this.DAGPlusPlusFactory.getIcon(stage.plugin.name),\n+        id: stage.id || `${stage.name.replace(/[ \\/]/g, '-')}${Math.floor(Math.random() * 100)}`,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c675284e1064ba5a5fab05c2bcfc7b84382eee39"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MDQyMjkw", "url": "https://github.com/cdapio/cdap/pull/12768#pullrequestreview-489042290", "createdAt": "2020-09-15T20:23:55Z", "commit": {"oid": "f96b2ed2d2f06d60117f933aff455d160a8abf54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MDg5ODc4", "url": "https://github.com/cdapio/cdap/pull/12768#pullrequestreview-489089878", "createdAt": "2020-09-15T21:15:42Z", "commit": {"oid": "f96b2ed2d2f06d60117f933aff455d160a8abf54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b6155792f0b2cfb9b1aafee3cccac3baf7f006f", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/4b6155792f0b2cfb9b1aafee3cccac3baf7f006f", "committedDate": "2020-09-15T23:57:31Z", "message": "[CDAP-17246] Fixes js error while importing from hub or adding pipeline from wrangler\n\n- Fixes plugins with spaces in labels to show preview data\n- Fixes selecting nodes/connections using keyboard to copy/paste\n- Fixes e2e tests failing in 6.2.2\n- Fixes nodes copied from 6.1.x version of CDAP to pasteable in 6.2.x"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f96b2ed2d2f06d60117f933aff455d160a8abf54", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/f96b2ed2d2f06d60117f933aff455d160a8abf54", "committedDate": "2020-09-15T20:21:31Z", "message": "Fixes nodes copied from 6.1.x version of CDAP to pasteable in 6.2.x"}, "afterCommit": {"oid": "4b6155792f0b2cfb9b1aafee3cccac3baf7f006f", "author": {"user": {"login": "ajainarayanan", "name": "Ajai"}}, "url": "https://github.com/cdapio/cdap/commit/4b6155792f0b2cfb9b1aafee3cccac3baf7f006f", "committedDate": "2020-09-15T23:57:31Z", "message": "[CDAP-17246] Fixes js error while importing from hub or adding pipeline from wrangler\n\n- Fixes plugins with spaces in labels to show preview data\n- Fixes selecting nodes/connections using keyboard to copy/paste\n- Fixes e2e tests failing in 6.2.2\n- Fixes nodes copied from 6.1.x version of CDAP to pasteable in 6.2.x"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1655, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}