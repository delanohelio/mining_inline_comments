{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMDQyOTUw", "number": 12200, "title": "[CDAP-16845] Fix preview starting when user clicks No with post-run actions", "bodyText": "JIRA: https://issues.cask.co/browse/CDAP-16845\nBuild: https://builds.cask.co/browse/CDAP-URUT255", "createdAt": "2020-05-20T22:04:00Z", "url": "https://github.com/cdapio/cdap/pull/12200", "merged": true, "mergeCommit": {"oid": "02255a4eb52b3cf390883a72a203077d93b06280"}, "closed": true, "closedAt": "2020-06-03T15:00:34Z", "author": {"login": "yukiej"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjRJH7gFqTQxNTc2ODI2NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnql_LABqjM0MDI1NDE3ODI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NzY4MjY1", "url": "https://github.com/cdapio/cdap/pull/12200#pullrequestreview-415768265", "createdAt": "2020-05-20T22:51:47Z", "commit": {"oid": "5f0e813b17c39fdc12d624dad4f4a9441de6b07b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDA2NTU1", "url": "https://github.com/cdapio/cdap/pull/12200#pullrequestreview-420406555", "createdAt": "2020-05-28T19:05:31Z", "commit": {"oid": "5f0e813b17c39fdc12d624dad4f4a9441de6b07b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f0e813b17c39fdc12d624dad4f4a9441de6b07b", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/5f0e813b17c39fdc12d624dad4f4a9441de6b07b", "committedDate": "2020-05-20T22:00:34Z", "message": "Fix  callback"}, "afterCommit": {"oid": "fbba0c2a64b7723ba10094fac04dbffab4ca209e", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/fbba0c2a64b7723ba10094fac04dbffab4ca209e", "committedDate": "2020-05-28T21:49:25Z", "message": "Fix  callback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMjA4ODQx", "url": "https://github.com/cdapio/cdap/pull/12200#pullrequestreview-423208841", "createdAt": "2020-06-03T04:24:59Z", "commit": {"oid": "5bf89c684af1fa106693aa79a93c6660bf7e0911"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNDoyNDo1OVrOGeLk2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNDoyNDo1OVrOGeLk2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwMDEyMw==", "bodyText": "nit: it would be clear if the test case says either one or the other. Saying should run or not run preview doesn't say what this test case is testing :). May be split it into two test cases one starting preview after clicking yes and one not starting preview because user clicked no.", "url": "https://github.com/cdapio/cdap/pull/12200#discussion_r434300123", "createdAt": "2020-06-03T04:24:59Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/cypress/integration/pipeline.spec.ts", "diffHunk": "@@ -96,13 +112,88 @@ describe('Creating a pipeline', () => {\n       .find('.toggle-switch')\n       .click();\n     cy.get('@instrumentationDiv').contains('Off');\n+\n+    cy.contains('Pipeline alert').click();\n+    cy.contains('+').click();\n+    cy.contains('Send Email').click();\n+\n+    // enter sender, recipients, subject, message\n+\n+    cy.get('[data-cy=\"sender\"]').within(() => {\n+      cy.get('input')\n+        .scrollIntoView()\n+        .focus()\n+        .type(TEST_SENDER);\n+    });\n+    cy.get('[data-cy=\"recipients\"]').within(() => {\n+      cy.get('input').type(TEST_RECIPIENT);\n+    });\n+    cy.get('[data-cy=\"subject\"]').within(() => {\n+      cy.get('input').type(TEST_SUBJECT);\n+    });\n+    // validate and see error\n+    cy.get('[data-cy=\"validate-btn\"]').click();\n+\n+    cy.contains('error found').should('exist');\n+\n+    // Fix missing field to resolve error\n+    cy.get('[data-cy=\"message\"]').within(() => {\n+      cy.get('button').click();\n+    });\n+    // validate\n+    cy.get('[data-cy=\"validate-btn\"]').click();\n+    cy.wait(2000);\n+    cy.contains('error found').should('not.exist');\n+\n+    // click next\n+    cy.get('[data-cy=\"next-btn\"]').click();\n+\n+    // click confirm\n+    cy.get('[data-cy=\"confirm-btn\"]').click();\n+\n+    // See email alert\n+    cy.get('[data-cy=\"saved-alerts\"]').within(() => {\n+      cy.contains('Email').should('exist');\n+    });\n+\n     cy.get('[data-testid=config-apply-close]').click();\n+  });\n+  it('should run or not run Preview based on user action on postrun action modal', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bf89c684af1fa106693aa79a93c6660bf7e0911"}, "originalPosition": 92}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebe34a58615eb2b024c24b7a6f03b6bd0b6e08d5", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/ebe34a58615eb2b024c24b7a6f03b6bd0b6e08d5", "committedDate": "2020-06-03T14:45:33Z", "message": "Fix  callback\n\nAdd data-cy attributes for preview\n\nAdd preview tests to run locally to check for behavior when post-run action exists"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5bf89c684af1fa106693aa79a93c6660bf7e0911", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/5bf89c684af1fa106693aa79a93c6660bf7e0911", "committedDate": "2020-05-29T16:19:05Z", "message": "Add preview tests to run locally to check for behavior when post-run action exists"}, "afterCommit": {"oid": "ebe34a58615eb2b024c24b7a6f03b6bd0b6e08d5", "author": {"user": {"login": "yukiej", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/ebe34a58615eb2b024c24b7a6f03b6bd0b6e08d5", "committedDate": "2020-06-03T14:45:33Z", "message": "Fix  callback\n\nAdd data-cy attributes for preview\n\nAdd preview tests to run locally to check for behavior when post-run action exists"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2061, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}