{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MDA1OTI4", "number": 12211, "title": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "bodyText": "JIRA: https://issues.cask.co/browse/CDAP-16862\nLet users define configuration groups for plugin JSON file.\nProperties under configuration are as following.\n\n Widget-type\n Label\n Name\n Widget-category\n Widget-attributes (To be implemented in the next PRs)\n\nwidget-attributes are nested properties, which makes them slightly more complicated. It will be further discussed in the next issue.\n\nLet the user define properties under each configuration group (add/delete/edit)\nRefactored & simplified existing components from the page.\n\nThe view of the page", "createdAt": "2020-05-27T17:33:43Z", "url": "https://github.com/cdapio/cdap/pull/12211", "merged": true, "mergeCommit": {"oid": "1207d14c6cff1aaa8adb63b01f32b38dd5f63cae"}, "closed": true, "closedAt": "2020-06-15T16:11:36Z", "author": {"login": "jennac3"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclfW8iABqjMzNzk5NjU4MDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrim_PgBqjM0NDUwMzM2Mjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05c25e53254dbf5fd746ac12feb1cbe6ae4c2ceb", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/05c25e53254dbf5fd746ac12feb1cbe6ae4c2ceb", "committedDate": "2020-05-27T17:26:54Z", "message": "[CDAP-16862] Define properties under each configuration group (widget JSON)"}, "afterCommit": {"oid": "99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "committedDate": "2020-05-27T20:33:09Z", "message": "[CDAP-16862] Define properties under each configuration group (widget JSON)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "committedDate": "2020-05-27T20:33:09Z", "message": "[CDAP-16862] Define properties under each configuration group (widget JSON)"}, "afterCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "committedDate": "2020-06-01T19:05:02Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMjE1NTUz", "url": "https://github.com/cdapio/cdap/pull/12211#pullrequestreview-423215553", "createdAt": "2020-06-03T04:49:07Z", "commit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNDo0OTowN1rOGeL6lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNDo1NjoxNFrOGeMBuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNTY4Nw==", "bodyText": "Thats a little dangerous and takes away the essential use of css-in-js. This one component controls every single element rendered within itself. Will introduce issues when things change in unexpected places. Can we reconsider this?", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434305687", "createdAt": "2020-06-03T04:49:07Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      '& > *': {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjM1NQ==", "bodyText": "nit: Is the category plugin? Can this be a dropdown with only one value. We really don't want the user to type this in.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306355", "createdAt": "2020-06-03T04:51:34Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      '& > *': {\n+        width: '100%',\n+        marginTop: '10px',\n+        marginBottom: '10px',\n+      },\n+    },\n+  };\n+};\n+\n+interface IWidgetInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  widgetID: number;\n+}\n+\n+const WidgetInputView: React.FC<IWidgetInputProps> = ({\n+  classes,\n+  widgetID,\n+  widgetToInfo,\n+  setWidgetToInfo,\n+}) => {\n+  function onNameChange(obj, id) {\n+    return (name) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, name } }));\n+    };\n+  }\n+\n+  function onLabelChange(obj, id) {\n+    return (label) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, label } }));\n+    };\n+  }\n+\n+  function onWidgetTypeChange(obj, id) {\n+    return (widgetType) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetType } }));\n+    };\n+  }\n+\n+  function onWidgetCategoryChange(obj, id) {\n+    return (widgetCategory) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetCategory } }));\n+    };\n+  }\n+\n+  const widgetInfo = widgetToInfo[widgetID];\n+\n+  return (\n+    <If condition={widgetInfo}>\n+      <div className={classes.widgetInput}>\n+        <PluginInput\n+          widgetType={'textbox'}\n+          value={widgetInfo.name}\n+          setValue={onNameChange(widgetInfo, widgetID)}\n+          label={'Name'}\n+          placeholder={'Name a Widget'}\n+          required={false}\n+        />\n+        <PluginInput\n+          widgetType={'textbox'}\n+          value={widgetInfo.label}\n+          setValue={onLabelChange(widgetInfo, widgetID)}\n+          label={'Label'}\n+          placeholder={'Label a Widget'}\n+          required={false}\n+        />\n+        <PluginInput\n+          widgetType={'textbox'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQzNw==", "bodyText": "nit: relative to components path.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306437", "createdAt": "2020-06-03T04:51:57Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQ5NA==", "bodyText": "Same here.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306494", "createdAt": "2020-06-03T04:52:08Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';\n+import WidgetInput from './WidgetInput';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    widgetInputs: {\n+      '& > *': {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzAyNQ==", "bodyText": "Can we pull this style into this component and remove plain css or scss usage?", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307025", "createdAt": "2020-06-03T04:54:18Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';\n+import WidgetInput from './WidgetInput';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    widgetInputs: {\n+      '& > *': {\n+        marginTop: '20px',\n+        marginBottom: '20px',\n+      },\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={`widget-wrapper-label ${classes.addWidgetLabel}`}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzQ2Mw==", "bodyText": "Is it possible to type this? Typing this partially atleast would be helpful. Using typescript and using any takes away the advantage of using typescript.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307463", "createdAt": "2020-06-03T04:55:58Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/index.tsx", "diffHunk": "@@ -67,6 +67,14 @@ class CreateView extends React.PureComponent<ICreateContext & WithStyles<typeof\n     this.setState({ groupToInfo });\n   };\n \n+  public setGroupToWidgets = (groupToWidgets: any) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzUxMw==", "bodyText": "nit: components relative path.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307513", "createdAt": "2020-06-03T04:56:14Z", "author": {"login": "ajainarayanan"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/steps.tsx", "diffHunk": "@@ -14,8 +14,8 @@\n  * the License.\n  */\n \n-import BasicPluginInfo from 'components/PluginJSONCreator/Create/Content/BasicPluginInfo';\n import ConfigurationGroupsCollection from 'components/PluginJSONCreator/Create/Content/ConfigurationGroupsCollection';\n+import BasicPluginInfo from './Content/BasicPluginInfo';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "committedDate": "2020-06-01T19:05:02Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}, "afterCommit": {"oid": "4eb68c6d18782a0e1ec14476b940dabde623f50d", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/4eb68c6d18782a0e1ec14476b940dabde623f50d", "committedDate": "2020-06-03T20:54:51Z", "message": "address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "befec414ddaee2f0d5bc4e136225b8e82f3aa1eb", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/befec414ddaee2f0d5bc4e136225b8e82f3aa1eb", "committedDate": "2020-06-04T13:39:34Z", "message": "further fix additional stuff"}, "afterCommit": {"oid": "872de537f8f0931c2c7ffe55b55bf92592443080", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/872de537f8f0931c2c7ffe55b55bf92592443080", "committedDate": "2020-06-08T19:45:00Z", "message": "pull from develop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MTAwNzIx", "url": "https://github.com/cdapio/cdap/pull/12211#pullrequestreview-429100721", "createdAt": "2020-06-11T16:49:11Z", "commit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjo0OToxMVrOGimFcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNjo1OTo1MVrOGimdjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkyODc1NQ==", "bodyText": "this should use forEach", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438928755", "createdAt": "2020-06-11T16:49:11Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupsCollection/index.tsx", "diffHunk": "@@ -57,54 +56,74 @@ const ConfigurationGroupsCollectionView: React.FC<ICreateContext & WithStyles<ty\n   setConfigurationGroups,\n   groupToInfo,\n   setGroupToInfo,\n+  groupToWidgets,\n+  setGroupToWidgets,\n+  widgetToInfo,\n+  setWidgetToInfo,\n }) => {\n+  const [activeGroupIndex, setActiveGroupIndex] = React.useState(null);\n   const [localConfigurationGroups, setLocalConfigurationGroups] = React.useState(\n     configurationGroups\n   );\n-  const [activeGroupIndex, setActiveGroupIndex] = React.useState(null);\n   const [localGroupToInfo, setLocalGroupToInfo] = React.useState(groupToInfo);\n+  const [localGroupToWidgets, setLocalGroupToWidgets] = React.useState(groupToWidgets);\n+  const [localWidgetToInfo, setLocalWidgetToInfo] = React.useState(widgetToInfo);\n \n   function addConfigurationGroup(index: number) {\n-    const newGroupID = 'ConfigGroup_' + uuidV4();\n-\n-    // add a new group's ID at the specified index\n-    const newGroups = [...localConfigurationGroups];\n-    if (newGroups.length === 0) {\n-      newGroups.splice(0, 0, newGroupID);\n-    } else {\n-      newGroups.splice(index + 1, 0, newGroupID);\n-    }\n-    setLocalConfigurationGroups(newGroups);\n-\n-    // set the activeGroupIndex to the new group's index\n-    if (newGroups.length <= 1) {\n-      setActiveGroupIndex(0);\n-    } else {\n-      setActiveGroupIndex(index + 1);\n-    }\n-\n-    // set the default label and description of the group\n-    setLocalGroupToInfo({\n-      ...localGroupToInfo,\n-      [newGroupID]: {\n-        label: '',\n-        description: '',\n-      } as IConfigurationGroupInfo,\n-    });\n+    return () => {\n+      const newGroupID = 'ConfigGroup_' + uuidV4();\n+\n+      // Add a new group's ID at the specified index\n+      const newGroups = [...localConfigurationGroups];\n+      if (newGroups.length === 0) {\n+        newGroups.splice(0, 0, newGroupID);\n+      } else {\n+        newGroups.splice(index + 1, 0, newGroupID);\n+      }\n+      setLocalConfigurationGroups(newGroups);\n+\n+      // Set the activeGroupIndex to the new group's index\n+      if (newGroups.length <= 1) {\n+        setActiveGroupIndex(0);\n+      } else {\n+        setActiveGroupIndex(index + 1);\n+      }\n+\n+      // Set the mappings for the newly added group\n+      setLocalGroupToInfo({\n+        ...localGroupToInfo,\n+        [newGroupID]: {\n+          label: '',\n+          description: '',\n+        } as IConfigurationGroupInfo,\n+      });\n+      setLocalGroupToWidgets({ ...localGroupToWidgets, [newGroupID]: [] });\n+    };\n   }\n \n   function deleteConfigurationGroup(index: number) {\n-    setActiveGroupIndex(null);\n-\n-    // delete a group at the specified index\n-    const newGroups = [...localConfigurationGroups];\n-    const groupToDelete = newGroups[index];\n-    newGroups.splice(index, 1);\n-    setLocalConfigurationGroups(newGroups);\n+    return () => {\n+      setActiveGroupIndex(null);\n \n-    // delete the corresponding information of the group\n-    const { [groupToDelete]: info, ...restGroupToInfo } = localGroupToInfo;\n-    setLocalGroupToInfo(restGroupToInfo);\n+      // Delete a group at the specified index\n+      const newGroups = [...localConfigurationGroups];\n+      const groupToDelete = newGroups[index];\n+      newGroups.splice(index, 1);\n+      setLocalConfigurationGroups(newGroups);\n+\n+      // Delete the corresponding data of the group\n+      const { [groupToDelete]: info, ...restGroupToInfo } = localGroupToInfo;\n+      const { [groupToDelete]: widgets, ...restGroupToWidgets } = localGroupToWidgets;\n+      setLocalGroupToInfo(restGroupToInfo);\n+      setLocalGroupToWidgets(restGroupToWidgets);\n+\n+      // Delete all the widget information that belong to the group\n+      const newWidgetToInfo = localWidgetToInfo;\n+      widgets.map((widget) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTEwOQ==", "bodyText": "the setWidgetToInfo function should only accept the id and the modified object for the argument. The handling of the prevObjs should happen in the implementation of this function for the context", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438931109", "createdAt": "2020-06-11T16:53:12Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_CATEGORY, WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      marginTop: '20px',\n+      marginBottom: '20px',\n+    },\n+    widgetField: {\n+      width: '100%',\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+    },\n+  };\n+};\n+\n+interface IWidgetInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  widgetID: number;\n+}\n+\n+const WidgetInputView: React.FC<IWidgetInputProps> = ({\n+  classes,\n+  widgetID,\n+  widgetToInfo,\n+  setWidgetToInfo,\n+}) => {\n+  function onNameChange(obj, id) {\n+    return (name) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, name } }));\n+    };\n+  }\n+\n+  function onLabelChange(obj, id) {\n+    return (label) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, label } }));\n+    };\n+  }\n+\n+  function onWidgetTypeChange(obj, id) {\n+    return (widgetType) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetType } }));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTYyNA==", "bodyText": "this seemed dangerous if the screen size is small", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438931624", "createdAt": "2020-06-11T16:54:06Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMzg5OA==", "bodyText": "this comment doesn't have to be done in this PR.\nThis useEffect is one source of performance bottleneck. Every time user makes an edit to a widget, the groupToWidgets will get updated, and this useEffect gets triggered everytime. There's probably a better way to set the the activeWidget to prevent rerendering.", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438933898", "createdAt": "2020-06-11T16:58:00Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDU5OA==", "bodyText": "did you check javascript console for this? I think <If> expects only 1 children component", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438934598", "createdAt": "2020-06-11T16:59:13Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={classes.addWidgetLabel}>\n+        Add Widgets\n+        <span className={classes.required}>*</span>\n+      </div>\n+      <div className={classes.widgetContainer}>\n+        {activeWidgets.map((widgetID, widgetIndex) => {\n+          return (\n+            <If condition={widgetToInfo[widgetID]}>\n+              <div className={classes.eachWidget}>\n+                <WidgetInput\n+                  widgetToInfo={widgetToInfo}\n+                  widgetID={widgetID}\n+                  setWidgetToInfo={setWidgetToInfo}\n+                />\n+                <WidgetActionButtons\n+                  onAddWidgetToGroup={addWidgetToGroup(widgetIndex)}\n+                  onDeleteWidgetFromGroup={deleteWidgetFromGroup(widgetIndex)}\n+                />\n+              </div>\n+              <If condition={activeWidgets && widgetIndex < activeWidgets.length - 1}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 153}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDkyNg==", "bodyText": "can widgetToInfo[widgetID] ever not exist?", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438934926", "createdAt": "2020-06-11T16:59:51Z", "author": {"login": "elfenheart"}, "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={classes.addWidgetLabel}>\n+        Add Widgets\n+        <span className={classes.required}>*</span>\n+      </div>\n+      <div className={classes.widgetContainer}>\n+        {activeWidgets.map((widgetID, widgetIndex) => {\n+          return (\n+            <If condition={widgetToInfo[widgetID]}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa90989dabe4b1cff0944141cabee82f55d5a46a"}, "originalPosition": 141}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDk4MDk1", "url": "https://github.com/cdapio/cdap/pull/12211#pullrequestreview-430098095", "createdAt": "2020-06-13T00:49:27Z", "commit": {"oid": "44dda468bcaf4f0e3fd9aaef31817dec6e89a4fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "44dda468bcaf4f0e3fd9aaef31817dec6e89a4fb", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/44dda468bcaf4f0e3fd9aaef31817dec6e89a4fb", "committedDate": "2020-06-12T14:59:52Z", "message": "address comments"}, "afterCommit": {"oid": "d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "committedDate": "2020-06-15T14:58:15Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "committedDate": "2020-06-15T14:58:15Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}, "afterCommit": {"oid": "2634c6f30e22ac926b19b4d7403d40d876f9d7ba", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/2634c6f30e22ac926b19b4d7403d40d876f9d7ba", "committedDate": "2020-06-15T15:12:58Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2ca78a494a296ef5efa710a17e5991fa11c807b", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/e2ca78a494a296ef5efa710a17e5991fa11c807b", "committedDate": "2020-06-15T15:32:59Z", "message": "[CDAP-16861] Define configuration groups (plugin JSON Creator)"}, "afterCommit": {"oid": "f014e652e30e06813a4873fe7918a9e7fb2944a3", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/f014e652e30e06813a4873fe7918a9e7fb2944a3", "committedDate": "2020-06-15T15:34:52Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "577649e4cecff4c0af925b2a31e5f5d37646e2c0", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/577649e4cecff4c0af925b2a31e5f5d37646e2c0", "committedDate": "2020-06-15T15:43:57Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8dede2ea404ee25959eb27e084688e531f8d411c", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/8dede2ea404ee25959eb27e084688e531f8d411c", "committedDate": "2020-06-15T15:42:16Z", "message": "merge conflict"}, "afterCommit": {"oid": "577649e4cecff4c0af925b2a31e5f5d37646e2c0", "author": {"user": {"login": "jennac3", "name": "Jenna Choi"}}, "url": "https://github.com/cdapio/cdap/commit/577649e4cecff4c0af925b2a31e5f5d37646e2c0", "committedDate": "2020-06-15T15:43:57Z", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2079, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}