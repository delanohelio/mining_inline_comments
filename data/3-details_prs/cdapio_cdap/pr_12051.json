{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMjcxMzU4", "number": 12051, "title": "(CDAP-16369) Collections of provisioner improvement", "bodyText": "Changes are organized by commits:\n\n(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\nThe gives more control to the provision deletion implementation on the deletion state transition\n\nThe deprovisioning can make sure jobs are completed before deleting the cluster\nIt can relies on the state transition from the provisioning service to perform retry/polling logic\n\n\n\n\n(CDAP-16369) Add isTerminated to RuntimJobStatus\n\nThis helps simplify logic on determining if a job is terminated or not\n\n\n(CDAP-16369) Improve and fix Dataproc job files upload\n\nEnhance the file upload logic to use LocationFactory from CDAP\nThis automatically enables the local caching in distributed mode\nFix the bucket name settings in Dataproc provisioner such that it works with or without gs:// prefix\n\n\n(CDAP-16369) Expose LocationFactory to ProvisionerContext\n\nThis allows provisioner to have access to locations as used by CDAP\n\n\n(CDAP-16369) Deprecate ProgramRun in favor of ProgramRunInfo\n\nThe ProgramRunInfo is a super set of ProgramRun\n\n\n(CDAP-16369) Make provisioner executor size configurable\n\nThis is a small bug fix\nScheduledExecutor size shouldn't be 0", "createdAt": "2020-04-12T01:27:26Z", "url": "https://github.com/cdapio/cdap/pull/12051", "merged": true, "mergeCommit": {"oid": "b36edbcd9204217437d72d4c01d3b199f0d6bd10"}, "closed": true, "closedAt": "2020-04-12T14:42:12Z", "author": {"login": "chtyim"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWv5yAAH2gAyNDAyMjcxMzU4OjgxMTY4NWQwMjMyZGQ5YTIzOWQyZjk0M2ViMTEyNjIwMmYwYTUxMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWzTHLgBqjMyMjQ3ODE4MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "811685d0232dd9a239d2f943eb1126202f0a5122", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/811685d0232dd9a239d2f943eb1126202f0a5122", "committedDate": "2020-04-12T01:21:04Z", "message": "(CDAP-16369) Make provisioner executor size configurable\n\n- This is a small bug fix\n- ScheduledExecutor size shouldn't be 0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODE0NTMx", "url": "https://github.com/cdapio/cdap/pull/12051#pullrequestreview-391814531", "createdAt": "2020-04-12T02:03:37Z", "commit": {"oid": "052214bc6fea62d7c1374819a112ecd6f79f7ebf"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQwMjowMzozN1rOGEResw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQwMjowMzozN1rOGEResw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEzMzg3NQ==", "bodyText": "For deprecated methods, we usually add the release number from which the method/class is deprecated.\n\n  \n    \n      cdap/cdap-app-templates/cdap-etl/cdap-etl-api/src/main/java/io/cdap/cdap/etl/api/validation/InvalidConfigPropertyException.java\n    \n    \n         Line 23\n      in\n      1d62163\n    \n    \n    \n    \n\n        \n          \n            * Deprecated since 6.1.0. Use {@link ValidationFailure} instead.", "url": "https://github.com/cdapio/cdap/pull/12051#discussion_r407133875", "createdAt": "2020-04-12T02:03:37Z", "author": {"login": "CuriousVini"}, "path": "cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java", "diffHunk": "@@ -16,11 +16,16 @@\n \n package io.cdap.cdap.runtime.spi.provisioner;\n \n+import io.cdap.cdap.runtime.spi.ProgramRunInfo;\n+\n import java.util.Objects;\n \n /**\n  * A program run.\n+ *\n+ * @deprecated Use {@link ProgramRunInfo} instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "052214bc6fea62d7c1374819a112ecd6f79f7ebf"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1eedb74badf3c62eeb5fa1267993f08ca2e71f2", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/f1eedb74badf3c62eeb5fa1267993f08ca2e71f2", "committedDate": "2020-04-12T01:24:19Z", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic"}, "afterCommit": {"oid": "ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "committedDate": "2020-04-12T04:03:16Z", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8825d406bd24d8b4256a9962d6d336178829e1f1", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/8825d406bd24d8b4256a9962d6d336178829e1f1", "committedDate": "2020-04-12T05:18:17Z", "message": "(CDAP-16369) Deprecate ProgramRun in favor of ProgramRunInfo\n\n- The ProgramRunInfo is a super set of ProgramRun"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fb4da5b18fd482bc58fa30a15a26036f35ee155", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/6fb4da5b18fd482bc58fa30a15a26036f35ee155", "committedDate": "2020-04-12T05:18:17Z", "message": "(CDAP-16369) Expose LocationFactory to ProvisionerContext\n\n- This allows provisioner to have access to locations as used by CDAP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e393765a2dffae9f4007f2f634ae32bc0a095ef2", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/e393765a2dffae9f4007f2f634ae32bc0a095ef2", "committedDate": "2020-04-12T05:18:18Z", "message": "(CDAP-16369) Improve and fix Dataproc job files upload\n\n- Enhance the file upload logic to use LocationFactory from CDAP\n-- This automatically enables the local caching in distributed mode\n- Fix the bucket name settings in Dataproc provisioner such that it works with or without gs:// prefix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "559ff7fcace02d31c8c501403ac4d057006eb695", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/559ff7fcace02d31c8c501403ac4d057006eb695", "committedDate": "2020-04-12T05:18:18Z", "message": "(CDAP-16369) Add isTerminated to RuntimJobStatus\n\n- This helps simplify logic on determining if a job is terminated or not"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "348b579c316c4ff74dab6ea6d663be046ff85cad", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/348b579c316c4ff74dab6ea6d663be046ff85cad", "committedDate": "2020-04-12T05:18:18Z", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "committedDate": "2020-04-12T04:03:16Z", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic"}, "afterCommit": {"oid": "348b579c316c4ff74dab6ea6d663be046ff85cad", "author": {"user": {"login": "chtyim", "name": "Terence Yim"}}, "url": "https://github.com/cdapio/cdap/commit/348b579c316c4ff74dab6ea6d663be046ff85cad", "committedDate": "2020-04-12T05:18:18Z", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2146, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}