{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzODg5OTY5", "number": 12323, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0ODozMVrOEFNQpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0OTo0MlrOEFNRYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk1NTkwOnYy", "diffSide": "RIGHT", "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0ODozMVrOGjTY7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0ODozMVrOGjTY7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MTAyMg==", "bodyText": "Check for not empty string as well.", "url": "https://github.com/cdapio/cdap/pull/12323#discussion_r439671022", "createdAt": "2020-06-12T22:48:31Z", "author": {"login": "chtyim"}, "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "diffHunk": "@@ -368,6 +368,24 @@ ClusterOperationMetadata createCluster(String name, String imageVersion, Map<Str\n       clusterProperties.put(\"dataproc:dataproc.monitoring.stackdriver.enable\",\n                             Boolean.toString(conf.isStackdriverMonitoringEnabled()));\n \n+      InstanceGroupConfig.Builder instanceGroupBuilder = InstanceGroupConfig.newBuilder()\n+          .setNumInstances(conf.getWorkerNumNodes())\n+          .setMachineTypeUri(conf.getWorkerMachineType())\n+          .setDiskConfig(DiskConfig.newBuilder()\n+              .setBootDiskSizeGb(conf.getWorkerDiskGB())\n+              .setNumLocalSsds(0)\n+              .build());\n+      //If custom Image URI is specified, use that for cluster creation\n+      if (conf.getCustomImageUri() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "006a8ecbf5b1278ae3b06566612a0332cd4d0f19"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk1Nzc4OnYy", "diffSide": "RIGHT", "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0OTo0MlrOGjTaCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0OTo0MlrOGjTaCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MTMwNA==", "bodyText": "Better group this with an else to the if above.", "url": "https://github.com/cdapio/cdap/pull/12323#discussion_r439671304", "createdAt": "2020-06-12T22:49:42Z", "author": {"login": "chtyim"}, "path": "cdap-runtime-ext-dataproc/src/main/java/io/cdap/cdap/runtime/spi/provisioner/dataproc/DataprocClient.java", "diffHunk": "@@ -368,6 +368,24 @@ ClusterOperationMetadata createCluster(String name, String imageVersion, Map<Str\n       clusterProperties.put(\"dataproc:dataproc.monitoring.stackdriver.enable\",\n                             Boolean.toString(conf.isStackdriverMonitoringEnabled()));\n \n+      InstanceGroupConfig.Builder instanceGroupBuilder = InstanceGroupConfig.newBuilder()\n+          .setNumInstances(conf.getWorkerNumNodes())\n+          .setMachineTypeUri(conf.getWorkerMachineType())\n+          .setDiskConfig(DiskConfig.newBuilder()\n+              .setBootDiskSizeGb(conf.getWorkerDiskGB())\n+              .setNumLocalSsds(0)\n+              .build());\n+      //If custom Image URI is specified, use that for cluster creation\n+      if (conf.getCustomImageUri() != null) {\n+        instanceGroupBuilder.setImageUri(conf.getCustomImageUri());\n+      }\n+\n+      SoftwareConfig.Builder softwareConfigBuilder = SoftwareConfig.newBuilder()\n+          .putAllProperties(clusterProperties);\n+      //Use image version only if custom Image URI is not specified, otherwise may cause image version conflicts\n+      if (conf.getCustomImageUri() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "006a8ecbf5b1278ae3b06566612a0332cd4d0f19"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3398, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}