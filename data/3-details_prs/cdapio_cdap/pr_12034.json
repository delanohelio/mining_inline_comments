{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4OTIzMDk1", "number": 12034, "title": "(CDAP-16353) Refactor k8s deployment building in KubeTwillPreparer to a separate function", "bodyText": "What:\nRefactor the k8s deployment object building logic into a separate function\nwith all external data passed in via parameters (thus no access to member fields)\nWhy:\nAllow us to write a unit test for this function to verify the state of\ndeployment k8s object is as expected.", "createdAt": "2020-04-05T06:13:29Z", "url": "https://github.com/cdapio/cdap/pull/12034", "merged": true, "mergeCommit": {"oid": "fba457ab6bc88813b84db0b161d937dd14cfd515"}, "closed": true, "closedAt": "2020-04-06T06:38:03Z", "author": {"login": "wyzhang"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUk5BbAFqTM4Nzc4OTA5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcU4nmHABqjMyMDM3OTU2NzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Nzg5MDk5", "url": "https://github.com/cdapio/cdap/pull/12034#pullrequestreview-387789099", "createdAt": "2020-04-05T07:22:46Z", "commit": {"oid": "fe5a26243411bf75ee4fa38827aeac1ec0be6115"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwNzoyMjo0NlrOGA9hWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwNzoyMjo0NlrOGA9hWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY2MTE0NQ==", "bodyText": "Usually method exposed for testing should be kept as package private instead of public.", "url": "https://github.com/cdapio/cdap/pull/12034#discussion_r403661145", "createdAt": "2020-04-05T07:22:46Z", "author": {"login": "chtyim"}, "path": "cdap-kubernetes/src/main/java/io/cdap/cdap/k8s/runtime/KubeTwillPreparer.java", "diffHunk": "@@ -321,7 +322,21 @@ public TwillController start(long timeout, TimeUnit timeoutUnit) {\n     }\n   }\n \n-  private V1Deployment createDeployment(V1ConfigMap configMap, long startTimeoutMillis) throws ApiException {\n+  /**\n+   * Return a {@link V1Deployment} object that will be deployed in Kubernetes to run the program\n+   */\n+  @VisibleForTesting\n+  public V1Deployment buildDeployment(RunId runid,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe5a26243411bf75ee4fa38827aeac1ec0be6115"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2c45410be3158c1d51d10bc4622ef215ea9591f", "author": {"user": {"login": "wyzhang", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/b2c45410be3158c1d51d10bc4622ef215ea9591f", "committedDate": "2020-04-06T06:22:04Z", "message": "(CDAP-16353) Refactor KubeTwillPreparer k8s deployment building into its own function\n\nWhat:\nRefactor the k8s deployment object building into a separate function\nwith all external data required passed in via parameters.\n\nWhy:\nAllow us to write a unit test for this function to verify the state of\ndeployment k8s object is as expectd."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fe5a26243411bf75ee4fa38827aeac1ec0be6115", "author": {"user": {"login": "wyzhang", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/fe5a26243411bf75ee4fa38827aeac1ec0be6115", "committedDate": "2020-04-05T06:05:00Z", "message": "(CDAP-16353) Refactor k8s deployment creation in KubeTwillPreparer for easy unit testing\n\nWhat:\nRefactor the k8s deployment object building into a separate function\nwith all external data passed in via parameters (no access to member field)\n\nWhy:\nAllow us to write a unit test for this function to verify the state of\ndeployment k8s object is as expectd."}, "afterCommit": {"oid": "b2c45410be3158c1d51d10bc4622ef215ea9591f", "author": {"user": {"login": "wyzhang", "name": null}}, "url": "https://github.com/cdapio/cdap/commit/b2c45410be3158c1d51d10bc4622ef215ea9591f", "committedDate": "2020-04-06T06:22:04Z", "message": "(CDAP-16353) Refactor KubeTwillPreparer k8s deployment building into its own function\n\nWhat:\nRefactor the k8s deployment object building into a separate function\nwith all external data required passed in via parameters.\n\nWhy:\nAllow us to write a unit test for this function to verify the state of\ndeployment k8s object is as expectd."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2113, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}