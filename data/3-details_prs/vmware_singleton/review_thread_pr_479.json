{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNTgxODQ3", "number": 479, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMTo1MDozMlrODyTmPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMTo1NzoxOVrODyTrIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MDc2NDc4OnYy", "diffSide": "RIGHT", "path": "src/services/core.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMTo1MDozMlrOGGRoRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMTo1MDozMlrOGGRoRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIzMzQ3OQ==", "bodyText": "Logically, translation and pattern data validation should not be nested.", "url": "https://github.com/vmware/singleton/pull/479#discussion_r409233479", "createdAt": "2020-04-16T01:50:32Z", "author": {"login": "wangyi-e"}, "path": "src/services/core.service.ts", "diffHunk": "@@ -184,6 +198,35 @@ export class CoreService {\n             }).catch((err: any) => { this.logger.error('Load translations failed.', err.message); });\n     }\n \n+    public loadTranslationsAndPattern(language: string, region: string): Promise<any> | Promise<any>[] {\n+        const cachePattern = this.cacheManager.lookforPattern(language, region);\n+        if (typeof cachePattern !== 'undefined') {\n+            const cacheTranslation = this.cacheManager.lookforTranslationByComponent(this.config.component, language);\n+            if (typeof cacheTranslation === 'undefined') {\n+                return Promise.resolve({\n+                    components: [cacheTranslation],\n+                    pattern: cachePattern\n+                });\n+            }\n+        }\n+\n+        const url = this.getI18nResourceUrl(language, region);\n+        const promise = this.coreLoader.getI18nResource(url, this.httpOptions);\n+        return promise.then(\n+            (result: any) => {\n+                const translations = this.resParser.getTranslations(result);\n+                if (translations) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7764c94ca6206c3153473878b857133d26be9f"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0MDc3NzI5OnYy", "diffSide": "RIGHT", "path": "src/services/core.service.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMTo1NzoxOVrOGGRvqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQxMjo0MDo1OFrOGHqtZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIzNTM2OQ==", "bodyText": "If this data can be checked in advance to keep loadTranslationsAndPattern clean.\nThe translation and pattern data validation should not be nested.", "url": "https://github.com/vmware/singleton/pull/479#discussion_r409235369", "createdAt": "2020-04-16T01:57:19Z", "author": {"login": "wangyi-e"}, "path": "src/services/core.service.ts", "diffHunk": "@@ -184,6 +198,35 @@ export class CoreService {\n             }).catch((err: any) => { this.logger.error('Load translations failed.', err.message); });\n     }\n \n+    public loadTranslationsAndPattern(language: string, region: string): Promise<any> | Promise<any>[] {\n+        const cachePattern = this.cacheManager.lookforPattern(language, region);\n+        if (typeof cachePattern !== 'undefined') {\n+            const cacheTranslation = this.cacheManager.lookforTranslationByComponent(this.config.component, language);\n+            if (typeof cacheTranslation === 'undefined') {\n+                return Promise.resolve({\n+                    components: [cacheTranslation],\n+                    pattern: cachePattern\n+                });\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7764c94ca6206c3153473878b857133d26be9f"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDY5Mjk2Nw==", "bodyText": "Alreay modifed", "url": "https://github.com/vmware/singleton/pull/479#discussion_r410692967", "createdAt": "2020-04-18T12:40:58Z", "author": {"login": "songjiang320"}, "path": "src/services/core.service.ts", "diffHunk": "@@ -184,6 +198,35 @@ export class CoreService {\n             }).catch((err: any) => { this.logger.error('Load translations failed.', err.message); });\n     }\n \n+    public loadTranslationsAndPattern(language: string, region: string): Promise<any> | Promise<any>[] {\n+        const cachePattern = this.cacheManager.lookforPattern(language, region);\n+        if (typeof cachePattern !== 'undefined') {\n+            const cacheTranslation = this.cacheManager.lookforTranslationByComponent(this.config.component, language);\n+            if (typeof cacheTranslation === 'undefined') {\n+                return Promise.resolve({\n+                    components: [cacheTranslation],\n+                    pattern: cachePattern\n+                });\n+            }\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIzNTM2OQ=="}, "originalCommit": {"oid": "cf7764c94ca6206c3153473878b857133d26be9f"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4558, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}