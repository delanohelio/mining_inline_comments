{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMzIyMzE5", "number": 879, "title": "fix bug #819: [BUG] [Service] [getPattern] Week info(\"firstDayOfWeek\" &\"weekendOfRange\") should also follow CLDR data", "bodyText": "", "createdAt": "2020-11-18T16:49:28Z", "url": "https://github.com/vmware/singleton/pull/879", "merged": true, "mergeCommit": {"oid": "ac480a59b63a2868dce775d5a8c882124c0b93f6"}, "closed": true, "closedAt": "2020-11-30T08:44:51Z", "author": {"login": "huihuiw01"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddqlCBAH2gAyNTIzMzIyMzE5OjE2MTJiYmFhMGU5ZjA0ODkzOGE3ODIyNWE3Y2ZhNTcxYTYwOGRkMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhf12sgFqTU0MDYzOTEwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1612bbaa0e9f048938a78225a7cfa571a608dd06", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/1612bbaa0e9f048938a78225a7cfa571a608dd06", "committedDate": "2020-11-18T09:17:30Z", "message": "Correct firstDayOfWeek's value with cldr data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d65662a48430639184da78f7dddecc0c7b0e264", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/5d65662a48430639184da78f7dddecc0c7b0e264", "committedDate": "2020-11-18T09:51:16Z", "message": "Correct weekendRange's value with cldr data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a591a037126a6937fa31e431f92f7f6e69f31bdb", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/a591a037126a6937fa31e431f92f7f6e69f31bdb", "committedDate": "2020-11-18T10:47:42Z", "message": "Convert day string to index number"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b8868f82745fbc37df36b1d5b87b4f80516b3bf", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/4b8868f82745fbc37df36b1d5b87b4f80516b3bf", "committedDate": "2020-11-18T16:36:33Z", "message": "add logic of supplementing default region for locales without region"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/6ece854420fd1fc210a4b7779edf037f2e2a4b28", "committedDate": "2020-11-19T03:49:35Z", "message": "fix CI failure problem: add header in new added file DayEnum"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MTMwMzI0", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-534130324", "createdAt": "2020-11-19T07:05:51Z", "commit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzowNTo1MVrOH2PTWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzowNTo1MVrOH2PTWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYzNTg2Nw==", "bodyText": "recommend the method name firstDayExtract to getFirstDayExtract", "url": "https://github.com/vmware/singleton/pull/879#discussion_r526635867", "createdAt": "2020-11-19T07:05:51Z", "author": {"login": "tigershi"}, "path": "g11n-ws/tools/tool-cldr-extractor/src/main/java/com/vmware/i18n/utils/CLDRUtils.java", "diffHunk": "@@ -563,6 +572,43 @@ public static String readZip(String fileName, String zipPath) {\n         return erasMap;\n     }\n \n+    /**\n+     * Get the first day of one Country, the implementation is according to https://www.unicode.org/reports/tr35/tr35-49/tr35-dates.html#Week_Data\n+     *\n+     * @param localeStr\n+     * @param firstDayData\n+     * @return\n+     */\n+    private static Integer firstDayExtract(String localeStr, Map<String, String> firstDayData){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MTMwNzQ3", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-534130747", "createdAt": "2020-11-19T07:06:42Z", "commit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzowNjo0MlrOH2PUqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzowNjo0MlrOH2PUqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYzNjIwMQ==", "bodyText": "recommend the method name weekendRangeExtract to getWeekendRangeExtract", "url": "https://github.com/vmware/singleton/pull/879#discussion_r526636201", "createdAt": "2020-11-19T07:06:42Z", "author": {"login": "tigershi"}, "path": "g11n-ws/tools/tool-cldr-extractor/src/main/java/com/vmware/i18n/utils/CLDRUtils.java", "diffHunk": "@@ -563,6 +572,43 @@ public static String readZip(String fileName, String zipPath) {\n         return erasMap;\n     }\n \n+    /**\n+     * Get the first day of one Country, the implementation is according to https://www.unicode.org/reports/tr35/tr35-49/tr35-dates.html#Week_Data\n+     *\n+     * @param localeStr\n+     * @param firstDayData\n+     * @return\n+     */\n+    private static Integer firstDayExtract(String localeStr, Map<String, String> firstDayData){\n+        String firstDay = firstDayData.get(Constants.TERRITORY_001);\n+        String territory = LocaleDataUtils.getInstance().getTerritory(localeStr);\n+        if(territory != null && firstDayData.get(territory) != null)\n+            firstDay = firstDayData.get(territory);\n+        return DayEnum.getIndexByDay(firstDay);\n+    }\n+\n+    /**\n+     * Get the weekend range of one Country, the implementation is according to https://www.unicode.org/reports/tr35/tr35-49/tr35-dates.html#Week_Data\n+     *\n+     * @param localeStr\n+     * @param supplementalWeekData\n+     * @return\n+     */\n+    private static List<Integer> weekendRangeExtract(String localeStr, Map<String, Object> supplementalWeekData){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MTQ0OTY0", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-534144964", "createdAt": "2020-11-19T07:34:26Z", "commit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzozNDoyNlrOH2QBRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNzozNDoyNlrOH2QBRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY0NzYyMg==", "bodyText": "I remember there is an existing method to get the default region of a locale. Could you check?", "url": "https://github.com/vmware/singleton/pull/879#discussion_r526647622", "createdAt": "2020-11-19T07:34:26Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/tools/tool-cldr-extractor/src/main/java/com/vmware/i18n/utils/LocaleDataUtils.java", "diffHunk": "@@ -159,6 +159,38 @@ public String getDefaultRegionCode(String inputLocale, Map<String, String> regio\n \t\treturn defaultRegionMap;\n \t}\n \n+\t/**\n+\t * Get territory of a locale\n+\t *\n+\t * @param localeStr\n+\t * @return\n+\t */\n+\tpublic String getTerritory(String localeStr){\n+\t\tLocale locale = Locale.forLanguageTag(localeStr);\n+\t\tString territory = locale.getCountry();\n+\t\tif(territory == null || territory.isEmpty())//this is for supplement default region for locales like en, zh-Hans..\n+\t\t\tterritory = getLanguageDefaultRegionMappings().get(localeStr);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ece854420fd1fc210a4b7779edf037f2e2a4b28"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "827921de00b07e1baf3fde0ca9e961a4f9a84231", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/827921de00b07e1baf3fde0ca9e961a4f9a84231", "committedDate": "2020-11-19T08:40:05Z", "message": "rename some methods' names according to review comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MTY4MDY2", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-535168066", "createdAt": "2020-11-20T07:23:22Z", "commit": {"oid": "827921de00b07e1baf3fde0ca9e961a4f9a84231"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNzoyMzoyM1rOH3DPBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNzoyMzoyM1rOH3DPBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQ4NjcyNg==", "bodyText": "How about this?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tterritory = getLanguageDefaultRegionMappings().get(localeStr);\n          \n          \n            \n            \t\t\tterritory = JSONUtils.getMapFromJson(PatternUtil.getRegionFromLib(localeStr)).get(ConstantsKeys.DEFAULT_REGION_CODE);", "url": "https://github.com/vmware/singleton/pull/879#discussion_r527486726", "createdAt": "2020-11-20T07:23:23Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/tools/tool-cldr-extractor/src/main/java/com/vmware/i18n/utils/LocaleDataUtils.java", "diffHunk": "@@ -159,6 +159,38 @@ public String getDefaultRegionCode(String inputLocale, Map<String, String> regio\n \t\treturn defaultRegionMap;\n \t}\n \n+\t/**\n+\t * Get territory of a locale\n+\t *\n+\t * @param localeStr\n+\t * @return\n+\t */\n+\tpublic String getTerritory(String localeStr){\n+\t\tLocale locale = Locale.forLanguageTag(localeStr);\n+\t\tString territory = locale.getCountry();\n+\t\tif(territory == null || territory.isEmpty())//this is for supplement default region for locales like en, zh-Hans..\n+\t\t\tterritory = getLanguageDefaultRegionMappings().get(localeStr);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "827921de00b07e1baf3fde0ca9e961a4f9a84231"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MTc3MjQ0", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-536177244", "createdAt": "2020-11-23T04:55:06Z", "commit": {"oid": "827921de00b07e1baf3fde0ca9e961a4f9a84231"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwNDo1NTowNlrOH3_Wuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwNDo1NTowNlrOH3_Wuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ3MTczOQ==", "bodyText": "Why add weekend range. How does this relate to the first day of week?", "url": "https://github.com/vmware/singleton/pull/879#discussion_r528471739", "createdAt": "2020-11-23T04:55:06Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/tools/tool-cldr-extractor/src/main/java/com/vmware/i18n/utils/CLDRUtils.java", "diffHunk": "@@ -184,8 +193,8 @@ public static String readZip(String fileName, String zipPath) {\n         dateMap.put(Constants.MONTH_FORMAT, monthsFormatMap);\n         dateMap.put(Constants.MONTHS_STANDALONE, monthsStandaloneMap);\n         dateMap.put(Constants.ERAS, erasMap);\n-        dateMap.put(Constants.FIRST_DAY_OF_WEEK, 0);\n-        dateMap.put(Constants.WEEKEND_RANGE, Arrays.asList(6, 0));\n+        dateMap.put(Constants.FIRST_DAY_OF_WEEK, firstDayOfWeek);\n+        dateMap.put(Constants.WEEKEND_RANGE, weekendRange);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "827921de00b07e1baf3fde0ca9e961a4f9a84231"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "923d77c9cb6c107660e5c56098fabebad185158c", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/923d77c9cb6c107660e5c56098fabebad185158c", "committedDate": "2020-11-24T04:48:56Z", "message": "fix review comment: use existed method to get region of a locale"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NzQ0NzAw", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-539744700", "createdAt": "2020-11-27T07:01:53Z", "commit": {"oid": "923d77c9cb6c107660e5c56098fabebad185158c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNTU4NDI1", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-540558425", "createdAt": "2020-11-30T02:05:16Z", "commit": {"oid": "923d77c9cb6c107660e5c56098fabebad185158c"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba58739edd00730cbc13d9228afeeca1decd4f00", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/ba58739edd00730cbc13d9228afeeca1decd4f00", "committedDate": "2020-11-30T06:30:27Z", "message": "Merge branch 'master' of github.com:vmware/singleton into master_#819"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a83d1dd0a55febf3e30d2512d1b3413a3fb5e59b", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/a83d1dd0a55febf3e30d2512d1b3413a3fb5e59b", "committedDate": "2020-11-30T06:07:04Z", "message": "Merge branch 'master' of github.com:vmware/singleton into master_#819"}, "afterCommit": {"oid": "ba58739edd00730cbc13d9228afeeca1decd4f00", "author": {"user": {"login": "huihuiw01", "name": null}}, "url": "https://github.com/vmware/singleton/commit/ba58739edd00730cbc13d9228afeeca1decd4f00", "committedDate": "2020-11-30T06:30:27Z", "message": "Merge branch 'master' of github.com:vmware/singleton into master_#819"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNjM4NjAx", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-540638601", "createdAt": "2020-11-30T07:01:32Z", "commit": {"oid": "ba58739edd00730cbc13d9228afeeca1decd4f00"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNjM5MTA3", "url": "https://github.com/vmware/singleton/pull/879#pullrequestreview-540639107", "createdAt": "2020-11-30T07:02:37Z", "commit": {"oid": "ba58739edd00730cbc13d9228afeeca1decd4f00"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4156, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}