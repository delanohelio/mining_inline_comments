{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNTQ1Nzc4", "number": 569, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOToxMjowNFrOD-ILcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwOTo1NToxOVrOD_VLpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NDcyMzA1OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOToxMjowNFrOGYCeXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwMTozMjoxOVrOGYjTXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg1OTU1MA==", "bodyText": "Why delete the cache\uff1f", "url": "https://github.com/vmware/singleton/pull/569#discussion_r427859550", "createdAt": "2020-05-20T09:12:04Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block\n+\t\t\tthrow new L3APIException(\n+\t\t\t\t\t\"MULTCOMPONENT cache occurs error when update translation.\", e);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NDQ4NQ==", "bodyText": "Delete cache content that have updated translation", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428394485", "createdAt": "2020-05-21T01:20:23Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block\n+\t\t\tthrow new L3APIException(\n+\t\t\t\t\t\"MULTCOMPONENT cache occurs error when update translation.\", e);\n+\t\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg1OTU1MA=="}, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NzQwNw==", "bodyText": "This use the deleteCachedObject method,  not delete cache", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428397407", "createdAt": "2020-05-21T01:32:19Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block\n+\t\t\tthrow new L3APIException(\n+\t\t\t\t\t\"MULTCOMPONENT cache occurs error when update translation.\", e);\n+\t\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg1OTU1MA=="}, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2ODYzOTY3OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzoyNTo1MVrOGYo87Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzozMTowOFrOGYpFAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ4OTk2NQ==", "bodyText": "Delete todo", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428489965", "createdAt": "2020-05-21T07:25:51Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ5MjAzNA==", "bodyText": "done", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428492034", "createdAt": "2020-05-21T07:31:08Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ4OTk2NQ=="}, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2ODY0NTc0OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzoyODoyMlrOGYpArQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzozODo1MFrOGYpRKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ5MDkyNQ==", "bodyText": "Does this error return to user?\nIf so, it's wrong because updating has been successful.", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428490925", "createdAt": "2020-05-21T07:28:22Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block\n+\t\t\tthrow new L3APIException(\n+\t\t\t\t\t\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ5NTE0NQ==", "bodyText": "This is just to remind that the cache occurs error", "url": "https://github.com/vmware/singleton/pull/569#discussion_r428495145", "createdAt": "2020-05-21T07:38:50Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey, com.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\t// TODO Auto-generated catch block\n+\t\t\tthrow new L3APIException(\n+\t\t\t\t\t\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ5MDkyNQ=="}, "originalCommit": {"oid": "d83072b1228c42405fab594a705e5343c3f5bbe5"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NjkxMjIwOnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwNzozODowOFrOGZ3nHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwODowODoxOVrOGZ4glQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3ODcxOA==", "bodyText": "not good in the loop.", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429778718", "createdAt": "2020-05-25T07:38:08Z", "author": {"login": "linr211"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -145,9 +146,13 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\tList<ComponentMessagesDTO> componentMessagesDTOList)\n \t\t\tthrows L3APIException {\n \t\tList<TranslationDTO> translationDTOList = new ArrayList<TranslationDTO>();\n+\t\tString productName = null;\n+\t\tString version = null;\n \t\tfor (ComponentMessagesDTO componentMessagesDTO : componentMessagesDTOList) {\n \t\t\ttry {\n \t\t\t\tupdateTranslation(componentMessagesDTO);\n+\t\t\t\tproductName = componentMessagesDTO.getProductName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da8eefa7da0437afaf4abc152d5db6e72ba17cbc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc5MzQyOQ==", "bodyText": "done", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429793429", "createdAt": "2020-05-25T08:08:19Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -145,9 +146,13 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\tList<ComponentMessagesDTO> componentMessagesDTOList)\n \t\t\tthrows L3APIException {\n \t\tList<TranslationDTO> translationDTOList = new ArrayList<TranslationDTO>();\n+\t\tString productName = null;\n+\t\tString version = null;\n \t\tfor (ComponentMessagesDTO componentMessagesDTO : componentMessagesDTOList) {\n \t\t\ttry {\n \t\t\t\tupdateTranslation(componentMessagesDTO);\n+\t\t\t\tproductName = componentMessagesDTO.getProductName();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3ODcxOA=="}, "originalCommit": {"oid": "da8eefa7da0437afaf4abc152d5db6e72ba17cbc"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NjkxNTM4OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwNzozOToxM1rOGZ3pGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwODowODowOFrOGZ4gMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3OTIyNw==", "bodyText": "put them in a private method.", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429779227", "createdAt": "2020-05-25T07:39:13Z", "author": {"login": "linr211"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da8eefa7da0437afaf4abc152d5db6e72ba17cbc"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc5MzMyOA==", "bodyText": "done", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429793328", "createdAt": "2020-05-25T08:08:08Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,6 +171,19 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc3OTIyNw=="}, "originalCommit": {"oid": "da8eefa7da0437afaf4abc152d5db6e72ba17cbc"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzMzNjk1OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwOTo1NDoyN1rOGZ7vXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMDo1NDoyM1rOGaLvTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0NjM2Ng==", "bodyText": "Is it necessary to judge length of componentMessagesDTOList greater than 0?", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429846366", "createdAt": "2020-05-25T09:54:27Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEwODQ5Mw==", "bodyText": "It is not necessary. because have not null validation", "url": "https://github.com/vmware/singleton/pull/569#discussion_r430108493", "createdAt": "2020-05-26T00:54:23Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0NjM2Ng=="}, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzMzOTI1OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwOTo1NToxOVrOGZ7w1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMToxNToxMFrOGaL82w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0Njc0MQ==", "bodyText": "Here should log an error message rather than throwing an exception because translation has been updated successfully.", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429846741", "createdAt": "2020-05-25T09:55:19Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());\n \t\treturn translationDTOList;\n \t}\n+\t\n+\t/**\n+\t * update the MultComponent Cache project when update translations\n+\t * \n+\t * @param productName\n+\t * @param version\n+\t * @throws L3APIException\n+\t */\n+\tprivate void updateMultComponentCache(String productName, String version) throws L3APIException {\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey,\n+\t\t\t\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\tthrow new L3APIException(\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0OTI3OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tthrow new L3APIException(\"MULTCOMPONENT cache occurs error when update translation.\", e);\n          \n          \n            \n            \t\t\tlogger.Error(\"Error occurs when deleting MULTCOMPONENT cache.\");", "url": "https://github.com/vmware/singleton/pull/569#discussion_r429849279", "createdAt": "2020-05-25T10:00:47Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());\n \t\treturn translationDTOList;\n \t}\n+\t\n+\t/**\n+\t * update the MultComponent Cache project when update translations\n+\t * \n+\t * @param productName\n+\t * @param version\n+\t * @throws L3APIException\n+\t */\n+\tprivate void updateMultComponentCache(String productName, String version) throws L3APIException {\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey,\n+\t\t\t\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\tthrow new L3APIException(\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0Njc0MQ=="}, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDExMTI1Mg==", "bodyText": "Here we should throw an exception. Because we have an ExceptionHandle class to Unify handling the level3 error", "url": "https://github.com/vmware/singleton/pull/569#discussion_r430111252", "createdAt": "2020-05-26T01:11:28Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());\n \t\treturn translationDTOList;\n \t}\n+\t\n+\t/**\n+\t * update the MultComponent Cache project when update translations\n+\t * \n+\t * @param productName\n+\t * @param version\n+\t * @throws L3APIException\n+\t */\n+\tprivate void updateMultComponentCache(String productName, String version) throws L3APIException {\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey,\n+\t\t\t\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\tthrow new L3APIException(\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0Njc0MQ=="}, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDExMTk2Mw==", "bodyText": "We should keep this error internally because translation has been updated successfully. If users get this error, they will be confused.", "url": "https://github.com/vmware/singleton/pull/569#discussion_r430111963", "createdAt": "2020-05-26T01:15:10Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-i18n-l3/src/main/java/com/vmware/vip/core/messages/service/product/ProductService.java", "diffHunk": "@@ -166,8 +167,31 @@ private DropVersionDTO getDropVersion(DropVersionDTO versioninfo,JSONObject jo,\n \t\t\t\t\t\t+ componentMessagesDTO.getVersion(), e);\n \t\t\t}\n \t\t}\n+\t\tupdateMultComponentCache(componentMessagesDTOList.get(0).getProductName(), componentMessagesDTOList.get(0).getVersion());\n \t\treturn translationDTOList;\n \t}\n+\t\n+\t/**\n+\t * update the MultComponent Cache project when update translations\n+\t * \n+\t * @param productName\n+\t * @param version\n+\t * @throws L3APIException\n+\t */\n+\tprivate void updateMultComponentCache(String productName, String version) throws L3APIException {\n+\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO multComp = new com.vmware.vip.core.messages.service.multcomponent.TranslationDTO();\n+\t\tmultComp.setProductName(productName);\n+\t\tmultComp.setVersion(version);\n+\t\tmultComp.setLocales(getSupportedLocaleList(productName, version));\n+\t\tmultComp.setComponents(getComponentNameList(productName, version));\n+\t\tString multKey = CachedKeyGetter.getMultiComponentsCachedKey(multComp);\n+\t\ttry {\n+\t\t\tTranslationCache3.deleteCachedObject(CacheName.MULTCOMPONENT, multKey,\n+\t\t\t\t\tcom.vmware.vip.core.messages.service.multcomponent.TranslationDTO.class);\n+\t\t} catch (VIPCacheException e) {\n+\t\t\tthrow new L3APIException(\"MULTCOMPONENT cache occurs error when update translation.\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg0Njc0MQ=="}, "originalCommit": {"oid": "84f0f520a6fee0e89781b5ae144cdecb2228462d"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4614, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}