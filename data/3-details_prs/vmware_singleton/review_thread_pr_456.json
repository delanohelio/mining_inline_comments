{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4OTg5Nzc2", "number": 456, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0NjoxN1rODooObg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMTo0MTo0MlrODpeP6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTI4Njg2OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwODo0NjoxN1rOF3Sm9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNjo0NjoxNFrOF34BxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDg4NQ==", "bodyText": "Don't use RuntimeException, it will cause thread exit.", "url": "https://github.com/vmware/singleton/pull/456#discussion_r393520885", "createdAt": "2020-03-17T08:46:17Z", "author": {"login": "linr211"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,6 +52,12 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n+\t      try {\n+\t    \t  ParameterValidationUtility.validateTranslationWithPatternAPI(data);\n+\t      }catch(RuntimeException excep) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6dce6df105fedb70301f2fb8c65e37d8ed301a75"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDEzMzk1Ng==", "bodyText": "done", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394133956", "createdAt": "2020-03-18T06:46:14Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,6 +52,12 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n+\t      try {\n+\t    \t  ParameterValidationUtility.validateTranslationWithPatternAPI(data);\n+\t      }catch(RuntimeException excep) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUyMDg4NQ=="}, "originalCommit": {"oid": "6dce6df105fedb70301f2fb8c65e37d8ed301a75"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MzQ4ODA4OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwOToyNToxNVrOF38c8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzo0NDozNlrOF4fKXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIwNjQ1MA==", "bodyText": "put the validation in 'validate' function\ndon't need the catch since the function will throw it.", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394206450", "createdAt": "2020-03-18T09:25:15Z", "author": {"login": "linr211"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,6 +53,12 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n+\t      try {\n+\t    \t  ParameterValidationUtility.validateTranslationWithPatternAPI(data);\n+\t      }catch(VIPAPIException excep) {\n+\t    \t  return super.handleResponse(APIResponseStatus.BAD_REQUEST.getCode(),\n+\t    \t\t\t  excep.getMessage(), null);\n+\t      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69ff42f6d8bd930b7f77d00bb51269bc52ac0081"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3NTEzMg==", "bodyText": "2, if don't catch the exception, the default http response code is 520", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394775132", "createdAt": "2020-03-19T03:44:36Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,6 +53,12 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n+\t      try {\n+\t    \t  ParameterValidationUtility.validateTranslationWithPatternAPI(data);\n+\t      }catch(VIPAPIException excep) {\n+\t    \t  return super.handleResponse(APIResponseStatus.BAD_REQUEST.getCode(),\n+\t    \t\t\t  excep.getMessage(), null);\n+\t      }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIwNjQ1MA=="}, "originalCommit": {"oid": "69ff42f6d8bd930b7f77d00bb51269bc52ac0081"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MzQ5MTQyOnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/utils/ParameterValidationUtility.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwOToyNjowNVrOF38fCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMTo1MzowNVrOF4dc4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIwNjk4Ng==", "bodyText": "remove 'private ParameterValidationUtility() {}', it's not required.", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394206986", "createdAt": "2020-03-18T09:26:05Z", "author": {"login": "linr211"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/utils/ParameterValidationUtility.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2019 VMware, Inc.\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package com.vmware.vip.i18n.api.base.utils;\n+\n+\n+import org.apache.commons.lang3.StringUtils;\n+import com.vmware.vip.common.constants.ValidationMsg;\n+import com.vmware.vip.common.exceptions.VIPAPIException;\n+import com.vmware.vip.common.i18n.dto.TranslationWithPatternDTO;\n+import com.vmware.vip.common.utils.RegExpValidatorUtils;\n+\n+public class ParameterValidationUtility{\n+\tprivate ParameterValidationUtility() {}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69ff42f6d8bd930b7f77d00bb51269bc52ac0081"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc0NzEwNg==", "bodyText": "Yes, I agree with you. But the Sonarqube scan it as a issue", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394747106", "createdAt": "2020-03-19T01:53:05Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/utils/ParameterValidationUtility.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2019 VMware, Inc.\n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package com.vmware.vip.i18n.api.base.utils;\n+\n+\n+import org.apache.commons.lang3.StringUtils;\n+import com.vmware.vip.common.constants.ValidationMsg;\n+import com.vmware.vip.common.exceptions.VIPAPIException;\n+import com.vmware.vip.common.i18n.dto.TranslationWithPatternDTO;\n+import com.vmware.vip.common.utils.RegExpValidatorUtils;\n+\n+public class ParameterValidationUtility{\n+\tprivate ParameterValidationUtility() {}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIwNjk4Ng=="}, "originalCommit": {"oid": "69ff42f6d8bd930b7f77d00bb51269bc52ac0081"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0ODA3OTM2OnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-service-authen/src/main/java/com/vmware/vip/core/validation/ParameterValidation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMToyMzo0MFrOF4qOCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjo0NjowNVrOF4szyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk1NjI5OA==", "bodyText": "Is this duplicate validation because there has already called validate in TranslationWithPatternAction.java ?", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394956298", "createdAt": "2020-03-19T11:23:40Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-service-authen/src/main/java/com/vmware/vip/core/validation/ParameterValidation.java", "diffHunk": "@@ -34,6 +33,7 @@ public void validate() throws ValidationException {\n \t\tvalidateComponent(request);\n \t\tvalidateKey(request);\n \t\tvalidateLocale(request);\n+\t\tvalidateLanguage(request);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c881bb76eee0f154f4dff52b1f601fb77c265ddc"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5ODczMQ==", "bodyText": "it only can validate the path variable or query parameter, can't validate the post content", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394998731", "createdAt": "2020-03-19T12:46:05Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-service-authen/src/main/java/com/vmware/vip/core/validation/ParameterValidation.java", "diffHunk": "@@ -34,6 +33,7 @@ public void validate() throws ValidationException {\n \t\tvalidateComponent(request);\n \t\tvalidateKey(request);\n \t\tvalidateLocale(request);\n+\t\tvalidateLanguage(request);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk1NjI5OA=="}, "originalCommit": {"oid": "c881bb76eee0f154f4dff52b1f601fb77c265ddc"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0ODEzODAxOnYy", "diffSide": "RIGHT", "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMTo0MTo0MlrOF4qyDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjo1NDoyNFrOF4tFHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk2NTUxOQ==", "bodyText": "How about change validate throwing VIPAPIException for other conditions to unify the process?", "url": "https://github.com/vmware/singleton/pull/456#discussion_r394965519", "createdAt": "2020-03-19T11:41:42Z", "author": {"login": "Xiaochao8"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,7 +53,14 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n-\t      if (validate(data)) {\n+\t      boolean validateResult;\n+\t      try {\n+\t    \t  validateResult = validate(data);\n+\t      }catch(VIPAPIException excep) {\n+\t    \t  return super.handleResponse(APIResponseStatus.BAD_REQUEST.getCode(),\n+\t    \t\t\t  excep.getMessage(), null);\n+\t      }\n+\t      if (validateResult) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c881bb76eee0f154f4dff52b1f601fb77c265ddc"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAwMzE2Ng==", "bodyText": "I agree with you, But need to change a lot other business code and this API will delete after JS client change to get API", "url": "https://github.com/vmware/singleton/pull/456#discussion_r395003166", "createdAt": "2020-03-19T12:54:24Z", "author": {"login": "tigershi"}, "path": "g11n-ws/modules/md-restful-api-i18n/src/main/java/com/vmware/vip/i18n/api/base/TranslationWithPatternAction.java", "diffHunk": "@@ -51,7 +53,14 @@\n \t    */\n \t   public APIResponseDTO getTransPattern(TranslationWithPatternDTO data) throws Exception {\n \t      logger.info(\"begin getTransPattern\");\n-\t      if (validate(data)) {\n+\t      boolean validateResult;\n+\t      try {\n+\t    \t  validateResult = validate(data);\n+\t      }catch(VIPAPIException excep) {\n+\t    \t  return super.handleResponse(APIResponseStatus.BAD_REQUEST.getCode(),\n+\t    \t\t\t  excep.getMessage(), null);\n+\t      }\n+\t      if (validateResult) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk2NTUxOQ=="}, "originalCommit": {"oid": "c881bb76eee0f154f4dff52b1f601fb77c265ddc"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4550, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}