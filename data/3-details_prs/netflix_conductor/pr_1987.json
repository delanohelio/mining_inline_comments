{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5MDM1NTgy", "number": 1987, "title": "Fix bug in the event polling with Rx Executor scheduler", "bodyText": "Fixes the issue #1806 where the executor scheduler does not poll messages from certain queue types when the thread pool size is less than the number of queues to poll for.\nAs per conversion in #1806 (comment), restoring default behavior and keeping the option to configure the thread pool size for the scheduler.", "createdAt": "2020-11-29T01:55:54Z", "url": "https://github.com/Netflix/conductor/pull/1987", "merged": true, "mergeCommit": {"oid": "bec9c454d6db0411c8be0124e2bb2a80bbec1cd8"}, "closed": true, "closedAt": "2021-06-21T23:14:10Z", "author": {"login": "mdepak"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZW94vgH2gAyNTI5MDM1NTgyOjlmNDFlMjE0NWNiYmY0NzJhM2YyMTNhZDE3ZDUxM2RmMjBkYjA5MmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeeUSHIAH2gAyNTI5MDM1NTgyOmI5ZWJiMDM1ZDJiMGJmM2YyMTZhYzgxYmFmMzg5MDRmOGE3YzEyYTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f41e2145cbbf472a3f213ad17d513df20db092b", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/9f41e2145cbbf472a3f213ad17d513df20db092b", "committedDate": "2020-11-05T00:10:51Z", "message": "Fix bug in the event polling with Rx Executor scheduler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c13cdc9da46084ec32e477005557422144d73141", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/c13cdc9da46084ec32e477005557422144d73141", "committedDate": "2020-11-30T02:40:15Z", "message": "Fix bug in the event polling with Rx Executor scheduler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7c56354eeda8f128601cf6cceb90ee01bcc204a", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/d7c56354eeda8f128601cf6cceb90ee01bcc204a", "committedDate": "2020-11-30T03:42:13Z", "message": "Merge remote-tracking branch 'origin/event-poll-scheduler-fix' into event-poll-scheduler-fix\n\n# Conflicts:\n#\tcore/src/main/java/com/netflix/conductor/core/config/Configuration.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7eb149f0317a36cc2260754009405fc751625d8b", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/7eb149f0317a36cc2260754009405fc751625d8b", "committedDate": "2020-11-30T03:43:30Z", "message": "Fix unit test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxNDA4Mjg0", "url": "https://github.com/Netflix/conductor/pull/1987#pullrequestreview-541408284", "createdAt": "2020-12-01T00:49:16Z", "commit": {"oid": "7eb149f0317a36cc2260754009405fc751625d8b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDo0OToxNlrOH8Tu3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDo0OToxNlrOH8Tu3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjk5OTkwMQ==", "bodyText": "@mdepak Based on the documentation here, http://reactivex.io/RxJava/javadoc/rx/schedulers/Schedulers.html#computation--\n\nDo not perform IO-bound work on this scheduler. Use io() instead.\n\nand the fact that IO needs to be performed as seen here\nDoes it make sense to use io() instead here?", "url": "https://github.com/Netflix/conductor/pull/1987#discussion_r532999901", "createdAt": "2020-12-01T00:49:16Z", "author": {"login": "aravindanr"}, "path": "core/src/main/java/com/netflix/conductor/core/events/queue/EventPollSchedulerProvider.java", "diffHunk": "@@ -37,11 +37,14 @@ public EventPollSchedulerProvider(Configuration configuration) {\n \n     @Override\n     public Scheduler get() {\n-        ThreadFactory threadFactory = new ThreadFactoryBuilder()\n-                .setNameFormat(\"event-queue-poll-scheduler-thread-%d\")\n-                .build();\n-        Executor executorService = Executors.newFixedThreadPool(configuration.getEventSchedulerPollThreadCount(), threadFactory);\n-\n-        return Schedulers.from(executorService);\n+        if (configuration.getEventSchedulerPollThreadCount() != null) {\n+            ThreadFactory threadFactory = new ThreadFactoryBuilder()\n+                    .setNameFormat(\"event-queue-poll-scheduler-thread-%d\")\n+                    .build();\n+            Executor executorService = Executors.newFixedThreadPool(configuration.getEventSchedulerPollThreadCount(), threadFactory);\n+            return Schedulers.from(executorService);\n+        } else {\n+            return Schedulers.computation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7eb149f0317a36cc2260754009405fc751625d8b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86827ef56072abc8a07ca5183b8119e43e53a5a0", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/86827ef56072abc8a07ca5183b8119e43e53a5a0", "committedDate": "2021-05-25T01:29:56Z", "message": "Merge remote-tracking branch 'upstream/2.31' into event-poll-scheduler-fix\n\n# Conflicts:\n#\tcore/src/main/java/com/netflix/conductor/core/config/Configuration.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "deb5ff9e1ee3fff68da2d1369b3a4c069d3eecb6", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/deb5ff9e1ee3fff68da2d1369b3a4c069d3eecb6", "committedDate": "2021-05-25T01:32:58Z", "message": "Merge remote-tracking branch 'upstream/2.31' into event-poll-scheduler-fix\n\n# Conflicts:\n#\tcore/src/main/java/com/netflix/conductor/core/config/Configuration.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "798839964c022d973b9a7ad09f86d3bb842afcba", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/798839964c022d973b9a7ad09f86d3bb842afcba", "committedDate": "2021-06-07T06:03:49Z", "message": "Fix compilation error in unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9ebb035d2b0bf3f216ac81baf38904f8a7c12a3", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/b9ebb035d2b0bf3f216ac81baf38904f8a7c12a3", "committedDate": "2021-06-07T06:04:00Z", "message": "Merge branch 'event-poll-scheduler-fix' of https://github.com/mdepak/conductor into event-poll-scheduler-fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 734, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}