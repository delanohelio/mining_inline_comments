{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4ODIxMzQ2", "number": 1626, "title": "ElasticSearch Rest  BulkIndex NPE fix for Race condition", "bodyText": "As per #1553, there is a race condition in BulkRequestBuilder class of ElasticSearch which is used in ElasticSearchDAO transport client. In our setup, this NullPointerException happens in case of ElasticSearchRestDAO as well. ElasticSearchRestDAO uses BulkRequest object which in turn uses ArrayList to maintain the index requests is not synchronized. Hence this problem occurs in Rest implementation as well. So using an approach similar to #1554 to use thread-safe wrapper for Rest implementation as well. Verified that in high throughput scenario the NullPointerExceptions are happening no more. Thanks, @skissane for the initial solution.", "createdAt": "2020-04-04T23:50:46Z", "url": "https://github.com/Netflix/conductor/pull/1626", "merged": true, "mergeCommit": {"oid": "8102a1419412019c3fd35c71149c1ba09df6af75"}, "closed": true, "closedAt": "2020-04-27T23:50:07Z", "author": {"login": "mdepak"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUOUoBAH2gAyMzk4ODIxMzQ2OmU5NjczNjA1ZTdkYzNiNzUzMGQ1MzQyODY0NzYxMzQ0NGVlMjFiMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcb4MLCgFqTQwMTQwNDc2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e9673605e7dc3b7530d53428647613444ee21b16", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/e9673605e7dc3b7530d53428647613444ee21b16", "committedDate": "2020-04-04T05:05:46Z", "message": "Use thread-safe wrapper for BulkRequest in ElasticSearchRestDAO"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84f75079f2b5288f123e6d3060ebfc09ce284c62", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/84f75079f2b5288f123e6d3060ebfc09ce284c62", "committedDate": "2020-04-04T23:28:48Z", "message": "Use thread-safe wrapper for ElasticSearchRestDAOV6 bulk request"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMjM5Mjgx", "url": "https://github.com/Netflix/conductor/pull/1626#pullrequestreview-393239281", "createdAt": "2020-04-14T19:41:58Z", "commit": {"oid": "84f75079f2b5288f123e6d3060ebfc09ce284c62"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxOTo0MTo1OFrOGFeGtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxOTo0MjoxM1rOGFeHQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM4OTMwMg==", "bodyText": "Please add a license header.", "url": "https://github.com/Netflix/conductor/pull/1626#discussion_r408389302", "createdAt": "2020-04-14T19:41:58Z", "author": {"login": "apanicker-nflx"}, "path": "es5-persistence/src/main/java/com/netflix/conductor/dao/es5/index/BulkRequestWrapper.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package com.netflix.conductor.dao.es5.index;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f75079f2b5288f123e6d3060ebfc09ce284c62"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM4OTQ0Mw==", "bodyText": "Please add a license header.", "url": "https://github.com/Netflix/conductor/pull/1626#discussion_r408389443", "createdAt": "2020-04-14T19:42:13Z", "author": {"login": "apanicker-nflx"}, "path": "es6-persistence/src/main/java/com/netflix/conductor/dao/es6/index/BulkRequestWrapper.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package com.netflix.conductor.dao.es6.index;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f75079f2b5288f123e6d3060ebfc09ce284c62"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a52165db15a2b65bf76f2a2f65de232abd52fa5d", "author": {"user": {"login": "mdepak", "name": "Deepak Mahudeswaran"}}, "url": "https://github.com/Netflix/conductor/commit/a52165db15a2b65bf76f2a2f65de232abd52fa5d", "committedDate": "2020-04-17T04:35:47Z", "message": "Add license header"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNDA0NzY5", "url": "https://github.com/Netflix/conductor/pull/1626#pullrequestreview-401404769", "createdAt": "2020-04-27T23:50:01Z", "commit": {"oid": "a52165db15a2b65bf76f2a2f65de232abd52fa5d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 752, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}