{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0OTE2Nzc0", "number": 860, "title": "issue #858 - added logic to set summary=count when size=0", "bodyText": "Signed-off-by: Lee Surprenant lmsurpre@us.ibm.com", "createdAt": "2020-03-27T18:48:28Z", "url": "https://github.com/IBM/FHIR/pull/860", "merged": true, "mergeCommit": {"oid": "6f8045ff80a91d420930e774148f0777bb0fe948"}, "closed": true, "closedAt": "2020-03-27T20:27:53Z", "author": {"login": "lmsurpre"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcR1PTsgH2gAyMzk0OTE2Nzc0OmMyZmU2OTkxNWY1MmJhODFmYTIwOWFjOGRjZDk1ZDRmYWNhNjU2MWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcR2YPqgFqTM4MzE2NTI5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e", "author": {"user": {"login": "lmsurpre", "name": "Lee Surprenant"}}, "url": "https://github.com/IBM/FHIR/commit/c2fe69915f52ba81fa209ac8dcd95d4faca6561e", "committedDate": "2020-03-27T18:44:29Z", "message": "issue #858 - added logic to set summary=count when size=0\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTI5MDE4", "url": "https://github.com/IBM/FHIR/pull/860#pullrequestreview-383129018", "createdAt": "2020-03-27T19:04:31Z", "commit": {"oid": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTowNDozMVrOF8-ZDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTowNDozMVrOF8-ZDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MTEwMw==", "bodyText": "leaving one comment - makes sense to me - do we want a test for it?", "url": "https://github.com/IBM/FHIR/pull/860#discussion_r399481103", "createdAt": "2020-03-27T19:04:31Z", "author": {"login": "prb112"}, "path": "fhir-search/src/main/java/com/ibm/fhir/search/util/SearchUtil.java", "diffHunk": "@@ -1074,11 +1074,19 @@ private static void parseSearchResultParameter(Class<?> resourceType, FHIRSearch\n             if (SearchConstants.COUNT.equals(name)) {\n                 int pageSize = Integer.parseInt(first);\n \n-                // If the user specified a value > max, then use the max.\n-                if (pageSize > SearchConstants.MAX_PAGE_SIZE) {\n-                    pageSize = SearchConstants.MAX_PAGE_SIZE;\n+                if (pageSize < 0) {\n+                    throw new IllegalArgumentException(\"pageSize must be greater than or equal to zero\");\n+                } else if (pageSize == 0) {\n+                    // if _count has the value 0, this shall be treated the same as _summary=count\n+                    // https://www.hl7.org/fhir/r4/search.html#count\n+                    context.setSummaryParameter(SummaryValueSet.COUNT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e"}, "originalPosition": 152}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTI5MTI0", "url": "https://github.com/IBM/FHIR/pull/860#pullrequestreview-383129124", "createdAt": "2020-03-27T19:04:40Z", "commit": {"oid": "c2fe69915f52ba81fa209ac8dcd95d4faca6561e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed9cf3ec7be131bba33635a56c8f2d649e6dcce6", "author": {"user": {"login": "lmsurpre", "name": "Lee Surprenant"}}, "url": "https://github.com/IBM/FHIR/commit/ed9cf3ec7be131bba33635a56c8f2d649e6dcce6", "committedDate": "2020-03-27T19:26:08Z", "message": "issue #851 - add delete to the pre-packed openapi\n\nwe already had a flag for this, i just made it true by default\n\ni also updated the definition to say it returns HTTP 204 (No Content) on\nsuccess (vs 200 OK)\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da4a849969c2c3ffa760552556e210d0656a5028", "author": {"user": {"login": "lmsurpre", "name": "Lee Surprenant"}}, "url": "https://github.com/IBM/FHIR/commit/da4a849969c2c3ffa760552556e210d0656a5028", "committedDate": "2020-03-27T19:46:18Z", "message": "Merge pull request #861 from IBM/issue-851\n\nissue #851 - add delete to the pre-packed openapi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "861619ac643826d7820ebb44ca737c353be5d709", "author": {"user": {"login": "lmsurpre", "name": "Lee Surprenant"}}, "url": "https://github.com/IBM/FHIR/commit/861619ac643826d7820ebb44ca737c353be5d709", "committedDate": "2020-03-27T19:59:32Z", "message": "issue #858 - added summary=count and count=0 e2e tests\n\nAdded them in SearchTest which is where the other Summary tests were\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTY1Mjk4", "url": "https://github.com/IBM/FHIR/pull/860#pullrequestreview-383165298", "createdAt": "2020-03-27T20:04:09Z", "commit": {"oid": "861619ac643826d7820ebb44ca737c353be5d709"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 551, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}