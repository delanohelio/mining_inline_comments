{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5Mzc2Mjgw", "number": 1389, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNDowM1rOEULysA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNjowM1rOEUL1CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjAwMTc2OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNDowM1rOG6VObw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNDowM1rOG6VObw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxODM1MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // An important step here is to add _id, values table bind variables, and then and _lastUpdated\n          \n          \n            \n                        // An important step here is to add _id, values table bind variables, and then _lastUpdated", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463818351", "createdAt": "2020-07-31T20:24:03Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -196,15 +196,16 @@ protected SqlQueryData buildQuery() throws Exception {\n             queryString.append(\"     R.LOGICAL_RESOURCE_ID = LR.LOGICAL_RESOURCE_ID \");\n             queryString.append(\" AND R.RESOURCE_ID = LR.CURRENT_RESOURCE_ID \");\n             queryString.append(\" AND R.IS_DELETED <> 'Y'\");\n-            \n \n-            // Bind Variables\n+\n+            // An important step here is to add _id, values table bind variables, and then and _lastUpdated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjAwMjc1OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNDoyN1rOG6VPBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNDoyN1rOG6VPBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxODUwMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // An important step here is to add _id, values table bind variables, and then and _lastUpdated\n          \n          \n            \n                        // An important step here is to add _id, values table bind variables, and then _lastUpdated", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463818503", "createdAt": "2020-07-31T20:24:27Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -267,13 +268,14 @@ protected SqlQueryData buildCountQuery() throws Exception {\n             buildFromClause(queryString, simpleName);\n             buildWhereClause(queryString, null);\n \n-            // An important step here is to add _id then all other values. \n+            // An important step here is to add _id, values table bind variables, and then and _lastUpdated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjAwNTg1OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNToyM1rOG6VQsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwMDowNjo1MVrOG6ZwYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxODkzMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            // An important step here is to add _id, values table bind variables, and then and _lastUpdated\n          \n          \n            \n                            // An important step here is to add _id, values table bind variables, and then _lastUpdated", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463818930", "createdAt": "2020-07-31T20:25:23Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -358,20 +359,19 @@ protected SqlQueryData buildSystemLevelQuery(String selectRoot, String subSelect\n                 queryString.append(JOIN);\n                 processFromClauseForLastUpdated(queryString, resourceTypeName);\n                 queryString.append(\" AS R \");\n-                                \n-                // An important step here is to add _id and _lastUpdated\n-                allBindVariables.addAll(idsObjects);\n-                allBindVariables.addAll(lastUpdatedObjects);\n \n                 queryString.append(ON);\n                 queryString.append(\"     R.LOGICAL_RESOURCE_ID = LR.LOGICAL_RESOURCE_ID \");\n                 queryString.append(\" AND R.RESOURCE_ID = LR.CURRENT_RESOURCE_ID \");\n                 queryString.append(\" AND R.IS_DELETED <> 'Y'\");\n-                \n+\n+                // An important step here is to add _id, values table bind variables, and then and _lastUpdated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 181}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5MjU3OA==", "bodyText": "Fixed", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463892578", "createdAt": "2020-08-01T00:06:51Z", "author": {"login": "prb112"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -358,20 +359,19 @@ protected SqlQueryData buildSystemLevelQuery(String selectRoot, String subSelect\n                 queryString.append(JOIN);\n                 processFromClauseForLastUpdated(queryString, resourceTypeName);\n                 queryString.append(\" AS R \");\n-                                \n-                // An important step here is to add _id and _lastUpdated\n-                allBindVariables.addAll(idsObjects);\n-                allBindVariables.addAll(lastUpdatedObjects);\n \n                 queryString.append(ON);\n                 queryString.append(\"     R.LOGICAL_RESOURCE_ID = LR.LOGICAL_RESOURCE_ID \");\n                 queryString.append(\" AND R.RESOURCE_ID = LR.CURRENT_RESOURCE_ID \");\n                 queryString.append(\" AND R.IS_DELETED <> 'Y'\");\n-                \n+\n+                // An important step here is to add _id, values table bind variables, and then and _lastUpdated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxODkzMA=="}, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 181}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjAwNzc3OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDoyNjowM1rOG6VR0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMDozODoxMlrOG6Vlog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxOTIxNw==", "bodyText": "did you mean to take this back out?  if not, it should be a log statement, not sysout", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463819217", "createdAt": "2020-07-31T20:26:03Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -604,7 +606,10 @@ protected void buildWhereClause(StringBuilder whereClause, String overrideType)\n                         .append(\".LOGICAL_RESOURCE_ID = R.LOGICAL_RESOURCE_ID\");\n                     }\n                 }\n-            } // end if SKIP_WHERE\n+            } else {\n+                // end if SKIP_WHERE\n+                System.out.println(whereClause);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 333}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgyNDI5MA==", "bodyText": "Yes, I meant to remove.  Fixed in next commit.", "url": "https://github.com/IBM/FHIR/pull/1389#discussion_r463824290", "createdAt": "2020-07-31T20:38:12Z", "author": {"login": "prb112"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/QuerySegmentAggregator.java", "diffHunk": "@@ -604,7 +606,10 @@ protected void buildWhereClause(StringBuilder whereClause, String overrideType)\n                         .append(\".LOGICAL_RESOURCE_ID = R.LOGICAL_RESOURCE_ID\");\n                     }\n                 }\n-            } // end if SKIP_WHERE\n+            } else {\n+                // end if SKIP_WHERE\n+                System.out.println(whereClause);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgxOTIxNw=="}, "originalCommit": {"oid": "0d2ec598d930039484b17f77bed126c7c17508c5"}, "originalPosition": 333}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4782, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}