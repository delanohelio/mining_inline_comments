{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MzU4NjM0", "number": 1070, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1ODo1NVrOD7azhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMzozMTowMVrOD7cEpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNjMxNzQ4OnYy", "diffSide": "RIGHT", "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1ODo1NVrOGTu4mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1ODo1NVrOGTu4mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDI4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // Make the call, but\n          \n          \n            \n                    // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n          \n          \n            \n                    // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n          \n          \n            \n                    // If enforced=false, skip the constraint because PostgreSQL doesn't support unenforced constraints", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423344282", "createdAt": "2020-05-11T21:58:55Z", "author": {"login": "lmsurpre"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -250,7 +250,9 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n         // Make the call, but\n         // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n         // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2da09cd47aef7aa76ecd4f6d54da127f5751da0a"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNjMxODc2OnYy", "diffSide": "RIGHT", "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1OTozNFrOGTu5fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo1OTozNFrOGTu5fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDUxMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n          \n          \n            \n                        // Make the call, but without the tenantColumnName because PostgreSQL doesn't support our multi-tenant implementation\n          \n          \n            \n                        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423344511", "createdAt": "2020-05-11T21:59:34Z", "author": {"login": "lmsurpre"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -250,7 +250,9 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n         // Make the call, but\n         // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n         // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n-        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n+        if (enforced) {\n+            super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2da09cd47aef7aa76ecd4f6d54da127f5751da0a"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNjMxOTgzOnYy", "diffSide": "RIGHT", "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMjowMDowMlrOGTu6Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMjoxNTozOVrOGTvTNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDY4Mw==", "bodyText": "somewhat minor/unrelated, but can we make this same change on the Derby side for consistency?", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423344683", "createdAt": "2020-05-11T22:00:02Z", "author": {"login": "lmsurpre"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -250,7 +250,9 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n         // Make the call, but\n         // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n         // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n-        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n+        if (enforced) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2da09cd47aef7aa76ecd4f6d54da127f5751da0a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NzM4Ng==", "bodyText": "Ok, will change", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423347386", "createdAt": "2020-05-11T22:06:27Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -250,7 +250,9 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n         // Make the call, but\n         // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n         // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n-        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n+        if (enforced) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDY4Mw=="}, "originalCommit": {"oid": "2da09cd47aef7aa76ecd4f6d54da127f5751da0a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM1MTA5Mg==", "bodyText": "done", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423351092", "createdAt": "2020-05-11T22:15:39Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -250,7 +250,9 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n         // Make the call, but\n         // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n         // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n-        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n+        if (enforced) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NDY4Mw=="}, "originalCommit": {"oid": "2da09cd47aef7aa76ecd4f6d54da127f5751da0a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNjUyNTE5OnYy", "diffSide": "RIGHT", "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMzozMTowMVrOGTw6NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMzozMTowMVrOGTw6NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM3NzQ2MQ==", "bodyText": "good comment.", "url": "https://github.com/IBM/FHIR/pull/1070#discussion_r423377461", "createdAt": "2020-05-11T23:31:01Z", "author": {"login": "prb112"}, "path": "fhir-database-utils/src/main/java/com/ibm/fhir/database/utils/postgresql/PostgreSqlAdapter.java", "diffHunk": "@@ -247,10 +247,11 @@ public void createForeignKeyConstraint(String constraintName, String schemaName,\n             String targetSchema, String targetTable, String tenantColumnName,\n             List<String> columns, boolean enforced) {\n \n-        // Make the call, but\n-        // 1. without the tenantColumnName because PostgreSql doesn't support our multi-tenant implementation; and\n-        // 2. with enforced=true because PostgreSql doesn't support non-default constraint characteristics\n-        super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);\n+        // If enforced=false, skip the constraint because PostgreSQL doesn't support unenforced constraints\n+        if (enforced) {\n+            // Make the call, but without the tenantColumnName because PostgreSQL doesn't support our multi-tenant implementation\n+            super.createForeignKeyConstraint(constraintName, schemaName, name, targetSchema, targetTable, null, columns, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a6ba33e3ec28dab1af9bbbfd8810a5b2a670e1e"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 69, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}