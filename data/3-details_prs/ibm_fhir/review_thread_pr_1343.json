{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NTkxODYw", "number": 1343, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1MDo1OFrOEQr-aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1Mjo1MVrOEQsBvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1OTMzMTYwOnYy", "diffSide": "RIGHT", "path": "fhir-persistence-schema/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1MDo1OFrOG0-jhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1MDo1OFrOG0-jhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODIwNDAzOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Alternative: Setting upIBM FHIR Servers against a shared DB2 with separate schemas for each customer\n          \n          \n            \n            ## Alternative: Setting up a shared Db2 with separate schemas for each tenant", "url": "https://github.com/IBM/FHIR/pull/1343#discussion_r458204039", "createdAt": "2020-07-21T15:50:58Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -214,7 +214,55 @@ For postgresql:\n --db-type postgresql\n ```\n \n-## Alternative: manually apply the schema\n+## Alternative: Setting upIBM FHIR Servers against a shared DB2 with separate schemas for each customer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "118a5aa64cbe2bc7fc81364960508372d5bd9777"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1OTM0MDE1OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-schema/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1Mjo1MlrOG0-o4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxNTo1Mjo1MlrOG0-o4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODIwNTQwOA==", "bodyText": "We already have a section on printing the schema near the top (under getting started).  This section should specifically focus on how to apply that manually.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Alternative: Print the Schema\n          \n          \n            \n            ## Alternative: Manually apply the schema", "url": "https://github.com/IBM/FHIR/pull/1343#discussion_r458205408", "createdAt": "2020-07-21T15:52:52Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -214,7 +214,55 @@ For postgresql:\n --db-type postgresql\n ```\n \n-## Alternative: manually apply the schema\n+## Alternative: Setting upIBM FHIR Servers against a shared DB2 with separate schemas for each customer\n+\n+For those using multiple schemas for each customer, for instance, customer 2 needs to be separately configured with the database and schema. \n+\n+### Create the additional schema\n+\n+```\n+java -jar ./fhir-persistence-schema-${VERSION}-cli.jar \\ \n+--prop-file db2.properties\n+--create-schemas\n+--create-schema-batch FHIR_JBATCH_2ND\n+--create-schema-oauth FHIR_OUATH_2ND\n+--create-schema-fhir FHIRDATA_2ND\n+```\n+\n+### Deploy the additional schema\n+\n+```\n+java -jar ./fhir-persistence-schema-${VERSION}-cli.jar \\ \n+--prop-file db2.properties\n+--schema-name FHIRDATA\n+--update-schema-batch FHIR_JBATCH_2ND\n+--update-schema-oauth FHIR_OUATH_2ND\n+--update-schema-fhir FHIRDATA_2ND\n+```\n+\n+### Grant privileges to data access user\n+```\n+java -jar ./fhir-persistence-schema-${VERSION}-cli.jar \\ \n+--prop-file db2.properties\n+--grant-to FHIRSERVER\n+--target BATCH FHIR_JBATCH_2ND\n+```\n+\n+```\n+java -jar ./fhir-persistence-schema-${VERSION}-cli.jar \\ \n+--prop-file db2.properties\n+--grant-to FHIRSERVER\n+--target OAUTH FHIR_OAUTH_2ND\n+```\n+\n+```\n+java -jar ./fhir-persistence-schema-${VERSION}-cli.jar \\ \n+--prop-file db2.properties\n+--grant-to FHIRSERVER\n+--target DATA FHIRDATA_2ND\n+```\n+\n+## Alternative: Print the Schema", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "118a5aa64cbe2bc7fc81364960508372d5bd9777"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4766, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}