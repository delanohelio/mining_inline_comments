{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNTEzMjAx", "number": 904, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1MjoxM1rODvyGXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo0MDoyNlrODwEyKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNDMwNDk0OnYy", "diffSide": "LEFT", "path": "build/.gitignore", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1MjoxM1rOGCaNLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMTo0NDo1NVrOGCcGzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3OTY5Mw==", "bodyText": "logs was added for release.sh - please add back", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405179693", "createdAt": "2020-04-07T23:52:13Z", "author": {"login": "prb112"}, "path": "build/.gitignore", "diffHunk": "@@ -1 +1,6 @@\n-logs/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMDgzMA==", "bodyText": "done", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405210830", "createdAt": "2020-04-08T01:44:55Z", "author": {"login": "lmsurpre"}, "path": "build/.gitignore", "diffHunk": "@@ -1 +1,6 @@\n-logs/", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3OTY5Mw=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNDMwNzcxOnYy", "diffSide": "RIGHT", "path": "build/db2-migration-test-docker.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1Mzo0NlrOGCaO8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMTo0ODowMlrOGCcKEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDE0Nw==", "bodyText": "I think what I built for persistence-automation for postgres, could play well here, and we should probably reconcile early as I think you have a pattern that I've just generalized.", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405180147", "createdAt": "2020-04-07T23:53:46Z", "author": {"login": "prb112"}, "path": "build/db2-migration-test-docker.sh", "diffHunk": "@@ -7,13 +7,13 @@\n set -ex\n \n echo \"Preparing environment for fhir-server integration tests...\"\n-if [[ -z \"${WORKSPACE}\" ]]; then\n-    echo \"ERROR: WORKSPACE environment variable not set!\"\n-    exit 2\n-fi\n+\n+# The full path to the directory of this script, no matter where its called from", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMTY2NQ==", "bodyText": "I find that having this run the same no matter where its invoked from simplifies the script, so I settled on this pattern based on https://stackoverflow.com/a/246128/161022\nPreviously, these scripts required us to set a WORKSPACE env variable, but this got me very confused when I cloned a second copy of our repo and tried running the scripts and couldn't understand why it wasn't using the right stuff.  Better to have it know its in a build dir under the project root and always execute relative to that.", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405211665", "createdAt": "2020-04-08T01:48:02Z", "author": {"login": "lmsurpre"}, "path": "build/db2-migration-test-docker.sh", "diffHunk": "@@ -7,13 +7,13 @@\n set -ex\n \n echo \"Preparing environment for fhir-server integration tests...\"\n-if [[ -z \"${WORKSPACE}\" ]]; then\n-    echo \"ERROR: WORKSPACE environment variable not set!\"\n-    exit 2\n-fi\n+\n+# The full path to the directory of this script, no matter where its called from", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDE0Nw=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNDMxMDY0OnYy", "diffSide": "RIGHT", "path": "build/docker/db2/Dockerfile", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1NTowMVrOGCaQtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNzo0ODo1MFrOGC6Plg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDU5OQ==", "bodyText": "There has to be at least one link / reference to this file in an md", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405180599", "createdAt": "2020-04-07T23:55:01Z", "author": {"login": "prb112"}, "path": "build/docker/db2/Dockerfile", "diffHunk": "@@ -6,8 +6,7 @@\n \n FROM ibmcom/db2\n \n-# Create a non-admin user for the FHIR server\n-# This non-admin user will be used by fhir server to access db2\n+# Create a non-admin user for the FHIR server to use to access db2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMTkyOA==", "bodyText": "Not sure I follow this comment...", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405211928", "createdAt": "2020-04-08T01:48:55Z", "author": {"login": "lmsurpre"}, "path": "build/docker/db2/Dockerfile", "diffHunk": "@@ -6,8 +6,7 @@\n \n FROM ibmcom/db2\n \n-# Create a non-admin user for the FHIR server\n-# This non-admin user will be used by fhir server to access db2\n+# Create a non-admin user for the FHIR server to use to access db2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDU5OQ=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2MDI3NQ==", "bodyText": "sorry - I did a quick search in the docs, and we should probably make sure (since we move this file) that there are no documents that need updating", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405660275", "createdAt": "2020-04-08T16:37:05Z", "author": {"login": "prb112"}, "path": "build/docker/db2/Dockerfile", "diffHunk": "@@ -6,8 +6,7 @@\n \n FROM ibmcom/db2\n \n-# Create a non-admin user for the FHIR server\n-# This non-admin user will be used by fhir server to access db2\n+# Create a non-admin user for the FHIR server to use to access db2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDU5OQ=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2NDQyNA==", "bodyText": "good call.  i just found one:\nfhir-install/README-DB2.md:docker build -t fhirserverdb2 . -f Dockerfile-db2 --squash\n\nwill fix", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405664424", "createdAt": "2020-04-08T16:43:36Z", "author": {"login": "lmsurpre"}, "path": "build/docker/db2/Dockerfile", "diffHunk": "@@ -6,8 +6,7 @@\n \n FROM ibmcom/db2\n \n-# Create a non-admin user for the FHIR server\n-# This non-admin user will be used by fhir server to access db2\n+# Create a non-admin user for the FHIR server to use to access db2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDU5OQ=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcwNDU5OA==", "bodyText": "ok, i basically ended up re-writing this readme and moved it to the build dir", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405704598", "createdAt": "2020-04-08T17:48:50Z", "author": {"login": "lmsurpre"}, "path": "build/docker/db2/Dockerfile", "diffHunk": "@@ -6,8 +6,7 @@\n \n FROM ibmcom/db2\n \n-# Create a non-admin user for the FHIR server\n-# This non-admin user will be used by fhir server to access db2\n+# Create a non-admin user for the FHIR server to use to access db2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE4MDU5OQ=="}, "originalCommit": {"oid": "b92d3ceb96144a52fa8471e454b639c3d2e54f62"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNzM0Nzk3OnYy", "diffSide": "RIGHT", "path": "build/docker/copy-schema-jar.sh", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjozNTo0NlrOGC3fNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo0MjoxM1rOGC3vTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1OTQ0Nw==", "bodyText": "interesting.. this is considered a reserved exit code\nhttp://www.tldp.org/LDP/abs/html/exitcodes.html\njust something to think about next time we're in the code", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405659447", "createdAt": "2020-04-08T16:35:46Z", "author": {"login": "prb112"}, "path": "build/docker/copy-schema-jar.sh", "diffHunk": "@@ -0,0 +1,22 @@\n+#!/usr/bin/env bash\n+###############################################################################\n+# (C) Copyright IBM Corp. 2016, 2020\n+#\n+# SPDX-License-Identifier: Apache-2.0\n+###############################################################################\n+set -e\n+\n+if [[ -z \"${WORKSPACE}\" ]]; then\n+    echo \"ERROR: WORKSPACE environment variable not set!\"\n+    exit 2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a62c3bede27f4e373da124462b78ea9d46036cfc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2MDU2Mg==", "bodyText": "i was wondering why it exits with a code of 2!\nlets just change to 1 and be done?", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405660562", "createdAt": "2020-04-08T16:37:34Z", "author": {"login": "lmsurpre"}, "path": "build/docker/copy-schema-jar.sh", "diffHunk": "@@ -0,0 +1,22 @@\n+#!/usr/bin/env bash\n+###############################################################################\n+# (C) Copyright IBM Corp. 2016, 2020\n+#\n+# SPDX-License-Identifier: Apache-2.0\n+###############################################################################\n+set -e\n+\n+if [[ -z \"${WORKSPACE}\" ]]; then\n+    echo \"ERROR: WORKSPACE environment variable not set!\"\n+    exit 2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1OTQ0Nw=="}, "originalCommit": {"oid": "a62c3bede27f4e373da124462b78ea9d46036cfc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2MzU2Nw==", "bodyText": "done", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405663567", "createdAt": "2020-04-08T16:42:13Z", "author": {"login": "lmsurpre"}, "path": "build/docker/copy-schema-jar.sh", "diffHunk": "@@ -0,0 +1,22 @@\n+#!/usr/bin/env bash\n+###############################################################################\n+# (C) Copyright IBM Corp. 2016, 2020\n+#\n+# SPDX-License-Identifier: Apache-2.0\n+###############################################################################\n+set -e\n+\n+if [[ -z \"${WORKSPACE}\" ]]; then\n+    echo \"ERROR: WORKSPACE environment variable not set!\"\n+    exit 2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY1OTQ0Nw=="}, "originalCommit": {"oid": "a62c3bede27f4e373da124462b78ea9d46036cfc"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNzM2NjE3OnYy", "diffSide": "RIGHT", "path": "build/gen-code.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo0MDoyNlrOGC3qqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo0MDoyNlrOGC3qqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2MjM3Nw==", "bodyText": "good fix", "url": "https://github.com/IBM/FHIR/pull/904#discussion_r405662377", "createdAt": "2020-04-08T16:40:26Z", "author": {"login": "prb112"}, "path": "build/gen-code.sh", "diffHunk": "@@ -5,12 +5,16 @@\n #\n # SPDX-License-Identifier: Apache-2.0\n ###############################################################################\n+set -ex\n \n-# installs the fhir-tools\n-mvn clean package install -f ../fhir-tools/pom.xml\n+# The full path to the directory of this script, no matter where its called from\n+DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" >/dev/null 2>&1 && pwd )\"\n+WORKSPACE=\"$( dirname \"${DIR}\" )\"\n+\n+# Install the latest fhir-tools\n+mvn clean install -f ${WORKSPACE}/fhir-tools/pom.xml\n \n if [[ $? -eq 0 ]]\n-then \n-    mvn com.ibm.fhir:fhir-tools:generate-model -f ../fhir-model/pom.xml\n+then\n+    mvn com.ibm.fhir:fhir-tools:generate-model -f ${WORKSPACE}/fhir-model/pom.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a62c3bede27f4e373da124462b78ea9d46036cfc"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 170, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}