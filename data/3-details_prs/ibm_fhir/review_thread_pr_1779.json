{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMjkwNTA1", "number": 1779, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMjowMzo0N1rOE_1Csw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMjowMzo0N1rOE_1Csw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MzY0Nzg3OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/app/Main.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMjowMzo0N1rOH9wClA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwMDo1ODozMFrOH90kKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUxMjI3Ng==", "bodyText": "I was under the impression that the stored procs (or functions for postgres) should be part of the physical data model already and that they should get \"refreshed\" as part of the normal applyModel.\nObviously that wasn't working quite right, but now I'm not sure if it was because my understanding was wrong or if a premature commit (the change below) was the root cause.\nI'm OK with adding this in to cover us (so for sure the issue will be addressed), but it would be good to know whether applyModel above is working properly or not wrt updating procedures.", "url": "https://github.com/IBM/FHIR/pull/1779#discussion_r534512276", "createdAt": "2020-12-02T22:03:47Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/app/Main.java", "diffHunk": "@@ -374,6 +374,10 @@ protected void updateSchema() {\n         if (!MULTITENANT_FEATURE_ENABLED.contains(dbType) && newDb ) {\n             populateResourceTypeAndParameterNameTableEntries(null);\n         }\n+\n+        // Let's refresh the procedures and functions.\n+        logger.info(\"Refreshing procedures and functions\");\n+        updateProcedures();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41e95c7381ecb889f30f467e5a6cc7c0c78e5e60"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDU4NjQxMA==", "bodyText": "yes, that's right they should however it doesn't exactly work on postgres, it does on db2.", "url": "https://github.com/IBM/FHIR/pull/1779#discussion_r534586410", "createdAt": "2020-12-03T00:58:30Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/src/main/java/com/ibm/fhir/schema/app/Main.java", "diffHunk": "@@ -374,6 +374,10 @@ protected void updateSchema() {\n         if (!MULTITENANT_FEATURE_ENABLED.contains(dbType) && newDb ) {\n             populateResourceTypeAndParameterNameTableEntries(null);\n         }\n+\n+        // Let's refresh the procedures and functions.\n+        logger.info(\"Refreshing procedures and functions\");\n+        updateProcedures();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUxMjI3Ng=="}, "originalCommit": {"oid": "41e95c7381ecb889f30f467e5a6cc7c0c78e5e60"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4647, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}