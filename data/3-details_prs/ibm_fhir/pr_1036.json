{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MjQyNzg5", "number": 1036, "title": "Set Context Invalid in Multi-tenant Db2 #1032", "bodyText": "Signed-off-by: Paul Bastide pbastide@us.ibm.com", "createdAt": "2020-05-06T17:50:10Z", "url": "https://github.com/IBM/FHIR/pull/1036", "merged": true, "mergeCommit": {"oid": "8d802a067603808bd1509eb6c3134b57a99295b0"}, "closed": true, "closedAt": "2020-05-06T18:31:52Z", "author": {"login": "prb112"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcesbIWAH2gAyNDE0MjQyNzg5OjZmZWNlNWI4MmFlN2Y4MTRiNjBhYjYyZWM2NDA1OWE5ZWNjYzNiZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcesmlvgH2gAyNDE0MjQyNzg5OjcxZmFmNjM4NzliZGJmMWRkNDU2NGYzZDA2MmVjZTI5NTU2ZjEzYTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6fece5b82ae7f814b60ab62ec64059a9eccc3bd7", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/6fece5b82ae7f814b60ab62ec64059a9eccc3bd7", "committedDate": "2020-05-06T17:49:16Z", "message": "Set Context Invalid in Multi-tenant Db2 #1032\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2ODUzMjIw", "url": "https://github.com/IBM/FHIR/pull/1036#pullrequestreview-406853220", "createdAt": "2020-05-06T17:54:21Z", "commit": {"oid": "6fece5b82ae7f814b60ab62ec64059a9eccc3bd7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2ODU0MTQw", "url": "https://github.com/IBM/FHIR/pull/1036#pullrequestreview-406854140", "createdAt": "2020-05-06T17:55:28Z", "commit": {"oid": "6fece5b82ae7f814b60ab62ec64059a9eccc3bd7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNzo1NToyOFrOGRewKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNzo1NToyOFrOGRewKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk4MjgyNw==", "bodyText": "should we handle dsPG == null situation?", "url": "https://github.com/IBM/FHIR/pull/1036#discussion_r420982827", "createdAt": "2020-05-06T17:55:28Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/dao/impl/FHIRDbDAOImpl.java", "diffHunk": "@@ -247,6 +222,67 @@ public Connection getConnection() throws FHIRPersistenceDBConnectException {\n         }\n     }\n \n+    /**\n+     * this feature is executes row access control\n+     * \n+     * @param connection\n+     * @throws Exception\n+     */\n+    public void executeRowAccessFeature(Connection connection) throws Exception {\n+        // For the multi-tenant feature, configure the connection for the tenant by setting the sv_tenant_id.\n+        String tenantName = FHIRRequestContext.get().getTenantId();\n+        String tenantKey = null;\n+        String dsId = FHIRRequestContext.get().getDataStoreId();\n+        boolean multiTenantFeature = false;\n+\n+        // Retrieve the property group pertaining to the specified datastore.\n+        // Find and set the tenantKey for the request, otherwise subsequent pulls from the pool\n+        // miss the tenantKey.\n+        String dsPropertyName = FHIRConfiguration.PROPERTY_DATASOURCES + \"/\" + dsId;\n+        PropertyGroup dsPG = FHIRConfigHelper.getPropertyGroup(dsPropertyName);\n+        if (dsPG != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fece5b82ae7f814b60ab62ec64059a9eccc3bd7"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2ODU0NjAz", "url": "https://github.com/IBM/FHIR/pull/1036#pullrequestreview-406854603", "createdAt": "2020-05-06T17:56:05Z", "commit": {"oid": "6fece5b82ae7f814b60ab62ec64059a9eccc3bd7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71faf63879bdbf1dd4564f3d062ece29556f13a7", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/71faf63879bdbf1dd4564f3d062ece29556f13a7", "committedDate": "2020-05-06T18:01:47Z", "message": "Set Context Invalid in Multi-tenant Db2 #1032\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 446, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}