{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4MDEzMDE2", "number": 978, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyNToyMFrOD1Y5kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyNToyMFrOD1Y5kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzA5MDc1OnYy", "diffSide": "RIGHT", "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyNToyMFrOGKznEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMDo0Njo0OFrOGLB2sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NDUzMA==", "bodyText": "so it doesn't complain that fhirbatchDS doesn't exist by default?", "url": "https://github.com/IBM/FHIR/pull/978#discussion_r413984530", "createdAt": "2020-04-23T17:25:20Z", "author": {"login": "lmsurpre"}, "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "diffHunk": "@@ -41,15 +44,21 @@\n             portNumber=\"50001\"\n             securityMechanism=\"15\"\n             serverName=\"${env.BATCH_DB_HOSTNAME}\"\n-            sslConnection=\"true\" /> -->\n-        <!-- <properties.postgresql\n+            sslConnection=\"true\" />\n+    </dataSource>\n+     -->\n+   \n+   <!-- Use postgresql for job repository  \n+    <dataSource id=\"fhirbatchDS\" jndiName=\"jdbc/fhirbatchDB\">\n+        <jdbcDriver libraryRef=\"fhirSharedLib\"/>\n+        <properties.postgresql\n             databaseName=\"jobdb\"\n             portNumber=\"5432\"\n             serverName=\"localhost\"\n             user=\"javabatch\"\n-            password=\"change-password\" /> -->\n-        <properties.derby.embedded createDatabase=\"create\" databaseName=\"derby/fhirDB\"/>\n+            password=\"change-password\" />\n     </dataSource>\n+    -->\n \n     <batchPersistence jobStoreRef=\"BatchDatabaseStore\"/>\n     <databaseStore dataSourceRef=\"fhirbatchDS\" id=\"BatchDatabaseStore\" schema=\"JBATCH\" tablePrefix=\"\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a331f008ffa0626bf4a77c4b4948dc3247b5921"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk5MTE4NQ==", "bodyText": "yes, it doesn't complaint on these 2 lines, so I kept them here, and so only need to define the datasource in the overrides", "url": "https://github.com/IBM/FHIR/pull/978#discussion_r413991185", "createdAt": "2020-04-23T17:34:51Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "diffHunk": "@@ -41,15 +44,21 @@\n             portNumber=\"50001\"\n             securityMechanism=\"15\"\n             serverName=\"${env.BATCH_DB_HOSTNAME}\"\n-            sslConnection=\"true\" /> -->\n-        <!-- <properties.postgresql\n+            sslConnection=\"true\" />\n+    </dataSource>\n+     -->\n+   \n+   <!-- Use postgresql for job repository  \n+    <dataSource id=\"fhirbatchDS\" jndiName=\"jdbc/fhirbatchDB\">\n+        <jdbcDriver libraryRef=\"fhirSharedLib\"/>\n+        <properties.postgresql\n             databaseName=\"jobdb\"\n             portNumber=\"5432\"\n             serverName=\"localhost\"\n             user=\"javabatch\"\n-            password=\"change-password\" /> -->\n-        <properties.derby.embedded createDatabase=\"create\" databaseName=\"derby/fhirDB\"/>\n+            password=\"change-password\" />\n     </dataSource>\n+    -->\n \n     <batchPersistence jobStoreRef=\"BatchDatabaseStore\"/>\n     <databaseStore dataSourceRef=\"fhirbatchDS\" id=\"BatchDatabaseStore\" schema=\"JBATCH\" tablePrefix=\"\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NDUzMA=="}, "originalCommit": {"oid": "4a331f008ffa0626bf4a77c4b4948dc3247b5921"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk5MjU0NA==", "bodyText": "and yes, I verified that derby is used in this case. the job id is always 1 after each restart of the server.", "url": "https://github.com/IBM/FHIR/pull/978#discussion_r413992544", "createdAt": "2020-04-23T17:36:54Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "diffHunk": "@@ -41,15 +44,21 @@\n             portNumber=\"50001\"\n             securityMechanism=\"15\"\n             serverName=\"${env.BATCH_DB_HOSTNAME}\"\n-            sslConnection=\"true\" /> -->\n-        <!-- <properties.postgresql\n+            sslConnection=\"true\" />\n+    </dataSource>\n+     -->\n+   \n+   <!-- Use postgresql for job repository  \n+    <dataSource id=\"fhirbatchDS\" jndiName=\"jdbc/fhirbatchDB\">\n+        <jdbcDriver libraryRef=\"fhirSharedLib\"/>\n+        <properties.postgresql\n             databaseName=\"jobdb\"\n             portNumber=\"5432\"\n             serverName=\"localhost\"\n             user=\"javabatch\"\n-            password=\"change-password\" /> -->\n-        <properties.derby.embedded createDatabase=\"create\" databaseName=\"derby/fhirDB\"/>\n+            password=\"change-password\" />\n     </dataSource>\n+    -->\n \n     <batchPersistence jobStoreRef=\"BatchDatabaseStore\"/>\n     <databaseStore dataSourceRef=\"fhirbatchDS\" id=\"BatchDatabaseStore\" schema=\"JBATCH\" tablePrefix=\"\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NDUzMA=="}, "originalCommit": {"oid": "4a331f008ffa0626bf4a77c4b4948dc3247b5921"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDEwOTU4OA==", "bodyText": "OK, I havn't quite got around to test bulk export locally, but I'll take your word for it :-)", "url": "https://github.com/IBM/FHIR/pull/978#discussion_r414109588", "createdAt": "2020-04-23T20:41:45Z", "author": {"login": "lmsurpre"}, "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "diffHunk": "@@ -41,15 +44,21 @@\n             portNumber=\"50001\"\n             securityMechanism=\"15\"\n             serverName=\"${env.BATCH_DB_HOSTNAME}\"\n-            sslConnection=\"true\" /> -->\n-        <!-- <properties.postgresql\n+            sslConnection=\"true\" />\n+    </dataSource>\n+     -->\n+   \n+   <!-- Use postgresql for job repository  \n+    <dataSource id=\"fhirbatchDS\" jndiName=\"jdbc/fhirbatchDB\">\n+        <jdbcDriver libraryRef=\"fhirSharedLib\"/>\n+        <properties.postgresql\n             databaseName=\"jobdb\"\n             portNumber=\"5432\"\n             serverName=\"localhost\"\n             user=\"javabatch\"\n-            password=\"change-password\" /> -->\n-        <properties.derby.embedded createDatabase=\"create\" databaseName=\"derby/fhirDB\"/>\n+            password=\"change-password\" />\n     </dataSource>\n+    -->\n \n     <batchPersistence jobStoreRef=\"BatchDatabaseStore\"/>\n     <databaseStore dataSourceRef=\"fhirbatchDS\" id=\"BatchDatabaseStore\" schema=\"JBATCH\" tablePrefix=\"\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NDUzMA=="}, "originalCommit": {"oid": "4a331f008ffa0626bf4a77c4b4948dc3247b5921"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDIxNzkwNw==", "bodyText": "thanks! :)", "url": "https://github.com/IBM/FHIR/pull/978#discussion_r414217907", "createdAt": "2020-04-24T00:46:48Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-server/liberty-config/configDropins/defaults/bulkdata.xml", "diffHunk": "@@ -41,15 +44,21 @@\n             portNumber=\"50001\"\n             securityMechanism=\"15\"\n             serverName=\"${env.BATCH_DB_HOSTNAME}\"\n-            sslConnection=\"true\" /> -->\n-        <!-- <properties.postgresql\n+            sslConnection=\"true\" />\n+    </dataSource>\n+     -->\n+   \n+   <!-- Use postgresql for job repository  \n+    <dataSource id=\"fhirbatchDS\" jndiName=\"jdbc/fhirbatchDB\">\n+        <jdbcDriver libraryRef=\"fhirSharedLib\"/>\n+        <properties.postgresql\n             databaseName=\"jobdb\"\n             portNumber=\"5432\"\n             serverName=\"localhost\"\n             user=\"javabatch\"\n-            password=\"change-password\" /> -->\n-        <properties.derby.embedded createDatabase=\"create\" databaseName=\"derby/fhirDB\"/>\n+            password=\"change-password\" />\n     </dataSource>\n+    -->\n \n     <batchPersistence jobStoreRef=\"BatchDatabaseStore\"/>\n     <databaseStore dataSourceRef=\"fhirbatchDS\" id=\"BatchDatabaseStore\" schema=\"JBATCH\" tablePrefix=\"\"/>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NDUzMA=="}, "originalCommit": {"oid": "4a331f008ffa0626bf4a77c4b4948dc3247b5921"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4982, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}