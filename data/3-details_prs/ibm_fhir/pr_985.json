{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4OTkzNjAy", "number": 985, "title": "BulkData $import API improvement - Exit Status #949", "bodyText": "Updated the ChunkJob.xml to include missing parameters (the passed\nvalues didn't agree)\nAdd guard for null condition\nAdded support for operational outcome bucket\n\n{\n    \"transactionTime\": \"2020-04-25T20:35:50.699-04:00\",\n    \"request\": \"$import\",\n    \"requiresAccessToken\": false,\n    \"output\": [\n        {\n            \"type\": \"OperationOutcome\",\n            \"url\": \"test-import.ndjson_oo_success.ndjson\",\n            \"count\": 3\n        }\n    ],\n    \"error\": [\n        {\n            \"type\": \"OperationOutcome\",\n            \"url\": \"test-import.ndjson_oo_errors.ndjson\",\n            \"count\": 0\n        }\n    ]\n}```\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "createdAt": "2020-04-26T00:45:31Z", "url": "https://github.com/IBM/FHIR/pull/985", "merged": true, "mergeCommit": {"oid": "8e73de9046c4d0f416a64c8febdf41f6c2510c51"}, "closed": true, "closedAt": "2020-04-27T13:44:43Z", "author": {"login": "prb112"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbPxSfgH2gAyNDA4OTkzNjAyOjQ1NzRjNTA1ZDk3MjI4MjllYTUyNWU0MDc4OTQyMzM5ZGUxZGJlYjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbvQMmAFqTQwMDk0Nzk5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/4574c505d9722829ea525e4078942339de1dbeb6", "committedDate": "2020-04-26T00:44:27Z", "message": "BulkData $import API improvement - Exit Status #949\n\n- Updated the ChunkJob.xml to include missing parameters (the passed\nvalues didn't agree)\n- Add guard for null condition\n- Added support for operational outcome bucket\n```\n{\n    \"transactionTime\": \"2020-04-25T20:35:50.699-04:00\",\n    \"request\": \"$import\",\n    \"requiresAccessToken\": false,\n    \"output\": [\n        {\n            \"type\": \"OperationOutcome\",\n            \"url\": \"test-import.ndjson_oo_success.ndjson\",\n            \"count\": 3\n        }\n    ],\n    \"error\": [\n        {\n            \"type\": \"OperationOutcome\",\n            \"url\": \"test-import.ndjson_oo_errors.ndjson\",\n            \"count\": 0\n        }\n    ]\n}```\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODkzMzQ1", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400893345", "createdAt": "2020-04-27T12:15:53Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoxNTo1M1rOGMgDYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoxNTo1M1rOGMgDYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc2MTI1MA==", "bodyText": "Mapper doesn't need this.", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415761250", "createdAt": "2020-04-27T12:15:53Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-bulkimportexport-webapp/src/main/java/META-INF/batch-jobs/FhirBulkImportChunkJob.xml", "diffHunk": "@@ -49,12 +49,13 @@\n                     <property name=\"cos.location\" value=\"#{jobParameters['cos.location']}\"/>\n                     <property name=\"cos.credential.ibm\" value=\"#{jobParameters['cos.credential.ibm']}\"/>\n                     <property name=\"cos.bucket.name\" value=\"#{jobParameters['cos.bucket.name']}\"/>\n+                    <property name=\"cos.operationoutcomes.bucket.name\" value=\"#{jobParameters['cos.operationoutcomes.bucket.name']}\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTAwMTIw", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400900120", "createdAt": "2020-04-27T12:25:19Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyNToxOVrOGMgbLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyNToxOVrOGMgbLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc2NzM0Mw==", "bodyText": "not sure why this change is needed, not inject property is used in ImportPartitionCollector(), the CosClient was created in ImportPartitionCollector() to make sure it's only created once for each ImportPartitionCollector object.", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415767343", "createdAt": "2020-04-27T12:25:19Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportPartitionCollector.java", "diffHunk": "@@ -80,10 +86,7 @@ public ImportPartitionCollector() throws Exception {\n                 logger.finer(\"ImportPartitionCollector: Succeed get CosClient!\");\n             }\n         }\n-    }\n \n-    @Override\n-    public Serializable collectPartitionData() throws Exception{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTAzMjQ1", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400903245", "createdAt": "2020-04-27T12:29:32Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyOTozMlrOGMgmDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyOTozMlrOGMgmDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3MDEyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                <property name=\"cos.operationoutcomes.bucket.name\" value=\"#{jobParameters['cos.operationoutcomes.bucket.name']}\"/>", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415770125", "createdAt": "2020-04-27T12:29:32Z", "author": {"login": "prb112"}, "path": "fhir-bulkimportexport-webapp/src/main/java/META-INF/batch-jobs/FhirBulkImportChunkJob.xml", "diffHunk": "@@ -49,12 +49,13 @@\n                     <property name=\"cos.location\" value=\"#{jobParameters['cos.location']}\"/>\n                     <property name=\"cos.credential.ibm\" value=\"#{jobParameters['cos.credential.ibm']}\"/>\n                     <property name=\"cos.bucket.name\" value=\"#{jobParameters['cos.bucket.name']}\"/>\n+                    <property name=\"cos.operationoutcomes.bucket.name\" value=\"#{jobParameters['cos.operationoutcomes.bucket.name']}\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTAzMzUz", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400903353", "createdAt": "2020-04-27T12:29:41Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyOTo0MlrOGMgmfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjoyOTo0MlrOGMgmfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3MDIzOQ==", "bodyText": "Mapper already got these properties from injection, don't need to pass through partition properties.", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415770239", "createdAt": "2020-04-27T12:29:42Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportPartitionMapper.java", "diffHunk": "@@ -269,6 +276,13 @@ public PartitionPlan mapPartitions() throws Exception {\n             Properties p = new Properties();\n             p.setProperty(Constants.IMPORT_PARTITTION_WORKITEM, fhirDataSource.getUrl());\n             p.setProperty(Constants.IMPORT_PARTITTION_RESOURCE_TYPE, fhirDataSource.getType());\n+            p.setProperty(Constants.COS_API_KEY, cosApiKeyProperty);\n+            p.setProperty(Constants.COS_SRVINST_ID, cosSrvinstId);\n+            p.setProperty(Constants.COS_ENDPOINT_URL, cosEndpointUrl);\n+            p.setProperty(Constants.COS_LOCATION, cosLocation);\n+            p.setProperty(Constants.COS_OPERATIONOUTCOMES_BUCKET_NAME, cosOperationOutcomesBucketName);\n+            p.setProperty(Constants.COS_IS_IBM_CREDENTIAL, cosCredentialIbm);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b97c16145e83c9cc6a4a9ea9f84ee25a7a5f97d1", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/b97c16145e83c9cc6a4a9ea9f84ee25a7a5f97d1", "committedDate": "2020-04-27T12:29:43Z", "message": "Update fhir-bulkimportexport-webapp/src/main/java/META-INF/batch-jobs/FhirBulkImportChunkJob.xml\r\n\r\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTEwMTgw", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400910180", "createdAt": "2020-04-27T12:39:14Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjozOToxNFrOGMg-9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjozOToxNFrOGMg-9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3NjUwMg==", "bodyText": "better use OperationOutcome instead of Oo?", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415776502", "createdAt": "2020-04-27T12:39:14Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-operation-bulkdata/src/main/java/com/ibm/fhir/operation/bulkdata/client/BulkDataClient.java", "diffHunk": "@@ -448,6 +453,7 @@ public String submitImport(String inputFormat, String inputSource, List<Input> i\n         builder.applicationName(properties.get(BulkDataConfigUtil.APPLICATION_NAME));\n         builder.moduleName(properties.get(BulkDataConfigUtil.MODULE_NAME));\n         builder.cosBucketName(properties.get(BulkDataConfigUtil.JOB_PARAMETERS_BUCKET));\n+        builder.cosBucketNameOo(properties.get(BulkDataConfigUtil.JOB_PARAMETERS_BUCKET));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTEwNTI2", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400910526", "createdAt": "2020-04-27T12:39:44Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjozOTo0NFrOGMhAQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjozOTo0NFrOGMhAQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3NjgzMw==", "bodyText": "better use OperationOutcome instead of Oo?", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415776833", "createdAt": "2020-04-27T12:39:44Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-operation-bulkdata/src/main/java/com/ibm/fhir/operation/bulkdata/model/JobExecutionResponse.java", "diffHunk": "@@ -340,6 +340,11 @@ public Builder fhirStorageType(StorageDetail storageDetails) {\n             jobParameter.setStorageDetails(storageDetails);\n             return this;\n         }\n+\n+        public Builder cosBucketNameOo(String cosBucketNameOo) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTExMzE1", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400911315", "createdAt": "2020-04-27T12:40:47Z", "commit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MDo0OFrOGMhC0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMjo0MDo0OFrOGMhC0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc3NzQ5MA==", "bodyText": "Oo seems strange ...", "url": "https://github.com/IBM/FHIR/pull/985#discussion_r415777490", "createdAt": "2020-04-27T12:40:48Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-operation-bulkdata/src/main/java/com/ibm/fhir/operation/bulkdata/model/JobInstanceRequest.java", "diffHunk": "@@ -190,6 +190,11 @@ public JobInstanceRequest build() {\n             request.setJobParameters(jobParameter);\n             return request;\n         }\n+\n+        public Builder cosBucketNameOo(String cosBucketNameOo) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4574c505d9722829ea525e4078942339de1dbeb6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82fb63f07613d154e8c2011893e71aa376568f22", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/82fb63f07613d154e8c2011893e71aa376568f22", "committedDate": "2020-04-27T13:05:56Z", "message": "BulkData $import API improvement - Exit Status #949\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "709ad3b44846d5ccba0404dd55bd9cf7e6c41487", "author": {"user": {"login": "prb112", "name": "Paul Bastide"}}, "url": "https://github.com/IBM/FHIR/commit/709ad3b44846d5ccba0404dd55bd9cf7e6c41487", "committedDate": "2020-04-27T13:06:19Z", "message": "Merge branch 'issue-949' of github.com:IBM/FHIR into issue-949"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTQ3OTkx", "url": "https://github.com/IBM/FHIR/pull/985#pullrequestreview-400947991", "createdAt": "2020-04-27T13:25:16Z", "commit": {"oid": "709ad3b44846d5ccba0404dd55bd9cf7e6c41487"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 401, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}