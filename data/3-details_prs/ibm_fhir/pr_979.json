{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4MTM3NTcz", "number": 979, "title": "issue #944 add import counts to job exit status", "bodyText": "Added import counts (succeeded and failures) to import javabatch job exit status.\nSigned-off-by: Albert Wang xuwang@us.ibm.com", "createdAt": "2020-04-23T19:25:06Z", "url": "https://github.com/IBM/FHIR/pull/979", "merged": true, "mergeCommit": {"oid": "26c4c36e61e3ddaa658d42cb65f1ec036ae3f898"}, "closed": true, "closedAt": "2020-04-24T00:46:03Z", "author": {"login": "albertwang-ibm"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaiLThAFqTM5OTQxNjAyMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcajNjwAH2gAyNDA4MTM3NTczOjg2MGY1NmY4YTAyNjljOTdmOTY0OWRlODgyNDgxMDUzZDc0ZmNiYzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDE2MDIx", "url": "https://github.com/IBM/FHIR/pull/979#pullrequestreview-399416021", "createdAt": "2020-04-23T19:37:13Z", "commit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTozNzoxM1rOGK43Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTozNzoxM1rOGK43Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA3MDYzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.setUniqueIDForImportOperationOutcomes(importPartitionWorkitem + \"_ok_file.ndjson\");\n          \n          \n            \n                    this.setUniqueIDForImportOperationOutcomes(importPartitionWorkitem + \"_oo_success.ndjson\");", "url": "https://github.com/IBM/FHIR/pull/979#discussion_r414070630", "createdAt": "2020-04-23T19:37:13Z", "author": {"login": "prb112"}, "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportCheckPointData.java", "diffHunk": "@@ -62,9 +62,14 @@ public ImportCheckPointData(String importPartitionWorkitem, int numOfProcessedRe\n         this.importPartitionWorkitem = importPartitionWorkitem;\n         this.numOfProcessedResources = numOfProcessedResources;\n         this.importPartitionResourceType = importPartitionResourceType;\n-        String ramdomID = FHIRUtil.getRandomKey(\"AES\");\n-        this.setUniqueIDForImportOperationOutcomes(ramdomID + \"_ok_file.ndjson\");\n-        this.setUniqueIDForImportFailureOperationOutcomes(ramdomID + \"_error_file.ndjson\");\n+\n+        // This naming pattern is used in bulkdata operation to generate file links for import OperationOutcomes.\n+        // e.g, for input file test1.ndjson, if there is any error during the importing, then the errors are in \n+        // test1.ndjson_errors.ndjson\n+        // Note: for those good imports, we don't really generate any meaningful OperationOutcome, so only error import \n+        //       OperationOutcomes are supported for now.\n+        this.setUniqueIDForImportOperationOutcomes(importPartitionWorkitem + \"_ok_file.ndjson\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDE2MTgw", "url": "https://github.com/IBM/FHIR/pull/979#pullrequestreview-399416180", "createdAt": "2020-04-23T19:37:27Z", "commit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTozNzoyN1rOGK438w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTozNzoyN1rOGK438w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA3MDc3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.setUniqueIDForImportFailureOperationOutcomes(importPartitionWorkitem + \"_errors.ndjson\");\n          \n          \n            \n                    this.setUniqueIDForImportFailureOperationOutcomes(importPartitionWorkitem + \"_oo_errors.ndjson\");", "url": "https://github.com/IBM/FHIR/pull/979#discussion_r414070771", "createdAt": "2020-04-23T19:37:27Z", "author": {"login": "prb112"}, "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportCheckPointData.java", "diffHunk": "@@ -62,9 +62,14 @@ public ImportCheckPointData(String importPartitionWorkitem, int numOfProcessedRe\n         this.importPartitionWorkitem = importPartitionWorkitem;\n         this.numOfProcessedResources = numOfProcessedResources;\n         this.importPartitionResourceType = importPartitionResourceType;\n-        String ramdomID = FHIRUtil.getRandomKey(\"AES\");\n-        this.setUniqueIDForImportOperationOutcomes(ramdomID + \"_ok_file.ndjson\");\n-        this.setUniqueIDForImportFailureOperationOutcomes(ramdomID + \"_error_file.ndjson\");\n+\n+        // This naming pattern is used in bulkdata operation to generate file links for import OperationOutcomes.\n+        // e.g, for input file test1.ndjson, if there is any error during the importing, then the errors are in \n+        // test1.ndjson_errors.ndjson\n+        // Note: for those good imports, we don't really generate any meaningful OperationOutcome, so only error import \n+        //       OperationOutcomes are supported for now.\n+        this.setUniqueIDForImportOperationOutcomes(importPartitionWorkitem + \"_ok_file.ndjson\");\n+        this.setUniqueIDForImportFailureOperationOutcomes(importPartitionWorkitem + \"_errors.ndjson\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDE4MjM3", "url": "https://github.com/IBM/FHIR/pull/979#pullrequestreview-399418237", "createdAt": "2020-04-23T19:40:26Z", "commit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTo0MDoyNlrOGK4--A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxOTo0MDoyNlrOGK4--A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDA3MjU2OA==", "bodyText": "82-85 is repeated in many locations.  It seems that it is ideal for a small utility method shared across Jobs. and could use try-catch-close", "url": "https://github.com/IBM/FHIR/pull/979#discussion_r414072568", "createdAt": "2020-04-23T19:40:26Z", "author": {"login": "prb112"}, "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportJobListener.java", "diffHunk": "@@ -60,6 +77,30 @@ public void afterJob() {\n             return;\n         }\n \n+        // Generate import summary and pass it into ExitStatus of the job execution.\n+        // e.g, [3:0, 4:1] means 3 resources imported and 0 failures for the 1st file, and 4 imported and 1 failure for the 2nd file.\n+        JsonReader reader = Json.createReader(new StringReader(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d053bcf76585eef215bed94e6eecdbebc864408f"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NDU4NTcz", "url": "https://github.com/IBM/FHIR/pull/979#pullrequestreview-399458573", "createdAt": "2020-04-23T20:39:23Z", "commit": {"oid": "345f401dcbfa0fc2295fe397cbc4df5d76c98959"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0054de71d35dbb851bd7d659b3e2ff317706afdb", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/0054de71d35dbb851bd7d659b3e2ff317706afdb", "committedDate": "2020-04-23T20:45:47Z", "message": "issue #944 add import counts to job exit status\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2385903dc9240533bc5c596522b51f7e711de937", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/2385903dc9240533bc5c596522b51f7e711de937", "committedDate": "2020-04-23T20:45:47Z", "message": "Update fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkimport/ImportCheckPointData.java\r\n\r\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>\n\nCo-Authored-By: Paul Bastide <pbastide@us.ibm.com>\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cdabee864bd94ed1d1b8b51b92434ba1a6ef5de", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/1cdabee864bd94ed1d1b8b51b92434ba1a6ef5de", "committedDate": "2020-04-23T20:45:47Z", "message": "Apply suggestions from code review\r\n\r\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>\n\nCo-Authored-By: Paul Bastide <pbastide@us.ibm.com>\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6eb2d5158fd8c8409a1379583d692e4dad7a6a81", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/6eb2d5158fd8c8409a1379583d692e4dad7a6a81", "committedDate": "2020-04-23T20:45:47Z", "message": "issue #944 updates per review comments\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "559925c6697f96bc44b27b44e2fe73b96504b653", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/559925c6697f96bc44b27b44e2fe73b96504b653", "committedDate": "2020-04-23T20:44:14Z", "message": "issue #944 updates per review comments\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}, "afterCommit": {"oid": "6eb2d5158fd8c8409a1379583d692e4dad7a6a81", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/6eb2d5158fd8c8409a1379583d692e4dad7a6a81", "committedDate": "2020-04-23T20:45:47Z", "message": "issue #944 updates per review comments\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "860f56f8a0269c97f9649de882481053d74fcbc6", "author": {"user": {"login": "albertwang-ibm", "name": "Albert(Xu) Wang"}}, "url": "https://github.com/IBM/FHIR/commit/860f56f8a0269c97f9649de882481053d74fcbc6", "committedDate": "2020-04-23T20:49:36Z", "message": "issue #944 minor update to comments to align with the codes\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 392, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}