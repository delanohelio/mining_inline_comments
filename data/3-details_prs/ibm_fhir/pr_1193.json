{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MDgzMTY1", "number": 1193, "title": "Issue #1182 - created FHIRTerminologyGuide", "bodyText": "Signed-off-by: John T.E. Timm johntimm@us.ibm.com", "createdAt": "2020-06-04T20:54:35Z", "url": "https://github.com/IBM/FHIR/pull/1193", "merged": true, "mergeCommit": {"oid": "4212a3aff0f05278bf6de571121252de61462dc1"}, "closed": true, "closedAt": "2020-06-05T12:15:13Z", "author": {"login": "JohnTimm"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoEc3SAH2gAyNDI4MDgzMTY1OmRmMGRiMjE4YTVmZTk3ZGY3YWJhOWEyNTU2YjQyMWY2MzgxYmU1ZGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoRn-RAFqTQyNTI0NDg4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df0db218a5fe97df7aba9a2556b421f6381be5dd", "author": {"user": {"login": "JohnTimm", "name": "John T.E. Timm"}}, "url": "https://github.com/IBM/FHIR/commit/df0db218a5fe97df7aba9a2556b421f6381be5dd", "committedDate": "2020-06-04T20:54:12Z", "message": "Issue #1182 - created FHIRTerminologyGuide\n\nSigned-off-by: John T.E. Timm <johntimm@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c31c66e6524368e04d6f263771d24e7d6d0599f7", "author": {"user": {"login": "JohnTimm", "name": "John T.E. Timm"}}, "url": "https://github.com/IBM/FHIR/commit/c31c66e6524368e04d6f263771d24e7d6d0599f7", "committedDate": "2020-06-04T21:27:55Z", "message": "Issue #1182 - fixed typos\n\nSigned-off-by: John T.E. Timm <johntimm@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODU2NDk4", "url": "https://github.com/IBM/FHIR/pull/1193#pullrequestreview-424856498", "createdAt": "2020-06-04T21:42:49Z", "commit": {"oid": "df0db218a5fe97df7aba9a2556b421f6381be5dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo0Mjo0OVrOGfZDDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTo0Mjo0OVrOGfZDDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU2OTQyMA==", "bodyText": "Is it possible to run multiple terminology service implementations at the same time? and allow to choose which service implementation to call.  just curious. :)", "url": "https://github.com/IBM/FHIR/pull/1193#discussion_r435569420", "createdAt": "2020-06-04T21:42:49Z", "author": {"login": "albertwang-ibm"}, "path": "docs/src/pages/guides/FHIRTerminologyGuide.md", "diffHunk": "@@ -0,0 +1,102 @@\n+---\n+layout: post\n+title: FHIR Terminology Guide\n+description: FHIR Terminology Guide\n+date:   2020-06-04 12:00:00 -0400\n+permalink: /FHIRTerminologyGuide/\n+---\n+\n+## Overview\n+\n+The IBM FHIR Server Terminology module ([fhir-term](https://github.com/IBM/FHIR/tree/master/fhir-term)) provides a FHIR terminology service provider interface (SPI) and a default implementation that implements terminology services using `ConceptMap`, `ValueSet`, and `ConceptMap` resources that have been made available through the FHIR registry module ([fhir-registry](https://github.com/IBM/FHIR/tree/master/fhir-registry)).\n+\n+## FHIR Terminology Service Provider Interface (SPI)\n+\n+The FHIR Terminology Service Provider interface provides a mechanism for implementers to provide terminology capabilities via the Java ServiceLoader. The interface includes method signatures for `expand`, `lookup`, `subsumes`, `closure`, `validateCode` (CodeSystem) and `validateCode` (ValueSet). Here is an excerpt (for brevity) of the SPI:\n+\n+```java\n+public interface FHIRTermServiceProvider {\n+    boolean isExpandable(ValueSet valueSet);\n+    ValueSet expand(ValueSet valueSet, ExpansionParameters parameters);\n+    LookupOutcome lookup(Coding coding, LookupParameters parameters);\n+    ConceptSubsumptionOutcome subsumes(Coding codingA, Coding codingB);\n+    Set<Concept> closure(Coding coding);\n+    ValidationOutcome validateCode(CodeSystem codeSystem, Coding coding, ValidationParameters parameters);\n+    ValidationOutcome validateCode(CodeSystem codeSystem, CodeableConcept codeableConcept, ValidationParameters parameters);\n+    ValidationOutcome validateCode(ValueSet valueSet, Coding coding, ValidationParameters parameters);\n+    ValidationOutcome validateCode(ValueSet valueSet, CodeableConcept codeableConcept, ValidationParameters parameters);\n+    TranslationOutcome translate(ConceptMap conceptMap, CodeableConcept codeableConcept, TranslationParameters parameters);\n+}\n+\n+```\n+\n+The `expand `, `lookup`, `validateCode` (CodeSystem), `validateCode` (ValueSet), and `translate` methods support the passing of optional parameters (e.g. `ExpansionParameters`, `LookupParameters`, etc.). Many of the methods also return an \"outcome\" object. These \"parameter\" and \"outcome\" objects are modeled after the input/output parameters specified in the terminology operations from the FHIR Terminology module: [http://hl7.org/fhir/terminology-module.html](http://hl7.org/fhir/terminology-module.html).\n+\n+The \"parameter\" objects can be created from a `Parameters` resource:\n+\n+```java\n+Parameters parameters = ...;\n+ExpansionParameters expansionParameters = ExpansionParameters.from(parameters);\n+```\n+\n+The \"outcome\" objects can be converted to a Parameters resource:\n+\n+```java\n+LookupOutcome outcome = ...;\n+Parameters parameters = outcome.toParameters();\n+```\n+\n+This bridge to/from the `Parameters` resource enables implementers build both native implementations of the SPI and implementations that access an existing external terminology service.\n+\n+## Default Terminology Service Provider Implementation\n+\n+The default implementation of `FHIRTermServiceProvider` ([DefaultTermServiceProvider](https://github.com/IBM/FHIR/master/fhir-term/src/main/java/com/ibm/fhir/term/service/provider/DefaultTermServiceProvider.java)) leverages terminology resources (`CodeSystem`, `ValueSet`, and `ConceptMap`) that are available from the FHIR registry. The only `CodeSystem` resources that are supported are those with complete content (`CodeSystem.content = 'complete'`). `ValueSet` resources are supported if they reference `CodeSystem` resources that have complete content. The default implementation does not support any optional parameters (e.g. `ExpansionParameters`, `TranslationParameters`, `ValidationParameters`, etc.).\n+\n+## FHIR Terminology Service Singleton facade\n+\n+The FHIR Terminology Service Singleton facade ([FHIRTermService](https://github.com/IBM/FHIR/master/fhir-term/src/main/java/com/ibm/fhir/term/service/FHIRTermService.java)) loads a `FHIRTermServiceProvider` from the ServiceLoader, if one exists. Otherwise, it will instantiate a `DefaultTermServiceProvider`. Other FHIR server components and user code (Java) that requires terminology capabilities should access them via the `FHIRTermService` singleton facade. Here is an example:\n+\n+```java\n+ValueSet valueSet = ValueSetSupport.getValueSet(\"http://ibm.com/fhir/ValueSet/vs1\");\n+Coding coding = Coding.builder()\n+        .system(Uri.of(\"http://ibm.com/fhir/CodeSystem/cs1\"))\n+        .version(string(\"1.0.0\"))\n+        .code(Code.of(\"a\")\n+        .display(string(\"concept a\")\n+        .build();\n+ValidationOutcome outcome = FHIRTermService.getInstance().validateCode(valueSet, coding);\n+```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df0db218a5fe97df7aba9a2556b421f6381be5dd"}, "originalPosition": 68}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODU2Njgy", "url": "https://github.com/IBM/FHIR/pull/1193#pullrequestreview-424856682", "createdAt": "2020-06-04T21:43:11Z", "commit": {"oid": "df0db218a5fe97df7aba9a2556b421f6381be5dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db243e0b3f42c5c66f206c85f2fc1d1151f66e94", "author": {"user": {"login": "JohnTimm", "name": "John T.E. Timm"}}, "url": "https://github.com/IBM/FHIR/commit/db243e0b3f42c5c66f206c85f2fc1d1151f66e94", "committedDate": "2020-06-04T21:47:21Z", "message": "Issue #1182 - fixed broken links\n\nSigned-off-by: John T.E. Timm <johntimm@us.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc84c8d550a051ca5349904bbd418356f450ccb2", "author": {"user": {"login": "JohnTimm", "name": "John T.E. Timm"}}, "url": "https://github.com/IBM/FHIR/commit/fc84c8d550a051ca5349904bbd418356f450ccb2", "committedDate": "2020-06-04T21:49:22Z", "message": "Issue #1182 - fixed headings\n\nSigned-off-by: John T.E. Timm <johntimm@us.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MjQ0ODgy", "url": "https://github.com/IBM/FHIR/pull/1193#pullrequestreview-425244882", "createdAt": "2020-06-05T12:15:06Z", "commit": {"oid": "fc84c8d550a051ca5349904bbd418356f450ccb2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 264, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}