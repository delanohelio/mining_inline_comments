{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzM0OTYz", "number": 1765, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNjo1Njo0OFrOE_P27Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNzowNDo1NFrOE_QE9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NzU1NTY1OnYy", "diffSide": "RIGHT", "path": "build/persistence/postgres/pre-integration-test.sh", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNjo1Njo0OFrOH82hYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxODo0MTo1NFrOH86usQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU2OTg4OQ==", "bodyText": "I think this is what failed...", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533569889", "createdAt": "2020-12-01T16:56:48Z", "author": {"login": "prb112"}, "path": "build/persistence/postgres/pre-integration-test.sh", "diffHunk": "@@ -50,11 +50,12 @@ copy_server_config(){\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config-tenants/config/* $DIST/config\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config/config/default/fhir-server-config-postgresql.json $DIST/config/default/fhir-server-config.json\n \n-    echo \"Replacing datasource content in server configDropins...\"\n-    rm -f $DIST/overrides/datasource-*.xml 2> /dev/null\n+    # Note the overrides folder is specifically mounted to the docker image under configDropins/overrides\n+    echo \"Creating an overrides folder in $DIST\"\n     mkdir -p $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-bootstrap.xml $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-postgresql.xml $DIST/overrides\n+    \n+    # Copy and rename the postgres override\n+    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/disabled/datasource-postgresql.xml $DIST/overrides/datasource.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU4ODEwMw==", "bodyText": "I think we want the derby (bootstrap) config too because some of the server tests run against different tenants and, for reduced build times, we only provision a postgresql schema for the default tenant.", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533588103", "createdAt": "2020-12-01T17:22:32Z", "author": {"login": "lmsurpre"}, "path": "build/persistence/postgres/pre-integration-test.sh", "diffHunk": "@@ -50,11 +50,12 @@ copy_server_config(){\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config-tenants/config/* $DIST/config\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config/config/default/fhir-server-config-postgresql.json $DIST/config/default/fhir-server-config.json\n \n-    echo \"Replacing datasource content in server configDropins...\"\n-    rm -f $DIST/overrides/datasource-*.xml 2> /dev/null\n+    # Note the overrides folder is specifically mounted to the docker image under configDropins/overrides\n+    echo \"Creating an overrides folder in $DIST\"\n     mkdir -p $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-bootstrap.xml $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-postgresql.xml $DIST/overrides\n+    \n+    # Copy and rename the postgres override\n+    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/disabled/datasource-postgresql.xml $DIST/overrides/datasource.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU2OTg4OQ=="}, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzYyOTAxMQ==", "bodyText": "never mind, I see the bootstrap datasources are included in the configDropins/defaults", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533629011", "createdAt": "2020-12-01T18:25:59Z", "author": {"login": "lmsurpre"}, "path": "build/persistence/postgres/pre-integration-test.sh", "diffHunk": "@@ -50,11 +50,12 @@ copy_server_config(){\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config-tenants/config/* $DIST/config\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config/config/default/fhir-server-config-postgresql.json $DIST/config/default/fhir-server-config.json\n \n-    echo \"Replacing datasource content in server configDropins...\"\n-    rm -f $DIST/overrides/datasource-*.xml 2> /dev/null\n+    # Note the overrides folder is specifically mounted to the docker image under configDropins/overrides\n+    echo \"Creating an overrides folder in $DIST\"\n     mkdir -p $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-bootstrap.xml $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-postgresql.xml $DIST/overrides\n+    \n+    # Copy and rename the postgres override\n+    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/disabled/datasource-postgresql.xml $DIST/overrides/datasource.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU2OTg4OQ=="}, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzYzODgzMw==", "bodyText": "I think I found the issue: a bad change to the datasource definitions.  I think the datasource properties need to be a peer of the jdbcDriver, not a child.  Also fixed indentations so we hopefully don't make that mistake again.", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533638833", "createdAt": "2020-12-01T18:41:54Z", "author": {"login": "lmsurpre"}, "path": "build/persistence/postgres/pre-integration-test.sh", "diffHunk": "@@ -50,11 +50,12 @@ copy_server_config(){\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config-tenants/config/* $DIST/config\n     cp -pr ${WORKSPACE}/fhir-server/liberty-config/config/default/fhir-server-config-postgresql.json $DIST/config/default/fhir-server-config.json\n \n-    echo \"Replacing datasource content in server configDropins...\"\n-    rm -f $DIST/overrides/datasource-*.xml 2> /dev/null\n+    # Note the overrides folder is specifically mounted to the docker image under configDropins/overrides\n+    echo \"Creating an overrides folder in $DIST\"\n     mkdir -p $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-bootstrap.xml $DIST/overrides\n-    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/overrides/datasource-postgresql.xml $DIST/overrides\n+    \n+    # Copy and rename the postgres override\n+    cp -p ${WORKSPACE}/fhir-server/liberty-config/configDropins/disabled/datasource-postgresql.xml $DIST/overrides/datasource.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU2OTg4OQ=="}, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0NzU5MTU5OnYy", "diffSide": "RIGHT", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNzowNDo1NFrOH824cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxODozNzo1OVrOH86krQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU3NTc5NQ==", "bodyText": "we're mixing datasource and datastore again...probably should match the others:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datastore.xml' as follows:\n          \n          \n            \n            Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datasource.xml' as follows:", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533575795", "createdAt": "2020-12-01T17:04:54Z", "author": {"login": "lmsurpre"}, "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -450,7 +450,7 @@ The 'dataSourceJndiName' property can be removed as it is only used when 'enable\n \n When configured explicitly, the jndiName does not have to follow the standard naming convention, although this is not recommended.\n \n-Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datastore-default.xml' as follows:\n+Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datastore.xml' as follows:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzYzNjI2OQ==", "bodyText": "I included this change in my commit", "url": "https://github.com/IBM/FHIR/pull/1765#discussion_r533636269", "createdAt": "2020-12-01T18:37:59Z", "author": {"login": "lmsurpre"}, "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -450,7 +450,7 @@ The 'dataSourceJndiName' property can be removed as it is only used when 'enable\n \n When configured explicitly, the jndiName does not have to follow the standard naming convention, although this is not recommended.\n \n-Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datastore-default.xml' as follows:\n+Continuing the above example, configure a drop-in server configuration file 'configDropins/overrides/datastore.xml' as follows:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU3NTc5NQ=="}, "originalCommit": {"oid": "22fc3d95222b0d83d831b403939339693f6106ae"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4642, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}