{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMTY0Nzk5", "number": 847, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowNjoyM1rODq6SfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowODowNVrODq6U-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MzIxNzg4OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-schema/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowNjoyM1rOF684jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowNjoyM1rOF684jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM1OTI0NA==", "bodyText": "The other snippets in this README use default as the tenant name.\nI think we should either do the same here (or update everywhere to TENANT_NAME).", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397359244", "createdAt": "2020-03-24T18:06:23Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+\n+```\n+--prop-file db2.properties\n+--schema-name FHIRDATA\n+--add-tenant-key TENANT_NAME", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MzIyNDI1OnYy", "diffSide": "RIGHT", "path": "fhir-persistence-schema/README.md", "isResolved": false, "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxODowODowNVrOF688nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxOTo0MjoxNlrOF7ATAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ==", "bodyText": "do we have info about when is needed to add a key to existing tenant? and how to delete the old tenant key if need etc.", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397360285", "createdAt": "2020-03-24T18:08:05Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM3MjM4Mg==", "bodyText": "I actually had the same thought.  I don't think there is a function to remove a prior key, but I think there should be.", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397372382", "createdAt": "2020-03-24T18:27:33Z", "author": {"login": "lmsurpre"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM3ODE3Ng==", "bodyText": "I can add a comment on this.", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397378176", "createdAt": "2020-03-24T18:37:13Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM3OTY0Mg==", "bodyText": "We only have allocate and drop and add", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397379642", "createdAt": "2020-03-24T18:39:39Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM4MDUzMQ==", "bodyText": "thoughts?", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397380531", "createdAt": "2020-03-24T18:41:15Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM4NDU4Nw==", "bodyText": "allocateTenant will add the tenant and also create a tenant key.\ndoes dropTenant drop all tenant keys? I guess it should.\ndid Robin add the add key for existing tenant feature for security reason? e.g, the tenant key is expose, so need a new key for the tenant ... if so, I think, we do need a command to remove the key ...  and I guess, all the tenant keys of a tenant can work to access the tenant, so if don't delete the old key could bring security issue. ...", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397384587", "createdAt": "2020-03-24T18:48:09Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM4NjM1Mg==", "bodyText": "or it could be that, Robin added this feature just in case the old tenant key is missed/forgotten, but we still want to access that tenant, so this make it handy for us to just create a new key for the tenant and then use it to access the tenant ...", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397386352", "createdAt": "2020-03-24T18:51:04Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM5MzM0NA==", "bodyText": "dropTenant does not remove a key.  it just change the tenant status and removes the partition.  add-tenant-key was for key rotation (except there are NO delete-key features)", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397393344", "createdAt": "2020-03-24T19:02:55Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQwOTkxNg==", "bodyText": "ha, I see. then I think if possible, we need:\n(1) add removing all the tenant keys function in dropTenant, otherwise they are just useless garbage data after the tenant is dropped.\n(2) add remove key command, use tenant name and key as parameter.\nAnd as I remember, the tenant key itself is not stored in DB, but the hash with a salt of the key is stored in db instead, so we will need to remove the hash from the table instead...", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397409916", "createdAt": "2020-03-24T19:32:33Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQxMDA3Mg==", "bodyText": "but anyway, I'm OK with this document change.", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397410072", "createdAt": "2020-03-24T19:32:52Z", "author": {"login": "albertwang-ibm"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQxNDk2Mg==", "bodyText": "it's best to leave it.  I think it's good audit data, and ensures the id is not re-used.", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397414962", "createdAt": "2020-03-24T19:41:50Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQxNTE3MQ==", "bodyText": "I think remove key should be added, that's fairly easy to use.  If agreed, we can create an issue to track", "url": "https://github.com/IBM/FHIR/pull/847#discussion_r397415171", "createdAt": "2020-03-24T19:42:16Z", "author": {"login": "prb112"}, "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -141,6 +141,23 @@ Edit `wlp/usr/servers/fhir-server/config/default/fhir-server-config.json` and ad\n --tenant-key \"<the-base64-tenant-key>\"\n ```\n \n+### Add a Key to Existing Tenant\n+To add a tenant key for an existing tenant, replace FHIRDATA with your client schema, and TENANT_NAME with your tenant's name. \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM2MDI4NQ=="}, "originalCommit": {"oid": "ce22f305bcfc44f8f2c91e04e9fa412ca5913030"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 139, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}