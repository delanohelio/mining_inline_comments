{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwNDY5MjI5", "number": 1335, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMDoxOVrOEPSNQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMjoxM1rOEPSPgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDYyNDAyOnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/JDBCQueryBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMDoxOVrOGy6sTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDoxODowMFrOGy7PDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0MzU5Ng==", "bodyText": "I'm ok with it left there, probably should wrap in is loggable fine and log.fine", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456043596", "createdAt": "2020-07-16T20:00:19Z", "author": {"login": "prb112"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/JDBCQueryBuilder.java", "diffHunk": "@@ -648,8 +648,13 @@ protected SqlQueryData processChainedReferenceParm(QueryParameter queryParm) thr\n             } else {\n                 // This logic processes the LAST parameter in the chain.\n                 // Build this piece: CPx.PARAMETER_NAME_ID = x AND CPx.STR_VALUE = ?\n+                if (chainedParmVar == null) {\n+                    chainedParmVar            = CP + 1;\n+                }\n                 Class<?> chainedResourceType = ModelSupport.getResourceType(resourceTypeName);\n                 SqlQueryData sqlQueryData = buildQueryParm(chainedResourceType, currentParm, chainedParmVar);\n+\n+                // log.info(\"chained sqlQueryData[\" + chainedParmVar + \"] = \" + sqlQueryData.getQueryString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA1MjQ5Mg==", "bodyText": "wrapped and changed to fine", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456052492", "createdAt": "2020-07-16T20:18:00Z", "author": {"login": "punktilious"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/JDBCQueryBuilder.java", "diffHunk": "@@ -648,8 +648,13 @@ protected SqlQueryData processChainedReferenceParm(QueryParameter queryParm) thr\n             } else {\n                 // This logic processes the LAST parameter in the chain.\n                 // Build this piece: CPx.PARAMETER_NAME_ID = x AND CPx.STR_VALUE = ?\n+                if (chainedParmVar == null) {\n+                    chainedParmVar            = CP + 1;\n+                }\n                 Class<?> chainedResourceType = ModelSupport.getResourceType(resourceTypeName);\n                 SqlQueryData sqlQueryData = buildQueryParm(chainedResourceType, currentParm, chainedParmVar);\n+\n+                // log.info(\"chained sqlQueryData[\" + chainedParmVar + \"] = \" + sqlQueryData.getQueryString());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0MzU5Ng=="}, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDYyNjA1OnYy", "diffSide": "LEFT", "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/type/LocationParmBehaviorUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMDo1NVrOGy6thg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDoxODoxMFrOGy7PZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0MzkxMA==", "bodyText": "Copyright 2019", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456043910", "createdAt": "2020-07-16T20:00:55Z", "author": {"login": "prb112"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/type/LocationParmBehaviorUtil.java", "diffHunk": "@@ -46,7 +46,7 @@ public LocationParmBehaviorUtil() {\n      * @param boundingAreas\n      */\n     public void buildLocationSearchQuery(String populateNameIdSubSegment, StringBuilder whereClauseSegment,\n-            List<Object> bindVariables, List<Bounding> boundingAreas) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA1MjU4Mg==", "bodyText": "fixed", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456052582", "createdAt": "2020-07-16T20:18:10Z", "author": {"login": "punktilious"}, "path": "fhir-persistence-jdbc/src/main/java/com/ibm/fhir/persistence/jdbc/util/type/LocationParmBehaviorUtil.java", "diffHunk": "@@ -46,7 +46,7 @@ public LocationParmBehaviorUtil() {\n      * @param boundingAreas\n      */\n     public void buildLocationSearchQuery(String populateNameIdSubSegment, StringBuilder whereClauseSegment,\n-            List<Object> bindVariables, List<Bounding> boundingAreas) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0MzkxMA=="}, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDYyNjkyOnYy", "diffSide": "RIGHT", "path": "fhir-persistence-jdbc/src/test/java/com/ibm/fhir/persistence/jdbc/test/util/LocationParmBehaviorUtilTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMToxOVrOGy6uKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDoxODoyMVrOGy7Pwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0NDA3Mg==", "bodyText": "2020 copyright", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456044072", "createdAt": "2020-07-16T20:01:19Z", "author": {"login": "prb112"}, "path": "fhir-persistence-jdbc/src/test/java/com/ibm/fhir/persistence/jdbc/test/util/LocationParmBehaviorUtilTest.java", "diffHunk": "@@ -37,7 +39,7 @@ private void runTestBoundingBox(List<Object> expectedBindVariables, String expec\n         List<Object> actualBindVariables = new ArrayList<>();\n \n         LocationParmBehaviorUtil util = new LocationParmBehaviorUtil();\n-        util.buildQueryForBoundingBox(actualWhereClauseSegment, actualBindVariables, boundingBox);\n+        util.buildQueryForBoundingBox(actualWhereClauseSegment, actualBindVariables, boundingBox, JDBCConstants.PARAMETER_TABLE_ALIAS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA1MjY3NA==", "bodyText": "fixed", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456052674", "createdAt": "2020-07-16T20:18:21Z", "author": {"login": "punktilious"}, "path": "fhir-persistence-jdbc/src/test/java/com/ibm/fhir/persistence/jdbc/test/util/LocationParmBehaviorUtilTest.java", "diffHunk": "@@ -37,7 +39,7 @@ private void runTestBoundingBox(List<Object> expectedBindVariables, String expec\n         List<Object> actualBindVariables = new ArrayList<>();\n \n         LocationParmBehaviorUtil util = new LocationParmBehaviorUtil();\n-        util.buildQueryForBoundingBox(actualWhereClauseSegment, actualBindVariables, boundingBox);\n+        util.buildQueryForBoundingBox(actualWhereClauseSegment, actualBindVariables, boundingBox, JDBCConstants.PARAMETER_TABLE_ALIAS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0NDA3Mg=="}, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDYyOTc4OnYy", "diffSide": "RIGHT", "path": "fhir-persistence/src/main/java/com/ibm/fhir/persistence/util/AbstractQueryBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDowMjoxM1rOGy6v9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDoxODozMFrOGy7QDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0NDUzMw==", "bodyText": "Copyright", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456044533", "createdAt": "2020-07-16T20:02:13Z", "author": {"login": "prb112"}, "path": "fhir-persistence/src/main/java/com/ibm/fhir/persistence/util/AbstractQueryBuilder.java", "diffHunk": "@@ -233,7 +233,7 @@ protected T1 buildQueryParm(Class<?> resourceType, QueryParameter queryParm)\n      * @return T1 - A query segment related to a LocationPosition\n      * @throws FHIRPersistenceException\n      */\n-    protected T1 processLocationPosition(List<QueryParameter> queryParameters) throws FHIRPersistenceException {\n+    protected T1 processLocationPosition(List<QueryParameter> queryParameters, String paramTableAlias) throws FHIRPersistenceException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA1Mjc1MA==", "bodyText": "fixed", "url": "https://github.com/IBM/FHIR/pull/1335#discussion_r456052750", "createdAt": "2020-07-16T20:18:30Z", "author": {"login": "punktilious"}, "path": "fhir-persistence/src/main/java/com/ibm/fhir/persistence/util/AbstractQueryBuilder.java", "diffHunk": "@@ -233,7 +233,7 @@ protected T1 buildQueryParm(Class<?> resourceType, QueryParameter queryParm)\n      * @return T1 - A query segment related to a LocationPosition\n      * @throws FHIRPersistenceException\n      */\n-    protected T1 processLocationPosition(List<QueryParameter> queryParameters) throws FHIRPersistenceException {\n+    protected T1 processLocationPosition(List<QueryParameter> queryParameters, String paramTableAlias) throws FHIRPersistenceException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA0NDUzMw=="}, "originalCommit": {"oid": "cf852a9a056465d8f61412388e108c02d75125eb"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4757, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}