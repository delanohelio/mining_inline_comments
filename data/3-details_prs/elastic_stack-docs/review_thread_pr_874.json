{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0MzgwMjAy", "number": 874, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo0ODoxOVrODhLhCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxOTozNDoyMlrODhMcFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTE4MjgzOnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo0ODoxOVrOFrzR6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMzowNjo0MVrOFsSk2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3MzI1Ng==", "bodyText": "to be fair, this is our logic error, the beats field is wad, whether or not the design is correct. It might be kind of unfair to say this is a beats issue.", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381473256", "createdAt": "2020-02-19T18:48:19Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk4NjAxMQ==", "bodyText": "Removed the word issue.", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381986011", "createdAt": "2020-02-20T13:06:41Z", "author": {"login": "benskelker"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3MzI1Ng=="}, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTE5MTQ3OnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1MTowNFrOFrzXpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1MTowNFrOFrzXpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NDcyNQ==", "bodyText": "can we say, \"when they rarely produce actionable signals because they match local expected behavior, workflows, or policy exceptions.\"", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381474725", "createdAt": "2020-02-19T18:51:04Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTE5NDU5OnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1MTo1NFrOFrzZ4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1MTo1NFrOFrzZ4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NTI5OQ==", "bodyText": "would be more accurate to say \"so they align with or reflect local policy exceptions\"", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381475299", "createdAt": "2020-02-19T18:51:54Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTE5Nzc0OnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1Mjo1NlrOFrzb9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1Mjo1NlrOFrzb9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NTgzMA==", "bodyText": "this may be my bad but we should say \"Occasionally, these produce unwanted signals.\"", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381475830", "createdAt": "2020-02-19T18:52:56Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, \n+network detection rules may produce noise. <<fix-network-rules>> explains how \n+to resolve this issue. For more background information, see the\n+{ecs-ref}/ecs-network.html[ECS network.direction field].\n+\n+[float]\n+[[filter-rule-process]]\n+=== Filter out uncommon application signals\n+\n+Organizations frequently use uncommon and in-house applications. Often, these ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTIwMjYwOnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1NDoxOVrOFrzfFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1NDoxOVrOFrzfFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3NjYyOA==", "bodyText": "I would say authorized security research  - it could be ongoing or intermittent, automated or manual.", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381476628", "createdAt": "2020-02-19T18:54:19Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, \n+network detection rules may produce noise. <<fix-network-rules>> explains how \n+to resolve this issue. For more background information, see the\n+{ecs-ref}/ecs-network.html[ECS network.direction field].\n+\n+[float]\n+[[filter-rule-process]]\n+=== Filter out uncommon application signals\n+\n+Organizations frequently use uncommon and in-house applications. Often, these \n+can trigger unwanted signals. To stop a rule matching on an application, you \n+need to modify the rule's logic so it ignores the application's name.\n+\n+For example, to prevent the <<unusual-process-execution-temp>> rule from\n+producing signals for an in-house application named `myautomatedbuild`:\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Search for the `Unusual Process Execution - Temp` rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Duplicate rule_\n++\n+A duplicate rule is created, named `Unusual Process Execution - Temp [Duplicate]`.\n+. Search for the new rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Edit rule settings_\n++\n+TIP: At the top of the *All rules* table, click `Custom rules` to display only \n+your rules.\n++\n+The *Edit rule settings* page is displayed.\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule.png[]\n+\n+. Do *one* of these:\n+* In the _Custom query_ field, add this condition:\n++\n+`and not process.name: \"myautomatedbuild\"`\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-query.png[]\n+* Click _Add filter_, and then define a `process.name is not myautomatedbuild` \n+condition.\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-filter.png[]\n+. Save the new rule and disable the original rule. If you want, you can delete \n+the original rule.\n+\n+[float]\n+[[tune-authorized-processes]]\n+=== Tune rules detecting authorized processes\n+\n+Authorized security testing, system tools, management frameworks, and\n+administrative activity may trigger detection rules. These legitimate \n+activities include:\n+\n+* Ongoing and automated security testing and research.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTIxMTYwOnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODo1NzowMlrOFrzk2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMzoxODo0N1rOFsS7vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODEwNQ==", "bodyText": "I would not discuss practices at Elastic because only InfoSec are probably authorized to make public statements about this.", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381478105", "createdAt": "2020-02-19T18:57:02Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, \n+network detection rules may produce noise. <<fix-network-rules>> explains how \n+to resolve this issue. For more background information, see the\n+{ecs-ref}/ecs-network.html[ECS network.direction field].\n+\n+[float]\n+[[filter-rule-process]]\n+=== Filter out uncommon application signals\n+\n+Organizations frequently use uncommon and in-house applications. Often, these \n+can trigger unwanted signals. To stop a rule matching on an application, you \n+need to modify the rule's logic so it ignores the application's name.\n+\n+For example, to prevent the <<unusual-process-execution-temp>> rule from\n+producing signals for an in-house application named `myautomatedbuild`:\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Search for the `Unusual Process Execution - Temp` rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Duplicate rule_\n++\n+A duplicate rule is created, named `Unusual Process Execution - Temp [Duplicate]`.\n+. Search for the new rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Edit rule settings_\n++\n+TIP: At the top of the *All rules* table, click `Custom rules` to display only \n+your rules.\n++\n+The *Edit rule settings* page is displayed.\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule.png[]\n+\n+. Do *one* of these:\n+* In the _Custom query_ field, add this condition:\n++\n+`and not process.name: \"myautomatedbuild\"`\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-query.png[]\n+* Click _Add filter_, and then define a `process.name is not myautomatedbuild` \n+condition.\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-filter.png[]\n+. Save the new rule and disable the original rule. If you want, you can delete \n+the original rule.\n+\n+[float]\n+[[tune-authorized-processes]]\n+=== Tune rules detecting authorized processes\n+\n+Authorized security testing, system tools, management frameworks, and\n+administrative activity may trigger detection rules. These legitimate \n+activities include:\n+\n+* Ongoing and automated security testing and research.\n+* System and software management processes running scripts, including scripts \n+that start child processes.\n+* Administrative and management frameworks that create users, schedule tasks, make `psexec` connections, and run WMI commands.\n+* Legitimate scripts using the `whoami` command.\n+* Applications that work with file shares, such as backup programs, and use the \n+server message block (SMB) protocol.\n+\n+To reduce signal noise for authorized activity, you can do any of the these:\n+\n+* Add a statement or filter to the rules that exclude specific servers, such as \n+the relevant host names, agent names, or other common identifier. \n+For example, `and not host.name : \"server-name\"`.\n+* Add a statement or filter to the rules that <<filter-rule-process, exclude specific processes>>. For example, `and not process.name : \"process-name\"`.\n+* Add a statement or filter to the rules that exclude a common user. \n+For example, `and not user.name : \"security-tester\"`.\n+\n+Another useful technique is to assign lower risk scores to rules triggered by \n+authorized activity. This enables detection while keeping the resulting signals \n+out of high-priority workflows. Use these steps:\n+\n+. Duplicate the same rule twice.\n+. In the first duplication of the rule, exclude the relevant user or process \n+names (`and not user.name : \"user-name\"` or `and not process.name : \"process-name\"`).\n+. In the second duplication of the rule:\n+* Lower the `Risk score` (*Edit rule settings* -> *About* tab).\n+* Change the rule's query or filter so it only matches the user or process \n+names excluded in the first duplication\n+(`and user.name : \"user-name\"` or `and process.name : \"process-name\"`).\n+. Disable the original rule.\n+\n+[float]\n+[[tune-windows-rules]]\n+=== Tune Windows child process and PowerShell rules\n+\n+Normal user activity may sometimes trigger one or more of these these rules:\n+\n+* <<powershell-spawning-cmd>>\n+* <<suspicious-ms-office-child-process>>\n+* <<suspicious-ms-outlook-child-process>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<system-shells-via-services>>\n+* <<unusual-parent-child-relationship>>\n+* <<windows-script-executing-powershell>>\n+ \n+While all rules can be adjusted as needed, use care when adding exceptions to \n+these rules. Exceptions could result in an undetected client side execution, or \n+a persistence or malware threat going unnoticed.\n+\n+Examples of when these rules may create noise include:\n+\n+* Receiving and opening email-attached Microsoft Office files, which \n+include active content such as macros or scripts, from a trusted third-party \n+source.\n+* Authorized technical support personnel who provide remote workers with\n+scripts to gather troubleshooting information.\n+\n+In these cases, exceptions can be added to the rules using the relevant \n+`process.name`, `user.name`, and `host.name` conditions. Additionally, \n+you can create duplicate rules with lower risk scores.\n+\n+[float]\n+[[tune-network-rules]]\n+=== Tune network rules\n+\n+The definition of normal network behavior varies widely across different\n+organizations, each network conforming to different security policies, \n+standards, and regulations. When normal network activity triggers signals, \n+network rules can be disabled or modified. For example:\n+\n+* To exclude a specific source, add a `not source.ip` statement with the \n+relevant IP address, and a `destination.port` statement with the relevant port \n+number (`not source.ip : 196.1.0.12 and destination.port : 445`).\n+* To exclude source network traffic for an entire subnet, add a `not source.ip` \n+statement with the relevant CIDR notation (`not source.ip : 192.168.0.0/16`).\n+* To exclude a destination IP for a specific destination port, add a\n+`not destination.ip` statement with the IP address, and a `destination.port` \n+statement with the port number\n+(`not destination.ip : 38.160.150.31 and destination.port : 445`)\n+* To exclude a destination subnet for a specific destination port, add a\n+`not destination.ip` statement using CIDR notation, and a \u2018destination.port\u2019 \n+statement with the port number\n+(`not destination.ip : 172.16.0.0/12 and destination.port : 445`).\n+\n+[float]\n+==== Noise from common network traffic\n+\n+These network rules may need tuning to reduce noise from legitimate network\n+activity:\n+\n+[horizontal]\n+<<dns-activity-to-the-internet>>:: Personal devices, brought to work or used while working remotely, can query arbitrary DNS servers.\n+<<ftp-file-transfer-protocol-activity-to-the-internet>>:: FTP is sometimes used with external sources.\n+<<smtp-to-the-internet>>:: Marketing and business workflows often \n+use SMTP email traffic. Additionally, personal devices, brought to work or used \n+while working remotely, may use consumer email services.\n+<<sql-traffic-to-the-internet>>:: Although uncommon, accessing databases over \n+the internet may be part of development workflows.\n+<<tcp-port-8000-activity-to-the-internet>>:: Frequently used port while \n+developing and testing web services.\n+\n+[float]\n+==== Noise from common cloud-based network traffic\n+\n+In cloud-based organizations, such as Elastic, remote workers access services ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 182}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk5MTg3MQ==", "bodyText": "I was waiting for a comment about that", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381991871", "createdAt": "2020-02-20T13:18:47Z", "author": {"login": "benskelker"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, \n+network detection rules may produce noise. <<fix-network-rules>> explains how \n+to resolve this issue. For more background information, see the\n+{ecs-ref}/ecs-network.html[ECS network.direction field].\n+\n+[float]\n+[[filter-rule-process]]\n+=== Filter out uncommon application signals\n+\n+Organizations frequently use uncommon and in-house applications. Often, these \n+can trigger unwanted signals. To stop a rule matching on an application, you \n+need to modify the rule's logic so it ignores the application's name.\n+\n+For example, to prevent the <<unusual-process-execution-temp>> rule from\n+producing signals for an in-house application named `myautomatedbuild`:\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Search for the `Unusual Process Execution - Temp` rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Duplicate rule_\n++\n+A duplicate rule is created, named `Unusual Process Execution - Temp [Duplicate]`.\n+. Search for the new rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Edit rule settings_\n++\n+TIP: At the top of the *All rules* table, click `Custom rules` to display only \n+your rules.\n++\n+The *Edit rule settings* page is displayed.\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule.png[]\n+\n+. Do *one* of these:\n+* In the _Custom query_ field, add this condition:\n++\n+`and not process.name: \"myautomatedbuild\"`\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-query.png[]\n+* Click _Add filter_, and then define a `process.name is not myautomatedbuild` \n+condition.\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-filter.png[]\n+. Save the new rule and disable the original rule. If you want, you can delete \n+the original rule.\n+\n+[float]\n+[[tune-authorized-processes]]\n+=== Tune rules detecting authorized processes\n+\n+Authorized security testing, system tools, management frameworks, and\n+administrative activity may trigger detection rules. These legitimate \n+activities include:\n+\n+* Ongoing and automated security testing and research.\n+* System and software management processes running scripts, including scripts \n+that start child processes.\n+* Administrative and management frameworks that create users, schedule tasks, make `psexec` connections, and run WMI commands.\n+* Legitimate scripts using the `whoami` command.\n+* Applications that work with file shares, such as backup programs, and use the \n+server message block (SMB) protocol.\n+\n+To reduce signal noise for authorized activity, you can do any of the these:\n+\n+* Add a statement or filter to the rules that exclude specific servers, such as \n+the relevant host names, agent names, or other common identifier. \n+For example, `and not host.name : \"server-name\"`.\n+* Add a statement or filter to the rules that <<filter-rule-process, exclude specific processes>>. For example, `and not process.name : \"process-name\"`.\n+* Add a statement or filter to the rules that exclude a common user. \n+For example, `and not user.name : \"security-tester\"`.\n+\n+Another useful technique is to assign lower risk scores to rules triggered by \n+authorized activity. This enables detection while keeping the resulting signals \n+out of high-priority workflows. Use these steps:\n+\n+. Duplicate the same rule twice.\n+. In the first duplication of the rule, exclude the relevant user or process \n+names (`and not user.name : \"user-name\"` or `and not process.name : \"process-name\"`).\n+. In the second duplication of the rule:\n+* Lower the `Risk score` (*Edit rule settings* -> *About* tab).\n+* Change the rule's query or filter so it only matches the user or process \n+names excluded in the first duplication\n+(`and user.name : \"user-name\"` or `and process.name : \"process-name\"`).\n+. Disable the original rule.\n+\n+[float]\n+[[tune-windows-rules]]\n+=== Tune Windows child process and PowerShell rules\n+\n+Normal user activity may sometimes trigger one or more of these these rules:\n+\n+* <<powershell-spawning-cmd>>\n+* <<suspicious-ms-office-child-process>>\n+* <<suspicious-ms-outlook-child-process>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<system-shells-via-services>>\n+* <<unusual-parent-child-relationship>>\n+* <<windows-script-executing-powershell>>\n+ \n+While all rules can be adjusted as needed, use care when adding exceptions to \n+these rules. Exceptions could result in an undetected client side execution, or \n+a persistence or malware threat going unnoticed.\n+\n+Examples of when these rules may create noise include:\n+\n+* Receiving and opening email-attached Microsoft Office files, which \n+include active content such as macros or scripts, from a trusted third-party \n+source.\n+* Authorized technical support personnel who provide remote workers with\n+scripts to gather troubleshooting information.\n+\n+In these cases, exceptions can be added to the rules using the relevant \n+`process.name`, `user.name`, and `host.name` conditions. Additionally, \n+you can create duplicate rules with lower risk scores.\n+\n+[float]\n+[[tune-network-rules]]\n+=== Tune network rules\n+\n+The definition of normal network behavior varies widely across different\n+organizations, each network conforming to different security policies, \n+standards, and regulations. When normal network activity triggers signals, \n+network rules can be disabled or modified. For example:\n+\n+* To exclude a specific source, add a `not source.ip` statement with the \n+relevant IP address, and a `destination.port` statement with the relevant port \n+number (`not source.ip : 196.1.0.12 and destination.port : 445`).\n+* To exclude source network traffic for an entire subnet, add a `not source.ip` \n+statement with the relevant CIDR notation (`not source.ip : 192.168.0.0/16`).\n+* To exclude a destination IP for a specific destination port, add a\n+`not destination.ip` statement with the IP address, and a `destination.port` \n+statement with the port number\n+(`not destination.ip : 38.160.150.31 and destination.port : 445`)\n+* To exclude a destination subnet for a specific destination port, add a\n+`not destination.ip` statement using CIDR notation, and a \u2018destination.port\u2019 \n+statement with the port number\n+(`not destination.ip : 172.16.0.0/12 and destination.port : 445`).\n+\n+[float]\n+==== Noise from common network traffic\n+\n+These network rules may need tuning to reduce noise from legitimate network\n+activity:\n+\n+[horizontal]\n+<<dns-activity-to-the-internet>>:: Personal devices, brought to work or used while working remotely, can query arbitrary DNS servers.\n+<<ftp-file-transfer-protocol-activity-to-the-internet>>:: FTP is sometimes used with external sources.\n+<<smtp-to-the-internet>>:: Marketing and business workflows often \n+use SMTP email traffic. Additionally, personal devices, brought to work or used \n+while working remotely, may use consumer email services.\n+<<sql-traffic-to-the-internet>>:: Although uncommon, accessing databases over \n+the internet may be part of development workflows.\n+<<tcp-port-8000-activity-to-the-internet>>:: Frequently used port while \n+developing and testing web services.\n+\n+[float]\n+==== Noise from common cloud-based network traffic\n+\n+In cloud-based organizations, such as Elastic, remote workers access services ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ3ODEwNQ=="}, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 182}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MTMzMzk5OnYy", "diffSide": "RIGHT", "path": "docs/en/siem/tune-rule-signals.asciidoc", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxOTozNDoyMlrOFr0zzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxOTozNDoyMlrOFr0zzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ5ODMxOA==", "bodyText": "let's say \"can be modified\" ? May not be necessary to modify them all & I don't want to scare people by making it look like a mess of work", "url": "https://github.com/elastic/stack-docs/pull/874#discussion_r381498318", "createdAt": "2020-02-19T19:34:22Z", "author": {"login": "randomuserid"}, "path": "docs/en/siem/tune-rule-signals.asciidoc", "diffHunk": "@@ -0,0 +1,230 @@\n+[[tuning-detection-signals]]\n+== Tuning detection rules\n+\n+In the {siem-app}, detection rules can be tuned to produce the best possible \n+set of actionable signals. To reduce the noise level, you can:\n+\n+* Disable detection rules when they match expected behavior, workflows, and \n+allowed policies, and when they rarely produce actionable signals.\n+* <<manage-rules-ui, Clone and modify>> detection rule queries so they ignore \n+authorized policies and workflows, thereby reducing the noise level while still \n+retaining actionable signals.\n+* Clone and modify detection rule risk scores, and use branching logic to map \n+higher risk scores to higher priority workflows.\n+\n+For details about tuning rules for specific categories, see:\n+\n+* <<tune-authorized-processes>>\n+* <<tune-windows-rules>>\n+* <<tune-network-rules>>\n+\n+IMPORTANT: Due to the different way {beats} record network traffic direction, \n+network detection rules may produce noise. <<fix-network-rules>> explains how \n+to resolve this issue. For more background information, see the\n+{ecs-ref}/ecs-network.html[ECS network.direction field].\n+\n+[float]\n+[[filter-rule-process]]\n+=== Filter out uncommon application signals\n+\n+Organizations frequently use uncommon and in-house applications. Often, these \n+can trigger unwanted signals. To stop a rule matching on an application, you \n+need to modify the rule's logic so it ignores the application's name.\n+\n+For example, to prevent the <<unusual-process-execution-temp>> rule from\n+producing signals for an in-house application named `myautomatedbuild`:\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Search for the `Unusual Process Execution - Temp` rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Duplicate rule_\n++\n+A duplicate rule is created, named `Unusual Process Execution - Temp [Duplicate]`.\n+. Search for the new rule, and then:\n+.. Click the actions icon on the rule's row (three dots).\n+.. Select _Edit rule settings_\n++\n+TIP: At the top of the *All rules* table, click `Custom rules` to display only \n+your rules.\n++\n+The *Edit rule settings* page is displayed.\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule.png[]\n+\n+. Do *one* of these:\n+* In the _Custom query_ field, add this condition:\n++\n+`and not process.name: \"myautomatedbuild\"`\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-query.png[]\n+* Click _Add filter_, and then define a `process.name is not myautomatedbuild` \n+condition.\n++\n+[role=\"screenshot\"]\n+image::images/edit-dect-rule-filter.png[]\n+. Save the new rule and disable the original rule. If you want, you can delete \n+the original rule.\n+\n+[float]\n+[[tune-authorized-processes]]\n+=== Tune rules detecting authorized processes\n+\n+Authorized security testing, system tools, management frameworks, and\n+administrative activity may trigger detection rules. These legitimate \n+activities include:\n+\n+* Ongoing and automated security testing and research.\n+* System and software management processes running scripts, including scripts \n+that start child processes.\n+* Administrative and management frameworks that create users, schedule tasks, make `psexec` connections, and run WMI commands.\n+* Legitimate scripts using the `whoami` command.\n+* Applications that work with file shares, such as backup programs, and use the \n+server message block (SMB) protocol.\n+\n+To reduce signal noise for authorized activity, you can do any of the these:\n+\n+* Add a statement or filter to the rules that exclude specific servers, such as \n+the relevant host names, agent names, or other common identifier. \n+For example, `and not host.name : \"server-name\"`.\n+* Add a statement or filter to the rules that <<filter-rule-process, exclude specific processes>>. For example, `and not process.name : \"process-name\"`.\n+* Add a statement or filter to the rules that exclude a common user. \n+For example, `and not user.name : \"security-tester\"`.\n+\n+Another useful technique is to assign lower risk scores to rules triggered by \n+authorized activity. This enables detection while keeping the resulting signals \n+out of high-priority workflows. Use these steps:\n+\n+. Duplicate the same rule twice.\n+. In the first duplication of the rule, exclude the relevant user or process \n+names (`and not user.name : \"user-name\"` or `and not process.name : \"process-name\"`).\n+. In the second duplication of the rule:\n+* Lower the `Risk score` (*Edit rule settings* -> *About* tab).\n+* Change the rule's query or filter so it only matches the user or process \n+names excluded in the first duplication\n+(`and user.name : \"user-name\"` or `and process.name : \"process-name\"`).\n+. Disable the original rule.\n+\n+[float]\n+[[tune-windows-rules]]\n+=== Tune Windows child process and PowerShell rules\n+\n+Normal user activity may sometimes trigger one or more of these these rules:\n+\n+* <<powershell-spawning-cmd>>\n+* <<suspicious-ms-office-child-process>>\n+* <<suspicious-ms-outlook-child-process>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<suspicious-process-spawning-from-script-interpreter>>\n+* <<system-shells-via-services>>\n+* <<unusual-parent-child-relationship>>\n+* <<windows-script-executing-powershell>>\n+ \n+While all rules can be adjusted as needed, use care when adding exceptions to \n+these rules. Exceptions could result in an undetected client side execution, or \n+a persistence or malware threat going unnoticed.\n+\n+Examples of when these rules may create noise include:\n+\n+* Receiving and opening email-attached Microsoft Office files, which \n+include active content such as macros or scripts, from a trusted third-party \n+source.\n+* Authorized technical support personnel who provide remote workers with\n+scripts to gather troubleshooting information.\n+\n+In these cases, exceptions can be added to the rules using the relevant \n+`process.name`, `user.name`, and `host.name` conditions. Additionally, \n+you can create duplicate rules with lower risk scores.\n+\n+[float]\n+[[tune-network-rules]]\n+=== Tune network rules\n+\n+The definition of normal network behavior varies widely across different\n+organizations, each network conforming to different security policies, \n+standards, and regulations. When normal network activity triggers signals, \n+network rules can be disabled or modified. For example:\n+\n+* To exclude a specific source, add a `not source.ip` statement with the \n+relevant IP address, and a `destination.port` statement with the relevant port \n+number (`not source.ip : 196.1.0.12 and destination.port : 445`).\n+* To exclude source network traffic for an entire subnet, add a `not source.ip` \n+statement with the relevant CIDR notation (`not source.ip : 192.168.0.0/16`).\n+* To exclude a destination IP for a specific destination port, add a\n+`not destination.ip` statement with the IP address, and a `destination.port` \n+statement with the port number\n+(`not destination.ip : 38.160.150.31 and destination.port : 445`)\n+* To exclude a destination subnet for a specific destination port, add a\n+`not destination.ip` statement using CIDR notation, and a \u2018destination.port\u2019 \n+statement with the port number\n+(`not destination.ip : 172.16.0.0/12 and destination.port : 445`).\n+\n+[float]\n+==== Noise from common network traffic\n+\n+These network rules may need tuning to reduce noise from legitimate network\n+activity:\n+\n+[horizontal]\n+<<dns-activity-to-the-internet>>:: Personal devices, brought to work or used while working remotely, can query arbitrary DNS servers.\n+<<ftp-file-transfer-protocol-activity-to-the-internet>>:: FTP is sometimes used with external sources.\n+<<smtp-to-the-internet>>:: Marketing and business workflows often \n+use SMTP email traffic. Additionally, personal devices, brought to work or used \n+while working remotely, may use consumer email services.\n+<<sql-traffic-to-the-internet>>:: Although uncommon, accessing databases over \n+the internet may be part of development workflows.\n+<<tcp-port-8000-activity-to-the-internet>>:: Frequently used port while \n+developing and testing web services.\n+\n+[float]\n+==== Noise from common cloud-based network traffic\n+\n+In cloud-based organizations, such as Elastic, remote workers access services \n+over the internet. The security policies of home networks probably differ from \n+the security policies of managed corporate networks, and these rules might need \n+tuning to reduce noise from legitimate administrative activities: \n+\n+* <<rdp-remote-desktop-protocol-from-the-internet>>\n+* <<ssh-secure-shell-from-the-internet>>\n+* <<ssh-secure-shell-to-the-internet>>\n+\n+TIP: If your organization is widely distributed and the workforce travels a \n+lot, use the `windows_anomalous_user_name_ecs`, \n+`linux_anomalous_user_name_ecs`, and `suspicious_login_activity_ecs`\n+<<machine-learning, {ml}>> jobs to detect suspicious authentication activity.\n+\n+[float]\n+[[fix-network-rules]]\n+=== Reduce noise for network rules\n+\n+To reduce noise for network rules, duplicate the network rules and *either*:\n+\n+* Remove all rule index patterns, except for the `filebeat-*` index pattern.\n+* Remove the `network.direction: outbound` statement from the query. The rule\n+then relies on CIDR notation to match traffic direction. The CIDR matches \n+(`source.ip` and `destination.ip`) can be changed to match your network's \n+configuration.\n+\n+The following rules should be modified:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e75d16b13b5f2f5fcfaf4144869d1b16c1482b"}, "originalPosition": 208}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1238, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}