{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1MDk5NjU3", "number": 1504, "title": "[DOCS] Adds security_linux and security_windows modules", "bodyText": "Related to elastic/kibana#85065\nThis PR adds documentation for the new modules in https://www.elastic.co/guide/en/machine-learning/master/ootb-ml-jobs-siem.html, based on the details in https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux and https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows and the existing job descriptions.\nPreview\n\nhttps://stack-docs_1504.docs-preview.app.elstc.co/guide/en/machine-learning/master/ootb-ml-jobs-siem.html#security-linux-jobs\nhttps://stack-docs_1504.docs-preview.app.elstc.co/guide/en/machine-learning/master/ootb-ml-jobs-siem.html#security-windows-jobs", "createdAt": "2020-12-24T01:57:36Z", "url": "https://github.com/elastic/stack-docs/pull/1504", "merged": true, "mergeCommit": {"oid": "2362efa0b9f40b0625d74e3f23c8017d06f05abc"}, "closed": true, "closedAt": "2021-02-09T21:53:06Z", "author": {"login": "lcawl"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABd0tuA0gH2gAyNTQ1MDk5NjU3OmRkOGU1ZDgwZTAyYjFlZDg3YjU1Y2ZmM2VhOWNiMTJlZGQ5YjE2NWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd4i-XOgFqTU4NzAzNzUzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dd8e5d80e02b1ed87b55cff3ea9cb12edd9b165f", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/dd8e5d80e02b1ed87b55cff3ea9cb12edd9b165f", "committedDate": "2021-01-28T23:57:17Z", "message": "[DOCS] Adds new linux and windows security modules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f9aa12075920882952921c5590b8d69e29e3515", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/5f9aa12075920882952921c5590b8d69e29e3515", "committedDate": "2021-01-29T01:43:59Z", "message": "[DOCS] Add version admonition"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b228228e01901e9a2965689ae682190da2120544", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/b228228e01901e9a2965689ae682190da2120544", "committedDate": "2020-12-24T01:50:57Z", "message": "[DOCS] Adds new linux and windows security modules"}, "afterCommit": {"oid": "5f9aa12075920882952921c5590b8d69e29e3515", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/5f9aa12075920882952921c5590b8d69e29e3515", "committedDate": "2021-01-29T01:43:59Z", "message": "[DOCS] Add version admonition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ea2fb8d21fccb68447fde7c88fef36a65baf1d2", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/5ea2fb8d21fccb68447fde7c88fef36a65baf1d2", "committedDate": "2021-01-29T18:33:53Z", "message": "[DOCS] Adds missing mentions of Elastic Agent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fb3594adef936029c72c0b25d284b92bcdf5d68", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/1fb3594adef936029c72c0b25d284b92bcdf5d68", "committedDate": "2021-01-30T01:31:51Z", "message": "[DOCS] Add event 4688 details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/25cff6147c1b85ea003c73afcc38e5b15f39ef22", "committedDate": "2021-02-03T00:41:40Z", "message": "[DOCS] Add footnotes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9cd88f81843bc8e2f94fc62b8fd03e337150b1b1", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/9cd88f81843bc8e2f94fc62b8fd03e337150b1b1", "committedDate": "2021-02-03T00:24:50Z", "message": "[DOCS] Add footnotes"}, "afterCommit": {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/25cff6147c1b85ea003c73afcc38e5b15f39ef22", "committedDate": "2021-02-03T00:41:40Z", "message": "[DOCS] Add footnotes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgyMzIxNDUx", "url": "https://github.com/elastic/stack-docs/pull/1504#pullrequestreview-582321451", "createdAt": "2021-02-03T12:42:38Z", "commit": {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wM1QxMjo0MjozOFrOIfAWzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wM1QxMjo0MjozOFrOIfAWzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTM4MjYwNQ==", "bodyText": "It's very probable that it's just me, but I'm not sure I understand why the second sentence is important for me as a user. Or what other test options exist other than the two that are listed. Should I be aware that there might be certain cases that are not tested?", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r569382605", "createdAt": "2021-02-03T12:42:38Z", "author": {"login": "szabosteve"}, "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -638,9 +649,217 @@ Required ECS fields when not using {beats}:::\n \n // end::security-cloudtrail-jobs[]\n \n+[discrete]\n+[[security-linux-jobs]]\n+== Security: Linux\n+\n+Detect suspicious activity using ECS Linux events. Tested with {auditbeat} and {agent}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22"}, "originalPosition": 301}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74a85630ff7c05eb0edd35684c352f2a8c8bd8c5", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/74a85630ff7c05eb0edd35684c352f2a8c8bd8c5", "committedDate": "2021-02-03T20:45:02Z", "message": "[DOCS] Addresses feedback about testing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2NDQ0OTUw", "url": "https://github.com/elastic/stack-docs/pull/1504#pullrequestreview-566444950", "createdAt": "2021-01-12T16:24:00Z", "commit": {"oid": "b228228e01901e9a2965689ae682190da2120544"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxNjoyNDowMFrOISJkkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMlQxODo0OTo1OFrOISPcsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTkwMjA5Ng==", "bodyText": "this is the module query that is present in all jobs. I think this can be stated once at the beginning of the section.", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555902096", "createdAt": "2021-01-12T16:24:00Z", "author": {"login": "randomuserid"}, "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -638,9 +637,191 @@ Required ECS fields when not using {beats}:::\n \n // end::security-cloudtrail-jobs[]\n \n+[discrete]\n+[[security-linux-jobs]]\n+== Security: Linux\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/manifest.json#L8[manifest file].\n+\n+Detect suspicious activity using ECS Linux events. Tested with {auditbeat} and {agent}.\n+\n+// tag::security-linux-jobs[]\n+v2_linux_anomalous_network_port_activity_ecs::\n+\n+Identifies unusual destination port activity that can indicate\n+command-and-control, persistence mechanism, or data exfiltration activity.\n++\n+Rarely used destination port activity is generally unusual in Linux fleets, and \n+can indicate unauthorized access or threat actor activity.\n+\n+Job details:::\n+\n+* Analyzes network activity logs where `host.os.type` is `linux` or ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b228228e01901e9a2965689ae682190da2120544"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTkwMzQ0Mw==", "bodyText": "this query is also used across the entire module and could be stated once in the beginning of the section?", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555903443", "createdAt": "2021-01-12T16:25:50Z", "author": {"login": "randomuserid"}, "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -816,9 +997,259 @@ Required ECS fields when not using {beats}:::\n \n // end::siem-packetbeat-jobs[]\n \n+[discrete]\n+[[security-windows-jobs]]\n+== Security: Windows\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json#L8[manifest file].\n+\n+Detects suspicious activity using ECS Windows events. Tested with {winlogbeat} \n+and {agent}.\n+\n+// tag::security-windows-jobs[]\n+v2_rare_process_by_host_windows_ecs::\n+\n+Detects unusually rare processes on Windows hosts, which can indicate execution \n+of unauthorized services, malware, or persistence mechanisms.\n++\n+Processes are considered rare when they only run occasionally as compared with\n+other processes running on the host.\n+\n+Job details:::\n+\n+* Analyzes host activity logs where `host.os.family` or `host.os.type` is ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b228228e01901e9a2965689ae682190da2120544"}, "originalPosition": 262}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk5ODM4Ng==", "bodyText": "we need to note this job is Sysmon-only at the moment. It will work with Endpoint events when the required field is added. ref: elastic/endpoint-dev#8112", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555998386", "createdAt": "2021-01-12T18:49:58Z", "author": {"login": "randomuserid"}, "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -816,9 +997,259 @@ Required ECS fields when not using {beats}:::\n \n // end::siem-packetbeat-jobs[]\n \n+[discrete]\n+[[security-windows-jobs]]\n+== Security: Windows\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json#L8[manifest file].\n+\n+Detects suspicious activity using ECS Windows events. Tested with {winlogbeat} \n+and {agent}.\n+\n+// tag::security-windows-jobs[]\n+v2_rare_process_by_host_windows_ecs::\n+\n+Detects unusually rare processes on Windows hosts, which can indicate execution \n+of unauthorized services, malware, or persistence mechanisms.\n++\n+Processes are considered rare when they only run occasionally as compared with\n+other processes running on the host.\n+\n+Job details:::\n+\n+* Analyzes host activity logs where `host.os.family` or `host.os.type` is \n+`windows`.\n+* Models occurrences of process activities on the host. \n+* Detects unusually rare processes compared to other processes on the host \n+(using the\n+{ml-docs}/ml-rare-functions.html#ml-rare[`rare` function]).\n+* Works on ECS compatible events across multiple indices.\n+\n+Required ECS fields:::\n+\n+* `event.category`\n+* `event.type`\n+* `host.name`\n+* `host.os.family`\n+* `host.os.type`\n+* `process.name`\n+* `user.name`\n+\n+v2_windows_anomalous_network_activity_ecs::\n+\n+Looks for unusual processes using the network which could indicate command-and-\n+control, lateral movement, persistence, or data exfiltration activity.\n++\n+A process with unusual network activity can denote process exploitation or\n+injection, where the process is used to run persistence mechanisms that allow a\n+malicious actor remote access or control of the host, data exfiltration, and\n+execution of unauthorized network applications.\n+\n+Job details:::\n+\n+* Analyzes network activity logs where `host.os.family` is `windows`.\n+* Models the occurrences of processes that cause network activity.\n+* Detects network activity caused by processes that occur rarely compared to \n+other processes (using the\n+{ml-docs}/ml-rare-functions.html#ml-rare[`rare` function]).\n+* Works on ECS compatible events across multiple indices.\n+\n+Required ECS fields:::\n+\n+* `destination.ip`\n+* `event.category`\n+* `event.type`\n+* `host.name`\n+* `host.os.family`\n+* `host.os.type`\n+* `process.name`\n+* `user.name`\n+\n+v2_windows_anomalous_path_activity_ecs::", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b228228e01901e9a2965689ae682190da2120544"}, "originalPosition": 310}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21f8e02c8599c1f3726be34f63908cb7f6f5feca", "author": {"user": {"login": "lcawl", "name": "Lisa Cawley"}}, "url": "https://github.com/elastic/stack-docs/commit/21f8e02c8599c1f3726be34f63908cb7f6f5feca", "committedDate": "2021-02-08T22:05:10Z", "message": "[DOCS] Move duplicated datafeed details"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg3MDM3NTM4", "url": "https://github.com/elastic/stack-docs/pull/1504#pullrequestreview-587037538", "createdAt": "2021-02-09T21:41:53Z", "commit": {"oid": "21f8e02c8599c1f3726be34f63908cb7f6f5feca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4600, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}