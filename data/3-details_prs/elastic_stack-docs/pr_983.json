{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMzIzNjg3", "number": 983, "title": "[Docs][SIEM]Rules API ml rule type", "bodyText": "Updates the rules API docs for creating ml rules.\nPreview", "createdAt": "2020-04-07T15:01:21Z", "url": "https://github.com/elastic/stack-docs/pull/983", "merged": true, "mergeCommit": {"oid": "cdadd1dcb137e2d34b4b3a9b6c721538452890e7"}, "closed": true, "closedAt": "2020-04-09T08:12:50Z", "author": {"login": "benskelker"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVUnRGgH2gAyNDAwMzIzNjg3OjJlMTg1ZTU5ZDUzZGRiZWI5ZjliZTRjOTBmOTkxNWQ2YmM5MmQ5ZmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV3t8NgH2gAyNDAwMzIzNjg3OmM3YzI2OTA1OTFkMzA2OTM2NzFiYzY1ODhiYzUyYjdlMjg5ZjZhOGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e185e59d53ddbeb9f9be4c90f9915d6bc92d9fa", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/2e185e59d53ddbeb9f9be4c90f9915d6bc92d9fa", "committedDate": "2020-04-07T14:59:29Z", "message": "adds ml rule type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20cf70c0d78f11dae9b0c3f9fd6f4c00e423948e", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/20cf70c0d78f11dae9b0c3f9fd6f4c00e423948e", "committedDate": "2020-04-07T15:44:25Z", "message": "update rules api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20fcfd379a28076cd13e0c0f39b626d7037dd8a0", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/20fcfd379a28076cd13e0c0f39b626d7037dd8a0", "committedDate": "2020-04-07T16:26:01Z", "message": "finishes action placeholders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "670411c0bea2d9b795c20346bd2d141dc573e4c3", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/670411c0bea2d9b795c20346bd2d141dc573e4c3", "committedDate": "2020-04-07T16:41:02Z", "message": "typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/ac700565fa5bcb219ec04efb23a70f44099881b5", "committedDate": "2020-04-07T17:06:44Z", "message": "response correction"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTExNzE0", "url": "https://github.com/elastic/stack-docs/pull/983#pullrequestreview-389511714", "createdAt": "2020-04-07T21:42:28Z", "commit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTo0MjoyOFrOGCXOiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTo0MjoyOFrOGCXOiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzMDg4OQ==", "bodyText": "Nice! Thanks for providing a reference to the ML API here \ud83d\ude42", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405130889", "createdAt": "2020-04-07T21:42:28Z", "author": {"login": "spong"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -3,6 +3,43 @@\n \n Creates a new signal detection rule.\n \n+You can create two types of rules:\n+\n+* Query-based rules, which search the defined indices and creates a signal when\n+a document matches the rule's query.\n+* {ml-cap} rules, which create a signal when a {ml} job discovers an anomaly above the defined threshold (see <<machine-learning>>).\n+\n+IMPORTANT: You can only create {ml} jobs when you have a\n+https://www.elastic.co/subscriptions[Platinum License], are using a\n+{ess-trial}[Cloud] deployment, or are testing out a *Free Trial*. Additionally,\n+for the {ml} rule to function, the associated {ml} job must be running.\n+\n+To retrieve {ml} job IDs, which are required to create {ml} jobs, call the\n+{ref}/ml-get-job.html[{es} Get jobs API].", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTMzMzgy", "url": "https://github.com/elastic/stack-docs/pull/983#pullrequestreview-389533382", "createdAt": "2020-04-07T22:25:55Z", "commit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjoyNTo1NVrOGCYXGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjoyNTo1NVrOGCYXGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0OTQ2Nw==", "bodyText": "Not sure if it makes sense to capture this here, but just want to mention that certain fields are forbidden depending on the rule type. For instance, for type: \"machine_learning\", noth query and language fields are forbidden. It may be a little hard to read, but explicit details are in the create_rules_schema if necessary.", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405149467", "createdAt": "2020-04-07T22:25:55Z", "author": {"login": "spong"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -41,19 +84,21 @@ time).\n is converted from a third-party security solution. |No, automatically created \n when it is not provided.\n \n-|index |String[] |Indices on which the rule functions. |No, defaults to the \n-{siem-soln} indices defined on the {kib} Advanced Settings page (*Kibana* \u2192 \n-*Management* \u2192 *Advanced Settings* \u2192 `siem:defaultIndex`).\n+|index |String[] |Indices on which the rule functions. |No, for query rules,\n+defaults to the {siem-soln} indices defined on the {kib} Advanced Settings page\n+(*Kibana* \u2192 *Management* \u2192 *Advanced Settings* \u2192 `siem:defaultIndex`).\n \n |interval |String |Frequency of rule execution, using a\n {ref}/common-options.html#date-math[date math range]. For example, `\"1h\"` \n means the rule runs every hour. |No, defaults to `5m` (5 minutes).\n \n+|machine_learning_job_id |String |{ml} job ID of the job for which you want to generate signals. |Yes, for {ml} rules.\n+\n |query |String |{kibana-ref}/search.html[Query] used by the rule to create a \n-signal. |No, defaults to an empty string.\n+signal. |No, for query rules, defaults to an empty string.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTM0OTMy", "url": "https://github.com/elastic/stack-docs/pull/983#pullrequestreview-389534932", "createdAt": "2020-04-07T22:29:23Z", "commit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTk3MTk2", "url": "https://github.com/elastic/stack-docs/pull/983#pullrequestreview-389597196", "createdAt": "2020-04-08T01:32:48Z", "commit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "state": "APPROVED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMTozMjo0OFrOGCb6xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMjowNDoyOFrOGCcbYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIwNzc1MQ==", "bodyText": "function is a bit ambiguous here (which I realize may be intentional!), so I'll over-explain the behavior:\nIf the associated job is not running, the rule will (barring any other exceptions):\n\ncomplete (i.e. it will perform a query for anomalies, and exit)\npotentially generate signals (if anomalies were found above)\nhave an error (indicating that the job was not running during execution)", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405207751", "createdAt": "2020-04-08T01:32:48Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -3,6 +3,43 @@\n \n Creates a new signal detection rule.\n \n+You can create two types of rules:\n+\n+* Query-based rules, which search the defined indices and creates a signal when\n+a document matches the rule's query.\n+* {ml-cap} rules, which create a signal when a {ml} job discovers an anomaly above the defined threshold (see <<machine-learning>>).\n+\n+IMPORTANT: You can only create {ml} jobs when you have a\n+https://www.elastic.co/subscriptions[Platinum License], are using a\n+{ess-trial}[Cloud] deployment, or are testing out a *Free Trial*. Additionally,\n+for the {ml} rule to function, the associated {ml} job must be running.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIwODkxNQ==", "bodyText": "We may want a caveat here about the \"siem\" group/tag. Although there's nothing currently preventing API users from creating rules against non-siem jobs, once we tighten our ML integration and implement our auto-installation/starting of jobs we'll want to ensure that we're only doing so for jobs in the siem group.", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405208915", "createdAt": "2020-04-08T01:37:16Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -3,6 +3,43 @@\n \n Creates a new signal detection rule.\n \n+You can create two types of rules:\n+\n+* Query-based rules, which search the defined indices and creates a signal when\n+a document matches the rule's query.\n+* {ml-cap} rules, which create a signal when a {ml} job discovers an anomaly above the defined threshold (see <<machine-learning>>).\n+\n+IMPORTANT: You can only create {ml} jobs when you have a\n+https://www.elastic.co/subscriptions[Platinum License], are using a\n+{ess-trial}[Cloud] deployment, or are testing out a *Free Trial*. Additionally,\n+for the {ml} rule to function, the associated {ml} job must be running.\n+\n+To retrieve {ml} job IDs, which are required to create {ml} jobs, call the\n+{ref}/ml-get-job.html[{es} Get jobs API].", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzMDg4OQ=="}, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIwOTY5OQ==", "bodyText": "article/noun disagreement here", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405209699", "createdAt": "2020-04-08T01:40:26Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -3,6 +3,43 @@\n \n Creates a new signal detection rule.\n \n+You can create two types of rules:\n+\n+* Query-based rules, which search the defined indices and creates a signal when\n+a document matches the rule's query.\n+* {ml-cap} rules, which create a signal when a {ml} job discovers an anomaly above the defined threshold (see <<machine-learning>>).\n+\n+IMPORTANT: You can only create {ml} jobs when you have a\n+https://www.elastic.co/subscriptions[Platinum License], are using a\n+{ess-trial}[Cloud] deployment, or are testing out a *Free Trial*. Additionally,\n+for the {ml} rule to function, the associated {ml} job must be running.\n+\n+To retrieve {ml} job IDs, which are required to create {ml} jobs, call the\n+{ref}/ml-get-job.html[{es} Get jobs API].\n+\n+Additionally, you can set up notification when a rule creates a signal. The", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMDA4Mw==", "bodyText": "Integer between 0 and 100 inclusive, if that matters.", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405210083", "createdAt": "2020-04-08T01:42:08Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -15,6 +52,12 @@ A JSON object with these fields:\n |==============================================\n |Name |Type |Description |Required\n \n+|actions |<<actions-object-schema, actions[]>> |Array defining the automated\n+actions (notifications) taken signals are produced. |No\n+\n+|anomaly_threshold |Integer |Anomaly threshold above which signals are", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMDc2OA==", "bodyText": "These are somewhat discoverable through the 400 responses we'll generate (you can google the Joi message if you're not familiar), but saving the user a step here would probably be appreciated \ud83d\udc4d", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405210768", "createdAt": "2020-04-08T01:44:45Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -41,19 +84,21 @@ time).\n is converted from a third-party security solution. |No, automatically created \n when it is not provided.\n \n-|index |String[] |Indices on which the rule functions. |No, defaults to the \n-{siem-soln} indices defined on the {kib} Advanced Settings page (*Kibana* \u2192 \n-*Management* \u2192 *Advanced Settings* \u2192 `siem:defaultIndex`).\n+|index |String[] |Indices on which the rule functions. |No, for query rules,\n+defaults to the {siem-soln} indices defined on the {kib} Advanced Settings page\n+(*Kibana* \u2192 *Management* \u2192 *Advanced Settings* \u2192 `siem:defaultIndex`).\n \n |interval |String |Frequency of rule execution, using a\n {ref}/common-options.html#date-math[date math range]. For example, `\"1h\"` \n means the rule runs every hour. |No, defaults to `5m` (5 minutes).\n \n+|machine_learning_job_id |String |{ml} job ID of the job for which you want to generate signals. |Yes, for {ml} rules.\n+\n |query |String |{kibana-ref}/search.html[Query] used by the rule to create a \n-signal. |No, defaults to an empty string.\n+signal. |No, for query rules, defaults to an empty string.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0OTQ2Nw=="}, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMTMxNg==", "bodyText": "My own curiosity: why do some of these fields have |String | and others have |String a| ? Why do they appear identical in the preview?", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405211316", "createdAt": "2020-04-08T01:46:49Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -94,14 +141,25 @@ occurred\n |tags |String[] |String array containing words and phrases to help categorize,\n filter, and search rules. |No, defaults to an empty array.\n \n+|throttle |String a|Determines how often actions are taken:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMTc0OQ==", "bodyText": "\ud83d\udc4f great example!", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405211749", "createdAt": "2020-04-08T01:48:22Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -196,26 +340,88 @@ POST api/detection_engine/rules\n If the rule starts to run at 15:00, it analyzes data from 13:50 until 15:00. \n When it runs next, at 16:00, it will analyze data from 14:50 until 16:00.\n \n+{ml-cap} rule that creates signals, and sends Slack notification, when the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 237}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMjE3OQ==", "bodyText": "@FrankHassanabad what's the status of output index? Are we still supporting this in 7.7?", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405212179", "createdAt": "2020-04-08T01:49:55Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -196,26 +340,88 @@ POST api/detection_engine/rules\n If the rule starts to run at 15:00, it analyzes data from 13:50 until 15:00. \n When it runs next, at 16:00, it will analyze data from 14:50 until 16:00.\n \n+{ml-cap} rule that creates signals, and sends Slack notification, when the\n+`linux_anomalous_network_activity_ecs` {ml} job discovers anomalies with a\n+threshold of 70 or above:\n+\n+[source,console]\n+--------------------------------------------------\n+POST api/detection_engine/rules\n+{\n+  \"anomaly_threshold\": 70,\n+  \"rule_id\": \"ml_linux_network_high_threshold\",\n+  \"risk_score\": 70,\n+  \"machine_learning_job_id\": \"linux_anomalous_network_activity_ecs\",\n+  \"description\": \"Generates signals when the job discovers anomalies over 70\",\n+  \"interval\": \"5m\",\n+  \"name\": \"Anomalous Linux network activity\",\n+  \"note\": \"Shut down the internet.\",\n+  \"severity\": \"high\",\n+  \"tags\": [\n+   \"machine learning\",\n+   \"Linux\"\n+   ],\n+  \"type\": \"machine_learning\",\n+  \"from\": \"now-6m\",\n+  \"enabled\": true,\n+  \"throttle\": \"rule\",\n+  \"actions\": [\n+    {\n+      \"action_type_id\": \".slack\",\n+      \"group\": \"default\",\n+      \"id\": \"5ad22cd5-5e6e-4c6c-a81a-54b626a4cec5\",\n+      \"params\": {\n+        \"message\": \"Urgent: {{context.rule.description}}\"\n+      }\n+    }\n+  ]\n+}\n+--------------------------------------------------\n+// KIBANA\n+\n ==== Response code\n \n `200`:: \n     Indicates a successful call.\n     \n ==== Response payload\n \n-A JSON object that includes a unique ID, the time the rule was created, and its version number. If the request payload did not include a `rule_id` field, a unique rule ID is also generated.\n+A JSON object that includes a unique ID, the time the rule was created, and its\n+version number. If the request payload did not include a `rule_id` field, a\n+unique rule ID is also generated.\n \n-Example response:\n+Example response for a query-based rule:\n \n [source,json]\n --------------------------------------------------\n {\n-  \"created_at\": \"2020-01-05T09:56:11.805Z\",\n-  \"updated_at\": \"2020-01-05T09:56:11.805Z\",\n-  \"created_by\": \"elastic\",\n+  \"created_at\": \"2020-04-07T14:51:09.755Z\",\n+  \"updated_at\": \"2020-04-07T14:51:09.970Z\",\n+  \"created_by\": \"LiverpoolFC\",\n   \"description\": \"Process started by MS Office program - possible payload\",\n   \"enabled\": false,\n   \"false_positives\": [],\n+  \"from\": \"now-70m\",\n+  \"id\": \"6541b99a-dee9-4f6d-a86d-dbd1869d73b1\",\n+  \"immutable\": false,\n+  \"interval\": \"1h\",\n+  \"rule_id\": \"process_started_by_ms_office_program\",\n+  \"output_index\": \".siem-signals-default\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 308}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMzE4NQ==", "bodyText": "Oh right, I created the issue \ud83e\udd26\u200d\u2642 : elastic/kibana#59103. We want to drop support for this but I think it's staying for 7.7.", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405213185", "createdAt": "2020-04-08T01:53:45Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -196,26 +340,88 @@ POST api/detection_engine/rules\n If the rule starts to run at 15:00, it analyzes data from 13:50 until 15:00. \n When it runs next, at 16:00, it will analyze data from 14:50 until 16:00.\n \n+{ml-cap} rule that creates signals, and sends Slack notification, when the\n+`linux_anomalous_network_activity_ecs` {ml} job discovers anomalies with a\n+threshold of 70 or above:\n+\n+[source,console]\n+--------------------------------------------------\n+POST api/detection_engine/rules\n+{\n+  \"anomaly_threshold\": 70,\n+  \"rule_id\": \"ml_linux_network_high_threshold\",\n+  \"risk_score\": 70,\n+  \"machine_learning_job_id\": \"linux_anomalous_network_activity_ecs\",\n+  \"description\": \"Generates signals when the job discovers anomalies over 70\",\n+  \"interval\": \"5m\",\n+  \"name\": \"Anomalous Linux network activity\",\n+  \"note\": \"Shut down the internet.\",\n+  \"severity\": \"high\",\n+  \"tags\": [\n+   \"machine learning\",\n+   \"Linux\"\n+   ],\n+  \"type\": \"machine_learning\",\n+  \"from\": \"now-6m\",\n+  \"enabled\": true,\n+  \"throttle\": \"rule\",\n+  \"actions\": [\n+    {\n+      \"action_type_id\": \".slack\",\n+      \"group\": \"default\",\n+      \"id\": \"5ad22cd5-5e6e-4c6c-a81a-54b626a4cec5\",\n+      \"params\": {\n+        \"message\": \"Urgent: {{context.rule.description}}\"\n+      }\n+    }\n+  ]\n+}\n+--------------------------------------------------\n+// KIBANA\n+\n ==== Response code\n \n `200`:: \n     Indicates a successful call.\n     \n ==== Response payload\n \n-A JSON object that includes a unique ID, the time the rule was created, and its version number. If the request payload did not include a `rule_id` field, a unique rule ID is also generated.\n+A JSON object that includes a unique ID, the time the rule was created, and its\n+version number. If the request payload did not include a `rule_id` field, a\n+unique rule ID is also generated.\n \n-Example response:\n+Example response for a query-based rule:\n \n [source,json]\n --------------------------------------------------\n {\n-  \"created_at\": \"2020-01-05T09:56:11.805Z\",\n-  \"updated_at\": \"2020-01-05T09:56:11.805Z\",\n-  \"created_by\": \"elastic\",\n+  \"created_at\": \"2020-04-07T14:51:09.755Z\",\n+  \"updated_at\": \"2020-04-07T14:51:09.970Z\",\n+  \"created_by\": \"LiverpoolFC\",\n   \"description\": \"Process started by MS Office program - possible payload\",\n   \"enabled\": false,\n   \"false_positives\": [],\n+  \"from\": \"now-70m\",\n+  \"id\": \"6541b99a-dee9-4f6d-a86d-dbd1869d73b1\",\n+  \"immutable\": false,\n+  \"interval\": \"1h\",\n+  \"rule_id\": \"process_started_by_ms_office_program\",\n+  \"output_index\": \".siem-signals-default\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxMjE3OQ=="}, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 308}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIxNjA5Ng==", "bodyText": "Super nitpick: should this be \"...generated by  {ml} rules\"?\nIn my mind, signals are generated by rules, from data (anomalies, events, signals), for ... users? Now I'm getting semantic satiation for prepositions...", "url": "https://github.com/elastic/stack-docs/pull/983#discussion_r405216096", "createdAt": "2020-04-08T02:04:28Z", "author": {"login": "rylnd"}, "path": "docs/en/siem/rules-api-create.asciidoc", "diffHunk": "@@ -15,6 +52,12 @@ A JSON object with these fields:\n |==============================================\n |Name |Type |Description |Required\n \n+|actions |<<actions-object-schema, actions[]>> |Array defining the automated\n+actions (notifications) taken signals are produced. |No\n+\n+|anomaly_threshold |Integer |Anomaly threshold above which signals are\n+generated for {ml} rules |Yes, for {ml} rules.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac700565fa5bcb219ec04efb23a70f44099881b5"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b1689ab7e4c84e67e07bdac857fc9c9d2c050a2", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/2b1689ab7e4c84e67e07bdac857fc9c9d2c050a2", "committedDate": "2020-04-08T07:46:48Z", "message": "corrections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a2c6eb021fb8d44b70ae65a3c31d7b8b4940efc", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/2a2c6eb021fb8d44b70ae65a3c31d7b8b4940efc", "committedDate": "2020-04-08T07:50:17Z", "message": "fixes table"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2aa1039cbe4675c2b3450573dfbde9fddc94bc46", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/2aa1039cbe4675c2b3450573dfbde9fddc94bc46", "committedDate": "2020-04-08T08:11:42Z", "message": "fixes type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7c2690591d30693671bc6588bc52b7e289f6a8a", "author": {"user": {"login": "benskelker", "name": "Ben Skelker"}}, "url": "https://github.com/elastic/stack-docs/commit/c7c2690591d30693671bc6588bc52b7e289f6a8a", "committedDate": "2020-04-09T07:53:27Z", "message": "corrects indentation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4795, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}