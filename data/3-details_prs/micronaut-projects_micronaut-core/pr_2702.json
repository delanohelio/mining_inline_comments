{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4MDc0ODI4", "number": 2702, "title": "Enabling Visitors to declare annotation processors options.", "bodyText": "Needed to fix issue micronaut-projects/micronaut-openapi#108\nBy enabling annotation processors arguments, one can remove the need\nfor ugly System properties on thirdy party visitors. E.g.:\nmicronaut-openapi\nFixing http-server-netty integration test, according to HTTP spec regarding to\nContent-Type negotiation:\nSee https://tools.ietf.org/html/rfc7231#section-3.1.1.5", "createdAt": "2020-01-28T15:25:20Z", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702", "merged": true, "mergeCommit": {"oid": "c07decde8948bd4816a7aae56ed48ef3d3207353"}, "closed": true, "closedAt": "2020-02-05T07:31:51Z", "author": {"login": "miguelbaldi"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-zOQlAFqTM0OTQ3NTQ5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBJl6pABqjMwMDgwMDQyMzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NDc1NDkz", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#pullrequestreview-349475493", "createdAt": "2020-01-28T15:38:58Z", "commit": {"oid": "fa033688c896b506bd50fbeba4eaa01660b7c0c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNTozODo1OFrOFipvoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNTozODo1OFrOFipvoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg3OTg0MA==", "bodyText": "Please remove this change", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#discussion_r371879840", "createdAt": "2020-01-28T15:38:58Z", "author": {"login": "graemerocher"}, "path": "gradle.properties", "diffHunk": "@@ -1,4 +1,4 @@\n-projectVersion=1.3.0.BUILD-SNAPSHOT\n+projectVersion=1.3.0.RC2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa033688c896b506bd50fbeba4eaa01660b7c0c3"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa033688c896b506bd50fbeba4eaa01660b7c0c3", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/fa033688c896b506bd50fbeba4eaa01660b7c0c3", "committedDate": "2020-01-28T15:23:40Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}, "afterCommit": {"oid": "cfeb3da0d309e97e380b5a05246002505393fb3e", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/cfeb3da0d309e97e380b5a05246002505393fb3e", "committedDate": "2020-01-28T15:40:23Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cfeb3da0d309e97e380b5a05246002505393fb3e", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/cfeb3da0d309e97e380b5a05246002505393fb3e", "committedDate": "2020-01-28T15:40:23Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}, "afterCommit": {"oid": "3f4bf3f579ac50fdc3f9d04b14d87268818d8d05", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/3f4bf3f579ac50fdc3f9d04b14d87268818d8d05", "committedDate": "2020-01-28T16:22:28Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f4bf3f579ac50fdc3f9d04b14d87268818d8d05", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/3f4bf3f579ac50fdc3f9d04b14d87268818d8d05", "committedDate": "2020-01-28T16:22:28Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}, "afterCommit": {"oid": "b6f0bc273d19a024a47fa41fbf6a3a066e127e0f", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/b6f0bc273d19a024a47fa41fbf6a3a066e127e0f", "committedDate": "2020-01-28T17:27:08Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6f0bc273d19a024a47fa41fbf6a3a066e127e0f", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/b6f0bc273d19a024a47fa41fbf6a3a066e127e0f", "committedDate": "2020-01-28T17:27:08Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5"}, "afterCommit": {"oid": "84caa2b1b2eac93363b6ba67b33f779db9323e6b", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/84caa2b1b2eac93363b6ba67b33f779db9323e6b", "committedDate": "2020-01-29T18:17:32Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "84caa2b1b2eac93363b6ba67b33f779db9323e6b", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/84caa2b1b2eac93363b6ba67b33f779db9323e6b", "committedDate": "2020-01-29T18:17:32Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly"}, "afterCommit": {"oid": "961aaf84d94daa0e5391f0eac234c316e5f5d07c", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/961aaf84d94daa0e5391f0eac234c316e5f5d07c", "committedDate": "2020-01-29T19:24:12Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "961aaf84d94daa0e5391f0eac234c316e5f5d07c", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/961aaf84d94daa0e5391f0eac234c316e5f5d07c", "committedDate": "2020-01-29T19:24:12Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly"}, "afterCommit": {"oid": "89e52cb12870978e6bc8ee45ed02bd7dad2a0c41", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/89e52cb12870978e6bc8ee45ed02bd7dad2a0c41", "committedDate": "2020-01-29T21:44:14Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89e52cb12870978e6bc8ee45ed02bd7dad2a0c41", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/89e52cb12870978e6bc8ee45ed02bd7dad2a0c41", "committedDate": "2020-01-29T21:44:14Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "83f0fbb6ce1fac88f3424ab1226c8b0390d5b23f", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/83f0fbb6ce1fac88f3424ab1226c8b0390d5b23f", "committedDate": "2020-01-29T22:03:27Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83f0fbb6ce1fac88f3424ab1226c8b0390d5b23f", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/83f0fbb6ce1fac88f3424ab1226c8b0390d5b23f", "committedDate": "2020-01-29T22:03:27Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "d7b520a7953467b32bbaf8c368345aa0ad112b80", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/d7b520a7953467b32bbaf8c368345aa0ad112b80", "committedDate": "2020-01-30T15:44:25Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d7b520a7953467b32bbaf8c368345aa0ad112b80", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/d7b520a7953467b32bbaf8c368345aa0ad112b80", "committedDate": "2020-01-30T15:44:25Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/c4cc6f8337f2735265bbccf8cf68eb79e38dd47d", "committedDate": "2020-02-04T14:50:47Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDQ1MzIw", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#pullrequestreview-353045320", "createdAt": "2020-02-04T15:02:50Z", "commit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTowMjo1MFrOFlXSlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTowMjo1MFrOFlXSlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyMzIyMQ==", "bodyText": "You collect to a Set, so I don't think distinct is needed.", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#discussion_r374723221", "createdAt": "2020-02-04T15:02:50Z", "author": {"login": "croudet"}, "path": "inject-java/src/main/java/io/micronaut/annotation/processing/TypeElementVisitorProcessor.java", "diffHunk": "@@ -55,10 +58,30 @@\n public class TypeElementVisitorProcessor extends AbstractInjectAnnotationProcessor {\n \n     private boolean executed = false;\n+    private Collection<TypeElementVisitor> typeElementVisitors;\n+\n+    @Override\n+    public synchronized void init(ProcessingEnvironment processingEnv) {\n+        super.init(processingEnv);\n+        this.typeElementVisitors = findTypeElementVisitors();\n+    }\n \n     @Override\n     public Set<String> getSupportedOptions() {\n-        return Collections.singleton(\"org.gradle.annotation.processing.aggregating\");\n+        Stream<String> baseOption = Stream.of(\"org.gradle.annotation.processing.aggregating\");\n+        Stream<String> visitorsOptions = typeElementVisitors\n+                .stream()\n+                .map(TypeElementVisitor::getSupportedOptions)\n+                .flatMap(Collection::stream);\n+        Stream<String> visitorsAnnotationsOptions = typeElementVisitors\n+                .stream()\n+                .filter(tev -> tev.getClass().isAnnotationPresent(SupportedOptions.class))\n+                .map(TypeElementVisitor::getClass)\n+                .map(cls -> cls.getAnnotation(SupportedOptions.class))\n+                .flatMap((SupportedOptions supportedOptions) -> Arrays.stream(supportedOptions.value()));\n+        return Stream.of(baseOption, visitorsAnnotationsOptions, visitorsOptions)\n+                .flatMap(Stream::distinct)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDQ2MTE2", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#pullrequestreview-353046116", "createdAt": "2020-02-04T15:03:44Z", "commit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTowMzo0NFrOFlXVFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNTowMzo0NFrOFlXVFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDcyMzg2MA==", "bodyText": "You may want to call super.getSupportedOptions as well.", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2702#discussion_r374723860", "createdAt": "2020-02-04T15:03:44Z", "author": {"login": "croudet"}, "path": "inject-java/src/main/java/io/micronaut/annotation/processing/TypeElementVisitorProcessor.java", "diffHunk": "@@ -55,10 +58,30 @@\n public class TypeElementVisitorProcessor extends AbstractInjectAnnotationProcessor {\n \n     private boolean executed = false;\n+    private Collection<TypeElementVisitor> typeElementVisitors;\n+\n+    @Override\n+    public synchronized void init(ProcessingEnvironment processingEnv) {\n+        super.init(processingEnv);\n+        this.typeElementVisitors = findTypeElementVisitors();\n+    }\n \n     @Override\n     public Set<String> getSupportedOptions() {\n-        return Collections.singleton(\"org.gradle.annotation.processing.aggregating\");\n+        Stream<String> baseOption = Stream.of(\"org.gradle.annotation.processing.aggregating\");\n+        Stream<String> visitorsOptions = typeElementVisitors\n+                .stream()\n+                .map(TypeElementVisitor::getSupportedOptions)\n+                .flatMap(Collection::stream);\n+        Stream<String> visitorsAnnotationsOptions = typeElementVisitors\n+                .stream()\n+                .filter(tev -> tev.getClass().isAnnotationPresent(SupportedOptions.class))\n+                .map(TypeElementVisitor::getClass)\n+                .map(cls -> cls.getAnnotation(SupportedOptions.class))\n+                .flatMap((SupportedOptions supportedOptions) -> Arrays.stream(supportedOptions.value()));\n+        return Stream.of(baseOption, visitorsAnnotationsOptions, visitorsOptions)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d"}, "originalPosition": 57}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4cc6f8337f2735265bbccf8cf68eb79e38dd47d", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/c4cc6f8337f2735265bbccf8cf68eb79e38dd47d", "committedDate": "2020-02-04T14:50:47Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "0883617f21598f312d844dec8b3aa712550d9fe1", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/0883617f21598f312d844dec8b3aa712550d9fe1", "committedDate": "2020-02-04T15:05:37Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0883617f21598f312d844dec8b3aa712550d9fe1", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/0883617f21598f312d844dec8b3aa712550d9fe1", "committedDate": "2020-02-04T15:05:37Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "9fd9e70bf69b681a1d7c7931827e588f8da87dba", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/9fd9e70bf69b681a1d7c7931827e588f8da87dba", "committedDate": "2020-02-04T15:27:46Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fd9e70bf69b681a1d7c7931827e588f8da87dba", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/9fd9e70bf69b681a1d7c7931827e588f8da87dba", "committedDate": "2020-02-04T15:27:46Z", "message": "[WIP] Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affect, given that they access the properties directly\n  TODO:\n    - Tests!"}, "afterCommit": {"oid": "bbd23b6e412353c7c41be6a3203fd255b6a1dab9", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/bbd23b6e412353c7c41be6a3203fd255b6a1dab9", "committedDate": "2020-02-04T19:49:57Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bbd23b6e412353c7c41be6a3203fd255b6a1dab9", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/bbd23b6e412353c7c41be6a3203fd255b6a1dab9", "committedDate": "2020-02-04T19:49:57Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}, "afterCommit": {"oid": "fabcf52aa0d88d6964ed71d689e0e3dba1cedd08", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/fabcf52aa0d88d6964ed71d689e0e3dba1cedd08", "committedDate": "2020-02-04T20:10:57Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fabcf52aa0d88d6964ed71d689e0e3dba1cedd08", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/fabcf52aa0d88d6964ed71d689e0e3dba1cedd08", "committedDate": "2020-02-04T20:10:57Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}, "afterCommit": {"oid": "a4e875a3803e5fa85f41db54d9dcd177d123df0b", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/a4e875a3803e5fa85f41db54d9dcd177d123df0b", "committedDate": "2020-02-04T22:47:35Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "310864173198c43f132db5af71027036726b1db5", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/310864173198c43f132db5af71027036726b1db5", "committedDate": "2020-02-04T22:50:22Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4e875a3803e5fa85f41db54d9dcd177d123df0b", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/a4e875a3803e5fa85f41db54d9dcd177d123df0b", "committedDate": "2020-02-04T22:47:35Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}, "afterCommit": {"oid": "310864173198c43f132db5af71027036726b1db5", "author": {"user": {"login": "miguelbaldi", "name": "Miguel Aranha Baldi Horlle"}}, "url": "https://github.com/micronaut-projects/micronaut-core/commit/310864173198c43f132db5af71027036726b1db5", "committedDate": "2020-02-04T22:50:22Z", "message": "Enabling Visitors to declare annotation processors options.\n\n  - Needed to fix issue micronaut-projects/micronaut-openapi#108\n    By enabling annotation processors arguments, one can remove the need\n    for ugly System properties on thirdy party visitors. E.g.:\n      micronaut-openapi\n  - Fixing http-server-netty integration test, according to HTTP spec regarding to\n    Content-Type negotiation:\n    See https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  - Groovy compatibility using System properties\n  - Java processors implementations that rely on System properties are\n    not affected, given that they access the properties directly\n  - Internal visitors updated to use `@SupportedOptions` annotation."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2910, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}