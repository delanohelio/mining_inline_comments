{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMjU2MjM4", "number": 930, "title": "Optimize implementations of aggregateBy in Bags to use forEachWithOcc\u2026", "bodyText": "\u2026urrences.Closes #449\nSigned-off-by: Sirisha Pratha sirisha.pratha@bnymellon.com", "createdAt": "2020-06-30T19:47:08Z", "url": "https://github.com/eclipse/eclipse-collections/pull/930", "merged": true, "mergeCommit": {"oid": "bfb3b7622370710062486a52132151ea56645d95"}, "closed": true, "closedAt": "2020-07-02T04:22:53Z", "author": {"login": "prathasirisha"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwcL_QgFqTQ0MDM4Mzc2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcw2dpPABqjM1MDUyMDMyMTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMzgzNzYz", "url": "https://github.com/eclipse/eclipse-collections/pull/930#pullrequestreview-440383763", "createdAt": "2020-06-30T21:03:20Z", "commit": {"oid": "2038e7ff5ec57d90b5cc92936035af591205ee15"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMTowMzoyMFrOGrOX9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMTowNDoyOFrOGrOaWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk3NzQ2Mw==", "bodyText": "Hi @prathasirisha, you could move this for loop into a method on the NonMutatingAggregationProcedure class.", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r447977463", "createdAt": "2020-06-30T21:03:20Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/bag/immutable/AbstractImmutableBagIterable.java", "diffHunk": "@@ -67,7 +67,14 @@\n             Function2<? super V, ? super T, ? extends V> nonMutatingAggregator)\n     {\n         MutableMap<K, V> map = UnifiedMap.newMap();\n-        this.forEach(new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator));\n+        NonMutatingAggregationProcedure<T, K, V> nonMutatingAggregationProcedure = new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator);\n+        this.forEachWithOccurrences((each, occurrences) ->\n+        {\n+            for (int i = 0; i < occurrences; i++)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2038e7ff5ec57d90b5cc92936035af591205ee15"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk3ODA3NA==", "bodyText": "You could reuse the method you move to NonMutatingAggregationProcedure.", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r447978074", "createdAt": "2020-06-30T21:04:28Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/bag/mutable/AbstractMutableBagIterable.java", "diffHunk": "@@ -303,7 +304,14 @@ public T max(Comparator<? super T> comparator)\n             Function2<? super V, ? super T, ? extends V> nonMutatingAggregator)\n     {\n         MutableMap<K, V> map = UnifiedMap.newMap();\n-        this.forEach(new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator));\n+        Procedure<T> nonMutatingAggregationProcedure = new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator);\n+        this.forEachWithOccurrences((each, occurrences) ->\n+        {\n+            for (int i = 0; i < occurrences; i++)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2038e7ff5ec57d90b5cc92936035af591205ee15"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d49293eff9f62476b07a00f73a3de33acea64db2", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/d49293eff9f62476b07a00f73a3de33acea64db2", "committedDate": "2020-06-30T23:55:12Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "6f82d4fe8ce46e4b23d7531e5446d3766382fc28", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/6f82d4fe8ce46e4b23d7531e5446d3766382fc28", "committedDate": "2020-06-30T23:59:47Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDgzNDU1", "url": "https://github.com/eclipse/eclipse-collections/pull/930#pullrequestreview-440483455", "createdAt": "2020-07-01T01:09:31Z", "commit": {"oid": "6f82d4fe8ce46e4b23d7531e5446d3766382fc28"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMTowOTozMVrOGrTgOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMTowOTozMVrOGrTgOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA2MTQ5Nw==", "bodyText": "Hi @prathasirisha, if you switch the parameters you can use a method reference to call this.", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r448061497", "createdAt": "2020-07-01T01:09:31Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/block/procedure/NonMutatingAggregationProcedure.java", "diffHunk": "@@ -47,4 +47,12 @@ public void value(T each)\n         K key = this.groupBy.valueOf(each);\n         this.map.updateValueWith(key, this.zeroValueFactory, this.nonMutatingAggregator, each);\n     }\n+\n+    public void forEachWithOccurrences(int occurrences, T each)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f82d4fe8ce46e4b23d7531e5446d3766382fc28"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f82d4fe8ce46e4b23d7531e5446d3766382fc28", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/6f82d4fe8ce46e4b23d7531e5446d3766382fc28", "committedDate": "2020-06-30T23:59:47Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "8c1afa870797976b7c96694da01a9d39f114926d", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/8c1afa870797976b7c96694da01a9d39f114926d", "committedDate": "2020-07-01T01:57:07Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c1afa870797976b7c96694da01a9d39f114926d", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/8c1afa870797976b7c96694da01a9d39f114926d", "committedDate": "2020-07-01T01:57:07Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "36a04361dc022868767de532a037f8f36aefe144", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/36a04361dc022868767de532a037f8f36aefe144", "committedDate": "2020-07-01T01:58:30Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTAyNjIw", "url": "https://github.com/eclipse/eclipse-collections/pull/930#pullrequestreview-440502620", "createdAt": "2020-07-01T02:15:37Z", "commit": {"oid": "36a04361dc022868767de532a037f8f36aefe144"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMjoxNTozOFrOGrUf3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwMjoxNjozMFrOGrUgvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3Nzc5MQ==", "bodyText": "Hi @prathasirisha, I'm struggling on this name as well. On the one hand this name matches the parameters exactly. But I wonder if it would be better to name this repeatForOccurrences. @nikhilnanivadekar @motlin opinions?", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r448077791", "createdAt": "2020-07-01T02:15:38Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/block/procedure/NonMutatingAggregationProcedure.java", "diffHunk": "@@ -47,4 +47,12 @@ public void value(T each)\n         K key = this.groupBy.valueOf(each);\n         this.map.updateValueWith(key, this.zeroValueFactory, this.nonMutatingAggregator, each);\n     }\n+\n+    public void forEachWithOccurrences(T each, int occurrences)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a04361dc022868767de532a037f8f36aefe144"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3Nzg5NQ==", "bodyText": "I would shorten the variable name to procedure.", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r448077895", "createdAt": "2020-07-01T02:16:02Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/bag/mutable/AbstractMutableBagIterable.java", "diffHunk": "@@ -303,7 +303,8 @@ public T max(Comparator<? super T> comparator)\n             Function2<? super V, ? super T, ? extends V> nonMutatingAggregator)\n     {\n         MutableMap<K, V> map = UnifiedMap.newMap();\n-        this.forEach(new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator));\n+        NonMutatingAggregationProcedure<T, K, V> nonMutatingAggregationProcedure = new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a04361dc022868767de532a037f8f36aefe144"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3ODAxMg==", "bodyText": "I would shorten the variable name to procedure.", "url": "https://github.com/eclipse/eclipse-collections/pull/930#discussion_r448078012", "createdAt": "2020-07-01T02:16:30Z", "author": {"login": "donraab"}, "path": "eclipse-collections/src/main/java/org/eclipse/collections/impl/bag/immutable/AbstractImmutableBagIterable.java", "diffHunk": "@@ -67,7 +67,8 @@\n             Function2<? super V, ? super T, ? extends V> nonMutatingAggregator)\n     {\n         MutableMap<K, V> map = UnifiedMap.newMap();\n-        this.forEach(new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator));\n+        NonMutatingAggregationProcedure<T, K, V> nonMutatingAggregationProcedure = new NonMutatingAggregationProcedure<>(map, groupBy, zeroValueFactory, nonMutatingAggregator);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a04361dc022868767de532a037f8f36aefe144"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36a04361dc022868767de532a037f8f36aefe144", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/36a04361dc022868767de532a037f8f36aefe144", "committedDate": "2020-07-01T01:58:30Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "9a131cfd57d25ea47f13e0716943223488e7bb04", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/9a131cfd57d25ea47f13e0716943223488e7bb04", "committedDate": "2020-07-02T02:24:03Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a131cfd57d25ea47f13e0716943223488e7bb04", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/9a131cfd57d25ea47f13e0716943223488e7bb04", "committedDate": "2020-07-02T02:24:03Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "89d0ec657e17c543d8a8ada45aa026b66aeaf7cf", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/89d0ec657e17c543d8a8ada45aa026b66aeaf7cf", "committedDate": "2020-07-02T02:29:05Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89d0ec657e17c543d8a8ada45aa026b66aeaf7cf", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/89d0ec657e17c543d8a8ada45aa026b66aeaf7cf", "committedDate": "2020-07-02T02:29:05Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "fd748572dd4297de42a94f05a315eaf7302a385e", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/fd748572dd4297de42a94f05a315eaf7302a385e", "committedDate": "2020-07-02T03:23:46Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzI2MDky", "url": "https://github.com/eclipse/eclipse-collections/pull/930#pullrequestreview-441326092", "createdAt": "2020-07-02T03:30:10Z", "commit": {"oid": "fd748572dd4297de42a94f05a315eaf7302a385e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "518e8e5e1590a9695110f5f6bcb9e10ed986cbd8", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/518e8e5e1590a9695110f5f6bcb9e10ed986cbd8", "committedDate": "2020-07-02T03:41:29Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd748572dd4297de42a94f05a315eaf7302a385e", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/fd748572dd4297de42a94f05a315eaf7302a385e", "committedDate": "2020-07-02T03:23:46Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}, "afterCommit": {"oid": "518e8e5e1590a9695110f5f6bcb9e10ed986cbd8", "author": {"user": {"login": "prathasirisha", "name": "Sirisha Pratha"}}, "url": "https://github.com/eclipse/eclipse-collections/commit/518e8e5e1590a9695110f5f6bcb9e10ed986cbd8", "committedDate": "2020-07-02T03:41:29Z", "message": "Optimize implementations of aggregateBy in Bags to use forEachWithOccurrences.Closes #449\n\nSigned-off-by: Sirisha Pratha <sirisha.pratha@bnymellon.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 697, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}