{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwODIwMjcw", "number": 6702, "title": "#6701 Added error message when sales order cloning fails.", "bodyText": "#6701", "createdAt": "2020-05-20T15:16:54Z", "url": "https://github.com/metasfresh/metasfresh/pull/6702", "merged": true, "mergeCommit": {"oid": "9757a34269784ca03578fad18e8b1b0ae908d03d"}, "closed": true, "closedAt": "2020-05-21T12:00:18Z", "author": {"login": "dragospodariu96"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjKhyLgH2gAyNDIwODIwMjcwOjdiYjA5NWU5NTg5ZjE1OTJlOTlkYmY0MTZkNThiMTQxNWNkZWExYzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjbiFjAH2gAyNDIwODIwMjcwOjkwMGQ4MDdiNTFkODhiMjFiNDM2MWQwZDcwYzkxMzM4ZDYzNzVlMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7bb095e9589f1592e99dbf416d58b1415cdea1c6", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/7bb095e9589f1592e99dbf416d58b1415cdea1c6", "committedDate": "2020-05-20T15:09:23Z", "message": "#6701 Added error message when sales order cloning fails."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDgxNzA5", "url": "https://github.com/metasfresh/metasfresh/pull/6702#pullrequestreview-415481709", "createdAt": "2020-05-20T15:55:27Z", "commit": {"oid": "7bb095e9589f1592e99dbf416d58b1415cdea1c6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTo1NToyN1rOGYSp4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTo1NjozMlrOGYSszg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODEyNDY0MA==", "bodyText": "use AdMessageKey instead of String", "url": "https://github.com/metasfresh/metasfresh/pull/6702#discussion_r428124640", "createdAt": "2020-05-20T15:55:27Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.adempiere.adempiere/base/src/main/java/de/metas/bpartner/service/impl/BPartnerDAO.java", "diffHunk": "@@ -119,6 +123,8 @@\n \n \tprivate final GLNLoadingCache glnsLoadingCache = new GLNLoadingCache();\n \n+\tprivate static final String MSG_ADDRESS_INACTIVE = \"webui.salesorder.clone.inactivelocation\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bb095e9589f1592e99dbf416d58b1415cdea1c6"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODEyNTIwMw==", "bodyText": "declare locationRepos as a class field", "url": "https://github.com/metasfresh/metasfresh/pull/6702#discussion_r428125203", "createdAt": "2020-05-20T15:56:15Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.adempiere.adempiere/base/src/main/java/de/metas/bpartner/service/impl/BPartnerDAO.java", "diffHunk": "@@ -492,11 +496,21 @@ else if (bpLocations.size() == 1)\n \t@Override\n \tpublic CountryId retrieveBPartnerLocationCountryId(@NonNull final BPartnerLocationId bpLocationId)\n \t{\n-\t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n-\t\tfinal LocationId locationId = LocationId.ofRepoId(bpLocation.getC_Location_ID());\n+\t\ttry\n+\t\t{\n+\t\t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n+\t\t\tfinal LocationId locationId = LocationId.ofRepoId(bpLocation.getC_Location_ID());\n+\n+\t\t\tfinal ILocationDAO locationRepos = Services.get(ILocationDAO.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bb095e9589f1592e99dbf416d58b1415cdea1c6"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODEyNTM5MA==", "bodyText": "declare msgBL as a class field", "url": "https://github.com/metasfresh/metasfresh/pull/6702#discussion_r428125390", "createdAt": "2020-05-20T15:56:32Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.adempiere.adempiere/base/src/main/java/de/metas/bpartner/service/impl/BPartnerDAO.java", "diffHunk": "@@ -492,11 +496,21 @@ else if (bpLocations.size() == 1)\n \t@Override\n \tpublic CountryId retrieveBPartnerLocationCountryId(@NonNull final BPartnerLocationId bpLocationId)\n \t{\n-\t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n-\t\tfinal LocationId locationId = LocationId.ofRepoId(bpLocation.getC_Location_ID());\n+\t\ttry\n+\t\t{\n+\t\t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n+\t\t\tfinal LocationId locationId = LocationId.ofRepoId(bpLocation.getC_Location_ID());\n+\n+\t\t\tfinal ILocationDAO locationRepos = Services.get(ILocationDAO.class);\n+\t\t\treturn locationRepos.getCountryIdByLocationId(locationId);\n+\t\t}\n+\t\tcatch (NullPointerException ex)\n+\t\t{\n+\t\t\tfinal IMsgBL msgBL = Services.get(IMsgBL.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bb095e9589f1592e99dbf416d58b1415cdea1c6"}, "originalPosition": 86}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "282ec218600d7aee1d3f5b32a4b920c6371c2ea1", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/282ec218600d7aee1d3f5b32a4b920c6371c2ea1", "committedDate": "2020-05-21T09:02:28Z", "message": "#6701 Throwing adempiere exception instead of catching NPE."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MDI4ODI0", "url": "https://github.com/metasfresh/metasfresh/pull/6702#pullrequestreview-416028824", "createdAt": "2020-05-21T10:09:43Z", "commit": {"oid": "282ec218600d7aee1d3f5b32a4b920c6371c2ea1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDowOTo0M1rOGYtcGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxMDo1Mjo0OVrOGYujTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU2MzQ4Mw==", "bodyText": "u can pass directly the MSG_ADDRESS_INACTIVE.\nNo need to call msgBL", "url": "https://github.com/metasfresh/metasfresh/pull/6702#discussion_r428563483", "createdAt": "2020-05-21T10:09:43Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.adempiere.adempiere/base/src/main/java/de/metas/bpartner/service/impl/BPartnerDAO.java", "diffHunk": "@@ -493,6 +499,11 @@ else if (bpLocations.size() == 1)\n \tpublic CountryId retrieveBPartnerLocationCountryId(@NonNull final BPartnerLocationId bpLocationId)\n \t{\n \t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n+\t\tif (bpLocation == null)\n+\t\t{\n+\t\t\tfinal ITranslatableString message = msgBL.getTranslatableMsgText(MSG_ADDRESS_INACTIVE, Collections.emptyList());\n+\t\t\tthrow new AdempiereException(message).markAsUserValidationError();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "282ec218600d7aee1d3f5b32a4b920c6371c2ea1"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU4MTcxMA==", "bodyText": "i.e. new AdempiereException(MSG_ADDRESS_INACTIVE).markAsUserValidationError();", "url": "https://github.com/metasfresh/metasfresh/pull/6702#discussion_r428581710", "createdAt": "2020-05-21T10:52:49Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.adempiere.adempiere/base/src/main/java/de/metas/bpartner/service/impl/BPartnerDAO.java", "diffHunk": "@@ -493,6 +499,11 @@ else if (bpLocations.size() == 1)\n \tpublic CountryId retrieveBPartnerLocationCountryId(@NonNull final BPartnerLocationId bpLocationId)\n \t{\n \t\tfinal I_C_BPartner_Location bpLocation = getBPartnerLocationById(bpLocationId);\n+\t\tif (bpLocation == null)\n+\t\t{\n+\t\t\tfinal ITranslatableString message = msgBL.getTranslatableMsgText(MSG_ADDRESS_INACTIVE, Collections.emptyList());\n+\t\t\tthrow new AdempiereException(message).markAsUserValidationError();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU2MzQ4Mw=="}, "originalCommit": {"oid": "282ec218600d7aee1d3f5b32a4b920c6371c2ea1"}, "originalPosition": 79}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "900d807b51d88b21b4361d0d70c91338d6375e1c", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/900d807b51d88b21b4361d0d70c91338d6375e1c", "committedDate": "2020-05-21T10:58:06Z", "message": "#6701 Throwing adempiere exception instead of catching NPE."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3433, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}