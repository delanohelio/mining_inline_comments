{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MDAxODU0", "number": 6251, "title": "#4048 Only showing 'Create From' action for drafted Payment Selection documents.", "bodyText": "#6250", "createdAt": "2020-02-24T13:52:39Z", "url": "https://github.com/metasfresh/metasfresh/pull/6251", "merged": true, "mergeCommit": {"oid": "34868f32de96a3a19d6f01a8604b9aea8d5e19bf"}, "closed": true, "closedAt": "2020-02-26T14:51:03Z", "author": {"login": "dragospodariu96"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHd3wbAH2gAyMzc5MDAxODU0OmExOWU5Y2I2MTA5NDcwMDM0NGRiYzgyNmQwNGYxZjM1MDE3YWJjNGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIFynKgH2gAyMzc5MDAxODU0OjBjZmY2OWEwNTQwNmVkYThlMTU2ZDBjNmYxYjNmYzcxNzdjYTc0MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/a19e9cb61094700344dbc826d04f1f35017abc4b", "committedDate": "2020-02-24T13:51:42Z", "message": "#4048 Only showing 'Create From' action for drafted Payment Selection documents."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "522471fd3236507ef8914d62b2dce315e334fa70", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/522471fd3236507ef8914d62b2dce315e334fa70", "committedDate": "2020-02-24T14:07:13Z", "message": "#4048 Removed unused import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e68bbb57c84acbfbf58d67898421c72f8816a04", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/2e68bbb57c84acbfbf58d67898421c72f8816a04", "committedDate": "2020-02-24T14:07:47Z", "message": "#4048 Removed unused variable."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNDEzODAx", "url": "https://github.com/metasfresh/metasfresh/pull/6251#pullrequestreview-363413801", "createdAt": "2020-02-24T14:10:00Z", "commit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDoxMDowMFrOFth2og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDoxMDowMFrOFth2og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4NDg5OA==", "bodyText": "not 100% sure, but i think this won't work if you reactivate a pay selection. because then it is in \"in progress\".\nSo,\n\nso, use DocStatus.isDraftedOrInProgress()\nalso make sure to avoid NPEs. I.e. use ofNullableCode\nnote: i guess that assuming the C_PaySelection record itself exists is OK", "url": "https://github.com/metasfresh/metasfresh/pull/6251#discussion_r383284898", "createdAt": "2020-02-24T14:10:00Z", "author": {"login": "metas-ts"}, "path": "de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/process/C_PaySelection_CreateFrom.java", "diffHunk": "@@ -104,6 +111,22 @@ else if (name.equals(\"C_BP_Group_ID\"))\n \t\t}\n \t}\n \n+\t@Override\n+\tpublic ProcessPreconditionsResolution checkPreconditionsApplicable(final @NonNull IProcessPreconditionsContext context)\n+\t{\n+\t\tfinal IPaySelectionDAO paySelectionDAO = Services.get(IPaySelectionDAO.class);\n+\t\tfinal IPaymentDAO paymentDAO = Services.get(IPaymentDAO.class);\n+\n+\t\tfinal I_C_PaySelection paySelection = paySelectionDAO.retrievePaySelectionById(context.getSingleSelectedRecordId());\n+\n+\t\tif (paySelection.getDocStatus().equals(DocStatus.Drafted.getCode()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b"}, "originalPosition": 58}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c524ad0584c83e3b5e45e778abd76f333a1e781b", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/c524ad0584c83e3b5e45e778abd76f333a1e781b", "committedDate": "2020-02-25T23:35:14Z", "message": "Merge branch 'master' into gh4048"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56f52f761dc335c0a93ac57f9719bd54906dc50b", "author": {"user": {"login": "dragospodariu96", "name": null}}, "url": "https://github.com/metasfresh/metasfresh/commit/56f52f761dc335c0a93ac57f9719bd54906dc50b", "committedDate": "2020-02-25T23:36:18Z", "message": "#4048 Now showing 'Create From' Action if document is reactivated."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6a059b71c1ce0c85a6f49bac3b7e4043f9e0c5f", "author": {"user": {"login": "teosarca", "name": "Teo Sarca"}}, "url": "https://github.com/metasfresh/metasfresh/commit/b6a059b71c1ce0c85a6f49bac3b7e4043f9e0c5f", "committedDate": "2020-02-26T12:19:09Z", "message": "Merge branch 'master' into gh4048"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cff69a05406eda8e156d0c6f1b3fc7177ca7412", "author": {"user": {"login": "teosarca", "name": "Teo Sarca"}}, "url": "https://github.com/metasfresh/metasfresh/commit/0cff69a05406eda8e156d0c6f1b3fc7177ca7412", "committedDate": "2020-02-26T12:22:17Z", "message": "QA"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3632, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}