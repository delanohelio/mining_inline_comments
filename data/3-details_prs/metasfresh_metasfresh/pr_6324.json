{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1OTc1MzE3", "number": 6324, "title": "Unconditionally migrate `AD_Org_ID` process parameter to `Search` from whatever it is now", "bodyText": "#6298", "createdAt": "2020-03-10T07:24:39Z", "url": "https://github.com/metasfresh/metasfresh/pull/6324", "merged": true, "mergeCommit": {"oid": "faf6c6559327fc6ddc4d2026013a584fc48daee0"}, "closed": true, "closedAt": "2020-03-11T11:57:09Z", "author": {"login": "TheBestPessimist"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMNUB4gH2gAyMzg1OTc1MzE3OjI0MTUyMGI5ZDNiYzk0ZDZiMWFkYWMwYTZlMjIwNGQ1YWVkYWFmYjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMl0fuAFqTM3MjY5MzAwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/241520b9d3bc94d6b1adac0a6e2204d5aedaafb9", "committedDate": "2020-03-10T07:23:49Z", "message": "Unconditionally migrate `AD_Org_ID` process parameter to `Search` from whatever it is now\n\nhttps://github.com/metasfresh/metasfresh/issues/6298"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMDkxMzk0", "url": "https://github.com/metasfresh/metasfresh/pull/6324#pullrequestreview-372091394", "createdAt": "2020-03-10T15:58:25Z", "commit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNTo1ODoyNVrOF0Vl2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxNjowNjowNVrOF0V78A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQyNDAyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              AND ad_element_id = (SELECT ad_element_id FROM ad_element WHERE columnname = 'AD_Org_ID')\n          \n          \n            \n              AND ad_element_id = (SELECT ad_element_id FROM ad_element WHERE columnname = 'AD_Org_ID')\n          \n          \n            \n              AND ad_reference_id != (SELECT ad_reference_id FROM ad_reference WHERE name = 'Search')", "url": "https://github.com/metasfresh/metasfresh/pull/6324#discussion_r390424026", "createdAt": "2020-03-10T15:58:25Z", "author": {"login": "metas-ts"}, "path": "de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5554220_sys_gh6298_Update_AD_Org_ID_InProcessesToSearch.sql", "diffHunk": "@@ -0,0 +1,18 @@\n+-- Backup the table AD_Process_Para, Even though only the rows containing 'AD_Org_ID' will be modified\n+CREATE TABLE backup.ad_process_para_gh6298_ad_org_id_as_search AS\n+    (\n+        SELECT *\n+        FROM ad_process_para\n+    )\n+;\n+\n+\n+-- Unconditionally update the `ad_reference_id` to `Search`\n+UPDATE ad_process_para\n+SET --\n+    ad_reference_id = (SELECT ad_reference_id FROM ad_reference WHERE name = 'Search'),\n+    UpdatedBy=0,\n+    Updated=now()\n+WHERE TRUE\n+  AND ad_element_id = (SELECT ad_element_id FROM ad_element WHERE columnname = 'AD_Org_ID')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQyNzc0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                Updated=now()\n          \n          \n            \n                Updated=`2020-03-10 17:01:56.767453+01`\n          \n      \n    \n    \n  \n\nuse a hardcoded date string that will be the same in the SQL and the DB", "url": "https://github.com/metasfresh/metasfresh/pull/6324#discussion_r390427740", "createdAt": "2020-03-10T16:03:19Z", "author": {"login": "metas-ts"}, "path": "de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5554220_sys_gh6298_Update_AD_Org_ID_InProcessesToSearch.sql", "diffHunk": "@@ -0,0 +1,18 @@\n+-- Backup the table AD_Process_Para, Even though only the rows containing 'AD_Org_ID' will be modified\n+CREATE TABLE backup.ad_process_para_gh6298_ad_org_id_as_search AS\n+    (\n+        SELECT *\n+        FROM ad_process_para\n+    )\n+;\n+\n+\n+-- Unconditionally update the `ad_reference_id` to `Search`\n+UPDATE ad_process_para\n+SET --\n+    ad_reference_id = (SELECT ad_reference_id FROM ad_reference WHERE name = 'Search'),\n+    UpdatedBy=0,\n+    Updated=now()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQyODI3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                UpdatedBy=0,\n          \n          \n            \n                UpdatedBy=99,\n          \n      \n    \n    \n  \n\nuse AD_User_ID 99 which is generally used for \"manual\" migrations", "url": "https://github.com/metasfresh/metasfresh/pull/6324#discussion_r390428276", "createdAt": "2020-03-10T16:04:03Z", "author": {"login": "metas-ts"}, "path": "de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5554220_sys_gh6298_Update_AD_Org_ID_InProcessesToSearch.sql", "diffHunk": "@@ -0,0 +1,18 @@\n+-- Backup the table AD_Process_Para, Even though only the rows containing 'AD_Org_ID' will be modified\n+CREATE TABLE backup.ad_process_para_gh6298_ad_org_id_as_search AS\n+    (\n+        SELECT *\n+        FROM ad_process_para\n+    )\n+;\n+\n+\n+-- Unconditionally update the `ad_reference_id` to `Search`\n+UPDATE ad_process_para\n+SET --\n+    ad_reference_id = (SELECT ad_reference_id FROM ad_reference WHERE name = 'Search'),\n+    UpdatedBy=0,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQyOTY4MA==", "bodyText": "please stick with teos suggestion to update only the record that actually need updating", "url": "https://github.com/metasfresh/metasfresh/pull/6324#discussion_r390429680", "createdAt": "2020-03-10T16:06:05Z", "author": {"login": "metas-ts"}, "path": "de.metas.adempiere.adempiere/migration/src/main/sql/postgresql/system/10-de.metas.adempiere/5554220_sys_gh6298_Update_AD_Org_ID_InProcessesToSearch.sql", "diffHunk": "@@ -0,0 +1,18 @@\n+-- Backup the table AD_Process_Para, Even though only the rows containing 'AD_Org_ID' will be modified\n+CREATE TABLE backup.ad_process_para_gh6298_ad_org_id_as_search AS\n+    (\n+        SELECT *\n+        FROM ad_process_para\n+    )\n+;\n+\n+\n+-- Unconditionally update the `ad_reference_id` to `Search`\n+UPDATE ad_process_para\n+SET --\n+    ad_reference_id = (SELECT ad_reference_id FROM ad_reference WHERE name = 'Search'),\n+    UpdatedBy=0,\n+    Updated=now()\n+WHERE TRUE\n+  AND ad_element_id = (SELECT ad_element_id FROM ad_element WHERE columnname = 'AD_Org_ID')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDQyNDAyNg=="}, "originalCommit": {"oid": "241520b9d3bc94d6b1adac0a6e2204d5aedaafb9"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9d7fbd21c332fcad2f95c8db74b1dc8f0890a0f", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/b9d7fbd21c332fcad2f95c8db74b1dc8f0890a0f", "committedDate": "2020-03-11T06:02:37Z", "message": "Fixes after review\n\n- update only the records that actually need updating\n- use a hardcoded date string that will be the same in the SQL and the DB\n- use AD_User_ID 99 which is generally used for \"manual\" migrations\n\nhttps://github.com/metasfresh/metasfresh/issues/6298"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70ffbf45ea553e3d81c94dc13cf0adb805ee0915", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/70ffbf45ea553e3d81c94dc13cf0adb805ee0915", "committedDate": "2020-03-11T06:15:06Z", "message": "Bugfix: Update only those process params which are not of type `Search`\n\nhttps://github.com/metasfresh/metasfresh/issues/6298"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNjkzMDAx", "url": "https://github.com/metasfresh/metasfresh/pull/6324#pullrequestreview-372693001", "createdAt": "2020-03-11T11:57:00Z", "commit": {"oid": "70ffbf45ea553e3d81c94dc13cf0adb805ee0915"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3544, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}