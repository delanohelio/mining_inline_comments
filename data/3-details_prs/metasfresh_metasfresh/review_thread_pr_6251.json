{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MDAxODU0", "number": 6251, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDoxMDowMFrODiVrxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDoxMDowMFrODiVrxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MzMzNDQ2OnYy", "diffSide": "RIGHT", "path": "de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/process/C_PaySelection_CreateFrom.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNDoxMDowMFrOFth2og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNjowODo1MlrOFuMOoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4NDg5OA==", "bodyText": "not 100% sure, but i think this won't work if you reactivate a pay selection. because then it is in \"in progress\".\nSo,\n\nso, use DocStatus.isDraftedOrInProgress()\nalso make sure to avoid NPEs. I.e. use ofNullableCode\nnote: i guess that assuming the C_PaySelection record itself exists is OK", "url": "https://github.com/metasfresh/metasfresh/pull/6251#discussion_r383284898", "createdAt": "2020-02-24T14:10:00Z", "author": {"login": "metas-ts"}, "path": "de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/process/C_PaySelection_CreateFrom.java", "diffHunk": "@@ -104,6 +111,22 @@ else if (name.equals(\"C_BP_Group_ID\"))\n \t\t}\n \t}\n \n+\t@Override\n+\tpublic ProcessPreconditionsResolution checkPreconditionsApplicable(final @NonNull IProcessPreconditionsContext context)\n+\t{\n+\t\tfinal IPaySelectionDAO paySelectionDAO = Services.get(IPaySelectionDAO.class);\n+\t\tfinal IPaymentDAO paymentDAO = Services.get(IPaymentDAO.class);\n+\n+\t\tfinal I_C_PaySelection paySelection = paySelectionDAO.retrievePaySelectionById(context.getSingleSelectedRecordId());\n+\n+\t\tif (paySelection.getDocStatus().equals(DocStatus.Drafted.getCode()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzM1NTUxMA==", "bodyText": "Yes, it's not working if gets reactivated.", "url": "https://github.com/metasfresh/metasfresh/pull/6251#discussion_r383355510", "createdAt": "2020-02-24T16:03:35Z", "author": {"login": "dragospodariu96"}, "path": "de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/process/C_PaySelection_CreateFrom.java", "diffHunk": "@@ -104,6 +111,22 @@ else if (name.equals(\"C_BP_Group_ID\"))\n \t\t}\n \t}\n \n+\t@Override\n+\tpublic ProcessPreconditionsResolution checkPreconditionsApplicable(final @NonNull IProcessPreconditionsContext context)\n+\t{\n+\t\tfinal IPaySelectionDAO paySelectionDAO = Services.get(IPaySelectionDAO.class);\n+\t\tfinal IPaymentDAO paymentDAO = Services.get(IPaymentDAO.class);\n+\n+\t\tfinal I_C_PaySelection paySelection = paySelectionDAO.retrievePaySelectionById(context.getSingleSelectedRecordId());\n+\n+\t\tif (paySelection.getDocStatus().equals(DocStatus.Drafted.getCode()))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4NDg5OA=="}, "originalCommit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzk3OTE2OQ==", "bodyText": "agree with Tobi. It shall be as Tobi suggested", "url": "https://github.com/metasfresh/metasfresh/pull/6251#discussion_r383979169", "createdAt": "2020-02-25T16:08:52Z", "author": {"login": "teosarca"}, "path": "de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/process/C_PaySelection_CreateFrom.java", "diffHunk": "@@ -104,6 +111,22 @@ else if (name.equals(\"C_BP_Group_ID\"))\n \t\t}\n \t}\n \n+\t@Override\n+\tpublic ProcessPreconditionsResolution checkPreconditionsApplicable(final @NonNull IProcessPreconditionsContext context)\n+\t{\n+\t\tfinal IPaySelectionDAO paySelectionDAO = Services.get(IPaySelectionDAO.class);\n+\t\tfinal IPaymentDAO paymentDAO = Services.get(IPaymentDAO.class);\n+\n+\t\tfinal I_C_PaySelection paySelection = paySelectionDAO.retrievePaySelectionById(context.getSingleSelectedRecordId());\n+\n+\t\tif (paySelection.getDocStatus().equals(DocStatus.Drafted.getCode()))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzI4NDg5OA=="}, "originalCommit": {"oid": "a19e9cb61094700344dbc826d04f1f35017abc4b"}, "originalPosition": 58}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1510, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}