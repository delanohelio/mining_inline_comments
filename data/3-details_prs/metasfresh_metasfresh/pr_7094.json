{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNzc0MDIw", "number": 7094, "title": "#7093 C_Flatrate_Term_C_Order_Term_ID", "bodyText": "Make it a real column\nPropagate it on term extension\n\n#7093", "createdAt": "2020-08-04T13:43:27Z", "url": "https://github.com/metasfresh/metasfresh/pull/7094", "merged": true, "mergeCommit": {"oid": "56888f540636944089168a8e767c99db97a1f8d6"}, "closed": true, "closedAt": "2020-08-05T12:01:42Z", "author": {"login": "metas-rc"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7m1XpAH2gAyNDYyNzc0MDIwOjYzNzNjNTVjMDRhODM5ODU4ZmZkYjc2OGNkYmNmZDlhY2QwOTE1ZDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc75-4QgH2gAyNDYyNzc0MDIwOmFiNjM5ZDg5YzM2NDY4NmFhMzZiODk2MDgwNzgwMWIwNDBmNDQ1ZTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6373c55c04a839858ffdb768cdbcfd9acd0915d5", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/6373c55c04a839858ffdb768cdbcfd9acd0915d5", "committedDate": "2020-08-04T13:42:18Z", "message": "#7093 C_Flatrate_Term_C_Order_Term_ID\n\n* Make it a real column\n* Propagate it on term extension\n\nhttps://github.com/metasfresh/metasfresh/issues/7093"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9aaa868b5a8846c34bbc64a9d2b69b2fef419116", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/9aaa868b5a8846c34bbc64a9d2b69b2fef419116", "committedDate": "2020-08-04T15:05:46Z", "message": "#7093 migration\n\nhttps://github.com/metasfresh/metasfresh/issues/7093"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwOTE0Mjgw", "url": "https://github.com/metasfresh/metasfresh/pull/7094#pullrequestreview-460914280", "createdAt": "2020-08-04T15:16:01Z", "commit": {"oid": "9aaa868b5a8846c34bbc64a9d2b69b2fef419116"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNToxNjowMVrOG7lKxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNToxNjowMVrOG7lKxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEyODEzMw==", "bodyText": "wouldn't this be more efficient?\nUPDATE C_Flatrate_Term term\nSET C_Order_Term_ID = (SELECT ol.C_Order_ID\n                       FROM C_OrderLine ol\n                       WHERE ol.C_OrderLine_ID = term.C_OrderLine_Term_ID)\nWHERE term.C_OrderLine_Term_ID IS NOT NULL\n  AND term.C_Order_Term_ID IS NULL;", "url": "https://github.com/metasfresh/metasfresh/pull/7094#discussion_r465128133", "createdAt": "2020-08-04T15:16:01Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.contracts/src/main/sql/postgresql/system/50-de.metas.contracts/5564650_sys_gh7093_C_Flatrate_Term_C_Order_Term_ID_Real_Column.sql", "diffHunk": "@@ -0,0 +1,29 @@\n+\n+\n+CREATE TABLE backup.BKP_C_Flatrate_Term_04082020 \n+AS\n+SELECT * FROM C_Flatrate_Term;\n+\n+\n+\n+\n+\n+\n+-- 2020-08-04T11:13:21.686Z\n+-- #298 changing anz. stellen\n+UPDATE AD_Column SET ColumnSQL='',Updated=TO_TIMESTAMP('2020-08-04 14:13:21','YYYY-MM-DD HH24:MI:SS'),UpdatedBy=100 WHERE AD_Column_ID=547320\n+;\n+\n+-- 2020-08-04T11:13:25.896Z\n+-- #298 changing anz. stellen\n+/* DDL */ SELECT public.db_alter_table('C_Flatrate_Term','ALTER TABLE public.C_Flatrate_Term ADD COLUMN C_Order_Term_ID NUMERIC(10)')\n+;\n+\n+\n+UPDATE C_Flatrate_Term term\n+SET C_Order_Term_ID = x.C_Order_ID\n+FROM (SELECT ol.C_Order_ID, t.C_Flatrate_Term_ID\n+      FROM C_OrderLine ol\n+               JOIN C_Flatrate_Term t on ol.C_OrderLine_ID = t.C_OrderLine_Term_ID\n+      WHERE t.C_OrderLine_Term_ID IS NOT NULL) x\n+WHERE term.C_Flatrate_Term_ID = x.C_Flatrate_Term_ID;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9aaa868b5a8846c34bbc64a9d2b69b2fef419116"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab639d89c364686aa36b8960807801b040f445e7", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/ab639d89c364686aa36b8960807801b040f445e7", "committedDate": "2020-08-05T12:00:53Z", "message": "#7093 improve update migration\n\nhttps://github.com/metasfresh/metasfresh/issues/7093"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3246, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}