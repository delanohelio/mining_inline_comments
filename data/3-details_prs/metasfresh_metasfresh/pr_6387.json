{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNTMxOTg3", "number": 6387, "title": "Gh6384 Split Pricelist Comparison Process in Sales and Purchase", "bodyText": "#6384", "createdAt": "2020-03-23T17:27:43Z", "url": "https://github.com/metasfresh/metasfresh/pull/6387", "merged": true, "mergeCommit": {"oid": "95455a55b2854c34e0c4a3c865abd5af4527681a"}, "closed": true, "closedAt": "2020-03-24T08:59:31Z", "author": {"login": "metas-rc"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQhuqFAH2gAyMzkyNTMxOTg3OmNkZDI4YmFhM2Y2YTUyZGY3YWQwYmZmMzA4Y2VlYWE2M2ZlNjY0M2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQvCneAH2gAyMzkyNTMxOTg3OmRjOGEzN2ZiOTZmZTdjOGI0NmFiNGM1MDVhYmI5NGFiZDRjMjNiNGM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cdd28baa3f6a52df7ad0bff308ceeaa63fe6643a", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/cdd28baa3f6a52df7ad0bff308ceeaa63fe6643a", "committedDate": "2020-03-23T17:26:42Z", "message": "# Pricelist Comparison Split Processes\n\nhttps://github.com/metasfresh/metasfresh/issues/6384"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98ff5264ed8c3b2668c485b71caa2c8a77eb4f42", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/98ff5264ed8c3b2668c485b71caa2c8a77eb4f42", "committedDate": "2020-03-23T17:27:05Z", "message": "Merge branch 'master' into gh6384"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bbff48bbbdd3dfc872797e21db9894acc4f3272", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/0bbff48bbbdd3dfc872797e21db9894acc4f3272", "committedDate": "2020-03-24T07:16:31Z", "message": "#6384 repairment in comment\n\nhttps://github.com/metasfresh/metasfresh/issues/6384"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMTAzMTQz", "url": "https://github.com/metasfresh/metasfresh/pull/6387#pullrequestreview-380103143", "createdAt": "2020-03-24T08:51:13Z", "commit": {"oid": "0bbff48bbbdd3dfc872797e21db9894acc4f3272"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwODo1MToxNFrOF6mMdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwODo1MToxNFrOF6mMdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk4NzUxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            -- Function: report.bpartner_pricelist_version(numeric)\n          \n          \n            \n            \n          \n          \n            \n             DROP FUNCTION IF EXISTS report.bpartner_pricelist_version(numeric);\n          \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n             DROP FUNCTION IF EXISTS report.bpartner_pricelist_version(numeric, character);\n          \n          \n            \n            \n          \n          \n            \n            CREATE OR REPLACE FUNCTION report.bpartner_pricelist_version(c_bpartner_id numeric, p_IsSOTrx character default null)\n          \n          \n            \n              RETURNS numeric AS\n          \n          \n            \n            $BODY$\n          \n          \n            \n            SELECT M_PriceList_Version_ID\n          \n          \n            \n            FROM Report.fresh_PriceList_Version_Val_Rule plv\n          \n          \n            \n            WHERE C_BPartner_ID= $1 AND ValidFrom <= now()\n          \n          \n            \n            AND (p_IsSOTrx IS NULL OR p_IsSOTrx = IsSOTrx)\n          \n          \n            \n            ORDER BY ValidFrom DESC, Name ASC\n          \n          \n            \n            LIMIT 1$BODY$\n          \n          \n            \n              LANGUAGE sql STABLE\n          \n          \n            \n              COST 100;\n          \n          \n            \n            COMMENT ON FUNCTION report.bpartner_pricelist_version(numeric, character) IS 'Returns the latest, currently valid price list version within the pricing system of a given Partner (or its BP Group)';\n          \n      \n    \n    \n  \n\nlooks like this got in here by accident", "url": "https://github.com/metasfresh/metasfresh/pull/6387#discussion_r396987511", "createdAt": "2020-03-24T08:51:14Z", "author": {"login": "metas-ts"}, "path": "de.metas.fresh/de.metas.fresh.base/src/main/sql/postgresql/ddl/views/Fresh_PriceList_Version_Val_Rule.sql", "diffHunk": "@@ -20,3 +20,27 @@ WHERE\n \n \n COMMENT ON VIEW report.fresh_Pricelist_Version_Val_Rule IS 'Returns all currently valid C_PriceList_Version_IDs for all C_BPartner_ID along with the valid-from-date and price list version name';\n+\n+\n+\n+\n+\n+-- Function: report.bpartner_pricelist_version(numeric)\n+\n+ DROP FUNCTION IF EXISTS report.bpartner_pricelist_version(numeric);\n+\n+\n+ DROP FUNCTION IF EXISTS report.bpartner_pricelist_version(numeric, character);\n+\n+CREATE OR REPLACE FUNCTION report.bpartner_pricelist_version(c_bpartner_id numeric, p_IsSOTrx character default null)\n+  RETURNS numeric AS\n+$BODY$\n+SELECT M_PriceList_Version_ID\n+FROM Report.fresh_PriceList_Version_Val_Rule plv\n+WHERE C_BPartner_ID= $1 AND ValidFrom <= now()\n+AND (p_IsSOTrx IS NULL OR p_IsSOTrx = IsSOTrx)\n+ORDER BY ValidFrom DESC, Name ASC\n+LIMIT 1$BODY$\n+  LANGUAGE sql STABLE\n+  COST 100;\n+COMMENT ON FUNCTION report.bpartner_pricelist_version(numeric, character) IS 'Returns the latest, currently valid price list version within the pricing system of a given Partner (or its BP Group)';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0bbff48bbbdd3dfc872797e21db9894acc4f3272"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8a37fb96fe7c8b46ab4c505abb94abd4c23b4c", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/dc8a37fb96fe7c8b46ab4c505abb94abd4c23b4c", "committedDate": "2020-03-24T08:57:16Z", "message": "#6384 clean migration script\r\n\r\nhttps://github.com/metasfresh/metasfresh/issues/6384\n\nCo-Authored-By: Tobias Sch\u00f6neberg <metas-ts@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3568, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}