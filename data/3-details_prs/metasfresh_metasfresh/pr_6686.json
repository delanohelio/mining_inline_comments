{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMDQ3NDI0", "number": 6686, "title": "Gh6511 2 repair PaySelectionTrxType calculation", "bodyText": "#6511", "createdAt": "2020-05-19T11:10:13Z", "url": "https://github.com/metasfresh/metasfresh/pull/6686", "merged": true, "mergeCommit": {"oid": "7360d41d39ed576042e2900d1617a152b6ece49c"}, "closed": true, "closedAt": "2020-05-19T12:19:56Z", "author": {"login": "metas-rc"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcieiJAgH2gAyNDIwMDQ3NDI0OjJhZjg3YmFhYzA5YzU3MWZiMzVmYjljMTYxNjQ3MTc4Y2I1NzY2OGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABciy21JgH2gAyNDIwMDQ3NDI0OjI4NDljZjhmNWI2OTNjNjZlMGM0ZThlZDk3NDJhNDk5MjA3MDgxNTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2af87baac09c571fb35fb9c161647178cb57668b", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/2af87baac09c571fb35fb9c161647178cb57668b", "committedDate": "2020-05-18T11:53:57Z", "message": "#6511 update bank statement lines and references processed flag on bank statement completion\n\nhttps://github.com/metasfresh/metasfresh/issues/6511"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "389ee890d46e869045436f229eeb55fabeafac48", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/389ee890d46e869045436f229eeb55fabeafac48", "committedDate": "2020-05-18T11:54:22Z", "message": "Merge branch 'invisible_croissant' into gh6511"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edf4a086af98dc41bf9369381a60e299ccbb2faa", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/edf4a086af98dc41bf9369381a60e299ccbb2faa", "committedDate": "2020-05-19T11:09:15Z", "message": "#6511 repair pay selection trx type calculation\n\nhttps://github.com/metasfresh/metasfresh/issues/6511"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6efd55973b43eac901782037c1eb5c52034f261", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/e6efd55973b43eac901782037c1eb5c52034f261", "committedDate": "2020-05-19T11:09:22Z", "message": "Merge branch 'invisible_croissant' into gh6511_2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MzQ4MzY2", "url": "https://github.com/metasfresh/metasfresh/pull/6686#pullrequestreview-414348366", "createdAt": "2020-05-19T11:23:53Z", "commit": {"oid": "e6efd55973b43eac901782037c1eb5c52034f261"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMToyMzo1M1rOGXb1Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMToyNDowM1rOGXb1Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjM3OA==", "bodyText": "pls change !='ARC' to ='ARI'.\nReason: avoid future doc base types to be matched by this rule.", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427226378", "createdAt": "2020-05-19T11:23:53Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.banking/de.metas.banking.base/src/main/java/de/metas/banking/payment/impl/PaySelectionUpdater.java", "diffHunk": "@@ -386,7 +386,7 @@ else if (getC_BP_Group_ID() > 0)\n \tprivate String buildSelectSQL_MatchRequirement()\n \t{\n \t\tfinal String whereCreditTransferToVendor = \" i.IsSOTrx='N' AND i.PaymentRule IN ('\" + PaymentRule.DirectDeposit.getCode() + \"','\" + PaymentRule.OnCredit.getCode() + \"') \";\n-\t\tfinal String whereDirectDebitFromCustomer = \" i.IsSOTrx='Y' AND dt.DocBaseType!='ARC' AND i.PaymentRule IN ('\" + PaymentRule.DirectDebit.getCode() + \"') \";\n+\t\tfinal String whereDirectDebitFromCustomer = \" i.IsSOTrx='Y' AND dt.DocBaseType!='ARC' AND i.PaymentRule IN ('\" + PaymentRule.DirectDebit.getCode() + \"','\" + PaymentRule.OnCredit.getCode() + \"') \";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6efd55973b43eac901782037c1eb5c52034f261"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzIyNjQ1NA==", "bodyText": "pls change !='ARC' to ='ARI'.\nReason: avoid future doc base types to be matched by this rule.", "url": "https://github.com/metasfresh/metasfresh/pull/6686#discussion_r427226454", "createdAt": "2020-05-19T11:24:03Z", "author": {"login": "teosarca"}, "path": "backend/de.metas.payment.sepa/base/src/main/sql/postgresql/ddl/views/C_Invoice_PaySelectionTrxType_V.sql", "diffHunk": "@@ -4,8 +4,8 @@ CREATE OR REPLACE VIEW C_Invoice_PaySelectionTrxType_V AS\n SELECT C_Invoice_ID,\n \tCASE \n \t\tWHEN /* CREDIT_TRANSFER_TO_VENDOR - \"OUT\" */ i.IsSOTrx='N' AND i.PaymentRule IN ('T'/*DirectDeposit*/, 'P'/*OnCredit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'CT'\n-\t\tWHEN /* DIRECT_DEBIT_FROM_CUSTOMER - \"CDD\" */ i.IsSOTrx='Y' AND dt.DocBaseType = 'ARC' AND i.PaymentRule IN ('D'/*DirectDebit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'DD'\n-\t\tWHEN /* CREDIT_TRANSFER_TO_CUSTOMER - \"CRE\" */ i.IsSOTrx='Y' AND dt.DocBaseType = 'ARC' AND i.PaymentRule IN ('T'/*DirectDeposit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'CT'\n+\t\tWHEN /* DIRECT_DEBIT_FROM_CUSTOMER - \"CDD\" */ i.IsSOTrx='Y' AND dt.DocBaseType != 'ARC' AND i.PaymentRule IN ('D'/*DirectDebit*/, 'P'/*OnCredit*/) AND i.DocStatus IN ('CO', 'CL') THEN 'DD'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6efd55973b43eac901782037c1eb5c52034f261"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2849cf8f5b693c66e0c4e8ed9742a49920708153", "author": {"user": {"login": "metas-rc", "name": "Ruxandra Craciunescu"}}, "url": "https://github.com/metasfresh/metasfresh/commit/2849cf8f5b693c66e0c4e8ed9742a49920708153", "committedDate": "2020-05-19T11:34:39Z", "message": "#6615 avoid future doc base types to be matched by this rule\n\nhttps://github.com/metasfresh/metasfresh/issues/6511"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3423, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}