{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NTQwNzQw", "number": 6357, "title": "OLCand-REST-EP shall use BPartner-REST-EP", "bodyText": "remove BPartnerMasterDataProvider; instead, invoke BpartnerRestController\nBpartnerRestController now returns detailed information wrt which entities (bpartner, contact, location) were created or updated\n#6356", "createdAt": "2020-03-16T23:18:29Z", "url": "https://github.com/metasfresh/metasfresh/pull/6357", "merged": true, "mergeCommit": {"oid": "8872b6cc47db72d07dcfacc5da7a7ce853c95d45"}, "closed": true, "closedAt": "2020-03-18T07:46:29Z", "author": {"login": "metas-ts"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOWjEJAH2gAyMzg5NTQwNzQwOjgxNTYwMTI3NTViMjU5Zjc2YzA4MzljOTNkMjQ4ODViMjAzZDdjZjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOyZSpAFqTM3NjU3ODM0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8156012755b259f76c0839c93d24885b203d7cf9", "author": {"user": {"login": "metas-ts", "name": "Tobias Sch\u00f6neberg"}}, "url": "https://github.com/metasfresh/metasfresh/commit/8156012755b259f76c0839c93d24885b203d7cf9", "committedDate": "2020-03-16T23:17:14Z", "message": "OLCand-REST-EP shall use BPartner-REST-EP\n\n* remove BPartnerMasterDataProvider; instead, invoke BpartnerRestController\n* BpartnerRestController now returns detailed information wrt which entities (bpartner, contact, location) were created or updated\nhttps://github.com/metasfresh/metasfresh/issues/6356"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff96f8e8e2da8f9574818aff894ceea19706a323", "author": {"user": {"login": "metas-ts", "name": "Tobias Sch\u00f6neberg"}}, "url": "https://github.com/metasfresh/metasfresh/commit/ff96f8e8e2da8f9574818aff894ceea19706a323", "committedDate": "2020-03-17T18:19:08Z", "message": "OLCand-REST-EP shall use BPartner-REST-EP\n\n* fix unit test(s)\nhttps://github.com/metasfresh/metasfresh/issues/6356"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "445e0d1f181aa0cde5eb9e2a9631f84398371473", "author": {"user": {"login": "metas-ts", "name": "Tobias Sch\u00f6neberg"}}, "url": "https://github.com/metasfresh/metasfresh/commit/445e0d1f181aa0cde5eb9e2a9631f84398371473", "committedDate": "2020-03-17T21:36:40Z", "message": "OLCand-REST-EP shall use BPartner-REST-EP\n\n* fix unit test(s)\nhttps://github.com/metasfresh/metasfresh/issues/6356"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTc4MzQ4", "url": "https://github.com/metasfresh/metasfresh/pull/6357#pullrequestreview-376578348", "createdAt": "2020-03-18T05:46:50Z", "commit": {"oid": "445e0d1f181aa0cde5eb9e2a9631f84398371473"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNTo0Njo1MVrOF33DhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNzo0MTo1NFrOF35QOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDExODAyMQ==", "bodyText": "make sure the billTo parameter becomes clearer", "url": "https://github.com/metasfresh/metasfresh/pull/6357#discussion_r394118021", "createdAt": "2020-03-18T05:46:51Z", "author": {"login": "metas-ts"}, "path": "de.metas.business.rest-api-impl/src/main/java/de/metas/rest_api/ordercandidates/impl/JsonConverters.java", "diffHunk": "@@ -144,10 +144,10 @@ public final OLCandCreateRequestBuilder fromJson(\n \t\t\t\t.externalLineId(request.getExternalLineId())\n \t\t\t\t.externalHeaderId(request.getExternalHeaderId())\n \t\t\t\t//\n-\t\t\t\t.bpartner(masterdataProvider.getCreateBPartnerInfo(request.getBpartner(), orgId))\n-\t\t\t\t.billBPartner(masterdataProvider.getCreateBPartnerInfo(request.getBillBPartner(), orgId))\n-\t\t\t\t.dropShipBPartner(masterdataProvider.getCreateBPartnerInfo(request.getDropShipBPartner(), orgId))\n-\t\t\t\t.handOverBPartner(masterdataProvider.getCreateBPartnerInfo(request.getHandOverBPartner(), orgId))\n+\t\t\t\t.bpartner(masterdataProvider.getCreateBPartnerInfo(request.getBpartner(), true/* billTo */, orgId))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "445e0d1f181aa0cde5eb9e2a9631f84398371473"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDExODI4Mg==", "bodyText": "make sure the billTo parameter becomes clearer", "url": "https://github.com/metasfresh/metasfresh/pull/6357#discussion_r394118282", "createdAt": "2020-03-18T05:47:56Z", "author": {"login": "metas-ts"}, "path": "de.metas.business.rest-api-impl/src/main/java/de/metas/rest_api/ordercandidates/impl/OrderCandidatesRestControllerImpl.java", "diffHunk": "@@ -213,10 +218,10 @@ private void createOrUpdateMasterdata0(\n \t{\n \t\tfinal OrgId orgId = masterdataProvider.getCreateOrgId(json.getOrg());\n \n-\t\tfinal BPartnerInfo bpartnerInfo = masterdataProvider.getCreateBPartnerInfo(json.getBpartner(), orgId);\n-\t\tfinal BPartnerInfo billBPartnerInfo = masterdataProvider.getCreateBPartnerInfo(json.getBillBPartner(), orgId);\n-\t\tmasterdataProvider.getCreateBPartnerInfo(json.getDropShipBPartner(), orgId);\n-\t\tmasterdataProvider.getCreateBPartnerInfo(json.getHandOverBPartner(), orgId);\n+\t\tfinal BPartnerInfo bpartnerInfo = masterdataProvider.getCreateBPartnerInfo(json.getBpartner(), true/* billTo */, orgId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "445e0d1f181aa0cde5eb9e2a9631f84398371473"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE1NDA0Mw==", "bodyText": "TODO check mock-based solution in master-branch", "url": "https://github.com/metasfresh/metasfresh/pull/6357#discussion_r394154043", "createdAt": "2020-03-18T07:41:54Z", "author": {"login": "metas-ts"}, "path": "de.metas.business/src/main/java/de/metas/bpartner/composite/repository/BPartnerCompositeSaver.java", "diffHunk": "@@ -395,11 +403,24 @@ private void saveBPartnerBankAccount(\n \t\trecord.setC_Currency_ID(bankAccount.getCurrencyId().getRepoId());\n \t\trecord.setIsActive(bankAccount.isActive());\n \n+\t\tassertCanCreateOrUpdate(record);\n \t\tsaveRecord(record);\n \n \t\tfinal BPartnerBankAccountId id = BPartnerBankAccountId.ofRepoId(bpartnerId, record.getC_BP_BankAccount_ID());\n \n \t\tbankAccount.setId(id);\n \t}\n \n+\tprivate void assertCanCreateOrUpdate(@NonNull final Object record)\n+\t{\n+\t\tif (Adempiere.isUnitTestMode())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "445e0d1f181aa0cde5eb9e2a9631f84398371473"}, "originalPosition": 63}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3557, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}