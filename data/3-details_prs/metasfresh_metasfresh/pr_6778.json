{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2NTE1MzYx", "number": 6778, "title": "#6777 Shall refresh even if is single document", "bodyText": "#6777 Shall refresh even if is single document", "createdAt": "2020-06-02T11:10:29Z", "url": "https://github.com/metasfresh/metasfresh/pull/6778", "merged": true, "mergeCommit": {"oid": "095ca928d18f97cfb6ee869235197a50f04a382d"}, "closed": true, "closedAt": "2020-06-02T12:36:18Z", "author": {"login": "cristinamghita"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnS4i9gH2gAyNDI2NTE1MzYxOjBjMzBlOWIzZjNjMGFlNzRkZTZkN2JkYWZmNWM2ZWY1MzBkMWVkYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnUIHvAFqTQyMjYzMDM2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2", "author": {"user": {"login": "cristinamghita", "name": "Cristina Ghita"}}, "url": "https://github.com/metasfresh/metasfresh/commit/0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2", "committedDate": "2020-06-02T11:09:11Z", "message": "#6777 Shall refresh even if is single document"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNTkwMjE0", "url": "https://github.com/metasfresh/metasfresh/pull/6778#pullrequestreview-422590214", "createdAt": "2020-06-02T11:37:35Z", "commit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMTozNzozNVrOGdtrYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMTozNzozNVrOGdtrYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzgxMDI3NA==", "bodyText": "wanted to call, but i think it's better to list my questions..\n\nsince we are in the isRefreshAllAfterExecution() branch, don't we have to find a way to invalidate all records?\nin case of isRefreshAllAfterExecution() == false, shouldn't we still make sure to invalidate the selected record?\nin the dev-test you wrote \"select a product and run the process\". So, i can imagine the test succeeds with a single record. but what if more than one record is selected?\nmaybe consult with Teo?", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433810274", "createdAt": "2020-06-02T11:37:35Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{\n+\t\t\t\tviewSupplier.get().invalidateAll();\n+\t\t\t\tviewInvalidateAllCalled = true;\n+\t\t\t}\n+\t\t\telse if (currentSingleSelectedDocumentRef != null)\n+\t\t\t{\n+\t\t\t\tdocumentsCollection.invalidateDocumentByRecordId(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjI5NTEw", "url": "https://github.com/metasfresh/metasfresh/pull/6778#pullrequestreview-422629510", "createdAt": "2020-06-02T12:34:57Z", "commit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNDo1N1rOGdvg8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNToxMFrOGdvhXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg0MDM3MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t{ // multible rows selected", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433840370", "createdAt": "2020-06-02T12:34:57Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg0MDQ3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t{ // single row selected", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433840477", "createdAt": "2020-06-02T12:35:10Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{\n+\t\t\t\tviewSupplier.get().invalidateAll();\n+\t\t\t\tviewInvalidateAllCalled = true;\n+\t\t\t}\n+\t\t\telse if (currentSingleSelectedDocumentRef != null)\n+\t\t\t{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdadedf68a06f0c5748db4dd3dfb6bc25419a462", "author": {"user": {"login": "metas-ts", "name": "Tobias Sch\u00f6neberg"}}, "url": "https://github.com/metasfresh/metasfresh/commit/bdadedf68a06f0c5748db4dd3dfb6bc25419a462", "committedDate": "2020-06-02T12:35:54Z", "message": "minor: add comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjMwMzY4", "url": "https://github.com/metasfresh/metasfresh/pull/6778#pullrequestreview-422630368", "createdAt": "2020-06-02T12:36:06Z", "commit": {"oid": "bdadedf68a06f0c5748db4dd3dfb6bc25419a462"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3350, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}