{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MTYwMTUz", "number": 6200, "title": "Jasper Report: `Summary and balance Report` - Summen- und Saldenliste", "bodyText": "#6190", "createdAt": "2020-02-17T14:16:22Z", "url": "https://github.com/metasfresh/metasfresh/pull/6200", "merged": true, "mergeCommit": {"oid": "70bd1cbe094ebb297dafe195baf14302c03b720c"}, "closed": true, "closedAt": "2020-02-19T13:15:06Z", "author": {"login": "TheBestPessimist"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFOEYzAFqTM1OTc2NzA3Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcF2VuBAH2gAyMzc2MTYwMTUzOmU4YTMzNGQwMzA2ZDcyYzlhN2U5NWFjYjRhYjRiMDA4MDJmZDQ0Yzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NzY3MDcz", "url": "https://github.com/metasfresh/metasfresh/pull/6200#pullrequestreview-359767073", "createdAt": "2020-02-17T14:19:09Z", "commit": {"oid": "55370ad0d1bba3c685cfa587c7139292af007456"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoxOTowOVrOFqmBlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoxOTowOVrOFqmBlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIwNzUwOQ==", "bodyText": "activity filtering shall be applied on Fact_Acct, Fact_Acct_Summary.\nIf we don't have the Fact_Acct_Summary.C_Activity_ID then pls:\n\nskip it\ninform Mark\ncreate a follow-up to introduce it", "url": "https://github.com/metasfresh/metasfresh/pull/6200#discussion_r380207509", "createdAt": "2020-02-17T14:19:09Z", "author": {"login": "teosarca"}, "path": "de.metas.acct.base/src/main/sql/postgresql/ddl/functions/SummaryAndBalanceListReport.sql", "diffHunk": "@@ -0,0 +1,66 @@\n+--- backup for erpit\n+CREATE INDEX fas_dateacct\n+    ON fact_acct_summary (dateacct);\n+DROP INDEX fas_dateacct;\n+-- todo @ teo observation: it seems the query runs faster without the index fas_dateacct. (27 sec avg -> 22 sec avg => >10% perf change)\n+-- todo extract the index drop to own migration script\n+--------------------------------------\n+\n+\n+CREATE OR REPLACE FUNCTION SummaryAndBalanceListReport(p_dateFrom date,\n+                                                       p_dateTo date,\n+                                                       p_c_acctschema_id NUMERIC,\n+                                                       p_ad_org_id numeric,\n+                                                       p_account_id NUMERIC=NULL,\n+                                                       p_c_activity_id numeric=NULL)\n+    RETURNS table\n+            (\n+                AccountValue     text,\n+                AccountName      text,\n+                beginningBalance numeric,\n+                debit            numeric,\n+                credit           numeric,\n+                endingBalancw    numeric\n+            )\n+AS\n+$$\n+WITH filteredElementValues AS\n+         (\n+             SELECT ev.c_elementvalue_id,\n+                    ev.name  AccountName,\n+                    ev.value AccountValue\n+             FROM c_elementvalue ev\n+             WHERE TRUE\n+               AND (p_account_id IS NULL OR ev.c_elementvalue_id = p_account_id)\n+               AND (p_c_activity_id IS NULL OR ev.c_activity_id = p_c_activity_id)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55370ad0d1bba3c685cfa587c7139292af007456"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NzY4NTY5", "url": "https://github.com/metasfresh/metasfresh/pull/6200#pullrequestreview-359768569", "createdAt": "2020-02-17T14:21:22Z", "commit": {"oid": "55370ad0d1bba3c685cfa587c7139292af007456"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoyMToyMlrOFqmGBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxNDoyMToyMlrOFqmGBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIwODY0Ng==", "bodyText": "cannot follow what's changed here. u will have to tell me....", "url": "https://github.com/metasfresh/metasfresh/pull/6200#discussion_r380208646", "createdAt": "2020-02-17T14:21:22Z", "author": {"login": "teosarca"}, "path": "de.metas.acct.base/src/main/sql/postgresql/ddl/functions/acctBalanceToDate.sql", "diffHunk": "@@ -15,89 +15,93 @@ CREATE TYPE de_metas_acct.BalanceAmt AS\n );\n \n  */\n-create or replace function de_metas_acct.acctBalanceToDate(p_Account_ID numeric, p_C_AcctSchema_ID numeric, p_DateAcct date, p_AD_Org_ID numeric(10,0),  p_IncludePostingTypeStatistical char(1) = 'N',  p_ExcludePostingTypeYearEnd char(1) = 'N')\n-RETURNS de_metas_acct.BalanceAmt AS\n+CREATE OR REPLACE FUNCTION de_metas_acct.acctBalanceToDate_test(p_Account_ID numeric,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55370ad0d1bba3c685cfa587c7139292af007456"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "55370ad0d1bba3c685cfa587c7139292af007456", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/55370ad0d1bba3c685cfa587c7139292af007456", "committedDate": "2020-02-17T14:15:12Z", "message": "First draft of SummaryAndBalanceListReport\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}, "afterCommit": {"oid": "3abb64611f1ba21367e1712c2a9c726837587cd2", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/3abb64611f1ba21367e1712c2a9c726837587cd2", "committedDate": "2020-02-18T06:27:50Z", "message": "Stop filtering by `c_elementvalue.c_activity_id`\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ab8455ac5f331aeff5364a6510149f6e33c2e9b", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/3ab8455ac5f331aeff5364a6510149f6e33c2e9b", "committedDate": "2020-02-18T07:38:35Z", "message": "Add migration script\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}, "afterCommit": {"oid": "00ab3fdf0bb54565eb7a27917ecba808b9a7c233", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/00ab3fdf0bb54565eb7a27917ecba808b9a7c233", "committedDate": "2020-02-18T09:56:48Z", "message": "Add migration script\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2685ab2c6189be54d6d1f265a9aa57765a35f19", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/f2685ab2c6189be54d6d1f265a9aa57765a35f19", "committedDate": "2020-02-18T11:41:26Z", "message": "Use CTE instead of pasting the same query 4 times.\n\nSeems like this reduces query time to about 70% of original. (30% reduction)\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11196f1d4b4c96a88759809621e208c816410c4e", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/11196f1d4b4c96a88759809621e208c816410c4e", "committedDate": "2020-02-18T11:41:26Z", "message": "First draft of SummaryAndBalanceListReport\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9730a3761bd93b5ba595232d3079009e718849c", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/b9730a3761bd93b5ba595232d3079009e718849c", "committedDate": "2020-02-18T11:41:26Z", "message": "Stop filtering by `c_elementvalue.c_activity_id`\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bfad459a8ef8df3e5c802e698b7b6a210e328e8", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/5bfad459a8ef8df3e5c802e698b7b6a210e328e8", "committedDate": "2020-02-18T11:41:26Z", "message": "DROP INDEX fas_dateacct\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75de20931933b48d042e1fe55608469525c7e596", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/75de20931933b48d042e1fe55608469525c7e596", "committedDate": "2020-02-18T11:41:26Z", "message": "Add migration script\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00ab3fdf0bb54565eb7a27917ecba808b9a7c233", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/00ab3fdf0bb54565eb7a27917ecba808b9a7c233", "committedDate": "2020-02-18T09:56:48Z", "message": "Add migration script\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}, "afterCommit": {"oid": "75de20931933b48d042e1fe55608469525c7e596", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/75de20931933b48d042e1fe55608469525c7e596", "committedDate": "2020-02-18T11:41:26Z", "message": "Add migration script\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4db3aee75c299077337f7066425da2b7b0e08a59", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/4db3aee75c299077337f7066425da2b7b0e08a59", "committedDate": "2020-02-19T06:43:32Z", "message": "Rename report to `SummaryAndBalanceReport` from `SummaryAndBalanceListReport`\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9be690a1fcede3773da2875d22f9f0e1b561637e", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/9be690a1fcede3773da2875d22f9f0e1b561637e", "committedDate": "2020-02-19T09:02:58Z", "message": "Exclude empty lines via param\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "567fb03de0cf5cd011dac28987197f6f5a0db4b3", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/567fb03de0cf5cd011dac28987197f6f5a0db4b3", "committedDate": "2020-02-19T09:03:46Z", "message": "Add migration script for Summary and Balance Report\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8a334d0306d72c9a7e95acb4ab4b00802fd44c7", "author": {"user": {"login": "TheBestPessimist", "name": "TheBestPessimist"}}, "url": "https://github.com/metasfresh/metasfresh/commit/e8a334d0306d72c9a7e95acb4ab4b00802fd44c7", "committedDate": "2020-02-19T13:14:18Z", "message": "Remove redundant order by inside CTE\n\nhttps://github.com/metasfresh/metasfresh/issues/6190"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3617, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}