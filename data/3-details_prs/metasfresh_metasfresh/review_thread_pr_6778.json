{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2NTE1MzYx", "number": 6778, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMTozNzozNVrOEBtMCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNToxMFrOEBuVnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMjI0MzkzOnYy", "diffSide": "RIGHT", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMTozNzozNVrOGdtrYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjoyMDo1MFrOGdvDAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzgxMDI3NA==", "bodyText": "wanted to call, but i think it's better to list my questions..\n\nsince we are in the isRefreshAllAfterExecution() branch, don't we have to find a way to invalidate all records?\nin case of isRefreshAllAfterExecution() == false, shouldn't we still make sure to invalidate the selected record?\nin the dev-test you wrote \"select a product and run the process\". So, i can imagine the test succeeds with a single record. but what if more than one record is selected?\nmaybe consult with Teo?", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433810274", "createdAt": "2020-06-02T11:37:35Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{\n+\t\t\t\tviewSupplier.get().invalidateAll();\n+\t\t\t\tviewInvalidateAllCalled = true;\n+\t\t\t}\n+\t\t\telse if (currentSingleSelectedDocumentRef != null)\n+\t\t\t{\n+\t\t\t\tdocumentsCollection.invalidateDocumentByRecordId(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzgzMjcwNQ==", "bodyText": "One short, the case of more than one record selected is already covered by previous lines:\n\n\nin case of isRefreshAllAfterExecution() == false, shouldn't we still make sure to invalidate the selected record?\n\nHm.. it is wanted? Not sure.", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433832705", "createdAt": "2020-06-02T12:20:50Z", "author": {"login": "cristinamghita"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{\n+\t\t\t\tviewSupplier.get().invalidateAll();\n+\t\t\t\tviewInvalidateAllCalled = true;\n+\t\t\t}\n+\t\t\telse if (currentSingleSelectedDocumentRef != null)\n+\t\t\t{\n+\t\t\t\tdocumentsCollection.invalidateDocumentByRecordId(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzgxMDI3NA=="}, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMjQzMTcxOnYy", "diffSide": "RIGHT", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNDo1N1rOGdvg8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNDo1N1rOGdvg8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg0MDM3MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t{ // multible rows selected", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433840370", "createdAt": "2020-06-02T12:34:57Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMjQzMjMxOnYy", "diffSide": "RIGHT", "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNToxMFrOGdvhXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjozNToxMFrOGdvhXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg0MDQ3Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t{\n          \n          \n            \n            \t\t\t{ // single row selected", "url": "https://github.com/metasfresh/metasfresh/pull/6778#discussion_r433840477", "createdAt": "2020-06-02T12:35:10Z", "author": {"login": "metas-ts"}, "path": "backend/metasfresh-webui-api/src/main/java/de/metas/ui/web/process/adprocess/ADProcessPostProcessService.java", "diffHunk": "@@ -126,10 +130,19 @@ private void invalidateDocumentsAndViews(final ViewId viewId, final ProcessExecu\n \t\t//\n \t\t// Refresh all\n \t\tboolean viewInvalidateAllCalled = false;\n-\t\tif (processExecutionResult.isRefreshAllAfterExecution() && viewSupplier.get() != null)\n+\t\tif (processExecutionResult.isRefreshAllAfterExecution())\n \t\t{\n-\t\t\tviewSupplier.get().invalidateAll();\n-\t\t\tviewInvalidateAllCalled = true;\n+\t\t\tif (viewSupplier.get() != null)\n+\t\t\t{\n+\t\t\t\tviewSupplier.get().invalidateAll();\n+\t\t\t\tviewInvalidateAllCalled = true;\n+\t\t\t}\n+\t\t\telse if (currentSingleSelectedDocumentRef != null)\n+\t\t\t{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c30e9b3f3c0ae74de6d7bdaff5c6ef530d1eda2"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1457, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}