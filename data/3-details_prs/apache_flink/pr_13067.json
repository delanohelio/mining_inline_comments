{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMjYyMzAy", "number": 13067, "title": "[FLINK-18821][network] Report PartitionRequest failures to subsequent\u2026", "bodyText": "What is the purpose of the change\nCurrently, an exception in PartitionRequestClientFactory is propagated to the client directly.\nThe future in the internal PartitionRequestClientFactory map is not completed exceptionally.\nThis causes subsequent calls to wait indefinitely for the future to complete (see FLINK-18821).\nThis PR fixes it by completing the future exceptionally in case of error.\nVerifying this change\nAdded unit test: PartitionRequestClientFactoryTest.testFailureReportedToSubsequentRequests\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no\nIf yes, how is the feature documented? no", "createdAt": "2020-08-05T09:27:09Z", "url": "https://github.com/apache/flink/pull/13067", "merged": true, "mergeCommit": {"oid": "3dbb8a5ac36c42137ba815426730c5aa705fe385"}, "closed": true, "closedAt": "2020-08-07T02:41:19Z", "author": {"login": "rkhachatryan"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc73qHwAH2gAyNDYzMjYyMzAyOmUzYWQzOTFiNDhiN2ZmYzRhNWViZDM3MTdlMGY5OTgwODUyMmNiMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8O2NMgH2gAyNDYzMjYyMzAyOjk5MTJkNmZkNjQ3NTdiY2U5OTZiNDM4YmVmZWU0NjJmMWRlYmMyZWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e3ad391b48b7ffc4a5ebd3717e0f99808522cb28", "author": {"user": {"login": "rkhachatryan", "name": "Roman"}}, "url": "https://github.com/apache/flink/commit/e3ad391b48b7ffc4a5ebd3717e0f99808522cb28", "committedDate": "2020-08-05T09:18:24Z", "message": "[FLINK-18821][network] Report PartitionRequest failures to subsequent callers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMjkxNjEx", "url": "https://github.com/apache/flink/pull/13067#pullrequestreview-462291611", "createdAt": "2020-08-06T08:22:29Z", "commit": {"oid": "e3ad391b48b7ffc4a5ebd3717e0f99808522cb28"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwODoyMjoyOVrOG8ogKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwODoyMjoyOVrOG8ogKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjIzMTMzNg==", "bodyText": "I added a similar method to FutureUtils called runSync (but it creates a new future). Would it make sense to keep the names in sync? (I have no hard feeling about renaming runSync).", "url": "https://github.com/apache/flink/pull/13067#discussion_r466231336", "createdAt": "2020-08-06T08:22:29Z", "author": {"login": "AHeise"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/concurrent/FutureUtils.java", "diffHunk": "@@ -90,6 +90,21 @@\n \t\t}\n \t}\n \n+\t/**\n+\t * Fakes asynchronous execution by immediately executing the operation and completing the supplied future\n+\t * either noramlly or exceptionally.\n+\t *\n+\t * @param operation to executed\n+\t * @param <T> type of the result\n+\t */\n+\tpublic static <T> void completeFromCallable(CompletableFuture<T> future, Callable<T> operation) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3ad391b48b7ffc4a5ebd3717e0f99808522cb28"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9912d6fd64757bce996b438befee462f1debc2ea", "author": {"user": {"login": "rkhachatryan", "name": "Roman"}}, "url": "https://github.com/apache/flink/commit/9912d6fd64757bce996b438befee462f1debc2ea", "committedDate": "2020-08-06T12:19:25Z", "message": "[hotfix] Remove unused FutureUtils.runSync"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4967, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}