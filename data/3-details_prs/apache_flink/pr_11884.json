{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3ODc4MjYz", "number": 11884, "title": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog.", "bodyText": "What is the purpose of the change\nThis pull request supports register and get Python UDF in catalog via sql ddl.\nBrief change log\n\nSupport register python catalog UDF via SQL DDL.\nSupport create, get and alter python catalog UDF in HiveCatalog.\n\nVerifying this change\nThis change is already covered by existing tests, such as PythonFunctionFactoryTest, HiveCatalogTest, GenericInMemoryCatalogTest.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (no)\nThe serializers: (no)\nThe runtime per-record code paths (performance sensitive): (no)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (no)\nThe S3 file system connector: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes)\nIf yes, how is the feature documented? (docs)", "createdAt": "2020-04-23T12:18:07Z", "url": "https://github.com/apache/flink/pull/11884", "merged": true, "mergeCommit": {"oid": "90fed7225a27dd45de2b98e8ee654e67c2bdf723"}, "closed": true, "closedAt": "2020-04-24T14:53:15Z", "author": {"login": "WeiZhong94"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaea22AFqTM5OTE5NjYyNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcasQxFgBqjMyNjgxNjA2MjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MTk2NjI0", "url": "https://github.com/apache/flink/pull/11884#pullrequestreview-399196624", "createdAt": "2020-04-23T15:08:42Z", "commit": {"oid": "ecd663181bfe20940c7c2ff311100f9007316392"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNTowODo0M1rOGKtNJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNToxNDozMlrOGKthqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg3OTU5MQ==", "bodyText": "Could you explain the aim of this change? It seems to me there is no difference between the changed logic and the original logic.", "url": "https://github.com/apache/flink/pull/11884#discussion_r413879591", "createdAt": "2020-04-23T15:08:43Z", "author": {"login": "dianfu"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/catalog/FunctionCatalog.java", "diffHunk": "@@ -194,22 +194,32 @@ public void registerCatalogFunction(\n \t\t\tUnresolvedIdentifier unresolvedIdentifier,\n \t\t\tClass<? extends UserDefinedFunction> functionClass,\n \t\t\tboolean ignoreIfExists) {\n-\t\tfinal ObjectIdentifier identifier = catalogManager.qualifyIdentifier(unresolvedIdentifier);\n-\t\tfinal ObjectIdentifier normalizedIdentifier = FunctionIdentifier.normalizeObjectIdentifier(identifier);\n \n \t\ttry {\n \t\t\tUserDefinedFunctionHelper.validateClass(functionClass);\n \t\t} catch (Throwable t) {\n \t\t\tthrow new ValidationException(\n \t\t\t\tString.format(\n \t\t\t\t\t\"Could not register catalog function '%s' due to implementation errors.\",\n-\t\t\t\t\tidentifier.asSummaryString()),\n+\t\t\t\t\tcatalogManager.qualifyIdentifier(unresolvedIdentifier).asSummaryString()),\n \t\t\t\tt);\n \t\t}\n \n-\t\tfinal Catalog catalog = catalogManager.getCatalog(normalizedIdentifier.getCatalogName())\n-\t\t\t.orElseThrow(IllegalStateException::new);\n-\t\tfinal ObjectPath path = identifier.toObjectPath();\n+\t\tfinal CatalogFunction catalogFunction = new CatalogFunctionImpl(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecd663181bfe20940c7c2ff311100f9007316392"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg4NDg0Mg==", "bodyText": "What's the aim of this change?", "url": "https://github.com/apache/flink/pull/11884#discussion_r413884842", "createdAt": "2020-04-23T15:14:32Z", "author": {"login": "dianfu"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/catalog/CatalogFunctionImpl.java", "diffHunk": "@@ -67,6 +67,9 @@ public CatalogFunction copy() {\n \n \t@Override\n \tpublic boolean isGeneric() {\n+\t\tif (functionLanguage == FunctionLanguage.PYTHON) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecd663181bfe20940c7c2ff311100f9007316392"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecd663181bfe20940c7c2ff311100f9007316392", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/ecd663181bfe20940c7c2ff311100f9007316392", "committedDate": "2020-04-23T12:13:39Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}, "afterCommit": {"oid": "570f7e22326fc2f2d9f7dff4066192b604e7c479", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/570f7e22326fc2f2d9f7dff4066192b604e7c479", "committedDate": "2020-04-24T02:00:56Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "570f7e22326fc2f2d9f7dff4066192b604e7c479", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/570f7e22326fc2f2d9f7dff4066192b604e7c479", "committedDate": "2020-04-24T02:00:56Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}, "afterCommit": {"oid": "3579637b38484fb5589c309fea8e803ad3c2e4e0", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/3579637b38484fb5589c309fea8e803ad3c2e4e0", "committedDate": "2020-04-24T02:51:03Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5Njk4NjU4", "url": "https://github.com/apache/flink/pull/11884#pullrequestreview-399698658", "createdAt": "2020-04-24T07:21:33Z", "commit": {"oid": "3579637b38484fb5589c309fea8e803ad3c2e4e0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78e23cbb5c0ec424f89a83bffa5146e428237fea", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/78e23cbb5c0ec424f89a83bffa5146e428237fea", "committedDate": "2020-04-24T07:21:54Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3579637b38484fb5589c309fea8e803ad3c2e4e0", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/3579637b38484fb5589c309fea8e803ad3c2e4e0", "committedDate": "2020-04-24T02:51:03Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}, "afterCommit": {"oid": "78e23cbb5c0ec424f89a83bffa5146e428237fea", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/78e23cbb5c0ec424f89a83bffa5146e428237fea", "committedDate": "2020-04-24T07:21:54Z", "message": "[FLINK-17345][python][table] Support register and get Python UDF in Catalog."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4834, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}