{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNDQ0NTIw", "number": 14423, "title": "[FLINK-20673][table-planner-blink] ExecNode#getOutputType method should return LogicalType instead of RowType", "bodyText": "What is the purpose of the change\nCurrently, ExecNode#getOutputType always returns RowType. But some nodes do not return RowData, such as BatchExecSink and StreamExecSink. The output type of ExecNode should be consistent with the type parameter T. So ExecNode#getOutputType should return LogicalType instead of RowType, each subclass cast the LogicalType to specific type when using it.\nBrief change log\n\nChange ExecNode#getOutputType's return type from RowType to LogicalType\n\nVerifying this change\nThis change is a refactoring rework covered by existing tests.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-12-18T10:12:30Z", "url": "https://github.com/apache/flink/pull/14423", "merged": true, "mergeCommit": {"oid": "ce43b7fe0ff24a7b8acdd5ac4d2ce9cc68476f09"}, "closed": true, "closedAt": "2020-12-20T15:44:12Z", "author": {"login": "godfreyhe"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnVY3hgFqTU1NTM2MTY3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnXiq3ABqjQxMjk2MzQxMDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MzYxNjcw", "url": "https://github.com/apache/flink/pull/14423#pullrequestreview-555361670", "createdAt": "2020-12-18T10:15:27Z", "commit": {"oid": "0cd0435254c0858f52ad5bd5f7d998ce2b9797e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1Mzk2MjU0", "url": "https://github.com/apache/flink/pull/14423#pullrequestreview-555396254", "createdAt": "2020-12-18T11:06:35Z", "commit": {"oid": "0cd0435254c0858f52ad5bd5f7d998ce2b9797e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTowNjozNVrOIIen-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTowNjozNVrOIIen-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc2MTI3Mg==", "bodyText": "You can link to JavaDoc of RowData for a mapping of logical types to internal data structures here.", "url": "https://github.com/apache/flink/pull/14423#discussion_r545761272", "createdAt": "2020-12-18T11:06:35Z", "author": {"login": "twalthr"}, "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/ExecNode.java", "diffHunk": "@@ -41,9 +41,11 @@\n \tString getDesc();\n \n \t/**\n-\t * Returns the output {@link RowType} of this node.\n+\t * Returns the output {@link LogicalType} of this node,\n+\t * this type should be consistent with the type parameter {@link T}.\n+\t * Such as, T is RowData, the output type should be RowType.\n \t */\n-\tRowType getOutputType();\n+\tLogicalType getOutputType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0cd0435254c0858f52ad5bd5f7d998ce2b9797e1"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c86de68aea339d2daa509f9ee8324fbd7aa2efea", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/c86de68aea339d2daa509f9ee8324fbd7aa2efea", "committedDate": "2020-12-18T12:45:26Z", "message": "[FLINK-20673][table-planner-blink] ExecNode#getOutputType method should return LogicalType instead of RowType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feca8bda1976f237787ea3219b567bff442e4568", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/feca8bda1976f237787ea3219b567bff442e4568", "committedDate": "2020-12-18T12:45:26Z", "message": "address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1507f5fd4747da2a8d3434b2cdbc883a1d332f2", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/c1507f5fd4747da2a8d3434b2cdbc883a1d332f2", "committedDate": "2020-12-18T12:24:33Z", "message": "address comments"}, "afterCommit": {"oid": "feca8bda1976f237787ea3219b567bff442e4568", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/feca8bda1976f237787ea3219b567bff442e4568", "committedDate": "2020-12-18T12:45:26Z", "message": "address comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3710, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}