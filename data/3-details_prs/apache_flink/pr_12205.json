{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MTczMzQ0", "number": 12205, "title": "[FLINK-17780][checkpointing] Add task name to log statements of ChannelStateWriter.", "bodyText": "What is the purpose of the change\nAdd task name to the executor thread and to all method of ChannelStateWriter (as they can be called from any other thread), such that log statements can be connected to the respective task.\nBrief change log\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-05-17T21:02:29Z", "url": "https://github.com/apache/flink/pull/12205", "merged": true, "mergeCommit": {"oid": "e7f7c5ebaec8ae46c3e5cb69ffdf3e60d703151e"}, "closed": true, "closedAt": "2020-05-20T13:27:48Z", "author": {"login": "AHeise"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciu6KQAFqTQxNDE1MTA5MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABci5XOkABqjMzNTMzMjA3NzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MTUxMDkw", "url": "https://github.com/apache/flink/pull/12205#pullrequestreview-414151090", "createdAt": "2020-05-19T06:56:50Z", "commit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNjo1Njo1MFrOGXSUzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNjo1Njo1MFrOGXSUzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA3MDY2OQ==", "bodyText": "nit missing white space: + \" interrupted\"", "url": "https://github.com/apache/flink/pull/12205#discussion_r427070669", "createdAt": "2020-05-19T06:56:50Z", "author": {"login": "pnowojski"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriteRequestExecutorImpl.java", "diffHunk": "@@ -79,7 +84,7 @@ private void loop() throws Exception {\n \t\t\t\tdispatcher.dispatch(deque.take());\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\tif (!wasClosed) {\n-\t\t\t\t\tLOG.debug(\"interrupted while waiting for a request (continue waiting)\", e);\n+\t\t\t\t\tLOG.debug(taskName + \"interrupted while waiting for a request (continue waiting)\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MTQ1MjAx", "url": "https://github.com/apache/flink/pull/12205#pullrequestreview-414145201", "createdAt": "2020-05-19T06:46:07Z", "commit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNjo0NjowN1rOGXSCoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzowMDo1MVrOGXScAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA2NjAxNg==", "bodyText": "add a white space\n\"interrupted... => \" interrupted...", "url": "https://github.com/apache/flink/pull/12205#discussion_r427066016", "createdAt": "2020-05-19T06:46:07Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriteRequestExecutorImpl.java", "diffHunk": "@@ -79,7 +84,7 @@ private void loop() throws Exception {\n \t\t\t\tdispatcher.dispatch(deque.take());\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\tif (!wasClosed) {\n-\t\t\t\t\tLOG.debug(\"interrupted while waiting for a request (continue waiting)\", e);\n+\t\t\t\t\tLOG.debug(taskName + \"interrupted while waiting for a request (continue waiting)\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA3MTU3OA==", "bodyText": "Should the first parameter be in a separate line?\nnit: add -> adds, similarly in other places. It reads a bit strange otherwise. But I do not think it is a big problem.", "url": "https://github.com/apache/flink/pull/12205#discussion_r427071578", "createdAt": "2020-05-19T06:58:53Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriterImpl.java", "diffHunk": "@@ -104,48 +111,57 @@ public void start(long checkpointId, CheckpointOptions checkpointOptions) {\n \n \t@Override\n \tpublic void addInputData(long checkpointId, InputChannelInfo info, int startSeqNum, Buffer... data) {\n-\t\tLOG.debug(\"add input data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",\n-\t\t\tcheckpointId, info, startSeqNum, data == null ? 0 : data.length);\n+\t\tLOG.debug(\"{} add input data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA3MjUxMw==", "bodyText": "a separate line?", "url": "https://github.com/apache/flink/pull/12205#discussion_r427072513", "createdAt": "2020-05-19T07:00:51Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriterImpl.java", "diffHunk": "@@ -104,48 +111,57 @@ public void start(long checkpointId, CheckpointOptions checkpointOptions) {\n \n \t@Override\n \tpublic void addInputData(long checkpointId, InputChannelInfo info, int startSeqNum, Buffer... data) {\n-\t\tLOG.debug(\"add input data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",\n-\t\t\tcheckpointId, info, startSeqNum, data == null ? 0 : data.length);\n+\t\tLOG.debug(\"{} add input data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",\n+\t\t\ttaskName,\n+\t\t\tcheckpointId,\n+\t\t\tinfo,\n+\t\t\tstartSeqNum,\n+\t\t\tdata == null ? 0 : data.length);\n \t\tenqueue(write(checkpointId, info, checkBufferType(data)), false);\n \t}\n \n \t@Override\n \tpublic void addOutputData(long checkpointId, ResultSubpartitionInfo info, int startSeqNum, Buffer... data) {\n-\t\tLOG.debug(\"add output data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",\n-\t\t\tcheckpointId, info, startSeqNum, data == null ? 0 : data.length);\n+\t\tLOG.debug(\"{} add output data, checkpoint id: {}, channel: {}, startSeqNum: {}, num buffers: {}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae108cca79cb02ce45cb8ec0657e7f04a5b55aef", "author": {"user": {"login": "AHeise", "name": "Arvid Heise"}}, "url": "https://github.com/apache/flink/commit/ae108cca79cb02ce45cb8ec0657e7f04a5b55aef", "committedDate": "2020-05-19T19:05:36Z", "message": "[FLINK-17780][checkpointing] Add task name to log statements of ChannelStateWriter.\n\nAdd task name to the executor thread and to all method of ChannelStateWriter (as they can be called from any other thread), such that log statements can be connected to the respective task."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "95793199f3be07aaf21dcefd2f7c7f8998be683d", "author": {"user": {"login": "AHeise", "name": "Arvid Heise"}}, "url": "https://github.com/apache/flink/commit/95793199f3be07aaf21dcefd2f7c7f8998be683d", "committedDate": "2020-05-17T20:59:03Z", "message": "[FLINK-17780][checkpointing] Add task name to log statements of ChannelStateWriter.\n\nAdd task name to the executor thread and to all method of ChannelStateWriter (as they can be called from any other thread), such that log statements can be connected to the respective task."}, "afterCommit": {"oid": "ae108cca79cb02ce45cb8ec0657e7f04a5b55aef", "author": {"user": {"login": "AHeise", "name": "Arvid Heise"}}, "url": "https://github.com/apache/flink/commit/ae108cca79cb02ce45cb8ec0657e7f04a5b55aef", "committedDate": "2020-05-19T19:05:36Z", "message": "[FLINK-17780][checkpointing] Add task name to log statements of ChannelStateWriter.\n\nAdd task name to the executor thread and to all method of ChannelStateWriter (as they can be called from any other thread), such that log statements can be connected to the respective task."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4144, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}