{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MjgxNTY5", "number": 14377, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDo0NjoyMFrOFGvkBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxOTo0N1rOFHGWHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjE1MDQ2OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-jdbc/src/main/java/org/apache/flink/table/descriptors/JdbcValidator.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDo0NjoyMFrOIH5Aow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDo0NjoyMFrOIH5Aow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE0NDk5NQ==", "bodyText": "Space is needed before 0.", "url": "https://github.com/apache/flink/pull/14377#discussion_r545144995", "createdAt": "2020-12-17T14:46:20Z", "author": {"login": "wangxlong"}, "path": "flink-connectors/flink-connector-jdbc/src/main/java/org/apache/flink/table/descriptors/JdbcValidator.java", "diffHunk": "@@ -115,7 +115,7 @@ private void validateReadProperties(DescriptorProperties properties) {\n \tprivate void validateLookupProperties(DescriptorProperties properties) {\n \t\tproperties.validateLong(CONNECTOR_LOOKUP_CACHE_MAX_ROWS, true);\n \t\tproperties.validateDuration(CONNECTOR_LOOKUP_CACHE_TTL, true, 1);\n-\t\tproperties.validateInt(CONNECTOR_LOOKUP_MAX_RETRIES, true);\n+\t\tproperties.validateInt(CONNECTOR_LOOKUP_MAX_RETRIES, true,0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0e212ed51c103765ada525c54ba3d83614f929a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjE3OTg1OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDo1MTo0NVrOIH5Rtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxNToyMFrOIIagtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE0OTM2Ng==", "bodyText": "// lookup max-retries property less than zero", "url": "https://github.com/apache/flink/pull/14377#discussion_r545149366", "createdAt": "2020-12-17T14:51:45Z", "author": {"login": "wangxlong"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "diffHunk": "@@ -255,6 +255,17 @@ public void testJdbcValidation() {\n \t\t\tfail(\"exception expected\");\n \t\t} catch (IllegalArgumentException ignored) {\n \t\t}\n+\n+\t\t// lookup max-retries properties not complete", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0e212ed51c103765ada525c54ba3d83614f929a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTY5Mzg3OQ==", "bodyText": "Please fix the comment", "url": "https://github.com/apache/flink/pull/14377#discussion_r545693879", "createdAt": "2020-12-18T09:15:20Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "diffHunk": "@@ -255,6 +255,17 @@ public void testJdbcValidation() {\n \t\t\tfail(\"exception expected\");\n \t\t} catch (IllegalArgumentException ignored) {\n \t\t}\n+\n+\t\t// lookup max-retries properties not complete", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE0OTM2Ng=="}, "originalCommit": {"oid": "c0e212ed51c103765ada525c54ba3d83614f929a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjE4NDc0OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcLookupTableITCase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNDo1Mjo0MlrOIH5Uog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwNTozODowOFrOIITz5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE1MDExNA==", "bodyText": "Would be better as following,\n\nJdbcLookupOptions.Builder lookupOptionsBuilder = JdbcLookupOptions.builder().setMaxRetryTimes(0);\nif (useCache) {\nlookupOptionsBuilder.setCacheMaxSize(1000).setCacheExpireMs(1000 * 1000);\n}\nbuilder.setLookupOptions(lookupOptionsBuilder.build());", "url": "https://github.com/apache/flink/pull/14377#discussion_r545150114", "createdAt": "2020-12-17T14:52:42Z", "author": {"login": "wangxlong"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcLookupTableITCase.java", "diffHunk": "@@ -120,7 +120,7 @@ public void testLookup() throws Exception {\n \t\t\t\t.build());\n \t\tif (useCache) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0e212ed51c103765ada525c54ba3d83614f929a"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTU4NDEwMQ==", "bodyText": "Thank you for your careful review, I have fixed the code", "url": "https://github.com/apache/flink/pull/14377#discussion_r545584101", "createdAt": "2020-12-18T05:38:08Z", "author": {"login": "xiaoHoly"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcLookupTableITCase.java", "diffHunk": "@@ -120,7 +120,7 @@ public void testLookup() throws Exception {\n \t\t\t\t.build());\n \t\tif (useCache) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE1MDExNA=="}, "originalCommit": {"oid": "c0e212ed51c103765ada525c54ba3d83614f929a"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyOTg3NTM0OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxODozNlrOIIar_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxODozNlrOIIar_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTY5Njc2Ng==", "bodyText": "Zero is a valid value, so there should no exception be thrown here. I think what we want to test is -1 here.", "url": "https://github.com/apache/flink/pull/14377#discussion_r545696766", "createdAt": "2020-12-18T09:18:36Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "diffHunk": "@@ -255,6 +255,17 @@ public void testJdbcValidation() {\n \t\t\tfail(\"exception expected\");\n \t\t} catch (IllegalArgumentException ignored) {\n \t\t}\n+\n+\t\t// lookup max-retries properties not complete\n+\t\ttry {\n+\t\t\tMap<String, String> properties = getBasicProperties();\n+\t\t\tproperties.put(\"connector.lookup.max-retries\", \"0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffcb3c699eb099caccb20aa38f372557e8a59306"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyOTg4MzE4OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxOTo0N1rOIIaw-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToxOTo0N1rOIIaw-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTY5ODA0Mw==", "bodyText": "This ignores the exception from fail(\"exception expected\"), we should catch the specific exception ValidationException here.", "url": "https://github.com/apache/flink/pull/14377#discussion_r545698043", "createdAt": "2020-12-18T09:19:47Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcTableSourceSinkFactoryTest.java", "diffHunk": "@@ -255,6 +255,17 @@ public void testJdbcValidation() {\n \t\t\tfail(\"exception expected\");\n \t\t} catch (IllegalArgumentException ignored) {\n \t\t}\n+\n+\t\t// lookup max-retries properties not complete\n+\t\ttry {\n+\t\t\tMap<String, String> properties = getBasicProperties();\n+\t\t\tproperties.put(\"connector.lookup.max-retries\", \"0\");\n+\n+\t\t\tTableFactoryService.find(StreamTableSourceFactory.class, properties)\n+\t\t\t\t.createStreamTableSource(properties);\n+\t\t\tfail(\"exception expected\");\n+\t\t} catch (Throwable ignored) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ffcb3c699eb099caccb20aa38f372557e8a59306"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4624, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}