{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NjUwNTU0", "number": 11400, "title": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors", "bodyText": "What is the purpose of the change\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future.\nBrief change log\n\nBuild InputChannelInfo in constructor of InputChannel\nBuild ResultSubpartitionInfo in constructor of ResultSubpartition\n\nVerifying this change\n\nAdded ResultPartitionTest#testResultSubpartitionInfo and SingleInputGateTest#testInputChannelInfo\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-03-13T08:22:27Z", "url": "https://github.com/apache/flink/pull/11400", "merged": true, "mergeCommit": {"oid": "ddec07323701a9998e854c378468617bafffa1f5"}, "closed": true, "closedAt": "2020-03-18T05:24:22Z", "author": {"login": "zhijiangW"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNL-tegBqjMxMjU4MDYxODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOuhH1ABqjMxMzk3OTIwNDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ca2fa84819dc112285aec27afcee6ccd3ba0ad8", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/2ca2fa84819dc112285aec27afcee6ccd3ba0ad8", "committedDate": "2020-03-13T08:20:29Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}, "afterCommit": {"oid": "a86f1e2e6785237893201dac302bc50041610d73", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/a86f1e2e6785237893201dac302bc50041610d73", "committedDate": "2020-03-13T08:24:13Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a86f1e2e6785237893201dac302bc50041610d73", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/a86f1e2e6785237893201dac302bc50041610d73", "committedDate": "2020-03-13T08:24:13Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}, "afterCommit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/835d5e2f86901bd8a85cf1d2aea9f91536bd132f", "committedDate": "2020-03-13T08:41:19Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTUxMTMz", "url": "https://github.com/apache/flink/pull/11400#pullrequestreview-374151133", "createdAt": "2020-03-13T09:23:50Z", "commit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOToyMzo1MFrOF18riA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOToyMzo1MFrOF18riA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjExMzAzMg==", "bodyText": "Wildcard imports are discouraged by flink style guide.", "url": "https://github.com/apache/flink/pull/11400#discussion_r392113032", "createdAt": "2020-03-13T09:23:50Z", "author": {"login": "rkhachatryan"}, "path": "flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java", "diffHunk": "@@ -60,10 +61,7 @@\n import java.io.IOException;\n import java.nio.ByteBuffer;\n import java.nio.ByteOrder;\n-import java.util.Arrays;\n-import java.util.HashMap;\n-import java.util.Map;\n-import java.util.Optional;\n+import java.util.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTUzNDEw", "url": "https://github.com/apache/flink/pull/11400#pullrequestreview-374153410", "createdAt": "2020-03-13T09:27:21Z", "commit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOToyNzoyMVrOF18yLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOToyNzoyMVrOF18yLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjExNDczMw==", "bodyText": "I think it's better to initialize it with an invalid value to force clients to set it.", "url": "https://github.com/apache/flink/pull/11400#discussion_r392114733", "createdAt": "2020-03-13T09:27:21Z", "author": {"login": "rkhachatryan"}, "path": "flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionBuilder.java", "diffHunk": "@@ -40,6 +40,8 @@\n \n \tprivate BoundedBlockingSubpartitionType blockingSubpartitionType = BoundedBlockingSubpartitionType.AUTO;\n \n+\tprivate int partitionIndex = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/835d5e2f86901bd8a85cf1d2aea9f91536bd132f", "committedDate": "2020-03-13T08:41:19Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}, "afterCommit": {"oid": "3c660599680944e8c6f2b3b0ceaf6975b03fc5c4", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/3c660599680944e8c6f2b3b0ceaf6975b03fc5c4", "committedDate": "2020-03-13T09:47:22Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MTY3ODUz", "url": "https://github.com/apache/flink/pull/11400#pullrequestreview-374167853", "createdAt": "2020-03-13T09:49:50Z", "commit": {"oid": "835d5e2f86901bd8a85cf1d2aea9f91536bd132f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1MTo0NlrOF19hrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1MTo0NlrOF19hrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEyNjg5NA==", "bodyText": "Here, we rely on iteration order (counter), but the type of inputGateDeploymentDescriptors is Collection.\nWhen it is created it is List though.\nSo I think we should change the type of TaskDeploymentDescriptor.inputGates and all parameters down to  inputGateDeploymentDescriptors  to List.", "url": "https://github.com/apache/flink/pull/11400#discussion_r392126894", "createdAt": "2020-03-13T09:51:46Z", "author": {"login": "rkhachatryan"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/NettyShuffleEnvironment.java", "diffHunk": "@@ -217,6 +218,7 @@ public ShuffleIOOwnerContext createShuffleIOOwnerContext(\n \t\t\tfor (InputGateDeploymentDescriptor igdd : inputGateDeploymentDescriptors) {\n \t\t\t\tSingleInputGate inputGate = singleInputGateFactory.create(\n \t\t\t\t\townerContext.getOwnerName(),\n+\t\t\t\t\tcounter,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c660599680944e8c6f2b3b0ceaf6975b03fc5c4"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3c660599680944e8c6f2b3b0ceaf6975b03fc5c4", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/3c660599680944e8c6f2b3b0ceaf6975b03fc5c4", "committedDate": "2020-03-13T09:47:22Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}, "afterCommit": {"oid": "5216b6412ed32669643e576b1879af2122f43e4b", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/5216b6412ed32669643e576b1879af2122f43e4b", "committedDate": "2020-03-13T13:29:07Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5057598901a93935fe1259ca53629cf5c27c07e9", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/5057598901a93935fe1259ca53629cf5c27c07e9", "committedDate": "2020-03-16T04:08:43Z", "message": "[hotfix][task][tests] Remove useless import from TaskTest"}, "afterCommit": {"oid": "ea3d7681318c2a9dcdcb6a27cae8c2f0e95ea316", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/ea3d7681318c2a9dcdcb6a27cae8c2f0e95ea316", "committedDate": "2020-03-16T04:13:35Z", "message": "[hotfix][task][tests] Remove useless import from TaskTest class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MTkwMjYz", "url": "https://github.com/apache/flink/pull/11400#pullrequestreview-376190263", "createdAt": "2020-03-17T16:16:36Z", "commit": {"oid": "ea3d7681318c2a9dcdcb6a27cae8c2f0e95ea316"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1eff48158b2bc4b76dab5d0bdac7b0a57132e18", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/e1eff48158b2bc4b76dab5d0bdac7b0a57132e18", "committedDate": "2020-03-18T03:10:40Z", "message": "[FLINK-16586][network] Build ResultSubpartitionInfo and InputChannelInfo in respective constructors\n\nIn the constructors of ResultSubpartition and InputChannel, the respective ResultSubpartitionInfo and InputChannelInfo should be created as well.\nThese infos would be used for interacting with ChannelStateReader and ChannelStateWriter future.\n\nThis cloese #11400."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0a936bd3411aa7ccaa7373fd51c0ed71a363629", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/f0a936bd3411aa7ccaa7373fd51c0ed71a363629", "committedDate": "2020-03-18T03:11:56Z", "message": "[hotfix][task][tests] Remove useless import from TaskTest class\n\nThis cloese #11400."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea3d7681318c2a9dcdcb6a27cae8c2f0e95ea316", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/ea3d7681318c2a9dcdcb6a27cae8c2f0e95ea316", "committedDate": "2020-03-16T04:13:35Z", "message": "[hotfix][task][tests] Remove useless import from TaskTest class"}, "afterCommit": {"oid": "f0a936bd3411aa7ccaa7373fd51c0ed71a363629", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/f0a936bd3411aa7ccaa7373fd51c0ed71a363629", "committedDate": "2020-03-18T03:11:56Z", "message": "[hotfix][task][tests] Remove useless import from TaskTest class\n\nThis cloese #11400."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2759, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}