{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1ODI3MjIx", "number": 13932, "title": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration for Print connector", "bodyText": "What is the purpose of the change\nSupport sink parallelism configuration for Print connector\nBrief change log\n\nSupport sink parallelism configuration for Print connector\n\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (no)\nThe serializers: (no)\nThe runtime per-record code paths (performance sensitive): (no)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (no)\nThe S3 file system connector: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes)\nIf yes, how is the feature documented? (docs)", "createdAt": "2020-11-05T06:24:51Z", "url": "https://github.com/apache/flink/pull/13932", "merged": true, "mergeCommit": {"oid": "af57682fdb2c46509d3b0bc8e51c6eff3b7f3558"}, "closed": true, "closedAt": "2020-12-18T14:33:03Z", "author": {"login": "zhuxiaoshang"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdka40TAFqTU0Nzk2NDQ2NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmm4fPgH2gAyNTE1ODI3MjIxOmMxNzAxZDc5ZDhmMDZmNWMzNWVlYTM4Y2E1ZWM4MjcyM2ZjZmQxOTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3OTY0NDY1", "url": "https://github.com/apache/flink/pull/13932#pullrequestreview-547964465", "createdAt": "2020-12-09T08:58:06Z", "commit": {"oid": "cd87ec7806bbe57badf0302188c7041a71349b59"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "author": {"user": null}, "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "committedDate": "2020-12-09T12:10:16Z", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd87ec7806bbe57badf0302188c7041a71349b59", "author": {"user": null}, "url": "https://github.com/apache/flink/commit/cd87ec7806bbe57badf0302188c7041a71349b59", "committedDate": "2020-11-05T06:34:55Z", "message": "update docs"}, "afterCommit": {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "author": {"user": null}, "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "committedDate": "2020-12-09T12:10:16Z", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTM4OTc4", "url": "https://github.com/apache/flink/pull/13932#pullrequestreview-548938978", "createdAt": "2020-12-10T08:08:56Z", "commit": {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwODowODo1N1rOIC8X3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwODowODo1N1rOIC8X3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NzIxNQ==", "bodyText": "Arrays.asList -> Collections.singletonList", "url": "https://github.com/apache/flink/pull/13932#discussion_r539957215", "createdAt": "2020-12-10T08:08:57Z", "author": {"login": "fsk119"}, "path": "flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/runtime/stream/table/PrintConnectorITCase.java", "diffHunk": "@@ -77,6 +77,31 @@ public void testStandardError() throws Exception {\n \t\ttest(true);\n \t}\n \n+\t@Test\n+\tpublic void testWithParallelism() throws Exception {\n+\t\ttEnv().executeSql(\"create table print_t (\" +\n+\t\t\t\t\"f0 int,\" +\n+\t\t\t\t\"f1 double\" +\n+\t\t\t\t\") with (\" +\n+\t\t\t\t\"'connector' = 'print',\" +\n+\t\t\t\t\"'print-identifier' = 'test_print',\" +\n+\t\t\t\t\"'sink.parallelism' = '2',\" +\n+\t\t\t\t\"'standard-error'='false')\");\n+\t\tDataType type = tEnv().from(\"print_t\").getSchema().toRowDataType();\n+\t\tRow row = Row.of(1, 1.1);\n+\t\ttEnv().fromValues(type, Arrays.asList(row)).executeInsert(\"print_t\").await();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5464e35dc08ff8d326e298987998e26441b92d92", "author": {"user": null}, "url": "https://github.com/apache/flink/commit/5464e35dc08ff8d326e298987998e26441b92d92", "committedDate": "2020-12-10T08:13:19Z", "message": "fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NzY5MDM3", "url": "https://github.com/apache/flink/pull/13932#pullrequestreview-549769037", "createdAt": "2020-12-11T03:02:29Z", "commit": {"oid": "5464e35dc08ff8d326e298987998e26441b92d92"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5ODY0OTMx", "url": "https://github.com/apache/flink/pull/13932#pullrequestreview-549864931", "createdAt": "2020-12-11T07:45:59Z", "commit": {"oid": "5464e35dc08ff8d326e298987998e26441b92d92"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNzo0NTo1OVrOIDsyoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNzo0NTo1OVrOIDsyoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc1MDQ5Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tprivate final Integer parallelism;\n          \n          \n            \n            \t\tprivate final @Nullable Integer parallelism;\n          \n      \n    \n    \n  \n\nWould be better to add @Nullable annotation.\nSee the Flink Code Style Guideline: https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional", "url": "https://github.com/apache/flink/pull/13932#discussion_r540750496", "createdAt": "2020-12-11T07:45:59Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java", "diffHunk": "@@ -95,19 +96,22 @@ public DynamicTableSink createDynamicTableSink(Context context) {\n \t\treturn new PrintSink(\n \t\t\t\tcontext.getCatalogTable().getSchema().toPhysicalRowDataType(),\n \t\t\t\toptions.get(PRINT_IDENTIFIER),\n-\t\t\t\toptions.get(STANDARD_ERROR));\n+\t\t\t\toptions.get(STANDARD_ERROR),\n+\t\t\t\toptions.getOptional(FactoryUtil.SINK_PARALLELISM).orElse(null));\n \t}\n \n \tprivate static class PrintSink implements DynamicTableSink {\n \n \t\tprivate final DataType type;\n \t\tprivate final String printIdentifier;\n \t\tprivate final boolean stdErr;\n+\t\tprivate final Integer parallelism;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5464e35dc08ff8d326e298987998e26441b92d92"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "author": {"user": {"login": "zhuxiaoshang", "name": null}}, "url": "https://github.com/apache/flink/commit/46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "committedDate": "2020-12-11T09:01:34Z", "message": "Update flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java\n\nCo-authored-by: Jark Wu <imjark@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5OTI3Nzg0", "url": "https://github.com/apache/flink/pull/13932#pullrequestreview-549927784", "createdAt": "2020-12-11T09:22:45Z", "commit": {"oid": "46501ddbb8fe78f1ae737862cd2f93d0ddc38793"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "author": {"user": {"login": "zhuxiaoshang", "name": null}}, "url": "https://github.com/apache/flink/commit/c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "committedDate": "2020-12-16T04:04:27Z", "message": "Update PrintTableSinkFactory.java\n\nadd import javax.annotation.Nullable;"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4808, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}