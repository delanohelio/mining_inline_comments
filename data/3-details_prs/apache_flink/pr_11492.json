{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyODAwMTA4", "number": 11492, "title": "[FLINK-16740][orc] OrcSplitReaderUtil::logicalTypeToOrcType fails to \u2026", "bodyText": "\u2026create decimal type with precision < 10\n\nWhat is the purpose of the change\nTypeDescription::DEFAULT_SCALE is 10. OrcSplitReaderUtil::logicalTypeToOrcType sets precision before it sets scale. So if we create a decimal type with precision<10, it'll cause an exception.\nBrief change log\n\nSets scale first in OrcSplitReaderUtil::logicalTypeToOrcType.\nAdd test for decimal type.\n\nVerifying this change\nAdded test case\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no\nIf yes, how is the feature documented? NA", "createdAt": "2020-03-24T06:21:10Z", "url": "https://github.com/apache/flink/pull/11492", "merged": true, "mergeCommit": {"oid": "d6a0e4a6f390a22f8a54db4469d0ce64a8e5d045"}, "closed": true, "closedAt": "2020-03-24T12:38:40Z", "author": {"login": "lirui-apache"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQsvGEAH2gAyMzkyODAwMTA4OjBhYTVmZGViMWNjYzFmNzk1YTg4NTIxOGExMDYyNGJhYWI0OGFlNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQt_R5gFqTM4MDA2MDY3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/0aa5fdeb1ccc1f795a885218a10624baab48ae63", "committedDate": "2020-03-24T06:16:08Z", "message": "[FLINK-16740][orc] OrcSplitReaderUtil::logicalTypeToOrcType fails to create decimal type with precision < 10"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMDI4NjA2", "url": "https://github.com/apache/flink/pull/11492#pullrequestreview-380028606", "createdAt": "2020-03-24T06:29:51Z", "commit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMDYwNjcx", "url": "https://github.com/apache/flink/pull/11492#pullrequestreview-380060671", "createdAt": "2020-03-24T07:43:43Z", "commit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo0Mzo0M1rOF6kFOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo0Mzo0M1rOF6kFOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1Mjg4OQ==", "bodyText": "Just curious why this order matters?", "url": "https://github.com/apache/flink/pull/11492#discussion_r396952889", "createdAt": "2020-03-24T07:43:43Z", "author": {"login": "KurtYoung"}, "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "diffHunk": "@@ -158,8 +158,8 @@ static TypeDescription logicalTypeToOrcType(LogicalType type) {\n \t\t\tcase DECIMAL:\n \t\t\t\tDecimalType decimalType = (DecimalType) type;\n \t\t\t\treturn TypeDescription.createDecimal()\n-\t\t\t\t\t\t.withPrecision(decimalType.getPrecision())\n-\t\t\t\t\t\t.withScale(decimalType.getScale());\n+\t\t\t\t\t\t.withScale(decimalType.getScale())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2466, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}