{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzMzIxODMx", "number": 13634, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxMDozOVrOEwPTTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMjoxNjo1MlrOEwkbUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MDE3ODA2OnYy", "diffSide": "RIGHT", "path": "flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroRowDataDeSerializationSchemaTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzoxMDozOVrOHlrBKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxMzo0MzoxNFrOHls3Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2NDE2OQ==", "bodyText": "We don't need to add such a big test. You can just add a null entry to the map in the testSerializeDeserialize.", "url": "https://github.com/apache/flink/pull/13634#discussion_r509264169", "createdAt": "2020-10-21T13:10:39Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroRowDataDeSerializationSchemaTest.java", "diffHunk": "@@ -198,4 +198,38 @@ public void testSpecificType() throws Exception {\n \t\tAssert.assertEquals(\"12:12:12\", DataFormatConverters.LocalTimeConverter.INSTANCE.toExternal(\n \t\t\t\trowData.getInt(2)).toString());\n \t}\n+\n+\t@Test\n+\tpublic void testNullableMapType() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d719acbd86db08cb920aac511e4ef0e82720469f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI5NDM5OA==", "bodyText": "OK, i will remove it , and add in the testSerializeDeserialize", "url": "https://github.com/apache/flink/pull/13634#discussion_r509294398", "createdAt": "2020-10-21T13:43:14Z", "author": {"login": "shizhengchao"}, "path": "flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroRowDataDeSerializationSchemaTest.java", "diffHunk": "@@ -198,4 +198,38 @@ public void testSpecificType() throws Exception {\n \t\tAssert.assertEquals(\"12:12:12\", DataFormatConverters.LocalTimeConverter.INSTANCE.toExternal(\n \t\t\t\trowData.getInt(2)).toString());\n \t}\n+\n+\t@Test\n+\tpublic void testNullableMapType() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI2NDE2OQ=="}, "originalCommit": {"oid": "d719acbd86db08cb920aac511e4ef0e82720469f"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzYzOTIwOnYy", "diffSide": "RIGHT", "path": "flink-formats/flink-avro/src/main/java/org/apache/flink/formats/avro/AvroToRowDataConverters.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMjoxNjo1MlrOHmOG6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMjo1Mzo1N1rOHmOtnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA==", "bodyText": "key can also be null?", "url": "https://github.com/apache/flink/pull/13634#discussion_r509839080", "createdAt": "2020-10-22T02:16:52Z", "author": {"login": "libenchao"}, "path": "flink-formats/flink-avro/src/main/java/org/apache/flink/formats/avro/AvroToRowDataConverters.java", "diffHunk": "@@ -178,7 +178,7 @@ private static AvroToRowDataConverter createArrayConverter(ArrayType arrayType)\n \n \tprivate static AvroToRowDataConverter createMapConverter(LogicalType type) {\n \t\tfinal AvroToRowDataConverter keyConverter = createConverter(DataTypes.STRING().getLogicalType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16a7e73c66d66707a59d19be6ace83ba664f20fc"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0NjM2Nw==", "bodyText": "Avro can't serialize null key for map.", "url": "https://github.com/apache/flink/pull/13634#discussion_r509846367", "createdAt": "2020-10-22T02:43:58Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-avro/src/main/java/org/apache/flink/formats/avro/AvroToRowDataConverters.java", "diffHunk": "@@ -178,7 +178,7 @@ private static AvroToRowDataConverter createArrayConverter(ArrayType arrayType)\n \n \tprivate static AvroToRowDataConverter createMapConverter(LogicalType type) {\n \t\tfinal AvroToRowDataConverter keyConverter = createConverter(DataTypes.STRING().getLogicalType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA=="}, "originalCommit": {"oid": "16a7e73c66d66707a59d19be6ace83ba664f20fc"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg0ODk4OQ==", "bodyText": "Avro can't serialize null key for map.\n\nThat's right, and this problem only exists when the type of map entry is STRING()", "url": "https://github.com/apache/flink/pull/13634#discussion_r509848989", "createdAt": "2020-10-22T02:53:57Z", "author": {"login": "shizhengchao"}, "path": "flink-formats/flink-avro/src/main/java/org/apache/flink/formats/avro/AvroToRowDataConverters.java", "diffHunk": "@@ -178,7 +178,7 @@ private static AvroToRowDataConverter createArrayConverter(ArrayType arrayType)\n \n \tprivate static AvroToRowDataConverter createMapConverter(LogicalType type) {\n \t\tfinal AvroToRowDataConverter keyConverter = createConverter(DataTypes.STRING().getLogicalType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgzOTA4MA=="}, "originalCommit": {"oid": "16a7e73c66d66707a59d19be6ace83ba664f20fc"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 143, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}