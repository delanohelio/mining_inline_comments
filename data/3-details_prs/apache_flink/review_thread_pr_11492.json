{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyODAwMTA4", "number": 11492, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo0Mzo0M1rODqrHfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo0Mzo0M1rODqrHfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MDczMjE1OnYy", "diffSide": "RIGHT", "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo0Mzo0M1rOF6kFOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwNzo1Mzo0NlrOF6kX2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1Mjg4OQ==", "bodyText": "Just curious why this order matters?", "url": "https://github.com/apache/flink/pull/11492#discussion_r396952889", "createdAt": "2020-03-24T07:43:43Z", "author": {"login": "KurtYoung"}, "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "diffHunk": "@@ -158,8 +158,8 @@ static TypeDescription logicalTypeToOrcType(LogicalType type) {\n \t\t\tcase DECIMAL:\n \t\t\t\tDecimalType decimalType = (DecimalType) type;\n \t\t\t\treturn TypeDescription.createDecimal()\n-\t\t\t\t\t\t.withPrecision(decimalType.getPrecision())\n-\t\t\t\t\t\t.withScale(decimalType.getScale());\n+\t\t\t\t\t\t.withScale(decimalType.getScale())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1NjgxMA==", "bodyText": "I had some explanations in the description of this PR. In short, it's because ORC TypeDescription assumes default scale to be 10, and asserts scale < precision when we set the precision.\nIt'd be better if they provide an interface to set precision and scale in one go.", "url": "https://github.com/apache/flink/pull/11492#discussion_r396956810", "createdAt": "2020-03-24T07:52:11Z", "author": {"login": "lirui-apache"}, "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "diffHunk": "@@ -158,8 +158,8 @@ static TypeDescription logicalTypeToOrcType(LogicalType type) {\n \t\t\tcase DECIMAL:\n \t\t\t\tDecimalType decimalType = (DecimalType) type;\n \t\t\t\treturn TypeDescription.createDecimal()\n-\t\t\t\t\t\t.withPrecision(decimalType.getPrecision())\n-\t\t\t\t\t\t.withScale(decimalType.getScale());\n+\t\t\t\t\t\t.withScale(decimalType.getScale())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1Mjg4OQ=="}, "originalCommit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1NzY1OA==", "bodyText": "public TypeDescription withPrecision(int precision) {\n    if (precision < 1 || precision > MAX_PRECISION || **scale > precision**){\n      throw new IllegalArgumentException(\"precision \" + precision +\n          \" is out of range 1 .. \" + scale);\n    }\n    this.precision = precision;\n    return this;\n  }\n\nThere is check in withPrecision, and default scale is 10.", "url": "https://github.com/apache/flink/pull/11492#discussion_r396957658", "createdAt": "2020-03-24T07:53:46Z", "author": {"login": "JingsongLi"}, "path": "flink-formats/flink-orc/src/main/java/org/apache/flink/orc/OrcSplitReaderUtil.java", "diffHunk": "@@ -158,8 +158,8 @@ static TypeDescription logicalTypeToOrcType(LogicalType type) {\n \t\t\tcase DECIMAL:\n \t\t\t\tDecimalType decimalType = (DecimalType) type;\n \t\t\t\treturn TypeDescription.createDecimal()\n-\t\t\t\t\t\t.withPrecision(decimalType.getPrecision())\n-\t\t\t\t\t\t.withScale(decimalType.getScale());\n+\t\t\t\t\t\t.withScale(decimalType.getScale())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njk1Mjg4OQ=="}, "originalCommit": {"oid": "0aa5fdeb1ccc1f795a885218a10624baab48ae63"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 693, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}