{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NTY4MDU4", "number": 11214, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDowNzoyMVrODituUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDowNzoyMVrODituUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3NzI3MzE0OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/sources/CsvTableSourceFactoryBase.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDowNzoyMVrOFuHWGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDo1MTo0MFrOFuJChQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg5OTE2MQ==", "bodyText": "Maybe we can have a small utility in the class to get the LogicalType List from TableSchema? Then we don't need the long method chain.", "url": "https://github.com/apache/flink/pull/11214#discussion_r383899161", "createdAt": "2020-02-25T14:07:21Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/sources/CsvTableSourceFactoryBase.java", "diffHunk": "@@ -123,7 +126,15 @@ protected CsvTableSource createTableSource(\n \t\t\tTableSchema formatSchema = params.getTableSchema(FORMAT_FIELDS);\n \t\t\t// the CsvTableSource needs some rework first\n \t\t\t// for now the schema must be equal to the encoding\n-\t\t\tif (!formatSchema.equals(tableSchema)) {\n+\t\t\t// Ignore conversion classes in DataType\n+\t\t\tif (!Arrays\n+\t\t\t\t\t.stream(formatSchema.getFieldDataTypes())\n+\t\t\t\t\t.map(DataType::getLogicalType)\n+\t\t\t\t\t.collect(Collectors.toList())\n+\t\t\t\t\t.equals(Arrays\n+\t\t\t\t\t\t\t.stream(tableSchema.getFieldDataTypes())\n+\t\t\t\t\t\t\t.map(DataType::getLogicalType)\n+\t\t\t\t\t\t\t.collect(Collectors.toList()))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b25a5519591a0c994e7c30b8f6a3e0b693290c12"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzkyNjkxNw==", "bodyText": "OK", "url": "https://github.com/apache/flink/pull/11214#discussion_r383926917", "createdAt": "2020-02-25T14:51:40Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/sources/CsvTableSourceFactoryBase.java", "diffHunk": "@@ -123,7 +126,15 @@ protected CsvTableSource createTableSource(\n \t\t\tTableSchema formatSchema = params.getTableSchema(FORMAT_FIELDS);\n \t\t\t// the CsvTableSource needs some rework first\n \t\t\t// for now the schema must be equal to the encoding\n-\t\t\tif (!formatSchema.equals(tableSchema)) {\n+\t\t\t// Ignore conversion classes in DataType\n+\t\t\tif (!Arrays\n+\t\t\t\t\t.stream(formatSchema.getFieldDataTypes())\n+\t\t\t\t\t.map(DataType::getLogicalType)\n+\t\t\t\t\t.collect(Collectors.toList())\n+\t\t\t\t\t.equals(Arrays\n+\t\t\t\t\t\t\t.stream(tableSchema.getFieldDataTypes())\n+\t\t\t\t\t\t\t.map(DataType::getLogicalType)\n+\t\t\t\t\t\t\t.collect(Collectors.toList()))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzg5OTE2MQ=="}, "originalCommit": {"oid": "b25a5519591a0c994e7c30b8f6a3e0b693290c12"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1016, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}