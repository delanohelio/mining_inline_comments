{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMzY5NTI1", "number": 11026, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzozMDozNVrODdVMgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzozMDozNVrODdVMgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyMDgyNTYzOnYy", "diffSide": "RIGHT", "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SourceStreamTask.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzozMDozNVrOFl3tzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzo1MDoxNFrOFl4V8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI1NDQ3OA==", "bodyText": "We probably need to restore interruption flag Thread.interrupt().", "url": "https://github.com/apache/flink/pull/11026#discussion_r375254478", "createdAt": "2020-02-05T13:30:35Z", "author": {"login": "AHeise"}, "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SourceStreamTask.java", "diffHunk": "@@ -121,10 +123,12 @@ protected void processInput(MailboxDefaultAction.Controller controller) throws E\n \t\tsourceThread.setTaskDescription(getName());\n \t\tsourceThread.start();\n \t\tsourceThread.getCompletionFuture().whenComplete((Void ignore, Throwable sourceThreadThrowable) -> {\n-\t\t\tif (sourceThreadThrowable == null || isFinished) {\n-\t\t\t\tmailboxProcessor.allActionsCompleted();\n-\t\t\t} else {\n+\t\t\tif (isCanceled() && ExceptionUtils.findThrowable(sourceThreadThrowable, InterruptedException.class).isPresent()) {\n+\t\t\t\tmailboxProcessor.reportThrowable(new CancelTaskException(sourceThreadThrowable));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8eaafb64c3d0d2b9045b2fea974a3bb04927cf8"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI2NDc1NQ==", "bodyText": "Interruption is internal to SourceStreamTask, so I think the flag shouldn't be set.", "url": "https://github.com/apache/flink/pull/11026#discussion_r375264755", "createdAt": "2020-02-05T13:50:14Z", "author": {"login": "rkhachatryan"}, "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SourceStreamTask.java", "diffHunk": "@@ -121,10 +123,12 @@ protected void processInput(MailboxDefaultAction.Controller controller) throws E\n \t\tsourceThread.setTaskDescription(getName());\n \t\tsourceThread.start();\n \t\tsourceThread.getCompletionFuture().whenComplete((Void ignore, Throwable sourceThreadThrowable) -> {\n-\t\t\tif (sourceThreadThrowable == null || isFinished) {\n-\t\t\t\tmailboxProcessor.allActionsCompleted();\n-\t\t\t} else {\n+\t\t\tif (isCanceled() && ExceptionUtils.findThrowable(sourceThreadThrowable, InterruptedException.class).isPresent()) {\n+\t\t\t\tmailboxProcessor.reportThrowable(new CancelTaskException(sourceThreadThrowable));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI1NDQ3OA=="}, "originalCommit": {"oid": "c8eaafb64c3d0d2b9045b2fea974a3bb04927cf8"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1033, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}