{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMDk5MjAx", "number": 13061, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjoxNTozOVrOEVO20g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjo0Mzo1M1rOEVPKBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNjk4OTYyOnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjoxNTozOVrOG73tBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzowNTo1NlrOG74e_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzMTgxNA==", "bodyText": "Please be careful about these unnecessary changes.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465431814", "createdAt": "2020-08-05T02:15:39Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "diffHunk": "@@ -22,9 +22,12 @@\n \n import unittest\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0NDYwNA==", "bodyText": "Thank you, I will pay more attention to it.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465444604", "createdAt": "2020-08-05T03:05:56Z", "author": {"login": "shuiqiangchen"}, "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "diffHunk": "@@ -22,9 +22,12 @@\n \n import unittest\n \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzMTgxNA=="}, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNzAwOTg3OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjoyNzoyOFrOG734yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzowNjo0N1rOG74fuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzNDgyNQ==", "bodyText": "There are some problems with the design:\n\nwe need to pass java datastream object explicitly which should be avoided.\nwe need to specify True false manually. I think we can infer the true false from the input datastream, i.e., set true when output_type is PickledBytesTypeInfo.\n\nThe code may looks like:\ncollect_util = DataStreamCollectUtil()\ncollect_util.collect(ds)\nresults = collect_util.results()", "url": "https://github.com/apache/flink/pull/13061#discussion_r465434825", "createdAt": "2020-08-05T02:27:28Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "diffHunk": "@@ -211,3 +214,31 @@ def test_execute(self):\n         self.assertEqual(len(execution_result.get_all_accumulator_results()), 0)\n         self.assertIsNone(execution_result.get_accumulator_result('accumulator'))\n         self.assertIsNotNone(str(execution_result))\n+\n+    def test_from_collection_without_data_types(self):\n+        ds = self.env.from_collection([(1, 'Hi', 'Hello'), (2, 'Hello', 'Hi')])\n+        test_sink = DataStreamTestCollectSink(True)\n+        ds._j_data_stream.addSink(test_sink._j_data_stream_test_collect_sink)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0NDc5Mg==", "bodyText": "Yes, there might be some spaces for improvements.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465444792", "createdAt": "2020-08-05T03:06:47Z", "author": {"login": "shuiqiangchen"}, "path": "flink-python/pyflink/datastream/tests/test_stream_execution_environment.py", "diffHunk": "@@ -211,3 +214,31 @@ def test_execute(self):\n         self.assertEqual(len(execution_result.get_all_accumulator_results()), 0)\n         self.assertIsNone(execution_result.get_accumulator_result('accumulator'))\n         self.assertIsNotNone(str(execution_result))\n+\n+    def test_from_collection_without_data_types(self):\n+        ds = self.env.from_collection([(1, 'Hi', 'Hello'), (2, 'Hello', 'Hi')])\n+        test_sink = DataStreamTestCollectSink(True)\n+        ds._j_data_stream.addSink(test_sink._j_data_stream_test_collect_sink)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzNDgyNQ=="}, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNzAxMzc0OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/datastream/tests/test_util.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjoyOTo0MFrOG736-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzowNzowM1rOG74f5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzNTM4NQ==", "bodyText": "Refactor the class according to the comments above.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465435385", "createdAt": "2020-08-05T02:29:40Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/datastream/tests/test_util.py", "diffHunk": "@@ -0,0 +1,45 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+import pickle\n+\n+from pyflink.java_gateway import get_gateway\n+\n+\n+class DataStreamTestCollectSink(object):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0NDgzOA==", "bodyText": "Ok, I will do it.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465444838", "createdAt": "2020-08-05T03:07:03Z", "author": {"login": "shuiqiangchen"}, "path": "flink-python/pyflink/datastream/tests/test_util.py", "diffHunk": "@@ -0,0 +1,45 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+import pickle\n+\n+from pyflink.java_gateway import get_gateway\n+\n+\n+class DataStreamTestCollectSink(object):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzNTM4NQ=="}, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNzAzODc3OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/datastream/data_stream.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjo0Mzo1M1rOG74Jow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzowNToxM1rOG74eZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzOTEzOQ==", "bodyText": "Should also add tests to verify these methods.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465439139", "createdAt": "2020-08-05T02:43:53Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/datastream/data_stream.py", "diffHunk": "@@ -0,0 +1,162 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+from pyflink.common import typeinfo, ExecutionConfig\n+from pyflink.common.typeinfo import TypeInformation\n+\n+\n+class DataStream(object):\n+    \"\"\"\n+    A DataStream represents a stream of elements of the same type. A DataStream can be transformed\n+    into another DataStream by applying a transformation as for example:\n+    ::\n+        >>> DataStream.map(MapFunctionImpl())\n+        >>> DataStream.filter(FilterFunctionImpl())\n+    \"\"\"\n+\n+    def __init__(self, j_data_stream):\n+        self._j_data_stream = j_data_stream\n+\n+    def get_name(self) -> str:\n+        \"\"\"\n+        Gets the name of the current data stream. This name is used by the visualization and logging\n+        during runtime.\n+\n+        :return: Name of the stream.\n+        \"\"\"\n+        return self._j_data_stream.getName()\n+\n+    def name(self, name: str):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0NDQ1Mg==", "bodyText": "Yes, I will add the corresponding tests to verify them.", "url": "https://github.com/apache/flink/pull/13061#discussion_r465444452", "createdAt": "2020-08-05T03:05:13Z", "author": {"login": "shuiqiangchen"}, "path": "flink-python/pyflink/datastream/data_stream.py", "diffHunk": "@@ -0,0 +1,162 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+from pyflink.common import typeinfo, ExecutionConfig\n+from pyflink.common.typeinfo import TypeInformation\n+\n+\n+class DataStream(object):\n+    \"\"\"\n+    A DataStream represents a stream of elements of the same type. A DataStream can be transformed\n+    into another DataStream by applying a transformation as for example:\n+    ::\n+        >>> DataStream.map(MapFunctionImpl())\n+        >>> DataStream.filter(FilterFunctionImpl())\n+    \"\"\"\n+\n+    def __init__(self, j_data_stream):\n+        self._j_data_stream = j_data_stream\n+\n+    def get_name(self) -> str:\n+        \"\"\"\n+        Gets the name of the current data stream. This name is used by the visualization and logging\n+        during runtime.\n+\n+        :return: Name of the stream.\n+        \"\"\"\n+        return self._j_data_stream.getName()\n+\n+    def name(self, name: str):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzOTEzOQ=="}, "originalCommit": {"oid": "8ccc4bad17d568058446ad6816a6d181f090ecf0"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4906, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}