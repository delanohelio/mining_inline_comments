{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMzkwMDM3", "number": 11439, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzoyNjozOVrODpW0Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzo0MDowMVrODpW9iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjkxOTk5OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/nodes/physical/batch/BatchExecPythonCalc.scala", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzoyNjozOVrOF4e3Vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzoyNjozOVrOF4e3Vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3MDI2Mw==", "bodyText": "Change to getConfig(planner.getTableConfig)? so that we don't need to change the signature of createPythonOneInputTransformation()", "url": "https://github.com/apache/flink/pull/11439#discussion_r394770263", "createdAt": "2020-03-19T03:26:39Z", "author": {"login": "hequn8128"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/nodes/physical/batch/BatchExecPythonCalc.scala", "diffHunk": "@@ -58,7 +58,7 @@ class BatchExecPythonCalc(\n       inputTransform,\n       calcProgram,\n       \"BatchExecPythonCalc\",\n-      planner.getTableConfig.getConfiguration)\n+      planner.getTableConfig)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d65c0ec99a4b0ca509ebd83d55a5f9c21aa40db5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0NjkzMDk0OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/table/types.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzozMzo1MVrOF4e96Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzozMzo1MVrOF4e96Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3MTk0NQ==", "bodyText": "Take local timezone into consideration? For example, time 0h in Japen should return -1h in China.", "url": "https://github.com/apache/flink/pull/11439#discussion_r394771945", "createdAt": "2020-03-19T03:33:51Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/table/types.py", "diffHunk": "@@ -490,12 +492,20 @@ def need_conversion(self):\n \n     def to_sql_type(self, dt):\n         if dt is not None:\n+            if dt.tzinfo is not None:\n+                offset = dt.utcoffset()\n+                offset = offset if offset else datetime.timedelta()\n+                offset_microseconds =\\\n+                    (offset.days * 86400 + offset.seconds) * 10 ** 6 + offset.microseconds\n+            else:\n+                offset_microseconds = self.EPOCH_ORDINAL\n             seconds = (calendar.timegm(dt.utctimetuple()) if dt.tzinfo\n                        else time.mktime(dt.timetuple()))\n-            return int(seconds) * 10 ** 6 + dt.microsecond\n+            return int(seconds) * 10 ** 6 + dt.microsecond + offset_microseconds", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d65c0ec99a4b0ca509ebd83d55a5f9c21aa40db5"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0Njk0NDA4OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coders.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzo0MDowMVrOF4fF-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMzo0MDowMVrOF4fF-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc3NDAwOQ==", "bodyText": "Add python tests for the coder. e.g. tests in test_coders_common.py.", "url": "https://github.com/apache/flink/pull/11439#discussion_r394774009", "createdAt": "2020-03-19T03:40:01Z", "author": {"login": "hequn8128"}, "path": "flink-python/pyflink/fn_execution/coders.py", "diffHunk": "@@ -377,6 +380,22 @@ def to_type_hint(self):\n         return datetime.datetime\n \n \n+class LocalZonedTimestampCoder(DeterministicCoder):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d65c0ec99a4b0ca509ebd83d55a5f9c21aa40db5"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 807, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}