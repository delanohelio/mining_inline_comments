{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NDQxNzEx", "number": 13991, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzoxOToxNlrOE5e-Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzoyNjoyNVrOE5fJNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NzExNzU1OnYy", "diffSide": "LEFT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeResultPartition.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzoxOToxNlrOHz-WjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzo0MjowMVrOHz_NWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI2MTAwNA==", "bodyText": "Could you please also add the component name to the commit message? Also This closes #13991. should probably appear in the last commit.", "url": "https://github.com/apache/flink/pull/13991#discussion_r524261004", "createdAt": "2020-11-16T13:19:16Z", "author": {"login": "AHeise"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeResultPartition.java", "diffHunk": "@@ -317,7 +317,6 @@ public ResultSubpartitionView createSubpartitionView(\n \t\t\t\tavailabilityListener,\n \t\t\t\tresultFile);\n \t\t\treaders.add(reader);\n-\t\t\tavailabilityListener.notifyDataAvailable();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92e8080fd8d3d2d5a13b2c7d30d288460ce9adb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI3NTAzNQ==", "bodyText": "Fixed.", "url": "https://github.com/apache/flink/pull/13991#discussion_r524275035", "createdAt": "2020-11-16T13:42:01Z", "author": {"login": "wsry"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeResultPartition.java", "diffHunk": "@@ -317,7 +317,6 @@ public ResultSubpartitionView createSubpartitionView(\n \t\t\t\tavailabilityListener,\n \t\t\t\tresultFile);\n \t\t\treaders.add(reader);\n-\t\t\tavailabilityListener.notifyDataAvailable();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI2MTAwNA=="}, "originalCommit": {"oid": "f92e8080fd8d3d2d5a13b2c7d30d288460ce9adb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NzE0NTQ5OnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeSubpartitionReader.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzoyNjoyNVrOHz-now==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxMzo0Mzo0NFrOHz_Riw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI2NTM3OQ==", "bodyText": "Do we need to return the segments to the MemoryManager? I guess not since they are unpooled.", "url": "https://github.com/apache/flink/pull/13991#discussion_r524265379", "createdAt": "2020-11-16T13:26:25Z", "author": {"login": "AHeise"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeSubpartitionReader.java", "diffHunk": "@@ -138,7 +138,9 @@ public void notifyDataAvailable() {\n \n \t@Override\n \tpublic void recycle(MemorySegment segment) {\n-\t\treadBuffers.add(segment);\n+\t\tif (!isReleased) {\n+\t\t\treadBuffers.add(segment);\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c44538769371ce3114274f3322168a9fe18e4875"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI3NjEwNw==", "bodyText": "You are right, the buffers are unpooled so we do not need to return the segments to the MemoryManager.", "url": "https://github.com/apache/flink/pull/13991#discussion_r524276107", "createdAt": "2020-11-16T13:43:44Z", "author": {"login": "wsry"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/SortMergeSubpartitionReader.java", "diffHunk": "@@ -138,7 +138,9 @@ public void notifyDataAvailable() {\n \n \t@Override\n \tpublic void recycle(MemorySegment segment) {\n-\t\treadBuffers.add(segment);\n+\t\tif (!isReleased) {\n+\t\t\treadBuffers.add(segment);\n+\t\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI2NTM3OQ=="}, "originalCommit": {"oid": "c44538769371ce3114274f3322168a9fe18e4875"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4850, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}