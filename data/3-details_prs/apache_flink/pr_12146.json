{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3ODM3NjIz", "number": 12146, "title": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat", "bodyText": "What is the purpose of the change\nBecause the Configuration in HBaseRowInputFormat cannot be serialized, the task cannot obtain the zk address set in the table parameter, which prevents the task from connecting to Hbase.\nBecause the default value of hbase.zookeeper.quorum is localhost, the unit test is ok\nBrief change log\nFix failure to read hbase table\nVerifying this change\nno\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no\nIf yes, how is the feature documented? not documented", "createdAt": "2020-05-14T08:32:38Z", "url": "https://github.com/apache/flink/pull/12146", "merged": true, "mergeCommit": {"oid": "03b82f9aa81b828b06c61f7f30f92a331ec5120b"}, "closed": true, "closedAt": "2020-06-02T03:26:33Z", "author": {"login": "Tartarus0zm"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmCqEhAH2gAyNDE3ODM3NjIzOjU5ODIwODY3ZWI0NmNkYjI4NzBjYTY1MDBhYzkzODU4OTIzNTkwZjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcm3xrtgFqTQyMTU3NjMzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9", "author": {"user": {"login": "Tartarus0zm", "name": "zhangmang"}}, "url": "https://github.com/apache/flink/commit/59820867eb46cdb2870ca6500ac93858923590f9", "committedDate": "2020-05-29T13:40:58Z", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e9f1a46dd294b87fc5577a36d1fdd634ac3c64e", "author": {"user": {"login": "Tartarus0zm", "name": "zhangmang"}}, "url": "https://github.com/apache/flink/commit/2e9f1a46dd294b87fc5577a36d1fdd634ac3c64e", "committedDate": "2020-05-14T08:31:02Z", "message": "[hotfix][hbase]Fix HBaseRowInputFormat cannot get the zk address set in the table property"}, "afterCommit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9", "author": {"user": {"login": "Tartarus0zm", "name": "zhangmang"}}, "url": "https://github.com/apache/flink/commit/59820867eb46cdb2870ca6500ac93858923590f9", "committedDate": "2020-05-29T13:40:58Z", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDk0NDc2", "url": "https://github.com/apache/flink/pull/12146#pullrequestreview-421494476", "createdAt": "2020-05-31T13:25:07Z", "commit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxMzoyNTowN1rOGc4_Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxMzoyNzo1M1rOGc4__A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0Njk2Nw==", "bodyText": "How about to call it getHadoopConfiguration ? Because the returned value is not \"serialized\".", "url": "https://github.com/apache/flink/pull/12146#discussion_r432946967", "createdAt": "2020-05-31T13:25:07Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java", "diffHunk": "@@ -99,6 +108,14 @@\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n+\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {\n+\t\tserializedConfig = HBaseConfigurationUtil.serializeConfiguration(hConf);\n+\t}\n+\n+\tprotected org.apache.hadoop.conf.Configuration getSerializedConfig() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0Njk5NQ==", "bodyText": "I think we don't need such method, we can directly call HBaseConfigurationUtil.serializeConfiguration in the construct?", "url": "https://github.com/apache/flink/pull/12146#discussion_r432946995", "createdAt": "2020-05-31T13:25:30Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/AbstractTableInputFormat.java", "diffHunk": "@@ -99,6 +108,14 @@\n \t */\n \tpublic abstract void configure(Configuration parameters);\n \n+\tprotected void setSerializedConfig(org.apache.hadoop.conf.Configuration hConf) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NzE5Ng==", "bodyText": "Could you add some Javadoc on this? What is the hConf and what values should be contained in the hConf?", "url": "https://github.com/apache/flink/pull/12146#discussion_r432947196", "createdAt": "2020-05-31T13:27:53Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-hbase/src/main/java/org/apache/flink/connector/hbase/source/HBaseInputFormat.java", "diffHunk": "@@ -36,6 +35,10 @@\n \n \tprivate static final long serialVersionUID = 1L;\n \n+\tpublic HBaseInputFormat(org.apache.hadoop.conf.Configuration hConf) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59820867eb46cdb2870ca6500ac93858923590f9"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea008e0dffab41f7f3ac373746605cdc3f6a2388", "author": {"user": {"login": "Tartarus0zm", "name": "zhangmang"}}, "url": "https://github.com/apache/flink/commit/ea008e0dffab41f7f3ac373746605cdc3f6a2388", "committedDate": "2020-06-01T02:37:16Z", "message": "[FLINK-17968][hbase] Fix Hadoop Configuration is not properly serialized in HBaseRowInputFormat"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNTc2MzMy", "url": "https://github.com/apache/flink/pull/12146#pullrequestreview-421576332", "createdAt": "2020-06-01T03:34:15Z", "commit": {"oid": "ea008e0dffab41f7f3ac373746605cdc3f6a2388"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4970, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}