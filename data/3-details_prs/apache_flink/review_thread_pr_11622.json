{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NjYxOTc2", "number": 11622, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNDozMFrODuBa1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowODo0MlrODuBh-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NTg0MzQxOnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBOptions.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNDozMFrOF_yaYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjoxOTowNFrOF_zBgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMDU2MQ==", "bodyText": "Is it a problem that the type of the config option changes. You mentioned to me before that this could impact users, which is correct.\nI would not be too worried, though, because most users probably would not use this in code but rather in the yaml config.", "url": "https://github.com/apache/flink/pull/11622#discussion_r402430561", "createdAt": "2020-04-02T16:04:30Z", "author": {"login": "aljoscha"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBOptions.java", "diffHunk": "@@ -47,9 +48,10 @@\n \t * Choice of timer service implementation.\n \t */\n \t@Documentation.Section(Documentation.Sections.STATE_BACKEND_ROCKSDB)\n-\tpublic static final ConfigOption<String> TIMER_SERVICE_FACTORY = ConfigOptions\n+\tpublic static final ConfigOption<PriorityQueueStateType> TIMER_SERVICE_FACTORY = ConfigOptions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abc70d0db7c027b6ff3777d38ac9f67699b8659f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMTc5NA==", "bodyText": "Also, weirdly named option: it's a \"factory\" but the type is an enum? \ud83d\ude05", "url": "https://github.com/apache/flink/pull/11622#discussion_r402431794", "createdAt": "2020-04-02T16:06:12Z", "author": {"login": "aljoscha"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBOptions.java", "diffHunk": "@@ -47,9 +48,10 @@\n \t * Choice of timer service implementation.\n \t */\n \t@Documentation.Section(Documentation.Sections.STATE_BACKEND_ROCKSDB)\n-\tpublic static final ConfigOption<String> TIMER_SERVICE_FACTORY = ConfigOptions\n+\tpublic static final ConfigOption<PriorityQueueStateType> TIMER_SERVICE_FACTORY = ConfigOptions", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMDU2MQ=="}, "originalCommit": {"oid": "abc70d0db7c027b6ff3777d38ac9f67699b8659f"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ0MDU3OA==", "bodyText": "I would not be too worried, though, because most users probably would not use this in code but rather in the yaml config.\n\nThat was also my thinking after looking at it again. The class RocksDBOptions has no annotation, so it is not necessarily Public. Moreover I think we do not advertise using those options directly. Programatically users should rather use org.apache.flink.contrib.streaming.state.RocksDBStateBackend#setPriorityQueueStateType, if I am not mistaken.", "url": "https://github.com/apache/flink/pull/11622#discussion_r402440578", "createdAt": "2020-04-02T16:19:04Z", "author": {"login": "dawidwys"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBOptions.java", "diffHunk": "@@ -47,9 +48,10 @@\n \t * Choice of timer service implementation.\n \t */\n \t@Documentation.Section(Documentation.Sections.STATE_BACKEND_ROCKSDB)\n-\tpublic static final ConfigOption<String> TIMER_SERVICE_FACTORY = ConfigOptions\n+\tpublic static final ConfigOption<PriorityQueueStateType> TIMER_SERVICE_FACTORY = ConfigOptions", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMDU2MQ=="}, "originalCommit": {"oid": "abc70d0db7c027b6ff3777d38ac9f67699b8659f"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NTg1NzY2OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackendConfigTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNzo0NFrOF_yjWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNzo0NFrOF_yjWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMjg1Nw==", "bodyText": "Nit: you could just turn the field into a ConfigOption.", "url": "https://github.com/apache/flink/pull/11622#discussion_r402432857", "createdAt": "2020-04-02T16:07:44Z", "author": {"login": "aljoscha"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackendConfigTest.java", "diffHunk": "@@ -792,8 +794,11 @@ public ColumnFamilyOptions createColumnOptions(ColumnFamilyOptions currentOption\n \t\t}\n \n \t\t@Override\n-\t\tpublic RocksDBOptionsFactory configure(Configuration configuration) {\n-\t\t\tthis.backgroundJobs = configuration.getInteger(BACKGROUND_JOBS_OPTION, DEFAULT_BACKGROUND_JOBS);\n+\t\tpublic RocksDBOptionsFactory configure(ReadableConfig configuration) {\n+\t\t\tthis.backgroundJobs = configuration.get(\n+\t\t\t\tConfigOptions.key(BACKGROUND_JOBS_OPTION)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abc70d0db7c027b6ff3777d38ac9f67699b8659f"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NTg2MTY4OnYy", "diffSide": "RIGHT", "path": "flink-tests/src/test/java/org/apache/flink/test/checkpointing/EventTimeWindowCheckpointingITCase.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowODo0MlrOF_yl4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowODo0MlrOF_yl4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMzUwNg==", "bodyText": "wouldn't config.set(RocksDBOptions.TIMER_SERVICE_FACTORY, ...) work?", "url": "https://github.com/apache/flink/pull/11622#discussion_r402433506", "createdAt": "2020-04-02T16:08:42Z", "author": {"login": "aljoscha"}, "path": "flink-tests/src/test/java/org/apache/flink/test/checkpointing/EventTimeWindowCheckpointingITCase.java", "diffHunk": "@@ -179,7 +179,7 @@ private Configuration getConfiguration() throws Exception {\n \t\t\tcase ROCKSDB_INCREMENTAL:\n \t\t\t\t// Test RocksDB based timer service as well\n \t\t\t\tconfig.setString(\n-\t\t\t\t\tRocksDBOptions.TIMER_SERVICE_FACTORY,\n+\t\t\t\t\tRocksDBOptions.TIMER_SERVICE_FACTORY.key(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abc70d0db7c027b6ff3777d38ac9f67699b8659f"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 616, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}