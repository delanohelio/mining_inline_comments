{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMTcyMDk3", "number": 10995, "title": "[FLINK-15847][ml] Include flink-ml-api and flink-ml-lib in opt", "bodyText": "What is the purpose of the change\nThis pull request adds the jar of flink-ml into the opt folder so that users can directly use the jars with the binary release. For example, users can move the jars into the lib folder or use -j to upload the jar.\nBrief change log\n\nAdds maven-shade-plugin in the pom of flink-ml-lib module\nAdds a file config similar to sql-client in flink-dist/src/main/assemblies/opt.xml\n\nVerifying this change\n\nThis change is a trivial rework / code cleanup without any test coverage.\nBuild Flink locally and check jars in opt.\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (no)\nThe serializers: (no)\nThe runtime per-record code paths (performance sensitive): (no)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)\nThe S3 file system connector: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (no)", "createdAt": "2020-02-03T07:55:08Z", "url": "https://github.com/apache/flink/pull/10995", "merged": true, "mergeCommit": {"oid": "6deca76e76e6e3b8aeff2de4cdc5b0616219bd5b"}, "closed": true, "closedAt": "2020-02-27T13:16:01Z", "author": {"login": "hequn8128"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcApBVjgH2gAyMzcwMTcyMDk3OjEzODVmNDJhNzZiYTAwNjBkMzcwMjI4NzMwNjRlNzM2ZDUyZWEwYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIYR_fgFqTM2NTU0NTYwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/1385f42a76ba0060d37022873064e736d52ea0af", "committedDate": "2020-02-03T08:53:39Z", "message": "[FLINK-15847][ml] Include flink-ml-api and flink-ml-lib in opt"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "65debfebc1bad896666160a6375b9c78ea8eb063", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/65debfebc1bad896666160a6375b9c78ea8eb063", "committedDate": "2020-02-03T07:39:14Z", "message": "[FLINK-15847][ml] Include flink-ml-api and flink-ml-lib in opt"}, "afterCommit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/1385f42a76ba0060d37022873064e736d52ea0af", "committedDate": "2020-02-03T08:53:39Z", "message": "[FLINK-15847][ml] Include flink-ml-api and flink-ml-lib in opt"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMTQxOTIx", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-352141921", "createdAt": "2020-02-03T10:10:02Z", "commit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMDoxMDowM1rOFksKpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMDoxMDowM1rOFksKpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDAxNjY3OA==", "bodyText": "licensing needs to be updated", "url": "https://github.com/apache/flink/pull/10995#discussion_r374016678", "createdAt": "2020-02-03T10:10:03Z", "author": {"login": "zentol"}, "path": "flink-ml-parent/flink-ml-lib/pom.xml", "diffHunk": "@@ -57,4 +57,30 @@ under the License.\n \t\t\t<version>1.1.2</version>\n \t\t</dependency>\n \t</dependencies>\n+\n+\t<build>\n+\t\t<plugins>\n+\t\t\t<!-- Build flink-ml-lib jar -->\n+\t\t\t<plugin>\n+\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n+\t\t\t\t<artifactId>maven-shade-plugin</artifactId>\n+\t\t\t\t<executions>\n+\t\t\t\t\t<execution>\n+\t\t\t\t\t\t<id>shade-flink</id>\n+\t\t\t\t\t\t<phase>package</phase>\n+\t\t\t\t\t\t<goals>\n+\t\t\t\t\t\t\t<goal>shade</goal>\n+\t\t\t\t\t\t</goals>\n+\t\t\t\t\t\t<configuration>\n+\t\t\t\t\t\t\t<artifactSet>\n+\t\t\t\t\t\t\t\t<includes combine.children=\"append\">\n+\t\t\t\t\t\t\t\t\t<include>com.github.fommil.netlib:core</include>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NzY2MzU4", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-358766358", "createdAt": "2020-02-14T08:05:03Z", "commit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwODowNTowM1rOFpuR3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQwODowNTowM1rOFpuR3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTI5NDE3NQ==", "bodyText": "Should we add a module \"flink-ml-uber\" just like \"flink-table-uber\" to create a fat job for flink ml module? Currently it assumes that the flink-ml-api is packaged in the fat jar of flink-ml-lib. This seems a little wired for me. It would be great if more people could share the thoughts on this?", "url": "https://github.com/apache/flink/pull/10995#discussion_r379294175", "createdAt": "2020-02-14T08:05:03Z", "author": {"login": "dianfu"}, "path": "flink-dist/src/main/assemblies/opt.xml", "diffHunk": "@@ -168,6 +168,14 @@\n \t\t\t<destName>flink-python_${scala.binary.version}-${project.version}.jar</destName>\n \t\t\t<fileMode>0644</fileMode>\n \t\t</file>\n+\n+\t\t<!-- ML (API & LIB)  -->\n+\t\t<file>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/9c1edd078c466ee56f2aed16ce9098e35bfae69e", "committedDate": "2020-02-15T04:53:05Z", "message": "address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fdb8d92730a099a903893e663d9a986094ae5af6", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/fdb8d92730a099a903893e663d9a986094ae5af6", "committedDate": "2020-02-15T04:48:33Z", "message": "address comments"}, "afterCommit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/9c1edd078c466ee56f2aed16ce9098e35bfae69e", "committedDate": "2020-02-15T04:53:05Z", "message": "address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODQyNjc1", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-362842675", "createdAt": "2020-02-21T18:52:41Z", "commit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxODo1Mjo0MVrOFtBFtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxODo1Mjo0MVrOFtBFtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0ODA4NA==", "bodyText": "hmm. in fact the flink-ml-* packages are never release/bundled anyway. we should revert the LICENSE notice (in fact it shouldn't contain any LICENSE since only source codes were released: https://repo1.maven.org/maven2/org/apache/flink/flink-ml-lib_2.12/1.10.0/.\nHow should we proceed? should we have a revert in release-1.10 branch only and keep this PR intact?", "url": "https://github.com/apache/flink/pull/10995#discussion_r382748084", "createdAt": "2020-02-21T18:52:41Z", "author": {"login": "walterddr"}, "path": "flink-ml-parent/flink-ml-lib/pom.xml", "diffHunk": "@@ -57,4 +57,30 @@ under the License.\n \t\t\t<version>1.1.2</version>\n \t\t</dependency>\n \t</dependencies>\n+\n+\t<build>\n+\t\t<plugins>\n+\t\t\t<!-- Build flink-ml-lib jar -->\n+\t\t\t<plugin>\n+\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n+\t\t\t\t<artifactId>maven-shade-plugin</artifactId>\n+\t\t\t\t<executions>\n+\t\t\t\t\t<execution>\n+\t\t\t\t\t\t<id>shade-flink</id>\n+\t\t\t\t\t\t<phase>package</phase>\n+\t\t\t\t\t\t<goals>\n+\t\t\t\t\t\t\t<goal>shade</goal>\n+\t\t\t\t\t\t</goals>\n+\t\t\t\t\t\t<configuration>\n+\t\t\t\t\t\t\t<artifactSet>\n+\t\t\t\t\t\t\t\t<includes combine.children=\"append\">\n+\t\t\t\t\t\t\t\t\t<include>com.github.fommil.netlib:core</include>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDAxNjY3OA=="}, "originalCommit": {"oid": "1385f42a76ba0060d37022873064e736d52ea0af"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMzU0MDQ5", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-363354049", "createdAt": "2020-02-24T12:29:16Z", "commit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODg3NTE3", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-364887517", "createdAt": "2020-02-26T13:16:51Z", "commit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoxNjo1MlrOFurEzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoxNjo1MlrOFurEzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4NDU1Ng==", "bodyText": "I would move this (and the corresponding NOTICE) into the uber module.\nThe basic idea is that the uber module is responsible for all things related to the distribution. The individual modules usually shouldn't have to shade dependencies; users should set flink-ml dependencies to provided anyways so we don't have to concerned about them accidently bundling this dependency.", "url": "https://github.com/apache/flink/pull/10995#discussion_r384484556", "createdAt": "2020-02-26T13:16:52Z", "author": {"login": "zentol"}, "path": "flink-ml-parent/flink-ml-lib/pom.xml", "diffHunk": "@@ -57,4 +60,30 @@ under the License.\n \t\t\t<version>1.1.2</version>\n \t\t</dependency>\n \t</dependencies>\n+\n+\t<build>\n+\t\t<plugins>\n+\t\t\t<!-- Build flink-ml-lib jar -->\n+\t\t\t<plugin>\n+\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n+\t\t\t\t<artifactId>maven-shade-plugin</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1edd078c466ee56f2aed16ce9098e35bfae69e"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "478491bde663e58f1e84753bf6fac3a7367ef195", "author": {"user": {"login": "hequn8128", "name": "Hequn Cheng"}}, "url": "https://github.com/apache/flink/commit/478491bde663e58f1e84753bf6fac3a7367ef195", "committedDate": "2020-02-27T03:12:33Z", "message": "move NOTICE into the uber module"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NTQ1NjAx", "url": "https://github.com/apache/flink/pull/10995#pullrequestreview-365545601", "createdAt": "2020-02-27T09:54:51Z", "commit": {"oid": "478491bde663e58f1e84753bf6fac3a7367ef195"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4579, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}