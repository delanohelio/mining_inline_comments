{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3MDI0NTk4", "number": 11387, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NToxN1rODnXFyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NzoyN1rODnXH5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNTk5MzY5OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NToxN1rOF1T_kA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NToxN1rOF1T_kA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjQxNg==", "bodyText": "Using match case?", "url": "https://github.com/apache/flink/pull/11387#discussion_r391446416", "createdAt": "2020-03-12T07:45:17Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92a95ede6d30f98203c696c58d17dca9069a940"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNTk5NDMzOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NTozNVrOF1UABQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwOTozODozNVrOF1XOSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjUzMw==", "bodyText": "Why not add this to BatchExecTableSourceScanRule?", "url": "https://github.com/apache/flink/pull/11387#discussion_r391446533", "createdAt": "2020-03-12T07:45:35Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {\n       throw new TableException(\"Catalog tables support only \"\n         + \"StreamTableSource and InputFormatTableSource\")\n     }\n+\n+    // validate TableSource when it is in batch mode\n+    if (!schemaTable.isStreamingMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92a95ede6d30f98203c696c58d17dca9069a940"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ5OTMzOQ==", "bodyText": "My initial thought is \"fail-fast\", throw the exception at ealier stage, just like the above validation which only allows StreamTableSource and InputFormatTableSource.", "url": "https://github.com/apache/flink/pull/11387#discussion_r391499339", "createdAt": "2020-03-12T09:38:35Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {\n       throw new TableException(\"Catalog tables support only \"\n         + \"StreamTableSource and InputFormatTableSource\")\n     }\n+\n+    // validate TableSource when it is in batch mode\n+    if (!schemaTable.isStreamingMode) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjUzMw=="}, "originalCommit": {"oid": "b92a95ede6d30f98203c696c58d17dca9069a940"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNTk5OTExOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NzoyN1rOF1UCxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNzo0NzoyN1rOF1UCxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NzIzNg==", "bodyText": "Can just use && to one if", "url": "https://github.com/apache/flink/pull/11387#discussion_r391447236", "createdAt": "2020-03-12T07:47:27Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {\n       throw new TableException(\"Catalog tables support only \"\n         + \"StreamTableSource and InputFormatTableSource\")\n     }\n+\n+    // validate TableSource when it is in batch mode\n+    if (!schemaTable.isStreamingMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92a95ede6d30f98203c696c58d17dca9069a940"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 767, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}