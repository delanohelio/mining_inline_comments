{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NTk5NDk4", "number": 12661, "title": "[FLINK-18299][json] Add option in json format to parse timestamp in different format standard", "bodyText": "What is the purpose of the change\nCurrently the behaviour of TIMESTAMP is not as same as it means. The main difference is that it can parse input timestamp with zone and output timestamp with zone.  So we fix the behaviour of TIMESTAMP and offer option 'timestamp-format.standard' for users to choose.\nBrief change log\n\nAdd formatters for timestamp with 'ISO-8601' or 'SQL' format\nExpose option 'timestamp-format.standard' in json options\nUse the value of option 'timestamp-format.standard' to select formatter to parse input timestamp\n\nVerifying this change\nThis change added tests and can be verified as follows:\n\nAdded illegal input value for 'timestamp-format.standard'\nExtended integration test for input timestamp with SQL or ISO-8601 format\nAdded illegal input timestamp test for SQL and ISO-8601 formatter\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-06-15T15:03:38Z", "url": "https://github.com/apache/flink/pull/12661", "merged": true, "mergeCommit": {"oid": "258a01e7189372ddbb621f8b57d18257a8bab0e5"}, "closed": true, "closedAt": "2020-06-17T13:32:10Z", "author": {"login": "fsk119"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr0IiigFqTQzMTQwNjI1Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsFLSKAFqTQzMjE1MjQ4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxNDA2MjU3", "url": "https://github.com/apache/flink/pull/12661#pullrequestreview-431406257", "createdAt": "2020-06-16T11:24:10Z", "commit": {"oid": "9994520727018f9f9583ce9b91d221c69346f0d2"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMToyNDoxMFrOGkW6Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMTo1NjoyMVrOGkX45Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc3NzI4Ng==", "bodyText": "You can make the timestampFormat as optional to avoid invoke it for every TestSpec.", "url": "https://github.com/apache/flink/pull/12661#discussion_r440777286", "createdAt": "2020-06-16T11:24:10Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonRowDataSerDeSchemaTest.java", "diffHunk": "@@ -383,73 +407,117 @@ private void testParseErrors(TestSpec spec) throws Exception {\n \t\tTestSpec\n \t\t\t.json(\"{\\\"id\\\": \\\"trueA\\\"}\")\n \t\t\t.rowType(ROW(FIELD(\"id\", BOOLEAN())))\n+\t\t\t.timestampFormat(\"ISO-8601\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9994520727018f9f9583ce9b91d221c69346f0d2"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc3OTExMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <li>Option <code>'ISO-8601'</code>will parse input timestamp in \"yyyy-MM-ddTHH:mm:ss.s{precision}\" format, e.g '2020-12-30T12:13:14.123' and output timestamp in the same way.</li>\n          \n          \n            \n                    <li>Option <code>'ISO-8601'</code>will parse input timestamp in \"yyyy-MM-ddTHH:mm:ss.s{precision}\" format, e.g '2020-12-30T12:13:14.123' and output timestamp in the same format.</li>", "url": "https://github.com/apache/flink/pull/12661#discussion_r440779110", "createdAt": "2020-06-16T11:27:50Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/json.md", "diffHunk": "@@ -103,6 +103,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+      <td><h5>json.timestamp-format.standard</h5></td>\n+      <td>optional</td>\n+      <td style=\"word-wrap: break-word;\"><code>'SQL'</code></td>\n+      <td>String</td>\n+      <td>Specify the input and output timestamp format. Currently supported values are <code>'SQL'</code> and <code>'ISO-8601'</code>:\n+      <ul>\n+        <li>Option <code>'SQL'</code> will parse input timestamp in \"yyyy-MM-dd HH:mm:ss.s{precision}\" format, e.g '2020-12-30 12:13:14.123' and output timestamp in the same way.</li>\n+        <li>Option <code>'ISO-8601'</code>will parse input timestamp in \"yyyy-MM-ddTHH:mm:ss.s{precision}\" format, e.g '2020-12-30T12:13:14.123' and output timestamp in the same way.</li>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9994520727018f9f9583ce9b91d221c69346f0d2"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc5Mjg3Mg==", "bodyText": "TimestampFormat.ISO_8601", "url": "https://github.com/apache/flink/pull/12661#discussion_r440792872", "createdAt": "2020-06-16T11:55:35Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonRowDataSerDeSchemaTest.java", "diffHunk": "@@ -168,7 +168,7 @@ public void testSerDe() throws Exception {\n \t\tassertEquals(expected, actual);\n \n \t\t// test serialization\n-\t\tJsonRowDataSerializationSchema serializationSchema = new JsonRowDataSerializationSchema(schema);\n+\t\tJsonRowDataSerializationSchema serializationSchema = new JsonRowDataSerializationSchema(schema,  JsonOptions.getTimestampFormatOption(\"ISO-8601\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9994520727018f9f9583ce9b91d221c69346f0d2"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc5MzMxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tthrown.expect(containsCause(new ValidationException(\"Unsupported value test for timestamp-format.standard. Supported values are [SQL, ISO-8601].\")));\n          \n          \n            \n            \t\tthrown.expect(containsCause(new ValidationException(\"Unsupported value 'test' for timestamp-format.standard. Supported values are [SQL, ISO-8601].\")));", "url": "https://github.com/apache/flink/pull/12661#discussion_r440793317", "createdAt": "2020-06-16T11:56:21Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java", "diffHunk": "@@ -91,6 +91,16 @@ public void testInvalidOptionForIgnoreParseErrors() {\n \t\ttestSchemaDeserializationSchema(tableOptions);\n \t}\n \n+\t@Test\n+\tpublic void testInvalidOptionForTimestampFormat() {\n+\t\tfinal Map<String, String> tableOptions = getModifyOptions(\n+\t\t\toptions -> options.put(\"json.timestamp-format.standard\", \"test\"));\n+\n+\t\tthrown.expect(ValidationException.class);\n+\t\tthrown.expect(containsCause(new ValidationException(\"Unsupported value test for timestamp-format.standard. Supported values are [SQL, ISO-8601].\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9994520727018f9f9583ce9b91d221c69346f0d2"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a27644dead7045e5a44289a4b886d940a27ea1a3", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/a27644dead7045e5a44289a4b886d940a27ea1a3", "committedDate": "2020-06-16T13:16:06Z", "message": "delete wrong annotation."}, "afterCommit": {"oid": "af50f547204f12002cc8ab146058b8c00aa454ab", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/af50f547204f12002cc8ab146058b8c00aa454ab", "committedDate": "2020-06-17T01:53:57Z", "message": "delete wrong annotation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDIyNjUx", "url": "https://github.com/apache/flink/pull/12661#pullrequestreview-432022651", "createdAt": "2020-06-17T02:51:27Z", "commit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "state": "COMMENTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMjo1MToyOFrOGkzz5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMzowNzowNlrOGk0CzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MDc4OQ==", "bodyText": "Put this exception in the default branch of swith.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441250789", "createdAt": "2020-06-17T02:51:28Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonOptions.java", "diffHunk": "@@ -38,4 +44,40 @@\n \t\t\t.defaultValue(false)\n \t\t\t.withDescription(\"Optional flag to skip fields and rows with parse errors instead of failing;\\n\"\n \t\t\t\t\t+ \"fields are set to null in case of errors, false by default\");\n+\n+\tpublic static final ConfigOption<String> TIMESTAMP_FORMAT = ConfigOptions\n+\t\t\t.key(\"timestamp-format.standard\")\n+\t\t\t.stringType()\n+\t\t\t.defaultValue(\"SQL\")\n+\t\t\t.withDescription(\"Optional flag to specify timestamp format, SQL by default.\" +\n+\t\t\t\t\" Option ISO-8601 will parse input timestamp in \\\"yyyy-MM-ddTHH:mm:ss.s{precision}\\\" format and output timestamp in the same format.\" +\n+\t\t\t\t\" Option SQL will parse input timestamp in \\\"yyyy-MM-dd HH:mm:ss.s{precision}\\\" format and output timestamp in the same format.\");\n+\n+\t// --------------------------------------------------------------------------------------------\n+\t// Option enumerations\n+\t// --------------------------------------------------------------------------------------------\n+\n+\tpublic static final String SQL = \"SQL\";\n+\tpublic static final String ISO_8601 = \"ISO-8601\";\n+\n+\tpublic static final Set<String> TIMESTAMP_FORMAT_ENUM = new HashSet<>(Arrays.asList(\n+\t\tSQL,\n+\t\tISO_8601\n+\t));\n+\n+\t// --------------------------------------------------------------------------------------------\n+\t// Utilities\n+\t// --------------------------------------------------------------------------------------------\n+\n+\tpublic static TimestampFormat getTimestampFormat(ReadableConfig config){\n+\t\tString timestampFormat = config.get(TIMESTAMP_FORMAT);\n+\t\tswitch (timestampFormat){\n+\t\t\tcase SQL:\n+\t\t\t\treturn TimestampFormat.SQL;\n+\t\t\tcase ISO_8601:\n+\t\t\t\treturn TimestampFormat.ISO_8601;\n+\t\t}\n+\t\tthrow new TableException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MTYyNg==", "bodyText": "Keep the original indent.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441251626", "createdAt": "2020-06-17T02:54:58Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/canal/CanalJsonDeserializationSchema.java", "diffHunk": "@@ -68,9 +69,10 @@\n \tprivate final int fieldCount;\n \n \tpublic CanalJsonDeserializationSchema(\n-\t\t\tRowType rowType,\n-\t\t\tTypeInformation<RowData> resultTypeInfo,\n-\t\t\tboolean ignoreParseErrors) {\n+\t\tRowType rowType,\n+\t\tTypeInformation<RowData> resultTypeInfo,\n+\t\tboolean ignoreParseErrors,\n+\t\tTimestampFormat timestampFormatOption) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MTg0Ng==", "bodyText": "Add this into optionalOptions().", "url": "https://github.com/apache/flink/pull/12661#discussion_r441251846", "createdAt": "2020-06-17T02:55:49Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactory.java", "diffHunk": "@@ -57,12 +59,9 @@\n \t\t\t\"This option indicates the Debezium JSON data include the schema in the message or not. \" +\n \t\t\t\"Default is false.\");\n \n-\tpublic static final ConfigOption<Boolean> IGNORE_PARSE_ERRORS = ConfigOptions\n-\t\t.key(\"ignore-parse-errors\")\n-\t\t.booleanType()\n-\t\t.defaultValue(false)\n-\t\t.withDescription(\"Optional flag to skip fields and rows with parse errors instead of failing, \" +\n-\t\t\t\"fields are set to null in case of errors. Default is false.\");\n+\tpublic static final ConfigOption<Boolean> IGNORE_PARSE_ERRORS = JsonOptions.IGNORE_PARSE_ERRORS;\n+\n+\tpublic static final ConfigOption<String> TIMESTAMP_FORMAT = JsonOptions.TIMESTAMP_FORMAT;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MTg2NQ==", "bodyText": "Add this into optionalOptions().", "url": "https://github.com/apache/flink/pull/12661#discussion_r441251865", "createdAt": "2020-06-17T02:55:54Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactory.java", "diffHunk": "@@ -48,12 +49,9 @@\n \n \tpublic static final String IDENTIFIER = \"canal-json\";\n \n-\tpublic static final ConfigOption<Boolean> IGNORE_PARSE_ERRORS = ConfigOptions\n-\t\t.key(\"ignore-parse-errors\")\n-\t\t.booleanType()\n-\t\t.defaultValue(false)\n-\t\t.withDescription(\"Optional flag to skip fields and rows with parse errors instead of failing, \" +\n-\t\t\t\"fields are set to null in case of errors. Default is false.\");\n+\tpublic static final ConfigOption<Boolean> IGNORE_PARSE_ERRORS = JsonOptions.IGNORE_PARSE_ERRORS;\n+\n+\tpublic static final ConfigOption<String> TIMESTAMP_FORMAT = JsonOptions.TIMESTAMP_FORMAT;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MTk5Mg==", "bodyText": "Keep the original indent.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441251992", "createdAt": "2020-06-17T02:56:22Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/debezium/DebeziumJsonDeserializationSchema.java", "diffHunk": "@@ -75,10 +76,11 @@\n \tprivate final boolean ignoreParseErrors;\n \n \tpublic DebeziumJsonDeserializationSchema(\n-\t\t\tRowType rowType,\n-\t\t\tTypeInformation<RowData> resultTypeInfo,\n-\t\t\tboolean schemaInclude,\n-\t\t\tboolean ignoreParseErrors) {\n+\t\tRowType rowType,\n+\t\tTypeInformation<RowData> resultTypeInfo,\n+\t\tboolean schemaInclude,\n+\t\tboolean ignoreParseErrors,\n+\t\tTimestampFormat timestampFormatOption) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MjMxNQ==", "bodyText": "Add TIMESTAMP_FORMAT into optionalOptions.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441252315", "createdAt": "2020-06-17T02:57:32Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonFileSystemFormatFactory.java", "diffHunk": "@@ -79,13 +79,15 @@ public String factoryIdentifier() {\n \t\tvalidateFormatOptions(options);\n \t\tboolean failOnMissingField = options.get(FAIL_ON_MISSING_FIELD);\n \t\tboolean ignoreParseErrors = options.get(IGNORE_PARSE_ERRORS);\n+\t\tTimestampFormat timestampOption = JsonOptions.getTimestampFormat(options);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MzA0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/** Options for timestamp format. */\n          \n          \n            \n            \t/** Timestamp format specification which is used to parse timestamp. */", "url": "https://github.com/apache/flink/pull/12661#discussion_r441253042", "createdAt": "2020-06-17T03:00:26Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonRowDataDeserializationSchema.java", "diffHunk": "@@ -93,11 +94,15 @@\n \t/** Object mapper for parsing the JSON. */\n \tprivate final ObjectMapper objectMapper = new ObjectMapper();\n \n+\t/** Options for timestamp format. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MzIyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/** Option for timestamp format. */\n          \n          \n            \n            \t/** Timestamp format specification which is used to generate timestamp. */", "url": "https://github.com/apache/flink/pull/12661#discussion_r441253225", "createdAt": "2020-06-17T03:01:04Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonRowDataSerializationSchema.java", "diffHunk": "@@ -72,8 +74,12 @@\n \t/** Reusable object node. */\n \tprivate transient ObjectNode node;\n \n-\tpublic JsonRowDataSerializationSchema(RowType rowType) {\n+\t/** Option for timestamp format. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MzQ3NA==", "bodyText": "Add this into equals and hashcode.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441253474", "createdAt": "2020-06-17T03:02:16Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonRowDataDeserializationSchema.java", "diffHunk": "@@ -93,11 +94,15 @@\n \t/** Object mapper for parsing the JSON. */\n \tprivate final ObjectMapper objectMapper = new ObjectMapper();\n \n+\t/** Options for timestamp format. */\n+\tprivate final TimestampFormat timestampFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MzUwNQ==", "bodyText": "Add this into equals and hashcode.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441253505", "createdAt": "2020-06-17T03:02:24Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/main/java/org/apache/flink/formats/json/JsonRowDataSerializationSchema.java", "diffHunk": "@@ -72,8 +74,12 @@\n \t/** Reusable object node. */\n \tprivate transient ObjectNode node;\n \n-\tpublic JsonRowDataSerializationSchema(RowType rowType) {\n+\t/** Option for timestamp format. */\n+\tprivate final TimestampFormat timestampFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1NDAyNA==", "bodyText": "Add the timestamp format option into getAllOptions.\noptions.put(\"canal-json.timestamp-format.standard\", \"ISO-8081\");", "url": "https://github.com/apache/flink/pull/12661#discussion_r441254024", "createdAt": "2020-06-17T03:04:38Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java", "diffHunk": "@@ -65,7 +66,8 @@ public void testSeDeSchema() {\n \t\tfinal CanalJsonDeserializationSchema expectedDeser = new CanalJsonDeserializationSchema(\n \t\t\tROW_TYPE,\n \t\t\tnew RowDataTypeInfo(ROW_TYPE),\n-\t\t\ttrue);\n+\t\t\ttrue,\n+\t\t\tTimestampFormat.ISO_8601);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1NDEyMA==", "bodyText": "Add the timestamp format option into getAllOptions.\noptions.put(\"debezium-json.timestamp-format.standard\", \"ISO-8081\");", "url": "https://github.com/apache/flink/pull/12661#discussion_r441254120", "createdAt": "2020-06-17T03:04:58Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactoryTest.java", "diffHunk": "@@ -66,7 +67,8 @@ public void testSeDeSchema() {\n \t\t\tROW_TYPE,\n \t\t\tnew RowDataTypeInfo(ROW_TYPE),\n \t\t\ttrue,\n-\t\t\ttrue);\n+\t\t\ttrue,\n+\t\t\tTimestampFormat.ISO_8601);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1NDYwNQ==", "bodyText": "Add an additional test for lowercase iso-8081.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441254605", "createdAt": "2020-06-17T03:07:06Z", "author": {"login": "wuchong"}, "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java", "diffHunk": "@@ -91,6 +91,16 @@ public void testInvalidOptionForIgnoreParseErrors() {\n \t\ttestSchemaDeserializationSchema(tableOptions);\n \t}\n \n+\t@Test\n+\tpublic void testInvalidOptionForTimestampFormat() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bcd586302c348e37128936ed2f3e70e755a8531", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/1bcd586302c348e37128936ed2f3e70e755a8531", "committedDate": "2020-06-17T03:28:01Z", "message": "partial commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "151911755ebde2deb31fa691fe27a6d3d5254bcc", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/151911755ebde2deb31fa691fe27a6d3d5254bcc", "committedDate": "2020-06-17T03:28:01Z", "message": "add `timestamp-format` keyword for json format and add test for new feature."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25f6cddb1e673ac581aba3dc11f7d22c658b6ed8", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/25f6cddb1e673ac581aba3dc11f7d22c658b6ed8", "committedDate": "2020-06-17T03:28:01Z", "message": "add docs and tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b76c95e928fefbed375cab5d068374aa97bf2d5", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/8b76c95e928fefbed375cab5d068374aa97bf2d5", "committedDate": "2020-06-17T03:28:01Z", "message": "rename option name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a922887be3db1c756c9680ba51596ded871b8474", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/a922887be3db1c756c9680ba51596ded871b8474", "committedDate": "2020-06-17T03:28:01Z", "message": "fix bugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88183ac4674542abd15bba64acbf8db532ba3fef", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/88183ac4674542abd15bba64acbf8db532ba3fef", "committedDate": "2020-06-17T03:28:01Z", "message": "fix elasticsearch test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed923b1bd70ef11f8d546b6848ba1d4bdfd15b5e", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/ed923b1bd70ef11f8d546b6848ba1d4bdfd15b5e", "committedDate": "2020-06-17T03:28:01Z", "message": "fix Jark's comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5753a529897019d7a5c8ade7fb42c4c4dd48098", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/c5753a529897019d7a5c8ade7fb42c4c4dd48098", "committedDate": "2020-06-17T03:28:01Z", "message": "fix Jark's comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dacf0bbe706b3f4b533dba786aa619990280e330", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/dacf0bbe706b3f4b533dba786aa619990280e330", "committedDate": "2020-06-17T03:28:01Z", "message": "delete wrong annotation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7e54387903999620d752d2019f0f59cb84f6cae", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/f7e54387903999620d752d2019f0f59cb84f6cae", "committedDate": "2020-06-17T03:28:02Z", "message": "fix bug."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "049b128dd1ba69c6e62ed10059bdd6d2b1cd332c", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/049b128dd1ba69c6e62ed10059bdd6d2b1cd332c", "committedDate": "2020-06-17T04:18:46Z", "message": "fix Jark's comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a125b99385dce7471006b4a899e098cb67bf2f9", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/7a125b99385dce7471006b4a899e098cb67bf2f9", "committedDate": "2020-06-17T06:44:04Z", "message": "add docs and fix SQLClientKafkaITCase"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24897cd0337aeb7292ad7754a5633ab0b09699e4", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/24897cd0337aeb7292ad7754a5633ab0b09699e4", "committedDate": "2020-06-17T02:32:56Z", "message": "fix bug."}, "afterCommit": {"oid": "7a125b99385dce7471006b4a899e098cb67bf2f9", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/7a125b99385dce7471006b4a899e098cb67bf2f9", "committedDate": "2020-06-17T06:44:04Z", "message": "add docs and fix SQLClientKafkaITCase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/93fe0e9d61a7ef909ca7b613e69d2f5592346ae0", "committedDate": "2020-06-17T07:05:47Z", "message": "add TIMESTAMP_FORMAT into optionalOptions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMTM1OTU0", "url": "https://github.com/apache/flink/pull/12661#pullrequestreview-432135954", "createdAt": "2020-06-17T07:38:33Z", "commit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzozODozNFrOGk5dYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzozOTo0NVrOGk5gCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MzMzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                   <td><h5>json.timestamp-format.standard</h5></td>\n          \n          \n            \n                   <td><h5>canal-json.timestamp-format.standard</h5></td>", "url": "https://github.com/apache/flink/pull/12661#discussion_r441343330", "createdAt": "2020-06-17T07:38:34Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/canal.zh.md", "diffHunk": "@@ -169,6 +169,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+       <td><h5>json.timestamp-format.standard</h5></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MzQ0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                   <td><h5>json.timestamp-format.standard</h5></td>\n          \n          \n            \n                   <td><h5>debezium-json.timestamp-format.standard</h5></td>", "url": "https://github.com/apache/flink/pull/12661#discussion_r441343440", "createdAt": "2020-06-17T07:38:44Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/debezium.md", "diffHunk": "@@ -185,6 +185,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+       <td><h5>json.timestamp-format.standard</h5></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MzUxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <td><h5>json.timestamp-format.standard</h5></td>\n          \n          \n            \n                  <td><h5>debezium-json.timestamp-format.standard</h5></td>", "url": "https://github.com/apache/flink/pull/12661#discussion_r441343512", "createdAt": "2020-06-17T07:38:53Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/debezium.zh.md", "diffHunk": "@@ -185,6 +185,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+      <td><h5>json.timestamp-format.standard</h5></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MzYzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <td><h5>json.timestamp-format.standard</h5></td>\n          \n          \n            \n                  <td><h5>canal-json.timestamp-format.standard</h5></td>", "url": "https://github.com/apache/flink/pull/12661#discussion_r441343639", "createdAt": "2020-06-17T07:39:08Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/canal.md", "diffHunk": "@@ -169,6 +169,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+      <td><h5>json.timestamp-format.standard</h5></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0NDAxMA==", "bodyText": "Plase also help to correct the above json.ignore-parse-errors to debezium-json.ignore-parse-errors.\nThe same to Canal docs.", "url": "https://github.com/apache/flink/pull/12661#discussion_r441344010", "createdAt": "2020-06-17T07:39:45Z", "author": {"login": "wuchong"}, "path": "docs/dev/table/connectors/formats/debezium.md", "diffHunk": "@@ -185,6 +185,18 @@ Format Options\n       <td>Skip fields and rows with parse errors instead of failing.\n       Fields are set to null in case of errors.</td>\n     </tr>\n+    <tr>\n+       <td><h5>json.timestamp-format.standard</h5></td>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MzQ0MA=="}, "originalCommit": {"oid": "93fe0e9d61a7ef909ca7b613e69d2f5592346ae0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ac891bbb217acf32c455b4d7140c35fb5a2e1e6", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/6ac891bbb217acf32c455b4d7140c35fb5a2e1e6", "committedDate": "2020-06-17T07:54:10Z", "message": "fix docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMTUyNDgz", "url": "https://github.com/apache/flink/pull/12661#pullrequestreview-432152483", "createdAt": "2020-06-17T08:00:36Z", "commit": {"oid": "6ac891bbb217acf32c455b4d7140c35fb5a2e1e6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3520, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}