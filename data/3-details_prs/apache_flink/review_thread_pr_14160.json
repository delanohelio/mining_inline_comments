{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1MzA4MjI1", "number": 14160, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwODo0ODozOFrOE8HhXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDo0NzozOVrOE9D-nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNDczMjQ2OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/TemporalJoinITCase.scala", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwODo0ODozOFrOH4DwNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwODo0ODozOFrOH4DwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODU0Mzc5Ng==", "bodyText": "We drop the before messages in the temporal table, therefore, 1,Euro can correlate a value now.", "url": "https://github.com/apache/flink/pull/14160#discussion_r528543796", "createdAt": "2020-11-23T08:48:38Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/TemporalJoinITCase.scala", "diffHunk": "@@ -537,51 +523,35 @@ class TemporalJoinITCase(state: StateBackendMode)\n       \" ON o.currency = r.currency\"\n     tEnv.executeSql(sql).await()\n \n-    val rawResult = getRawResults(\"rowtime_default_sink\")\n     // Note: the event time semantics in delete event is when the delete event happened,\n     // records \"+I(2,US Dollar)\" and \"+I(3,RMB)\" would not correlate the deleted events\n     val expected = List(\n-      \"+I(1,Euro,12,2020-08-15T00:01,null,null)\",\n-      \"+I(2,US Dollar,1,2020-08-15T00:02,null,null)\",\n-      \"+I(3,RMB,40,2020-08-15T00:03,null,null)\",\n-      \"+I(4,Euro,14,2020-08-16T00:04,118,2020-08-16T00:01)\",\n-      \"-U(2,US Dollar,1,2020-08-16T00:03,106,2020-08-16T00:02)\",\n-      \"+U(2,US Dollar,18,2020-08-16T00:03,106,2020-08-16T00:02)\",\n-      \"+I(5,RMB,40,2020-08-16T00:03,null,null)\",\n-      \"+I(6,RMB,40,2020-08-16T00:04,null,null)\",\n-      \"-D(6,RMB,40,2020-08-16T00:04,null,null)\")\n-    assertEquals(expected.sorted, rawResult.sorted)\n+      \"1,Euro,12,2020-08-15T00:01,114,2020-08-15T00:00:01\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdea131f32cf7f25237f44e7246e93a219ea1d8d"}, "originalPosition": 141}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDYwNzE3OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/formats/canal.zh.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDozMTowMlrOH5i0zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDozMTowMlrOH5i0zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwMTQ1NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u73af\u5883\u4e0b\uff0cCanal \u5e94\u7528\u80fd\u4ee5 **exactly-once** \u7684\u8bed\u4e49\u6295\u9012\u6bcf\u6761\u53d8\u66f4\u4e8b\u4ef6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cFlink \u6d88\u8d39 Canal \u4ea7\u751f\u7684\u53d8\u66f4\u4e8b\u4ef6\u80fd\u591f\u5de5\u4f5c\u5730\u5f88\u597d\u3002\n          \n          \n            \n            \u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u73af\u5883\u4e0b\uff0cCanal \u5e94\u7528\u80fd\u4ee5 **exactly-once** \u7684\u8bed\u4e49\u6295\u9012\u6bcf\u6761\u53d8\u66f4\u4e8b\u4ef6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cFlink \u6d88\u8d39 Canal \u4ea7\u751f\u7684\u53d8\u66f4\u4e8b\u4ef6\u80fd\u591f\u5de5\u4f5c\u5f97\u5f88\u597d\u3002", "url": "https://github.com/apache/flink/pull/14160#discussion_r530101454", "createdAt": "2020-11-25T04:31:02Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/formats/canal.zh.md", "diffHunk": "@@ -219,6 +219,17 @@ Format \u53c2\u6570\n     </tbody>\n </table>\n \n+\u6ce8\u610f\u4e8b\u9879\n+----------------\n+\n+### \u91cd\u590d\u7684\u53d8\u66f4\u4e8b\u4ef6\n+\n+\u5728\u6b63\u5e38\u7684\u64cd\u4f5c\u73af\u5883\u4e0b\uff0cCanal \u5e94\u7528\u80fd\u4ee5 **exactly-once** \u7684\u8bed\u4e49\u6295\u9012\u6bcf\u6761\u53d8\u66f4\u4e8b\u4ef6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cFlink \u6d88\u8d39 Canal \u4ea7\u751f\u7684\u53d8\u66f4\u4e8b\u4ef6\u80fd\u591f\u5de5\u4f5c\u5730\u5f88\u597d\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af478685f91c3cf99c0553eeddd320bb8c3f4b35"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDYxMDU1OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/formats/debezium.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDozMzoxN1rOH5i2yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDozMzoxN1rOH5i2yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwMTk2Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Under normal operating scenarios, the Debezium application delivers every change event **exactly-once**. This works pretty well when Flink consumes Debezium produced events in this situation.\n          \n          \n            \n            Under normal operating scenarios, the Debezium application delivers every change event **exactly-once**. Flink works pretty well when consumes Debezium produced events in this situation.", "url": "https://github.com/apache/flink/pull/14160#discussion_r530101963", "createdAt": "2020-11-25T04:33:17Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/formats/debezium.md", "diffHunk": "@@ -282,6 +282,14 @@ Use format `debezium-avro-confluent` to interpret Debezium Avro messages and for\n Caveats\n ----------------\n \n+### Duplicate change events\n+\n+Under normal operating scenarios, the Debezium application delivers every change event **exactly-once**. This works pretty well when Flink consumes Debezium produced events in this situation.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af478685f91c3cf99c0553eeddd320bb8c3f4b35"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDYyOTY3OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/sources/DynamicSourceUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDo0MzowMVrOH5jBHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNjo1OTozMVrOH5lezg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwNDYwNQ==", "bodyText": "The condition!changelogMode.containsOnly(RowKind.INSERT) does not indicate the source is a CDC source which is non-upsert", "url": "https://github.com/apache/flink/pull/14160#discussion_r530104605", "createdAt": "2020-11-25T04:43:01Z", "author": {"login": "leonardBang"}, "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/sources/DynamicSourceUtils.java", "diffHunk": "@@ -267,6 +302,20 @@ private static void validateScanSourceForStreaming(\n \t\t\t\t\tscanSource.getClass().getName()\n \t\t\t\t)\n \t\t\t);\n+\t\t} else if (!changelogMode.containsOnly(RowKind.INSERT)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af478685f91c3cf99c0553eeddd320bb8c3f4b35"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDE0NDk3NA==", "bodyText": "This is in the else branch which means it doesn't match !hasUpdateBefore && hasUpdateAfter (upsert source).", "url": "https://github.com/apache/flink/pull/14160#discussion_r530144974", "createdAt": "2020-11-25T06:59:31Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/sources/DynamicSourceUtils.java", "diffHunk": "@@ -267,6 +302,20 @@ private static void validateScanSourceForStreaming(\n \t\t\t\t\tscanSource.getClass().getName()\n \t\t\t\t)\n \t\t\t);\n+\t\t} else if (!changelogMode.containsOnly(RowKind.INSERT)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwNDYwNQ=="}, "originalCommit": {"oid": "af478685f91c3cf99c0553eeddd320bb8c3f4b35"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDYzNzczOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/TemporalJoinITCase.scala", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDo0NzozOVrOH5jFvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwNDo0NzozOVrOH5jFvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDEwNTc5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"1,Euro,12,2020-08-15T00:01,114,2020-08-15T00:00:01\",\n          \n          \n            \n                  \"3,RMB,40,2020-08-15T00:03,702,2020-08-15T00:00:04\",\n          \n          \n            \n                  \"4,Euro,14,2020-08-16T00:04,118,2020-08-16T00:01\",\n          \n          \n            \n                  \"2,US Dollar,18,2020-08-16T00:03,106,2020-08-16T00:02\")\n          \n          \n            \n                  \"1,Euro,12,2020-08-15T00:01,114,2020-08-15T00:00:01\",\n          \n          \n            \n                  \"2,US Dollar,18,2020-08-16T00:03,106,2020-08-16T00:02\",\n          \n          \n            \n                  \"3,RMB,40,2020-08-15T00:03,702,2020-08-15T00:00:04\",\n          \n          \n            \n                  \"4,Euro,14,2020-08-16T00:04,118,2020-08-16T00:01\")\n          \n      \n    \n    \n  \n\nminor\uff1a we can give a more readable order that is same as the left table input.", "url": "https://github.com/apache/flink/pull/14160#discussion_r530105790", "createdAt": "2020-11-25T04:47:39Z", "author": {"login": "leonardBang"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/TemporalJoinITCase.scala", "diffHunk": "@@ -455,15 +455,12 @@ class TemporalJoinITCase(state: StateBackendMode)\n       \" ON o.currency = r.currency\"\n \n     tEnv.executeSql(sql).await()\n-    val rawResult = getRawResults(\"rowtime_default_sink\")\n     val expected = List(\n-      \"+I(1,Euro,12,2020-08-15T00:01,114,2020-08-15T00:00:01)\",\n-      \"+I(2,US Dollar,1,2020-08-15T00:02,102,2020-08-15T00:00:02)\",\n-      \"+I(3,RMB,40,2020-08-15T00:03,702,2020-08-15T00:00:04)\",\n-      \"+I(4,Euro,14,2020-08-16T00:04,118,2020-08-16T00:01)\",\n-      \"-U(2,US Dollar,1,2020-08-16T00:03,106,2020-08-16T00:02)\",\n-      \"+U(2,US Dollar,18,2020-08-16T00:03,106,2020-08-16T00:02)\")\n-    assertEquals(expected.sorted, rawResult.sorted)\n+      \"1,Euro,12,2020-08-15T00:01,114,2020-08-15T00:00:01\",\n+      \"3,RMB,40,2020-08-15T00:03,702,2020-08-15T00:00:04\",\n+      \"4,Euro,14,2020-08-16T00:04,118,2020-08-16T00:01\",\n+      \"2,US Dollar,18,2020-08-16T00:03,106,2020-08-16T00:02\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af478685f91c3cf99c0553eeddd320bb8c3f4b35"}, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4718, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}