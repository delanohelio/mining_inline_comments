{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMTg0ODUy", "number": 13612, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMDo1MDoxN1rOEs-tog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNDo0MDoyOFrOEyLgvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1NjAwMjkwOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarFunctionsTest.scala", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMDo1MDoxN1rOHggxcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMjo1MDowMFrOHglCCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg1MzQyNw==", "bodyText": "Could you add this test to ScalarOperatorsTest? Because cast is an operator.\nBesides, coul dyou add cast tests for binary and varbinary source fields?", "url": "https://github.com/apache/flink/pull/13612#discussion_r503853427", "createdAt": "2020-10-13T10:50:17Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarFunctionsTest.scala", "diffHunk": "@@ -4056,4 +4056,15 @@ class ScalarFunctionsTest extends ScalarTypesTestBase {\n       \"f55=f57\",\n       \"true\")\n   }\n+\n+  @Test\n+  def testCast(): Unit = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aeb2e48d1722fab6e1a52ab64d3c8bd5665048d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzkyMzIxMQ==", "bodyText": "Yes, Thank you for reminder. I updated the test case.", "url": "https://github.com/apache/flink/pull/13612#discussion_r503923211", "createdAt": "2020-10-13T12:50:00Z", "author": {"login": "wangxlong"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarFunctionsTest.scala", "diffHunk": "@@ -4056,4 +4056,15 @@ class ScalarFunctionsTest extends ScalarTypesTestBase {\n       \"f55=f57\",\n       \"true\")\n   }\n+\n+  @Test\n+  def testCast(): Unit = {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg1MzQyNw=="}, "originalCommit": {"oid": "0aeb2e48d1722fab6e1a52ab64d3c8bd5665048d"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMDUyODYwOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarOperatorsTest.scala", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNDo0MDoyOFrOHorL3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowNzoxNFrOHpBL4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQxMjYzNw==", "bodyText": "Would be better to add a test for cast binary literal to varchar.", "url": "https://github.com/apache/flink/pull/13612#discussion_r512412637", "createdAt": "2020-10-27T04:40:28Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarOperatorsTest.scala", "diffHunk": "@@ -62,6 +62,26 @@ class ScalarOperatorsTest extends ScalarOperatorsTestBase {\n     )\n   }\n \n+  @Test\n+  def testCast(): Unit = {\n+\n+    // binary -> varchar\n+    testSqlApi(\n+      \"CAST (f18 as varchar)\",\n+      \"hello world\")\n+\n+    // varbinary -> varchar\n+    testSqlApi(\n+      \"CAST (f19 as varchar)\",\n+      \"hello flink\")\n+\n+    // null case\n+    testSqlApi(\"CAST (NULL AS INT)\", \"null\")\n+    testSqlApi(\n+      \"CAST (NULL AS VARCHAR) = ''\",\n+      \"null\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1a881b34bea5ede3b622e0d53c9728d232cb48c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc3MzA4OQ==", "bodyText": "Updated.", "url": "https://github.com/apache/flink/pull/13612#discussion_r512773089", "createdAt": "2020-10-27T15:07:14Z", "author": {"login": "wangxlong"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/ScalarOperatorsTest.scala", "diffHunk": "@@ -62,6 +62,26 @@ class ScalarOperatorsTest extends ScalarOperatorsTestBase {\n     )\n   }\n \n+  @Test\n+  def testCast(): Unit = {\n+\n+    // binary -> varchar\n+    testSqlApi(\n+      \"CAST (f18 as varchar)\",\n+      \"hello world\")\n+\n+    // varbinary -> varchar\n+    testSqlApi(\n+      \"CAST (f19 as varchar)\",\n+      \"hello flink\")\n+\n+    // null case\n+    testSqlApi(\"CAST (NULL AS INT)\", \"null\")\n+    testSqlApi(\n+      \"CAST (NULL AS VARCHAR) = ''\",\n+      \"null\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQxMjYzNw=="}, "originalCommit": {"oid": "a1a881b34bea5ede3b622e0d53c9728d232cb48c"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 131, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}