{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NjA5MTY0", "number": 11327, "title": "[FLINK-16450][hive] Integrate parquet columnar row reader to hive", "bodyText": "What is the purpose of the change\n#10922 has introduce ParquetColumnarRowSplitReader, we should enable it in hive.\nBrief change log\n\nModify hive pom to shade parquet\nIntroduce HiveVectorizedParquetSplitReader\n\nVerifying this change\nTableEnvHiveConnectorTest modify cases.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-03-06T03:00:55Z", "url": "https://github.com/apache/flink/pull/11327", "merged": true, "mergeCommit": {"oid": "a68f5fde472de8a351726239a936ca2acf8073a3"}, "closed": true, "closedAt": "2020-03-09T04:05:54Z", "author": {"login": "JingsongLi"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcK3HE7AH2gAyMzg0NjA5MTY0OjIwNDhmNzc2YTMxYjRiNDg5YjQ1MDVmM2NkMzNkMDM3NmNmZjM2MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcL0rCJgFqTM3MDg5MjEwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2048f776a31b4b489b4505f3cd33d0376cff3633", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/2048f776a31b4b489b4505f3cd33d0376cff3633", "committedDate": "2020-03-06T02:57:50Z", "message": "[FLINK-16450][hive] Integrate parquet columnar row reader to hive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3b16385089b077cc856f24d9b0f33903a17a91c", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/c3b16385089b077cc856f24d9b0f33903a17a91c", "committedDate": "2020-03-06T03:06:40Z", "message": "Add documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1864a6fe88ffdb1ce37f928a7fade4b38e13c876", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/1864a6fe88ffdb1ce37f928a7fade4b38e13c876", "committedDate": "2020-03-06T06:21:49Z", "message": "Add notice file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMjg0NjQ5", "url": "https://github.com/apache/flink/pull/11327#pullrequestreview-370284649", "createdAt": "2020-03-06T12:25:27Z", "commit": {"oid": "1864a6fe88ffdb1ce37f928a7fade4b38e13c876"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjoyNToyN1rOFy3AKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjoyNToyN1rOFy3AKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3NDI4Mw==", "bodyText": "I think this method actually returns whether a type is not supported?", "url": "https://github.com/apache/flink/pull/11327#discussion_r388874283", "createdAt": "2020-03-06T12:25:27Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/read/HiveTableInputFormat.java", "diffHunk": "@@ -113,16 +114,74 @@ public void configure(org.apache.flink.configuration.Configuration parameters) {\n \n \t@Override\n \tpublic void open(HiveTableInputSplit split) throws IOException {\n-\t\tif (!useMapRedReader && useOrcVectorizedRead(split.getHiveTablePartition())) {\n+\t\tHiveTablePartition partition = split.getHiveTablePartition();\n+\t\tif (!useMapRedReader && useOrcVectorizedRead(partition)) {\n \t\t\tthis.reader = new HiveVectorizedOrcSplitReader(\n \t\t\t\t\thiveVersion, jobConf, fieldNames, fieldTypes, selectedFields, split);\n+\t\t} else if (!useMapRedReader && useParquetVectorizedRead(partition)) {\n+\t\t\tthis.reader = new HiveVectorizedParquetSplitReader(\n+\t\t\t\t\thiveVersion, jobConf, fieldNames, fieldTypes, selectedFields, split);\n \t\t} else {\n \t\t\tthis.reader = new HiveMapredSplitReader(jobConf, partitionKeys, fieldTypes, selectedFields, split,\n \t\t\t\t\tHiveShimLoader.loadHiveShim(hiveVersion));\n \t\t}\n \t\tcurrentReadCount = 0L;\n \t}\n \n+\tprivate boolean isVectorizationSupport(LogicalType t) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1864a6fe88ffdb1ce37f928a7fade4b38e13c876"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36e589c681957f4c13d33ac2d8e82d18dc57697a", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/36e589c681957f4c13d33ac2d8e82d18dc57697a", "committedDate": "2020-03-09T01:44:16Z", "message": "Fix comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwODkyMTAw", "url": "https://github.com/apache/flink/pull/11327#pullrequestreview-370892100", "createdAt": "2020-03-09T02:41:19Z", "commit": {"oid": "36e589c681957f4c13d33ac2d8e82d18dc57697a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3103, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}