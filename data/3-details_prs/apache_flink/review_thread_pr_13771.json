{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4OTI5MzQ4", "number": 13771, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwNjozODowMlrOExxCIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOTozNToyNlrOEyQiaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNjE5MDQxOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushPartitionIntoTableSourceScanRule.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwNjozODowMlrOHoCVwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwNjozODowMlrOHoCVwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTc0MzQyNA==", "bodyText": "Unused field remainingPartitions", "url": "https://github.com/apache/flink/pull/13771#discussion_r511743424", "createdAt": "2020-10-26T06:38:02Z", "author": {"login": "fsk119"}, "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushPartitionIntoTableSourceScanRule.java", "diffHunk": "@@ -239,46 +239,40 @@ public RexNode visitInputRef(RexInputRef inputRef) {\n \t\t// get partitions from table/catalog and prune\n \t\tOptional<Catalog> catalogOptional = context.getCatalogManager().getCatalog(tableSourceTable.tableIdentifier().getCatalogName());\n \t\tList<Map<String, String>> remainingPartitions;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "625bb55bba2c6febed70a805ffddef883b736dbc"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTM1MjA5OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOTozNToyNlrOHoy5lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwOTo0Mjo0NVrOHozMbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzOTAyOA==", "bodyText": "Should we report error for the else branch ?", "url": "https://github.com/apache/flink/pull/13771#discussion_r512539028", "createdAt": "2020-10-27T09:35:26Z", "author": {"login": "danny0405"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "diffHunk": "@@ -346,63 +329,30 @@ private TableSchema getProducedTableSchema() {\n \t}\n \n \t@Override\n-\tpublic boolean isLimitPushedDown() {\n-\t\treturn isLimitPushDown;\n+\tpublic void applyLimit(long limit) {\n+\t\tthis.limit = limit;\n \t}\n \n \t@Override\n-\tpublic TableSource<RowData> applyLimit(long limit) {\n-\t\treturn new HiveTableSource(\n-\t\t\t\tjobConf,\n-\t\t\t\tflinkConf,\n-\t\t\t\ttablePath,\n-\t\t\t\tcatalogTable,\n-\t\t\t\tremainingPartitions,\n-\t\t\t\thiveVersion,\n-\t\t\t\tpartitionPruned,\n-\t\t\t\tprojectedFields,\n-\t\t\t\ttrue,\n-\t\t\t\tlimit);\n+\tpublic Optional<List<Map<String, String>>> listPartitions() {\n+\t\treturn Optional.empty();\n \t}\n \n \t@Override\n-\tpublic List<Map<String, String>> getPartitions() {\n-\t\tthrow new UnsupportedOperationException(\n-\t\t\t\t\"Please use Catalog API to retrieve all partitions of a table\");\n+\tpublic void applyPartitions(List<Map<String, String>> remainingPartitions) {\n+\t\tif (catalogTable.getPartitionKeys() != null && catalogTable.getPartitionKeys().size() != 0) {\n+\t\t\tthis.remainingPartitions = remainingPartitions;\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed42b2dd882c30eff6a0dc3f5e8cf5546958448"}, "originalPosition": 193}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU0Mzg1NQ==", "bodyText": "I think we can", "url": "https://github.com/apache/flink/pull/13771#discussion_r512543855", "createdAt": "2020-10-27T09:42:45Z", "author": {"login": "JingsongLi"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "diffHunk": "@@ -346,63 +329,30 @@ private TableSchema getProducedTableSchema() {\n \t}\n \n \t@Override\n-\tpublic boolean isLimitPushedDown() {\n-\t\treturn isLimitPushDown;\n+\tpublic void applyLimit(long limit) {\n+\t\tthis.limit = limit;\n \t}\n \n \t@Override\n-\tpublic TableSource<RowData> applyLimit(long limit) {\n-\t\treturn new HiveTableSource(\n-\t\t\t\tjobConf,\n-\t\t\t\tflinkConf,\n-\t\t\t\ttablePath,\n-\t\t\t\tcatalogTable,\n-\t\t\t\tremainingPartitions,\n-\t\t\t\thiveVersion,\n-\t\t\t\tpartitionPruned,\n-\t\t\t\tprojectedFields,\n-\t\t\t\ttrue,\n-\t\t\t\tlimit);\n+\tpublic Optional<List<Map<String, String>>> listPartitions() {\n+\t\treturn Optional.empty();\n \t}\n \n \t@Override\n-\tpublic List<Map<String, String>> getPartitions() {\n-\t\tthrow new UnsupportedOperationException(\n-\t\t\t\t\"Please use Catalog API to retrieve all partitions of a table\");\n+\tpublic void applyPartitions(List<Map<String, String>> remainingPartitions) {\n+\t\tif (catalogTable.getPartitionKeys() != null && catalogTable.getPartitionKeys().size() != 0) {\n+\t\t\tthis.remainingPartitions = remainingPartitions;\n+\t\t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzOTAyOA=="}, "originalCommit": {"oid": "2ed42b2dd882c30eff6a0dc3f5e8cf5546958448"}, "originalPosition": 193}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4953, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}