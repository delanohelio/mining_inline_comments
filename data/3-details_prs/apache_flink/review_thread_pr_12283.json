{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMzQ3MTQ1", "number": 12283, "reviewThreads": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1NjoyMlrOD--t6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxOTo0NDoyN1rOEB5XBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY1ODY2OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1NjoyMlrOGZaMgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQwMjo1OTo1MFrOGZsXhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5Njc3MA==", "bodyText": "Is this Hadoop specific or Flink FS. Shouldn't the title just be \"FileSystem Connector\"?", "url": "https://github.com/apache/flink/pull/12283#discussion_r429296770", "createdAt": "2020-05-22T14:56:22Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU5NDUwMw==", "bodyText": "It is for Flink FS, forgot to modify title.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429594503", "createdAt": "2020-05-24T02:59:50Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5Njc3MA=="}, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY2MzYxOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1Nzo0NVrOGZaPlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1Nzo0NVrOGZaPlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5NzU1OQ==", "bodyText": "nit, i'm trying to make the docs more consistent with having a paragraph above the toc\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * This will be replaced by the TOC\n          \n          \n            \n            {:toc}\n          \n          \n            \n            \n          \n          \n            \n            This connector provides access to partitioned files in filesystems\n          \n          \n            \n            supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n          \n          \n            \n            This connector provides access to partitioned files in filesystems\n          \n          \n            \n            supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n          \n          \n            \n            \n          \n          \n            \n            * This will be replaced by the TOC\n          \n          \n            \n            {:toc}", "url": "https://github.com/apache/flink/pull/12283#discussion_r429297559", "createdAt": "2020-05-22T14:57:45Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY2NzcwOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1ODo1N1rOGZaSPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNDo1ODo1N1rOGZaSPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5ODIzOQ==", "bodyText": "Please link here instead.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n          \n          \n            \n            <span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).", "url": "https://github.com/apache/flink/pull/12283#discussion_r429298239", "createdAt": "2020-05-22T14:58:57Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY3MTkxOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowMDowNlrOGZaVCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowMDowNlrOGZaVCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5ODk1Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n          \n          \n            \n            <span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429298953", "createdAt": "2020-05-22T15:00:06Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY3MzU2OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowMDozMlrOGZaWJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowMDozMlrOGZaWJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI5OTIzNg==", "bodyText": "Lets be consistent in title capitalizaiton\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Partition files\n          \n          \n            \n            ## Partition Files", "url": "https://github.com/apache/flink/pull/12283#discussion_r429299236", "createdAt": "2020-05-22T15:00:32Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY4ODM3OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNToyN1rOGZagHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNToyN1rOGZagHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMTc5MQ==", "bodyText": "I think I would find this confusing if I wasn't familiar with the FLIP, what about:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The partition supported by the file system connector is similar to hive, but different from hive,\n          \n          \n            \n            hive manage partitions through catalog, file system table manages partitions according to the\n          \n          \n            \n            directory of the file system. File system connector discover and infer partitions automatically.\n          \n          \n            \n            For example, a table partitioned by datetime and hour is the structure in file system path:\n          \n          \n            \n            Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429301791", "createdAt": "2020-05-22T15:05:27Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY5MzEyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNjo0OFrOGZajDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNjo0OFrOGZajDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMjU0MA==", "bodyText": "I don't think this second sentence needs to be a note, its a natrual extension to a paragraph.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n          \n          \n            \n            \n          \n          \n            \n            **NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n          \n          \n            \n            The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429302540", "createdAt": "2020-05-22T15:06:48Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 90}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY5NjEyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNzo0MlrOGZak5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNzo0MlrOGZak5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMzAxMg==", "bodyText": "?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n          \n          \n            \n             - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).", "url": "https://github.com/apache/flink/pull/12283#discussion_r429303012", "createdAt": "2020-05-22T15:07:42Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY5Njc5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNzo1NFrOGZalUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowNzo1NFrOGZalUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMzEyMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Streaming sink\n          \n          \n            \n            ## Streaming Sink", "url": "https://github.com/apache/flink/pull/12283#discussion_r429303121", "createdAt": "2020-05-22T15:07:54Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 102}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY5ODAzOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowODoyMFrOGZamKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowODoyMFrOGZamKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMzMzOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n          \n          \n            \n            The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)", "url": "https://github.com/apache/flink/pull/12283#discussion_r429303338", "createdAt": "2020-05-22T15:08:20Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzY5OTMyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowODo0NlrOGZam-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowODo0NlrOGZam-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwMzU0Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ### Rolling policy\n          \n          \n            \n            ### Rolling Policy", "url": "https://github.com/apache/flink/pull/12283#discussion_r429303547", "createdAt": "2020-05-22T15:08:46Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzcwMjIyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNTowOTozOVrOGZao5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwODoxMjozOFrOGZ4obg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwNDAzOQ==", "bodyText": "Avro is not a bulk format.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            **NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n          \n          \n            \n            **NOTE:** For bulk formats (parquet, orc), the rolling policy in combination with the checkpoint interval (pending files", "url": "https://github.com/apache/flink/pull/12283#discussion_r429304039", "createdAt": "2020-05-22T15:09:39Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTc5NTQzOA==", "bodyText": "In https://issues.apache.org/jira/browse/FLINK-11395 , because in avro file writer, metadata kept in the header and the writer supports compression. So we implement it as a bulk writer.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429795438", "createdAt": "2020-05-25T08:12:38Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwNDAzOQ=="}, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzcwMzMzOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxMDowMFrOGZapmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxMDowMFrOGZapmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwNDIxNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            **NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n          \n          \n            \n            **NOTE:** For row formats (csv, json, avro), you can reduce the time interval appropriately to avoid too long delay.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429304216", "createdAt": "2020-05-22T15:10:00Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 142}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzcwMzc5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxMDowOVrOGZap6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxMDowOVrOGZap6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwNDI5OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ### Partition commit\n          \n          \n            \n            ### Partition Commit", "url": "https://github.com/apache/flink/pull/12283#discussion_r429304298", "createdAt": "2020-05-22T15:10:09Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzcyNzgyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxNzoxOVrOGZa5Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxNzoxOVrOGZa5Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwODE3NQ==", "bodyText": "I apologize but I rewrote this paragraph a bit more than normal. I hope that's alright.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n          \n          \n            \n            Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n          \n          \n            \n            writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n          \n          \n            \n            After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429308175", "createdAt": "2020-05-22T15:17:19Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 148}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzczMTc1OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxODozN1rOGZa7pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxODozN1rOGZa7pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwODgzNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This requires that your job has watermark, and the partition is divided according to time, such as\n          \n          \n            \n            This requires that your job is using event time, and the partition is divided according to time, such as", "url": "https://github.com/apache/flink/pull/12283#discussion_r429308837", "createdAt": "2020-05-22T15:18:37Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 184}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzczMzI4OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxOTowNFrOGZa8lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxOTowNFrOGZa8lA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwOTA3Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #### Partition time extractor\n          \n          \n            \n            #### Partition Time Extractor", "url": "https://github.com/apache/flink/pull/12283#discussion_r429309076", "createdAt": "2020-05-22T15:19:04Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 190}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MzczNDE1OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxOToyNFrOGZa9Kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToxOToyNFrOGZa9Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMwOTIyNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Time extractor defines extracting time from partition values.\n          \n          \n            \n            Time extractors define extracting time from partition values.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429309226", "createdAt": "2020-05-22T15:19:24Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 192}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc0NDcyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyMjo0MVrOGZbD2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyMjo0MVrOGZbD2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMDkzNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n          \n          \n            \n            \n          \n          \n            \n            You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n          \n          \n            \n            The default extractor is based on a timestamp pattern composed of your partition fields. You can also specify an implementation for fully custom partition extraction based on the `PartitionTimeExtractor` interface.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429310937", "createdAt": "2020-05-22T15:22:41Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 227}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc0NzAzOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyMzoyOFrOGZbFZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyMzoyOFrOGZbFZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMTMzMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #### Partition commit policy\n          \n          \n            \n            #### Partition Commit Policy", "url": "https://github.com/apache/flink/pull/12283#discussion_r429311332", "createdAt": "2020-05-22T15:23:28Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 246}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc0ODg2OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyNDowM1rOGZbGnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyNDowM1rOGZbGnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMTY0NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n          \n          \n            \n            The partition commit policy defines what action is taken when partitions are committed.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429311644", "createdAt": "2020-05-22T15:24:03Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 248}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc2MDIxOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyNzoyOVrOGZbN4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowNzozMVrOGZ_CKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMzUwNQ==", "bodyText": "@JingsongLi @KurtYoung\nThe naming of these options is not good. Metastore having a default no-op implementation does not make any sense. There should be none, success-file, and custom. I want to very strongly encourage making this change for 1.11.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429313505", "createdAt": "2020-05-22T15:27:29Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 251}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUwMzgxNg==", "bodyText": "We can hide(throws UnsupportedException?) it for filesystem connector.\nBut for Hive table, metastore is needed.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429503816", "createdAt": "2020-05-23T01:51:48Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMzUwNQ=="}, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 251}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTUyNjI0OQ==", "bodyText": "Throwing exception in filesystem connector would be better, and we also need to highlight this in document.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429526249", "createdAt": "2020-05-23T08:16:39Z", "author": {"login": "KurtYoung"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMzUwNQ=="}, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 251}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkwMDMyOA==", "bodyText": "Created JIRA: https://issues.apache.org/jira/browse/FLINK-17925", "url": "https://github.com/apache/flink/pull/12283#discussion_r429900328", "createdAt": "2020-05-25T12:07:31Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMzUwNQ=="}, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 251}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc2MzExOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyODoxMlrOGZbPfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyODoxMlrOGZbPfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxMzkxNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Example\n          \n          \n            \n            ## Full Example", "url": "https://github.com/apache/flink/pull/12283#discussion_r429313916", "createdAt": "2020-05-22T15:28:12Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only work with hive table, it is empty implementation for file system table. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t\thiveShell.execute(String.format(\n+\t\t    \"ANALYZE TABLE %s PARTITION (%s = '%s') COMPUTE STATISTICS FOR COLUMNS\",\n+\t\t    context.tableName(),\n+\t\t    context.partitionKeys().get(0),\n+\t\t    context.partitionValues().get(0)));\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+## Example", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 314}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Mzc2NzExOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyOToyOVrOGZbSFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNToyOToyOVrOGZbSFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMxNDU4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Here is a example to:\n          \n          \n            \n            \n          \n          \n            \n            - streaming sql: kafka table -> filesystem table.\n          \n          \n            \n            - batch sql: query filesystem table.\n          \n          \n            \n            The below shows how the file system connector can be used to write a streaming query to write data from Kafka into a file system and runs a batch query to read that data back out.", "url": "https://github.com/apache/flink/pull/12283#discussion_r429314581", "createdAt": "2020-05-22T15:29:29Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,352 @@\n+---\n+title: \"Hadoop FileSystem Connector\"\n+nav-title: Hadoop FileSystem\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/internals/filesystems.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition files\n+\n+The partition supported by the file system connector is similar to hive, but different from hive,\n+hive manage partitions through catalog, file system table manages partitions according to the\n+directory of the file system. File system connector discover and infer partitions automatically.\n+For example, a table partitioned by datetime and hour is the structure in file system path:\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table support partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html).\n+\n+**NOTE:** When you insert overwrite to a partitioned table, only the corresponding partition will be overwrite, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file. It is [Newline-delimited JSON](http://jsonlines.org/). Uncompressed.\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming sink\n+\n+The file system connector supports streaming sink, it uses [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet,orc,avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv,json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition commit\n+\n+Committing a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read.\n+Streaming sink includes not only the writing of data files, but also the visibility commit of partition. When a partition completes\n+writing, you need to notify metastore or add the success file in the directory. Partition commit mechanism allows you to:\n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job has watermark, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition time extractor\n+\n+Time extractor defines extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor provide a timestamp pattern way, you can construct timestamp pattern from your partition fields.\n+\n+You can also specify an implementation to complete partition time extraction. The custom extractor implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition commit policy\n+\n+The partiton commit policy defines how to commit a partition. Two policies are supported by default:\n+\n+- The first is metastore, but since the file system does not have metastore, it is an empty implementation.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only work with hive table, it is empty implementation for file system table. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t\thiveShell.execute(String.format(\n+\t\t    \"ANALYZE TABLE %s PARTITION (%s = '%s') COMPUTE STATISTICS FOR COLUMNS\",\n+\t\t    context.tableName(),\n+\t\t    context.partitionKeys().get(0),\n+\t\t    context.partitionValues().get(0)));\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+## Example\n+\n+Here is a example to:\n+\n+- streaming sql: kafka table -> filesystem table.\n+- batch sql: query filesystem table.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967561896814c71906c96bb77e7d9ac76fe7fd26"}, "originalPosition": 319}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzY3NDMyOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowNTozOFrOGZ-_Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjoyMDo1MFrOGZ_W1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5OTU0Nw==", "bodyText": "please use \"'\", not \"\u2018\"", "url": "https://github.com/apache/flink/pull/12283#discussion_r429899547", "createdAt": "2020-05-25T12:05:38Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,340 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job is using event time, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition Time Extractor\n+\n+Time extractors define extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor is based on a timestamp pattern composed of your partition fields. You can also specify an implementation for fully custom partition extraction based on the `PartitionTimeExtractor` interface. \n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition Commit Policy\n+\n+The partition commit policy defines what action is taken when partitions are committed. \n+\n+- The first is metastore, only hive table supports metastore policy, file system manages partitions through directory structure.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only work with hive table, it is empty implementation for file system table. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t\thiveShell.execute(String.format(\n+\t\t    \"ANALYZE TABLE %s PARTITION (%s = '%s') COMPUTE STATISTICS FOR COLUMNS\",\n+\t\t    context.tableName(),\n+\t\t    context.partitionKeys().get(0),\n+\t\t    context.partitionValues().get(0)));\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+## Full Example\n+\n+The below shows how the file system connector can be used to write a streaming query to write data from Kafka into a file system and runs a batch query to read that data back out. \n+\n+{% highlight sql %}\n+\n+CREATE TABLE kafka_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  log_ts TIMESTAMP(3),\n+  WATERMARK FOR log_ts AS log_ts - INTERVAL '5' SECOND\n+) WITH (...);\n+\n+CREATE TABLE fs_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  dt STRING,\n+  hour STRING\n+) PARTITIONED BY (dt, hour) WITH (\n+  \u2019connector\u2019=\u2019filesystem\u2019,\n+  \u2019path\u2019=\u2019...\u2019,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad4d80a2795df3e7920d31660a2dea7fe1d5ee5"}, "originalPosition": 325}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkwNTYyMw==", "bodyText": "Good catch", "url": "https://github.com/apache/flink/pull/12283#discussion_r429905623", "createdAt": "2020-05-25T12:20:50Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,340 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job is using event time, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition Time Extractor\n+\n+Time extractors define extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor is based on a timestamp pattern composed of your partition fields. You can also specify an implementation for fully custom partition extraction based on the `PartitionTimeExtractor` interface. \n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition Commit Policy\n+\n+The partition commit policy defines what action is taken when partitions are committed. \n+\n+- The first is metastore, only hive table supports metastore policy, file system manages partitions through directory structure.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only work with hive table, it is empty implementation for file system table. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t\thiveShell.execute(String.format(\n+\t\t    \"ANALYZE TABLE %s PARTITION (%s = '%s') COMPUTE STATISTICS FOR COLUMNS\",\n+\t\t    context.tableName(),\n+\t\t    context.partitionKeys().get(0),\n+\t\t    context.partitionValues().get(0)));\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+## Full Example\n+\n+The below shows how the file system connector can be used to write a streaming query to write data from Kafka into a file system and runs a batch query to read that data back out. \n+\n+{% highlight sql %}\n+\n+CREATE TABLE kafka_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  log_ts TIMESTAMP(3),\n+  WATERMARK FOR log_ts AS log_ts - INTERVAL '5' SECOND\n+) WITH (...);\n+\n+CREATE TABLE fs_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  dt STRING,\n+  hour STRING\n+) PARTITIONED BY (dt, hour) WITH (\n+  \u2019connector\u2019=\u2019filesystem\u2019,\n+  \u2019path\u2019=\u2019...\u2019,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5OTU0Nw=="}, "originalCommit": {"oid": "9ad4d80a2795df3e7920d31660a2dea7fe1d5ee5"}, "originalPosition": 325}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzY3NjI5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowNjoyMlrOGZ_ASw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowNjoyMlrOGZ_ASw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg5OTg1MQ==", "bodyText": "code ident", "url": "https://github.com/apache/flink/pull/12283#discussion_r429899851", "createdAt": "2020-05-25T12:06:22Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,340 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">1024L * 1024L * 128L</td>\n+        <td>Long</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">partition-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'partition-time': extract time from partition, if 'watermark' > 'partition-time' + 'delay', will commit the partition. 'process-time': use processing time, if 'current processing time' > 'partition directory creation time' + 'delay', will commit the partition.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is to judge the time of partition commit according to the partition time and watermark.\n+This requires that your job is using event time, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+- The second is partition processing time. The time of partition commit according to partition\n+creation time and current time. This trigger is more universal, but not so precise. For example,\n+data delay or failover will lead to premature partition commit.\n+\n+#### Partition Time Extractor\n+\n+Time extractors define extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor is based on a timestamp pattern composed of your partition fields. You can also specify an implementation for fully custom partition extraction based on the `PartitionTimeExtractor` interface. \n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+\t@Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition Commit Policy\n+\n+The partition commit policy defines what action is taken when partitions are committed. \n+\n+- The first is metastore, only hive table supports metastore policy, file system manages partitions through directory structure.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only work with hive table, it is empty implementation for file system table. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\"></td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t\thiveShell.execute(String.format(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad4d80a2795df3e7920d31660a2dea7fe1d5ee5"}, "originalPosition": 293}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzY4MzE5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowOTowNlrOGZ_Eng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjowOTowNlrOGZ_Eng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkwMDk1OA==", "bodyText": "please put the file in section \u300aTable API Connectors\u300b rather than \u300aDataStream Connectors\u300b", "url": "https://github.com/apache/flink/pull/12283#discussion_r429900958", "createdAt": "2020-05-25T12:09:06Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,340 @@\n+---", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad4d80a2795df3e7920d31660a2dea7fe1d5ee5"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3NzY5OTg0OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjoxNTo1MlrOGZ_PHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjoxNTo1MlrOGZ_PHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkwMzY0NQ==", "bodyText": "please check the URL\uff0cthere are some url can not open properly", "url": "https://github.com/apache/flink/pull/12283#discussion_r429903645", "createdAt": "2020-05-25T12:15:52Z", "author": {"login": "leonardBang"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,340 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors\n+nav-pos: 5\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ad4d80a2795df3e7920d31660a2dea7fe1d5ee5"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NzkzNjU0OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo0NjoyNVrOGbj1hQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo0NjoyNVrOGbj1hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MTg3Nw==", "bodyText": "\"A filesystem table can be defined as\"?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431551877", "createdAt": "2020-05-28T02:46:25Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4NzkzNjg5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo0Njo0MVrOGbj1vQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo0Njo0MVrOGbj1vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MTkzMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              'connector' = 'filesystem',           -- required: specify to connector type\n          \n          \n            \n              'connector' = 'filesystem',           -- required: specify the connector type", "url": "https://github.com/apache/flink/pull/12283#discussion_r431551933", "createdAt": "2020-05-28T02:46:41Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk0Mzk4OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo1MTo1MlrOGbj6ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMjo1MTo1MlrOGbj6ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1MzEyNQ==", "bodyText": "\"the default value is false\"?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431553125", "createdAt": "2020-05-28T02:51:52Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk1NzkxOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzowMTo1MlrOGbkDYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMzozMDoyMFrOGb1I0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NTQyNw==", "bodyText": "So user can roll a part file either by size or by time, or both?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431555427", "createdAt": "2020-05-28T03:01:52Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgzNTM0NQ==", "bodyText": "yes", "url": "https://github.com/apache/flink/pull/12283#discussion_r431835345", "createdAt": "2020-05-28T13:30:20Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NTQyNw=="}, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk2MDYzOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzowMzo0NFrOGbkFLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMzozMToxOFrOGb1Lig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NTg4NQ==", "bodyText": "Why is this called memory size? And what's the difference between memory size and the file size that a user can see in the file system?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431555885", "createdAt": "2020-05-28T03:03:44Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgzNjA0Mg==", "bodyText": "I think it is a legacy reason, and it is used in disk too.", "url": "https://github.com/apache/flink/pull/12283#discussion_r431836042", "createdAt": "2020-05-28T13:31:18Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NTg4NQ=="}, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 122}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk2NzE5OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzowNzo1N1rOGbkJNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMzozMzo0OVrOGb1SIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NjkxNg==", "bodyText": "Does this mean only bulk formats can work with checkpoints?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431556916", "createdAt": "2020-05-28T03:07:57Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgzNzcyOA==", "bodyText": "No, it means checkpoint must trigger rolling for bulk formats, but not for row-based.", "url": "https://github.com/apache/flink/pull/12283#discussion_r431837728", "createdAt": "2020-05-28T13:33:49Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1NjkxNg=="}, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 134}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk3OTQ3OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzoxNToyOFrOGbkQTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzozNzoyOFrOGbkjOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1ODczNA==", "bodyText": "What happens if late data arrives after a partition is committed? Is it appended to the partition or discarded?", "url": "https://github.com/apache/flink/pull/12283#discussion_r431558734", "createdAt": "2020-05-28T03:15:28Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">process-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'process-time': based on the time of the machine, it neither requires partition time extraction nor watermark generation. Commit partition once the 'current system time' passes 'partition creation system time' plus 'delay'. 'partition-time': based on the time that extracted from partition values, it requires watermark generation. Commit partition once the 'watermark' passes 'time extracted from partition values' plus 'delay'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is partition processing time. It neither requires partition time extraction nor watermark\n+generation. The trigger of partition commit according to partition creation time and current system time. This trigger\n+is more universal, but not so precise. For example, data delay or failover will lead to premature partition commit.\n+- The second is the trigger of partition commit according to the time that extracted from partition values and watermark.\n+This requires that your job has watermark generation, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+\n+If you want to let downstream see the partition as soon as possible, no matter whether its data is complete or not:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='0s' (Default value)\n+Once there is data in the partition, it will immediately commit. Note: the partition may be committed multiple times.\n+\n+If you want to let downstream see the partition only when its data is complete, and your job has watermark generation, and you can extract the time from partition values:\n+- 'sink.partition-commit.trigger'='partition-time'\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+This is the most accurate way to commit partition, and it will try to ensure that the committed partitions are as data complete as possible.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 191}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU2MzU3OQ==", "bodyText": "I just saw the earlier discussions about this question. I guess we should also mention it in the doc.", "url": "https://github.com/apache/flink/pull/12283#discussion_r431563579", "createdAt": "2020-05-28T03:37:28Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">process-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'process-time': based on the time of the machine, it neither requires partition time extraction nor watermark generation. Commit partition once the 'current system time' passes 'partition creation system time' plus 'delay'. 'partition-time': based on the time that extracted from partition values, it requires watermark generation. Commit partition once the 'watermark' passes 'time extracted from partition values' plus 'delay'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is partition processing time. It neither requires partition time extraction nor watermark\n+generation. The trigger of partition commit according to partition creation time and current system time. This trigger\n+is more universal, but not so precise. For example, data delay or failover will lead to premature partition commit.\n+- The second is the trigger of partition commit according to the time that extracted from partition values and watermark.\n+This requires that your job has watermark generation, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+\n+If you want to let downstream see the partition as soon as possible, no matter whether its data is complete or not:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='0s' (Default value)\n+Once there is data in the partition, it will immediately commit. Note: the partition may be committed multiple times.\n+\n+If you want to let downstream see the partition only when its data is complete, and your job has watermark generation, and you can extract the time from partition values:\n+- 'sink.partition-commit.trigger'='partition-time'\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+This is the most accurate way to commit partition, and it will try to ensure that the committed partitions are as data complete as possible.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1ODczNA=="}, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 191}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4Nzk4NjkzOnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzoyMDo0MFrOGbkU0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMzoyMDo0MFrOGbkU0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU1OTg4OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>\n          \n          \n            \n                    <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp should be extracted from a single partition field 'dt', can configure: '$dt'. If timestamp should be extracted from multiple partition fields, say 'year', 'month', 'day' and 'hour', can configure: '$year-$month-$day $hour:00:00'. If timestamp should be extracted from two partition fields 'dt' and 'hour', can configure: '$dt $hour:00:00'.</td>", "url": "https://github.com/apache/flink/pull/12283#discussion_r431559888", "createdAt": "2020-05-28T03:20:40Z", "author": {"login": "lirui-apache"}, "path": "docs/dev/table/connectors/filesystem.md", "diffHunk": "@@ -0,0 +1,355 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify to connector type\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is disabled.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">process-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'process-time': based on the time of the machine, it neither requires partition time extraction nor watermark generation. Commit partition once the 'current system time' passes 'partition creation system time' plus 'delay'. 'partition-time': based on the time that extracted from partition values, it requires watermark generation. Commit partition once the 'watermark' passes 'time extracted from partition values' plus 'delay'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is partition processing time. It neither requires partition time extraction nor watermark\n+generation. The trigger of partition commit according to partition creation time and current system time. This trigger\n+is more universal, but not so precise. For example, data delay or failover will lead to premature partition commit.\n+- The second is the trigger of partition commit according to the time that extracted from partition values and watermark.\n+This requires that your job has watermark generation, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+\n+If you want to let downstream see the partition as soon as possible, no matter whether its data is complete or not:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='0s' (Default value)\n+Once there is data in the partition, it will immediately commit. Note: the partition may be committed multiple times.\n+\n+If you want to let downstream see the partition only when its data is complete, and your job has watermark generation, and you can extract the time from partition values:\n+- 'sink.partition-commit.trigger'='partition-time'\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+This is the most accurate way to commit partition, and it will try to ensure that the committed partitions are as data complete as possible.\n+\n+If you want to let downstream see the partition only when its data is complete, but there is no watermark, or the time cannot be extracted from partition values:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+Try to commit partition accurately, but data delay or failover will lead to premature partition commit.\n+\n+#### Partition Time Extractor\n+\n+Time extractors define extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp in partition is single field 'dt', can configure: '$dt'. If timestamp in partition is year, month, day, hour, can configure: '$year-$month-$day $hour:00:00'. If timestamp in partition is dt and hour, can configure: '$dt $hour:00:00'.</td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82265c63292351f29ed7885ba5be97317fa83b9a"}, "originalPosition": 228}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNDIzODE1OnYy", "diffSide": "RIGHT", "path": "docs/dev/table/connectors/filesystem.zh.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxOTo0NDoyN1rOGeBciQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxOTo0NDoyN1rOGeBciQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEzNDE1Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              'sink.partition-commit.policy.kind'='success-file')\n          \n          \n            \n              'sink.partition-commit.policy.kind'='success-file'", "url": "https://github.com/apache/flink/pull/12283#discussion_r434134153", "createdAt": "2020-06-02T19:44:27Z", "author": {"login": "sjwiesman"}, "path": "docs/dev/table/connectors/filesystem.zh.md", "diffHunk": "@@ -0,0 +1,359 @@\n+---\n+title: \"FileSystem Connector\"\n+nav-title: FileSystem Connector\n+nav-parent_id: connectors-table\n+nav-pos: 1\n+---\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+This connector provides access to partitioned files in filesystems\n+supported by the [Flink FileSystem abstraction]({{ site.baseurl}}/ops/filesystems/index.html).\n+\n+* This will be replaced by the TOC\n+{:toc}\n+\n+The file system connector itself is included in Flink and does not require an additional dependency.\n+A corresponding format needs to be specified for reading and writing rows from and to a file system.\n+\n+The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem table can be defined as:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"DDL\" markdown=\"1\">\n+{% highlight sql %}\n+CREATE TABLE MyUserTable (\n+  column_name1 INT,\n+  column_name2 STRING,\n+  ...\n+  part_name1 INT,\n+  part_name2 STRING\n+) PARTITIONED BY (part_name1, part_name2) WITH (\n+  'connector' = 'filesystem',           -- required: specify the connector\n+  'path' = 'file:///path/to/whatever',  -- required: path to a directory\n+  'format' = '...',                     -- required: file system connector requires to specify a format,\n+                                        -- Please refer to Table Formats\n+                                        -- section for more details.s\n+  'partition.default-name' = '...',     -- optional: default partition name in case the dynamic partition\n+                                        -- column value is null/empty string.\n+  \n+  -- optional: the option to enable shuffle data by dynamic partition fields in sink phase, this can greatly\n+  -- reduce the number of file for filesystem sink but may lead data skew, the default value is false.\n+  'sink.shuffle-by-partition.enable' = '...',\n+  ...\n+)\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+<span class=\"label label-danger\">Attention</span> Make sure to include [Flink File System specific dependencies]({{ site.baseurl }}/ops/filesystems/index.html).\n+\n+<span class=\"label label-danger\">Attention</span> File system sources for streaming is still under development. In the future, the community will add support for common streaming use cases, i.e., partition and directory monitoring.\n+\n+## Partition Files\n+\n+Flink's file system partition support uses the standard hive format. However, it does not require partitions to be pre-registered with a table catalog. Partitions are discovered and inferred based on directory structure. For example, a table partitioned based on the directory below would be inferred to contain `datetime` and `hour` partitions.\n+\n+```\n+path\n+\u2514\u2500\u2500 datetime=2019-08-25\n+    \u2514\u2500\u2500 hour=11\n+        \u251c\u2500\u2500 part-0.parquet\n+        \u251c\u2500\u2500 part-1.parquet\n+    \u2514\u2500\u2500 hour=12\n+        \u251c\u2500\u2500 part-0.parquet\n+\u2514\u2500\u2500 datetime=2019-08-26\n+    \u2514\u2500\u2500 hour=6\n+        \u251c\u2500\u2500 part-0.parquet\n+```\n+\n+The file system table supports both partition inserting and overwrite inserting. See [INSERT Statement]({{ site.baseurl }}/dev/table/sql/insert.html). When you insert overwrite to a partitioned table, only the corresponding partition will be overwritten, not the entire table.\n+\n+## File Formats\n+\n+The file system connector supports multiple formats:\n+\n+ - CSV: [RFC-4180](https://tools.ietf.org/html/rfc4180). Uncompressed.\n+ - JSON: Note JSON format for file system connector is not a typical JSON file but uncompressed [newline delimited JSON](http://jsonlines.org/).\n+ - Avro: [Apache Avro](http://avro.apache.org). Support compression by configuring `avro.codec`.\n+ - Parquet: [Apache Parquet](http://parquet.apache.org). Compatible with Hive.\n+ - Orc: [Apache Orc](http://orc.apache.org). Compatible with Hive.\n+\n+## Streaming Sink\n+\n+The file system connector supports streaming writes, based on Flink's [Streaming File Sink]({{ site.baseurl }}/dev/connectors/streamfile_sink.html)\n+to write records to file. Row-encoded Formats are csv and json. Bulk-encoded Formats are parquet, orc and avro.\n+\n+### Rolling Policy\n+\n+Data within the partition directories are split into part files. Each partition will contain at least one part file for\n+each subtask of the sink that has received data for that partition. The in-progress part file will be closed and additional\n+part file will be created according to the configurable rolling policy. The policy rolls part files based on size,\n+a timeout that specifies the maximum duration for which a file can be open.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.rolling-policy.file-size</h5></td>\n+        <td style=\"word-wrap: break-word;\">128MB</td>\n+        <td>MemorySize</td>\n+        <td>The maximum part file size before rolling.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.rolling-policy.time-interval</h5></td>\n+        <td style=\"word-wrap: break-word;\">30 m</td>\n+        <td>Duration</td>\n+        <td>The maximum time duration a part file can stay open before rolling (by default 30 min to avoid to many small files).</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+**NOTE:** For bulk formats (parquet, orc, avro), the rolling policy in combination with the checkpoint interval(pending files\n+become finished on the next checkpoint) control the size and number of these parts.\n+\n+**NOTE:** For row formats (csv, json), you can reduce the time interval appropriately to avoid too long delay.\n+\n+### Partition Commit\n+\n+After writing a partition, it is often necessary to notify downstream applications. For example, add the partition to a Hive metastore or writing a `_SUCCESS` file in the directory. The file system sink contains a partition commit feature that allows configuring custom policies. Commit actions are based on a combination of `triggers` and `policies`. \n+\n+- Trigger: The timing of the commit of the partition can be determined by the watermark with the time extracted from the partition, or by processing time.\n+- Policy: How to commit a partition, built-in policies support for the commit of success files and metastore, you can also implement your own policies, such as triggering hive's analysis to generate statistics, or merging small files, etc.\n+\n+#### Partition commit trigger\n+\n+To define when to commit a partition, providing partition commit trigger:\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.trigger</h5></td>\n+        <td style=\"word-wrap: break-word;\">process-time</td>\n+        <td>String</td>\n+        <td>Trigger type for partition commit: 'process-time': based on the time of the machine, it neither requires partition time extraction nor watermark generation. Commit partition once the 'current system time' passes 'partition creation system time' plus 'delay'. 'partition-time': based on the time that extracted from partition values, it requires watermark generation. Commit partition once the 'watermark' passes 'time extracted from partition values' plus 'delay'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.delay</h5></td>\n+        <td style=\"word-wrap: break-word;\">0 s</td>\n+        <td>Duration</td>\n+        <td>The partition will not commit until the delay time. If it is a daily partition, should be '1 d', if it is a hourly partition, should be '1 h'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+There are two types of trigger:\n+- The first is partition processing time. It neither requires partition time extraction nor watermark\n+generation. The trigger of partition commit according to partition creation time and current system time. This trigger\n+is more universal, but not so precise. For example, data delay or failover will lead to premature partition commit.\n+- The second is the trigger of partition commit according to the time that extracted from partition values and watermark.\n+This requires that your job has watermark generation, and the partition is divided according to time, such as\n+hourly partition or daily partition.\n+\n+If you want to let downstream see the partition as soon as possible, no matter whether its data is complete or not:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='0s' (Default value)\n+Once there is data in the partition, it will immediately commit. Note: the partition may be committed multiple times.\n+\n+If you want to let downstream see the partition only when its data is complete, and your job has watermark generation, and you can extract the time from partition values:\n+- 'sink.partition-commit.trigger'='partition-time'\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+This is the most accurate way to commit partition, and it will try to ensure that the committed partitions are as data complete as possible.\n+\n+If you want to let downstream see the partition only when its data is complete, but there is no watermark, or the time cannot be extracted from partition values:\n+- 'sink.partition-commit.trigger'='process-time' (Default value)\n+- 'sink.partition-commit.delay'='1h' ('1h' if your partition is hourly partition, depends on your partition type)\n+Try to commit partition accurately, but data delay or failover will lead to premature partition commit.\n+\n+Late data processing: The record will be written into its partition when a record is supposed to be\n+written into a partition that has already been committed, and then the committing of this partition\n+will be triggered again.\n+\n+#### Partition Time Extractor\n+\n+Time extractors define extracting time from partition values.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>partition.time-extractor.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">default</td>\n+        <td>String</td>\n+        <td>Time extractor to extract time from partition values. Support default and custom. For default, can configure timestamp pattern. For custom, should configure extractor class.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.class</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The extractor class for implement PartitionTimeExtractor interface.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>partition.time-extractor.timestamp-pattern</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The 'default' construction way allows users to use partition fields to get a legal timestamp pattern. Default support 'yyyy-mm-dd hh:mm:ss' from first field. If timestamp should be extracted from a single partition field 'dt', can configure: '$dt'. If timestamp should be extracted from multiple partition fields, say 'year', 'month', 'day' and 'hour', can configure: '$year-$month-$day $hour:00:00'. If timestamp should be extracted from two partition fields 'dt' and 'hour', can configure: '$dt $hour:00:00'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+The default extractor is based on a timestamp pattern composed of your partition fields. You can also specify an implementation for fully custom partition extraction based on the `PartitionTimeExtractor` interface. \n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class HourPartTimeExtractor implements PartitionTimeExtractor {\n+    @Override\n+    public LocalDateTime extract(List<String> keys, List<String> values) {\n+        String dt = values.get(0);\n+        String hour = values.get(1);\n+\t\treturn Timestamp.valueOf(dt + \" \" + hour + \":00:00\").toLocalDateTime();\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+#### Partition Commit Policy\n+\n+The partition commit policy defines what action is taken when partitions are committed. \n+\n+- The first is metastore, only hive table supports metastore policy, file system manages partitions through directory structure.\n+- The second is the success file, which will write an empty file in the directory corresponding to the partition.\n+\n+<table class=\"table table-bordered\">\n+  <thead>\n+    <tr>\n+        <th class=\"text-left\" style=\"width: 20%\">Key</th>\n+        <th class=\"text-left\" style=\"width: 15%\">Default</th>\n+        <th class=\"text-left\" style=\"width: 10%\">Type</th>\n+        <th class=\"text-left\" style=\"width: 55%\">Description</th>\n+    </tr>\n+  </thead>\n+  <tbody>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.kind</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>Policy to commit a partition is to notify the downstream application that the partition has finished writing, the partition is ready to be read. metastore: add partition to metastore. Only hive table supports metastore policy, file system manages partitions through directory structure. success-file: add '_success' file to directory. Both can be configured at the same time: 'metastore,success-file'. custom: use policy class to create a commit policy. Support to configure multiple policies: 'metastore,success-file'.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.policy.class</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The partition commit policy class for implement PartitionCommitPolicy interface. Only work in custom commit policy.</td>\n+    </tr>\n+    <tr>\n+        <td><h5>sink.partition-commit.success-file.name</h5></td>\n+        <td style=\"word-wrap: break-word;\">(none)</td>\n+        <td>String</td>\n+        <td>The file name for success-file partition commit policy, default is '_SUCCESS'.</td>\n+    </tr>\n+  </tbody>\n+</table>\n+\n+You can extend the implementation of commit policy, The custom commit policy implementation like:\n+\n+<div class=\"codetabs\" markdown=\"1\">\n+<div data-lang=\"java\" markdown=\"1\">\n+{% highlight java %}\n+\n+public class AnalysisCommitPolicy implements PartitionCommitPolicy {\n+    private HiveShell hiveShell;\n+\t@Override\n+\tpublic void commit(Context context) throws Exception {\n+\t    if (hiveShell == null) {\n+\t        hiveShell = createHiveShell(context.catalogName());\n+\t    }\n+\t    hiveShell.execute(String.format(\"ALTER TABLE %s ADD IF NOT EXISTS PARTITION (%s = '%s') location '%s'\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0),\n+\t        context.partitionPath()));\n+\t    hiveShell.execute(String.format(\n+\t        \"ANALYZE TABLE %s PARTITION (%s = '%s') COMPUTE STATISTICS FOR COLUMNS\",\n+\t        context.tableName(),\n+\t        context.partitionKeys().get(0),\n+\t        context.partitionValues().get(0)));\n+\t}\n+}\n+\n+{% endhighlight %}\n+</div>\n+</div>\n+\n+## Full Example\n+\n+The below shows how the file system connector can be used to write a streaming query to write data from Kafka into a file system and runs a batch query to read that data back out. \n+\n+{% highlight sql %}\n+\n+CREATE TABLE kafka_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  log_ts TIMESTAMP(3),\n+  WATERMARK FOR log_ts AS log_ts - INTERVAL '5' SECOND\n+) WITH (...);\n+\n+CREATE TABLE fs_table (\n+  user_id STRING,\n+  order_amount DOUBLE,\n+  dt STRING,\n+  hour STRING\n+) PARTITIONED BY (dt, hour) WITH (\n+  'connector'='filesystem',\n+  'path'='...',\n+  'format'='parquet',\n+  'partition.time-extractor.timestamp-pattern'='$dt $hour:00:00',\n+  'sink.partition-commit.delay'='1 h',\n+  'sink.partition-commit.policy.kind'='success-file')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c29ec64e9bc260015c4b57395ace4a578926fa16"}, "originalPosition": 348}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4549, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}