{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5OTM0ODU0", "number": 14267, "title": "[FLINK-20429][kafka] Using proper watermark interval in KafkaTableITCase.testKafkaTemporalJoinChangelog test", "bodyText": "What is the purpose of the change\n\nThis pull request aims to fix the KafkaTableITCase.testKafkaTemporalJoinChangelog test,  the tables in the test didn't set a watermark interval which means the event will never be late, but the test data contains events with same event timestamp(i.e. two event with timestamp 2020-10-01 12:00:00), thus the earlier event will trigger the watermark directly rather than wait the later event arrived.\n\nBrief change log\n\nSet prober watermark interval for the test table\nAdd extra test record for advancing the latest watermark\n\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (no)\nThe serializers: (no)\nThe runtime per-record code paths (performance sensitive): ( no)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (no)\nThe S3 file system connector: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-12-01T02:46:27Z", "url": "https://github.com/apache/flink/pull/14267", "merged": true, "mergeCommit": {"oid": "803ae412abb74eca6b16e7df82a4b15a7b19876d"}, "closed": true, "closedAt": "2020-12-07T12:33:29Z", "author": {"login": "leonardBang"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjtqungFqTU0NTgyMDM1MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjwdFqABqjQwNzgxMjQyNjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1ODIwMzUx", "url": "https://github.com/apache/flink/pull/14267#pullrequestreview-545820351", "createdAt": "2020-12-07T04:16:41Z", "commit": {"oid": "dda43957a8fed853659da60acabcd64671b2b169"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNDoxNjo0MVrOIAVR_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwNDoxNjo0MVrOIAVR_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzIxOTU4Mg==", "bodyText": "Would be better to use 1 second.", "url": "https://github.com/apache/flink/pull/14267#discussion_r537219582", "createdAt": "2020-12-07T04:16:41Z", "author": {"login": "wuchong"}, "path": "flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/table/KafkaTableITCase.java", "diffHunk": "@@ -551,7 +551,7 @@ public void testKafkaTemporalJoinChangelog() throws Exception {\n \t\t\t\t\t\t\"  order_time TIMESTAMP(3),\\n\" +\n \t\t\t\t\t\t\"  quantity INT,\\n\" +\n \t\t\t\t\t\t\"  purchaser STRING,\\n\" +\n-\t\t\t\t\t\t\"  WATERMARK FOR order_time AS order_time\\n\" +\n+\t\t\t\t\t\t\"  WATERMARK FOR order_time AS order_time - INTERVAL '10' SECOND\\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda43957a8fed853659da60acabcd64671b2b169"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e8f01050d90d2e95fc3520af1e5a3aa088a6d48", "author": {"user": {"login": "leonardBang", "name": "Leonard Xu"}}, "url": "https://github.com/apache/flink/commit/4e8f01050d90d2e95fc3520af1e5a3aa088a6d48", "committedDate": "2020-12-07T07:30:43Z", "message": "[FLINK-20486][hive] Hive temporal join shouldn't require a minimal 1h monitor interval"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dda43957a8fed853659da60acabcd64671b2b169", "author": {"user": {"login": "leonardBang", "name": "Leonard Xu"}}, "url": "https://github.com/apache/flink/commit/dda43957a8fed853659da60acabcd64671b2b169", "committedDate": "2020-12-01T02:36:10Z", "message": "[FLINK-20429][kafka] Using proper watermark interval in KafkaTableITCase.testKafkaTemporalJoinChangelog test"}, "afterCommit": {"oid": "4e8f01050d90d2e95fc3520af1e5a3aa088a6d48", "author": {"user": {"login": "leonardBang", "name": "Leonard Xu"}}, "url": "https://github.com/apache/flink/commit/4e8f01050d90d2e95fc3520af1e5a3aa088a6d48", "committedDate": "2020-12-07T07:30:43Z", "message": "[FLINK-20486][hive] Hive temporal join shouldn't require a minimal 1h monitor interval"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3798, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}