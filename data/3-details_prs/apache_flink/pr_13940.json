{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1OTI2NTU0", "number": 13940, "title": "[FLINK-18546] Upgrade to Kafka Schema Registry Client 5.5.2", "bodyText": "What is the purpose of the change\nThe PR updates the Confluent Schema Registry client version to 5.5.2.\nBrief change log\n\nThe PR changes the packaging of flink-avro-confluent-registry module. We do no longer ship a fat-jar. Instead users should build the fat-jar themselves. It is because the upgraded version of registry client accesses fields from Avro of Jackson types. Because of the fact we can either bundle and shade both Avro and Jackson, or not shade Jackson. I decided it will be best not to ship a fat-jar and leave that decision to users.\nOn the other hand for the sql-client it is better to provide fat-jars, however because of 1. I added a separate flink-sql-avro-confluent-registry module that builds a fat-jar (including Avro, and shaded jackson).\n\nVerifying this change\n\nThe existing tests pass, especially the test_confluent_schema_registry.sh e2e test.\nI tested manually the flink-sql-avro-confluent-registry with sql-client with both java 1.8 and java 1.11. The test I performed was:\n\n\nCreate a table\n\nCREATE TABLE user_behavior (\n  user_id BIGINT,\n  item_id BIGINT,\n  category_id BIGINT,\n  behavior STRING,\n  ts TIMESTAMP(3)\n) WITH (\n  'connector' = 'kafka',\n  'properties.bootstrap.servers' = 'localhost:9092',\n  'scan.startup.mode'='earliest-offset',\n  'topic' = 'user_behavior',\n  'format' = 'avro-confluent',\n  'avro-confluent.schema-registry.url' = 'http://localhost:8082',\n  'avro-confluent.schema-registry.subject' = 'user_behavior'\n)\n\n\nInsert into the table\nQuery the table\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-11-05T09:36:21Z", "url": "https://github.com/apache/flink/pull/13940", "merged": true, "mergeCommit": {"oid": "15fa170caf8f69bdf58863b02c58ff82f947d27a"}, "closed": true, "closedAt": "2020-11-06T12:32:29Z", "author": {"login": "dawidwys"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZfKJegFqTUyNDA4NDY4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZzNw2AH2gAyNTE1OTI2NTU0OmUzMmU4ZTY3MTM2ZjBjNDYwYTUyMjE1ZDFmMWU4ZmQ2ZTUyNGYzNGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDg0Njg4", "url": "https://github.com/apache/flink/pull/13940#pullrequestreview-524084688", "createdAt": "2020-11-05T09:43:28Z", "commit": {"oid": "bf893aeeba444c5d0d41a50e4ced33256e46079b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOTo0MzoyOVrOHt7HDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOTo0MzoyOVrOHt7HDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkxNjQzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - io.confluent:kafka-schema-registry-client:jar:5.5.2\n          \n          \n            \n            - org.apache.kafka:kafka-clients:jar:5.5.2-ccs\n          \n          \n            \n            - io.confluent:common-config:jar:5.5.2\n          \n          \n            \n            - io.confluent:common-utils:jar:5.5.2\n          \n          \n            \n            - org.glassfish.jersey.core:jersey-common:jar:2.30\n          \n          \n            \n            \n          \n          \n            \n            The binary distribution of this product bundles these dependencies under the Eclipse Public License - v 2.0 (https://www.eclipse.org/org/documents/epl-2.0/EPL-2.0.txt)\n          \n          \n            \n            \n          \n          \n            \n            - jakarta.annotation:jakarta.annotation-api:jar:1.3.5\n          \n          \n            \n            - jakarta.ws.rs:jakarta.ws.rs-api:jar:2.1.6\n          \n          \n            \n            - org.glassfish.hk2.external:jakarta.inject:jar:2.6.1\n          \n          \n            \n            - org.glassfish.hk2:osgi-resource-locator:jar:1.0.3\n          \n          \n            \n            - io.confluent:kafka-schema-registry-client:5.5.2\n          \n          \n            \n            - org.apache.kafka:kafka-clients:jar:5.5.2-ccs\n          \n          \n            \n            - io.confluent:common-config:5.5.2\n          \n          \n            \n            - io.confluent:common-utils:5.5.2\n          \n          \n            \n            - org.glassfish.jersey.core:jersey-common:2.30\n          \n          \n            \n            \n          \n          \n            \n            The binary distribution of this product bundles these dependencies under the Eclipse Public License - v 2.0 (https://www.eclipse.org/org/documents/epl-2.0/EPL-2.0.txt)\n          \n          \n            \n            \n          \n          \n            \n            - jakarta.annotation:jakarta.annotation-api:1.3.5\n          \n          \n            \n            - jakarta.ws.rs:jakarta.ws.rs-api:2.1.6\n          \n          \n            \n            - org.glassfish.hk2.external:jakarta.inject:2.6.1\n          \n          \n            \n            - org.glassfish.hk2:osgi-resource-locator:1.0.3", "url": "https://github.com/apache/flink/pull/13940#discussion_r517916430", "createdAt": "2020-11-05T09:43:29Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-avro-confluent-registry/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -0,0 +1,25 @@\n+flink-sql-avro-confluent-registry\n+Copyright 2014-2020 The Apache Software Foundation\n+\n+This product includes software developed at\n+The Apache Software Foundation (http://www.apache.org/).\n+\n+This project bundles the following dependencies under the Apache Software License 2.0. (http://www.apache.org/licenses/LICENSE-2.0.txt)\n+\n+- org.apache.avro:avro:1.10.0\n+- com.fasterxml.jackson.core:jackson-core:2.10.1\n+- com.fasterxml.jackson.core:jackson-databind:2.10.1\n+- com.fasterxml.jackson.core:jackson-annotations:2.10.1\n+- com.apache.commons:commons-compress:1.20\n+- io.confluent:kafka-schema-registry-client:jar:5.5.2\n+- org.apache.kafka:kafka-clients:jar:5.5.2-ccs\n+- io.confluent:common-config:jar:5.5.2\n+- io.confluent:common-utils:jar:5.5.2\n+- org.glassfish.jersey.core:jersey-common:jar:2.30\n+\n+The binary distribution of this product bundles these dependencies under the Eclipse Public License - v 2.0 (https://www.eclipse.org/org/documents/epl-2.0/EPL-2.0.txt)\n+\n+- jakarta.annotation:jakarta.annotation-api:jar:1.3.5\n+- jakarta.ws.rs:jakarta.ws.rs-api:jar:2.1.6\n+- org.glassfish.hk2.external:jakarta.inject:jar:2.6.1\n+- org.glassfish.hk2:osgi-resource-locator:jar:1.0.3", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf893aeeba444c5d0d41a50e4ced33256e46079b"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81ba55e52bfb04eaf42f4a7927074cfb12174501", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/81ba55e52bfb04eaf42f4a7927074cfb12174501", "committedDate": "2020-11-05T09:44:50Z", "message": "[FLINK-18546] Upgrade to Kafka Schema Registry Client 5.5.2\n\nThe commit changes the packaging of flink-avro-confluent-registry module. We do no longer ship a fat-jar. Instead users should build the fat-jar themselves. It is because the upgraded version of registry client accesses fields from Avro of Jackson types. Because of the fact we can either bundle and shade both Avro and Jackson, or not shade Jackson. I decided it will be best not to ship a fat-jar and leave that decision to users.\n\nOn the other hand for the sql-client it is better to provide fat-jars, however because of 1. I added a separate flink-sql-avro-confluent-registry module that builds a fat-jar (including Avro, and shaded jackson)."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf893aeeba444c5d0d41a50e4ced33256e46079b", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/bf893aeeba444c5d0d41a50e4ced33256e46079b", "committedDate": "2020-11-05T09:34:57Z", "message": "[FLINK-18546] Upgrade to Kafka Schema Registry Client 5.5.2\n\nThe commit changes the packaging of flink-avro-confluent-registry module. We do no longer ship a fat-jar. Instead users should build the fat-jar themselves. It is because the upgraded version of registry client accesses fields from Avro of Jackson types. Because of the fact we can either bundle and shade both Avro and Jackson, or not shade Jackson. I decided it will be best not to ship a fat-jar and leave that decision to users.\n\nOn the other hand for the sql-client it is better to provide fat-jars, however because of 1. I added a separate flink-sql-avro-confluent-registry module that builds a fat-jar (including Avro, and shaded jackson)."}, "afterCommit": {"oid": "81ba55e52bfb04eaf42f4a7927074cfb12174501", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/81ba55e52bfb04eaf42f4a7927074cfb12174501", "committedDate": "2020-11-05T09:44:50Z", "message": "[FLINK-18546] Upgrade to Kafka Schema Registry Client 5.5.2\n\nThe commit changes the packaging of flink-avro-confluent-registry module. We do no longer ship a fat-jar. Instead users should build the fat-jar themselves. It is because the upgraded version of registry client accesses fields from Avro of Jackson types. Because of the fact we can either bundle and shade both Avro and Jackson, or not shade Jackson. I decided it will be best not to ship a fat-jar and leave that decision to users.\n\nOn the other hand for the sql-client it is better to provide fat-jars, however because of 1. I added a separate flink-sql-avro-confluent-registry module that builds a fat-jar (including Avro, and shaded jackson)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTExNjEw", "url": "https://github.com/apache/flink/pull/13940#pullrequestreview-524111610", "createdAt": "2020-11-05T10:15:39Z", "commit": {"oid": "81ba55e52bfb04eaf42f4a7927074cfb12174501"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMDoxNTo0MFrOHt8YOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMDoxNTo0MFrOHt8YOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzkzNzIwOQ==", "bodyText": "Sorry that I didn't catch this earlier.\nAre we shipping a copy of the license to our users already? Usually, dependencies with other licenses are shipped like this: https://github.com/apache/flink/tree/master/flink-connectors/flink-connector-kinesis/src/main/resources/META-INF/licenses", "url": "https://github.com/apache/flink/pull/13940#discussion_r517937209", "createdAt": "2020-11-05T10:15:40Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-avro-confluent-registry/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -0,0 +1,25 @@\n+flink-sql-avro-confluent-registry\n+Copyright 2014-2020 The Apache Software Foundation\n+\n+This product includes software developed at\n+The Apache Software Foundation (http://www.apache.org/).\n+\n+This project bundles the following dependencies under the Apache Software License 2.0. (http://www.apache.org/licenses/LICENSE-2.0.txt)\n+\n+- org.apache.avro:avro:1.10.0\n+- com.fasterxml.jackson.core:jackson-core:2.10.1\n+- com.fasterxml.jackson.core:jackson-databind:2.10.1\n+- com.fasterxml.jackson.core:jackson-annotations:2.10.1\n+- com.apache.commons:commons-compress:1.20\n+- io.confluent:kafka-schema-registry-client:5.5.2\n+- org.apache.kafka:kafka-clients:5.5.2-ccs\n+- io.confluent:common-config:5.5.2\n+- io.confluent:common-utils:5.5.2\n+- org.glassfish.jersey.core:jersey-common:2.30\n+\n+The binary distribution of this product bundles these dependencies under the Eclipse Public License - v 2.0 (https://www.eclipse.org/org/documents/epl-2.0/EPL-2.0.txt)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81ba55e52bfb04eaf42f4a7927074cfb12174501"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8489a38ccbde05400d6500a3201aa68f9115440", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/d8489a38ccbde05400d6500a3201aa68f9115440", "committedDate": "2020-11-05T10:37:17Z", "message": "Add license files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0OTYxMjU2", "url": "https://github.com/apache/flink/pull/13940#pullrequestreview-524961256", "createdAt": "2020-11-06T08:55:26Z", "commit": {"oid": "d8489a38ccbde05400d6500a3201aa68f9115440"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e32e8e67136f0c460a52215d1f1e8fd6e524f34b", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/e32e8e67136f0c460a52215d1f1e8fd6e524f34b", "committedDate": "2020-11-06T09:05:32Z", "message": "fix invalid mention in NOTICE"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4827, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}