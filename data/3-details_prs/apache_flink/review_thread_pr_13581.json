{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwOTQzNzk1", "number": 13581, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNjo1MDozMlrOFIb0rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNzoyOToyMlrOFIc7fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0Mzg4NzgxOnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionAttemptID.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNjo1MDozMlrOIKWUmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNjo1MDozMlrOIKWUmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzcyMjM5Mw==", "bodyText": "Would you please add a comment here, something like\n\"the length of two long types representing an executionAttemptId, with the lower part and the upper part taking one long type of length each\" or something similar to explain where 16 comes from.", "url": "https://github.com/apache/flink/pull/13581#discussion_r547722393", "createdAt": "2020-12-23T06:50:32Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionAttemptID.java", "diffHunk": "@@ -31,6 +31,7 @@\n public class ExecutionAttemptID implements java.io.Serializable {\n \n \tprivate static final long serialVersionUID = -1169683445778281344L;\n+\tprivate static final int BYTEBUF_LEN = 16;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NDAxNDMzOnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelID.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNzoxNzowN1rOIKXlYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNzoxNzowN1rOIKXlYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc0MzA3Mg==", "bodyText": "similarly here, please add a comment to explain.", "url": "https://github.com/apache/flink/pull/13581#discussion_r547743072", "createdAt": "2020-12-23T07:17:07Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelID.java", "diffHunk": "@@ -28,6 +28,7 @@\n public class InputChannelID extends AbstractID {\n \n \tprivate static final long serialVersionUID = 1L;\n+\tprivate static final int BYTEBUF_LEN = 16;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NDAyNzI3OnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/IntermediateResultPartitionID.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNzoxOTo1MVrOIKXt4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwODoxNDo0N1rOIKaZyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc0NTI0OQ==", "bodyText": "similarly here, please add a comment.\nWhere are the extra 4 bytes coming from? partitionNum?", "url": "https://github.com/apache/flink/pull/13581#discussion_r547745249", "createdAt": "2020-12-23T07:19:51Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/IntermediateResultPartitionID.java", "diffHunk": "@@ -30,6 +30,7 @@\n public class IntermediateResultPartitionID implements ResultID {\n \n \tprivate static final long serialVersionUID = 1L;\n+\tprivate static final int BYTEBUF_LEN = 20;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc4OTI1Nw==", "bodyText": "Yes, the extra 4 bytes come from the partitionNum.", "url": "https://github.com/apache/flink/pull/13581#discussion_r547789257", "createdAt": "2020-12-23T08:14:47Z", "author": {"login": "KarmaGYZ"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/IntermediateResultPartitionID.java", "diffHunk": "@@ -30,6 +30,7 @@\n public class IntermediateResultPartitionID implements ResultID {\n \n \tprivate static final long serialVersionUID = 1L;\n+\tprivate static final int BYTEBUF_LEN = 20;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc0NTI0OQ=="}, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NDA2OTEwOnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyMessage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwNzoyOToyMlrOIKYJCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwODozMTo1MFrOIKbUjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc1MjIwMw==", "bodyText": "why isCompressed (boolean) is hardcoded, while everything else is not?", "url": "https://github.com/apache/flink/pull/13581#discussion_r547752203", "createdAt": "2020-12-23T07:29:22Z", "author": {"login": "curcur"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyMessage.java", "diffHunk": "@@ -259,7 +259,7 @@ protected Object decode(ChannelHandlerContext ctx, ByteBuf in) throws Exception\n \t\tstatic final byte ID = 0;\n \n \t\t// receiver ID (16), sequence number (4), backlog (4), dataType (1), isCompressed (1), buffer size (4)\n-\t\tstatic final int MESSAGE_HEADER_LENGTH = 16 + 4 + 4 + 1 + 1 + 4;\n+\t\tstatic final int MESSAGE_HEADER_LENGTH = InputChannelID.getByteBufLength() + Integer.BYTES + Integer.BYTES + Byte.BYTES + 1 + Integer.BYTES;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgwNDMwMg==", "bodyText": "After a deeper investigation, I find that a boolean will be treated as a byte in netty. Will change it to Byte.BYTES.", "url": "https://github.com/apache/flink/pull/13581#discussion_r547804302", "createdAt": "2020-12-23T08:31:50Z", "author": {"login": "KarmaGYZ"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyMessage.java", "diffHunk": "@@ -259,7 +259,7 @@ protected Object decode(ChannelHandlerContext ctx, ByteBuf in) throws Exception\n \t\tstatic final byte ID = 0;\n \n \t\t// receiver ID (16), sequence number (4), backlog (4), dataType (1), isCompressed (1), buffer size (4)\n-\t\tstatic final int MESSAGE_HEADER_LENGTH = 16 + 4 + 4 + 1 + 1 + 4;\n+\t\tstatic final int MESSAGE_HEADER_LENGTH = InputChannelID.getByteBufLength() + Integer.BYTES + Integer.BYTES + Byte.BYTES + 1 + Integer.BYTES;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzc1MjIwMw=="}, "originalCommit": {"oid": "05751c9777cba4c922adac2fb1f1c5a980b779da"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 107, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}