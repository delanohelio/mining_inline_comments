{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NDY4NTI4", "number": 11118, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwOTo1OTo1MlrODhAhKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyNzowMlrODhYKGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1OTM4MDg5OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwOTo1OTo1MlrOFrh49A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1MzowNVrOFro3Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE4ODM0MA==", "bodyText": "Could we generate this search table using one function? Besides, it would be great to add some comments on how to generate the search table. It will make it more readable and maintainable. What's your thought?", "url": "https://github.com/apache/flink/pull/11118#discussion_r381188340", "createdAt": "2020-02-19T09:59:52Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwMjU1MQ==", "bodyText": "Yes. Good idea", "url": "https://github.com/apache/flink/pull/11118#discussion_r381302551", "createdAt": "2020-02-19T13:53:05Z", "author": {"login": "HuangXingBo"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE4ODM0MA=="}, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1OTQxMjYwOnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMDowODoyMlrOFriMPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyODoyMlrOFsFV4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE5MzI3OQ==", "bodyText": "What about renamed to _leading_bytes_num", "url": "https://github.com/apache/flink/pull/11118#discussion_r381193279", "createdAt": "2020-02-19T10:08:22Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),\n+                              (False, False, False, False, False, False, False, True),\n+                              (False, False, False, False, False, False, True, False),\n+                              (False, False, False, False, False, False, True, True),\n+                              (False, False, False, False, False, True, False, False),\n+                              (False, False, False, False, False, True, False, True),\n+                              (False, False, False, False, False, True, True, False),\n+                              (False, False, False, False, False, True, True, True),\n+                              (False, False, False, False, True, False, False, False),\n+                              (False, False, False, False, True, False, False, True),\n+                              (False, False, False, False, True, False, True, False),\n+                              (False, False, False, False, True, False, True, True),\n+                              (False, False, False, False, True, True, False, False),\n+                              (False, False, False, False, True, True, False, True),\n+                              (False, False, False, False, True, True, True, False),\n+                              (False, False, False, False, True, True, True, True),\n+                              (False, False, False, True, False, False, False, False),\n+                              (False, False, False, True, False, False, False, True),\n+                              (False, False, False, True, False, False, True, False),\n+                              (False, False, False, True, False, False, True, True),\n+                              (False, False, False, True, False, True, False, False),\n+                              (False, False, False, True, False, True, False, True),\n+                              (False, False, False, True, False, True, True, False),\n+                              (False, False, False, True, False, True, True, True),\n+                              (False, False, False, True, True, False, False, False),\n+                              (False, False, False, True, True, False, False, True),\n+                              (False, False, False, True, True, False, True, False),\n+                              (False, False, False, True, True, False, True, True),\n+                              (False, False, False, True, True, True, False, False),\n+                              (False, False, False, True, True, True, False, True),\n+                              (False, False, False, True, True, True, True, False),\n+                              (False, False, False, True, True, True, True, True),\n+                              (False, False, True, False, False, False, False, False),\n+                              (False, False, True, False, False, False, False, True),\n+                              (False, False, True, False, False, False, True, False),\n+                              (False, False, True, False, False, False, True, True),\n+                              (False, False, True, False, False, True, False, False),\n+                              (False, False, True, False, False, True, False, True),\n+                              (False, False, True, False, False, True, True, False),\n+                              (False, False, True, False, False, True, True, True),\n+                              (False, False, True, False, True, False, False, False),\n+                              (False, False, True, False, True, False, False, True),\n+                              (False, False, True, False, True, False, True, False),\n+                              (False, False, True, False, True, False, True, True),\n+                              (False, False, True, False, True, True, False, False),\n+                              (False, False, True, False, True, True, False, True),\n+                              (False, False, True, False, True, True, True, False),\n+                              (False, False, True, False, True, True, True, True),\n+                              (False, False, True, True, False, False, False, False),\n+                              (False, False, True, True, False, False, False, True),\n+                              (False, False, True, True, False, False, True, False),\n+                              (False, False, True, True, False, False, True, True),\n+                              (False, False, True, True, False, True, False, False),\n+                              (False, False, True, True, False, True, False, True),\n+                              (False, False, True, True, False, True, True, False),\n+                              (False, False, True, True, False, True, True, True),\n+                              (False, False, True, True, True, False, False, False),\n+                              (False, False, True, True, True, False, False, True),\n+                              (False, False, True, True, True, False, True, False),\n+                              (False, False, True, True, True, False, True, True),\n+                              (False, False, True, True, True, True, False, False),\n+                              (False, False, True, True, True, True, False, True),\n+                              (False, False, True, True, True, True, True, False),\n+                              (False, False, True, True, True, True, True, True),\n+                              (False, True, False, False, False, False, False, False),\n+                              (False, True, False, False, False, False, False, True),\n+                              (False, True, False, False, False, False, True, False),\n+                              (False, True, False, False, False, False, True, True),\n+                              (False, True, False, False, False, True, False, False),\n+                              (False, True, False, False, False, True, False, True),\n+                              (False, True, False, False, False, True, True, False),\n+                              (False, True, False, False, False, True, True, True),\n+                              (False, True, False, False, True, False, False, False),\n+                              (False, True, False, False, True, False, False, True),\n+                              (False, True, False, False, True, False, True, False),\n+                              (False, True, False, False, True, False, True, True),\n+                              (False, True, False, False, True, True, False, False),\n+                              (False, True, False, False, True, True, False, True),\n+                              (False, True, False, False, True, True, True, False),\n+                              (False, True, False, False, True, True, True, True),\n+                              (False, True, False, True, False, False, False, False),\n+                              (False, True, False, True, False, False, False, True),\n+                              (False, True, False, True, False, False, True, False),\n+                              (False, True, False, True, False, False, True, True),\n+                              (False, True, False, True, False, True, False, False),\n+                              (False, True, False, True, False, True, False, True),\n+                              (False, True, False, True, False, True, True, False),\n+                              (False, True, False, True, False, True, True, True),\n+                              (False, True, False, True, True, False, False, False),\n+                              (False, True, False, True, True, False, False, True),\n+                              (False, True, False, True, True, False, True, False),\n+                              (False, True, False, True, True, False, True, True),\n+                              (False, True, False, True, True, True, False, False),\n+                              (False, True, False, True, True, True, False, True),\n+                              (False, True, False, True, True, True, True, False),\n+                              (False, True, False, True, True, True, True, True),\n+                              (False, True, True, False, False, False, False, False),\n+                              (False, True, True, False, False, False, False, True),\n+                              (False, True, True, False, False, False, True, False),\n+                              (False, True, True, False, False, False, True, True),\n+                              (False, True, True, False, False, True, False, False),\n+                              (False, True, True, False, False, True, False, True),\n+                              (False, True, True, False, False, True, True, False),\n+                              (False, True, True, False, False, True, True, True),\n+                              (False, True, True, False, True, False, False, False),\n+                              (False, True, True, False, True, False, False, True),\n+                              (False, True, True, False, True, False, True, False),\n+                              (False, True, True, False, True, False, True, True),\n+                              (False, True, True, False, True, True, False, False),\n+                              (False, True, True, False, True, True, False, True),\n+                              (False, True, True, False, True, True, True, False),\n+                              (False, True, True, False, True, True, True, True),\n+                              (False, True, True, True, False, False, False, False),\n+                              (False, True, True, True, False, False, False, True),\n+                              (False, True, True, True, False, False, True, False),\n+                              (False, True, True, True, False, False, True, True),\n+                              (False, True, True, True, False, True, False, False),\n+                              (False, True, True, True, False, True, False, True),\n+                              (False, True, True, True, False, True, True, False),\n+                              (False, True, True, True, False, True, True, True),\n+                              (False, True, True, True, True, False, False, False),\n+                              (False, True, True, True, True, False, False, True),\n+                              (False, True, True, True, True, False, True, False),\n+                              (False, True, True, True, True, False, True, True),\n+                              (False, True, True, True, True, True, False, False),\n+                              (False, True, True, True, True, True, False, True),\n+                              (False, True, True, True, True, True, True, False),\n+                              (False, True, True, True, True, True, True, True),\n+                              (True, False, False, False, False, False, False, False),\n+                              (True, False, False, False, False, False, False, True),\n+                              (True, False, False, False, False, False, True, False),\n+                              (True, False, False, False, False, False, True, True),\n+                              (True, False, False, False, False, True, False, False),\n+                              (True, False, False, False, False, True, False, True),\n+                              (True, False, False, False, False, True, True, False),\n+                              (True, False, False, False, False, True, True, True),\n+                              (True, False, False, False, True, False, False, False),\n+                              (True, False, False, False, True, False, False, True),\n+                              (True, False, False, False, True, False, True, False),\n+                              (True, False, False, False, True, False, True, True),\n+                              (True, False, False, False, True, True, False, False),\n+                              (True, False, False, False, True, True, False, True),\n+                              (True, False, False, False, True, True, True, False),\n+                              (True, False, False, False, True, True, True, True),\n+                              (True, False, False, True, False, False, False, False),\n+                              (True, False, False, True, False, False, False, True),\n+                              (True, False, False, True, False, False, True, False),\n+                              (True, False, False, True, False, False, True, True),\n+                              (True, False, False, True, False, True, False, False),\n+                              (True, False, False, True, False, True, False, True),\n+                              (True, False, False, True, False, True, True, False),\n+                              (True, False, False, True, False, True, True, True),\n+                              (True, False, False, True, True, False, False, False),\n+                              (True, False, False, True, True, False, False, True),\n+                              (True, False, False, True, True, False, True, False),\n+                              (True, False, False, True, True, False, True, True),\n+                              (True, False, False, True, True, True, False, False),\n+                              (True, False, False, True, True, True, False, True),\n+                              (True, False, False, True, True, True, True, False),\n+                              (True, False, False, True, True, True, True, True),\n+                              (True, False, True, False, False, False, False, False),\n+                              (True, False, True, False, False, False, False, True),\n+                              (True, False, True, False, False, False, True, False),\n+                              (True, False, True, False, False, False, True, True),\n+                              (True, False, True, False, False, True, False, False),\n+                              (True, False, True, False, False, True, False, True),\n+                              (True, False, True, False, False, True, True, False),\n+                              (True, False, True, False, False, True, True, True),\n+                              (True, False, True, False, True, False, False, False),\n+                              (True, False, True, False, True, False, False, True),\n+                              (True, False, True, False, True, False, True, False),\n+                              (True, False, True, False, True, False, True, True),\n+                              (True, False, True, False, True, True, False, False),\n+                              (True, False, True, False, True, True, False, True),\n+                              (True, False, True, False, True, True, True, False),\n+                              (True, False, True, False, True, True, True, True),\n+                              (True, False, True, True, False, False, False, False),\n+                              (True, False, True, True, False, False, False, True),\n+                              (True, False, True, True, False, False, True, False),\n+                              (True, False, True, True, False, False, True, True),\n+                              (True, False, True, True, False, True, False, False),\n+                              (True, False, True, True, False, True, False, True),\n+                              (True, False, True, True, False, True, True, False),\n+                              (True, False, True, True, False, True, True, True),\n+                              (True, False, True, True, True, False, False, False),\n+                              (True, False, True, True, True, False, False, True),\n+                              (True, False, True, True, True, False, True, False),\n+                              (True, False, True, True, True, False, True, True),\n+                              (True, False, True, True, True, True, False, False),\n+                              (True, False, True, True, True, True, False, True),\n+                              (True, False, True, True, True, True, True, False),\n+                              (True, False, True, True, True, True, True, True),\n+                              (True, True, False, False, False, False, False, False),\n+                              (True, True, False, False, False, False, False, True),\n+                              (True, True, False, False, False, False, True, False),\n+                              (True, True, False, False, False, False, True, True),\n+                              (True, True, False, False, False, True, False, False),\n+                              (True, True, False, False, False, True, False, True),\n+                              (True, True, False, False, False, True, True, False),\n+                              (True, True, False, False, False, True, True, True),\n+                              (True, True, False, False, True, False, False, False),\n+                              (True, True, False, False, True, False, False, True),\n+                              (True, True, False, False, True, False, True, False),\n+                              (True, True, False, False, True, False, True, True),\n+                              (True, True, False, False, True, True, False, False),\n+                              (True, True, False, False, True, True, False, True),\n+                              (True, True, False, False, True, True, True, False),\n+                              (True, True, False, False, True, True, True, True),\n+                              (True, True, False, True, False, False, False, False),\n+                              (True, True, False, True, False, False, False, True),\n+                              (True, True, False, True, False, False, True, False),\n+                              (True, True, False, True, False, False, True, True),\n+                              (True, True, False, True, False, True, False, False),\n+                              (True, True, False, True, False, True, False, True),\n+                              (True, True, False, True, False, True, True, False),\n+                              (True, True, False, True, False, True, True, True),\n+                              (True, True, False, True, True, False, False, False),\n+                              (True, True, False, True, True, False, False, True),\n+                              (True, True, False, True, True, False, True, False),\n+                              (True, True, False, True, True, False, True, True),\n+                              (True, True, False, True, True, True, False, False),\n+                              (True, True, False, True, True, True, False, True),\n+                              (True, True, False, True, True, True, True, False),\n+                              (True, True, False, True, True, True, True, True),\n+                              (True, True, True, False, False, False, False, False),\n+                              (True, True, True, False, False, False, False, True),\n+                              (True, True, True, False, False, False, True, False),\n+                              (True, True, True, False, False, False, True, True),\n+                              (True, True, True, False, False, True, False, False),\n+                              (True, True, True, False, False, True, False, True),\n+                              (True, True, True, False, False, True, True, False),\n+                              (True, True, True, False, False, True, True, True),\n+                              (True, True, True, False, True, False, False, False),\n+                              (True, True, True, False, True, False, False, True),\n+                              (True, True, True, False, True, False, True, False),\n+                              (True, True, True, False, True, False, True, True),\n+                              (True, True, True, False, True, True, False, False),\n+                              (True, True, True, False, True, True, False, True),\n+                              (True, True, True, False, True, True, True, False),\n+                              (True, True, True, False, True, True, True, True),\n+                              (True, True, True, True, False, False, False, False),\n+                              (True, True, True, True, False, False, False, True),\n+                              (True, True, True, True, False, False, True, False),\n+                              (True, True, True, True, False, False, True, True),\n+                              (True, True, True, True, False, True, False, False),\n+                              (True, True, True, True, False, True, False, True),\n+                              (True, True, True, True, False, True, True, False),\n+                              (True, True, True, True, False, True, True, True),\n+                              (True, True, True, True, True, False, False, False),\n+                              (True, True, True, True, True, False, False, True),\n+                              (True, True, True, True, True, False, True, False),\n+                              (True, True, True, True, True, False, True, True),\n+                              (True, True, True, True, True, True, False, False),\n+                              (True, True, True, True, True, True, False, True),\n+                              (True, True, True, True, True, True, True, False),\n+                              (True, True, True, True, True, True, True, True))\n+\n+    null_byte_search_table = (0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01)\n \n     def __init__(self, field_coders):\n         self._field_coders = field_coders\n         self._filed_count = len(field_coders)\n+        self._complete_byte_num = self._filed_count // 8", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 266}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc2OTE4Nw==", "bodyText": "_complete_byte_num -> _leading_complete_bytes_num\n_leading_bytes_num -> _remaining_bits_num", "url": "https://github.com/apache/flink/pull/11118#discussion_r381769187", "createdAt": "2020-02-20T05:28:22Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),\n+                              (False, False, False, False, False, False, False, True),\n+                              (False, False, False, False, False, False, True, False),\n+                              (False, False, False, False, False, False, True, True),\n+                              (False, False, False, False, False, True, False, False),\n+                              (False, False, False, False, False, True, False, True),\n+                              (False, False, False, False, False, True, True, False),\n+                              (False, False, False, False, False, True, True, True),\n+                              (False, False, False, False, True, False, False, False),\n+                              (False, False, False, False, True, False, False, True),\n+                              (False, False, False, False, True, False, True, False),\n+                              (False, False, False, False, True, False, True, True),\n+                              (False, False, False, False, True, True, False, False),\n+                              (False, False, False, False, True, True, False, True),\n+                              (False, False, False, False, True, True, True, False),\n+                              (False, False, False, False, True, True, True, True),\n+                              (False, False, False, True, False, False, False, False),\n+                              (False, False, False, True, False, False, False, True),\n+                              (False, False, False, True, False, False, True, False),\n+                              (False, False, False, True, False, False, True, True),\n+                              (False, False, False, True, False, True, False, False),\n+                              (False, False, False, True, False, True, False, True),\n+                              (False, False, False, True, False, True, True, False),\n+                              (False, False, False, True, False, True, True, True),\n+                              (False, False, False, True, True, False, False, False),\n+                              (False, False, False, True, True, False, False, True),\n+                              (False, False, False, True, True, False, True, False),\n+                              (False, False, False, True, True, False, True, True),\n+                              (False, False, False, True, True, True, False, False),\n+                              (False, False, False, True, True, True, False, True),\n+                              (False, False, False, True, True, True, True, False),\n+                              (False, False, False, True, True, True, True, True),\n+                              (False, False, True, False, False, False, False, False),\n+                              (False, False, True, False, False, False, False, True),\n+                              (False, False, True, False, False, False, True, False),\n+                              (False, False, True, False, False, False, True, True),\n+                              (False, False, True, False, False, True, False, False),\n+                              (False, False, True, False, False, True, False, True),\n+                              (False, False, True, False, False, True, True, False),\n+                              (False, False, True, False, False, True, True, True),\n+                              (False, False, True, False, True, False, False, False),\n+                              (False, False, True, False, True, False, False, True),\n+                              (False, False, True, False, True, False, True, False),\n+                              (False, False, True, False, True, False, True, True),\n+                              (False, False, True, False, True, True, False, False),\n+                              (False, False, True, False, True, True, False, True),\n+                              (False, False, True, False, True, True, True, False),\n+                              (False, False, True, False, True, True, True, True),\n+                              (False, False, True, True, False, False, False, False),\n+                              (False, False, True, True, False, False, False, True),\n+                              (False, False, True, True, False, False, True, False),\n+                              (False, False, True, True, False, False, True, True),\n+                              (False, False, True, True, False, True, False, False),\n+                              (False, False, True, True, False, True, False, True),\n+                              (False, False, True, True, False, True, True, False),\n+                              (False, False, True, True, False, True, True, True),\n+                              (False, False, True, True, True, False, False, False),\n+                              (False, False, True, True, True, False, False, True),\n+                              (False, False, True, True, True, False, True, False),\n+                              (False, False, True, True, True, False, True, True),\n+                              (False, False, True, True, True, True, False, False),\n+                              (False, False, True, True, True, True, False, True),\n+                              (False, False, True, True, True, True, True, False),\n+                              (False, False, True, True, True, True, True, True),\n+                              (False, True, False, False, False, False, False, False),\n+                              (False, True, False, False, False, False, False, True),\n+                              (False, True, False, False, False, False, True, False),\n+                              (False, True, False, False, False, False, True, True),\n+                              (False, True, False, False, False, True, False, False),\n+                              (False, True, False, False, False, True, False, True),\n+                              (False, True, False, False, False, True, True, False),\n+                              (False, True, False, False, False, True, True, True),\n+                              (False, True, False, False, True, False, False, False),\n+                              (False, True, False, False, True, False, False, True),\n+                              (False, True, False, False, True, False, True, False),\n+                              (False, True, False, False, True, False, True, True),\n+                              (False, True, False, False, True, True, False, False),\n+                              (False, True, False, False, True, True, False, True),\n+                              (False, True, False, False, True, True, True, False),\n+                              (False, True, False, False, True, True, True, True),\n+                              (False, True, False, True, False, False, False, False),\n+                              (False, True, False, True, False, False, False, True),\n+                              (False, True, False, True, False, False, True, False),\n+                              (False, True, False, True, False, False, True, True),\n+                              (False, True, False, True, False, True, False, False),\n+                              (False, True, False, True, False, True, False, True),\n+                              (False, True, False, True, False, True, True, False),\n+                              (False, True, False, True, False, True, True, True),\n+                              (False, True, False, True, True, False, False, False),\n+                              (False, True, False, True, True, False, False, True),\n+                              (False, True, False, True, True, False, True, False),\n+                              (False, True, False, True, True, False, True, True),\n+                              (False, True, False, True, True, True, False, False),\n+                              (False, True, False, True, True, True, False, True),\n+                              (False, True, False, True, True, True, True, False),\n+                              (False, True, False, True, True, True, True, True),\n+                              (False, True, True, False, False, False, False, False),\n+                              (False, True, True, False, False, False, False, True),\n+                              (False, True, True, False, False, False, True, False),\n+                              (False, True, True, False, False, False, True, True),\n+                              (False, True, True, False, False, True, False, False),\n+                              (False, True, True, False, False, True, False, True),\n+                              (False, True, True, False, False, True, True, False),\n+                              (False, True, True, False, False, True, True, True),\n+                              (False, True, True, False, True, False, False, False),\n+                              (False, True, True, False, True, False, False, True),\n+                              (False, True, True, False, True, False, True, False),\n+                              (False, True, True, False, True, False, True, True),\n+                              (False, True, True, False, True, True, False, False),\n+                              (False, True, True, False, True, True, False, True),\n+                              (False, True, True, False, True, True, True, False),\n+                              (False, True, True, False, True, True, True, True),\n+                              (False, True, True, True, False, False, False, False),\n+                              (False, True, True, True, False, False, False, True),\n+                              (False, True, True, True, False, False, True, False),\n+                              (False, True, True, True, False, False, True, True),\n+                              (False, True, True, True, False, True, False, False),\n+                              (False, True, True, True, False, True, False, True),\n+                              (False, True, True, True, False, True, True, False),\n+                              (False, True, True, True, False, True, True, True),\n+                              (False, True, True, True, True, False, False, False),\n+                              (False, True, True, True, True, False, False, True),\n+                              (False, True, True, True, True, False, True, False),\n+                              (False, True, True, True, True, False, True, True),\n+                              (False, True, True, True, True, True, False, False),\n+                              (False, True, True, True, True, True, False, True),\n+                              (False, True, True, True, True, True, True, False),\n+                              (False, True, True, True, True, True, True, True),\n+                              (True, False, False, False, False, False, False, False),\n+                              (True, False, False, False, False, False, False, True),\n+                              (True, False, False, False, False, False, True, False),\n+                              (True, False, False, False, False, False, True, True),\n+                              (True, False, False, False, False, True, False, False),\n+                              (True, False, False, False, False, True, False, True),\n+                              (True, False, False, False, False, True, True, False),\n+                              (True, False, False, False, False, True, True, True),\n+                              (True, False, False, False, True, False, False, False),\n+                              (True, False, False, False, True, False, False, True),\n+                              (True, False, False, False, True, False, True, False),\n+                              (True, False, False, False, True, False, True, True),\n+                              (True, False, False, False, True, True, False, False),\n+                              (True, False, False, False, True, True, False, True),\n+                              (True, False, False, False, True, True, True, False),\n+                              (True, False, False, False, True, True, True, True),\n+                              (True, False, False, True, False, False, False, False),\n+                              (True, False, False, True, False, False, False, True),\n+                              (True, False, False, True, False, False, True, False),\n+                              (True, False, False, True, False, False, True, True),\n+                              (True, False, False, True, False, True, False, False),\n+                              (True, False, False, True, False, True, False, True),\n+                              (True, False, False, True, False, True, True, False),\n+                              (True, False, False, True, False, True, True, True),\n+                              (True, False, False, True, True, False, False, False),\n+                              (True, False, False, True, True, False, False, True),\n+                              (True, False, False, True, True, False, True, False),\n+                              (True, False, False, True, True, False, True, True),\n+                              (True, False, False, True, True, True, False, False),\n+                              (True, False, False, True, True, True, False, True),\n+                              (True, False, False, True, True, True, True, False),\n+                              (True, False, False, True, True, True, True, True),\n+                              (True, False, True, False, False, False, False, False),\n+                              (True, False, True, False, False, False, False, True),\n+                              (True, False, True, False, False, False, True, False),\n+                              (True, False, True, False, False, False, True, True),\n+                              (True, False, True, False, False, True, False, False),\n+                              (True, False, True, False, False, True, False, True),\n+                              (True, False, True, False, False, True, True, False),\n+                              (True, False, True, False, False, True, True, True),\n+                              (True, False, True, False, True, False, False, False),\n+                              (True, False, True, False, True, False, False, True),\n+                              (True, False, True, False, True, False, True, False),\n+                              (True, False, True, False, True, False, True, True),\n+                              (True, False, True, False, True, True, False, False),\n+                              (True, False, True, False, True, True, False, True),\n+                              (True, False, True, False, True, True, True, False),\n+                              (True, False, True, False, True, True, True, True),\n+                              (True, False, True, True, False, False, False, False),\n+                              (True, False, True, True, False, False, False, True),\n+                              (True, False, True, True, False, False, True, False),\n+                              (True, False, True, True, False, False, True, True),\n+                              (True, False, True, True, False, True, False, False),\n+                              (True, False, True, True, False, True, False, True),\n+                              (True, False, True, True, False, True, True, False),\n+                              (True, False, True, True, False, True, True, True),\n+                              (True, False, True, True, True, False, False, False),\n+                              (True, False, True, True, True, False, False, True),\n+                              (True, False, True, True, True, False, True, False),\n+                              (True, False, True, True, True, False, True, True),\n+                              (True, False, True, True, True, True, False, False),\n+                              (True, False, True, True, True, True, False, True),\n+                              (True, False, True, True, True, True, True, False),\n+                              (True, False, True, True, True, True, True, True),\n+                              (True, True, False, False, False, False, False, False),\n+                              (True, True, False, False, False, False, False, True),\n+                              (True, True, False, False, False, False, True, False),\n+                              (True, True, False, False, False, False, True, True),\n+                              (True, True, False, False, False, True, False, False),\n+                              (True, True, False, False, False, True, False, True),\n+                              (True, True, False, False, False, True, True, False),\n+                              (True, True, False, False, False, True, True, True),\n+                              (True, True, False, False, True, False, False, False),\n+                              (True, True, False, False, True, False, False, True),\n+                              (True, True, False, False, True, False, True, False),\n+                              (True, True, False, False, True, False, True, True),\n+                              (True, True, False, False, True, True, False, False),\n+                              (True, True, False, False, True, True, False, True),\n+                              (True, True, False, False, True, True, True, False),\n+                              (True, True, False, False, True, True, True, True),\n+                              (True, True, False, True, False, False, False, False),\n+                              (True, True, False, True, False, False, False, True),\n+                              (True, True, False, True, False, False, True, False),\n+                              (True, True, False, True, False, False, True, True),\n+                              (True, True, False, True, False, True, False, False),\n+                              (True, True, False, True, False, True, False, True),\n+                              (True, True, False, True, False, True, True, False),\n+                              (True, True, False, True, False, True, True, True),\n+                              (True, True, False, True, True, False, False, False),\n+                              (True, True, False, True, True, False, False, True),\n+                              (True, True, False, True, True, False, True, False),\n+                              (True, True, False, True, True, False, True, True),\n+                              (True, True, False, True, True, True, False, False),\n+                              (True, True, False, True, True, True, False, True),\n+                              (True, True, False, True, True, True, True, False),\n+                              (True, True, False, True, True, True, True, True),\n+                              (True, True, True, False, False, False, False, False),\n+                              (True, True, True, False, False, False, False, True),\n+                              (True, True, True, False, False, False, True, False),\n+                              (True, True, True, False, False, False, True, True),\n+                              (True, True, True, False, False, True, False, False),\n+                              (True, True, True, False, False, True, False, True),\n+                              (True, True, True, False, False, True, True, False),\n+                              (True, True, True, False, False, True, True, True),\n+                              (True, True, True, False, True, False, False, False),\n+                              (True, True, True, False, True, False, False, True),\n+                              (True, True, True, False, True, False, True, False),\n+                              (True, True, True, False, True, False, True, True),\n+                              (True, True, True, False, True, True, False, False),\n+                              (True, True, True, False, True, True, False, True),\n+                              (True, True, True, False, True, True, True, False),\n+                              (True, True, True, False, True, True, True, True),\n+                              (True, True, True, True, False, False, False, False),\n+                              (True, True, True, True, False, False, False, True),\n+                              (True, True, True, True, False, False, True, False),\n+                              (True, True, True, True, False, False, True, True),\n+                              (True, True, True, True, False, True, False, False),\n+                              (True, True, True, True, False, True, False, True),\n+                              (True, True, True, True, False, True, True, False),\n+                              (True, True, True, True, False, True, True, True),\n+                              (True, True, True, True, True, False, False, False),\n+                              (True, True, True, True, True, False, False, True),\n+                              (True, True, True, True, True, False, True, False),\n+                              (True, True, True, True, True, False, True, True),\n+                              (True, True, True, True, True, True, False, False),\n+                              (True, True, True, True, True, True, False, True),\n+                              (True, True, True, True, True, True, True, False),\n+                              (True, True, True, True, True, True, True, True))\n+\n+    null_byte_search_table = (0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01)\n \n     def __init__(self, field_coders):\n         self._field_coders = field_coders\n         self._filed_count = len(field_coders)\n+        self._complete_byte_num = self._filed_count // 8", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE5MzI3OQ=="}, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 266}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1OTQyNTM1OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMDoxMjowMVrOFriUIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMDoxMjowMVrOFriUIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTE5NTI5Nw==", "bodyText": "Make write_null_mask non-static? then this change is not needed any more.", "url": "https://github.com/apache/flink/pull/11118#discussion_r381195297", "createdAt": "2020-02-19T10:12:01Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),\n+                              (False, False, False, False, False, False, False, True),\n+                              (False, False, False, False, False, False, True, False),\n+                              (False, False, False, False, False, False, True, True),\n+                              (False, False, False, False, False, True, False, False),\n+                              (False, False, False, False, False, True, False, True),\n+                              (False, False, False, False, False, True, True, False),\n+                              (False, False, False, False, False, True, True, True),\n+                              (False, False, False, False, True, False, False, False),\n+                              (False, False, False, False, True, False, False, True),\n+                              (False, False, False, False, True, False, True, False),\n+                              (False, False, False, False, True, False, True, True),\n+                              (False, False, False, False, True, True, False, False),\n+                              (False, False, False, False, True, True, False, True),\n+                              (False, False, False, False, True, True, True, False),\n+                              (False, False, False, False, True, True, True, True),\n+                              (False, False, False, True, False, False, False, False),\n+                              (False, False, False, True, False, False, False, True),\n+                              (False, False, False, True, False, False, True, False),\n+                              (False, False, False, True, False, False, True, True),\n+                              (False, False, False, True, False, True, False, False),\n+                              (False, False, False, True, False, True, False, True),\n+                              (False, False, False, True, False, True, True, False),\n+                              (False, False, False, True, False, True, True, True),\n+                              (False, False, False, True, True, False, False, False),\n+                              (False, False, False, True, True, False, False, True),\n+                              (False, False, False, True, True, False, True, False),\n+                              (False, False, False, True, True, False, True, True),\n+                              (False, False, False, True, True, True, False, False),\n+                              (False, False, False, True, True, True, False, True),\n+                              (False, False, False, True, True, True, True, False),\n+                              (False, False, False, True, True, True, True, True),\n+                              (False, False, True, False, False, False, False, False),\n+                              (False, False, True, False, False, False, False, True),\n+                              (False, False, True, False, False, False, True, False),\n+                              (False, False, True, False, False, False, True, True),\n+                              (False, False, True, False, False, True, False, False),\n+                              (False, False, True, False, False, True, False, True),\n+                              (False, False, True, False, False, True, True, False),\n+                              (False, False, True, False, False, True, True, True),\n+                              (False, False, True, False, True, False, False, False),\n+                              (False, False, True, False, True, False, False, True),\n+                              (False, False, True, False, True, False, True, False),\n+                              (False, False, True, False, True, False, True, True),\n+                              (False, False, True, False, True, True, False, False),\n+                              (False, False, True, False, True, True, False, True),\n+                              (False, False, True, False, True, True, True, False),\n+                              (False, False, True, False, True, True, True, True),\n+                              (False, False, True, True, False, False, False, False),\n+                              (False, False, True, True, False, False, False, True),\n+                              (False, False, True, True, False, False, True, False),\n+                              (False, False, True, True, False, False, True, True),\n+                              (False, False, True, True, False, True, False, False),\n+                              (False, False, True, True, False, True, False, True),\n+                              (False, False, True, True, False, True, True, False),\n+                              (False, False, True, True, False, True, True, True),\n+                              (False, False, True, True, True, False, False, False),\n+                              (False, False, True, True, True, False, False, True),\n+                              (False, False, True, True, True, False, True, False),\n+                              (False, False, True, True, True, False, True, True),\n+                              (False, False, True, True, True, True, False, False),\n+                              (False, False, True, True, True, True, False, True),\n+                              (False, False, True, True, True, True, True, False),\n+                              (False, False, True, True, True, True, True, True),\n+                              (False, True, False, False, False, False, False, False),\n+                              (False, True, False, False, False, False, False, True),\n+                              (False, True, False, False, False, False, True, False),\n+                              (False, True, False, False, False, False, True, True),\n+                              (False, True, False, False, False, True, False, False),\n+                              (False, True, False, False, False, True, False, True),\n+                              (False, True, False, False, False, True, True, False),\n+                              (False, True, False, False, False, True, True, True),\n+                              (False, True, False, False, True, False, False, False),\n+                              (False, True, False, False, True, False, False, True),\n+                              (False, True, False, False, True, False, True, False),\n+                              (False, True, False, False, True, False, True, True),\n+                              (False, True, False, False, True, True, False, False),\n+                              (False, True, False, False, True, True, False, True),\n+                              (False, True, False, False, True, True, True, False),\n+                              (False, True, False, False, True, True, True, True),\n+                              (False, True, False, True, False, False, False, False),\n+                              (False, True, False, True, False, False, False, True),\n+                              (False, True, False, True, False, False, True, False),\n+                              (False, True, False, True, False, False, True, True),\n+                              (False, True, False, True, False, True, False, False),\n+                              (False, True, False, True, False, True, False, True),\n+                              (False, True, False, True, False, True, True, False),\n+                              (False, True, False, True, False, True, True, True),\n+                              (False, True, False, True, True, False, False, False),\n+                              (False, True, False, True, True, False, False, True),\n+                              (False, True, False, True, True, False, True, False),\n+                              (False, True, False, True, True, False, True, True),\n+                              (False, True, False, True, True, True, False, False),\n+                              (False, True, False, True, True, True, False, True),\n+                              (False, True, False, True, True, True, True, False),\n+                              (False, True, False, True, True, True, True, True),\n+                              (False, True, True, False, False, False, False, False),\n+                              (False, True, True, False, False, False, False, True),\n+                              (False, True, True, False, False, False, True, False),\n+                              (False, True, True, False, False, False, True, True),\n+                              (False, True, True, False, False, True, False, False),\n+                              (False, True, True, False, False, True, False, True),\n+                              (False, True, True, False, False, True, True, False),\n+                              (False, True, True, False, False, True, True, True),\n+                              (False, True, True, False, True, False, False, False),\n+                              (False, True, True, False, True, False, False, True),\n+                              (False, True, True, False, True, False, True, False),\n+                              (False, True, True, False, True, False, True, True),\n+                              (False, True, True, False, True, True, False, False),\n+                              (False, True, True, False, True, True, False, True),\n+                              (False, True, True, False, True, True, True, False),\n+                              (False, True, True, False, True, True, True, True),\n+                              (False, True, True, True, False, False, False, False),\n+                              (False, True, True, True, False, False, False, True),\n+                              (False, True, True, True, False, False, True, False),\n+                              (False, True, True, True, False, False, True, True),\n+                              (False, True, True, True, False, True, False, False),\n+                              (False, True, True, True, False, True, False, True),\n+                              (False, True, True, True, False, True, True, False),\n+                              (False, True, True, True, False, True, True, True),\n+                              (False, True, True, True, True, False, False, False),\n+                              (False, True, True, True, True, False, False, True),\n+                              (False, True, True, True, True, False, True, False),\n+                              (False, True, True, True, True, False, True, True),\n+                              (False, True, True, True, True, True, False, False),\n+                              (False, True, True, True, True, True, False, True),\n+                              (False, True, True, True, True, True, True, False),\n+                              (False, True, True, True, True, True, True, True),\n+                              (True, False, False, False, False, False, False, False),\n+                              (True, False, False, False, False, False, False, True),\n+                              (True, False, False, False, False, False, True, False),\n+                              (True, False, False, False, False, False, True, True),\n+                              (True, False, False, False, False, True, False, False),\n+                              (True, False, False, False, False, True, False, True),\n+                              (True, False, False, False, False, True, True, False),\n+                              (True, False, False, False, False, True, True, True),\n+                              (True, False, False, False, True, False, False, False),\n+                              (True, False, False, False, True, False, False, True),\n+                              (True, False, False, False, True, False, True, False),\n+                              (True, False, False, False, True, False, True, True),\n+                              (True, False, False, False, True, True, False, False),\n+                              (True, False, False, False, True, True, False, True),\n+                              (True, False, False, False, True, True, True, False),\n+                              (True, False, False, False, True, True, True, True),\n+                              (True, False, False, True, False, False, False, False),\n+                              (True, False, False, True, False, False, False, True),\n+                              (True, False, False, True, False, False, True, False),\n+                              (True, False, False, True, False, False, True, True),\n+                              (True, False, False, True, False, True, False, False),\n+                              (True, False, False, True, False, True, False, True),\n+                              (True, False, False, True, False, True, True, False),\n+                              (True, False, False, True, False, True, True, True),\n+                              (True, False, False, True, True, False, False, False),\n+                              (True, False, False, True, True, False, False, True),\n+                              (True, False, False, True, True, False, True, False),\n+                              (True, False, False, True, True, False, True, True),\n+                              (True, False, False, True, True, True, False, False),\n+                              (True, False, False, True, True, True, False, True),\n+                              (True, False, False, True, True, True, True, False),\n+                              (True, False, False, True, True, True, True, True),\n+                              (True, False, True, False, False, False, False, False),\n+                              (True, False, True, False, False, False, False, True),\n+                              (True, False, True, False, False, False, True, False),\n+                              (True, False, True, False, False, False, True, True),\n+                              (True, False, True, False, False, True, False, False),\n+                              (True, False, True, False, False, True, False, True),\n+                              (True, False, True, False, False, True, True, False),\n+                              (True, False, True, False, False, True, True, True),\n+                              (True, False, True, False, True, False, False, False),\n+                              (True, False, True, False, True, False, False, True),\n+                              (True, False, True, False, True, False, True, False),\n+                              (True, False, True, False, True, False, True, True),\n+                              (True, False, True, False, True, True, False, False),\n+                              (True, False, True, False, True, True, False, True),\n+                              (True, False, True, False, True, True, True, False),\n+                              (True, False, True, False, True, True, True, True),\n+                              (True, False, True, True, False, False, False, False),\n+                              (True, False, True, True, False, False, False, True),\n+                              (True, False, True, True, False, False, True, False),\n+                              (True, False, True, True, False, False, True, True),\n+                              (True, False, True, True, False, True, False, False),\n+                              (True, False, True, True, False, True, False, True),\n+                              (True, False, True, True, False, True, True, False),\n+                              (True, False, True, True, False, True, True, True),\n+                              (True, False, True, True, True, False, False, False),\n+                              (True, False, True, True, True, False, False, True),\n+                              (True, False, True, True, True, False, True, False),\n+                              (True, False, True, True, True, False, True, True),\n+                              (True, False, True, True, True, True, False, False),\n+                              (True, False, True, True, True, True, False, True),\n+                              (True, False, True, True, True, True, True, False),\n+                              (True, False, True, True, True, True, True, True),\n+                              (True, True, False, False, False, False, False, False),\n+                              (True, True, False, False, False, False, False, True),\n+                              (True, True, False, False, False, False, True, False),\n+                              (True, True, False, False, False, False, True, True),\n+                              (True, True, False, False, False, True, False, False),\n+                              (True, True, False, False, False, True, False, True),\n+                              (True, True, False, False, False, True, True, False),\n+                              (True, True, False, False, False, True, True, True),\n+                              (True, True, False, False, True, False, False, False),\n+                              (True, True, False, False, True, False, False, True),\n+                              (True, True, False, False, True, False, True, False),\n+                              (True, True, False, False, True, False, True, True),\n+                              (True, True, False, False, True, True, False, False),\n+                              (True, True, False, False, True, True, False, True),\n+                              (True, True, False, False, True, True, True, False),\n+                              (True, True, False, False, True, True, True, True),\n+                              (True, True, False, True, False, False, False, False),\n+                              (True, True, False, True, False, False, False, True),\n+                              (True, True, False, True, False, False, True, False),\n+                              (True, True, False, True, False, False, True, True),\n+                              (True, True, False, True, False, True, False, False),\n+                              (True, True, False, True, False, True, False, True),\n+                              (True, True, False, True, False, True, True, False),\n+                              (True, True, False, True, False, True, True, True),\n+                              (True, True, False, True, True, False, False, False),\n+                              (True, True, False, True, True, False, False, True),\n+                              (True, True, False, True, True, False, True, False),\n+                              (True, True, False, True, True, False, True, True),\n+                              (True, True, False, True, True, True, False, False),\n+                              (True, True, False, True, True, True, False, True),\n+                              (True, True, False, True, True, True, True, False),\n+                              (True, True, False, True, True, True, True, True),\n+                              (True, True, True, False, False, False, False, False),\n+                              (True, True, True, False, False, False, False, True),\n+                              (True, True, True, False, False, False, True, False),\n+                              (True, True, True, False, False, False, True, True),\n+                              (True, True, True, False, False, True, False, False),\n+                              (True, True, True, False, False, True, False, True),\n+                              (True, True, True, False, False, True, True, False),\n+                              (True, True, True, False, False, True, True, True),\n+                              (True, True, True, False, True, False, False, False),\n+                              (True, True, True, False, True, False, False, True),\n+                              (True, True, True, False, True, False, True, False),\n+                              (True, True, True, False, True, False, True, True),\n+                              (True, True, True, False, True, True, False, False),\n+                              (True, True, True, False, True, True, False, True),\n+                              (True, True, True, False, True, True, True, False),\n+                              (True, True, True, False, True, True, True, True),\n+                              (True, True, True, True, False, False, False, False),\n+                              (True, True, True, True, False, False, False, True),\n+                              (True, True, True, True, False, False, True, False),\n+                              (True, True, True, True, False, False, True, True),\n+                              (True, True, True, True, False, True, False, False),\n+                              (True, True, True, True, False, True, False, True),\n+                              (True, True, True, True, False, True, True, False),\n+                              (True, True, True, True, False, True, True, True),\n+                              (True, True, True, True, True, False, False, False),\n+                              (True, True, True, True, True, False, False, True),\n+                              (True, True, True, True, True, False, True, False),\n+                              (True, True, True, True, True, False, True, True),\n+                              (True, True, True, True, True, True, False, False),\n+                              (True, True, True, True, True, True, False, True),\n+                              (True, True, True, True, True, True, True, False),\n+                              (True, True, True, True, True, True, True, True))\n+\n+    null_byte_search_table = (0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01)\n \n     def __init__(self, field_coders):\n         self._field_coders = field_coders\n         self._filed_count = len(field_coders)\n+        self._complete_byte_num = self._filed_count // 8\n+        self._remaining_bit_num = self._filed_count % 8\n \n     def encode_to_stream(self, value, out_stream, nested):\n-        self.write_null_mask(value, out_stream)\n+        self.write_null_mask(value, self._complete_byte_num, self._remaining_bit_num, out_stream)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 271}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1OTQ1ODI4OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMDoyMToyNFrOFriojA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMDoyMToyNFrOFriojA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTIwMDUyNA==", "bodyText": "ditto", "url": "https://github.com/apache/flink/pull/11118#discussion_r381200524", "createdAt": "2020-02-19T10:21:24Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -25,56 +25,331 @@\n \n \n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = ((False, False, False, False, False, False, False, False),\n+                              (False, False, False, False, False, False, False, True),\n+                              (False, False, False, False, False, False, True, False),\n+                              (False, False, False, False, False, False, True, True),\n+                              (False, False, False, False, False, True, False, False),\n+                              (False, False, False, False, False, True, False, True),\n+                              (False, False, False, False, False, True, True, False),\n+                              (False, False, False, False, False, True, True, True),\n+                              (False, False, False, False, True, False, False, False),\n+                              (False, False, False, False, True, False, False, True),\n+                              (False, False, False, False, True, False, True, False),\n+                              (False, False, False, False, True, False, True, True),\n+                              (False, False, False, False, True, True, False, False),\n+                              (False, False, False, False, True, True, False, True),\n+                              (False, False, False, False, True, True, True, False),\n+                              (False, False, False, False, True, True, True, True),\n+                              (False, False, False, True, False, False, False, False),\n+                              (False, False, False, True, False, False, False, True),\n+                              (False, False, False, True, False, False, True, False),\n+                              (False, False, False, True, False, False, True, True),\n+                              (False, False, False, True, False, True, False, False),\n+                              (False, False, False, True, False, True, False, True),\n+                              (False, False, False, True, False, True, True, False),\n+                              (False, False, False, True, False, True, True, True),\n+                              (False, False, False, True, True, False, False, False),\n+                              (False, False, False, True, True, False, False, True),\n+                              (False, False, False, True, True, False, True, False),\n+                              (False, False, False, True, True, False, True, True),\n+                              (False, False, False, True, True, True, False, False),\n+                              (False, False, False, True, True, True, False, True),\n+                              (False, False, False, True, True, True, True, False),\n+                              (False, False, False, True, True, True, True, True),\n+                              (False, False, True, False, False, False, False, False),\n+                              (False, False, True, False, False, False, False, True),\n+                              (False, False, True, False, False, False, True, False),\n+                              (False, False, True, False, False, False, True, True),\n+                              (False, False, True, False, False, True, False, False),\n+                              (False, False, True, False, False, True, False, True),\n+                              (False, False, True, False, False, True, True, False),\n+                              (False, False, True, False, False, True, True, True),\n+                              (False, False, True, False, True, False, False, False),\n+                              (False, False, True, False, True, False, False, True),\n+                              (False, False, True, False, True, False, True, False),\n+                              (False, False, True, False, True, False, True, True),\n+                              (False, False, True, False, True, True, False, False),\n+                              (False, False, True, False, True, True, False, True),\n+                              (False, False, True, False, True, True, True, False),\n+                              (False, False, True, False, True, True, True, True),\n+                              (False, False, True, True, False, False, False, False),\n+                              (False, False, True, True, False, False, False, True),\n+                              (False, False, True, True, False, False, True, False),\n+                              (False, False, True, True, False, False, True, True),\n+                              (False, False, True, True, False, True, False, False),\n+                              (False, False, True, True, False, True, False, True),\n+                              (False, False, True, True, False, True, True, False),\n+                              (False, False, True, True, False, True, True, True),\n+                              (False, False, True, True, True, False, False, False),\n+                              (False, False, True, True, True, False, False, True),\n+                              (False, False, True, True, True, False, True, False),\n+                              (False, False, True, True, True, False, True, True),\n+                              (False, False, True, True, True, True, False, False),\n+                              (False, False, True, True, True, True, False, True),\n+                              (False, False, True, True, True, True, True, False),\n+                              (False, False, True, True, True, True, True, True),\n+                              (False, True, False, False, False, False, False, False),\n+                              (False, True, False, False, False, False, False, True),\n+                              (False, True, False, False, False, False, True, False),\n+                              (False, True, False, False, False, False, True, True),\n+                              (False, True, False, False, False, True, False, False),\n+                              (False, True, False, False, False, True, False, True),\n+                              (False, True, False, False, False, True, True, False),\n+                              (False, True, False, False, False, True, True, True),\n+                              (False, True, False, False, True, False, False, False),\n+                              (False, True, False, False, True, False, False, True),\n+                              (False, True, False, False, True, False, True, False),\n+                              (False, True, False, False, True, False, True, True),\n+                              (False, True, False, False, True, True, False, False),\n+                              (False, True, False, False, True, True, False, True),\n+                              (False, True, False, False, True, True, True, False),\n+                              (False, True, False, False, True, True, True, True),\n+                              (False, True, False, True, False, False, False, False),\n+                              (False, True, False, True, False, False, False, True),\n+                              (False, True, False, True, False, False, True, False),\n+                              (False, True, False, True, False, False, True, True),\n+                              (False, True, False, True, False, True, False, False),\n+                              (False, True, False, True, False, True, False, True),\n+                              (False, True, False, True, False, True, True, False),\n+                              (False, True, False, True, False, True, True, True),\n+                              (False, True, False, True, True, False, False, False),\n+                              (False, True, False, True, True, False, False, True),\n+                              (False, True, False, True, True, False, True, False),\n+                              (False, True, False, True, True, False, True, True),\n+                              (False, True, False, True, True, True, False, False),\n+                              (False, True, False, True, True, True, False, True),\n+                              (False, True, False, True, True, True, True, False),\n+                              (False, True, False, True, True, True, True, True),\n+                              (False, True, True, False, False, False, False, False),\n+                              (False, True, True, False, False, False, False, True),\n+                              (False, True, True, False, False, False, True, False),\n+                              (False, True, True, False, False, False, True, True),\n+                              (False, True, True, False, False, True, False, False),\n+                              (False, True, True, False, False, True, False, True),\n+                              (False, True, True, False, False, True, True, False),\n+                              (False, True, True, False, False, True, True, True),\n+                              (False, True, True, False, True, False, False, False),\n+                              (False, True, True, False, True, False, False, True),\n+                              (False, True, True, False, True, False, True, False),\n+                              (False, True, True, False, True, False, True, True),\n+                              (False, True, True, False, True, True, False, False),\n+                              (False, True, True, False, True, True, False, True),\n+                              (False, True, True, False, True, True, True, False),\n+                              (False, True, True, False, True, True, True, True),\n+                              (False, True, True, True, False, False, False, False),\n+                              (False, True, True, True, False, False, False, True),\n+                              (False, True, True, True, False, False, True, False),\n+                              (False, True, True, True, False, False, True, True),\n+                              (False, True, True, True, False, True, False, False),\n+                              (False, True, True, True, False, True, False, True),\n+                              (False, True, True, True, False, True, True, False),\n+                              (False, True, True, True, False, True, True, True),\n+                              (False, True, True, True, True, False, False, False),\n+                              (False, True, True, True, True, False, False, True),\n+                              (False, True, True, True, True, False, True, False),\n+                              (False, True, True, True, True, False, True, True),\n+                              (False, True, True, True, True, True, False, False),\n+                              (False, True, True, True, True, True, False, True),\n+                              (False, True, True, True, True, True, True, False),\n+                              (False, True, True, True, True, True, True, True),\n+                              (True, False, False, False, False, False, False, False),\n+                              (True, False, False, False, False, False, False, True),\n+                              (True, False, False, False, False, False, True, False),\n+                              (True, False, False, False, False, False, True, True),\n+                              (True, False, False, False, False, True, False, False),\n+                              (True, False, False, False, False, True, False, True),\n+                              (True, False, False, False, False, True, True, False),\n+                              (True, False, False, False, False, True, True, True),\n+                              (True, False, False, False, True, False, False, False),\n+                              (True, False, False, False, True, False, False, True),\n+                              (True, False, False, False, True, False, True, False),\n+                              (True, False, False, False, True, False, True, True),\n+                              (True, False, False, False, True, True, False, False),\n+                              (True, False, False, False, True, True, False, True),\n+                              (True, False, False, False, True, True, True, False),\n+                              (True, False, False, False, True, True, True, True),\n+                              (True, False, False, True, False, False, False, False),\n+                              (True, False, False, True, False, False, False, True),\n+                              (True, False, False, True, False, False, True, False),\n+                              (True, False, False, True, False, False, True, True),\n+                              (True, False, False, True, False, True, False, False),\n+                              (True, False, False, True, False, True, False, True),\n+                              (True, False, False, True, False, True, True, False),\n+                              (True, False, False, True, False, True, True, True),\n+                              (True, False, False, True, True, False, False, False),\n+                              (True, False, False, True, True, False, False, True),\n+                              (True, False, False, True, True, False, True, False),\n+                              (True, False, False, True, True, False, True, True),\n+                              (True, False, False, True, True, True, False, False),\n+                              (True, False, False, True, True, True, False, True),\n+                              (True, False, False, True, True, True, True, False),\n+                              (True, False, False, True, True, True, True, True),\n+                              (True, False, True, False, False, False, False, False),\n+                              (True, False, True, False, False, False, False, True),\n+                              (True, False, True, False, False, False, True, False),\n+                              (True, False, True, False, False, False, True, True),\n+                              (True, False, True, False, False, True, False, False),\n+                              (True, False, True, False, False, True, False, True),\n+                              (True, False, True, False, False, True, True, False),\n+                              (True, False, True, False, False, True, True, True),\n+                              (True, False, True, False, True, False, False, False),\n+                              (True, False, True, False, True, False, False, True),\n+                              (True, False, True, False, True, False, True, False),\n+                              (True, False, True, False, True, False, True, True),\n+                              (True, False, True, False, True, True, False, False),\n+                              (True, False, True, False, True, True, False, True),\n+                              (True, False, True, False, True, True, True, False),\n+                              (True, False, True, False, True, True, True, True),\n+                              (True, False, True, True, False, False, False, False),\n+                              (True, False, True, True, False, False, False, True),\n+                              (True, False, True, True, False, False, True, False),\n+                              (True, False, True, True, False, False, True, True),\n+                              (True, False, True, True, False, True, False, False),\n+                              (True, False, True, True, False, True, False, True),\n+                              (True, False, True, True, False, True, True, False),\n+                              (True, False, True, True, False, True, True, True),\n+                              (True, False, True, True, True, False, False, False),\n+                              (True, False, True, True, True, False, False, True),\n+                              (True, False, True, True, True, False, True, False),\n+                              (True, False, True, True, True, False, True, True),\n+                              (True, False, True, True, True, True, False, False),\n+                              (True, False, True, True, True, True, False, True),\n+                              (True, False, True, True, True, True, True, False),\n+                              (True, False, True, True, True, True, True, True),\n+                              (True, True, False, False, False, False, False, False),\n+                              (True, True, False, False, False, False, False, True),\n+                              (True, True, False, False, False, False, True, False),\n+                              (True, True, False, False, False, False, True, True),\n+                              (True, True, False, False, False, True, False, False),\n+                              (True, True, False, False, False, True, False, True),\n+                              (True, True, False, False, False, True, True, False),\n+                              (True, True, False, False, False, True, True, True),\n+                              (True, True, False, False, True, False, False, False),\n+                              (True, True, False, False, True, False, False, True),\n+                              (True, True, False, False, True, False, True, False),\n+                              (True, True, False, False, True, False, True, True),\n+                              (True, True, False, False, True, True, False, False),\n+                              (True, True, False, False, True, True, False, True),\n+                              (True, True, False, False, True, True, True, False),\n+                              (True, True, False, False, True, True, True, True),\n+                              (True, True, False, True, False, False, False, False),\n+                              (True, True, False, True, False, False, False, True),\n+                              (True, True, False, True, False, False, True, False),\n+                              (True, True, False, True, False, False, True, True),\n+                              (True, True, False, True, False, True, False, False),\n+                              (True, True, False, True, False, True, False, True),\n+                              (True, True, False, True, False, True, True, False),\n+                              (True, True, False, True, False, True, True, True),\n+                              (True, True, False, True, True, False, False, False),\n+                              (True, True, False, True, True, False, False, True),\n+                              (True, True, False, True, True, False, True, False),\n+                              (True, True, False, True, True, False, True, True),\n+                              (True, True, False, True, True, True, False, False),\n+                              (True, True, False, True, True, True, False, True),\n+                              (True, True, False, True, True, True, True, False),\n+                              (True, True, False, True, True, True, True, True),\n+                              (True, True, True, False, False, False, False, False),\n+                              (True, True, True, False, False, False, False, True),\n+                              (True, True, True, False, False, False, True, False),\n+                              (True, True, True, False, False, False, True, True),\n+                              (True, True, True, False, False, True, False, False),\n+                              (True, True, True, False, False, True, False, True),\n+                              (True, True, True, False, False, True, True, False),\n+                              (True, True, True, False, False, True, True, True),\n+                              (True, True, True, False, True, False, False, False),\n+                              (True, True, True, False, True, False, False, True),\n+                              (True, True, True, False, True, False, True, False),\n+                              (True, True, True, False, True, False, True, True),\n+                              (True, True, True, False, True, True, False, False),\n+                              (True, True, True, False, True, True, False, True),\n+                              (True, True, True, False, True, True, True, False),\n+                              (True, True, True, False, True, True, True, True),\n+                              (True, True, True, True, False, False, False, False),\n+                              (True, True, True, True, False, False, False, True),\n+                              (True, True, True, True, False, False, True, False),\n+                              (True, True, True, True, False, False, True, True),\n+                              (True, True, True, True, False, True, False, False),\n+                              (True, True, True, True, False, True, False, True),\n+                              (True, True, True, True, False, True, True, False),\n+                              (True, True, True, True, False, True, True, True),\n+                              (True, True, True, True, True, False, False, False),\n+                              (True, True, True, True, True, False, False, True),\n+                              (True, True, True, True, True, False, True, False),\n+                              (True, True, True, True, True, False, True, True),\n+                              (True, True, True, True, True, True, False, False),\n+                              (True, True, True, True, True, True, False, True),\n+                              (True, True, True, True, True, True, True, False),\n+                              (True, True, True, True, True, True, True, True))\n+\n+    null_byte_search_table = (0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01)\n \n     def __init__(self, field_coders):\n         self._field_coders = field_coders\n         self._filed_count = len(field_coders)\n+        self._complete_byte_num = self._filed_count // 8\n+        self._remaining_bit_num = self._filed_count % 8\n \n     def encode_to_stream(self, value, out_stream, nested):\n-        self.write_null_mask(value, out_stream)\n+        self.write_null_mask(value, self._complete_byte_num, self._remaining_bit_num, out_stream)\n         for i in range(self._filed_count):\n-            if value[i] is not None:\n-                self._field_coders[i].encode_to_stream(value[i], out_stream, nested)\n+            item = value[i]\n+            if item is not None:\n+                self._field_coders[i].encode_to_stream(item, out_stream, nested)\n \n     def decode_from_stream(self, in_stream, nested):\n-        null_mask = self.read_null_mask(self._filed_count, in_stream)\n+        null_mask = self.read_null_mask(self._complete_byte_num, self._remaining_bit_num, in_stream)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bd212965eac342eb67cb216d47128405462889f"}, "originalPosition": 281}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MDEyMDc5OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1NjoxM1rOFro-ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1NjoxM1rOFro-ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwNDQyMQ==", "bodyText": "It seems that there is no need to introduce this variable.", "url": "https://github.com/apache/flink/pull/11118#discussion_r381304421", "createdAt": "2020-02-19T13:56:13Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -24,57 +24,71 @@\n from pyflink.table import Row\n \n \n+def generate_null_mask_search_table():\n+    \"\"\"\n+    Each bit of one byte represents if the column at the specified position is None or not, e.g.\n+    0x84 represents the first column and the sixth column are None.\n+    \"\"\"\n+    num = 256", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7729a10a210e81cceb6ca909d2d7b73a93ae4c78"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MDEyMzU5OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1Njo1NlrOFro__w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1Njo1NlrOFro__w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwNDgzMQ==", "bodyText": "specified -> corresponding", "url": "https://github.com/apache/flink/pull/11118#discussion_r381304831", "createdAt": "2020-02-19T13:56:56Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -24,57 +24,71 @@\n from pyflink.table import Row\n \n \n+def generate_null_mask_search_table():\n+    \"\"\"\n+    Each bit of one byte represents if the column at the specified position is None or not, e.g.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7729a10a210e81cceb6ca909d2d7b73a93ae4c78"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MjkxNzI3OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMzo1ODozMlrOFsCs9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwMzo1ODozMlrOFsCs9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTcyNTk0MA==", "bodyText": "Make it a private method of FlattenRowCoderImpl? I think there is no need to expose it.", "url": "https://github.com/apache/flink/pull/11118#discussion_r381725940", "createdAt": "2020-02-20T03:58:32Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -24,57 +24,71 @@\n from pyflink.table import Row\n \n \n+def generate_null_mask_search_table():", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7729a10a210e81cceb6ca909d2d7b73a93ae4c78"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MzIzNzU3OnYy", "diffSide": "RIGHT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyMjoyNlrOFsFKmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyMjoyNlrOFsFKmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc2NjI5OQ==", "bodyText": "What about make it an instance variable as it's faster than static variable: https://stackoverflow.com/questions/2714573/instance-variables-vs-class-variables-in-python", "url": "https://github.com/apache/flink/pull/11118#discussion_r381766299", "createdAt": "2020-02-20T05:22:26Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -24,57 +24,71 @@\n from pyflink.table import Row\n \n \n+def generate_null_mask_search_table():\n+    \"\"\"\n+    Each bit of one byte represents if the column at the specified position is None or not, e.g.\n+    0x84 represents the first column and the sixth column are None.\n+    \"\"\"\n+    num = 256\n+    null_mask = []\n+    for b in range(num):\n+        every_num_null_mask = [(b & 0x80) > 0, (b & 0x40) > 0, (b & 0x20) > 0, (b & 0x10) > 0,\n+                               (b & 0x08) > 0, (b & 0x04) > 0, (b & 0x02) > 0, (b & 0x01) > 0]\n+        null_mask.append(tuple(every_num_null_mask))\n+\n+    return tuple(null_mask)\n+\n+\n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = generate_null_mask_search_table()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7729a10a210e81cceb6ca909d2d7b73a93ae4c78"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2MzI1NDAyOnYy", "diffSide": "LEFT", "path": "flink-python/pyflink/fn_execution/coder_impl.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyNzowMlrOFsFTTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNToyNzowMlrOFsFTTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc2ODUyNg==", "bodyText": "Could we add some unit tests for the null mask related logic?", "url": "https://github.com/apache/flink/pull/11118#discussion_r381768526", "createdAt": "2020-02-20T05:27:02Z", "author": {"login": "dianfu"}, "path": "flink-python/pyflink/fn_execution/coder_impl.py", "diffHunk": "@@ -24,57 +24,71 @@\n from pyflink.table import Row\n \n \n+def generate_null_mask_search_table():\n+    \"\"\"\n+    Each bit of one byte represents if the column at the specified position is None or not, e.g.\n+    0x84 represents the first column and the sixth column are None.\n+    \"\"\"\n+    num = 256\n+    null_mask = []\n+    for b in range(num):\n+        every_num_null_mask = [(b & 0x80) > 0, (b & 0x40) > 0, (b & 0x20) > 0, (b & 0x10) > 0,\n+                               (b & 0x08) > 0, (b & 0x04) > 0, (b & 0x02) > 0, (b & 0x01) > 0]\n+        null_mask.append(tuple(every_num_null_mask))\n+\n+    return tuple(null_mask)\n+\n+\n class FlattenRowCoderImpl(StreamCoderImpl):\n+    null_mask_search_table = generate_null_mask_search_table()\n+\n+    null_byte_search_table = (0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01)\n \n     def __init__(self, field_coders):\n         self._field_coders = field_coders\n         self._filed_count = len(field_coders)\n+        self._complete_byte_num = self._filed_count // 8\n+        self._leading_bytes_num = self._filed_count % 8\n \n     def encode_to_stream(self, value, out_stream, nested):\n         self.write_null_mask(value, out_stream)\n         for i in range(self._filed_count):\n-            if value[i] is not None:\n-                self._field_coders[i].encode_to_stream(value[i], out_stream, nested)\n+            item = value[i]\n+            if item is not None:\n+                self._field_coders[i].encode_to_stream(item, out_stream, nested)\n \n     def decode_from_stream(self, in_stream, nested):\n-        null_mask = self.read_null_mask(self._filed_count, in_stream)\n+        null_mask = self.read_null_mask(in_stream)\n         return [None if null_mask[idx] else self._field_coders[idx].decode_from_stream(\n             in_stream, nested) for idx in range(0, self._filed_count)]\n \n-    @staticmethod\n-    def write_null_mask(value, out_stream):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7729a10a210e81cceb6ca909d2d7b73a93ae4c78"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 941, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}