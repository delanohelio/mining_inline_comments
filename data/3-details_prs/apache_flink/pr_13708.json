{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2OTE2Nzkz", "number": 13708, "title": "[FLINK-19734][table-planner-blink] Replace 'collection' connector by 'values' connector for temporal join plan tests", "bodyText": "What is the purpose of the change\nThe 'collection' connector is a legacy connector, we should use the 'values' connector which is based on FLIP-95 interfaces.\nBrief change log\n\nReplace 'collection' connector by 'values' connector in plan tests\nDecouple scan source and lookup source for values connector\n\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-10-20T15:47:19Z", "url": "https://github.com/apache/flink/pull/13708", "merged": true, "mergeCommit": {"oid": "fc91b0830384e10b87ff0d8ab05258e3f89a8d1b"}, "closed": true, "closedAt": "2020-10-22T03:26:00Z", "author": {"login": "wuchong"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUas29gH2gAyNTA2OTE2NzkzOjc3OTBkZGQ2NTcxMTI1M2E2ZTU1ZTk5MDhlZGQ1NDFkYjMwYjRiNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUts-BAFqTUxMzcwODYwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7790ddd65711253a6e55e9908edd541db30b4b70", "author": {"user": {"login": "wuchong", "name": "Jark Wu"}}, "url": "https://github.com/apache/flink/commit/7790ddd65711253a6e55e9908edd541db30b4b70", "committedDate": "2020-10-20T15:42:15Z", "message": "[FLINK-19734][table-planner-blink] Replace 'collection' connector by 'values' connector for temporal join plan tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMjg2MTA5", "url": "https://github.com/apache/flink/pull/13708#pullrequestreview-513286109", "createdAt": "2020-10-21T03:45:44Z", "commit": {"oid": "7790ddd65711253a6e55e9908edd541db30b4b70"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMzo0NTo0NFrOHlZLUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMzo0NTo0NFrOHlZLUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk3MTg1OQ==", "bodyText": "Could we add one Collection test to ensure the temporal join plan works fine with Legacy connector?", "url": "https://github.com/apache/flink/pull/13708#discussion_r508971859", "createdAt": "2020-10-21T03:45:44Z", "author": {"login": "leonardBang"}, "path": "flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/stream/sql/join/TemporalJoinTest.xml", "diffHunk": "@@ -43,13 +43,13 @@ Calc(select=[amount, currency, rowtime, PROCTIME_MATERIALIZE(proctime) AS procti\n    :- Exchange(distribution=[hash[currency]])\n    :  +- WatermarkAssigner(rowtime=[rowtime], watermark=[rowtime])\n    :     +- Calc(select=[amount, currency, rowtime, PROCTIME() AS proctime])\n-   :        +- LegacyTableSourceScan(table=[[default_catalog, default_database, Orders, source: [CollectionTableSource(amount, currency, rowtime)]]], fields=[amount, currency, rowtime])\n+   :        +- TableSourceScan(table=[[default_catalog, default_database, Orders]], fields=[amount, currency, rowtime])\n    +- Exchange(distribution=[hash[currency]])\n       +- Calc(select=[currency, rate, rowtime], where=[<(rate, 100)])\n          +- Rank(strategy=[AppendFastStrategy], rankType=[ROW_NUMBER], rankRange=[rankStart=1, rankEnd=1], partitionBy=[currency], orderBy=[rowtime DESC], select=[currency, rate, rowtime])\n             +- Exchange(distribution=[hash[currency]])\n                +- WatermarkAssigner(rowtime=[rowtime], watermark=[rowtime])\n-                  +- LegacyTableSourceScan(table=[[default_catalog, default_database, RatesHistory, source: [CollectionTableSource(currency, rate, rowtime)]]], fields=[currency, rate, rowtime])\n+                  +- TableSourceScan(table=[[default_catalog, default_database, RatesHistory]], fields=[currency, rate, rowtime])", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7790ddd65711253a6e55e9908edd541db30b4b70"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78020d78e6cddf182a97d1f44926bb50a3691284", "author": {"user": {"login": "wuchong", "name": "Jark Wu"}}, "url": "https://github.com/apache/flink/commit/78020d78e6cddf182a97d1f44926bb50a3691284", "committedDate": "2020-10-21T12:57:09Z", "message": "add plan tests for legacy source"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNzA4NjA5", "url": "https://github.com/apache/flink/pull/13708#pullrequestreview-513708609", "createdAt": "2020-10-21T13:50:34Z", "commit": {"oid": "78020d78e6cddf182a97d1f44926bb50a3691284"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2942, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}