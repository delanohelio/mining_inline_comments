{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NTA5NzYy", "number": 12048, "title": "[FLINK-17586][python] Use the real StreamExecutionEnvironment contained in DummyStreamExecutionEnvironment when translating the Python UDF physical nodes to operators.", "bodyText": "What is the purpose of the change\nThis pull request gets the real Configuration object from DummyStreamExecutionEnvironment when translating the Python UDF physical nodes to operators.\nBrief change log\n\nGet the real environment object from the DummyStreamExecutionEnvironment before getting the configuration.\n\nVerifying this change\nThis change can be verified as follows:\n\nPrepare a sql job with python udfs.\nSubmit the sql job with python dependency management command line options.\n\nNOTE: This change can be verify automatically after adding the PyFlink e2e tests.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (no)\nThe serializers: (no)\nThe runtime per-record code paths (performance sensitive): (no)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (no)\nThe S3 file system connector: (no)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (no)\nIf yes, how is the feature documented? (not applicable)", "createdAt": "2020-05-09T03:49:54Z", "url": "https://github.com/apache/flink/pull/12048", "merged": true, "mergeCommit": {"oid": "61fe14f3a2ebf31891187eff1a9a6fb92b35c776"}, "closed": true, "closedAt": "2020-05-09T11:34:53Z", "author": {"login": "WeiZhong94"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfd9OFgH2gAyNDE1NTA5NzYyOjBlYTI0Y2NjNTc2MDk3YjQ4OWQ1ZjBkMTZkNDY0MzE4Y2UzOTQ5ZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcff8bsAFqTQwODYxNTQ0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0ea24ccc576097b489d5f0d16d464318ce3949d3", "author": {"user": {"login": "WeiZhong94", "name": "Wei Zhong"}}, "url": "https://github.com/apache/flink/commit/0ea24ccc576097b489d5f0d16d464318ce3949d3", "committedDate": "2020-05-09T03:31:51Z", "message": "[FLINK-17586][python] get the real Configuration object from DummyStreamExecutionEnvironment when translating the Python UDF physical nodes to operators."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjE0ODg4", "url": "https://github.com/apache/flink/pull/12048#pullrequestreview-408614888", "createdAt": "2020-05-09T05:40:45Z", "commit": {"oid": "0ea24ccc576097b489d5f0d16d464318ce3949d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQwNTo0MDo0NVrOGS4pzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQwNTo0MDo0NVrOGS4pzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ1NTc1OA==", "bodyText": "Should we also consider the DummyExecutionEnvironment?", "url": "https://github.com/apache/flink/pull/12048#discussion_r422455758", "createdAt": "2020-05-09T05:40:45Z", "author": {"login": "dianfu"}, "path": "flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/nodes/CommonPythonBase.scala", "diffHunk": "@@ -136,6 +140,16 @@ trait CommonPythonBase {\n     config.addAll(tableConfig.getConfiguration)\n     config\n   }\n+\n+  private def getRealEnvironment(env: StreamExecutionEnvironment): StreamExecutionEnvironment = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ea24ccc576097b489d5f0d16d464318ce3949d3"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjE1NDQ0", "url": "https://github.com/apache/flink/pull/12048#pullrequestreview-408615444", "createdAt": "2020-05-09T05:50:48Z", "commit": {"oid": "0ea24ccc576097b489d5f0d16d464318ce3949d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4213, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}