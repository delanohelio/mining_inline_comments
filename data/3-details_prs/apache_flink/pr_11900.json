{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NDE5NDE5", "number": 11900, "title": "[FLINK-17284][jdbc][postgres] Support serial fields", "bodyText": "What is the purpose of the change\nThis pull request allows to read and write serial fields\nBrief change log\nFrom types spec listed in https://www.postgresql.org/docs/12/datatype-numeric.html, handled serial types in  in PostgresCatalog.fromJDBCType:\n\nserial, serial2 , serial4  as INT\nbigserial, serial8 as BIGINT\nsmallserial as SMALLINT\n\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nHowever serial type is auto-incremented: you can write a value into it but if you try to autogenerate a value you get duplicate values until you find a value that is not already in use. However Flink does not keep track of the original field type so there's no way to warn the user that is not using this field correctly (he/she should use DEFAULT or not specify any value for such columns).\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no\nIf yes, how is the feature documented? not documented", "createdAt": "2020-04-24T08:52:37Z", "url": "https://github.com/apache/flink/pull/11900", "merged": true, "mergeCommit": {"oid": "b0dd0aa639ef973db0341ade7d2fe73384cf2ed3"}, "closed": true, "closedAt": "2020-05-28T04:12:17Z", "author": {"login": "fpompermaier"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcc1MGmgBqjMyOTE2NTAzMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcll5HOgFqTQxOTc2Mzg3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56a3c01587e6e87d3a9d82fbe14c3c72724bb547", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/56a3c01587e6e87d3a9d82fbe14c3c72724bb547", "committedDate": "2020-04-24T19:52:21Z", "message": "Fixed compilation errors"}, "afterCommit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/6d068905bd0bcdcdc6074ec657ee5b87b5377e2c", "committedDate": "2020-04-30T22:53:38Z", "message": "Added tests and removed useless switch cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTM2Mzgw", "url": "https://github.com/apache/flink/pull/11900#pullrequestreview-407136380", "createdAt": "2020-05-07T04:08:49Z", "commit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNDowODo1MFrOGRtriA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNDowOToyOFrOGRtsNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTIyNzQwMA==", "bodyText": "just add comments, rather than commenting out string constants?", "url": "https://github.com/apache/flink/pull/11900#discussion_r421227400", "createdAt": "2020-05-07T04:08:50Z", "author": {"login": "bowenli86"}, "path": "flink-connectors/flink-jdbc/src/main/java/org/apache/flink/api/java/io/jdbc/catalog/PostgresCatalog.java", "diffHunk": "@@ -216,6 +216,12 @@ public CatalogBaseTable getTable(ObjectPath tablePath) throws TableNotExistExcep\n \t\t}\n \t}\n \n+\tpublic static final String PG_SERIAL = \"serial\";\n+\t//public static final String PG_SERIAL2 = \"serial2\"; //ResultSetMetaData.getColumnTypeName() returns int2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTIyNzU3Mg==", "bodyText": "why use a separate table rather than reusing existing one?", "url": "https://github.com/apache/flink/pull/11900#discussion_r421227572", "createdAt": "2020-05-07T04:09:28Z", "author": {"login": "bowenli86"}, "path": "flink-connectors/flink-jdbc/src/test/java/org/apache/flink/api/java/io/jdbc/catalog/PostgresCatalogTestBase.java", "diffHunk": "@@ -58,6 +58,7 @@\n \tprotected static final String TABLE5 = \"t5\";\n \tprotected static final String TABLE_PRIMITIVE_TYPE = \"dt\";\n \tprotected static final String TABLE_ARRAY_TYPE = \"dt2\";\n+\tprotected static final String TABLE_SERIAL_TYPE = \"dt3\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/6d068905bd0bcdcdc6074ec657ee5b87b5377e2c", "committedDate": "2020-04-30T22:53:38Z", "message": "Added tests and removed useless switch cases"}, "afterCommit": {"oid": "7dbc5136bfeaccf5ec33190993d0aed31664e1c8", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/7dbc5136bfeaccf5ec33190993d0aed31664e1c8", "committedDate": "2020-05-07T09:32:02Z", "message": "Addressed PR comments, added tests for decimal type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NzAzOTkx", "url": "https://github.com/apache/flink/pull/11900#pullrequestreview-408703991", "createdAt": "2020-05-10T04:47:46Z", "commit": {"oid": "7dbc5136bfeaccf5ec33190993d0aed31664e1c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwNDo0Nzo0NlrOGTAfKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwNDo0Nzo0NlrOGTAfKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjU4NDEwNw==", "bodyText": "I'd recommend to rename dt,dt2, and dt3 to reflect the types they individually contain and test; otherwise, it's getting confusing", "url": "https://github.com/apache/flink/pull/11900#discussion_r422584107", "createdAt": "2020-05-10T04:47:46Z", "author": {"login": "bowenli86"}, "path": "flink-connectors/flink-jdbc/src/test/java/org/apache/flink/api/java/io/jdbc/catalog/PostgresCatalogTestBase.java", "diffHunk": "@@ -58,6 +58,7 @@\n \tprotected static final String TABLE5 = \"t5\";\n \tprotected static final String TABLE_PRIMITIVE_TYPE = \"dt\";\n \tprotected static final String TABLE_ARRAY_TYPE = \"dt2\";\n+\tprotected static final String TABLE_SERIAL_TYPE = \"dt3\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTIyNzU3Mg=="}, "originalCommit": {"oid": "6d068905bd0bcdcdc6074ec657ee5b87b5377e2c"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7dbc5136bfeaccf5ec33190993d0aed31664e1c8", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/7dbc5136bfeaccf5ec33190993d0aed31664e1c8", "committedDate": "2020-05-07T09:32:02Z", "message": "Addressed PR comments, added tests for decimal type"}, "afterCommit": {"oid": "b520f70f3c7dbc88c3260cd00649f3ee6f27180e", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/b520f70f3c7dbc88c3260cd00649f3ee6f27180e", "committedDate": "2020-05-11T21:32:09Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b520f70f3c7dbc88c3260cd00649f3ee6f27180e", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/b520f70f3c7dbc88c3260cd00649f3ee6f27180e", "committedDate": "2020-05-11T21:32:09Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}, "afterCommit": {"oid": "225d015e642e19e1db90604aa01ccd82b96f54a5", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/225d015e642e19e1db90604aa01ccd82b96f54a5", "committedDate": "2020-05-11T21:35:48Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "225d015e642e19e1db90604aa01ccd82b96f54a5", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/225d015e642e19e1db90604aa01ccd82b96f54a5", "committedDate": "2020-05-11T21:35:48Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}, "afterCommit": {"oid": "ab01f79686561ac0677cb1841a92c01955e90c7f", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/ab01f79686561ac0677cb1841a92c01955e90c7f", "committedDate": "2020-05-11T21:37:46Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab01f79686561ac0677cb1841a92c01955e90c7f", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/ab01f79686561ac0677cb1841a92c01955e90c7f", "committedDate": "2020-05-11T21:37:46Z", "message": "[FLINK-17537][connectors / jdbc] Support serial fields"}, "afterCommit": {"oid": "61bc4171b2761832ba38b60f62f4979ab9783090", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/61bc4171b2761832ba38b60f62f4979ab9783090", "committedDate": "2020-05-19T14:54:05Z", "message": "Rebased code"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61bc4171b2761832ba38b60f62f4979ab9783090", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/61bc4171b2761832ba38b60f62f4979ab9783090", "committedDate": "2020-05-19T14:54:05Z", "message": "Rebased code"}, "afterCommit": {"oid": "69bce2717b0279a894aa66d15cd4b9b72cd5a474", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/69bce2717b0279a894aa66d15cd4b9b72cd5a474", "committedDate": "2020-05-19T14:54:49Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "69bce2717b0279a894aa66d15cd4b9b72cd5a474", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/69bce2717b0279a894aa66d15cd4b9b72cd5a474", "committedDate": "2020-05-19T14:54:49Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "17ee20d6efb84cca02a24b032c9504dcf03ff8a1", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/17ee20d6efb84cca02a24b032c9504dcf03ff8a1", "committedDate": "2020-05-19T15:08:17Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17ee20d6efb84cca02a24b032c9504dcf03ff8a1", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/17ee20d6efb84cca02a24b032c9504dcf03ff8a1", "committedDate": "2020-05-19T15:08:17Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "3ca03cd504f4ed817c49647de1523bf039d82a22", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/3ca03cd504f4ed817c49647de1523bf039d82a22", "committedDate": "2020-05-20T12:26:28Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ca03cd504f4ed817c49647de1523bf039d82a22", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/3ca03cd504f4ed817c49647de1523bf039d82a22", "committedDate": "2020-05-20T12:26:28Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "4cf97b2be4447c2d2f94259ad559fefb79a0a727", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/4cf97b2be4447c2d2f94259ad559fefb79a0a727", "committedDate": "2020-05-20T12:27:30Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4cf97b2be4447c2d2f94259ad559fefb79a0a727", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/4cf97b2be4447c2d2f94259ad559fefb79a0a727", "committedDate": "2020-05-20T12:27:30Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "eeb75e199f3c920c4e36b336ff4598ccaa9acb9f", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/eeb75e199f3c920c4e36b336ff4598ccaa9acb9f", "committedDate": "2020-05-21T22:23:41Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eeb75e199f3c920c4e36b336ff4598ccaa9acb9f", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/eeb75e199f3c920c4e36b336ff4598ccaa9acb9f", "committedDate": "2020-05-21T22:23:41Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "57beefa4d2852424d27ac41d193b188525ed191e", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/57beefa4d2852424d27ac41d193b188525ed191e", "committedDate": "2020-05-21T22:26:15Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57beefa4d2852424d27ac41d193b188525ed191e", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/57beefa4d2852424d27ac41d193b188525ed191e", "committedDate": "2020-05-21T22:26:15Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d", "committedDate": "2020-05-21T22:27:20Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzY3NzY5", "url": "https://github.com/apache/flink/pull/11900#pullrequestreview-417367769", "createdAt": "2020-05-24T15:18:51Z", "commit": {"oid": "ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNToxODo1MlrOGZvlDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxNTozMjoyNVrOGZvpug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY0NzExNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t// serial2 <=> int2\n          \n          \n            \n            \t// serial4 <=> serial\n          \n          \n            \n            \t// serial8 <=> bigserial\n          \n          \n            \n            \t// smallserial <=> int2\n          \n          \n            \n            \t// serial2 <=> int2\n          \n          \n            \n            \t// smallserial <=> int2\n          \n          \n            \n            \t// serial4 <=> serial\n          \n          \n            \n            \t// serial8 <=> bigserial\n          \n      \n    \n    \n  \n\nHow about bubbling up \"// smallserial <=> int2 \" to make them look better?", "url": "https://github.com/apache/flink/pull/11900#discussion_r429647116", "createdAt": "2020-05-24T15:18:52Z", "author": {"login": "leonardBang"}, "path": "flink-connectors/flink-connector-jdbc/src/main/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalog.java", "diffHunk": "@@ -231,13 +231,19 @@ public CatalogBaseTable getTable(ObjectPath tablePath) throws TableNotExistExcep\n \t}\n \n \t// Postgres jdbc driver maps several alias to real type, we use real type rather than alias:\n+\t// serial2 <=> int2\n+\t// serial4 <=> serial\n+\t// serial8 <=> bigserial\n+\t// smallserial <=> int2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY0ODMxNA==", "bodyText": "This values is never used.\nHow about add a ITCase that read serial type data properly to check the type mapping logic? and we can use more meaningful values like \"32767, 2147483647, 32767, 2147483647 , 9223372036854775807, 9223372036854775807\" .", "url": "https://github.com/apache/flink/pull/11900#discussion_r429648314", "createdAt": "2020-05-24T15:32:25Z", "author": {"login": "leonardBang"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogTestBase.java", "diffHunk": "@@ -289,4 +292,29 @@ public static TestTable getArrayTable() {\n \t\t\t));\n \t}\n \n+\tpublic static TestTable getSerialTable() {\n+\t\treturn new TestTable(\n+\t\t\tTableSchema.builder()\n+\t\t\t\t.field(\"f0\", DataTypes.SMALLINT())\n+\t\t\t\t.field(\"f1\", DataTypes.INT())\n+\t\t\t\t.field(\"f2\", DataTypes.SMALLINT())\n+\t\t\t\t.field(\"f3\", DataTypes.INT())\n+\t\t\t\t.field(\"f4\", DataTypes.BIGINT())\n+\t\t\t\t.field(\"f5\", DataTypes.BIGINT())\n+\t\t\t\t.build(),\n+\t\t\t\"f0 smallserial, \" +\n+\t\t\t\t\"f1 serial, \" +\n+\t\t\t\t\"f2 serial2, \" +\n+\t\t\t\t\"f3 serial4, \" +\n+\t\t\t\t\"f4 serial8, \" +\n+\t\t\t\t\"f5 bigserial\",\n+\t\t\t\"0,\" +\n+\t\t\t\t\"1,\" +\n+\t\t\t\t\"2,\" +\n+\t\t\t\t\"3,\" +\n+\t\t\t\t\"4,\" +\n+\t\t\t\t\"5\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3938da0d084dad77f0222157a09ae5a0055f47a", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/c3938da0d084dad77f0222157a09ae5a0055f47a", "committedDate": "2020-05-25T07:27:38Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9190d85e2b0e02af9a1062263e25c6f9a23b1c5d", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/9190d85e2b0e02af9a1062263e25c6f9a23b1c5d", "committedDate": "2020-05-25T07:57:41Z", "message": "Fixed test and addressed comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/ccd3b17332d5a7eb5bb97124cd1a9a4c3986d82d", "committedDate": "2020-05-21T22:27:20Z", "message": "[FLINK-17284][jdbc][postgres] Support serial fields"}, "afterCommit": {"oid": "9190d85e2b0e02af9a1062263e25c6f9a23b1c5d", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/9190d85e2b0e02af9a1062263e25c6f9a23b1c5d", "committedDate": "2020-05-25T07:57:41Z", "message": "Fixed test and addressed comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTE4MDQ2", "url": "https://github.com/apache/flink/pull/11900#pullrequestreview-418118046", "createdAt": "2020-05-26T09:19:24Z", "commit": {"oid": "9190d85e2b0e02af9a1062263e25c6f9a23b1c5d"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxOToyNFrOGaVyGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxOTo1NlrOGaVzQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MzA0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\"2767,\" +\n          \n          \n            \n            \t\t\t\"32767,\" +", "url": "https://github.com/apache/flink/pull/11900#discussion_r430273049", "createdAt": "2020-05-26T09:19:24Z", "author": {"login": "leonardBang"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogTestBase.java", "diffHunk": "@@ -289,4 +292,30 @@ public static TestTable getArrayTable() {\n \t\t\t));\n \t}\n \n+\tpublic static TestTable getSerialTable() {\n+\t\treturn new TestTable(\n+\t\t\tTableSchema.builder()\n+\t\t\t\t// serial fields are returned as not null by ResultSetMetaData.columnNoNulls\n+\t\t\t\t.field(\"f0\", DataTypes.SMALLINT().notNull())\n+\t\t\t\t.field(\"f1\", DataTypes.INT().notNull())\n+\t\t\t\t.field(\"f2\", DataTypes.SMALLINT().notNull())\n+\t\t\t\t.field(\"f3\", DataTypes.INT().notNull())\n+\t\t\t\t.field(\"f4\", DataTypes.BIGINT().notNull())\n+\t\t\t\t.field(\"f5\", DataTypes.BIGINT().notNull())\n+\t\t\t\t.build(),\n+\t\t\t\"f0 smallserial, \" +\n+\t\t\t\t\"f1 serial, \" +\n+\t\t\t\t\"f2 serial2, \" +\n+\t\t\t\t\"f3 serial4, \" +\n+\t\t\t\t\"f4 serial8, \" +\n+\t\t\t\t\"f5 bigserial\",\n+\t\t\t\"2767,\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9190d85e2b0e02af9a1062263e25c6f9a23b1c5d"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MzM0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\"2767,\" +\n          \n          \n            \n            \t\t\t\t\"32767,\" +", "url": "https://github.com/apache/flink/pull/11900#discussion_r430273346", "createdAt": "2020-05-26T09:19:56Z", "author": {"login": "leonardBang"}, "path": "flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogITCase.java", "diffHunk": "@@ -139,4 +139,19 @@ public void testArrayTypes() {\n \t\t\t\t\"[00:51:03, 00:59:03]]\",\n \t\t\tresults.toString());\n \t}\n+\n+\t@Test\n+\tpublic void testSerialTypes() {\n+\t\tList<Row> results = Lists.newArrayList(\n+\t\t\ttEnv.sqlQuery(String.format(\"select * from %s\", TABLE_SERIAL_TYPE)).execute().collect());\n+\n+\t\tassertEquals(\"[\" +\n+\t\t\t\t\"2767,\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9190d85e2b0e02af9a1062263e25c6f9a23b1c5d"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc55b2372cd6eb9c60298a8b8c4187521ff44aa8", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/cc55b2372cd6eb9c60298a8b8c4187521ff44aa8", "committedDate": "2020-05-26T17:11:04Z", "message": "Update flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogTestBase.java\n\nCo-authored-by: Leonard Xu <xbjtdcq@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "591a44a8755aa5ce787b4c555f23fa0ead4eca7c", "author": {"user": {"login": "fpompermaier", "name": "Flavio Pompermaier"}}, "url": "https://github.com/apache/flink/commit/591a44a8755aa5ce787b4c555f23fa0ead4eca7c", "committedDate": "2020-05-26T17:12:32Z", "message": "Update flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/catalog/PostgresCatalogITCase.java\n\nCo-authored-by: Leonard Xu <xbjtdcq@163.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzYzODc2", "url": "https://github.com/apache/flink/pull/11900#pullrequestreview-419763876", "createdAt": "2020-05-28T04:10:09Z", "commit": {"oid": "591a44a8755aa5ce787b4c555f23fa0ead4eca7c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4873, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}