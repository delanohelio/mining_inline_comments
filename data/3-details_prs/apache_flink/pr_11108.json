{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MDM5NTgy", "number": 11108, "title": "[FLINK-16113][table-planner-blink] ExpressionReducer shouldn't escape the reduced string value", "bodyText": "What is the purpose of the change\nExpressionReducer shouldn't escape the reduced string value, the escaping should only happen in code generation, otherwise the output result is inccorect.\nBrief change log\nRemove the escape string logic from ExpressionReducer.\nVerifying this change\nAdded a plan test and an integration test.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-02-17T09:50:09Z", "url": "https://github.com/apache/flink/pull/11108", "merged": true, "mergeCommit": {"oid": "22899a153c774bd7d491b569e26c1a2e9fd8cd85"}, "closed": true, "closedAt": "2020-02-17T14:45:26Z", "author": {"login": "wuchong"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFKKuSAH2gAyMzc2MDM5NTgyOmJlNTY5NzY5MWMxOWQ5YTA5NTU5OWNkYzNlMTM0MDhiODRlOTM3M2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFKmsUgH2gAyMzc2MDM5NTgyOjRlZjVhNDFkZWRlNzI3NDI4OWM2NWJhYjdiNWU1YmI2MzU2M2FmMGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a", "author": {"user": {"login": "wuchong", "name": "Jark Wu"}}, "url": "https://github.com/apache/flink/commit/be5697691c19d9a095599cdc3e13408b84e9373a", "committedDate": "2020-02-17T09:46:28Z", "message": "[FLINK-16113][table-planner-blink] ExpressionReducer shouldn't escape the reduced string value"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NjE5NDk2", "url": "https://github.com/apache/flink/pull/11108#pullrequestreview-359619496", "createdAt": "2020-02-17T10:09:58Z", "commit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDowOTo1OFrOFqe31g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDowOTo1OFrOFqe31g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA5MDMyNg==", "bodyText": "This code should consistent with GenerateUtils.generateLiteral.\nIt is merging error when merged blink to flink.", "url": "https://github.com/apache/flink/pull/11108#discussion_r380090326", "createdAt": "2020-02-17T10:09:58Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/ExpressionReducer.scala", "diffHunk": "@@ -138,8 +138,8 @@ class ExpressionReducer(\n                SqlTypeName.MULTISET =>\n             reducedValues.add(unreduced)\n           case SqlTypeName.VARCHAR | SqlTypeName.CHAR =>\n-            val escapeVarchar = StringEscapeUtils", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NjIwMDkw", "url": "https://github.com/apache/flink/pull/11108#pullrequestreview-359620090", "createdAt": "2020-02-17T10:10:51Z", "commit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDoxMDo1MlrOFqe5iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDoxMDo1MlrOFqe5iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA5MDc2MA==", "bodyText": "Do we have to add a it case?", "url": "https://github.com/apache/flink/pull/11108#discussion_r380090760", "createdAt": "2020-02-17T10:10:52Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/CalcITCase.scala", "diffHunk": "@@ -284,4 +284,21 @@ class CalcITCase extends StreamingTestBase {\n       assertEquals(expected, result)\n     )\n   }\n+\n+  @Test\n+  def testFilterOnNonAsciiLiteral(): Unit = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NjIwMTk3", "url": "https://github.com/apache/flink/pull/11108#pullrequestreview-359620197", "createdAt": "2020-02-17T10:11:02Z", "commit": {"oid": "be5697691c19d9a095599cdc3e13408b84e9373a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ef5a41dede7274289c65bab7b5e5bb63563af0b", "author": {"user": {"login": "wuchong", "name": "Jark Wu"}}, "url": "https://github.com/apache/flink/commit/4ef5a41dede7274289c65bab7b5e5bb63563af0b", "committedDate": "2020-02-17T10:17:01Z", "message": "remove IT case"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4395, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}