{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNDQ4NDg1", "number": 11288, "title": "[FLINK-16350][e2e] Run half of streaming HA tests against ZK 3.5", "bodyText": "The test uses the bin/zookeeper.sh script from the Flink distribution to start zookeeper. This makes use of the zookeeper version bundled in lib. By switching the jars we thus not only change the version of the client, but also the version of the zk server.", "createdAt": "2020-03-02T15:28:48Z", "url": "https://github.com/apache/flink/pull/11288", "merged": true, "mergeCommit": {"oid": "108f52804cfe5541c922f4aa461d6b9dc52a806d"}, "closed": true, "closedAt": "2020-03-12T13:26:23Z", "author": {"login": "zentol"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJvcd9AH2gAyMzgyNDQ4NDg1OjI5NzYxNzg4NmJkOWFkMjIwYjlkMDA3NzA0MTQ1ZGJmN2YzNmE1ZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcM4rIVAH2gAyMzgyNDQ4NDg1OjQyNWY0NDI3N2M3NzUxYmZiNzQ5MTkwMTNlODRhYWI0OGQ4ZjI3MGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "297617886bd9ad220b9d007704145dbf7f36a5fd", "author": {"user": {"login": "zentol", "name": "Chesnay Schepler"}}, "url": "https://github.com/apache/flink/commit/297617886bd9ad220b9d007704145dbf7f36a5fd", "committedDate": "2020-03-02T15:28:02Z", "message": "[FLINK-16350][e2e] Run half of streaming HA tests against ZK 3.5"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjY2ODU0", "url": "https://github.com/apache/flink/pull/11288#pullrequestreview-368666854", "createdAt": "2020-03-04T10:34:11Z", "commit": {"oid": "297617886bd9ad220b9d007704145dbf7f36a5fd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMDozNDoxMlrOFxn-9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMDozNDoxMlrOFxn-9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU3OTYzNw==", "bodyText": "This logic won't work because of common.sh#backup_flink_dir which will overwrite lib after the end of the test. I think it should work if we only copy flink-shaded-zookeeper-3.5 instead of moving it.", "url": "https://github.com/apache/flink/pull/11288#discussion_r387579637", "createdAt": "2020-03-04T10:34:12Z", "author": {"login": "tillrohrmann"}, "path": "flink-end-to-end-tests/test-scripts/common.sh", "diffHunk": "@@ -101,6 +101,20 @@ function revert_flink_dir() {\n     CURL_SSL_ARGS=\"\"\n }\n \n+function use_zookeeper_34() {\n+  if [ -e \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.5* ]; then\n+    mv \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.5* \"${FLINK_DIR}/opt\"\n+    mv \"${FLINK_DIR}\"/opt/flink-shaded-zookeeper-3.4* \"${FLINK_DIR}/lib\"\n+  fi\n+}\n+\n+function use_zookeeper_35() {\n+  if [ -e \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.4* ]; then\n+    mv \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.4* \"${FLINK_DIR}/opt\"\n+    mv \"${FLINK_DIR}\"/opt/flink-shaded-zookeeper-3.5* \"${FLINK_DIR}/lib\"\n+  fi\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "297617886bd9ad220b9d007704145dbf7f36a5fd"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4479ba78fddb94b572a802662b100c31bfd651f0", "author": {"user": {"login": "zentol", "name": "Chesnay Schepler"}}, "url": "https://github.com/apache/flink/commit/4479ba78fddb94b572a802662b100c31bfd651f0", "committedDate": "2020-03-04T12:28:58Z", "message": "never modify opt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d6cf20446dbf6e210792be9940027ae3ab2de46", "author": {"user": {"login": "zentol", "name": "Chesnay Schepler"}}, "url": "https://github.com/apache/flink/commit/5d6cf20446dbf6e210792be9940027ae3ab2de46", "committedDate": "2020-03-04T12:38:53Z", "message": "+"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODYyMDQ0", "url": "https://github.com/apache/flink/pull/11288#pullrequestreview-368862044", "createdAt": "2020-03-04T15:14:03Z", "commit": {"oid": "5d6cf20446dbf6e210792be9940027ae3ab2de46"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNToxNDowM1rOFxxOfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNToxNDowM1rOFxxOfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzczMTA2OQ==", "bodyText": "Where does opt/zookeeper-3.4 come from? I think per default only zookeeper-3.5 is in opt.", "url": "https://github.com/apache/flink/pull/11288#discussion_r387731069", "createdAt": "2020-03-04T15:14:03Z", "author": {"login": "tillrohrmann"}, "path": "flink-end-to-end-tests/test-scripts/common.sh", "diffHunk": "@@ -101,6 +101,24 @@ function revert_flink_dir() {\n     CURL_SSL_ARGS=\"\"\n }\n \n+function use_zookeeper_34() {\n+  if [ -e \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.5* ]; then\n+    # contents of 'opt' must not be changed since it is not backed up in common.sh#backup_flink_dir\n+    # it is fine to delete jars from 'lib' since it is backed up and will be restored after the test\n+    rm \"${FLINK_DIR}\"/lib/flink-shaded-zookeeper-3.5*\n+    cp \"${FLINK_DIR}\"/opt/flink-shaded-zookeeper-3.4* \"${FLINK_DIR}/lib\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d6cf20446dbf6e210792be9940027ae3ab2de46"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cf04823e0e8b9a97fcfab622e7ae0f8cb0fec5e", "author": {"user": {"login": "zentol", "name": "Chesnay Schepler"}}, "url": "https://github.com/apache/flink/commit/3cf04823e0e8b9a97fcfab622e7ae0f8cb0fec5e", "committedDate": "2020-03-11T21:15:40Z", "message": "+"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "425f44277c7751bfb74919013e84aab48d8f270d", "author": {"user": {"login": "zentol", "name": "Chesnay Schepler"}}, "url": "https://github.com/apache/flink/commit/425f44277c7751bfb74919013e84aab48d8f270d", "committedDate": "2020-03-12T09:54:58Z", "message": "+"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2979, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}