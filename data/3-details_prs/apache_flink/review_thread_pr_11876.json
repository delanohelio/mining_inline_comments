{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NzUwODg4", "number": 11876, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTozNjo0NlrOD2ol8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMTozNzozMlrOD3Jwng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjE0NzcwOnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/functions/hive/conversion/HiveInspectors.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTozNjo0NlrOGMemqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwMjoxNDo0M1rOGM_erw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTczNzUxMw==", "bodyText": "Why do we still need these changes? Actually I think this method is no longer needed", "url": "https://github.com/apache/flink/pull/11876#discussion_r415737513", "createdAt": "2020-04-27T11:36:46Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/functions/hive/conversion/HiveInspectors.java", "diffHunk": "@@ -354,25 +354,25 @@ public static ObjectInspector getObjectInspector(HiveShim hiveShim, Class clazz)\n \t\tif (clazz.equals(String.class) || clazz.equals(Text.class)) {\n \n \t\t\ttypeInfo = TypeInfoFactory.stringTypeInfo;\n-\t\t} else if (clazz.equals(Boolean.class) || clazz.equals(BooleanWritable.class)) {\n+\t\t} else if (clazz.equals(boolean.class) || clazz.equals(Boolean.class) || clazz.equals(BooleanWritable.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI3NjE0Mw==", "bodyText": "Ok, I will remove the method.", "url": "https://github.com/apache/flink/pull/11876#discussion_r416276143", "createdAt": "2020-04-28T02:14:43Z", "author": {"login": "z8r-coder"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/functions/hive/conversion/HiveInspectors.java", "diffHunk": "@@ -354,25 +354,25 @@ public static ObjectInspector getObjectInspector(HiveShim hiveShim, Class clazz)\n \t\tif (clazz.equals(String.class) || clazz.equals(Text.class)) {\n \n \t\t\ttypeInfo = TypeInfoFactory.stringTypeInfo;\n-\t\t} else if (clazz.equals(Boolean.class) || clazz.equals(BooleanWritable.class)) {\n+\t\t} else if (clazz.equals(boolean.class) || clazz.equals(Boolean.class) || clazz.equals(BooleanWritable.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTczNzUxMw=="}, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjE4MDg3OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTo0NTowOFrOGMe5ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwMjozNzowNlrOGM_6Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0MjM5NA==", "bodyText": "Why we allow a 1.0 delta here? And I think 3.0f should be the expected value and udf.eval(3.0f) should be the actual value.", "url": "https://github.com/apache/flink/pull/11876#discussion_r415742394", "createdAt": "2020-04-27T11:45:08Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -49,6 +50,30 @@\n public class HiveSimpleUDFTest {\n \tprivate static HiveShim hiveShim = HiveShimLoader.loadHiveShim(HiveShimLoader.getHiveVersion());\n \n+\t@Test\n+\tpublic void testBooleanUDF() {\n+\t\tHiveSimpleUDF udf = init(BooleanUDF.class, new DataType[]{ DataTypes.INT()});\n+\t\tassertTrue((boolean) udf.eval(1));\n+\t}\n+\n+\t@Test\n+\tpublic void testFloatUDF() {\n+\t\tHiveSimpleUDF udf = init(FloatUDF.class, new DataType[]{ DataTypes.FLOAT()});\n+\t\tassertEquals((float) udf.eval(3.0f), 3.0f, 1.0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjI4MzIzMQ==", "bodyText": "the function need a positive delta\nstatic public void assertEquals(float expected, float actual, float delta)\nasserts that two floats are equal to within a positive delta.\nI have set delta to 0", "url": "https://github.com/apache/flink/pull/11876#discussion_r416283231", "createdAt": "2020-04-28T02:37:06Z", "author": {"login": "z8r-coder"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -49,6 +50,30 @@\n public class HiveSimpleUDFTest {\n \tprivate static HiveShim hiveShim = HiveShimLoader.loadHiveShim(HiveShimLoader.getHiveVersion());\n \n+\t@Test\n+\tpublic void testBooleanUDF() {\n+\t\tHiveSimpleUDF udf = init(BooleanUDF.class, new DataType[]{ DataTypes.INT()});\n+\t\tassertTrue((boolean) udf.eval(1));\n+\t}\n+\n+\t@Test\n+\tpublic void testFloatUDF() {\n+\t\tHiveSimpleUDF udf = init(FloatUDF.class, new DataType[]{ DataTypes.FLOAT()});\n+\t\tassertEquals((float) udf.eval(3.0f), 3.0f, 1.0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0MjM5NA=="}, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjE4NDM1OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTo0NjowMlrOGMe7wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTo0NjowMlrOGMe7wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0MjkxNA==", "bodyText": "just return content == 1", "url": "https://github.com/apache/flink/pull/11876#discussion_r415742914", "createdAt": "2020-04-27T11:46:02Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -230,4 +255,64 @@ protected static HiveSimpleUDF init(Class hiveUdfClass, DataType[] argTypes) {\n \n \t\treturn udf;\n \t}\n+\n+\t/**\n+\t * Boolean Test UDF.\n+\t */\n+\tpublic static class BooleanUDF extends UDF {\n+\t\t/**\n+\t\t *\n+\t\t * @param content input\n+\t\t * @return\n+\t\t */\n+\t\tpublic boolean evaluate(int content) {\n+\t\t\tif (content == 1) {\n+\t\t\t\treturn true;\n+\t\t\t} else {\n+\t\t\t\treturn false;\n+\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4NjE4NzkyOnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTo0Njo0N1rOGMe9tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMTo0Njo0N1rOGMe9tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0MzQxMw==", "bodyText": "Please remove these java docs since they're meaningless.", "url": "https://github.com/apache/flink/pull/11876#discussion_r415743413", "createdAt": "2020-04-27T11:46:47Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -230,4 +255,64 @@ protected static HiveSimpleUDF init(Class hiveUdfClass, DataType[] argTypes) {\n \n \t\treturn udf;\n \t}\n+\n+\t/**\n+\t * Boolean Test UDF.\n+\t */\n+\tpublic static class BooleanUDF extends UDF {\n+\t\t/**\n+\t\t *\n+\t\t * @param content input\n+\t\t * @return\n+\t\t */\n+\t\tpublic boolean evaluate(int content) {\n+\t\t\tif (content == 1) {\n+\t\t\t\treturn true;\n+\t\t\t} else {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\t/**\n+\t * Float Test UDF.\n+\t */\n+\tpublic static class FloatUDF extends UDF {\n+\t\t/**\n+\t\t *\n+\t\t * @param content input\n+\t\t * @return\n+\t\t */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1386aff448073520feb8effc3eac67a4f4577cb"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTU4MTc0OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMTozNzozMlrOGNPwlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMTo0ODowNVrOGNQHNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU0Mjg3MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tassertEquals((float) udf.eval(3.0f), 3.0f, 0);\n          \n          \n            \n            \t\tassertEquals(3.0f, (float) udf.eval(3.0f), 0);\n          \n      \n    \n    \n  \n\nThe 1st argument is the expected value. Same goes for other tests.", "url": "https://github.com/apache/flink/pull/11876#discussion_r416542870", "createdAt": "2020-04-28T11:37:32Z", "author": {"login": "lirui-apache"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -49,6 +50,30 @@\n public class HiveSimpleUDFTest {\n \tprivate static HiveShim hiveShim = HiveShimLoader.loadHiveShim(HiveShimLoader.getHiveVersion());\n \n+\t@Test\n+\tpublic void testBooleanUDF() {\n+\t\tHiveSimpleUDF udf = init(BooleanUDF.class, new DataType[]{ DataTypes.INT()});\n+\t\tassertTrue((boolean) udf.eval(1));\n+\t}\n+\n+\t@Test\n+\tpublic void testFloatUDF() {\n+\t\tHiveSimpleUDF udf = init(FloatUDF.class, new DataType[]{ DataTypes.FLOAT()});\n+\t\tassertEquals((float) udf.eval(3.0f), 3.0f, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46bde5253c0ce7b4c33ef7ab1868b843207a5dcb"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU0ODY2Mg==", "bodyText": "ok", "url": "https://github.com/apache/flink/pull/11876#discussion_r416548662", "createdAt": "2020-04-28T11:48:05Z", "author": {"login": "z8r-coder"}, "path": "flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/functions/hive/HiveSimpleUDFTest.java", "diffHunk": "@@ -49,6 +50,30 @@\n public class HiveSimpleUDFTest {\n \tprivate static HiveShim hiveShim = HiveShimLoader.loadHiveShim(HiveShimLoader.getHiveVersion());\n \n+\t@Test\n+\tpublic void testBooleanUDF() {\n+\t\tHiveSimpleUDF udf = init(BooleanUDF.class, new DataType[]{ DataTypes.INT()});\n+\t\tassertTrue((boolean) udf.eval(1));\n+\t}\n+\n+\t@Test\n+\tpublic void testFloatUDF() {\n+\t\tHiveSimpleUDF udf = init(FloatUDF.class, new DataType[]{ DataTypes.FLOAT()});\n+\t\tassertEquals((float) udf.eval(3.0f), 3.0f, 0);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU0Mjg3MA=="}, "originalCommit": {"oid": "46bde5253c0ce7b4c33ef7ab1868b843207a5dcb"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1580, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}