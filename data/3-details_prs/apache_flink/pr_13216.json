{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNjAwMjI1", "number": 13216, "title": "[FLINK-18999][table-planner-blink][hive] Temporary generic table does\u2026", "bodyText": "\u2026n't work with HiveCatalog\n\nWhat is the purpose of the change\nFix the issue that generic temporary table can't be used with hive catalog\nBrief change log\n\nAvoid using catalog table factory for temporary tables\nAdd test cases\n\nVerifying this change\nExisting and added test cases\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no\nIf yes, how is the feature documented? N/A", "createdAt": "2020-08-21T12:20:13Z", "url": "https://github.com/apache/flink/pull/13216", "merged": true, "mergeCommit": {"oid": "e6d7f97e63a727566125489e527f1dabb225d91e"}, "closed": true, "closedAt": "2020-10-14T03:39:56Z", "author": {"login": "lirui-apache"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDT_7jABqjM3MDM2NzE4NzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSUwyqAFqTUwNzk3MjA4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6cef4d0e4c7cc7f835bad1594abf700df632d22b", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/6cef4d0e4c7cc7f835bad1594abf700df632d22b", "committedDate": "2020-08-24T03:10:18Z", "message": "checkstyle"}, "afterCommit": {"oid": "31eef5a5d1f413435c3a3ccd9764c185b66c1c08", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/31eef5a5d1f413435c3a3ccd9764c185b66c1c08", "committedDate": "2020-08-28T12:16:49Z", "message": "add isTemporary flag"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31eef5a5d1f413435c3a3ccd9764c185b66c1c08", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/31eef5a5d1f413435c3a3ccd9764c185b66c1c08", "committedDate": "2020-08-28T12:16:49Z", "message": "add isTemporary flag"}, "afterCommit": {"oid": "167e78ad9d9f8fdb79ce5b2483feed7f120456a3", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/167e78ad9d9f8fdb79ce5b2483feed7f120456a3", "committedDate": "2020-09-04T11:31:58Z", "message": "add isTemporary flag"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "167e78ad9d9f8fdb79ce5b2483feed7f120456a3", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/167e78ad9d9f8fdb79ce5b2483feed7f120456a3", "committedDate": "2020-09-04T11:31:58Z", "message": "add isTemporary flag"}, "afterCommit": {"oid": "167af46332e5e7d9e142ae44b9c38cefb5d5fe25", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/167af46332e5e7d9e142ae44b9c38cefb5d5fe25", "committedDate": "2020-09-08T06:52:41Z", "message": "add isTemporary flag"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "167af46332e5e7d9e142ae44b9c38cefb5d5fe25", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/167af46332e5e7d9e142ae44b9c38cefb5d5fe25", "committedDate": "2020-09-08T06:52:41Z", "message": "add isTemporary flag"}, "afterCommit": {"oid": "93e3ffb49e8a5ac3e25f8dd81b989a97f3579e2f", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/93e3ffb49e8a5ac3e25f8dd81b989a97f3579e2f", "committedDate": "2020-09-21T07:25:00Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93e3ffb49e8a5ac3e25f8dd81b989a97f3579e2f", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/93e3ffb49e8a5ac3e25f8dd81b989a97f3579e2f", "committedDate": "2020-09-21T07:25:00Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}, "afterCommit": {"oid": "f07cf90226588764811e5e5075d2bca96558aa40", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/f07cf90226588764811e5e5075d2bca96558aa40", "committedDate": "2020-09-22T11:57:00Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f07cf90226588764811e5e5075d2bca96558aa40", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/f07cf90226588764811e5e5075d2bca96558aa40", "committedDate": "2020-09-22T11:57:00Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}, "afterCommit": {"oid": "555452d0580d6eeeced07936ec9947fff8f17b47", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/555452d0580d6eeeced07936ec9947fff8f17b47", "committedDate": "2020-09-27T03:23:20Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MjIzMTQy", "url": "https://github.com/apache/flink/pull/13216#pullrequestreview-497223142", "createdAt": "2020-09-28T06:40:59Z", "commit": {"oid": "00910669a7c7b63e947ee691103578a4dc37545d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjo0MDo1OVrOHYwQ7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjo0MDo1OVrOHYwQ7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxODYzOQ==", "bodyText": "Why don't remove old methods? Looks like they will hides potential bugs.", "url": "https://github.com/apache/flink/pull/13216#discussion_r495718639", "createdAt": "2020-09-28T06:40:59Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java", "diffHunk": "@@ -109,11 +109,27 @@ public static DynamicTableSource createTableSource(\n \t\t\tCatalogTable catalogTable,\n \t\t\tReadableConfig configuration,\n \t\t\tClassLoader classLoader) {\n+\t\treturn createTableSource(catalog, objectIdentifier, catalogTable, configuration, classLoader, false);\n+\t}\n+\n+\t/**\n+\t * Creates a {@link DynamicTableSource} from a {@link CatalogTable}.\n+\t *\n+\t * <p>It considers {@link Catalog#getFactory()} if provided.\n+\t */\n+\tpublic static DynamicTableSource createTableSource(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00910669a7c7b63e947ee691103578a4dc37545d"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "555452d0580d6eeeced07936ec9947fff8f17b47", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/555452d0580d6eeeced07936ec9947fff8f17b47", "committedDate": "2020-09-27T03:23:20Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}, "afterCommit": {"oid": "528277a79d67bb9309ec3d6121d40dfca9e83553", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/528277a79d67bb9309ec3d6121d40dfca9e83553", "committedDate": "2020-09-28T09:56:16Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NDUyMTIz", "url": "https://github.com/apache/flink/pull/13216#pullrequestreview-505452123", "createdAt": "2020-10-09T08:10:27Z", "commit": {"oid": "528277a79d67bb9309ec3d6121d40dfca9e83553"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQwODoxMDoyN1rOHe_hcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQwODoxMDoyN1rOHe_hcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjI2MDA4MQ==", "bodyText": "Not only source, sink too.\nI can see the bug in HiveDynamicTableFactory because not remove old method.", "url": "https://github.com/apache/flink/pull/13216#discussion_r502260081", "createdAt": "2020-10-09T08:10:27Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java", "diffHunk": "@@ -148,11 +150,27 @@ public static DynamicTableSink createTableSink(\n \t\t\tCatalogTable catalogTable,\n \t\t\tReadableConfig configuration,\n \t\t\tClassLoader classLoader) {\n+\t\treturn createTableSink(catalog, objectIdentifier, catalogTable, configuration, classLoader, false);\n+\t}\n+\n+\t/**\n+\t * Creates a {@link DynamicTableSink} from a {@link CatalogTable}.\n+\t *\n+\t * <p>It considers {@link Catalog#getFactory()} if provided.\n+\t */\n+\tpublic static DynamicTableSink createTableSink(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "528277a79d67bb9309ec3d6121d40dfca9e83553"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "528277a79d67bb9309ec3d6121d40dfca9e83553", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/528277a79d67bb9309ec3d6121d40dfca9e83553", "committedDate": "2020-09-28T09:56:16Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}, "afterCommit": {"oid": "8d6ca96817da4640dee68e9c81b7e612e63dfcd9", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/8d6ca96817da4640dee68e9c81b7e612e63dfcd9", "committedDate": "2020-10-10T11:03:42Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d54487cef393aa7088f46f7d0b8c4ead9c4e14c0", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/d54487cef393aa7088f46f7d0b8c4ead9c4e14c0", "committedDate": "2020-10-12T07:13:48Z", "message": "[FLINK-18999][table-common][table-planner-blink] Add isTemporary flag to table factory context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6656a1f1a4989f4e4840038be252bd11f6e1731f", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/6656a1f1a4989f4e4840038be252bd11f6e1731f", "committedDate": "2020-10-12T07:17:18Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d6ca96817da4640dee68e9c81b7e612e63dfcd9", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/8d6ca96817da4640dee68e9c81b7e612e63dfcd9", "committedDate": "2020-10-10T11:03:42Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}, "afterCommit": {"oid": "6656a1f1a4989f4e4840038be252bd11f6e1731f", "author": {"user": {"login": "lirui-apache", "name": "Rui Li"}}, "url": "https://github.com/apache/flink/commit/6656a1f1a4989f4e4840038be252bd11f6e1731f", "committedDate": "2020-10-12T07:17:18Z", "message": "[FLINK-18999][hive] Temporary generic table doesn't work with HiveCatalog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTcyMDg0", "url": "https://github.com/apache/flink/pull/13216#pullrequestreview-507972084", "createdAt": "2020-10-14T03:39:16Z", "commit": {"oid": "6656a1f1a4989f4e4840038be252bd11f6e1731f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4683, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}