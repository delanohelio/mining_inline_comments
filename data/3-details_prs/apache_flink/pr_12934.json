{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzMTI5ODU0", "number": 12934, "title": "[FLINK-18616][table sql/api]Add SHOW CURRENT DDLs", "bodyText": "What is the purpose of the change\nAdd show current ddls.\nBrief change log\n\nModify parser in flink and hive to parse SHOW CURRENT DDLs.\nAdd Operation of SHOW CURRENT DDLs and convert sqlNode to corresponding Operation.\nModify TableEnv to adapt to new Operation and return result according to input Operation type.\n\nVerifying this change\nThis change added tests and can be verified as follows:\n\nAdded test that parser can parse SHOW CURRENT DDLs with flink parser, hive parser and sql command parser.\nAdded test that SHOW CURRENT DDLs can return correct result with all kinds of TableEnvironment(TableEnvironmentImpl, StreamTableEnv and BatchTableEnv) and sql client.\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-07-20T07:01:45Z", "url": "https://github.com/apache/flink/pull/12934", "merged": true, "mergeCommit": {"oid": "ede4da5b364d657096f593e5c4e99393d5137dc1"}, "closed": true, "closedAt": "2020-07-24T06:13:56Z", "author": {"login": "fsk119"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc2sopogFqTQ1MTM0Nzc3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc390juAFqTQ1NDY1MzE5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzQ3Nzc1", "url": "https://github.com/apache/flink/pull/12934#pullrequestreview-451347775", "createdAt": "2020-07-20T07:11:25Z", "commit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzoxMToyNVrOGz8T1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzozNjozOVrOGz9ULw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExODY3OA==", "bodyText": "Leave one empty line above.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457118678", "createdAt": "2020-07-20T07:11:25Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/operations/ShowCurrentDatabaseOperation.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.table.operations;\n+\n+/**\n+ * Operation to describe SHOW CURRENT DATABASE operation.\n+ */\n+public class ShowCurrentDatabaseOperation implements ShowOperation{\n+\t@Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExODk1MA==", "bodyText": "Leave one empty line above.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457118950", "createdAt": "2020-07-20T07:11:52Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/operations/ShowCurrentCatalogOperation.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.table.operations;\n+\n+/**\n+ * Operation to describe a SHOW CURRENT CATALOG statement.\n+ */\n+public class ShowCurrentCatalogOperation implements ShowOperation{\n+\t@Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExOTY3OA==", "bodyText": "current catalog name?", "url": "https://github.com/apache/flink/pull/12934#discussion_r457119678", "createdAt": "2020-07-20T07:13:00Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java", "diffHunk": "@@ -1007,8 +1009,12 @@ private TableResult executeOperation(Operation operation) {\n \t\t\treturn TableResultImpl.TABLE_RESULT_OK;\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n+\t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n+\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzExOTg1MQ==", "bodyText": "current database name?", "url": "https://github.com/apache/flink/pull/12934#discussion_r457119851", "createdAt": "2020-07-20T07:13:14Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/api/internal/TableEnvironmentImpl.java", "diffHunk": "@@ -1007,8 +1009,12 @@ private TableResult executeOperation(Operation operation) {\n \t\t\treturn TableResultImpl.TABLE_RESULT_OK;\n \t\t} else if (operation instanceof ShowCatalogsOperation) {\n \t\t\treturn buildShowResult(\"catalog name\", listCatalogs());\n+\t\t} else if (operation instanceof ShowCurrentCatalogOperation){\n+\t\t\treturn buildShowResult(\"catalog name\", new String[]{catalogManager.getCurrentCatalog()});\n \t\t} else if (operation instanceof ShowDatabasesOperation) {\n \t\t\treturn buildShowResult(\"database name\", listDatabases());\n+\t\t} else if (operation instanceof ShowCurrentDatabaseOperation) {\n+\t\t\treturn buildShowResult(\"database name\", new String[]{catalogManager.getCurrentDatabase()});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMDU4OQ==", "bodyText": "Leave one empty line above.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457120589", "createdAt": "2020-07-20T07:14:18Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+* Show current database.\n+ */\n+public class SqlShowCurrentDatabase extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTMyMw==", "bodyText": "Two indents instead of one. Others should be the same.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121323", "createdAt": "2020-07-20T07:15:24Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentDatabase.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+* Show current database.\n+ */\n+public class SqlShowCurrentDatabase extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT DATABASE\", SqlKind.OTHER);\n+\n+\tpublic SqlShowCurrentDatabase(SqlParserPos pos) {\n+\t\tsuper(pos);\n+\t}\n+\n+\t@Override\n+\tpublic SqlOperator getOperator() {\n+\t\treturn OPERATOR;\n+\t}\n+\n+\t@Override\n+\tpublic List<SqlNode> getOperandList() {\n+\t\treturn Collections.EMPTY_LIST;\n+\t}\n+\n+\t@Override\n+\tpublic void unparse(\n+\t\tSqlWriter writer,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTU2Nw==", "bodyText": "Two indents instead of one.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121567", "createdAt": "2020-07-20T07:15:45Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+ * SHOW CURRENT CATALOG sql call.\n+ */\n+public class SqlShowCurrentCatalog extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);\n+\n+\tpublic SqlShowCurrentCatalog(SqlParserPos pos) {\n+\t\tsuper(pos);\n+\t}\n+\n+\t@Override\n+\tpublic SqlOperator getOperator() {\n+\t\treturn OPERATOR;\n+\t}\n+\n+\t@Override\n+\tpublic List<SqlNode> getOperandList() {\n+\t\treturn Collections.emptyList();\n+\t}\n+\n+\t@Override\n+\tpublic void unparse(\n+\t\tSqlWriter writer,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEyMTYxOQ==", "bodyText": "Leave one empty line above.", "url": "https://github.com/apache/flink/pull/12934#discussion_r457121619", "createdAt": "2020-07-20T07:15:51Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-parser/src/main/java/org/apache/flink/sql/parser/dql/SqlShowCurrentCatalog.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.sql.parser.dql;\n+\n+import org.apache.calcite.sql.SqlCall;\n+import org.apache.calcite.sql.SqlKind;\n+import org.apache.calcite.sql.SqlNode;\n+import org.apache.calcite.sql.SqlOperator;\n+import org.apache.calcite.sql.SqlSpecialOperator;\n+import org.apache.calcite.sql.SqlWriter;\n+import org.apache.calcite.sql.parser.SqlParserPos;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+/**\n+ * SHOW CURRENT CATALOG sql call.\n+ */\n+public class SqlShowCurrentCatalog extends SqlCall {\n+\tpublic static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator(\"SHOW CURRENT CATALOG\", SqlKind.OTHER);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzMzE2OA==", "bodyText": "getCurrentCatalog?", "url": "https://github.com/apache/flink/pull/12934#discussion_r457133168", "createdAt": "2020-07-20T07:33:35Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -309,13 +309,27 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzMzE5NA==", "bodyText": "getCurrentDatabase?", "url": "https://github.com/apache/flink/pull/12934#discussion_r457133194", "createdAt": "2020-07-20T07:33:37Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -309,13 +309,27 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listCatalogs()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentCatalog(String sessionId) throws SqlExecutionException {\n+\t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n+\t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n+\t\treturn context.wrapClassLoader(() -> tableEnv.getCurrentCatalog());\n+\t}\n+\n \t@Override\n \tpublic List<String> listDatabases(String sessionId) throws SqlExecutionException {\n \t\tfinal ExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tfinal TableEnvironment tableEnv = context.getTableEnvironment();\n \t\treturn context.wrapClassLoader(() -> Arrays.asList(tableEnv.listDatabases()));\n \t}\n \n+\t@Override\n+\tpublic String listCurrentDatabase(String sessionId) throws SqlExecutionException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzNDIwNA==", "bodyText": "What is the difference?", "url": "https://github.com/apache/flink/pull/12934#discussion_r457134204", "createdAt": "2020-07-20T07:35:12Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/sql/show.zh.md", "diffHunk": "@@ -274,4 +308,4 @@ SHOW VIEWS\n SHOW FUNCTIONS\n {% endhighlight %}\n \n-\u5c55\u793a\u6240\u6709\u7684 function\uff0c\u5305\u62ec\uff1a\u4e34\u65f6\u7cfb\u7edf function, \u7cfb\u7edf function, \u4e34\u65f6 catalog function\uff0c\u5f53\u524d catalog \u548c database \u4e2d\u7684 catalog function\u3002\n\\ No newline at end of file\n+\u5c55\u793a\u6240\u6709\u7684 function\uff0c\u5305\u62ec\uff1a\u4e34\u65f6\u7cfb\u7edf function, \u7cfb\u7edf function, \u4e34\u65f6 catalog function\uff0c\u5f53\u524d catalog \u548c database \u4e2d\u7684 catalog function\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzNDc0Mg==", "bodyText": "current database name", "url": "https://github.com/apache/flink/pull/12934#discussion_r457134742", "createdAt": "2020-07-20T07:36:01Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/sql/show.md", "diffHunk": "@@ -63,6 +73,14 @@ tEnv.executeSql(\"SHOW DATABASES\").print();\n // | default_database |\n // +------------------+\n \n+// show current database\n+tEnv.executeSql(\"SHOW CURRENT DATABASE\").print();\n+// +------------------+\n+// |    database name |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzNDgzMA==", "bodyText": "current catalog name", "url": "https://github.com/apache/flink/pull/12934#discussion_r457134830", "createdAt": "2020-07-20T07:36:10Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/sql/show.md", "diffHunk": "@@ -55,6 +57,14 @@ tEnv.executeSql(\"SHOW CATALOGS\").print();\n // | default_catalog |\n // +-----------------+\n \n+// show current catalog\n+tEnv.executeSql(\"SHOW CURRENT CATALOG\").print();\n+// +-----------------+\n+// |    catalog name |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzEzNTE1MQ==", "bodyText": "or show or or get", "url": "https://github.com/apache/flink/pull/12934#discussion_r457135151", "createdAt": "2020-07-20T07:36:39Z", "author": {"login": "JingsongLi"}, "path": "docs/dev/table/sql/show.md", "diffHunk": "@@ -25,12 +25,14 @@ under the License.\n * This will be replaced by the TOC\n {:toc}\n \n-SHOW statements are used to list all catalogs, or list all databases in the current catalog, or list all tables/views in the current catalog and the current database, or list all functions including temp system functions, system functions, temp catalog functions and catalog functions in the current catalog and the current database.\n+SHOW statements are used to list all catalogs, or list all databases in the current catalog, or list all tables/views in the current catalog and the current database, or list current catalog and database, or list all functions including temp system functions, system functions, temp catalog functions and catalog functions in the current catalog and the current database.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMzY5NTM1", "url": "https://github.com/apache/flink/pull/12934#pullrequestreview-451369535", "createdAt": "2020-07-20T07:46:40Z", "commit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzo0Njo0MVrOGz9uaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzo0NzowMlrOGz9vfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MTg2NA==", "bodyText": "we should not introduce new methods, instead, we can call executeSql directly", "url": "https://github.com/apache/flink/pull/12934#discussion_r457141864", "createdAt": "2020-07-20T07:46:41Z", "author": {"login": "godfreyhe"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java", "diffHunk": "@@ -79,13 +79,23 @@\n \t/**\n \t * Lists all registered catalogs.\n \t */\n-\tList<String> listCatalogs(String sessionid) throws SqlExecutionException;\n+\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n+\n+\t/**\n+\t * List current catalog.\n+\t */\n+\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE0MjE0MA==", "bodyText": "ditto", "url": "https://github.com/apache/flink/pull/12934#discussion_r457142140", "createdAt": "2020-07-20T07:47:02Z", "author": {"login": "godfreyhe"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/Executor.java", "diffHunk": "@@ -79,13 +79,23 @@\n \t/**\n \t * Lists all registered catalogs.\n \t */\n-\tList<String> listCatalogs(String sessionid) throws SqlExecutionException;\n+\tList<String> listCatalogs(String sessionId) throws SqlExecutionException;\n+\n+\t/**\n+\t * List current catalog.\n+\t */\n+\tString listCurrentCatalog(String sessionId) throws SqlExecutionException;\n \n \t/**\n \t * Lists all databases in the current catalog.\n \t */\n \tList<String> listDatabases(String sessionId) throws SqlExecutionException;\n \n+\t/**\n+\t * List current database.\n+\t */\n+\tString listCurrentDatabase(String sessionId) throws SqlExecutionException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "905fd299573bf766f2bec65ee6d710698063b6bb", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/905fd299573bf766f2bec65ee6d710698063b6bb", "committedDate": "2020-07-23T07:20:39Z", "message": "[FLINK-18616][table sql/api]Add SHOW CURRENT DDLs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6485e7990e33fdf45e8a18753cbca8749bba262", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/a6485e7990e33fdf45e8a18753cbca8749bba262", "committedDate": "2020-07-23T09:09:36Z", "message": "fix godfrey and Jinsong's comment:\n1. modify format problem(add blank line and space idents)\n2. replace showCurrentCatalog/Database in executor with executeSql"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/c3a5fb2c03a80e2d1a447a23923ce5c6c977c389", "committedDate": "2020-07-20T06:26:31Z", "message": "[FLINK-18616][table sql/api]Add SHOW CURRENT DDLs"}, "afterCommit": {"oid": "a6485e7990e33fdf45e8a18753cbca8749bba262", "author": {"user": {"login": "fsk119", "name": "Shengkai "}}, "url": "https://github.com/apache/flink/commit/a6485e7990e33fdf45e8a18753cbca8749bba262", "committedDate": "2020-07-23T09:09:36Z", "message": "fix godfrey and Jinsong's comment:\n1. modify format problem(add blank line and space idents)\n2. replace showCurrentCatalog/Database in executor with executeSql"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NjUzMTkw", "url": "https://github.com/apache/flink/pull/12934#pullrequestreview-454653190", "createdAt": "2020-07-24T06:13:32Z", "commit": {"oid": "a6485e7990e33fdf45e8a18753cbca8749bba262"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2904, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}