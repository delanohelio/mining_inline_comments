{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMDE3ODcx", "number": 11218, "title": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument", "bodyText": "What is the purpose of the change\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from the arguments of SingleInputGate#setInputChannel to cleanup the codes.\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the internal ResultPartitionID that the respective InputChannel maintains.\nBrief change log\n\n*Remove the argument of IntermediateResultPartitionID from SingleInputGate#setInputChannel \nAdjust the related unit tests\n\nVerifying this change\nThis change is a trivial rework / code cleanup without any test coverage.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-02-26T05:37:14Z", "url": "https://github.com/apache/flink/pull/11218", "merged": true, "mergeCommit": {"oid": "d4ca6ea2b0061c758f49c1edef562348eb96c9d0"}, "closed": true, "closedAt": "2020-03-02T03:51:41Z", "author": {"login": "zhijiangW"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIADFrgBqjMwNzIyMTAwMzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIxlg6AFqTM2NjQ3NjQwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb563801b8d0724c79847ed62c8a7add2043c48e", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/bb563801b8d0724c79847ed62c8a7add2043c48e", "committedDate": "2020-02-26T05:32:11Z", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains."}, "afterCommit": {"oid": "7b8f569390e60c187f3282763813b44a43ff9cc9", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/7b8f569390e60c187f3282763813b44a43ff9cc9", "committedDate": "2020-02-26T05:40:24Z", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7b8f569390e60c187f3282763813b44a43ff9cc9", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/7b8f569390e60c187f3282763813b44a43ff9cc9", "committedDate": "2020-02-26T05:40:24Z", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains."}, "afterCommit": {"oid": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "committedDate": "2020-02-27T04:20:15Z", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NjU0MzMx", "url": "https://github.com/apache/flink/pull/11218#pullrequestreview-365654331", "createdAt": "2020-02-27T12:51:43Z", "commit": {"oid": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMjo1MTo0NFrOFvRBsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMjo1MTo0NFrOFvRBsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEwNjM1Mw==", "bodyText": "\ud83d\udc4d for removing potential inconsistency and extra argument\nJust two minor issues here:\n\ncheckNotNull right before dereferencing doesn't make sense to me\nI think it's preferable to access InputChannel.partitionId through its getter", "url": "https://github.com/apache/flink/pull/11218#discussion_r385106353", "createdAt": "2020-02-27T12:51:44Z", "author": {"login": "rkhachatryan"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java", "diffHunk": "@@ -322,9 +322,10 @@ public void assignExclusiveSegments() throws IOException {\n \t\t}\n \t}\n \n-\tpublic void setInputChannel(IntermediateResultPartitionID partitionId, InputChannel inputChannel) {\n+\tpublic void setInputChannel(InputChannel inputChannel) {\n+\t\tIntermediateResultPartitionID partitionId = checkNotNull(inputChannel).partitionId.getPartitionId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efe373d488de41bf51ed2e9294d6e8c581dd1961", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/efe373d488de41bf51ed2e9294d6e8c581dd1961", "committedDate": "2020-02-27T15:12:29Z", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ece6d2f655ee073d66ade0f3681c0489ea8483c", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/0ece6d2f655ee073d66ade0f3681c0489ea8483c", "committedDate": "2020-02-27T15:13:03Z", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "committedDate": "2020-02-27T04:20:15Z", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel"}, "afterCommit": {"oid": "0ece6d2f655ee073d66ade0f3681c0489ea8483c", "author": {"user": {"login": "zhijiangW", "name": "zhijiang"}}, "url": "https://github.com/apache/flink/commit/0ece6d2f655ee073d66ade0f3681c0489ea8483c", "committedDate": "2020-02-27T15:13:03Z", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NDc2NDA5", "url": "https://github.com/apache/flink/pull/11218#pullrequestreview-366476409", "createdAt": "2020-02-28T15:23:48Z", "commit": {"oid": "0ece6d2f655ee073d66ade0f3681c0489ea8483c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3210, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}