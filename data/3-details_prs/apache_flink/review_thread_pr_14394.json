{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwNDU1NzE2", "number": 14394, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NTowN1rOFGBmig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0ODowMVrOFGBsUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYyMDI2OnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapKeyedStateBackendBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NTowN1rOIG1Yjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NTowN1rOIG1Yjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzNzAwNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tlogger.info(\"Finish to build heap keyed state-backend.\");\n          \n          \n            \n            \t\t\tlogger.info(\"Finished to build heap keyed state-backend.\");", "url": "https://github.com/apache/flink/pull/14394#discussion_r544037006", "createdAt": "2020-12-16T06:45:07Z", "author": {"login": "rmetzger"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapKeyedStateBackendBuilder.java", "diffHunk": "@@ -112,6 +112,7 @@ public HeapKeyedStateBackendBuilder(\n \t\t\tkeyContext);\n \t\ttry {\n \t\t\trestoreOperation.restore();\n+\t\t\tlogger.info(\"Finish to build heap keyed state-backend.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYyMDkxOnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NToxOVrOIG1Y7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NToxOVrOIG1Y7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzNzEwMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tLOG.info(\"Start to restore from state handle: {}.\", keyedStateHandle);\n          \n          \n            \n            \t\t\tLOG.info(\"Starting to restore from state handle: {}.\", keyedStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544037101", "createdAt": "2020-12-16T06:45:19Z", "author": {"login": "rmetzger"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapRestoreOperation.java", "diffHunk": "@@ -122,6 +126,7 @@ public Void restore() throws Exception {\n \t\t\t\tthrow unexpectedStateHandleException(KeyGroupsStateHandle.class, keyedStateHandle.getClass());\n \t\t\t}\n \n+\t\t\tLOG.info(\"Start to restore from state handle: {}.\", keyedStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYyMTc2OnYy", "diffSide": "RIGHT", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NTozNVrOIG1ZbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NTozNVrOIG1ZbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzNzIyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tLOG.info(\"Finish to restore from state handle: {}.\", keyedStateHandle);\n          \n          \n            \n            \t\t\t\tLOG.info(\"Finished restoring from state handle: {}.\", keyedStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544037229", "createdAt": "2020-12-16T06:45:35Z", "author": {"login": "rmetzger"}, "path": "flink-runtime/src/main/java/org/apache/flink/runtime/state/heap/HeapRestoreOperation.java", "diffHunk": "@@ -164,6 +169,7 @@ public Void restore() throws Exception {\n \t\t\t\t\tkvStatesById, restoredMetaInfos.size(),\n \t\t\t\t\tserializationProxy.getReadVersion(),\n \t\t\t\t\tserializationProxy.isUsingKeyGroupCompression());\n+\t\t\t\tLOG.info(\"Finish to restore from state handle: {}.\", keyedStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYyNzY4OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackendBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Njo0MFrOIG1dLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Njo0MFrOIG1dLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzODE4OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tlogger.warn(\"Failed to instance base path for RocksDB: \" + instanceBasePath, ex);\n          \n          \n            \n            \t\t\t\tlogger.warn(\"Failed to delete base path for RocksDB: \" + instanceBasePath, ex);\n          \n      \n    \n    \n  \n\nNot sure, maybe I don't understand what the code is doing here.", "url": "https://github.com/apache/flink/pull/14394#discussion_r544038188", "createdAt": "2020-12-16T06:46:40Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackendBuilder.java", "diffHunk": "@@ -317,21 +314,22 @@ private static void checkAndCreateDirectory(File directory) throws IOException {\n \t\t\ttry {\n \t\t\t\tFileUtils.deleteDirectory(instanceBasePath);\n \t\t\t} catch (Exception ex) {\n-\t\t\t\tLOG.warn(\"Failed to instance base path for RocksDB: \" + instanceBasePath, ex);\n+\t\t\t\tlogger.warn(\"Failed to instance base path for RocksDB: \" + instanceBasePath, ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYyOTQ4OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackendBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Njo1OFrOIG1eUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Njo1OFrOIG1eUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzODQ4MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tlogger.info(\"Finish to build RocksDB keyed state-backend at {}.\", instanceBasePath);\n          \n          \n            \n            \t\tlogger.info(\"Finished building RocksDB keyed state-backend at {}.\", instanceBasePath);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544038480", "createdAt": "2020-12-16T06:46:58Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackendBuilder.java", "diffHunk": "@@ -317,21 +314,22 @@ private static void checkAndCreateDirectory(File directory) throws IOException {\n \t\t\ttry {\n \t\t\t\tFileUtils.deleteDirectory(instanceBasePath);\n \t\t\t} catch (Exception ex) {\n-\t\t\t\tLOG.warn(\"Failed to instance base path for RocksDB: \" + instanceBasePath, ex);\n+\t\t\t\tlogger.warn(\"Failed to instance base path for RocksDB: \" + instanceBasePath, ex);\n \t\t\t}\n \t\t\t// Log and rethrow\n \t\t\tif (e instanceof BackendBuildingException) {\n \t\t\t\tthrow (BackendBuildingException) e;\n \t\t\t} else {\n \t\t\t\tString errMsg = \"Caught unexpected exception.\";\n-\t\t\t\tLOG.error(errMsg, e);\n+\t\t\t\tlogger.error(errMsg, e);\n \t\t\t\tthrow new BackendBuildingException(errMsg, e);\n \t\t\t}\n \t\t}\n \t\tInternalKeyContext<K> keyContext = new InternalKeyContextImpl<>(\n \t\t\tkeyGroupRange,\n \t\t\tnumberOfKeyGroups\n \t\t);\n+\t\tlogger.info(\"Finish to build RocksDB keyed state-backend at {}.\", instanceBasePath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYzMDE1OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBFullRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NzowOFrOIG1eyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NzowOFrOIG1eyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzODYwMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tlogger.info(\"Start to restore from state handle: {}.\", currentKeyGroupsStateHandle);\n          \n          \n            \n            \t\t\tlogger.info(\"Starting to restore from state handle: {}.\", currentKeyGroupsStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544038601", "createdAt": "2020-12-16T06:47:08Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBFullRestoreOperation.java", "diffHunk": "@@ -162,11 +162,13 @@ public RocksDBRestoreResult restore()\n \tprivate void restoreKeyGroupsInStateHandle()\n \t\tthrows IOException, StateMigrationException, RocksDBException {\n \t\ttry {\n+\t\t\tlogger.info(\"Start to restore from state handle: {}.\", currentKeyGroupsStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYzMTQxOnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBFullRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NzoxOVrOIG1fmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0NzoxOVrOIG1fmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzODgxMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tlogger.info(\"Finish to restore from state handle: {}.\", currentKeyGroupsStateHandle);\n          \n          \n            \n            \t\t\tlogger.info(\"Finished restoring from state handle: {}.\", currentKeyGroupsStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544038811", "createdAt": "2020-12-16T06:47:19Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBFullRestoreOperation.java", "diffHunk": "@@ -162,11 +162,13 @@ public RocksDBRestoreResult restore()\n \tprivate void restoreKeyGroupsInStateHandle()\n \t\tthrows IOException, StateMigrationException, RocksDBException {\n \t\ttry {\n+\t\t\tlogger.info(\"Start to restore from state handle: {}.\", currentKeyGroupsStateHandle);\n \t\t\tcurrentStateHandleInStream = currentKeyGroupsStateHandle.openInputStream();\n \t\t\tcancelStreamRegistry.registerCloseable(currentStateHandleInStream);\n \t\t\tcurrentStateHandleInView = new DataInputViewStreamWrapper(currentStateHandleInStream);\n \t\t\trestoreKVStateMetaData();\n \t\t\trestoreKVStateData();\n+\t\t\tlogger.info(\"Finish to restore from state handle: {}.\", currentKeyGroupsStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYzNDE1OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBIncrementalRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Nzo1MFrOIG1hDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0Nzo1MFrOIG1hDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzOTE4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tlogger.info(\"Start to restore from state handle: {} with rescaling.\", rawStateHandle);\n          \n          \n            \n            \t\t\tlogger.info(\"Starting to restore from state handle: {} with rescaling.\", rawStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544039182", "createdAt": "2020-12-16T06:47:50Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBIncrementalRestoreOperation.java", "diffHunk": "@@ -295,6 +294,7 @@ private void restoreWithRescaling(Collection<KeyedStateHandle> restoreStateHandl\n \t\t\t\tthrow unexpectedStateHandleException(IncrementalRemoteKeyedStateHandle.class, rawStateHandle.getClass());\n \t\t\t}\n \n+\t\t\tlogger.info(\"Start to restore from state handle: {} with rescaling.\", rawStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQxODYzNTA2OnYy", "diffSide": "RIGHT", "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBIncrementalRestoreOperation.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0ODowMVrOIG1hug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwNjo0ODowMVrOIG1hug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDAzOTM1NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tlogger.info(\"Finish to restore from state handle: {} with rescaling.\", rawStateHandle);\n          \n          \n            \n            \t\t\t\tlogger.info(\"Finished restoring from state handle: {} with rescaling.\", rawStateHandle);", "url": "https://github.com/apache/flink/pull/14394#discussion_r544039354", "createdAt": "2020-12-16T06:48:01Z", "author": {"login": "rmetzger"}, "path": "flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/restore/RocksDBIncrementalRestoreOperation.java", "diffHunk": "@@ -330,6 +330,7 @@ private void restoreWithRescaling(Collection<KeyedStateHandle> restoreStateHandl\n \t\t\t\t\t\t}\n \t\t\t\t\t} // releases native iterator resources\n \t\t\t\t}\n+\t\t\t\tlogger.info(\"Finish to restore from state handle: {} with rescaling.\", rawStateHandle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f0ec70e5ded62603dcde72a4eac42ea1116b02"}, "originalPosition": 69}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4634, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}