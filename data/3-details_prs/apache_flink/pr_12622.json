{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzNDMwNzU3", "number": 12622, "title": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file", "bodyText": "What is the purpose of the change\nflink-orc and flink-parquet provides a jar-with-dependencies.jar variant which ships binaries.\nHowever, these binaries are not documented in META-INF/NOTICE.\nThere are two similar files in that directory (NOTICE from force-shading and NOTICE.txt from Commons Lang).\nThere is a NOTICE file that looks valid, but it is in META-INF/services.\nThis has been introduced in FLINK-17460.\nAnd see FLINK-11026:\nInstead of defining separate shade-plugin execution with a custom artifactSuffix this PR adds a dedicated flink-sql-** module which only contains the packaging logic. This is a similar approach that we've already been using for flink-sql-connector-elasticsearch6 .\nThe main motivation for this is licensing; for accurate notice files it is necessary to be able to supply each artifact with distinct NOTICE files.\nThis cannot be done within a single module in a reasonable way. We would have to un-package each created jar, add the appropriate license files, and re-pack them again. We'd end up with tightly-coupled plugin definitions (since the names have to match!) and an overall more complicated (and slower!) build.\nBrief change log\n\nIntroduce flink-sql-orc to create orc bundled jar.\nIntroduce flink-sql-parquet to create parquet bundled jar.\nadd sqlJars profile to flink-formats to support skipping the creation of sql jars\n\nVerifying this change\n\nManually check NOTICE file.\nManually test bundled jar for sql filesystem connector.\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): no\nThe public API, i.e., is any changed class annotated with @Public(Evolving): no\nThe serializers: no\nThe runtime per-record code paths (performance sensitive): no\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: no\nThe S3 file system connector: no\n\nDocumentation\n\nDoes this pull request introduce a new feature? no", "createdAt": "2020-06-12T02:37:18Z", "url": "https://github.com/apache/flink/pull/12622", "merged": true, "mergeCommit": {"oid": "6388336b0c56589c3a77e38f8fd16f582e2d947c"}, "closed": true, "closedAt": "2020-06-16T02:09:24Z", "author": {"login": "JingsongLi"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqhgj4AFqTQyOTY3Nzc2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcre_BigFqTQzMDU1NjIwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5Njc3NzYy", "url": "https://github.com/apache/flink/pull/12622#pullrequestreview-429677762", "createdAt": "2020-06-12T11:49:03Z", "commit": {"oid": "affedb647e7fc0b175f155b202dcc48a9775174a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMTo0OTowM1rOGjBJmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMTo1MjoxNVrOGjBOqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MjE4Nw==", "bodyText": "The location of this file is wrong. It needs to be in the META-INF folder, not the services folder.", "url": "https://github.com/apache/flink/pull/12622#discussion_r439372187", "createdAt": "2020-06-12T11:49:03Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-orc/src/main/resources/META-INF/services/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-orc", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "affedb647e7fc0b175f155b202dcc48a9775174a"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MjI3NQ==", "bodyText": "same issue", "url": "https://github.com/apache/flink/pull/12622#discussion_r439372275", "createdAt": "2020-06-12T11:49:18Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-parquet/src/main/resources/META-INF/services/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-parquet", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "affedb647e7fc0b175f155b202dcc48a9775174a"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg==", "bodyText": "I'm not sure if it is necessary to create new modules just to create the fat jar.\nAfaik, you can use the maven shade plugin to create a new jar. I guess the <finalName> or <outputFile> parameter will be of help for this.", "url": "https://github.com/apache/flink/pull/12622#discussion_r439373482", "createdAt": "2020-06-12T11:52:15Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-orc/pom.xml", "diffHunk": "@@ -0,0 +1,92 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "affedb647e7fc0b175f155b202dcc48a9775174a"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "affedb647e7fc0b175f155b202dcc48a9775174a", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/affedb647e7fc0b175f155b202dcc48a9775174a", "committedDate": "2020-06-12T06:53:27Z", "message": "Fix maven-enforcer-plugin"}, "afterCommit": {"oid": "409adc2e3f4e30a3070213da099d3649eb38659e", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/409adc2e3f4e30a3070213da099d3649eb38659e", "committedDate": "2020-06-12T12:24:10Z", "message": "Modify md"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28d56864a3f9940a351d4533296cdb9497493bab", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/28d56864a3f9940a351d4533296cdb9497493bab", "committedDate": "2020-06-13T08:21:40Z", "message": "add sqlJars profile to flink-formats to support skipping the creation of sql jars"}, "afterCommit": {"oid": "50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "committedDate": "2020-06-15T02:38:35Z", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "committedDate": "2020-06-15T03:18:56Z", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "committedDate": "2020-06-15T02:38:35Z", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file"}, "afterCommit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "committedDate": "2020-06-15T03:18:56Z", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ3MTkx", "url": "https://github.com/apache/flink/pull/12622#pullrequestreview-430447191", "createdAt": "2020-06-15T08:55:30Z", "commit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NTozMVrOGjpIYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NTozMVrOGjpIYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNzIzNA==", "bodyText": "\u2705  File looks good", "url": "https://github.com/apache/flink/pull/12622#discussion_r440027234", "createdAt": "2020-06-15T08:55:31Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-orc/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-orc", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ4NzY4", "url": "https://github.com/apache/flink/pull/12622#pullrequestreview-430448768", "createdAt": "2020-06-15T08:57:26Z", "commit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NzoyNlrOGjpNIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NzoyNlrOGjpNIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyODQ0OQ==", "bodyText": "\u2705  file looks good", "url": "https://github.com/apache/flink/pull/12622#discussion_r440028449", "createdAt": "2020-06-15T08:57:26Z", "author": {"login": "rmetzger"}, "path": "flink-formats/flink-sql-parquet/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-parquet\n+flink-sql-parquet", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDk3Mjg1", "url": "https://github.com/apache/flink/pull/12622#pullrequestreview-430497285", "createdAt": "2020-06-15T10:01:26Z", "commit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMDowMToyNlrOGjrfqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMDowMToyNlrOGjrfqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA2NTk2Mw==", "bodyText": "I'd prefer this to be defined in flink-formats; to keep things as localized as possible.", "url": "https://github.com/apache/flink/pull/12622#discussion_r440065963", "createdAt": "2020-06-15T10:01:26Z", "author": {"login": "zentol"}, "path": "pom.xml", "diffHunk": "@@ -156,6 +156,7 @@ under the License.\n \t\t<hivemetastore.hadoop.version>2.7.5</hivemetastore.hadoop.version>\n \t\t<japicmp.referenceVersion>1.10.0</japicmp.referenceVersion>\n \t\t<japicmp.outputDir>tools/japicmp-output</japicmp.outputDir>\n+\t\t<flink.format.parquet.version>1.10.0</flink.format.parquet.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d78d9ec514a23300e40aab4ca88ebad35ea86453", "author": {"user": {"login": "JingsongLi", "name": "Jingsong Lee"}}, "url": "https://github.com/apache/flink/commit/d78d9ec514a23300e40aab4ca88ebad35ea86453", "committedDate": "2020-06-15T10:18:18Z", "message": "Fix comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNTU2MjAz", "url": "https://github.com/apache/flink/pull/12622#pullrequestreview-430556203", "createdAt": "2020-06-15T11:30:49Z", "commit": {"oid": "d78d9ec514a23300e40aab4ca88ebad35ea86453"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3401, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}