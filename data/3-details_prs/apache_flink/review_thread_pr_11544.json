{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NTYzMzEz", "number": 11544, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwOTo1NzowN1rODr_u_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxNjozMFrODx_EjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NDU5NTgyOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwOTo1NzowN1rOF8qPnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQwMzoxODozMVrOF9OGOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTE1MTAwNw==", "bodyText": "Will this influence the RESET command which should clear all session properties?", "url": "https://github.com/apache/flink/pull/11544#discussion_r399151007", "createdAt": "2020-03-27T09:57:07Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -281,13 +283,18 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\tExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tEnvironment env = context.getEnvironment();\n \t\tEnvironment newEnv = Environment.enrich(env, ImmutableMap.of(key, value), ImmutableMap.of());\n+\t\tExecutionContext.SessionState sessionState = context.getSessionState();\n+\t\t// update table config\n+\t\tnewEnv.getConfiguration().asMap().forEach((k, v) ->\n+\t\t\t\tsessionState.config.getConfiguration().setString(k, v));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "961e5d7c690f82967b92b01df5eee5fa75292c77"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTczODQyNg==", "bodyText": "good catch, we should store the original SessionState for resetting all properties to initial state.", "url": "https://github.com/apache/flink/pull/11544#discussion_r399738426", "createdAt": "2020-03-29T03:18:31Z", "author": {"login": "godfreyhe"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -281,13 +283,18 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\tExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tEnvironment env = context.getEnvironment();\n \t\tEnvironment newEnv = Environment.enrich(env, ImmutableMap.of(key, value), ImmutableMap.of());\n+\t\tExecutionContext.SessionState sessionState = context.getSessionState();\n+\t\t// update table config\n+\t\tnewEnv.getConfiguration().asMap().forEach((k, v) ->\n+\t\t\t\tsessionState.config.getConfiguration().setString(k, v));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTE1MTAwNw=="}, "originalCommit": {"oid": "961e5d7c690f82967b92b01df5eee5fa75292c77"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzM4ODEzOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxMjo0OFrOGFw2Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxMjo0OFrOGFw2Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5NjMyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\treturn new SessionState( catalogManager, moduleManager, functionCatalog);\n          \n          \n            \n            \t\t\treturn new SessionState(catalogManager, moduleManager, functionCatalog);\n          \n      \n    \n    \n  \n\nremove space.", "url": "https://github.com/apache/flink/pull/11544#discussion_r408696322", "createdAt": "2020-04-15T09:12:48Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java", "diffHunk": "@@ -771,28 +772,24 @@ public Builder sessionState(SessionState sessionState) {\n \n \t/** Represents the state that should be reused in one session. **/\n \tpublic static class SessionState {\n-\t\tpublic final TableConfig config;\n \t\tpublic final CatalogManager catalogManager;\n \t\tpublic final ModuleManager moduleManager;\n \t\tpublic final FunctionCatalog functionCatalog;\n \n \t\tprivate SessionState(\n-\t\t\t\tTableConfig config,\n \t\t\t\tCatalogManager catalogManager,\n \t\t\t\tModuleManager moduleManager,\n \t\t\t\tFunctionCatalog functionCatalog) {\n-\t\t\tthis.config = config;\n \t\t\tthis.catalogManager = catalogManager;\n \t\t\tthis.moduleManager = moduleManager;\n \t\t\tthis.functionCatalog = functionCatalog;\n \t\t}\n \n \t\tpublic static SessionState of(\n-\t\t\t\tTableConfig config,\n \t\t\t\tCatalogManager catalogManager,\n \t\t\t\tModuleManager moduleManager,\n \t\t\t\tFunctionCatalog functionCatalog) {\n-\t\t\treturn new SessionState(config, catalogManager, moduleManager, functionCatalog);\n+\t\t\treturn new SessionState( catalogManager, moduleManager, functionCatalog);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87b3f8b93da1e5791502bdb0ebd02bb8fba49753"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzQwMTczOnYy", "diffSide": "RIGHT", "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToxNjozMFrOGFw-dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOTo1NzoyMVrOGFye1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5ODQ4NA==", "bodyText": "Do we need this change? It seems they are equivalent.", "url": "https://github.com/apache/flink/pull/11544#discussion_r408698484", "createdAt": "2020-04-15T09:16:30Z", "author": {"login": "wuchong"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -281,13 +283,15 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\tExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tEnvironment env = context.getEnvironment();\n \t\tEnvironment newEnv = Environment.enrich(env, ImmutableMap.of(key, value), ImmutableMap.of());\n+\t\tExecutionContext.SessionState sessionState = context.getSessionState();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87b3f8b93da1e5791502bdb0ebd02bb8fba49753"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODcyMzE1Nw==", "bodyText": "I revert this", "url": "https://github.com/apache/flink/pull/11544#discussion_r408723157", "createdAt": "2020-04-15T09:57:21Z", "author": {"login": "godfreyhe"}, "path": "flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/LocalExecutor.java", "diffHunk": "@@ -281,13 +283,15 @@ public void setSessionProperty(String sessionId, String key, String value) throw\n \t\tExecutionContext<?> context = getExecutionContext(sessionId);\n \t\tEnvironment env = context.getEnvironment();\n \t\tEnvironment newEnv = Environment.enrich(env, ImmutableMap.of(key, value), ImmutableMap.of());\n+\t\tExecutionContext.SessionState sessionState = context.getSessionState();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5ODQ4NA=="}, "originalCommit": {"oid": "87b3f8b93da1e5791502bdb0ebd02bb8fba49753"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 746, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}