{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3ODIwMDM3", "number": 12485, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwMzo0MjowMlrOEDSrQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwMzo0MjowMlrOEDSrQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODg3MTY4OnYy", "diffSide": "RIGHT", "path": "flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/filesystem/PartitionLoader.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwMzo0MjowMlrOGgOZQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwMzo1MjoxMFrOGgOf5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ0MzQ1Nw==", "bodyText": "Here seems inconsistent with this method's comment: rename does not delete the dest path if it exists on HDFS. Instead, it will keep the srcPath and dest Path unchanged.", "url": "https://github.com/apache/flink/pull/12485#discussion_r436443457", "createdAt": "2020-06-08T03:42:02Z", "author": {"login": "gaoyunhaii"}, "path": "flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/filesystem/PartitionLoader.java", "diffHunk": "@@ -113,12 +113,7 @@ private void renameFiles(List<Path> srcDirs, Path destDir) throws Exception {\n \t\t\t\t\tfor (FileStatus srcFile : srcFiles) {\n \t\t\t\t\t\tPath srcPath = srcFile.getPath();\n \t\t\t\t\t\tPath destPath = new Path(destDir, srcPath.getName());\n-\t\t\t\t\t\tint count = 1;\n-\t\t\t\t\t\twhile (!fs.rename(srcPath, destPath)) {\n-\t\t\t\t\t\t\tString name = srcPath.getName() + \"_copy_\" + count;\n-\t\t\t\t\t\t\tdestPath = new Path(destDir, name);\n-\t\t\t\t\t\t\tcount++;\n-\t\t\t\t\t\t}\n+\t\t\t\t\t\tfs.rename(srcPath, destPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "765ffd5d614376c2fde93440c9c904a80e1eab94"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ0NTE1Nw==", "bodyText": "The comment is out of date, the overwrite is occurred in overwrite(Path) method instead of here.\nNow it is consistent with HadoopRecoverableFsDataOutputStream.commit.\nI will update comments.", "url": "https://github.com/apache/flink/pull/12485#discussion_r436445157", "createdAt": "2020-06-08T03:52:10Z", "author": {"login": "JingsongLi"}, "path": "flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/filesystem/PartitionLoader.java", "diffHunk": "@@ -113,12 +113,7 @@ private void renameFiles(List<Path> srcDirs, Path destDir) throws Exception {\n \t\t\t\t\tfor (FileStatus srcFile : srcFiles) {\n \t\t\t\t\t\tPath srcPath = srcFile.getPath();\n \t\t\t\t\t\tPath destPath = new Path(destDir, srcPath.getName());\n-\t\t\t\t\t\tint count = 1;\n-\t\t\t\t\t\twhile (!fs.rename(srcPath, destPath)) {\n-\t\t\t\t\t\t\tString name = srcPath.getName() + \"_copy_\" + count;\n-\t\t\t\t\t\t\tdestPath = new Path(destDir, name);\n-\t\t\t\t\t\t\tcount++;\n-\t\t\t\t\t\t}\n+\t\t\t\t\t\tfs.rename(srcPath, destPath);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ0MzQ1Nw=="}, "originalCommit": {"oid": "765ffd5d614376c2fde93440c9c904a80e1eab94"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4430, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}