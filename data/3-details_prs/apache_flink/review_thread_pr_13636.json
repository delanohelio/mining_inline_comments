{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzMzMyODkx", "number": 13636, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjoyNDozNlrOExAkKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjoyNzoyNFrOExAl9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODI0OTM5OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/util/HiveStatsUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjoyNDozNlrOHm6B0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjoyNDozNlrOHm6B0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU1ODY3NA==", "bodyText": "Revert", "url": "https://github.com/apache/flink/pull/13636#discussion_r510558674", "createdAt": "2020-10-23T02:24:36Z", "author": {"login": "JingsongLi"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/util/HiveStatsUtil.java", "diffHunk": "@@ -69,7 +69,7 @@\n public class HiveStatsUtil {\n \tprivate static final Logger LOG = LoggerFactory.getLogger(HiveStatsUtil.class);\n \n-\tprivate static final int DEFAULT_UNKNOWN_STATS_VALUE = -1;\n+\tpublic static final int DEFAULT_UNKNOWN_STATS_VALUE = -1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccf58fbc6e8b269f07cc0ba4ad332ca06631b493"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5ODI1Mzk4OnYy", "diffSide": "RIGHT", "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjoyNzoyNFrOHm6Eeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNDozODo0N1rOHnQuGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU1OTM1NA==", "bodyText": "Can you extract these parallelism inference logic to a dedicated class like HiveParallelismInference (Including limit logic)?", "url": "https://github.com/apache/flink/pull/13636#discussion_r510559354", "createdAt": "2020-10-23T02:27:24Z", "author": {"login": "JingsongLi"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "diffHunk": "@@ -210,19 +212,35 @@ private boolean isStreamingSource() {\n \t\t\t\t\t\t\t\t\" cannot be less than 1\");\n \t\t\t}\n \n-\t\t\tint splitNum;\n \t\t\ttry {\n-\t\t\t\tlong nano1 = System.nanoTime();\n-\t\t\t\tsplitNum = inputFormat.createInputSplits(0).length;\n-\t\t\t\tlong nano2 = System.nanoTime();\n+\t\t\t\t// `createInputSplits` is costly,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccf58fbc6e8b269f07cc0ba4ad332ca06631b493"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg2MDY2OA==", "bodyText": "I don't think this is needed, at least in this PR. This PR is only an optimization and code cleanups should be done in separate PRs.", "url": "https://github.com/apache/flink/pull/13636#discussion_r510860668", "createdAt": "2020-10-23T12:50:08Z", "author": {"login": "tsreaper"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "diffHunk": "@@ -210,19 +212,35 @@ private boolean isStreamingSource() {\n \t\t\t\t\t\t\t\t\" cannot be less than 1\");\n \t\t\t}\n \n-\t\t\tint splitNum;\n \t\t\ttry {\n-\t\t\t\tlong nano1 = System.nanoTime();\n-\t\t\t\tsplitNum = inputFormat.createInputSplits(0).length;\n-\t\t\t\tlong nano2 = System.nanoTime();\n+\t\t\t\t// `createInputSplits` is costly,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU1OTM1NA=="}, "originalCommit": {"oid": "ccf58fbc6e8b269f07cc0ba4ad332ca06631b493"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDkzMDQ1Ng==", "bodyText": "Yes, it can be a separate PR.\nYou are making the logic more complex, so I think you should cleanup code first.", "url": "https://github.com/apache/flink/pull/13636#discussion_r510930456", "createdAt": "2020-10-23T14:38:47Z", "author": {"login": "JingsongLi"}, "path": "flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveTableSource.java", "diffHunk": "@@ -210,19 +212,35 @@ private boolean isStreamingSource() {\n \t\t\t\t\t\t\t\t\" cannot be less than 1\");\n \t\t\t}\n \n-\t\t\tint splitNum;\n \t\t\ttry {\n-\t\t\t\tlong nano1 = System.nanoTime();\n-\t\t\t\tsplitNum = inputFormat.createInputSplits(0).length;\n-\t\t\t\tlong nano2 = System.nanoTime();\n+\t\t\t\t// `createInputSplits` is costly,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU1OTM1NA=="}, "originalCommit": {"oid": "ccf58fbc6e8b269f07cc0ba4ad332ca06631b493"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 145, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}