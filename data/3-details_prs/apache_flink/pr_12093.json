{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NTM1MzMx", "number": 12093, "title": " [FLINK-17307] Add collector to deserialize method of DeserializationSchema", "bodyText": "What is the purpose of the change\nThis PR adds collector to DeserializationSchema#deserializer. It also implements support for this method in PubSub, Kinesis, Kafka (in #12018). Kinesis consumer because of complex threading model does not support it for now. There I check if the used schema implements the deserialize with a collector and eagerly throw an exception if that's the case\nVerifying this change\nAdded tests in corresponding modules.\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-05-12T07:18:52Z", "url": "https://github.com/apache/flink/pull/12093", "merged": true, "mergeCommit": {"oid": "6119c31a8a07b934aee5c3ca44e7995889d37eb1"}, "closed": true, "closedAt": "2020-05-12T20:16:07Z", "author": {"login": "dawidwys"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgjJ8kAFqTQwOTk3NDE0NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgnzGJABqjMzMjg1NzcwNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTc0MTQ0", "url": "https://github.com/apache/flink/pull/12093#pullrequestreview-409974144", "createdAt": "2020-05-12T12:08:21Z", "commit": {"oid": "d5c512da6104551adc64ef96643aaa185910c83e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowODoyMlrOGUDcwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjowODoyMlrOGUDcwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY4MTIxNg==", "bodyText": "Is it ok that we now only \"break\" out of the loop after the autoAck handling?", "url": "https://github.com/apache/flink/pull/12093#discussion_r423681216", "createdAt": "2020-05-12T12:08:22Z", "author": {"login": "aljoscha"}, "path": "flink-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSource.java", "diffHunk": "@@ -235,11 +230,44 @@ public void run(SourceContext<OUT> ctx) throws Exception {\n \t\t\t\t\tsessionIds.add(deliveryTag);\n \t\t\t\t}\n \n-\t\t\t\tctx.collect(result);\n+\t\t\t\tschema.deserialize(delivery.getBody(), collector);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c512da6104551adc64ef96643aaa185910c83e"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94b01f86573300d55eb6e18eaa0e02b0d0f1efe0", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/94b01f86573300d55eb6e18eaa0e02b0d0f1efe0", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Add collector to deserialize method of DeserializationSchema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "259815f9f25947bc3a0426f988c4a81af8a126a8", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/259815f9f25947bc3a0426f988c4a81af8a126a8", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Forward call to DeserializationSchema#collect with a\ncollector in KafkaDeserializationSchemaWrapper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1159ea0a3f7dea7a887386224db7f37106090f82", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/1159ea0a3f7dea7a887386224db7f37106090f82", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Add collector to deserialize in RMQ"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "424fa6e7b916070d02452305766fd583a2055aea", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/424fa6e7b916070d02452305766fd583a2055aea", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Check for deserialize method with a Collector in Kinesis consumer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "582250d9ebdaeea76e975e3d54d26b4669fbc968", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/582250d9ebdaeea76e975e3d54d26b4669fbc968", "committedDate": "2020-05-12T07:12:37Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}, "afterCommit": {"oid": "7fdbba2ed092a419bb6176ff5be5e91530ed0403", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/7fdbba2ed092a419bb6176ff5be5e91530ed0403", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fdbba2ed092a419bb6176ff5be5e91530ed0403", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/7fdbba2ed092a419bb6176ff5be5e91530ed0403", "committedDate": "2020-05-12T12:43:49Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}, "afterCommit": {"oid": "7abf95e77ea4b57fef1683a70662d2c12e363426", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/7abf95e77ea4b57fef1683a70662d2c12e363426", "committedDate": "2020-05-12T12:52:46Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7abf95e77ea4b57fef1683a70662d2c12e363426", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/7abf95e77ea4b57fef1683a70662d2c12e363426", "committedDate": "2020-05-12T12:52:46Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}, "afterCommit": {"oid": "a164f63155ff1186da725900305572d73e8be05e", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/a164f63155ff1186da725900305572d73e8be05e", "committedDate": "2020-05-12T15:20:53Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a164f63155ff1186da725900305572d73e8be05e", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/a164f63155ff1186da725900305572d73e8be05e", "committedDate": "2020-05-12T15:20:53Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}, "afterCommit": {"oid": "047de7eb9bc15c15a4a0491686a87ee235867fde", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/047de7eb9bc15c15a4a0491686a87ee235867fde", "committedDate": "2020-05-12T16:38:32Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2634d7b5d540e9615d149052d71f16d24fbd57e", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/f2634d7b5d540e9615d149052d71f16d24fbd57e", "committedDate": "2020-05-12T17:33:31Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "047de7eb9bc15c15a4a0491686a87ee235867fde", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/047de7eb9bc15c15a4a0491686a87ee235867fde", "committedDate": "2020-05-12T16:38:32Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}, "afterCommit": {"oid": "f2634d7b5d540e9615d149052d71f16d24fbd57e", "author": {"user": {"login": "dawidwys", "name": "Dawid Wysakowicz"}}, "url": "https://github.com/apache/flink/commit/f2634d7b5d540e9615d149052d71f16d24fbd57e", "committedDate": "2020-05-12T17:33:31Z", "message": "[FLINK-17307] Add collector to deserialize in PubSub"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4307, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}