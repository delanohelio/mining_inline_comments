{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyNTA2MDMy", "number": 14103, "title": "[FLINK-18545] Introduce `pipeline.name` to allow users to specify job name by configuration", "bodyText": "What is the purpose of the change\nUsers can't specify job name for sql job when using new apis introduced in FLIP-84. As discussion in FLINK-18545, we should introduce pipeline.name in  PipelineOptions to support it, which could work for both DataStream jobs and SQL jobs.\nBrief change log\n\nIntroduce pipeline.name to allow users to specify job name by configuration\nSpecify job name by pipeline.name for flink-python\nSpecify job name by pipeline.name for sql job\n\nVerifying this change\nThis change added tests and can be verified as follows:\n\nExtended StreamExecutionEnvironmentTest & PythonConfigUtilTest to verify the job name specified by pipeline.name\n\nDoes this pull request potentially affect one of the following parts:\n\nDependencies (does it add or upgrade a dependency): (yes / no)\nThe public API, i.e., is any changed class annotated with @Public(Evolving): (yes / no)\nThe serializers: (yes / no / don't know)\nThe runtime per-record code paths (performance sensitive): (yes / no / don't know)\nAnything that affects deployment or recovery: JobManager (and its components), Checkpointing, Kubernetes/Yarn/Mesos, ZooKeeper: (yes / no / don't know)\nThe S3 file system connector: (yes / no / don't know)\n\nDocumentation\n\nDoes this pull request introduce a new feature? (yes / no)\nIf yes, how is the feature documented? (not applicable / docs / JavaDocs / not documented)", "createdAt": "2020-11-17T15:40:33Z", "url": "https://github.com/apache/flink/pull/14103", "merged": true, "mergeCommit": {"oid": "88d0ee002c38f8a17895d4485703787a04f67c50"}, "closed": true, "closedAt": "2020-11-27T01:52:58Z", "author": {"login": "godfreyhe"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddbe5_ABqjQwMDYxMzc1OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgRZ-PABqjQwNDIxMzg0MTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6cdf328a97a33c80d0b2275468b907e619fa63b8", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/6cdf328a97a33c80d0b2275468b907e619fa63b8", "committedDate": "2020-11-17T15:32:07Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}, "afterCommit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "committedDate": "2020-11-17T15:41:55Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0Nzk1Njc0", "url": "https://github.com/apache/flink/pull/14103#pullrequestreview-534795674", "createdAt": "2020-11-19T19:50:08Z", "commit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MzM1OTYz", "url": "https://github.com/apache/flink/pull/14103#pullrequestreview-538335963", "createdAt": "2020-11-25T10:05:38Z", "commit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMDowNTozOFrOH5r72A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMDoyODo0OFrOH5s3aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI1MDcxMg==", "bodyText": "nit: change this to The job name used for printing and logging.", "url": "https://github.com/apache/flink/pull/14103#discussion_r530250712", "createdAt": "2020-11-25T10:05:38Z", "author": {"login": "twalthr"}, "path": "docs/_includes/generated/pipeline_configuration.html", "diffHunk": "@@ -86,6 +86,12 @@\n             <td>Integer</td>\n             <td>The program-wide maximum parallelism used for operators which haven't specified a maximum parallelism. The maximum parallelism specifies the upper limit for dynamic scaling and the number of key groups used for partitioned state.</td>\n         </tr>\n+        <tr>\n+            <td><h5>pipeline.name</h5></td>\n+            <td style=\"word-wrap: break-word;\">(none)</td>\n+            <td>String</td>\n+            <td>The name to display for the job.</td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI2MDgwNA==", "bodyText": "Update StreamExecutionEnvironment#configure as well.", "url": "https://github.com/apache/flink/pull/14103#discussion_r530260804", "createdAt": "2020-11-25T10:20:50Z", "author": {"login": "twalthr"}, "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/StreamExecutionEnvironment.java", "diffHunk": "@@ -1778,7 +1778,7 @@ private StateBackend loadStateBackend(ReadableConfig configuration, ClassLoader\n \t * @throws Exception which occurs during job execution.\n \t */\n \tpublic JobExecutionResult execute() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI2NTk2Mw==", "bodyText": "nit: simplify the test here and below to just use env.fromElements(1, 2, 3).print()", "url": "https://github.com/apache/flink/pull/14103#discussion_r530265963", "createdAt": "2020-11-25T10:28:48Z", "author": {"login": "twalthr"}, "path": "flink-streaming-java/src/test/java/org/apache/flink/streaming/api/StreamExecutionEnvironmentTest.java", "diffHunk": "@@ -269,6 +271,27 @@ public void testGetStreamGraph() {\n \t\t}\n \t}\n \n+\t@Test\n+\tpublic void testDefaultJobName() {\n+\t\tStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n+\n+\t\tenv.fromCollection(new DummySplittableIterator<>(), BasicTypeInfo.INT_TYPE_INFO).addSink(new DiscardingSink<>());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NDU2OTY5", "url": "https://github.com/apache/flink/pull/14103#pullrequestreview-538456969", "createdAt": "2020-11-25T12:44:03Z", "commit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMjo0NDowM1rOH5xwmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMjo0NDowM1rOH5xwmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM0NjEzNg==", "bodyText": "Can't we just put the default name in the pipeline option? That way, it will also be rendered in the documentation.", "url": "https://github.com/apache/flink/pull/14103#discussion_r530346136", "createdAt": "2020-11-25T12:44:03Z", "author": {"login": "aljoscha"}, "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/StreamExecutionEnvironment.java", "diffHunk": "@@ -2330,4 +2330,8 @@ public void registerCachedFile(String filePath, String name, boolean executable)\n \t\t}\n \t\treturn (T) resolvedTypeInfo;\n \t}\n+\n+\tprivate String getJobName() {\n+\t\treturn configuration.getString(PipelineOptions.NAME, DEFAULT_JOB_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MDgzMTQ2", "url": "https://github.com/apache/flink/pull/14103#pullrequestreview-539083146", "createdAt": "2020-11-26T08:23:38Z", "commit": {"oid": "cda47b16b8fa216fefb5399249026c2a54e907ed"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODoyMzozOFrOH6QS7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwODoyMzozOFrOH6QS7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg0NjQ0Ng==", "bodyText": "This method must not be public and thus part of the API. You can call createProgramPlan().getJobName for testing.", "url": "https://github.com/apache/flink/pull/14103#discussion_r530846446", "createdAt": "2020-11-26T08:23:38Z", "author": {"login": "twalthr"}, "path": "flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java", "diffHunk": "@@ -1122,12 +1125,14 @@ void registerDataSink(DataSink<?> sink) {\n \t}\n \n \t/**\n-\t * Gets a default job name, based on the timestamp when this method is invoked.\n+\t * Gets the job name. If user defined job name is not found in the configuration,\n+\t * the default name based on the timestamp when this method is invoked will return.\n \t *\n-\t * @return A default job name.\n+\t * @return A job name.\n \t */\n-\tprivate static String getDefaultName() {\n-\t\treturn \"Flink Java Job at \" + Calendar.getInstance().getTime();\n+\t@VisibleForTesting", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cda47b16b8fa216fefb5399249026c2a54e907ed"}, "originalPosition": 66}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5d5336c50afe2aeab2acec4e6ae81be59f5f024", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/b5d5336c50afe2aeab2acec4e6ae81be59f5f024", "committedDate": "2020-11-26T09:30:25Z", "message": "[FLINK-18545][configuration] Introduce `pipeline.name` to allow users to specify job name by configuration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "96911576999869f37acb8133be917c91745e90a4", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/96911576999869f37acb8133be917c91745e90a4", "committedDate": "2020-11-26T09:15:29Z", "message": "address Timo's comments"}, "afterCommit": {"oid": "84daf24842f84ae2b07fa9fccef5a328bffc6029", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/84daf24842f84ae2b07fa9fccef5a328bffc6029", "committedDate": "2020-11-26T09:30:26Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f8a0d979eaece7ead8530a9a02875443343373", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/d4f8a0d979eaece7ead8530a9a02875443343373", "committedDate": "2020-11-26T11:38:56Z", "message": "[FLINK-18545][configuration] Allow users to specify job name by configuration in ExecutionEnvironment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0d0bd3c338dbd6afc109724730f021647582eac", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/b0d0bd3c338dbd6afc109724730f021647582eac", "committedDate": "2020-11-26T11:39:04Z", "message": "[FLINK-18545][python] Specify job name by `pipeline.name` for flink-python"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1858bb1abcedf787cb83f77443298baf3afe63e0", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/1858bb1abcedf787cb83f77443298baf3afe63e0", "committedDate": "2020-11-26T11:39:04Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "84daf24842f84ae2b07fa9fccef5a328bffc6029", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/84daf24842f84ae2b07fa9fccef5a328bffc6029", "committedDate": "2020-11-26T09:30:26Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}, "afterCommit": {"oid": "1858bb1abcedf787cb83f77443298baf3afe63e0", "author": {"user": {"login": "godfreyhe", "name": "godfrey he"}}, "url": "https://github.com/apache/flink/commit/1858bb1abcedf787cb83f77443298baf3afe63e0", "committedDate": "2020-11-26T11:39:04Z", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4328, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}