{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MTg1ODI4", "number": 242, "title": "Update deployment parameters to Configuration to match cloud service", "bodyText": "Issue #, if available:\nDescription of changes:\nUpdates the deployment document to have \"Configuration\" as a map instead of \"Parameters\" as a list of objects. Matches cloud config: https://quip-amazon.com/RoYxADgdaJmf/PackageComponent-Parameter-Config\nAlso comments out E2E cloud test due to cloud changes breaking us.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-05-14T18:53:25Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242", "merged": true, "mergeCommit": {"oid": "fd846b8dcf2fce396be80796413e0f76a522bd1d"}, "closed": true, "closedAt": "2020-05-15T18:57:55Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchk3-HAH2gAyNDE4MTg1ODI4OmU4NGM3ZDUwMTZiNmEzZGYzNTUxY2EyZTJjNmI2MDVkYTY2MTJmZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchmxDIgFqTQxMjg5MTQ5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e84c7d5016b6a3df3551ca2e2c6b605da6612fe3", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e84c7d5016b6a3df3551ca2e2c6b605da6612fe3", "committedDate": "2020-05-15T16:43:18Z", "message": "Update deployment parameters to Configuration to match cloud service"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6af0351f54a7269ea17bd6e3feb0299a8ec16d0b", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6af0351f54a7269ea17bd6e3feb0299a8ec16d0b", "committedDate": "2020-05-15T16:12:47Z", "message": "Merge branch 'master' into configuration"}, "afterCommit": {"oid": "d87f3c5594000eea96398cd30dcf94a7245ec397", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/d87f3c5594000eea96398cd30dcf94a7245ec397", "committedDate": "2020-05-15T16:53:33Z", "message": "Disable broken cloud integration test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/22f17e3677182bf0f1e000c9a473802af2f45ddb", "committedDate": "2020-05-15T16:57:06Z", "message": "Disable broken cloud integration test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d87f3c5594000eea96398cd30dcf94a7245ec397", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/d87f3c5594000eea96398cd30dcf94a7245ec397", "committedDate": "2020-05-15T16:53:33Z", "message": "Disable broken cloud integration test"}, "afterCommit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/22f17e3677182bf0f1e000c9a473802af2f45ddb", "committedDate": "2020-05-15T16:57:06Z", "message": "Disable broken cloud integration test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODQzMzk2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#pullrequestreview-412843396", "createdAt": "2020-05-15T17:39:41Z", "commit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzozOTo0MVrOGWOCOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo0MToxNVrOGWOFaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk1MTgwMw==", "bodyText": "typo? ParameterType.BOOLEAN", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#discussion_r425951803", "createdAt": "2020-05-15T17:39:41Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/models/PackageParameter.java", "diffHunk": "@@ -47,6 +51,29 @@ public PackageParameter(String name, String value, ParameterType type) {\n         this.value = value;\n     }\n \n+    /**\n+     * Get a set of parameters from a map of ParameterName -> ParameterValue.\n+     *\n+     * @param configuration map of parameters\n+     * @return set of parameters\n+     */\n+    public static Set<PackageParameter> fromMap(Map<String, Object> configuration) {\n+        HashSet<PackageParameter> set = new HashSet<>();\n+        for (Map.Entry<String, Object> parameter : configuration.entrySet()) {\n+            Object value = parameter.getValue();\n+            if (value instanceof String) {\n+                set.add(new PackageParameter(parameter.getKey(), (String) parameter.getValue(), ParameterType.STRING));\n+            } else if (value instanceof Boolean) {\n+                set.add(new PackageParameter(parameter.getKey(), ((Boolean) parameter.getValue()).toString(),\n+                        ParameterType.STRING));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk1MjYxOQ==", "bodyText": "nit: replace all the parameter.getValue() with value", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#discussion_r425952619", "createdAt": "2020-05-15T17:41:15Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/models/PackageParameter.java", "diffHunk": "@@ -47,6 +51,29 @@ public PackageParameter(String name, String value, ParameterType type) {\n         this.value = value;\n     }\n \n+    /**\n+     * Get a set of parameters from a map of ParameterName -> ParameterValue.\n+     *\n+     * @param configuration map of parameters\n+     * @return set of parameters\n+     */\n+    public static Set<PackageParameter> fromMap(Map<String, Object> configuration) {\n+        HashSet<PackageParameter> set = new HashSet<>();\n+        for (Map.Entry<String, Object> parameter : configuration.entrySet()) {\n+            Object value = parameter.getValue();\n+            if (value instanceof String) {\n+                set.add(new PackageParameter(parameter.getKey(), (String) parameter.getValue(), ParameterType.STRING));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcaf57c1ad62a83085f058af76b4db1ba7367a37", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/dcaf57c1ad62a83085f058af76b4db1ba7367a37", "committedDate": "2020-05-15T17:46:58Z", "message": "Address pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODUzMzM2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#pullrequestreview-412853336", "createdAt": "2020-05-15T17:54:54Z", "commit": {"oid": "dcaf57c1ad62a83085f058af76b4db1ba7367a37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODU1MzIz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#pullrequestreview-412855323", "createdAt": "2020-05-15T17:57:48Z", "commit": {"oid": "dcaf57c1ad62a83085f058af76b4db1ba7367a37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODU0MzM5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#pullrequestreview-412854339", "createdAt": "2020-05-15T17:56:21Z", "commit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1NjoyMVrOGWOjvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNzo1NjoyMVrOGWOjvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTk2MDM4MQ==", "bodyText": "Handle lists and maps (recursive parsing)? Will need the ParameterType also to support that.\nRight now if a list is passed then it will be ignored. The cloud document uses example of a list.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#discussion_r425960381", "createdAt": "2020-05-15T17:56:21Z", "author": {"login": "abanthiy"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/models/PackageParameter.java", "diffHunk": "@@ -47,6 +51,29 @@ public PackageParameter(String name, String value, ParameterType type) {\n         this.value = value;\n     }\n \n+    /**\n+     * Get a set of parameters from a map of ParameterName -> ParameterValue.\n+     *\n+     * @param configuration map of parameters\n+     * @return set of parameters\n+     */\n+    public static Set<PackageParameter> fromMap(Map<String, Object> configuration) {\n+        HashSet<PackageParameter> set = new HashSet<>();\n+        for (Map.Entry<String, Object> parameter : configuration.entrySet()) {\n+            Object value = parameter.getValue();\n+            if (value instanceof String) {\n+                set.add(new PackageParameter(parameter.getKey(), (String) parameter.getValue(), ParameterType.STRING));\n+            } else if (value instanceof Boolean) {\n+                set.add(new PackageParameter(parameter.getKey(), ((Boolean) parameter.getValue()).toString(),\n+                        ParameterType.STRING));\n+            } else if (value instanceof Number) {\n+                set.add(new PackageParameter(parameter.getKey(), String.valueOf(parameter.getValue()),\n+                        ParameterType.NUMBER));\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22f17e3677182bf0f1e000c9a473802af2f45ddb"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODkxNDkw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/242#pullrequestreview-412891490", "createdAt": "2020-05-15T18:55:33Z", "commit": {"oid": "dcaf57c1ad62a83085f058af76b4db1ba7367a37"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2200, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}