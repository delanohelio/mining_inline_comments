{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MTIwNjYx", "number": 336, "title": "Integrate with cloud for safe-to-update check", "bodyText": "Integrate with cloud for safe-to-update check. Add e2e test, make e2e\ntest to use cloud gamma endpoint.\nIssue #, if available:\nCloud implemented safe-to-update check. Integrate with cloud\nDescription of changes:\nWhy is this change necessary:\nHow was this change tested:\nRun e2e test locally\nAny additional information or context required to review the change:\nGithub build won't pass for now, since the Evergreen sdk hasn't been updated in maven repo.\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-07-29T00:09:52Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336", "merged": true, "mergeCommit": {"oid": "371ae5a6de96f9ca5818f954bacc81751b76247a"}, "closed": true, "closedAt": "2020-07-30T20:08:33Z", "author": {"login": "ShirleyZheng92"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5fgtagH2gAyNDU4MTIwNjYxOjhhNDBhODIwYzk5YmY1NGEzYTcyOTMwZmZkMmIyMzc5NWJkNTc3ZGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6ErcrAFqTQ1ODY4ODIyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8a40a820c99bf54a3a72930ffd2b23795bd577db", "author": {"user": {"login": "ShirleyZheng92", "name": "Xueli Zheng "}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8a40a820c99bf54a3a72930ffd2b23795bd577db", "committedDate": "2020-07-29T00:02:33Z", "message": "Integrate with cloud for safe-to-update check\n\nIntegrate with cloud for safe-to-update check. Add e2e test, make e2e\ntest to use cloud gamma endpoint."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75eac9c39c4d677d4d208b5d45736ff2c4e9204a", "author": {"user": {"login": "ShirleyZheng92", "name": "Xueli Zheng "}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/75eac9c39c4d677d4d208b5d45736ff2c4e9204a", "committedDate": "2020-07-29T00:09:17Z", "message": "update e2e test region"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTExMjc3", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#pullrequestreview-457111277", "createdAt": "2020-07-29T00:11:06Z", "commit": {"oid": "75eac9c39c4d677d4d208b5d45736ff2c4e9204a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMDoxMTowN1rOG4kCpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMDoxMjo0MVrOG4kEvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk2Mzk0Mw==", "bodyText": "TODO?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#discussion_r461963943", "createdAt": "2020-07-29T00:11:07Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -249,12 +252,21 @@ protected static synchronized AWSEvergreen getFcsClient() {\n     @SuppressWarnings(\"PMD.LinguisticNaming\")\n     protected PublishConfigurationResult setAndPublishFleetConfiguration(SetConfigurationRequest setRequest) {\n         AWSEvergreen client = getFcsClient();\n+\n+        // update package name with random suffix to avoid conflict in cloud", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75eac9c39c4d677d4d208b5d45736ff2c4e9204a"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk2NDQ3Nw==", "bodyText": "why do we need a new test, don't we have this covered by other tests?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#discussion_r461964477", "createdAt": "2020-07-29T00:12:41Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/e2e/deployment/DeploymentE2ETest.java", "diffHunk": "@@ -275,6 +274,58 @@ void GIVEN_some_running_services_WHEN_cancel_event_received_and_kernel_is_waitin\n         Slf4jLogAdapter.removeGlobalListener(logListener);\n     }\n \n+    @Timeout(value = 10, unit = TimeUnit.MINUTES)\n+    @Test\n+    void GIVEN_deployment_received_WHEN_skip_safety_check_THEN_safety_check_skipped() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75eac9c39c4d677d4d208b5d45736ff2c4e9204a"}, "originalPosition": 93}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c2c1d773a2bd37150d35733398daed273516b12", "author": {"user": {"login": "ShirleyZheng92", "name": "Xueli Zheng "}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8c2c1d773a2bd37150d35733398daed273516b12", "committedDate": "2020-07-29T22:39:49Z", "message": "Merge branch 'master' into SafeToUpdateCheck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37a42fbe4dc5b4404a926d3fab1fcd54a7623638", "author": {"user": {"login": "ShirleyZheng92", "name": "Xueli Zheng "}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/37a42fbe4dc5b4404a926d3fab1fcd54a7623638", "committedDate": "2020-07-30T17:21:51Z", "message": "Merge branch 'master' into SafeToUpdateCheck"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NjM3MDIy", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#pullrequestreview-458637022", "createdAt": "2020-07-30T18:04:53Z", "commit": {"oid": "37a42fbe4dc5b4404a926d3fab1fcd54a7623638"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxODowNDo1M1rOG5uHUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxODowNDo1M1rOG5uHUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE3NzU1Mg==", "bodyText": "This will only change the FCS endpoint to Gamma, the CMS endpoint seems to be coming from here https://github.com/aws/aws-greengrass-kernel/blob/master/src/main/java/com/aws/iot/evergreen/easysetup/DeviceProvisioningHelper.java#L74 We should be changing this as well,\nThis is the endpoint information I got from the cloud team today -\nFor ComponentManagementService:\nBeta: https://uqtyx1gsuk.execute-api.us-east-1.amazonaws.com/Beta\nGamma: https://nztb5z87k6.execute-api.us-east-1.amazonaws.com/Gamma", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#discussion_r463177552", "createdAt": "2020-07-30T18:04:53Z", "author": {"login": "shaguptashaikh"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/e2e/BaseE2ETestCase.java", "diffHunk": "@@ -69,8 +72,8 @@\n  */\n @ExtendWith(EGExtension.class)\n public class BaseE2ETestCase implements AutoCloseable {\n-    protected static final String FCS_BETA_ENDPOINT = \"https://aqzw8qdn5l.execute-api.us-east-1.amazonaws.com/Beta\";\n-    protected static final Region BETA_REGION = Region.US_EAST_1;\n+    protected static final String FCS_GAMMA_ENDPOINT = \"https://bp5p2uvbx6.execute-api.us-east-1.amazonaws.com/Gamma\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37a42fbe4dc5b4404a926d3fab1fcd54a7623638"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NjczNzk0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#pullrequestreview-458673794", "createdAt": "2020-07-30T18:58:34Z", "commit": {"oid": "37a42fbe4dc5b4404a926d3fab1fcd54a7623638"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4Njg4MjIw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/336#pullrequestreview-458688220", "createdAt": "2020-07-30T19:20:46Z", "commit": {"oid": "37a42fbe4dc5b4404a926d3fab1fcd54a7623638"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2953, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}