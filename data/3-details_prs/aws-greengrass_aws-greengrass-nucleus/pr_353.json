{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMjI4MTc2", "number": 353, "title": "support interpolating artifact unpack directories", "bodyText": "Issue #, if available:\nDescription of changes:\nGIVEN a component recipe\nWHEN the recipe references {{artifacts.unpackDir}} and {{kernel.root}}\nTHEN local store sets up a directory per component version for unpacking artifacts, and config merger interpolates to the directory\nWhy is this change necessary:\nThis is required for kernel to unpack artifacts during kernel update.\nHow was this change tested:\nUnit tests\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n[X ] Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-08-05T08:22:52Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353", "merged": true, "mergeCommit": {"oid": "363dabf5509ebd4f67ce0c37b9047988db8ab0c1"}, "closed": true, "closedAt": "2020-08-07T17:32:32Z", "author": {"login": "fahadmohammed01"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc721FOAH2gAyNDYzMjI4MTc2OjBhMjcyMjMzNjYxYTI2YWU3Y2JhNzMxM2MyZDM0YWJkYzk1OTM2OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8nrSXgFqTQ2MzQ3NDQ5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/0a272233661a26ae7cba7313c2d34abdc9593697", "committedDate": "2020-08-05T08:20:28Z", "message": "support interpolating artifact unpack directories"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODI1MjEx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-461825211", "createdAt": "2020-08-05T16:23:30Z", "commit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjoyMzozMFrOG8RJsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjoyMzozMFrOG8RJsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg0ODc1Mw==", "bodyText": "Nice refactor. Can we make Utils more generic? I think we already have our own FileUtils class?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r465848753", "createdAt": "2020-08-05T16:23:30Z", "author": {"login": "leaf94"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/PackageStore.java", "diffHunk": "@@ -56,21 +60,12 @@\n     public PackageStore(@Named(CONTEXT_PACKAGE_STORE_DIRECTORY) @NonNull Path packageStoreDirectory)\n             throws PackagingException {\n         this.recipeDirectory = packageStoreDirectory.resolve(RECIPE_DIRECTORY);\n-        if (!Files.exists(recipeDirectory)) {\n-            try {\n-                Files.createDirectories(recipeDirectory);\n-            } catch (IOException e) {\n-                throw new PackagingException(String.format(\"Failed to create recipe directory %s\", recipeDirectory), e);\n-            }\n-        }\n         this.artifactDirectory = packageStoreDirectory.resolve(ARTIFACT_DIRECTORY);\n-        if (!Files.exists(artifactDirectory)) {\n-            try {\n-                Files.createDirectories(artifactDirectory);\n-            } catch (IOException e) {\n-                throw new PackagingException(String.format(\"Failed to create artifact directory %s\", artifactDirectory),\n-                        e);\n-            }\n+        this.artifactsUnpackDirectory = packageStoreDirectory.resolve(ARTIFACTS_UNPACK_DIRECTORY);\n+        try {\n+            Utils.createPaths(recipeDirectory, artifactDirectory, artifactsUnpackDirectory);\n+        } catch (IOException e) {\n+            throw new PackagingException(\"Failed to create necessary directories for package store\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODQ1MTcw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-461845170", "createdAt": "2020-08-05T16:48:08Z", "commit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjo0ODowOFrOG8SG4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjo0ODowOFrOG8SG4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg2NDQxOA==", "bodyText": "Use the systemParameters instead of hardcoding these.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r465864418", "createdAt": "2020-08-05T16:48:08Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolver.java", "diffHunk": "@@ -148,13 +150,19 @@ private Object interpolate(Object configValue, Set<PackageParameter> packagePara\n     }\n \n     private String replace(String stringValue, PackageIdentifier packageIdentifier,\n-                           Set<PackageParameter> packageParameters) {\n+                           Set<PackageParameter> packageParameters) throws PackageLoadingException {\n         // Handle package parameters\n         for (final PackageParameter parameter : packageParameters) {\n             stringValue = stringValue\n                     .replace(String.format(PARAMETER_REFERENCE_FORMAT, parameter.getName()), parameter.getValue());\n         }\n \n+        //Handle directories\n+        stringValue = stringValue.replace(ARTIFACTS_UNPACK_DIRECTORY_PLACEHOLDER,\n+                packageStore.resolveAndSetupArtifactsUnpackDirectory(packageIdentifier).toAbsolutePath().toString());\n+        stringValue = stringValue.replace(KERNEL_ROOT_DIRECTORY_PLACEHOLDER,\n+                kernel.getRootPath().toAbsolutePath().toString());\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODQ2NTQ1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-461846545", "createdAt": "2020-08-05T16:49:53Z", "commit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjo0OTo1M1rOG8SLKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNjo0OTo1M1rOG8SLKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg2NTUxNA==", "bodyText": "How is this used? Does kernel decompress the file itself?\nFeng (IoT) Wang Yesterday at 9:40 PM\nCustomers should be able to specify the compression format of the artifact and the artifact downloader should unpack the artifacts. That\u2019s what I described in the original package downloader design: https://quip-amazon.com/aEbzAtwX1b1M/Evergreen-device-package-store#BJX9CAdFfH2\n5 replies\nMichael Dombrowski  12 hours ago\nIt says that it decompresses automatically, are we sure we want that? Or should it be an option?\nFeng (IoT) Wang  12 hours ago\nwe can make it configurable.\nMichael Dombrowski  12 hours ago\nuri: something\ndecompress: zip/gzip\nSomething like that?\nFeng (IoT) Wang  12 hours ago\nright. If a compression format is specified, such as zip or tar, then we can unzip/untar it. If it\u2019s not specified, then we do nothing.\nMichael Dombrowski  12 hours ago\nI'm good with that. Can work on it tomorrow. It'll need a cloud change too to add it to the recipe", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r465865514", "createdAt": "2020-08-05T16:49:53Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/PackageStore.java", "diffHunk": "@@ -46,8 +48,10 @@\n \n     private final Path artifactDirectory;\n \n+    private final Path artifactsUnpackDirectory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODc4OTU5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-461878959", "createdAt": "2020-08-05T17:31:46Z", "commit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzozMTo0NlrOG8TrVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzozMTo0NlrOG8TrVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5MDEzMg==", "bodyText": "What's the unpack directory for?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r465890132", "createdAt": "2020-08-05T17:31:46Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/PackageStore.java", "diffHunk": "@@ -38,6 +39,7 @@\n     public static final String CONTEXT_PACKAGE_STORE_DIRECTORY = \"packageStoreDirectory\";\n     public static final String RECIPE_DIRECTORY = \"recipes\";\n     public static final String ARTIFACT_DIRECTORY = \"artifacts\";\n+    public static final String ARTIFACTS_UNPACK_DIRECTORY = \"artifacts-unpack\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a272233661a26ae7cba7313c2d34abdc9593697"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "241cb5f2dc5ffed4980a34bbaf5d19f3006afa00", "author": {"user": {"login": "ShirleyZheng92", "name": "Xueli Zheng "}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/241cb5f2dc5ffed4980a34bbaf5d19f3006afa00", "committedDate": "2020-08-05T18:08:03Z", "message": "Merge branch 'master' into interpolate-directories"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb323631a5b12e24ac8055888bc0d53658383b00", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/bb323631a5b12e24ac8055888bc0d53658383b00", "committedDate": "2020-08-06T01:56:27Z", "message": "addressed pr comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2986e6b429f9f8a5225b10adea1b1c2044a029bb", "committedDate": "2020-08-06T20:26:48Z", "message": "added tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODc4NDcx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462878471", "createdAt": "2020-08-06T21:09:00Z", "commit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODgwMDU4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462880058", "createdAt": "2020-08-06T21:11:36Z", "commit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMTozNlrOG9EbAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMTozNlrOG9EbAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4ODc2OQ==", "bodyText": "Why does this need to create the path? Our other artifact dir is created at some other time", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r466688769", "createdAt": "2020-08-06T21:11:36Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolver.java", "diffHunk": "@@ -55,10 +60,18 @@ public KernelConfigResolver(PackageStore packageStore, Kernel kernel) {\n         this.kernel = kernel;\n \n         // More system parameters can be added over time by extending this map with new namespaces/keys\n-        HashMap<String, Function<PackageIdentifier, String>> artifactNamespace = new HashMap<>();\n-        artifactNamespace\n-                .put(\"path\", (id) -> packageStore.resolveArtifactDirectoryPath(id).toAbsolutePath().toString());\n-        systemParameters.put(\"artifacts\", artifactNamespace);\n+        HashMap<String, CrashableFunction<PackageIdentifier, String, PackageLoadingException>> artifactNamespace\n+                = new HashMap<>();\n+        artifactNamespace.put(\"path\",\n+                (id) -> packageStore.resolveArtifactDirectoryPath(id).toAbsolutePath().toString());\n+        artifactNamespace.put(\"unpackPath\",\n+                (id) -> packageStore.resolveAndSetupArtifactsUnpackDirectory(id).toAbsolutePath().toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODgwMjg1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462880285", "createdAt": "2020-08-06T21:12:00Z", "commit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMjowMFrOG9EbxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMToxMjowMFrOG9EbxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4ODk2NQ==", "bodyText": "maybe \"decompressedPath\"?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r466688965", "createdAt": "2020-08-06T21:12:00Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolver.java", "diffHunk": "@@ -55,10 +60,18 @@ public KernelConfigResolver(PackageStore packageStore, Kernel kernel) {\n         this.kernel = kernel;\n \n         // More system parameters can be added over time by extending this map with new namespaces/keys\n-        HashMap<String, Function<PackageIdentifier, String>> artifactNamespace = new HashMap<>();\n-        artifactNamespace\n-                .put(\"path\", (id) -> packageStore.resolveArtifactDirectoryPath(id).toAbsolutePath().toString());\n-        systemParameters.put(\"artifacts\", artifactNamespace);\n+        HashMap<String, CrashableFunction<PackageIdentifier, String, PackageLoadingException>> artifactNamespace\n+                = new HashMap<>();\n+        artifactNamespace.put(\"path\",\n+                (id) -> packageStore.resolveArtifactDirectoryPath(id).toAbsolutePath().toString());\n+        artifactNamespace.put(\"unpackPath\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2986e6b429f9f8a5225b10adea1b1c2044a029bb"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5092be8afb885ce0e718ce042d0a1c2a669ab53", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e5092be8afb885ce0e718ce042d0a1c2a669ab53", "committedDate": "2020-08-06T21:30:18Z", "message": "Merge branch 'master' into interpolate-directories"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7805028cf2cf98e1ada5b05523834c095b05f5ec", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7805028cf2cf98e1ada5b05523834c095b05f5ec", "committedDate": "2020-08-06T21:48:19Z", "message": "resolved merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a0f9371ca3804254795d9058f1b8f0b3c49667d", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/0a0f9371ca3804254795d9058f1b8f0b3c49667d", "committedDate": "2020-08-06T21:52:50Z", "message": "minor refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b3f34624090425e93807ebe6053041c9f42f936", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8b3f34624090425e93807ebe6053041c9f42f936", "committedDate": "2020-08-06T22:31:13Z", "message": "fixed test case to work in windows platform"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/9e234e938f886f8f470a4f834ed0d9265de831e9", "committedDate": "2020-08-06T23:05:50Z", "message": "Merge branch 'master' into interpolate-directories"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTQ0Mzgw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462944380", "createdAt": "2020-08-06T23:32:47Z", "commit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTQ1Mzgz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462945383", "createdAt": "2020-08-06T23:35:51Z", "commit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMzozNTo1MVrOG9Hmxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMzozOToxNFrOG9HqoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0MDkzNA==", "bodyText": "I don't think these need to be public", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r466740934", "createdAt": "2020-08-06T23:35:51Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolver.java", "diffHunk": "@@ -42,6 +43,9 @@\n     private static final Logger LOGGER = LogManager.getLogger(KernelConfigResolver.class);\n     public static final String VERSION_CONFIG_KEY = \"version\";\n     public static final String PARAMETERS_CONFIG_KEY = \"parameters\";\n+    public static final String ARTIFACTS_NAMESPACE = \"artifacts\";\n+    public static final String KERNEL_NAMESPACE = \"kernel\";\n+    public static final String KERNEL_ROOT_PATH = \"rootPath\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0MTU5NA==", "bodyText": "change the unpack everywhere to decompressed", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r466741594", "createdAt": "2020-08-06T23:38:13Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/PackageStore.java", "diffHunk": "@@ -38,6 +39,7 @@\n     public static final String CONTEXT_PACKAGE_STORE_DIRECTORY = \"packageStoreDirectory\";\n     public static final String RECIPE_DIRECTORY = \"recipes\";\n     public static final String ARTIFACT_DIRECTORY = \"artifacts\";\n+    public static final String ARTIFACTS_UNPACK_DIRECTORY = \"artifacts-unpack\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0MTkyMA==", "bodyText": "Format isn't necessary when you're just appending to the end, I think concatenation is faster in this case.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#discussion_r466741920", "createdAt": "2020-08-06T23:39:14Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/PackageStore.java", "diffHunk": "@@ -217,6 +211,25 @@ private Path resolveRecipePath(String packageName, Semver packageVersion) {\n         return recipeDirectory.resolve(String.format(RECIPE_FILE_NAME_FORMAT, packageName, packageVersion.getValue()));\n     }\n \n+    /**\n+     * Resolve the artifact unpack directory path and creates the directory if absent.\n+     * @param packageIdentifier packageIdentifier\n+     * @return artifact unpack directory path\n+     * @throws PackageLoadingException if un-able to create artifact unpack directory path\n+     */\n+    public Path resolveAndSetupArtifactsUnpackDirectory(@NonNull PackageIdentifier packageIdentifier)\n+            throws PackageLoadingException {\n+        Path path = artifactsUnpackDirectory.resolve(packageIdentifier.getName())\n+                .resolve(packageIdentifier.getVersion().getValue());\n+        try {\n+            Utils.createPaths(path);\n+            return path;\n+        } catch (IOException e) {\n+            throw new PackageLoadingException(String.format(\n+                    \"Failed to create artifact unpack directory for %s\", packageIdentifier.toString()), e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e234e938f886f8f470a4f834ed0d9265de831e9"}, "originalPosition": 82}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dd579f6f995d3173c637adba47bb0e648fc58d4", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7dd579f6f995d3173c637adba47bb0e648fc58d4", "committedDate": "2020-08-07T00:29:49Z", "message": "addressed pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTYyMTk2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-462962196", "createdAt": "2020-08-07T00:31:01Z", "commit": {"oid": "7dd579f6f995d3173c637adba47bb0e648fc58d4"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cde04bf09bbdb820876fb58b7f853ba07337496a", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/cde04bf09bbdb820876fb58b7f853ba07337496a", "committedDate": "2020-08-07T04:00:54Z", "message": "fixed test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be62f5e7126c575fc36122080624599bb82d9f02", "author": {"user": {"login": "fahadmohammed01", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/be62f5e7126c575fc36122080624599bb82d9f02", "committedDate": "2020-08-07T04:02:21Z", "message": "fixed test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNDczMjc5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-463473279", "createdAt": "2020-08-07T17:13:05Z", "commit": {"oid": "be62f5e7126c575fc36122080624599bb82d9f02"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNDc0NDk5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/353#pullrequestreview-463474499", "createdAt": "2020-08-07T17:15:07Z", "commit": {"oid": "be62f5e7126c575fc36122080624599bb82d9f02"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2069, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}