{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MzMxNDc0", "number": 357, "title": "Fix tlog to handle periods in namespace", "bodyText": "Issue #, if available:\nDescription of changes:\nWrites tlog to handle periods in the configuration namespace by serializing it as an array.\nWe should again reconsider the TLog format and think about just using jackson to have proper serdes.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-08-07T00:49:37Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/357", "merged": true, "mergeCommit": {"oid": "44e10666a640976982472ad048a997c1310abae0"}, "closed": true, "closedAt": "2020-08-07T20:30:23Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8ZtlGgH2gAyNDY0MzMxNDc0OmEyZTJiODczM2M2ZWI1OWQyMjc0Mjk5Y2QzYzkzNDBmMjVkY2U2MWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8qZGZAFqTQ2MzU5MDM2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a2e2b8733c6eb59d2274299cd3c9340f25dce61a", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/a2e2b8733c6eb59d2274299cd3c9340f25dce61a", "committedDate": "2020-08-07T00:58:57Z", "message": "Fix tlog to handle periods in namespace"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "69649a2a7418fa6c4382f03aee3da6f9a614f4b5", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/69649a2a7418fa6c4382f03aee3da6f9a614f4b5", "committedDate": "2020-08-07T00:49:14Z", "message": "Fix tlog to handle periods in namespace"}, "afterCommit": {"oid": "a2e2b8733c6eb59d2274299cd3c9340f25dce61a", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/a2e2b8733c6eb59d2274299cd3c9340f25dce61a", "committedDate": "2020-08-07T00:58:57Z", "message": "Fix tlog to handle periods in namespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc87bf528e00b9fab568ecdb9cf470bbbb9382af", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/cc87bf528e00b9fab568ecdb9cf470bbbb9382af", "committedDate": "2020-08-07T18:43:53Z", "message": "Merge branch 'master' into tlog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTg0NjA4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/357#pullrequestreview-463584608", "createdAt": "2020-08-07T20:13:20Z", "commit": {"oid": "cc87bf528e00b9fab568ecdb9cf470bbbb9382af"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QyMDoxMzoyMFrOG9mjiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QyMDoxNjo1NFrOG9mpBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzI0ODAxMQ==", "bodyText": "maybe use getter and mark it as private since we already has it?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/357#discussion_r467248011", "createdAt": "2020-08-07T20:13:20Z", "author": {"login": "leaf94"}, "path": "src/main/java/com/aws/iot/evergreen/config/ConfigurationReader.java", "diffHunk": "@@ -28,28 +27,25 @@ private ConfigurationReader() {\n      * @param reader         reader of the transaction log to read from\n      * @param forceTimestamp should ignore if the proposed timestamp is older than current\n      * @param mergeCondition Predicate that returns true if the provided Topic should be merged and false if not\n-     *\n      * @throws IOException if reading fails\n      */\n-    public static void mergeTLogInto(Configuration config,\n-                                     Reader reader,\n-                                     boolean forceTimestamp,\n+    public static void mergeTLogInto(Configuration config, Reader reader, boolean forceTimestamp,\n                                      Predicate<Node> mergeCondition) throws IOException {\n-        try (BufferedReader in = reader instanceof BufferedReader\n-                ? (BufferedReader) reader : new BufferedReader(reader)) {\n+        try (BufferedReader in = reader instanceof BufferedReader ? (BufferedReader) reader\n+                : new BufferedReader(reader)) {\n             String l;\n \n             for (l = in.readLine(); l != null; l = in.readLine()) {\n                 try {\n                     Tlogline tlogline = Tlogline.fromStringInput(l);\n                     if (WhatHappened.changed.equals(tlogline.action)) {\n-                        Topic targetTopic = config.lookup(seperator.split(tlogline.topicString));\n+                        Topic targetTopic = config.lookup(tlogline.topicPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc87bf528e00b9fab568ecdb9cf470bbbb9382af"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzI0OTQxMg==", "bodyText": "yeah let's remember if we can switch this with jackson...", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/357#discussion_r467249412", "createdAt": "2020-08-07T20:16:54Z", "author": {"login": "leaf94"}, "path": "src/main/java/com/aws/iot/evergreen/util/Coerce.java", "diffHunk": "@@ -287,6 +287,17 @@ public static void appendParseableString(Object o, Appendable out) throws IOExce\n             out.append(\"null\");\n         } else if (o instanceof Boolean || o instanceof Number || o instanceof List) {\n             out.append(o.toString());\n+        } else if (o.getClass().isArray()) {\n+            out.append('[');\n+            Object[] objects = (Object[]) o;\n+            for (int j = 0; j < objects.length; j++) {\n+                Object i = objects[j];\n+                out.append(toString(i));\n+                if (j != objects.length - 1) {\n+                    out.append(',');\n+                }\n+            }\n+            out.append(']');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc87bf528e00b9fab568ecdb9cf470bbbb9382af"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTkwMzY5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/357#pullrequestreview-463590369", "createdAt": "2020-08-07T20:24:58Z", "commit": {"oid": "cc87bf528e00b9fab568ecdb9cf470bbbb9382af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2073, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}