{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODI0Mzc3", "number": 316, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTowMTo1M1rOEO7HTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTowMTo1M1rOEO7HTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MDg0MDQ3OnYy", "diffSide": "RIGHT", "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/e2e/deployment/MultipleDeploymentsTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTowMTo1M1rOGyWbIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTowMTo1M1rOGyWbIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ0OTM3OA==", "bodyText": "do we need 5 minutes on the cancelled, seems a bit long", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/316#discussion_r455449378", "createdAt": "2020-07-16T01:01:53Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/e2e/deployment/MultipleDeploymentsTest.java", "diffHunk": "@@ -115,20 +117,25 @@ void GIVEN_offline_device_WHEN_create_multiple_deployments_THEN_deployments_exec\n \n             IotJobsUtils.waitForJobExecutionStatusToSatisfy(iotClient, helper.jobId, thingInfo.getThingName(),\n                     Duration.ofMinutes(1), s -> s.ordinal() >= JobExecutionStatus.QUEUED.ordinal());\n-            logger.atWarn().kv(\"jobId\", helper.jobId).log(\"Created IoT Job\");\n+            logger.atWarn().kv(\"jobId\", helper.jobId).kv(\"index\", helper.index).log(\"Created IoT Job\");\n         }\n-\n-        subscribeToLocalDeploymentStatus(kernel, helpers);\n+        // Only the last job should execute\n+        subscribeToLocalDeploymentStatus(kernel, Arrays.asList(mostRecentJobHelper));\n \n         // Start kernel and connect IoT cloud\n         kernel.launch();\n \n         // Wait for all jobs to finish\n         for (DeploymentJobHelper helper : helpers) {\n-            assertTrue(helper.jobCompleted.await(2, TimeUnit.MINUTES), \"Deployment job timed out: \" + helper.jobId);\n-\n-            IotJobsUtils.waitForJobExecutionStatusToSatisfy(iotClient, helper.jobId, thingInfo.getThingName(),\n-                    Duration.ofMinutes(5), s -> s.equals(JobExecutionStatus.SUCCEEDED));\n+            if (helper.index == 3) {\n+                assertTrue(helper.jobCompleted.await(2, TimeUnit.MINUTES), \"Deployment job timed out: \" + helper.jobId);\n+\n+                IotJobsUtils.waitForJobExecutionStatusToSatisfy(iotClient, helper.jobId, thingInfo.getThingName(),\n+                        Duration.ofMinutes(5), s -> s.equals(JobExecutionStatus.SUCCEEDED));\n+            } else {\n+                IotJobsUtils.waitForJobExecutionStatusToSatisfy(iotClient, helper.jobId, thingInfo.getThingName(),\n+                        Duration.ofMinutes(5), s -> s.equals(JobExecutionStatus.CANCELED));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8533c2146202b4eccd7bc03535ff77df5efc7758"}, "originalPosition": 50}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4413, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}