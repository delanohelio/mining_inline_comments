{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyOTc4MzMx", "number": 523, "title": "Add version to command line, CLI support for recipes in json and not \u2026", "bodyText": "\u2026precicely named files\nIssue #, if available:\nDescription of changes:\nAdds version output for CLI for IDT team. Updates CLI to support recipes in json format as well as not requiring a specific filename (it parses the recipe to find the name and version number).\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-10-13T23:29:56Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523", "merged": true, "mergeCommit": {"oid": "0bfc5088ca2f42d94c7c94e6eabd1e9586bc1047"}, "closed": true, "closedAt": "2020-10-14T23:50:49Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSROVfgBqjM4NzQwMjQ4ODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSl497gFqTUwODg0MjEwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b615fd7824aa9b7d93fca243c3db511b3e6005c", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2b615fd7824aa9b7d93fca243c3db511b3e6005c", "committedDate": "2020-10-13T23:03:39Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}, "afterCommit": {"oid": "2ec588d1d1485bef06a4285af2fbf58f319a72a7", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2ec588d1d1485bef06a4285af2fbf58f319a72a7", "committedDate": "2020-10-13T23:31:48Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3ODk5Mzk5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#pullrequestreview-507899399", "createdAt": "2020-10-13T23:34:56Z", "commit": {"oid": "2b615fd7824aa9b7d93fca243c3db511b3e6005c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMzozNToyNlrOHg9Fdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMzozOTo0MlrOHg9KRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMxNzMwMg==", "bodyText": "What's the use-case of performing a partial update in case of read failure?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#discussion_r504317302", "createdAt": "2020-10-13T23:35:26Z", "author": {"login": "philcali"}, "path": "src/main/java/com/aws/greengrass/builtin/services/cli/CLIServiceAgent.java", "diffHunk": "@@ -241,6 +245,39 @@ public void updateRecipesAndArtifacts(UpdateRecipesAndArtifactsRequest request)\n         }\n     }\n \n+    private void copyRecipes(Path from, Path to) throws IOException {\n+        for (Path r : Files.walk(from).collect(Collectors.toList())) {\n+            String ext = Utils.extension(r.toString());\n+            ComponentRecipe recipe = null;\n+            try {\n+                switch (ext.toLowerCase()) {\n+                    case \"yaml\":\n+                    case \"yml\":\n+                        recipe = SerializerFactory.getRecipeSerializer().readValue(r.toFile(), ComponentRecipe.class);\n+                        break;\n+                    case \"json\":\n+                        recipe = SerializerFactory.getRecipeSerializerJson()\n+                                .readValue(r.toFile(), ComponentRecipe.class);\n+                        break;\n+                    default:\n+                        break;\n+                }\n+            } catch (IOException e) {\n+                logger.atError().log(\"Error reading recipe file from {}\", r, e);\n+            }\n+\n+            if (recipe == null) {\n+                continue;\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ec588d1d1485bef06a4285af2fbf58f319a72a7"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMxODUzNA==", "bodyText": "Will customers understand --env-stage? Should we use --endpoint instead (like the SDK)?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#discussion_r504318534", "createdAt": "2020-10-13T23:39:42Z", "author": {"login": "philcali"}, "path": "src/main/java/com/aws/greengrass/easysetup/GreengrassSetup.java", "diffHunk": "@@ -51,6 +52,8 @@\n             + \"\\t--install-cli, -ic\\t\\tY/N Indicate if you want to install Greengrass device CLI\\n\"\n             + \"\\t--setup-system-service, -ss\\t\\tY/N Indicate if you want to setup Greengrass as a system service\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ec588d1d1485bef06a4285af2fbf58f319a72a7"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTA4MzI5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#pullrequestreview-507908329", "createdAt": "2020-10-14T00:02:19Z", "commit": {"oid": "2ec588d1d1485bef06a4285af2fbf58f319a72a7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ec588d1d1485bef06a4285af2fbf58f319a72a7", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2ec588d1d1485bef06a4285af2fbf58f319a72a7", "committedDate": "2020-10-13T23:31:48Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}, "afterCommit": {"oid": "8aa44eef66c393dc5a7d6e99386806359a8a3fe9", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8aa44eef66c393dc5a7d6e99386806359a8a3fe9", "committedDate": "2020-10-14T00:10:59Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3OTEzMTk4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#pullrequestreview-507913198", "createdAt": "2020-10-14T00:18:08Z", "commit": {"oid": "8aa44eef66c393dc5a7d6e99386806359a8a3fe9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28f3ff473b8ec8435185f6dacce974b35647bb29", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/28f3ff473b8ec8435185f6dacce974b35647bb29", "committedDate": "2020-10-14T06:49:07Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e5d48e53e322834247168a3a373969f95be6ba35", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e5d48e53e322834247168a3a373969f95be6ba35", "committedDate": "2020-10-14T05:13:02Z", "message": "Fix getting content length from public repo"}, "afterCommit": {"oid": "28f3ff473b8ec8435185f6dacce974b35647bb29", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/28f3ff473b8ec8435185f6dacce974b35647bb29", "committedDate": "2020-10-14T06:49:07Z", "message": "Add version to command line, CLI support for recipes in json and not precicely named files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4Mjk1MDcw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#pullrequestreview-508295070", "createdAt": "2020-10-14T12:33:10Z", "commit": {"oid": "28f3ff473b8ec8435185f6dacce974b35647bb29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "452e2531626d1ff67fedebc3e71553428bb408ff", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/452e2531626d1ff67fedebc3e71553428bb408ff", "committedDate": "2020-10-14T23:28:29Z", "message": "Merge branch 'master' into nicer-cli"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4ODQyMTAz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/523#pullrequestreview-508842103", "createdAt": "2020-10-14T23:36:35Z", "commit": {"oid": "452e2531626d1ff67fedebc3e71553428bb408ff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3146, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}