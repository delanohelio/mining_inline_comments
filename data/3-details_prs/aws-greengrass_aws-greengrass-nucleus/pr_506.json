{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4ODkzMjE1", "number": 506, "title": "Centralize paths and permissions", "bodyText": "Issue #, if available:\nDescription of changes:\nCentralize directory creation to a single file NucleusPaths which will use another new class Permission to set the permissions for each directory/file as needed. Permissions are not getting set yet as this PR is big enough already. It is just moving All the directory creation I could see into this one file and removing the paths from the kernel object.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-10-06T23:41:08Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506", "merged": true, "mergeCommit": {"oid": "70e51c3b3258d5595ea9187cec5d2654308431fb"}, "closed": true, "closedAt": "2020-10-08T15:56:45Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQBjKSABqjM4NDgwMjQwMzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQi6x-AFqTUwNDg3ODc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d36dd5c6c84a0a3d7bac270c6baa1eaa046f2fb5", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/d36dd5c6c84a0a3d7bac270c6baa1eaa046f2fb5", "committedDate": "2020-10-06T23:38:58Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "43fb8d3ca76004d8c2e75c6f34dd3d2cdb92affa", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/43fb8d3ca76004d8c2e75c6f34dd3d2cdb92affa", "committedDate": "2020-10-07T00:08:13Z", "message": "Centralize paths and permissions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "43fb8d3ca76004d8c2e75c6f34dd3d2cdb92affa", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/43fb8d3ca76004d8c2e75c6f34dd3d2cdb92affa", "committedDate": "2020-10-07T00:08:13Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "f3b04b397bc35df8359c2f54c452990f450d2065", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f3b04b397bc35df8359c2f54c452990f450d2065", "committedDate": "2020-10-07T00:19:13Z", "message": "Centralize paths and permissions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3b04b397bc35df8359c2f54c452990f450d2065", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f3b04b397bc35df8359c2f54c452990f450d2065", "committedDate": "2020-10-07T00:19:13Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "c2f81f7b1480e42137b16d69952cdea7da4eedff", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/c2f81f7b1480e42137b16d69952cdea7da4eedff", "committedDate": "2020-10-07T00:28:13Z", "message": "Centralize paths and permissions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2f81f7b1480e42137b16d69952cdea7da4eedff", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/c2f81f7b1480e42137b16d69952cdea7da4eedff", "committedDate": "2020-10-07T00:28:13Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "7dca19249d912f4453f6712a773c0a40ff86f0ac", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7dca19249d912f4453f6712a773c0a40ff86f0ac", "committedDate": "2020-10-07T03:05:11Z", "message": "Centralize paths and permissions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDExMDQ4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504011048", "createdAt": "2020-10-07T15:34:41Z", "commit": {"oid": "7dca19249d912f4453f6712a773c0a40ff86f0ac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTozNDo0MlrOHd5XGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTozNDo0MlrOHd5XGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMDU1NA==", "bodyText": "Setting the permissions for the work path and the artifact paths will need to lookup the the user/group for the service. Do you see that happening in the Permissions class?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#discussion_r501110554", "createdAt": "2020-10-07T15:34:42Z", "author": {"login": "rbattle"}, "path": "src/main/java/com/aws/greengrass/util/NucleusPaths.java", "diffHunk": "@@ -0,0 +1,153 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.aws.greengrass.util;\n+\n+import com.aws.greengrass.componentmanager.models.ComponentIdentifier;\n+\n+import java.io.IOException;\n+import java.nio.file.Path;\n+\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACTS_DECOMPRESSED_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACT_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.RECIPE_DIRECTORY;\n+\n+@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n+public class NucleusPaths {\n+    private Path rootPath;\n+    private Path workPath;\n+    private Path componentStorePath;\n+    private Path configPath;\n+    private Path deploymentPath;\n+    private Path kernelAltsPath;\n+\n+    public void initPaths(Path root, Path workPath, Path componentStorePath, Path configPath, Path kernelAlts,\n+                          Path deployment) throws IOException {\n+        setRootPath(root);\n+        setConfigPath(configPath);\n+        setDeploymentPath(deployment);\n+        setKernelAltsPath(kernelAlts);\n+        setWorkPath(workPath);\n+        setComponentStorePath(componentStorePath);\n+    }\n+\n+    public void setKernelAltsPath(Path kernelAltsPath) throws IOException {\n+        this.kernelAltsPath = kernelAltsPath;\n+        Utils.createPaths(kernelAltsPath());\n+        Permissions.setKernelAltsPermission(kernelAltsPath());\n+    }\n+\n+    public Path kernelAltsPath() {\n+        return kernelAltsPath;\n+    }\n+\n+    public void setDeploymentPath(Path deploymentPath) throws IOException {\n+        this.deploymentPath = deploymentPath;\n+        Utils.createPaths(deploymentPath());\n+        Permissions.setDeploymentPermission(deploymentPath());\n+    }\n+\n+    public Path deploymentPath() {\n+        return deploymentPath;\n+    }\n+\n+    public void setConfigPath(Path configPath) throws IOException {\n+        this.configPath = configPath;\n+        Utils.createPaths(configPath());\n+        Permissions.setConfigPermission(configPath());\n+    }\n+\n+    public Path configPath() {\n+        return configPath;\n+    }\n+\n+    public void setWorkPath(Path workPath) throws IOException {\n+        this.workPath = workPath;\n+        Utils.createPaths(workPath);\n+        Permissions.setWorkPathPermission(workPath);\n+    }\n+\n+    public void setRootPath(Path root) throws IOException {\n+        this.rootPath = root;\n+        Utils.createPaths(root);\n+        Permissions.setRootPermission(root);\n+\n+        Utils.createPaths(pluginPath());\n+        Permissions.setPluginPermission(pluginPath());\n+    }\n+\n+    public void setComponentStorePath(Path componentStorePath) throws IOException {\n+        this.componentStorePath = componentStorePath;\n+        Utils.createPaths(componentStorePath);\n+        Permissions.setComponentStorePermission(componentStorePath);\n+\n+        Utils.createPaths(artifactPath());\n+        Permissions.setArtifactStorePermission(artifactPath());\n+\n+        Utils.createPaths(unarchivePath());\n+        Permissions.setArtifactStorePermission(unarchivePath());\n+\n+        Utils.createPaths(recipePath());\n+        Permissions.setRecipeStorePermission(recipePath());\n+    }\n+\n+    public Path artifactPath() {\n+        return componentStorePath.resolve(ARTIFACT_DIRECTORY);\n+    }\n+\n+    public Path artifactPath(ComponentIdentifier componentIdentifier) throws IOException {\n+        Path p = artifactPath().resolve(componentIdentifier.getName())\n+                .resolve(componentIdentifier.getVersion().getValue());\n+        Utils.createPaths(p);\n+        Permissions.setArtifactPermission(p);\n+        return p;\n+    }\n+\n+    public Path recipePath() {\n+        return componentStorePath.resolve(RECIPE_DIRECTORY);\n+    }\n+\n+    public Path unarchivePath() {\n+        return componentStorePath.resolve(ARTIFACTS_DECOMPRESSED_DIRECTORY);\n+    }\n+\n+    public Path unarchiveArtifactPath(ComponentIdentifier componentIdentifier, String artifactName) throws IOException {\n+        Path p = unarchiveArtifactPath(componentIdentifier).resolve(artifactName);\n+        Utils.createPaths(p);\n+        Permissions.setArtifactPermission(p);\n+        return p;\n+    }\n+\n+    public Path unarchiveArtifactPath(ComponentIdentifier componentIdentifier) throws IOException {\n+        Path p = unarchivePath().resolve(componentIdentifier.getName())\n+                .resolve(componentIdentifier.getVersion().getValue());\n+        Utils.createPaths(p);\n+        Permissions.setArtifactPermission(p);\n+        return p;\n+    }\n+\n+    public Path componentStorePath() {\n+        return componentStorePath;\n+    }\n+\n+    public Path workPath(String serviceName) throws IOException {\n+        Path p = workPath().resolve(serviceName);\n+        Utils.createPaths(p);\n+        Permissions.setWorkPathPermission(p);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dca19249d912f4453f6712a773c0a40ff86f0ac"}, "originalPosition": 138}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7dca19249d912f4453f6712a773c0a40ff86f0ac", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7dca19249d912f4453f6712a773c0a40ff86f0ac", "committedDate": "2020-10-07T03:05:11Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "249f20691b3ddff103fd7e2f6206725e916c9db1", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/249f20691b3ddff103fd7e2f6206725e916c9db1", "committedDate": "2020-10-07T18:27:59Z", "message": "Centralize paths and permissions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "249f20691b3ddff103fd7e2f6206725e916c9db1", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/249f20691b3ddff103fd7e2f6206725e916c9db1", "committedDate": "2020-10-07T18:27:59Z", "message": "Centralize paths and permissions"}, "afterCommit": {"oid": "6e1557598011046a201046f7e7b77168b68751ae", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6e1557598011046a201046f7e7b77168b68751ae", "committedDate": "2020-10-07T18:29:00Z", "message": "Centralize paths and permissions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a4d6d24fa36a47a939ecfaf14d426a2a13a022e", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7a4d6d24fa36a47a939ecfaf14d426a2a13a022e", "committedDate": "2020-10-07T22:10:24Z", "message": "Centralize paths and permissions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6032a00d87a0f9ad0857b9e0c67e48e1031e00a9", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6032a00d87a0f9ad0857b9e0c67e48e1031e00a9", "committedDate": "2020-10-07T21:18:39Z", "message": "Merge branch 'master' into perms"}, "afterCommit": {"oid": "7a4d6d24fa36a47a939ecfaf14d426a2a13a022e", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/7a4d6d24fa36a47a939ecfaf14d426a2a13a022e", "committedDate": "2020-10-07T22:10:24Z", "message": "Centralize paths and permissions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MzA4Mjg0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504308284", "createdAt": "2020-10-07T22:21:19Z", "commit": {"oid": "7a4d6d24fa36a47a939ecfaf14d426a2a13a022e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "313ab5041592b23204f6e6d52e763e4f18959b2f", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/313ab5041592b23204f6e6d52e763e4f18959b2f", "committedDate": "2020-10-07T22:28:16Z", "message": "Remove broken test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0bd7e5e95a45a83748466c7d2890afaa35491206", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/0bd7e5e95a45a83748466c7d2890afaa35491206", "committedDate": "2020-10-07T22:23:28Z", "message": "Remove broken test"}, "afterCommit": {"oid": "313ab5041592b23204f6e6d52e763e4f18959b2f", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/313ab5041592b23204f6e6d52e763e4f18959b2f", "committedDate": "2020-10-07T22:28:16Z", "message": "Remove broken test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "717fce23472959c2335a7a8e8f9a8a2c0c55865d", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/717fce23472959c2335a7a8e8f9a8a2c0c55865d", "committedDate": "2020-10-08T01:56:05Z", "message": "remove mock"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38d18ffd2863eaf054dd3f24b3f667cb08550a29", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/38d18ffd2863eaf054dd3f24b3f667cb08550a29", "committedDate": "2020-10-08T01:50:50Z", "message": "remove mock"}, "afterCommit": {"oid": "02fbb6e3f044c0a5d7eaf2659f101f1db4ea9174", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/02fbb6e3f044c0a5d7eaf2659f101f1db4ea9174", "committedDate": "2020-10-08T01:56:14Z", "message": "remove mock"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02fbb6e3f044c0a5d7eaf2659f101f1db4ea9174", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/02fbb6e3f044c0a5d7eaf2659f101f1db4ea9174", "committedDate": "2020-10-08T01:56:14Z", "message": "remove mock"}, "afterCommit": {"oid": "d8a089c38413697d050c9b1ca26a3ad8cf806deb", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/d8a089c38413697d050c9b1ca26a3ad8cf806deb", "committedDate": "2020-10-08T02:09:11Z", "message": "remove mock"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8a089c38413697d050c9b1ca26a3ad8cf806deb", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/d8a089c38413697d050c9b1ca26a3ad8cf806deb", "committedDate": "2020-10-08T02:09:11Z", "message": "remove mock"}, "afterCommit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/df4df63ef15cbc7b97086d54bcc6eca5d25a37df", "committedDate": "2020-10-08T02:35:44Z", "message": "remove mock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDA1NTg0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504405584", "createdAt": "2020-10-08T03:33:14Z", "commit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwMzozMzoxNFrOHeMwwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwMzo0NTo1NVrOHeM8oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQyODQxNw==", "bodyText": "Where is the IOException thrown from? Is it retryable?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#discussion_r501428417", "createdAt": "2020-10-08T03:33:14Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/greengrass/deployment/DefaultDeploymentTask.java", "diffHunk": "@@ -126,7 +126,7 @@ public DeploymentResult call()\n             // or deployment merge step and landed here\n             handleCancellation(preparePackagesFuture, deploymentMergeFuture);\n             return null;\n-        } catch (PackagingException e) {\n+        } catch (IOException | PackagingException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQzMDczMA==", "bodyText": "Would it be better also moving the path name of the sub-paths into this class? This method gives me the impression that we can init the workPath and configPath under different root directories.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#discussion_r501430730", "createdAt": "2020-10-08T03:42:56Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/greengrass/util/NucleusPaths.java", "diffHunk": "@@ -0,0 +1,153 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.aws.greengrass.util;\n+\n+import com.aws.greengrass.componentmanager.models.ComponentIdentifier;\n+\n+import java.io.IOException;\n+import java.nio.file.Path;\n+\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACTS_DECOMPRESSED_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACT_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.RECIPE_DIRECTORY;\n+\n+@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n+public class NucleusPaths {\n+    private Path rootPath;\n+    private Path workPath;\n+    private Path componentStorePath;\n+    private Path configPath;\n+    private Path deploymentPath;\n+    private Path kernelAltsPath;\n+\n+    public void initPaths(Path root, Path workPath, Path componentStorePath, Path configPath, Path kernelAlts,\n+                          Path deployment) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTQzMTQ1Nw==", "bodyText": "All these set***Path methods look like duplicates. Would one method setPath(Path path, Permission permission) be sufficient?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#discussion_r501431457", "createdAt": "2020-10-08T03:45:55Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/greengrass/util/NucleusPaths.java", "diffHunk": "@@ -0,0 +1,153 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.aws.greengrass.util;\n+\n+import com.aws.greengrass.componentmanager.models.ComponentIdentifier;\n+\n+import java.io.IOException;\n+import java.nio.file.Path;\n+\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACTS_DECOMPRESSED_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.ARTIFACT_DIRECTORY;\n+import static com.aws.greengrass.componentmanager.ComponentStore.RECIPE_DIRECTORY;\n+\n+@SuppressWarnings(\"checkstyle:MissingJavadocMethod\")\n+public class NucleusPaths {\n+    private Path rootPath;\n+    private Path workPath;\n+    private Path componentStorePath;\n+    private Path configPath;\n+    private Path deploymentPath;\n+    private Path kernelAltsPath;\n+\n+    public void initPaths(Path root, Path workPath, Path componentStorePath, Path configPath, Path kernelAlts,\n+                          Path deployment) throws IOException {\n+        setRootPath(root);\n+        setConfigPath(configPath);\n+        setDeploymentPath(deployment);\n+        setKernelAltsPath(kernelAlts);\n+        setWorkPath(workPath);\n+        setComponentStorePath(componentStorePath);\n+    }\n+\n+    public void setKernelAltsPath(Path kernelAltsPath) throws IOException {\n+        this.kernelAltsPath = kernelAltsPath;\n+        Utils.createPaths(kernelAltsPath());\n+        Permissions.setKernelAltsPermission(kernelAltsPath());\n+    }\n+\n+    public Path kernelAltsPath() {\n+        return kernelAltsPath;\n+    }\n+\n+    public void setDeploymentPath(Path deploymentPath) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDEzMzc3", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504413377", "createdAt": "2020-10-08T04:02:14Z", "commit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df4df63ef15cbc7b97086d54bcc6eca5d25a37df", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/df4df63ef15cbc7b97086d54bcc6eca5d25a37df", "committedDate": "2020-10-08T02:35:44Z", "message": "remove mock"}, "afterCommit": {"oid": "603b62e2ecfbbb738559a6951d9bdc8265d59f9f", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/603b62e2ecfbbb738559a6951d9bdc8265d59f9f", "committedDate": "2020-10-08T04:02:38Z", "message": "remove mock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDEzODU4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504413858", "createdAt": "2020-10-08T04:04:01Z", "commit": {"oid": "603b62e2ecfbbb738559a6951d9bdc8265d59f9f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "603b62e2ecfbbb738559a6951d9bdc8265d59f9f", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/603b62e2ecfbbb738559a6951d9bdc8265d59f9f", "committedDate": "2020-10-08T04:02:38Z", "message": "remove mock"}, "afterCommit": {"oid": "87a5b32e7ef7be07f6c8b01e184caa544f31344c", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/87a5b32e7ef7be07f6c8b01e184caa544f31344c", "committedDate": "2020-10-08T04:18:11Z", "message": "remove mock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fecf78673801c7af7ad3788867d65c5d3393468", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6fecf78673801c7af7ad3788867d65c5d3393468", "committedDate": "2020-10-08T04:55:58Z", "message": "remove mock"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "87a5b32e7ef7be07f6c8b01e184caa544f31344c", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/87a5b32e7ef7be07f6c8b01e184caa544f31344c", "committedDate": "2020-10-08T04:18:11Z", "message": "remove mock"}, "afterCommit": {"oid": "6fecf78673801c7af7ad3788867d65c5d3393468", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6fecf78673801c7af7ad3788867d65c5d3393468", "committedDate": "2020-10-08T04:55:58Z", "message": "remove mock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDUzNzc0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504453774", "createdAt": "2020-10-08T06:09:52Z", "commit": {"oid": "6fecf78673801c7af7ad3788867d65c5d3393468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0ODc4NzU3", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/506#pullrequestreview-504878757", "createdAt": "2020-10-08T15:01:00Z", "commit": {"oid": "6fecf78673801c7af7ad3788867d65c5d3393468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3090, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}