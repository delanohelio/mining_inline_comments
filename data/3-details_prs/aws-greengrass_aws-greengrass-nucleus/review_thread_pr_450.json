{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5MTA3MTAy", "number": 450, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo1MDowMFrOEk1tyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOToyODoxOFrOElF0Dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MDY0MjY0OnYy", "diffSide": "RIGHT", "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCCliTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo1MDowMFrOHUAQKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo1MDowMFrOHUAQKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczNzcwNw==", "bodyText": "ordering is highly suspect to me.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r490737707", "createdAt": "2020-09-18T06:50:00Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCCliTest.java", "diffHunk": "@@ -84,6 +92,7 @@\n import static org.junit.jupiter.api.Assertions.fail;\n \n @ExtendWith(EGExtension.class)\n+@TestMethodOrder(MethodOrderer.OrderAnnotation.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dd65be2138e94666f4f72b9f17af86c3218d318"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MDY0NTg5OnYy", "diffSide": "RIGHT", "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCServicesTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNjo1MToxNlrOHUASDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNzozMzoyOVrOHUWALg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczODE4OQ==", "bodyText": "set the root dir in the beforeall now. Otherwise it will use ~/.evergreen.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r490738189", "createdAt": "2020-09-18T06:51:16Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCServicesTest.java", "diffHunk": "@@ -60,23 +62,31 @@\n     @TempDir\n     static Path tempRootDir;\n \n-    private Kernel kernel;\n+    private static Kernel kernel;\n     private IPCClient client;\n \n+    @BeforeAll\n+    static void beforeAll() throws InterruptedException {\n+        kernel = prepareKernelFromConfigFile(\"ipc.yaml\", IPCServicesTest.class, TEST_SERVICE_NAME);\n+    }\n+\n+    @AfterAll\n+    static void afterAll() {\n+        kernel.shutdown();\n+    }\n+\n     @BeforeEach\n-    void beforeEach(ExtensionContext context) throws InterruptedException, IOException {\n+    void beforeEach(ExtensionContext context) throws InterruptedException {\n         System.setProperty(\"root\", tempRootDir.toAbsolutePath().toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dd65be2138e94666f4f72b9f17af86c3218d318"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA5NDA2Mg==", "bodyText": "updated", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491094062", "createdAt": "2020-09-18T17:33:29Z", "author": {"login": "fahadmohammed01"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCServicesTest.java", "diffHunk": "@@ -60,23 +62,31 @@\n     @TempDir\n     static Path tempRootDir;\n \n-    private Kernel kernel;\n+    private static Kernel kernel;\n     private IPCClient client;\n \n+    @BeforeAll\n+    static void beforeAll() throws InterruptedException {\n+        kernel = prepareKernelFromConfigFile(\"ipc.yaml\", IPCServicesTest.class, TEST_SERVICE_NAME);\n+    }\n+\n+    @AfterAll\n+    static void afterAll() {\n+        kernel.shutdown();\n+    }\n+\n     @BeforeEach\n-    void beforeEach(ExtensionContext context) throws InterruptedException, IOException {\n+    void beforeEach(ExtensionContext context) throws InterruptedException {\n         System.setProperty(\"root\", tempRootDir.toAbsolutePath().toString());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczODE4OQ=="}, "originalCommit": {"oid": "7dd65be2138e94666f4f72b9f17af86c3218d318"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjkyMTMwOnYy", "diffSide": "RIGHT", "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCCliTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNzozMDozNVrOHUV6xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxODo1MDoxOVrOHUYUcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA5MjY3Nw==", "bodyText": "nit: why not change LOCAL_DEPLOYMENT_TIMEOUT_MINUTES and SERVICE_STATE_CHECK_TIMEOUT_MINUTES to 15?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491092677", "createdAt": "2020-09-18T17:30:35Z", "author": {"login": "hui-yang"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCCliTest.java", "diffHunk": "@@ -336,8 +337,8 @@ public void GIVEN_kernel_running_WHEN_change_configuration_and_deployment_THEN_k\n         String deploymentId1 = deploymentResponse.getDeploymentId();\n         CountDownLatch deploymentLatch = waitForDeploymentToBeSuccessful(deploymentId1);\n \n-        assertTrue(deploymentLatch.await(LOCAL_DEPLOYMENT_TIMEOUT_MINUTES, TimeUnit.MINUTES));\n-        assertTrue(serviceLatch.await(SERVICE_STATE_CHECK_TIMEOUT_MINUTES, TimeUnit.MINUTES));\n+        assertTrue(deploymentLatch.await(15, TimeUnit.SECONDS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67465fe9d9043fffcce9858168915cbc2e3c011a"}, "originalPosition": 227}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTEzMjAxNg==", "bodyText": "updated", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491132016", "createdAt": "2020-09-18T18:50:19Z", "author": {"login": "fahadmohammed01"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCCliTest.java", "diffHunk": "@@ -336,8 +337,8 @@ public void GIVEN_kernel_running_WHEN_change_configuration_and_deployment_THEN_k\n         String deploymentId1 = deploymentResponse.getDeploymentId();\n         CountDownLatch deploymentLatch = waitForDeploymentToBeSuccessful(deploymentId1);\n \n-        assertTrue(deploymentLatch.await(LOCAL_DEPLOYMENT_TIMEOUT_MINUTES, TimeUnit.MINUTES));\n-        assertTrue(serviceLatch.await(SERVICE_STATE_CHECK_TIMEOUT_MINUTES, TimeUnit.MINUTES));\n+        assertTrue(deploymentLatch.await(15, TimeUnit.SECONDS));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA5MjY3Nw=="}, "originalCommit": {"oid": "67465fe9d9043fffcce9858168915cbc2e3c011a"}, "originalPosition": 227}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjkzMjgzOnYy", "diffSide": "LEFT", "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNzozNDoxMFrOHUWBqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxODo1MDoxM1rOHUYUTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA5NDQ0MQ==", "bodyText": "Does this test need to verify A restarts, based on the test name?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491094441", "createdAt": "2020-09-18T17:34:10Z", "author": {"login": "hui-yang"}, "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "diffHunk": "@@ -118,11 +116,5 @@ void GIVEN_service_WHEN_dependencies_change_THEN_service_restarts() {\n         assertEquals(aService.dependencies.size(), 3);\n         assertNull(aService.dependencies.get(dService));\n         assertNotNull(aService.dependencies.get(eService));\n-\n-        aService.getState();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67465fe9d9043fffcce9858168915cbc2e3c011a"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTEzMTk4MA==", "bodyText": "renamed the test", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491131980", "createdAt": "2020-09-18T18:50:13Z", "author": {"login": "fahadmohammed01"}, "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "diffHunk": "@@ -118,11 +116,5 @@ void GIVEN_service_WHEN_dependencies_change_THEN_service_restarts() {\n         assertEquals(aService.dependencies.size(), 3);\n         assertNull(aService.dependencies.get(dService));\n         assertNotNull(aService.dependencies.get(eService));\n-\n-        aService.getState();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA5NDQ0MQ=="}, "originalCommit": {"oid": "67465fe9d9043fffcce9858168915cbc2e3c011a"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzI4MDE0OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOToyODoxOFrOHUZYPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOTo0MjozOVrOHUZwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE0OTM3NA==", "bodyText": "Should the name be ...THEN_service_updates()?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491149374", "createdAt": "2020-09-18T19:28:18Z", "author": {"login": "shaguptashaikh"}, "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "diffHunk": "@@ -104,10 +102,10 @@ void GIVEN_a_config_WHEN_constructor_is_called_THEN_service_is_initialized() {\n     }\n \n     @Test\n-    void GIVEN_service_WHEN_dependencies_change_THEN_service_restarts() {\n+    void GIVEN_service_WHEN_dependencies_change_THEN_service_dependencies_updates() {\n         //GIVEN service A with dependencies B,C,D", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eeb76b873a16f2ecc181d56f0f1f1b5f1cee083b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE1NDgwNA==", "bodyText": "The test only verifies the dependencies, since kernel and lifecycle are not running nothing else updates.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491154804", "createdAt": "2020-09-18T19:40:55Z", "author": {"login": "fahadmohammed01"}, "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "diffHunk": "@@ -104,10 +102,10 @@ void GIVEN_a_config_WHEN_constructor_is_called_THEN_service_is_initialized() {\n     }\n \n     @Test\n-    void GIVEN_service_WHEN_dependencies_change_THEN_service_restarts() {\n+    void GIVEN_service_WHEN_dependencies_change_THEN_service_dependencies_updates() {\n         //GIVEN service A with dependencies B,C,D", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE0OTM3NA=="}, "originalCommit": {"oid": "eeb76b873a16f2ecc181d56f0f1f1b5f1cee083b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE1NTUwOA==", "bodyText": "okay, but nit- there's typo in the name still", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/450#discussion_r491155508", "createdAt": "2020-09-18T19:42:39Z", "author": {"login": "shaguptashaikh"}, "path": "src/test/java/com/aws/iot/evergreen/kernel/EvergreenServiceTest.java", "diffHunk": "@@ -104,10 +102,10 @@ void GIVEN_a_config_WHEN_constructor_is_called_THEN_service_is_initialized() {\n     }\n \n     @Test\n-    void GIVEN_service_WHEN_dependencies_change_THEN_service_restarts() {\n+    void GIVEN_service_WHEN_dependencies_change_THEN_service_dependencies_updates() {\n         //GIVEN service A with dependencies B,C,D", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE0OTM3NA=="}, "originalCommit": {"oid": "eeb76b873a16f2ecc181d56f0f1f1b5f1cee083b"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 521, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}