{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMTY5ODE3", "number": 692, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoxMDo0OFrOE6vwNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoyMDowMFrOE6wAUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMDM1MjU1OnYy", "diffSide": "LEFT", "path": "src/integrationtests/java/com/aws/greengrass/integrationtests/deployment/DeploymentConfigMergingTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoxMDo0OFrOH2AKtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMToxOToyOFrOH2Clag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4Nzg5NQ==", "bodyText": "yay!, Can we totally remove jackson-jr?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526387895", "createdAt": "2020-11-18T20:10:48Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/greengrass/integrationtests/deployment/DeploymentConfigMergingTest.java", "diffHunk": "@@ -34,8 +35,6 @@\n import com.aws.greengrass.testcommons.testutilities.NoOpPathOwnershipHandler;\n import com.aws.greengrass.testcommons.testutilities.TestUtils;\n import com.aws.greengrass.util.Coerce;\n-import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyNjc0Mw==", "bodyText": "I'm afraid not. At least AFAIK Configuration.java is using it", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526426743", "createdAt": "2020-11-18T21:18:01Z", "author": {"login": "ShirleyZheng92"}, "path": "src/integrationtests/java/com/aws/greengrass/integrationtests/deployment/DeploymentConfigMergingTest.java", "diffHunk": "@@ -34,8 +35,6 @@\n import com.aws.greengrass.testcommons.testutilities.NoOpPathOwnershipHandler;\n import com.aws.greengrass.testcommons.testutilities.TestUtils;\n import com.aws.greengrass.util.Coerce;\n-import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4Nzg5NQ=="}, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyNzQ5OA==", "bodyText": "It might be, but it doesn't need to be.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526427498", "createdAt": "2020-11-18T21:19:28Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/java/com/aws/greengrass/integrationtests/deployment/DeploymentConfigMergingTest.java", "diffHunk": "@@ -34,8 +35,6 @@\n import com.aws.greengrass.testcommons.testutilities.NoOpPathOwnershipHandler;\n import com.aws.greengrass.testcommons.testutilities.TestUtils;\n import com.aws.greengrass.util.Coerce;\n-import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4Nzg5NQ=="}, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMDM2OTA5OnYy", "diffSide": "LEFT", "path": "src/integrationtests/resources/com/aws/greengrass/integrationtests/lifecyclemanager/kernel_restart_new_config.yaml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoxNTozNFrOH2AVFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMToyNzoyM1rOH2C2eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5MDU1MQ==", "bodyText": "fairly sure that your change will fail on windows because of the way that echo works with quotes in cmd compared to powershell.\nBut I guess we can fix it when we build for windows again", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526390551", "createdAt": "2020-11-18T20:15:34Z", "author": {"login": "MikeDombo"}, "path": "src/integrationtests/resources/com/aws/greengrass/integrationtests/lifecyclemanager/kernel_restart_new_config.yaml", "diffHunk": "@@ -11,14 +11,10 @@ services:\n \n   service_3:\n     lifecycle:\n-      run:\n-        posix: echo \"service_3\"\n-        windows: powershell -command echo \"service_3\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQzMTg2Ng==", "bodyText": "this change also deletes echo for posix too - I'm assuming the echo is not needed.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526431866", "createdAt": "2020-11-18T21:27:23Z", "author": {"login": "JamieHunter"}, "path": "src/integrationtests/resources/com/aws/greengrass/integrationtests/lifecyclemanager/kernel_restart_new_config.yaml", "diffHunk": "@@ -11,14 +11,10 @@ services:\n \n   service_3:\n     lifecycle:\n-      run:\n-        posix: echo \"service_3\"\n-        windows: powershell -command echo \"service_3\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5MDU1MQ=="}, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMDM5MTQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/util/platforms/Platform.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoxOTozMFrOH2AktQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoxOTozMFrOH2AktQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5NDU0OQ==", "bodyText": "just use getName not canonical", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526394549", "createdAt": "2020-11-18T20:19:30Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/util/platforms/Platform.java", "diffHunk": "@@ -35,17 +49,19 @@ public static synchronized Platform getInstance() {\n         if (INSTANCE != null) {\n             return INSTANCE;\n         }\n-        if (Exec.isWindows) {\n+\n+        if (PlatformResolver.isWindows) {\n             INSTANCE = new WindowsPlatform();\n-        } else if (PlatformResolver.RANKS.get().containsKey(\"qnx\")) {\n+        } else if (UNIX_SYS_VER.contains(\"qnx\")) {\n             INSTANCE = new QNXPlatform();\n-        } else if (PlatformResolver.RANKS.get().containsKey(\"macos\") || PlatformResolver.RANKS.get()\n-                .containsKey(\"darwin\")) {\n+        } else if (UNIX_SYS_VER.contains(\"darwin\") || UNIX_SYS_VER.contains(\"macos\")) {\n             INSTANCE = new DarwinPlatform();\n         } else {\n             INSTANCE = new UnixPlatform();\n         }\n \n+        logger.atInfo().log(\"Getting platform instance {}.\", INSTANCE.getClass().getCanonicalName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMDM5Mzc3OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/aws/greengrass/componentmanager/ComponentStoreTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoyMDowMFrOH2AmEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDoyMDowMFrOH2AmEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5NDg5Nw==", "bodyText": "use hamcrest assertthat contains", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/692#discussion_r526394897", "createdAt": "2020-11-18T20:20:00Z", "author": {"login": "MikeDombo"}, "path": "src/test/java/com/aws/greengrass/componentmanager/ComponentStoreTest.java", "diffHunk": "@@ -214,8 +214,11 @@ void GIVEN_an_invalid_recipe_exists_WHEN_findPackageRecipe_THEN_loading_exceptio\n \n         // WHEN\n         // THEN\n-        assertThrows(PackageLoadingException.class,\n-                () -> componentStore.findPackageRecipe(new ComponentIdentifier(\"InvalidRecipe\", new Semver(\"1.0.0\"))));\n+        PackageLoadingException pe = assertThrows(PackageLoadingException.class,\n+                () -> componentStore.findPackageRecipe(\n+                        new ComponentIdentifier(\"InvalidRecipe\", new Semver(\"1.0.0\"))));\n+        assertTrue(pe.getMessage().contains(\"Failed to parse recipe file content to contract model\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b84f4bd48076fe4a13d72194f3a6417f81a53cb0"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 256, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}