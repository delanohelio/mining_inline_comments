{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2OTQzMTE4", "number": 436, "title": "Fix kernel update workflow", "bodyText": "Issue #, if available:\nDescription of changes:\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-09-14T23:28:32Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436", "merged": true, "mergeCommit": {"oid": "9342ab0161e3484e12fcb49bf472275ca5f51dc4"}, "closed": true, "closedAt": "2020-09-15T21:34:56Z", "author": {"login": "hui-yang"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI70Y1gFqTQ4ODIyMjg5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJOwImAFqTQ4OTEyMTk4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MjIyODk1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#pullrequestreview-488222895", "createdAt": "2020-09-14T23:30:14Z", "commit": {"oid": "9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzozMDoxNFrOHRrFWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzozMDoxNFrOHRrFWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI5MzcyMQ==", "bodyText": "why? We shouldn't be using this as unzip isn't available by default on most systems", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#discussion_r488293721", "createdAt": "2020-09-14T23:30:14Z", "author": {"login": "MikeDombo"}, "path": "GreengrassCore-2.0.0.yaml", "diffHunk": "@@ -13,39 +13,39 @@ Manifests:\n         value: -Xms512m -Xmx512m\n         type: STRING\n     Artifacts:\n-      # TODO: set correct URI\n+      # TODO: set correct URI. Use builtin unpack functionality with permission preserved\n       - URI: S3:GreengrassCore-2.0.0.zip\n-        Unarchive: zip\n     Lifecycle:\n       bootstrap:\n           script: |-\n             set -eu\n             KERNEL_ROOT=\"{{kernel:rootPath}}\"\n-            UNPACK_DIR=\"{{artifacts:decompressedPath}}\"\n+            UNPACK_DIR=\"{{artifacts:decompressedPath}}/GreengrassCore-2.0.0\"\n+            unzip \"{{artifacts:path}}/custom.zip\" -d \"$UNPACK_DIR\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MjIzMTI3", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#pullrequestreview-488223127", "createdAt": "2020-09-14T23:30:51Z", "commit": {"oid": "9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzozMDo1MVrOHRrGFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzozMDo1MVrOHRrGFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI5MzkwOQ==", "bodyText": "what permission?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#discussion_r488293909", "createdAt": "2020-09-14T23:30:51Z", "author": {"login": "MikeDombo"}, "path": "GreengrassCore-2.0.0.yaml", "diffHunk": "@@ -13,39 +13,39 @@ Manifests:\n         value: -Xms512m -Xmx512m\n         type: STRING\n     Artifacts:\n-      # TODO: set correct URI\n+      # TODO: set correct URI. Use builtin unpack functionality with permission preserved\n       - URI: S3:GreengrassCore-2.0.0.zip\n-        Unarchive: zip\n     Lifecycle:\n       bootstrap:\n           script: |-\n             set -eu\n             KERNEL_ROOT=\"{{kernel:rootPath}}\"\n-            UNPACK_DIR=\"{{artifacts:decompressedPath}}\"\n+            UNPACK_DIR=\"{{artifacts:decompressedPath}}/GreengrassCore-2.0.0\"\n+            unzip \"{{artifacts:path}}/custom.zip\" -d \"$UNPACK_DIR\"\n \n-            rm -r \"$KERNEL_ROOT/alts/current/*\"\n+            rm -r \"$KERNEL_ROOT\"/alts/current/*\n \n             echo \"{{params:jvmOptions.value}}\" > \"$KERNEL_ROOT/alts/current/launch.params\"\n             ln -sf \"$UNPACK_DIR\" \"$KERNEL_ROOT/alts/current/distro\"\n             exit 100\n \n   - Platform:\n-      os: unbuntu\n+      os: ubuntu\n     Parameters:\n       - name: jvmOptions\n         # TODO: consider change to nested structure\n         value: -Xms512m -Xmx512m\n         type: STRING\n     Artifacts:\n-      # TODO: set correct URI\n+      # TODO: set correct URI. Use builtin unpack functionality with permission preserved", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a87f108262667e309a1f872b79ceef6cea5e73c", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/5a87f108262667e309a1f872b79ceef6cea5e73c", "committedDate": "2020-09-14T23:43:02Z", "message": "Fix kernel update workflow"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/9a374abd3f9bf712f53ec6e5b0887b2bb11f1c96", "committedDate": "2020-09-14T23:27:33Z", "message": "Fix kernel update workflow"}, "afterCommit": {"oid": "5a87f108262667e309a1f872b79ceef6cea5e73c", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/5a87f108262667e309a1f872b79ceef6cea5e73c", "committedDate": "2020-09-14T23:43:02Z", "message": "Fix kernel update workflow"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b13786f66b452f8493f5b3c01db80eee2f100a8", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/9b13786f66b452f8493f5b3c01db80eee2f100a8", "committedDate": "2020-09-15T00:34:58Z", "message": "Increase assertion timeout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26875c1312fd71c302ff9410c901e84e142e0cf1", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/26875c1312fd71c302ff9410c901e84e142e0cf1", "committedDate": "2020-09-15T01:20:30Z", "message": "Merge branch 'master' into ku-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36e0ee1cb7ad94427cfe635fe77c58674048747c", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/36e0ee1cb7ad94427cfe635fe77c58674048747c", "committedDate": "2020-09-15T20:18:50Z", "message": "Merge branch 'master' into ku-fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MDU3ODEx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#pullrequestreview-489057811", "createdAt": "2020-09-15T20:46:52Z", "commit": {"oid": "36e0ee1cb7ad94427cfe635fe77c58674048747c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MTIxOTgx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/436#pullrequestreview-489121981", "createdAt": "2020-09-15T21:33:48Z", "commit": {"oid": "36e0ee1cb7ad94427cfe635fe77c58674048747c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3304, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}