{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MjA2OTMx", "number": 443, "title": "Updating IPCUtils to wait for multiple services to run", "bodyText": "Issue #, if available:\nDescription of changes:\nUpdated the IPCCliTests to wait for both CLI Service and Test service to be running before each test.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-09-16T19:44:40Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443", "merged": true, "mergeCommit": {"oid": "eaeda257139f1a6d7904ffa23dfef5c3767dd5e2"}, "closed": true, "closedAt": "2020-09-17T02:17:09Z", "author": {"login": "abanthiy"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJh1MDgBqjM3NzQ4MDQ4MzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJlACegFqTQ5MDA4NDc2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6c0c03185dc1dc495128816d7ede1519493b1ad2", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6c0c03185dc1dc495128816d7ede1519493b1ad2", "committedDate": "2020-09-16T19:43:00Z", "message": "Updating IPCUtils to wait for multiple services to run"}, "afterCommit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2032ea8c66f055651ac19fffc83857c69a2789df", "committedDate": "2020-09-16T19:47:17Z", "message": "Updating IPCUtils to wait for multiple services to run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5OTcwMzM2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#pullrequestreview-489970336", "createdAt": "2020-09-16T19:49:36Z", "commit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDA4NDE1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#pullrequestreview-490008415", "createdAt": "2020-09-16T20:47:31Z", "commit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMDo0NzozMVrOHTDpAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQyMDo0NzozMVrOHTDpAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc0NDY0MQ==", "bodyText": "nit: break; afterwards?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#discussion_r489744641", "createdAt": "2020-09-16T20:47:31Z", "author": {"login": "hui-yang"}, "path": "src/integrationtests/java/com/aws/iot/evergreen/integrationtests/ipc/IPCTestUtils.java", "diffHunk": "@@ -38,15 +38,19 @@ public static KernelIPCClientConfig getIPCConfigForService(String serviceName, K\n                         .getOnce())).build();\n     }\n \n-    public static Kernel prepareKernelFromConfigFile(String configFile, String serviceName, Class testClass) throws InterruptedException {\n+    public static Kernel prepareKernelFromConfigFile(String configFile, Class testClass, String... serviceNames) throws InterruptedException {\n         Kernel kernel = new Kernel();\n         kernel.parseArgs(\"-i\", testClass.getResource(configFile).toString());\n \n         // ensure awaitIpcServiceLatch starts\n-        CountDownLatch awaitIpcServiceLatch = new CountDownLatch(1);\n+        CountDownLatch awaitIpcServiceLatch = new CountDownLatch(serviceNames.length);\n         kernel.getContext().addGlobalStateChangeListener((service, oldState, newState) -> {\n-            if (service.getName().equals(serviceName) && newState.equals(State.RUNNING)) {\n-                awaitIpcServiceLatch.countDown();\n+            if (serviceNames != null && serviceNames.length != 0) {\n+                for (String serviceName:serviceNames) {\n+                    if (service.getName().equals(serviceName) && newState.equals(State.RUNNING)) {\n+                        awaitIpcServiceLatch.countDown();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDQ4MTE0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#pullrequestreview-490048114", "createdAt": "2020-09-16T21:55:57Z", "commit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ff397158622cee010cd6631adbaa8a12a242216", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8ff397158622cee010cd6631adbaa8a12a242216", "committedDate": "2020-09-16T22:09:13Z", "message": "Updating IPCUtils to wait for multiple services to run. Updating IPCCliTests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2032ea8c66f055651ac19fffc83857c69a2789df", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2032ea8c66f055651ac19fffc83857c69a2789df", "committedDate": "2020-09-16T19:47:17Z", "message": "Updating IPCUtils to wait for multiple services to run"}, "afterCommit": {"oid": "8ff397158622cee010cd6631adbaa8a12a242216", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8ff397158622cee010cd6631adbaa8a12a242216", "committedDate": "2020-09-16T22:09:13Z", "message": "Updating IPCUtils to wait for multiple services to run. Updating IPCCliTests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDgwNzk2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#pullrequestreview-490080796", "createdAt": "2020-09-16T23:17:38Z", "commit": {"oid": "8ff397158622cee010cd6631adbaa8a12a242216"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDg0NzY2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/443#pullrequestreview-490084766", "createdAt": "2020-09-16T23:29:05Z", "commit": {"oid": "8ff397158622cee010cd6631adbaa8a12a242216"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2963, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}