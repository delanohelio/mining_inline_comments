{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2NjI3NTMw", "number": 404, "title": "Support local deployment's param version matching", "bodyText": "Issue #, if available:\nDescription of changes:\nAlso found a weird error/potential bug with Semver lib. I opened an issue vdurmont/semver4j#46 for them.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-08-31T23:15:03Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404", "merged": true, "mergeCommit": {"oid": "f975bd5346a071801ded9086454f05a00049270f"}, "closed": true, "closedAt": "2020-09-01T19:47:00Z", "author": {"login": "leaf94"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEbHrEgH2gAyNDc2NjI3NTMwOjFhMmRjMGE0NTE1ZjIwOWM2Nzc5ODk3MTA0YjE0MGMzOTI3Y2U5MmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdErpkJgH2gAyNDc2NjI3NTMwOmE0MTcwYjFkNTZkNTM3MmE2YzI5MWQzMjQzODE2ZTA4MDMwZWFlNTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1a2dc0a4515f209c6779897104b140c3927ce92e", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/1a2dc0a4515f209c6779897104b140c3927ce92e", "committedDate": "2020-08-31T23:08:45Z", "message": "Support local deployment's param version matching"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5MDMxMzEz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#pullrequestreview-479031313", "createdAt": "2020-08-31T23:16:26Z", "commit": {"oid": "1a2dc0a4515f209c6779897104b140c3927ce92e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e7ec30bc4258f43f6a4c4c1bc3c1b3ee47ce793", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6e7ec30bc4258f43f6a4c4c1bc3c1b3ee47ce793", "committedDate": "2020-08-31T23:16:48Z", "message": "style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5MDM0MTM4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#pullrequestreview-479034138", "createdAt": "2020-08-31T23:24:26Z", "commit": {"oid": "6e7ec30bc4258f43f6a4c4c1bc3c1b3ee47ce793"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMzoyNDoyN1rOHKNkaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQyMzoyNDoyN1rOHKNkaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ3MDEyMQ==", "bodyText": "Is findAny() still correct?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#discussion_r480470121", "createdAt": "2020-08-31T23:24:27Z", "author": {"login": "shaguptashaikh"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolver.java", "diffHunk": "@@ -295,8 +297,12 @@ private String lookupParameterValueForComponent(\n                                                                                             String packageName,\n                                                                                             String packageVersion) {\n         return document.getDeploymentPackageConfigurationList().stream()\n-                .filter(packageConfig -> packageName.equals(packageConfig.getPackageName()) && packageVersion\n-                        .equals(packageConfig.getResolvedVersion())).findAny();\n+                       .filter(packageConfig ->\n+                               packageName.equals(packageConfig.getPackageName())\n+                                       // TODO packageConfig.getResolvedVersion() should be strongly typed when created\n+                                       && Requirement.buildNPM(packageConfig.getResolvedVersion())\n+                                                     .isSatisfiedBy(new Semver(packageVersion, Semver.SemverType.NPM)))\n+                       .findAny();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e7ec30bc4258f43f6a4c4c1bc3c1b3ee47ce793"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "713e14f052d98bee1dcf66a07ca1ac310cfdb29a", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/713e14f052d98bee1dcf66a07ca1ac310cfdb29a", "committedDate": "2020-09-01T17:30:42Z", "message": "Fix test due to a potential semver bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e552aed9c745e0863142876c456939dce9df309c", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e552aed9c745e0863142876c456939dce9df309c", "committedDate": "2020-09-01T17:45:18Z", "message": "Get back tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTk0MDYz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#pullrequestreview-479994063", "createdAt": "2020-09-01T18:06:38Z", "commit": {"oid": "e552aed9c745e0863142876c456939dce9df309c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODowNjozOFrOHLCVXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxODowNjozOFrOHLCVXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMzNDYyMg==", "bodyText": "What if the customer isn't specifying requirements? What if it is just 1.2?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#discussion_r481334622", "createdAt": "2020-09-01T18:06:38Z", "author": {"login": "MikeDombo"}, "path": "src/test/java/com/aws/iot/evergreen/packagemanager/KernelConfigResolverTest.java", "diffHunk": "@@ -406,7 +406,7 @@ void GIVEN_deployment_with_artifact_WHEN_config_resolution_requested_THEN_artifa\n         }}, Collections.emptyList(), Collections.emptyMap(), null);\n \n         DeploymentPackageConfiguration rootPackageDeploymentConfig =\n-                new DeploymentPackageConfiguration(TEST_INPUT_PACKAGE_A, true, \"1.2\", Collections.emptyMap());\n+                new DeploymentPackageConfiguration(TEST_INPUT_PACKAGE_A, true, \"=1.2\", Collections.emptyMap());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e552aed9c745e0863142876c456939dce9df309c"}, "originalPosition": 88}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTk1MDIz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#pullrequestreview-479995023", "createdAt": "2020-09-01T18:07:59Z", "commit": {"oid": "e552aed9c745e0863142876c456939dce9df309c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5OTk3Mzcz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/404#pullrequestreview-479997373", "createdAt": "2020-09-01T18:11:22Z", "commit": {"oid": "e552aed9c745e0863142876c456939dce9df309c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4170b1d56d5372a6c291d3243816e08030eae50", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/a4170b1d56d5372a6c291d3243816e08030eae50", "committedDate": "2020-09-01T18:24:15Z", "message": "Merge branch 'master' into local_dev_param_version_match"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3234, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}