{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NjY1ODky", "number": 729, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDoxMjo0OFrOE9blPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDoxMjo0OFrOE9blPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyODUwNDkyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/deployment/DeploymentService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDoxMjo0OFrOH6HjmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDozMjoxMVrOH6H1Xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDcwMzI1Ng==", "bodyText": "Shouldn't this block be after line 299?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#discussion_r530703256", "createdAt": "2020-11-26T00:12:48Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentService.java", "diffHunk": "@@ -287,6 +288,14 @@ private void finishCurrentDeployment() throws InterruptedException {\n                             .persistAndPublishDeploymentStatus(currentDeploymentTaskMetadata.getDeploymentId(),\n                                                                currentDeploymentTaskMetadata.getDeploymentType(),\n                                                                JobStatus.SUCCEEDED.toString(), statusDetails);\n+\n+                    if (currentDeploymentTaskMetadata.getDeploymentTask() instanceof KernelUpdateDeploymentTask) {\n+                        try {\n+                            kernel.getContext().get(KernelAlternatives.class).activationSucceeds();\n+                        } catch (IOException e) {\n+                            logger.atError().log(\"Failed to reset Kernel activate directory\", e);\n+                        }\n+                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6343c3ec00905f3c3820d95b92c22e5f7bb765dc"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDcwNzgwNg==", "bodyText": "I don't think so. If anything breaks before ln294, we can still restart into kernel activate and the ongoing deployment artifacts are needed.\nFailing to clean up the ongoing deployment artifacts is not as critical. If we have to process the new deployment or the same deployment again for some reason, the ongoing deployment artifacts will be cleaned up then as well.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#discussion_r530707806", "createdAt": "2020-11-26T00:32:11Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentService.java", "diffHunk": "@@ -287,6 +288,14 @@ private void finishCurrentDeployment() throws InterruptedException {\n                             .persistAndPublishDeploymentStatus(currentDeploymentTaskMetadata.getDeploymentId(),\n                                                                currentDeploymentTaskMetadata.getDeploymentType(),\n                                                                JobStatus.SUCCEEDED.toString(), statusDetails);\n+\n+                    if (currentDeploymentTaskMetadata.getDeploymentTask() instanceof KernelUpdateDeploymentTask) {\n+                        try {\n+                            kernel.getContext().get(KernelAlternatives.class).activationSucceeds();\n+                        } catch (IOException e) {\n+                            logger.atError().log(\"Failed to reset Kernel activate directory\", e);\n+                        }\n+                    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDcwMzI1Ng=="}, "originalCommit": {"oid": "6343c3ec00905f3c3820d95b92c22e5f7bb765dc"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 311, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}