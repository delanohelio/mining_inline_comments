{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwMzY4NzQ5", "number": 414, "title": "Make S3 download fallback if TES credentials are null", "bodyText": "Issue #, if available:\nDescription of changes:\nIf TES can't get credentials, it may return null credentials, which we didn't handle nicely. Now it will throw a proper exception which we catch. This allows our S3 downloader to fallback to the local store if TES is not configured or is mis-configured.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-09-05T01:59:38Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414", "merged": true, "mergeCommit": {"oid": "901824998813e208574130e683036a73fa81397f"}, "closed": true, "closedAt": "2020-09-08T23:44:56Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFv8ebgH2gAyNDgwMzY4NzQ5OjZmMTQ4YjI1OGQwMmRhN2E1ZDlkOTI0YTdjNTliYjlkYTc2M2UyZGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHAbiZgH2gAyNDgwMzY4NzQ5OjU3YTM1ZDkyNjRkZTQ4YmEyMTMzMjcxYTNkOGZhODRlYTc2ZjQwODA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6f148b258d02da7a5d9d924a7c59bb9da763e2da", "committedDate": "2020-09-05T01:58:27Z", "message": "Make S3 download fallback if TES credentials are null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzQxMjEz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#pullrequestreview-484341213", "createdAt": "2020-09-08T17:14:11Z", "commit": {"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNzoxNDoxMVrOHOmqWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNzoxNDoxMVrOHOmqWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3NTU0Ng==", "bodyText": "Shouldn't resolve throw ideally?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#discussion_r485075546", "createdAt": "2020-09-08T17:14:11Z", "author": {"login": "prateek-y"}, "path": "src/main/java/com/aws/iot/evergreen/tes/LazyCredentialProvider.java", "diffHunk": "@@ -34,10 +34,15 @@ public LazyCredentialProvider(Kernel kernel) {\n     @Override\n     public AwsCredentials resolveCredentials() {\n         try {\n-            return ((TokenExchangeService) kernel.locate(TOKEN_EXCHANGE_SERVICE_TOPICS)).resolveCredentials();\n+            AwsCredentials creds =\n+                    ((TokenExchangeService) kernel.locate(TOKEN_EXCHANGE_SERVICE_TOPICS)).resolveCredentials();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0Mzg4NjU2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#pullrequestreview-484388656", "createdAt": "2020-09-08T18:22:41Z", "commit": {"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NTYzODAx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#pullrequestreview-484563801", "createdAt": "2020-09-08T23:40:14Z", "commit": {"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65e11bcc4af286ddc6f10f018d750b7e1bbfbcf9", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/65e11bcc4af286ddc6f10f018d750b7e1bbfbcf9", "committedDate": "2020-09-08T23:41:09Z", "message": "Merge branch 'master' into s3-cred-fallback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57a35d9264de48ba2133271a3d8fa84ea76f4080", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/57a35d9264de48ba2133271a3d8fa84ea76f4080", "committedDate": "2020-09-08T23:44:47Z", "message": "Merge branch 'master' into s3-cred-fallback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3258, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}