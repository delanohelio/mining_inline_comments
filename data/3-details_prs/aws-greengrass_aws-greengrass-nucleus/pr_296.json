{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzODAxNDkz", "number": 296, "title": "Updating readme for multiple group deployments support", "bodyText": "Issue #, if available:\nDescription of changes:\nUpdating the readme with multiple group deployments workflow\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-07-03T01:04:22Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296", "merged": true, "mergeCommit": {"oid": "21bf13594def50888609690b7f60885cc1dcb3ec"}, "closed": true, "closedAt": "2020-07-21T17:44:38Z", "author": {"login": "abanthiy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxIyY5gH2gAyNDQzODAxNDkzOjUyNmY0ZDI5NDU1ZTQyMzJlZGQ1OTMyNjE5NjgyYjg1ZWQ2NmM1ODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3JzcPgFqTQ1MjY4NDIzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584", "author": {"user": {"login": "abanthiy", "name": null}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/526f4d29455e4232edd5932619682b85ed66c584", "committedDate": "2020-07-03T01:02:39Z", "message": "Updating readme for multiple group deployments support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDk1NjMx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#pullrequestreview-442095631", "createdAt": "2020-07-03T01:20:20Z", "commit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MTI1NjYw", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#pullrequestreview-444125660", "createdAt": "2020-07-07T17:58:12Z", "commit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNzo1ODoxM1rOGuJofg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODowMDo0NFrOGuJueQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NTUwMg==", "bodyText": "nit: without", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451045502", "createdAt": "2020-07-07T17:58:13Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NTY4NA==", "bodyText": "nit: multiple", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451045684", "createdAt": "2020-07-07T17:58:33Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzAzMw==", "bodyText": "nit: \", \"", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451047033", "createdAt": "2020-07-07T18:00:44Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).\n+ 1. [***DeploymentService***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentService.java) maintains a \n+ mapping of groupName to the root components and their version constraints ,deployed as ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "584e4b6f881643040df86e12fd3dc72b263f99dd", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/584e4b6f881643040df86e12fd3dc72b263f99dd", "committedDate": "2020-07-16T07:21:36Z", "message": "Merge branch 'master' into deploymentDocumentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NTY5ODYy", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#pullrequestreview-449569862", "createdAt": "2020-07-16T07:22:21Z", "commit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzoyMjoyMVrOGydYHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzoyMjoyMVrOGydYHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU2MzI5Mg==", "bodyText": "bad link, I think, this is just going to the directory instead of the file", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r455563292", "createdAt": "2020-07-16T07:22:21Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).\n+ 1. [***DeploymentService***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentService.java) maintains a \n+ mapping of groupName to the root components and their version constraints ,deployed as \n+ part of that group.This \n+ mapping is stored in the DeploymentService's [***Configuration***](/src/main/java/com/aws/iot/evergreen/config/Configuration.java).\n+ 2. Upon receiving a new deployment from the *DeploymentsQueue*, when constructing the new configuration for the \n+ kernel, the [***DeploymentTask***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentTask.java) uses the \n+ saved mapping to calculate the set of root components. For the group that is being deployed, it takes the root \n+ components from the deployment document. For all other groups it takes the root components from the saved mapping.\n+ 3. [***DependencyResolver***](/src/main/java/com/aws/iot/evergreen/deployment/) uses the saved mapping to calculate ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "526f4d29455e4232edd5932619682b85ed66c584"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86f63375aaa8c7eccf17db5f498baeb1ccb8c313", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/86f63375aaa8c7eccf17db5f498baeb1ccb8c313", "committedDate": "2020-07-21T17:15:14Z", "message": "Update README.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6f1a5cc2f586c9cfb235f660e6bc60a806675e", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4c6f1a5cc2f586c9cfb235f660e6bc60a806675e", "committedDate": "2020-07-21T17:15:30Z", "message": "Merge branch 'master' into deploymentDocumentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNjY4NDg2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#pullrequestreview-452668486", "createdAt": "2020-07-21T17:15:58Z", "commit": {"oid": "4c6f1a5cc2f586c9cfb235f660e6bc60a806675e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNjg0MjM1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#pullrequestreview-452684235", "createdAt": "2020-07-21T17:37:15Z", "commit": {"oid": "4c6f1a5cc2f586c9cfb235f660e6bc60a806675e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2850, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}