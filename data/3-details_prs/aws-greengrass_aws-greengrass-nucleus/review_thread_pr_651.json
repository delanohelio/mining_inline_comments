{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NzQwMTc1", "number": 651, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDoyNDo0MlrOE3ZkEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1MjozNFrOE3aI8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTI1OTcwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/deployment/bootstrap/BootstrapManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDoyNDo0MlrOHwuR_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo0MDowOVrOHwuw_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1MTk2NA==", "bodyText": "use coerce to string instead of casting", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520851964", "createdAt": "2020-11-10T20:24:42Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/deployment/bootstrap/BootstrapManager.java", "diffHunk": "@@ -203,23 +203,24 @@ private boolean defaultRunWithChanged(Map<String, Object> newNucleusParameters,\n         Map<String, Object> currentValues = currentDeviceConfiguration.getRunWithTopic().toPOJO();\n \n         boolean changed = false;\n-        if (!Objects.equals(currentValues.get(RUN_WITH_DEFAULT_POSIX_USER),\n-                runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))) {\n+        if (Utils.stringHasChanged(Coerce.toString(currentValues.get(RUN_WITH_DEFAULT_POSIX_USER)),\n+                (String) runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))) {\n             logger.atInfo().kv(RUN_WITH_TOPIC + \".\" + RUN_WITH_DEFAULT_POSIX_USER,\n                     runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))\n                     .log(RESTART_REQUIRED_MESSAGE);\n             changed = true;\n         }\n-        if (!Objects.equals(currentValues.get(RUN_WITH_DEFAULT_POSIX_GROUP),\n-                runWithDefault.get(RUN_WITH_DEFAULT_POSIX_GROUP))) {\n+        if (Utils.stringHasChanged(Coerce.toString(currentValues.get(RUN_WITH_DEFAULT_POSIX_GROUP)),\n+                (String) runWithDefault.get(RUN_WITH_DEFAULT_POSIX_GROUP))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88a007ed4a06ab5544de8d19032283f79b9cee6e"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1OTkwMA==", "bodyText": "Updated", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520859900", "createdAt": "2020-11-10T20:40:09Z", "author": {"login": "tomnagy-aws"}, "path": "src/main/java/com/aws/greengrass/deployment/bootstrap/BootstrapManager.java", "diffHunk": "@@ -203,23 +203,24 @@ private boolean defaultRunWithChanged(Map<String, Object> newNucleusParameters,\n         Map<String, Object> currentValues = currentDeviceConfiguration.getRunWithTopic().toPOJO();\n \n         boolean changed = false;\n-        if (!Objects.equals(currentValues.get(RUN_WITH_DEFAULT_POSIX_USER),\n-                runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))) {\n+        if (Utils.stringHasChanged(Coerce.toString(currentValues.get(RUN_WITH_DEFAULT_POSIX_USER)),\n+                (String) runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))) {\n             logger.atInfo().kv(RUN_WITH_TOPIC + \".\" + RUN_WITH_DEFAULT_POSIX_USER,\n                     runWithDefault.get(RUN_WITH_DEFAULT_POSIX_USER))\n                     .log(RESTART_REQUIRED_MESSAGE);\n             changed = true;\n         }\n-        if (!Objects.equals(currentValues.get(RUN_WITH_DEFAULT_POSIX_GROUP),\n-                runWithDefault.get(RUN_WITH_DEFAULT_POSIX_GROUP))) {\n+        if (Utils.stringHasChanged(Coerce.toString(currentValues.get(RUN_WITH_DEFAULT_POSIX_GROUP)),\n+                (String) runWithDefault.get(RUN_WITH_DEFAULT_POSIX_GROUP))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1MTk2NA=="}, "originalCommit": {"oid": "88a007ed4a06ab5544de8d19032283f79b9cee6e"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTI2MTQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/util/Utils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDoyNToxNVrOHwuTCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo0MDoyNFrOHwuxrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1MjIzNQ==", "bodyText": "you could check that both are empty using Utils.isEmpty", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520852235", "createdAt": "2020-11-10T20:25:15Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,24 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }\n+        if (oldValue == null && \"\".equals(newValue)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88a007ed4a06ab5544de8d19032283f79b9cee6e"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2MDA3OQ==", "bodyText": "And updated \ud83d\udc4d", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520860079", "createdAt": "2020-11-10T20:40:24Z", "author": {"login": "tomnagy-aws"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,24 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }\n+        if (oldValue == null && \"\".equals(newValue)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg1MjIzNQ=="}, "originalCommit": {"oid": "88a007ed4a06ab5544de8d19032283f79b9cee6e"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTMyMjQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/util/Utils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo0MzowN1rOHwu3ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo0OTo1NVrOHwvFoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2MTYwMw==", "bodyText": "can't this all be simplified? Utils.isEmpty(oldValue) && Utils.isEmpty(newValue)", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520861603", "createdAt": "2020-11-10T20:43:07Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,24 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }\n+        if (oldValue == null && Utils.isEmpty(newValue)) {\n+            return false;\n+        }\n+        if (oldValue != null && Utils.isEmpty(oldValue) && newValue == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e143b7b220744a7428bd5f64ced2f1df9bc8cadf"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTE4NA==", "bodyText": "Yeah. Changed", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520865184", "createdAt": "2020-11-10T20:49:55Z", "author": {"login": "tomnagy-aws"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,24 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }\n+        if (oldValue == null && Utils.isEmpty(newValue)) {\n+            return false;\n+        }\n+        if (oldValue != null && Utils.isEmpty(oldValue) && newValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2MTYwMw=="}, "originalCommit": {"oid": "e143b7b220744a7428bd5f64ced2f1df9bc8cadf"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTM1MTQ2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/util/Utils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1MTo0OVrOHwvJlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1Nzo1M1rOHwvWHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NjE5OQ==", "bodyText": "this is also covered by L105", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520866199", "createdAt": "2020-11-10T20:51:49Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,21 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79901fed7dd33a71c1389842f50d3982a564a783"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2OTQwNg==", "bodyText": "For some reason I thought it was returning something different. Removed it.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520869406", "createdAt": "2020-11-10T20:57:53Z", "author": {"login": "tomnagy-aws"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -90,16 +90,21 @@ public static Throwable flush(Object flushable) {\n     }\n \n     /**\n-     * Returns true if the two strings are different, including null.\n+     * Returns true if the two strings are different, including <code>null</code>.\n+     *\n+     * <p>A change from <code>null</code> to <code>\"\"</code>, or vice versa, is not considered a change.</p>\n      *\n      * @param oldValue first string\n      * @param newValue second string\n-     * @return true if the two strings are not equal\n+     * @return true if the two strings are different\n      */\n     public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NjE5OQ=="}, "originalCommit": {"oid": "79901fed7dd33a71c1389842f50d3982a564a783"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTM1NDA4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/util/Utils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1MjozNFrOHwvLNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1ODowMVrOHwvWYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NjYxMw==", "bodyText": "this can go too", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520866613", "createdAt": "2020-11-10T20:52:34Z", "author": {"login": "rbattle"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -102,10 +102,7 @@ public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79901fed7dd33a71c1389842f50d3982a564a783"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2OTQ3NQ==", "bodyText": "Removed it", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/651#discussion_r520869475", "createdAt": "2020-11-10T20:58:01Z", "author": {"login": "tomnagy-aws"}, "path": "src/main/java/com/aws/greengrass/util/Utils.java", "diffHunk": "@@ -102,10 +102,7 @@ public static boolean stringHasChanged(String oldValue, String newValue) {\n         if (oldValue == null && newValue == null) {\n             return false;\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NjYxMw=="}, "originalCommit": {"oid": "79901fed7dd33a71c1389842f50d3982a564a783"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 202, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}