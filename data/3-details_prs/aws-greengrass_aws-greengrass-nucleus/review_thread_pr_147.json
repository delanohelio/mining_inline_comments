{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MTc0Mjc0", "number": 147, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo0NjoxOFrODtrivw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo1NjozN1rODtrxEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MjI1OTE5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo0NjoxOFrOF_P_ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjozMjo1OVrOF_VBLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2NjU5Nw==", "bodyText": "better than (String) topic.getOnce()...", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/147#discussion_r401866597", "createdAt": "2020-04-01T19:46:18Z", "author": {"login": "leaf94"}, "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "diffHunk": "@@ -161,12 +155,26 @@ public Kernel parseArgs(String... args) {\n                 case \"-print\":\n                     writeConfig(new OutputStreamWriter(System.out, StandardCharsets.UTF_8));\n                     break;\n+                case \"-root\":\n+                case \"-r\":\n+                    rootAbsolutePath = getArg();\n+                    break;\n                 default:\n                     logger.atError().log(\"Undefined command line argument: {}\", arg);\n                     broken = true;\n                     break;\n             }\n         }\n+        if (Utils.isEmpty(rootAbsolutePath)) {\n+            rootAbsolutePath = \"~/.evergreen\";  // Default to hidden subdirectory of home.\n+        }\n+        rootAbsolutePath = deTilde(rootAbsolutePath);\n+        if (!ensureCreated(Paths.get(rootAbsolutePath))) {\n+            logger.atError().log(\"{}: not a valid root directory\", rootAbsolutePath);\n+            broken = true;\n+        }\n+        lookup(\"system\", \"rootpath\").dflt(rootAbsolutePath)\n+                .subscribe((whatHappened, topic) -> initPaths(Coerce.toString(topic)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efe22d08b91fb77111aef6c3976127a0ced1cf22"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0ODk3Mw==", "bodyText": "Yes, Coerce.* methods generally cover more of the odd corner cases.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/147#discussion_r401948973", "createdAt": "2020-04-01T22:32:59Z", "author": {"login": "JamesGosling"}, "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "diffHunk": "@@ -161,12 +155,26 @@ public Kernel parseArgs(String... args) {\n                 case \"-print\":\n                     writeConfig(new OutputStreamWriter(System.out, StandardCharsets.UTF_8));\n                     break;\n+                case \"-root\":\n+                case \"-r\":\n+                    rootAbsolutePath = getArg();\n+                    break;\n                 default:\n                     logger.atError().log(\"Undefined command line argument: {}\", arg);\n                     broken = true;\n                     break;\n             }\n         }\n+        if (Utils.isEmpty(rootAbsolutePath)) {\n+            rootAbsolutePath = \"~/.evergreen\";  // Default to hidden subdirectory of home.\n+        }\n+        rootAbsolutePath = deTilde(rootAbsolutePath);\n+        if (!ensureCreated(Paths.get(rootAbsolutePath))) {\n+            logger.atError().log(\"{}: not a valid root directory\", rootAbsolutePath);\n+            broken = true;\n+        }\n+        lookup(\"system\", \"rootpath\").dflt(rootAbsolutePath)\n+                .subscribe((whatHappened, topic) -> initPaths(Coerce.toString(topic)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg2NjU5Nw=="}, "originalCommit": {"oid": "efe22d08b91fb77111aef6c3976127a0ced1cf22"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MjI5NTg0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxOTo1NjozN1rOF_QV_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMzowMDoxOFrOF_VoWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg3MjM4Mg==", "bodyText": "I guess new assignment of rootAbsolutePath  cannot be applied to the logging store for now, given how log4j initialized the file appender.\nBut we probably want to change that entirely and to re-instate the log queue, which would solve that from the source of evil (Sorry log4j...).", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/147#discussion_r401872382", "createdAt": "2020-04-01T19:56:37Z", "author": {"login": "leaf94"}, "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "diffHunk": "@@ -161,12 +155,26 @@ public Kernel parseArgs(String... args) {\n                 case \"-print\":\n                     writeConfig(new OutputStreamWriter(System.out, StandardCharsets.UTF_8));\n                     break;\n+                case \"-root\":\n+                case \"-r\":\n+                    rootAbsolutePath = getArg();\n+                    break;\n                 default:\n                     logger.atError().log(\"Undefined command line argument: {}\", arg);\n                     broken = true;\n                     break;\n             }\n         }\n+        if (Utils.isEmpty(rootAbsolutePath)) {\n+            rootAbsolutePath = \"~/.evergreen\";  // Default to hidden subdirectory of home.\n+        }\n+        rootAbsolutePath = deTilde(rootAbsolutePath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efe22d08b91fb77111aef6c3976127a0ced1cf22"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1OTAwMg==", "bodyText": "In time...", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/147#discussion_r401959002", "createdAt": "2020-04-01T23:00:18Z", "author": {"login": "JamesGosling"}, "path": "src/main/java/com/aws/iot/evergreen/kernel/Kernel.java", "diffHunk": "@@ -161,12 +155,26 @@ public Kernel parseArgs(String... args) {\n                 case \"-print\":\n                     writeConfig(new OutputStreamWriter(System.out, StandardCharsets.UTF_8));\n                     break;\n+                case \"-root\":\n+                case \"-r\":\n+                    rootAbsolutePath = getArg();\n+                    break;\n                 default:\n                     logger.atError().log(\"Undefined command line argument: {}\", arg);\n                     broken = true;\n                     break;\n             }\n         }\n+        if (Utils.isEmpty(rootAbsolutePath)) {\n+            rootAbsolutePath = \"~/.evergreen\";  // Default to hidden subdirectory of home.\n+        }\n+        rootAbsolutePath = deTilde(rootAbsolutePath);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg3MjM4Mg=="}, "originalCommit": {"oid": "efe22d08b91fb77111aef6c3976127a0ced1cf22"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4971, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}