{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNDk4NDI1", "number": 387, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTozNzo0NlrOEcQbjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMzozNzozOVrOEclCTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDY0NzgxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTozNzo0NlrOHGrJEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTozOToxMFrOHGrNjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc2MDMzNg==", "bodyText": "Why remove the tes credential hook?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/387#discussion_r476760336", "createdAt": "2020-08-25T21:37:46Z", "author": {"login": "shaguptashaikh"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "diffHunk": "@@ -103,10 +101,7 @@ public File downloadToPath(PackageIdentifier packageIdentifier, ComponentArtifac\n     private byte[] getObject(String bucket, String key, ComponentArtifact artifact, PackageIdentifier packageIdentifier)\n             throws PackageDownloadException {\n         try {\n-            TokenExchangeService tokenExchangeService = kernel.getContext().get(TokenExchangeService.class);\n-            GetObjectRequest getObjectRequest = GetObjectRequest.builder().overrideConfiguration(\n-                    AwsRequestOverrideConfiguration.builder().credentialsProvider(tokenExchangeService).build())\n-                    .bucket(bucket).key(key).build();\n+            GetObjectRequest getObjectRequest = GetObjectRequest.builder().bucket(bucket).key(key).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8760dfb82c08ee7b03617954f80273d5c921d818"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc2MTQ4NQ==", "bodyText": "It is already configured to use TES in the client factory", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/387#discussion_r476761485", "createdAt": "2020-08-25T21:39:10Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "diffHunk": "@@ -103,10 +101,7 @@ public File downloadToPath(PackageIdentifier packageIdentifier, ComponentArtifac\n     private byte[] getObject(String bucket, String key, ComponentArtifact artifact, PackageIdentifier packageIdentifier)\n             throws PackageDownloadException {\n         try {\n-            TokenExchangeService tokenExchangeService = kernel.getContext().get(TokenExchangeService.class);\n-            GetObjectRequest getObjectRequest = GetObjectRequest.builder().overrideConfiguration(\n-                    AwsRequestOverrideConfiguration.builder().credentialsProvider(tokenExchangeService).build())\n-                    .bucket(bucket).key(key).build();\n+            GetObjectRequest getObjectRequest = GetObjectRequest.builder().bucket(bucket).key(key).build();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc2MDMzNg=="}, "originalCommit": {"oid": "8760dfb82c08ee7b03617954f80273d5c921d818"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDY1OTU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/iot/evergreen/packagemanager/GreengrassPackageServiceClientFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTozOTo1N1rOHGrQYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTozOTo1N1rOHGrQYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc2MjIwOA==", "bodyText": "This is supposed to be temporary, GG will eventually be available in other regions, add a TODO for that? Or leave it the way it was and not test in other regions until GG becomes available so that we don't have to come back and change this again later", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/387#discussion_r476762208", "createdAt": "2020-08-25T21:39:57Z", "author": {"login": "shaguptashaikh"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/GreengrassPackageServiceClientFactory.java", "diffHunk": "@@ -40,7 +39,8 @@ public GreengrassPackageServiceClientFactory(\n             LazyCredentialProvider credentialsProvider) {\n         AWSEvergreenClientBuilder clientBuilder =\n                 AWSEvergreenClientBuilder.standard();\n-        String region = Coerce.toString(deviceConfiguration.getAWSRegion());\n+        // GG only exists in east\n+        String region = \"us-east-1\"; // Coerce.toString(deviceConfiguration.getAWSRegion());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8760dfb82c08ee7b03617954f80273d5c921d818"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NDAyMzgzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMzozNzozOVrOHHMeLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjowNzo1OVrOHHTS0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMwNjQxMw==", "bodyText": "Which resource is it complaining as not being closed? The getObjectsAsBytes? Can we try-resources that block?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/387#discussion_r477306413", "createdAt": "2020-08-26T13:37:39Z", "author": {"login": "philcali"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "diffHunk": "@@ -100,14 +98,18 @@ public File downloadToPath(PackageIdentifier packageIdentifier, ComponentArtifac\n         }\n     }\n \n+    @SuppressWarnings(\"PMD.CloseResource\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d206412f12a28acc3a8206307023af0d58aa5be"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQxODE5NA==", "bodyText": "No, it is the s3 client, which we shouldn't be closing.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/387#discussion_r477418194", "createdAt": "2020-08-26T16:07:59Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/iot/evergreen/packagemanager/plugins/S3Downloader.java", "diffHunk": "@@ -100,14 +98,18 @@ public File downloadToPath(PackageIdentifier packageIdentifier, ComponentArtifac\n         }\n     }\n \n+    @SuppressWarnings(\"PMD.CloseResource\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMwNjQxMw=="}, "originalCommit": {"oid": "5d206412f12a28acc3a8206307023af0d58aa5be"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 715, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}