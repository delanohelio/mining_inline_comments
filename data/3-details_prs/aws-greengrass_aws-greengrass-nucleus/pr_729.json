{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NjY1ODky", "number": 729, "title": "Report deployment status before flipping symlinks in kernel update", "bodyText": "Issue #, if available:\nDescription of changes:\n\nReport deployment status before flipping symlinks in kernel update\nInstead of passing configuration file from loader, Nucleus loads the correct config on launch\n\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-11-25T20:01:23Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729", "merged": true, "mergeCommit": {"oid": "9e7bd4a25fb5b7480cc3f0bacda1c57337d967a4"}, "closed": true, "closedAt": "2020-11-30T17:40:03Z", "author": {"login": "hui-yang"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgHlOAAFqTUzODkxNTU3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhoTSEAFqTU0MTEwMjExNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4OTE1NTc2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#pullrequestreview-538915576", "createdAt": "2020-11-26T00:12:47Z", "commit": {"oid": "6343c3ec00905f3c3820d95b92c22e5f7bb765dc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDoxMjo0OFrOH6HjmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwMDoxMjo0OFrOH6HjmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDcwMzI1Ng==", "bodyText": "Shouldn't this block be after line 299?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#discussion_r530703256", "createdAt": "2020-11-26T00:12:48Z", "author": {"login": "fengwang666"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentService.java", "diffHunk": "@@ -287,6 +288,14 @@ private void finishCurrentDeployment() throws InterruptedException {\n                             .persistAndPublishDeploymentStatus(currentDeploymentTaskMetadata.getDeploymentId(),\n                                                                currentDeploymentTaskMetadata.getDeploymentType(),\n                                                                JobStatus.SUCCEEDED.toString(), statusDetails);\n+\n+                    if (currentDeploymentTaskMetadata.getDeploymentTask() instanceof KernelUpdateDeploymentTask) {\n+                        try {\n+                            kernel.getContext().get(KernelAlternatives.class).activationSucceeds();\n+                        } catch (IOException e) {\n+                            logger.atError().log(\"Failed to reset Kernel activate directory\", e);\n+                        }\n+                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6343c3ec00905f3c3820d95b92c22e5f7bb765dc"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4OTMyMDQ4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#pullrequestreview-538932048", "createdAt": "2020-11-26T01:13:35Z", "commit": {"oid": "eecf8b816c61fd96f7caec9c626e75338fb37606"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MDE2MDgz", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#pullrequestreview-539016083", "createdAt": "2020-11-26T06:08:31Z", "commit": {"oid": "eecf8b816c61fd96f7caec9c626e75338fb37606"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eecf8b816c61fd96f7caec9c626e75338fb37606", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/eecf8b816c61fd96f7caec9c626e75338fb37606", "committedDate": "2020-11-26T01:08:16Z", "message": "Merge branch 'master' into P42006266"}, "afterCommit": {"oid": "712cd9c5c8bb696aac093a7cae9f1f74b3620be8", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/712cd9c5c8bb696aac093a7cae9f1f74b3620be8", "committedDate": "2020-11-27T17:53:17Z", "message": "Report deployment status before flipping symlinks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "465b94e5024c0b2a77d7a13c629ddd0460e1b79e", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/465b94e5024c0b2a77d7a13c629ddd0460e1b79e", "committedDate": "2020-11-27T22:04:53Z", "message": "Report deployment status before flipping symlinks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f9d0d937c755da4fb981467265e957c1538128cb", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f9d0d937c755da4fb981467265e957c1538128cb", "committedDate": "2020-11-27T19:57:06Z", "message": "Merge branch 'master' into P42006266"}, "afterCommit": {"oid": "8a0cd3c089a988736bb7e718fd363ebff7258581", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8a0cd3c089a988736bb7e718fd363ebff7258581", "committedDate": "2020-11-27T22:04:53Z", "message": "Figure out correct config file on launch"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a0cd3c089a988736bb7e718fd363ebff7258581", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/8a0cd3c089a988736bb7e718fd363ebff7258581", "committedDate": "2020-11-27T22:04:53Z", "message": "Figure out correct config file on launch"}, "afterCommit": {"oid": "be9e01e8ee847ff499df7bf719aab22382f2dd07", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/be9e01e8ee847ff499df7bf719aab22382f2dd07", "committedDate": "2020-11-27T22:28:56Z", "message": "Figure out correct config file on launch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be01073e1a6cae94367ab85d347735f872eb0d11", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/be01073e1a6cae94367ab85d347735f872eb0d11", "committedDate": "2020-11-27T23:27:07Z", "message": "Figure out correct config file on launch"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be9e01e8ee847ff499df7bf719aab22382f2dd07", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/be9e01e8ee847ff499df7bf719aab22382f2dd07", "committedDate": "2020-11-27T22:28:56Z", "message": "Figure out correct config file on launch"}, "afterCommit": {"oid": "be01073e1a6cae94367ab85d347735f872eb0d11", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/be01073e1a6cae94367ab85d347735f872eb0d11", "committedDate": "2020-11-27T23:27:07Z", "message": "Figure out correct config file on launch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdfe642a644df36985e8549c8a762045d498077b", "author": {"user": {"login": "hui-yang", "name": "Hui Yang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/fdfe642a644df36985e8549c8a762045d498077b", "committedDate": "2020-11-29T03:26:45Z", "message": "Merge branch 'master' into P42006266"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNDQ1NDU1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#pullrequestreview-540445455", "createdAt": "2020-11-29T04:05:18Z", "commit": {"oid": "fdfe642a644df36985e8549c8a762045d498077b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMTAyMTE1", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/729#pullrequestreview-541102115", "createdAt": "2020-11-30T16:54:00Z", "commit": {"oid": "fdfe642a644df36985e8549c8a762045d498077b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2757, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}