{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNDE1MTQ2", "number": 386, "title": "setup to consume common lib from codeartifact", "bodyText": "Issue #, if available:\nDescription of changes:\nconsume component common lib, which contains component recipe file model as well as platform matching logic, from AWS code artifact. In the other end, common lib source code which is in brazil publishes build artifacts into code artifact.\nWhy is this change necessary:\nOtherwise no common lib is shared between cloud and device.\nHow was this change tested:\nTested publish and consume in personal AWS account.\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-08-25T19:39:08Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386", "merged": true, "mergeCommit": {"oid": "276f257bac841961bb2b023142c11f6f7a437380"}, "closed": true, "closedAt": "2020-08-27T17:39:33Z", "author": {"login": "wikimonkey"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCats4AH2gAyNDczNDE1MTQ2OmY3YWE0MzExNThkZWEzODk0YjU0YThmZmY5NDU1MDEyZjc5MDc4ODg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDEAYtgFqTQ3Njk0MjY0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f7aa431158dea3894b54a8fff9455012f7907888", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f7aa431158dea3894b54a8fff9455012f7907888", "committedDate": "2020-08-25T17:32:32Z", "message": "setup to consume common lib from codeartifact"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35e7f510666b40a0a688a7c03817eb1e09426777", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/35e7f510666b40a0a688a7c03817eb1e09426777", "committedDate": "2020-08-25T20:22:27Z", "message": "acquire code-artifact token in github actions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "873d8a33384aa14341605d21271e495d790f56e6", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/873d8a33384aa14341605d21271e495d790f56e6", "committedDate": "2020-08-25T21:42:29Z", "message": "echo token"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecafa3825907a8b9875aa4f723201cd18a82e454", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/ecafa3825907a8b9875aa4f723201cd18a82e454", "committedDate": "2020-08-25T22:05:13Z", "message": "Revert \"echo token\"\n\nThis reverts commit 873d8a33384aa14341605d21271e495d790f56e6."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ca09833c935e264ebf2857091d4e342a7a891c", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/09ca09833c935e264ebf2857091d4e342a7a891c", "committedDate": "2020-08-25T22:07:17Z", "message": "echo token"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1944f3d9f81a449eb79e73cd7cd7a655d883c24", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/c1944f3d9f81a449eb79e73cd7cd7a655d883c24", "committedDate": "2020-08-25T22:14:14Z", "message": "add region in get coderartifact token command"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e68d75d325a95ccd9c654e7afb8695764f229ef", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/3e68d75d325a95ccd9c654e7afb8695764f229ef", "committedDate": "2020-08-25T22:44:52Z", "message": "debug github action on acquiring token"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4526414ea284a4a4d234e60657f5c90295188de8", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4526414ea284a4a4d234e60657f5c90295188de8", "committedDate": "2020-08-25T22:48:06Z", "message": "acquire token before running mvn build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68d8aea6b48e3623109b0495a2363d398ea07c95", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/68d8aea6b48e3623109b0495a2363d398ea07c95", "committedDate": "2020-08-25T22:51:00Z", "message": "echo token for debug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "968e4012d510a0103e410c4a713541137bcfaa59", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/968e4012d510a0103e410c4a713541137bcfaa59", "committedDate": "2020-08-25T23:21:31Z", "message": "use settings.xml in maven build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "647e2b4987f6f7c8400496576267e5744ffc33bd", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/647e2b4987f6f7c8400496576267e5744ffc33bd", "committedDate": "2020-08-25T23:31:55Z", "message": "Merge branch 'master' into consume_common_lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "980cd3d7aad4a98ea45bbf6beba504e640830b63", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/980cd3d7aad4a98ea45bbf6beba504e640830b63", "committedDate": "2020-08-26T06:12:13Z", "message": "Merge branch 'master' into consume_common_lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086", "committedDate": "2020-08-26T16:31:47Z", "message": "remove dependency, revert token acquire, try running unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NjcxMDM3", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#pullrequestreview-475671037", "createdAt": "2020-08-26T16:43:11Z", "commit": {"oid": "e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjo0MzoxMVrOHHUqtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjo0MzoxMVrOHHUqtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDY5Mw==", "bodyText": "this is the windows build. You need to make it work on windows and linux (L41)", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477440693", "createdAt": "2020-08-26T16:43:11Z", "author": {"login": "MikeDombo"}, "path": ".github/workflows/maven.yml", "diffHunk": "@@ -32,7 +32,9 @@ jobs:\n       - run: rm -rf /tmp/*\n         continue-on-error: true\n       - name: Build with Maven\n-        run: mvn -ntp -U clean verify\n+        run: |\n+          for /f %i in ('aws codeartifact get-authorization-token --domain evergreen --query authorizationToken --output text --region us-west-2') do set CODEARTIFACT_AUTH_TOKEN=%i", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1725e478c811435f1e631dcd36f5924127660da", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f1725e478c811435f1e631dcd36f5924127660da", "committedDate": "2020-08-26T21:31:45Z", "message": "validate windows cmd running multiple commands"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2d2b74a6b90e3ec2c49ec7855e347d2ad096378", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f2d2b74a6b90e3ec2c49ec7855e347d2ad096378", "committedDate": "2020-08-26T23:15:26Z", "message": "try with powershell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d149ec5ff9b5b38b52d909aa918cdb497b6c3d6", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4d149ec5ff9b5b38b52d909aa918cdb497b6c3d6", "committedDate": "2020-08-26T23:19:43Z", "message": "use powershell to run windows commands"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44fee2452814a6b96d6d12820d2110324467a42e", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/44fee2452814a6b96d6d12820d2110324467a42e", "committedDate": "2020-08-26T23:31:05Z", "message": "Merge branch 'master' into consume_common_lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ad7d83f4ad3012b56deaa0cccc6a044001dab02", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/5ad7d83f4ad3012b56deaa0cccc6a044001dab02", "committedDate": "2020-08-27T00:25:19Z", "message": "Merge branch 'master' into consume_common_lib"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MjU1MTk2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#pullrequestreview-476255196", "createdAt": "2020-08-27T00:53:39Z", "commit": {"oid": "5ad7d83f4ad3012b56deaa0cccc6a044001dab02"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwMDo1MzozOVrOHHrxKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwMDo1MzozOVrOHHrxKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzgxOTE3OA==", "bodyText": "Can we get cloud to publish into S3? This requires us to have tokens on all of our computers and every single build step across all our repositories (there are already more than 10).", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477819178", "createdAt": "2020-08-27T00:53:39Z", "author": {"login": "MikeDombo"}, "path": ".github/workflows/maven.yml", "diffHunk": "@@ -32,11 +32,15 @@ jobs:\n       - run: rm -rf /tmp/*\n         continue-on-error: true\n       - name: Build with Maven\n-        run: mvn -ntp -U clean verify\n-        shell: cmd\n+        run: |\n+          $CODEARTIFACT_TOKEN = aws codeartifact get-authorization-token --domain evergreen --query authorizationToken --output text --region us-west-2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ad7d83f4ad3012b56deaa0cccc6a044001dab02"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01d2d2ceb3ea6db0d84594791c0a5d7f801fb0a0", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/01d2d2ceb3ea6db0d84594791c0a5d7f801fb0a0", "committedDate": "2020-08-27T02:58:02Z", "message": "use existing s3->cloudfront path to consume component common lib"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99440014771decedfcb56fdf31c05e0745c45a65", "author": {"user": {"login": "wikimonkey", "name": "Jason Wang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/99440014771decedfcb56fdf31c05e0745c45a65", "committedDate": "2020-08-27T02:58:53Z", "message": "revert github action experimental changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a26c1ecd97bddb87267fd04d530dcb91e40671d", "author": {"user": {"login": "leaf94", "name": "Ethan Huang"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2a26c1ecd97bddb87267fd04d530dcb91e40671d", "committedDate": "2020-08-27T16:42:55Z", "message": "Merge branch 'master' into consume_common_lib"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2OTI3MTQx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#pullrequestreview-476927141", "createdAt": "2020-08-27T17:17:40Z", "commit": {"oid": "2a26c1ecd97bddb87267fd04d530dcb91e40671d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2OTQyNjQ0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#pullrequestreview-476942644", "createdAt": "2020-08-27T17:39:03Z", "commit": {"oid": "2a26c1ecd97bddb87267fd04d530dcb91e40671d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3197, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}