{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MzAwNDYy", "number": 394, "title": "Fix S3 region again", "bodyText": "Issue #, if available:\nDescription of changes:\nFixing S3 region again so that if it can get a region from the environment, it will do that, otherwise it will use the region that we give it.\nS3 doesn't work if we hardcode a region, but it can determine that it is in some region, so this workaround should fix that.\nWhy is this change necessary:\nHow was this change tested:\nAny additional information or context required to review the change:\nChecklist:\n\n Updated the README if applicable\n Updated or added new unit tests\n Updated or added new integration tests\n Updated or added new end-to-end tests\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-08-26T23:09:36Z", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394", "merged": true, "mergeCommit": {"oid": "8af6b3f3080a49b6e2548f40fd6de4bd2dccccd6"}, "closed": true, "closedAt": "2020-08-27T00:15:46Z", "author": {"login": "MikeDombo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC0J93AFqTQ3NjA1MTY3OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdC0bMZgFqTQ3NjEwNTY2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDUxNjc5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476051679", "createdAt": "2020-08-26T23:11:02Z", "commit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDYyMjc2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476062276", "createdAt": "2020-08-26T23:16:27Z", "commit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDYzMzgx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476063381", "createdAt": "2020-08-26T23:17:01Z", "commit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzoxNzowMVrOHHiALg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzoxNzowMVrOHHiALg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY1OTE4Mg==", "bodyText": "Should we log this?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#discussion_r477659182", "createdAt": "2020-08-26T23:17:01Z", "author": {"login": "philcali"}, "path": "src/main/java/com/aws/iot/evergreen/util/S3SdkClientFactory.java", "diffHunk": "@@ -25,14 +27,21 @@\n     /**\n      * Constructor.\n      *\n+     * @param deviceConfiguration device configuration\n      * @param credentialsProvider credential provider from TES\n      */\n     @Inject\n-    public S3SdkClientFactory(LazyCredentialProvider credentialsProvider) {\n+    public S3SdkClientFactory(DeviceConfiguration deviceConfiguration, LazyCredentialProvider credentialsProvider) {\n         this.credentialsProvider = credentialsProvider;\n+        Region region;\n+        try {\n+            region = new DefaultAwsRegionProviderChain().getRegion();\n+        } catch (RuntimeException ignored) {\n+            region = Region.of(Coerce.toString(deviceConfiguration.getAWSRegion()));\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDY1ODgx", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476065881", "createdAt": "2020-08-26T23:18:16Z", "commit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fe948c797ecb0c6161796d834ec708f971d2af9", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2fe948c797ecb0c6161796d834ec708f971d2af9", "committedDate": "2020-08-26T23:18:26Z", "message": "Fix S3 region again"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01e71dd0432c1411b5e3513e8c3fd9d50668c72d", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/01e71dd0432c1411b5e3513e8c3fd9d50668c72d", "committedDate": "2020-08-26T23:08:55Z", "message": "Fix S3 region again"}, "afterCommit": {"oid": "2fe948c797ecb0c6161796d834ec708f971d2af9", "author": {"user": {"login": "MikeDombo", "name": "Michael Dombrowski"}}, "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2fe948c797ecb0c6161796d834ec708f971d2af9", "committedDate": "2020-08-26T23:18:26Z", "message": "Fix S3 region again"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDkzNDQ4", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476093448", "createdAt": "2020-08-26T23:25:58Z", "commit": {"oid": "2fe948c797ecb0c6161796d834ec708f971d2af9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MTA1NjY5", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/394#pullrequestreview-476105669", "createdAt": "2020-08-26T23:29:51Z", "commit": {"oid": "2fe948c797ecb0c6161796d834ec708f971d2af9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3217, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}