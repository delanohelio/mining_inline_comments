{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMzU4MTk3", "number": 678, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1Nzo1MlrOE4gBSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1Nzo1MlrOE4gBSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3NjgwMzI5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/deployment/DeploymentStatusKeeper.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1Nzo1MlrOHydTkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMToyMDowNVrOHy_6_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDk5Mg==", "bodyText": "How are these snapshots used?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/678#discussion_r522670992", "createdAt": "2020-11-13T05:57:52Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentStatusKeeper.java", "diffHunk": "@@ -128,6 +139,12 @@ public void publishPersistedStatusUpdates(DeploymentType type) {\n                     break;\n                 }\n                 processedDeployments.remove(topics);\n+                try {\n+                    deploymentDirectoryManager.takeConfigSnapshot(deploymentDirectoryManager.getSnapshotFilePath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6670dba2c48a1705c2a3b8147eee145e3ea8d0ae"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjc1NjQyNw==", "bodyText": "This is being used to udpate the tlog, so that if cloud status update fails and device restarts, then device has the correct series of deployment status updates for the cloud.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/678#discussion_r522756427", "createdAt": "2020-11-13T07:57:33Z", "author": {"login": "abanthiy"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentStatusKeeper.java", "diffHunk": "@@ -128,6 +139,12 @@ public void publishPersistedStatusUpdates(DeploymentType type) {\n                     break;\n                 }\n                 processedDeployments.remove(topics);\n+                try {\n+                    deploymentDirectoryManager.takeConfigSnapshot(deploymentDirectoryManager.getSnapshotFilePath());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDk5Mg=="}, "originalCommit": {"oid": "6670dba2c48a1705c2a3b8147eee145e3ea8d0ae"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEyMTY3Mg==", "bodyText": "Is this trying to add deployment status updates to the rollback snapshot?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/678#discussion_r523121672", "createdAt": "2020-11-13T17:46:32Z", "author": {"login": "hui-yang"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentStatusKeeper.java", "diffHunk": "@@ -128,6 +139,12 @@ public void publishPersistedStatusUpdates(DeploymentType type) {\n                     break;\n                 }\n                 processedDeployments.remove(topics);\n+                try {\n+                    deploymentDirectoryManager.takeConfigSnapshot(deploymentDirectoryManager.getSnapshotFilePath());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDk5Mg=="}, "originalCommit": {"oid": "6670dba2c48a1705c2a3b8147eee145e3ea8d0ae"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzIzODE0MA==", "bodyText": "Yes, I believe same is used when device restarts", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/678#discussion_r523238140", "createdAt": "2020-11-13T21:20:05Z", "author": {"login": "abanthiy"}, "path": "src/main/java/com/aws/greengrass/deployment/DeploymentStatusKeeper.java", "diffHunk": "@@ -128,6 +139,12 @@ public void publishPersistedStatusUpdates(DeploymentType type) {\n                     break;\n                 }\n                 processedDeployments.remove(topics);\n+                try {\n+                    deploymentDirectoryManager.takeConfigSnapshot(deploymentDirectoryManager.getSnapshotFilePath());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDk5Mg=="}, "originalCommit": {"oid": "6670dba2c48a1705c2a3b8147eee145e3ea8d0ae"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 243, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}