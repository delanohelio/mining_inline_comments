{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MDcyNjYz", "number": 646, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMToyODo0NlrOE3BUeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMToyODo0NlrOE3BUeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MTI4NzYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/deployment/activator/DefaultActivator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMToyODo0NlrOHwIMIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQwMTo0NTozM1rOHwIgog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIyNzg3NQ==", "bodyText": "Is it worth logging that these services are already broken and that we are not going to track them for failed rollback?\nThe services to track are logged below, but it could be useful info to log as another kv there that there are services we are ignoring. If there's a ton of logs between the services breaking and the deployment it may not be obvious.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/646#discussion_r520227875", "createdAt": "2020-11-10T01:28:46Z", "author": {"login": "rbattle"}, "path": "src/main/java/com/aws/greengrass/deployment/activator/DefaultActivator.java", "diffHunk": "@@ -146,6 +146,10 @@ void rollback(DeploymentDocument deploymentDocument, CompletableFuture<Deploymen\n \n         try {\n             Set<GreengrassService> servicesToTrackForRollback = rollbackManager.servicesToTrack();\n+            // Don't track services if they were already broken before the rolled back deployment, because they'd\n+            // be expected to still be broken\n+            servicesToTrackForRollback.removeIf((s) ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a95b5212d56b173f372ad67acff3685263378e37"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIzMzEyMg==", "bodyText": "Added log to line below", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/646#discussion_r520233122", "createdAt": "2020-11-10T01:45:33Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/deployment/activator/DefaultActivator.java", "diffHunk": "@@ -146,6 +146,10 @@ void rollback(DeploymentDocument deploymentDocument, CompletableFuture<Deploymen\n \n         try {\n             Set<GreengrassService> servicesToTrackForRollback = rollbackManager.servicesToTrack();\n+            // Don't track services if they were already broken before the rolled back deployment, because they'd\n+            // be expected to still be broken\n+            servicesToTrackForRollback.removeIf((s) ->", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIyNzg3NQ=="}, "originalCommit": {"oid": "a95b5212d56b173f372ad67acff3685263378e37"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 194, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}