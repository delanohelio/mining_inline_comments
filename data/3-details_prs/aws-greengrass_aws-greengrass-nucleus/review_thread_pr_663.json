{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5NTM1NTE0", "number": 663, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMDozMDozOFrOE37qrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMDozMDozOFrOE37qrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3MDg0NzE2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMDozMDozOFrOHxkCvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwMDo1OTo1MlrOHxlFBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMjc5Ng==", "bodyText": "don't you need to check both the keypath and the valueToMerge map?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/663#discussion_r521732796", "createdAt": "2020-11-12T00:30:38Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "diffHunk": "@@ -312,23 +314,26 @@ private void validateRequest(UpdateConfigurationRequest request) {\n             if (request.getValueToMerge() == null) {\n                 throw new InvalidArgumentsError(\"ValueToMerge is required\");\n             }\n-\n+            String[] keyPath = new String[0];\n+            if (request.getKeyPath() != null) {\n+                keyPath = request.getKeyPath().toArray(new String[0]);\n+            }\n+            if (keyPath.length == 0 && request.getValueToMerge().keySet().stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d695cedb1c289156863aa3cd66f4b60dcf351306"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMzQxNw==", "bodyText": "yes, the accessControl at top level is restricted. If a key name accessControl is inside then we don't wnt to restrict that.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/663#discussion_r521733417", "createdAt": "2020-11-12T00:31:48Z", "author": {"login": "abanthiy"}, "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "diffHunk": "@@ -312,23 +314,26 @@ private void validateRequest(UpdateConfigurationRequest request) {\n             if (request.getValueToMerge() == null) {\n                 throw new InvalidArgumentsError(\"ValueToMerge is required\");\n             }\n-\n+            String[] keyPath = new String[0];\n+            if (request.getKeyPath() != null) {\n+                keyPath = request.getKeyPath().toArray(new String[0]);\n+            }\n+            if (keyPath.length == 0 && request.getValueToMerge().keySet().stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMjc5Ng=="}, "originalCommit": {"oid": "d695cedb1c289156863aa3cd66f4b60dcf351306"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczNjA5MA==", "bodyText": "What about changing subkeys though, accessControl.policy1.whatever?", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/663#discussion_r521736090", "createdAt": "2020-11-12T00:36:35Z", "author": {"login": "MikeDombo"}, "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "diffHunk": "@@ -312,23 +314,26 @@ private void validateRequest(UpdateConfigurationRequest request) {\n             if (request.getValueToMerge() == null) {\n                 throw new InvalidArgumentsError(\"ValueToMerge is required\");\n             }\n-\n+            String[] keyPath = new String[0];\n+            if (request.getKeyPath() != null) {\n+                keyPath = request.getKeyPath().toArray(new String[0]);\n+            }\n+            if (keyPath.length == 0 && request.getValueToMerge().keySet().stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMjc5Ng=="}, "originalCommit": {"oid": "d695cedb1c289156863aa3cd66f4b60dcf351306"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc0ODMzNw==", "bodyText": "if any key under accessControl does not get updated, LGTM.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/663#discussion_r521748337", "createdAt": "2020-11-12T00:57:24Z", "author": {"login": "prateek-y"}, "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "diffHunk": "@@ -312,23 +314,26 @@ private void validateRequest(UpdateConfigurationRequest request) {\n             if (request.getValueToMerge() == null) {\n                 throw new InvalidArgumentsError(\"ValueToMerge is required\");\n             }\n-\n+            String[] keyPath = new String[0];\n+            if (request.getKeyPath() != null) {\n+                keyPath = request.getKeyPath().toArray(new String[0]);\n+            }\n+            if (keyPath.length == 0 && request.getValueToMerge().keySet().stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMjc5Ng=="}, "originalCommit": {"oid": "d695cedb1c289156863aa3cd66f4b60dcf351306"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc0OTc2Nw==", "bodyText": "Updated PR should not allow the subkeys either.", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/663#discussion_r521749767", "createdAt": "2020-11-12T00:59:52Z", "author": {"login": "abanthiy"}, "path": "src/main/java/com/aws/greengrass/builtin/services/configstore/ConfigStoreIPCEventStreamAgent.java", "diffHunk": "@@ -312,23 +314,26 @@ private void validateRequest(UpdateConfigurationRequest request) {\n             if (request.getValueToMerge() == null) {\n                 throw new InvalidArgumentsError(\"ValueToMerge is required\");\n             }\n-\n+            String[] keyPath = new String[0];\n+            if (request.getKeyPath() != null) {\n+                keyPath = request.getKeyPath().toArray(new String[0]);\n+            }\n+            if (keyPath.length == 0 && request.getValueToMerge().keySet().stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTczMjc5Ng=="}, "originalCommit": {"oid": "d695cedb1c289156863aa3cd66f4b60dcf351306"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 217, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}