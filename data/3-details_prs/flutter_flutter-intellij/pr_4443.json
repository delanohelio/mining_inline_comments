{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MTA5ODMx", "number": 4443, "title": "fix an issue with discovering hyperlinks in test consoles", "bodyText": "Fix an issue with discovering hyperlinks in test consoles:\n\nadd a DartConsoleFilter console filter to the test console\nsome related cleanup and normalization to our filters for various consoles\nfix #4429\nfix #3851\n\nWe'd never contributed a DartConsoleFilter to the test consoles before (which we should have), and recent changes in the FlutterConsoleFilter had caused the test console hyperlink support to regress further.\n@gspencergoog, this will likely address the issue you're seeing. We have a release scheduled for next Friday, so you'll see this change then. If you want to try out a version before that, we now have a beta channel that gets automatically pushed to every Sunday AM. I can send you docs on how to switch to the beta channel if you like.", "createdAt": "2020-03-28T15:20:17Z", "url": "https://github.com/flutter/flutter-intellij/pull/4443", "merged": true, "mergeCommit": {"oid": "4c0d20d9c7b6e46f0fd8e260da44bb9f42aa95a2"}, "closed": true, "closedAt": "2020-03-30T00:42:50Z", "author": {"login": "devoncarew"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSG1YDgH2gAyMzk1MTA5ODMxOmNiNTYyZTIwODY3MWEzZDU4ODE1NmVkYWNiNjJjZTE3NDQxZTZkMDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcSh9PwgFqTM4MzQ1OTk0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cb562e208671a3d588156edacb62ce17441e6d05", "author": {"user": {"login": "devoncarew", "name": "Devon Carew"}}, "url": "https://github.com/flutter/flutter-intellij/commit/cb562e208671a3d588156edacb62ce17441e6d05", "committedDate": "2020-03-28T15:14:27Z", "message": "fix an issue with discovering hyperlinks in test consoles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a", "author": {"user": {"login": "devoncarew", "name": "Devon Carew"}}, "url": "https://github.com/flutter/flutter-intellij/commit/39c68a568df974acd2f28f986c733603e95d346a", "committedDate": "2020-03-28T17:00:47Z", "message": "add back in DartRelativePathsConsoleFilter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMzU1Njgx", "url": "https://github.com/flutter/flutter-intellij/pull/4443#pullrequestreview-383355681", "createdAt": "2020-03-28T22:37:45Z", "commit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQyMjozNzo0NVrOF9M2HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQyMjo0MzoxMlrOF9M35w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxNzkxNw==", "bodyText": "DartRelativePathsConsoleFilter is intended to be used in test environs. Are you sure deleting it is the right thing to do?", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399717917", "createdAt": "2020-03-28T22:37:45Z", "author": {"login": "stevemessick"}, "path": "src/io/flutter/run/bazelTest/BazelTestLaunchState.java", "diffHunk": "@@ -106,8 +106,8 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final ConsoleProps props = ConsoleProps.forBazel(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.bazelFrameworkName, props);\n \n-    final String baseDir = workspace.getRoot().getPath();\n-    console.addMessageFilter(new DartRelativePathsConsoleFilter(project, baseDir));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODA3OA==", "bodyText": "I think you want DartConsoleFilter here, too, but it may be getting added at a later stage. I forgot just how convoluted this is.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399718078", "createdAt": "2020-03-28T22:39:28Z", "author": {"login": "stevemessick"}, "path": "src/io/flutter/run/daemon/DaemonConsoleView.java", "diffHunk": "@@ -46,6 +46,7 @@ protected ConsoleView createConsole() {\n     };\n \n     // Set up basic console filters. (More may be added later.)\n+    // TODO(devoncarew): Do we need this filter? What about DartConsoleFilter (for package: uris)?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ==", "bodyText": "Are you sure you want to remove this? It has some specialized logic for handling Flutter stuff, like plugins.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399718375", "createdAt": "2020-03-28T22:43:12Z", "author": {"login": "stevemessick"}, "path": "src/io/flutter/run/test/TestLaunchState.java", "diffHunk": "@@ -113,15 +113,15 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final DartUrlResolver resolver = DartUrlResolver.getInstance(project, testFileOrDir);\n     final ConsoleProps props = ConsoleProps.forPub(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.pubFrameworkName, props);\n+\n     final Module module = ModuleUtil.findModuleForFile(testFileOrDir, project);\n-    if (module != null) {\n-      console.addMessageFilter(new FlutterConsoleFilter(module));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dd4cee51be3f20ee1ea7590a9b9284d4cd3dce5", "author": {"user": {"login": "devoncarew", "name": "Devon Carew"}}, "url": "https://github.com/flutter/flutter-intellij/commit/3dd4cee51be3f20ee1ea7590a9b9284d4cd3dce5", "committedDate": "2020-03-29T22:49:38Z", "message": "add the DartRelativePathsConsoleFilter filter to the bazel test config; add docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNDU5OTQ1", "url": "https://github.com/flutter/flutter-intellij/pull/4443#pullrequestreview-383459945", "createdAt": "2020-03-29T21:57:52Z", "commit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQyMTo1Nzo1MlrOF9Vfqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQyMjoxMDoxN1rOF9VlSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1OTYyNw==", "bodyText": "No, I'll add it back in, and add some brief docs about what the different filters do.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399859627", "createdAt": "2020-03-29T21:57:52Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/run/bazelTest/BazelTestLaunchState.java", "diffHunk": "@@ -106,8 +106,8 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final ConsoleProps props = ConsoleProps.forBazel(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.bazelFrameworkName, props);\n \n-    final String baseDir = workspace.getRoot().getPath();\n-    console.addMessageFilter(new DartRelativePathsConsoleFilter(project, baseDir));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxNzkxNw=="}, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MDIxMQ==", "bodyText": "We may just need the DartConsoleFilter in the SdkRunConfig.java (the run/debug console)? If you're certain I can add it, but would otherwise hold off.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399860211", "createdAt": "2020-03-29T22:02:52Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/run/daemon/DaemonConsoleView.java", "diffHunk": "@@ -46,6 +46,7 @@ protected ConsoleView createConsole() {\n     };\n \n     // Set up basic console filters. (More may be added later.)\n+    // TODO(devoncarew): Do we need this filter? What about DartConsoleFilter (for package: uris)?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODA3OA=="}, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MDM3NQ==", "bodyText": "I'll figure out what all the FlutterConsoleFilter is responsible for. I think it's more important for the run console (to link to lib.main.dart, and some flutter doctor output?). It may have several different concerns in that class.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399860375", "createdAt": "2020-03-29T22:04:12Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/run/test/TestLaunchState.java", "diffHunk": "@@ -113,15 +113,15 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final DartUrlResolver resolver = DartUrlResolver.getInstance(project, testFileOrDir);\n     final ConsoleProps props = ConsoleProps.forPub(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.pubFrameworkName, props);\n+\n     final Module module = ModuleUtil.findModuleForFile(testFileOrDir, project);\n-    if (module != null) {\n-      console.addMessageFilter(new FlutterConsoleFilter(module));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ=="}, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MTA2NA==", "bodyText": "I added docs to FlutterConsoleFilter. I think we only want to use it for the run and debug consoles.", "url": "https://github.com/flutter/flutter-intellij/pull/4443#discussion_r399861064", "createdAt": "2020-03-29T22:10:17Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/run/test/TestLaunchState.java", "diffHunk": "@@ -113,15 +113,15 @@ protected ConsoleView createConsole(@NotNull Executor executor) throws Execution\n     final DartUrlResolver resolver = DartUrlResolver.getInstance(project, testFileOrDir);\n     final ConsoleProps props = ConsoleProps.forPub(config, executor, resolver);\n     final BaseTestsOutputConsoleView console = SMTestRunnerConnectionUtil.createConsole(ConsoleProps.pubFrameworkName, props);\n+\n     final Module module = ModuleUtil.findModuleForFile(testFileOrDir, project);\n-    if (module != null) {\n-      console.addMessageFilter(new FlutterConsoleFilter(module));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxODM3NQ=="}, "originalCommit": {"oid": "39c68a568df974acd2f28f986c733603e95d346a"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1672, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}