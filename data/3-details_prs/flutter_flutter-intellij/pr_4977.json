{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NjcyNDU4", "number": 4977, "title": "resume isolates at test start", "bodyText": "fix an issue resuming isolates at the start of running tests\nfix #4967\nfix #4960\n\nFrom the reported issue, and looking at the code, I believe the problem was that we were resuming all known isolates (reported by the VM object) at test start. However, there's a chance the test isolate might not be executable yet. I believe the state changes that isolates go through are (https://github.com/dart-lang/sdk/blob/master/runtime/vm/service/service.md#streamlisten) IsolateStart, IsolateRunnable, and PauseStart. If you try and resume an isolate that's not yet runnable (or paused) the VM will return an error.\nThis changes to resuming all isolates that are 'PauseStart' when we first connect, and all isolates for which we later received 'PauseStart' events.\nThis alos changes from reporting issues via LOG.error() - which look like crashes to the user - to writing error messages to the run / test console.\n@helin24 - this is for the FlutterTestRunner program runner. I haven't looked to see if we'll need similar changes for the bazel test runner as well.", "createdAt": "2020-10-19T04:50:45Z", "url": "https://github.com/flutter/flutter-intellij/pull/4977", "merged": true, "mergeCommit": {"oid": "88b0df5e8ac055225e33c9393bbc8147dbeaaae0"}, "closed": true, "closedAt": "2020-10-19T20:16:53Z", "author": {"login": "devoncarew"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdT8c0tgH2gAyNTA1NjcyNDU4OmQ1YjdiMjJhZWQ5YjM3ZjRiZmU0MmJjNjA0MjIwZGFhYzIwYWIwYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUHrLUgH2gAyNTA1NjcyNDU4OjIzYTEyMDA4OTgxOWM0ZWUwMTZmNTE5YTgyMTIxZTc1OTE4MGJmNzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d5b7b22aed9b37f4bfe42bc604220daac20ab0a1", "author": {"user": {"login": "devoncarew", "name": "Devon Carew"}}, "url": "https://github.com/flutter/flutter-intellij/commit/d5b7b22aed9b37f4bfe42bc604220daac20ab0a1", "committedDate": "2020-10-19T04:27:35Z", "message": "resume isolates at test start"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExOTQzOTU3", "url": "https://github.com/flutter/flutter-intellij/pull/4977#pullrequestreview-511943957", "createdAt": "2020-10-19T16:26:54Z", "commit": {"oid": "d5b7b22aed9b37f4bfe42bc604220daac20ab0a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjoyNjo1NFrOHkXC-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjoyNjo1NFrOHkXC-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4ODM3Nw==", "bodyText": "We may want to keep this expanded", "url": "https://github.com/flutter/flutter-intellij/pull/4977#discussion_r507888377", "createdAt": "2020-10-19T16:26:54Z", "author": {"login": "helin24"}, "path": "src/io/flutter/run/test/FlutterTestRunner.java", "diffHunk": "@@ -37,13 +37,12 @@\n import io.flutter.settings.FlutterSettings;\n import io.flutter.utils.JsonUtils;\n import io.flutter.utils.StdoutJsonParser;\n+import io.flutter.utils.VmServiceListenerAdapter;\n import io.flutter.vmService.VmServiceConsumers;\n+import io.flutter.vmService.VmServiceConsumers.EmptyResumeConsumer;\n import org.dartlang.vm.service.VmService;\n import org.dartlang.vm.service.consumer.VMConsumer;\n-import org.dartlang.vm.service.element.ElementList;\n-import org.dartlang.vm.service.element.IsolateRef;\n-import org.dartlang.vm.service.element.RPCError;\n-import org.dartlang.vm.service.element.VM;\n+import org.dartlang.vm.service.element.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5b7b22aed9b37f4bfe42bc604220daac20ab0a1"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExOTQ0NTQ0", "url": "https://github.com/flutter/flutter-intellij/pull/4977#pullrequestreview-511944544", "createdAt": "2020-10-19T16:27:32Z", "commit": {"oid": "d5b7b22aed9b37f4bfe42bc604220daac20ab0a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23a120089819c4ee016f519a82121e759180bf77", "author": {"user": {"login": "devoncarew", "name": "Devon Carew"}}, "url": "https://github.com/flutter/flutter-intellij/commit/23a120089819c4ee016f519a82121e759180bf77", "committedDate": "2020-10-19T17:32:13Z", "message": "revert imports change"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3112, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}