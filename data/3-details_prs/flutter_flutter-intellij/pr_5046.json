{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMjUxMTUx", "number": 5046, "title": "Use runScript for bazel run", "bodyText": "This uses the updated runScript, which:\n\nProcesses bazel-options as a string of all of the bazel arguments\nHandles the device-specific logic internally (so we can remove from the plugin)", "createdAt": "2020-11-13T01:00:38Z", "url": "https://github.com/flutter/flutter-intellij/pull/5046", "merged": true, "mergeCommit": {"oid": "82f358b233d8c77228d36ff0eb8f50895f57ce8e"}, "closed": true, "closedAt": "2020-11-13T23:38:38Z", "author": {"login": "helin24"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcKfyQgH2gAyNTIwMjUxMTUxOmRiMjQyM2I5ZjkyMjRmYzE3YjgzNzljYjk0MGZiZGE0MTZiNzkyNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcPemjgH2gAyNTIwMjUxMTUxOjNlZjMyYjJkZWE3M2RhMWRkZDAwN2RhNDlhZDhlNzE4MGRmZGNhMTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/db2423b9f9224fc17b8379cb940fbda416b79265", "committedDate": "2020-11-13T17:20:53Z", "message": "Use run script for bazel run"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd10a7f34a2eb30f871e57878d31c14aaa503127", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/bd10a7f34a2eb30f871e57878d31c14aaa503127", "committedDate": "2020-11-13T02:26:47Z", "message": "Try adding print statements to debug test"}, "afterCommit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/db2423b9f9224fc17b8379cb940fbda416b79265", "committedDate": "2020-11-13T17:20:53Z", "message": "Use run script for bazel run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMjc0MDcy", "url": "https://github.com/flutter/flutter-intellij/pull/5046#pullrequestreview-530274072", "createdAt": "2020-11-13T17:41:17Z", "commit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNDI5NjI1", "url": "https://github.com/flutter/flutter-intellij/pull/5046#pullrequestreview-530429625", "createdAt": "2020-11-13T21:33:19Z", "commit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMTozMzoxOVrOHzARTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMTozMzoxOVrOHzARTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI0Mzg1Mg==", "bodyText": "Add a TODO to remove these defines and let the run script handle this part.", "url": "https://github.com/flutter/flutter-intellij/pull/5046#discussion_r523243852", "createdAt": "2020-11-13T21:33:19Z", "author": {"login": "jacob314"}, "path": "src/io/flutter/run/bazel/BazelFields.java", "diffHunk": "@@ -201,75 +201,38 @@ GeneralCommandLine getLaunchCommand(@NotNull Project project,\n     commandLine.setCharset(CharsetToolkit.UTF8_CHARSET);\n     commandLine.setExePath(FileUtil.toSystemDependentName(launchingScript));\n \n+    // Potentially add build mode to user-specified bazel arguments.\n+    final String inputBazelArgs = StringUtil.notNullize(bazelArgs);\n+    final StringBuilder fullBazelArgs = new StringBuilder(inputBazelArgs);\n+\n     // If the user hasn't overridden the flutter_build_mode, then\n     if (!StringUtil.notNullize(bazelArgs).matches(\".*--define[ =]flutter_build_mode.*\")) {\n+      if (!inputBazelArgs.isEmpty()) {\n+        fullBazelArgs.append(\" \");\n+      }\n \n       // Set the mode. This section needs to match the bazel versions of the flutter_build_mode parameters.\n       if (enableReleaseMode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNDI5NzY5", "url": "https://github.com/flutter/flutter-intellij/pull/5046#pullrequestreview-530429769", "createdAt": "2020-11-13T21:33:35Z", "commit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMTozMzozNVrOHzARtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMTozMzozNVrOHzARtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI0Mzk1Ng==", "bodyText": "great to see this go away!", "url": "https://github.com/flutter/flutter-intellij/pull/5046#discussion_r523243956", "createdAt": "2020-11-13T21:33:35Z", "author": {"login": "jacob314"}, "path": "src/io/flutter/run/bazel/BazelFields.java", "diffHunk": "@@ -201,75 +201,38 @@ GeneralCommandLine getLaunchCommand(@NotNull Project project,\n     commandLine.setCharset(CharsetToolkit.UTF8_CHARSET);\n     commandLine.setExePath(FileUtil.toSystemDependentName(launchingScript));\n \n+    // Potentially add build mode to user-specified bazel arguments.\n+    final String inputBazelArgs = StringUtil.notNullize(bazelArgs);\n+    final StringBuilder fullBazelArgs = new StringBuilder(inputBazelArgs);\n+\n     // If the user hasn't overridden the flutter_build_mode, then\n     if (!StringUtil.notNullize(bazelArgs).matches(\".*--define[ =]flutter_build_mode.*\")) {\n+      if (!inputBazelArgs.isEmpty()) {\n+        fullBazelArgs.append(\" \");\n+      }\n \n       // Set the mode. This section needs to match the bazel versions of the flutter_build_mode parameters.\n       if (enableReleaseMode) {\n-        commandLine.addParameters(\"--define\", \"flutter_build_mode=release\");\n+        fullBazelArgs.append(\"--define=flutter_build_mode=release\");\n       }\n       else {\n         switch (mode) {\n           case PROFILE:\n-            commandLine.addParameters(\"--define\", \"flutter_build_mode=profile\");\n+            fullBazelArgs.append(\"--define=flutter_build_mode=profile\");\n             break;\n           case RUN:\n           case DEBUG:\n           default:\n             // The default mode of a flutter app is debug mode. This is the mode that supports hot reloading.\n             // So far as flutter is concerned, there is no difference between debug mode and run mode;\n             // the only difference is that a debug mode app will --start-paused.\n-            commandLine.addParameters(\"--define\", \"flutter_build_mode=debug\");\n+            fullBazelArgs.append(\"--define=flutter_build_mode=debug\");\n             break;\n         }\n       }\n     }\n \n-    // User specified additional bazel arguments.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNDMwMjMy", "url": "https://github.com/flutter/flutter-intellij/pull/5046#pullrequestreview-530430232", "createdAt": "2020-11-13T21:34:35Z", "commit": {"oid": "db2423b9f9224fc17b8379cb940fbda416b79265"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef32b2dea73da1ddd007da49ad8e7180dfdca19", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/3ef32b2dea73da1ddd007da49ad8e7180dfdca19", "committedDate": "2020-11-13T23:09:07Z", "message": "Add TODO to move build mode to run script"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3009, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}