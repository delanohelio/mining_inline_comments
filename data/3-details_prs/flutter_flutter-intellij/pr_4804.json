{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5MDc4MDg4", "number": 4804, "title": "Skip transparent background if hardware accelerated causes error", "bodyText": "Fixes #4803\nIt seems that hardware accelerated mode can fail on Windows, but we aren't sure if this is due to a machine setting or a JxBrowser limitation. Adding this check so that we can try a backup mode.\nVerified that this works, but it is comically zoomed in:\n\nThe OFFSCREEN mode works fine; in the previous screenshot my windows device had a strange zoom setting.\n\nThe HARDWARE_ACCELERATED mode works too; in comments below the issue was also due to the local zoom setting.", "createdAt": "2020-09-03T23:03:21Z", "url": "https://github.com/flutter/flutter-intellij/pull/4804", "merged": true, "mergeCommit": {"oid": "2597ad720ed738fe97d8096ea5bdbbecfb89ecaf"}, "closed": true, "closedAt": "2020-09-10T00:09:39Z", "author": {"login": "helin24"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHOUQVAFqTQ4NTE1Njc5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHVW-CAFqTQ4NTQ4MTQxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MTU2Nzk4", "url": "https://github.com/flutter/flutter-intellij/pull/4804#pullrequestreview-485156798", "createdAt": "2020-09-09T15:55:29Z", "commit": {"oid": "e59e29c09ce87f595d94d5c2a6eab8a435a24f43"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNTo1NToyOVrOHPOIpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNTo1NToyOVrOHPOIpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTcyMjI3Ng==", "bodyText": "does HARDWARE_ACCELERATED without the transparent background work on windows? Perhaps add a comment as the placement of the try-catch makes it look like that is the problem not the HARDWARE_ACCELERATED option. I'll put it this way, if I had to pick, HARDWARE_ACCELERATED over enableTransparentBackground as one impacts performance and the other just causes a UI flicker.", "url": "https://github.com/flutter/flutter-intellij/pull/4804#discussion_r485722276", "createdAt": "2020-09-09T15:55:29Z", "author": {"login": "jacob314"}, "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "diffHunk": "@@ -20,19 +21,30 @@\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import static com.teamdev.jxbrowser.engine.RenderingMode.HARDWARE_ACCELERATED;\n+import static com.teamdev.jxbrowser.engine.RenderingMode.OFF_SCREEN;\n \n public class EmbeddedBrowser {\n   public void openPanel(ContentManager contentManager, String tabName, String url) {\n-    final EngineOptions options =\n+    EngineOptions options =\n       EngineOptions.newBuilder(HARDWARE_ACCELERATED).build();\n-    final Engine engine = Engine.newInstance(options);\n-    final Browser browser = engine.newBrowser();\n-    browser.settings().enableTransparentBackground();\n+    Engine engine = Engine.newInstance(options);\n+    Browser browser = engine.newBrowser();\n+\n+    try {\n+      browser.settings().enableTransparentBackground();\n+    } catch (UnsupportedRenderingModeException ex) {\n+      options =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e59e29c09ce87f595d94d5c2a6eab8a435a24f43"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MTYzNDkw", "url": "https://github.com/flutter/flutter-intellij/pull/4804#pullrequestreview-485163490", "createdAt": "2020-09-09T15:58:07Z", "commit": {"oid": "e59e29c09ce87f595d94d5c2a6eab8a435a24f43"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNTo1ODowN1rOHPOP0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNTo1ODowN1rOHPOP0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTcyNDExNQ==", "bodyText": "nit: having a variable named finalBrowser is a bit ugly.  A slightly cleaner option would be to have a createBrowser()helper method.\nfinal Browser browser= createBrowser(..)", "url": "https://github.com/flutter/flutter-intellij/pull/4804#discussion_r485724115", "createdAt": "2020-09-09T15:58:07Z", "author": {"login": "jacob314"}, "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "diffHunk": "@@ -20,19 +21,30 @@\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import static com.teamdev.jxbrowser.engine.RenderingMode.HARDWARE_ACCELERATED;\n+import static com.teamdev.jxbrowser.engine.RenderingMode.OFF_SCREEN;\n \n public class EmbeddedBrowser {\n   public void openPanel(ContentManager contentManager, String tabName, String url) {\n-    final EngineOptions options =\n+    EngineOptions options =\n       EngineOptions.newBuilder(HARDWARE_ACCELERATED).build();\n-    final Engine engine = Engine.newInstance(options);\n-    final Browser browser = engine.newBrowser();\n-    browser.settings().enableTransparentBackground();\n+    Engine engine = Engine.newInstance(options);\n+    Browser browser = engine.newBrowser();\n+\n+    try {\n+      browser.settings().enableTransparentBackground();\n+    } catch (UnsupportedRenderingModeException ex) {\n+      options =\n+        EngineOptions.newBuilder(OFF_SCREEN).build();\n+      engine = Engine.newInstance(options);\n+      browser = engine.newBrowser();\n+      browser.settings().enableTransparentBackground();\n+    }\n \n     // Multiple LoadFinished events can occur, but we only need to add content the first time.\n     final AtomicBoolean contentLoaded = new AtomicBoolean(false);\n \n     browser.navigation().loadUrl(url);\n+    final Browser finalBrowser = browser;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e59e29c09ce87f595d94d5c2a6eab8a435a24f43"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "312cb34c036e0c18a7bd6db4567eb7fcb4edb869", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/312cb34c036e0c18a7bd6db4567eb7fcb4edb869", "committedDate": "2020-09-09T17:50:11Z", "message": "Use off screen render mode if hardware accelerated causes error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f25f8ca88fb1ed5c2b7f927def20c8867cda65aa", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/f25f8ca88fb1ed5c2b7f927def20c8867cda65aa", "committedDate": "2020-09-09T22:23:53Z", "message": "Use helper function to get browser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5b8accae6be442b4d77f377f74aba637c48bb5b", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/b5b8accae6be442b4d77f377f74aba637c48bb5b", "committedDate": "2020-09-09T22:44:42Z", "message": "Skip transparent background only"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e59e29c09ce87f595d94d5c2a6eab8a435a24f43", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/e59e29c09ce87f595d94d5c2a6eab8a435a24f43", "committedDate": "2020-09-03T22:59:05Z", "message": "Use off screen render mode if hardware accelerated causes error"}, "afterCommit": {"oid": "b5b8accae6be442b4d77f377f74aba637c48bb5b", "author": {"user": {"login": "helin24", "name": "Helin Shiah"}}, "url": "https://github.com/flutter/flutter-intellij/commit/b5b8accae6be442b4d77f377f74aba637c48bb5b", "committedDate": "2020-09-09T22:44:42Z", "message": "Skip transparent background only"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NDgxNDE3", "url": "https://github.com/flutter/flutter-intellij/pull/4804#pullrequestreview-485481417", "createdAt": "2020-09-10T00:07:48Z", "commit": {"oid": "b5b8accae6be442b4d77f377f74aba637c48bb5b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1628, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}