{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4Njc0ODI4", "number": 5035, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMToyMjo0NlrOE3auzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMTo1MTo0OFrOE3bUZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTQ1MTAyOnYy", "diffSide": "RIGHT", "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMToyMjo0NlrOHwwHMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMToyMjo0NlrOHwwHMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4MTk3MA==", "bodyText": "log this instead?", "url": "https://github.com/flutter/flutter-intellij/pull/5035#discussion_r520881970", "createdAt": "2020-11-10T21:22:46Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "diffHunk": "@@ -16,25 +16,46 @@\n import com.teamdev.jxbrowser.navigation.event.LoadFinished;\n import com.teamdev.jxbrowser.view.swing.BrowserView;\n import icons.FlutterIcons;\n+import org.jetbrains.annotations.NotNull;\n \n import java.awt.*;\n+import java.io.File;\n+import java.nio.file.Paths;\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import static com.teamdev.jxbrowser.engine.RenderingMode.HARDWARE_ACCELERATED;\n \n public class EmbeddedBrowser {\n-  public void openPanel(ContentManager contentManager, String tabName, String url) {\n+  private static EmbeddedBrowser embeddedBrowser;\n+\n+  @NotNull\n+  public static EmbeddedBrowser getInstance() {\n+    if (embeddedBrowser == null) {\n+      embeddedBrowser = new EmbeddedBrowser();\n+    }\n+    return embeddedBrowser;\n+  }\n+\n+  private Browser browser;\n+\n+  private EmbeddedBrowser() {\n+    System.out.println(Paths.get(JxBrowserManager.DOWNLOAD_PATH + File.separatorChar + \"user-data\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59ef40bdb28ebe092ae1e6b2284143e86b02b0ea"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTQ2MDAyOnYy", "diffSide": "RIGHT", "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMToyNToyNVrOHwwMkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzo0MDozMFrOHwz5hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4MzM0Ng==", "bodyText": "Do we want this to be an application singleton or a per project (per IntelliJ window) singleton? I'm guessing the 2nd one. There are several places in the code base where we have per-project singletons. You register them in the plugin's xml file and then have a slightly different singleton getter. See for example FlutterReloadManager.getInstance(Project project).", "url": "https://github.com/flutter/flutter-intellij/pull/5035#discussion_r520883346", "createdAt": "2020-11-10T21:25:25Z", "author": {"login": "devoncarew"}, "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "diffHunk": "@@ -16,25 +16,46 @@\n import com.teamdev.jxbrowser.navigation.event.LoadFinished;\n import com.teamdev.jxbrowser.view.swing.BrowserView;\n import icons.FlutterIcons;\n+import org.jetbrains.annotations.NotNull;\n \n import java.awt.*;\n+import java.io.File;\n+import java.nio.file.Paths;\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import static com.teamdev.jxbrowser.engine.RenderingMode.HARDWARE_ACCELERATED;\n \n public class EmbeddedBrowser {\n-  public void openPanel(ContentManager contentManager, String tabName, String url) {\n+  private static EmbeddedBrowser embeddedBrowser;\n+\n+  @NotNull\n+  public static EmbeddedBrowser getInstance() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59ef40bdb28ebe092ae1e6b2284143e86b02b0ea"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0NDAwNg==", "bodyText": "Ack forgot about this! Changed to per-project.", "url": "https://github.com/flutter/flutter-intellij/pull/5035#discussion_r520944006", "createdAt": "2020-11-10T23:40:30Z", "author": {"login": "helin24"}, "path": "src/io/flutter/jxbrowser/EmbeddedBrowser.java", "diffHunk": "@@ -16,25 +16,46 @@\n import com.teamdev.jxbrowser.navigation.event.LoadFinished;\n import com.teamdev.jxbrowser.view.swing.BrowserView;\n import icons.FlutterIcons;\n+import org.jetbrains.annotations.NotNull;\n \n import java.awt.*;\n+import java.io.File;\n+import java.nio.file.Paths;\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import static com.teamdev.jxbrowser.engine.RenderingMode.HARDWARE_ACCELERATED;\n \n public class EmbeddedBrowser {\n-  public void openPanel(ContentManager contentManager, String tabName, String url) {\n+  private static EmbeddedBrowser embeddedBrowser;\n+\n+  @NotNull\n+  public static EmbeddedBrowser getInstance() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg4MzM0Ng=="}, "originalCommit": {"oid": "59ef40bdb28ebe092ae1e6b2284143e86b02b0ea"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTU0NzI1OnYy", "diffSide": "RIGHT", "path": "src/io/flutter/devtools/DevToolsManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMTo1MTo0OFrOHwxBZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzo0MTozMFrOHwz66g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg5Njg3MQ==", "bodyText": "getInstance(project)\nI think we'd want separate instances for each window.\nI don't think IntelliJ allows opening two windows on a single project, but if it does that could be a problem.", "url": "https://github.com/flutter/flutter-intellij/pull/5035#discussion_r520896871", "createdAt": "2020-11-10T21:51:48Z", "author": {"login": "stevemessick"}, "path": "src/io/flutter/devtools/DevToolsManager.java", "diffHunk": "@@ -404,7 +404,7 @@ public void openPanel(String serviceProtocolUri, ContentManager contentManager,\n \n     //noinspection CodeBlock2Expr\n     ApplicationManager.getApplication().invokeLater(() -> {\n-      new EmbeddedBrowser().openPanel(contentManager, tabName, url);\n+      EmbeddedBrowser.getInstance().openPanel(contentManager, tabName, url);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59ef40bdb28ebe092ae1e6b2284143e86b02b0ea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0NDM2Mg==", "bodyText": "Hmm.. I can't do it easily, so hopefully only one project per window.", "url": "https://github.com/flutter/flutter-intellij/pull/5035#discussion_r520944362", "createdAt": "2020-11-10T23:41:30Z", "author": {"login": "helin24"}, "path": "src/io/flutter/devtools/DevToolsManager.java", "diffHunk": "@@ -404,7 +404,7 @@ public void openPanel(String serviceProtocolUri, ContentManager contentManager,\n \n     //noinspection CodeBlock2Expr\n     ApplicationManager.getApplication().invokeLater(() -> {\n-      new EmbeddedBrowser().openPanel(contentManager, tabName, url);\n+      EmbeddedBrowser.getInstance().openPanel(contentManager, tabName, url);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg5Njg3MQ=="}, "originalCommit": {"oid": "59ef40bdb28ebe092ae1e6b2284143e86b02b0ea"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 377, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}