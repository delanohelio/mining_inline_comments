{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzkzOTIz", "number": 4423, "title": "Fix API incompatibilities", "bodyText": "This replaces #4417.\nThis rebases the sources on 3.6 (stable) Android Studio. We have to do some editing in the plugin tool to build for 4.0 now.", "createdAt": "2020-03-10T22:25:52Z", "url": "https://github.com/flutter/flutter-intellij/pull/4423", "merged": true, "mergeCommit": {"oid": "199e44ba4ad17ea0b0adcc1388952617cf965c3b"}, "closed": true, "closedAt": "2020-03-11T15:01:07Z", "author": {"login": "stevemessick"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMaLEsAH2gAyMzg2MzkzOTIzOjI4NmU1N2RiY2U3NzU2OTljOGFlODA0OGFiZmI1Y2U4NjAyNTRmMjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMay8cgFqTM3MjM3OTU3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "286e57dbce775699c8ae8048abfb5ce860254f23", "author": {"user": {"login": "stevemessick", "name": null}}, "url": "https://github.com/flutter/flutter-intellij/commit/286e57dbce775699c8ae8048abfb5ce860254f23", "committedDate": "2020-03-10T22:22:48Z", "message": "Fix API incompatibilities"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMzc5NTc5", "url": "https://github.com/flutter/flutter-intellij/pull/4423#pullrequestreview-372379579", "createdAt": "2020-03-10T23:04:20Z", "commit": {"oid": "286e57dbce775699c8ae8048abfb5ce860254f23"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQyMzowNToyNlrOF0kDoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQyMzowNjowNVrOF0kEYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY2MTAyNA==", "bodyText": "does this need \"// for 4.0\"", "url": "https://github.com/flutter/flutter-intellij/pull/4423#discussion_r390661024", "createdAt": "2020-03-10T23:05:26Z", "author": {"login": "kenzieschmoll"}, "path": "flutter-studio/src/io/flutter/project/FlutterProjectSystem.java", "diffHunk": "@@ -102,27 +102,19 @@ public ProjectSystemSyncManager getSyncManager() {\n     }\n   }\n \n-  @SuppressWarnings(\"override\")\n-  public boolean getAugmentRClasses() {\n-    // TODO(messick) Remove when 3.5 is stable\n-    return false;\n-  }\n-\n   @NotNull\n   @SuppressWarnings(\"override\")\n   public LightResourceClassService getLightResourceClassService() {\n     return gradleProjectSystem.getLightResourceClassService();\n   }\n \n-  @NotNull\n-  @SuppressWarnings(\"override\")\n-  public SourceProvidersFactory getSourceProvidersFactory() {\n-    return gradleProjectSystem.getSourceProvidersFactory();\n-  }\n+  //@NotNull\n+  //public SourceProvidersFactory getSourceProvidersFactory() {\n+  //  return gradleProjectSystem.getSourceProvidersFactory();\n+  //} // for 4.0\n \n-  @NotNull\n-  @SuppressWarnings(\"override\")\n-  public Collection<Module> getSubmodules() {\n-    return gradleProjectSystem.getSubmodules();\n-  }\n+  //@NotNull\n+  //public Collection<Module> getSubmodules() {\n+  //  return gradleProjectSystem.getSubmodules();\n+  //}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "286e57dbce775699c8ae8048abfb5ce860254f23"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY2MTIxNg==", "bodyText": "do we need to uncomment the @NotNull  annotations too?", "url": "https://github.com/flutter/flutter-intellij/pull/4423#discussion_r390661216", "createdAt": "2020-03-10T23:06:05Z", "author": {"login": "kenzieschmoll"}, "path": "tool/plugin/lib/plugin.dart", "diffHunk": "@@ -715,26 +715,60 @@ class BuildCommand extends ProductCommand {\n           'baseDir.getPath()',\n         );\n         processedFile.writeAsStringSync(source);\n+      }\n \n+      if (spec.version.startsWith('4.')) {\n         processedFile = File(\n             'flutter-studio/src/io/flutter/module/FlutterDescriptionProvider.java');\n         source = processedFile.readAsStringSync();\n         files[processedFile] = source;\n         source = source.replaceAll(\n-          'import com.android.tools.idea.npw.model.ProjectSyncInvoker',\n-          'import com.android.tools.idea.npw.model.NewModuleModel',\n+          'public SkippableWizardStep createStep(@NotNull NewModuleModel model) {',\n+          'public SkippableWizardStep createStep(@NotNull Project project, @NotNull ProjectSyncInvoker invoker, String parent) {',\n+        );\n+        source = source.replaceAll(\n+          'model(model.getProject().getValue()',\n+          'model(project',\n+        );\n+        source = source.replaceAll(\n+          'NewModuleModel',\n+          'NewAndroidModuleModel',\n+        );\n+        processedFile.writeAsStringSync(source);\n+\n+        processedFile = File(\n+            'flutter-studio/src/io/flutter/android/AndroidModuleLibraryManager.java');\n+        source = processedFile.readAsStringSync();\n+        files[processedFile] = source;\n+        source = source.replaceAll(\n+          'super(filePath.toString()',\n+          'super(filePath',\n+        );\n+        source = source.replaceAll(\n+          'getStateStore().setPath(path.toString()',\n+          'getStateStore().setPath(path',\n+        );\n+        processedFile.writeAsStringSync(source);\n+\n+        processedFile = File(\n+            'flutter-studio/src/io/flutter/project/FlutterProjectSystem.java');\n+        source = processedFile.readAsStringSync();\n+        files[processedFile] = source;\n+        source = source.replaceAll(\n+          '//import com.android.tools.idea.projectsystem.SourceProvidersFactory;',\n+          'import com.android.tools.idea.projectsystem.SourceProvidersFactory;',\n         );\n         source = source.replaceAll(\n-          'createStep(@NotNull Project model, @NotNull ProjectSyncInvoker invoker, String parent)',\n-          'createStep(@NotNull NewModuleModel model)',\n+          '//public SourceProvidersFactory getSourceProvidersFactory() {',\n+          'public SourceProvidersFactory getSourceProvidersFactory() {',\n         );\n         source = source.replaceAll(\n-          'FlutterProjectModel model(@NotNull Project project,',\n-          'FlutterProjectModel model(@NotNull NewModuleModel project,',\n+          '//  return gradleProjectSystem.getSourceProvidersFactory();',\n+          '  return gradleProjectSystem.getSourceProvidersFactory();',\n         );\n         source = source.replaceAll(\n-          'mySharedModel.getValue().project().setValue(project);',\n-          'mySharedModel.getValue().project().setValue(project.getProject().getValue());',\n+          '//} // for 4.0',\n+          '} // for 4.0',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "286e57dbce775699c8ae8048abfb5ce860254f23"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1668, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}