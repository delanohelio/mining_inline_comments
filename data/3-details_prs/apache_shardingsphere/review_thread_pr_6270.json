{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0NTE2MjM2", "number": 6270, "reviewThreads": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1NTozMFrOELigug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1MDowMVrOELj1zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM1MjI2OnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1NTozMFrOGtIywA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTo0NTo0NFrOGtJhHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4MzE2OA==", "bodyText": "Should delete if only use for serverVersion once.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449983168", "createdAt": "2020-07-06T04:55:30Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5NTAzNg==", "bodyText": "ok", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449995036", "createdAt": "2020-07-06T05:45:44Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4MzE2OA=="}, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM1NjczOnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1ODozOVrOGtI1ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1ODozOVrOGtI1ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4Mzg0NA==", "bodyText": "follow an empty line.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449983844", "createdAt": "2020-07-06T04:58:39Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM1NzY5OnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1OTozMFrOGtI1-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNDo1OTozMFrOGtI1-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4Mzk5NQ==", "bodyText": "null != version", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449983995", "createdAt": "2020-07-06T04:59:30Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.\n+     * @param version version\n      */\n-    public static final int CHARSET = 0x21;\n+    public static void setServerVersion(final String version) {\n+        if (version != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM2OTQ5OnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowNzoyMlrOGtI8xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowNzoyMlrOGtI8xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NTczNA==", "bodyText": "set should be capitalized.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449985734", "createdAt": "2020-07-06T05:07:22Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM3MDE0OnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowNzo0N1rOGtI9JQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowNzo0N1rOGtI9JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NTgyOQ==", "bodyText": "server version", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449985829", "createdAt": "2020-07-06T05:07:47Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.\n+     * @param version version", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM3MTQwOnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowODo0NlrOGtI95g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowODo0NlrOGtI95g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NjAyMg==", "bodyText": "get should be capitalized.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449986022", "createdAt": "2020-07-06T05:08:46Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.\n+     * @param version version\n      */\n-    public static final int CHARSET = 0x21;\n+    public static void setServerVersion(final String version) {\n+        if (version != null) {\n+            serverVersion = String.format(\"%s-ShardingSphere-Proxy 5.0.0-RC1\", version);\n+        }\n+    }\n+    \n+    /**\n+     * get current server version.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM3MTU2OnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowODo1OVrOGtI-Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTowODo1OVrOGtI-Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NjA1MQ==", "bodyText": "follow an empty line.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449986051", "createdAt": "2020-07-06T05:08:59Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n+    private static final String DEFAULT_SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = DEFAULT_SERVER_VERSION;\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     *  set server version.\n+     * @param version version\n      */\n-    public static final int CHARSET = 0x21;\n+    public static void setServerVersion(final String version) {\n+        if (version != null) {\n+            serverVersion = String.format(\"%s-ShardingSphere-Proxy 5.0.0-RC1\", version);\n+        }\n+    }\n+    \n+    /**\n+     * get current server version.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM3ODM0OnYy", "diffSide": "RIGHT", "path": "shardingsphere-distribution/shardingsphere-proxy-distribution/src/main/resources/bin/start.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToxMzowOFrOGtJByg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTo1NjoyOFrOGtJr5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NzAxOA==", "bodyText": "What's this for?  I suggest delete it from this pr. If you would like to add help, please create a new issue to do this.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449987018", "createdAt": "2020-07-06T05:13:08Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-distribution/shardingsphere-proxy-distribution/src/main/resources/bin/start.sh", "diffHunk": "@@ -38,6 +38,17 @@ JAVA_MEM_OPTS=\" -server -Xmx2g -Xms2g -Xmn1g -Xss256k -XX:+DisableExplicitGC -XX\n \n MAIN_CLASS=org.apache.shardingsphere.proxy.Bootstrap\n \n+print_usage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5Nzc5Nw==", "bodyText": "got it", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449997797", "createdAt": "2020-07-06T05:56:28Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-distribution/shardingsphere-proxy-distribution/src/main/resources/bin/start.sh", "diffHunk": "@@ -38,6 +38,17 @@ JAVA_MEM_OPTS=\" -server -Xmx2g -Xms2g -Xmn1g -Xss256k -XX:+DisableExplicitGC -XX\n \n MAIN_CLASS=org.apache.shardingsphere.proxy.Bootstrap\n \n+print_usage() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4NzAxOA=="}, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM5MzcyOnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyMjowOVrOGtJKfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyMjowOVrOGtJKfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk4OTI0Ng==", "bodyText": "remove meaningless empty line.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449989246", "createdAt": "2020-07-06T05:22:09Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,26 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData meta = connection.getMetaData();\n+            String name = meta.getDatabaseProductName();\n+            String version = meta.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);\n+            MySQLServerInfo.setServerVersion(version);\n+        } catch (SQLException e) {\n+            log.error(e.getMessage(), e);\n+        }\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTM5OTM0OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyNTo0MlrOGtJNwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyNTo0MlrOGtJNwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MDA4MQ==", "bodyText": "meta -> databaseMetaData, note that we rarely use abbreviation.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449990081", "createdAt": "2020-07-06T05:25:42Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,26 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData meta = connection.getMetaData();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTQwMzQ0OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyODoxMVrOGtJQLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyODoxMVrOGtJQLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MDcwMg==", "bodyText": "throw a ShardingSphereException instead of print log.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449990702", "createdAt": "2020-07-06T05:28:11Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,26 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData meta = connection.getMetaData();\n+            String name = meta.getDatabaseProductName();\n+            String version = meta.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);\n+            MySQLServerInfo.setServerVersion(version);\n+        } catch (SQLException e) {\n+            log.error(e.getMessage(), e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTQwNDA5OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyODo0MlrOGtJQmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNToyODo0MlrOGtJQmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MDgxMA==", "bodyText": "SQLException e -> final SQLException ex", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449990810", "createdAt": "2020-07-06T05:28:42Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,26 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData meta = connection.getMetaData();\n+            String name = meta.getDatabaseProductName();\n+            String version = meta.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);\n+            MySQLServerInfo.setServerVersion(version);\n+        } catch (SQLException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTQxNTE4OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-common/src/main/java/org/apache/shardingsphere/proxy/config/ShardingConfigurationLoader.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTozNToyOVrOGtJXKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNTozNToyOVrOGtJXKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk5MjQ5MA==", "bodyText": "remove this change if it's not about the server version.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r449992490", "createdAt": "2020-07-06T05:35:29Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-common/src/main/java/org/apache/shardingsphere/proxy/config/ShardingConfigurationLoader.java", "diffHunk": "@@ -52,9 +53,10 @@\n      * @throws IOException IO exception\n      */\n     public ShardingConfiguration load(final String path) throws IOException {\n+        //this is just check for schemaName duplication", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a824485738666d9a93676f30448f3a14e9f5cad6"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTU1MTEwOnYy", "diffSide": "RIGHT", "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo0MjoyNFrOGtKnBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNzowNDoyMFrOGtLKPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxMjkzMg==", "bodyText": "version server version -> server version", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450012932", "createdAt": "2020-07-06T06:42:24Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     * Set server version.\n+     *\n+     * @param version server version", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNzc3NA==", "bodyText": "the checkstyle will fail if changes to server version\n 'server' \u7684\u65e0\u7528\u6807\u7b7e @param \u3002 (47:8) [JavadocMethodCheck]", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450017774", "createdAt": "2020-07-06T06:54:42Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     * Set server version.\n+     *\n+     * @param version server version", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxMjkzMg=="}, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyMTk1MQ==", "bodyText": "done", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450021951", "createdAt": "2020-07-06T07:04:20Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-db-protocol/shardingsphere-db-protocol-mysql/src/main/java/org/apache/shardingsphere/db/protocol/mysql/constant/MySQLServerInfo.java", "diffHunk": "@@ -31,13 +31,33 @@\n      */\n     public static final int PROTOCOL_VERSION = 0x0A;\n     \n+    /**\n+     * Charset code 0x21 is utf8_general_ci.\n+     */\n+    public static final int CHARSET = 0x21;\n+    \n     /**\n      * Server version.\n      */\n-    public static final String SERVER_VERSION = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n+    private static String serverVersion = \"8.0.20-ShardingSphere-Proxy 5.0.0-RC1\";\n     \n     /**\n-     * Charset code 0x21 is utf8_general_ci.\n+     * Set server version.\n+     *\n+     * @param version server version", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxMjkzMg=="}, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTU1Nzg1OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo0NTowOFrOGtKrHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo0NTowOFrOGtKrHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxMzk4Mg==", "bodyText": "move @slf4j after constructor", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450013982", "createdAt": "2020-07-06T06:45:08Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -77,6 +81,7 @@\n /**\n  * ShardingSphere-Proxy Bootstrap.\n  */\n+@Slf4j", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTU2NTg2OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo0ODoyOFrOGtKv7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1ODozNVrOGtLAkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNTIxNA==", "bodyText": "Database name/Database version is better.", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450015214", "createdAt": "2020-07-06T06:48:28Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,25 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData databaseMetaData = connection.getMetaData();\n+            String name = databaseMetaData.getDatabaseProductName();\n+            String version = databaseMetaData.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxODE0Mw==", "bodyText": "yes that's better", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450018143", "createdAt": "2020-07-06T06:55:37Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,25 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData databaseMetaData = connection.getMetaData();\n+            String name = databaseMetaData.getDatabaseProductName();\n+            String version = databaseMetaData.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNTIxNA=="}, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxOTQ3Mw==", "bodyText": "done", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450019473", "createdAt": "2020-07-06T06:58:35Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,25 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData databaseMetaData = connection.getMetaData();\n+            String name = databaseMetaData.getDatabaseProductName();\n+            String version = databaseMetaData.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNTIxNA=="}, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNTU3MDA0OnYy", "diffSide": "RIGHT", "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1MDowMVrOGtKyfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1ODoxOFrOGtLAPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNTg3MA==", "bodyText": "e -> ex", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450015870", "createdAt": "2020-07-06T06:50:01Z", "author": {"login": "tuohai666"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,25 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData databaseMetaData = connection.getMetaData();\n+            String name = databaseMetaData.getDatabaseProductName();\n+            String version = databaseMetaData.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);\n+            MySQLServerInfo.setServerVersion(version);\n+        } catch (final SQLException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxOTM4OA==", "bodyText": "done", "url": "https://github.com/apache/shardingsphere/pull/6270#discussion_r450019388", "createdAt": "2020-07-06T06:58:18Z", "author": {"login": "xbkaishui"}, "path": "shardingsphere-proxy/shardingsphere-proxy-bootstrap/src/main/java/org/apache/shardingsphere/proxy/Bootstrap.java", "diffHunk": "@@ -157,6 +162,25 @@ private static void initialize(final Authentication authentication, final Proper\n         log(authentication, properties);\n         initControlPanelFacade(metricsConfiguration);\n         initCluster(cluster);\n+        updateServerInfo();\n+    }\n+    \n+    private static void updateServerInfo() {\n+        List<String> schemaNames = ProxySchemaContexts.getInstance().getSchemaNames();\n+        if (CollectionUtils.isEmpty(schemaNames)) {\n+            return;\n+        }\n+        Map<String, DataSource> dataSources = ProxySchemaContexts.getInstance().getSchema(schemaNames.get(0)).getSchema().getDataSources();\n+        DataSource singleDataSource = dataSources.values().iterator().next();\n+        try (Connection connection = singleDataSource.getConnection()) {\n+            DatabaseMetaData databaseMetaData = connection.getMetaData();\n+            String name = databaseMetaData.getDatabaseProductName();\n+            String version = databaseMetaData.getDatabaseProductVersion();\n+            log.info(\"server name {} , server version {}\", name, version);\n+            MySQLServerInfo.setServerVersion(version);\n+        } catch (final SQLException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNTg3MA=="}, "originalCommit": {"oid": "a2c8f52658a82312948736ff68ae3ed83978a57f"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 450, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}