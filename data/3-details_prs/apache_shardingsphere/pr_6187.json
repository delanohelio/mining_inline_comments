{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTYyMjM1", "number": 6187, "title": "Add port to proxy instance", "bodyText": "Fixes #6163\nChanges proposed in this pull request:\n\nupdate orchestration instance buildup to consume port\npass port from start config to instance buildup", "createdAt": "2020-06-25T17:32:54Z", "url": "https://github.com/apache/shardingsphere/pull/6187", "merged": true, "mergeCommit": {"oid": "44475589776548e9a1bcc6e982f5cb21c4a97092"}, "closed": true, "closedAt": "2020-07-10T03:19:19Z", "author": {"login": "swayamraina"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuyGd9gH2gAyNDQwMTYyMjM1OmQ5ZjcwNzE5ZjM0NWJkMTNiZGE4MDYyNDJhZGMxMDYzMzRkODRlMTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcza7sOgFqTQ0NjA5NzEwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d9f70719f345bd13bda806242adc106334d84e13", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/d9f70719f345bd13bda806242adc106334d84e13", "committedDate": "2020-06-25T17:28:55Z", "message": "update instance id to consume port info"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e330e9183724da01f9ffbe222e45f0718027c4c", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/6e330e9183724da01f9ffbe222e45f0718027c4c", "committedDate": "2020-06-25T17:30:06Z", "message": "pass port info to orchestration instance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7d44504d368d8f853b16d539e543237f9ddea0a", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/f7d44504d368d8f853b16d539e543237f9ddea0a", "committedDate": "2020-06-25T17:30:40Z", "message": "updated TCs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/3881ed6810094cdda5fb0da8a8760ea2148b1177", "committedDate": "2020-06-25T18:26:24Z", "message": "fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NjY2ODA0", "url": "https://github.com/apache/shardingsphere/pull/6187#pullrequestreview-438666804", "createdAt": "2020-06-27T02:58:08Z", "commit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QwMjo1ODowOVrOGpyuig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yN1QwMzoxMDo1MlrOGpyywA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3NTkxNA==", "bodyText": "UUID should be kept", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446475914", "createdAt": "2020-06-27T02:58:09Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java", "diffHunk": "@@ -30,21 +28,30 @@\n public final class OrchestrationInstance {\n     \n     private static final String DELIMITER = \"@\";\n-    \n-    private static final OrchestrationInstance INSTANCE = new OrchestrationInstance();\n+\n+    private static OrchestrationInstance instance;\n     \n     private final String instanceId;\n-    \n-    private OrchestrationInstance() {\n-        instanceId = IpUtils.getIp() + DELIMITER + ManagementFactory.getRuntimeMXBean().getName().split(DELIMITER)[0] + DELIMITER + UUID.randomUUID().toString();\n+\n+    public OrchestrationInstance(final int port) {\n+        instanceId = IpUtils.getIp() + DELIMITER + port;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3NjUxMQ==", "bodyText": "OrchestrationShardingSphereDataSource is provided for sharding-jdbc, can not specify a fixed port , sharding-jdbc should still retain threadId as the unique identifier of the instance.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446476511", "createdAt": "2020-06-27T03:05:08Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-jdbc/shardingsphere-jdbc-orchestration/src/main/java/org/apache/shardingsphere/driver/orchestration/internal/datasource/OrchestrationShardingSphereDataSource.java", "diffHunk": "@@ -69,7 +69,7 @@\n     private ShardingSphereDataSource dataSource;\n     \n     public OrchestrationShardingSphereDataSource(final OrchestrationConfiguration orchestrationConfig) throws SQLException {\n-        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME)));\n+        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME), 3307));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3NjU3MQ==", "bodyText": "Same as above.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446476571", "createdAt": "2020-06-27T03:05:34Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-jdbc/shardingsphere-jdbc-orchestration/src/main/java/org/apache/shardingsphere/driver/orchestration/internal/datasource/OrchestrationShardingSphereDataSource.java", "diffHunk": "@@ -82,7 +82,7 @@ public OrchestrationShardingSphereDataSource(final OrchestrationConfiguration or\n     }\n     \n     public OrchestrationShardingSphereDataSource(final ShardingSphereDataSource shardingSphereDataSource, final OrchestrationConfiguration orchestrationConfig) {\n-        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME)));\n+        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME), 3307));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3NjU4OA==", "bodyText": "Same as above.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446476588", "createdAt": "2020-06-27T03:05:51Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-jdbc/shardingsphere-jdbc-orchestration/src/main/java/org/apache/shardingsphere/driver/orchestration/internal/datasource/OrchestrationShardingSphereDataSource.java", "diffHunk": "@@ -92,7 +92,7 @@ public OrchestrationShardingSphereDataSource(final ShardingSphereDataSource shar\n     }\n     \n     public OrchestrationShardingSphereDataSource(final OrchestrationConfiguration orchestrationConfig, final ClusterConfiguration clusterConfiguration) throws SQLException {\n-        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME)));\n+        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME), 3307));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3NjU5Ng==", "bodyText": "Same as above.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446476596", "createdAt": "2020-06-27T03:06:04Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-jdbc/shardingsphere-jdbc-orchestration/src/main/java/org/apache/shardingsphere/driver/orchestration/internal/datasource/OrchestrationShardingSphereDataSource.java", "diffHunk": "@@ -106,7 +106,7 @@ public OrchestrationShardingSphereDataSource(final OrchestrationConfiguration or\n     \n     public OrchestrationShardingSphereDataSource(final ShardingSphereDataSource shardingSphereDataSource,\n                                                  final OrchestrationConfiguration orchestrationConfig, final ClusterConfiguration clusterConfiguration) {\n-        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME)));\n+        super(new ShardingOrchestrationFacade(orchestrationConfig, Collections.singletonList(DefaultSchema.LOGIC_NAME), 3307));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQ3Njk5Mg==", "bodyText": "ShardingOrchestrationFacade is provided to both proxy and sharding-jdbc, may be the variable defined as port is not suitable, It should describe a unique identifier of the orchestration instance, for proxy, it's a port, and for sharding-jdbc, it's a threadId.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r446476992", "createdAt": "2020-06-27T03:10:52Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-facade/src/main/java/org/apache/shardingsphere/orchestration/core/facade/ShardingOrchestrationFacade.java", "diffHunk": "@@ -81,7 +81,7 @@\n     \n     private final ShardingOrchestrationListenerManager listenerManager;\n     \n-    public ShardingOrchestrationFacade(final OrchestrationConfiguration orchestrationConfig, final Collection<String> shardingSchemaNames) {\n+    public ShardingOrchestrationFacade(final OrchestrationConfiguration orchestrationConfig, final Collection<String> shardingSchemaNames, final int port) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3881ed6810094cdda5fb0da8a8760ea2148b1177"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22697e8e4de7ef66a24bdf6764da04d06c6e8226", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/22697e8e4de7ef66a24bdf6764da04d06c6e8226", "committedDate": "2020-06-30T17:03:28Z", "message": "add uuid"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ea50396322bb430604ace28bac419fed3a9b213", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/8ea50396322bb430604ace28bac419fed3a9b213", "committedDate": "2020-06-30T17:04:44Z", "message": "use id instead of port"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ccc48c028bd7746b3ae4814fcf13652e8446d87", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/9ccc48c028bd7746b3ae4814fcf13652e8446d87", "committedDate": "2020-06-30T17:05:34Z", "message": "pass thread-id for data-source"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3160b6814766d0e8a8da2d0ee91d941ef1e7c87", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/d3160b6814766d0e8a8da2d0ee91d941ef1e7c87", "committedDate": "2020-06-30T19:00:12Z", "message": "fixed styling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9adf6aeeeba7afff2f140a175365cc05c5ebcd56", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/9adf6aeeeba7afff2f140a175365cc05c5ebcd56", "committedDate": "2020-07-01T03:45:12Z", "message": "resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dd78e8268602421856810deda836f03f5089393", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/0dd78e8268602421856810deda836f03f5089393", "committedDate": "2020-07-01T03:51:41Z", "message": "resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd381bfbdab4c4e39b1fde948df23444e6c605d", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/9bd381bfbdab4c4e39b1fde948df23444e6c605d", "committedDate": "2020-07-01T03:59:30Z", "message": "resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b6649f0e6ef7005464155b2766f0ff7bbe53d1c", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/4b6649f0e6ef7005464155b2766f0ff7bbe53d1c", "committedDate": "2020-07-01T04:00:56Z", "message": "resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "061d91ea3a30eb11b82db7da7a7972883d2ef239", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/061d91ea3a30eb11b82db7da7a7972883d2ef239", "committedDate": "2020-07-01T15:07:05Z", "message": "Merge branch 'master' into add-port-to-proxy-instance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/df10436ed059b3b3c7ad84b5e5081a52f3737a17", "committedDate": "2020-07-01T15:21:58Z", "message": "remove unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzg1NTA0", "url": "https://github.com/apache/shardingsphere/pull/6187#pullrequestreview-441385504", "createdAt": "2020-07-02T06:34:29Z", "commit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjozNDozMFrOGr_OGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjo1NDozN1rOGr_vPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3Nzc1Mw==", "bodyText": "The parameter identifier cannot correctly describe the meaning of orchestration instance unique identification,  my suggestion is instanceId, and i think it's better to define it as String type.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448777753", "createdAt": "2020-07-02T06:34:30Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-facade/src/main/java/org/apache/shardingsphere/orchestration/core/facade/ShardingOrchestrationFacade.java", "diffHunk": "@@ -81,7 +81,7 @@\n     \n     private final ShardingOrchestrationListenerManager listenerManager;\n     \n-    public ShardingOrchestrationFacade(final OrchestrationConfiguration orchestrationConfig, final Collection<String> shardingSchemaNames) {\n+    public ShardingOrchestrationFacade(final OrchestrationConfiguration orchestrationConfig, final Collection<String> shardingSchemaNames, final int identifier) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3ODE5Mw==", "bodyText": "Same as above.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448778193", "createdAt": "2020-07-02T06:35:33Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/RegistryCenter.java", "diffHunk": "@@ -34,11 +34,11 @@\n     private final RegistryCenterRepository repository;\n     \n     private final OrchestrationInstance instance;\n-    \n-    public RegistryCenter(final String name, final RegistryCenterRepository registryCenterRepository) {\n+\n+    public RegistryCenter(final String name, final int port, final RegistryCenterRepository registryCenterRepository) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4Mjg1Mg==", "bodyText": "This method is unnecessary.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448782852", "createdAt": "2020-07-02T06:46:51Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java", "diffHunk": "@@ -29,21 +28,30 @@\n public final class OrchestrationInstance {\n     \n     private static final String DELIMITER = \"@\";\n-    \n-    private static final OrchestrationInstance INSTANCE = new OrchestrationInstance();\n+\n+    private static OrchestrationInstance instance;\n     \n     private final String instanceId;\n-    \n-    private OrchestrationInstance() {\n-        instanceId = IpUtils.getIp() + DELIMITER + ManagementFactory.getRuntimeMXBean().getName().split(DELIMITER)[0] + DELIMITER + UUID.randomUUID().toString();\n+\n+    public OrchestrationInstance(final int identifier) {\n+        instanceId = IpUtils.getIp() + DELIMITER + identifier + DELIMITER + UUID.randomUUID().toString();\n     }\n-    \n+\n     /**\n      * Get instance.\n-     * \n-     * @return instance\n+     *\n+     * @param   identifier  identifier on which the instance is running\n+     * @return  instance    the orchestration instance\n      */\n-    public static OrchestrationInstance getInstance() {\n-        return INSTANCE;\n+    public static OrchestrationInstance getInstance(final int identifier) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4MzQ2OA==", "bodyText": "How about add instance = this;", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448783468", "createdAt": "2020-07-02T06:48:10Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java", "diffHunk": "@@ -29,21 +28,30 @@\n public final class OrchestrationInstance {\n     \n     private static final String DELIMITER = \"@\";\n-    \n-    private static final OrchestrationInstance INSTANCE = new OrchestrationInstance();\n+\n+    private static OrchestrationInstance instance;\n     \n     private final String instanceId;\n-    \n-    private OrchestrationInstance() {\n-        instanceId = IpUtils.getIp() + DELIMITER + ManagementFactory.getRuntimeMXBean().getName().split(DELIMITER)[0] + DELIMITER + UUID.randomUUID().toString();\n+\n+    public OrchestrationInstance(final int identifier) {\n+        instanceId = IpUtils.getIp() + DELIMITER + identifier + DELIMITER + UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4MzczNA==", "bodyText": "this.instance = new OrchestrationInstance(port);", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448783734", "createdAt": "2020-07-02T06:48:51Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/RegistryCenter.java", "diffHunk": "@@ -34,11 +34,11 @@\n     private final RegistryCenterRepository repository;\n     \n     private final OrchestrationInstance instance;\n-    \n-    public RegistryCenter(final String name, final RegistryCenterRepository registryCenterRepository) {\n+\n+    public RegistryCenter(final String name, final int port, final RegistryCenterRepository registryCenterRepository) {\n         this.node = new RegistryCenterNode(name);\n         this.repository = registryCenterRepository;\n-        this.instance = OrchestrationInstance.getInstance();\n+        this.instance = OrchestrationInstance.getInstance(port);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4NTQ3MQ==", "bodyText": "The port is unnecessary.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448785471", "createdAt": "2020-07-02T06:52:46Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/listener/InstanceStateChangedListener.java", "diffHunk": "@@ -35,8 +35,8 @@\n  */\n public final class InstanceStateChangedListener extends PostShardingCenterRepositoryEventListener {\n     \n-    public InstanceStateChangedListener(final String name, final RegistryCenterRepository registryCenterRepository) {\n-        super(registryCenterRepository, Collections.singleton(new RegistryCenterNode(name).getInstancesNodeFullPath(OrchestrationInstance.getInstance().getInstanceId())));\n+    public InstanceStateChangedListener(final String name, final int port, final RegistryCenterRepository registryCenterRepository) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4NTg0Ng==", "bodyText": "OrchestrationInstance.getInstance().getInstanceId()", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448785846", "createdAt": "2020-07-02T06:53:39Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/listener/InstanceStateChangedListener.java", "diffHunk": "@@ -35,8 +35,8 @@\n  */\n public final class InstanceStateChangedListener extends PostShardingCenterRepositoryEventListener {\n     \n-    public InstanceStateChangedListener(final String name, final RegistryCenterRepository registryCenterRepository) {\n-        super(registryCenterRepository, Collections.singleton(new RegistryCenterNode(name).getInstancesNodeFullPath(OrchestrationInstance.getInstance().getInstanceId())));\n+    public InstanceStateChangedListener(final String name, final int port, final RegistryCenterRepository registryCenterRepository) {\n+        super(registryCenterRepository, Collections.singleton(new RegistryCenterNode(name).getInstancesNodeFullPath(OrchestrationInstance.getInstance(port).getInstanceId())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc4NjIzOA==", "bodyText": "The port is unnecessary.", "url": "https://github.com/apache/shardingsphere/pull/6187#discussion_r448786238", "createdAt": "2020-07-02T06:54:37Z", "author": {"login": "menghaoranss"}, "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/listener/RegistryListenerManager.java", "diffHunk": "@@ -29,8 +29,8 @@\n     \n     private final DataSourceStateChangedListener dataSourceStateChangedListener;\n     \n-    public RegistryListenerManager(final String name, final RegistryCenterRepository registryCenterRepository) {\n-        instanceStateChangedListener = new InstanceStateChangedListener(name, registryCenterRepository);\n+    public RegistryListenerManager(final String name, final int port, final RegistryCenterRepository registryCenterRepository) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df10436ed059b3b3c7ad84b5e5081a52f3737a17"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "392bd6fd5221e5b24f7b6e535f751334fade46fd", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/392bd6fd5221e5b24f7b6e535f751334fade46fd", "committedDate": "2020-07-06T08:51:49Z", "message": "updated TC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee866694f1d3a7acf8393f99d0503aa0331c84cb", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/ee866694f1d3a7acf8393f99d0503aa0331c84cb", "committedDate": "2020-07-06T08:52:17Z", "message": "updated implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9920914965fbe3747070fcfac157a035e51f6025", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/9920914965fbe3747070fcfac157a035e51f6025", "committedDate": "2020-07-06T08:53:56Z", "message": "make thread-id a string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb785568953f75c72af1e4203bbe32d6ed0f5a2c", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/fb785568953f75c72af1e4203bbe32d6ed0f5a2c", "committedDate": "2020-07-06T08:54:53Z", "message": "rename to instanceTag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e072722d828e3d12ed3b5e10fcd5cbc817ff8a36", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/e072722d828e3d12ed3b5e10fcd5cbc817ff8a36", "committedDate": "2020-07-09T10:36:47Z", "message": "merge from master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20b3e1474bf49a9f7d2670e76410e3377c95c55d", "author": {"user": {"login": "swayamraina", "name": "Swayam Raina"}}, "url": "https://github.com/apache/shardingsphere/commit/20b3e1474bf49a9f7d2670e76410e3377c95c55d", "committedDate": "2020-07-09T10:37:59Z", "message": "update singleton istance impl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDk3MTA2", "url": "https://github.com/apache/shardingsphere/pull/6187#pullrequestreview-446097106", "createdAt": "2020-07-10T03:18:57Z", "commit": {"oid": "20b3e1474bf49a9f7d2670e76410e3377c95c55d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4900, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}