{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNTM3Nzgz", "number": 5413, "title": "optimize integrate framework", "bodyText": "for #5301\n\ndisplay raw sql in parametrized test\nprint test context when assertion error occur", "createdAt": "2020-05-03T02:31:38Z", "url": "https://github.com/apache/shardingsphere/pull/5413", "merged": true, "mergeCommit": {"oid": "8d1561fb56e8951279196f6303066935dae0fe69"}, "closed": true, "closedAt": "2020-05-03T03:32:32Z", "author": {"login": "cherrylzhao"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdX48ZAH2gAyNDEyNTM3NzgzOjkxZTViOTc3OGQ1ZmEzZDA5ZGMzMDc2ZWJhZGMwNTFhZTE3NzU5NzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdiXiXAFqTQwNDU3ODQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "91e5b9778d5fa3d09dc3076ebadc051ae1775972", "author": {"user": {"login": "cherrylzhao", "name": "zhaojun"}}, "url": "https://github.com/apache/shardingsphere/commit/91e5b9778d5fa3d09dc3076ebadc051ae1775972", "committedDate": "2020-05-02T15:19:54Z", "message": "display raw sql in parametrized test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6145c661ade4dcb687f7178e715d9ee5f8f7acfd", "author": {"user": {"login": "cherrylzhao", "name": "zhaojun"}}, "url": "https://github.com/apache/shardingsphere/commit/6145c661ade4dcb687f7178e715d9ee5f8f7acfd", "committedDate": "2020-05-02T15:21:06Z", "message": "for checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "395263ba13476b98c218b6557d1addeb42f7b2a3", "author": {"user": {"login": "cherrylzhao", "name": "zhaojun"}}, "url": "https://github.com/apache/shardingsphere/commit/395263ba13476b98c218b6557d1addeb42f7b2a3", "committedDate": "2020-05-03T02:24:55Z", "message": "print test context when assertion error occur"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTc3NDY4", "url": "https://github.com/apache/shardingsphere/pull/5413#pullrequestreview-404577468", "createdAt": "2020-05-03T03:07:27Z", "commit": {"oid": "395263ba13476b98c218b6557d1addeb42f7b2a3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QwMzowNzoyN1rOGPoHWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QwMzowODo0NFrOGPoHqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAzOTA2NQ==", "bodyText": "final maybe unnecessary", "url": "https://github.com/apache/shardingsphere/pull/5413#discussion_r419039065", "createdAt": "2020-05-03T03:07:27Z", "author": {"login": "terrymanu"}, "path": "sharding-integration-test/sharding-jdbc-test/src/test/java/org/apache/shardingsphere/dbtest/engine/SingleIT.java", "diffHunk": "@@ -39,13 +42,29 @@\n     \n     private final String sql;\n     \n+    private final String originalSQL;\n+    \n     public SingleIT(final String path, final IntegrateTestCaseAssertion assertion, final String ruleType,\n                     final DatabaseType databaseType, final SQLCaseType caseType, final String sql) throws IOException, JAXBException, SQLException, ParseException {\n         super(ruleType, databaseType);\n         this.assertion = assertion;\n         this.caseType = caseType;\n-        this.sql = sql;\n+        this.originalSQL = sql;\n+        this.sql = convert(sql);\n         expectedDataFile = getExpectedDataFile(path, ruleType, databaseType, null != assertion ? assertion.getExpectedDataFile() : null);\n     }\n+    \n+    private String convert(final String sql) throws ParseException {\n+        return caseType == SQLCaseType.Literal ? getLiteralSQL(sql) : sql;\n+    }\n+    \n+    private String getLiteralSQL(final String sql) throws ParseException {\n+        final List<Object> parameters = null != assertion ? assertion.getSQLValues().stream().map(SQLValue::toString).collect(Collectors.toList()) : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "395263ba13476b98c218b6557d1addeb42f7b2a3"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAzOTE0Ng==", "bodyText": "\\n should be LINE_SEPARATOR", "url": "https://github.com/apache/shardingsphere/pull/5413#discussion_r419039146", "createdAt": "2020-05-03T03:08:44Z", "author": {"login": "terrymanu"}, "path": "sharding-integration-test/sharding-jdbc-test/src/test/java/org/apache/shardingsphere/dbtest/engine/util/IntegrateTestParameters.java", "diffHunk": "@@ -168,7 +152,7 @@ private static void printTestPlan(final Map<DatabaseType, Collection<Object[]>>\n             disabledPlan.add(String.format(\"%s(%s)\", entry.getKey().getName(), entry.getValue().size() * factor));\n         }\n         System.out.println(\"[INFO] ======= Test Plan =======\");\n-        String summary = String.format(\"[%s] Total: %s, Active: %s, Disabled: %s\",\n+        String summary = String.format(\"[%s] Total: %s, Active: %s, Disabled: %s \\n\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "395263ba13476b98c218b6557d1addeb42f7b2a3"}, "originalPosition": 63}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "821c792573227c27fefe99a6b76f9665c395b7bc", "author": {"user": {"login": "cherrylzhao", "name": "zhaojun"}}, "url": "https://github.com/apache/shardingsphere/commit/821c792573227c27fefe99a6b76f9665c395b7bc", "committedDate": "2020-05-03T03:19:55Z", "message": "for checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTc4NDM5", "url": "https://github.com/apache/shardingsphere/pull/5413#pullrequestreview-404578439", "createdAt": "2020-05-03T03:32:22Z", "commit": {"oid": "821c792573227c27fefe99a6b76f9665c395b7bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3634, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}