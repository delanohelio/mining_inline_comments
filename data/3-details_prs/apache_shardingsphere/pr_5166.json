{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyNTk4NDE1", "number": 5166, "title": "Optimize MetaData Center #MetaDataCenter-phase-3-4", "bodyText": "For #5128 .\nChanges proposed in this pull request:\n\nAdd metadata center documents", "createdAt": "2020-04-13T11:15:10Z", "url": "https://github.com/apache/shardingsphere/pull/5166", "merged": true, "mergeCommit": {"oid": "05b6673eb2bfc3a0bfe53717a8526cb287875b5e"}, "closed": true, "closedAt": "2020-04-13T15:53:49Z", "author": {"login": "menghaoranss"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXMhffgH2gAyNDAyNTk4NDE1OjBmNDVmOWY4OTNkNDNkMzMwNWY0N2E1MzJlMGM0YjFmNDJhZjA5NTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXQ8CgAFqTM5MjIzMjgxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0f45f9f893d43d3305f47a532e0c4b1f42af0956", "author": {"user": {"login": "menghaoranss", "name": "Haoran Meng"}}, "url": "https://github.com/apache/shardingsphere/commit/0f45f9f893d43d3305f47a532e0c4b1f42af0956", "committedDate": "2020-04-13T10:41:47Z", "message": "for issue 5128, add metadata center docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ef762c68e85a5991466842040ca38f7ac6beff6", "author": {"user": {"login": "menghaoranss", "name": "Haoran Meng"}}, "url": "https://github.com/apache/shardingsphere/commit/9ef762c68e85a5991466842040ca38f7ac6beff6", "committedDate": "2020-04-13T11:06:55Z", "message": "for issue 5128, add empty lines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797", "author": {"user": {"login": "menghaoranss", "name": "Haoran Meng"}}, "url": "https://github.com/apache/shardingsphere/commit/0ef9ab39bdb2121c6773af97c96540bc554fc797", "committedDate": "2020-04-13T11:12:58Z", "message": "for issue 5128, revise documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMDk2MzI3", "url": "https://github.com/apache/shardingsphere/pull/5166#pullrequestreview-392096327", "createdAt": "2020-04-13T11:37:27Z", "commit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMTozNzoyN1rOGEkGhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMTo0MzoyM1rOGEkNMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQzODk4Mw==", "bodyText": "config/registry/metadata center", "url": "https://github.com/apache/shardingsphere/pull/5166#discussion_r407438983", "createdAt": "2020-04-13T11:37:27Z", "author": {"login": "kimmking"}, "path": "docs/document/content/features/orchestration/_index.en.md", "diffHunk": "@@ -7,4 +7,4 @@ chapter = true\n \n ## Navigation\n \n-Provide orchestration of config/registry center(and metadata center in plan), dynamic configuration, database & application disabling, and APM.\n+Provide orchestration of config/registry center/metadata center, dynamic configuration, database & application disabling, and APM.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ0MDI4NQ==", "bodyText": "\u901a\u8fc7\u67d0\u4e00\u4e2aProxy\u5b9e\u4f8b\u6267\u884cDDL\u4ee5\u540e\uff0c\u7cfb\u7edf\u5148\u5c06\u65b0\u7684\u5143\u6570\u636e\u5b58\u50a8\u5230\u5143\u6570\u636e\u4e2d\u5fc3\uff0c\u7136\u540e\u901a\u8fc7\u4e8b\u4ef6\u5e7f\u64ad\u673a\u5236\uff0c\u901a\u77e5\u5176\u5b83Proxy\u5b9e\u4f8b\u4ece\u6e90\u6570\u636e\u5e93\u4e2d\u5fc3\u540c\u6b65\u5143\u6570\u636e\uff0c\u4fdd\u8bc1\u5143\u6570\u636e\u4e00\u81f4\u3002", "url": "https://github.com/apache/shardingsphere/pull/5166#discussion_r407440285", "createdAt": "2020-04-13T11:42:06Z", "author": {"login": "kimmking"}, "path": "docs/document/content/features/orchestration/metadata-center.cn.md", "diffHunk": "@@ -0,0 +1,103 @@\n++++\n+pre = \"<b>3.3.3. </b>\"\n+toc = true\n+title = \"\u5143\u6570\u636e\u4e2d\u5fc3\"\n+weight = 3\n++++\n+\n+## \u5b9e\u73b0\u52a8\u673a\n+\n+- \u5143\u6570\u636e\u662fSharding-JDBC/Sharding-Proxy\u6240\u4f7f\u7528\u7684\u6570\u636e\u6e90\u7684\u8868\u3001\u5217\u548c\u7d22\u5f15\u7b49\u6838\u5fc3\u6570\u636e\uff0c\u5143\u6570\u636e\u4fdd\u969cShardingSphere\u5404\u4e2a\u7ec4\u4ef6\u80fd\u591f\u6b63\u786e\u8fd0\u884c\u3002\n+\n+- \u5143\u6570\u636e\u4e2d\u5fc3\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u7edf\u4e00\u7ec4\u7ec7\u548c\u7ba1\u7406\uff0c\u5b9e\u73b0\u5143\u6570\u636e\u7684\u7edf\u4e00\u52a0\u8f7d\u3001\u53d8\u66f4\u901a\u77e5\u548c\u6570\u636e\u540c\u6b65\u3002\n+\n+## \u5143\u6570\u636e\u4e2d\u5fc3\u6570\u636e\u7ed3\u6784\n+\n+\u5143\u6570\u636e\u4e2d\u5fc3\u5728\u5b9a\u4e49\u7684\u547d\u540d\u7a7a\u95f4\u7684metadata\u8282\u70b9\u4e0b\uff0c\u4ee5YAML\u683c\u5f0f\u5b58\u50a8\uff0c\u6bcf\u4e2a\u903b\u8f91\u6570\u636e\u6e90\u72ec\u7acb\u5b58\u50a8\u3002\n+\n+```\n+metadata\n+    \u251c\u2500\u2500schema1\n+    \u251c      \u251c\u2500\u2500 [YAML text contents]     \n+    \u251c\u2500\u2500schema2\n+    \u251c      \u251c\u2500\u2500 [YAML text contents]    \n+    \u251c\u2500\u2500....\n+```\n+\n+## YAML Text Contents\n+\n+\u5728\u5143\u6570\u636e\u4e2d\u5fc3\u4e2d\uff0c\u5143\u6570\u636e\u5206\u4e3a `configuredSchemaMetaData` \u548c `unconfiguredSchemaMetaDataMap` \u4e24\u90e8\u5206\u3002\n+\n+\u5143\u6570\u636e\u5185\u5bb9\u76ee\u524d\u4e0d\u652f\u6301\u52a8\u6001\u4fee\u6539\u3002\n+\n+```\n+configuredSchemaMetaData:\n+  tables:                                       # \u8868\n+    t_order:                                    # \u8868\u540d\n+      columns:                                  # \u5217\n+        id:                                     # \u5217\u540d\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: id\n+          primaryKey: trues\n+        order_id:\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: order_id\n+          primaryKey: false\n+      indexs:                                   # \u7d22\u5f15\n+        t_user_order_id_index:                  # \u7d22\u5f15\u540d\n+          name: t_user_order_id_index\n+    t_order_item:\n+      columns:\n+        order_id:\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: order_id\n+          primaryKey: false\n+unconfiguredSchemaMetaDataMap:\n+  ds_0:                                         # \u6570\u636e\u6e90\n+    tables:                                     # \u8868\n+      t_user:                                   # \u8868\u540d\n+        columns:                                # \u5217\n+          user_id:                              # \u5217\u540d\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: user_id\n+            primaryKey: false\n+          id:\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: id\n+            primaryKey: true\n+          order_id:\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: order_id\n+            primaryKey: false\n+        indexes:                                # \u7d22\u5f15\n+          t_user_order_id_index:                # \u7d22\u5f15\u540d\n+            name: t_user_order_id_index\n+          t_user_user_id_index:\n+            name: t_user_user_id_index\n+          primary:\n+            name: PRIMARY\n+```\n+\n+### configuredSchemaMetaData\n+\n+\u5b58\u50a8\u6240\u6709\u914d\u7f6e\u4e86\u5206\u7247\u89c4\u5219\u7684\u6570\u636e\u6e90\u7684\u5143\u6570\u636e\u3002\n+\n+### unconfiguredSchemaMetaDataMap\n+\n+\u5b58\u50a8\u6ca1\u6709\u914d\u7f6e\u5206\u7247\u89c4\u5219\u7684\u6570\u636e\u6e90\u7684\u5143\u6570\u636e\u3002\n+\n+## \u53d8\u66f4\u901a\u77e5\n+\n+\u901a\u8fc7\u67d0\u4e00\u4e2aProxy\u5b9e\u4f8b\u6267\u884cDDL\u4ee5\u540e\uff0c\u5143\u6570\u636e\u4e2d\u5fc3\u901a\u8fc7\u4e8b\u4ef6\u673a\u5236\uff0c\u901a\u77e5\u5176\u5b83Proxy\u5b9e\u4f8b\u91cd\u65b0\u52a0\u8f7d\u5143\u6570\u636e\uff0c\u4fdd\u8bc1\u5143\u6570\u636e\u4e00\u81f4\u3002", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ0MDQyMw==", "bodyText": "Sharding-JDBC/Sharding-Proxy", "url": "https://github.com/apache/shardingsphere/pull/5166#discussion_r407440423", "createdAt": "2020-04-13T11:42:32Z", "author": {"login": "kimmking"}, "path": "docs/document/content/features/orchestration/metadata-center.en.md", "diffHunk": "@@ -0,0 +1,103 @@\n++++\n+pre = \"<b>3.3.3. </b>\"\n+toc = true\n+title = \"Metadata Center\"\n+weight = 3\n++++\n+\n+## Motivation\n+\n+- Metadata is the core data of the data source used by Sharding-JDBC / Sharding-Proxy, which contains tables, columns, and indexes, etc. Metadata ensures that each component of ShardingSphere can run correctly.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ0MDYxNg==", "bodyText": "missing namespace&orchestration node\uff1f", "url": "https://github.com/apache/shardingsphere/pull/5166#discussion_r407440616", "createdAt": "2020-04-13T11:43:08Z", "author": {"login": "kimmking"}, "path": "docs/document/content/features/orchestration/metadata-center.cn.md", "diffHunk": "@@ -0,0 +1,103 @@\n++++\n+pre = \"<b>3.3.3. </b>\"\n+toc = true\n+title = \"\u5143\u6570\u636e\u4e2d\u5fc3\"\n+weight = 3\n++++\n+\n+## \u5b9e\u73b0\u52a8\u673a\n+\n+- \u5143\u6570\u636e\u662fSharding-JDBC/Sharding-Proxy\u6240\u4f7f\u7528\u7684\u6570\u636e\u6e90\u7684\u8868\u3001\u5217\u548c\u7d22\u5f15\u7b49\u6838\u5fc3\u6570\u636e\uff0c\u5143\u6570\u636e\u4fdd\u969cShardingSphere\u5404\u4e2a\u7ec4\u4ef6\u80fd\u591f\u6b63\u786e\u8fd0\u884c\u3002\n+\n+- \u5143\u6570\u636e\u4e2d\u5fc3\u5bf9\u5143\u6570\u636e\u8fdb\u884c\u7edf\u4e00\u7ec4\u7ec7\u548c\u7ba1\u7406\uff0c\u5b9e\u73b0\u5143\u6570\u636e\u7684\u7edf\u4e00\u52a0\u8f7d\u3001\u53d8\u66f4\u901a\u77e5\u548c\u6570\u636e\u540c\u6b65\u3002\n+\n+## \u5143\u6570\u636e\u4e2d\u5fc3\u6570\u636e\u7ed3\u6784\n+\n+\u5143\u6570\u636e\u4e2d\u5fc3\u5728\u5b9a\u4e49\u7684\u547d\u540d\u7a7a\u95f4\u7684metadata\u8282\u70b9\u4e0b\uff0c\u4ee5YAML\u683c\u5f0f\u5b58\u50a8\uff0c\u6bcf\u4e2a\u903b\u8f91\u6570\u636e\u6e90\u72ec\u7acb\u5b58\u50a8\u3002\n+\n+```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ0MDY4OQ==", "bodyText": "as the above", "url": "https://github.com/apache/shardingsphere/pull/5166#discussion_r407440689", "createdAt": "2020-04-13T11:43:23Z", "author": {"login": "kimmking"}, "path": "docs/document/content/features/orchestration/metadata-center.en.md", "diffHunk": "@@ -0,0 +1,103 @@\n++++\n+pre = \"<b>3.3.3. </b>\"\n+toc = true\n+title = \"Metadata Center\"\n+weight = 3\n++++\n+\n+## Motivation\n+\n+- Metadata is the core data of the data source used by Sharding-JDBC / Sharding-Proxy, which contains tables, columns, and indexes, etc. Metadata ensures that each component of ShardingSphere can run correctly.\n+\n+- The metadata center organizes and manages the metadata in a unified manner to realize the unified loading of metadata, change notifications and data synchronization.\n+\n+## Data Structure in Metadata Center\n+\n+The metadata center stores metadata in YAML under the metadata node of the defined namespace, and each logical data source is stored independently.\n+\n+```\n+metadata\n+    \u251c\u2500\u2500schema1\n+    \u251c      \u251c\u2500\u2500 [YAML text contents]     \n+    \u251c\u2500\u2500schema2\n+    \u251c      \u251c\u2500\u2500 [YAML text contents]    \n+    \u251c\u2500\u2500....\n+```\n+\n+## YAML text contents\n+\n+In the metadata center, metadata is divided into two parts: `configuredSchemaMetaData` and` unconfiguredSchemaMetaDataMap`.\n+\n+Dynamic modification of metadata content is not supported currently.\n+\n+```\n+configuredSchemaMetaData:\n+  tables:                                       # Tables\n+    t_order:                                    # table_name\n+      columns:                                  # Columns\n+        id:                                     # column_name\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: id\n+          primaryKey: trues\n+        order_id:\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: order_id\n+          primaryKey: false\n+      indexs:                                   # Indexes\n+        t_user_order_id_index:                  # index_name\n+          name: t_user_order_id_index\n+    t_order_item:\n+      columns:\n+        order_id:\n+          caseSensitive: false\n+          dataType: 0\n+          generated: false\n+          name: order_id\n+          primaryKey: false\n+unconfiguredSchemaMetaDataMap:\n+  ds_0:                                         # DataSources\n+    tables:                                     # Tables\n+      t_user:                                   # table_name\n+        columns:                                # Columns\n+          user_id:                              # column_name\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: user_id\n+            primaryKey: false\n+          id:\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: id\n+            primaryKey: true\n+          order_id:\n+            caseSensitive: false\n+            dataType: 0\n+            generated: false\n+            name: order_id\n+            primaryKey: false\n+        indexes:                                # Indexes\n+          t_user_order_id_index:                # index_name\n+            name: t_user_order_id_index\n+          t_user_user_id_index:\n+            name: t_user_user_id_index\n+          primary:\n+            name: PRIMARY\n+```\n+\n+### configuredSchemaMetaData\n+\n+Store metadata for all data sources configured with sharding rules.\n+\n+### unconfiguredSchemaMetaDataMap\n+\n+Store metadata for data sources that no sharding rules configured.\n+\n+## Change Notifications\n+\n+After DDL is executed through a certain Proxy instance, the metadata center notifies other Proxy instances to reload metadata through an event mechanism to ensure metadata consistency.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ef9ab39bdb2121c6773af97c96540bc554fc797"}, "originalPosition": 103}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f91f28ca35b455ebcbe520ba24b0c4ad0f2eb7e7", "author": {"user": {"login": "menghaoranss", "name": "Haoran Meng"}}, "url": "https://github.com/apache/shardingsphere/commit/f91f28ca35b455ebcbe520ba24b0c4ad0f2eb7e7", "committedDate": "2020-04-13T12:32:38Z", "message": "for issue 5128, revise documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjMyODE0", "url": "https://github.com/apache/shardingsphere/pull/5166#pullrequestreview-392232814", "createdAt": "2020-04-13T15:50:24Z", "commit": {"oid": "f91f28ca35b455ebcbe520ba24b0c4ad0f2eb7e7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3716, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}