{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMDcwMjQw", "number": 1034, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMjozMDo1MlrOD3K7nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMzowOFrOD3MT8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTc3MzczOnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/main/java/pro/taskana/task/internal/TaskCommentServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMjozMDo1MlrOGNRmpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMzo0MzoyM1rOGN_d_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU3MzA5Mg==", "bodyText": "Shouldn't we compare the current userid with the creator of the comment in the database?", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416573092", "createdAt": "2020-04-28T12:30:52Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/main/java/pro/taskana/task/internal/TaskCommentServiceImpl.java", "diffHunk": "@@ -70,7 +70,8 @@ TaskComment updateTaskComment(TaskComment taskCommentToUpdate)\n       taskService.getTask(taskCommentImplToUpdate.getTaskId());\n \n       if (taskCommentToUpdate.getCreator().equals(userId)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzMyNDU0MQ==", "bodyText": "Indeed. Will fix this in a separate ticket though", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r417324541", "createdAt": "2020-04-29T13:43:23Z", "author": {"login": "gitgoodjhe"}, "path": "lib/taskana-core/src/main/java/pro/taskana/task/internal/TaskCommentServiceImpl.java", "diffHunk": "@@ -70,7 +70,8 @@ TaskComment updateTaskComment(TaskComment taskCommentToUpdate)\n       taskService.getTask(taskCommentImplToUpdate.getTaskId());\n \n       if (taskCommentToUpdate.getCreator().equals(userId)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU3MzA5Mg=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTkyMDk2OnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/main/java/pro/taskana/workbasket/internal/WorkbasketServiceImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzowNTo1MFrOGNTAWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzowNTo1MFrOGNTAWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU5NjA1Nw==", "bodyText": "Do we need this? Since this is not directly task related I would question this part", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416596057", "createdAt": "2020-04-28T13:05:50Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/main/java/pro/taskana/workbasket/internal/WorkbasketServiceImpl.java", "diffHunk": "@@ -75,7 +75,9 @@ public Workbasket getWorkbasket(String workbasketId)\n         throw new WorkbasketNotFoundException(\n             workbasketId, \"Workbasket with id \" + workbasketId + \" was not found.\");\n       }\n-      if (!taskanaEngine.getEngine().isUserInRole(TaskanaRole.ADMIN, TaskanaRole.BUSINESS_ADMIN)) {\n+      if (!taskanaEngine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk1MDYxOnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/task/DeleteTaskCommentAccTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoxMjoxNlrOGNTSSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwODo0Mjo1MlrOGRJXqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwMDY1MA==", "bodyText": "Do we have dependencies between the tests?", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416600650", "createdAt": "2020-04-28T13:12:16Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/task/DeleteTaskCommentAccTest.java", "diffHunk": "@@ -53,18 +55,41 @@ void should_FailToDeleteTaskComment_When_UserHasNoAuthorization()\n     TaskService taskService = taskanaEngine.getTaskService();\n \n     List<TaskComment> taskComments =\n-        taskService.getTaskComments(\"TKI:000000000000000000000000000000000002\");\n-    assertThat(taskComments).hasSize(2);\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskComments).hasSize(3);\n \n     ThrowingCallable lambda =\n-        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000005\");\n+        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000000\");\n \n     assertThatThrownBy(lambda).isInstanceOf(NotAuthorizedException.class);\n \n     // make sure the task comment was not deleted\n+    List<TaskComment> taskCommentsAfterDeletion =\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskCommentsAfterDeletion).hasSize(3);\n+  }\n+\n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_DeleteTaskComment_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws NotAuthorizedException, TaskNotFoundException, TaskCommentNotFoundException,\n+                 InvalidArgumentException, SQLException {\n+\n+    resetDb(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzMyNDQ1MA==", "bodyText": "This test runs twice. It deletes a task comment which can't be deleted twice, so a reset is necessary.", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r417324450", "createdAt": "2020-04-29T13:43:17Z", "author": {"login": "gitgoodjhe"}, "path": "lib/taskana-core/src/test/java/acceptance/task/DeleteTaskCommentAccTest.java", "diffHunk": "@@ -53,18 +55,41 @@ void should_FailToDeleteTaskComment_When_UserHasNoAuthorization()\n     TaskService taskService = taskanaEngine.getTaskService();\n \n     List<TaskComment> taskComments =\n-        taskService.getTaskComments(\"TKI:000000000000000000000000000000000002\");\n-    assertThat(taskComments).hasSize(2);\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskComments).hasSize(3);\n \n     ThrowingCallable lambda =\n-        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000005\");\n+        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000000\");\n \n     assertThatThrownBy(lambda).isInstanceOf(NotAuthorizedException.class);\n \n     // make sure the task comment was not deleted\n+    List<TaskComment> taskCommentsAfterDeletion =\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskCommentsAfterDeletion).hasSize(3);\n+  }\n+\n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_DeleteTaskComment_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws NotAuthorizedException, TaskNotFoundException, TaskCommentNotFoundException,\n+                 InvalidArgumentException, SQLException {\n+\n+    resetDb(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwMDY1MA=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDYzMDIxNQ==", "bodyText": "Each invocation of a test template method behaves like the execution of a regular @test method with full support for the same lifecycle callbacks and extensions.\n\nhttps://junit.org/junit5/docs/current/user-guide/#writing-tests-test-templates\nNo manual reset needed ;)", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r420630215", "createdAt": "2020-05-06T08:38:55Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/test/java/acceptance/task/DeleteTaskCommentAccTest.java", "diffHunk": "@@ -53,18 +55,41 @@ void should_FailToDeleteTaskComment_When_UserHasNoAuthorization()\n     TaskService taskService = taskanaEngine.getTaskService();\n \n     List<TaskComment> taskComments =\n-        taskService.getTaskComments(\"TKI:000000000000000000000000000000000002\");\n-    assertThat(taskComments).hasSize(2);\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskComments).hasSize(3);\n \n     ThrowingCallable lambda =\n-        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000005\");\n+        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000000\");\n \n     assertThatThrownBy(lambda).isInstanceOf(NotAuthorizedException.class);\n \n     // make sure the task comment was not deleted\n+    List<TaskComment> taskCommentsAfterDeletion =\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskCommentsAfterDeletion).hasSize(3);\n+  }\n+\n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_DeleteTaskComment_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws NotAuthorizedException, TaskNotFoundException, TaskCommentNotFoundException,\n+                 InvalidArgumentException, SQLException {\n+\n+    resetDb(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwMDY1MA=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDYzMjQ4OQ==", "bodyText": "I see the issue: resetDb(..) is executed once for each TestClass.\nIdea:\nDepending on the current user try to delete a different ID and provide two Ids within the test-data", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r420632489", "createdAt": "2020-05-06T08:42:52Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/test/java/acceptance/task/DeleteTaskCommentAccTest.java", "diffHunk": "@@ -53,18 +55,41 @@ void should_FailToDeleteTaskComment_When_UserHasNoAuthorization()\n     TaskService taskService = taskanaEngine.getTaskService();\n \n     List<TaskComment> taskComments =\n-        taskService.getTaskComments(\"TKI:000000000000000000000000000000000002\");\n-    assertThat(taskComments).hasSize(2);\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskComments).hasSize(3);\n \n     ThrowingCallable lambda =\n-        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000005\");\n+        () -> taskService.deleteTaskComment(\"TCI:000000000000000000000000000000000000\");\n \n     assertThatThrownBy(lambda).isInstanceOf(NotAuthorizedException.class);\n \n     // make sure the task comment was not deleted\n+    List<TaskComment> taskCommentsAfterDeletion =\n+        taskService.getTaskComments(\"TKI:000000000000000000000000000000000000\");\n+    assertThat(taskCommentsAfterDeletion).hasSize(3);\n+  }\n+\n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_DeleteTaskComment_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws NotAuthorizedException, TaskNotFoundException, TaskCommentNotFoundException,\n+                 InvalidArgumentException, SQLException {\n+\n+    resetDb(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwMDY1MA=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk2ODYwOnYy", "diffSide": "LEFT", "path": "lib/taskana-core/src/test/java/acceptance/task/TransferTaskAccTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoxNjoxMFrOGNTdSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoxNjoxMFrOGNTdSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwMzQ2NA==", "bodyText": "why did you delete this test?", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416603464", "createdAt": "2020-04-28T13:16:10Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/task/TransferTaskAccTest.java", "diffHunk": "@@ -134,21 +158,7 @@ void testTransferTaskDoesNotExist() {\n \n   @WithAccessId(user = \"teamlead_1\", groups = \"teamlead_1\")\n   @Test\n-  void testTransferNotAuthorizationOnWorkbasketTransfer() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 117}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk3OTU0OnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoxODozMFrOGNTjug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMzo0MzoxNFrOGN_dfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNTExNA==", "bodyText": "this should not be necessary if each test works own dedicated data sets.", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416605114", "createdAt": "2020-04-28T13:18:30Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "diffHunk": "@@ -129,6 +130,31 @@ void should_ThrowException_When_TaskHasAlreadyBeenUpdated()\n         .withFailMessage(\"The task has already been updated by another user\");\n   }\n \n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_UpdateTask_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws TaskNotFoundException, ClassificationNotFoundException, InvalidArgumentException,\n+                 ConcurrencyException, NotAuthorizedException, AttachmentPersistenceException,\n+                 InvalidStateException, SQLException {\n+\n+    TaskService taskService = taskanaEngine.getTaskService();\n+    Task task = taskService.getTask(\"TKI:000000000000000000000000000000000000\");\n+    final ClassificationSummary classificationSummary = task.getClassificationSummary();\n+    task.setClassificationKey(\"T2100\");\n+    Task updatedTask = taskService.updateTask(task);\n+    updatedTask = taskService.getTask(updatedTask.getId());\n+\n+    assertThat(updatedTask).isNotNull();\n+    assertThat(updatedTask.getClassificationSummary().getKey()).isEqualTo(\"T2100\");\n+    assertThat(updatedTask.getClassificationSummary()).isNotEqualTo(classificationSummary);\n+    assertThat(updatedTask.getCreated()).isNotEqualTo(updatedTask.getModified());\n+    assertThat(task.getPlanned()).isEqualTo(updatedTask.getPlanned());\n+    assertThat(task.getName()).isEqualTo(updatedTask.getName());\n+    assertThat(task.getDescription()).isEqualTo(updatedTask.getDescription());\n+    resetDb(false); // classification of task TKI:0..00 was changed...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzMyNDQxNA==", "bodyText": "Was able to remove this without repurcussions - looks like it was indeed unnecessary", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r417324414", "createdAt": "2020-04-29T13:43:14Z", "author": {"login": "gitgoodjhe"}, "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "diffHunk": "@@ -129,6 +130,31 @@ void should_ThrowException_When_TaskHasAlreadyBeenUpdated()\n         .withFailMessage(\"The task has already been updated by another user\");\n   }\n \n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_UpdateTask_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws TaskNotFoundException, ClassificationNotFoundException, InvalidArgumentException,\n+                 ConcurrencyException, NotAuthorizedException, AttachmentPersistenceException,\n+                 InvalidStateException, SQLException {\n+\n+    TaskService taskService = taskanaEngine.getTaskService();\n+    Task task = taskService.getTask(\"TKI:000000000000000000000000000000000000\");\n+    final ClassificationSummary classificationSummary = task.getClassificationSummary();\n+    task.setClassificationKey(\"T2100\");\n+    Task updatedTask = taskService.updateTask(task);\n+    updatedTask = taskService.getTask(updatedTask.getId());\n+\n+    assertThat(updatedTask).isNotNull();\n+    assertThat(updatedTask.getClassificationSummary().getKey()).isEqualTo(\"T2100\");\n+    assertThat(updatedTask.getClassificationSummary()).isNotEqualTo(classificationSummary);\n+    assertThat(updatedTask.getCreated()).isNotEqualTo(updatedTask.getModified());\n+    assertThat(task.getPlanned()).isEqualTo(updatedTask.getPlanned());\n+    assertThat(task.getName()).isEqualTo(updatedTask.getName());\n+    assertThat(task.getDescription()).isEqualTo(updatedTask.getDescription());\n+    resetDb(false); // classification of task TKI:0..00 was changed...", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNTExNA=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk4MTUxOnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoxOTowMlrOGNTlBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMzo0Mjo0MFrOGN_bgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNTQ0Nw==", "bodyText": "in this testcase we do not need all the assertions, do we? I assume we have this tested in another testcase?", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416605447", "createdAt": "2020-04-28T13:19:02Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "diffHunk": "@@ -129,6 +130,31 @@ void should_ThrowException_When_TaskHasAlreadyBeenUpdated()\n         .withFailMessage(\"The task has already been updated by another user\");\n   }\n \n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_UpdateTask_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws TaskNotFoundException, ClassificationNotFoundException, InvalidArgumentException,\n+                 ConcurrencyException, NotAuthorizedException, AttachmentPersistenceException,\n+                 InvalidStateException, SQLException {\n+\n+    TaskService taskService = taskanaEngine.getTaskService();\n+    Task task = taskService.getTask(\"TKI:000000000000000000000000000000000000\");\n+    final ClassificationSummary classificationSummary = task.getClassificationSummary();\n+    task.setClassificationKey(\"T2100\");\n+    Task updatedTask = taskService.updateTask(task);\n+    updatedTask = taskService.getTask(updatedTask.getId());\n+\n+    assertThat(updatedTask).isNotNull();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzMyMzkwNg==", "bodyText": "changed it", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r417323906", "createdAt": "2020-04-29T13:42:40Z", "author": {"login": "gitgoodjhe"}, "path": "lib/taskana-core/src/test/java/acceptance/task/UpdateTaskAccTest.java", "diffHunk": "@@ -129,6 +130,31 @@ void should_ThrowException_When_TaskHasAlreadyBeenUpdated()\n         .withFailMessage(\"The task has already been updated by another user\");\n   }\n \n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_UpdateTask_When_NoExplicitPermissionsButUserIsInAdministrativeRole()\n+      throws TaskNotFoundException, ClassificationNotFoundException, InvalidArgumentException,\n+                 ConcurrencyException, NotAuthorizedException, AttachmentPersistenceException,\n+                 InvalidStateException, SQLException {\n+\n+    TaskService taskService = taskanaEngine.getTaskService();\n+    Task task = taskService.getTask(\"TKI:000000000000000000000000000000000000\");\n+    final ClassificationSummary classificationSummary = task.getClassificationSummary();\n+    task.setClassificationKey(\"T2100\");\n+    Task updatedTask = taskService.updateTask(task);\n+    updatedTask = taskService.getTask(updatedTask.getId());\n+\n+    assertThat(updatedTask).isNotNull();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNTQ0Nw=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk4ODk3OnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/workbasket/DeleteWorkbasketAuthorizationsAccTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMDo0NVrOGNTpyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMzo0MjozNlrOGN_bWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNjY2NA==", "bodyText": "what do we need this for?", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416606664", "createdAt": "2020-04-28T13:20:45Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/workbasket/DeleteWorkbasketAuthorizationsAccTest.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package acceptance.workbasket;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import acceptance.AbstractAccTest;\n+import org.assertj.core.api.ThrowableAssert.ThrowingCallable;\n+import org.junit.jupiter.api.TestTemplate;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+\n+import pro.taskana.common.api.exceptions.NotAuthorizedException;\n+import pro.taskana.security.JaasExtension;\n+import pro.taskana.security.WithAccessId;\n+import pro.taskana.workbasket.api.WorkbasketService;\n+import pro.taskana.workbasket.api.models.WorkbasketAccessItem;\n+\n+/**\n+ * Acceptance test for all \"delete workbasket authorizations\" scenarios.\n+ */\n+@ExtendWith(JaasExtension.class)\n+public class DeleteWorkbasketAuthorizationsAccTest extends AbstractAccTest {\n+\n+  @WithAccessId(user = \"user_1_1\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  public void should_ThrowException_When_UserRoleIsNotAdminOrBusinessAdmin() {\n+\n+    final WorkbasketService workbasketService = taskanaEngine.getWorkbasketService();\n+\n+    ThrowingCallable deleteWorkbasketAccessItemCall =\n+        () -> {\n+          workbasketService.deleteWorkbasketAccessItemsForAccessId(\"group_1\");\n+        };\n+\n+    assertThatThrownBy(deleteWorkbasketAccessItemCall).isInstanceOf(NotAuthorizedException.class);\n+\n+    WorkbasketAccessItem workbasketAccessItem =\n+        workbasketService.newWorkbasketAccessItem(\n+            \"WBI:100000000000000000000000000000000008\", \"newAccessIdForUpdate\");\n+\n+    workbasketAccessItem.setPermCustom1(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzMyMzg2Nw==", "bodyText": "changed it", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r417323867", "createdAt": "2020-04-29T13:42:36Z", "author": {"login": "gitgoodjhe"}, "path": "lib/taskana-core/src/test/java/acceptance/workbasket/DeleteWorkbasketAuthorizationsAccTest.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package acceptance.workbasket;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import acceptance.AbstractAccTest;\n+import org.assertj.core.api.ThrowableAssert.ThrowingCallable;\n+import org.junit.jupiter.api.TestTemplate;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+\n+import pro.taskana.common.api.exceptions.NotAuthorizedException;\n+import pro.taskana.security.JaasExtension;\n+import pro.taskana.security.WithAccessId;\n+import pro.taskana.workbasket.api.WorkbasketService;\n+import pro.taskana.workbasket.api.models.WorkbasketAccessItem;\n+\n+/**\n+ * Acceptance test for all \"delete workbasket authorizations\" scenarios.\n+ */\n+@ExtendWith(JaasExtension.class)\n+public class DeleteWorkbasketAuthorizationsAccTest extends AbstractAccTest {\n+\n+  @WithAccessId(user = \"user_1_1\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  public void should_ThrowException_When_UserRoleIsNotAdminOrBusinessAdmin() {\n+\n+    final WorkbasketService workbasketService = taskanaEngine.getWorkbasketService();\n+\n+    ThrowingCallable deleteWorkbasketAccessItemCall =\n+        () -> {\n+          workbasketService.deleteWorkbasketAccessItemsForAccessId(\"group_1\");\n+        };\n+\n+    assertThatThrownBy(deleteWorkbasketAccessItemCall).isInstanceOf(NotAuthorizedException.class);\n+\n+    WorkbasketAccessItem workbasketAccessItem =\n+        workbasketService.newWorkbasketAccessItem(\n+            \"WBI:100000000000000000000000000000000008\", \"newAccessIdForUpdate\");\n+\n+    workbasketAccessItem.setPermCustom1(true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNjY2NA=="}, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk5NDU3OnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/workbasket/GetWorkbasketAccTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMTo1MVrOGNTtNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMTo1MVrOGNTtNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwNzU0MQ==", "bodyText": "see above. I'm not sure if we want to do this.", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416607541", "createdAt": "2020-04-28T13:21:51Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/workbasket/GetWorkbasketAccTest.java", "diffHunk": "@@ -51,6 +52,38 @@ void testGetWorkbasketById() throws NotAuthorizedException, WorkbasketNotFoundEx\n     assertThat(workbasket.getCustom4()).isEqualTo(\"custom4\");\n   }\n \n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"businessadmin\")\n+  @WithAccessId(user = \"taskadmin\")\n+\n+  @TestTemplate\n+  void should_ReturnWorkbasketByKeyAndDomain_When_NoExplicitPermissionButUserHasAdministrativeRole()\n+      throws NotAuthorizedException, WorkbasketNotFoundException {\n+\n+    WorkbasketService workbasketService = taskanaEngine.getWorkbasketService();\n+\n+    Workbasket retrievedWorkbasket =\n+        workbasketService.getWorkbasket(\"WBI:100000000000000000000000000000000007\");\n+\n+    assertThat(retrievedWorkbasket).isNotNull();\n+    assertThat(retrievedWorkbasket.getOwner()).isEqualTo(\"Peter Maier\");\n+  }\n+\n+  @WithAccessId(user = \"admin\")\n+  @WithAccessId(user = \"businessadmin\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  void should_ReturnWorkbasketById_When_NoExplicitPermissionsButUserIsInAdministrativeRole()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MTk5OTg0OnYy", "diffSide": "RIGHT", "path": "lib/taskana-core/src/test/java/acceptance/workbasket/GetWorkbasketAuthorizationsAccTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMzowOFrOGNTwpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMzoyMzowOFrOGNTwpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjYwODQyMA==", "bodyText": "again - but here we already reject the get? Doesn't look consistent to me. But I would rather change the other parts.", "url": "https://github.com/Taskana/taskana/pull/1034#discussion_r416608420", "createdAt": "2020-04-28T13:23:08Z", "author": {"login": "holgerhagen"}, "path": "lib/taskana-core/src/test/java/acceptance/workbasket/GetWorkbasketAuthorizationsAccTest.java", "diffHunk": "@@ -0,0 +1,35 @@\n+package acceptance.workbasket;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import acceptance.AbstractAccTest;\n+import org.assertj.core.api.ThrowableAssert.ThrowingCallable;\n+import org.junit.jupiter.api.TestTemplate;\n+import org.junit.jupiter.api.extension.ExtendWith;\n+\n+import pro.taskana.common.api.exceptions.NotAuthorizedException;\n+import pro.taskana.security.JaasExtension;\n+import pro.taskana.security.WithAccessId;\n+import pro.taskana.workbasket.api.WorkbasketService;\n+\n+/**\n+ * Acceptance test for all \"get workbasket authorizations\" scenarios.\n+ */\n+@ExtendWith(JaasExtension.class)\n+public class GetWorkbasketAuthorizationsAccTest extends AbstractAccTest {\n+\n+  @WithAccessId(user = \"user_1_1\")\n+  @WithAccessId(user = \"taskadmin\")\n+  @TestTemplate\n+  public void should_ThrowException_When_UserRoleIsNotAdminOrBusinessAdmin() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f443af0cb1797cd0acf4efc9e4abbf6a295965"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4346, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}