{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4NDc4NTA1", "number": 1206, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOTo0N1rOEUeyCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwODoxMTozNFrOEWsdfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5OTExMzA2OnYy", "diffSide": "RIGHT", "path": "web/src/app/workplace/components/task-master/task-master.component.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOTo0N1rOG6tY4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxMzo1MjoyOFrOG7hXHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDI0Mw==", "bodyText": "Why don't we update selectedId and currentBasket like before when taskSelectedStream (getSelectedTask()) changes?", "url": "https://github.com/Taskana/taskana/pull/1206#discussion_r464214243", "createdAt": "2020-08-03T06:19:47Z", "author": {"login": "sofie29"}, "path": "web/src/app/workplace/components/task-master/task-master.component.ts", "diffHunk": "@@ -55,19 +55,13 @@ export class TaskMasterComponent implements OnInit, OnDestroy {\n   ) {}\n \n   ngOnInit() {\n-    this.taskService\n-      .getSelectedTask()\n-      .pipe(takeUntil(this.destroy$))\n-      .subscribe((task: Task) => {\n-        if (!this.currentBasket) {\n-          this.selectedId = task.taskId;\n-          this.currentBasket = task.workbasketSummary;\n-          this.getTasks();\n-        }\n-        if (!task) {\n-          this.selectedId = '';\n-        }\n-      });\n+    this.taskService.taskChangedStream.pipe(takeUntil(this.destroy$)).subscribe((task: Task) => {\n+      this.selectedId = task ? task.taskId : '';\n+      if (!this.currentBasket) {\n+        this.currentBasket = task.workbasketSummary;\n+        this.getTasks();\n+      }\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82eab5b2a93e30ef889c7c43151dcbf95161b5b1"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA2NTc1OQ==", "bodyText": "I used the taskChangedStream, because i assumed it was the same as the selected stream (it worked for my purposes). I changed it to the selectedStream and the list now gets displayed when working on a task.\nGood suggestion, thanks", "url": "https://github.com/Taskana/taskana/pull/1206#discussion_r465065759", "createdAt": "2020-08-04T13:52:28Z", "author": {"login": "Tristan2357"}, "path": "web/src/app/workplace/components/task-master/task-master.component.ts", "diffHunk": "@@ -55,19 +55,13 @@ export class TaskMasterComponent implements OnInit, OnDestroy {\n   ) {}\n \n   ngOnInit() {\n-    this.taskService\n-      .getSelectedTask()\n-      .pipe(takeUntil(this.destroy$))\n-      .subscribe((task: Task) => {\n-        if (!this.currentBasket) {\n-          this.selectedId = task.taskId;\n-          this.currentBasket = task.workbasketSummary;\n-          this.getTasks();\n-        }\n-        if (!task) {\n-          this.selectedId = '';\n-        }\n-      });\n+    this.taskService.taskChangedStream.pipe(takeUntil(this.destroy$)).subscribe((task: Task) => {\n+      this.selectedId = task ? task.taskId : '';\n+      if (!this.currentBasket) {\n+        this.currentBasket = task.workbasketSummary;\n+        this.getTasks();\n+      }\n+    });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDI0Mw=="}, "originalCommit": {"oid": "82eab5b2a93e30ef889c7c43151dcbf95161b5b1"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwOTk0NzQ4OnYy", "diffSide": "RIGHT", "path": "web/src/app/workplace/components/task-master/task-master.component.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzo0NTowN1rOG8UIWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzo0NTowN1rOG8UIWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5NzU2MA==", "bodyText": "I thought about this - I think we have to delete the currentBasket even when there is an objectReference. In case we search by type and value, the method getTasks() should be called without a currentBasket. Otherwise the method would filter the tasks by a workbasket (the currentBasket).", "url": "https://github.com/Taskana/taskana/pull/1206#discussion_r465897560", "createdAt": "2020-08-05T17:45:07Z", "author": {"login": "sofie29"}, "path": "web/src/app/workplace/components/task-master/task-master.component.ts", "diffHunk": "@@ -90,9 +84,10 @@ export class TaskMasterComponent implements OnInit, OnDestroy {\n \n     this.workplaceService.objectReferenceSelectedStream.pipe(takeUntil(this.destroy$)).subscribe((objectReference) => {\n       this.objectReference = objectReference;\n-      delete this.currentBasket;\n       if (objectReference) {\n         this.getTasks();\n+      } else {\n+        delete this.currentBasket;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0ddb1725ca1817662fecd1d23c6c60c74b0801f"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyMjMyNTcyOnYy", "diffSide": "RIGHT", "path": "web/src/app/workplace/services/task.service.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwODoxMTozNFrOG-FCvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwODoxMTozNFrOG-FCvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc0NzUxNw==", "bodyText": "nice", "url": "https://github.com/Taskana/taskana/pull/1206#discussion_r467747517", "createdAt": "2020-08-10T08:11:34Z", "author": {"login": "cnguyen-de"}, "path": "web/src/app/workplace/services/task.service.ts", "diffHunk": "@@ -91,29 +90,17 @@ export class TaskService {\n     return this.httpClient.post<Task>(this.url, task);\n   }\n \n-  private convertTasksDatesToGMT(task: Task): Task {\n-    if (task.created) {\n-      task.created = new Date(task.created).toISOString();\n-    }\n-    if (task.claimed) {\n-      task.claimed = new Date(task.claimed).toISOString();\n-    }\n-    if (task.completed) {\n-      task.completed = new Date(task.completed).toISOString();\n-    }\n-    if (task.modified) {\n-      task.modified = new Date(task.modified).toISOString();\n-    }\n-    if (task.planned) {\n-      task.planned = new Date(task.planned).toISOString();\n-    }\n-    if (task.due) {\n-      task.due = new Date(task.due).toISOString();\n-    }\n+  private static convertTasksDatesToGMT(task: Task): Task {\n+    const timeAttributes = ['created', 'claimed', 'completed', 'modified', 'planned', 'due'];\n+    timeAttributes.forEach((attributeName) => {\n+      if (task[attributeName]) {\n+        task[attributeName] = new Date(task[attributeName]).toISOString();\n+      }\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b330dd287fe6b55d3de7c20cd5896e616eacdb37"}, "originalPosition": 85}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4136, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}