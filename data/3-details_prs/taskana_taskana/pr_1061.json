{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MTMyNzQ4", "number": 1061, "title": "TSK-1224: refactor the configuration of the custom holidays", "bodyText": "", "createdAt": "2020-05-11T14:15:04Z", "url": "https://github.com/Taskana/taskana/pull/1061", "merged": true, "mergeCommit": {"oid": "9dc3cc68e862cf8747124e82166964da6169283e"}, "closed": true, "closedAt": "2020-05-18T09:01:22Z", "author": {"login": "sfrevel"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgRPARABqjMzMjM0NjE0NzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcib6WugFqTQxMzM5MzIxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17411b390478af451aabd8cfa23848ba53727c7b", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/17411b390478af451aabd8cfa23848ba53727c7b", "committedDate": "2020-05-11T14:03:11Z", "message": "TSK-1227: refactor the configuration of the custom holidays"}, "afterCommit": {"oid": "54c04d579576caf604f55a57b895d5d0cd400e9a", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/54c04d579576caf604f55a57b895d5d0cd400e9a", "committedDate": "2020-05-11T15:15:40Z", "message": "TSK-1227: refactor the configuration of the custom holidays"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d77418e8927c3d4a273076636dea4cea392658d0", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/d77418e8927c3d4a273076636dea4cea392658d0", "committedDate": "2020-05-12T06:14:55Z", "message": "TSK-1227: add/refactor tests"}, "afterCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe", "committedDate": "2020-05-12T07:12:50Z", "message": "TSK-1224: add/refactor tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NzgxOTcz", "url": "https://github.com/Taskana/taskana/pull/1061#pullrequestreview-409781973", "createdAt": "2020-05-12T07:47:20Z", "commit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwNzo0NzoyMFrOGT6MwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwODowMDowMlrOGT6rBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUyOTY2NA==", "bodyText": "As discussed. Maybe it's cooler to generalize our rolesSeparator", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423529664", "createdAt": "2020-05-12T07:47:20Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/TaskanaEngineConfiguration.java", "diffHunk": "@@ -71,6 +72,10 @@\n   // TASKANA_SCHEMA_VERSION\n   private static final String DEFAULT_SCHEMA_NAME = \"TASKANA\";\n \n+  private static final String TASKANA_CUSTOM_HOLIDAY = \"taskana.custom.holidays\";\n+  private static final String TASKANA_CUSTOM_HOLIDAY_SEPERATOR = \";\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUyOTg0OQ==", "bodyText": "Why are you escaping the dot?", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423529849", "createdAt": "2020-05-12T07:47:39Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/TaskanaEngineConfiguration.java", "diffHunk": "@@ -71,6 +72,10 @@\n   // TASKANA_SCHEMA_VERSION\n   private static final String DEFAULT_SCHEMA_NAME = \"TASKANA\";\n \n+  private static final String TASKANA_CUSTOM_HOLIDAY = \"taskana.custom.holidays\";\n+  private static final String TASKANA_CUSTOM_HOLIDAY_SEPERATOR = \";\";\n+  private static final String TASKANA_CUSTOM_HOLIDAY_DAY_MONTH_SEPERATOR = \"\\\\.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzMDgxMw==", "bodyText": "a set method which only adds feels a little odd..\nEither rename the method to addCustomHolidays or replace the existing lists (and thus override the property initalization).", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423530813", "createdAt": "2020-05-12T07:49:22Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/TaskanaEngineConfiguration.java", "diffHunk": "@@ -248,12 +254,12 @@ public void setGermanPublicHolidaysEnabled(boolean germanPublicHolidaysEnabled)\n     this.germanPublicHolidaysEnabled = germanPublicHolidaysEnabled;\n   }\n \n-  public List<LocalDate> getCustomHolidays() {\n+  public List<CustomHoliday> getCustomHolidays() {\n     return customHolidays;\n   }\n \n-  public void setCustomHolidays(List<LocalDate> customHolidays) {\n-    this.customHolidays = customHolidays;\n+  public void setCustomHolidays(List<CustomHoliday> customHolidays) {\n+    customHolidays.forEach(this.customHolidays::add);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzMzUxMw==", "bodyText": "I prefer escaping the TASKANA_CUSTOM_HOLIDAY_SEPERATOR programmatically with Pattern#quote\nBecause of this other developer don't get confused with the semantic of that constant", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423533513", "createdAt": "2020-05-12T07:53:51Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/TaskanaEngineConfiguration.java", "diffHunk": "@@ -533,6 +539,34 @@ private void initTaskanaRoles(Properties props, String rolesSeparator) {\n     }\n   }\n \n+  private void initCustomHolidays(Properties props) {\n+    if (props.getProperty(TASKANA_CUSTOM_HOLIDAY) != null) {\n+      Arrays.asList(\n+              props.getProperty(TASKANA_CUSTOM_HOLIDAY).split(TASKANA_CUSTOM_HOLIDAY_SEPERATOR))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNDc4Ng==", "bodyText": "same as the comment above :)", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423534786", "createdAt": "2020-05-12T07:55:49Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/TaskanaEngineConfiguration.java", "diffHunk": "@@ -533,6 +539,34 @@ private void initTaskanaRoles(Properties props, String rolesSeparator) {\n     }\n   }\n \n+  private void initCustomHolidays(Properties props) {\n+    if (props.getProperty(TASKANA_CUSTOM_HOLIDAY) != null) {\n+      Arrays.asList(\n+              props.getProperty(TASKANA_CUSTOM_HOLIDAY).split(TASKANA_CUSTOM_HOLIDAY_SEPERATOR))\n+          .forEach(\n+              entry -> {\n+                try {\n+                  customHolidays.add(createCustomHolidayFromPropsEntry(entry));\n+                } catch (WrongCustomHolidayFormatException e) {\n+                  LOGGER.warn(e.getMessage());\n+                }\n+              });\n+    }\n+  }\n+\n+  private CustomHoliday createCustomHolidayFromPropsEntry(String customHolidayEntry)\n+      throws WrongCustomHolidayFormatException {\n+    String[] parts = customHolidayEntry.split(TASKANA_CUSTOM_HOLIDAY_DAY_MONTH_SEPERATOR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNTc1OA==", "bodyText": "Please extend TaskanaException instead of Exception", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423535758", "createdAt": "2020-05-12T07:57:17Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/common/api/exceptions/WrongCustomHolidayFormatException.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package pro.taskana.common.api.exceptions;\n+\n+public class WrongCustomHolidayFormatException extends Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNzA0Nw==", "bodyText": "I wouldn't put this class in internal, since this is necessary for the user to configure.\nThis is common/api/model.. Any other thoughts?", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423537047", "createdAt": "2020-05-12T07:59:24Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/common/internal/util/CustomHoliday.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package pro.taskana.common.internal.util;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNzE0Nw==", "bodyText": "Or just common/api", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423537147", "createdAt": "2020-05-12T07:59:35Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/common/internal/util/CustomHoliday.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package pro.taskana.common.internal.util;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNzA0Nw=="}, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUzNzQxMg==", "bodyText": "What do you think of reusing our generic Pair class? Or would that be confusing?", "url": "https://github.com/Taskana/taskana/pull/1061#discussion_r423537412", "createdAt": "2020-05-12T08:00:02Z", "author": {"login": "mustaphazorgati"}, "path": "lib/taskana-core/src/main/java/pro/taskana/common/internal/util/CustomHoliday.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package pro.taskana.common.internal.util;\n+\n+import java.util.Objects;\n+\n+public final class CustomHoliday {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2c465b4ed05d9f6946f2af0a7de887bcb8d8dbe"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTkxOTQ4", "url": "https://github.com/Taskana/taskana/pull/1061#pullrequestreview-413191948", "createdAt": "2020-05-17T19:35:27Z", "commit": {"oid": "893b453ab66a31ceda465206989ec457fe4471d3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "893b453ab66a31ceda465206989ec457fe4471d3", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/893b453ab66a31ceda465206989ec457fe4471d3", "committedDate": "2020-05-12T08:58:23Z", "message": "TSK-1224: refactorings - rename methods, reuse roles/propertiesSeparator, use Pattern#quote"}, "afterCommit": {"oid": "e47b1c0cc061f81165358d8d4409f4499fa352a9", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/e47b1c0cc061f81165358d8d4409f4499fa352a9", "committedDate": "2020-05-17T19:36:51Z", "message": "TSK-1224: refactorings - rename methods, reuse roles/propertiesSeparator, use Pattern#quote"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04429c2cfa9ce0798224b025929d2c7e33a763f2", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/04429c2cfa9ce0798224b025929d2c7e33a763f2", "committedDate": "2020-05-17T23:26:32Z", "message": "TSK-1224: refactor the configuration of the custom holidays"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7b932b9acdc1a068d9bd4911b3f76386563f829", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/d7b932b9acdc1a068d9bd4911b3f76386563f829", "committedDate": "2020-05-17T23:26:40Z", "message": "TSK-1224: add/refactor tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d942211fec3edcb35046dad83cc885f0e20b2693", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/d942211fec3edcb35046dad83cc885f0e20b2693", "committedDate": "2020-05-17T23:26:47Z", "message": "TSK-1224: refactorings - rename methods, reuse roles/propertiesSeparator, use Pattern#quote"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e47b1c0cc061f81165358d8d4409f4499fa352a9", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/e47b1c0cc061f81165358d8d4409f4499fa352a9", "committedDate": "2020-05-17T19:36:51Z", "message": "TSK-1224: refactorings - rename methods, reuse roles/propertiesSeparator, use Pattern#quote"}, "afterCommit": {"oid": "d942211fec3edcb35046dad83cc885f0e20b2693", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/d942211fec3edcb35046dad83cc885f0e20b2693", "committedDate": "2020-05-17T23:26:47Z", "message": "TSK-1224: refactorings - rename methods, reuse roles/propertiesSeparator, use Pattern#quote"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d687ce065153130d3927b7a7c7c4ea62d6ab27ef", "author": {"user": {"login": "sfrevel", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/d687ce065153130d3927b7a7c7c4ea62d6ab27ef", "committedDate": "2020-05-18T08:49:17Z", "message": "TSK-1224: removed unused import after history rewrite"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMzkzMjE4", "url": "https://github.com/Taskana/taskana/pull/1061#pullrequestreview-413393218", "createdAt": "2020-05-18T08:50:41Z", "commit": {"oid": "d687ce065153130d3927b7a7c7c4ea62d6ab27ef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4478, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}