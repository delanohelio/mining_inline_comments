{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0NTMyODg2", "number": 1127, "title": "TSK-1279 Enable the creation of subclassifications", "bodyText": "Depends on TSK-1214, TSK-1222", "createdAt": "2020-06-15T13:15:06Z", "url": "https://github.com/Taskana/taskana/pull/1127", "merged": true, "mergeCommit": {"oid": "2760b9ee59a45e71c7be1acb6354c3b8c6458f3b"}, "closed": true, "closedAt": "2020-06-22T10:43:26Z", "author": {"login": "sofie29"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsLp8PgFqTQzMjUxOTMwMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABctuft2gFqTQzNDgwNjUzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTE5MzAx", "url": "https://github.com/Taskana/taskana/pull/1127#pullrequestreview-432519301", "createdAt": "2020-06-17T15:26:00Z", "commit": {"oid": "8742a3efd53adb38e8e6f83cb15cf8295f751e7a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNToyNjowMFrOGlLKmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNTozMjo0NVrOGlLclg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYzMzQzMg==", "bodyText": "I'm missing a takeUntil(this.destroy$)", "url": "https://github.com/Taskana/taskana/pull/1127#discussion_r441633432", "createdAt": "2020-06-17T15:26:00Z", "author": {"login": "mustaphazorgati"}, "path": "web/src/app/administration/components/classification-details/classification-details.component.ts", "diffHunk": "@@ -80,7 +78,9 @@ export class ClassificationDetailsComponent implements OnInit, OnDestroy {\n     this.action$.pipe(takeUntil(this.destroy$)).subscribe(data => {\n       this.action = data;\n       if (this.action === ACTION.CREATE) {\n-        this.initClassificationOnCreation();\n+        this.selectedClassification$.pipe(take(1)).subscribe(initialClassification => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8742a3efd53adb38e8e6f83cb15cf8295f751e7a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYzNTUxNA==", "bodyText": "why are you not using classificationCopy$?", "url": "https://github.com/Taskana/taskana/pull/1127#discussion_r441635514", "createdAt": "2020-06-17T15:28:56Z", "author": {"login": "mustaphazorgati"}, "path": "web/src/app/shared/components/tree/tree.component.ts", "diffHunk": "@@ -92,19 +87,25 @@ export class TaskanaTreeComponent implements OnInit, AfterViewChecked, OnDestroy\n       this.action = action;\n     });\n \n-    this.selectedClassificationId$.pipe(takeUntil(this.destroy$)).subscribe(selectedClassificationId => {\n-      this.selectNodeId = typeof selectedClassificationId !== 'undefined' ? selectedClassificationId : undefined;\n-      if (typeof this.tree.treeModel.getActiveNode() !== 'undefined') {\n-        if (this.tree.treeModel.getActiveNode().data.classificationId !== this.selectNodeId) {\n-          this.selectNode(this.selectNodeId);\n+    const classificationCopy$: Observable<TreeNodeModel[]> = this.classifications$.pipe(\n+      filter(classifications => typeof (classifications) !== 'undefined'),\n+      tap(classifications => {\n+        this.classifications = classifications.map(this.classificationsDeepCopy.bind(this));\n+      })\n+    );\n+\n+    combineLatest(this.selectedClassificationId$, classificationCopy$).pipe(takeUntil(this.destroy$))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8742a3efd53adb38e8e6f83cb15cf8295f751e7a"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYzODAzOA==", "bodyText": "why are we copying the classification?", "url": "https://github.com/Taskana/taskana/pull/1127#discussion_r441638038", "createdAt": "2020-06-17T15:32:45Z", "author": {"login": "mustaphazorgati"}, "path": "web/src/app/administration/components/classification-details/classification-details.component.ts", "diffHunk": "@@ -80,7 +78,9 @@ export class ClassificationDetailsComponent implements OnInit, OnDestroy {\n     this.action$.pipe(takeUntil(this.destroy$)).subscribe(data => {\n       this.action = data;\n       if (this.action === ACTION.CREATE) {\n-        this.initClassificationOnCreation();\n+        this.selectedClassification$.pipe(take(1)).subscribe(initialClassification => {\n+          this.classification = { ...initialClassification };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8742a3efd53adb38e8e6f83cb15cf8295f751e7a"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4fe0cb0572da7c75d612d1ae8426972e5d4a04b", "author": {"user": {"login": "mustaphazorgati", "name": "Mustapha Zorgati"}}, "url": "https://github.com/Taskana/taskana/commit/a4fe0cb0572da7c75d612d1ae8426972e5d4a04b", "committedDate": "2020-06-22T10:11:02Z", "message": "TSK-1214: refactored taskana-classification\n\nTSK-1214 Trying to make drag'n drop in tree possible\n\nTSK-1214 Removed refreshClassification output from tree\n\nTSK-1214 New action in store updates a classification and refetches all, saving now correctly refreshes the classification-list\n\nTSK-1214 Fixed tests in tree component\n\nTSK-1214 Removed tree service and corresponding test in class-details\n\nTSK-1214 fixed issues in tree where multiple actions to store are fired incorrectly\n\nTSK-1214 added accessibility action, use space to select a tree node\n\nTSK-1214 swapped space and enter in tree component, cleaned code\n\nTSK-1214 fixed bug where page isn't updated dynamically according to browser path\n\nTSK-1214 workaround circular dependency.\n\nservice uses snapshot of store, does not actually access the state in store\n\nTSK-1214 fixed eslint. TODO: circular dependency between classification.service and classification.state\n\nTSK-1214 changed first() to take(1) to fix Observable dying during test\n\nTSK-1214 fixed test cases and lint issues\n\nTSK-1214 fixed circular dependency\n\nTSK-1214 devmode = false\n\nTSK-1214: fixed merge problems with notificationService and removed some warnings\n\nTSK-1214: fixed merge problems with notificationService\n\nTSK-1214 remove wrong imports from before merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abe54cd6c90054cf0d53b9475ade85fe290fb60a", "author": {"user": {"login": "sofie29", "name": "Sofie Hofmann"}}, "url": "https://github.com/Taskana/taskana/commit/abe54cd6c90054cf0d53b9475ade85fe290fb60a", "committedDate": "2020-06-22T10:14:02Z", "message": "TSK-1279: Enable the creation of subclassifications"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0ODA2NTM3", "url": "https://github.com/Taskana/taskana/pull/1127#pullrequestreview-434806537", "createdAt": "2020-06-22T10:42:57Z", "commit": {"oid": "abe54cd6c90054cf0d53b9475ade85fe290fb60a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4498, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}