{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNjY5MTMw", "number": 1159, "title": "TSK-1253: Prevent LDAP injection.", "bodyText": "", "createdAt": "2020-07-01T12:33:03Z", "url": "https://github.com/Taskana/taskana/pull/1159", "merged": true, "mergeCommit": {"oid": "9f0179619f7d96f971f979d73d7e32cedd896e6e"}, "closed": true, "closedAt": "2020-07-02T08:14:55Z", "author": {"login": "holgerhagen"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwpRBkgH2gAyNDQyNjY5MTMwOjNmMGI2NTE4MjY3MjcxMTUyMzU3MGU1NGZhYTM4NGExY2U3NzIwMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcw6VLCAFqTQ0MTQ0ODAwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3f0b65182672711523570e54faa384a1ce772006", "author": {"user": {"login": "holgerhagen", "name": null}}, "url": "https://github.com/Taskana/taskana/commit/3f0b65182672711523570e54faa384a1ce772006", "committedDate": "2020-07-01T12:19:09Z", "message": "TSK-1253: Prevent LDAP injection."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODM3NTI0", "url": "https://github.com/Taskana/taskana/pull/1159#pullrequestreview-440837524", "createdAt": "2020-07-01T12:49:12Z", "commit": {"oid": "3f0b65182672711523570e54faa384a1ce772006"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxMjo0OToxMlrOGrkeRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxMjo1Mjo0MVrOGrkl-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMzOTUyNA==", "bodyText": "what happens if the accessId is already a full dn? Do we have a test for this case?", "url": "https://github.com/Taskana/taskana/pull/1159#discussion_r448339524", "createdAt": "2020-07-01T12:49:12Z", "author": {"login": "mustaphazorgati"}, "path": "rest/taskana-rest-spring/src/main/java/pro/taskana/common/rest/ldap/LdapClient.java", "diffHunk": "@@ -191,7 +191,18 @@ public AccessIdRepresentationModel searchGroupByDn(final String name) {\n \n     final AndFilter andFilter = new AndFilter();\n     andFilter.and(new EqualsFilter(getGroupSearchFilterName(), getGroupSearchFilterValue()));\n-    andFilter.and(new LikeFilter(getGroupsOfUser(), \"*\" + accessId + \"*\"));\n+    final OrFilter orFilter = new OrFilter();\n+    orFilter.or(new EqualsFilter(getGroupsOfUser(), accessId));\n+    orFilter.or(\n+        new EqualsFilter(\n+            getGroupsOfUser(),\n+            LdapNameBuilder.newInstance()\n+                .add(getBaseDn())\n+                .add(getUserSearchBase())\n+                .add(\"uid\", accessId)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f0b65182672711523570e54faa384a1ce772006"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM0MTAyMg==", "bodyText": "Sorry \ud83d\ude05 : I don't understand the test name.\nWhat in ksc-teamleads,cn=groups is invalid?", "url": "https://github.com/Taskana/taskana/pull/1159#discussion_r448341022", "createdAt": "2020-07-01T12:51:52Z", "author": {"login": "mustaphazorgati"}, "path": "rest/taskana-rest-spring/src/test/java/pro/taskana/common/rest/AccessIdControllerIntTest.java", "diffHunk": "@@ -61,6 +61,17 @@ void testQueryGroupsByCn() {\n         .containsExactly(\"cn=ksc-users,cn=groups,OU=Test,O=TASKANA\");\n   }\n \n+  @Test\n+  void should_returnEmptyResults_ifInvalidCharacterIsUsedInCondition() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f0b65182672711523570e54faa384a1ce772006"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM0MTQ5OQ==", "bodyText": "Does this test make sense? You want to test something within the LdapClient, but the exception is thrown in the AccessIdController. Thus this test only tests that getGroupsByAccessId is called with a valid accessId", "url": "https://github.com/Taskana/taskana/pull/1159#discussion_r448341499", "createdAt": "2020-07-01T12:52:41Z", "author": {"login": "mustaphazorgati"}, "path": "rest/taskana-rest-spring/src/test/java/pro/taskana/common/rest/AccessIdControllerIntTest.java", "diffHunk": "@@ -128,6 +139,23 @@ void should_returnAccessIdsOfGroupsTheAccessIdIsMemberOf_ifAccessIdOfUserIsGiven\n                 + \"cn=Organisationseinheit KSC,cn=organisation,OU=Test,O=TASKANA\");\n   }\n \n+  @Test\n+  void should_returnBadRequest_ifAccessIdOfUserContainsInvalidCharacter() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f0b65182672711523570e54faa384a1ce772006"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNDQ4MDAz", "url": "https://github.com/Taskana/taskana/pull/1159#pullrequestreview-441448003", "createdAt": "2020-07-02T08:12:04Z", "commit": {"oid": "3f0b65182672711523570e54faa384a1ce772006"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4441, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}