{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4OTA5NDE3", "number": 7337, "title": "Fix modded EntityClassifications", "bodyText": "The EntityClassification enum can be extended thanks to Forge's IExtensibleEnum.\nHowever, then included VALUES_MAP is not updated with the new additions, which causes issues.\nThis PR fixes this by adding new elements to the map in the constructor.\nAlso updates the CODEC", "createdAt": "2020-09-17T20:18:59Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337", "merged": true, "mergeCommit": {"oid": "9177ac1b2e326a3acffaf476eeff28a1cf9a637f"}, "closed": true, "closedAt": "2020-10-02T22:06:48Z", "author": {"login": "maxanier"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJ2yDfAH2gAyNDg4OTA5NDE3OjIzYzQzOGUxNWVkNmU1M2EyMTU0YjNjZTVlZGFkZjQxN2Q3NmFmOTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN8vMPAH2gAyNDg4OTA5NDE3OjJjYjM1MTAxYzNkZmJiMWI2N2JlZDU0NThhZjdjMGQ0NTA2MmU4MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "23c438e15ed6e53a2154b3ce5edadf417d76af98", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/23c438e15ed6e53a2154b3ce5edadf417d76af98", "committedDate": "2020-09-17T20:12:06Z", "message": "Rebuilt entity classification map after init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02f772d8dd8fc43bdc7cb55ac9b52e1844bab6d2", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/02f772d8dd8fc43bdc7cb55ac9b52e1844bab6d2", "committedDate": "2020-09-17T21:16:40Z", "message": "Improve implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0OTY0MTc3", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337#pullrequestreview-494964177", "createdAt": "2020-09-23T19:02:58Z", "commit": {"oid": "02f772d8dd8fc43bdc7cb55ac9b52e1844bab6d2"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxOTowMjo1OFrOHW88Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxOTowMzo1NVrOHW8-Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzgyOTE1MQ==", "bodyText": "I have my doubts if this second line is actually needed as the Codec seems to reference Enum#values and not the cached VALUES_MAP.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337#discussion_r493829151", "createdAt": "2020-09-23T19:02:58Z", "author": {"login": "pupnewfster"}, "path": "patches/minecraft/net/minecraft/entity/EntityClassification.java.patch", "diffHunk": "@@ -9,13 +9,20 @@\n     MONSTER(\"monster\", 70, false, false, 128),\n     CREATURE(\"creature\", 10, true, true, 128),\n     AMBIENT(\"ambient\", 15, true, false, 128),\n-@@ -57,6 +57,10 @@\n+@@ -57,6 +57,17 @@\n        return this.field_82707_i;\n     }\n  \n +   public static EntityClassification create(String name, String id, int maxNumberOfCreatureIn, boolean isPeacefulCreatureIn, boolean isAnimalIn, int despawnDistance) {\n +      throw new IllegalStateException(\"Enum not extended\");\n +   }\n++\n++   @Override\n++   @Deprecated\n++   public void init() {\n++      field_220364_f.put(this.field_220365_j, this);\n++      field_233667_g_ = IStringSerializable.func_233023_a_(EntityClassification::values, EntityClassification::func_233670_a_);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02f772d8dd8fc43bdc7cb55ac9b52e1844bab6d2"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzgyOTY1NQ==", "bodyText": "For future reference (or if I am wrong about modifying the codec being wrong), when you modify the access transformer file you should run the checkATs task as it orders things alphabetically and entity should be way before world.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337#discussion_r493829655", "createdAt": "2020-09-23T19:03:55Z", "author": {"login": "pupnewfster"}, "path": "src/main/resources/META-INF/accesstransformer.cfg", "diffHunk": "@@ -315,4 +315,5 @@ public net.minecraft.world.gen.layer.LayerUtil func_202829_a(JLnet/minecraft/wor\n private-f net.minecraft.world.raid.Raid$WaveMember field_221284_f # VALUES\n public net.minecraft.world.server.ServerChunkProvider field_186029_c # chunkGenerator\n public net.minecraft.world.server.ServerChunkProvider field_73251_h # worldObj\n-public net.minecraft.world.storage.FolderName <init>(Ljava/lang/String;)V # constructor\n\\ No newline at end of file\n+public net.minecraft.world.storage.FolderName <init>(Ljava/lang/String;)V # constructor\n+public-f net.minecraft.entity.EntityClassification field_233667_g_ # CODEC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02f772d8dd8fc43bdc7cb55ac9b52e1844bab6d2"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6af79388fb1689622ee63da18e16bda0b3f34d84", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/6af79388fb1689622ee63da18e16bda0b3f34d84", "committedDate": "2020-09-23T20:16:24Z", "message": "Reorder ATs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "874fe77c363f4f41b302f1712ff8105cb186be34", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/874fe77c363f4f41b302f1712ff8105cb186be34", "committedDate": "2020-09-23T21:27:19Z", "message": "Use non-caching setup for extended enum codec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b49624553a678fbb2413f8a7f0fe014a8bbf848", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7b49624553a678fbb2413f8a7f0fe014a8bbf848", "committedDate": "2020-09-23T21:28:04Z", "message": "Remove access transformer for codec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b04a184fddf2ee0a8012a5548a3f50859054414", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/9b04a184fddf2ee0a8012a5548a3f50859054414", "committedDate": "2020-09-23T21:34:18Z", "message": "Fix patch after AT change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NDA2MjY5", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337#pullrequestreview-499406269", "createdAt": "2020-09-30T13:04:37Z", "commit": {"oid": "9b04a184fddf2ee0a8012a5548a3f50859054414"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMzowNDozN1rOHach5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMzowNDozN1rOHach5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ5MjQ1Mw==", "bodyText": "vanilla calls getName instead of using the raw field, we should mirror this (even though it shouldn't make a difference)", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7337#discussion_r497492453", "createdAt": "2020-09-30T13:04:37Z", "author": {"login": "ichttt"}, "path": "patches/minecraft/net/minecraft/entity/EntityClassification.java.patch", "diffHunk": "@@ -9,13 +9,28 @@\n     MONSTER(\"monster\", 70, false, false, 128),\n     CREATURE(\"creature\", 10, true, true, 128),\n     AMBIENT(\"ambient\", 15, true, false, 128),\n-@@ -57,6 +57,10 @@\n+@@ -14,7 +14,7 @@\n+    WATER_AMBIENT(\"water_ambient\", 20, true, false, 64),\n+    MISC(\"misc\", -1, true, true, 128);\n+ \n+-   public static final Codec<EntityClassification> field_233667_g_ = IStringSerializable.func_233023_a_(EntityClassification::values, EntityClassification::func_233670_a_);\n++   public static final Codec<EntityClassification> field_233667_g_ = net.minecraftforge.common.IExtensibleEnum.createCodecForExtensibleEnum(EntityClassification::values, EntityClassification::func_233670_a_);\n+    private static final Map<String, EntityClassification> field_220364_f = Arrays.stream(values()).collect(Collectors.toMap(EntityClassification::func_220363_a, (p_220362_0_) -> {\n+       return p_220362_0_;\n+    }));\n+@@ -57,6 +57,16 @@\n        return this.field_82707_i;\n     }\n  \n +   public static EntityClassification create(String name, String id, int maxNumberOfCreatureIn, boolean isPeacefulCreatureIn, boolean isAnimalIn, int despawnDistance) {\n +      throw new IllegalStateException(\"Enum not extended\");\n +   }\n++\n++   @Override\n++   @Deprecated\n++   public void init() {\n++      field_220364_f.put(this.field_220365_j, this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b04a184fddf2ee0a8012a5548a3f50859054414"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cb35101c3dfbb1b67bed5458af7c0d45062e812", "author": {"user": {"login": "maxanier", "name": "Max Becker"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2cb35101c3dfbb1b67bed5458af7c0d45062e812", "committedDate": "2020-09-30T13:24:06Z", "message": "Use getter instead of direct field access"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2274, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}