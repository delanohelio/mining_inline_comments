{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUyMjA0MTU5", "number": 6992, "title": "[1.16] Re-added PlayerEvent.NameFormat", "bodyText": "Since it seems that PlayerEvent.NameFormat wasn't ported to more recent versions of Forge, I have reimplemented it here.\nThe behavior is identical to how it used to work:\n\nThe PlayerEvent.NameFormat is fired properly and can change the display name of a player.\nThis affects the name tag in the world and in the chat.\nThis does not affect the name in the player list (tab). This is intended and how it used to work.\nEntityPlayer#refreshDisplayName() needs to be called to re-fire the PlayerEvent.NameFormat event.\n\nChanges:\n\n\nDidn't readd EntityPlayer#getDisplayNameString(). Instead, the displayname field is now set in EntityPlayer#getDisplayName()\n\n\nChanged PlayerEvent.NameFormat and all methods that rely on it to use ITextComponent instead of String.\n\n\nThis PR also contains a test mod", "createdAt": "2020-07-18T23:30:40Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992", "merged": true, "mergeCommit": {"oid": "941b9a1d1fcddaba9de2a050a5bb07163f188c3a"}, "closed": true, "closedAt": "2020-07-27T21:16:36Z", "author": {"login": "Tschipp"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc2Q77iAH2gAyNDUyMjA0MTU5OjJkZTJjMDYzYzQ2NzBkYzlkNzcxZDExM2QwM2Y1MzMzYzkzM2I4MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5IiNHAH2gAyNDUyMjA0MTU5OmZmMzA1OWYxMWVhMzE1ZmM2MWIwNDczOGY2NGU2N2IxZGFjMTZjZGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817", "author": {"user": {"login": "Tschipp", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2de2c063c4670dc9d771d113d03f5333c933b817", "committedDate": "2020-07-18T23:21:56Z", "message": "Re-added PlayerEvent.NameFormat"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDg4MTE4", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#pullrequestreview-451088118", "createdAt": "2020-07-18T23:33:02Z", "commit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMzozMzowMlrOGzrNnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQyMzo0MjozOFrOGzrQNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzODU1Nw==", "bodyText": "Weird spacing here", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456838557", "createdAt": "2020-07-18T23:33:02Z", "author": {"login": "Yunus1903"}, "path": "src/test/resources/META-INF/mods.toml", "diffHunk": "@@ -71,4 +71,6 @@ loaderVersion=\"[28,)\"\n [[mods]]\n     modId=\"ender_mask_test\"\n [[mods]]\n-    modId=\"raid_enum_test\"\n\\ No newline at end of file\n+    modId=\"raid_enum_test\"\n+[[mods]]\n+\tmodId=\"player_name_event_test\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzODg5MA==", "bodyText": "if statement has no space between the if and (", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456838890", "createdAt": "2020-07-18T23:37:35Z", "author": {"login": "Yunus1903"}, "path": "patches/minecraft/net/minecraft/entity/player/PlayerEntity.java.patch", "diffHunk": "@@ -288,19 +288,23 @@\n        this.field_71068_ca += p_82242_1_;\n        if (this.field_71068_ca < 0) {\n           this.field_71068_ca = 0;\n-@@ -1704,7 +1745,10 @@\n+@@ -1702,9 +1743,13 @@\n+    public Scoreboard func_96123_co() {\n+       return this.field_70170_p.func_96441_U();\n     }\n- \n+-\n++   \n     public ITextComponent func_145748_c_() {\n -      IFormattableTextComponent iformattabletextcomponent = ScorePlayerTeam.func_237500_a_(this.func_96124_cp(), this.func_200200_C_());\n++      if(this.displayname == null) this.displayname = net.minecraftforge.event.ForgeEventFactory.getPlayerDisplayName(this, this.func_200200_C_());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzOTA4Nw==", "bodyText": "Minecraft tabs need to be 3 spaces, some of them are longer here", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456839087", "createdAt": "2020-07-18T23:40:30Z", "author": {"login": "Yunus1903"}, "path": "patches/minecraft/net/minecraft/entity/player/PlayerEntity.java.patch", "diffHunk": "@@ -313,6 +317,14 @@\n +   public Collection<IFormattableTextComponent> getSuffixes() {\n +       return this.suffixes;\n +   }\n++   \n++   private ITextComponent displayname = null;\n++   /**\n++    * Force the displayed name to refresh\n++    */\n++   public void refreshDisplayName() {\n++       this.displayname = net.minecraftforge.event.ForgeEventFactory.getPlayerDisplayName(this, this.func_200200_C_());\n++   }\n +\n +   private final net.minecraftforge.common.util.LazyOptional<net.minecraftforge.items.IItemHandler>\n +         playerMainHandler = net.minecraftforge.common.util.LazyOptional.of(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgzOTIyMQ==", "bodyText": "Bracket should be on the next line here (for consistency in the class)", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456839221", "createdAt": "2020-07-18T23:42:38Z", "author": {"login": "Yunus1903"}, "path": "src/main/java/net/minecraftforge/event/entity/player/PlayerEvent.java", "diffHunk": "@@ -152,26 +153,26 @@ public BreakSpeed(PlayerEntity player, BlockState state, float original, BlockPo\n      **/\n     public static class NameFormat extends PlayerEvent\n     {\n-        private final String username;\n-        private String displayname;\n+        private final ITextComponent username;\n+        private ITextComponent displayname;\n \n-        public NameFormat(PlayerEntity player, String username) {\n+        public NameFormat(PlayerEntity player, ITextComponent username) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2de2c063c4670dc9d771d113d03f5333c933b817"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a00c2c4a20d37eff7b6b6ae6ef5ab3416d244a5", "author": {"user": {"login": "Tschipp", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/1a00c2c4a20d37eff7b6b6ae6ef5ab3416d244a5", "committedDate": "2020-07-19T08:25:44Z", "message": "Fixed various formatting issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMTQyMDA3", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#pullrequestreview-451142007", "createdAt": "2020-07-19T15:36:33Z", "commit": {"oid": "1a00c2c4a20d37eff7b6b6ae6ef5ab3416d244a5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOVQxNTozNjozNFrOGzwXIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOVQxNTozOTowN1rOGzwYBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyMjkxNQ==", "bodyText": "Unnecessary patch.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456922915", "createdAt": "2020-07-19T15:36:34Z", "author": {"login": "diesieben07"}, "path": "patches/minecraft/net/minecraft/entity/player/PlayerEntity.java.patch", "diffHunk": "@@ -288,19 +288,23 @@\n        this.field_71068_ca += p_82242_1_;\n        if (this.field_71068_ca < 0) {\n           this.field_71068_ca = 0;\n-@@ -1704,7 +1745,10 @@\n+@@ -1702,9 +1743,13 @@\n+    public Scoreboard func_96123_co() {\n+       return this.field_70170_p.func_96441_U();\n     }\n- \n+-\n++   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a00c2c4a20d37eff7b6b6ae6ef5ab3416d244a5"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjkyMzE0Mw==", "bodyText": "That JavaDoc explains almost nothing. You should at least link to the event name and clarify that this will cause the event to be re-fired.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6992#discussion_r456923143", "createdAt": "2020-07-19T15:39:07Z", "author": {"login": "diesieben07"}, "path": "patches/minecraft/net/minecraft/entity/player/PlayerEntity.java.patch", "diffHunk": "@@ -313,6 +317,14 @@\n +   public Collection<IFormattableTextComponent> getSuffixes() {\n +       return this.suffixes;\n +   }\n++   \n++   private ITextComponent displayname = null;\n++   /**\n++    * Force the displayed name to refresh\n++    */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a00c2c4a20d37eff7b6b6ae6ef5ab3416d244a5"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "759805ef8a390547fc62100bb31873825fe7f06b", "author": {"user": {"login": "Tschipp", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/759805ef8a390547fc62100bb31873825fe7f06b", "committedDate": "2020-07-19T18:54:18Z", "message": "Improved Javadoc and removed unnecessary patch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6a25f892afa158fe49344ce125092674056baed", "author": {"user": {"login": "Tschipp", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/b6a25f892afa158fe49344ce125092674056baed", "committedDate": "2020-07-20T14:38:29Z", "message": "Changed Implementation to be Non-Breaking, also improved Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00d0041e81ae6e56176af4228f09b772df6f714f", "author": {"user": {"login": "Tschipp", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/00d0041e81ae6e56176af4228f09b772df6f714f", "committedDate": "2020-07-20T14:47:34Z", "message": "Revert \"Changed Implementation to be Non-Breaking, also improved Javadoc\"\n\nThis reverts commit b6a25f892afa158fe49344ce125092674056baed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff3059f11ea315fc61b04738f64e67b1dac16cdb", "author": {"user": {"login": "LexManos", "name": "LexManos"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/ff3059f11ea315fc61b04738f64e67b1dac16cdb", "committedDate": "2020-07-27T21:16:22Z", "message": "Merge branch '1.16.x' into PlayerEvent.NameFormat"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2478, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}