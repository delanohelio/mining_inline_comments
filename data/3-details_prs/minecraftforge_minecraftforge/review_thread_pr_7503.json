{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0ODM2MzM2", "number": 7503, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxMzo1NzoyNlrOFJQG1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMjo1N1rOFJQOIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1MjQ1Mzk2OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/minecraftforge/registries/GameData.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxMzo1NzoyNlrOILjZ3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDoyMDo0NlrOILkMMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4NTMxMA==", "bodyText": "We are not vanilla, might want to make this message a bit more useful and not use Util.pauseDevMode.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548985310", "createdAt": "2020-12-26T13:57:26Z", "author": {"login": "diesieben07"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -613,6 +618,38 @@ public void onCreate(IForgeRegistryInternal<Feature<?>> owner, RegistryManager s\n         }\n     }\n \n+    private static class PointOfInterestTypeCallbacks implements IForgeRegistry.AddCallback<PointOfInterestType> , IForgeRegistry.ClearCallback<PointOfInterestType>, IForgeRegistry.CreateCallback<PointOfInterestType>\n+    {\n+        static final PointOfInterestTypeCallbacks INSTANCE = new PointOfInterestTypeCallbacks();\n+        \n+        @Override\n+        public void onAdd(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage, int id, PointOfInterestType obj, @Nullable PointOfInterestType oldObj)\n+        {\n+            Map<BlockState, PointOfInterestType> map = owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class);\n+            if (oldObj != null)\n+            {\n+                oldObj.getBlockStates().forEach(map::remove);\n+            }\n+            obj.getBlockStates().forEach((state) -> \n+            {\n+                if (map.put(state, obj) != null)\n+                {\n+                    throw Util.pauseDevMode(new IllegalStateException(String.format(\"%s is defined in too many tags\", state)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5db4f68cacd86455c9520684cb0faad6c8ca6099"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk5ODE5NA==", "bodyText": "Now explains which POI's conflict and why.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548998194", "createdAt": "2020-12-26T14:20:46Z", "author": {"login": "mrp-v2"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -613,6 +618,38 @@ public void onCreate(IForgeRegistryInternal<Feature<?>> owner, RegistryManager s\n         }\n     }\n \n+    private static class PointOfInterestTypeCallbacks implements IForgeRegistry.AddCallback<PointOfInterestType> , IForgeRegistry.ClearCallback<PointOfInterestType>, IForgeRegistry.CreateCallback<PointOfInterestType>\n+    {\n+        static final PointOfInterestTypeCallbacks INSTANCE = new PointOfInterestTypeCallbacks();\n+        \n+        @Override\n+        public void onAdd(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage, int id, PointOfInterestType obj, @Nullable PointOfInterestType oldObj)\n+        {\n+            Map<BlockState, PointOfInterestType> map = owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class);\n+            if (oldObj != null)\n+            {\n+                oldObj.getBlockStates().forEach(map::remove);\n+            }\n+            obj.getBlockStates().forEach((state) -> \n+            {\n+                if (map.put(state, obj) != null)\n+                {\n+                    throw Util.pauseDevMode(new IllegalStateException(String.format(\"%s is defined in too many tags\", state)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4NTMxMA=="}, "originalCommit": {"oid": "5db4f68cacd86455c9520684cb0faad6c8ca6099"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1MjQ2Mjk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/minecraftforge/registries/GameData.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMTowNVrOILjffg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDoxOTozOVrOILkMBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4Njc1MA==", "bodyText": "Formatting: Put the annotation on its own line like everywhere else.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548986750", "createdAt": "2020-12-26T14:01:05Z", "author": {"login": "diesieben07"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -615,6 +620,38 @@ public void onCreate(IForgeRegistryInternal<Feature<?>> owner, RegistryManager s\n         }\n     }\n \n+    private static class PointOfInterestTypeCallbacks implements IForgeRegistry.AddCallback<PointOfInterestType> , IForgeRegistry.ClearCallback<PointOfInterestType>, IForgeRegistry.CreateCallback<PointOfInterestType>\n+    {\n+        static final PointOfInterestTypeCallbacks INSTANCE = new PointOfInterestTypeCallbacks();\n+        \n+        @Override\n+        public void onAdd(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage, int id, PointOfInterestType obj, @Nullable PointOfInterestType oldObj)\n+        {\n+            Map<BlockState, PointOfInterestType> map = owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class);\n+            if (oldObj != null)\n+            {\n+                oldObj.getBlockStates().forEach(map::remove);\n+            }\n+            obj.getBlockStates().forEach((state) -> \n+            {\n+                if (map.put(state, obj) != null)\n+                {\n+                    throw Util.pauseDevMode(new IllegalStateException(String.format(\"%s is defined in too many tags\", state)));\n+                }\n+            });\n+        }\n+\n+        @Override public void onClear(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk5ODE0OA==", "bodyText": "Silly IDE formatting...", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548998148", "createdAt": "2020-12-26T14:19:39Z", "author": {"login": "mrp-v2"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -615,6 +620,38 @@ public void onCreate(IForgeRegistryInternal<Feature<?>> owner, RegistryManager s\n         }\n     }\n \n+    private static class PointOfInterestTypeCallbacks implements IForgeRegistry.AddCallback<PointOfInterestType> , IForgeRegistry.ClearCallback<PointOfInterestType>, IForgeRegistry.CreateCallback<PointOfInterestType>\n+    {\n+        static final PointOfInterestTypeCallbacks INSTANCE = new PointOfInterestTypeCallbacks();\n+        \n+        @Override\n+        public void onAdd(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage, int id, PointOfInterestType obj, @Nullable PointOfInterestType oldObj)\n+        {\n+            Map<BlockState, PointOfInterestType> map = owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class);\n+            if (oldObj != null)\n+            {\n+                oldObj.getBlockStates().forEach(map::remove);\n+            }\n+            obj.getBlockStates().forEach((state) -> \n+            {\n+                if (map.put(state, obj) != null)\n+                {\n+                    throw Util.pauseDevMode(new IllegalStateException(String.format(\"%s is defined in too many tags\", state)));\n+                }\n+            });\n+        }\n+\n+        @Override public void onClear(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4Njc1MA=="}, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1MjQ2MzQ4OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/minecraftforge/registries/GameData.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMToxMVrOILjf3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMToxMVrOILjf3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4Njg0Nw==", "bodyText": "Formatting", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548986847", "createdAt": "2020-12-26T14:01:11Z", "author": {"login": "diesieben07"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -615,6 +620,38 @@ public void onCreate(IForgeRegistryInternal<Feature<?>> owner, RegistryManager s\n         }\n     }\n \n+    private static class PointOfInterestTypeCallbacks implements IForgeRegistry.AddCallback<PointOfInterestType> , IForgeRegistry.ClearCallback<PointOfInterestType>, IForgeRegistry.CreateCallback<PointOfInterestType>\n+    {\n+        static final PointOfInterestTypeCallbacks INSTANCE = new PointOfInterestTypeCallbacks();\n+        \n+        @Override\n+        public void onAdd(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage, int id, PointOfInterestType obj, @Nullable PointOfInterestType oldObj)\n+        {\n+            Map<BlockState, PointOfInterestType> map = owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class);\n+            if (oldObj != null)\n+            {\n+                oldObj.getBlockStates().forEach(map::remove);\n+            }\n+            obj.getBlockStates().forEach((state) -> \n+            {\n+                if (map.put(state, obj) != null)\n+                {\n+                    throw Util.pauseDevMode(new IllegalStateException(String.format(\"%s is defined in too many tags\", state)));\n+                }\n+            });\n+        }\n+\n+        @Override public void onClear(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage)\n+        {\n+            owner.getSlaveMap(BLOCKSTATE_TO_POINT_OF_INTEREST_TYPE, Map.class).clear();\n+        }\n+\n+        @Override public void onCreate(IForgeRegistryInternal<PointOfInterestType> owner, RegistryManager stage)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1MjQ2NjExOnYy", "diffSide": "RIGHT", "path": "src/main/java/net/minecraftforge/registries/GameData.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMTo0M1rOILjhoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMTo0M1rOILjhoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4NzI5Nw==", "bodyText": "Why?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548987297", "createdAt": "2020-12-26T14:01:43Z", "author": {"login": "diesieben07"}, "path": "src/main/java/net/minecraftforge/registries/GameData.java", "diffHunk": "@@ -77,6 +74,7 @@\n import net.minecraftforge.common.world.ForgeWorldType;\n import net.minecraftforge.event.RegistryEvent;\n import net.minecraftforge.event.RegistryEvent.MissingMappings;\n+import net.minecraftforge.eventbus.api.SubscribeEvent;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1MjQ3MjY1OnYy", "diffSide": "RIGHT", "path": "patches/minecraft/net/minecraft/village/PointOfInterestType.java.patch", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDowMjo1N1rOILjlzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNDo0OTowMlrOILkVQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4ODM2NA==", "bodyText": "I liked the previous solution of if (false), better. Its a smaller patch and you can add a comment explaining why this is disabled.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548988364", "createdAt": "2020-12-26T14:02:57Z", "author": {"login": "diesieben07"}, "path": "patches/minecraft/net/minecraft/village/PointOfInterestType.java.patch", "diffHunk": "@@ -9,3 +9,33 @@\n     private static final Supplier<Set<PointOfInterestType>> field_234168_y_ = Suppliers.memoize(() -> {\n        return Registry.field_218370_L.func_201756_e().map(VillagerProfession::func_221149_b).collect(Collectors.toSet());\n     });\n+@@ -36,7 +36,7 @@\n+    }).filter((p_234173_0_) -> {\n+       return p_234173_0_.func_177229_b(BedBlock.field_176472_a) == BedPart.HEAD;\n+    }).collect(ImmutableSet.toImmutableSet());\n+-   private static final Map<BlockState, PointOfInterestType> field_221073_u = Maps.newHashMap();\n++   private static final Map<BlockState, PointOfInterestType> field_221073_u = net.minecraftforge.registries.GameData.getBlockStatePointOfInterestTypeMap();\n+    public static final PointOfInterestType field_221054_b = func_226360_a_(\"unemployed\", ImmutableSet.of(), 1, field_221071_s, 1);\n+    public static final PointOfInterestType field_221055_c = func_226359_a_(\"armorer\", func_221042_a(Blocks.field_222424_lM), 1, 1);\n+    public static final PointOfInterestType field_221056_d = func_226359_a_(\"butcher\", func_221042_a(Blocks.field_222423_lL), 1, 1);\n+@@ -112,16 +112,14 @@\n+    }\n+ \n+    private static PointOfInterestType func_221052_a(PointOfInterestType p_221052_0_) {\n+-      p_221052_0_.field_221075_w.forEach((p_234169_1_) -> {\n+-         PointOfInterestType pointofinteresttype = field_221073_u.put(p_234169_1_, p_221052_0_);\n+-         if (pointofinteresttype != null) {\n+-            throw (IllegalStateException)Util.func_229757_c_(new IllegalStateException(String.format(\"%s is defined in too many tags\", p_234169_1_)));\n+-         }\n+-      });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk5Nzk3Ng==", "bodyText": "I opted to delete the code, so that if the code changes in a future Minecraft version, the patch breaks. I choose this because in #7490 it seemed lex prefers patches that will break if the vanilla code changes (see this comment).", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r548997976", "createdAt": "2020-12-26T14:17:23Z", "author": {"login": "mrp-v2"}, "path": "patches/minecraft/net/minecraft/village/PointOfInterestType.java.patch", "diffHunk": "@@ -9,3 +9,33 @@\n     private static final Supplier<Set<PointOfInterestType>> field_234168_y_ = Suppliers.memoize(() -> {\n        return Registry.field_218370_L.func_201756_e().map(VillagerProfession::func_221149_b).collect(Collectors.toSet());\n     });\n+@@ -36,7 +36,7 @@\n+    }).filter((p_234173_0_) -> {\n+       return p_234173_0_.func_177229_b(BedBlock.field_176472_a) == BedPart.HEAD;\n+    }).collect(ImmutableSet.toImmutableSet());\n+-   private static final Map<BlockState, PointOfInterestType> field_221073_u = Maps.newHashMap();\n++   private static final Map<BlockState, PointOfInterestType> field_221073_u = net.minecraftforge.registries.GameData.getBlockStatePointOfInterestTypeMap();\n+    public static final PointOfInterestType field_221054_b = func_226360_a_(\"unemployed\", ImmutableSet.of(), 1, field_221071_s, 1);\n+    public static final PointOfInterestType field_221055_c = func_226359_a_(\"armorer\", func_221042_a(Blocks.field_222424_lM), 1, 1);\n+    public static final PointOfInterestType field_221056_d = func_226359_a_(\"butcher\", func_221042_a(Blocks.field_222423_lL), 1, 1);\n+@@ -112,16 +112,14 @@\n+    }\n+ \n+    private static PointOfInterestType func_221052_a(PointOfInterestType p_221052_0_) {\n+-      p_221052_0_.field_221075_w.forEach((p_234169_1_) -> {\n+-         PointOfInterestType pointofinteresttype = field_221073_u.put(p_234169_1_, p_221052_0_);\n+-         if (pointofinteresttype != null) {\n+-            throw (IllegalStateException)Util.func_229757_c_(new IllegalStateException(String.format(\"%s is defined in too many tags\", p_234169_1_)));\n+-         }\n+-      });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4ODM2NA=="}, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAwMDUxMg==", "bodyText": "Fair enough", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7503#discussion_r549000512", "createdAt": "2020-12-26T14:49:02Z", "author": {"login": "diesieben07"}, "path": "patches/minecraft/net/minecraft/village/PointOfInterestType.java.patch", "diffHunk": "@@ -9,3 +9,33 @@\n     private static final Supplier<Set<PointOfInterestType>> field_234168_y_ = Suppliers.memoize(() -> {\n        return Registry.field_218370_L.func_201756_e().map(VillagerProfession::func_221149_b).collect(Collectors.toSet());\n     });\n+@@ -36,7 +36,7 @@\n+    }).filter((p_234173_0_) -> {\n+       return p_234173_0_.func_177229_b(BedBlock.field_176472_a) == BedPart.HEAD;\n+    }).collect(ImmutableSet.toImmutableSet());\n+-   private static final Map<BlockState, PointOfInterestType> field_221073_u = Maps.newHashMap();\n++   private static final Map<BlockState, PointOfInterestType> field_221073_u = net.minecraftforge.registries.GameData.getBlockStatePointOfInterestTypeMap();\n+    public static final PointOfInterestType field_221054_b = func_226360_a_(\"unemployed\", ImmutableSet.of(), 1, field_221071_s, 1);\n+    public static final PointOfInterestType field_221055_c = func_226359_a_(\"armorer\", func_221042_a(Blocks.field_222424_lM), 1, 1);\n+    public static final PointOfInterestType field_221056_d = func_226359_a_(\"butcher\", func_221042_a(Blocks.field_222423_lL), 1, 1);\n+@@ -112,16 +112,14 @@\n+    }\n+ \n+    private static PointOfInterestType func_221052_a(PointOfInterestType p_221052_0_) {\n+-      p_221052_0_.field_221075_w.forEach((p_234169_1_) -> {\n+-         PointOfInterestType pointofinteresttype = field_221073_u.put(p_234169_1_, p_221052_0_);\n+-         if (pointofinteresttype != null) {\n+-            throw (IllegalStateException)Util.func_229757_c_(new IllegalStateException(String.format(\"%s is defined in too many tags\", p_234169_1_)));\n+-         }\n+-      });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODk4ODM2NA=="}, "originalCommit": {"oid": "8381130ecfdd1225a4da52558340d27fecd84f97"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 776, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}