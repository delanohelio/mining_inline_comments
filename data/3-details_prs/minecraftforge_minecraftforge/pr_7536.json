{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMjQ0MDIw", "number": 7536, "title": "Override invalidateCaps instead of remove for vanilla TE capability invalidation", "bodyText": "Addresses a small oversight of mine in 1a539ff where I did not realize that forge's patched in capabilities for vanilla TEs was hardcoded to happening in remove instead of in invalidateCaps.", "createdAt": "2020-12-06T18:31:01Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536", "merged": true, "mergeCommit": {"oid": "b7fb6484d77cf3c04d3a4353b9ab024e534ba102"}, "closed": true, "closedAt": "2020-12-08T19:54:30Z", "author": {"login": "pupnewfster"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjlPb-AH2gAyNTMzMjQ0MDIwOmY4ODczOGY5YzIzYjA5MDI2YTUzZDlmMDAzOWJkYTZhYWY5MjhjNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkKn1QAFqTU0NzI1OTg5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f88738f9c23b09026a53d9f0039bda6aaf928c5a", "author": {"user": {"login": "pupnewfster", "name": "Sara Freimer"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f88738f9c23b09026a53d9f0039bda6aaf928c5a", "committedDate": "2020-12-06T18:27:56Z", "message": "Properly invalidate patched in vanilla TE caps in invalidateCaps instead of remove so that they get invalidated on chunk unload"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260", "author": {"user": {"login": "pupnewfster", "name": "Sara Freimer"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f8664903bfd96c2c32e6f91986e3dd6563412260", "committedDate": "2020-12-06T18:59:49Z", "message": "Fix access levels, and also switch entity capability invalidation over to using invalidateCaps as it is called at the correct time, and then if we ever add more places entities invalidate their caps in the future they will properly get called and not be forgotten"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MzU4NzE2", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#pullrequestreview-546358716", "createdAt": "2020-12-07T17:12:40Z", "commit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNzoxMjo0MFrOIAxRkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNzoxMzoxM1rOIAxTJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY3ODIyNA==", "bodyText": "Why was the keepData check removed here?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#discussion_r537678224", "createdAt": "2020-12-07T17:12:40Z", "author": {"login": "OrionDevelopment"}, "path": "patches/minecraft/net/minecraft/entity/LivingEntity.java.patch", "diffHunk": "@@ -531,12 +531,10 @@\n +   }\n +\n +   @Override\n-+   public void remove(boolean keepData) {\n-+      super.remove(keepData);\n-+      if (!keepData) {\n-+         for (int x = 0; x < handlers.length; x++)\n-+            handlers[x].invalidate();\n-+      }\n++   protected void invalidateCaps() {\n++      super.invalidateCaps();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY3ODQxNQ==", "bodyText": "Again why was this check removed?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#discussion_r537678415", "createdAt": "2020-12-07T17:12:55Z", "author": {"login": "OrionDevelopment"}, "path": "patches/minecraft/net/minecraft/entity/item/minecart/ContainerMinecartEntity.java.patch", "diffHunk": "@@ -20,11 +20,10 @@\n  \n -      super.func_70106_y();\n +      super.remove(keepData);\n-+      if (!keepData) itemHandler.invalidate();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY3ODYyOA==", "bodyText": "Again removes the keepData check", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#discussion_r537678628", "createdAt": "2020-12-07T17:13:13Z", "author": {"login": "OrionDevelopment"}, "path": "patches/minecraft/net/minecraft/entity/passive/horse/AbstractHorseEntity.java.patch", "diffHunk": "@@ -43,9 +43,9 @@\n +   }\n +\n +   @Override\n-+   public void remove(boolean keepData) {\n-+      super.remove(keepData);\n-+      if (!keepData && itemHandler != null) {\n++   protected void invalidateCaps() {\n++      super.invalidateCaps();\n++      if (itemHandler != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2MzkxNzM4", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#pullrequestreview-546391738", "createdAt": "2020-12-07T17:51:40Z", "commit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNzo1MTo0MFrOIAy_Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNzo1MTo0MFrOIAy_Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzcwNjMwMg==", "bodyText": "This annotation can just be removed. It was Nullable to override the vanilla's package level ones. Back before the cap optional rewrite.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#discussion_r537706302", "createdAt": "2020-12-07T17:51:40Z", "author": {"login": "LexManos"}, "path": "patches/minecraft/net/minecraft/tileentity/LockableTileEntity.java.patch", "diffHunk": "@@ -10,16 +10,16 @@\n +      return new net.minecraftforge.items.wrapper.InvWrapper(this);\n +   }\n +\n-+   @javax.annotation.Nullable\n++   @javax.annotation.Nonnull", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8664903bfd96c2c32e6f91986e3dd6563412260"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b8ffc5e9fe5d063baf69b3796a110b732bfcf10", "author": {"user": {"login": "pupnewfster", "name": "Sara Freimer"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/9b8ffc5e9fe5d063baf69b3796a110b732bfcf10", "committedDate": "2020-12-07T17:54:40Z", "message": "Remove unneeded annotation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3MjU5ODky", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7536#pullrequestreview-547259892", "createdAt": "2020-12-08T14:01:04Z", "commit": {"oid": "9b8ffc5e9fe5d063baf69b3796a110b732bfcf10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2243, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}