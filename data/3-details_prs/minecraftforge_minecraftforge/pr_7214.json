{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMzYyNDk4", "number": 7214, "title": "Add user-friendly exceptions when config loading fails", "bodyText": "Currently, when a config file fails to be parsed by NightConfig, it throws a ParsingException. The exception includes no details of what file errored, and in the case of corruption of the file (which is the most reported error), has the vague message of Not enough data available.\nIdeally, the solution would be to find the underlying cause of config corruption and fix it. However, there is no known way to reproduce the issue (outside of trying it thousands of times and hoping for the best), so a fix cannot be attempted.\nBut,at least make the exception message can be made more helpful, so users and support can pinpoint the file causing the crash (because ParsingExceptions are also thrown on invalid TOML files) without losing user-defined config settings.\nThis PR does the following:\n\nWraps any ParsingException thrown during the loading of FMLConfig with a RuntimeException to have a more helpful message:\nFailed to load FML config from {configFile.toString()}\";\nCreates a new ConfigLoadingException, which has a helpful message:\nFailed loading config file <config.getFullPath().toString()> with type <config.getType()> for modid <config.getModId()>\nWraps any ParsingException thrown during config loading (at game startup) and re-loading (from file changes) with a ConfigLoadingException.\n\nNotes:\n\nOnly a ParsingException thrown during game startup from FMLConfig and ConfigTracker makes the game crash. A ParsingException thrown when config re-loading due to file changes does not crash the game, presumably because the ConfigWatcher runs on a separate thread from the game.\nThis is not a solution for the problem of config corruption; that must be tackled separately when the underlying issue is found. In the meanwhile, this PR presents a stopgap measure to allow both end-users and support to better help the user (otherwise the advice is mostly \"delete all your configs\").\nConfigLoadingException was not used for FMLConfig because there is no ModConfig available, and I wanted the exception to be clear as to what it represents: a config loading failure caused by a mod.", "createdAt": "2020-08-03T19:44:23Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7214", "merged": true, "mergeCommit": {"oid": "625cd746ef3ae6e77a0e79fff9095440928c7243"}, "closed": true, "closedAt": "2020-08-21T21:27:13Z", "author": {"login": "sciwhiz12"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7W7DxAH2gAyNDYyMzYyNDk4OmU1ZjdiOTNiZTU1NzUyZDQ4NDc2ZmZjMjAwYjBhMjg4ZGRkMDA3Yzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBJu0xgH2gAyNDYyMzYyNDk4OjA0MzkzNTcwYWRmN2E1Y2M0NTg4YWRjNGM3ZDYzNDBhYjYzOTI0MTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e5f7b93be55752d48476ffc200b0a288ddd007c9", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e5f7b93be55752d48476ffc200b0a288ddd007c9", "committedDate": "2020-08-03T19:10:02Z", "message": "Add user-friendly exceptions when config loading fails"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fc9fca9a68885af2b68b821a93804ba78349de8", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7fc9fca9a68885af2b68b821a93804ba78349de8", "committedDate": "2020-08-03T20:48:52Z", "message": "Add license header to ConfigLoadingException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ad80bcaac70c8e889fb4dbabda4cfee5b8cd2e1", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2ad80bcaac70c8e889fb4dbabda4cfee5b8cd2e1", "committedDate": "2020-08-16T19:27:17Z", "message": "Fix formatting for braces"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjMxNzQ5", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7214#pullrequestreview-470631749", "createdAt": "2020-08-19T16:22:04Z", "commit": {"oid": "2ad80bcaac70c8e889fb4dbabda4cfee5b8cd2e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNjoyMjowNFrOHDPCdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNjoyMjowNFrOHDPCdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1NDE2NA==", "bodyText": "This seems weird, why not just print pass the message as a super argument?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7214#discussion_r473154164", "createdAt": "2020-08-19T16:22:04Z", "author": {"login": "ichttt"}, "path": "src/main/java/net/minecraftforge/fml/config/ConfigLoadingException.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Minecraft Forge\n+ * Copyright (c) 2016-2020.\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.fml.config;\n+\n+public class ConfigLoadingException extends RuntimeException\n+{\n+    private final ModConfig config;\n+\n+    public ConfigLoadingException(ModConfig config, Exception cause)\n+    {\n+        super(cause);\n+        this.config = config;\n+    }\n+\n+    @Override\n+    public String getMessage()\n+    {\n+        return \"Failed loading config file \" + config.getFullPath().toString() + \" with type \" + config.getType() + \" for modid \" + config.getModId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ad80bcaac70c8e889fb4dbabda4cfee5b8cd2e1"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3ff1ac9a309a9a2acfea061a247c139c8e5e7f1", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e3ff1ac9a309a9a2acfea061a247c139c8e5e7f1", "committedDate": "2020-08-19T16:34:15Z", "message": "Move message to super constructor parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc02521127543261b9accfea1ee65933f1dddec0", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/bc02521127543261b9accfea1ee65933f1dddec0", "committedDate": "2020-08-21T19:04:38Z", "message": "Update to latest 1.16.x"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f0c7357f03971544f6624074b64fa7a98a8d588", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/1f0c7357f03971544f6624074b64fa7a98a8d588", "committedDate": "2020-08-21T19:06:15Z", "message": "Change ConfigLoadingException to be inner class of ConfigFileTypeHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNzU2MDEx", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7214#pullrequestreview-472756011", "createdAt": "2020-08-21T19:09:32Z", "commit": {"oid": "1f0c7357f03971544f6624074b64fa7a98a8d588"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxOTowOTozM1rOHE4N3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxOTowOTozM1rOHE4N3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg3NzQwNw==", "bodyText": "private", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7214#discussion_r474877407", "createdAt": "2020-08-21T19:09:33Z", "author": {"login": "LexManos"}, "path": "src/main/java/net/minecraftforge/fml/config/ConfigFileTypeHandler.java", "diffHunk": "@@ -120,4 +120,12 @@ public void run() {\n             }\n         }\n     }\n+\n+    public static class ConfigLoadingException extends RuntimeException\n+    {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f0c7357f03971544f6624074b64fa7a98a8d588"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04393570adf7a5cc4588adc4c7d6340ab6392418", "author": {"user": {"login": "sciwhiz12", "name": null}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/04393570adf7a5cc4588adc4c7d6340ab6392418", "committedDate": "2020-08-21T19:11:27Z", "message": "Make the inner exception private"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2411, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}