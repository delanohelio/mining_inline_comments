{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1MzA4Njg2", "number": 7463, "title": "Allow for custom command argument types", "bodyText": "Allow actually registering custom command argument types by using the new vanilla network filter system to filter them on vanilla connections.\nAfter this PR Forge clients will see the following:\n\nVanilla clients will continue to see the following (improving this behavior is out of scope for this PR).\n\nThis is enabled by actually registering Forge's custom argument types (ModIdArgument and EnumArgument), this was previously disabled due to it preventing vanilla clients from connecting.\nI have also removed the existing patch to SCommandListPacket for the following reasons:\n\nIf the argument type could not be found on the client it's data would have to be read first, before reading the ResourceLocation for the custom suggestion data. However we don't know what the argument type is, so we can't read it's data. Trying to read a ResourceLocation here will only produce garbled data.\nThis patch was completely ineffective anyways, because the condition it checked will never evaluate to true. (i & 16) != 0 cannot be true, if i is initialized as buf & 3.\n\nPotentially improving the behavior of custom argument types that are present on the server, but not on a forge client is out of scope of this PR. That state will continue to cause errors and would need a separate system, where the client can skip over unknown argument type data. Probably a length would have to be prepended, however that requires altering the protocol.", "createdAt": "2020-11-04T11:04:47Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463", "merged": true, "mergeCommit": {"oid": "bca20ace4ecb1da07806c8fc6c749826c3bd57e1"}, "closed": true, "closedAt": "2020-11-10T20:24:25Z", "author": {"login": "diesieben07"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZLkp2AH2gAyNTE1MzA4Njg2OmU2OTZlMWIzNzAwZjYzMjg5YjNiZTVjODU4MzU2OWI5MDI1YzQ3ZDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbO9c7gFqTUyNzU2MDQxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e696e1b3700f63289b3be5c8583569b9025c47d6", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e696e1b3700f63289b3be5c8583569b9025c47d6", "committedDate": "2020-11-04T10:54:20Z", "message": "Add support for custom argument types by filtering them on vanilla connections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0290829e5078a21738c4eea1c5e633efd1a6dcf", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f0290829e5078a21738c4eea1c5e633efd1a6dcf", "committedDate": "2020-11-04T10:54:21Z", "message": "Add support for custom argument types by filtering them on vanilla connections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07a0066e3b94b875a3f8691d23e66455ae56156d", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/07a0066e3b94b875a3f8691d23e66455ae56156d", "committedDate": "2020-11-04T11:11:41Z", "message": "Order SAS, clean up EnumArgument warnings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2258fefe4643c5d607f28bb086e4b2c355f33d7c", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2258fefe4643c5d607f28bb086e4b2c355f33d7c", "committedDate": "2020-11-04T11:12:41Z", "message": "clean up EnumArgument warnings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMzA1ODAx", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#pullrequestreview-523305801", "createdAt": "2020-11-04T12:15:20Z", "commit": {"oid": "2258fefe4643c5d607f28bb086e4b2c355f33d7c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMjoxNToyMFrOHtVk2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMjoxNToyMFrOHtVk2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMwMTQ2Nw==", "bodyText": "Could you remove the empty lines here?\nOr is this policy to leave them here?\nAlso is a ForgeMarker not required here?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#discussion_r517301467", "createdAt": "2020-11-04T12:15:20Z", "author": {"login": "OrionDevelopment"}, "path": "patches/minecraft/net/minecraft/command/arguments/ArgumentTypes.java.patch", "diffHunk": "@@ -0,0 +1,13 @@\n+--- a/net/minecraft/command/arguments/ArgumentTypes.java\n++++ b/net/minecraft/command/arguments/ArgumentTypes.java\n+@@ -220,4 +220,10 @@\n+          this.field_197481_c = p_i48088_3_;\n+       }\n+    }\n++", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2258fefe4643c5d607f28bb086e4b2c355f33d7c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00e9ddd66ab46f3a9cbb1b394f8d2caaf1d387c4", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/00e9ddd66ab46f3a9cbb1b394f8d2caaf1d387c4", "committedDate": "2020-11-04T13:14:52Z", "message": "Remove extra blank line in patch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMzU4MTIw", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#pullrequestreview-523358120", "createdAt": "2020-11-04T13:28:02Z", "commit": {"oid": "00e9ddd66ab46f3a9cbb1b394f8d2caaf1d387c4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzoyODowMlrOHtYA6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxMzoyODowMlrOHtYA6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzM0MTQxNw==", "bodyText": "Another empty line.....\nSorry for being annoying about this. But smaller patches benefit everybody.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#discussion_r517341417", "createdAt": "2020-11-04T13:28:02Z", "author": {"login": "OrionDevelopment"}, "path": "patches/minecraft/net/minecraft/command/arguments/ArgumentTypes.java.patch", "diffHunk": "@@ -0,0 +1,12 @@\n+--- a/net/minecraft/command/arguments/ArgumentTypes.java\n++++ b/net/minecraft/command/arguments/ArgumentTypes.java\n+@@ -220,4 +220,9 @@\n+          this.field_197481_c = p_i48088_3_;\n+       }\n+    }\n++   @javax.annotation.Nullable public static ResourceLocation getId(ArgumentType<?> type) {\n++      Entry<?> entry = func_201040_a(type);\n++      return entry == null ? null : entry.field_197481_c;\n++   }\n++", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00e9ddd66ab46f3a9cbb1b394f8d2caaf1d387c4"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "deb3a476409f7b5f701f098365e661f69e249254", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/deb3a476409f7b5f701f098365e661f69e249254", "committedDate": "2020-11-04T13:40:13Z", "message": "Remove extra blank line in patch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMzcwMzEy", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#pullrequestreview-523370312", "createdAt": "2020-11-04T13:42:55Z", "commit": {"oid": "deb3a476409f7b5f701f098365e661f69e249254"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9147099ed47b3ac488d037cb0f9710f017ed0b9d", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/9147099ed47b3ac488d037cb0f9710f017ed0b9d", "committedDate": "2020-11-04T14:00:49Z", "message": "Remove commented out old StructureArgument"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NTYwNDE3", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#pullrequestreview-527560417", "createdAt": "2020-11-10T19:58:58Z", "commit": {"oid": "9147099ed47b3ac488d037cb0f9710f017ed0b9d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxOTo1ODo1OVrOHwtbOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxOTo1ODo1OVrOHwtbOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgzNzk0NQ==", "bodyText": "This must of changed in a MC update. It needs to be buf & 16 not i & 16to match the case below it. And it does actually function as needed, at least when I wrote it.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7463#discussion_r520837945", "createdAt": "2020-11-10T19:58:59Z", "author": {"login": "LexManos"}, "path": "patches/minecraft/net/minecraft/network/play/server/SCommandListPacket.java.patch", "diffHunk": "@@ -1,12 +0,0 @@\n---- a/net/minecraft/network/play/server/SCommandListPacket.java\n-+++ b/net/minecraft/network/play/server/SCommandListPacket.java\n-@@ -119,6 +119,9 @@\n-          String s = p_197695_0_.func_150789_c(32767);\n-          ArgumentType<?> argumenttype = ArgumentTypes.func_197486_a(p_197695_0_);\n-          if (argumenttype == null) {\n-+            if ((i & 16) != 0) { // FORGE: Flush unused suggestion data", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9147099ed47b3ac488d037cb0f9710f017ed0b9d"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2376, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}