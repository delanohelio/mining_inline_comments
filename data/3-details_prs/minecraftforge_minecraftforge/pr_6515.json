{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczOTI4MjUw", "number": 6515, "title": "Add system for dimensions to be marked for deletion", "bodyText": "When calling DimensionManager.markForDeletion(DimensionType) the DimensionType will not be re-created when the world is reloaded and the save-directory for the dimension will be cleaned up.", "createdAt": "2020-02-11T22:39:30Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6515", "merged": true, "mergeCommit": {"oid": "6345f2670c4b38ab2e14db0102beca81d180995b"}, "closed": true, "closedAt": "2020-06-15T16:37:09Z", "author": {"login": "diesieben07"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDZlO6gH2gAyMzczOTI4MjUwOjZkYzQ0NTNhNjk2ZWVkNWMzODVjNjVmYWNmYTc3ZGIwZGQ2YmQyMmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchm857AH2gAyMzczOTI4MjUwOjllNjc0NmI0ZDVhYmY2ZjZhYmNkMjc1YjUyNDI0OWEzOTE1NWYwYjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6dc4453a696eed5c385c65facfa77db0dd6bd22d", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/6dc4453a696eed5c385c65facfa77db0dd6bd22d", "committedDate": "2020-02-11T22:36:09Z", "message": "Add system for dimensions to be marked for deletion, which will not remove them and their save-data from the save upon reload"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb30f067f31b7d8588c6127617c6469b66cac848", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/eb30f067f31b7d8588c6127617c6469b66cac848", "committedDate": "2020-02-12T18:00:51Z", "message": "add debug mod"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8917dcf2de1b057d4f4326f3e1003e83108668b8", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/8917dcf2de1b057d4f4326f3e1003e83108668b8", "committedDate": "2020-02-12T19:36:40Z", "message": "fix testmod"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8d0e0572d0e785ad3cedc9f34a6eed38853c3e4", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f8d0e0572d0e785ad3cedc9f34a6eed38853c3e4", "committedDate": "2020-02-12T20:31:00Z", "message": "fix testmod and formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ed45d5c50accd93daafdd2fac21bd4377cd17e6", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/6ed45d5c50accd93daafdd2fac21bd4377cd17e6", "committedDate": "2020-02-12T20:32:01Z", "message": "clear folders to remove on load"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7a62f39a431175e3c0f4d5ba88194be65e551ee", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/b7a62f39a431175e3c0f4d5ba88194be65e551ee", "committedDate": "2020-02-12T20:32:22Z", "message": "Remove unneeded method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8b0ed583235d3ab3250e81a44ad34f0e1c39134", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f8b0ed583235d3ab3250e81a44ad34f0e1c39134", "committedDate": "2020-02-12T20:33:26Z", "message": "undo build.gradle update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "775c0caedb7d45683e1edeb8222cdb4009cca6c7", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/775c0caedb7d45683e1edeb8222cdb4009cca6c7", "committedDate": "2020-02-12T20:34:50Z", "message": "undo import changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23d7e8ed3a161835d2aec33b5aeaa5f2dfc1ae6e", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/23d7e8ed3a161835d2aec33b5aeaa5f2dfc1ae6e", "committedDate": "2020-02-12T20:36:14Z", "message": "undo testmod change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccbda2c8c3d5dc255c0f9383bbab9396dd184a11", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/ccbda2c8c3d5dc255c0f9383bbab9396dd184a11", "committedDate": "2020-02-12T20:39:33Z", "message": "small testmod improvement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "634af8b0d945d3fb8dbc80be6acc3db0fbb58654", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/634af8b0d945d3fb8dbc80be6acc3db0fbb58654", "committedDate": "2020-02-12T20:41:53Z", "message": "Improve documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ec3d453589ba5369d4c6713e82d8548a1199e00", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/3ec3d453589ba5369d4c6713e82d8548a1199e00", "committedDate": "2020-02-12T22:42:46Z", "message": "improve testmod"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MjA1MTc0", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6515#pullrequestreview-359205174", "createdAt": "2020-02-14T20:37:33Z", "commit": {"oid": "3ec3d453589ba5369d4c6713e82d8548a1199e00"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQyMDozNzozM1rOFqC_jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQyMDozNzozM1rOFqC_jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTYzMzU0OA==", "bodyText": "This is now how you get the current directory, we have FMLPaths which should have the supplied --gamedir paths.\nNothing in Minecrat should rely on the current execution directory directly. {Server's should set the gamedir to CWD if none is supplied}", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6515#discussion_r379633548", "createdAt": "2020-02-14T20:37:33Z", "author": {"login": "LexManos"}, "path": "src/main/java/net/minecraftforge/common/DimensionManager.java", "diffHunk": "@@ -199,14 +209,49 @@ public static ServerWorld getWorld(MinecraftServer server, DimensionType dim, bo\n         return ret;\n     }\n \n+    /**\n+     * Marks the given dimension for deletion upon next reload of the save.\n+     * The corresponding data directory will be deleted as well.\n+     *\n+     * Note that the dimension need not be currently unloaded. The dimension will stay functioning as normal\n+     * until the save is reloaded.\n+     *\n+     * Vanilla dimensions are not supported and will throw an exception.\n+     *\n+     * @param dim the dimension to delete\n+     */\n+    public static void markForDeletion(DimensionType dim)\n+    {\n+        if (dim.isVanilla())\n+        {\n+            throw new IllegalArgumentException(\"Cannot delete vanilla dimensions.\");\n+        }\n+        getData(dim).markedForDeletion = true;\n+\n+        Path base = Paths.get(\".\").toAbsolutePath().normalize();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ec3d453589ba5369d4c6713e82d8548a1199e00"}, "originalPosition": 85}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MjA2MjEy", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6515#pullrequestreview-359206212", "createdAt": "2020-02-14T20:39:48Z", "commit": {"oid": "3ec3d453589ba5369d4c6713e82d8548a1199e00"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQyMDozOTo0OFrOFqDCsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQyMDozOTo0OFrOFqDCsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTYzNDM1NA==", "bodyText": "Is there a way we can add a confirmation screen similiar to the registry issues one?\nI don't like the idea of deleting files in bulk without atleast a confirmation.\nAlso, should filter this list with a folder.exists() so we don't warn we're deleting folders that are already gone.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6515#discussion_r379634354", "createdAt": "2020-02-14T20:39:48Z", "author": {"login": "LexManos"}, "path": "src/main/java/net/minecraftforge/common/DimensionManager.java", "diffHunk": "@@ -408,6 +457,31 @@ public static void readRegistry(CompoundNBT data)\n                 registerDimensionInternal(entry.id, entry.name, mod, entry.data == null ? null : new PacketBuffer(Unpooled.wrappedBuffer(entry.data)), entry.skyLight());\n             }\n         }\n+\n+        foldersScheduledForDeletion.clear();\n+\n+        ListNBT folderList = data.getList(\"delete_dirs\", Constants.NBT.TAG_STRING);\n+        folderList.stream()\n+                .map(INBT::getString)\n+                .forEach(foldersScheduledForDeletion::add);\n+    }\n+\n+    public static void processScheduledDeletions(SaveHandler saveHandler)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ec3d453589ba5369d4c6713e82d8548a1199e00"}, "originalPosition": 156}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99762bda50a586e81cf32301ef3d708f9b179877", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/99762bda50a586e81cf32301ef3d708f9b179877", "committedDate": "2020-05-15T17:33:00Z", "message": "Merge branch '1.15.x' into mark-dimension-for-deletion\n\n# Conflicts:\n#\tsrc/main/java/net/minecraftforge/common/DimensionManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e6746b4d5abf6f6abcd275b524249a39155f0b4", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/9e6746b4d5abf6f6abcd275b524249a39155f0b4", "committedDate": "2020-05-15T19:08:30Z", "message": "Add startupquery before deleting dimensions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2131, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}