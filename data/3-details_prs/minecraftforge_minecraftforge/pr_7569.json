{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NzU3MzEz", "number": 7569, "title": "Add ForgeHooks.canEntitySpawn to instances of ISpecialSpawner", "bodyText": "This can be used to allow mods to cancel Phantom spawn events.\nAn example of this would be TorchMaster which dynamically blocks entity spawning if they are in range of a MegaTorch block\nhttps://github.com/Xalcon/TorchMaster/blob/e1a5fd037fd3a1677109d7146376b01bc7f9ef9f/src/main/java/net/xalcon/torchmaster/common/logic/entityblocking/EntityBlockingEventHandler.java#L22-L46\nNo edits would need to be made to TorchMaster's code to start using this hook.\nI'm not too sure if this is the best way to do this, so let me know if there's a better way.", "createdAt": "2020-12-27T03:04:04Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7569", "merged": true, "mergeCommit": {"oid": "e039531497ab875b03c28d51c18f4181c81f7fe6"}, "closed": true, "closedAt": "2021-02-15T21:40:03Z", "author": {"login": "shroomdog27"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqYdyrgFqTU1ODk1OTc2NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdukICngBqjQxODc0NDU0NzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTU5NzY0", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7569#pullrequestreview-558959764", "createdAt": "2020-12-27T21:29:58Z", "commit": {"oid": "e68def26fe8cf2a2114a426d64b9015094f1e8d0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QyMToyOTo1OFrOILuafQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yN1QyMTozMToxNVrOILuazA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE2NTY5Mw==", "bodyText": "There's lots of other calculations in this class that are used to determine where to spawn a Cat. I didn't want to make a large patch to bypass that code, so I just stuck it in the spawnCat method.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7569#discussion_r549165693", "createdAt": "2020-12-27T21:29:58Z", "author": {"login": "shroomdog27"}, "path": "patches/minecraft/net/minecraft/world/spawner/CatSpawner.java.patch", "diffHunk": "@@ -0,0 +1,10 @@\n+--- a/net/minecraft/world/spawner/CatSpawner.java\n++++ b/net/minecraft/world/spawner/CatSpawner.java\n+@@ -80,6 +80,7 @@\n+       if (catentity == null) {\n+          return 0;\n+       } else {\n++         if(net.minecraftforge.common.ForgeHooks.canEntitySpawn(catentity, p_221122_2_, p_221122_1_.func_177958_n(), p_221122_1_.func_177956_o(), p_221122_1_.func_177952_p(), null, SpawnReason.NATURAL) == -1) return 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e68def26fe8cf2a2114a426d64b9015094f1e8d0"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE2NTc3Mg==", "bodyText": "Same for PatrolSpawner. func_230253_a_ is the main method that is used to determine if a Patrol can spawn. I just hooked into spawnPatroller at the very end to look at the end result if the game decides it wants to spawn a Patrol or not.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7569#discussion_r549165772", "createdAt": "2020-12-27T21:31:15Z", "author": {"login": "shroomdog27"}, "path": "patches/minecraft/net/minecraft/world/spawner/PatrolSpawner.java.patch", "diffHunk": "@@ -0,0 +1,10 @@\n+--- a/net/minecraft/world/spawner/PatrolSpawner.java\n++++ b/net/minecraft/world/spawner/PatrolSpawner.java\n+@@ -94,6 +94,7 @@\n+          return false;\n+       } else {\n+          PatrollerEntity patrollerentity = EntityType.field_220350_aJ.func_200721_a(p_222695_1_);\n++         if(net.minecraftforge.common.ForgeHooks.canEntitySpawn(patrollerentity, p_222695_1_, p_222695_2_.func_177958_n(), p_222695_2_.func_177956_o(), p_222695_2_.func_177952_p(), null, SpawnReason.PATROL) == -1) return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e68def26fe8cf2a2114a426d64b9015094f1e8d0"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b004f6f75e32d030792fe679373b94a2c8c63d7", "author": {"user": {"login": "shroomdog27", "name": "Sydney"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/0b004f6f75e32d030792fe679373b94a2c8c63d7", "committedDate": "2021-01-09T21:22:29Z", "message": "Add ForgeHooks.canEntitySpawn to PhantomSpawner\n\n* This can be used to allow mods to cancel Phantom spawn events."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67be72e0f68dcffb969e3b12e3008908fbb027cd", "author": {"user": {"login": "shroomdog27", "name": "Sydney"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/67be72e0f68dcffb969e3b12e3008908fbb027cd", "committedDate": "2021-01-09T21:22:30Z", "message": "Add hooks for other instances of ISpecialSpawner\n\n* Added for CatSpawner\n* Added for PatrolSpawner\n* NOT added for VillageSiege. It is already handled by VillageSiegeEvent\n* NOT added for WanderingTraderSpawner. It calls EntityType#spawn which is already handled by ForgeEventFactory#doSpecialSpawn"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e68def26fe8cf2a2114a426d64b9015094f1e8d0", "author": {"user": {"login": "shroomdog27", "name": "Sydney"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e68def26fe8cf2a2114a426d64b9015094f1e8d0", "committedDate": "2020-12-27T20:47:09Z", "message": "Add hooks for other instances of ISpecialSpawner\n\n* Added for CatSpawner\n* Added for PatrolSpawner\n* NOT added for VillageSiege. It is already handled by VillageSiegeEvent\n* NOT added for WanderingTraderSpawner. It calls EntityType#spawn which is already handled by ForgeEventFactory#doSpecialSpawn"}, "afterCommit": {"oid": "67be72e0f68dcffb969e3b12e3008908fbb027cd", "author": {"user": {"login": "shroomdog27", "name": "Sydney"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/67be72e0f68dcffb969e3b12e3008908fbb027cd", "committedDate": "2021-01-09T21:22:30Z", "message": "Add hooks for other instances of ISpecialSpawner\n\n* Added for CatSpawner\n* Added for PatrolSpawner\n* NOT added for VillageSiege. It is already handled by VillageSiegeEvent\n* NOT added for WanderingTraderSpawner. It calls EntityType#spawn which is already handled by ForgeEventFactory#doSpecialSpawn"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2259, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}