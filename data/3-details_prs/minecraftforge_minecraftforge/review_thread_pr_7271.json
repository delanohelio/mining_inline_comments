{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyOTYzMzc4", "number": 7271, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNTowMzoxMVrOEcHNPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNzoxN1rOEctrnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3OTEzNjYyOnYy", "diffSide": "RIGHT", "path": "patches/minecraft/net/minecraft/tags/ITag.java.patch", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNTowMzoxMVrOHGceXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwMToxNjo0M1rOHMRwGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUyMDAzMA==", "bodyText": "Pretty sure ItemEntry is meant for a single entry, EntityTypeTags and FluidTags are also ItemEntry's.\nThe DataGeneratorTest uses BlockTags but I am guessing it worked on the fact that blocks and items share the same name.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r476520030", "createdAt": "2020-08-25T15:03:11Z", "author": {"login": "Cyborgmas"}, "path": "patches/minecraft/net/minecraft/tags/ITag.java.patch", "diffHunk": "@@ -41,18 +41,37 @@\n           jsonobject.add(\"values\", jsonarray);\n           return jsonobject;\n        }\n-@@ -178,6 +189,7 @@\n+@@ -152,6 +163,8 @@\n+       <T> boolean func_230238_a_(Function<ResourceLocation, ITag<T>> p_230238_1_, Function<ResourceLocation, T> p_230238_2_, Consumer<T> p_230238_3_);\n+ \n+       void func_230237_a_(JsonArray p_230237_1_);\n++\n++      default boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) { return true; }\n+    }\n+ \n+    public static class ItemEntry implements ITag.ITagEntry {\n+@@ -178,6 +191,12 @@\n        public String toString() {\n           return this.field_232969_a_.toString();\n        }\n +      @Override public boolean equals(Object o) { return o == this || (o instanceof ITag.ItemEntry && java.util.Objects.equals(this.field_232969_a_, ((ITag.ItemEntry) o).field_232969_a_)); }\n++\n++      @Override\n++      public boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) {\n++         return net.minecraftforge.registries.ForgeRegistries.ITEMS.containsKey(field_232969_a_);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDY4MjQ0Nw==", "bodyText": "That's going to pose a problem then. This method is probably going to move to a static with hardcoded type checks since these 4 entry types are fixed, and I can accept the registry as a parameter there.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r480682447", "createdAt": "2020-09-01T03:15:22Z", "author": {"login": "tterrag1098"}, "path": "patches/minecraft/net/minecraft/tags/ITag.java.patch", "diffHunk": "@@ -41,18 +41,37 @@\n           jsonobject.add(\"values\", jsonarray);\n           return jsonobject;\n        }\n-@@ -178,6 +189,7 @@\n+@@ -152,6 +163,8 @@\n+       <T> boolean func_230238_a_(Function<ResourceLocation, ITag<T>> p_230238_1_, Function<ResourceLocation, T> p_230238_2_, Consumer<T> p_230238_3_);\n+ \n+       void func_230237_a_(JsonArray p_230237_1_);\n++\n++      default boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) { return true; }\n+    }\n+ \n+    public static class ItemEntry implements ITag.ITagEntry {\n+@@ -178,6 +191,12 @@\n        public String toString() {\n           return this.field_232969_a_.toString();\n        }\n +      @Override public boolean equals(Object o) { return o == this || (o instanceof ITag.ItemEntry && java.util.Objects.equals(this.field_232969_a_, ((ITag.ItemEntry) o).field_232969_a_)); }\n++\n++      @Override\n++      public boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) {\n++         return net.minecraftforge.registries.ForgeRegistries.ITEMS.containsKey(field_232969_a_);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUyMDAzMA=="}, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNTgwMQ==", "bodyText": "Thinking about it more, this code is completely unnecessary. An ItemEntry will never reach this point because validating the registry contains the entry is handled by func_232963_b_. I'm going to push a new version that only cares about TagEntry and hardcodes it into TagsProvider.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r482635801", "createdAt": "2020-09-03T01:16:43Z", "author": {"login": "tterrag1098"}, "path": "patches/minecraft/net/minecraft/tags/ITag.java.patch", "diffHunk": "@@ -41,18 +41,37 @@\n           jsonobject.add(\"values\", jsonarray);\n           return jsonobject;\n        }\n-@@ -178,6 +189,7 @@\n+@@ -152,6 +163,8 @@\n+       <T> boolean func_230238_a_(Function<ResourceLocation, ITag<T>> p_230238_1_, Function<ResourceLocation, T> p_230238_2_, Consumer<T> p_230238_3_);\n+ \n+       void func_230237_a_(JsonArray p_230237_1_);\n++\n++      default boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) { return true; }\n+    }\n+ \n+    public static class ItemEntry implements ITag.ITagEntry {\n+@@ -178,6 +191,12 @@\n        public String toString() {\n           return this.field_232969_a_.toString();\n        }\n +      @Override public boolean equals(Object o) { return o == this || (o instanceof ITag.ItemEntry && java.util.Objects.equals(this.field_232969_a_, ((ITag.ItemEntry) o).field_232969_a_)); }\n++\n++      @Override\n++      public boolean exists(String type, net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) {\n++         return net.minecraftforge.registries.ForgeRegistries.ITEMS.containsKey(field_232969_a_);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUyMDAzMA=="}, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NTQzMzgwOnYy", "diffSide": "RIGHT", "path": "patches/minecraft/net/minecraft/data/TagsProvider.java.patch", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNToxOVrOHHaNyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNToxOVrOHHaNyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMTU5Mg==", "bodyText": "I would just remove the else and keep the brackets, as this commented out curly bracket is floating around quite freely otherwise (which might cause issues when porting patches)", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r477531592", "createdAt": "2020-08-26T19:15:19Z", "author": {"login": "ichttt"}, "path": "patches/minecraft/net/minecraft/data/TagsProvider.java.patch", "diffHunk": "@@ -1,34 +1,56 @@\n --- a/net/minecraft/data/TagsProvider.java\n +++ b/net/minecraft/data/TagsProvider.java\n-@@ -28,11 +28,17 @@\n+@@ -28,11 +28,19 @@\n     protected final DataGenerator field_200433_a;\n     protected final Registry<T> field_200435_c;\n     protected final Map<ResourceLocation, ITag.Builder> field_200434_b = Maps.newLinkedHashMap();\n +   protected String modId;\n++   net.minecraftforge.common.data.ExistingFileHelper existingFileHelper;\n  \n +   @Deprecated//Forge, Use ModID version.\n     protected TagsProvider(DataGenerator p_i49827_1_, Registry<T> p_i49827_2_) {\n -      this.field_200433_a = p_i49827_1_;\n -      this.field_200435_c = p_i49827_2_;\n-+       this(p_i49827_1_, p_i49827_2_, \"vanilla\");\n++       this(p_i49827_1_, p_i49827_2_, \"vanilla\", null);\n     }\n-+   protected TagsProvider(DataGenerator generatorIn, Registry<T> registryIn, String modId) {\n++   protected TagsProvider(DataGenerator generatorIn, Registry<T> registryIn, String modId, @javax.annotation.Nullable net.minecraftforge.common.data.ExistingFileHelper existingFileHelper) {\n +      this.field_200433_a = generatorIn;\n +      this.field_200435_c = registryIn;\n +      this.modId = modId;\n++      this.existingFileHelper = existingFileHelper;\n +   }\n  \n     protected abstract void func_200432_c();\n  \n-@@ -53,6 +59,7 @@\n-          } else {\n+@@ -49,10 +57,17 @@\n+       this.field_200434_b.forEach((p_240524_4_, p_240524_5_) -> {\n+          List<ITag.Proxy> list = p_240524_5_.func_232963_b_(function, function1).collect(Collectors.toList());\n+          if (!list.isEmpty()) {\n++            // FORGE: Add validation via existing resources\n++            for (ITag.Proxy missingTag : list) {\n++               // Vanilla tag types use plural names, revisit this when/if we add custom tag types\n++               if (existingFileHelper == null || !missingTag.func_232968_a_().exists(((Registry)Registry.field_212617_f).func_177774_c(field_200435_c).func_110623_a() + \"s\", existingFileHelper))\n+             throw new IllegalArgumentException(String.format(\"Couldn't define tag %s as it is missing following references: %s\", p_240524_4_, list.stream().map(Objects::toString).collect(Collectors.joining(\",\"))));\n+-         } else {\n++            }\n++         } //else {\n++            // FORGE: Run this code always, it will be skipped if the above code throws an exception\n              JsonObject jsonobject = p_240524_5_.func_232965_c_();\n              Path path = this.func_200431_a(p_240524_4_);\n +            if (path == null) return; //Forge: Allow running this data provider without writing it. Recipe provider needs valid tags.\n  \n              try {\n                 String s = field_200437_e.toJson((JsonElement)jsonobject);\n-@@ -78,7 +85,7 @@\n+@@ -70,7 +85,7 @@\n+                field_200436_d.error(\"Couldn't save tags to {}\", path, ioexception);\n+             }\n+ \n+-         }\n++//         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NTQzNzExOnYy", "diffSide": "RIGHT", "path": "patches/minecraft/net/minecraft/data/TagsProvider.java.patch", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNjoyMlrOHHaP8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNjoyMlrOHHaP8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMjE0Ng==", "bodyText": "should be private or protected, but package-private makes no sense here", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r477532146", "createdAt": "2020-08-26T19:16:22Z", "author": {"login": "ichttt"}, "path": "patches/minecraft/net/minecraft/data/TagsProvider.java.patch", "diffHunk": "@@ -1,34 +1,56 @@\n --- a/net/minecraft/data/TagsProvider.java\n +++ b/net/minecraft/data/TagsProvider.java\n-@@ -28,11 +28,17 @@\n+@@ -28,11 +28,19 @@\n     protected final DataGenerator field_200433_a;\n     protected final Registry<T> field_200435_c;\n     protected final Map<ResourceLocation, ITag.Builder> field_200434_b = Maps.newLinkedHashMap();\n +   protected String modId;\n++   net.minecraftforge.common.data.ExistingFileHelper existingFileHelper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NTQ0MDI5OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/minecraftforge/client/model/generators/BlockModelBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxOToxNzoxN1rOHHaR3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwMzoxNDozNVrOHKadeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMjYzNg==", "bodyText": "Unnecessary import here and a few times below", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r477532636", "createdAt": "2020-08-26T19:17:17Z", "author": {"login": "ichttt"}, "path": "src/main/java/net/minecraftforge/client/model/generators/BlockModelBuilder.java", "diffHunk": "@@ -20,6 +20,7 @@\n package net.minecraftforge.client.model.generators;\n \n import net.minecraft.util.ResourceLocation;\n+import net.minecraftforge.common.data.ExistingFileHelper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDY4MTMzOA==", "bodyText": "It's not unnecessary...the class moved.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7271#discussion_r480681338", "createdAt": "2020-09-01T03:14:35Z", "author": {"login": "tterrag1098"}, "path": "src/main/java/net/minecraftforge/client/model/generators/BlockModelBuilder.java", "diffHunk": "@@ -20,6 +20,7 @@\n package net.minecraftforge.client.model.generators;\n \n import net.minecraft.util.ResourceLocation;\n+import net.minecraftforge.common.data.ExistingFileHelper;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUzMjYzNg=="}, "originalCommit": {"oid": "69e3984a488b54d829b78890fb8e95d2ba1eea3e"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 895, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}