{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNDM2ODIx", "number": 6822, "title": "[1.16.x] Allow GlobalEntityTypeAttributes' EntityType -> AttributeModifierMap to be added to", "bodyText": "The only way to set attributes on an entity is by registering an AttributeModifierMap to GlobalEntityTypeAttributes. Unfortunately, this map is an ImmutableMap meaning it is impossible to set attributes on a modded entity.\nThis PR remedies that by creating a second map, and adding a put method. It also avoids modifying the vanilla map so that the patch is more stable since it is likely the vanilla map will change.\nThis implementation also does get in the most efficient way I could come up with (getOrDefault will evaluate the second statement, and using containsKey requires going over one of the maps twice)\nThe get method (func_233835_a_) is only used in the constructor of LivingEntity, so it should be safe to register to until your entity is constructed.", "createdAt": "2020-06-26T07:51:28Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822", "merged": true, "mergeCommit": {"oid": "71baebcc930d7ff88436187bfd573993b47fc979"}, "closed": true, "closedAt": "2020-06-26T13:03:57Z", "author": {"login": "itsmeow"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcu-OwlAH2gAyNDQwNDM2ODIxOmE3OTk5NjA3NzVmNDczNmRlYmU4YzcyMDNkM2RiMzE2YzQ0NTA1Mjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvCzzdgFqTQzODI3MTcyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a799960775f4736debe8c7203d3db316c4450529", "author": {"user": {"login": "itsmeow", "name": "itsmeow"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/a799960775f4736debe8c7203d3db316c4450529", "committedDate": "2020-06-26T07:36:50Z", "message": "Make GlobalEntityTypeAttributes map able to be added to"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MDkwMTQ1", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#pullrequestreview-438090145", "createdAt": "2020-06-26T07:59:46Z", "commit": {"oid": "a799960775f4736debe8c7203d3db316c4450529"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MTEyNjY2", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#pullrequestreview-438112666", "createdAt": "2020-06-26T08:33:43Z", "commit": {"oid": "a799960775f4736debe8c7203d3db316c4450529"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MjUzNzUx", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#pullrequestreview-438253751", "createdAt": "2020-06-26T12:29:21Z", "commit": {"oid": "a799960775f4736debe8c7203d3db316c4450529"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjoyOToyMlrOGpfDDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMjozMDozNlrOGpfFTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE1MzQ4NQ==", "bodyText": "There's no need to shove the return into the same line. Patches should be made as simple as possible but not to the extend it hurts readability unnecessarily", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#discussion_r446153485", "createdAt": "2020-06-26T12:29:22Z", "author": {"login": "gigaherz"}, "path": "patches/minecraft/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java.patch", "diffHunk": "@@ -0,0 +1,23 @@\n+--- a/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java\n++++ b/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java\n+@@ -71,13 +71,18 @@\n+ public class GlobalEntityTypeAttributes {\n+    private static final Logger field_233832_a_ = LogManager.getLogger();\n+    private static final Map<EntityType<? extends LivingEntity>, AttributeModifierMap> field_233833_b_ = ImmutableMap.<EntityType<? extends LivingEntity>, AttributeModifierMap>builder().put(EntityType.field_200789_c, LivingEntity.func_233639_cI_().func_233813_a_()).put(EntityType.field_200791_e, BatEntity.func_234175_m_().func_233813_a_()).put(EntityType.field_226289_e_, BeeEntity.func_234182_eX_().func_233813_a_()).put(EntityType.field_200792_f, BlazeEntity.func_234276_m_().func_233813_a_()).put(EntityType.field_220360_g, CatEntity.func_234184_eY_().func_233813_a_()).put(EntityType.field_200794_h, CaveSpiderEntity.func_234277_m_().func_233813_a_()).put(EntityType.field_200795_i, ChickenEntity.func_234187_eI_().func_233813_a_()).put(EntityType.field_203780_j, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200796_j, CowEntity.func_234188_eI_().func_233813_a_()).put(EntityType.field_200797_k, CreeperEntity.func_234278_m_().func_233813_a_()).put(EntityType.field_205137_n, DolphinEntity.func_234190_eK_().func_233813_a_()).put(EntityType.field_200798_l, AbstractChestedHorseEntity.func_234234_eJ_().func_233813_a_()).put(EntityType.field_204724_o, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200800_n, ElderGuardianEntity.func_234283_m_().func_233813_a_()).put(EntityType.field_200803_q, EndermanEntity.func_234287_m_().func_233813_a_()).put(EntityType.field_200804_r, EndermiteEntity.func_234288_m_().func_233813_a_()).put(EntityType.field_200802_p, EnderDragonEntity.func_234257_m_().func_233813_a_()).put(EntityType.field_200806_t, EvokerEntity.func_234289_eI_().func_233813_a_()).put(EntityType.field_220356_B, FoxEntity.func_234192_eI_().func_233813_a_()).put(EntityType.field_200811_y, GhastEntity.func_234290_eH_().func_233813_a_()).put(EntityType.field_200812_z, GiantEntity.func_234291_m_().func_233813_a_()).put(EntityType.field_200761_A, GuardianEntity.func_234292_eK_().func_233813_a_()).put(EntityType.field_233588_G_, HoglinEntity.func_234362_eI_().func_233813_a_()).put(EntityType.field_200762_B, AbstractHorseEntity.func_234237_fg_().func_233813_a_()).put(EntityType.field_200763_C, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200764_D, IllusionerEntity.func_234293_eI_().func_233813_a_()).put(EntityType.field_200757_aw, IronGolemEntity.func_234200_m_().func_233813_a_()).put(EntityType.field_200769_I, LlamaEntity.func_234244_fu_().func_233813_a_()).put(EntityType.field_200771_K, MagmaCubeEntity.func_234294_m_().func_233813_a_()).put(EntityType.field_200780_T, CowEntity.func_234188_eI_().func_233813_a_()).put(EntityType.field_200779_S, AbstractChestedHorseEntity.func_234234_eJ_().func_233813_a_()).put(EntityType.field_200781_U, OcelotEntity.func_234201_eI_().func_233813_a_()).put(EntityType.field_220353_aa, PandaEntity.func_234204_eW_().func_233813_a_()).put(EntityType.field_200783_W, ParrotEntity.func_234213_eS_().func_233813_a_()).put(EntityType.field_203097_aH, MonsterEntity.func_234295_eP_().func_233813_a_()).put(EntityType.field_200784_X, PigEntity.func_234215_eI_().func_233813_a_()).put(EntityType.field_233591_ai_, PiglinEntity.func_234420_eI_().func_233813_a_()).put(EntityType.field_220350_aJ, PillagerEntity.func_234296_eI_().func_233813_a_()).put(EntityType.field_200729_aH, PlayerEntity.func_234570_el_().func_233813_a_()).put(EntityType.field_200786_Z, PolarBearEntity.func_234219_eI_().func_233813_a_()).put(EntityType.field_203779_Z, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200736_ab, RabbitEntity.func_234224_eJ_().func_233813_a_()).put(EntityType.field_220352_aU, RavagerEntity.func_234297_m_().func_233813_a_()).put(EntityType.field_203778_ae, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200737_ac, SheepEntity.func_234225_eI_().func_233813_a_()).put(EntityType.field_200738_ad, ShulkerEntity.func_234300_m_().func_233813_a_()).put(EntityType.field_200740_af, SilverfishEntity.func_234301_m_().func_233813_a_()).put(EntityType.field_200741_ag, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_200742_ah, SkeletonHorseEntity.func_234250_eJ_().func_233813_a_()).put(EntityType.field_200743_ai, MonsterEntity.func_234295_eP_().func_233813_a_()).put(EntityType.field_200745_ak, SnowGolemEntity.func_234226_m_().func_233813_a_()).put(EntityType.field_200748_an, SpiderEntity.func_234305_eI_().func_233813_a_()).put(EntityType.field_200749_ao, SquidEntity.func_234227_m_().func_233813_a_()).put(EntityType.field_200750_ap, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_233589_aE_, StriderEntity.func_234317_eK_().func_233813_a_()).put(EntityType.field_220354_ax, LlamaEntity.func_234244_fu_().func_233813_a_()).put(EntityType.field_204262_at, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_203099_aq, TurtleEntity.func_234228_eK_().func_233813_a_()).put(EntityType.field_200755_au, VexEntity.func_234321_m_().func_233813_a_()).put(EntityType.field_200756_av, VillagerEntity.func_234551_eU_().func_233813_a_()).put(EntityType.field_200758_ax, VindicatorEntity.func_234322_eI_().func_233813_a_()).put(EntityType.field_220351_aK, MobEntity.func_233666_p_().func_233813_a_()).put(EntityType.field_200759_ay, WitchEntity.func_234323_eI_().func_233813_a_()).put(EntityType.field_200760_az, WitherEntity.func_234258_eI_().func_233813_a_()).put(EntityType.field_200722_aA, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_200724_aC, WolfEntity.func_234233_eS_().func_233813_a_()).put(EntityType.field_233590_aW_, ZoglinEntity.func_234339_m_().func_233813_a_()).put(EntityType.field_200725_aD, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200726_aE, ZombieHorseEntity.func_234256_eJ_().func_233813_a_()).put(EntityType.field_200727_aF, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_233592_ba_, ZombifiedPiglinEntity.func_234352_eU_().func_233813_a_()).build();\n++   private static final Map<EntityType<? extends LivingEntity>, AttributeModifierMap> FORGE_ATTRIBUTES = new java.util.HashMap<EntityType<? extends LivingEntity>, AttributeModifierMap>();\n++   \n++   public static AttributeModifierMap put(EntityType<? extends LivingEntity> type, AttributeModifierMap map) {\n++       return FORGE_ATTRIBUTES.put(type, map);\n++   }\n+ \n+    public static AttributeModifierMap func_233835_a_(EntityType<? extends LivingEntity> p_233835_0_) {\n+-      return field_233833_b_.get(p_233835_0_);\n++       AttributeModifierMap map = field_233833_b_.get(p_233835_0_); return map != null ? map : FORGE_ATTRIBUTES.get(p_233835_0_);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a799960775f4736debe8c7203d3db316c4450529"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjE1NDA2MA==", "bodyText": "Is it worth adding a sanity check to prevent copypasta calling put() twice on the same EntityType?", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#discussion_r446154060", "createdAt": "2020-06-26T12:30:36Z", "author": {"login": "gigaherz"}, "path": "patches/minecraft/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java.patch", "diffHunk": "@@ -0,0 +1,23 @@\n+--- a/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java\n++++ b/net/minecraft/entity/ai/attributes/GlobalEntityTypeAttributes.java\n+@@ -71,13 +71,18 @@\n+ public class GlobalEntityTypeAttributes {\n+    private static final Logger field_233832_a_ = LogManager.getLogger();\n+    private static final Map<EntityType<? extends LivingEntity>, AttributeModifierMap> field_233833_b_ = ImmutableMap.<EntityType<? extends LivingEntity>, AttributeModifierMap>builder().put(EntityType.field_200789_c, LivingEntity.func_233639_cI_().func_233813_a_()).put(EntityType.field_200791_e, BatEntity.func_234175_m_().func_233813_a_()).put(EntityType.field_226289_e_, BeeEntity.func_234182_eX_().func_233813_a_()).put(EntityType.field_200792_f, BlazeEntity.func_234276_m_().func_233813_a_()).put(EntityType.field_220360_g, CatEntity.func_234184_eY_().func_233813_a_()).put(EntityType.field_200794_h, CaveSpiderEntity.func_234277_m_().func_233813_a_()).put(EntityType.field_200795_i, ChickenEntity.func_234187_eI_().func_233813_a_()).put(EntityType.field_203780_j, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200796_j, CowEntity.func_234188_eI_().func_233813_a_()).put(EntityType.field_200797_k, CreeperEntity.func_234278_m_().func_233813_a_()).put(EntityType.field_205137_n, DolphinEntity.func_234190_eK_().func_233813_a_()).put(EntityType.field_200798_l, AbstractChestedHorseEntity.func_234234_eJ_().func_233813_a_()).put(EntityType.field_204724_o, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200800_n, ElderGuardianEntity.func_234283_m_().func_233813_a_()).put(EntityType.field_200803_q, EndermanEntity.func_234287_m_().func_233813_a_()).put(EntityType.field_200804_r, EndermiteEntity.func_234288_m_().func_233813_a_()).put(EntityType.field_200802_p, EnderDragonEntity.func_234257_m_().func_233813_a_()).put(EntityType.field_200806_t, EvokerEntity.func_234289_eI_().func_233813_a_()).put(EntityType.field_220356_B, FoxEntity.func_234192_eI_().func_233813_a_()).put(EntityType.field_200811_y, GhastEntity.func_234290_eH_().func_233813_a_()).put(EntityType.field_200812_z, GiantEntity.func_234291_m_().func_233813_a_()).put(EntityType.field_200761_A, GuardianEntity.func_234292_eK_().func_233813_a_()).put(EntityType.field_233588_G_, HoglinEntity.func_234362_eI_().func_233813_a_()).put(EntityType.field_200762_B, AbstractHorseEntity.func_234237_fg_().func_233813_a_()).put(EntityType.field_200763_C, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200764_D, IllusionerEntity.func_234293_eI_().func_233813_a_()).put(EntityType.field_200757_aw, IronGolemEntity.func_234200_m_().func_233813_a_()).put(EntityType.field_200769_I, LlamaEntity.func_234244_fu_().func_233813_a_()).put(EntityType.field_200771_K, MagmaCubeEntity.func_234294_m_().func_233813_a_()).put(EntityType.field_200780_T, CowEntity.func_234188_eI_().func_233813_a_()).put(EntityType.field_200779_S, AbstractChestedHorseEntity.func_234234_eJ_().func_233813_a_()).put(EntityType.field_200781_U, OcelotEntity.func_234201_eI_().func_233813_a_()).put(EntityType.field_220353_aa, PandaEntity.func_234204_eW_().func_233813_a_()).put(EntityType.field_200783_W, ParrotEntity.func_234213_eS_().func_233813_a_()).put(EntityType.field_203097_aH, MonsterEntity.func_234295_eP_().func_233813_a_()).put(EntityType.field_200784_X, PigEntity.func_234215_eI_().func_233813_a_()).put(EntityType.field_233591_ai_, PiglinEntity.func_234420_eI_().func_233813_a_()).put(EntityType.field_220350_aJ, PillagerEntity.func_234296_eI_().func_233813_a_()).put(EntityType.field_200729_aH, PlayerEntity.func_234570_el_().func_233813_a_()).put(EntityType.field_200786_Z, PolarBearEntity.func_234219_eI_().func_233813_a_()).put(EntityType.field_203779_Z, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200736_ab, RabbitEntity.func_234224_eJ_().func_233813_a_()).put(EntityType.field_220352_aU, RavagerEntity.func_234297_m_().func_233813_a_()).put(EntityType.field_203778_ae, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_200737_ac, SheepEntity.func_234225_eI_().func_233813_a_()).put(EntityType.field_200738_ad, ShulkerEntity.func_234300_m_().func_233813_a_()).put(EntityType.field_200740_af, SilverfishEntity.func_234301_m_().func_233813_a_()).put(EntityType.field_200741_ag, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_200742_ah, SkeletonHorseEntity.func_234250_eJ_().func_233813_a_()).put(EntityType.field_200743_ai, MonsterEntity.func_234295_eP_().func_233813_a_()).put(EntityType.field_200745_ak, SnowGolemEntity.func_234226_m_().func_233813_a_()).put(EntityType.field_200748_an, SpiderEntity.func_234305_eI_().func_233813_a_()).put(EntityType.field_200749_ao, SquidEntity.func_234227_m_().func_233813_a_()).put(EntityType.field_200750_ap, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_233589_aE_, StriderEntity.func_234317_eK_().func_233813_a_()).put(EntityType.field_220354_ax, LlamaEntity.func_234244_fu_().func_233813_a_()).put(EntityType.field_204262_at, AbstractFishEntity.func_234176_m_().func_233813_a_()).put(EntityType.field_203099_aq, TurtleEntity.func_234228_eK_().func_233813_a_()).put(EntityType.field_200755_au, VexEntity.func_234321_m_().func_233813_a_()).put(EntityType.field_200756_av, VillagerEntity.func_234551_eU_().func_233813_a_()).put(EntityType.field_200758_ax, VindicatorEntity.func_234322_eI_().func_233813_a_()).put(EntityType.field_220351_aK, MobEntity.func_233666_p_().func_233813_a_()).put(EntityType.field_200759_ay, WitchEntity.func_234323_eI_().func_233813_a_()).put(EntityType.field_200760_az, WitherEntity.func_234258_eI_().func_233813_a_()).put(EntityType.field_200722_aA, AbstractSkeletonEntity.func_234275_m_().func_233813_a_()).put(EntityType.field_200724_aC, WolfEntity.func_234233_eS_().func_233813_a_()).put(EntityType.field_233590_aW_, ZoglinEntity.func_234339_m_().func_233813_a_()).put(EntityType.field_200725_aD, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_200726_aE, ZombieHorseEntity.func_234256_eJ_().func_233813_a_()).put(EntityType.field_200727_aF, ZombieEntity.func_234342_eQ_().func_233813_a_()).put(EntityType.field_233592_ba_, ZombifiedPiglinEntity.func_234352_eU_().func_233813_a_()).build();\n++   private static final Map<EntityType<? extends LivingEntity>, AttributeModifierMap> FORGE_ATTRIBUTES = new java.util.HashMap<EntityType<? extends LivingEntity>, AttributeModifierMap>();\n++   \n++   public static AttributeModifierMap put(EntityType<? extends LivingEntity> type, AttributeModifierMap map) {\n++       return FORGE_ATTRIBUTES.put(type, map);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a799960775f4736debe8c7203d3db316c4450529"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "116284a77ea5f38064e05264f8629e3271726ca9", "author": {"user": {"login": "itsmeow", "name": "itsmeow"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/116284a77ea5f38064e05264f8629e3271726ca9", "committedDate": "2020-06-26T12:41:13Z", "message": "Split get patch into two lines"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f399156d89a5c3cc4d0d061ee3f0f3d0af567b81", "author": {"user": {"login": "itsmeow", "name": "itsmeow"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f399156d89a5c3cc4d0d061ee3f0f3d0af567b81", "committedDate": "2020-06-26T12:33:16Z", "message": "Update GlobalEntityTypeAttributes.java.patch"}, "afterCommit": {"oid": "116284a77ea5f38064e05264f8629e3271726ca9", "author": {"user": {"login": "itsmeow", "name": "itsmeow"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/116284a77ea5f38064e05264f8629e3271726ca9", "committedDate": "2020-06-26T12:41:13Z", "message": "Split get patch into two lines"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80d4c8b21c7433ecdabd594a98f0f84a9d8d5fbe", "author": {"user": {"login": "itsmeow", "name": "itsmeow"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/80d4c8b21c7433ecdabd594a98f0f84a9d8d5fbe", "committedDate": "2020-06-26T12:49:15Z", "message": "Favor Forge's map over vanilla"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MjcxNzIz", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6822#pullrequestreview-438271723", "createdAt": "2020-06-26T12:56:55Z", "commit": {"oid": "80d4c8b21c7433ecdabd594a98f0f84a9d8d5fbe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1968, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}