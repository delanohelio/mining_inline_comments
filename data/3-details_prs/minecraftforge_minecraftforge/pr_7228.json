{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MDA4NDk0", "number": 7228, "title": "Improve performance and cleanup code for DelegatingResourcePack", "bodyText": "DelegatingResourcePack will now only query relevant packs for resources, based on getResourceNamespaces.\nRemoved a lot of the synchronization in DelegatingResourcePack, addDelegate is deprecated.\nDelegatableResourcePack is deprecated and basically unused now. To be removed in 1.17.\n\nFixes #7227.", "createdAt": "2020-08-08T09:14:18Z", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228", "merged": true, "mergeCommit": {"oid": "50197b1fa5a171b63201adc0b7ecbb8b71715122"}, "closed": true, "closedAt": "2020-08-21T17:48:50Z", "author": {"login": "diesieben07"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc81JFpAH2gAyNDY1MDA4NDk0OjdmZjhjMmZhMzdkYmRhZjY2YzYxZDIxYmZlNWI2NDIwODljNWNkYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBIcB8gH2gAyNDY1MDA4NDk0OmU5YTRjZGUwZWRhYjU5NmNlMjc0YTI4MTRmYTZiMWRlMGFkZDJjMjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ff8c2fa37dbdaf66c61d21bfe5b642089c5cda2", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7ff8c2fa37dbdaf66c61d21bfe5b642089c5cda2", "committedDate": "2020-08-08T08:56:26Z", "message": "Improve performance of DelegatingResourcePack and general cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0683c7c3bfa618bd47674ea476a11bd17cae528", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/c0683c7c3bfa618bd47674ea476a11bd17cae528", "committedDate": "2020-08-08T08:56:46Z", "message": "Merge remote-tracking branch 'upstream/1.16.x' into delegating-resourcepack-cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40a15265e14522527535ba1b874c094e99f02726", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/40a15265e14522527535ba1b874c094e99f02726", "committedDate": "2020-08-08T08:57:23Z", "message": "Remove pointless comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "291d31587214d7b3234581ed12eb2685f01f2aae", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/291d31587214d7b3234581ed12eb2685f01f2aae", "committedDate": "2020-08-08T09:15:52Z", "message": "Add note about volatile removal in 1.17"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODA4NTI2", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228#pullrequestreview-463808526", "createdAt": "2020-08-08T15:08:40Z", "commit": {"oid": "291d31587214d7b3234581ed12eb2685f01f2aae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNTowODo0MFrOG90VFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNTowODo0MFrOG90VFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ3MzY4Ng==", "bodyText": "Could this be changed to use namespaceAssets.keySet()/namespaceData.keyset()? IIRC ModFileResourcePack#getResourceNamespaces does file system operations, so it's relatively slow.", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/7228#discussion_r467473686", "createdAt": "2020-08-08T15:08:40Z", "author": {"login": "malte0811"}, "path": "src/main/java/net/minecraftforge/fml/packs/DelegatingResourcePack.java", "diffHunk": "@@ -84,69 +111,86 @@ public String getName()\n     @Override\n     public Collection<ResourceLocation> getAllResourceLocations(ResourcePackType type, String pathIn, String pathIn2, int maxDepth, Predicate<String> filter)\n     {\n-        synchronized(delegates)\n-        {\n-            return delegates.stream()\n-                    .flatMap(r -> r.getAllResourceLocations(type, pathIn, pathIn2, maxDepth, filter).stream())\n-                    .collect(Collectors.toList());\n-        }\n+        return delegates.stream()\n+                .flatMap(r -> r.getAllResourceLocations(type, pathIn, pathIn2, maxDepth, filter).stream())\n+                .collect(Collectors.toList());\n     }\n \n     @Override\n     public Set<String> getResourceNamespaces(ResourcePackType type)\n     {\n-        synchronized (delegates)\n-        {\n-            return delegates.stream()\n-                    .flatMap(r -> r.getResourceNamespaces(type).stream())\n-                    .collect(Collectors.toSet());\n-        }\n+        return delegates.stream()\n+                .flatMap(r -> r.getResourceNamespaces(type).stream())\n+                .collect(Collectors.toSet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "291d31587214d7b3234581ed12eb2685f01f2aae"}, "originalPosition": 112}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b777418f013366e94de7cee2c299dd03657b648", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2b777418f013366e94de7cee2c299dd03657b648", "committedDate": "2020-08-08T15:43:15Z", "message": "Remove unnecessary stream in getResourceNamespaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d6f95d8b03b59e8356eef3ef0bd57da1a6aa01d", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7d6f95d8b03b59e8356eef3ef0bd57da1a6aa01d", "committedDate": "2020-08-08T16:13:50Z", "message": "update deprecation notes to 1.16.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2423574d9bb35c7ce72a4cf1c127ec151e5f5e80", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2423574d9bb35c7ce72a4cf1c127ec151e5f5e80", "committedDate": "2020-08-16T10:09:35Z", "message": "Merge branch '1.16.x' into delegating-resourcepack-cleanup\n\n# Conflicts:\n#\tsrc/main/java/net/minecraftforge/fml/client/ClientModLoader.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcff52bf694f7470bbad2a94255cd2ebd1ec0315", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/bcff52bf694f7470bbad2a94255cd2ebd1ec0315", "committedDate": "2020-08-16T10:14:35Z", "message": "Update to 1.16.2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c92f62ede83722478758418f62a48425ff1e668b", "author": {"user": {"login": "diesieben07", "name": "Take Weiland"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/c92f62ede83722478758418f62a48425ff1e668b", "committedDate": "2020-08-16T10:15:33Z", "message": "Remove deprecated DelegatingResourcePack constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7842f4322777c153cde1ed0a5230edfb68fcb7a9", "author": {"user": {"login": "LexManos", "name": "LexManos"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/7842f4322777c153cde1ed0a5230edfb68fcb7a9", "committedDate": "2020-08-21T17:34:58Z", "message": "Merge branch '1.16.x' into delegating-resourcepack-cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9a4cde0edab596ce274a2814fa6b1de0add2c22", "author": {"user": {"login": "LexManos", "name": "LexManos"}}, "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e9a4cde0edab596ce274a2814fa6b1de0add2c22", "committedDate": "2020-08-21T17:41:01Z", "message": "Update ModFileResourcePack.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2426, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}