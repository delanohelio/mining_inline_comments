{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NjI4MTA1", "number": 5892, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoxMDowMlrOEZk39w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNzo0MTo1MFrOEbDWjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjU0MDA3OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/PreparedStatement.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoxMDowMlrOHCeGOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMjozMDoyNVrOHDdZkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1MjMxMw==", "bodyText": "@kishoreg @npawar I'm not super convinced with this name but can't think of a better name than this. Feel free to suggest something else.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472352313", "createdAt": "2020-08-18T17:10:02Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/PreparedStatement.java", "diffHunk": "@@ -72,6 +72,15 @@ public ResultSetGroup execute() {\n     return _connection.execute(new Request(_queryFormat, fillStatementWithParameters()));\n   }\n \n+  /**\n+   * Executes this prepared statement and returns the BrokerResponse.\n+   *\n+   * @return The BrokerResponse received.\n+   */\n+  public BrokerResponse executeRequest() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTM3NQ==", "bodyText": "This isn't a rename. It's a new method addition.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472445375", "createdAt": "2020-08-18T19:58:36Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/PreparedStatement.java", "diffHunk": "@@ -72,6 +72,15 @@ public ResultSetGroup execute() {\n     return _connection.execute(new Request(_queryFormat, fillStatementWithParameters()));\n   }\n \n+  /**\n+   * Executes this prepared statement and returns the BrokerResponse.\n+   *\n+   * @return The BrokerResponse received.\n+   */\n+  public BrokerResponse executeRequest() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1MjMxMw=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM4OTQ1OA==", "bodyText": "This isn't applicable anymore as per the latest change.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r473389458", "createdAt": "2020-08-19T22:30:25Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/PreparedStatement.java", "diffHunk": "@@ -72,6 +72,15 @@ public ResultSetGroup execute() {\n     return _connection.execute(new Request(_queryFormat, fillStatementWithParameters()));\n   }\n \n+  /**\n+   * Executes this prepared statement and returns the BrokerResponse.\n+   *\n+   * @return The BrokerResponse received.\n+   */\n+  public BrokerResponse executeRequest() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1MjMxMw=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MzAwNDA2OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "isResolved": false, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOToyMjoyM1rOHCipZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNjoxODoyMlrOHDsmrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg==", "bodyText": "Don't rename the methods as it would not be backward compatible and will break other connectors such as JDBC.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472426852", "createdAt": "2020-08-18T19:22:23Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTMyNQ==", "bodyText": "This isn't a rename. It's a new method addition.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472445325", "createdAt": "2020-08-18T19:58:29Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ3MDg3NQ==", "bodyText": "My bad. @kishoreg should we have two methods both executing query - one returning the complete response while other returning the response table. IMO, we should have only one but if we remove the old one the JDBC connector will break.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472470875", "createdAt": "2020-08-18T20:28:20Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjUwODQ2Mw==", "bodyText": "why not add the response stats as part of the existing return type. It maintains backwards compatibility and simply adds an additional method in ResultSetGroup", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472508463", "createdAt": "2020-08-18T21:39:19Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU1ODk5MQ==", "bodyText": "I don't think the stats belong to ResultSetGroup, hence I didn't go that route. Yes, it's simple and easy method but isn't intuitive API, at least to me.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472558991", "createdAt": "2020-08-19T00:02:55Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjY1NjIwMw==", "bodyText": "Not really. There is scope for metadata and stats. https://cloud.google.com/spanner/docs/reference/rest/v1/ResultSet", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472656203", "createdAt": "2020-08-19T03:54:14Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE2MTI1Mw==", "bodyText": "Yes. JDBC also follows a similar theme where you can return a ResultSetMetadata along with the actual result.\nBrokerResponse can change in the future but the query interface should be consistent.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r473161253", "createdAt": "2020-08-19T16:28:27Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzYzODU3Mw==", "bodyText": "Fixed this now by exposing stats in the ResultSetGroup itself. Please check.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r473638573", "createdAt": "2020-08-20T06:18:22Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java", "diffHunk": "@@ -96,6 +96,18 @@ public ResultSetGroup execute(Request request)\n     return execute(null, request);\n   }\n \n+  /**\n+   * Executes a Pinot Request and returns the Response.\n+   *\n+   * @param request The request to execute\n+   * @return The BrokerResponse for the request.\n+   * @throws PinotClientException If an exception occurs while processing the query\n+   */\n+  public BrokerResponse executeRequest(Request request)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNjg1Mg=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MzAwODkwOnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOToyMzo1NVrOHCismw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMToxODoyNlrOHCnC1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNzY3NQ==", "bodyText": "This class should be moved to a separate file.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472427675", "createdAt": "2020-08-18T19:23:55Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -38,6 +39,126 @@ private BrokerResponse(JsonNode brokerResponse) {\n     _exceptions = brokerResponse.get(\"exceptions\");\n     _selectionResults = brokerResponse.get(\"selectionResults\");\n     _resultTable = brokerResponse.get(\"resultTable\");\n+    _responseStats = ResponseStats.fromJson(brokerResponse);\n+  }\n+\n+  public static class ResponseStats {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ5ODkwMw==", "bodyText": "Done.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472498903", "createdAt": "2020-08-18T21:18:26Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -38,6 +39,126 @@ private BrokerResponse(JsonNode brokerResponse) {\n     _exceptions = brokerResponse.get(\"exceptions\");\n     _selectionResults = brokerResponse.get(\"selectionResults\");\n     _resultTable = brokerResponse.get(\"resultTable\");\n+    _responseStats = ResponseStats.fromJson(brokerResponse);\n+  }\n+\n+  public static class ResponseStats {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyNzY3NQ=="}, "originalCommit": {"oid": "c807a77ae019940fc6ac22a47250882a08a49230"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MzExOTI2OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTo1Nzo1OVrOHCjwkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMjozNDozNVrOHDdlnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTA3NQ==", "bodyText": "@KKcorps @npawar I would call this as a major change in the public API for java client. BrokerResponse was package protected but now this PR makes the class public. Do you know why the BrokerResponse was not public?\nMy understanding is the client was exposing the results, much like the relational databases so that the client application doesn't need to understand the internals of Pinot response but this requirement kind of beats that. The intention here is \"I understand response stats and let me access them\".\nThoughts, please?", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472445075", "createdAt": "2020-08-18T19:57:59Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -24,11 +24,12 @@\n /**\n  * Reimplementation of BrokerResponse from pinot-common, so that pinot-api does not depend on pinot-common.\n  */\n-class BrokerResponse {\n+public class BrokerResponse {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb9304acdd026bf7b5582691eb06560a364f3fdb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ3NTE5NA==", "bodyText": "I think thee intention was to expose a standard ResultSet Interface from which the user can easily read the data.\nBroker Response can have different fields depending upon whether SQL or PQL endpoint was queried.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472475194", "createdAt": "2020-08-18T20:32:53Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -24,11 +24,12 @@\n /**\n  * Reimplementation of BrokerResponse from pinot-common, so that pinot-api does not depend on pinot-common.\n  */\n-class BrokerResponse {\n+public class BrokerResponse {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTA3NQ=="}, "originalCommit": {"oid": "bb9304acdd026bf7b5582691eb06560a364f3fdb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjUwNTYyNg==", "bodyText": "IMO, ResultSet makes sense for JDBC client but for the Java client, the entire BrokerResponse makes more sense.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r472505626", "createdAt": "2020-08-18T21:32:51Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -24,11 +24,12 @@\n /**\n  * Reimplementation of BrokerResponse from pinot-common, so that pinot-api does not depend on pinot-common.\n  */\n-class BrokerResponse {\n+public class BrokerResponse {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTA3NQ=="}, "originalCommit": {"oid": "bb9304acdd026bf7b5582691eb06560a364f3fdb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM5MjU0Mw==", "bodyText": "Fixed this now by exposing stats in the ResultSetGroup itself. Please check.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r473392543", "createdAt": "2020-08-19T22:34:35Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerResponse.java", "diffHunk": "@@ -24,11 +24,12 @@\n /**\n  * Reimplementation of BrokerResponse from pinot-common, so that pinot-api does not depend on pinot-common.\n  */\n-class BrokerResponse {\n+public class BrokerResponse {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ0NTA3NQ=="}, "originalCommit": {"oid": "bb9304acdd026bf7b5582691eb06560a364f3fdb"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2Mzc2ODM3OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODowMTowN1rOHENOFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwODoxNDoxMFrOHEhn4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3Mjk1MA==", "bodyText": "This should be a List as well since ResultSet is a list", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474172950", "createdAt": "2020-08-20T18:01:07Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI5MjU3OQ==", "bodyText": "A single query only has one set of stats. AFAIK, ResultSet is a list because Pinot sends a separate set of results for each group when there is groupBy but that doesn't mean there will be multiple response stats.\n@fx19880617 correct me if my understanding isn't correct.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474292579", "createdAt": "2020-08-20T21:50:55Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3Mjk1MA=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MDQ3NA==", "bodyText": "@buchireddy that's right. we don't need it to be part of each resultset", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474450474", "createdAt": "2020-08-21T07:05:28Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3Mjk1MA=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUwNzIzMw==", "bodyText": "cool.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474507233", "createdAt": "2020-08-21T08:14:10Z", "author": {"login": "KKcorps"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3Mjk1MA=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NTU3NjQ5OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzowNjoyMlrOHEeMjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwODoxMzo0NVrOHEhmgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MTA4NA==", "bodyText": "rename to executionStats", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474451084", "createdAt": "2020-08-21T07:06:22Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUwNjg4Mg==", "bodyText": "Done", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474506882", "createdAt": "2020-08-21T08:13:45Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetGroup.java", "diffHunk": "@@ -28,6 +28,7 @@\n  */\n public class ResultSetGroup {\n   private final List<ResultSet> _resultSets;\n+  private final ResultSetStats _resultSetStats;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1MTA4NA=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NTYwNjQ5OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzoxMjoyOFrOHEefDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNjozNjo0NFrOHEz4ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1NTgyMQ==", "bodyText": "can we create constants for strings?", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474455821", "createdAt": "2020-08-21T07:12:28Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "diffHunk": "@@ -0,0 +1,144 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.client;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+\n+/**\n+ * Simple POJO to hold query execution statistics for a request. These stats come in every\n+ * query that's executed and can be used for debugging Pinot slow queries.\n+ */\n+class ResultSetStats {\n+  private final int _numServersQueried;\n+  private final int _numServersResponded;\n+  private final long _numDocsScanned;\n+  private final long _numEntriesScannedInFilter;\n+  private final long _numEntriesScannedPostFilter;\n+  private final long _numSegmentsQueried;\n+  private final long _numSegmentsProcessed;\n+  private final long _numSegmentsMatched;\n+  private final long _numConsumingSegmentsQueried;\n+  private final long _minConsumingFreshnessTimeMs;\n+  private final long _totalDocs;\n+  private final boolean _numGroupsLimitReached;\n+  private final long _timeUsedMs;\n+\n+  ResultSetStats(JsonNode brokerResponse) {\n+    _numServersQueried = brokerResponse.has(\"numServersQueried\") ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgwNjQzNQ==", "bodyText": "Done.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474806435", "createdAt": "2020-08-21T16:36:44Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "diffHunk": "@@ -0,0 +1,144 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.client;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+\n+/**\n+ * Simple POJO to hold query execution statistics for a request. These stats come in every\n+ * query that's executed and can be used for debugging Pinot slow queries.\n+ */\n+class ResultSetStats {\n+  private final int _numServersQueried;\n+  private final int _numServersResponded;\n+  private final long _numDocsScanned;\n+  private final long _numEntriesScannedInFilter;\n+  private final long _numEntriesScannedPostFilter;\n+  private final long _numSegmentsQueried;\n+  private final long _numSegmentsProcessed;\n+  private final long _numSegmentsMatched;\n+  private final long _numConsumingSegmentsQueried;\n+  private final long _minConsumingFreshnessTimeMs;\n+  private final long _totalDocs;\n+  private final boolean _numGroupsLimitReached;\n+  private final long _timeUsedMs;\n+\n+  ResultSetStats(JsonNode brokerResponse) {\n+    _numServersQueried = brokerResponse.has(\"numServersQueried\") ?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1NTgyMQ=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NTYyMTE3OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzoxNToxOFrOHEen5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwODoxMzozNlrOHEhl7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1ODA4Ng==", "bodyText": "can we simply maintain a reference to jsonNode and look it up in the respective methods. This will add perf overhead for high throughput use cases where the client code is not interested in all the stats", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474458086", "createdAt": "2020-08-21T07:15:18Z", "author": {"login": "kishoreg"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "diffHunk": "@@ -0,0 +1,144 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.client;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+\n+/**\n+ * Simple POJO to hold query execution statistics for a request. These stats come in every\n+ * query that's executed and can be used for debugging Pinot slow queries.\n+ */\n+class ResultSetStats {\n+  private final int _numServersQueried;\n+  private final int _numServersResponded;\n+  private final long _numDocsScanned;\n+  private final long _numEntriesScannedInFilter;\n+  private final long _numEntriesScannedPostFilter;\n+  private final long _numSegmentsQueried;\n+  private final long _numSegmentsProcessed;\n+  private final long _numSegmentsMatched;\n+  private final long _numConsumingSegmentsQueried;\n+  private final long _minConsumingFreshnessTimeMs;\n+  private final long _totalDocs;\n+  private final boolean _numGroupsLimitReached;\n+  private final long _timeUsedMs;\n+\n+  ResultSetStats(JsonNode brokerResponse) {\n+    _numServersQueried = brokerResponse.has(\"numServersQueried\") ?\n+        brokerResponse.get(\"numServersQueried\").asInt() : -1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUwNjczNQ==", "bodyText": "Done", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474506735", "createdAt": "2020-08-21T08:13:36Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSetStats.java", "diffHunk": "@@ -0,0 +1,144 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.client;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+\n+/**\n+ * Simple POJO to hold query execution statistics for a request. These stats come in every\n+ * query that's executed and can be used for debugging Pinot slow queries.\n+ */\n+class ResultSetStats {\n+  private final int _numServersQueried;\n+  private final int _numServersResponded;\n+  private final long _numDocsScanned;\n+  private final long _numEntriesScannedInFilter;\n+  private final long _numEntriesScannedPostFilter;\n+  private final long _numSegmentsQueried;\n+  private final long _numSegmentsProcessed;\n+  private final long _numSegmentsMatched;\n+  private final long _numConsumingSegmentsQueried;\n+  private final long _minConsumingFreshnessTimeMs;\n+  private final long _totalDocs;\n+  private final boolean _numGroupsLimitReached;\n+  private final long _timeUsedMs;\n+\n+  ResultSetStats(JsonNode brokerResponse) {\n+    _numServersQueried = brokerResponse.has(\"numServersQueried\") ?\n+        brokerResponse.get(\"numServersQueried\").asInt() : -1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ1ODA4Ng=="}, "originalCommit": {"oid": "40aea9410a36afe01ed5bd61f582074ad41c452a"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2ODAxOTM0OnYy", "diffSide": "RIGHT", "path": "pinot-clients/pinot-java-client/src/test/java/org/apache/pinot/client/ResultSetGroupTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNzo0MTo1MFrOHE1z2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQyMDo1MjowN1rOHE9SMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgzNzk3OA==", "bodyText": "How are we getting this fixed time of 82 for the test?", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474837978", "createdAt": "2020-08-21T17:41:50Z", "author": {"login": "npawar"}, "path": "pinot-clients/pinot-java-client/src/test/java/org/apache/pinot/client/ResultSetGroupTest.java", "diffHunk": "@@ -55,11 +55,15 @@ public void testDeserializeSelectionResultSet() {\n     Assert.assertEquals(resultSet.getColumnCount(), 79);\n     Assert.assertEquals(resultSet.getColumnName(0), \"ActualElapsedTime\");\n     Assert.assertEquals(resultSet.getColumnName(1), \"AirTime\");\n+\n+    // Verify the execution stats.\n+    Assert.assertEquals(115545, resultSetGroup.getExecutionStats().getTotalDocs());\n+    Assert.assertEquals(82, resultSetGroup.getExecutionStats().getTimeUsedMs());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6589c8a69f8ba34c61befbfae126bd7c36a21705"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk2MDQzMw==", "bodyText": "This is just testing the checked-in json file selection.json. Look at L41.", "url": "https://github.com/apache/pinot/pull/5892#discussion_r474960433", "createdAt": "2020-08-21T20:52:07Z", "author": {"login": "buchireddy"}, "path": "pinot-clients/pinot-java-client/src/test/java/org/apache/pinot/client/ResultSetGroupTest.java", "diffHunk": "@@ -55,11 +55,15 @@ public void testDeserializeSelectionResultSet() {\n     Assert.assertEquals(resultSet.getColumnCount(), 79);\n     Assert.assertEquals(resultSet.getColumnName(0), \"ActualElapsedTime\");\n     Assert.assertEquals(resultSet.getColumnName(1), \"AirTime\");\n+\n+    // Verify the execution stats.\n+    Assert.assertEquals(115545, resultSetGroup.getExecutionStats().getTotalDocs());\n+    Assert.assertEquals(82, resultSetGroup.getExecutionStats().getTimeUsedMs());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgzNzk3OA=="}, "originalCommit": {"oid": "6589c8a69f8ba34c61befbfae126bd7c36a21705"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4025, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}