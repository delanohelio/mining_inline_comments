{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MjM4MzAy", "number": 5006, "title": "Add FieldConfig to encapsulate a column's encoding and indexing info", "bodyText": "TableConfig can take a list of FieldConfig to encapsulate storage, indexing and any other information for a field.\nMotivation:\nAs part of text search feature, we need to add a new set of columns to IndexingConfig : something like TextIndexConfig and capture the information required for text indexes: column name and some additional properties used by the implementation.\nWhile this is good and in accordance with the existing model for specifying the per column encoding and indexing info, it is not very clean and interspersed throughout the IndexingConfig.\nThis PR implements a new model to store the per column encoding and indexing info encapsulated into FieldConfig object. TableConfig can take a list of FieldConfig. A FieldConfig is self-descriptive about the encoding and indexing info for the column along with additional properties.\nPlease read this document (also shared in the open source community) to know more details, migration plan from existing model to new model etc.\nhttps://docs.google.com/document/d/1PyULfbLOYa5OexZMqbP_MZgg-338flKETJOKWS5en3g/edit", "createdAt": "2020-01-23T08:22:04Z", "url": "https://github.com/apache/pinot/pull/5006", "merged": true, "mergeCommit": {"oid": "783cb3825d423862ac514d96ba342d93d3f5437b"}, "closed": true, "closedAt": "2020-02-06T23:54:13Z", "author": {"login": "siddharthteotia"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9GGAZAFqTM0NzEyMzY0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcByx9rABqjMwMTU3NjgwMjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MTIzNjQ5", "url": "https://github.com/apache/pinot/pull/5006#pullrequestreview-347123649", "createdAt": "2020-01-23T08:29:11Z", "commit": {"oid": "1fe6f9baec4c22093ccc14315a1ea9e2ab91c932"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwODoyOToxMVrOFg1_Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QwODoyOToxMVrOFg1_Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MzI3MA==", "bodyText": "what is @ Null, is it suppose to be @ Nullable?", "url": "https://github.com/apache/pinot/pull/5006#discussion_r369983270", "createdAt": "2020-01-23T08:29:11Z", "author": {"login": "kishoreg"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -82,7 +88,8 @@ public TableConfig() {\n   private TableConfig(String tableName, TableType tableType, SegmentsValidationAndRetentionConfig validationConfig,\n       TenantConfig tenantConfig, IndexingConfig indexingConfig, TableCustomConfig customConfig,\n       @Nullable QuotaConfig quotaConfig, @Nullable TableTaskConfig taskConfig, @Nullable RoutingConfig routingConfig,\n-      @Nullable Map<InstancePartitionsType, InstanceAssignmentConfig> instanceAssignmentConfigMap) {\n+      @Nullable Map<InstancePartitionsType, InstanceAssignmentConfig> instanceAssignmentConfigMap,\n+      @Null List<FieldConfig> fieldConfigList) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fe6f9baec4c22093ccc14315a1ea9e2ab91c932"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDgxODA5", "url": "https://github.com/apache/pinot/pull/5006#pullrequestreview-347481809", "createdAt": "2020-01-23T17:34:38Z", "commit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTA3NDI0", "url": "https://github.com/apache/pinot/pull/5006#pullrequestreview-347507424", "createdAt": "2020-01-23T18:17:06Z", "commit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxNzowN1rOFhH9XA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxOTo1NzozN1rOFhK1Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NzcyNA==", "bodyText": "Should we use dictionary encoding by default?", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370277724", "createdAt": "2020-01-23T18:17:07Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;\n+\n+  @JsonCreator\n+  FieldConfig (@JsonProperty(value = \"name\", required = true) String name,\n+      @JsonProperty(value = \"encodingType\") @Nullable EncodingType encodingType,\n+      @JsonProperty(value = \"indexType\") @Nullable IndexType indexType,\n+      @JsonProperty(value = \"properties\") @Nullable Properties properties) {\n+    _name = name;\n+    _encodingType = encodingType;\n+    _indexType = indexType;\n+    _properties = properties;\n+  }\n+\n+  // If null, we will create raw forward index", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTI4MA==", "bodyText": "Make them final?", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370279280", "createdAt": "2020-01-23T18:20:07Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTk2MA==", "bodyText": "public?\nAlso need to reformat", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370279960", "createdAt": "2020-01-23T18:21:34Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;\n+\n+  @JsonCreator\n+  FieldConfig (@JsonProperty(value = \"name\", required = true) String name,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDc0Mg==", "bodyText": "Equivalent to childConfigNode.isContainerNode()", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370324742", "createdAt": "2020-01-23T19:57:28Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -157,7 +168,7 @@ public static TableConfig fromJsonConfig(JsonNode jsonConfig)\n     if (childConfigNode == null || childConfigNode.isNull()) {\n       return null;\n     }\n-    if (childConfigNode.isObject()) {\n+    if (childConfigNode.isObject() || childConfigNode instanceof ArrayNode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDgwMg==", "bodyText": "Same here", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370324802", "createdAt": "2020-01-23T19:57:37Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -177,7 +188,7 @@ public static TableConfig fromJsonConfig(JsonNode jsonConfig)\n     if (childConfigNode == null || childConfigNode.isNull()) {\n       return null;\n     }\n-    if (childConfigNode.isObject()) {\n+    if (childConfigNode.isObject() || childConfigNode instanceof ArrayNode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTk5MDUw", "url": "https://github.com/apache/pinot/pull/5006#pullrequestreview-347599050", "createdAt": "2020-01-23T20:52:46Z", "commit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMDo1Mjo0N1rOFhMQnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMDo1Mjo0N1rOFhMQnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0ODE5MQ==", "bodyText": "I don't think we need the functionalities provided by Properties class, maybe Map<String, String> is enough?", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370348191", "createdAt": "2020-01-23T20:52:47Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c061a9ec888584ab2bcb5a45d11340603791ce38", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/c061a9ec888584ab2bcb5a45d11340603791ce38", "committedDate": "2020-02-06T01:11:20Z", "message": "Add FieldConfig. TableConfig can take a list of FieldConfig\nto encapsulate storage, indexing and any other information for a field."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "committedDate": "2020-01-23T09:02:34Z", "message": "Add more tests"}, "afterCommit": {"oid": "c061a9ec888584ab2bcb5a45d11340603791ce38", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/c061a9ec888584ab2bcb5a45d11340603791ce38", "committedDate": "2020-02-06T01:11:20Z", "message": "Add FieldConfig. TableConfig can take a list of FieldConfig\nto encapsulate storage, indexing and any other information for a field."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1518, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}