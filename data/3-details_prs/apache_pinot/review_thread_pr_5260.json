{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MTQ3MjAx", "number": 5260, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODoyMTo0NFrODyn0Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTo0ODozNFrODzDg6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDA3Nzc4OnYy", "diffSide": "RIGHT", "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODoyMTo0NFrOGGxw7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODoyMTo0NFrOGGxw7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTc1OTk4Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                LOGGER.info(\"Use class: {} as the AccessControlFactory\", accessControlFactoryClass);\n          \n          \n            \n                LOGGER.info(\"Using class: {} as the AccessControlFactory\", accessControlFactoryClass);", "url": "https://github.com/apache/pinot/pull/5260#discussion_r409759983", "createdAt": "2020-04-16T18:21:44Z", "author": {"login": "mcvsubbu"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -153,8 +154,18 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     updateInstanceConfigIfNeeded(host, port);\n \n     // Start restlet server for admin API endpoint\n+    String accessControlFactoryClass =\n+        _serverConf.getString(ACCESS_CONTROL_FACTORY_CLASS, DEFAULT_ACCESS_CONTROL_FACTORY_CLASS);\n+    LOGGER.info(\"Use class: {} as the AccessControlFactory\", accessControlFactoryClass);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d7aa45909cf4f588c288590d0f390800dd0f854"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDExMzI1OnYy", "diffSide": "RIGHT", "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODozMTo1NVrOGGyHxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODozMTo1NVrOGGyHxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTc2NTgzMA==", "bodyText": "Please use PluginManager.createInstance()", "url": "https://github.com/apache/pinot/pull/5260#discussion_r409765830", "createdAt": "2020-04-16T18:31:55Z", "author": {"login": "mcvsubbu"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -153,8 +154,18 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     updateInstanceConfigIfNeeded(host, port);\n \n     // Start restlet server for admin API endpoint\n+    String accessControlFactoryClass =\n+        _serverConf.getString(ACCESS_CONTROL_FACTORY_CLASS, DEFAULT_ACCESS_CONTROL_FACTORY_CLASS);\n+    LOGGER.info(\"Use class: {} as the AccessControlFactory\", accessControlFactoryClass);\n+    final AccessControlFactory accessControlFactory;\n+    try {\n+      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d7aa45909cf4f588c288590d0f390800dd0f854"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NDExNDg0OnYy", "diffSide": "RIGHT", "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxODozMjoyMFrOGGyIvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTozODo0OVrOGHd3Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTc2NjA3OA==", "bodyText": "Include class name in the exception string", "url": "https://github.com/apache/pinot/pull/5260#discussion_r409766078", "createdAt": "2020-04-16T18:32:20Z", "author": {"login": "mcvsubbu"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -153,8 +154,18 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     updateInstanceConfigIfNeeded(host, port);\n \n     // Start restlet server for admin API endpoint\n+    String accessControlFactoryClass =\n+        _serverConf.getString(ACCESS_CONTROL_FACTORY_CLASS, DEFAULT_ACCESS_CONTROL_FACTORY_CLASS);\n+    LOGGER.info(\"Use class: {} as the AccessControlFactory\", accessControlFactoryClass);\n+    final AccessControlFactory accessControlFactory;\n+    try {\n+      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();\n+    } catch (Exception e) {\n+      throw new RuntimeException(\"Caught exception while creating new AccessControlFactory instance\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d7aa45909cf4f588c288590d0f390800dd0f854"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4MjQ0Mg==", "bodyText": "done.", "url": "https://github.com/apache/pinot/pull/5260#discussion_r410482442", "createdAt": "2020-04-17T21:38:49Z", "author": {"login": "chenboat"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -153,8 +154,18 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     updateInstanceConfigIfNeeded(host, port);\n \n     // Start restlet server for admin API endpoint\n+    String accessControlFactoryClass =\n+        _serverConf.getString(ACCESS_CONTROL_FACTORY_CLASS, DEFAULT_ACCESS_CONTROL_FACTORY_CLASS);\n+    LOGGER.info(\"Use class: {} as the AccessControlFactory\", accessControlFactoryClass);\n+    final AccessControlFactory accessControlFactory;\n+    try {\n+      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();\n+    } catch (Exception e) {\n+      throw new RuntimeException(\"Caught exception while creating new AccessControlFactory instance\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTc2NjA3OA=="}, "originalCommit": {"oid": "5d7aa45909cf4f588c288590d0f390800dd0f854"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0ODYxNTQ1OnYy", "diffSide": "RIGHT", "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTo0ODozNFrOGHeFZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjoyMzoxNFrOGHeyuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4NjExOA==", "bodyText": "The class name you want to add to the exception is not this.getClass(). Instead, it should be the value of accessControlFactory. The idea is that the exception message should reflect the remedial action as close as possible (e.g. in this case, it could be a config typo). It may even be useful to put it in quotes, so as to spot extra spaces (e.g. \"... in class ' + accessControlFactoryClass + \"'\", e))", "url": "https://github.com/apache/pinot/pull/5260#discussion_r410486118", "createdAt": "2020-04-17T21:48:34Z", "author": {"login": "mcvsubbu"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -159,9 +160,11 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     LOGGER.info(\"Using class: {} as the AccessControlFactory\", accessControlFactoryClass);\n     final AccessControlFactory accessControlFactory;\n     try {\n-      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();\n+      accessControlFactory = PluginManager.get().createInstance(accessControlFactoryClass);\n     } catch (Exception e) {\n-      throw new RuntimeException(\"Caught exception while creating new AccessControlFactory instance\", e);\n+      throw new RuntimeException(\n+          \"Caught exception while creating new AccessControlFactory instance in class \" + this.getClass()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdc45f7e41cf3cbba6d1f79159e2b2f913cc8d6d"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ5NzcyMA==", "bodyText": "Got it. good point.", "url": "https://github.com/apache/pinot/pull/5260#discussion_r410497720", "createdAt": "2020-04-17T22:23:14Z", "author": {"login": "chenboat"}, "path": "pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixServerStarter.java", "diffHunk": "@@ -159,9 +160,11 @@ public HelixServerStarter(String helixClusterName, String zkAddress, Configurati\n     LOGGER.info(\"Using class: {} as the AccessControlFactory\", accessControlFactoryClass);\n     final AccessControlFactory accessControlFactory;\n     try {\n-      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();\n+      accessControlFactory = PluginManager.get().createInstance(accessControlFactoryClass);\n     } catch (Exception e) {\n-      throw new RuntimeException(\"Caught exception while creating new AccessControlFactory instance\", e);\n+      throw new RuntimeException(\n+          \"Caught exception while creating new AccessControlFactory instance in class \" + this.getClass()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4NjExOA=="}, "originalCommit": {"oid": "fdc45f7e41cf3cbba6d1f79159e2b2f913cc8d6d"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3415, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}