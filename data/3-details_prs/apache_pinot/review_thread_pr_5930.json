{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MTA1OTYy", "number": 5930, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjoyODoxOVrOEcxRPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozMDoxMlrOEcxTKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjAyODEyOnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/detection/detection-config-schema.json", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjoyODoxOVrOHHf3lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozNjozM1rOHHgD4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNDIxNA==", "bodyText": "shall the rule type be an enum?", "url": "https://github.com/apache/pinot/pull/5930#discussion_r477624214", "createdAt": "2020-08-26T22:28:19Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/detection/detection-config-schema.json", "diffHunk": "@@ -0,0 +1,214 @@\n+{\n+  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n+  \"title\": \"Detection Config Schema\",\n+\n+  \"type\": \"object\",\n+  \"description\": \"YAML representation of metric or composite detection config\",\n+\n+  \"required\": [ \"detectionName\" ],\n+\n+  \"properties\": {\n+    \"detectionName\": {\n+      \"type\": \"string\"\n+    },\n+    \"description\": {\n+      \"type\": \"string\"\n+    },\n+    \"type\": {\n+      \"type\": \"string\",\n+      \"description\": \"detection pipeline type\",\n+      \"enum\": [\n+        \"METRIC_ALERT\",\n+        \"COMPOSITE_ALERT\"\n+      ]\n+    },\n+    \"metric\": {\n+      \"type\": \"string\"\n+    },\n+    \"dataset\": {\n+      \"type\": \"string\"\n+    },\n+    \"active\": {\n+      \"type\": \"boolean\"\n+    },\n+    \"cron\": {\n+      \"type\": \"string\"\n+    },\n+    \"filters\": {\n+      \"$ref\": \"#/definitions/filters\"\n+    },\n+    \"dimensionExploration\": {\n+      \"$ref\": \"#/definitions/dimensionExploration\"\n+    },\n+    \"rules\": {\n+      \"$ref\": \"#/definitions/rules\"\n+    },\n+    \"alerts\": {\n+      \"$ref\": \"#/definitions/alerts\"\n+    },\n+    \"merger\": {\n+      \"$ref\": \"#/definitions/merger\"\n+    },\n+    \"grouper\": {\n+      \"$ref\": \"#/definitions/grouper\"\n+    }\n+  },\n+\n+  \"definitions\": {\n+    \"alerts\": {\n+      \"type\": \"array\",\n+      \"items\": {\n+        \"$ref\": \"#/definitions/subEntity\"\n+      }\n+    },\n+\n+    \"subEntity\": {\n+      \"type\": \"object\",\n+      \"description\": \"a sub-entity detection config\",\n+      \"required\": [ \"name\", \"type\" ],\n+      \"properties\": {\n+        \"name\": {\n+          \"type\": \"string\"\n+        },\n+        \"description\": {\n+          \"type\": \"string\"\n+        },\n+        \"type\": {\n+          \"type\": \"string\",\n+          \"description\": \"detection pipeline type\",\n+          \"enum\": [\n+            \"COMPOSITE_ALERT\",\n+            \"METRIC_ALERT\"\n+          ]\n+        },\n+        \"alerts\": {\n+          \"$ref\": \"#/definitions/alerts\"\n+        },\n+        \"metric\": {\n+          \"type\": \"string\"\n+        },\n+        \"dataset\": {\n+          \"type\": \"string\"\n+        },\n+        \"filters\": {\n+          \"$ref\": \"#/definitions/filters\"\n+        },\n+        \"dimensionExploration\": {\n+          \"$ref\": \"#/definitions/dimensionExploration\"\n+        },\n+        \"rules\": {\n+          \"$ref\": \"#/definitions/rules\"\n+        },\n+        \"merger\": {\n+          \"$ref\": \"#/definitions/merger\"\n+        },\n+        \"grouper\": {\n+          \"$ref\": \"#/definitions/grouper\"\n+        }\n+      },\n+      \"additionalProperties\": false\n+    },\n+\n+    \"dimensionExploration\": {\n+      \"type\": \"object\",\n+      \"description\": \"exploration combination of dimension values\",\n+      \"properties\": {\n+        \"dimensions\": {\n+          \"type\": \"array\",\n+          \"description\": \"dimension column names\",\n+          \"items\": {\n+            \"type\": \"string\"\n+          }\n+        },\n+        \"dimensionFilterMetric\": {\n+          \"type\": \"string\"\n+        }\n+      },\n+      \"patternProperties\": {\n+        \"k|minValue|minContribution|minValueHourly|maxValueHourly|minValueDaily|maxValueDaily\": {\n+          \"type\": \"number\"\n+        }\n+      },\n+      \"additionalProperties\": false\n+    },\n+\n+    \"filters\": {\n+      \"type\": \"object\",\n+      \"description\": \"dimension filters\",\n+      \"patternProperties\": {\n+        \".*\": {\n+          \"type\": \"array\",\n+          \"description\": \"dimension filter values\",\n+          \"items\": {\n+            \"type\": \"string\"\n+          }\n+        }\n+      }\n+    },\n+\n+    \"eachComponent\": {\n+      \"type\": \"array\",\n+      \"items\": {\n+        \"type\": \"object\",\n+        \"required\": [ \"type\", \"name\" ],\n+        \"properties\": {\n+          \"type\": {\n+            \"type\": \"string\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b38074b04c4c30083da37f6fc3e565549c5a06"}, "originalPosition": 156}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNzM2MA==", "bodyText": "We can define an enum, but I avoided it for a couple of reasons.\n\nWe do not want to hard code and maintain the list of possible rule types here.\nWe have internal algorithm types which shouldn't be hardcoded here.\nWe run a validation in the code which will anyways capture if the type is invalid.", "url": "https://github.com/apache/pinot/pull/5930#discussion_r477627360", "createdAt": "2020-08-26T22:36:33Z", "author": {"login": "akshayrai"}, "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/detection/detection-config-schema.json", "diffHunk": "@@ -0,0 +1,214 @@\n+{\n+  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n+  \"title\": \"Detection Config Schema\",\n+\n+  \"type\": \"object\",\n+  \"description\": \"YAML representation of metric or composite detection config\",\n+\n+  \"required\": [ \"detectionName\" ],\n+\n+  \"properties\": {\n+    \"detectionName\": {\n+      \"type\": \"string\"\n+    },\n+    \"description\": {\n+      \"type\": \"string\"\n+    },\n+    \"type\": {\n+      \"type\": \"string\",\n+      \"description\": \"detection pipeline type\",\n+      \"enum\": [\n+        \"METRIC_ALERT\",\n+        \"COMPOSITE_ALERT\"\n+      ]\n+    },\n+    \"metric\": {\n+      \"type\": \"string\"\n+    },\n+    \"dataset\": {\n+      \"type\": \"string\"\n+    },\n+    \"active\": {\n+      \"type\": \"boolean\"\n+    },\n+    \"cron\": {\n+      \"type\": \"string\"\n+    },\n+    \"filters\": {\n+      \"$ref\": \"#/definitions/filters\"\n+    },\n+    \"dimensionExploration\": {\n+      \"$ref\": \"#/definitions/dimensionExploration\"\n+    },\n+    \"rules\": {\n+      \"$ref\": \"#/definitions/rules\"\n+    },\n+    \"alerts\": {\n+      \"$ref\": \"#/definitions/alerts\"\n+    },\n+    \"merger\": {\n+      \"$ref\": \"#/definitions/merger\"\n+    },\n+    \"grouper\": {\n+      \"$ref\": \"#/definitions/grouper\"\n+    }\n+  },\n+\n+  \"definitions\": {\n+    \"alerts\": {\n+      \"type\": \"array\",\n+      \"items\": {\n+        \"$ref\": \"#/definitions/subEntity\"\n+      }\n+    },\n+\n+    \"subEntity\": {\n+      \"type\": \"object\",\n+      \"description\": \"a sub-entity detection config\",\n+      \"required\": [ \"name\", \"type\" ],\n+      \"properties\": {\n+        \"name\": {\n+          \"type\": \"string\"\n+        },\n+        \"description\": {\n+          \"type\": \"string\"\n+        },\n+        \"type\": {\n+          \"type\": \"string\",\n+          \"description\": \"detection pipeline type\",\n+          \"enum\": [\n+            \"COMPOSITE_ALERT\",\n+            \"METRIC_ALERT\"\n+          ]\n+        },\n+        \"alerts\": {\n+          \"$ref\": \"#/definitions/alerts\"\n+        },\n+        \"metric\": {\n+          \"type\": \"string\"\n+        },\n+        \"dataset\": {\n+          \"type\": \"string\"\n+        },\n+        \"filters\": {\n+          \"$ref\": \"#/definitions/filters\"\n+        },\n+        \"dimensionExploration\": {\n+          \"$ref\": \"#/definitions/dimensionExploration\"\n+        },\n+        \"rules\": {\n+          \"$ref\": \"#/definitions/rules\"\n+        },\n+        \"merger\": {\n+          \"$ref\": \"#/definitions/merger\"\n+        },\n+        \"grouper\": {\n+          \"$ref\": \"#/definitions/grouper\"\n+        }\n+      },\n+      \"additionalProperties\": false\n+    },\n+\n+    \"dimensionExploration\": {\n+      \"type\": \"object\",\n+      \"description\": \"exploration combination of dimension values\",\n+      \"properties\": {\n+        \"dimensions\": {\n+          \"type\": \"array\",\n+          \"description\": \"dimension column names\",\n+          \"items\": {\n+            \"type\": \"string\"\n+          }\n+        },\n+        \"dimensionFilterMetric\": {\n+          \"type\": \"string\"\n+        }\n+      },\n+      \"patternProperties\": {\n+        \"k|minValue|minContribution|minValueHourly|maxValueHourly|minValueDaily|maxValueDaily\": {\n+          \"type\": \"number\"\n+        }\n+      },\n+      \"additionalProperties\": false\n+    },\n+\n+    \"filters\": {\n+      \"type\": \"object\",\n+      \"description\": \"dimension filters\",\n+      \"patternProperties\": {\n+        \".*\": {\n+          \"type\": \"array\",\n+          \"description\": \"dimension filter values\",\n+          \"items\": {\n+            \"type\": \"string\"\n+          }\n+        }\n+      }\n+    },\n+\n+    \"eachComponent\": {\n+      \"type\": \"array\",\n+      \"items\": {\n+        \"type\": \"object\",\n+        \"required\": [ \"type\", \"name\" ],\n+        \"properties\": {\n+          \"type\": {\n+            \"type\": \"string\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNDIxNA=="}, "originalCommit": {"oid": "05b38074b04c4c30083da37f6fc3e565549c5a06"}, "originalPosition": 156}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjAzMzA3OnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/subscription/subscription-config-schema.json", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozMDoxMlrOHHf6eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozNzoyMlrOHHgFAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNDk1Mw==", "bodyText": "shall the subscription group type be an enum type?", "url": "https://github.com/apache/pinot/pull/5930#discussion_r477624953", "createdAt": "2020-08-26T22:30:12Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/subscription/subscription-config-schema.json", "diffHunk": "@@ -0,0 +1,110 @@\n+{\n+  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n+  \"title\": \"Subscription Config Schema\",\n+\n+  \"type\": \"object\",\n+  \"description\": \"YAML representation of a subscription group config\",\n+  \"required\": [ \"subscriptionGroupName\", \"subscribedDetections\", \"application\", \"alertSchemes\" ],\n+\n+  \"properties\": {\n+    \"subscriptionGroupName\": {\n+      \"type\": \"string\"\n+    },\n+    \"application\": {\n+      \"type\": \"string\"\n+    },\n+    \"type\": {\n+      \"type\": \"string\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b38074b04c4c30083da37f6fc3e565549c5a06"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNzY0OA==", "bodyText": "replied above.", "url": "https://github.com/apache/pinot/pull/5930#discussion_r477627648", "createdAt": "2020-08-26T22:37:22Z", "author": {"login": "akshayrai"}, "path": "thirdeye/thirdeye-pinot/src/main/resources/validators/subscription/subscription-config-schema.json", "diffHunk": "@@ -0,0 +1,110 @@\n+{\n+  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n+  \"title\": \"Subscription Config Schema\",\n+\n+  \"type\": \"object\",\n+  \"description\": \"YAML representation of a subscription group config\",\n+  \"required\": [ \"subscriptionGroupName\", \"subscribedDetections\", \"application\", \"alertSchemes\" ],\n+\n+  \"properties\": {\n+    \"subscriptionGroupName\": {\n+      \"type\": \"string\"\n+    },\n+    \"application\": {\n+      \"type\": \"string\"\n+    },\n+    \"type\": {\n+      \"type\": \"string\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNDk1Mw=="}, "originalCommit": {"oid": "05b38074b04c4c30083da37f6fc3e565549c5a06"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4071, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}