{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NTE4ODE5", "number": 5189, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMDo0MFrODuN9NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMzowMVrODuN_Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5Nzg5NzQ5OnYy", "diffSide": "RIGHT", "path": "kubernetes/helm/pinot-github-events-setup.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMDo0MFrOGAGF2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODozNzoyNlrOGCQ_qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1Mjk4NQ==", "bodyText": "pull_request_merge_event", "url": "https://github.com/apache/pinot/pull/5189#discussion_r402752985", "createdAt": "2020-04-03T06:00:40Z", "author": {"login": "kishoreg"}, "path": "kubernetes/helm/pinot-github-events-setup.yml", "diffHunk": "@@ -0,0 +1,280 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+apiVersion: v1\n+kind: ConfigMap\n+metadata:\n+  name: examples\n+  namespace: pinot-quickstart\n+data:\n+  pullRequestMergedEvents_realtime_table_config.json: |-\n+    {\n+      \"tableName\": \"pullRequestMergedEvents\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb439a47b59117691fe8a8cba0257117c73f62e5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAyODc3Nw==", "bodyText": "Will keep this for now, otherwise it'll be difficult to make any more changes to any current setup", "url": "https://github.com/apache/pinot/pull/5189#discussion_r405028777", "createdAt": "2020-04-07T18:37:26Z", "author": {"login": "npawar"}, "path": "kubernetes/helm/pinot-github-events-setup.yml", "diffHunk": "@@ -0,0 +1,280 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+apiVersion: v1\n+kind: ConfigMap\n+metadata:\n+  name: examples\n+  namespace: pinot-quickstart\n+data:\n+  pullRequestMergedEvents_realtime_table_config.json: |-\n+    {\n+      \"tableName\": \"pullRequestMergedEvents\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1Mjk4NQ=="}, "originalCommit": {"oid": "fb439a47b59117691fe8a8cba0257117c73f62e5"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5Nzg5OTI1OnYy", "diffSide": "RIGHT", "path": "pinot-tools/src/main/java/org/apache/pinot/tools/GithubEventsQuickstart.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMTo0MFrOGAGG4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMTo0MFrOGAGG4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1MzI0OQ==", "bodyText": "/tmp --> System.gettemp dir or something like that", "url": "https://github.com/apache/pinot/pull/5189#discussion_r402753249", "createdAt": "2020-04-03T06:01:40Z", "author": {"login": "kishoreg"}, "path": "pinot-tools/src/main/java/org/apache/pinot/tools/GithubEventsQuickstart.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.tools;\n+\n+import com.google.common.base.Preconditions;\n+import com.google.common.collect.Lists;\n+import java.io.File;\n+import java.net.URL;\n+import org.apache.commons.io.FileUtils;\n+import org.apache.pinot.common.utils.ZkStarter;\n+import org.apache.pinot.spi.plugin.PluginManager;\n+import org.apache.pinot.spi.stream.StreamDataProvider;\n+import org.apache.pinot.spi.stream.StreamDataServerStartable;\n+import org.apache.pinot.tools.Quickstart.Color;\n+import org.apache.pinot.tools.admin.command.QuickstartRunner;\n+import org.apache.pinot.tools.streams.githubevents.PullRequestMergedEventsStream;\n+import org.apache.pinot.tools.utils.KafkaStarterUtils;\n+\n+import static org.apache.pinot.tools.Quickstart.prettyPrintResponse;\n+import static org.apache.pinot.tools.Quickstart.printStatus;\n+\n+\n+/**\n+ * Sets up a demo Pinot cluster with 1 zookeeper, 1 controller, 1 broker and 1 server\n+ * Sets up a demo Kafka cluster, and creates a topic pullRequestMergedEvents\n+ * Creates a realtime table pullRequestMergedEvents\n+ * Starts the {@link PullRequestMergedEventsStream} to publish pullRequestMergedEvents into the topic\n+ */\n+public class GithubEventsQuickstart {\n+  private StreamDataServerStartable _kafkaStarter;\n+  private ZkStarter.ZookeeperInstance _zookeeperInstance;\n+\n+  private void startKafka() {\n+    _zookeeperInstance = ZkStarter.startLocalZkServer();\n+    try {\n+      _kafkaStarter = StreamDataProvider.getServerDataStartable(KafkaStarterUtils.KAFKA_SERVER_STARTABLE_CLASS_NAME,\n+          KafkaStarterUtils.getDefaultKafkaConfiguration());\n+    } catch (Exception e) {\n+      throw new RuntimeException(\"Failed to start \" + KafkaStarterUtils.KAFKA_SERVER_STARTABLE_CLASS_NAME, e);\n+    }\n+    _kafkaStarter.start();\n+    _kafkaStarter.createTopic(\"pullRequestMergedEvents\", KafkaStarterUtils.getTopicCreationProps(2));\n+  }\n+\n+  public void execute(String personalAccessToken)\n+      throws Exception {\n+    final File quickStartDataDir = new File(\"githubEvents\" + System.currentTimeMillis());\n+\n+    if (!quickStartDataDir.exists()) {\n+      Preconditions.checkState(quickStartDataDir.mkdirs());\n+    }\n+\n+    File schemaFile = new File(quickStartDataDir, \"pullRequestMergedEvents_schema.json\");\n+    File tableConfigFile = new File(quickStartDataDir, \"pullRequestMergedEvents_realtime_table_config.json\");\n+\n+    ClassLoader classLoader = Quickstart.class.getClassLoader();\n+    URL resource = classLoader.getResource(\"examples/stream/githubEvents/pullRequestMergedEvents_schema.json\");\n+    Preconditions.checkNotNull(resource);\n+    FileUtils.copyURLToFile(resource, schemaFile);\n+    resource =\n+        classLoader.getResource(\"examples/stream/githubEvents/pullRequestMergedEvents_realtime_table_config.json\");\n+    Preconditions.checkNotNull(resource);\n+    FileUtils.copyURLToFile(resource, tableConfigFile);\n+\n+    File tempDir = new File(\"/tmp\", String.valueOf(System.currentTimeMillis()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb439a47b59117691fe8a8cba0257117c73f62e5"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5Nzg5OTkzOnYy", "diffSide": "RIGHT", "path": "pinot-tools/src/main/java/org/apache/pinot/tools/GithubEventsQuickstart.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMTo1OFrOGAGHNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMTo1OFrOGAGHNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1MzMzNA==", "bodyText": "logger?", "url": "https://github.com/apache/pinot/pull/5189#discussion_r402753334", "createdAt": "2020-04-03T06:01:58Z", "author": {"login": "kishoreg"}, "path": "pinot-tools/src/main/java/org/apache/pinot/tools/GithubEventsQuickstart.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.tools;\n+\n+import com.google.common.base.Preconditions;\n+import com.google.common.collect.Lists;\n+import java.io.File;\n+import java.net.URL;\n+import org.apache.commons.io.FileUtils;\n+import org.apache.pinot.common.utils.ZkStarter;\n+import org.apache.pinot.spi.plugin.PluginManager;\n+import org.apache.pinot.spi.stream.StreamDataProvider;\n+import org.apache.pinot.spi.stream.StreamDataServerStartable;\n+import org.apache.pinot.tools.Quickstart.Color;\n+import org.apache.pinot.tools.admin.command.QuickstartRunner;\n+import org.apache.pinot.tools.streams.githubevents.PullRequestMergedEventsStream;\n+import org.apache.pinot.tools.utils.KafkaStarterUtils;\n+\n+import static org.apache.pinot.tools.Quickstart.prettyPrintResponse;\n+import static org.apache.pinot.tools.Quickstart.printStatus;\n+\n+\n+/**\n+ * Sets up a demo Pinot cluster with 1 zookeeper, 1 controller, 1 broker and 1 server\n+ * Sets up a demo Kafka cluster, and creates a topic pullRequestMergedEvents\n+ * Creates a realtime table pullRequestMergedEvents\n+ * Starts the {@link PullRequestMergedEventsStream} to publish pullRequestMergedEvents into the topic\n+ */\n+public class GithubEventsQuickstart {\n+  private StreamDataServerStartable _kafkaStarter;\n+  private ZkStarter.ZookeeperInstance _zookeeperInstance;\n+\n+  private void startKafka() {\n+    _zookeeperInstance = ZkStarter.startLocalZkServer();\n+    try {\n+      _kafkaStarter = StreamDataProvider.getServerDataStartable(KafkaStarterUtils.KAFKA_SERVER_STARTABLE_CLASS_NAME,\n+          KafkaStarterUtils.getDefaultKafkaConfiguration());\n+    } catch (Exception e) {\n+      throw new RuntimeException(\"Failed to start \" + KafkaStarterUtils.KAFKA_SERVER_STARTABLE_CLASS_NAME, e);\n+    }\n+    _kafkaStarter.start();\n+    _kafkaStarter.createTopic(\"pullRequestMergedEvents\", KafkaStarterUtils.getTopicCreationProps(2));\n+  }\n+\n+  public void execute(String personalAccessToken)\n+      throws Exception {\n+    final File quickStartDataDir = new File(\"githubEvents\" + System.currentTimeMillis());\n+\n+    if (!quickStartDataDir.exists()) {\n+      Preconditions.checkState(quickStartDataDir.mkdirs());\n+    }\n+\n+    File schemaFile = new File(quickStartDataDir, \"pullRequestMergedEvents_schema.json\");\n+    File tableConfigFile = new File(quickStartDataDir, \"pullRequestMergedEvents_realtime_table_config.json\");\n+\n+    ClassLoader classLoader = Quickstart.class.getClassLoader();\n+    URL resource = classLoader.getResource(\"examples/stream/githubEvents/pullRequestMergedEvents_schema.json\");\n+    Preconditions.checkNotNull(resource);\n+    FileUtils.copyURLToFile(resource, schemaFile);\n+    resource =\n+        classLoader.getResource(\"examples/stream/githubEvents/pullRequestMergedEvents_realtime_table_config.json\");\n+    Preconditions.checkNotNull(resource);\n+    FileUtils.copyURLToFile(resource, tableConfigFile);\n+\n+    File tempDir = new File(\"/tmp\", String.valueOf(System.currentTimeMillis()));\n+    Preconditions.checkState(tempDir.mkdirs());\n+    QuickstartTableRequest request = new QuickstartTableRequest(\"pullRequestMergedEvents\", schemaFile, tableConfigFile);\n+    final QuickstartRunner runner = new QuickstartRunner(Lists.newArrayList(request), 1, 1, 1, tempDir);\n+\n+    printStatus(Color.CYAN, \"***** Starting Kafka *****\");\n+    startKafka();\n+\n+    printStatus(Color.CYAN, \"***** Starting zookeeper, controller, server and broker *****\");\n+    runner.startAll();\n+\n+    printStatus(Color.CYAN, \"***** Adding pullRequestMergedEvents table *****\");\n+    runner.addTable();\n+\n+    printStatus(Color.CYAN, \"***** Starting pullRequestMergedEvents data stream and publishing to Kafka *****\");\n+    final PullRequestMergedEventsStream pullRequestMergedEventsStream =\n+        new PullRequestMergedEventsStream(schemaFile.getAbsolutePath(), \"pullRequestMergedEvents\",\n+            KafkaStarterUtils.DEFAULT_KAFKA_BROKER, personalAccessToken);\n+    pullRequestMergedEventsStream.execute();\n+    printStatus(Color.CYAN, \"***** Waiting for 10 seconds for a few events to get populated *****\");\n+    Thread.sleep(10000);\n+\n+    Runtime.getRuntime().addShutdownHook(new Thread(() -> {\n+      try {\n+        printStatus(Color.GREEN, \"***** Shutting down GithubEventsQuickStart *****\");\n+        runner.stop();\n+        _kafkaStarter.stop();\n+        ZkStarter.stopLocalZkServer(_zookeeperInstance);\n+        FileUtils.deleteDirectory(quickStartDataDir);\n+      } catch (Exception e) {\n+        e.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb439a47b59117691fe8a8cba0257117c73f62e5"}, "originalPosition": 111}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzkwMjE5OnYy", "diffSide": "RIGHT", "path": "pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GithubEventsQuickStartCommand.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMzowMVrOGAGIfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjowMzowMVrOGAGIfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1MzY2MA==", "bodyText": "Github --> GitHub in multiple places", "url": "https://github.com/apache/pinot/pull/5189#discussion_r402753660", "createdAt": "2020-04-03T06:03:01Z", "author": {"login": "kishoreg"}, "path": "pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GithubEventsQuickStartCommand.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.tools.admin.command;\n+\n+import org.apache.pinot.spi.plugin.PluginManager;\n+import org.apache.pinot.tools.Command;\n+import org.apache.pinot.tools.GithubEventsQuickstart;\n+import org.kohsuke.args4j.Option;\n+\n+/**\n+ * Command to run GithubEventsQuickStart\n+ */\n+public class GithubEventsQuickStartCommand extends AbstractBaseAdminCommand implements Command {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb439a47b59117691fe8a8cba0257117c73f62e5"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3329, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}