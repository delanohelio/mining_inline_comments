{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MDQwNDM2", "number": 6012, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNToyNzowMlrOEjbS4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNToyODoxMVrOEjbTqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTgyODE5OnYy", "diffSide": "RIGHT", "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNToyNzowMlrOHRxMtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNzowMTo0M1rOHRzhsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5MzkwOQ==", "bodyText": "Should we use min of configured parallelism and the numDataFiles?", "url": "https://github.com/apache/pinot/pull/6012#discussion_r488393909", "createdAt": "2020-09-15T05:27:02Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java", "diffHunk": "@@ -230,7 +230,10 @@ public void run()\n       if (hadoopTokenFileLocation != null) {\n         jobConf.set(\"mapreduce.job.credentials.binary\", hadoopTokenFileLocation);\n       }\n-      jobConf.setInt(JobContext.NUM_MAPS, numDataFiles);\n+\n+      int jobParallelism =\n+          (_spec.getSegmentCreationJobParallelism() > 0) ? _spec.getSegmentCreationJobParallelism() : numDataFiles;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e2cf599bb8623acef91836979a6cef4ef68bc02"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMjA1MA==", "bodyText": "You are right :)", "url": "https://github.com/apache/pinot/pull/6012#discussion_r488432050", "createdAt": "2020-09-15T07:01:43Z", "author": {"login": "xiangfu0"}, "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java", "diffHunk": "@@ -230,7 +230,10 @@ public void run()\n       if (hadoopTokenFileLocation != null) {\n         jobConf.set(\"mapreduce.job.credentials.binary\", hadoopTokenFileLocation);\n       }\n-      jobConf.setInt(JobContext.NUM_MAPS, numDataFiles);\n+\n+      int jobParallelism =\n+          (_spec.getSegmentCreationJobParallelism() > 0) ? _spec.getSegmentCreationJobParallelism() : numDataFiles;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5MzkwOQ=="}, "originalCommit": {"oid": "6e2cf599bb8623acef91836979a6cef4ef68bc02"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTgzMDE5OnYy", "diffSide": "RIGHT", "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/resources/segmentCreationAndTarPushJobSpec.yaml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNToyODoxMVrOHRxN7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNjo1OTo0OVrOHRzeBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5NDIyMA==", "bodyText": "10000?", "url": "https://github.com/apache/pinot/pull/6012#discussion_r488394220", "createdAt": "2020-09-15T05:28:11Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/resources/segmentCreationAndTarPushJobSpec.yaml", "diffHunk": "@@ -28,6 +28,7 @@ includeFileNamePattern: 'glob:**/*.parquet'\n excludeFileNamePattern: 'glob:**/*.avro'\n outputDirURI: 'file:///path/to/output'\n overwriteOutput: true\n+parallelism: 10000", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e2cf599bb8623acef91836979a6cef4ef68bc02"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQzMTExMA==", "bodyText": "it means 10k tasks in Spark or mappers in Hadoop ;)", "url": "https://github.com/apache/pinot/pull/6012#discussion_r488431110", "createdAt": "2020-09-15T06:59:49Z", "author": {"login": "xiangfu0"}, "path": "pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/resources/segmentCreationAndTarPushJobSpec.yaml", "diffHunk": "@@ -28,6 +28,7 @@ includeFileNamePattern: 'glob:**/*.parquet'\n excludeFileNamePattern: 'glob:**/*.avro'\n outputDirURI: 'file:///path/to/output'\n overwriteOutput: true\n+parallelism: 10000", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5NDIyMA=="}, "originalCommit": {"oid": "6e2cf599bb8623acef91836979a6cef4ef68bc02"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3883, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}