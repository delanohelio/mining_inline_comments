{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NzIyNjM2", "number": 5207, "title": "[TE] Retain the original last success task execution time if we can't\u2026", "bodyText": "\u2026 find success tasks\nThere are several alerts that failed for more than 30 days, and thus we can't get the last success task execution from this window.\nHowever we should keep the original last success task execution time.", "createdAt": "2020-04-02T17:39:13Z", "url": "https://github.com/apache/pinot/pull/5207", "merged": true, "mergeCommit": {"oid": "610350a04b58447a09687ef97cc5fbcf8ebd3b77"}, "closed": true, "closedAt": "2020-04-06T18:25:58Z", "author": {"login": "xiaohui-sun"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTu3YXAH2gAyMzk3NzIyNjM2OmE1OGNmZGZlODVmNTFhOGY0ZmI5MGEwZmQzODNkODNiZjZlMTRhNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVCdO_AFqTM4ODQ4MjQ1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f", "committedDate": "2020-04-02T16:26:46Z", "message": "[TE] Retain the original last success task execution time if we can't find success tasks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NzAzNTEw", "url": "https://github.com/apache/pinot/pull/5207#pullrequestreview-386703510", "createdAt": "2020-04-02T18:48:39Z", "commit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo0ODozOVrOF_43OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo1MzoxOFrOF_5Cag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzNjI0OQ==", "bodyText": "We may need to keep the name, otherwise, the existing JSON blobs in the DB won't be able to deserialize back to the object.", "url": "https://github.com/apache/pinot/pull/5207#discussion_r402536249", "createdAt": "2020-04-02T18:48:39Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/health/DetectionTaskStatus.java", "diffHunk": "@@ -46,10 +46,14 @@\n \n   // the time stamp of last successfully finishing task\n   @JsonProperty\n-  private final Long lastTaskExecutionTime;\n+  private Long lastSuccessTaskExecutionTime;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzOTExNA==", "bodyText": "Shall we put this logic in MonitorTaskRunner where the detection health is updated?", "url": "https://github.com/apache/pinot/pull/5207#discussion_r402539114", "createdAt": "2020-04-02T18:53:18Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/DetectionConfigBean.java", "diffHunk": "@@ -162,6 +162,12 @@ public DetectionHealth getHealth() {\n   }\n \n   public void setHealth(DetectionHealth health) {\n+    // If there is no success execution in the current window then the last success task execution time would be -1L.\n+    // We should keep the original last success task execution time if we have.\n+    long lastSuccessTaskExecutionTime = this.health.getDetectionTaskStatus().getLastSuccessTaskExecutionTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "305a2bfc5c572c695746160b8d7b8204686c911a", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/305a2bfc5c572c695746160b8d7b8204686c911a", "committedDate": "2020-04-04T21:02:59Z", "message": "Revert \"[TE] Retain the original last success task execution time if we can't find success tasks\"\n\nThis reverts commit a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4466c6c3f338326e248c408338b699cde212d210", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/4466c6c3f338326e248c408338b699cde212d210", "committedDate": "2020-04-04T21:13:39Z", "message": "[TE] keep the last task exeuction time if there is no success task"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDgyNDUx", "url": "https://github.com/apache/pinot/pull/5207#pullrequestreview-388482451", "createdAt": "2020-04-06T17:50:14Z", "commit": {"oid": "4466c6c3f338326e248c408338b699cde212d210"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1153, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}