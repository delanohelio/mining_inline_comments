{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MjE2OTU2", "number": 6102, "title": "Add the primary key reading from the GenericRow", "bodyText": "Description\nPart of a series of PRs for #4261\nCheck this doc out for the new design\nRelated to #6096", "createdAt": "2020-10-03T05:10:22Z", "url": "https://github.com/apache/pinot/pull/6102", "merged": true, "mergeCommit": {"oid": "be99d78e7139440104703719a822036d66b81469"}, "closed": true, "closedAt": "2020-10-06T01:23:03Z", "author": {"login": "yupeng9"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOzbSGAH2gAyNDk3MjE2OTU2OmY2MmIzNTE2NzY3OWE3MGU1OWVjNDY4NmRiMWY4OGEzYThlNmIxOWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPtGDFAH2gAyNDk3MjE2OTU2OjQ1N2IwNzhjYWU4NjFhNGJmZTQyOGUwNTdiMDM5NzI1NTI0OTdiNTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f62b35167679a70e59ec4686db1f88a3a8e6b19c", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/f62b35167679a70e59ec4686db1f88a3a8e6b19c", "committedDate": "2020-10-03T05:07:08Z", "message": "Add the primary key reading from the GenericRow"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "463b4085efde3dadc7b94ec43475bc6a11de65f4", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/463b4085efde3dadc7b94ec43475bc6a11de65f4", "committedDate": "2020-10-03T05:09:44Z", "message": "cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/169b88121b2f8cc542ebbb3622897836bb109615", "committedDate": "2020-10-04T03:27:26Z", "message": "add license"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDU3NTM3", "url": "https://github.com/apache/pinot/pull/6102#pullrequestreview-502457537", "createdAt": "2020-10-05T22:13:00Z", "commit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMjoxMzowMVrOHcvixg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMjoxNToxOFrOHcvmCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwMTEyNg==", "bodyText": "Cache primaryKeyColumns.size() into a local variable", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499901126", "createdAt": "2020-10-05T22:13:01Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java", "diffHunk": "@@ -123,6 +124,14 @@ public void putValue(String fieldName, @Nullable Object value) {\n     _fieldToValueMap.put(fieldName, value);\n   }\n \n+  public PrimaryKey getPrimaryKey(List<String> primaryKeyColumns) {\n+    Object[] fields = new Object[primaryKeyColumns.size()];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwMTQ5NQ==", "bodyText": "Suggest renaming it to values", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499901495", "createdAt": "2020-10-05T22:14:02Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java", "diffHunk": "@@ -123,6 +124,14 @@ public void putValue(String fieldName, @Nullable Object value) {\n     _fieldToValueMap.put(fieldName, value);\n   }\n \n+  public PrimaryKey getPrimaryKey(List<String> primaryKeyColumns) {\n+    Object[] fields = new Object[primaryKeyColumns.size()];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwMTU2OA==", "bodyText": "Suggest renaming it to _values", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499901568", "createdAt": "2020-10-05T22:14:13Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/PrimaryKey.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.spi.data.readers;\n+\n+import java.util.Arrays;\n+\n+\n+/**\n+ * The primary key of a record.\n+ */\n+public class PrimaryKey {\n+  private final Object[] _fields;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwMTk2MA==", "bodyText": "Add some javadoc stating that the values should be SV (MV values won't work for equals and hashcode)", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499901960", "createdAt": "2020-10-05T22:15:18Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/PrimaryKey.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.spi.data.readers;\n+\n+import java.util.Arrays;\n+\n+\n+/**\n+ * The primary key of a record.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "169b88121b2f8cc542ebbb3622897836bb109615"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2ce718388009aa1431d126df8f38b92cf65fab9", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/d2ce718388009aa1431d126df8f38b92cf65fab9", "committedDate": "2020-10-05T23:29:00Z", "message": "addressed comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNDk5NzY3", "url": "https://github.com/apache/pinot/pull/6102#pullrequestreview-502499767", "createdAt": "2020-10-06T00:03:13Z", "commit": {"oid": "d2ce718388009aa1431d126df8f38b92cf65fab9"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMDowMzoxNFrOHcxqJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwMDowMzo0MVrOHcxqnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkzNTc4MQ==", "bodyText": "(nit)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                Object[] values = new Object[primaryKeyColumns.size()];\n          \n          \n            \n                int size = primaryKeyColumns.size();\n          \n          \n            \n                for (int i = 0; i < size; i++) {\n          \n          \n            \n                int numPrimaryKeyColumns = primaryKeyColumns.size();\n          \n          \n            \n                Object[] values = new Object[numPrimaryKeyColumns];\n          \n          \n            \n                for (int i = 0; i < numPrimaryKeyColumns; i++) {", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499935781", "createdAt": "2020-10-06T00:03:14Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java", "diffHunk": "@@ -123,6 +124,15 @@ public void putValue(String fieldName, @Nullable Object value) {\n     _fieldToValueMap.put(fieldName, value);\n   }\n \n+  public PrimaryKey getPrimaryKey(List<String> primaryKeyColumns) {\n+    Object[] values = new Object[primaryKeyColumns.size()];\n+    int size = primaryKeyColumns.size();\n+    for (int i = 0; i < size; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2ce718388009aa1431d126df8f38b92cf65fab9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkzNTkwMQ==", "bodyText": "(nit)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public PrimaryKey(Object[] fields) {\n          \n          \n            \n                _values = fields;\n          \n          \n            \n              public PrimaryKey(Object[] values) {\n          \n          \n            \n                _values = values;", "url": "https://github.com/apache/pinot/pull/6102#discussion_r499935901", "createdAt": "2020-10-06T00:03:41Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/PrimaryKey.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.spi.data.readers;\n+\n+import java.util.Arrays;\n+\n+\n+/**\n+ * The primary key of a record. Note that the value used in the primary key must be single-value.\n+ */\n+public class PrimaryKey {\n+  private final Object[] _values;\n+\n+  public PrimaryKey(Object[] fields) {\n+    _values = fields;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2ce718388009aa1431d126df8f38b92cf65fab9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "457b078cae861a4bfe428e057b03972552497b53", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/457b078cae861a4bfe428e057b03972552497b53", "committedDate": "2020-10-06T00:18:26Z", "message": "more comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1525, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}