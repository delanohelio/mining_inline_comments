{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NDg1NzU3", "number": 5355, "title": "Remove some timeFieldSpec constructors", "bodyText": "As part of #2756 we are going to move away from TimeFieldSpec and instead use DateTimeFieldSpec.\nWe have a lot of constructors for TimeFieldSpec. Most of those constructor calls will be replaced by equivalent DateTimeFieldSpec constructor calls. After the final change to DateTimeFieldSpec, other than tests, no one should be calling these constructors. We will keep some basic constructor around, for the backward compatibility tests.\nIn this PR,\n\nattempting to clean up 9 constructors, keeping only 4 basic ones.\nWherever possible, using SchemaBuilder in tests.\nThis will make it one more step easier to switch over to the new stuff.", "createdAt": "2020-05-09T00:31:15Z", "url": "https://github.com/apache/pinot/pull/5355", "merged": true, "mergeCommit": {"oid": "d54afba0418e4f9321fb5129cd4c3cbc01491692"}, "closed": true, "closedAt": "2020-05-11T23:18:17Z", "author": {"login": "npawar"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgWAdGAH2gAyNDE1NDg1NzU3Ojg5NTIxMzE4ZmIyMDNjYzE4MjQ3MjE4ZGE4Nzk4ZmM3ZWIzYjEyYjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgXbmGgH2gAyNDE1NDg1NzU3OmQwNTdmNGQyZDZhNzA2M2VjYTRkYjllZjc2OGI0OWZlZTE3ZTMwNmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "89521318fb203cc18247218da8798fc7eb3b12b1", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/89521318fb203cc18247218da8798fc7eb3b12b1", "committedDate": "2020-05-11T20:50:04Z", "message": "Remove some TimeFieldSpec constructors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5ba8d9213d3f09799d04f21a518cd765f750c41", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/c5ba8d9213d3f09799d04f21a518cd765f750c41", "committedDate": "2020-05-11T20:50:04Z", "message": "Fix sdf test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "498a60e9ca456e36f5c086de5a368b9d7ecd63c6", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/498a60e9ca456e36f5c086de5a368b9d7ecd63c6", "committedDate": "2020-05-11T20:50:04Z", "message": "Fix test schema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d213c97ddc2ffc9f83cf0d51fcf798636ce63bcf", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/d213c97ddc2ffc9f83cf0d51fcf798636ce63bcf", "committedDate": "2020-05-11T20:50:04Z", "message": "Typo in test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/c6a64e1c6e8c4119f299d0d6f206bdb062338a0c", "committedDate": "2020-05-11T20:50:04Z", "message": "Remove unnecessary setTime"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "04b24a0bcecbbc0f760652ed11f6328667780c51", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/04b24a0bcecbbc0f760652ed11f6328667780c51", "committedDate": "2020-05-11T20:40:19Z", "message": "Typo in test"}, "afterCommit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/c6a64e1c6e8c4119f299d0d6f206bdb062338a0c", "committedDate": "2020-05-11T20:50:04Z", "message": "Remove unnecessary setTime"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NTY0ODIx", "url": "https://github.com/apache/pinot/pull/5355#pullrequestreview-409564821", "createdAt": "2020-05-11T22:05:57Z", "commit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMjowNTo1OFrOGTvD_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMjoxNTowOFrOGTvSZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM0NzE5Ng==", "bodyText": "Can you rename these variables?", "url": "https://github.com/apache/pinot/pull/5355#discussion_r423347196", "createdAt": "2020-05-11T22:05:58Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/test/java/org/apache/pinot/common/data/FieldSpecTest.java", "diffHunk": "@@ -132,72 +132,28 @@ public void testFieldSpec() {\n   @Test\n   public void testTimeFieldSpecConstructor() {\n     String incomingName = \"incoming\";\n-    FieldSpec.DataType incomingDataType = LONG;\n     TimeUnit incomingTimeUnit = TimeUnit.HOURS;\n     int incomingTimeUnitSize = 1;\n     TimeGranularitySpec incomingTimeGranularitySpec =\n-        new TimeGranularitySpec(incomingDataType, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n+        new TimeGranularitySpec(LONG, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n     String outgoingName = \"outgoing\";\n-    FieldSpec.DataType outgoingDataType = INT;\n     TimeUnit outgoingTimeUnit = TimeUnit.DAYS;\n     int outgoingTimeUnitSize = 1;\n     TimeGranularitySpec outgoingTimeGranularitySpec =\n-        new TimeGranularitySpec(outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit, outgoingName);\n+        new TimeGranularitySpec(INT, outgoingTimeUnitSize, outgoingTimeUnit, outgoingName);\n     int defaultNullValue = 17050;\n-\n-    TimeFieldSpec timeFieldSpec1 = new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit);\n-    TimeFieldSpec timeFieldSpec2 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, defaultNullValue);\n-    TimeFieldSpec timeFieldSpec3 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, outgoingName, outgoingDataType,\n-            outgoingTimeUnit);\n-    TimeFieldSpec timeFieldSpec4 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, outgoingName, outgoingDataType,\n-            outgoingTimeUnit, defaultNullValue);\n-    TimeFieldSpec timeFieldSpec5 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit);\n-    TimeFieldSpec timeFieldSpec6 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, defaultNullValue);\n-    TimeFieldSpec timeFieldSpec7 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, outgoingName,\n-            outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit);\n-    TimeFieldSpec timeFieldSpec8 =\n-        new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, outgoingName,\n-            outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit, defaultNullValue);\n     TimeFieldSpec timeFieldSpec9 = new TimeFieldSpec(incomingTimeGranularitySpec);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM1MDEwNg==", "bodyText": "We don't allow null for time, so you can remove the APIs with defaultNullValue as well", "url": "https://github.com/apache/pinot/pull/5355#discussion_r423350106", "createdAt": "2020-05-11T22:13:13Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/TimeFieldSpec.java", "diffHunk": "@@ -38,65 +38,6 @@ public TimeFieldSpec() {\n     super();\n   }\n \n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, TimeUnit incomingTimeUnit) {\n-    super(incomingName, incomingDataType, true);\n-    _incomingGranularitySpec = new TimeGranularitySpec(incomingDataType, incomingTimeUnit, incomingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, TimeUnit incomingTimeUnit,\n-      Object defaultNullValue) {\n-    super(incomingName, incomingDataType, true, defaultNullValue);\n-    _incomingGranularitySpec = new TimeGranularitySpec(incomingDataType, incomingTimeUnit, incomingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, TimeUnit incomingTimeUnit, String outgoingName,\n-      DataType outgoingDataType, TimeUnit outgoingTimeUnit) {\n-    super(outgoingName, outgoingDataType, true);\n-    _incomingGranularitySpec = new TimeGranularitySpec(incomingDataType, incomingTimeUnit, incomingName);\n-    _outgoingGranularitySpec = new TimeGranularitySpec(outgoingDataType, outgoingTimeUnit, outgoingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, TimeUnit incomingTimeUnit, String outgoingName,\n-      DataType outgoingDataType, TimeUnit outgoingTimeUnit, Object defaultNullValue) {\n-    super(outgoingName, outgoingDataType, true, defaultNullValue);\n-    _incomingGranularitySpec = new TimeGranularitySpec(incomingDataType, incomingTimeUnit, incomingName);\n-    _outgoingGranularitySpec = new TimeGranularitySpec(outgoingDataType, outgoingTimeUnit, outgoingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, int incomingTimeUnitSize,\n-      TimeUnit incomingTimeUnit) {\n-    super(incomingName, incomingDataType, true);\n-    _incomingGranularitySpec =\n-        new TimeGranularitySpec(incomingDataType, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, int incomingTimeUnitSize,\n-      TimeUnit incomingTimeUnit, Object defaultNullValue) {\n-    super(incomingName, incomingDataType, true, defaultNullValue);\n-    _incomingGranularitySpec =\n-        new TimeGranularitySpec(incomingDataType, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, int incomingTimeUnitSize,\n-      TimeUnit incomingTimeUnit, String outgoingName, DataType outgoingDataType, int outgoingTimeUnitSize,\n-      TimeUnit outgoingTimeUnit) {\n-    super(outgoingName, outgoingDataType, true);\n-    _incomingGranularitySpec =\n-        new TimeGranularitySpec(incomingDataType, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n-    _outgoingGranularitySpec =\n-        new TimeGranularitySpec(outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit, outgoingName);\n-  }\n-\n-  public TimeFieldSpec(String incomingName, DataType incomingDataType, int incomingTimeUnitSize,\n-      TimeUnit incomingTimeUnit, String outgoingName, DataType outgoingDataType, int outgoingTimeUnitSize,\n-      TimeUnit outgoingTimeUnit, Object defaultNullValue) {\n-    super(outgoingName, outgoingDataType, true, defaultNullValue);\n-    _incomingGranularitySpec =\n-        new TimeGranularitySpec(incomingDataType, incomingTimeUnitSize, incomingTimeUnit, incomingName);\n-    _outgoingGranularitySpec =\n-        new TimeGranularitySpec(outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit, outgoingName);\n-  }\n-\n   public TimeFieldSpec(TimeGranularitySpec incomingGranularitySpec) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM1MDg4NQ==", "bodyText": "Conceptually this should be the incoming name", "url": "https://github.com/apache/pinot/pull/5355#discussion_r423350885", "createdAt": "2020-05-11T22:15:08Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-tools/src/main/java/org/apache/pinot/tools/streams/AirlineDataStream.java", "diffHunk": "@@ -125,7 +125,7 @@ public void run() {\n             }\n \n             TimeFieldSpec spec = pinotSchema.getTimeFieldSpec();\n-            String timeColumn = spec.getIncomingTimeColumnName();\n+            String timeColumn = spec.getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a64e1c6e8c4119f299d0d6f206bdb062338a0c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "370acc266f83787bab6e69e0aebfe302654dc367", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/370acc266f83787bab6e69e0aebfe302654dc367", "committedDate": "2020-05-11T22:26:42Z", "message": "Review suggestions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d057f4d2d6a7063eca4db9ef768b49fee17e306a", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/d057f4d2d6a7063eca4db9ef768b49fee17e306a", "committedDate": "2020-05-11T22:29:37Z", "message": "Review suggestions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1018, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}