{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzM5Mzc5", "number": 5626, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMToxOTowM1rOEJRMlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMToxOTowM1rOEJRMlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4MTU0Mzg5OnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/v2/alerts/AlertSearcher.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMToxOTowM1rOGpu_hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMjozOToxNVrOGqlADg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQxNDcyNA==", "bodyText": "Can we have comments somewhere to make it clear that we are using AND or OR relationship between filters?", "url": "https://github.com/apache/pinot/pull/5626#discussion_r446414724", "createdAt": "2020-06-26T21:19:03Z", "author": {"login": "vincentchenjl"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/v2/alerts/AlertSearcher.java", "diffHunk": "@@ -194,15 +194,23 @@ public AlertSearcher() {\n     Set<Long> metricIds = new HashSet<>();\n     if (!searchFilter.getMetrics().isEmpty()) {\n       for (String metric : searchFilter.getMetrics()) {\n-        metricIds =\n-            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet());\n+        metricIds.addAll(\n+            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n       }\n     }\n \n     if (!searchFilter.getDatasets().isEmpty()) {\n+      Set<Long> metricIdsFromDataset = new HashSet<>();\n       for (String dataset : searchFilter.getDatasets()) {\n-        metricIds.retainAll(\n-            this.metricDAO.findByDataset(dataset).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n+        metricIdsFromDataset.addAll(this.metricDAO.findByPredicate(Predicate.LIKE(\"dataset\", \"%\" + dataset + \"%\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b426baad2f209af14041167d569bb3e92871ea32"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI5OTU5OA==", "bodyText": "sure. added the comments", "url": "https://github.com/apache/pinot/pull/5626#discussion_r447299598", "createdAt": "2020-06-29T22:39:15Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/v2/alerts/AlertSearcher.java", "diffHunk": "@@ -194,15 +194,23 @@ public AlertSearcher() {\n     Set<Long> metricIds = new HashSet<>();\n     if (!searchFilter.getMetrics().isEmpty()) {\n       for (String metric : searchFilter.getMetrics()) {\n-        metricIds =\n-            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet());\n+        metricIds.addAll(\n+            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n       }\n     }\n \n     if (!searchFilter.getDatasets().isEmpty()) {\n+      Set<Long> metricIdsFromDataset = new HashSet<>();\n       for (String dataset : searchFilter.getDatasets()) {\n-        metricIds.retainAll(\n-            this.metricDAO.findByDataset(dataset).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n+        metricIdsFromDataset.addAll(this.metricDAO.findByPredicate(Predicate.LIKE(\"dataset\", \"%\" + dataset + \"%\"))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQxNDcyNA=="}, "originalCommit": {"oid": "b426baad2f209af14041167d569bb3e92871ea32"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4393, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}