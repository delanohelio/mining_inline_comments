{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzMzEwNDg0", "number": 4989, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODozNjo1NlrODZmGww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxNDoyNVrODaQ-2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY1MzE1OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/SortedDocIdIterator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODozNjo1NlrOFgEiTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODozNjo1NlrOFgEiTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3MzA3MQ==", "bodyText": "Remove the empty javadoc?", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369173071", "createdAt": "2020-01-21T18:36:56Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/SortedDocIdIterator.java", "diffHunk": "@@ -24,14 +24,12 @@\n \n \n public final class SortedDocIdIterator implements IndexBasedDocIdIterator {\n-  /**\n-   *\n-   */\n   private List<IntPair> pairs;\n   private String datasourceName;\n \n   /**\n-   * @param sortedDocIdSet\n+   * @param datasourceName", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY3NjkxOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/BitmapDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0NDoxOFrOFgExLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0NDoxOFrOFgExLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3Njg3OQ==", "bodyText": "No need to scan values when filtering with inverted index", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369176879", "createdAt": "2020-01-21T18:44:18Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/BitmapDocIdSet.java", "diffHunk": "@@ -79,6 +79,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO: explain why there is no entries scanned in this filter.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY4NjQ1OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0NzoyNlrOFgE3bw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0NzoyNlrOFgE3bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3ODQ3OQ==", "bodyText": "Can you change the TODO to: Rename the class to MatchAllDocIdSet", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369178479", "createdAt": "2020-01-21T18:47:26Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -21,7 +21,7 @@\n import org.apache.pinot.core.common.BlockDocIdIterator;\n import org.apache.pinot.core.operator.dociditerators.SizeBasedDocIdIterator;\n \n-\n+// TODO: javadoc this class.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY4Nzg5OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SortedDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0Nzo1OVrOFgE4cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0Nzo1OVrOFgE4cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3ODczNw==", "bodyText": "No need to scan values when filtering with sorted index", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369178737", "createdAt": "2020-01-21T18:47:59Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SortedDocIdSet.java", "diffHunk": "@@ -77,6 +77,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO: explain return 0.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY5MTk2OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0OToxNVrOFgE66Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo0OToxNVrOFgE66Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3OTM2OQ==", "bodyText": "No need to scan values when all values match the filter", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369179369", "createdAt": "2020-01-21T18:49:15Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -49,6 +49,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // TODO explain why return 0.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTY5OTE0OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo1MTozNVrOFgE_cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo1MTozNVrOFgE_cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MDUyOQ==", "bodyText": "The number of entries (single-value entry contains one value, multi-value entry may contain multiple values) scanned ...", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369180529", "createdAt": "2020-01-21T18:51:35Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,12 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of doc ids scanned in the filtering phase of the query execution: could be larger than the total doc num", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MTcwMTAzOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo1MjoxM1rOFgFApg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxODo1MjoxM1rOFgFApg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4MDgzOA==", "bodyText": "Equal to numDocsScanned * numProjectedColumns", "url": "https://github.com/apache/pinot/pull/4989#discussion_r369180838", "createdAt": "2020-01-21T18:52:13Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,12 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of doc ids scanned in the filtering phase of the query execution: could be larger than the total doc num\n+  // because of multiple filtering predicates.\n   private long _numEntriesScannedInFilter;\n+  // Equal to _numDocsScanned * number_of_projected_columns", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71df3cbb8d3ca4c085f5e241f965283d96b50883"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4ODY3NDg1OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxMzoxM1rOFhH2Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxOTo1NTo1NFrOFhoy8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA==", "bodyText": "The number of entries (single-value entry contains 1 value, multi-value entry may contain multiple values) scanned in the filtering phase of the query execution. Could be larger than the number of documents scanned because of multiple filtering predicates.", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370275890", "createdAt": "2020-01-23T18:13:13Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NjM4OA==", "bodyText": "Last sentence also changed (multi-value entry is not the reason)", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370766388", "createdAt": "2020-01-24T18:02:18Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc4MTY3Mw==", "bodyText": "I thought one reason why number_of_entries_scanned > number_of_doc_scanned is that for a multi-value entry, each value in it could count as one entry scanned. Is it right?", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370781673", "createdAt": "2020-01-24T18:38:26Z", "author": {"login": "chenboat"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc5MTk0Nw==", "bodyText": "Oh sorry my bad, you are right. The semantic for this value changed with #4455 and I totally forgot about it...\nSo right now the entry has different meaning in _numEntriesScannedInFilter (each MV value contains multiple entries) and _numEntriesScannedInFilter (both SV and MV value are counted as one entry).\nCan you please add a TODO to make entry semantic the same in _numEntriesScannedInFilter and _numEntriesScannedInFilter? Currently it is very misleading.\nI think it might be better to add a new stats _numValuesScannedInFilter to replace the current _numEntriesScannedInFilter, but it is out of the scope of this pr.", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370791947", "createdAt": "2020-01-24T19:00:40Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxNTcyOA==", "bodyText": "TODO added. Thanks for the clarification.", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370815728", "createdAt": "2020-01-24T19:55:54Z", "author": {"login": "chenboat"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/ExecutionStatistics.java", "diffHunk": "@@ -22,8 +22,13 @@\n  * The <code>ExecutionStatistics</code> class contains the operator statistics during execution time.\n  */\n public class ExecutionStatistics {\n+  // The number of documents scanned post filtering.\n   private long _numDocsScanned;\n+  // The number of entries (single value entry contains 1 entry, multi-value entry may contain multiple entries) in the\n+  // filtering phase of the query execution: could be larger than the total scanned doc num because of multiple\n+  // filtering predicates and multi-value entry.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NTg5MA=="}, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4ODY3NjQwOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxMzo1MFrOFhH3Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxMzo1MFrOFhH3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NjE0Ng==", "bodyText": "Add TODO:", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370276146", "createdAt": "2020-01-23T18:13:50Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -21,7 +21,7 @@\n import org.apache.pinot.core.common.BlockDocIdIterator;\n import org.apache.pinot.core.operator.dociditerators.SizeBasedDocIdIterator;\n \n-\n+// Rename this class to MatchAllDocIdSet.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4ODY3ODAwOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxNDoyNVrOFhH4Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODoxNDoyNVrOFhH4Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NjM5NQ==", "bodyText": "matched", "url": "https://github.com/apache/pinot/pull/4989#discussion_r370276395", "createdAt": "2020-01-23T18:14:25Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/docidsets/SizeBasedDocIdSet.java", "diffHunk": "@@ -49,6 +49,7 @@ public void setEndDocId(int endDocId) {\n \n   @Override\n   public long getNumEntriesScannedInFilter() {\n+    // No value scanned because all docs are matches and will be returned.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9be4b4eb8622a22aab68d1181246b74d242616b9"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3597, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}