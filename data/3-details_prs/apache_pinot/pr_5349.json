{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTE0NDcy", "number": 5349, "title": "Remove excessive SchemaBuilder#addTime methods", "bodyText": "An item for project #2756\nWhen timeFieldSpec gets deprecated in favor of DateTimeFieldSpec, one of the changes will be in the SchemaBuilder class. SchemaBuilder is used only in tests (not sure if external integrations use it).\nSchemaBuilder has ~10 methods to addTime. These will be replaced with addDateTime (barring a few places where we intentionally want to add TIME to test that we get DATE_TIME.)\nRemoving most of the addTime methods, keeping only\n\naddTime(incomingGranularitySpec, outgoingGranularitySpec)\nThis will help when making the code change to dateTimeFieldSpec.\n\nThese above method gets replaced by\n\naddDateTime(name, dataType, format, granularity) // basic fields\naddDateTime(name, dataType, format, granularity, defaultNullValue, transformFunction) // advanced fields", "createdAt": "2020-05-07T20:54:28Z", "url": "https://github.com/apache/pinot/pull/5349", "merged": true, "mergeCommit": {"oid": "aa0a5f144ae360ef447dea01c5cc949e1b327989"}, "closed": true, "closedAt": "2020-05-08T19:09:21Z", "author": {"login": "npawar"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfDXCogH2gAyNDE0OTE0NDcyOjI0N2IyNmQxZWRmOWM0ZjgwOWQ3NzFkZjliZjIyOWExOGFlMWM3ZTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfWCK6gH2gAyNDE0OTE0NDcyOjgzOTU0MTA5ZjVmMTYwYzQ4MjYxZTQ5ZDFlODQwNTg3NWJmNDJhMmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "247b26d1edf9c4f809d771df9bf229a18ae1c7e5", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/247b26d1edf9c4f809d771df9bf229a18ae1c7e5", "committedDate": "2020-05-07T20:32:37Z", "message": "Remove many addTime methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dd199a825ba6bb89cceba459a17fce2770ab1d3", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/3dd199a825ba6bb89cceba459a17fce2770ab1d3", "committedDate": "2020-05-07T20:53:22Z", "message": "Keep only 1 addTime method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/ad0cc674a32b7049134f8d37fb83db07d6370d5b", "committedDate": "2020-05-07T20:58:19Z", "message": "Format classes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NDE2MTAz", "url": "https://github.com/apache/pinot/pull/5349#pullrequestreview-408416103", "createdAt": "2020-05-08T17:58:02Z", "commit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "state": "APPROVED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNzo1ODowMlrOGSuQZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxODowMTozNVrOGSuXjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NTQxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add single value dimensionFieldSpec with basic fields\n          \n          \n            \n                 * Add single value dimensionFieldSpec\n          \n      \n    \n    \n  \n\nthe word fields in the comment is confusing.\nI am also fine omitting javadocs from methods that are self-describing in the method name (and args)", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422285413", "createdAt": "2020-05-08T17:58:02Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NTYyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n          \n          \n            \n                 * Add single value dimensionFieldSpec with a defaultNullValue", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422285626", "createdAt": "2020-05-08T17:58:27Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NTg3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add multi value dimensionFieldSpec with basic fields\n          \n          \n            \n                 * Add multi value dimensionFieldSpec", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422285877", "createdAt": "2020-05-08T17:58:52Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add multi value dimensionFieldSpec with basic fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjIwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n          \n          \n            \n                 * Add single value dimensionFieldSpec with defaultNullValue", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422286207", "createdAt": "2020-05-08T17:59:26Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add multi value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjMxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add metricFieldSpec with basic fields\n          \n          \n            \n                 * Add metricFieldSpec", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422286312", "createdAt": "2020-05-08T17:59:39Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add multi value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add metricFieldSpec with basic fields", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NjQyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add metricFieldSpec with basic fields plus defaultNullValue\n          \n          \n            \n                 * Add metricFieldSpec with defaultNullValue", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422286425", "createdAt": "2020-05-08T17:59:52Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add multi value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add metricFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMetric(String metricName, DataType dataType) {\n       _schema.addField(new MetricFieldSpec(metricName, dataType));\n       return this;\n     }\n \n+    /**\n+     * Add metricFieldSpec with basic fields plus defaultNullValue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjI4NzI0NA==", "bodyText": "Can we annotate it with @Deprecated so as to prevent new usage of the method?\nI suspect there are no alternative methods at this point, so you can specify exactly what conditions this method must be used (e.g. testing backward compat, like you have already done) perhaps with an @note annotation.", "url": "https://github.com/apache/pinot/pull/5349#discussion_r422287244", "createdAt": "2020-05-08T18:01:35Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java", "diffHunk": "@@ -451,118 +452,87 @@ public SchemaBuilder setSchemaName(String schemaName) {\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addSingleValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, true, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add multi value dimensionFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false));\n       return this;\n     }\n \n+    /**\n+     * Add single value dimensionFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addMultiValueDimension(String dimensionName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new DimensionFieldSpec(dimensionName, dataType, false, defaultNullValue));\n       return this;\n     }\n \n+    /**\n+     * Add metricFieldSpec with basic fields\n+     */\n     public SchemaBuilder addMetric(String metricName, DataType dataType) {\n       _schema.addField(new MetricFieldSpec(metricName, dataType));\n       return this;\n     }\n \n+    /**\n+     * Add metricFieldSpec with basic fields plus defaultNullValue\n+     */\n     public SchemaBuilder addMetric(String metricName, DataType dataType, Object defaultNullValue) {\n       _schema.addField(new MetricFieldSpec(metricName, dataType, defaultNullValue));\n       return this;\n     }\n \n-    public SchemaBuilder addTime(String incomingName, TimeUnit incomingTimeUnit, DataType incomingDataType) {\n-      _schema.addField(new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, TimeUnit incomingTimeUnit, DataType incomingDataType,\n-        Object defaultNullValue) {\n-      _schema.addField(new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, defaultNullValue));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, TimeUnit incomingTimeUnit, DataType incomingDataType,\n-        String outgoingName, TimeUnit outgoingTimeUnit, DataType outgoingDataType) {\n-      _schema.addField(\n-          new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, outgoingName, outgoingDataType,\n-              outgoingTimeUnit));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, TimeUnit incomingTimeUnit, DataType incomingDataType,\n-        String outgoingName, TimeUnit outgoingTimeUnit, DataType outgoingDataType, Object defaultNullValue) {\n-      _schema.addField(\n-          new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnit, outgoingName, outgoingDataType,\n-              outgoingTimeUnit, defaultNullValue));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, int incomingTimeUnitSize, TimeUnit incomingTimeUnit,\n-        DataType incomingDataType) {\n-      _schema.addField(new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, int incomingTimeUnitSize, TimeUnit incomingTimeUnit,\n-        DataType incomingDataType, Object defaultNullValue) {\n-      _schema.addField(\n-          new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, defaultNullValue));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, int incomingTimeUnitSize, TimeUnit incomingTimeUnit,\n-        DataType incomingDataType, String outgoingName, int outgoingTimeUnitSize, TimeUnit outgoingTimeUnit,\n-        DataType outgoingDataType) {\n-      _schema.addField(\n-          new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, outgoingName,\n-              outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(String incomingName, int incomingTimeUnitSize, TimeUnit incomingTimeUnit,\n-        DataType incomingDataType, String outgoingName, int outgoingTimeUnitSize, TimeUnit outgoingTimeUnit,\n-        DataType outgoingDataType, Object defaultNullValue) {\n-      _schema.addField(\n-          new TimeFieldSpec(incomingName, incomingDataType, incomingTimeUnitSize, incomingTimeUnit, outgoingName,\n-              outgoingDataType, outgoingTimeUnitSize, outgoingTimeUnit, defaultNullValue));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(TimeGranularitySpec incomingTimeGranularitySpec) {\n-      _schema.addField(new TimeFieldSpec(incomingTimeGranularitySpec));\n-      return this;\n-    }\n-\n-    public SchemaBuilder addTime(TimeGranularitySpec incomingTimeGranularitySpec, Object defaultNullValue) {\n-      _schema.addField(new TimeFieldSpec(incomingTimeGranularitySpec, defaultNullValue));\n-      return this;\n-    }\n-\n+    /**\n+     * Add timeFieldSpec with incoming and outgoing granularity spec\n+     * TODO: This is deprecated in favor of addDateTime().", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad0cc674a32b7049134f8d37fb83db07d6370d5b"}, "originalPosition": 130}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2db749470ef07f6009185e95c87bfa0d9f804f7f", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/2db749470ef07f6009185e95c87bfa0d9f804f7f", "committedDate": "2020-05-08T18:16:21Z", "message": "Remove Deprecated from addTime, as it is not deprecated as of yet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83954109f5f160c48261e49d1e8405875bf42a2d", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/83954109f5f160c48261e49d1e8405875bf42a2d", "committedDate": "2020-05-08T18:18:01Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Subbu Subramaniam <mcvsubbu@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1010, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}