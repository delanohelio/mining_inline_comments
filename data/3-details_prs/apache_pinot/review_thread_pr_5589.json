{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2NTgxMDU5", "number": 5589, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjowMzo1NlrOEG0RUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODozMToyMVrOEG3b0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NTgzMzE0OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjowMzo1NlrOGl2Jcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjozMDozN1rOGl3Lgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzNzY1MQ==", "bodyText": "There may be (are) scripts that use this log line to parse. Unless absolutely needed, let us not change the case for requestId?", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442337651", "createdAt": "2020-06-18T16:03:56Z", "author": {"login": "mcvsubbu"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM1NDU2Mw==", "bodyText": "done", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442354563", "createdAt": "2020-06-18T16:30:37Z", "author": {"login": "siddharthteotia"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzNzY1MQ=="}, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NTgzODU3OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjowNToxOVrOGl2M-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNzoxNzowN1rOGl43LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzODU1NQ==", "bodyText": "Can you add the new items at the end and not change the names of the variables? Is the changing of var names absolutely needed?\nIf we are trying to minimize the line length, another way of doing this will be to create a separate logger that outputs in binary, and provide a utility to read it?", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442338555", "createdAt": "2020-06-18T16:05:19Z", "author": {"login": "mcvsubbu"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n+              + \"schedulerWaitMs:{},reqDeserMs:{},totalExecMs:{},resSerMs:{},totalTimeMs:{},minConsumingFreshnessMs:{},broker:{},\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM1MTU4NQ==", "bodyText": "@mcvsubbu, I didn't change any variable names. Have just added request deserialization (reqDeserMs) and response serialization (resSerMs) times. Nothing else has changed", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442351585", "createdAt": "2020-06-18T16:26:01Z", "author": {"login": "siddharthteotia"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n+              + \"schedulerWaitMs:{},reqDeserMs:{},totalExecMs:{},resSerMs:{},totalTimeMs:{},minConsumingFreshnessMs:{},broker:{},\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzODU1NQ=="}, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM1NTE3Ng==", "bodyText": "Also new items were not added at the end because I think it is better to keep the timing info together", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442355176", "createdAt": "2020-06-18T16:31:35Z", "author": {"login": "siddharthteotia"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n+              + \"schedulerWaitMs:{},reqDeserMs:{},totalExecMs:{},resSerMs:{},totalTimeMs:{},minConsumingFreshnessMs:{},broker:{},\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzODU1NQ=="}, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM4MjEyNQ==", "bodyText": "let us stick to \"name1=value1,name2=value2,....\". (IOW comma-separtated name=value, no other spaces).\nMy bad when I wrote \"variables\". I meant item names. For some reason, I thought \"schedulerWaitMs\" was changed to \"sched\" May be I was mistaken.\nSorry to harp on this, but when we look through gazillion log lines scripts help if the format is uniform.", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442382125", "createdAt": "2020-06-18T17:17:07Z", "author": {"login": "mcvsubbu"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -199,11 +199,13 @@ public void stop() {\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n       LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+          \"Processed RequestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n+              + \"schedulerWaitMs:{},reqDeserMs:{},totalExecMs:{},resSerMs:{},totalTimeMs:{},minConsumingFreshnessMs:{},broker:{},\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjMzODU1NQ=="}, "originalCommit": {"oid": "cdd443ab4df72e5f3d83de1a70525d3d75e4c71c"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NjM1MTUyOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODozMToyMVrOGl7Xng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMTo1MTowNFrOGmBaLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyMzE5OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  LOGGER.info(\"Processed requestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n          \n          \n            \n                  LOGGER.info(\"Processed requestId:{},table:{},segments(queried/processed/matched/consuming):{}/{}/{}/{},\"", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442423198", "createdAt": "2020-06-18T18:31:21Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -198,12 +198,13 @@ public void stop() {\n     long schedulerWaitMs = timerContext.getPhaseDurationMs(ServerQueryPhase.SCHEDULER_WAIT);\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n-      LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+      LOGGER.info(\"Processed requestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0236ebe210fe80a648f6a0ba0140babd75a43fb"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUyMjE1OQ==", "bodyText": "\"=\" is better for parsing out since \":\" is also present in timestamps. Made this consistent with log in BaseBrokerRequestHandler", "url": "https://github.com/apache/pinot/pull/5589#discussion_r442522159", "createdAt": "2020-06-18T21:51:04Z", "author": {"login": "siddharthteotia"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java", "diffHunk": "@@ -198,12 +198,13 @@ public void stop() {\n     long schedulerWaitMs = timerContext.getPhaseDurationMs(ServerQueryPhase.SCHEDULER_WAIT);\n \n     if (queryLogRateLimiter.tryAcquire() || forceLog(schedulerWaitMs, numDocsScanned)) {\n-      LOGGER.info(\n-          \"Processed requestId={},table={},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"\n-              + \"schedulerWaitMs={},totalExecMs={},totalTimeMs={},minConsumingFreshnessMs={},broker={},\"\n-              + \"numDocsScanned={},scanInFilter={},scanPostFilter={},sched={}\",\n-          requestId, tableNameWithType, numSegmentsQueried, numSegmentsProcessed, numSegmentsMatched,\n-          numSegmentsConsuming, schedulerWaitMs, timerContext.getPhaseDurationMs(ServerQueryPhase.QUERY_PROCESSING),\n+      LOGGER.info(\"Processed requestId:{},table:{},segments(queried/processed/matched/consuming)={}/{}/{}/{},\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQyMzE5OA=="}, "originalCommit": {"oid": "e0236ebe210fe80a648f6a0ba0140babd75a43fb"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4339, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}