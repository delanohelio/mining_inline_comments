{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMTA1Mjc1", "number": 5808, "title": "[TE] Dashboard Resource Refactor", "bodyText": "This change refactors the resource classes.\n\nRemoved top level annotations in resource classes and converted them to method level.\nCreated a RootResource to hold the \"/\" namespace\nMost dependencies have been moved to this resource simplifying the DashboardServer\nMost of the resource classes have been configured with relative paths hosted in there respective classes.\nSome minor refactor: mostly involves removing used dependencies\n\nThere is no behavior change with this PR. All endpoints work as is. There are some resource classes which required a lot of refactor and are not included in this change.\nIf required this PR can be split into multiple PRs. However, I decided to merge all commits in a single PR because it is tied to the same context.", "createdAt": "2020-08-05T02:24:34Z", "url": "https://github.com/apache/pinot/pull/5808", "merged": true, "mergeCommit": {"oid": "47323de00f23dd73a991122f0d0364eca917028d"}, "closed": true, "closedAt": "2020-08-11T20:40:45Z", "author": {"login": "suvodeep-pyne"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7_R6gABqjM2MjU4NjgxMzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc98F-1ABqjM2NDQ3MjM3NDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a24dc0ec09ce70124642c4ad155f098e95cc518e", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/a24dc0ec09ce70124642c4ad155f098e95cc518e", "committedDate": "2020-08-05T02:21:35Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}, "afterCommit": {"oid": "1494573ebc40677a30c4baa5f8055c2b13ba2d6a", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/1494573ebc40677a30c4baa5f8055c2b13ba2d6a", "committedDate": "2020-08-05T18:10:59Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\n Rebasing and resolving conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzUyMDM3", "url": "https://github.com/apache/pinot/pull/5808#pullrequestreview-462752037", "createdAt": "2020-08-06T17:57:24Z", "commit": {"oid": "1494573ebc40677a30c4baa5f8055c2b13ba2d6a"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzo1NzoyNFrOG8-U7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzo1ODo1MVrOG8-YNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU4ODkwOA==", "bodyText": "why these resources are not moved to RootResource\uff1f", "url": "https://github.com/apache/pinot/pull/5808#discussion_r466588908", "createdAt": "2020-08-06T17:57:24Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/ThirdEyeDashboardApplication.java", "diffHunk": "@@ -139,36 +114,11 @@ public void run(ThirdEyeDashboardConfiguration config, Environment env)\n     final JerseyEnvironment jersey = env.jersey();\n     injector = Guice.createInjector(new ThirdEyeDashboardModule(config, env, DAO_REGISTRY));\n     Stream.of(\n-        DetectionConfigurationResource.class,\n-        DatasetAutoOnboardResource.class,\n-        DashboardResource.class,\n-        CacheResource.class,\n         AnomalyResource.class,\n-        EntityManagerResource.class,\n-        MetricConfigResource.class,\n-        DatasetConfigResource.class,\n-        AdminResource.class,\n-        SummaryResource.class,\n-        ThirdEyeResource.class,\n-        DataResource.class,\n-        AnomaliesResource.class,\n-        EntityMappingResource.class,\n-        OnboardDatasetMetricResource.class,\n-        AutoOnboardResource.class,\n-        ConfigResource.class,\n-        CustomizedEventResource.class,\n-        AnomalyFlattenResource.class,\n-        UserDashboardResource.class,\n-        ApplicationResource.class,\n-        DetectionResource.class,\n-        DetectionAlertResource.class,\n-        YamlResource.class,\n-        SqlDataSourceResource.class,\n-        AlertResource.class,\n-        RootCauseTemplateResource.class,\n-        RootCauseSessionResource.class,\n         RootCauseMetricResource.class,\n-        AnomalySearchResource.class\n+        RootCauseSessionResource.class,\n+        RootCauseTemplateResource.class,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1494573ebc40677a30c4baa5f8055c2b13ba2d6a"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU4OTc0OQ==", "bodyText": "Swagger isn't working if the resources are put under this class.", "url": "https://github.com/apache/pinot/pull/5808#discussion_r466589749", "createdAt": "2020-08-06T17:58:51Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/RootResource.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ *\n+ */\n+\n+package org.apache.pinot.thirdeye.dashboard.resources;\n+\n+import com.google.inject.Inject;\n+import javax.ws.rs.Path;\n+import org.apache.pinot.thirdeye.api.application.ApplicationResource;\n+import org.apache.pinot.thirdeye.api.user.dashboard.UserDashboardResource;\n+import org.apache.pinot.thirdeye.dashboard.resources.v2.AnomaliesResource;\n+import org.apache.pinot.thirdeye.dashboard.resources.v2.ConfigResource;\n+import org.apache.pinot.thirdeye.dashboard.resources.v2.DataResource;\n+import org.apache.pinot.thirdeye.dashboard.resources.v2.DetectionAlertResource;\n+import org.apache.pinot.thirdeye.dashboard.resources.v2.alerts.AlertResource;\n+import org.apache.pinot.thirdeye.dataset.DatasetAutoOnboardResource;\n+import org.apache.pinot.thirdeye.datasource.sql.resources.SqlDataSourceResource;\n+import org.apache.pinot.thirdeye.detection.DetectionResource;\n+import org.apache.pinot.thirdeye.detection.yaml.YamlResource;\n+\n+/**\n+ * This is the Jersey root endpoint \"/\"\n+ * All child endpoints should be registered here with method level @Path annotations.\n+ *\n+ */\n+@Path(\"/\")\n+public class RootResource {\n+\n+  private final AlertResource alertResource;\n+  private final AdminResource adminResource;\n+  private final AnomaliesResource anomaliesResource;\n+  private final ApplicationResource applicationResource;\n+  private final AutoOnboardResource autoOnboardResource;\n+  private final CacheResource cacheResource;\n+  private final ConfigResource configResource;\n+  private final CustomizedEventResource customizedEventResource;\n+  private final DashboardResource dashboardResource;\n+  private final DataResource dataResource;\n+  private final DatasetAutoOnboardResource datasetAutoOnboardResource;\n+  private final DetectionResource detectionResource;\n+  private final DetectionAlertResource detectionAlertResource;\n+  private final EntityMappingResource entityMappingResource;\n+  private final OnboardDatasetMetricResource onboardDatasetMetricResource;\n+  private final SqlDataSourceResource sqlDataSourceResource;\n+  private final ThirdEyeResource thirdEyeResource;\n+  private final UserDashboardResource userDashboardResource;\n+  private final YamlResource yamlResource;\n+\n+  @Inject\n+  public RootResource(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1494573ebc40677a30c4baa5f8055c2b13ba2d6a"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTAzMDA1", "url": "https://github.com/apache/pinot/pull/5808#pullrequestreview-462903005", "createdAt": "2020-08-06T21:55:02Z", "commit": {"oid": "33e62ce8f6dfe8e146003fdaa68f0a411a64c3a8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTo1NTowM1rOG9Fjaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTo1NTowM1rOG9Fjaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcwNzMwNw==", "bodyText": "it seems this one - AnomalySearchResource  is not added to the RootResource.", "url": "https://github.com/apache/pinot/pull/5808#discussion_r466707307", "createdAt": "2020-08-06T21:55:03Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/ThirdEyeDashboardApplication.java", "diffHunk": "@@ -139,36 +114,11 @@ public void run(ThirdEyeDashboardConfiguration config, Environment env)\n     final JerseyEnvironment jersey = env.jersey();\n     injector = Guice.createInjector(new ThirdEyeDashboardModule(config, env, DAO_REGISTRY));\n     Stream.of(\n-        DetectionConfigurationResource.class,\n-        DatasetAutoOnboardResource.class,\n-        DashboardResource.class,\n-        CacheResource.class,\n         AnomalyResource.class,\n-        EntityManagerResource.class,\n-        MetricConfigResource.class,\n-        DatasetConfigResource.class,\n-        AdminResource.class,\n-        SummaryResource.class,\n-        ThirdEyeResource.class,\n-        DataResource.class,\n-        AnomaliesResource.class,\n-        EntityMappingResource.class,\n-        OnboardDatasetMetricResource.class,\n-        AutoOnboardResource.class,\n-        ConfigResource.class,\n-        CustomizedEventResource.class,\n-        AnomalyFlattenResource.class,\n-        UserDashboardResource.class,\n-        ApplicationResource.class,\n-        DetectionResource.class,\n-        DetectionAlertResource.class,\n-        YamlResource.class,\n-        SqlDataSourceResource.class,\n-        AlertResource.class,\n-        RootCauseTemplateResource.class,\n-        RootCauseSessionResource.class,\n         RootCauseMetricResource.class,\n-        AnomalySearchResource.class", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33e62ce8f6dfe8e146003fdaa68f0a411a64c3a8"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzAxNTA5", "url": "https://github.com/apache/pinot/pull/5808#pullrequestreview-463701509", "createdAt": "2020-08-08T00:48:48Z", "commit": {"oid": "b9afd4638e48d31d847b5bd72403a20a5ceb5d55"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MzU1NDA1", "url": "https://github.com/apache/pinot/pull/5808#pullrequestreview-465355405", "createdAt": "2020-08-11T19:13:43Z", "commit": {"oid": "b9afd4638e48d31d847b5bd72403a20a5ceb5d55"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a5e31c81a595f7f52e086ea01ed98a5026faf0a", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/5a5e31c81a595f7f52e086ea01ed98a5026faf0a", "committedDate": "2020-08-11T19:30:12Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8594eac7001a836be97572a00607a27281dac347", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/8594eac7001a836be97572a00607a27281dac347", "committedDate": "2020-08-11T19:30:12Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6135752d8810f7470ded98d487e694849b0bea5", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/f6135752d8810f7470ded98d487e694849b0bea5", "committedDate": "2020-08-11T19:30:12Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d0128fe00d4da9e2b8f3fd5ea98302cf1d2f3b7", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/3d0128fe00d4da9e2b8f3fd5ea98302cf1d2f3b7", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52c33c4c61d763ab8863ede70447dc6e5f2c995f", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/52c33c4c61d763ab8863ede70447dc6e5f2c995f", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13a426f9dee3e5b7de70e6c13a5ad26bccf60c49", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/13a426f9dee3e5b7de70e6c13a5ad26bccf60c49", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dedf83b5880f7dfa1bbf66595361e1cff582229b", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/dedf83b5880f7dfa1bbf66595361e1cff582229b", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\n Rebasing and resolving conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c768cd6e12642a80898bf8a2915c9356f7e8316d", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/c768cd6e12642a80898bf8a2915c9356f7e8316d", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nFixed Swagger Documentation for RootResource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2939b7feeb5ba9ff1f502ba9b6a29aebba85727", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/a2939b7feeb5ba9ff1f502ba9b6a29aebba85727", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nApplied @Singleton to all resource classes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddd0e9e4b94a89fc131d6e1d36b0e7e62b264a59", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/ddd0e9e4b94a89fc131d6e1d36b0e7e62b264a59", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nAdded AnomalySearchResource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd6d2fab14e9d8dbc5b86e4095710d1d581ce2c9", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/fd6d2fab14e9d8dbc5b86e4095710d1d581ce2c9", "committedDate": "2020-08-11T19:30:43Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nFixed RCA requests. Jersey throws 404.\nDashboardResource and AnomalyResource are both tagged with @Path(\"dashboard\") which confuses jersey"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a205584bb96164b87897923ca01b7b2d08c4d5f", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/2a205584bb96164b87897923ca01b7b2d08c4d5f", "committedDate": "2020-08-11T19:33:56Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nResolved conflicts. Added AnomalyDetectionResource path to RootResource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9afd4638e48d31d847b5bd72403a20a5ceb5d55", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/b9afd4638e48d31d847b5bd72403a20a5ceb5d55", "committedDate": "2020-08-08T00:31:25Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nFixed RCA requests. Jersey throws 404.\nDashboardResource and AnomalyResource are both tagged with @Path(\"dashboard\") which confuses jersey"}, "afterCommit": {"oid": "2a205584bb96164b87897923ca01b7b2d08c4d5f", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/2a205584bb96164b87897923ca01b7b2d08c4d5f", "committedDate": "2020-08-11T19:33:56Z", "message": "[TE] Dashboard Resource Refactor\n\nThis change refactors the resource classes.\n - Created a RootResource to hold the \"/\" namespace\n - Most dependencies have been moved to this resource simplifying the DashboardServer\n\nResolved conflicts. Added AnomalyDetectionResource path to RootResource"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 128, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}