{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NzE2NzE5", "number": 6387, "title": "Allow multiple H3 index resolutions", "bodyText": "Part of #5280\nEncode the index resolutions (which can be multiple) in two bytes, and save them in the index header. This allows multiple H3 index resolution creation in the index.", "createdAt": "2020-12-26T17:24:19Z", "url": "https://github.com/apache/pinot/pull/6387", "merged": true, "mergeCommit": {"oid": "e71f01a5ad3ccf068c847be6e114f1ac55127ee6"}, "closed": true, "closedAt": "2020-12-26T19:10:23Z", "author": {"login": "yupeng9"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpN89mgH2gAyNTQ1NzE2NzE5OjYyZGM4OTAyYjBkODg0OGE5NjBiOWQzYzAxZmM0ZjdlYjg0Mzg2Mzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdqAczfgH2gAyNTQ1NzE2NzE5OjA5OWRhOWUxMjg5MjU3MDk1YWY4Y2I3MDk4OTcxN2Q4MGJhMTA3NzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "62dc8902b0d8848a960b9d3c01fc4f7eb8438638", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/62dc8902b0d8848a960b9d3c01fc4f7eb8438638", "committedDate": "2020-12-24T06:43:29Z", "message": "local change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a2b8f5d42e8de612d1226ea824ab01e713ac8cd", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/6a2b8f5d42e8de612d1226ea824ab01e713ac8cd", "committedDate": "2020-12-26T17:19:09Z", "message": "Update the h3 index creation to write the resolution(s)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/af8fa078d7f99b561ec21cc284a21a463cdf47a8", "committedDate": "2020-12-26T17:24:00Z", "message": "temp change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODgzODYx", "url": "https://github.com/apache/pinot/pull/6387#pullrequestreview-558883861", "createdAt": "2020-12-26T17:28:01Z", "commit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNzoyODowMlrOILlHHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNzoyODowMlrOILlHHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAxMzI3OQ==", "bodyText": "make it int", "url": "https://github.com/apache/pinot/pull/6387#discussion_r549013279", "createdAt": "2020-12-26T17:28:02Z", "author": {"login": "kishoreg"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/segment/creator/impl/geospatial/H3IndexResolution.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package org.apache.pinot.core.segment.creator.impl.geospatial;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+\n+/**\n+ * Stores the resolutions for an index. There are in total of H3 resolutions https://h3geo.org/#/documentation/core-library/resolution-table\n+ * To efficiently serialize the resolutions, we use two bytes for encoding th enabled resolutions. The resolution level\n+ * maps to the corresponding bit.\n+ */\n+public class H3IndexResolution {\n+  private short _resolutions;\n+\n+  public H3IndexResolution(List<Integer> resolutions) {\n+    for (int resolution : resolutions) {\n+      _resolutions |= 1 << resolution;\n+    }\n+  }\n+\n+  /**\n+   * Creates the resolutions with the serialized short value\n+   * @param resolutions\n+   */\n+  public H3IndexResolution(short resolutions) {\n+    _resolutions = resolutions;\n+  }\n+\n+  /**\n+   * @return the encoding of the resolutions into a short value (two bytes)\n+   */\n+  public short serialize() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4ODgzODcz", "url": "https://github.com/apache/pinot/pull/6387#pullrequestreview-558883873", "createdAt": "2020-12-26T17:28:26Z", "commit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNzoyODoyNlrOILlHSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNlQxNzoyOTowOVrOILlHfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAxMzMyMw==", "bodyText": "use INT", "url": "https://github.com/apache/pinot/pull/6387#discussion_r549013323", "createdAt": "2020-12-26T17:28:26Z", "author": {"login": "kishoreg"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/segment/creator/impl/geospatial/H3IndexResolution.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package org.apache.pinot.core.segment.creator.impl.geospatial;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+\n+/**\n+ * Stores the resolutions for an index. There are in total of H3 resolutions https://h3geo.org/#/documentation/core-library/resolution-table\n+ * To efficiently serialize the resolutions, we use two bytes for encoding th enabled resolutions. The resolution level\n+ * maps to the corresponding bit.\n+ */\n+public class H3IndexResolution {\n+  private short _resolutions;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAxMzM3Mg==", "bodyText": "why size, we should write the serialized INT right?", "url": "https://github.com/apache/pinot/pull/6387#discussion_r549013372", "createdAt": "2020-12-26T17:29:09Z", "author": {"login": "kishoreg"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/segment/creator/impl/geospatial/H3IndexCreator.java", "diffHunk": "@@ -172,6 +175,7 @@ public void seal()\n     //write header file\n     headerStream.writeInt(VERSION);\n     headerStream.writeInt(writer.getNumUniqueIds());\n+    headerStream.writeShort(_resolution.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af8fa078d7f99b561ec21cc284a21a463cdf47a8"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "099da9e1289257095af8cb70989717d80ba10776", "author": {"user": {"login": "yupeng9", "name": "Yupeng Fu"}}, "url": "https://github.com/apache/pinot/commit/099da9e1289257095af8cb70989717d80ba10776", "committedDate": "2020-12-26T17:33:31Z", "message": "bug fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1699, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}