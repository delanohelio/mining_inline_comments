{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMzYwMzc2", "number": 5794, "title": "[TE] make rca insights in email resilient to issues in rca response", "bodyText": "Added a version 2 of cube api that returns a map rather than a string. /summary/autoDimensionOrder/v2\nAdded a safeguard in the notification pipeline that doesn't fail the anomaly notification if the rca api has errors.", "createdAt": "2020-08-03T19:39:19Z", "url": "https://github.com/apache/pinot/pull/5794", "merged": true, "mergeCommit": {"oid": "7cc75adb7102e41e36208f02486b4127e098923b"}, "closed": true, "closedAt": "2020-08-04T19:24:42Z", "author": {"login": "akshayrai"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7XVo8AH2gAyNDYyMzYwMzc2OmRiZWMwYmFmNjQ2MDYwOWFlOTk4MDYzODNkYjVhZDM4ZWZkZDZiNDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7rU78AFqTQ2MTA4MjkyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dbec0baf6460609ae99806383db5ad38efdd6b43", "author": {"user": {"login": "akshayrai", "name": "Akshay Rai"}}, "url": "https://github.com/apache/pinot/commit/dbec0baf6460609ae99806383db5ad38efdd6b43", "committedDate": "2020-08-03T19:39:04Z", "message": "[TE] make rca insights in email resilient to issues in rca response"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e0b9fc5c9cf7cbe612b9616f4e43b1a84e4968e9", "author": {"user": {"login": "akshayrai", "name": "Akshay Rai"}}, "url": "https://github.com/apache/pinot/commit/e0b9fc5c9cf7cbe612b9616f4e43b1a84e4968e9", "committedDate": "2020-08-03T00:27:50Z", "message": "[TE] make rca insights in email resilient to issues in rca response"}, "afterCommit": {"oid": "dbec0baf6460609ae99806383db5ad38efdd6b43", "author": {"user": {"login": "akshayrai", "name": "Akshay Rai"}}, "url": "https://github.com/apache/pinot/commit/dbec0baf6460609ae99806383db5ad38efdd6b43", "committedDate": "2020-08-03T19:39:04Z", "message": "[TE] make rca insights in email resilient to issues in rca response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzYyOTk2", "url": "https://github.com/apache/pinot/pull/5794#pullrequestreview-460362996", "createdAt": "2020-08-03T21:48:15Z", "commit": {"oid": "dbec0baf6460609ae99806383db5ad38efdd6b43"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d1b0c1a9b3d5d5eba9fca49488146585e816c6a", "author": {"user": {"login": "akshayrai", "name": "Akshay Rai"}}, "url": "https://github.com/apache/pinot/commit/9d1b0c1a9b3d5d5eba9fca49488146585e816c6a", "committedDate": "2020-08-04T18:18:09Z", "message": "remove h2 bin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMDc5MjUz", "url": "https://github.com/apache/pinot/pull/5794#pullrequestreview-461079253", "createdAt": "2020-08-04T18:50:44Z", "commit": {"oid": "9d1b0c1a9b3d5d5eba9fca49488146585e816c6a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo1MDo0NFrOG7tJNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo1MDo0NFrOG7tJNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1ODgwNw==", "bodyText": "Just want to confirm that we still need this method. Should the HTTP framework automatically convert Map<String, Object> to JSON?", "url": "https://github.com/apache/pinot/pull/5794#discussion_r465258807", "createdAt": "2020-08-04T18:50:44Z", "author": {"login": "vincentchenjl"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/SummaryResource.java", "diffHunk": "@@ -172,6 +158,57 @@ public String buildSummary(\n         response = SummaryResponse.buildNotAvailableResponse(datasetName, metricName);\n       }\n     }\n+\n+    return response;\n+  }\n+\n+  @GET\n+  @Path(value = \"/summary/autoDimensionOrder/v2\")\n+  @Produces(MediaType.APPLICATION_JSON)\n+  public Map<String, Object> getDataCubeSummary(\n+      @QueryParam(METRIC_URN) String metricUrn,\n+      @QueryParam(\"dataset\") String dataset,\n+      @QueryParam(\"metric\") String metric,\n+      @QueryParam(CURRENT_START) long currentStartInclusive,\n+      @QueryParam(CURRENT_END) long currentEndExclusive,\n+      @QueryParam(BASELINE_START) long baselineStartInclusive,\n+      @QueryParam(BASELINE_END) long baselineEndExclusive,\n+      @QueryParam(\"dimensions\") String groupByDimensions,\n+      @QueryParam(\"filters\") String filterJsonPayload,\n+      @QueryParam(CUBE_SUMMARY_SIZE) int summarySize,\n+      @QueryParam(CUBE_DEPTH) @DefaultValue(DEFAULT_DEPTH) int depth,\n+      @QueryParam(CUBE_DIM_HIERARCHIES) @DefaultValue(DEFAULT_HIERARCHIES) String hierarchiesPayload,\n+      @QueryParam(CUBE_ONE_SIDE_ERROR) @DefaultValue(DEFAULT_ONE_SIDE_ERROR) boolean doOneSideError,\n+      @QueryParam(CUBE_EXCLUDED_DIMENSIONS) @DefaultValue(DEFAULT_EXCLUDED_DIMENSIONS) String excludedDimensions,\n+      @QueryParam(TIME_ZONE) @DefaultValue(DEFAULT_TIMEZONE_ID) String timeZone) throws Exception {\n+    SummaryResponse response = buildDataCubeSummary(metricUrn, metric, dataset, currentStartInclusive, currentEndExclusive, baselineStartInclusive,\n+        baselineEndExclusive, groupByDimensions, filterJsonPayload, summarySize, depth, hierarchiesPayload,\n+        doOneSideError, excludedDimensions, timeZone);\n+    return OBJECT_MAPPER.convertValue(response, Map.class);\n+  }\n+\n+  @GET\n+  @Path(value = \"/summary/autoDimensionOrder\")\n+  @Produces(MediaType.APPLICATION_JSON)\n+  public String buildSummary(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d1b0c1a9b3d5d5eba9fca49488146585e816c6a"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMDgyOTIz", "url": "https://github.com/apache/pinot/pull/5794#pullrequestreview-461082923", "createdAt": "2020-08-04T18:56:24Z", "commit": {"oid": "9d1b0c1a9b3d5d5eba9fca49488146585e816c6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 541, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}