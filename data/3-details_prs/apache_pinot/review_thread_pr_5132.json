{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1ODgwNjky", "number": 5132, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMDoyNTozN1rODukruw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMDoyNTozN1rODukruw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMTYyMTA3OnYy", "diffSide": "RIGHT", "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/DocIdSetOperator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMDoyNTozN1rOGAn6Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMjoyNzoxM1rOGArfgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMwNzA4Ng==", "bodyText": "this was needed rt. @fx19880617", "url": "https://github.com/apache/pinot/pull/5132#discussion_r403307086", "createdAt": "2020-04-03T20:25:37Z", "author": {"login": "kishoreg"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/DocIdSetOperator.java", "diffHunk": "@@ -36,30 +35,20 @@\n public class DocIdSetOperator extends BaseOperator<DocIdSetBlock> {\n   private static final String OPERATOR_NAME = \"DocIdSetOperator\";\n \n-  private static final ThreadLocal<int[]> THREAD_LOCAL_DOC_IDS = new ThreadLocal<int[]>() {\n-    @Override\n-    protected int[] initialValue() {\n-      return new int[DocIdSetPlanNode.MAX_DOC_PER_CALL];\n-    }\n-  };\n+  private static final ThreadLocal<int[]> THREAD_LOCAL_DOC_IDS =\n+      ThreadLocal.withInitial(() -> new int[DocIdSetPlanNode.MAX_DOC_PER_CALL]);\n \n   private final BaseFilterOperator _filterOperator;\n   private final int _maxSizeOfDocIdSet;\n \n   private FilterBlockDocIdSet _filterBlockDocIdSet;\n   private BlockDocIdIterator _blockDocIdIterator;\n   private int _currentDocId = 0;\n-  private boolean _threadLocal = true;\n-\n-  public DocIdSetOperator(@Nonnull BaseFilterOperator filterOperator, int maxSizeOfDocIdSet) {\n-    this(filterOperator, maxSizeOfDocIdSet, true);\n-  }\n \n-  public DocIdSetOperator(@Nonnull BaseFilterOperator filterOperator, int maxSizeOfDocIdSet, boolean threadLocal) {\n+  public DocIdSetOperator(BaseFilterOperator filterOperator, int maxSizeOfDocIdSet) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aaa35faf69d6e14e4506b4d8b7d3ca2249584ce7"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM2NTc2MA==", "bodyText": "This is good.\nThe DocIdSet creation logic is moved outside.\nSee https://github.com/apache/incubator-pinot/pull/5132/files#diff-48213157488bdb6aa43c2f6da8d2a940R131", "url": "https://github.com/apache/pinot/pull/5132#discussion_r403365760", "createdAt": "2020-04-03T22:27:13Z", "author": {"login": "xiangfu0"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/operator/DocIdSetOperator.java", "diffHunk": "@@ -36,30 +35,20 @@\n public class DocIdSetOperator extends BaseOperator<DocIdSetBlock> {\n   private static final String OPERATOR_NAME = \"DocIdSetOperator\";\n \n-  private static final ThreadLocal<int[]> THREAD_LOCAL_DOC_IDS = new ThreadLocal<int[]>() {\n-    @Override\n-    protected int[] initialValue() {\n-      return new int[DocIdSetPlanNode.MAX_DOC_PER_CALL];\n-    }\n-  };\n+  private static final ThreadLocal<int[]> THREAD_LOCAL_DOC_IDS =\n+      ThreadLocal.withInitial(() -> new int[DocIdSetPlanNode.MAX_DOC_PER_CALL]);\n \n   private final BaseFilterOperator _filterOperator;\n   private final int _maxSizeOfDocIdSet;\n \n   private FilterBlockDocIdSet _filterBlockDocIdSet;\n   private BlockDocIdIterator _blockDocIdIterator;\n   private int _currentDocId = 0;\n-  private boolean _threadLocal = true;\n-\n-  public DocIdSetOperator(@Nonnull BaseFilterOperator filterOperator, int maxSizeOfDocIdSet) {\n-    this(filterOperator, maxSizeOfDocIdSet, true);\n-  }\n \n-  public DocIdSetOperator(@Nonnull BaseFilterOperator filterOperator, int maxSizeOfDocIdSet, boolean threadLocal) {\n+  public DocIdSetOperator(BaseFilterOperator filterOperator, int maxSizeOfDocIdSet) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMwNzA4Ng=="}, "originalCommit": {"oid": "aaa35faf69d6e14e4506b4d8b7d3ca2249584ce7"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3507, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}