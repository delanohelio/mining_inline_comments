{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4OTg0NTk2", "number": 6032, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToxNDo0M1rOEkx1DQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToxNDo0M1rOEkx1DQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MDAwNTg5OnYy", "diffSide": "RIGHT", "path": "pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotLLCRealtimeSegmentManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToxNDo0M1rOHT6mYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMToyNzowMlrOHT6zUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY0NTA4OA==", "bodyText": "Consumption will stop if this condition hits. Are we sure that is what we want?", "url": "https://github.com/apache/pinot/pull/6032#discussion_r490645088", "createdAt": "2020-09-18T01:14:43Z", "author": {"login": "mcvsubbu"}, "path": "pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotLLCRealtimeSegmentManager.java", "diffHunk": "@@ -504,6 +504,8 @@ private LLCRealtimeSegmentZKMetadata updateCommittingSegmentZKMetadata(String re\n     committingSegmentZKMetadata.setDownloadUrl(isPeerURL(committingSegmentDescriptor.getSegmentLocation())\n         ? CommonConstants.Segment.METADATA_URI_FOR_PEER_DOWNLOAD : committingSegmentDescriptor.getSegmentLocation());\n     committingSegmentZKMetadata.setCrc(Long.valueOf(segmentMetadata.getCrc()));\n+    Preconditions.checkNotNull(segmentMetadata.getTimeInterval(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb5e34e47474d071e45e17a51535f55a26bc7395"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY0ODQwMw==", "bodyText": "@mcvsubbu This condition should not happen after the fix from #5966. When this happens, the realtime segment commit would anyway fail and the consumption would be stopped due to the null pointer exception. (egmentMetadata.getTimeInterval().getStartMillis() gets called at the following line). I'm just trying to add more information to the logs here since the log message was not informative when we hit that.\nWe recently saw the null pointer error issue (and the consumption actually stopped) when the time column is misconfigured.\n2020/09/17 20:36:52.666 ERROR [SegmentCompletionFSM_XXXXX__3__0__20200915T2142Z] [grizzly-http-server-3] [pinot-controller] [] Caught exception while committing segment metadata for segment: XXXXX__3__0__20200915T2142Z\njava.lang.NullPointerException: null", "url": "https://github.com/apache/pinot/pull/6032#discussion_r490648403", "createdAt": "2020-09-18T01:27:02Z", "author": {"login": "snleee"}, "path": "pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotLLCRealtimeSegmentManager.java", "diffHunk": "@@ -504,6 +504,8 @@ private LLCRealtimeSegmentZKMetadata updateCommittingSegmentZKMetadata(String re\n     committingSegmentZKMetadata.setDownloadUrl(isPeerURL(committingSegmentDescriptor.getSegmentLocation())\n         ? CommonConstants.Segment.METADATA_URI_FOR_PEER_DOWNLOAD : committingSegmentDescriptor.getSegmentLocation());\n     committingSegmentZKMetadata.setCrc(Long.valueOf(segmentMetadata.getCrc()));\n+    Preconditions.checkNotNull(segmentMetadata.getTimeInterval(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY0NTA4OA=="}, "originalCommit": {"oid": "cb5e34e47474d071e45e17a51535f55a26bc7395"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3901, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}