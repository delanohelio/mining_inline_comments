{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NDYzNjkw", "number": 6069, "title": "[Issue 6068] Fixing the calls to Helix to throw exception if zk conne\u2026", "bodyText": "\u2026ction is broken\nSee Issue #6068\nDescription\nAdd a description of your PR here.\nA good description should include pointers to an issue or design document, etc.\nUpgrade Notes\nDoes this PR prevent a zero down-time upgrade? (Assume upgrade order: Controller, Broker, Server, Minion)\n\n Yes (Please label as backward-incompat, and complete the section below on Release Notes)\n\nDoes this PR fix a zero-downtime upgrade introduced earlier?\n\n Yes (Please label this as backward-incompat, and complete the section below on Release Notes)\n\nDoes this PR otherwise need attention when creating release notes? Things to consider:\n\nNew configuration options\nDeprecation of configurations\nSignature changes to public methods/interfaces\nNew plugins added or old plugins removed\n\n\n Yes (Please label this PR as release-notes and complete the section on Release Notes)\n\nRelease Notes\nIf you have tagged this as either backward-incompat or release-notes,\nyou MUST add text here that you would like to see appear in release notes of the\nnext release.\nIf you have a series of commits adding or enabling a feature, then\nadd this section only in final commit that marks the feature completed.\nRefer to earlier release notes to see examples of text\nDocumentation\nIf you have introduced a new feature or configuration, please add it to the documentation as well.\nSee https://docs.pinot.apache.org/developers/developers-and-contributors/update-document", "createdAt": "2020-09-29T00:00:39Z", "url": "https://github.com/apache/pinot/pull/6069", "merged": true, "mergeCommit": {"oid": "24147dd5b7dc188e01af283bd0d025a6cec3527b"}, "closed": true, "closedAt": "2020-10-06T00:07:54Z", "author": {"login": "mcvsubbu"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNcnIWAH2gAyNDk0NDYzNjkwOjljY2MxY2QzNTBlNzU3YmI0YjY0OGU1OGMzMThhYTcyMTQ0MTJjNTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPomNNAFqTUwMjMzODc5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9ccc1cd350e757bb4b648e58c318aa7214412c52", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/9ccc1cd350e757bb4b648e58c318aa7214412c52", "committedDate": "2020-09-28T23:58:20Z", "message": "[Issue 6068] Fixing the calls to Helix to throw exception if zk connection is broken\n\nSee Issue #6068"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4MTE0NzE3", "url": "https://github.com/apache/pinot/pull/6069#pullrequestreview-498114717", "createdAt": "2020-09-29T05:53:10Z", "commit": {"oid": "9ccc1cd350e757bb4b648e58c318aa7214412c52"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a94f969a488f444c2614b39c0f36f493a27da66d", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/a94f969a488f444c2614b39c0f36f493a27da66d", "committedDate": "2020-10-04T18:31:01Z", "message": "Update zk metadata APIs to use timeout zk timeout\n\nThese APIs will ensure that if there is a zk disconnect\nwe will get an exception after a minimal number of retries.\nWe can change this to retry once and implement a backoff retry\nif needed later on.\n\nNote that the underlying helix library ends up calling the previous\nAPI (as yet), but we will upgrade to a helix version soon that actually\nimplements these"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7323688bd837f4c03e9a70ebfa6c1c4738ef0ea4", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/7323688bd837f4c03e9a70ebfa6c1c4738ef0ea4", "committedDate": "2020-10-05T18:27:42Z", "message": "Fixing a unit test mock call"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59d331600cf47ae3ded2a262b7c4abda0b890088", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/59d331600cf47ae3ded2a262b7c4abda0b890088", "committedDate": "2020-10-05T18:39:43Z", "message": "Updating more calls to getChildren"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMzM4Nzk4", "url": "https://github.com/apache/pinot/pull/6069#pullrequestreview-502338798", "createdAt": "2020-10-05T19:03:53Z", "commit": {"oid": "7323688bd837f4c03e9a70ebfa6c1c4738ef0ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTowMzo1M1rOHcp9qQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTowMzo1M1rOHcp9qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgwOTcwNQ==", "bodyText": "This won't take effect... Here is the Helix code for it (I would count it as a bug):\n  @Override\n  public List<T> getChildren(String parentPath, List<Stat> stats, int options, int retryCount,\n      int retryInterval) throws HelixException {\n    return getChildren(parentPath, stats, options);\n  }\n\nI don't see an easy way to throw exception for this API unless we create the children paths manually.", "url": "https://github.com/apache/pinot/pull/6069#discussion_r499809705", "createdAt": "2020-10-05T19:03:53Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java", "diffHunk": "@@ -305,7 +308,7 @@ public static Schema getTableSchema(@Nonnull ZkHelixPropertyStore<ZNRecord> prop\n       ZkHelixPropertyStore<ZNRecord> propertyStore, String tableName) {\n     String offlineTableName = TableNameBuilder.OFFLINE.tableNameWithType(tableName);\n     String parentPath = constructPropertyStorePathForResource(offlineTableName);\n-    List<ZNRecord> znRecords = propertyStore.getChildren(parentPath, null, AccessOption.PERSISTENT);\n+    List<ZNRecord> znRecords = propertyStore.getChildren(parentPath, null, AccessOption.PERSISTENT, ZK_OP_RETRY_COUNT, ZK_OP_RETRY_INTERVAL_MS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7323688bd837f4c03e9a70ebfa6c1c4738ef0ea4"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1488, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}