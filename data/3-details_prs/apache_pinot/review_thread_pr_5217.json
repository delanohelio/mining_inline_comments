{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMTM0NDM4", "number": 5217, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODoyMjowM1rODvr4iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTozNjowOFrODvwC1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzI4NjQ5OnYy", "diffSide": "RIGHT", "path": "pinot-common/src/test/resources/pql_queries.list", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODoyMjowM1rOGCQbZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NToyOFrOGCTuNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAxOTQ5NA==", "bodyText": "Should be TOP instead of LIMIT?", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405019494", "createdAt": "2020-04-07T18:22:03Z", "author": {"login": "mcvsubbu"}, "path": "pinot-common/src/test/resources/pql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzE1Ng==", "bodyText": "Correct. Thanks for catching", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405073156", "createdAt": "2020-04-07T19:54:59Z", "author": {"login": "siddharthteotia"}, "path": "pinot-common/src/test/resources/pql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAxOTQ5NA=="}, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzQ2MQ==", "bodyText": "done", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405073461", "createdAt": "2020-04-07T19:55:28Z", "author": {"login": "siddharthteotia"}, "path": "pinot-common/src/test/resources/pql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAxOTQ5NA=="}, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzI5NTcwOnYy", "diffSide": "RIGHT", "path": "pinot-common/src/test/resources/sql_queries.list", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODoyNDoyN1rOGCQhHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTo1NTozNlrOGCTufQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAyMDk1Ng==", "bodyText": "The equivalent SQL (preserving old behavior of the pql query) will be\nSELECT VALUEIN(mv_col, 10790, 16344), count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) ORDER BY count(*) DESC LIMIT 10\n\nAm I right?", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405020956", "createdAt": "2020-04-07T18:24:27Z", "author": {"login": "mcvsubbu"}, "path": "pinot-common/src/test/resources/sql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MDQ0Nw==", "bodyText": "Correct. I missed adding this here for parser test. But had added these earlier in query execution tests.", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405040447", "createdAt": "2020-04-07T18:56:34Z", "author": {"login": "siddharthteotia"}, "path": "pinot-common/src/test/resources/sql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAyMDk1Ng=="}, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA3MzUzMw==", "bodyText": "done", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405073533", "createdAt": "2020-04-07T19:55:36Z", "author": {"login": "siddharthteotia"}, "path": "pinot-common/src/test/resources/sql_queries.list", "diffHunk": "@@ -817,3 +817,19 @@ select COUNT(*) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKeys(mapField) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where DIV(numberOfGames,10) = 100\n select mapKey(mapField,k1) from baseballStats where mapKey(mapField,k1) = 'v1'\n+SELECT count(*) FROM Foo GROUP BY VALUEIN(mv_col, 10790, 16344) LIMIT 10", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAyMDk1Ng=="}, "originalCommit": {"oid": "00078951aad7f2f24947c2dfbbe411b658f48a83"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzk2ODIyOnYy", "diffSide": "RIGHT", "path": "pinot-core/src/test/java/org/apache/pinot/queries/InterSegmentAggregationMultiValueQueriesTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTozNjowOFrOGCXCjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTozNjowOFrOGCXCjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEyNzgyMA==", "bodyText": "It will be useful to have these numbers defined as key1, key2, value1, value2 ,etc. WIll make it easier to extend the test if we want to.", "url": "https://github.com/apache/pinot/pull/5217#discussion_r405127820", "createdAt": "2020-04-07T21:36:08Z", "author": {"login": "mcvsubbu"}, "path": "pinot-core/src/test/java/org/apache/pinot/queries/InterSegmentAggregationMultiValueQueriesTest.java", "diffHunk": "@@ -57,6 +60,82 @@ public void testCountMV() {\n     brokerResponse = getBrokerResponseForPqlQuery(query + MV_GROUP_BY);\n     QueriesTestUtils\n         .testInterSegmentAggregationResult(brokerResponse, 400000L, 0L, 800000L, 400000L, new String[]{\"199896\"});\n+\n+    query = \"SELECT COUNTMV(column6) FROM testTable GROUP BY VALUEIN(column7, 363, 469, 246, 100000)\";\n+    brokerResponse = getBrokerResponseForPqlQuery(query);\n+    List<String[]> groupKeys = new ArrayList<>();\n+    groupKeys.add(new String[]{\"363\"});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad52afa8294efc5715b5b9ffee22fcba2b689bd7"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3356, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}