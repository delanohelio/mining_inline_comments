{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MzA2NTk3", "number": 6005, "title": "Fix extract method in AvroRecordExtractor class", "bodyText": "Description\nThis PR fixes the extract method in AvroRecordExtractor class.\nWhen _extractAll is true, the generic record will be first converted to a json String and then parse to a json map, whereas json object has its precision limitation:\nhttps://developers.google.com/discovery/v1/type-format\nE.g. the column1 was originally of long type. But when it was converted to json string and then parse to a json map, the type would be changed to int. Thus, the actual value may be incorrect from the json map comparing to the actual value from generic record. Plus, since it changes the data type, it will have to trigger the convert method in DataTypeTransformer class, which will make confusion to detect schema mismatch.\nThis PR fixes it by fetching the actual value directly from the original generic record.", "createdAt": "2020-09-11T17:45:01Z", "url": "https://github.com/apache/pinot/pull/6005", "merged": true, "mergeCommit": {"oid": "cadd61c22ba04b83fca7f205e4c0aaae7bde09bc"}, "closed": true, "closedAt": "2020-09-12T22:02:32Z", "author": {"login": "jackjlli"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdH5EjYAH2gAyNDg1MzA2NTk3OmJmYjU5NTQ1Y2RkMTNlOTRmMzRjODgyYmU1NzlhZmQ5MTdmYmRkODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdH55-UgH2gAyNDg1MzA2NTk3OmMxOWZiMjI5YmU3YzU1N2FjY2IxNzVjODA0ODc3ZGY0YjBkZWZmNjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bfb59545cdd13e94f34c882be579afd917fbdd80", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/bfb59545cdd13e94f34c882be579afd917fbdd80", "committedDate": "2020-09-11T17:44:16Z", "message": "Fix extract method in AvroRecordExtractor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MDA2NzM0", "url": "https://github.com/apache/pinot/pull/6005#pullrequestreview-487006734", "createdAt": "2020-09-11T17:50:55Z", "commit": {"oid": "bfb59545cdd13e94f34c882be579afd917fbdd80"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MDI2MDI3", "url": "https://github.com/apache/pinot/pull/6005#pullrequestreview-487026027", "createdAt": "2020-09-11T18:20:44Z", "commit": {"oid": "bfb59545cdd13e94f34c882be579afd917fbdd80"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODoyMDo0NVrOHQpKiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODoyMDo0NVrOHQpKiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIxMzcwNQ==", "bodyText": "Suggest using the non-functional way for performance concern", "url": "https://github.com/apache/pinot/pull/6005#discussion_r487213705", "createdAt": "2020-09-11T18:20:45Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroRecordExtractor.java", "diffHunk": "@@ -46,14 +46,13 @@ public void init(Set<String> fields, @Nullable RecordExtractorConfig recordExtra\n   @Override\n   public GenericRow extract(GenericRecord from, GenericRow to) {\n     if (_extractAll) {\n-      Map<String, Object> jsonMap = JsonUtils.genericRecordToJson(from);\n-      jsonMap.forEach((fieldName, value) -> to.putValue(fieldName, AvroUtils.convert(value)));\n+      List<Schema.Field> fields = from.getSchema().getFields();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfb59545cdd13e94f34c882be579afd917fbdd80"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c19fb229be7c557accb175c804877df4b0deff69", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/c19fb229be7c557accb175c804877df4b0deff69", "committedDate": "2020-09-11T18:42:37Z", "message": "Address PR comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 18, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}