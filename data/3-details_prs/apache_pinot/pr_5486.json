{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2ODI2MTE3", "number": 5486, "title": "Changed the segment commit protocol to send/receive streamPartitionMs\u2026", "bodyText": "\u2026gOffset\nUpdated the segment commit protocol so that new element streamPartitionMsgOffset\nis populated in requests (as request parameters) and in response (as JSON string element)\nThe server side has been modified to send the 'streamPartitionMsgOffset' as well as we the\n'offset' parameters to the controller. The controller looks for and prefers streamPartitionMsgOffset\nbut falls back to offset if the streamPartitionMsgOffset is not there.\nThe controller side, in the repsonse message, populates both of the elements, and the server on\nthe receiver side does likewise -- preferring streamPartitionMsgOffset.\nAll callers into the protocol module have been modified to NOT set the offset field. Instead,\nonly set the streamPartitionMsgOffset field. The 'offset' value will be derived from\nstreamPartitionMsgOffset.\nAdded a test to make sure that the controller always generates both elements. Such a test was not\npossible in the server side at this time, so verified manually.\nManually ran LLCClusterIntergrationTest by disabling populating streamPartitionMsgOffset on the\nserver side (old server/new controller) and on the controller respons side (new server/old controller)\nIssue #5359\nDescription\nAdd a description of your PR here.\nA good description should include pointers to an issue or design document, etc.\nUpgrade Notes\nDoes this PR prevent a zero down-time upgrade? (Assume upgrade order: Controller, Broker, Server, Minion)\n\n Yes (Please label as backward-incompat, and complete the section below on Release Notes)\n\nDoes this PR fix a zero-downtime upgrade introduced earlier?\n\n Yes (Please label this as backward-incompat, and complete the section below on Release Notes)\n\nDoes this PR otherwise need attention when creating release notes? Things to consider:\n\nNew configuration options\nDeprecation of configurations\nSignature changes to public methods/interfaces\nNew plugins added or old plugins removed\n\n\n Yes (Please label this PR as release-notes and complete the section on Release Notes)\n\nRelease Notes\nIf you have tagged this as either backward-incompat or release-notes,\nyou MUST add text here that you would like to see appear in release notes of the\nnext release.\nIf you have a series of commits adding or enabling a feature, then\nadd this section only in final commit that marks the feature completed.\nRefer to earlier release notes to see examples of text\nDocumentation\nIf you have introduced a new feature or configuration, please add it to the documentation as well.\nSee https://docs.pinot.apache.org/developers/developers-and-contributors/update-document", "createdAt": "2020-06-02T20:58:02Z", "url": "https://github.com/apache/pinot/pull/5486", "merged": true, "mergeCommit": {"oid": "056c930c6e62bbcd4cd3e8c659e16e815532dc4c"}, "closed": true, "closedAt": "2020-06-03T20:01:25Z", "author": {"login": "mcvsubbu"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnbKIhAH2gAyNDI2ODI2MTE3OjcyMDFmYTY0MzViMzYyNWNkYmYwMjMzYmJmOGIwODJlOTUzZDQxY2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnsu19gH2gAyNDI2ODI2MTE3OjRmYmQ3Nzg1YTJjMzdiNzYzNDZhZWY2ODllMTFiNWM1ODA0NTkzYjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7201fa6435b3625cdbf0233bbf8b082e953d41cc", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/7201fa6435b3625cdbf0233bbf8b082e953d41cc", "committedDate": "2020-06-02T20:47:38Z", "message": "Changed the segment commit protocol to send/receive streamPartitionMsgOffset\n\nUpdated the segment commit protocol so that new element streamPartitionMsgOffset\nis populated in requests (as request parameters) and in response (as JSON string element)\n\nThe server side has been modified to send the 'streamPartitionMsgOffset' as well as we the\n'offset' parameters to the controller. The controller looks for and prefers streamPartitionMsgOffset\nbut falls back to offset if the streamPartitionMsgOffset is not there.\n\nThe controller side, in the repsonse message, populates both of the elements, and the server on\nthe receiver side does likewise -- preferring streamPartitionMsgOffset.\n\nAll callers into the protocol module have been modified to NOT set the offset field. Instead,\nonly set the streamPartitionMsgOffset field. The 'offset' value will be derived from\nstreamPartitionMsgOffset.\n\nAdded a test to make sure that the controller always generates both elements. Such a test was not\npossible in the server side at this time, so verified manually.\n\nManually ran LLCClusterIntergrationTest by disabling populating `streamPartitionMsgOffset` on the\nserver side (old server/new controller) and on the controller respons side (new server/old controller)\n\nIssue #5359"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzQ3MDg5", "url": "https://github.com/apache/pinot/pull/5486#pullrequestreview-423747089", "createdAt": "2020-06-03T16:49:51Z", "commit": {"oid": "7201fa6435b3625cdbf0233bbf8b082e953d41cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNjo0OTo1MVrOGekx0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNjo0OTo1MVrOGekx0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMzA0Mg==", "bodyText": "left these lines by mistake?", "url": "https://github.com/apache/pinot/pull/5486#discussion_r434713042", "createdAt": "2020-06-03T16:49:51Z", "author": {"login": "npawar"}, "path": "pinot-core/src/test/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManagerTest.java", "diffHunk": "@@ -481,6 +485,11 @@ public void testOnlineTransitionAfterStop()\n     }\n   }\n \n+  @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7201fa6435b3625cdbf0233bbf8b082e953d41cc"}, "originalPosition": 188}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzYzODcy", "url": "https://github.com/apache/pinot/pull/5486#pullrequestreview-423763872", "createdAt": "2020-06-03T17:11:48Z", "commit": {"oid": "7201fa6435b3625cdbf0233bbf8b082e953d41cc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fbd7785a2c37b76346aef689e11b5c5804593b2", "author": {"user": {"login": "mcvsubbu", "name": "Subbu Subramaniam"}}, "url": "https://github.com/apache/pinot/commit/4fbd7785a2c37b76346aef689e11b5c5804593b2", "committedDate": "2020-06-03T17:16:07Z", "message": "Addressed review comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 895, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}