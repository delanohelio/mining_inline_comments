{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NzIyNjM2", "number": 5207, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo0ODozOVrODuFbig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo1MzoxOFrODuFiaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NjUwMDU4OnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/health/DetectionTaskStatus.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo0ODozOVrOF_43OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzoyMDozMFrOGA8Z9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzNjI0OQ==", "bodyText": "We may need to keep the name, otherwise, the existing JSON blobs in the DB won't be able to deserialize back to the object.", "url": "https://github.com/apache/pinot/pull/5207#discussion_r402536249", "createdAt": "2020-04-02T18:48:39Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/health/DetectionTaskStatus.java", "diffHunk": "@@ -46,10 +46,14 @@\n \n   // the time stamp of last successfully finishing task\n   @JsonProperty\n-  private final Long lastTaskExecutionTime;\n+  private Long lastSuccessTaskExecutionTime;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0Mjg3MQ==", "bodyText": "Reverted.", "url": "https://github.com/apache/pinot/pull/5207#discussion_r403642871", "createdAt": "2020-04-05T03:20:30Z", "author": {"login": "xiaohui-sun"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/health/DetectionTaskStatus.java", "diffHunk": "@@ -46,10 +46,14 @@\n \n   // the time stamp of last successfully finishing task\n   @JsonProperty\n-  private final Long lastTaskExecutionTime;\n+  private Long lastSuccessTaskExecutionTime;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzNjI0OQ=="}, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NjUxODE2OnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/DetectionConfigBean.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo1MzoxOFrOF_5Cag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzoyMDo0N1rOGA8aAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzOTExNA==", "bodyText": "Shall we put this logic in MonitorTaskRunner where the detection health is updated?", "url": "https://github.com/apache/pinot/pull/5207#discussion_r402539114", "createdAt": "2020-04-02T18:53:18Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/DetectionConfigBean.java", "diffHunk": "@@ -162,6 +162,12 @@ public DetectionHealth getHealth() {\n   }\n \n   public void setHealth(DetectionHealth health) {\n+    // If there is no success execution in the current window then the last success task execution time would be -1L.\n+    // We should keep the original last success task execution time if we have.\n+    long lastSuccessTaskExecutionTime = this.health.getDetectionTaskStatus().getLastSuccessTaskExecutionTime();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0Mjg4Mg==", "bodyText": "Makes sense! I changed that. Can you review again? @jihaozh", "url": "https://github.com/apache/pinot/pull/5207#discussion_r403642882", "createdAt": "2020-04-05T03:20:47Z", "author": {"login": "xiaohui-sun"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/DetectionConfigBean.java", "diffHunk": "@@ -162,6 +162,12 @@ public DetectionHealth getHealth() {\n   }\n \n   public void setHealth(DetectionHealth health) {\n+    // If there is no success execution in the current window then the last success task execution time would be -1L.\n+    // We should keep the original last success task execution time if we have.\n+    long lastSuccessTaskExecutionTime = this.health.getDetectionTaskStatus().getLastSuccessTaskExecutionTime();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjUzOTExNA=="}, "originalCommit": {"oid": "a58cfdfe85f51a8f4fb90a0fd383d83bf6e14a6f"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3345, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}