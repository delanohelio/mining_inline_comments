{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NDk3Nzc1", "number": 6104, "title": "Add a property to set the s3 endpoint", "bodyText": "Description\nAllow the S3PinotFS endpoint to be set by a property.  This will allow me to configure Pinot to write to MinIO (s3 compatible interface) while running locally on my Minikube.\nE.g. if running Pinot and Minio on the same Minikube locally, we could run the following job spec.\nexecutionFrameworkSpec:\n    name: 'standalone'\n    segmentGenerationJobRunnerClassName: 'org.apache.pinot.plugin.ingestion.batch.standalone.SegmentGenerationJobRunner'\n    segmentTarPushJobRunnerClassName: 'org.apache.pinot.plugin.ingestion.batch.standalone.SegmentTarPushJobRunner'\n    segmentUriPushJobRunnerClassName: 'org.apache.pinot.plugin.ingestion.batch.standalone.SegmentUriPushJobRunner'\njobType: SegmentCreationAndTarPush\ninputDirURI: 's3://pinot-bucket/pinot-ingestion/batch-input/'\noutputDirURI: 's3://pinot-bucket/pinot-ingestion/batch-output/'\noverwriteOutput: true\npinotFSSpecs:\n    - scheme: s3\n      className: org.apache.pinot.plugin.filesystem.S3PinotFS\n      configs:\n        region: 'ap-southeast-1'\n        endpoint: 'http://minio:9000'\n        accessKey: 'YOUR_ACCESS_KEY'\n        secretKey: 'YOUR_SECRET_KEY'\nrecordReaderSpec:\n    dataFormat: 'csv'\n    className: 'org.apache.pinot.plugin.inputformat.csv.CSVRecordReader'\n    configClassName: 'org.apache.pinot.plugin.inputformat.csv.CSVRecordReaderConfig'\ntableSpec:\n    tableName: 'students'\npinotClusterSpecs:\n    - controllerURI: 'http://pinot-controller:9000'\n\nUpgrade Notes\nNo upgrade issues.  This is a new property and the default does not change the existing behavior.\nDoes this PR otherwise need attention when creating release notes? Things to consider:\n\nNew configuration options\n\n\n Yes (Please label this PR as release-notes and complete the section on Release Notes)\n\nRelease Notes\nAdded a new property to configure S3PinotFS's endpoint.  This can be used to use a local S3-compatible interface.\nDocumentation\nIf you have introduced a new feature or configuration, please add it to the documentation as well.\nSee https://docs.pinot.apache.org/developers/developers-and-contributors/update-document\nWe can update this section after this is merged.  I'm not sure if I have permission to do this.\nhttps://docs.pinot.apache.org/basics/data-import/pinot-file-system/amazon-s3", "createdAt": "2020-10-04T20:57:16Z", "url": "https://github.com/apache/pinot/pull/6104", "merged": true, "mergeCommit": {"oid": "e4d7a102a8bdfdafb4fad04dc9395239544dae79"}, "closed": true, "closedAt": "2020-10-05T07:07:39Z", "author": {"login": "danbosnichill"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPVfJ0AH2gAyNDk3NDk3Nzc1OmU5OWMyMDI0YWYxYmFmNDJlZDcwZWE3YjYyYTkwZGZkOGNhNzA2MGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPWMwwgFqTUwMTY2MTYwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e99c2024af1baf42ed70ea7b62a90dfd8ca7060e", "author": {"user": {"login": "danbosnichill", "name": null}}, "url": "https://github.com/apache/pinot/commit/e99c2024af1baf42ed70ea7b62a90dfd8ca7060e", "committedDate": "2020-10-04T20:48:08Z", "message": "Add a property to set the s3 endpoint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNjYxNDMy", "url": "https://github.com/apache/pinot/pull/6104#pullrequestreview-501661432", "createdAt": "2020-10-04T21:35:24Z", "commit": {"oid": "e99c2024af1baf42ed70ea7b62a90dfd8ca7060e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQyMTozNToyNFrOHcKUVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQyMTozNToyNFrOHcKUVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI5MTIyMQ==", "bodyText": "Just curious, does MinIO take region/awsCredentialProvider as parameters?", "url": "https://github.com/apache/pinot/pull/6104#discussion_r499291221", "createdAt": "2020-10-04T21:35:24Z", "author": {"login": "xiangfu0"}, "path": "pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java", "diffHunk": "@@ -93,7 +95,16 @@ public void init(PinotConfiguration config) {\n         awsCredentialsProvider = DefaultCredentialsProvider.create();\n       }\n \n-      _s3Client = S3Client.builder().region(Region.of(region)).credentialsProvider(awsCredentialsProvider).build();\n+      S3ClientBuilder s3ClientBuilder = S3Client.builder().region(Region.of(region)).credentialsProvider(awsCredentialsProvider);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e99c2024af1baf42ed70ea7b62a90dfd8ca7060e"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNjYxNjAw", "url": "https://github.com/apache/pinot/pull/6104#pullrequestreview-501661600", "createdAt": "2020-10-04T21:37:57Z", "commit": {"oid": "e99c2024af1baf42ed70ea7b62a90dfd8ca7060e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1532, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}