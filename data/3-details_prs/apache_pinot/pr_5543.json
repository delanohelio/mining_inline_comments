{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzMzY2MTU4", "number": 5543, "title": "Added configurable http listeners for controller API", "bodyText": "Description\nAdds support for additional Opt-In protocol listeners for http and https. See release note section for further details.\nUpgrade Notes\nThis PR does not introduce breaking changes. However, if using the new protocols property, it is possible to remove controller.port. Keeping controller.port during upgrade means an operator can easily rollback in case there is an issue with the new version of Pinot.\nRelease Notes\nIntroduces new properties for ControllerConf that allows dynamic configurations for the HttpServer listeners. These properties are opt-in and will not impact the existing controller.port and controller.host properties that are used to establish an helix identify.\n\ncontroller.access.protocols=<comma seperated protocols http/https>\ncontroller.access.protocols.<protocol>.port=9443\ncontroller.access.protocols.<protocol>.host=0.0.0.0\ncontroller.access.protocols.<protocol>.vip=false\ncontroller.access.protocols.https.tls.keystore.path=some-path\ncontroller.access.protocols.https.tls.keystore.password=pass\ncontroller.access.protocols.https.tls.requires_client_auth=false\ncontroller.access.protocols.https.tls.truststore.path=some-path\ncontroller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols. The host property of a defined protocol is intended to restrict the listener hostname to specific entries. This is useful to restrict the protocol usage to certain network adapter or public facing DNS hostname. This design intends for maximum flexibility and will default to 0.0.0.0 if nothing is provided.\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility. If at least one protocol is defined through controller.access.protcols, operators have the possibility to not use controller.port.\nDocumentation\npinot-contrib/pinot-docs#4", "createdAt": "2020-06-11T22:34:14Z", "url": "https://github.com/apache/pinot/pull/5543", "merged": true, "mergeCommit": {"oid": "0f586271068c7ba4e6ccce052479518e2c090908"}, "closed": true, "closedAt": "2020-06-20T02:50:46Z", "author": {"login": "daniellavoie"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqXQldAFqTQyOTM3MDkwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcs2yVSAFqTQzNDI0OTYyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MzcwOTAy", "url": "https://github.com/apache/pinot/pull/5543#pullrequestreview-429370902", "createdAt": "2020-06-11T23:56:49Z", "commit": {"oid": "533e7b0989540208dd0ad7dcd6d1fb3961f436a5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzo1Njo1MFrOGiyf9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMzo1Njo1MFrOGiyf9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEzMjE0OQ==", "bodyText": "Does it make sense to do something like:\ncontroller.access.protocol = \"http\" (or, \"https\", or \"http,https\")\nand then have specific configs for the protocol as:\ncontroller.access.protocol.<yourConfiguredProtocol>.<protocol-specific-config>\nThere is already a controller.host, so I suggest we just keep that to be the same, for existing cloud installations. Otherwise, they will need to specify the same host name in multiple places. The host name is either specified or inferred, there are not any other combinations of this.  We can then leave the logic in ControllerStarter.inferHostNameifNeeded() as it is instead of looking at 3 other settings?", "url": "https://github.com/apache/pinot/pull/5543#discussion_r439132149", "createdAt": "2020-06-11T23:56:50Z", "author": {"login": "mcvsubbu"}, "path": "pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java", "diffHunk": "@@ -29,21 +29,28 @@\n import org.apache.pinot.common.protocols.SegmentCompletionProtocol;\n import org.apache.pinot.common.utils.StringUtil;\n import org.apache.pinot.spi.filesystem.LocalPinotFS;\n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n \n import static org.apache.pinot.common.utils.CommonConstants.Controller.CONFIG_OF_CONTROLLER_METRICS_PREFIX;\n import static org.apache.pinot.common.utils.CommonConstants.Controller.DEFAULT_METRICS_PREFIX;\n \n \n public class ControllerConf extends PropertiesConfiguration {\n-  private static final Logger LOGGER = LoggerFactory.getLogger(ControllerConf.class);\n-\n   private static final String CONTROLLER_VIP_HOST = \"controller.vip.host\";\n   private static final String CONTROLLER_VIP_PORT = \"controller.vip.port\";\n   private static final String CONTROLLER_VIP_PROTOCOL = \"controller.vip.protocol\";\n   private static final String CONTROLLER_HOST = \"controller.host\";\n   private static final String CONTROLLER_PORT = \"controller.port\";\n+  private static final String CONTROLLER_HTTP_ENABLED = \"controller.http.enabled\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "533e7b0989540208dd0ad7dcd6d1fb3961f436a5"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "533e7b0989540208dd0ad7dcd6d1fb3961f436a5", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/533e7b0989540208dd0ad7dcd6d1fb3961f436a5", "committedDate": "2020-06-11T19:58:36Z", "message": "Added configurable http listeners for controller API\n\nIntroduction of new properties:\n  controller.http.enabled\n  controller.http.host\n  controller.http.port\n  controller.https.enabled\n  controller.https.host\n  controller.https.port\n  controller.https.tls.keystore.path\n  controller.https.tls.keystore.password\n  controller.https.tls.requires_client_auth\n  controller.https.tls.truststore.path\n  controller.https.tls.truststore.password\n\nIf the legacy controller.port is configured, the controller.http\nproperties will be ignored."}, "afterCommit": {"oid": "8636925d761a1e7249fa3ab7bb14f81a83cada75", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/8636925d761a1e7249fa3ab7bb14f81a83cada75", "committedDate": "2020-06-12T20:46:09Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8636925d761a1e7249fa3ab7bb14f81a83cada75", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/8636925d761a1e7249fa3ab7bb14f81a83cada75", "committedDate": "2020-06-12T20:46:09Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "fd1344541cc8309c1faad332921669475efde7d0", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/fd1344541cc8309c1faad332921669475efde7d0", "committedDate": "2020-06-12T21:20:11Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd1344541cc8309c1faad332921669475efde7d0", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/fd1344541cc8309c1faad332921669475efde7d0", "committedDate": "2020-06-12T21:20:11Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "ce7645953877de4830837f18f3471abe6b38f9a9", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/ce7645953877de4830837f18f3471abe6b38f9a9", "committedDate": "2020-06-13T01:02:26Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce7645953877de4830837f18f3471abe6b38f9a9", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/ce7645953877de4830837f18f3471abe6b38f9a9", "committedDate": "2020-06-13T01:02:26Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "40873c750dcf7d36a9758f906ca35edf6cf0f5c0", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/40873c750dcf7d36a9758f906ca35edf6cf0f5c0", "committedDate": "2020-06-13T12:33:11Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "40873c750dcf7d36a9758f906ca35edf6cf0f5c0", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/40873c750dcf7d36a9758f906ca35edf6cf0f5c0", "committedDate": "2020-06-13T12:33:11Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols http/https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.<protocol>.tls.keystore.path=some-path\n  controller.access.protocols.<protocol>.tls.keystore.password=pass\n  controller.access.protocols.<protocol>.tls.requires_client_auth=false\n  controller.access.protocols.<protocol>.tls.truststore.path=some-path\n  controller.access.protocols.<protocol>.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "7394e300418d3b8997991af81290a9ef705fcbbc", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/7394e300418d3b8997991af81290a9ef705fcbbc", "committedDate": "2020-06-13T12:51:48Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7394e300418d3b8997991af81290a9ef705fcbbc", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/7394e300418d3b8997991af81290a9ef705fcbbc", "committedDate": "2020-06-13T12:51:48Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "4c8610d3fd343cf2798846466e0e30de7994557a", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/4c8610d3fd343cf2798846466e0e30de7994557a", "committedDate": "2020-06-18T12:23:23Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c8610d3fd343cf2798846466e0e30de7994557a", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/4c8610d3fd343cf2798846466e0e30de7994557a", "committedDate": "2020-06-18T12:23:23Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "9204a8737be9ccd45c19600a872f2f82be0f5f0c", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/9204a8737be9ccd45c19600a872f2f82be0f5f0c", "committedDate": "2020-06-18T13:24:22Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNDc3MzYx", "url": "https://github.com/apache/pinot/pull/5543#pullrequestreview-433477361", "createdAt": "2020-06-18T16:59:45Z", "commit": {"oid": "9204a8737be9ccd45c19600a872f2f82be0f5f0c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjo1OTo0NVrOGl4RRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjo1OTo0NVrOGl4RRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM3MjQyMA==", "bodyText": "Good time to change this to _httpServer", "url": "https://github.com/apache/pinot/pull/5543#discussion_r442372420", "createdAt": "2020-06-18T16:59:45Z", "author": {"login": "mcvsubbu"}, "path": "pinot-controller/src/main/java/org/apache/pinot/controller/api/ControllerAdminApiApplication.java", "diffHunk": "@@ -18,73 +18,110 @@\n  */\n package org.apache.pinot.controller.api;\n \n-import com.google.common.base.Preconditions;\n-import io.swagger.jaxrs.config.BeanConfig;\n import java.io.IOException;\n import java.net.URI;\n import java.net.URL;\n import java.net.URLClassLoader;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n import javax.ws.rs.container.ContainerRequestContext;\n import javax.ws.rs.container.ContainerResponseContext;\n import javax.ws.rs.container.ContainerResponseFilter;\n+\n+import org.apache.pinot.controller.api.listeners.ListenerConfig;\n+import org.apache.pinot.controller.api.listeners.TlsConfiguration;\n import org.glassfish.grizzly.http.server.CLStaticHttpHandler;\n import org.glassfish.grizzly.http.server.HttpServer;\n+import org.glassfish.grizzly.http.server.NetworkListener;\n+import org.glassfish.grizzly.ssl.SSLContextConfigurator;\n+import org.glassfish.grizzly.ssl.SSLEngineConfigurator;\n import org.glassfish.hk2.utilities.binding.AbstractBinder;\n import org.glassfish.jersey.grizzly2.httpserver.GrizzlyHttpServerFactory;\n+import org.glassfish.jersey.internal.guava.ThreadFactoryBuilder;\n import org.glassfish.jersey.jackson.JacksonFeature;\n import org.glassfish.jersey.media.multipart.MultiPartFeature;\n+import org.glassfish.jersey.process.JerseyProcessingUncaughtExceptionHandler;\n import org.glassfish.jersey.server.ResourceConfig;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n+import com.google.common.base.Preconditions;\n+\n+import io.swagger.jaxrs.config.BeanConfig;\n+\n \n public class ControllerAdminApiApplication extends ResourceConfig {\n   private static final Logger LOGGER = LoggerFactory.getLogger(ControllerAdminApiApplication.class);\n \n   private HttpServer httpServer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9204a8737be9ccd45c19600a872f2f82be0f5f0c"}, "originalPosition": 42}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9204a8737be9ccd45c19600a872f2f82be0f5f0c", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/9204a8737be9ccd45c19600a872f2f82be0f5f0c", "committedDate": "2020-06-18T13:24:22Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "615b6e4c230b3b1c62379da94fb3d384b45e0826", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/615b6e4c230b3b1c62379da94fb3d384b45e0826", "committedDate": "2020-06-18T17:16:25Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNDk2MDAw", "url": "https://github.com/apache/pinot/pull/5543#pullrequestreview-433496000", "createdAt": "2020-06-18T17:24:19Z", "commit": {"oid": "615b6e4c230b3b1c62379da94fb3d384b45e0826"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "095921701237e756ebfb2829d82d144370187447", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/095921701237e756ebfb2829d82d144370187447", "committedDate": "2020-06-18T17:33:35Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "615b6e4c230b3b1c62379da94fb3d384b45e0826", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/615b6e4c230b3b1c62379da94fb3d384b45e0826", "committedDate": "2020-06-18T17:16:25Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}, "afterCommit": {"oid": "095921701237e756ebfb2829d82d144370187447", "author": {"user": {"login": "daniellavoie", "name": "Daniel Lavoie"}}, "url": "https://github.com/apache/pinot/commit/095921701237e756ebfb2829d82d144370187447", "committedDate": "2020-06-18T17:33:35Z", "message": "Added configurable Opt-In http listeners for controller API\n\nIntroduction of new properties:\n  controller.access.protocols=<comma seperated protocols eg: http,https>\n  controller.access.protocols.<protocol>.port=9443\n  controller.access.protocols.<protocol>.host=0.0.0.0\n  controller.access.protocols.<protocol>.vip=false\n  controller.access.protocols.https.tls.keystore.path=some-path\n  controller.access.protocols.https.tls.keystore.password=pass\n  controller.access.protocols.https.tls.requires_client_auth=false\n  controller.access.protocols.https.tls.truststore.path=some-path\n  controller.access.protocols.https.tls.truststore.password=pass\n\nOnly the 'port' property will be mandatory if a protocol is activated\nthrough controller.access.protcols\n\nThe existing 'controller.port property' is still expected by CLI. These\nnew properties are opt-in and can be activated with legacy\n'controller.port' for backward compatibility."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MjQ5NjIz", "url": "https://github.com/apache/pinot/pull/5543#pullrequestreview-434249623", "createdAt": "2020-06-19T17:48:36Z", "commit": {"oid": "095921701237e756ebfb2829d82d144370187447"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 585, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}