{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NTIzNDgz", "number": 5190, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo0NjoxM1rODszmUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNToyMDozN1rODs80MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MzA5MzMxOnYy", "diffSide": "RIGHT", "path": ".travis/.travis_nightly_build.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo0NjoxM1rOF93YZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDozNDoxNVrOF97JnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDgyMQ==", "bodyText": "This will work. Thank you for coming up with this solution. Dealing with versions is very painful in Maven + CI/CD without unreliable -SNAPSHOTs.\nCurious, where did you find inspiration on how achieve this version bumping?", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400414821", "createdAt": "2020-03-30T18:46:13Z", "author": {"login": "mockitoguy"}, "path": ".travis/.travis_nightly_build.sh", "diffHunk": "@@ -0,0 +1,31 @@\n+#!/bin/bash -x\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+if [ -n \"${DEPLOY_BUILD_OPTS}\" ]; then\n+  echo \"Deploying to bintray\"\n+\n+  BUILD_VERSION=$(grep -E \"<revision>(.*)</revision>\" pom.xml | cut -d'>' -f2 | cut -d'<' -f1)\n+  echo \"Current build version: $BUILD_VERSION${DEV_VERSION}\"\n+  mvn versions:set -DnewVersion=\"$BUILD_VERSION${DEV_VERSION}\" -q -B\n+  mvn versions:commit -q -B", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ3NjU3Mw==", "bodyText": "I tested it by uploading the generated jars without setting the version, while the bintray returns 409 conflicts when uploading the pom files. Then I feel that may be due the same checksum of the pom files that's already uploaded. Thus, bumping up version might be the option before publishing them.\nAnother obstacle I found here is that travis doesn't work well with mvn help:evaluate -Dexpression=revision -q -DforceStdout, which is used to fetch properties from pom file; it returns nothing.\nI've documented all the traps I met in that instruction.", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400476573", "createdAt": "2020-03-30T20:34:15Z", "author": {"login": "jackjlli"}, "path": ".travis/.travis_nightly_build.sh", "diffHunk": "@@ -0,0 +1,31 @@\n+#!/bin/bash -x\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+if [ -n \"${DEPLOY_BUILD_OPTS}\" ]; then\n+  echo \"Deploying to bintray\"\n+\n+  BUILD_VERSION=$(grep -E \"<revision>(.*)</revision>\" pom.xml | cut -d'>' -f2 | cut -d'<' -f1)\n+  echo \"Current build version: $BUILD_VERSION${DEV_VERSION}\"\n+  mvn versions:set -DnewVersion=\"$BUILD_VERSION${DEV_VERSION}\" -q -B\n+  mvn versions:commit -q -B", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDgyMQ=="}, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MzExMzgwOnYy", "diffSide": "RIGHT", "path": "pinot-broker/pom.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo1MTo0N1rOF93lOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo1MTo0N1rOF93lOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxODEwNg==", "bodyText": "Looks great!", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400418106", "createdAt": "2020-03-30T18:51:47Z", "author": {"login": "mockitoguy"}, "path": "pinot-broker/pom.xml", "diffHunk": "@@ -19,12 +19,14 @@\n     under the License.\n \n -->\n-<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n     <artifactId>pinot</artifactId>\n     <groupId>org.apache.pinot</groupId>\n-    <version>0.4.0-SNAPSHOT</version>\n+    <version>${revision}${sha1}</version>\n+    <relativePath>..</relativePath>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MzEyMjIwOnYy", "diffSide": "RIGHT", "path": ".travis/.travis_set_deploy_build_opts.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo1Mzo1NlrOF93qgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMToxMDo1MlrOF98WwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxOTQ1Ng==", "bodyText": "I asked @varidhigarg to verify if versions like 0.4.0-dev-1, 0.4.0-dev-2 will work with auto-ELR. We believe it should work so please don't block this PR on this verification - it should not be a blocker for merging this in. Thanks!!", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400419456", "createdAt": "2020-03-30T18:53:56Z", "author": {"login": "mockitoguy"}, "path": ".travis/.travis_set_deploy_build_opts.sh", "diffHunk": "@@ -0,0 +1,26 @@\n+#!/bin/bash -x\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+if [ \"$TRAVIS_EVENT_TYPE\" = \"cron\" ]; then\n+  export DEV_VERSION=\"-dev-${TRAVIS_BUILD_NUMBER}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ5NjMyMA==", "bodyText": "As long as the mavenmetadata.xml is updated with the latest version we are good to go.", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400496320", "createdAt": "2020-03-30T21:10:52Z", "author": {"login": "varidhigarg"}, "path": ".travis/.travis_set_deploy_build_opts.sh", "diffHunk": "@@ -0,0 +1,26 @@\n+#!/bin/bash -x\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#\n+\n+if [ \"$TRAVIS_EVENT_TYPE\" = \"cron\" ]; then\n+  export DEV_VERSION=\"-dev-${TRAVIS_BUILD_NUMBER}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxOTQ1Ng=="}, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NDYwMzM2OnYy", "diffSide": "RIGHT", "path": "pom.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNToyMDozN1rOF-Ft0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNTo1NDo0N1rOF-GUkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY0OTY4MQ==", "bodyText": "In this case, what will be the behavior of command mvn release how is version been updated there?", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400649681", "createdAt": "2020-03-31T05:20:37Z", "author": {"login": "xiangfu0"}, "path": "pom.xml", "diffHunk": "@@ -96,8 +97,18 @@\n   <!-- Apache project inception year for generating correct NOTICE file for jar bundle. -->\n   <inceptionYear>2018</inceptionYear>\n \n+  <distributionManagement>\n+    <repository>\n+      <id>bintray-linkedin-maven</id>\n+      <name>linkedin-maven</name>\n+      <url>https://api.bintray.com/maven/linkedin/maven/pinot/;publish=1</url>\n+    </repository>\n+  </distributionManagement>\n+\n   <properties>\n     <pinot.root>${basedir}</pinot.root>\n+    <revision>0.4.0</revision>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY1OTYwMg==", "bodyText": "Since now the version consists of revision and sha1, you can set the version number and then publish the release. An instruction can be found in the link below:\nhttps://techluminary.com/discard-maven-release-plugin-with-a-new-approach/", "url": "https://github.com/apache/pinot/pull/5190#discussion_r400659602", "createdAt": "2020-03-31T05:54:47Z", "author": {"login": "jackjlli"}, "path": "pom.xml", "diffHunk": "@@ -96,8 +97,18 @@\n   <!-- Apache project inception year for generating correct NOTICE file for jar bundle. -->\n   <inceptionYear>2018</inceptionYear>\n \n+  <distributionManagement>\n+    <repository>\n+      <id>bintray-linkedin-maven</id>\n+      <name>linkedin-maven</name>\n+      <url>https://api.bintray.com/maven/linkedin/maven/pinot/;publish=1</url>\n+    </repository>\n+  </distributionManagement>\n+\n   <properties>\n     <pinot.root>${basedir}</pinot.root>\n+    <revision>0.4.0</revision>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY0OTY4MQ=="}, "originalCommit": {"oid": "86c4c17b14acc70154f56ac9dff43b626dc411d1"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3332, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}