{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMzgyMDQy", "number": 5920, "title": "[TE] only merge same trend in ChildKeepingMerge", "bodyText": "This PR is to fix the issue that ChildKeepMergeWrapper merges anomalies with different trend. After this PR, the wrapper will only merge anomalies with same trend, e.g anomalies with UP trend, meaning current value higher than predicted value.", "createdAt": "2020-08-25T18:29:36Z", "url": "https://github.com/apache/pinot/pull/5920", "merged": true, "mergeCommit": {"oid": "2dbc94c201557e3bce5a3a944abac46c644c3cbd"}, "closed": true, "closedAt": "2020-09-03T17:18:34Z", "author": {"login": "vincentchenjl"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCbfH9gH2gAyNDczMzgyMDQyOjRlNjQ5MjI3YjE4NGY0YTAyZTk1M2ZlN2MxY2Q1ZTA4ZDYyYmMwZjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDcGJkAH2gAyNDczMzgyMDQyOjY4OWMwNWFmYTU2YTMwZTAyNzRhOGZhNDg2Y2FiZGNlMzk3ZGY2YjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4e649227b184f4a02e953fe7c1cd5e08d62bc0f8", "author": {"user": {"login": "vincentchenjl", "name": "Vincent Chen"}}, "url": "https://github.com/apache/pinot/commit/4e649227b184f4a02e953fe7c1cd5e08d62bc0f8", "committedDate": "2020-08-25T18:26:31Z", "message": "[TE] only merge same trend in ChildKeepingMerge"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0OTA1NjQ2", "url": "https://github.com/apache/pinot/pull/5920#pullrequestreview-474905646", "createdAt": "2020-08-25T21:10:26Z", "commit": {"oid": "4e649227b184f4a02e953fe7c1cd5e08d62bc0f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cfdc6202bdd9e652b127b6fd9750b4d3d4ef229", "author": {"user": {"login": "vincentchenjl", "name": "Vincent Chen"}}, "url": "https://github.com/apache/pinot/commit/7cfdc6202bdd9e652b127b6fd9750b4d3d4ef229", "committedDate": "2020-08-25T21:51:54Z", "message": "minor change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2MDc3NDMw", "url": "https://github.com/apache/pinot/pull/5920#pullrequestreview-476077430", "createdAt": "2020-08-26T23:21:44Z", "commit": {"oid": "7cfdc6202bdd9e652b127b6fd9750b4d3d4ef229"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzoyMTo0NFrOHHiT7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzoyMTo0NFrOHHiT7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY2NDIzOQ==", "bodyText": "some anomalies don't have the pattern key. in that case, should it be deducted from the current and the baseline?", "url": "https://github.com/apache/pinot/pull/5920#discussion_r477664239", "createdAt": "2020-08-26T23:21:44Z", "author": {"login": "jihaozh"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/wrapper/ChildKeepingMergeWrapper.java", "diffHunk": "@@ -91,10 +93,13 @@ public ChildKeepingMergeWrapper(DataProvider provider, DetectionConfigDTO config\n       if (anomaly.getProperties().containsKey(PROP_GROUP_KEY)) {\n         groupKey = anomaly.getProperties().get(PROP_GROUP_KEY);\n       }\n-\n+      String patternKey = \"\";\n+      if (anomaly.getProperties().containsKey(PROP_PATTERN_KEY)) {\n+        patternKey = anomaly.getProperties().get(PROP_PATTERN_KEY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cfdc6202bdd9e652b127b6fd9750b4d3d4ef229"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daaba4799edc0e1ec4dbf399a175d3b43fa38794", "author": {"user": {"login": "vincentchenjl", "name": "Vincent Chen"}}, "url": "https://github.com/apache/pinot/commit/daaba4799edc0e1ec4dbf399a175d3b43fa38794", "committedDate": "2020-08-27T20:56:05Z", "message": "handle anomaly without pattern key"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MDc4Nzg0", "url": "https://github.com/apache/pinot/pull/5920#pullrequestreview-477078784", "createdAt": "2020-08-27T21:02:19Z", "commit": {"oid": "daaba4799edc0e1ec4dbf399a175d3b43fa38794"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3ODg2OTU4", "url": "https://github.com/apache/pinot/pull/5920#pullrequestreview-477886958", "createdAt": "2020-08-28T16:58:03Z", "commit": {"oid": "daaba4799edc0e1ec4dbf399a175d3b43fa38794"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "689c05afa56a30e0274a8fa486cabdce397df6b6", "author": {"user": {"login": "vincentchenjl", "name": "Vincent Chen"}}, "url": "https://github.com/apache/pinot/commit/689c05afa56a30e0274a8fa486cabdce397df6b6", "committedDate": "2020-08-28T21:43:04Z", "message": "add one more test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 269, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}