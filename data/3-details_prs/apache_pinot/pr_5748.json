{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MDUwNzQz", "number": 5748, "title": "GROOVY transform function UDF for queries", "bodyText": "Description\nGROOVY transform function for query time.\nSyntax:\ngroovy('<return value metadata json string>', '<groovy script>', argument0, argument1, argument2...)\n\n\n1st argument is a json string representing all return value metadata. Example: {\"returnType\":\"INT\",\"isSingleValue\":true}\n2nd argument is the groovy expression. Use arg0, arg1 etc for referring to arguments.\nall remaining arguments (3rd to nth) are arguments to the function (identifiers/functions)\n\nExamples:\n\nSingle value result -\n\ngroovy('{\"returnType\":\"INT\",\"isSingleValue\":true}', 'arg0 + arg1', colA, colB)\n\n\nSingle value result from array input -\n\ngroovy('{\"returnType\":\"INT\",\"isSingleValue\":true}', 'arg0.toList().max()', mvColumn)\n\n\nList result -\n\ngroovy('{\"returnType\":\"LONG\",\"isSingleValue\":false}', 'arg0.findIndexValues{ it > 5 }', mvColumn)\n\n\nNested with other Pinot functions -\n\ngroovy('{\"returnType\":\"DOUBLE\",\"isSingleValue\":true}', 'arg0 * arg1', arraylength(mvColumn), colB)\n\n\nMulti line groovy script, with loops and conditions -\n\ngroovy( '{\"returnType\":\"DOUBLE\",\"isSingleValue\":true}', \n'def x = 0; arg0.eachWithIndex{item, idx-> if (item == \"foo\") {x = x + arg1[idx] }}; return x' , \nmvColumnA, mvColumnB)\n\nExample in query:\nSELECT \nGROOVY('{\"returnType\":\"STRING\",\"isSingleValue\":true}', 'arg0+\" \"+arg1', firstName, lastName) AS fullName \nFROM myTable\n\nRefer to GROOVY row in https://docs.pinot.apache.org/users/user-guide-query/pinot-query-language#transform-function-in-aggregation-and-grouping for more examples.\nRelease Notes\nGROOVY - New transform UDF which executes Groovy expressions in query.\nDocumentation\nadded to the transform functions table: https://docs.pinot.apache.org/users/user-guide-query/pinot-query-language#transform-function-in-aggregation-and-grouping", "createdAt": "2020-07-24T03:09:24Z", "url": "https://github.com/apache/pinot/pull/5748", "merged": true, "mergeCommit": {"oid": "69111727f6f011a7d864698cde292df0cd2e22d9"}, "closed": true, "closedAt": "2020-07-25T02:38:34Z", "author": {"login": "npawar"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc37BSFgH2gAyNDU2MDUwNzQzOjM2ODA2YWRjNWVkMDBhZjczZDM4YzJiNTg4ZWUwMWI4Njk3NTQ2MDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc4M_BGAH2gAyNDU2MDUwNzQzOjRhMmU0ZGMyNDQwMjdhNzQyYWFhMzk2OTE4ZGU5M2MyNjJhNDJlNjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "36806adc5ed00af73d38c2b588ee01b869754605", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/36806adc5ed00af73d38c2b588ee01b869754605", "committedDate": "2020-07-24T02:57:43Z", "message": "GROOVY transform function UDF for queries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MDA1ODA0", "url": "https://github.com/apache/pinot/pull/5748#pullrequestreview-455005804", "createdAt": "2020-07-24T16:01:30Z", "commit": {"oid": "36806adc5ed00af73d38c2b588ee01b869754605"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNjowMTozMFrOG21Bsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNjowMTozMFrOG21Bsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE0NTA3NA==", "bodyText": "transformExpression -> closure", "url": "https://github.com/apache/pinot/pull/5748#discussion_r460145074", "createdAt": "2020-07-24T16:01:30Z", "author": {"login": "kishoreg"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/data/function/GroovyFunctionEvaluator.java", "diffHunk": "@@ -55,6 +55,7 @@\n   private static final String ARGUMENTS_SEPARATOR = \",\";\n \n   private final List<String> _arguments;\n+  private final int _numArguments;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36806adc5ed00af73d38c2b588ee01b869754605"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a2e4dc244027a742aaa396918de93c262a42e61", "author": {"user": {"login": "npawar", "name": "Neha Pawar"}}, "url": "https://github.com/apache/pinot/commit/4a2e4dc244027a742aaa396918de93c262a42e61", "committedDate": "2020-07-24T23:53:32Z", "message": "Change order of arguments to groovy function"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 461, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}