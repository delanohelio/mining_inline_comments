{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1MDk3NjQ2", "number": 6284, "title": " Support for text index without raw", "bodyText": "Adding support for text index without raw data.\nOur use cases are indexing huge blobs of text (STRING) data. We have seen the raw forward index size upto 2GB per segment for text data. As an example for few of our tables, supporting this mode of text index will lead upto 2TB storage space saving per colo per table. These tables use text index only in the filter clause. The raw values are neither projected nor used in the query in filter other than text_match clause.\n\nLike other text index configs, the behavior can be enabled on a per index basis through table config\nThe actual raw value is used for building the text index.\nFor the forward index, a dummy value (that also user can provide) will be used.  Default would be \"n\"\n\nA potential follow up will be to not have the column at all and just have the index. However, this requires semantic changes in quite a few places in the code that assume that forward index is always there.", "createdAt": "2020-11-21T08:14:59Z", "url": "https://github.com/apache/pinot/pull/6284", "merged": true, "mergeCommit": {"oid": "fe9d3c79d2da709e6ce15929df539f91fe960c2e"}, "closed": true, "closedAt": "2020-11-23T19:21:55Z", "author": {"login": "siddharthteotia"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdenW9GAH2gAyNTI1MDk3NjQ2OjcxM2ZiMmIyMDQ0NzAyZDM5NjU4YjQ5NGRkNDllZGRkZmIyNDY5NWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfaJw2gH2gAyNTI1MDk3NjQ2OjQ4ZGE2MzkxNmI5YjUyNjAyNTc4M2Y0YTA5YjEyZGM4ZGY3MmM4ODM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "713fb2b2044702d39658b494dd49edddfb24695c", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/713fb2b2044702d39658b494dd49edddfb24695c", "committedDate": "2020-11-21T08:06:20Z", "message": "WIP - Support for text index withour raw"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NzI5NTMw", "url": "https://github.com/apache/pinot/pull/6284#pullrequestreview-536729530", "createdAt": "2020-11-23T18:13:25Z", "commit": {"oid": "713fb2b2044702d39658b494dd49edddfb24695c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxODoxMzoyNVrOH4ZrlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxODoxMzoyNVrOH4ZrlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODkwMzA2MQ==", "bodyText": "Does it make sense to use a single character for this? This value is never used in processing, so it is a pure memory overhead, right?", "url": "https://github.com/apache/pinot/pull/6284#discussion_r528903061", "createdAt": "2020-11-23T18:13:25Z", "author": {"login": "mcvsubbu"}, "path": "pinot-spi/src/main/java/org/apache/pinot/spi/config/table/FieldConfig.java", "diffHunk": "@@ -44,6 +44,9 @@\n   // the cache improves performance of repeatable queries\n   public static String TEXT_INDEX_ENABLE_QUERY_CACHE = \"enableQueryCacheForTextIndex\";\n   public static String TEXT_INDEX_USE_AND_FOR_MULTI_TERM_QUERIES = \"useANDForMultiTermTextIndexQueries\";\n+  public static String TEXT_INDEX_NO_RAW_DATA = \"noRawDataForTextIndex\";\n+  public static String TEXT_INDEX_RAW_VALUE = \"rawValueForTextIndex\";\n+  public static String TEXT_INDEX_DEFAULT_RAW_VALUE = \"null\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "713fb2b2044702d39658b494dd49edddfb24695c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NzYzOTcx", "url": "https://github.com/apache/pinot/pull/6284#pullrequestreview-536763971", "createdAt": "2020-11-23T19:02:46Z", "commit": {"oid": "713fb2b2044702d39658b494dd49edddfb24695c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxOTowMjo0NlrOH4bWuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxOTowMjo0NlrOH4bWuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODkzMDQ4OQ==", "bodyText": "mark it visible for testing please", "url": "https://github.com/apache/pinot/pull/6284#discussion_r528930489", "createdAt": "2020-11-23T19:02:46Z", "author": {"login": "mcvsubbu"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/indexsegment/generator/SegmentGeneratorConfig.java", "diffHunk": "@@ -299,6 +299,10 @@ public void setTextIndexCreationColumns(List<String> textIndexCreationColumns) {\n     }\n   }\n \n+  public void setColumnProperties(Map<String, Map<String, String>> columnProperties) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "713fb2b2044702d39658b494dd49edddfb24695c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48da63916b9b526025783f4a09b12dc8df72c883", "author": {"user": null}, "url": "https://github.com/apache/pinot/commit/48da63916b9b526025783f4a09b12dc8df72c883", "committedDate": "2020-11-23T19:17:05Z", "message": "review comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1819, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}