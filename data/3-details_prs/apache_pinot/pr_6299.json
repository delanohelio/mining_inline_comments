{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5MjI4NDMx", "number": 6299, "title": "Adding custom metadata props into both segment metadata properties file and zk metadata record", "bodyText": "Description\nAllow adding custom configs during the segment creation phase, and made those available in both segment metadata property file and zookeeper znRecord.\nNote that those configs will have custom. prefix in metadata.properties file.\nSample output:\nmetadata.property file:\n\nzk metadata:", "createdAt": "2020-11-30T01:58:34Z", "url": "https://github.com/apache/pinot/pull/6299", "merged": true, "mergeCommit": {"oid": "d6862a24caf82e3a548ef28dd8d920cb81595eb0"}, "closed": true, "closedAt": "2020-12-01T03:56:43Z", "author": {"login": "xiangfu0"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhfzJ2ABqjQwNTAzNTU0MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhu5UzgFqTU0MTM5ODk4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af3ff4076ec166d1e9f3b036079c23b800e94899", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/af3ff4076ec166d1e9f3b036079c23b800e94899", "committedDate": "2020-11-30T01:55:50Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}, "afterCommit": {"oid": "8410221614a7f6439f4004a8139d0425e197b96d", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/8410221614a7f6439f4004a8139d0425e197b96d", "committedDate": "2020-11-30T06:59:29Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8410221614a7f6439f4004a8139d0425e197b96d", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/8410221614a7f6439f4004a8139d0425e197b96d", "committedDate": "2020-11-30T06:59:29Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}, "afterCommit": {"oid": "a05ccdda2a384cdd76a13260f7d4cba2e8347728", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/a05ccdda2a384cdd76a13260f7d4cba2e8347728", "committedDate": "2020-11-30T07:10:20Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a05ccdda2a384cdd76a13260f7d4cba2e8347728", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/a05ccdda2a384cdd76a13260f7d4cba2e8347728", "committedDate": "2020-11-30T07:10:20Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}, "afterCommit": {"oid": "2b0df65d0019c61c0fb9b04b61ba02cc504bafef", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/2b0df65d0019c61c0fb9b04b61ba02cc504bafef", "committedDate": "2020-11-30T08:52:31Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e8393f1111bdc07bf56236a3c27188c6ae0ed74", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/1e8393f1111bdc07bf56236a3c27188c6ae0ed74", "committedDate": "2020-11-30T22:07:15Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b0df65d0019c61c0fb9b04b61ba02cc504bafef", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/2b0df65d0019c61c0fb9b04b61ba02cc504bafef", "committedDate": "2020-11-30T08:52:31Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}, "afterCommit": {"oid": "1e8393f1111bdc07bf56236a3c27188c6ae0ed74", "author": {"user": {"login": "xiangfu0", "name": "Xiang Fu"}}, "url": "https://github.com/apache/pinot/commit/1e8393f1111bdc07bf56236a3c27188c6ae0ed74", "committedDate": "2020-11-30T22:07:15Z", "message": "Adding custom metadata props into both segment metadata properties file and zk metadata record"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMzk4OTgz", "url": "https://github.com/apache/pinot/pull/6299#pullrequestreview-541398983", "createdAt": "2020-12-01T00:24:34Z", "commit": {"oid": "1e8393f1111bdc07bf56236a3c27188c6ae0ed74"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNTowNVrOH8TOow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDoyNTowNVrOH8TOow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjk5MTY1MQ==", "bodyText": "Use constant", "url": "https://github.com/apache/pinot/pull/6299#discussion_r532991651", "createdAt": "2020-12-01T00:25:05Z", "author": {"login": "Jackie-Jiang"}, "path": "pinot-core/src/main/java/org/apache/pinot/core/segment/index/metadata/SegmentMetadataImpl.java", "diffHunk": "@@ -531,6 +553,12 @@ public JsonNode toJson(@Nullable Set<String> columnFilter) {\n     segmentMetadata.put(\"creatorName\", _creatorName);\n     segmentMetadata.put(\"paddingCharacter\", String.valueOf(_paddingCharacter));\n \n+    ObjectNode customConfigs = JsonUtils.newObjectNode();\n+    for (String key : _customMap.keySet()) {\n+      customConfigs.put(key, _customMap.get(key));\n+    }\n+    segmentMetadata.set(\"custom\", customConfigs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e8393f1111bdc07bf56236a3c27188c6ae0ed74"}, "originalPosition": 79}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1851, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}