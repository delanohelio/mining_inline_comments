{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2NTMxODU4", "number": 5009, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMDowOToyN1rODaTB8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMDo0MDozOFrODbBCsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4OTAxMzYzOnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QyMDowOToyN1rOFhLJPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMDozOTo1M1rOFiQv-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyOTkxNg==", "bodyText": "Why this is a TODO?", "url": "https://github.com/apache/pinot/pull/5009#discussion_r370329916", "createdAt": "2020-01-23T20:09:27Z", "author": {"login": "xiaohui-sun"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "diffHunk": "@@ -530,6 +535,11 @@ private DetectionConfigDTO generateDetectionConfig(Map<String, Object> yamlConfi\n     config.setActive(MapUtils.getBooleanValue(yamlConfigMap, PROP_ACTIVE, true));\n     config.setYaml(yamlConfig);\n \n+    //TODO: data-availability trigger is only enabled for detections running on PINOT only", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05c002dda9a7a678a34293bbffae9be4c7c2b36e"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM4MTE2OQ==", "bodyText": "Ideally, data availability trigger should be enabled if the cron is specified. However, due to the current prod setup, we only get events for Pinot dataset. We should remove the check for Pinot dataset when we get update events for other data source.", "url": "https://github.com/apache/pinot/pull/5009#discussion_r370381169", "createdAt": "2020-01-23T22:08:44Z", "author": {"login": "vincentchenjl"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "diffHunk": "@@ -530,6 +535,11 @@ private DetectionConfigDTO generateDetectionConfig(Map<String, Object> yamlConfi\n     config.setActive(MapUtils.getBooleanValue(yamlConfigMap, PROP_ACTIVE, true));\n     config.setYaml(yamlConfig);\n \n+    //TODO: data-availability trigger is only enabled for detections running on PINOT only", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyOTkxNg=="}, "originalCommit": {"oid": "05c002dda9a7a678a34293bbffae9be4c7c2b36e"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ3MDMzMA==", "bodyText": "Let's not add TODO here since this is a new feature request not a code refactor or tech debt. :)\nWe don't have ETA for getting event data for other datasets.", "url": "https://github.com/apache/pinot/pull/5009#discussion_r371470330", "createdAt": "2020-01-27T20:39:53Z", "author": {"login": "xiaohui-sun"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "diffHunk": "@@ -530,6 +535,11 @@ private DetectionConfigDTO generateDetectionConfig(Map<String, Object> yamlConfi\n     config.setActive(MapUtils.getBooleanValue(yamlConfigMap, PROP_ACTIVE, true));\n     config.setYaml(yamlConfig);\n \n+    //TODO: data-availability trigger is only enabled for detections running on PINOT only", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyOTkxNg=="}, "originalCommit": {"oid": "05c002dda9a7a678a34293bbffae9be4c7c2b36e"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NjU1MjE3OnYy", "diffSide": "RIGHT", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMDo0MDozOFrOFiQxJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjozNToyM1rOFiT3ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ3MDYyOQ==", "bodyText": "Need to check if this is daily/weekly detection.", "url": "https://github.com/apache/pinot/pull/5009#discussion_r371470629", "createdAt": "2020-01-27T20:40:38Z", "author": {"login": "xiaohui-sun"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "diffHunk": "@@ -530,6 +535,11 @@ private DetectionConfigDTO generateDetectionConfig(Map<String, Object> yamlConfi\n     config.setActive(MapUtils.getBooleanValue(yamlConfigMap, PROP_ACTIVE, true));\n     config.setYaml(yamlConfig);\n \n+    //TODO: data-availability trigger is only enabled for detections running on PINOT only\n+    if (MapUtils.getString(yamlConfigMap, PROP_CRON) == null\n+        && datasetConfigs.stream().allMatch(c -> c.getDataSource().equals(PinotThirdEyeDataSource.DATA_SOURCE_NAME))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05c002dda9a7a678a34293bbffae9be4c7c2b36e"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyMTM4MA==", "bodyText": "Added the check for the granularity of dataset. Even if the detection is a weekly detection, it can be data-availability triggered as long as it is daily Pinot dataset.", "url": "https://github.com/apache/pinot/pull/5009#discussion_r371521380", "createdAt": "2020-01-27T22:35:23Z", "author": {"login": "vincentchenjl"}, "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/detection/yaml/translator/DetectionConfigTranslator.java", "diffHunk": "@@ -530,6 +535,11 @@ private DetectionConfigDTO generateDetectionConfig(Map<String, Object> yamlConfi\n     config.setActive(MapUtils.getBooleanValue(yamlConfigMap, PROP_ACTIVE, true));\n     config.setYaml(yamlConfig);\n \n+    //TODO: data-availability trigger is only enabled for detections running on PINOT only\n+    if (MapUtils.getString(yamlConfigMap, PROP_CRON) == null\n+        && datasetConfigs.stream().allMatch(c -> c.getDataSource().equals(PinotThirdEyeDataSource.DATA_SOURCE_NAME))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQ3MDYyOQ=="}, "originalCommit": {"oid": "05c002dda9a7a678a34293bbffae9be4c7c2b36e"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3629, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}