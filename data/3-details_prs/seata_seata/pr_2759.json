{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MjQyMzQ2", "number": 2759, "title": "optimize: optimized the generation rules of thread name factory", "bodyText": "\u2160. Describe what this PR did\noptimized the generation rules of thread name factory\n\u2161. Does this pull request fix one issue?\nfixes #2741\n\u2162. Why don't you add test cases (unit test/integration test)?\nhas already add NamedThreadFactoryTest#testThreadNameHasCounterWithPrefixCounter\n\u2163. Describe how to verify it\ntest cases pass\ncan view the thread name using jstack or jconsole\n\u2164. Special notes for reviews", "createdAt": "2020-06-03T14:30:47Z", "url": "https://github.com/seata/seata/pull/2759", "merged": true, "mergeCommit": {"oid": "7a6583a2cbb7be285611444a98ee86dd10f659a1"}, "closed": true, "closedAt": "2020-06-05T02:28:01Z", "author": {"login": "caohdgege"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnqVicAH2gAyNDI3MjQyMzQ2OmFlZDU4NGY1YzQ3YzFjN2UyNzhmYzg4NmZmYTNlZjkzZGEyMTgyZTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoI1IyAFqTQyNDk0ODc1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "aed584f5c47c1c7e278fc886ffa3ef93da2182e8", "author": {"user": {"login": "caohdgege", "name": "chd"}}, "url": "https://github.com/seata/seata/commit/aed584f5c47c1c7e278fc886ffa3ef93da2182e8", "committedDate": "2020-06-03T14:28:40Z", "message": "bugfix: optimized the generation rules of thread name factory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDQ0ODM5", "url": "https://github.com/seata/seata/pull/2759#pullrequestreview-424044839", "createdAt": "2020-06-04T01:40:35Z", "commit": {"oid": "aed584f5c47c1c7e278fc886ffa3ef93da2182e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMTo0MDozNVrOGey8HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMTo0MDozNVrOGey8HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk0NTA1Mw==", "bodyText": "recommand:\nassertEquals(\"prefix_\" + DEFAULT_THREAD_PREFIX_COUNTER + \"_\" + (i + 1) + \"_\" + THREAD_TOTAL_SIZE, t1.getName());", "url": "https://github.com/seata/seata/pull/2759#discussion_r434945053", "createdAt": "2020-06-04T01:40:35Z", "author": {"login": "jsbxyyx"}, "path": "common/src/test/java/io/seata/common/thread/NamedThreadFactoryTest.java", "diffHunk": "@@ -49,4 +51,16 @@ public void testConstructorWithPrefixAndDaemons() {\n         assertThat(thread.getName()).startsWith(\"prefix\");\n         assertThat(thread.isDaemon()).isTrue();\n     }\n+\n+\n+    @Test\n+    public void testThreadNameHasCounterWithPrefixCounter() {\n+        NamedThreadFactory factory = new NamedThreadFactory(\"prefix\", THREAD_TOTAL_SIZE,true);\n+        for (int i = 0; i < THREAD_TOTAL_SIZE; i ++) {\n+            Thread t1 = factory.newThread(() -> {});\n+\n+            // the first _DEFAULT_THREAD_PREFIX_COUNTER is meaning thread counter\n+            assertThat(t1.getName()).startsWith(\"prefix_\" + DEFAULT_THREAD_PREFIX_COUNTER + \"_\" + (i + 1));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aed584f5c47c1c7e278fc886ffa3ef93da2182e8"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d99e9c7e81ef1295b7d3619997380063c21734e", "author": {"user": {"login": "caohdgege", "name": "chd"}}, "url": "https://github.com/seata/seata/commit/7d99e9c7e81ef1295b7d3619997380063c21734e", "committedDate": "2020-06-04T13:20:45Z", "message": "bugfix: change starts with to equals"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "927efdce6717fa73da797c6407c9c7aefe5e468d", "author": {"user": {"login": "caohdgege", "name": "chd"}}, "url": "https://github.com/seata/seata/commit/927efdce6717fa73da797c6407c9c7aefe5e468d", "committedDate": "2020-06-04T13:28:25Z", "message": "add a space"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "497ca49ddbb896916dde24ee537407454480f9b1", "author": {"user": {"login": "caohdgege", "name": "chd"}}, "url": "https://github.com/seata/seata/commit/497ca49ddbb896916dde24ee537407454480f9b1", "committedDate": "2020-06-04T13:39:53Z", "message": "to 4 space"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTI4NDY0", "url": "https://github.com/seata/seata/pull/2759#pullrequestreview-424928464", "createdAt": "2020-06-05T00:49:18Z", "commit": {"oid": "497ca49ddbb896916dde24ee537407454480f9b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTQ4NzUz", "url": "https://github.com/seata/seata/pull/2759#pullrequestreview-424948753", "createdAt": "2020-06-05T02:00:20Z", "commit": {"oid": "497ca49ddbb896916dde24ee537407454480f9b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3742, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}