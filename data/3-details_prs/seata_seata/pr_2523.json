{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxMTkxMDE4", "number": 2523, "title": "optimize: abnormal global transactions, output logs according to frequency", "bodyText": "\u2160. Describe what this PR did\noptimize log output when rm client disconnects abnormally\n\u2161. Does this pull request fix one issue?\n\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-04-09T03:45:25Z", "url": "https://github.com/seata/seata/pull/2523", "merged": true, "mergeCommit": {"oid": "bb07eec16f9090c02e7065d1fca32e0e5fce914c"}, "closed": true, "closedAt": "2020-04-14T05:59:41Z", "author": {"login": "a364176773"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcV0JNigH2gAyNDAxMTkxMDE4OjUzYTM3NzczODczZTY0NTNmNjg1MTI4ODM0ZjA0NjYzNDU4YWUwNDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXbRQ3AH2gAyNDAxMTkxMDE4Ojc5MWNhYWI3YmU4ZGY5M2RmODJkMmU4OTU3MmI4NjQ0Y2Q1NTZlMjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "53a37773873e6453f685128834f04663458ae049", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/53a37773873e6453f685128834f04663458ae049", "committedDate": "2020-04-09T03:43:37Z", "message": "optimize log output when rm client disconnects abnormally"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7756b663c8de2d2a48df3c968c96504b6a45c62b", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/7756b663c8de2d2a48df3c968c96504b6a45c62b", "committedDate": "2020-04-10T03:18:31Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2418261414865db9a47475de44fb405755e57bf", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/e2418261414865db9a47475de44fb405755e57bf", "committedDate": "2020-04-10T09:15:04Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODM4NTQ1", "url": "https://github.com/seata/seata/pull/2523#pullrequestreview-391838545", "createdAt": "2020-04-12T09:29:39Z", "commit": {"oid": "e2418261414865db9a47475de44fb405755e57bf"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQwOToyOTo0MFrOGETzwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQwOTozMjoyNlrOGET0zQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE3MjAzMw==", "bodyText": "If these two rows are the same, why don't we just format them once?", "url": "https://github.com/seata/seata/pull/2523#discussion_r407172033", "createdAt": "2020-04-12T09:29:40Z", "author": {"login": "slievrly"}, "path": "core/src/main/java/io/seata/core/rpc/netty/RpcServer.java", "diffHunk": "@@ -109,9 +111,9 @@ public Object sendSyncRequest(String resourceId, String clientId, Object message\n                                   long timeout) throws TimeoutException {\n         Channel clientChannel = ChannelManager.getChannel(resourceId, clientId);\n         if (clientChannel == null) {\n-            throw new RuntimeException(\"rm client is not connected. dbkey:\" + resourceId\n-                + \",clientId:\" + clientId);\n-\n+            StackTraceLogger.warn(LOGGER,\n+                new RuntimeException(\"rm client is not connected. dbkey:\" + resourceId + \",clientId:\" + clientId),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2418261414865db9a47475de44fb405755e57bf"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE3MjMwMQ==", "bodyText": "can this logic continue?", "url": "https://github.com/seata/seata/pull/2523#discussion_r407172301", "createdAt": "2020-04-12T09:32:26Z", "author": {"login": "slievrly"}, "path": "core/src/main/java/io/seata/core/rpc/netty/RpcServer.java", "diffHunk": "@@ -109,9 +111,9 @@ public Object sendSyncRequest(String resourceId, String clientId, Object message\n                                   long timeout) throws TimeoutException {\n         Channel clientChannel = ChannelManager.getChannel(resourceId, clientId);\n         if (clientChannel == null) {\n-            throw new RuntimeException(\"rm client is not connected. dbkey:\" + resourceId\n-                + \",clientId:\" + clientId);\n-\n+            StackTraceLogger.warn(LOGGER,\n+                new RuntimeException(\"rm client is not connected. dbkey:\" + resourceId + \",clientId:\" + clientId),\n+                \"rm client is not connected. dbkey: {},clientId: {}\", new String[] {resourceId, clientId});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2418261414865db9a47475de44fb405755e57bf"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ae665fc86cb676f168fd6a2c74b8c5e82f2f345", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/4ae665fc86cb676f168fd6a2c74b8c5e82f2f345", "committedDate": "2020-04-12T11:51:17Z", "message": "delete redundant changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df6b8cefce8d18699e444d31e48a123180cb1d90", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/df6b8cefce8d18699e444d31e48a123180cb1d90", "committedDate": "2020-04-12T11:56:04Z", "message": "Roll back the code"}, "afterCommit": {"oid": "4ae665fc86cb676f168fd6a2c74b8c5e82f2f345", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/4ae665fc86cb676f168fd6a2c74b8c5e82f2f345", "committedDate": "2020-04-12T11:51:17Z", "message": "delete redundant changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85bb13713bb6b6db0f38928c788c4c75b75ce158", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/85bb13713bb6b6db0f38928c788c4c75b75ce158", "committedDate": "2020-04-12T11:59:24Z", "message": "Roll back the code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e92031bff7dc9dc174f215a7b37eaef8b89475d", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/2e92031bff7dc9dc174f215a7b37eaef8b89475d", "committedDate": "2020-04-12T12:00:12Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8ee7a776214a3a4f7b5fd7a3639677c3d7d3022", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/b8ee7a776214a3a4f7b5fd7a3639677c3d7d3022", "committedDate": "2020-04-12T12:35:42Z", "message": "optimize"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "268ec10ad465c064187bc4e87a32cd891f90b8c8", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/268ec10ad465c064187bc4e87a32cd891f90b8c8", "committedDate": "2020-04-13T11:34:37Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMDk2MDYy", "url": "https://github.com/seata/seata/pull/2523#pullrequestreview-392096062", "createdAt": "2020-04-13T11:36:39Z", "commit": {"oid": "b8ee7a776214a3a4f7b5fd7a3639677c3d7d3022"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMDk2NzY5", "url": "https://github.com/seata/seata/pull/2523#pullrequestreview-392096769", "createdAt": "2020-04-13T11:38:45Z", "commit": {"oid": "268ec10ad465c064187bc4e87a32cd891f90b8c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90585e78666c820e6af17dff26d6c5db4b914eba", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/90585e78666c820e6af17dff26d6c5db4b914eba", "committedDate": "2020-04-14T03:38:09Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "791caab7be8df93df82d2e89572b8644cd556e20", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/791caab7be8df93df82d2e89572b8644cd556e20", "committedDate": "2020-04-14T03:52:38Z", "message": "Merge branch 'develop' into optimize_rm_not_connected"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3883, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}