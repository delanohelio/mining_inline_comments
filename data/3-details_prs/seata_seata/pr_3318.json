{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NDE2OTM2", "number": 3318, "title": "optimize: make CLIENT_TABLE_META_CHECKER_INTERVAL configurable", "bodyText": "\u2160. Describe what this PR did\n\nChange default config value of CLIENT_TABLE_META_CHECK_ENABLE to true.\nMake CLIENT_TABLE_META_CHECKER_INTERVAL configurable\n\n\u2161. Does this pull request to fix one issue?\nfix #3330\nObviously, the current default config value of CLIENT_TABLE_META_CHECK_ENABLE is false.\nThis default config may cause service unavailable for up to 15 minutes when change table schema.\n\nFor example, add a new column to a table. This is a very common operation when you update your system.\nI think that 15 minutes unavailable is an unacceptable duration for updating a system.\nSo, It is better to change the default config of CLIENT_TABLE_META_CHECK_ENABLE  to true rather than false.\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\nstep1: add a new column to a table.\nstep2: Execute insert SQL by seata. The insert table must be the table that we changed in step1.\nstop3: Insert will not succeed!\nWhy is that?\nBecause seata need to build afterImage after the real insert is executed.\nIt will select all columns When building afterImage.\n\nAnd Table mate may not sync immediately. So building afterimage will fail!\n\u2164. Special notes for reviews", "createdAt": "2020-11-30T09:32:48Z", "url": "https://github.com/seata/seata/pull/3318", "merged": true, "mergeCommit": {"oid": "bc83c38fe3ebb859247146e155b3cf956d35df47"}, "closed": true, "closedAt": "2021-01-13T05:31:28Z", "author": {"login": "0000005"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhhv2UAH2gAyNTI5NDE2OTM2OjE0MjIyNTIyOWE3NmIxZjA2YzlhNjMxM2EyNmM5ODQwMzJkYjJlMDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvneKRgFqTU2Njg3NDg0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "142225229a76b1f06c9a6313a26c984032db2e05", "author": {"user": {"login": "0000005", "name": "JerryYin"}}, "url": "https://github.com/seata/seata/commit/142225229a76b1f06c9a6313a26c984032db2e05", "committedDate": "2020-11-30T09:15:52Z", "message": "opt config file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83104d94ec3e4c9d877c75d546ffd92413f73864", "author": {"user": {"login": "0000005", "name": "JerryYin"}}, "url": "https://github.com/seata/seata/commit/83104d94ec3e4c9d877c75d546ffd92413f73864", "committedDate": "2020-12-04T01:58:07Z", "message": "making tableMetaCheckerInterval configurable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1Mzg3MjM1", "url": "https://github.com/seata/seata/pull/3318#pullrequestreview-545387235", "createdAt": "2020-12-05T01:23:39Z", "commit": {"oid": "83104d94ec3e4c9d877c75d546ffd92413f73864"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMToyMzozOVrOH_ntwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMToyMzozOVrOH_ntwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ3MzAyNA==", "bodyText": "I think the configuration of DEFAULT_CLIENT_TABLE_META_CHECK_ENABLE keep false in default", "url": "https://github.com/seata/seata/pull/3318#discussion_r536473024", "createdAt": "2020-12-05T01:23:39Z", "author": {"login": "l81893521"}, "path": "common/src/main/java/io/seata/common/DefaultValues.java", "diffHunk": "@@ -30,7 +30,8 @@\n     int DEFAULT_TM_DEGRADE_CHECK_PERIOD = 2000;\n     int DEFAULT_CLIENT_REPORT_RETRY_COUNT = 5;\n     boolean DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE = false;\n-    boolean DEFAULT_CLIENT_TABLE_META_CHECK_ENABLE = false;\n+    boolean DEFAULT_CLIENT_TABLE_META_CHECK_ENABLE = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83104d94ec3e4c9d877c75d546ffd92413f73864"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff700d441a7b3ed2ced6401c8b2e15415a02c8f4", "author": {"user": {"login": "0000005", "name": "JerryYin"}}, "url": "https://github.com/seata/seata/commit/ff700d441a7b3ed2ced6401c8b2e15415a02c8f4", "committedDate": "2020-12-15T09:29:21Z", "message": "remove change default value"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NzM2NDAw", "url": "https://github.com/seata/seata/pull/3318#pullrequestreview-558736400", "createdAt": "2020-12-25T02:12:09Z", "commit": {"oid": "ff700d441a7b3ed2ced6401c8b2e15415a02c8f4"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NzM3NDQ2", "url": "https://github.com/seata/seata/pull/3318#pullrequestreview-558737446", "createdAt": "2020-12-25T02:21:04Z", "commit": {"oid": "ff700d441a7b3ed2ced6401c8b2e15415a02c8f4"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee5f09966f6ee11f9cec997735551edf4ae02ffa", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/ee5f09966f6ee11f9cec997735551edf4ae02ffa", "committedDate": "2021-01-13T03:20:36Z", "message": "Merge branch 'develop' into fix_refresh_table_mate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2ODY2NjMx", "url": "https://github.com/seata/seata/pull/3318#pullrequestreview-566866631", "createdAt": "2021-01-13T03:21:35Z", "commit": {"oid": "ee5f09966f6ee11f9cec997735551edf4ae02ffa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY2ODc0ODQz", "url": "https://github.com/seata/seata/pull/3318#pullrequestreview-566874843", "createdAt": "2021-01-13T03:50:55Z", "commit": {"oid": "ee5f09966f6ee11f9cec997735551edf4ae02ffa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3524, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}