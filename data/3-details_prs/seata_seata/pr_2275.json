{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NTEzMDE5", "number": 2275, "title": "feature: support hsf on TCC transaction mode", "bodyText": "\u2160. Describe what this PR did\nSupport for HSF protocol by adding Seata HSFParser.\nI made the following changes\n\nModify the \u2018GlobalTrans actionScanner\u2019 to support HSF tag creation of HSF proxy bean\nSupport for non SpringProxy beans with new parsing methods of  \u2018SpringProxyUtils\u2019\n\n\u2161. Does this pull request fix one issue?\nfixes #2248 #2228\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\nI have used 'edas-demo' to verify the modification.\n\u2164. Special notes for reviews", "createdAt": "2020-02-20T02:12:49Z", "url": "https://github.com/seata/seata/pull/2275", "merged": true, "mergeCommit": {"oid": "9893fac8bd7c653fff39bb8a4c172c26d5807c6c"}, "closed": true, "closedAt": "2020-04-17T06:11:21Z", "author": {"login": "q294881866"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJoFvAAFqTM2Njk3OTQ2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYbChDgFqTM5NTE4MzgxNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2OTc5NDY4", "url": "https://github.com/seata/seata/pull/2275#pullrequestreview-366979468", "createdAt": "2020-03-02T06:53:52Z", "commit": {"oid": "245e26b9b9648ec1f2c2f9364408b1c2dc7ff9ab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NTQwNTA4", "url": "https://github.com/seata/seata/pull/2275#pullrequestreview-377540508", "createdAt": "2020-03-19T09:16:31Z", "commit": {"oid": "6382ed62eea5d90b862bd331f1c87cb4f8da4d8c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOToxNjozMVrOF4l2tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOToyMjowNVrOF4mDAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg4NDc4OQ==", "bodyText": "I think  !SpringProxyUtils.isProxy Contains the !(bean instanceof SpringProxy)) condition.", "url": "https://github.com/seata/seata/pull/2275#discussion_r394884789", "createdAt": "2020-03-19T09:16:31Z", "author": {"login": "slievrly"}, "path": "spring/src/main/java/io/seata/spring/annotation/GlobalTransactionScanner.java", "diffHunk": "@@ -227,7 +227,7 @@ protected Object wrapIfNecessary(Object bean, String beanName, Object cacheKey)\n                 }\n \n                 LOGGER.info(\"Bean[{}] with name [{}] would use interceptor [{}]\", bean.getClass().getName(), beanName, interceptor.getClass().getName());\n-                if (!AopUtils.isAopProxy(bean)) {\n+                if (!SpringProxyUtils.isProxy(bean) || !(bean instanceof SpringProxy)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6382ed62eea5d90b862bd331f1c87cb4f8da4d8c"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg4NzkzNw==", "bodyText": "!SpringProxyUtils.isProxy(bean) -> !AopUtils.isAopProxy(bean)  -> !((object instanceof SpringProxy && (Proxy.isProxyClass(object.getClass()) || ClassUtils.isCglibProxyClass(object.getClass())))) -> !(bean instanceof SpringProxy)) || !((Proxy.isProxyClass(object.getClass()) || ClassUtils.isCglibProxyClass(object.getClass()))))) ->   !(bean instanceof SpringProxy)) || (!Proxy.isProxyClass(object.getClass()) && !ClassUtils.isCglibProxyClass(object.getClass())))", "url": "https://github.com/seata/seata/pull/2275#discussion_r394887937", "createdAt": "2020-03-19T09:22:05Z", "author": {"login": "slievrly"}, "path": "spring/src/main/java/io/seata/spring/annotation/GlobalTransactionScanner.java", "diffHunk": "@@ -227,7 +227,7 @@ protected Object wrapIfNecessary(Object bean, String beanName, Object cacheKey)\n                 }\n \n                 LOGGER.info(\"Bean[{}] with name [{}] would use interceptor [{}]\", bean.getClass().getName(), beanName, interceptor.getClass().getName());\n-                if (!AopUtils.isAopProxy(bean)) {\n+                if (!SpringProxyUtils.isProxy(bean) || !(bean instanceof SpringProxy)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDg4NDc4OQ=="}, "originalCommit": {"oid": "6382ed62eea5d90b862bd331f1c87cb4f8da4d8c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9c367ffd1ac0674086fef1e82a1cb720d240703", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/f9c367ffd1ac0674086fef1e82a1cb720d240703", "committedDate": "2020-04-16T10:30:13Z", "message": "add hsf parser\nfixes #2248"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7bd269dfde44c7aa88f0eb0f4750a838ba5c6ed0", "author": {"user": {"login": "q294881866", "name": "Pengfei Pei"}}, "url": "https://github.com/seata/seata/commit/7bd269dfde44c7aa88f0eb0f4750a838ba5c6ed0", "committedDate": "2020-04-16T10:23:14Z", "message": "fix"}, "afterCommit": {"oid": "f9c367ffd1ac0674086fef1e82a1cb720d240703", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/f9c367ffd1ac0674086fef1e82a1cb720d240703", "committedDate": "2020-04-16T10:30:13Z", "message": "add hsf parser\nfixes #2248"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MTgzODE1", "url": "https://github.com/seata/seata/pull/2275#pullrequestreview-395183815", "createdAt": "2020-04-17T06:10:27Z", "commit": {"oid": "f9c367ffd1ac0674086fef1e82a1cb720d240703"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4015, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}