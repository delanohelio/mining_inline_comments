{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2ODkyNDcx", "number": 2929, "title": "bugfix: fix the application was configured to degrade at startup and can't be dynamically switch to upgraded", "bodyText": "Signed-off-by: slievrly slievrly@163.com\n\n\u2160. Describe what this PR did\nbugfix: fix the application was configured to degrade at startup and can't be dynamically switch to upgraded\n\u2161. Does this pull request fix one issue?\n\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\nbefore startup:  service.disableGlobalTransaction=true;\nafter startup: service.disableGlobalTransaction=true;\nNote that you need to use a configuration center that is not of file type. Dynamic configuration does not take effect when using seata-spring-boot-starter && type=file.\n\u2164. Special notes for reviews", "createdAt": "2020-07-27T04:40:18Z", "url": "https://github.com/seata/seata/pull/2929", "merged": true, "mergeCommit": {"oid": "f6d6161080f4d4982aaebfe70b72921f6413d85d"}, "closed": true, "closedAt": "2020-10-10T10:27:39Z", "author": {"login": "slievrly"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc46NUcgH2gAyNDU2ODkyNDcxOjhhNGI1NTk1ZDBjNDNhODIzNjNjNTMxOGY0OTNmN2E2YTU1ZGM2ZGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdRIBJ7gH2gAyNDU2ODkyNDcxOmQ4ZjE0Y2QwYjAzYjEzMzJmMmFiMjUyNjg3NmFjNTU4YjU3MDE3ZDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8a4b5595d0c43a82363c5318f493f7a6a55dc6de", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/8a4b5595d0c43a82363c5318f493f7a6a55dc6de", "committedDate": "2020-07-27T04:34:53Z", "message": "bugfix: fix the application was configured to degrade at startup and can't be dynamically switch to upgraded\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDg5NTQx", "url": "https://github.com/seata/seata/pull/2929#pullrequestreview-455489541", "createdAt": "2020-07-27T05:56:45Z", "commit": {"oid": "8a4b5595d0c43a82363c5318f493f7a6a55dc6de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNTo1Njo0NVrOG3UkpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwNTo1Njo0NVrOG3UkpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY2MTkyNA==", "bodyText": "DISABLE_GLOBAL_TRANSACTION \u5df2\u7ecf\u88ab\u8ba2\u9605\u4e86\uff0c\u6b64\u7c7b\u5e76\u672a\u6709\u5176\u4ed6\u9700\u8981\u76d1\u542c\u5904\u7406\u7684\u4e1a\u52a1\uff0c\u4e3a\u4f55\u4e0d\u76f4\u63a5\u521b\u5efa\u4f4d\u5c40\u90e8\u53d8\u91cf\uff0c\u8fdb\u884cgetBoolean\uff1f", "url": "https://github.com/seata/seata/pull/2929#discussion_r460661924", "createdAt": "2020-07-27T05:56:45Z", "author": {"login": "a364176773"}, "path": "spring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java", "diffHunk": "@@ -32,17 +36,22 @@\n import java.lang.reflect.Method;\n import java.util.Map;\n \n+import static io.seata.core.constants.DefaultValues.DEFAULT_DISABLE_GLOBAL_TRANSACTION;\n+\n /**\n  * TCC Interceptor\n  *\n  * @author zhangsen\n  */\n-public class TccActionInterceptor implements MethodInterceptor {\n+public class TccActionInterceptor implements MethodInterceptor, ConfigurationChangeListener {\n \n     private static final Logger LOGGER = LoggerFactory.getLogger(TccActionInterceptor.class);\n \n     private ActionInterceptorHandler actionInterceptorHandler = new ActionInterceptorHandler();\n \n+    private boolean disable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.DISABLE_GLOBAL_TRANSACTION,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4b5595d0c43a82363c5318f493f7a6a55dc6de"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NTI3MjI0", "url": "https://github.com/seata/seata/pull/2929#pullrequestreview-476527224", "createdAt": "2020-08-27T09:06:41Z", "commit": {"oid": "daf20f73eb237cf098d988ab6794118a06b729b2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwOTowNjo0MVrOHIHRWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwOTowNjo0MVrOHIHRWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI2OTc4Nw==", "bodyText": "volatile ?", "url": "https://github.com/seata/seata/pull/2929#discussion_r478269787", "createdAt": "2020-08-27T09:06:41Z", "author": {"login": "wangliang181230"}, "path": "spring/src/main/java/io/seata/spring/annotation/GlobalTransactionScanner.java", "diffHunk": "@@ -78,8 +80,9 @@\n     private final String applicationId;\n     private final String txServiceGroup;\n     private final int mode;\n-    private final boolean disableGlobalTransaction = ConfigurationFactory.getInstance().getBoolean(\n+    private boolean disableGlobalTransaction = ConfigurationFactory.getInstance().getBoolean(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "daf20f73eb237cf098d988ab6794118a06b729b2"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84629c5303da8f796993723594162fe7baf13728", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/84629c5303da8f796993723594162fe7baf13728", "committedDate": "2020-09-18T15:17:49Z", "message": "fix conflicts\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1a841f0c2697eba036399ff159b854b052d0685", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/b1a841f0c2697eba036399ff159b854b052d0685", "committedDate": "2020-09-11T04:04:03Z", "message": "Merge branch 'develop' into disable"}, "afterCommit": {"oid": "84629c5303da8f796993723594162fe7baf13728", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/84629c5303da8f796993723594162fe7baf13728", "committedDate": "2020-09-18T15:17:49Z", "message": "fix conflicts\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee480af5290ba447ea33b5b803351b708ab87049", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/ee480af5290ba447ea33b5b803351b708ab87049", "committedDate": "2020-09-18T15:20:25Z", "message": "fix review\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2a3a6bee61842e6a158272d2984ae39014a6a54", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/f2a3a6bee61842e6a158272d2984ae39014a6a54", "committedDate": "2020-09-21T03:08:43Z", "message": "fix ci\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e13383968d437cdf04866e35c74b8c89eccff50d", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/e13383968d437cdf04866e35c74b8c89eccff50d", "committedDate": "2020-09-21T03:22:45Z", "message": "fix review\n\nSigned-off-by: slievrly <slievrly@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "396f33ccfedf7a2e250f0dba4c1331e7d9a0f2c8", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/396f33ccfedf7a2e250f0dba4c1331e7d9a0f2c8", "committedDate": "2020-09-23T14:11:14Z", "message": "Merge branch 'develop' of github.com:seata/seata into disable\n\nSigned-off-by: slievrly <slievrly@163.com>\n\n# Conflicts:\n#\tspring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df2e20dcd86907fd2cd8b4940c927ca138c32485", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/df2e20dcd86907fd2cd8b4940c927ca138c32485", "committedDate": "2020-10-10T08:07:20Z", "message": "Merge branch 'develop' of github.com:seata/seata into disable\n\nSigned-off-by: slievrly <slievrly@163.com>\n\n# Conflicts:\n#\tspring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDc4NDM3", "url": "https://github.com/seata/seata/pull/2929#pullrequestreview-506078437", "createdAt": "2020-10-10T08:17:42Z", "commit": {"oid": "df2e20dcd86907fd2cd8b4940c927ca138c32485"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDc5Mjc0", "url": "https://github.com/seata/seata/pull/2929#pullrequestreview-506079274", "createdAt": "2020-10-10T08:30:36Z", "commit": {"oid": "df2e20dcd86907fd2cd8b4940c927ca138c32485"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDg1NzEx", "url": "https://github.com/seata/seata/pull/2929#pullrequestreview-506085711", "createdAt": "2020-10-10T10:11:33Z", "commit": {"oid": "df2e20dcd86907fd2cd8b4940c927ca138c32485"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8f14cd0b03b1332f2ab2526876ac558b57017d6", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/d8f14cd0b03b1332f2ab2526876ac558b57017d6", "committedDate": "2020-10-10T10:14:27Z", "message": "Merge branch 'develop' into disable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3575, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}