{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMDg5NDEx", "number": 3134, "title": "optimize: opt codes related to `Map` and `List`", "bodyText": "\u2160. Describe what this PR did\noptimize: opt codes related to Map and List.\n\u4f18\u5316Map\u548cList\u76f8\u5173\u7684\u4ee3\u7801\uff08\u56e0\u4e3a\u6709\u4eba\u5410\u69fd\u963f\u91cc\uff08seata\uff09\u7684\u5f00\u53d1\u4eba\u5458\u57fa\u7840\u5dee\uff0corz\uff09\n\u4f18\u5316\u540e\u7684\u6548\u679c\uff1a\n\n\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e9b\u6027\u80fd\u635f\u8017\u548c\u4e0d\u5fc5\u8981\u7684new\u5b9e\u4f8b\u5316\u5185\u5b58\u5f00\u9500\u3002\n\u4ee3\u7801\u66f4\u52a0\u7b80\u6d01\u6613\u8bfb\u3002\n\u90e8\u5206\u4ee3\u7801\u6bb5\u4f7f\u7528\u4e86Map\u7684computeIfAbsent\u65b9\u6cd5\uff0c\u4fdd\u8bc1\u4e86\u64cd\u4f5c\u539f\u5b50\u6027\uff0c\u51cf\u5c11\u4e86\u5e76\u53d1\u4e0b\u7684\u91cd\u590d\u521d\u59cb\u5316\u64cd\u4f5c\u3002\n\n\u2161. Does this pull request fix one issue?\n\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-09-21T07:01:29Z", "url": "https://github.com/seata/seata/pull/3134", "merged": true, "mergeCommit": {"oid": "ab7af771da397d2da6d21b287cb813a84478ff62"}, "closed": true, "closedAt": "2020-10-17T11:40:05Z", "author": {"login": "wangliang181230"}, "timelineItems": {"totalCount": 40, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdK8PI1gH2gAyNDkwMDg5NDExOjUzZDE1ODk2ODUxNDA1ZjNjZTA1NWM3ZTU3M2NhZTI4YTAxMmUzMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTZJ6ZgH2gAyNDkwMDg5NDExOmQ0NDAzODY1NmMwYjI2NDYwYTA0ZWY5NjEyYTkzMjk4NWZlZTdjZjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "53d15896851405f3ce055c7e573cae28a012e307", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/53d15896851405f3ce055c7e573cae28a012e307", "committedDate": "2020-09-21T05:07:19Z", "message": "optimize: opt map related codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fa4b20627ae99600326fbc7499eca8dadf8ea36", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/5fa4b20627ae99600326fbc7499eca8dadf8ea36", "committedDate": "2020-09-21T06:59:34Z", "message": "optimize: opt map related codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "658032e3eea9f39df9291c8766a368fbee595532", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/658032e3eea9f39df9291c8766a368fbee595532", "committedDate": "2020-09-21T07:10:15Z", "message": "fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0864ef1edbe8637d59bd65291aaf3307eafb7168", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/0864ef1edbe8637d59bd65291aaf3307eafb7168", "committedDate": "2020-09-21T07:14:48Z", "message": "fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d102cc6900cc9be5eb6ef8c8c1d1bf0caa645d0", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/5d102cc6900cc9be5eb6ef8c8c1d1bf0caa645d0", "committedDate": "2020-09-21T08:23:53Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8aeda9829206de5a2576517f8d3991b3a90ace6e", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/8aeda9829206de5a2576517f8d3991b3a90ace6e", "committedDate": "2020-09-21T08:25:02Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1017722042941c7519dd4de58e7c621fac1d2937", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/1017722042941c7519dd4de58e7c621fac1d2937", "committedDate": "2020-09-21T11:00:36Z", "message": "optimize code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNjI1NzAw", "url": "https://github.com/seata/seata/pull/3134#pullrequestreview-492625700", "createdAt": "2020-09-21T13:54:31Z", "commit": {"oid": "1017722042941c7519dd4de58e7c621fac1d2937"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMzo1NDozMVrOHVRLSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNDowMToyNVrOHVRfdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2MzU2Mw==", "bodyText": "\u8fd9\u91cc\u539f\u6765configListeners\u662f\u7a7amap\u7684\u65f6\u5019\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684set\uff0c\u73b0\u5728\u8fd4\u56de\u7684\u662fnull\uff0c\u4f1a\u4e0d\u4f1a\u6709\u5f71\u54cd\uff1f", "url": "https://github.com/seata/seata/pull/3134#discussion_r492063563", "createdAt": "2020-09-21T13:54:31Z", "author": {"login": "caohdgege"}, "path": "config/seata-config-nacos/src/main/java/io/seata/config/nacos/NacosConfiguration.java", "diffHunk": "@@ -172,8 +174,9 @@ public void removeConfigListener(String dataId, ConfigurationChangeListener list\n \n     @Override\n     public Set<ConfigurationChangeListener> getConfigListeners(String dataId) {\n-        if (configListenersMap.containsKey(dataId)) {\n-            return configListenersMap.get(dataId).keySet();\n+        Map<ConfigurationChangeListener, NacosListener> configListeners = configListenersMap.get(dataId);\n+        if (configListeners != null && !configListeners.isEmpty()) {\n+            return configListeners.keySet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1017722042941c7519dd4de58e7c621fac1d2937"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2ODcyNA==", "bodyText": "\u540c\u4e0a", "url": "https://github.com/seata/seata/pull/3134#discussion_r492068724", "createdAt": "2020-09-21T14:01:25Z", "author": {"login": "caohdgege"}, "path": "config/seata-config-zk/src/main/java/io/seata/config/zk/ZookeeperConfiguration.java", "diffHunk": "@@ -210,8 +212,9 @@ public void removeConfigListener(String dataId, ConfigurationChangeListener list\n \n     @Override\n     public Set<ConfigurationChangeListener> getConfigListeners(String dataId) {\n-        if (configListenersMap.containsKey(dataId)) {\n-            return configListenersMap.get(dataId).keySet();\n+        ConcurrentMap<ConfigurationChangeListener, ZKListener> configListeners = configListenersMap.get(dataId);\n+        if (configListeners != null && !configListeners.isEmpty()) {\n+            return configListeners.keySet();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1017722042941c7519dd4de58e7c621fac1d2937"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd2e61467bde9612bbad76355b9156d8505fc294", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/dd2e61467bde9612bbad76355b9156d8505fc294", "committedDate": "2020-09-22T02:28:56Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b8b41aae075bbe139392bc765be3ecb82e53b4e", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/5b8b41aae075bbe139392bc765be3ecb82e53b4e", "committedDate": "2020-09-22T02:52:31Z", "message": "add CollectionUtils.getLastItem(List list) method and unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a00e4fdc8f0b7c6be801743d7f757f4a38ca533a", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/a00e4fdc8f0b7c6be801743d7f757f4a38ca533a", "committedDate": "2020-09-22T03:23:17Z", "message": "optimize codes related to the `List`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b266e0200cccd96a805f8844dce1967da464cd41", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/b266e0200cccd96a805f8844dce1967da464cd41", "committedDate": "2020-09-23T06:45:40Z", "message": "Merge branch 'develop' into optimize-map-code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd652bec69d1a2ce59398ea1f868dc1abc7a25b4", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/cd652bec69d1a2ce59398ea1f868dc1abc7a25b4", "committedDate": "2020-09-23T09:26:18Z", "message": "Merge branch 'develop' into optimize-map-code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NDg4MTgw", "url": "https://github.com/seata/seata/pull/3134#pullrequestreview-494488180", "createdAt": "2020-09-23T09:50:03Z", "commit": {"oid": "b266e0200cccd96a805f8844dce1967da464cd41"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54817fffa072379ffd52b4dcdc7669fc53800dec", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/54817fffa072379ffd52b4dcdc7669fc53800dec", "committedDate": "2020-09-23T13:46:28Z", "message": "Merge branch 'develop' into optimize-map-code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0Njc3ODgz", "url": "https://github.com/seata/seata/pull/3134#pullrequestreview-494677883", "createdAt": "2020-09-23T13:46:41Z", "commit": {"oid": "cd652bec69d1a2ce59398ea1f868dc1abc7a25b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "193e5dd611d06d798ff29fcc9481ebbaacb74996", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/193e5dd611d06d798ff29fcc9481ebbaacb74996", "committedDate": "2020-09-24T02:37:11Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d27bf3faa742aaf9b5657f68be36181dd29ef228", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/d27bf3faa742aaf9b5657f68be36181dd29ef228", "committedDate": "2020-09-24T02:49:38Z", "message": "fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6b1d0794575fe008121055bdafb6749fb441965", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/c6b1d0794575fe008121055bdafb6749fb441965", "committedDate": "2020-09-24T07:05:27Z", "message": "add CollectionUtils.computeIfAbsent method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dda49990e529be09a7aa783a15f4e1e61076f60", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/0dda49990e529be09a7aa783a15f4e1e61076f60", "committedDate": "2020-09-24T09:27:29Z", "message": "optimize code: foreach Map"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb882ae2544934a8e120bb10f993c700d59573a0", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/cb882ae2544934a8e120bb10f993c700d59573a0", "committedDate": "2020-09-24T09:33:31Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f817f7cd72f7a34f5c5344c392e5b5cba05cebc", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/6f817f7cd72f7a34f5c5344c392e5b5cba05cebc", "committedDate": "2020-09-24T09:50:23Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4934d6abe60a30cc10b3f500f883337e931e88e6", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/4934d6abe60a30cc10b3f500f883337e931e88e6", "committedDate": "2020-09-24T09:55:50Z", "message": "optimize notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4098b72e66d2d9660580538eb5161df3b7a09fa", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/f4098b72e66d2d9660580538eb5161df3b7a09fa", "committedDate": "2020-09-24T10:09:47Z", "message": "optimize getLast method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcd8879e11a73b5e82e94cb9d71f6eb1a0028def", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/bcd8879e11a73b5e82e94cb9d71f6eb1a0028def", "committedDate": "2020-09-24T10:19:29Z", "message": "optimize notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2376c103b53597617afff0f3a36d1154a71b67c", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/a2376c103b53597617afff0f3a36d1154a71b67c", "committedDate": "2020-09-24T10:20:13Z", "message": "optimize notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9807cc71390d5b8872bb91eaa2e5c3a2c858b705", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/9807cc71390d5b8872bb91eaa2e5c3a2c858b705", "committedDate": "2020-09-25T05:37:08Z", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc73ccef529a32754189d930140ec40947d20428", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/dc73ccef529a32754189d930140ec40947d20428", "committedDate": "2020-09-25T08:06:20Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ae2ed2d343e5ea2f40432e9468c0720c892841", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/83ae2ed2d343e5ea2f40432e9468c0720c892841", "committedDate": "2020-10-10T04:30:34Z", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code\n\n# Conflicts:\n#\tspring/src/main/java/io/seata/spring/annotation/datasource/DataSourceProxyHolder.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a7f3960e8bf012c51108a3eb1fd6d4a78b7fd81", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/6a7f3960e8bf012c51108a3eb1fd6d4a78b7fd81", "committedDate": "2020-10-10T05:25:47Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "809e39d8edefee966645e6a4c8ea80f836c759cd", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/809e39d8edefee966645e6a4c8ea80f836c759cd", "committedDate": "2020-10-10T05:38:56Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0706ce53310b2502e1703f5e6cee98ee40eea2f5", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/0706ce53310b2502e1703f5e6cee98ee40eea2f5", "committedDate": "2020-10-10T05:50:53Z", "message": "fix style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07d5be054f1a514691327e915b758112dfd6660a", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/07d5be054f1a514691327e915b758112dfd6660a", "committedDate": "2020-10-10T06:13:00Z", "message": "Merge remote-tracking branch 'remotes/upstream/develop' into optimize-map-code\n\n# Conflicts:\n#\tintegration/http/src/main/java/io/seata/integration/http/AbstractHttpExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2d7dae966f2f9644ca8eca690c1ac6a28b7989f", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/a2d7dae966f2f9644ca8eca690c1ac6a28b7989f", "committedDate": "2020-10-10T06:23:20Z", "message": "move the method `convert` to CollectionUtils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4df71ae54052a0bcbf30d1e0f0b1dad6b06fe8b", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/b4df71ae54052a0bcbf30d1e0f0b1dad6b06fe8b", "committedDate": "2020-10-10T06:25:19Z", "message": "rename var"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDc2MjY0", "url": "https://github.com/seata/seata/pull/3134#pullrequestreview-506076264", "createdAt": "2020-10-10T07:44:50Z", "commit": {"oid": "b4df71ae54052a0bcbf30d1e0f0b1dad6b06fe8b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f08c5bb9245162a180217c8c83b00126bf705249", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/f08c5bb9245162a180217c8c83b00126bf705249", "committedDate": "2020-10-10T07:46:37Z", "message": "Merge branch 'develop' into optimize-map-code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfa6ffd6050d8620e1a0be0ff587c087bf5ffca9", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/bfa6ffd6050d8620e1a0be0ff587c087bf5ffca9", "committedDate": "2020-10-10T07:51:09Z", "message": "Merge branch 'develop' into optimize-map-code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwOTc4MzQ2", "url": "https://github.com/seata/seata/pull/3134#pullrequestreview-510978346", "createdAt": "2020-10-17T11:19:42Z", "commit": {"oid": "bfa6ffd6050d8620e1a0be0ff587c087bf5ffca9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d44038656c0b26460a04ef9612a932985fee7cf5", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/d44038656c0b26460a04ef9612a932985fee7cf5", "committedDate": "2020-10-17T11:20:15Z", "message": "Merge branch 'develop' into optimize-map-code"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3679, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}