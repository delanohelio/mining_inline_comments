{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMjA4ODc5", "number": 2328, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwOTo0OTozMFrODk-fiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwOTo0OTozMFrODk-fiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMDk5MjA4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/io/seata/core/store/db/AbstractDataSourceGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwOTo0OTozMFrOFxmcQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwNTowNjowMlrOFyGiDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU1NDM3MA==", "bodyText": "what circumstances will this happen\uff1f", "url": "https://github.com/seata/seata/pull/2328#discussion_r387554370", "createdAt": "2020-03-04T09:49:30Z", "author": {"login": "slievrly"}, "path": "core/src/main/java/io/seata/core/store/db/AbstractDataSourceGenerator.java", "diffHunk": "@@ -61,6 +81,53 @@ protected String getDriverClassName() {\n         return driverClassName;\n     }\n \n+    protected ClassLoader getDriverClassLoader() {\n+        return MYSQL_DRIVER_LOADERS.getOrDefault(getDriverClassName(), ClassLoader.getSystemClassLoader());\n+    }\n+\n+    private static Map<String, ClassLoader> createMysqlDriverClassLoaders() {\n+        Map<String, ClassLoader> loaders = new HashMap<>();\n+        String cp = System.getProperty(\"java.class.path\");\n+        if (cp == null || cp.isEmpty()) {\n+            return loaders;\n+        }\n+        Stream.of(cp.split(File.pathSeparator))\n+                .map(File::new)\n+                .filter(File::exists)\n+                .map(file -> file.isFile() ? file.getParentFile() : file)\n+                .filter(Objects::nonNull)\n+                .filter(File::isDirectory)\n+                .map(file -> new File(file, \"jdbc\"))\n+                .filter(File::exists)\n+                .filter(File::isDirectory)\n+                .distinct()\n+                .flatMap(file -> {\n+                    File[] files = file.listFiles((f, name) -> name.startsWith(MYSQL_DRIVER_FILE_PREFIX));\n+                    if (files != null) {\n+                        return Stream.of(files);\n+                    } else {\n+                        return Stream.of();\n+                    }\n+                })\n+                .forEach(file -> {\n+                    if (loaders.containsKey(MYSQL8_DRIVER_CLASS_NAME) && loaders.containsKey(MYSQL_DRIVER_CLASS_NAME)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a38193f148ff4591fa187805f0613e4023393ee3"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODA4MDE0MQ==", "bodyText": "It's almost impossible in the current environment, just in case.", "url": "https://github.com/seata/seata/pull/2328#discussion_r388080141", "createdAt": "2020-03-05T05:06:02Z", "author": {"login": "ggndnn"}, "path": "core/src/main/java/io/seata/core/store/db/AbstractDataSourceGenerator.java", "diffHunk": "@@ -61,6 +81,53 @@ protected String getDriverClassName() {\n         return driverClassName;\n     }\n \n+    protected ClassLoader getDriverClassLoader() {\n+        return MYSQL_DRIVER_LOADERS.getOrDefault(getDriverClassName(), ClassLoader.getSystemClassLoader());\n+    }\n+\n+    private static Map<String, ClassLoader> createMysqlDriverClassLoaders() {\n+        Map<String, ClassLoader> loaders = new HashMap<>();\n+        String cp = System.getProperty(\"java.class.path\");\n+        if (cp == null || cp.isEmpty()) {\n+            return loaders;\n+        }\n+        Stream.of(cp.split(File.pathSeparator))\n+                .map(File::new)\n+                .filter(File::exists)\n+                .map(file -> file.isFile() ? file.getParentFile() : file)\n+                .filter(Objects::nonNull)\n+                .filter(File::isDirectory)\n+                .map(file -> new File(file, \"jdbc\"))\n+                .filter(File::exists)\n+                .filter(File::isDirectory)\n+                .distinct()\n+                .flatMap(file -> {\n+                    File[] files = file.listFiles((f, name) -> name.startsWith(MYSQL_DRIVER_FILE_PREFIX));\n+                    if (files != null) {\n+                        return Stream.of(files);\n+                    } else {\n+                        return Stream.of();\n+                    }\n+                })\n+                .forEach(file -> {\n+                    if (loaders.containsKey(MYSQL8_DRIVER_CLASS_NAME) && loaders.containsKey(MYSQL_DRIVER_CLASS_NAME)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU1NDM3MA=="}, "originalCommit": {"oid": "a38193f148ff4591fa187805f0613e4023393ee3"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1649, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}