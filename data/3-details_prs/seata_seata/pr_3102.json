{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzNDMwNzc5", "number": 3102, "title": "optimize: opt ContextCore, can be set 'Object' value", "bodyText": "\u2160. Describe what this PR did\noptimize: opt ContextCore, can be set 'Object' value.\n\u4f18\u5316ContextCore\uff0c\u53ef\u8bbe\u7f6eObject\u503c\u3002\n\u4f18\u5316\u7684\u76ee\u7684\uff1a\nRootContext.getBranchType()\u548cRootContext.unbindBranchType()\u65b9\u6cd5\u7684\u8fd4\u56de\u7c7b\u578b\u7531String\u53d8\u4e3aBranchType\uff0c\u90e8\u5206\u5224\u65ad\u65b9\u6cd5\u7684\u6027\u80fd\u4f1a\u66f4\u9ad8\uff0c\u4ee3\u7801\u4e5f\u4f1a\u66f4\u7b80\u6d01\u6613\u8bfb\u3002\n\u2161. Does this pull request fix one issue?\n\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-09-10T06:22:50Z", "url": "https://github.com/seata/seata/pull/3102", "merged": true, "mergeCommit": {"oid": "186c8ac919c4732db73272ae7198685df0259114"}, "closed": true, "closedAt": "2020-09-14T15:15:14Z", "author": {"login": "wangliang181230"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHaqzDgH2gAyNDgzNDMwNzc5OjgwMjQ5MGZlNTJiNjcwNmNlZTYzYTgzYmY3NDFlOTdlOGQ2OTIyNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI0u3cgFqTQ4Nzg3NzUxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "802490fe52b6706cee63a83bf741e97e8d692279", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/802490fe52b6706cee63a83bf741e97e8d692279", "committedDate": "2020-09-10T06:18:59Z", "message": "optimize: opt ContextCore, support Object value"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6123c57033813871940b76d78a79dbaf6013d1f", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/d6123c57033813871940b76d78a79dbaf6013d1f", "committedDate": "2020-09-10T06:37:54Z", "message": "fix style."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70d42fc53d84be81e37f598767760020373493ef", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/70d42fc53d84be81e37f598767760020373493ef", "committedDate": "2020-09-10T07:04:55Z", "message": "\u5c0f\u8c03\u6574\u3002"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NDU1MTQw", "url": "https://github.com/seata/seata/pull/3102#pullrequestreview-487455140", "createdAt": "2020-09-14T06:43:17Z", "commit": {"oid": "70d42fc53d84be81e37f598767760020373493ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNjo0MzoxN1rOHRF2ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNjo0MzoxN1rOHRF2ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY4MzcwNw==", "bodyText": "if (BranchType.TCC != previousBranchType) {\nRootContext.unbindBranchType();\n}", "url": "https://github.com/seata/seata/pull/3102#discussion_r487683707", "createdAt": "2020-09-14T06:43:17Z", "author": {"login": "slievrly"}, "path": "spring/src/main/java/io/seata/spring/tcc/TccActionInterceptor.java", "diffHunk": "@@ -87,10 +86,11 @@ public Object invoke(final MethodInvocation invocation) throws Throwable {\n                 return ret.get(Constants.TCC_METHOD_RESULT);\n             }\n             finally {\n-                RootContext.unbindBranchType();\n                 //restore the TCC branchType if exists\n-                if (StringUtils.equals(BranchType.TCC.name(), previousBranchType)) {\n+                if (BranchType.TCC == previousBranchType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70d42fc53d84be81e37f598767760020373493ef"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c25e4b6b3fe15539408a0be79afacf825ca6e865", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/c25e4b6b3fe15539408a0be79afacf825ca6e865", "committedDate": "2020-09-14T06:55:50Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80395a137f45c2327fea2d5d12ddbcebe2f8ce29", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/80395a137f45c2327fea2d5d12ddbcebe2f8ce29", "committedDate": "2020-09-14T07:02:56Z", "message": "optimize code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NDczOTA0", "url": "https://github.com/seata/seata/pull/3102#pullrequestreview-487473904", "createdAt": "2020-09-14T07:15:13Z", "commit": {"oid": "80395a137f45c2327fea2d5d12ddbcebe2f8ce29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a721879bf4f0716941fb54b2b13956a14520f3a", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/9a721879bf4f0716941fb54b2b13956a14520f3a", "committedDate": "2020-09-14T07:17:17Z", "message": "fix notes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODc3NTEx", "url": "https://github.com/seata/seata/pull/3102#pullrequestreview-487877511", "createdAt": "2020-09-14T15:14:53Z", "commit": {"oid": "9a721879bf4f0716941fb54b2b13956a14520f3a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3653, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}