{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTA0MTg2", "number": 2831, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMzoxODo1MlrOEJZ2aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo0Nzo0MFrOEKbAtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4Mjk2MTcxOnYy", "diffSide": "RIGHT", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMzoxODo1MlrOGp58ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMzoxODo1MlrOGp58ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU5NDE1NA==", "bodyText": "When the configuration is null, the default value is not set.", "url": "https://github.com/seata/seata/pull/2831#discussion_r446594154", "createdAt": "2020-06-28T03:18:52Z", "author": {"login": "wangliang181230"}, "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "diffHunk": "@@ -39,14 +45,31 @@\n  */\n public class DbStateMachineConfig extends DefaultStateMachineConfig implements DisposableBean {\n \n+    private static final Logger LOGGER = LoggerFactory.getLogger(DbStateMachineConfig.class);\n+\n     private DataSource dataSource;\n     private String applicationId;\n     private String txServiceGroup;\n     private String tablePrefix = \"seata_\";\n     private String dbType;\n     private SagaTransactionalTemplate sagaTransactionalTemplate;\n-    private boolean rmReportSuccessEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n-    private boolean sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+    private boolean rmReportSuccessEnable;\n+    private boolean sagaBranchRegisterEnable;\n+    private String sagaJsonParser;\n+\n+\n+    public DbStateMachineConfig() {\n+        try {\n+            Configuration configuration = ConfigurationFactory.getInstance();\n+            if (configuration != null) {\n+                this.rmReportSuccessEnable = configuration.getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n+                this.sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+                this.sagaJsonParser = ConfigurationFactory.getInstance().getConfig(ConfigurationKeys.CLIENT_SAGA_JSON_PARSER, DEFAULT_SAGA_JSON_PARSER);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MzYzNzY1OnYy", "diffSide": "RIGHT", "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo0Nzo0MFrOGrczLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo1NzoxN1rOGrdJSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMzgwNQ==", "bodyText": "ConfigurationFactory.getInstance() to configuration", "url": "https://github.com/seata/seata/pull/2831#discussion_r448213805", "createdAt": "2020-07-01T08:47:40Z", "author": {"login": "wangliang181230"}, "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "diffHunk": "@@ -39,14 +45,33 @@\n  */\n public class DbStateMachineConfig extends DefaultStateMachineConfig implements DisposableBean {\n \n+    private static final Logger LOGGER = LoggerFactory.getLogger(DbStateMachineConfig.class);\n+\n     private DataSource dataSource;\n     private String applicationId;\n     private String txServiceGroup;\n     private String tablePrefix = \"seata_\";\n     private String dbType;\n     private SagaTransactionalTemplate sagaTransactionalTemplate;\n-    private boolean rmReportSuccessEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n-    private boolean sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+    private boolean rmReportSuccessEnable = DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE;\n+    private boolean sagaBranchRegisterEnable = DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE;\n+    private String sagaJsonParser = DEFAULT_SAGA_JSON_PARSER;\n+\n+\n+    public DbStateMachineConfig() {\n+        try {\n+            Configuration configuration = ConfigurationFactory.getInstance();\n+            if (configuration != null) {\n+                this.rmReportSuccessEnable = configuration.getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n+                this.sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxOTQ2Nw==", "bodyText": "done", "url": "https://github.com/seata/seata/pull/2831#discussion_r448219467", "createdAt": "2020-07-01T08:57:17Z", "author": {"login": "long187"}, "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "diffHunk": "@@ -39,14 +45,33 @@\n  */\n public class DbStateMachineConfig extends DefaultStateMachineConfig implements DisposableBean {\n \n+    private static final Logger LOGGER = LoggerFactory.getLogger(DbStateMachineConfig.class);\n+\n     private DataSource dataSource;\n     private String applicationId;\n     private String txServiceGroup;\n     private String tablePrefix = \"seata_\";\n     private String dbType;\n     private SagaTransactionalTemplate sagaTransactionalTemplate;\n-    private boolean rmReportSuccessEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n-    private boolean sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+    private boolean rmReportSuccessEnable = DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE;\n+    private boolean sagaBranchRegisterEnable = DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE;\n+    private String sagaJsonParser = DEFAULT_SAGA_JSON_PARSER;\n+\n+\n+    public DbStateMachineConfig() {\n+        try {\n+            Configuration configuration = ConfigurationFactory.getInstance();\n+            if (configuration != null) {\n+                this.rmReportSuccessEnable = configuration.getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n+                this.sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMzgwNQ=="}, "originalCommit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1483, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}