{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5MTA0MTg2", "number": 2831, "title": "feature: Saga support jackson json parser", "bodyText": "\u2160. Describe what this PR did\nSaga support jackson json parser\n\u2163. Describe how to verify it\nclient {\n  rm {\n    sagaJsonParser = jackson\n  }\n}\n\nor\nclient {\n  rm {\n    sagaJsonParser = fastjson\n  }\n}", "createdAt": "2020-06-24T10:09:29Z", "url": "https://github.com/seata/seata/pull/2831", "merged": true, "mergeCommit": {"oid": "8caac9088a16c12cde0564c81e4d96c7695fcee2"}, "closed": true, "closedAt": "2020-07-01T09:16:45Z", "author": {"login": "long187"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsGCeYgH2gAyNDM5MTA0MTg2OjEyYzMzMGYwNDg4ZTJiY2ZjZGZmMjgzN2U2MzM3ZjI3MzA1MzhmYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwmX48AH2gAyNDM5MTA0MTg2OjU0Mjk0YjMzNjI4NjVlZWUxZGM3NzAwZWFjMTYwNmI0ZDc5Nzg2OGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "12c330f0488e2bcfcdff2837e6337f2730538fb5", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/12c330f0488e2bcfcdff2837e6337f2730538fb5", "committedDate": "2020-06-17T09:00:53Z", "message": "jackson tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9817d27df1b7e43f527b301a3b997d33e14c0406", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/9817d27df1b7e43f527b301a3b997d33e14c0406", "committedDate": "2020-06-24T03:40:49Z", "message": "saga support jackson json parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b95868d8f9e3027eb73eceb3a15d9048b3765f1e", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/b95868d8f9e3027eb73eceb3a15d9048b3765f1e", "committedDate": "2020-06-24T08:15:37Z", "message": "saga support jackson json parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7", "committedDate": "2020-06-24T10:05:43Z", "message": "saga support jackson json parser"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2ODcyNDYx", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-436872461", "createdAt": "2020-06-24T17:47:01Z", "commit": {"oid": "ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzM5Nzkw", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-438739790", "createdAt": "2020-06-28T03:18:51Z", "commit": {"oid": "ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMzoxODo1MlrOGp58ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMzoxODo1MlrOGp58ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU5NDE1NA==", "bodyText": "When the configuration is null, the default value is not set.", "url": "https://github.com/seata/seata/pull/2831#discussion_r446594154", "createdAt": "2020-06-28T03:18:52Z", "author": {"login": "wangliang181230"}, "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "diffHunk": "@@ -39,14 +45,31 @@\n  */\n public class DbStateMachineConfig extends DefaultStateMachineConfig implements DisposableBean {\n \n+    private static final Logger LOGGER = LoggerFactory.getLogger(DbStateMachineConfig.class);\n+\n     private DataSource dataSource;\n     private String applicationId;\n     private String txServiceGroup;\n     private String tablePrefix = \"seata_\";\n     private String dbType;\n     private SagaTransactionalTemplate sagaTransactionalTemplate;\n-    private boolean rmReportSuccessEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n-    private boolean sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+    private boolean rmReportSuccessEnable;\n+    private boolean sagaBranchRegisterEnable;\n+    private String sagaJsonParser;\n+\n+\n+    public DbStateMachineConfig() {\n+        try {\n+            Configuration configuration = ConfigurationFactory.getInstance();\n+            if (configuration != null) {\n+                this.rmReportSuccessEnable = configuration.getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n+                this.sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+                this.sagaJsonParser = ConfigurationFactory.getInstance().getConfig(ConfigurationKeys.CLIENT_SAGA_JSON_PARSER, DEFAULT_SAGA_JSON_PARSER);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba59eeee2b6d1e01aa6e2c7abbdecb8fd81605b7"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4950667bf5cb976c1617946da4bd1d5ab22bdfe9", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/4950667bf5cb976c1617946da4bd1d5ab22bdfe9", "committedDate": "2020-06-30T07:16:34Z", "message": "add default value for sagaJsonParser"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NzgzNDQ3", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-439783447", "createdAt": "2020-06-30T08:24:05Z", "commit": {"oid": "4950667bf5cb976c1617946da4bd1d5ab22bdfe9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5ODk1NTMw", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-439895530", "createdAt": "2020-06-30T10:46:38Z", "commit": {"oid": "4950667bf5cb976c1617946da4bd1d5ab22bdfe9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb3516b15703f7f5e070a071ad49976dfa5071bc", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/fb3516b15703f7f5e070a071ad49976dfa5071bc", "committedDate": "2020-07-01T07:10:14Z", "message": "Saga client application-id read from config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f2f2b16f968b28d098fbdba98a69ab92dd3a1f4", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/9f2f2b16f968b28d098fbdba98a69ab92dd3a1f4", "committedDate": "2020-07-01T07:42:29Z", "message": "fix saga junit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/3c5c8b4c24f634049314281a3d4c5a9fd9751781", "committedDate": "2020-07-01T07:58:17Z", "message": "resolve conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNjM1MzQ4", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-440635348", "createdAt": "2020-07-01T08:01:25Z", "commit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNjcwMTU4", "url": "https://github.com/seata/seata/pull/2831#pullrequestreview-440670158", "createdAt": "2020-07-01T08:47:40Z", "commit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo0Nzo0MFrOGrczLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODo0Nzo0MFrOGrczLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMzgwNQ==", "bodyText": "ConfigurationFactory.getInstance() to configuration", "url": "https://github.com/seata/seata/pull/2831#discussion_r448213805", "createdAt": "2020-07-01T08:47:40Z", "author": {"login": "wangliang181230"}, "path": "saga/seata-saga-engine-store/src/main/java/io/seata/saga/engine/config/DbStateMachineConfig.java", "diffHunk": "@@ -39,14 +45,33 @@\n  */\n public class DbStateMachineConfig extends DefaultStateMachineConfig implements DisposableBean {\n \n+    private static final Logger LOGGER = LoggerFactory.getLogger(DbStateMachineConfig.class);\n+\n     private DataSource dataSource;\n     private String applicationId;\n     private String txServiceGroup;\n     private String tablePrefix = \"seata_\";\n     private String dbType;\n     private SagaTransactionalTemplate sagaTransactionalTemplate;\n-    private boolean rmReportSuccessEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n-    private boolean sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);\n+    private boolean rmReportSuccessEnable = DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE;\n+    private boolean sagaBranchRegisterEnable = DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE;\n+    private String sagaJsonParser = DEFAULT_SAGA_JSON_PARSER;\n+\n+\n+    public DbStateMachineConfig() {\n+        try {\n+            Configuration configuration = ConfigurationFactory.getInstance();\n+            if (configuration != null) {\n+                this.rmReportSuccessEnable = configuration.getBoolean(ConfigurationKeys.CLIENT_REPORT_SUCCESS_ENABLE, DEFAULT_CLIENT_REPORT_SUCCESS_ENABLE);\n+                this.sagaBranchRegisterEnable = ConfigurationFactory.getInstance().getBoolean(ConfigurationKeys.CLIENT_SAGA_BRANCH_REGISTER_ENABLE, DEFAULT_CLIENT_SAGA_BRANCH_REGISTER_ENABLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c5c8b4c24f634049314281a3d4c5a9fd9751781"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54294b3362865eee1dc7700eac1606b4d797868d", "author": {"user": {"login": "long187", "name": "leo"}}, "url": "https://github.com/seata/seata/commit/54294b3362865eee1dc7700eac1606b4d797868d", "committedDate": "2020-07-01T08:56:56Z", "message": "fix ConfigurationFactory.getInstance() to configuration"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3790, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}