{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNDIyMTcx", "number": 3241, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoxNFrOE5QkrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoyNFrOE5QkzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NDc1ODIxOnYy", "diffSide": "RIGHT", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiDeleteExecutor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoxNFrOHznTlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNToxMzo0MVrOH0DQNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzg4MzQxMw==", "bodyText": "NotSupportYetException ?", "url": "https://github.com/seata/seata/pull/3241#discussion_r523883413", "createdAt": "2020-11-16T03:37:14Z", "author": {"login": "jsbxyyx"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiDeleteExecutor.java", "diffHunk": "@@ -55,6 +57,15 @@ protected TableRecords beforeImage() throws SQLException {\n         for (SQLRecognizer recognizer : sqlRecognizers) {\n             sqlRecognizer = recognizer;\n             SQLDeleteRecognizer visitor = (SQLDeleteRecognizer) recognizer;\n+\n+            ParametersHolder parametersHolder = statementProxy instanceof ParametersHolder ? (ParametersHolder)statementProxy : null;\n+            if (StringUtils.isNotBlank(visitor.getLimit(parametersHolder, paramAppenderList))) {\n+                throw new ShouldNeverHappenException(\"Multi delete SQL should not contains limit condition !\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33242f2953002c15baa4d70908f1563aaf46206f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM0MTMwMQ==", "bodyText": "\u597d\u50cfNotSupportYetException \u662f\u66f4\u51c6\u786e\u4e00\u70b9\uff0cmessage\u987a\u4fbf\u6539\u4e00\u4e0b\u53ef\u80fd\u4f1a\u597d\u4e00\u70b9\nMulti delete SQL with limit condition is not support yet !\n\u8fd9\u6837OK\uff1f", "url": "https://github.com/seata/seata/pull/3241#discussion_r524341301", "createdAt": "2020-11-16T15:13:41Z", "author": {"login": "caohdgege"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiDeleteExecutor.java", "diffHunk": "@@ -55,6 +57,15 @@ protected TableRecords beforeImage() throws SQLException {\n         for (SQLRecognizer recognizer : sqlRecognizers) {\n             sqlRecognizer = recognizer;\n             SQLDeleteRecognizer visitor = (SQLDeleteRecognizer) recognizer;\n+\n+            ParametersHolder parametersHolder = statementProxy instanceof ParametersHolder ? (ParametersHolder)statementProxy : null;\n+            if (StringUtils.isNotBlank(visitor.getLimit(parametersHolder, paramAppenderList))) {\n+                throw new ShouldNeverHappenException(\"Multi delete SQL should not contains limit condition !\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzg4MzQxMw=="}, "originalCommit": {"oid": "33242f2953002c15baa4d70908f1563aaf46206f"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NDc1ODIyOnYy", "diffSide": "RIGHT", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiDeleteExecutor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoxNlrOHznTmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoxNlrOHznTmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzg4MzQxOA==", "bodyText": "NotSupportYetException ?", "url": "https://github.com/seata/seata/pull/3241#discussion_r523883418", "createdAt": "2020-11-16T03:37:16Z", "author": {"login": "jsbxyyx"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiDeleteExecutor.java", "diffHunk": "@@ -55,6 +57,15 @@ protected TableRecords beforeImage() throws SQLException {\n         for (SQLRecognizer recognizer : sqlRecognizers) {\n             sqlRecognizer = recognizer;\n             SQLDeleteRecognizer visitor = (SQLDeleteRecognizer) recognizer;\n+\n+            ParametersHolder parametersHolder = statementProxy instanceof ParametersHolder ? (ParametersHolder)statementProxy : null;\n+            if (StringUtils.isNotBlank(visitor.getLimit(parametersHolder, paramAppenderList))) {\n+                throw new ShouldNeverHappenException(\"Multi delete SQL should not contains limit condition !\");\n+            }\n+            if (StringUtils.isNotBlank(visitor.getOrderBy())) {\n+                throw new ShouldNeverHappenException(\"Multi delete SQL should not contains order by condition !\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33242f2953002c15baa4d70908f1563aaf46206f"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NDc1ODQwOnYy", "diffSide": "RIGHT", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiUpdateExecutor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoyMVrOHznTsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoyMVrOHznTsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzg4MzQ0MQ==", "bodyText": "NotSupportYetException ?", "url": "https://github.com/seata/seata/pull/3241#discussion_r523883441", "createdAt": "2020-11-16T03:37:21Z", "author": {"login": "jsbxyyx"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiUpdateExecutor.java", "diffHunk": "@@ -79,6 +81,15 @@ protected TableRecords beforeImage() throws SQLException {\n         for (SQLRecognizer recognizer : sqlRecognizers) {\n             sqlRecognizer = recognizer;\n             SQLUpdateRecognizer sqlUpdateRecognizer = (SQLUpdateRecognizer) recognizer;\n+\n+            ParametersHolder parametersHolder = statementProxy instanceof ParametersHolder ? (ParametersHolder)statementProxy : null;\n+            if (StringUtils.isNotBlank(sqlUpdateRecognizer.getLimit(parametersHolder, paramAppenderList))) {\n+                throw new ShouldNeverHappenException(\"Multi update SQL should not contains limit condition !\");\n+            }\n+            if (StringUtils.isNotBlank(sqlUpdateRecognizer.getOrderBy())) {\n+                throw new ShouldNeverHappenException(\"Multi update SQL should not contains order by condition !\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33242f2953002c15baa4d70908f1563aaf46206f"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4NDc1ODUyOnYy", "diffSide": "RIGHT", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiUpdateExecutor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoyNFrOHznTwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwMzozNzoyNFrOHznTwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzg4MzQ1Nw==", "bodyText": "NotSupportYetException ?", "url": "https://github.com/seata/seata/pull/3241#discussion_r523883457", "createdAt": "2020-11-16T03:37:24Z", "author": {"login": "jsbxyyx"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/exec/MultiUpdateExecutor.java", "diffHunk": "@@ -79,6 +81,15 @@ protected TableRecords beforeImage() throws SQLException {\n         for (SQLRecognizer recognizer : sqlRecognizers) {\n             sqlRecognizer = recognizer;\n             SQLUpdateRecognizer sqlUpdateRecognizer = (SQLUpdateRecognizer) recognizer;\n+\n+            ParametersHolder parametersHolder = statementProxy instanceof ParametersHolder ? (ParametersHolder)statementProxy : null;\n+            if (StringUtils.isNotBlank(sqlUpdateRecognizer.getLimit(parametersHolder, paramAppenderList))) {\n+                throw new ShouldNeverHappenException(\"Multi update SQL should not contains limit condition !\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33242f2953002c15baa4d70908f1563aaf46206f"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1332, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}