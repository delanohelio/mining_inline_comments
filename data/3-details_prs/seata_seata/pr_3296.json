{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1NDEzNTcz", "number": 3296, "title": "bugfix: when mixed use of AT and TCC, AT branchs is not deleted", "bodyText": "\u2160. Describe what this PR did\nbugfix: when mixed use of AT and TCC, AT branchs is not deleted.\n\u95ee\u9898\u4fee\u590d\uff1aAT\u548cTCC\u6df7\u5408\u4f7f\u7528\u65f6\uff0cAT\u5206\u652f\u672a\u88ab\u53ca\u65f6\u5220\u9664\u3002\n\u987a\u4fbf\u4f18\u5316\u4e00\u4e0b\uff1a\n\u987a\u4fbf\u6dfb\u52a0\u4e0a\u4e00\u4e2aPR\u4e2d\u53d8\u66f4\u8fc7\u914d\u7f6e\u4f4d\u7f6e\u7684\u63d0\u793a\uff0c\u6548\u679c\u5982\u4e0b\u56fe\uff1a\n\n\u2161. Does this pull request fix one issue?\n\nfixes #3295\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-11-23T02:47:05Z", "url": "https://github.com/seata/seata/pull/3296", "merged": true, "mergeCommit": {"oid": "23a407e236bb3d7f93fb7ad927299be5a43deb20"}, "closed": true, "closedAt": "2020-11-24T04:53:39Z", "author": {"login": "wangliang181230"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfL7vpAH2gAyNTI1NDEzNTczOmQxNzEzZDJmMmVjNWFhZWU1ZjA2ZGNiYmRkMjBhNzMyOTI3MGRjMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfiXTngFqTUzNzA3NjIwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d1713d2f2ec5aaee5f06dcbbdd20a7329270dc2b", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/d1713d2f2ec5aaee5f06dcbbdd20a7329270dc2b", "committedDate": "2020-11-23T02:43:06Z", "message": "bugfix: when AT and TCC are mixed, AT branchs is not deleted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d59b6cd98a5d99f11b6571b9d2e7b8f0451ba38", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/5d59b6cd98a5d99f11b6571b9d2e7b8f0451ba38", "committedDate": "2020-11-23T02:48:51Z", "message": "Merge branch 'develop' into bugfix-TC-async-commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MTU4MDI5", "url": "https://github.com/seata/seata/pull/3296#pullrequestreview-536158029", "createdAt": "2020-11-23T03:13:26Z", "commit": {"oid": "5d59b6cd98a5d99f11b6571b9d2e7b8f0451ba38"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMzoxMzoyN1rOH3-QFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QwMzoxMzoyN1rOH3-QFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQ1MzY1Mw==", "bodyText": "\u8fd9\u91cc\u7528 globalSession.canBeCommittedAsync \u4f1a\u4e0d\u4f1a\u597d\u70b9\uff1f", "url": "https://github.com/seata/seata/pull/3296#discussion_r528453653", "createdAt": "2020-11-23T03:13:27Z", "author": {"login": "caohdgege"}, "path": "server/src/main/java/io/seata/server/coordinator/DefaultCore.java", "diffHunk": "@@ -235,11 +238,12 @@ public boolean doGlobalCommit(GlobalSession globalSession, boolean retrying) thr\n                     }\n                 }\n             }\n-            if (globalSession.hasBranch()) {\n+            if (hasNoBranchsCanBeCommittedAsync && globalSession.hasBranch()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d59b6cd98a5d99f11b6571b9d2e7b8f0451ba38"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34cb6d452eeb62019400e71ccc40d802954e58df", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/34cb6d452eeb62019400e71ccc40d802954e58df", "committedDate": "2020-11-23T03:26:55Z", "message": "optimize code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NDMzOTY3", "url": "https://github.com/seata/seata/pull/3296#pullrequestreview-536433967", "createdAt": "2020-11-23T12:38:57Z", "commit": {"oid": "34cb6d452eeb62019400e71ccc40d802954e58df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NDYwOTU0", "url": "https://github.com/seata/seata/pull/3296#pullrequestreview-536460954", "createdAt": "2020-11-23T13:15:43Z", "commit": {"oid": "34cb6d452eeb62019400e71ccc40d802954e58df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fe31fde95ecd4004f4efae61ad862f4010360a2", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/6fe31fde95ecd4004f4efae61ad862f4010360a2", "committedDate": "2020-11-24T02:26:04Z", "message": "optimize comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e05e5e4271b6171e0ec6e71655285830be2df7c", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/8e05e5e4271b6171e0ec6e71655285830be2df7c", "committedDate": "2020-11-24T04:23:57Z", "message": "optimize config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fcd659023b58b656874f67d77993cb905bd0a80", "author": {"user": {"login": "wangliang181230", "name": "WangLiang/\u738b\u826f"}}, "url": "https://github.com/seata/seata/commit/8fcd659023b58b656874f67d77993cb905bd0a80", "committedDate": "2020-11-24T04:24:38Z", "message": "optimize config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3MDc2MjAw", "url": "https://github.com/seata/seata/pull/3296#pullrequestreview-537076200", "createdAt": "2020-11-24T04:51:07Z", "commit": {"oid": "8fcd659023b58b656874f67d77993cb905bd0a80"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3506, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}