{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwNjQ3OTE0", "number": 2776, "title": "optimize: paramsPlaceHolder generate by StringUtils.repeat()", "bodyText": "paramsPlaceHolder generate by StringUtils.repeat()\n\nparamsPlaceHolder generate by StringUtils.repeat()\nmake read easy\nrun test LogStoreDataBaseDAOTest", "createdAt": "2020-06-08T03:19:27Z", "url": "https://github.com/seata/seata/pull/2776", "merged": true, "mergeCommit": {"oid": "1b90640911f2e907e0def194dfefd97d2571f853"}, "closed": true, "closedAt": "2020-06-24T08:24:51Z", "author": {"login": "xianlaioy"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpHrYnAH2gAyNDMwNjQ3OTE0OmQ5NzEzNjcxMmI5NjQ2NDcxOWQ1ZTRkMDJjZDhiNGM4Y2ZiYmYxZjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuVtPOgFqTQzNjQyOTQ5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d97136712b96464719d5e4d02cd8b4c8cfbbf1f9", "author": {"user": {"login": "xianlaioy", "name": "xianlaioy"}}, "url": "https://github.com/seata/seata/commit/d97136712b96464719d5e4d02cd8b4c8cfbbf1f9", "committedDate": "2020-06-08T03:13:42Z", "message": "paramsPlaceHolder generate by StringUtils.repeat()\n\nparamsPlaceHolder generate by StringUtils.repeat()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08d287dc5985daaf2fefce63a7d1358f195f6be6", "author": {"user": {"login": "xianlaioy", "name": "xianlaioy"}}, "url": "https://github.com/seata/seata/commit/08d287dc5985daaf2fefce63a7d1358f195f6be6", "committedDate": "2020-06-08T06:59:28Z", "message": "Update LogStoreDataBaseDAO.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1OTU4MjI5", "url": "https://github.com/seata/seata/pull/2776#pullrequestreview-425958229", "createdAt": "2020-06-08T07:00:13Z", "commit": {"oid": "08d287dc5985daaf2fefce63a7d1358f195f6be6"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/21a7855effecf1df0785a3acef964832a239a33a", "committedDate": "2020-06-08T08:03:45Z", "message": "Merge branch 'develop' into patch-1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzUxMjEx", "url": "https://github.com/seata/seata/pull/2776#pullrequestreview-426751211", "createdAt": "2020-06-09T02:42:32Z", "commit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMjo0MjozM1rOGg22nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMjo0MjozM1rOGg22nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEwNjMzNQ==", "bodyText": "extract repeat method to io.seata.common.util.StringUtils?", "url": "https://github.com/seata/seata/pull/2776#discussion_r437106335", "createdAt": "2020-06-09T02:42:33Z", "author": {"login": "jsbxyyx"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -165,15 +164,9 @@ public GlobalTransactionDO queryGlobalTransactionDO(long transactionId) {\n             conn = logStoreDataSource.getConnection();\n             conn.setAutoCommit(true);\n \n-            StringBuilder sb = new StringBuilder();\n-            for (int i = 0; i < statuses.length; i++) {\n-                sb.append(\"?\");\n-                if (i != (statuses.length - 1)) {\n-                    sb.append(\", \");\n-                }\n-            }\n+            String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",statuses.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "962f1e192e6bc5c1525299454c8bb5495bd444b6", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/962f1e192e6bc5c1525299454c8bb5495bd444b6", "committedDate": "2020-06-09T03:18:03Z", "message": "Merge branch 'develop' into patch-1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzY0NTk2", "url": "https://github.com/seata/seata/pull/2776#pullrequestreview-426764596", "createdAt": "2020-06-09T03:29:44Z", "commit": {"oid": "962f1e192e6bc5c1525299454c8bb5495bd444b6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyOTo0NFrOGg3jUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyOTo0NFrOGg3jUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNzc3OQ==", "bodyText": "for better readability, please add a space in the separator.   \",\"-> \", \"", "url": "https://github.com/seata/seata/pull/2776#discussion_r437117779", "createdAt": "2020-06-09T03:29:44Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -288,11 +281,9 @@ public boolean deleteGlobalTransactionDO(GlobalTransactionDO globalTransactionDO\n     @Override\n     public List<BranchTransactionDO> queryBranchTransactionDO(List<String> xids) {\n         int length = xids.size();\n-        int retsSize = length * 3;\n-        List<BranchTransactionDO> rets = new ArrayList<>(retsSize);\n-        StringJoiner sj = new StringJoiner(\",\");\n-        xids.stream().forEach(xid -> sj.add(\"?\"));\n-        String sql = LogStoreSqlsFactory.getLogStoreSqls(dbType).getQueryBranchTransaction(brachTable, sj.toString());\n+        List<BranchTransactionDO> rets = new ArrayList<>(length * 3);\n+        String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "962f1e192e6bc5c1525299454c8bb5495bd444b6"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "746b542cc912a592cfc49d214dd196ec2e4f9b28", "author": {"user": {"login": "xianlaioy", "name": "xianlaioy"}}, "url": "https://github.com/seata/seata/commit/746b542cc912a592cfc49d214dd196ec2e4f9b28", "committedDate": "2020-06-09T03:43:52Z", "message": "code style format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ad5fffde3877545de5e2fc5ee8ca12586885e5d", "author": {"user": {"login": "xianlaioy", "name": "xianlaioy"}}, "url": "https://github.com/seata/seata/commit/1ad5fffde3877545de5e2fc5ee8ca12586885e5d", "committedDate": "2020-06-09T03:48:44Z", "message": "Update LogStoreDataBaseDAO.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28b65a45a3c110ca4a0ea7c1ac41d1aeb00dde70", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/28b65a45a3c110ca4a0ea7c1ac41d1aeb00dde70", "committedDate": "2020-06-09T04:01:08Z", "message": "Merge branch 'develop' into patch-1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61711f427bbb448cd34f9989cdd891f4702cd6f4", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/61711f427bbb448cd34f9989cdd891f4702cd6f4", "committedDate": "2020-06-22T02:54:11Z", "message": "Merge branch 'develop' into patch-1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29942d595bd649995a467bafd306d64996d70c92", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/29942d595bd649995a467bafd306d64996d70c92", "committedDate": "2020-06-24T08:00:46Z", "message": "Merge branch 'develop' into patch-1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDI2NzAx", "url": "https://github.com/seata/seata/pull/2776#pullrequestreview-436426701", "createdAt": "2020-06-24T08:20:17Z", "commit": {"oid": "29942d595bd649995a467bafd306d64996d70c92"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDI5NDk5", "url": "https://github.com/seata/seata/pull/2776#pullrequestreview-436429499", "createdAt": "2020-06-24T08:24:01Z", "commit": {"oid": "29942d595bd649995a467bafd306d64996d70c92"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3745, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}