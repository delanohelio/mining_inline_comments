{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM4OTA3NDI2", "number": 3367, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNjoyMTozNVrOFLkCxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNjoyMTozNVrOFLkCxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ3NjY5MTkxOnYy", "diffSide": "RIGHT", "path": "rm-datasource/src/main/java/io/seata/rm/datasource/xa/ConnectionProxyXA.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwNjoyMTozNVrOIOzTMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQwODowOTo0MFrOIO1Zuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MTQ3NA==", "bodyText": "rolled back\uff1f", "url": "https://github.com/seata/seata/pull/3367#discussion_r552391474", "createdAt": "2021-01-06T06:21:35Z", "author": {"login": "slievrly"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/xa/ConnectionProxyXA.java", "diffHunk": "@@ -201,22 +209,21 @@ public void rollback() throws SQLException {\n         if (!xaActive || this.xaBranchXid == null) {\n             throw new SQLException(\"should NOT rollback on an inactive session\");\n         }\n-        try {\n-            // Branch Report to TC\n-            DefaultResourceManager.get().branchReport(BranchType.XA, xid, xaBranchXid.getBranchId(), BranchStatus.PhaseOne_Failed, null);\n-\n-        } catch (TransactionException te) {\n-            // log and ignore the report failure\n-            LOGGER.warn(\"Failed to report XA branch rollback on \" + xid + \"-\" + xaBranchXid.getBranchId()\n-                + \" since \" + te.getCode() + \":\" + te.getMessage());\n-        }\n         try {\n             // XA End: Fail\n             xaResource.end(xaBranchXid, XAResource.TMFAIL);\n+            xaRollback(xaBranchXid);\n+            // Branch Report to TC\n+            DefaultResourceManager.get().branchReport(BranchType.XA, xid, xaBranchXid.getBranchId(),\n+                BranchStatus.PhaseOne_Failed, null);\n+            LOGGER.info(xaBranchXid + \" was rolled back.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8642480112697dfac703999d22375241c3eba989"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQyNTkxNQ==", "bodyText": "ok", "url": "https://github.com/seata/seata/pull/3367#discussion_r552425915", "createdAt": "2021-01-06T08:09:40Z", "author": {"login": "a364176773"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/xa/ConnectionProxyXA.java", "diffHunk": "@@ -201,22 +209,21 @@ public void rollback() throws SQLException {\n         if (!xaActive || this.xaBranchXid == null) {\n             throw new SQLException(\"should NOT rollback on an inactive session\");\n         }\n-        try {\n-            // Branch Report to TC\n-            DefaultResourceManager.get().branchReport(BranchType.XA, xid, xaBranchXid.getBranchId(), BranchStatus.PhaseOne_Failed, null);\n-\n-        } catch (TransactionException te) {\n-            // log and ignore the report failure\n-            LOGGER.warn(\"Failed to report XA branch rollback on \" + xid + \"-\" + xaBranchXid.getBranchId()\n-                + \" since \" + te.getCode() + \":\" + te.getMessage());\n-        }\n         try {\n             // XA End: Fail\n             xaResource.end(xaBranchXid, XAResource.TMFAIL);\n+            xaRollback(xaBranchXid);\n+            // Branch Report to TC\n+            DefaultResourceManager.get().branchReport(BranchType.XA, xid, xaBranchXid.getBranchId(),\n+                BranchStatus.PhaseOne_Failed, null);\n+            LOGGER.info(xaBranchXid + \" was rolled back.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MTQ3NA=="}, "originalCommit": {"oid": "8642480112697dfac703999d22375241c3eba989"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1371, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}