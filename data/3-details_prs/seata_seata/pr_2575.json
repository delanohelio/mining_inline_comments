{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NjQyMTky", "number": 2575, "title": "bugfix: fix executeBatch can not get targetSql in Statement mode", "bodyText": "\u2160. Describe what this PR did\n\u2161. Does this pull request fix one issue?\nfix bug #2537\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews\nin seata 1.1.0 addBatch could invoke only once\u3002\nif use jdbcTemplate.batchUpdate(String...sql), Only supports one SQL", "createdAt": "2020-04-19T10:39:12Z", "url": "https://github.com/seata/seata/pull/2575", "merged": true, "mergeCommit": {"oid": "b9c37390f0edf9a179664c6bda93f09ad80955f5"}, "closed": true, "closedAt": "2020-04-20T06:46:16Z", "author": {"login": "HankDevelop"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZICkTAH2gAyNDA1NjQyMTkyOjY1MGRkNzc0ZTVhZjI1MDU2NjczNTU0OGIyY2Q1OTc3OTBkMjIwYjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZZWCOgFqTM5NjE3ODUyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "650dd774e5af250566735548b2cd597790d220b9", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/650dd774e5af250566735548b2cd597790d220b9", "committedDate": "2020-04-19T10:36:14Z", "message": "fix bug#2537 jdbcTemplate batchUpdate can not get targetSql"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDEzNTI3", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396013527", "createdAt": "2020-04-19T12:50:55Z", "commit": {"oid": "650dd774e5af250566735548b2cd597790d220b9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMjo1MDo1NVrOGH3Mlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMjo1MDo1NVrOGH3Mlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg5NzU1OQ==", "bodyText": "If the business sql has \";\", the spliced sql will be wrong.\nBut the business side can handle it, and it can be changed here or not.", "url": "https://github.com/seata/seata/pull/2575#discussion_r410897559", "createdAt": "2020-04-19T12:50:55Z", "author": {"login": "zjinlei"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/StatementProxy.java", "diffHunk": "@@ -113,6 +114,16 @@ public boolean execute(String sql, String[] columnNames) throws SQLException {\n         return ExecuteTemplate.execute(this, (statement, args) -> statement.execute((String) args[0],(String[])args[1]), sql,columnNames);\n     }\n \n+    @Override\n+    public void addBatch(String sql) throws SQLException {\n+        if (StringUtils.isNotBlank(targetSQL)) {\n+            targetSQL += \"; \" + sql;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "650dd774e5af250566735548b2cd597790d220b9"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDEzNjE4", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396013618", "createdAt": "2020-04-19T12:51:58Z", "commit": {"oid": "650dd774e5af250566735548b2cd597790d220b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MDE2NDA0", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396016404", "createdAt": "2020-04-19T13:12:46Z", "commit": {"oid": "650dd774e5af250566735548b2cd597790d220b9"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2fca3b7ca0f5143c7f9591b6921d2c07f24945a", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/a2fca3b7ca0f5143c7f9591b6921d2c07f24945a", "committedDate": "2020-04-19T14:20:29Z", "message": "fix unit test at io.seata.rm.datasource.StatementProxyTest#testGetTargetSQL"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MTc2MTE4", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396176118", "createdAt": "2020-04-20T06:41:06Z", "commit": {"oid": "a2fca3b7ca0f5143c7f9591b6921d2c07f24945a"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MTc4MTMw", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396178130", "createdAt": "2020-04-20T06:45:09Z", "commit": {"oid": "a2fca3b7ca0f5143c7f9591b6921d2c07f24945a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MTc4NTI0", "url": "https://github.com/seata/seata/pull/2575#pullrequestreview-396178524", "createdAt": "2020-04-20T06:45:53Z", "commit": {"oid": "a2fca3b7ca0f5143c7f9591b6921d2c07f24945a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3922, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}