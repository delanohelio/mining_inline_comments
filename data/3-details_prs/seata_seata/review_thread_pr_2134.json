{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MTk0ODg1", "number": 2134, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMToyNzo1M1rODXtXaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMzoxNjo1OVrODc2Ihg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MTg3MTE1OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/coordinator/DefaultCoordinator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMToyNzo1M1rOFdJ0aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMzozNTozNlrOFdLW1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExMzg5Ng==", "bodyText": "Hello, plase keep jdk related import classes at the forefront.", "url": "https://github.com/seata/seata/pull/2134#discussion_r366113896", "createdAt": "2020-01-14T01:27:53Z", "author": {"login": "InstallingB"}, "path": "server/src/main/java/io/seata/server/coordinator/DefaultCoordinator.java", "diffHunk": "@@ -70,20 +54,21 @@\n import io.seata.core.rpc.netty.RpcServer;\n import io.seata.server.AbstractTCInboundHandler;\n import io.seata.server.event.EventBusManager;\n-import io.seata.server.session.BranchSession;\n import io.seata.server.session.GlobalSession;\n import io.seata.server.session.SessionHolder;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n-import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchCommitRequest;\n-import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchRollbackRequest;\n+import java.time.Duration;\n+import java.util.Collection;\n+import java.util.Map;\n+import java.util.concurrent.ScheduledThreadPoolExecutor;\n+import java.util.concurrent.TimeUnit;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEzOTA5NA==", "bodyText": "thanks, done", "url": "https://github.com/seata/seata/pull/2134#discussion_r366139094", "createdAt": "2020-01-14T03:35:36Z", "author": {"login": "ph3636"}, "path": "server/src/main/java/io/seata/server/coordinator/DefaultCoordinator.java", "diffHunk": "@@ -70,20 +54,21 @@\n import io.seata.core.rpc.netty.RpcServer;\n import io.seata.server.AbstractTCInboundHandler;\n import io.seata.server.event.EventBusManager;\n-import io.seata.server.session.BranchSession;\n import io.seata.server.session.GlobalSession;\n import io.seata.server.session.SessionHolder;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n-import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchCommitRequest;\n-import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchRollbackRequest;\n+import java.time.Duration;\n+import java.util.Collection;\n+import java.util.Map;\n+import java.util.concurrent.ScheduledThreadPoolExecutor;\n+import java.util.concurrent.TimeUnit;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExMzg5Ng=="}, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MTg3MzcwOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/transaction/saga/SagaCore.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMToyOTozOVrOFdJ17w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMzozNTo0MFrOFdLW4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNDI4Nw==", "bodyText": "Hello, plase keep jdk related import classes at the forefront.", "url": "https://github.com/seata/seata/pull/2134#discussion_r366114287", "createdAt": "2020-01-14T01:29:39Z", "author": {"login": "InstallingB"}, "path": "server/src/main/java/io/seata/server/transaction/saga/SagaCore.java", "diffHunk": "@@ -0,0 +1,239 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.transaction.saga;\n+\n+import io.netty.channel.Channel;\n+import io.seata.core.exception.GlobalTransactionException;\n+import io.seata.core.exception.TransactionException;\n+import io.seata.core.model.BranchStatus;\n+import io.seata.core.model.BranchType;\n+import io.seata.core.model.GlobalStatus;\n+import io.seata.core.protocol.transaction.BranchCommitRequest;\n+import io.seata.core.protocol.transaction.BranchCommitResponse;\n+import io.seata.core.protocol.transaction.BranchRollbackRequest;\n+import io.seata.core.protocol.transaction.BranchRollbackResponse;\n+import io.seata.core.rpc.ChannelManager;\n+import io.seata.core.rpc.ServerMessageSender;\n+import io.seata.server.coordinator.AbstractCore;\n+import io.seata.server.session.BranchSession;\n+import io.seata.server.session.GlobalSession;\n+import io.seata.server.session.SessionHelper;\n+import io.seata.server.session.SessionHolder;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.concurrent.TimeoutException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEzOTEwNw==", "bodyText": "thanks, done", "url": "https://github.com/seata/seata/pull/2134#discussion_r366139107", "createdAt": "2020-01-14T03:35:40Z", "author": {"login": "ph3636"}, "path": "server/src/main/java/io/seata/server/transaction/saga/SagaCore.java", "diffHunk": "@@ -0,0 +1,239 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.transaction.saga;\n+\n+import io.netty.channel.Channel;\n+import io.seata.core.exception.GlobalTransactionException;\n+import io.seata.core.exception.TransactionException;\n+import io.seata.core.model.BranchStatus;\n+import io.seata.core.model.BranchType;\n+import io.seata.core.model.GlobalStatus;\n+import io.seata.core.protocol.transaction.BranchCommitRequest;\n+import io.seata.core.protocol.transaction.BranchCommitResponse;\n+import io.seata.core.protocol.transaction.BranchRollbackRequest;\n+import io.seata.core.protocol.transaction.BranchRollbackResponse;\n+import io.seata.core.rpc.ChannelManager;\n+import io.seata.core.rpc.ServerMessageSender;\n+import io.seata.server.coordinator.AbstractCore;\n+import io.seata.server.session.BranchSession;\n+import io.seata.server.session.GlobalSession;\n+import io.seata.server.session.SessionHelper;\n+import io.seata.server.session.SessionHolder;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.concurrent.TimeoutException;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNDI4Nw=="}, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MTg3NDQyOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/coordinator/AbstractCore.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMTozMDoxN1rOFdJ2cA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMzozNTo0NFrOFdLW7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNDQxNg==", "bodyText": "Hello, plase keep jdk related import classes at the forefront.", "url": "https://github.com/seata/seata/pull/2134#discussion_r366114416", "createdAt": "2020-01-14T01:30:17Z", "author": {"login": "InstallingB"}, "path": "server/src/main/java/io/seata/server/coordinator/AbstractCore.java", "diffHunk": "@@ -0,0 +1,233 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.coordinator;\n+\n+import io.seata.core.exception.BranchTransactionException;\n+import io.seata.core.exception.GlobalTransactionException;\n+import io.seata.core.exception.TransactionException;\n+import io.seata.core.exception.TransactionExceptionCode;\n+import io.seata.core.model.BranchStatus;\n+import io.seata.core.model.BranchType;\n+import io.seata.core.model.GlobalStatus;\n+import io.seata.core.protocol.transaction.BranchCommitRequest;\n+import io.seata.core.protocol.transaction.BranchCommitResponse;\n+import io.seata.core.protocol.transaction.BranchRollbackRequest;\n+import io.seata.core.protocol.transaction.BranchRollbackResponse;\n+import io.seata.core.rpc.ServerMessageSender;\n+import io.seata.server.lock.LockManager;\n+import io.seata.server.lock.LockerFactory;\n+import io.seata.server.session.BranchSession;\n+import io.seata.server.session.GlobalSession;\n+import io.seata.server.session.SessionHelper;\n+import io.seata.server.session.SessionHolder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.io.IOException;\n+import java.util.concurrent.TimeoutException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEzOTExOA==", "bodyText": "thanks, done", "url": "https://github.com/seata/seata/pull/2134#discussion_r366139118", "createdAt": "2020-01-14T03:35:44Z", "author": {"login": "ph3636"}, "path": "server/src/main/java/io/seata/server/coordinator/AbstractCore.java", "diffHunk": "@@ -0,0 +1,233 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.coordinator;\n+\n+import io.seata.core.exception.BranchTransactionException;\n+import io.seata.core.exception.GlobalTransactionException;\n+import io.seata.core.exception.TransactionException;\n+import io.seata.core.exception.TransactionExceptionCode;\n+import io.seata.core.model.BranchStatus;\n+import io.seata.core.model.BranchType;\n+import io.seata.core.model.GlobalStatus;\n+import io.seata.core.protocol.transaction.BranchCommitRequest;\n+import io.seata.core.protocol.transaction.BranchCommitResponse;\n+import io.seata.core.protocol.transaction.BranchRollbackRequest;\n+import io.seata.core.protocol.transaction.BranchRollbackResponse;\n+import io.seata.core.rpc.ServerMessageSender;\n+import io.seata.server.lock.LockManager;\n+import io.seata.server.lock.LockerFactory;\n+import io.seata.server.session.BranchSession;\n+import io.seata.server.session.GlobalSession;\n+import io.seata.server.session.SessionHelper;\n+import io.seata.server.session.SessionHolder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.io.IOException;\n+import java.util.concurrent.TimeoutException;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjExNDQxNg=="}, "originalCommit": {"oid": "bb6f60a9c4c50ee92f1addaf18f82153a3209930"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTY0MzA0OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/coordinator/Core.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMjowOTo0NFrOFlGHEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMjowOTo0NFrOFlGHEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ0MTc0Ng==", "bodyText": "why not impl ResourceManagerInbound\uff1f", "url": "https://github.com/seata/seata/pull/2134#discussion_r374441746", "createdAt": "2020-02-04T02:09:44Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/coordinator/Core.java", "diffHunk": "@@ -29,27 +31,54 @@\n public interface Core extends TransactionManager, ResourceManagerOutbound {\n \n     /**\n-     * Sets resource manager inbound.\n+     * Do global commit.\n      *\n-     * @param resourceManagerInbound the resource manager inbound\n+     * @param globalSession the global session\n+     * @param retrying      the retrying\n+     * @return is global commit.\n+     * @throws TransactionException the transaction exception\n      */\n-    void setResourceManagerInbound(ResourceManagerInbound resourceManagerInbound);\n+    boolean doGlobalCommit(GlobalSession globalSession, boolean retrying) throws TransactionException;\n \n     /**\n-     * Do global commit.\n+     * Do global rollback.\n      *\n      * @param globalSession the global session\n      * @param retrying      the retrying\n+     * @return is global rollback.\n      * @throws TransactionException the transaction exception\n      */\n-    void doGlobalCommit(GlobalSession globalSession, boolean retrying) throws TransactionException;\n+    boolean doGlobalRollback(GlobalSession globalSession, boolean retrying) throws TransactionException;\n \n     /**\n-     * Do global rollback.\n+     * Do global report.\n      *\n      * @param globalSession the global session\n-     * @param retrying      the retrying\n+     * @param xid           Transaction id.\n+     * @param param         the global status\n      * @throws TransactionException the transaction exception\n      */\n-    void doGlobalRollback(GlobalSession globalSession, boolean retrying) throws TransactionException;\n+    void doGlobalReport(GlobalSession globalSession, String xid, GlobalStatus param) throws TransactionException;\n+\n+    /**\n+     * Commit a branch transaction.\n+     *\n+     * @param globalSession the global session\n+     * @param branchSession the branch session\n+     * @return Status of the branch after committing.\n+     * @throws TransactionException Any exception that fails this will be wrapped with TransactionException and thrown\n+     *                              out.\n+     */\n+    BranchStatus branchCommit(GlobalSession globalSession, BranchSession branchSession) throws TransactionException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d17f4e1e677b01e7a8bbc9079407e740205eebd"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTY2Mzg4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/coordinator/DefaultCore.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMjoyNDo0NlrOFlGT8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMjoyNDo0NlrOFlGT8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ0NTA0Mg==", "bodyText": "What does rm mean\uff1f", "url": "https://github.com/seata/seata/pull/2134#discussion_r374445042", "createdAt": "2020-02-04T02:24:46Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/coordinator/DefaultCore.java", "diffHunk": "@@ -52,104 +46,90 @@\n \n     private static final Logger LOGGER = LoggerFactory.getLogger(DefaultCore.class);\n \n-    private LockManager lockManager = LockerFactory.getLockManager();\n+    private EventBus eventBus = EventBusManager.get();\n \n-    private ResourceManagerInbound resourceManagerInbound;\n+    private static Map<BranchType, AbstractCore> coreMap = new ConcurrentHashMap<>();\n \n-    private EventBus eventBus = EventBusManager.get();\n+    /**\n+     * get the Default core.\n+     *\n+     * @param messageSender the message sender\n+     */\n+    public DefaultCore(ServerMessageSender messageSender) {\n+        List<AbstractCore> allCore = EnhancedServiceLoader.loadAll(AbstractCore.class,\n+                new Class[] {ServerMessageSender.class}, new Object[] {messageSender});\n+        if (CollectionUtils.isNotEmpty(allCore)) {\n+            for (AbstractCore core : allCore) {\n+                coreMap.put(core.getBranchType(), core);\n+            }\n+        }\n+    }\n \n-    @Override\n-    public void setResourceManagerInbound(ResourceManagerInbound resourceManagerInbound) {\n-        this.resourceManagerInbound = resourceManagerInbound;\n+    /**\n+     * get core\n+     *\n+     * @param branchType the branchType\n+     * @return the core\n+     */\n+    public AbstractCore getCore(BranchType branchType) {\n+        AbstractCore rm = coreMap.get(branchType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d17f4e1e677b01e7a8bbc9079407e740205eebd"}, "originalPosition": 78}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTczNjM4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/coordinator/AbstractCore.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMzoxNjo1OVrOFlG_PA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwMzoxNjo1OVrOFlG_PA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ1NjEyNA==", "bodyText": "getHandleBranchType", "url": "https://github.com/seata/seata/pull/2134#discussion_r374456124", "createdAt": "2020-02-04T03:16:59Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/coordinator/AbstractCore.java", "diffHunk": "@@ -0,0 +1,233 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.coordinator;\n+\n+import java.io.IOException;\n+import java.util.concurrent.TimeoutException;\n+\n+import io.seata.core.exception.BranchTransactionException;\n+import io.seata.core.exception.GlobalTransactionException;\n+import io.seata.core.exception.TransactionException;\n+import io.seata.core.exception.TransactionExceptionCode;\n+import io.seata.core.model.BranchStatus;\n+import io.seata.core.model.BranchType;\n+import io.seata.core.model.GlobalStatus;\n+import io.seata.core.protocol.transaction.BranchCommitRequest;\n+import io.seata.core.protocol.transaction.BranchCommitResponse;\n+import io.seata.core.protocol.transaction.BranchRollbackRequest;\n+import io.seata.core.protocol.transaction.BranchRollbackResponse;\n+import io.seata.core.rpc.ServerMessageSender;\n+import io.seata.server.lock.LockManager;\n+import io.seata.server.lock.LockerFactory;\n+import io.seata.server.session.BranchSession;\n+import io.seata.server.session.GlobalSession;\n+import io.seata.server.session.SessionHelper;\n+import io.seata.server.session.SessionHolder;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import static io.seata.core.exception.TransactionExceptionCode.BranchTransactionNotExist;\n+import static io.seata.core.exception.TransactionExceptionCode.FailedToAddBranch;\n+import static io.seata.core.exception.TransactionExceptionCode.GlobalTransactionNotActive;\n+import static io.seata.core.exception.TransactionExceptionCode.GlobalTransactionStatusInvalid;\n+import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchCommitRequest;\n+import static io.seata.core.exception.TransactionExceptionCode.FailedToSendBranchRollbackRequest;\n+\n+/**\n+ * The type abstract core.\n+ *\n+ * @author ph3636\n+ */\n+public abstract class AbstractCore implements Core {\n+\n+    protected static final Logger LOGGER = LoggerFactory.getLogger(AbstractCore.class);\n+\n+    protected LockManager lockManager = LockerFactory.getLockManager();\n+\n+    protected ServerMessageSender messageSender;\n+\n+    public AbstractCore(ServerMessageSender messageSender) {\n+        this.messageSender = messageSender;\n+    }\n+\n+    public abstract BranchType getBranchType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d17f4e1e677b01e7a8bbc9079407e740205eebd"}, "originalPosition": 66}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1716, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}