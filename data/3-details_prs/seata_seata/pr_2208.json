{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NTMxMzgw", "number": 2208, "title": "refactor: Replace getDbType with LoadLevel name", "bodyText": "refactor: Replace TableMetaCache and UndoLogManager and UndoExecutorHolder and KeywordChecker and SQLOperateRecognizerHolder with LoadLevel", "createdAt": "2020-01-19T12:52:55Z", "url": "https://github.com/seata/seata/pull/2208", "merged": true, "mergeCommit": {"oid": "67a99ddbad8eb0d0a2d3a7994a9e3679ea7ef6b1"}, "closed": true, "closedAt": "2020-01-23T16:06:36Z", "author": {"login": "ph3636"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb73b13gH2gAyMzY0NTMxMzgwOmMzZDE0MzI1YTkwMzRiOGRjMTk5NWEwZTA2MThjY2U3Zjg1ZDJjYTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9MiMRgFqTM0NzQxMzUyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c3d14325a9034b8dc1995a0e0618cce7f85d2ca6", "author": {"user": {"login": "ph3636", "name": null}}, "url": "https://github.com/seata/seata/commit/c3d14325a9034b8dc1995a0e0618cce7f85d2ca6", "committedDate": "2020-01-19T12:51:39Z", "message": "refactor: Replace TableMetaCache and UndoLogManager and UndoExecutorHolder and KeywordChecker and SQLOperateRecognizerHolder with LoadLevel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72", "author": {"user": {"login": "ph3636", "name": null}}, "url": "https://github.com/seata/seata/commit/5f8912ae68d8a2da7f23a48c80bc92f7efe76b72", "committedDate": "2020-01-19T13:05:24Z", "message": "refactor: Replace TableMetaCache and UndoLogManager and UndoExecutorHolder and KeywordChecker and SQLOperateRecognizerHolder with LoadLevel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDkzNDQy", "url": "https://github.com/seata/seata/pull/2208#pullrequestreview-345093442", "createdAt": "2020-01-20T06:05:35Z", "commit": {"oid": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNjowNTozNlrOFfUMKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNjowNTozNlrOFfUMKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM4MDk2OA==", "bodyText": "dbType.toLowerCase()?", "url": "https://github.com/seata/seata/pull/2208#discussion_r368380968", "createdAt": "2020-01-20T06:05:36Z", "author": {"login": "slievrly"}, "path": "rm-datasource/src/main/java/io/seata/rm/datasource/sql/struct/TableMetaCacheFactory.java", "diffHunk": "@@ -35,22 +34,11 @@\n      * @return table meta cache\n      */\n     public static TableMetaCache getTableMetaCache(String dbType) {\n-        dbType = dbType.toLowerCase();\n-        if (tableMetaCacheMap == null) {\n-            synchronized (TableMetaCacheFactory.class) {\n-                if (tableMetaCacheMap == null) {\n-                    Map<String, TableMetaCache> initializedMap = new HashMap<>();\n-                    List<TableMetaCache> cacheList = EnhancedServiceLoader.loadAll(TableMetaCache.class);\n-                    for (TableMetaCache cache : cacheList) {\n-                        initializedMap.put(cache.getDbType().toLowerCase(), cache);\n-                    }\n-                    tableMetaCacheMap = initializedMap;\n-                }\n-            }\n-        }\n-        if (tableMetaCacheMap.containsKey(dbType)) {\n-            return tableMetaCacheMap.get(dbType);\n+        if (TABLE_META_CACHE_MAP.get(dbType) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDk0Nzk3", "url": "https://github.com/seata/seata/pull/2208#pullrequestreview-345094797", "createdAt": "2020-01-20T06:10:58Z", "commit": {"oid": "5f8912ae68d8a2da7f23a48c80bc92f7efe76b72"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "485d29a677561988a95da7cf9271004bcd67812c", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/485d29a677561988a95da7cf9271004bcd67812c", "committedDate": "2020-01-22T04:28:54Z", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "304bb79412a9abcf04f5faa56430e75adf996ed9", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/304bb79412a9abcf04f5faa56430e75adf996ed9", "committedDate": "2020-01-22T14:55:40Z", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0b6a5b89affed4685fa627879206dad27512961", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/b0b6a5b89affed4685fa627879206dad27512961", "committedDate": "2020-01-23T02:55:07Z", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9df3e6588d3eeb4b83758b3e695833218d6abc3", "author": {"user": {"login": "lovepoem", "name": "Xin Wang"}}, "url": "https://github.com/seata/seata/commit/d9df3e6588d3eeb4b83758b3e695833218d6abc3", "committedDate": "2020-01-23T08:28:08Z", "message": "Merge branch 'develop' into refactorSPIwithLoadLevel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDEzNTIz", "url": "https://github.com/seata/seata/pull/2208#pullrequestreview-347413523", "createdAt": "2020-01-23T16:00:31Z", "commit": {"oid": "d9df3e6588d3eeb4b83758b3e695833218d6abc3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3984, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}