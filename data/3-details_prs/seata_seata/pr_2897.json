{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwMDIyMzUy", "number": 2897, "title": "bugfix: fix jedis unlock fail", "bodyText": "\u2160. Describe what this PR did\nfix jedis unlock fail\n\u2161. Does this pull request fix one issue?\n\nfix #2898\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-07-16T08:54:39Z", "url": "https://github.com/seata/seata/pull/2897", "merged": true, "mergeCommit": {"oid": "8a63c4f3c31153cdd4be75129394ea3927e99355"}, "closed": true, "closedAt": "2020-07-28T04:15:50Z", "author": {"login": "a364176773"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1bV_6ABqjM1NTIxMzg1MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5N2vDgFqTQ1NjI3NzE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "faa6cc89904a65fbb6f7bc0632b9a757d160e2e1", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/faa6cc89904a65fbb6f7bc0632b9a757d160e2e1", "committedDate": "2020-07-16T08:47:26Z", "message": "fix jedis unlock fail"}, "afterCommit": {"oid": "62bcd650a249d76947219fa76c9549afd97e51a7", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/62bcd650a249d76947219fa76c9549afd97e51a7", "committedDate": "2020-07-16T08:54:18Z", "message": "modify code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5e3d8e6592d1e493d427fdb6fb4b0dda781b01", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/6f5e3d8e6592d1e493d427fdb6fb4b0dda781b01", "committedDate": "2020-07-16T08:57:01Z", "message": "fix jedis unlock fail"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62bcd650a249d76947219fa76c9549afd97e51a7", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/62bcd650a249d76947219fa76c9549afd97e51a7", "committedDate": "2020-07-16T08:54:18Z", "message": "modify code style"}, "afterCommit": {"oid": "6f5e3d8e6592d1e493d427fdb6fb4b0dda781b01", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/6f5e3d8e6592d1e493d427fdb6fb4b0dda781b01", "committedDate": "2020-07-16T08:57:01Z", "message": "fix jedis unlock fail"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef4cab62d60bcebc9ae27c03774371c0428e58b6", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/ef4cab62d60bcebc9ae27c03774371c0428e58b6", "committedDate": "2020-07-16T09:54:25Z", "message": "Merge branch 'develop' into 0716"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf99e8f1015f4f79f8c886a465dbe831d1d97683", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/bf99e8f1015f4f79f8c886a465dbe831d1d97683", "committedDate": "2020-07-16T10:12:13Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb", "committedDate": "2020-07-16T10:12:45Z", "message": "Merge branch '0716' of https://github.com/a364176773/seata into 0716"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMjU2OTU0", "url": "https://github.com/seata/seata/pull/2897#pullrequestreview-451256954", "createdAt": "2020-07-20T02:39:13Z", "commit": {"oid": "ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwMjozOToxNFrOGz0_kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwMjo0MTowNVrOGz1BQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk5ODgwMQ==", "bodyText": "It can be changed to mget", "url": "https://github.com/seata/seata/pull/2897#discussion_r456998801", "createdAt": "2020-07-20T02:39:14Z", "author": {"login": "ph3636"}, "path": "server/src/main/java/io/seata/server/storage/redis/lock/RedisLocker.java", "diffHunk": "@@ -144,6 +144,7 @@ public boolean releaseLock(String xid, List<Long> branchIds) {\n             if (CollectionUtils.isNotEmpty(keys)) {\n                 Pipeline pipeline = null;\n                 Iterator<String> it = keys.iterator();\n+                List<String> delKeys = new ArrayList<>();\n                 while (it.hasNext()) {\n                     String key = it.next();\n                     LockDO lock = JSON.parseObject(jedis.get(key), LockDO.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk5OTIzMg==", "bodyText": "It can be deleted and the following with delKeys judgment", "url": "https://github.com/seata/seata/pull/2897#discussion_r456999232", "createdAt": "2020-07-20T02:41:05Z", "author": {"login": "ph3636"}, "path": "server/src/main/java/io/seata/server/storage/redis/lock/RedisLocker.java", "diffHunk": "@@ -152,13 +153,15 @@ public boolean releaseLock(String xid, List<Long> branchIds) {\n                             if (pipeline == null) {\n                                 pipeline = jedis.pipelined();\n                             }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNTQwNTky", "url": "https://github.com/seata/seata/pull/2897#pullrequestreview-451540592", "createdAt": "2020-07-20T11:59:43Z", "commit": {"oid": "ef96e24f1ce8d080aeb03fc9fde9cee20675a2bb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82ac3a79877b9cac3a2d6e8d4f61cb7e8540ccb3", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/82ac3a79877b9cac3a2d6e8d4f61cb7e8540ccb3", "committedDate": "2020-07-20T13:25:44Z", "message": "optimize code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMDg5NTI5", "url": "https://github.com/seata/seata/pull/2897#pullrequestreview-452089529", "createdAt": "2020-07-21T02:50:12Z", "commit": {"oid": "82ac3a79877b9cac3a2d6e8d4f61cb7e8540ccb3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daafdc3ab5bfe20e86092e9493fd3e1801fd1f1e", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/daafdc3ab5bfe20e86092e9493fd3e1801fd1f1e", "committedDate": "2020-07-23T02:17:43Z", "message": "Merge branch 'develop' into 0716"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ce920e44ab658f754c3b59d8d9c5dbb1e728ceb", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/1ce920e44ab658f754c3b59d8d9c5dbb1e728ceb", "committedDate": "2020-07-24T06:56:34Z", "message": "Merge branch 'develop' into 0716"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b64ffb7a02a5af95935b89a7c2b337367303eacc", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/b64ffb7a02a5af95935b89a7c2b337367303eacc", "committedDate": "2020-07-24T09:38:43Z", "message": "fix bug"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fcef6176f77c2a8b4dd848230d8e44169561e20f", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/fcef6176f77c2a8b4dd848230d8e44169561e20f", "committedDate": "2020-07-24T09:40:01Z", "message": "fix code style"}, "afterCommit": {"oid": "b64ffb7a02a5af95935b89a7c2b337367303eacc", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/b64ffb7a02a5af95935b89a7c2b337367303eacc", "committedDate": "2020-07-24T09:38:43Z", "message": "fix bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e9c9305e04092d07fa83a7fc43eb68c57ad1ebc", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/5e9c9305e04092d07fa83a7fc43eb68c57ad1ebc", "committedDate": "2020-07-24T10:01:10Z", "message": "fix code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MjM1NDE2", "url": "https://github.com/seata/seata/pull/2897#pullrequestreview-456235416", "createdAt": "2020-07-28T01:09:09Z", "commit": {"oid": "5e9c9305e04092d07fa83a7fc43eb68c57ad1ebc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "163140c451a12f5e9e25d60c8f47a98ac9bfd490", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/163140c451a12f5e9e25d60c8f47a98ac9bfd490", "committedDate": "2020-07-28T03:28:01Z", "message": "Merge branch 'develop' into 0716"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Mjc3MTQz", "url": "https://github.com/seata/seata/pull/2897#pullrequestreview-456277143", "createdAt": "2020-07-28T03:28:19Z", "commit": {"oid": "5e9c9305e04092d07fa83a7fc43eb68c57ad1ebc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3822, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}