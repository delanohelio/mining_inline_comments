{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMDU4NzE5", "number": 2237, "title": "bugfix: fix DefaultCoordinatorTest failed in Windows OS", "bodyText": "\u2160. Describe what this PR did\nfix DefaultCoordinatorTest failed in windows OS\n\u2161. Does this pull request fix one issue?\n\nfix #2235\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-02-10T10:36:21Z", "url": "https://github.com/seata/seata/pull/2237", "merged": true, "mergeCommit": {"oid": "b95b850bc2d1cd56c917def50e3cedae2ca6ea8b"}, "closed": true, "closedAt": "2020-02-11T05:57:05Z", "author": {"login": "booogu"}, "timelineItems": {"totalCount": 56, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbk4lcTgH2gAyMzczMDU4NzE5Ojg0NTQ2MTNiYTY5ZTY1OWZmNzQ1ODc0Y2NlYzE5M2QwYTM2YjE0NmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDJkg4gFqTM1NjQwNzU1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8454613ba69e659ff745874ccec193d0a36b146e", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/8454613ba69e659ff745874ccec193d0a36b146e", "committedDate": "2019-11-09T03:11:47Z", "message": "restructure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "387b7cbb08becf632ec62633c456e7c1fc77badc", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/387b7cbb08becf632ec62633c456e7c1fc77badc", "committedDate": "2019-11-09T06:38:09Z", "message": "Restructure SQLRecognizer and UndoExecutor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "472cb658328284dedb9b66d3369419428ce2616d", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/472cb658328284dedb9b66d3369419428ce2616d", "committedDate": "2019-11-11T06:35:24Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96de7fd8499b1a8344532465b92661485b59b2e1", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/96de7fd8499b1a8344532465b92661485b59b2e1", "committedDate": "2019-11-11T06:37:05Z", "message": "optimize concurrency of UndoExecutorGruopFactory and SQLRecognizerGroupFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f090ff64ca12f4d9a47a51d8d88f70cba90804", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/d4f090ff64ca12f4d9a47a51d8d88f70cba90804", "committedDate": "2019-11-11T07:14:20Z", "message": "remove @version tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "550f6e12e528e0b891f7fa5244cfd75ad40aa9dc", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/550f6e12e528e0b891f7fa5244cfd75ad40aa9dc", "committedDate": "2019-11-11T08:13:55Z", "message": "add javaDoc;optimize UndoExecutorGroupFactory and SQLOperateRecognizerGroupFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0e250e7424b5c023e29c8cb302c90257fc6865f", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/b0e250e7424b5c023e29c8cb302c90257fc6865f", "committedDate": "2019-11-11T09:17:47Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d06df2e0f95590f70c50cede0e91a0769b88047a", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/d06df2e0f95590f70c50cede0e91a0769b88047a", "committedDate": "2019-11-12T01:04:52Z", "message": "rename **Group to **Holder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d46a4660cb487c73ddfc6da7bbab5122f7cda9f", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/3d46a4660cb487c73ddfc6da7bbab5122f7cda9f", "committedDate": "2019-11-12T01:06:40Z", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28322ac0b56e79b26f156d9e927371ece2799c8b", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/28322ac0b56e79b26f156d9e927371ece2799c8b", "committedDate": "2019-11-12T10:07:28Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57fb2d033e654890bc34adf3f5f2a3001c7600a7", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/57fb2d033e654890bc34adf3f5f2a3001c7600a7", "committedDate": "2019-11-12T11:08:51Z", "message": "remove @data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3ae74a5359eec9b2d6fa7051cbe22f27ec79426", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/c3ae74a5359eec9b2d6fa7051cbe22f27ec79426", "committedDate": "2019-11-12T11:10:06Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9a163e1535ded6ad4d93884a7e4e6d38b938423", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/e9a163e1535ded6ad4d93884a7e4e6d38b938423", "committedDate": "2019-11-12T11:10:36Z", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78f456fc5e4af3f86fc117f43d6f21acd16dac86", "author": {"user": {"login": "zjinlei", "name": null}}, "url": "https://github.com/seata/seata/commit/78f456fc5e4af3f86fc117f43d6f21acd16dac86", "committedDate": "2019-11-13T04:52:40Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c0f5d28d0fe236ef2cb783435b2df1e28d672e1", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/8c0f5d28d0fe236ef2cb783435b2df1e28d672e1", "committedDate": "2019-11-13T09:24:52Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e9a6bdbc44384652899470b6185958fc11a69b4", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/3e9a6bdbc44384652899470b6185958fc11a69b4", "committedDate": "2019-11-14T01:18:52Z", "message": "fix NPE in UndoExecutorFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19ef256b49f428f07e88a4600850cccc2d900e47", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/19ef256b49f428f07e88a4600850cccc2d900e47", "committedDate": "2019-11-14T01:21:18Z", "message": "restructure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43bc2c344dd8f44ad4f60dcadcbe54a6ba4ddbb1", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/43bc2c344dd8f44ad4f60dcadcbe54a6ba4ddbb1", "committedDate": "2019-11-14T01:21:19Z", "message": "Restructure SQLRecognizer and UndoExecutor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45a275caf806f3d9aae5edd7f27fcc27f5d1b9d8", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/45a275caf806f3d9aae5edd7f27fcc27f5d1b9d8", "committedDate": "2019-11-14T01:21:19Z", "message": "optimize concurrency of UndoExecutorGruopFactory and SQLRecognizerGroupFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a96fe5e8e36bbd242ad44d05c767c3263a2e75be", "author": {"user": null}, "url": "https://github.com/seata/seata/commit/a96fe5e8e36bbd242ad44d05c767c3263a2e75be", "committedDate": "2019-11-14T01:21:20Z", "message": "remove @version tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5febb227411c5594506c9c8eb1fabf7ad7e40a0a", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/5febb227411c5594506c9c8eb1fabf7ad7e40a0a", "committedDate": "2019-11-14T01:21:21Z", "message": "add javaDoc;optimize UndoExecutorGroupFactory and SQLOperateRecognizerGroupFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9a3696a94eecda0715732aff2eca04b0ec5bc8c", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/b9a3696a94eecda0715732aff2eca04b0ec5bc8c", "committedDate": "2019-11-14T01:21:21Z", "message": "rename **Group to **Holder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca8813429e12ef93c754c05efd3c496a9acab069", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/ca8813429e12ef93c754c05efd3c496a9acab069", "committedDate": "2019-11-14T01:21:21Z", "message": "remove @data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05adb694c15ddff8379f3858afa8e821c44497f0", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/05adb694c15ddff8379f3858afa8e821c44497f0", "committedDate": "2019-11-14T01:21:21Z", "message": "optimize: xid header lowercase (#1789)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b05a94656883c8ad4582dffa1581426715fce7", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/b1b05a94656883c8ad4582dffa1581426715fce7", "committedDate": "2019-11-14T01:21:21Z", "message": "clean: reformat saga module (#1890)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c5fe29ea4352dc7a01713e405ad228c4bdd52b5", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/2c5fe29ea4352dc7a01713e405ad228c4bdd52b5", "committedDate": "2019-11-14T01:21:21Z", "message": "fix NPE in UndoExecutorFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92bba972a2d761ca185dc256749b5194e199ffdc", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/92bba972a2d761ca185dc256749b5194e199ffdc", "committedDate": "2019-11-14T02:54:43Z", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c116c9b0fb4b1e3e6cb6ff7c1ef77c2d453c8cd9", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/c116c9b0fb4b1e3e6cb6ff7c1ef77c2d453c8cd9", "committedDate": "2019-11-14T12:02:14Z", "message": "merge latest code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59fe1cf5118baed2467d3d9b5471fc9a415f96fa", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/59fe1cf5118baed2467d3d9b5471fc9a415f96fa", "committedDate": "2019-11-14T12:04:39Z", "message": "bugfix:fix NPE in UndoExecutorFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "378e89c316845148800674914e9c740a03091178", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/378e89c316845148800674914e9c740a03091178", "committedDate": "2019-11-21T07:16:01Z", "message": "local commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8dcb893e02ee7d11f4692267c650a412aa4891e", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/b8dcb893e02ee7d11f4692267c650a412aa4891e", "committedDate": "2019-11-22T02:59:42Z", "message": "merge remote"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9755622cb16b6014a7a8ed8a2ecb1c0e23551a65", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/9755622cb16b6014a7a8ed8a2ecb1c0e23551a65", "committedDate": "2019-11-22T02:59:54Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ade3c8529a29485631b6f639d29fb255a52cb24a", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/ade3c8529a29485631b6f639d29fb255a52cb24a", "committedDate": "2019-11-22T03:03:21Z", "message": "bugfix:A bug that will appear when the default constructor is declared private"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0867c6aac833153e6eeddef3b3929a5fd3fc162", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/c0867c6aac833153e6eeddef3b3929a5fd3fc162", "committedDate": "2019-11-22T08:51:55Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fc4f5eacf38028b5bddbe726dfaff86159110f9", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/9fc4f5eacf38028b5bddbe726dfaff86159110f9", "committedDate": "2019-11-22T08:53:44Z", "message": "code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbf102fa9528b7cc8e6b2b40182520f589392731", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/dbf102fa9528b7cc8e6b2b40182520f589392731", "committedDate": "2019-11-23T09:00:46Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea397a7bf89d48a98a29385e5a3836edad7bdf5f", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/ea397a7bf89d48a98a29385e5a3836edad7bdf5f", "committedDate": "2019-11-24T07:24:40Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f4dd2bed800b7291fb6bbe69b82fd86340a6a85", "author": {"user": {"login": "xingfudeshi", "name": "xingfudeshi"}}, "url": "https://github.com/seata/seata/commit/3f4dd2bed800b7291fb6bbe69b82fd86340a6a85", "committedDate": "2019-11-29T03:44:56Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "028a80d963f9393724256bd6bcb0b54429b94404", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/028a80d963f9393724256bd6bcb0b54429b94404", "committedDate": "2019-11-29T13:10:28Z", "message": "Merge branch 'develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1968bb425a2ce25123fff1de6165f596e876be8", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/e1968bb425a2ce25123fff1de6165f596e876be8", "committedDate": "2019-12-02T07:34:12Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd36c51a528ee06691ca976f0c44f0fa4b0f25b7", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/fd36c51a528ee06691ca976f0c44f0fa4b0f25b7", "committedDate": "2019-12-02T07:34:45Z", "message": "Merge branch 'develop' of https://github.com/CharmingRabbit/seata into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f01d15f86cb359c5fe59826b7572352548afd378", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/f01d15f86cb359c5fe59826b7572352548afd378", "committedDate": "2019-12-05T11:26:23Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9aa49b922a67e8257b420166e2a1da724cd3eb0", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/c9aa49b922a67e8257b420166e2a1da724cd3eb0", "committedDate": "2019-12-17T07:57:43Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f195d869e57125771712dc79439fb61241bfd3b4", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/f195d869e57125771712dc79439fb61241bfd3b4", "committedDate": "2019-12-30T00:55:57Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3399fff0c4bfd65b79afae3c8a55a66560f7410", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/c3399fff0c4bfd65b79afae3c8a55a66560f7410", "committedDate": "2020-01-04T06:59:02Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac3a43e717e5601dc658016db28f4b40a60b35cb", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/ac3a43e717e5601dc658016db28f4b40a60b35cb", "committedDate": "2020-01-17T00:57:17Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c5fbdfeeec3905e9faf378d64ded71783021ab8", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/7c5fbdfeeec3905e9faf378d64ded71783021ab8", "committedDate": "2020-02-10T09:04:42Z", "message": "Merge remote-tracking branch 'upstream/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71950a24fbe3c141a9a814143e9b10ab4cd11ca5", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/71950a24fbe3c141a9a814143e9b10ab4cd11ca5", "committedDate": "2020-02-10T10:29:28Z", "message": "bugfix:fix DefaultCoordinatorTest failed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd6e09cd68e695af8efc8cec342e3b250cce6254", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/fd6e09cd68e695af8efc8cec342e3b250cce6254", "committedDate": "2020-02-10T10:50:11Z", "message": "format code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MDI4NzQ0", "url": "https://github.com/seata/seata/pull/2237#pullrequestreview-356028744", "createdAt": "2020-02-10T15:28:32Z", "commit": {"oid": "fd6e09cd68e695af8efc8cec342e3b250cce6254"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNToyODozMlrOFnqWqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxNToyODozMlrOFnqWqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzEzMjcxMw==", "bodyText": "SessionHolder.destroy();  prevents other TestClasses from being deleted after creating data files.", "url": "https://github.com/seata/seata/pull/2237#discussion_r377132713", "createdAt": "2020-02-10T15:28:32Z", "author": {"login": "slievrly"}, "path": "server/src/test/java/io/seata/server/coordinator/DefaultCoordinatorTest.java", "diffHunk": "@@ -220,22 +222,24 @@ public static void afterClass() throws Exception {\n         for (GlobalSession globalSession : globalSessions) {\n             globalSession.closeAndClean();\n         }\n-\n-        SessionHolder.destroy();\n     }\n \n     @AfterEach\n-    public void tearDown() {\n+    public void tearDown() throws IOException {\n+        SessionHolder.destroy();\n         deleteDataFile();\n     }\n \n-    private static void deleteDataFile() {\n+    private static void deleteDataFile() throws IOException {\n         File directory = new File(sessionStorePath);\n         File[] files = directory.listFiles();\n-        for (File file : files) {\n-            file.delete();\n+        if (files != null && files.length > 0) {\n+            for (File file : files) {\n+                Files.delete(Paths.get(file.getPath()));\n+            }\n         }\n     }\n+\n     private static void deleteAndCreateDataFile() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd6e09cd68e695af8efc8cec342e3b250cce6254"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08345892e8395d0a25e3edccf3bd5a43a78053ca", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/08345892e8395d0a25e3edccf3bd5a43a78053ca", "committedDate": "2020-02-10T16:03:46Z", "message": "add destory() in beforeEach"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MDcxMTYy", "url": "https://github.com/seata/seata/pull/2237#pullrequestreview-356071162", "createdAt": "2020-02-10T16:18:54Z", "commit": {"oid": "08345892e8395d0a25e3edccf3bd5a43a78053ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d7edff8f9a1996a02588187a927d6ccf75975af", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/3d7edff8f9a1996a02588187a927d6ccf75975af", "committedDate": "2020-02-11T01:38:05Z", "message": "fix npe while destroySessionHolder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2Mzg3OTgw", "url": "https://github.com/seata/seata/pull/2237#pullrequestreview-356387980", "createdAt": "2020-02-11T02:14:19Z", "commit": {"oid": "3d7edff8f9a1996a02588187a927d6ccf75975af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwMjoxNDoyMFrOFn75xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwMjoxNDoyMFrOFn75xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQyMDIyOQ==", "bodyText": "This should be SessionHolder.destroy to determine whether or not null, SessionHolder as a static method class, there is no guarantee that the internal initialization.", "url": "https://github.com/seata/seata/pull/2237#discussion_r377420229", "createdAt": "2020-02-11T02:14:20Z", "author": {"login": "slievrly"}, "path": "server/src/test/java/io/seata/server/coordinator/DefaultCoordinatorTest.java", "diffHunk": "@@ -220,27 +222,42 @@ public static void afterClass() throws Exception {\n         for (GlobalSession globalSession : globalSessions) {\n             globalSession.closeAndClean();\n         }\n-\n-        SessionHolder.destroy();\n     }\n \n     @AfterEach\n-    public void tearDown() {\n+    public void tearDown() throws IOException {\n+        destroySessionHolder();\n         deleteDataFile();\n     }\n \n-    private static void deleteDataFile() {\n+    private static void deleteDataFile() throws IOException {\n         File directory = new File(sessionStorePath);\n         File[] files = directory.listFiles();\n-        for (File file : files) {\n-            file.delete();\n+        if (files != null && files.length > 0) {\n+            for (File file : files) {\n+                Files.delete(Paths.get(file.getPath()));\n+            }\n         }\n     }\n+\n     private static void deleteAndCreateDataFile() throws IOException {\n+        destroySessionHolder();\n         deleteDataFile();\n         SessionHolder.init(StoreMode.FILE.name());\n     }\n \n+    private static void destroySessionHolder() {\n+        try {\n+            SessionHolder.getRootSessionManager();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d7edff8f9a1996a02588187a927d6ccf75975af"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b88b9011a8b93bf9adee0db92dc3eb7c73177d91", "author": {"user": {"login": "booogu", "name": "haozhibei"}}, "url": "https://github.com/seata/seata/commit/b88b9011a8b93bf9adee0db92dc3eb7c73177d91", "committedDate": "2020-02-11T02:34:36Z", "message": "fix npe in SessionHolder.destroy()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDA3NTU4", "url": "https://github.com/seata/seata/pull/2237#pullrequestreview-356407558", "createdAt": "2020-02-11T03:56:53Z", "commit": {"oid": "b88b9011a8b93bf9adee0db92dc3eb7c73177d91"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3999, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}