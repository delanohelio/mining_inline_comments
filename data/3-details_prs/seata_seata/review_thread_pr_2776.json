{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwNjQ3OTE0", "number": 2776, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMjo0MjozM1rOEDsPgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyOTo0NFrOEDssBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMzA2MDQ4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMjo0MjozM1rOGg22nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoxMjoxOVrOGg3Tsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEwNjMzNQ==", "bodyText": "extract repeat method to io.seata.common.util.StringUtils?", "url": "https://github.com/seata/seata/pull/2776#discussion_r437106335", "createdAt": "2020-06-09T02:42:33Z", "author": {"login": "jsbxyyx"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -165,15 +164,9 @@ public GlobalTransactionDO queryGlobalTransactionDO(long transactionId) {\n             conn = logStoreDataSource.getConnection();\n             conn.setAutoCommit(true);\n \n-            StringBuilder sb = new StringBuilder();\n-            for (int i = 0; i < statuses.length; i++) {\n-                sb.append(\"?\");\n-                if (i != (statuses.length - 1)) {\n-                    sb.append(\", \");\n-                }\n-            }\n+            String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",statuses.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEwOTk2Nw==", "bodyText": "I don't think it's necessary.", "url": "https://github.com/seata/seata/pull/2776#discussion_r437109967", "createdAt": "2020-06-09T02:56:56Z", "author": {"login": "xianlaioy"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -165,15 +164,9 @@ public GlobalTransactionDO queryGlobalTransactionDO(long transactionId) {\n             conn = logStoreDataSource.getConnection();\n             conn.setAutoCommit(true);\n \n-            StringBuilder sb = new StringBuilder();\n-            for (int i = 0; i < statuses.length; i++) {\n-                sb.append(\"?\");\n-                if (i != (statuses.length - 1)) {\n-                    sb.append(\", \");\n-                }\n-            }\n+            String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",statuses.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEwNjMzNQ=="}, "originalCommit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExMzc3OA==", "bodyText": "the apache common langs jar often conflicts with other libraries. convenient direct replacement.", "url": "https://github.com/seata/seata/pull/2776#discussion_r437113778", "createdAt": "2020-06-09T03:12:19Z", "author": {"login": "jsbxyyx"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -165,15 +164,9 @@ public GlobalTransactionDO queryGlobalTransactionDO(long transactionId) {\n             conn = logStoreDataSource.getConnection();\n             conn.setAutoCommit(true);\n \n-            StringBuilder sb = new StringBuilder();\n-            for (int i = 0; i < statuses.length; i++) {\n-                sb.append(\"?\");\n-                if (i != (statuses.length - 1)) {\n-                    sb.append(\", \");\n-                }\n-            }\n+            String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",statuses.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEwNjMzNQ=="}, "originalCommit": {"oid": "21a7855effecf1df0785a3acef964832a239a33a"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMzEzMzUxOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyOTo0NFrOGg3jUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyOTo0NFrOGg3jUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNzc3OQ==", "bodyText": "for better readability, please add a space in the separator.   \",\"-> \", \"", "url": "https://github.com/seata/seata/pull/2776#discussion_r437117779", "createdAt": "2020-06-09T03:29:44Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/storage/db/store/LogStoreDataBaseDAO.java", "diffHunk": "@@ -288,11 +281,9 @@ public boolean deleteGlobalTransactionDO(GlobalTransactionDO globalTransactionDO\n     @Override\n     public List<BranchTransactionDO> queryBranchTransactionDO(List<String> xids) {\n         int length = xids.size();\n-        int retsSize = length * 3;\n-        List<BranchTransactionDO> rets = new ArrayList<>(retsSize);\n-        StringJoiner sj = new StringJoiner(\",\");\n-        xids.stream().forEach(xid -> sj.add(\"?\"));\n-        String sql = LogStoreSqlsFactory.getLogStoreSqls(dbType).getQueryBranchTransaction(brachTable, sj.toString());\n+        List<BranchTransactionDO> rets = new ArrayList<>(length * 3);\n+        String paramsPlaceHolder = org.apache.commons.lang.StringUtils.repeat(\"?\",\",\",length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "962f1e192e6bc5c1525299454c8bb5495bd444b6"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1467, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}